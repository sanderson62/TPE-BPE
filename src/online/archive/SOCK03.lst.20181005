* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
    45* 010213  CR2011083000005  PEMA  ADD SPECIAL DCC SPP DDF REFUND
    46* 101813  IR2013101700003  PEMA  FIX MN Net Balloon calc.
    47* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    48* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    49* 072415  IR2015071500003  PEMA  REMOVE CLOSE STATEMENT
    50* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
    51*071117   IR2017061900003  PEMA  ALLOW 0% APR ON REFUNDS
    52* 100417  CR2017051000002  PEMA  Add fields to interface
    53* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    54******************************************************************
    55 environment division.
    56 data division.
    57 working-storage section.
    58 01  DFH-START PIC X(04).
    59*
    60* program buffers
    61*
    62 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    63     88  ALREADY-SENT              VALUE 'Y'.
    64 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    65 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    66     88  ELCERT-FINISHED            VALUE 'Y'.
    67 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    68 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    69     88  ERACCT-FOUND               VALUE 'Y'.
    70 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    71 77 ws-send-msg-size           pic s9(8) comp value 4096.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   3
* SOCK03.cbl
    72 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    73 77 ws-recv-buf                pic x(4096).
    74 77 ws-send-buf                pic x(4096) VALUE SPACES.
    75 77 ws-recv-total              pic s9(8) comp value 0.
    76 77 ws-recv-left               pic s9(8) comp value 0.
    77 77 ws-seq-num                 pic s9(8) comp value 0.
    78 77 ws-flags                   pic s9(8) comp value 0.
    79 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    80 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    81 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    82 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    83 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    84 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    85 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    86 77  ws-cancel-reason            pic x   value spaces.
    87 77  P1                          PIC S999 COMP-3 VALUE +0.
    88 77  P2                          PIC S999 COMP-3 VALUE +0.
    89 77  C0                          PIC S999 COMP-3 VALUE +0.
    90 77  C1                          PIC S999 COMP-3 VALUE +0.
    91 77  C2                          PIC S999 COMP-3 VALUE +0.
    92 77  C3                          PIC S999 COMP-3 VALUE +0.
    93 77 S1                           PIC S999 COMP-3 VALUE +0.
    94 77 S2                           PIC S999 COMP-3 VALUE +0.
    95 77 L1                           PIC S999 COMP-3 VALUE +0.
    96 77 L2                           PIC S999 COMP-3 VALUE +0.
    97 77 F1                           PIC S999 COMP-3 VALUE +0.
    98 77 WS-BUILD-SW                  PIC X.
    99    88  TIME-TO-BUILD               VALUE 'Y'.
   100 77 WS-SAVE-ERACCT               PIC X(2000).
   101 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
   102 77 WS-STOP-SW                   PIC X  VALUE ' '.
   103    88  TOLD-TO-STOP               VALUE 'Y'.
   104 77 WS-PERFORM-SW                PIC X VALUE SPACES.
   105    88  GET-RATES                    VALUE 'R'.
   106    88  GET-ACT-ACCTS                VALUE 'A'.
   107 77 ws-bin-1st-pay-dt            pic xx  value low-values.
   108 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
   109 77 ws-disp-rate                 pic z9.99999.
   110 77  WS-ERCTBL-SW                PIC X VALUE ' '.
   111     88  END-OF-ERCTBL                 VALUE 'Y'.
   112 77  WS-STATUS                   PIC X.
   113 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
   114 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
   115 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
   116 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   117 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   118 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   119 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   120 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   121 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   122 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   123 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   124 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   125     88  WS-ELCERT-FULL             VALUE '1'.
   126     88  WS-ELCERT-NAME             VALUE '2'.
   127     88  WS-ELCERT-CERT-NO          VALUE '3'.
   128     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   129 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   4
* SOCK03.cbl
   130 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   131     88  I-SAY-TO-STOP      VALUE 'Y'.
   132 77  WS-HEX-0A                   PIC X.
   133 77  WS-CALL-TYPE                PIC X(6).
   134 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   135 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   136 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   137 77  DD-IU-SW                    PIC X   VALUE ' '.
   138     88  DD-IU-PRESENT                 VALUE 'Y'.
   139 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
   140 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
   141 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
   142 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
   143 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
   144 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
   145 77  ws-ah-rfnd-clp              pic s9(7)v99 comp-3 value +0.
   146 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
   147 77  WS-PDEF-RECORD-SW           PIC X           VALUE ' '.
   148     88  PDEF-FOUND                              VALUE 'Y'.
   149 77  ws-epiq-sw                  pic x  value ' '.
   150     88  ws-epiq-request           value 'Y'.
   151 77  ws-epiq-max                 pic s999 value +0 comp-3.
   152 01  WS-STRING-DATA.
   153     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   154     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   155     05  WS-CARRIER              PIC X        VALUE SPACES.
   156     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   157     05  WS-STATE                PIC XX       VALUE SPACES.
   158     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   159     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   160     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   161     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   162     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   163     05  WS-MID-INIT             PIC X        VALUE SPACES.
   164     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   165     05  WS-LF-COVERAGE-TYPE     PIC X        VALUE SPACES.
   166     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   167     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   168     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   169     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   170     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   171     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   172     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   173     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   174     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   175     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   176     05  WS-AH-COVERAGE-TYPE     PIC X        VALUE SPACES.
   177     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   178     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   179     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   180     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   181     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   182     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   183     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   184     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   185     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   186     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   187     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   5
* SOCK03.cbl
   188     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   189     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   190     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   191     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   192     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   193     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   194     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   195     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   196     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   197     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   198     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   199     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   200     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   201     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   202     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   203     05  WS-LF-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   204     05  WS-AH-CANCEL-DATE       PIC 9(8)   VALUE ZEROS.
   205     05  WS-VIN                  PIC X(17)  VALUE SPACES.
   206     05  WS-CRED-BENE-NAME       PIC X(30)  VALUE SPACES.
   207 01  ws-work-date.
   208     05  ws-work-ccyy            pic x(4).
   209     05  ws-work-mm              pic xx.
   210     05  ws-work-dd              pic xx.
   211 01  ws-work-date-num redefines ws-work-date
   212                                 pic 9(8).
   213 01  FILLER.
   214     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   215     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   216     12  WS-STATE-ABBREVIATION   PIC XX.
   217     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   218     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   219     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   220     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   221     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   222     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   223     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   224     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   225     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   226     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   227     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   228     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   229     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   230     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   231     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   232     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   233     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   234     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   235     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   236     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   237     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   238     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   239     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   240     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   241     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   242     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   243         88  WS-REDUCING                         VALUE 'R'.
   244         88  WS-LEVEL                            VALUE 'L'  'P'.
   245 01  ELMSTR-KEY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   6
* SOCK03.cbl
   246     12  ELMSTR-COMP-CD          PIC X.
   247     12  ELMSTR-CERT-NO          PIC X(11).
   248 01  CTBL-KEY-SAVE               PIC X(5).
   249 01  CTBL-KEY.
   250     05  CTBL-COMPANY-CD         PIC X.
   251     05  CTBL-TABLE              PIC XXX.
   252     05  CTBL-BEN-TYPE           PIC X.
   253     05  CTBL-BEN-CODE           PIC XX.
   254 01  ERPDEF-KEY-SAVE             PIC X(18).
   255 01  ERPDEF-KEY.
   256     12  ERPDEF-COMPANY-CD       PIC X.
   257     12  ERPDEF-STATE            PIC XX.
   258     12  ERPDEF-PROD-CD          PIC XXX.
   259     12  F                       PIC X(7).
   260     12  ERPDEF-BEN-TYPE         PIC X.
   261     12  ERPDEF-BEN-CODE         PIC XX.
   262     12  ERPDEF-EXP-DT           PIC XX.
   263 01  WS-AM3-KEY.
   264     12  WS-AM3-ACCOUNT          PIC X(10).
   265     12  WS-AM3-EXP-DT           PIC XX.
   266 01  WS-AM-KEY.
   267     12  WS-AM-COMPANY-CD        PIC X.
   268     12  WS-AM-CARRIER           PIC X.
   269     12  WS-AM-GROUPING          PIC X(6).
   270     12  WS-AM-STATE             PIC XX.
   271     12  WS-AM-ACCOUNT           PIC X(10).
   272     12  WS-AM-EXPIRATION-DT     PIC XX.
   273     12  WS-AM-FILLER            PIC XXXX.
   274 01  WS-CO-DATA.
   275     05  WS-CO-NUM               PIC X(10).
   276     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   277     05  WS-CO-NAME              PIC X(30).
   278     05  WS-CO-MAIL-NAME         PIC X(30).
   279     05  WS-CO-ADDR1             PIC X(30).
   280     05  WS-CO-ADDR2             PIC X(30).
   281     05  WS-CO-ADDR3             PIC X(30).
   282     05  WS-CO-ZIP               PIC X(9).
   283     05  WS-CO-PHONE             PIC X(10).
   284 01  WS-CF-KEY.
   285     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   286     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   287*        88  COMPANY-MASTER                      VALUE '1'.
   288*        88  STATE-MASTER                        VALUE '3'.
   289*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   290*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   291     12  WS-CF-ACCESS.
   292         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   293         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   294             20  FILLER          PIC  X(01).
   295             20  WS-CF-CARRIER   PIC  X(01).
   296     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   297 01  WS-CS-KEY.
   298     05  WS-CS-COMPANY-CD        PIC X.
   299     05  WS-CS-CARRIER           PIC X.
   300     05  WS-CS-GROUP             PIC X(6).
   301     05  WS-CS-STATE             PIC XX.
   302     05  WS-CS-ACCOUNT           PIC X(10).
   303     05  WS-CS-EFF-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   7
* SOCK03.cbl
   304     05  WS-CS-CERT-NO           PIC X(11).
   305     05  WS-CS-TRLR-TYPE         PIC X.
   306 01  WS-MA-KEY.
   307     05  WS-MA-COMPANY-CD        PIC X.
   308     05  WS-MA-CARRIER           PIC X.
   309     05  WS-MA-GROUP             PIC X(6).
   310     05  WS-MA-STATE             PIC XX.
   311     05  WS-MA-ACCOUNT           PIC X(10).
   312     05  WS-MA-EFF-DT            PIC XX.
   313     05  WS-MA-CERT-NO           PIC X(11).
   314 01  WS-CM-KEY.
   315     05  WS-CM-COMPANY-CD        PIC X.
   316     05  WS-CM-CARRIER           PIC X.
   317     05  WS-CM-GROUP             PIC X(6).
   318     05  WS-CM-STATE             PIC XX.
   319     05  WS-CM-ACCOUNT           PIC X(10).
   320     05  WS-CM-EFF-DT            PIC XX.
   321     05  WS-CM-CERT-NO           PIC X(11).
   322 01  WS-CM-KEY-A1.
   323     05  WS-CM-COMPANY-CD-A1     PIC X.
   324     05  WS-CM-LAST-NAME         PIC X(15).
   325     05  WS-CM-INITIALS          PIC XX.
   326 01  WS-CM-KEY-A4.
   327     05  WS-CM-COMPANY-CD-A4     PIC X.
   328     05  WS-CM-CERT-NO-A4        PIC X(11).
   329 01  WS-CID-NO                   PIC X(8).
   330 01  WS-DISP-RESP                PIC 9(5).
   331 01  WS-RESPONSE                 PIC S9(8)   COMP.
   332     88  RESP-NORMAL                  VALUE +00.
   333     88  RESP-NOTFND                  VALUE +13.
   334     88  RESP-DUPKEY                  VALUE +15.
   335     88  RESP-NOTOPEN                 VALUE +19.
   336     88  RESP-ENDFILE                 VALUE +20.
   337*                                 COPY ELCCERT.
   338******************************************************************
   339*                                                                *
   340*                            ELCCERT.                            *
   341*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   342*                            VMOD=2.013                          *
   343*                                                                *
   344*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   345*                                                                *
   346*   FILE TYPE = VSAM,KSDS                                        *
   347*   RECORD SIZE = 450  RECFORM = FIXED                           *
   348*                                                                *
   349*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   350*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   351*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   352*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   353*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   354*                                                                *
   355*   LOG = YES                                                    *
   356*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   357******************************************************************
   358*                   C H A N G E   L O G
   359*
   360* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   361*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   8
* SOCK03.cbl
   362*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   363* EFFECTIVE    NUMBER
   364*-----------------------------------------------------------------
   365* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   366* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   367* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   368* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   369* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   370* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   371* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   372* 032612  CR2011110200001  PEMA  AHL CHANGES
   373* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   374* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   375* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   376******************************************************************
   377
   378 01  CERTIFICATE-MASTER.
   379     12  CM-RECORD-ID                      PIC XX.
   380         88  VALID-CM-ID                      VALUE 'CM'.
   381
   382     12  CM-CONTROL-PRIMARY.
   383         16  CM-COMPANY-CD                 PIC X.
   384         16  CM-CARRIER                    PIC X.
   385         16  CM-GROUPING.
   386             20  CM-GROUPING-PREFIX        PIC X(3).
   387             20  CM-GROUPING-PRIME         PIC X(3).
   388         16  CM-STATE                      PIC XX.
   389         16  CM-ACCOUNT.
   390             20  CM-ACCOUNT-PREFIX         PIC X(4).
   391             20  CM-ACCOUNT-PRIME          PIC X(6).
   392         16  CM-CERT-EFF-DT                PIC XX.
   393         16  CM-CERT-NO.
   394             20  CM-CERT-PRIME             PIC X(10).
   395             20  CM-CERT-SFX               PIC X.
   396
   397     12  CM-CONTROL-BY-NAME.
   398         16  CM-COMPANY-CD-A1              PIC X.
   399         16  CM-INSURED-LAST-NAME          PIC X(15).
   400         16  CM-INSURED-INITIALS.
   401             20  CM-INSURED-INITIAL1       PIC X.
   402             20  CM-INSURED-INITIAL2       PIC X.
   403
   404     12  CM-CONTROL-BY-SSN.
   405         16  CM-COMPANY-CD-A2              PIC X.
   406         16  CM-SOC-SEC-NO.
   407             20  CM-SSN-STATE              PIC XX.
   408             20  CM-SSN-ACCOUNT            PIC X(6).
   409             20  CM-SSN-LN3.
   410                 25  CM-INSURED-INITIALS-A2.
   411                     30 CM-INSURED-INITIAL1-A2   PIC X.
   412                     30 CM-INSURED-INITIAL2-A2   PIC X.
   413                 25 CM-PART-LAST-NAME-A2         PIC X.
   414
   415     12  CM-CONTROL-BY-CERT-NO.
   416         16  CM-COMPANY-CD-A4              PIC X.
   417         16  CM-CERT-NO-A4                 PIC X(11).
   418
   419     12  CM-CONTROL-BY-MEMB.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page   9
* SOCK03.cbl
   420         16  CM-COMPANY-CD-A5              PIC X.
   421         16  CM-MEMBER-NO.
   422             20  CM-MEMB-STATE             PIC XX.
   423             20  CM-MEMB-ACCOUNT           PIC X(6).
   424             20  CM-MEMB-LN4.
   425                 25  CM-INSURED-INITIALS-A5.
   426                     30 CM-INSURED-INITIAL1-A5   PIC X.
   427                     30 CM-INSURED-INITIAL2-A5   PIC X.
   428                 25 CM-PART-LAST-NAME-A5         PIC XX.
   429
   430     12  CM-INSURED-PROFILE-DATA.
   431         16  CM-INSURED-FIRST-NAME.
   432             20  CM-INSURED-1ST-INIT       PIC X.
   433             20  FILLER                    PIC X(9).
   434         16  CM-INSURED-ISSUE-AGE          PIC 99.
   435         16  CM-INSURED-SEX                PIC X.
   436             88  CM-SEX-MALE                  VALUE 'M'.
   437             88  CM-SEX-FEMAL                 VALUE 'F'.
   438         16  CM-INSURED-JOINT-AGE          PIC 99.
   439         16  CM-JOINT-INSURED-NAME.
   440             20  CM-JT-LAST-NAME           PIC X(15).
   441             20  CM-JT-FIRST-NAME.
   442                 24  CM-JT-1ST-INIT        PIC X.
   443                 24  FILLER                PIC X(9).
   444             20  CM-JT-INITIAL             PIC X.
   445
   446     12  CM-LIFE-DATA.
   447         16  CM-LF-BENEFIT-CD              PIC XX.
   448         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   449         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   450         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   451         16  CM-LF-DEV-CODE                PIC XXX.
   452         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   453         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   454         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   455         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   456         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   457         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   458         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   459         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   460         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   461         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   462         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   463         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   464         16  cm-temp-epiq                  pic xx.
   465             88  EPIQ-CLASS                  value 'EQ'.
   466*        16  FILLER                        PIC XX.
   467
   468     12  CM-AH-DATA.
   469         16  CM-AH-BENEFIT-CD              PIC XX.
   470         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   471         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   472         16  CM-AH-DEV-CODE                PIC XXX.
   473         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   474         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   475         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   476         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   477         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  10
* SOCK03.cbl
   478         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   479         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   480         16  CM-AH-PAID-THRU-DT            PIC XX.
   481             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   482         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   483         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   484         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   485         16  FILLER                        PIC X.
   486
   487     12  CM-LOAN-INFORMATION.
   488         16  CM-LIVES                      PIC S9(7)     COMP-3.
   489         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   490                                           PIC S9(5)V99  COMP-3.
   491         16  CM-BILLED                     PIC S9(7)     COMP-3.
   492         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   493         16  CM-PAY-FREQUENCY              PIC S99.
   494         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   495         16  CM-RATE-CLASS                 PIC XX.
   496         16  CM-BENEFICIARY                PIC X(25).
   497         16  CM-POLICY-FORM-NO             PIC X(12).
   498         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   499         16  CM-LAST-ADD-ON-DT             PIC XX.
   500         16  CM-DEDUCTIBLE-AMOUNTS.
   501             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   502             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   503         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   504             20  CM-RESIDENT-STATE         PIC XX.
   505             20  CM-RATE-CODE              PIC X(4).
   506             20  FILLER                    PIC XX.
   507         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   508             20  CM-LOAN-OFFICER           PIC X(5).
   509             20  FILLER                    PIC XXX.
   510         16  CM-CSR-CODE                   PIC XXX.
   511         16  CM-UNDERWRITING-CODE          PIC X.
   512             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   513         16  CM-POST-CARD-IND              PIC X.
   514         16  CM-REF-INTERFACE-SW           PIC X.
   515         16  CM-PREMIUM-TYPE               PIC X.
   516             88  CM-SING-PRM                  VALUE '1'.
   517             88  CM-O-B-COVERAGE              VALUE '2'.
   518             88  CM-OPEN-END                  VALUE '3'.
   519         16  CM-IND-GRP-TYPE               PIC X.
   520             88  CM-INDIVIDUAL                VALUE 'I'.
   521             88  CM-GROUP                     VALUE 'G'.
   522         16  CM-SKIP-CODE                  PIC X.
   523             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   524             88  SKIP-JULY                    VALUE '1'.
   525             88  SKIP-AUGUST                  VALUE '2'.
   526             88  SKIP-SEPTEMBER               VALUE '3'.
   527             88  SKIP-JULY-AUG                VALUE '4'.
   528             88  SKIP-AUG-SEPT                VALUE '5'.
   529             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   530             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   531             88  SKIP-JUNE                    VALUE '8'.
   532             88  SKIP-JUNE-JULY               VALUE '9'.
   533             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   534             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   535         16  CM-PAYMENT-MODE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  11
* SOCK03.cbl
   536             88  PAY-MONTHLY                  VALUE SPACE.
   537             88  PAY-WEEKLY                   VALUE '1'.
   538             88  PAY-SEMI-MONTHLY             VALUE '2'.
   539             88  PAY-BI-WEEKLY                VALUE '3'.
   540             88  PAY-SEMI-ANUALLY             VALUE '4'.
   541         16  CM-LOAN-NUMBER                PIC X(8).
   542         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   543         16  CM-OLD-LOF                    PIC XXX.
   544*        16  CM-LOAN-OFFICER               PIC XXX.
   545         16  CM-REIN-TABLE                 PIC XXX.
   546         16  CM-SPECIAL-REIN-CODE          PIC X.
   547         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   548         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   549         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   550
   551     12  CM-STATUS-DATA.
   552         16  CM-ENTRY-STATUS               PIC X.
   553         16  CM-ENTRY-DT                   PIC XX.
   554
   555         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   556         16  CM-LF-CANCEL-DT               PIC XX.
   557         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   558
   559         16  CM-LF-STATUS-AT-DEATH         PIC X.
   560         16  CM-LF-DEATH-DT                PIC XX.
   561         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   562
   563         16  CM-LF-CURRENT-STATUS          PIC X.
   564             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   565                                                'M' '4' '5' '9'.
   566             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   567             88  CM-LF-POLICY-PENDING         VALUE '2'.
   568             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   569             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   570             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   571             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   572             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   573             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   574             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   575             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   576             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   577             88  CM-LF-DECLINED               VALUE 'D'.
   578             88  CM-LF-VOIDED                 VALUE 'V'.
   579
   580         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   581         16  CM-AH-CANCEL-DT               PIC XX.
   582         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   583
   584         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   585         16  CM-AH-SETTLEMENT-DT           PIC XX.
   586         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   587
   588         16  CM-AH-CURRENT-STATUS          PIC X.
   589             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   590                                                'M' '4' '5' '9'.
   591             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   592             88  CM-AH-POLICY-PENDING         VALUE '2'.
   593             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  12
* SOCK03.cbl
   594             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   595             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   596             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   597             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   598             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   599             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   600             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   601             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   602             88  CM-AH-DECLINED               VALUE 'D'.
   603             88  CM-AH-VOIDED                 VALUE 'V'.
   604
   605         16  CM-CLAIM-INTERFACE-SW         PIC X.
   606             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   607             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   608             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   609         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   610
   611         16  CM-ENTRY-BATCH                PIC X(6).
   612         16  CM-LF-EXIT-BATCH              PIC X(6).
   613         16  CM-AH-EXIT-BATCH              PIC X(6).
   614         16  CM-LAST-MONTH-END             PIC XX.
   615
   616     12  CM-NOTE-SW                        PIC X.
   617         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   618         88  CERT-NOTES-PRESENT               VALUE '1'.
   619         88  BILLING-NOTES-PRESENT            VALUE '2'.
   620         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   621         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   622         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   623         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   624         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   625     12  CM-COMP-EXCP-SW                   PIC X.
   626         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   627         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   628     12  CM-INSURED-ADDRESS-SW             PIC X.
   629         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   630         88  INSURED-ADDR-PRESENT             VALUE '1'.
   631
   632*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   633     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   634     12  FILLER                            PIC X.
   635
   636*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   637     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   638     12  FILLER                            PIC X.
   639*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   640     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   641
   642     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   643         88  CERT-ADDED-BATCH                 VALUE ' '.
   644         88  CERT-ADDED-ONLINE                VALUE '1'.
   645         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   646         88  CERT-PURGED-OFFLINE              VALUE '3'.
   647         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   648     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   649         88  CERT-AS-LOADED                   VALUE ' '.
   650         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   651         88  CERT-CLAIM-ONLINE                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  13
* SOCK03.cbl
   652         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   653         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   654         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   655         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   656         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   657
   658     12  CM-ACCOUNT-COMM-PCTS.
   659         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   660         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   661
   662     12  CM-USER-FIELD                     PIC X.
   663     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   664     12  CM-CLP-STATE                      PIC XX.
   665     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   666     12  CM-USER-RESERVED                  PIC XXX.
   667     12  FILLER REDEFINES CM-USER-RESERVED.
   668         16  CM-AH-CLASS-CD                PIC XX.
   669         16  F                             PIC X.
   670******************************************************************
   671*                                 COPY ELCMSTR.
   672******************************************************************
   673*                                                                *
   674*                            ELCMSTR.                            *
   675*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   676*                            VMOD=2.012                          *
   677*                                                                *
   678*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   679*                                                                *
   680*   FILE TYPE = VSAM,KSDS                                        *
   681*   RECORD SIZE = 350  RECFORM = FIXED                           *
   682*                                                                *
   683*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   684*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   685*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   686*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   687*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   688*                                                 RKP=75,LEN=21  *
   689*                                                                *
   690*   **** NOTE ****                                               *
   691*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   692*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   693*                                                                *
   694*   LOG = YES                                                    *
   695*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   696******************************************************************
   697*                   C H A N G E   L O G
   698*
   699* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   700*-----------------------------------------------------------------
   701*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   702* EFFECTIVE    NUMBER
   703*-----------------------------------------------------------------
   704* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   705* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   706* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
   707* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   708* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   709* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  14
* SOCK03.cbl
   710* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   711******************************************************************
   712 01  CLAIM-MASTER.
   713     12  CL-RECORD-ID                PIC XX.
   714         88  VALID-CL-ID         VALUE 'CL'.
   715
   716     12  CL-CONTROL-PRIMARY.
   717         16  CL-COMPANY-CD           PIC X.
   718         16  CL-CARRIER              PIC X.
   719         16  CL-CLAIM-NO             PIC X(7).
   720         16  CL-CERT-NO.
   721             20  CL-CERT-PRIME       PIC X(10).
   722             20  CL-CERT-SFX         PIC X.
   723
   724     12  CL-CONTROL-BY-NAME.
   725         16  CL-COMPANY-CD-A1        PIC X.
   726         16  CL-INSURED-LAST-NAME    PIC X(15).
   727         16  CL-INSURED-NAME.
   728             20  CL-INSURED-1ST-NAME PIC X(12).
   729             20  CL-INSURED-MID-INIT PIC X.
   730
   731     12  CL-CONTROL-BY-SSN.
   732         16  CL-COMPANY-CD-A2        PIC X.
   733         16  CL-SOC-SEC-NO.
   734             20  CL-SSN-STATE        PIC XX.
   735             20  CL-SSN-ACCOUNT      PIC X(6).
   736             20  CL-SSN-LN3          PIC X(3).
   737
   738     12  CL-CONTROL-BY-CERT-NO.
   739         16  CL-COMPANY-CD-A4        PIC X.
   740         16  CL-CERT-NO-A4.
   741             20  CL-CERT-A4-PRIME    PIC X(10).
   742             20  CL-CERT-A4-SFX      PIC X.
   743
   744     12  CL-CONTROL-BY-CCN.
   745         16  CL-COMPANY-CD-A5        PIC X.
   746         16  CL-CCN-A5.
   747             20  CL-CCN.
   748                 24  CL-CCN-PREFIX-A5 PIC X(4).
   749                 24  CL-CCN-PRIME-A5 PIC X(12).
   750             20  CL-CCN-FILLER-A5    PIC X(4).
   751
   752     12  CL-INSURED-PROFILE-DATA.
   753         16  CL-INSURED-BIRTH-DT     PIC XX.
   754         16  CL-INSURED-SEX-CD       PIC X.
   755             88  INSURED-IS-MALE        VALUE 'M'.
   756             88  INSURED-IS-FEMALE      VALUE 'F'.
   757             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   758         16  CL-INSURED-OCC-CD       PIC X(6).
   759         16  FILLER                  PIC X(5).
   760
   761     12  CL-PROCESSING-INFO.
   762         16  CL-PROCESSOR-ID         PIC X(4).
   763         16  CL-CLAIM-STATUS         PIC X.
   764             88  CLAIM-IS-OPEN          VALUE 'O'.
   765             88  CLAIM-IS-CLOSED        VALUE 'C'.
   766         16  CL-CLAIM-TYPE           PIC X.
   767*            88  AH-CLAIM               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  15
* SOCK03.cbl
   768*            88  LIFE-CLAIM             VALUE 'L'.
   769*            88  PROPERTY-CLAIM         VALUE 'P'.
   770*            88  IUI-CLAIM              VALUE 'I'.
   771*            88  GAP-CLAIM              VALUE 'G'.
   772*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
   773*            88  OTHER-CLAIM            VALUE 'O'.
   774         16  CL-CLAIM-PREM-TYPE      PIC X.
   775             88  SINGLE-PREMIUM         VALUE '1'.
   776             88  O-B-COVERAGE           VALUE '2'.
   777             88  OPEN-END-COVERAGE      VALUE '3'.
   778         16  CL-INCURRED-DT          PIC XX.
   779         16  CL-REPORTED-DT          PIC XX.
   780         16  CL-FILE-ESTABLISH-DT    PIC XX.
   781         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   782         16  CL-LAST-PMT-DT          PIC XX.
   783         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   784         16  CL-PAID-THRU-DT         PIC XX.
   785         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   786         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   787         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   788         16  CL-PMT-CALC-METHOD      PIC X.
   789             88  CL-360-DAY-YR          VALUE '1'.
   790             88  CL-365-DAY-YR          VALUE '2'.
   791             88  CL-FULL-MONTHS         VALUE '3'.
   792         16  CL-CAUSE-CD             PIC X(6).
   793
   794         16  CL-PRIME-CERT-NO.
   795             20  CL-PRIME-CERT-PRIME PIC X(10).
   796             20  CL-PRIME-CERT-SFX   PIC X.
   797
   798         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   799             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   800             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   801
   802         16  CL-MICROFILM-NO         PIC X(10).
   803         16  FILLER REDEFINES CL-MICROFILM-NO.
   804             20  CL-BENEFIT-PERIOD   PIC 99.
   805             20  FILLER              PIC X(8).
   806         16  CL-PROG-FORM-TYPE       PIC X.
   807         16  CL-LAST-ADD-ON-DT       PIC XX.
   808
   809         16  CL-LAST-REOPEN-DT       PIC XX.
   810         16  CL-LAST-CLOSE-DT        PIC XX.
   811         16  CL-LAST-CLOSE-REASON    PIC X(01).
   812             88  FINAL-PAID             VALUE '1'.
   813             88  CLAIM-DENIED           VALUE '2'.
   814             88  AUTO-CLOSE             VALUE '3'.
   815             88  MANUAL-CLOSE           VALUE '4'.
   816             88  BENEFITS-CHANGED       VALUE 'C'.
   817             88  SETUP-ERRORS           VALUE 'E'.
   818         16  CL-ASSOC-CERT-SEQU      PIC S99.
   819         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   820         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   821             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   822         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   823         16  FILLER                  PIC X.
   824
   825     12  CL-CERTIFICATE-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  16
* SOCK03.cbl
   826         16  CL-CERT-ORIGIN          PIC X.
   827             88  CERT-WAS-ONLINE        VALUE '1'.
   828             88  CERT-WAS-CREATED       VALUE '2'.
   829             88  COVERAGE-WAS-ADDED     VALUE '3'.
   830         16  CL-CERT-KEY-DATA.
   831             20  CL-CERT-CARRIER     PIC X.
   832             20  CL-CERT-GROUPING    PIC X(6).
   833             20  CL-CERT-STATE       PIC XX.
   834             20  CL-CERT-ACCOUNT.
   835                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   836                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   837             20  CL-CERT-EFF-DT      PIC XX.
   838
   839     12  CL-STATUS-CONTROLS.
   840         16  CL-PRIORITY-CD          PIC X.
   841             88  CONFIDENTIAL-DATA      VALUE '8'.
   842             88  HIGHEST-PRIORITY       VALUE '9'.
   843         16  CL-SUPV-ATTN-CD         PIC X.
   844             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   845             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   846         16  CL-PURGED-DT            PIC XX.
   847         16  CL-RESTORED-DT          PIC XX.
   848         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   849         16  CL-NEXT-RESEND-DT       PIC XX.
   850         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   851         16  CL-CRITICAL-PERIOD      PIC 99.
   852*        16  FILLER                  PIC XX.
   853         16  CL-LAST-MAINT-DT        PIC XX.
   854         16  CL-LAST-MAINT-USER      PIC X(4).
   855         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   856         16  CL-LAST-MAINT-TYPE      PIC X.
   857             88  CLAIM-SET-UP           VALUE ' '.
   858             88  PAYMENT-MADE           VALUE '1'.
   859             88  LETTER-SENT            VALUE '2'.
   860             88  MASTER-WAS-ALTERED     VALUE '3'.
   861             88  MASTER-WAS-RESTORED    VALUE '4'.
   862             88  INCURRED-DATE-CHANGED  VALUE '5'.
   863             88  FILE-CONVERTED         VALUE '6'.
   864             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   865             88  ERROR-CORRECTION       VALUE 'E'.
   866         16  CL-RELATED-CLAIM-NO     PIC X(7).
   867         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   868         16  CL-BENEFICIARY          PIC X(10).
   869         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   870         16  CL-DENIAL-TYPE          PIC X.
   871             88  CL-TYPE-DENIAL          VALUE '1'.
   872             88  CL-TYPE-RESCISSION      VALUE '2'.
   873             88  CL-TYPE-REFORMATION     VALUE '3'.
   874             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   875             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   876         16  CL-NO-OF-EXTENSIONS     PIC 99.
   877         16  filler                  pic x(3).
   878*        16  CL-CRIT-PER-RECURRENT   PIC X.
   879*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
   880*        16  CL-RTW-DT               PIC XX.
   881
   882     12  CL-TRAILER-CONTROLS.
   883         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  17
* SOCK03.cbl
   884             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   885             88  CL-LAST-TRL-AVAIL      VALUE +100.
   886             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   887         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   888         16  FILLER                  PIC XX.
   889         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   890         16  CL-ADDRESS-TRAILER-CNT.
   891             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   892                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   893             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   894                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   895             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   896                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   897             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   898                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   899             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   900                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   901             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   902                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   903             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   904                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   905
   906     12  CL-CV-REFERENCE-NO.
   907         16  CL-CV-REFNO-PRIME       PIC X(18).
   908         16  CL-CV-REFNO-SFX         PIC XX.
   909
   910     12  CL-FILE-LOCATION            PIC X(4).
   911
   912     12  CL-PROCESS-ERRORS.
   913         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   914             88  NO-FATAL-ERRORS        VALUE ZERO.
   915         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   916             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   917
   918     12  CL-PRODUCT-CD               PIC X.
   919
   920     12  CL-CURRENT-KEY-DATA.
   921         16  CL-CURRENT-CARRIER      PIC X.
   922         16  CL-CURRENT-GROUPING     PIC X(6).
   923         16  CL-CURRENT-STATE        PIC XX.
   924         16  CL-CURRENT-ACCOUNT      PIC X(10).
   925
   926     12  CL-ASSOCIATES               PIC X.
   927         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   928         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   929         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   930         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   931
   932     12  CL-ACTIVITY-CODE            PIC 99.
   933     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   934     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   935
   936     12  CL-LAPSE-REPORT-CODE        PIC 9.
   937     12  CL-LAG-REPORT-CODE          PIC 9.
   938     12  CL-LOAN-TYPE                PIC XX.
   939     12  CL-LEGAL-STATE              PIC XX.
   940
   941     12  CL-YESNOSW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  18
* SOCK03.cbl
   942     12  CL-ACCIDENT-CLAIM-SW        PIC X.
   943         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
   944         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
   945         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
   946     12  cl-insured-type             pic x.
   947         88  cl-claim-on-primary         value 'P'.
   948         88  cl-claim-on-co-borrower     value 'C'.
   949     12  cl-benefit-expiration-dt    PIC XX.
   950*                                 COPY ERCPDEF.
   951******************************************************************
   952*                                                                *
   953*                                                                *
   954*                            ERCPDEF.                            *
   955*                                                                *
   956*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   957*                                                                *
   958*    FILE TYPE = VSAM,KSDS                                       *
   959*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   960*                                                                *
   961*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   962*                                                                *
   963*    LOG = YES                                                   *
   964*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   965******************************************************************
   966*                   C H A N G E   L O G
   967*
   968* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   969*-----------------------------------------------------------------
   970*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   971* EFFECTIVE    NUMBER
   972*-----------------------------------------------------------------
   973* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   974* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   975* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   976* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   977******************************************************************
   978 01  PRODUCT-MASTER.
   979    12  PD-RECORD-ID                 PIC X(02).
   980        88  VALID-PD-ID                  VALUE 'PD'.
   981    12  PD-CONTROL-PRIMARY.
   982        16  PD-COMPANY-CD            PIC X.
   983        16  PD-STATE                 PIC XX.
   984        16  PD-PRODUCT-CD            PIC XXX.
   985        16  PD-FILLER                PIC X(7).
   986        16  PD-BEN-TYPE              PIC X.
   987        16  PD-BEN-CODE              PIC XX.
   988        16  PD-PROD-EXP-DT           PIC XX.
   989    12  FILLER                       PIC X(50).
   990    12  PD-PRODUCT-DATA OCCURS 8.
   991        16  PD-PROD-CODE             PIC X.
   992            88  PD-PROD-LIFE           VALUE 'L'.
   993            88  PD-PROD-PROP           VALUE 'P'.
   994            88  PD-PROD-AH             VALUE 'A'.
   995            88  PD-PROD-IU             VALUE 'I'.
   996            88  PD-PROD-GAP            VALUE 'G'.
   997            88  PD-PROD-FAML           VALUE 'F'.
   998            88  PD-PROD-OTH            VALUE 'O'.
   999        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  19
* SOCK03.cbl
  1000        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  1001        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  1002        16  PD-MAX-TERM              PIC S999        COMP-3.
  1003        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  1004        16  FILLER                   PIC X.
  1005        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  1006        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  1007        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  1008        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  1009        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  1010        16  PD-REC-CRIT-PERIOD       PIC 99.
  1011        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  1012            20  PD-RECURRING-YN      PIC X.
  1013            20  FILLER               PIC X.
  1014        16  PD-RTW-MOS               PIC 99.
  1015        16  PD-MAX-EXTENSION         PIC 99.
  1016        16  pd-ben-pct               pic sv999 comp-3.
  1017*       16  FILLER                   PIC XX.
  1018    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  1019    12  PD-TERM-LIMITS OCCURS 15.
  1020        16  PD-LOW-TERM              PIC S999        COMP-3.
  1021        16  PD-HI-TERM               PIC S999        COMP-3.
  1022*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  1023    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  1024        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  1025        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  1026    12  PD-EARN-FACTORS.
  1027        16  FILLER OCCURS 15.
  1028            20  FILLER OCCURS 15.
  1029                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  1030    12  PD-PRODUCT-DESC              PIC X(80).
  1031    12  PD-TRUNCATED                 PIC X.
  1032    12  FILLER                       PIC X(59).
  1033    12  PD-MAINT-INFORMATION.
  1034        16  PD-LAST-MAINT-DT         PIC X(02).
  1035        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  1036        16  PD-LAST-MAINT-BY         PIC X(04).
  1037*                                 COPY ERCCTBL.
  1038******************************************************************
  1039*                                                                *
  1040*                                                                *
  1041*                            ERCCTBL                             *
  1042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1043*                            VMOD=2.003
  1044*                                                                *
  1045*   ONLINE CREDIT SYSTEM                                         *
  1046*                                                                *
  1047*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  1048*                                                                *
  1049*   FILE TYPE = VSAM,KSDS                                        *
  1050*   RECORD SIZE = 200   RECFORM = FIXED                          *
  1051*                                                                *
  1052*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  1053*       ALTERNATE PATH = NONE                                    *
  1054*                                                                *
  1055*   LOG = NO                                                     *
  1056*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  20
* SOCK03.cbl
  1058*                                                                *
  1059******************************************************************
  1060
  1061 01  COMM-TABLE-RECORD.
  1062     12  CT-RECORD-ID                      PIC XX.
  1063         88  VALID-CT-ID                      VALUE 'CT'.
  1064
  1065     12  CT-CONTROL-PRIMARY.
  1066         16  CT-COMPANY-CD                 PIC X.
  1067         16  CT-TABLE                      PIC XXX.
  1068         16  CT-CNTRL-2.
  1069             20  CT-BEN-TYPE               PIC X.
  1070             20  CT-BEN-CODE               PIC XX.
  1071
  1072     12  CT-MAINT-INFORMATION.
  1073         16  CT-LAST-MAINT-DT              PIC XX.
  1074         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1075         16  CT-LAST-MAINT-USER            PIC X(4).
  1076         16  FILLER                        PIC X(31).
  1077
  1078     12  CT-LIMITS.
  1079         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  1080
  1081         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  1082
  1083         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  1084
  1085     12  CT-RATES.
  1086         16  CT-RTX          OCCURS 27 TIMES.
  1087             20  CT-RT                     PIC SV9(5)     COMP-3.
  1088             20  CT-RT-R   REDEFINES
  1089                 CT-RT                     PIC XXX.
  1090
  1091     12  FILLER                            PIC  X(42).
  1092
  1093******************************************************************
  1094*                                 COPY ELCCNTL.
  1095******************************************************************
  1096*                                                                *
  1097*                                                                *
  1098*                            ELCCNTL.                            *
  1099*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1100*                            VMOD=2.059                          *
  1101*                                                                *
  1102*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1103*                                                                *
  1104*   FILE TYPE = VSAM,KSDS                                        *
  1105*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1106*                                                                *
  1107*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1108*       ALTERNATE INDEX = NONE                                   *
  1109*                                                                *
  1110*   LOG = YES                                                    *
  1111*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1112******************************************************************
  1113*                   C H A N G E   L O G
  1114*
  1115* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  21
* SOCK03.cbl
  1116*-----------------------------------------------------------------
  1117*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1118* EFFECTIVE    NUMBER
  1119*-----------------------------------------------------------------
  1120* 082503                   PEMA  ADD BENEFIT GROUP
  1121* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1122* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1123* 092705    2005050300006  PEMA  ADD SPP LEASES
  1124* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1125* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1126* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1127* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1128* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1129* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1130* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1131* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1132* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1133* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1134* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1135******************************************************************
  1136*
  1137 01  CONTROL-FILE.
  1138     12  CF-RECORD-ID                       PIC XX.
  1139         88  VALID-CF-ID                        VALUE 'CF'.
  1140
  1141     12  CF-CONTROL-PRIMARY.
  1142         16  CF-COMPANY-ID                  PIC XXX.
  1143         16  CF-RECORD-TYPE                 PIC X.
  1144             88  CF-COMPANY-MASTER              VALUE '1'.
  1145             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1146             88  CF-STATE-MASTER                VALUE '3'.
  1147             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1148             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1149             88  CF-CARRIER-MASTER              VALUE '6'.
  1150             88  CF-MORTALITY-MASTER            VALUE '7'.
  1151             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1152             88  CF-TERMINAL-MASTER             VALUE '9'.
  1153             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1154             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1155             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1156             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1157             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1158             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1159             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1160             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1161             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1162         16  CF-ACCESS-CD-GENL              PIC X(4).
  1163         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1164             20  CF-PROCESSOR               PIC X(4).
  1165         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1166             20  CF-STATE-CODE              PIC XX.
  1167             20  FILLER                     PIC XX.
  1168         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1169             20  FILLER                     PIC XX.
  1170             20  CF-HI-BEN-IN-REC           PIC XX.
  1171         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1172             20  FILLER                     PIC XXX.
  1173             20  CF-CARRIER-CNTL            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  22
* SOCK03.cbl
  1174         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1175             20  FILLER                     PIC XX.
  1176             20  CF-HI-TYPE-IN-REC          PIC 99.
  1177         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1178             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1179                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1180             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1181             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1182         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1183             20  FILLER                     PIC X.
  1184             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1185         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1186             20  FILLER                     PIC XX.
  1187             20  CF-MORTGAGE-PLAN           PIC XX.
  1188         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1189
  1190     12  CF-LAST-MAINT-DT                   PIC XX.
  1191     12  CF-LAST-MAINT-BY                   PIC X(4).
  1192     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1193
  1194     12  CF-RECORD-BODY                     PIC X(728).
  1195
  1196
  1197****************************************************************
  1198*             COMPANY MASTER RECORD                            *
  1199****************************************************************
  1200
  1201     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1202         16  CF-COMPANY-ADDRESS.
  1203             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1204             20  CF-CL-IN-CARE-OF           PIC X(30).
  1205             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1206             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1207             20  CF-CL-CITY-STATE           PIC X(30).
  1208             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1209             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1210         16  CF-COMPANY-CD                  PIC X.
  1211         16  CF-COMPANY-PASSWORD            PIC X(8).
  1212         16  CF-SECURITY-OPTION             PIC X.
  1213             88  ALL-SECURITY                   VALUE '1'.
  1214             88  COMPANY-VERIFY                 VALUE '2'.
  1215             88  PROCESSOR-VERIFY               VALUE '3'.
  1216             88  NO-SECURITY                    VALUE '4'.
  1217             88  ALL-BUT-TERM                   VALUE '5'.
  1218         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1219             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1220         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1221             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1222         16  CF-INFORCE-LOCATION            PIC X.
  1223             88  CERTS-ARE-ONLINE               VALUE '1'.
  1224             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1225             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1226         16  CF-LOWER-CASE-LETTERS          PIC X.
  1227         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1228             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1229             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1230             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1231             88  CF-ACCNT-CNTL                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  23
* SOCK03.cbl
  1232             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1233
  1234         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1235         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1236
  1237         16  CF-LGX-CREDIT-USER             PIC X.
  1238             88  CO-IS-NOT-USER                 VALUE 'N'.
  1239             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1240
  1241         16 CF-CREDIT-CALC-CODES.
  1242             20  CF-CR-REM-TERM-CALC PIC X.
  1243               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1244               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1245               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1246               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1247               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1248               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1249               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1250             20  CF-CR-R78-METHOD           PIC X.
  1251               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1252               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1253
  1254         16  CF-CLAIM-CONTROL-COUNTS.
  1255             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1256                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1257
  1258             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1259                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1260
  1261             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1262                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1263
  1264             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1265                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1266
  1267         16  CF-CURRENT-MONTH-END           PIC XX.
  1268
  1269         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1270             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1271             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1272             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1273             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1274                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1275                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1276             20  CF-CO-PREM-REJECT-SW       PIC X.
  1277                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1278                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1279             20  CF-CO-REF-REJECT-SW        PIC X.
  1280                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1281                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1282
  1283         16  CF-CO-REPORTING-DT             PIC XX.
  1284         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1285         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1286           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1287           88  CF-CO-MONTH-END                  VALUE '1'.
  1288
  1289         16  CF-LGX-CLAIM-USER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  24
* SOCK03.cbl
  1290             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1291             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1292
  1293         16  CF-CREDIT-EDIT-CONTROLS.
  1294             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1295             20  CF-MIN-AGE                 PIC 99.
  1296             20  CF-DEFAULT-AGE             PIC 99.
  1297             20  CF-MIN-TERM                PIC S999      COMP-3.
  1298             20  CF-MAX-TERM                PIC S999      COMP-3.
  1299             20  CF-DEFAULT-SEX             PIC X.
  1300             20  CF-JOINT-AGE-INPUT         PIC X.
  1301                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1302             20  CF-BIRTH-DATE-INPUT        PIC X.
  1303                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1304             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1305                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1306                 88  CF-ZERO-CARRIER            VALUE '1'.
  1307                 88  CF-ZERO-GROUPING           VALUE '2'.
  1308                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1309             20  CF-EDIT-SW                 PIC X.
  1310                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1311             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1312             20  CF-CR-PR-METHOD            PIC X.
  1313               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1314               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1315             20  FILLER                     PIC X.
  1316
  1317         16  CF-CREDIT-MISC-CONTROLS.
  1318             20  CF-REIN-TABLE-SW           PIC X.
  1319                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1320             20  CF-COMP-TABLE-SW           PIC X.
  1321                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1322             20  CF-EXPERIENCE-RETENTION-AGE
  1323                                            PIC S9        COMP-3.
  1324             20  CF-CONVERSION-DT           PIC XX.
  1325             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1326             20  CF-RUN-FREQUENCY-SW        PIC X.
  1327                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1328                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1329
  1330             20  CF-CR-CHECK-NO-CONTROL.
  1331                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1332                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1333                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1334                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1335                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1336                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1337
  1338                 24  CF-CR-CHECK-COUNT       REDEFINES
  1339                     CF-CR-CHECK-COUNTER      PIC X(4).
  1340
  1341                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1342                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1343
  1344                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1345                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1346                 24  CF-MAIL-PROCESSING       PIC X.
  1347                     88  MAIL-PROCESSING          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  25
* SOCK03.cbl
  1348
  1349         16  CF-MISC-SYSTEM-CONTROL.
  1350             20  CF-SYSTEM-C                 PIC X.
  1351                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1352             20  CF-SYSTEM-D                 PIC X.
  1353                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1354             20  CF-SOC-SEC-NO-SW            PIC X.
  1355                 88  SOC-SEC-NO-USED             VALUE '1'.
  1356             20  CF-MEMBER-NO-SW             PIC X.
  1357                 88  MEMBER-NO-USED              VALUE '1'.
  1358             20  CF-TAX-ID-NUMBER            PIC X(11).
  1359             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1360             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1361                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1362                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1363                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1364                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1365             20  CF-SYSTEM-E                 PIC X.
  1366                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1367
  1368         16  CF-LGX-LIFE-USER               PIC X.
  1369             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1370             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1371
  1372         16  CF-CR-MONTH-END-DT             PIC XX.
  1373
  1374         16  CF-FILE-MAINT-DATES.
  1375             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1376                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1377             20  CF-LAST-BATCH       REDEFINES
  1378                 CF-LAST-BATCH-NO               PIC X(4).
  1379             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1380             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1381             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1382             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1383             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1384             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1385             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1386             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1387             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1388             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1389
  1390         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1391         16  FILLER                         PIC X.
  1392
  1393         16  CF-ALT-MORT-CODE               PIC X(4).
  1394         16  CF-MEMBER-CAPTION              PIC X(10).
  1395
  1396         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1397             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1398             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1399             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1400             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1401             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1402
  1403         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1404
  1405         16  CF-LIFE-OVERRIDE-L1            PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  26
* SOCK03.cbl
  1406         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1407         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1408         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1409
  1410         16  CF-AH-OVERRIDE-L1              PIC X.
  1411         16  CF-AH-OVERRIDE-L2              PIC XX.
  1412         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1413         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1414
  1415         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1416         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1417
  1418         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1419         16  CF-AR-LAST-EL860-DT            PIC XX.
  1420         16  CF-MP-MONTH-END-DT             PIC XX.
  1421
  1422         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1423         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1424             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1425
  1426         16  CF-AR-MONTH-END-DT             PIC XX.
  1427
  1428         16  CF-CRDTCRD-USER                PIC X.
  1429             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1430             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1431
  1432         16  CF-CC-MONTH-END-DT             PIC XX.
  1433
  1434         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1435
  1436         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1437             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1438             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1439             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1440         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1441         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1442         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1443         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1444             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1445             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1446         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1447         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1448         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1449             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1450         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1451
  1452         16  CF-CL-ZIP-CODE.
  1453             20  CF-CL-ZIP-PRIME.
  1454                 24  CF-CL-ZIP-1ST          PIC X.
  1455                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1456                 24  FILLER                 PIC X(4).
  1457             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1458         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1459             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1460             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1461             20  FILLER                     PIC XXX.
  1462
  1463         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  27
* SOCK03.cbl
  1464         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1465         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1466         16  CF-CO-OPTION-START-DATE        PIC XX.
  1467         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1468           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1469                                                      '3' '4'.
  1470           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1471           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1472           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1473           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1474           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1475           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1476
  1477         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1478
  1479         16  CF-PAYMENT-APPROVAL-LEVELS.
  1480             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1481             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1482             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1483             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1484             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1485             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1486
  1487         16  CF-END-USER-REPORTING-USER     PIC X.
  1488             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1489             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1490
  1491         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1492             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1493             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1494
  1495         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1496
  1497         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1498         16  FILLER                         PIC X.
  1499
  1500         16  CF-CREDIT-ARCHIVE-CNTL.
  1501             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1502             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1503             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1504
  1505         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1506
  1507         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1508             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1509             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1510
  1511         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1512             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1513             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1514
  1515         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1516
  1517         16  CF-CO-ACH-ID-CODE              PIC  X.
  1518             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1519             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1520             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1521         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  28
* SOCK03.cbl
  1522         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1523         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1524         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1525         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1526         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1527         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1528         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1529         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1530                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1531         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1532                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1533
  1534         16  CF-CO-OVER-SHORT.
  1535             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1536             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1537
  1538*         16  FILLER                         PIC X(102).
  1539         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1540             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1541             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1542
  1543         16  CF-AH-APPROVAL-DAYS.
  1544             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1545             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1546             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1547             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1548
  1549         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1550
  1551         16  CF-APPROV-LEV-5.
  1552             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1553             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1554             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1555
  1556         16  FILLER                         PIC X(68).
  1557****************************************************************
  1558*             PROCESSOR/USER RECORD                            *
  1559****************************************************************
  1560
  1561     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1562         16  CF-PROCESSOR-NAME              PIC X(30).
  1563         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1564         16  CF-PROCESSOR-TITLE             PIC X(26).
  1565         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1566                 88  MESSAGE-YES                VALUE 'Y'.
  1567                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1568
  1569*****************************************************
  1570****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1571****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1572****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1573****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1574*****************************************************
  1575
  1576         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1577             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1578             20  CF-APPLICATION-FORCE       PIC X.
  1579             20  CF-INDIVIDUAL-APP.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  29
* SOCK03.cbl
  1580                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1581                     28  CF-BROWSE-APP      PIC X.
  1582                     28  CF-UPDATE-APP      PIC X.
  1583
  1584         16  CF-CURRENT-TERM-ON             PIC X(4).
  1585         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1586             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1587             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1588             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1589             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1590             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1591             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1592             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1593         16  CF-PROCESSOR-CARRIER           PIC X.
  1594             88  NO-CARRIER-SECURITY            VALUE ' '.
  1595         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1596             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1597         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1598             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1599         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1600             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1601
  1602         16  CF-PROC-SYS-ACCESS-SW.
  1603             20  CF-PROC-CREDIT-CLAIMS-SW.
  1604                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1605                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1606                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1607                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1608             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1609                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1610                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1611             20  CF-PROC-LIFE-GNRLDGR-SW.
  1612                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1613                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1614                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1615                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1616             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1617                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1618                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1619         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1620             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1621             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1622         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1623
  1624         16  CF-APPROVAL-LEVEL                  PIC X.
  1625             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1626             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1627             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1628             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1629             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1630
  1631         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1632
  1633         16  CF-LANGUAGE-TYPE                   PIC X.
  1634             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1635             88  CF-LANG-IS-FR                      VALUE 'F'.
  1636
  1637         16  CF-CSR-IND                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  30
* SOCK03.cbl
  1638         16  FILLER                             PIC X(239).
  1639
  1640****************************************************************
  1641*             PROCESSOR/REMINDERS RECORD                       *
  1642****************************************************************
  1643
  1644     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1645         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1646             20  CF-START-REMIND-DT         PIC XX.
  1647             20  CF-END-REMIND-DT           PIC XX.
  1648             20  CF-REMINDER-TEXT           PIC X(50).
  1649         16  FILLER                         PIC X(296).
  1650
  1651
  1652****************************************************************
  1653*             STATE MASTER RECORD                              *
  1654****************************************************************
  1655
  1656     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1657         16  CF-STATE-ABBREVIATION          PIC XX.
  1658         16  CF-STATE-NAME                  PIC X(25).
  1659         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1660         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1661             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1662             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1663             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1664             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1665                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1666                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1667             20  CF-ST-PREM-REJECT-SW       PIC X.
  1668                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1669                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1670             20  CF-ST-REF-REJECT-SW        PIC X.
  1671                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1672                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1673         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1674         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1675         16  CF-ST-REFUND-RULES.
  1676             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1677             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1678             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1679         16  CF-ST-FST-PMT-EXTENSION.
  1680             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1681             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1682                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1683                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1684                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1685                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1686         16  CF-ST-STATE-CALL.
  1687             20  CF-ST-CALL-UNEARNED        PIC X.
  1688             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1689             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1690         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1691             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1692             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1693         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1694         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1695         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  31
* SOCK03.cbl
  1696         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1697         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1698         16  FILLER                         PIC X.
  1699         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1700             20  CF-ST-BENEFIT-CD           PIC XX.
  1701             20  CF-ST-BENEFIT-KIND         PIC X.
  1702                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1703                 88  CF-ST-AH-KIND              VALUE 'A'.
  1704             20  CF-ST-REM-TERM-CALC        PIC X.
  1705                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1706                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1707                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1708                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1709                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1710                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1711                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1712                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1713
  1714             20  CF-ST-REFUND-CALC          PIC X.
  1715                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1716                 88  ST-REFD-BY-R78             VALUE '1'.
  1717                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1718                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1719                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1720                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1721                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1722                 88  ST-REFD-UTAH               VALUE '7'.
  1723                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1724                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1725                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1726
  1727             20  CF-ST-EARNING-CALC         PIC X.
  1728                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1729                 88  ST-EARN-BY-R78             VALUE '1'.
  1730                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1731                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1732                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1733                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1734                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1735                 88  ST-EARN-MEAN               VALUE '8'.
  1736                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1737
  1738             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1739                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1740                 88  ST-OVRD-BY-R78             VALUE '1'.
  1741                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1742                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1743                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1744                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1745                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1746                 88  ST-OVRD-MEAN               VALUE '8'.
  1747                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1748             20  cf-st-extra-periods        pic 9.
  1749*            20  FILLER                     PIC X.
  1750
  1751         16  CF-ST-COMMISSION-CAPS.
  1752             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1753             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  32
* SOCK03.cbl
  1754             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1755             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1756         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1757                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1758                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1759                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1760
  1761         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1762
  1763         16  CF-ST-STATUTORY-INTEREST.
  1764             20  CF-ST-STAT-DATE-FROM       PIC X.
  1765                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1766                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1767             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1768             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1769             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1770             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1771             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1772
  1773         16  CF-ST-OVER-SHORT.
  1774             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1775             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1776
  1777         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1778
  1779         16  CF-ST-RT-CALC                  PIC X.
  1780
  1781         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1782         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1783         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1784         16  CF-ST-RF-LR-CALC               PIC X.
  1785         16  CF-ST-RF-LL-CALC               PIC X.
  1786         16  CF-ST-RF-LN-CALC               PIC X.
  1787         16  CF-ST-RF-AH-CALC               PIC X.
  1788         16  CF-ST-RF-CP-CALC               PIC X.
  1789*        16  FILLER                         PIC X(206).
  1790*CIDMOD         16  FILLER                         PIC X(192).
  1791         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1792             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1793         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1794         16  CF-ST-VFY-2ND-BENE             PIC X.
  1795         16  CF-ST-CAUSAL-STATE             PIC X.
  1796         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1797         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1798         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1799             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1800         16  CF-ST-NET-ONLY-STATE           PIC X.
  1801             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1802         16  cf-commission-cap-required     pic x.
  1803         16  CF-ST-GA-COMMISSION-CAPS.
  1804             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  1805             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  1806             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  1807             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  1808         16  CF-ST-TOT-COMMISSION-CAPS.
  1809             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  1810             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  1811             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  33
* SOCK03.cbl
  1812             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  1813         16  FILLER                         PIC X(156).
  1814
  1815****************************************************************
  1816*             BENEFIT MASTER RECORD                            *
  1817****************************************************************
  1818
  1819     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1820         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1821             20  CF-BENEFIT-CODE            PIC XX.
  1822             20  CF-BENEFIT-NUMERIC  REDEFINES
  1823                 CF-BENEFIT-CODE            PIC XX.
  1824             20  CF-BENEFIT-ALPHA           PIC XXX.
  1825             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1826             20  CF-BENEFIT-COMMENT         PIC X(10).
  1827
  1828             20  CF-LF-COVERAGE-TYPE        PIC X.
  1829                 88  CF-REDUCING                VALUE 'R'.
  1830                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1831
  1832             20  CF-SPECIAL-CALC-CD         PIC X.
  1833                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1834                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1835                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1836                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1837                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1838                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1839                 88  CF-FARM-PLAN               VALUE 'F'.
  1840                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1841                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1842                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1843                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1844                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1845                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1846                 88  CF-PRUDENTIAL              VALUE 'P'.
  1847                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1848                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1849                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1850                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1851                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1852                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1853
  1854             20  CF-JOINT-INDICATOR         PIC X.
  1855                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1856
  1857*            20  FILLER                     PIC X(12).
  1858             20  cf-maximum-benefits        pic s999 comp-3.
  1859             20  FILLER                     PIC X(09).
  1860             20  CF-BENEFIT-CATEGORY        PIC X.
  1861             20  CF-LOAN-TYPE               PIC X(8).
  1862
  1863             20  CF-CO-REM-TERM-CALC        PIC X.
  1864                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1865                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1866                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1867                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1868                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1869
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  34
* SOCK03.cbl
  1870             20  CF-CO-EARNINGS-CALC        PIC X.
  1871                 88  CO-EARN-BY-R78             VALUE '1'.
  1872                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1873                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1874                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1875                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1876                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1877                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1878                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1879
  1880             20  CF-CO-REFUND-CALC          PIC X.
  1881                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1882                 88  CO-REFD-BY-R78             VALUE '1'.
  1883                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1884                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1885                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1886                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1887                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1888                 88  CO-REFD-MEAN               VALUE '8'.
  1889                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1890                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1891                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1892
  1893             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1894                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1895                 88  CO-OVRD-BY-R78             VALUE '1'.
  1896                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1897                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1898                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1899                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1900                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1901                 88  CO-OVRD-MEAN               VALUE '8'.
  1902                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1903
  1904             20  CF-CO-BEN-I-G-CD           PIC X.
  1905                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1906                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1907                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1908
  1909         16  FILLER                         PIC X(304).
  1910
  1911
  1912****************************************************************
  1913*             CARRIER MASTER RECORD                            *
  1914****************************************************************
  1915
  1916     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1917         16  CF-ADDRESS-DATA.
  1918             20  CF-MAIL-TO-NAME            PIC X(30).
  1919             20  CF-IN-CARE-OF              PIC X(30).
  1920             20  CF-ADDRESS-LINE-1          PIC X(30).
  1921             20  CF-ADDRESS-LINE-2          PIC X(30).
  1922             20  CF-CITY-STATE              PIC X(30).
  1923             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1924             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1925
  1926         16  CF-CLAIM-NO-CONTROL.
  1927             20  CF-CLAIM-NO-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  35
* SOCK03.cbl
  1928                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1929                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1930                 88  CLAIM-NO-SEQ               VALUE '3'.
  1931                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1932             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1933                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1934                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1935                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1936
  1937         16  CF-CHECK-NO-CONTROL.
  1938             20  CF-CHECK-NO-METHOD         PIC X.
  1939                 88  CHECK-NO-MANUAL            VALUE '1'.
  1940                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1941                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1942                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1943             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1944                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1945
  1946         16  CF-DOMICILE-STATE              PIC XX.
  1947
  1948         16  CF-EXPENSE-CONTROLS.
  1949             20  CF-EXPENSE-METHOD          PIC X.
  1950                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1951                 88  DOLLARS-PER-PMT            VALUE '2'.
  1952                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1953                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1954             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1955             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1956
  1957         16  CF-CORRESPONDENCE-CONTROL.
  1958             20  CF-LETTER-RESEND-OPT       PIC X.
  1959                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1960                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1961             20  FILLER                     PIC X(4).
  1962
  1963         16  CF-RESERVE-CONTROLS.
  1964             20  CF-MANUAL-SW               PIC X.
  1965                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1966             20  CF-FUTURE-SW               PIC X.
  1967                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1968             20  CF-PTC-SW                  PIC X.
  1969                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1970             20  CF-IBNR-SW                 PIC X.
  1971                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1972             20  CF-PTC-LF-SW               PIC X.
  1973                 88  CF-LF-PTC-USED             VALUE '1'.
  1974             20  CF-CDT-ACCESS-METHOD       PIC X.
  1975                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1976                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1977                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1978             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1979
  1980         16  CF-CLAIM-CALC-METHOD           PIC X.
  1981             88  360-PLUS-MONTHS                VALUE '1'.
  1982             88  365-PLUS-MONTHS                VALUE '2'.
  1983             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1984             88  360-DAILY                      VALUE '4'.
  1985             88  365-DAILY                      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  36
* SOCK03.cbl
  1986
  1987         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1988         16  FILLER                         PIC X(11).
  1989
  1990         16  CF-LIMIT-AMOUNTS.
  1991             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1992             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1993             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1994             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1995             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1996             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1997             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1998             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1999             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2000             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2001
  2002         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2003         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2004         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2005
  2006         16  CF-ZIP-CODE.
  2007             20  CF-ZIP-PRIME.
  2008                 24  CF-ZIP-1ST             PIC X.
  2009                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2010                 24  FILLER                 PIC X(4).
  2011             20  CF-ZIP-PLUS4               PIC X(4).
  2012         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2013             20  CF-CAN-POSTAL-1            PIC XXX.
  2014             20  CF-CAN-POSTAL-2            PIC XXX.
  2015             20  FILLER                     PIC XXX.
  2016
  2017         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2018         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2019         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2020
  2021         16  CF-RATING-SWITCH               PIC X.
  2022             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2023             88  CF-NO-RATING                   VALUE 'N'.
  2024
  2025         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2026
  2027         16  CF-CARRIER-OVER-SHORT.
  2028             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2029             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2030
  2031         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2032         16  CF-SECPAY-SWITCH               PIC X.
  2033             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2034             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2035         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2036         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2037         16  FILLER                         PIC X(444).
  2038*        16  FILLER                         PIC X(452).
  2039
  2040
  2041****************************************************************
  2042*             MORTALITY MASTER RECORD                          *
  2043****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  37
* SOCK03.cbl
  2044
  2045     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2046         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2047                                INDEXED BY CF-MORT-NDX.
  2048             20  CF-MORT-TABLE              PIC X(5).
  2049             20  CF-MORT-TABLE-TYPE         PIC X.
  2050                 88  CF-MORT-JOINT              VALUE 'J'.
  2051                 88  CF-MORT-SINGLE             VALUE 'S'.
  2052                 88  CF-MORT-COMBINED           VALUE 'C'.
  2053                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2054                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2055             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2056             20  CF-MORT-AGE-METHOD         PIC XX.
  2057                 88  CF-AGE-LAST                VALUE 'AL'.
  2058                 88  CF-AGE-NEAR                VALUE 'AN'.
  2059             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2060             20  CF-MORT-ADJUSTMENT-DIRECTION
  2061                                            PIC X.
  2062                 88  CF-MINUS                   VALUE '-'.
  2063                 88  CF-PLUS                    VALUE '+'.
  2064             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2065             20  CF-MORT-JOINT-CODE         PIC X.
  2066                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2067             20  CF-MORT-PC-Q               PIC X.
  2068                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2069             20  CF-MORT-TABLE-CODE         PIC X(4).
  2070             20  CF-MORT-COMMENTS           PIC X(15).
  2071             20  FILLER                     PIC X(14).
  2072
  2073         16  FILLER                         PIC X(251).
  2074
  2075
  2076****************************************************************
  2077*             BUSSINESS TYPE MASTER RECORD                     *
  2078****************************************************************
  2079
  2080     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2081* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2082* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2083* AND RECORD 05 IS TYPES 81-99
  2084         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2085             20  CF-BUSINESS-TITLE          PIC  X(19).
  2086             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2087                                            PIC S9V9(4) COMP-3.
  2088             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2089             20  FILLER                     PIC  X.
  2090         16  FILLER                         PIC  X(248).
  2091
  2092
  2093****************************************************************
  2094*             TERMINAL MASTER RECORD                           *
  2095****************************************************************
  2096
  2097     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2098
  2099         16  CF-COMPANY-TERMINALS.
  2100             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2101                                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  38
* SOCK03.cbl
  2102         16  FILLER               PIC X(248).
  2103
  2104
  2105****************************************************************
  2106*             LIFE EDIT MASTER RECORD                          *
  2107****************************************************************
  2108
  2109     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2110         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2111             20  CF-LIFE-CODE-IN            PIC XX.
  2112             20  CF-LIFE-CODE-OUT           PIC XX.
  2113         16  FILLER                         PIC X(248).
  2114
  2115
  2116****************************************************************
  2117*             AH EDIT MASTER RECORD                            *
  2118****************************************************************
  2119
  2120     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2121         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2122             20  CF-AH-CODE-IN              PIC XXX.
  2123             20  CF-AH-CODE-OUT             PIC XX.
  2124         16  FILLER                         PIC X(248).
  2125
  2126
  2127****************************************************************
  2128*             CREDIBILITY TABLES                               *
  2129****************************************************************
  2130
  2131     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2132         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2133                             INDEXED BY CF-CRDB-NDX.
  2134             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2135             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2136             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2137         16  FILLER                         PIC  X(332).
  2138
  2139
  2140****************************************************************
  2141*             REPORT CUSTOMIZATION RECORD                      *
  2142****************************************************************
  2143
  2144     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2145         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2146             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2147             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2148             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2149**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2150****       A T-TRANSFER.                                   ****
  2151             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2152
  2153         16  FILLER                         PIC XX.
  2154
  2155         16  CF-CARRIER-CNTL-OPT.
  2156             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2157                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2158                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2159             20  CF-CARRIER-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  39
* SOCK03.cbl
  2160                                            PIC X.
  2161         16  CF-GROUP-CNTL-OPT.
  2162             20  CF-GROUP-OPT-SEQ           PIC 9.
  2163                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2164                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2165             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2166                                            PIC X(6).
  2167         16  CF-STATE-CNTL-OPT.
  2168             20  CF-STATE-OPT-SEQ           PIC 9.
  2169                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2170                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2171             20  CF-STATE-SELECT OCCURS 3 TIMES
  2172                                            PIC XX.
  2173         16  CF-ACCOUNT-CNTL-OPT.
  2174             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2175                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2176                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2177             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2178                                            PIC X(10).
  2179         16  CF-BUS-TYP-CNTL-OPT.
  2180             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2181                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2182                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2183             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2184                                            PIC XX.
  2185         16  CF-LF-TYP-CNTL-OPT.
  2186             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2187                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2188                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2189             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2190                                            PIC XX.
  2191         16  CF-AH-TYP-CNTL-OPT.
  2192             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2193                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2194                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2195             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2196                                            PIC XX.
  2197         16  CF-REPTCD1-CNTL-OPT.
  2198             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2199                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2200                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2201             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2202                                            PIC X(10).
  2203         16  CF-REPTCD2-CNTL-OPT.
  2204             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2205                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2206                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2207             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2208                                            PIC X(10).
  2209         16  CF-USER1-CNTL-OPT.
  2210             20  CF-USER1-OPT-SEQ           PIC 9.
  2211                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2212                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2213             20  CF-USER1-SELECT OCCURS 3 TIMES
  2214                                            PIC X(10).
  2215         16  CF-USER2-CNTL-OPT.
  2216             20  CF-USER2-OPT-SEQ           PIC 9.
  2217                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  40
* SOCK03.cbl
  2218                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2219             20  CF-USER2-SELECT OCCURS 3 TIMES
  2220                                            PIC X(10).
  2221         16  CF-USER3-CNTL-OPT.
  2222             20  CF-USER3-OPT-SEQ           PIC 9.
  2223                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2224                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2225             20  CF-USER3-SELECT OCCURS 3 TIMES
  2226                                            PIC X(10).
  2227         16  CF-USER4-CNTL-OPT.
  2228             20  CF-USER4-OPT-SEQ           PIC 9.
  2229                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2230                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2231             20  CF-USER4-SELECT OCCURS 3 TIMES
  2232                                            PIC X(10).
  2233         16  CF-USER5-CNTL-OPT.
  2234             20  CF-USER5-OPT-SEQ           PIC 9.
  2235                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2236                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2237             20  CF-USER5-SELECT OCCURS 3 TIMES
  2238                                            PIC X(10).
  2239         16  CF-REINS-CNTL-OPT.
  2240             20  CF-REINS-OPT-SEQ           PIC 9.
  2241                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2242                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2243             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2244                 24  CF-REINS-PRIME         PIC XXX.
  2245                 24  CF-REINS-SUB           PIC XXX.
  2246
  2247         16  CF-AGENT-CNTL-OPT.
  2248             20  CF-AGENT-OPT-SEQ           PIC 9.
  2249                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2250                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2251             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2252                                            PIC X(10).
  2253
  2254         16  FILLER                         PIC X(43).
  2255
  2256         16  CF-LOSS-RATIO-SELECT.
  2257             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2258             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2259         16  CF-ENTRY-DATE-SELECT.
  2260             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2261             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2262         16  CF-EFFECTIVE-DATE-SELECT.
  2263             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2264             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2265
  2266         16  CF-EXCEPTION-LIST-IND          PIC X.
  2267             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2268
  2269         16  FILLER                         PIC X(318).
  2270
  2271****************************************************************
  2272*                  EXCEPTION REPORTING RECORD                  *
  2273****************************************************************
  2274
  2275     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  41
* SOCK03.cbl
  2276         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2277             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2278
  2279         16  CF-COMBINED-LIFE-AH-OPT.
  2280             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2281             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2282             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2283             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2284
  2285         16  CF-LIFE-OPT.
  2286             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2287             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2288             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2289             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2290             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2291             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2292             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2293             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2294             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2295             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2296
  2297         16  CF-AH-OPT.
  2298             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2299             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2300             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2301             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2302             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2303             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2304             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2305             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2306             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2307             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2308
  2309         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2310             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2311             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2312             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2313
  2314         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2315
  2316         16  FILLER                         PIC X(673).
  2317
  2318
  2319****************************************************************
  2320*             MORTGAGE SYSTEM PLAN RECORD                      *
  2321****************************************************************
  2322
  2323     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2324         16  CF-PLAN-TYPE                   PIC X.
  2325             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2326             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2327             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2328         16  CF-PLAN-ABBREV                 PIC XXX.
  2329         16  CF-PLAN-DESCRIPT               PIC X(10).
  2330         16  CF-PLAN-NOTES                  PIC X(20).
  2331         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2332         16  CF-PLAN-UNDERWRITING.
  2333             20  CF-PLAN-TERM-DATA.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  42
* SOCK03.cbl
  2334                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2335                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2336             20  CF-PLAN-AGE-DATA.
  2337                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2338                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2339                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2340             20  CF-PLAN-BENEFIT-DATA.
  2341                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2342                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2343                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2344                                            PIC S9(7)V99  COMP-3.
  2345         16  CF-PLAN-POLICY-FORMS.
  2346             20  CF-POLICY-FORM             PIC X(12).
  2347             20  CF-MASTER-APPLICATION      PIC X(12).
  2348             20  CF-MASTER-POLICY           PIC X(12).
  2349         16  CF-PLAN-RATING.
  2350             20  CF-RATE-CODE               PIC X(5).
  2351             20  CF-SEX-RATING              PIC X.
  2352                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2353                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2354             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2355             20  CF-SUB-STD-TYPE            PIC X.
  2356                 88  CF-PCT-OF-PREM            VALUE '1'.
  2357                 88  CF-PCT-OF-BENE            VALUE '2'.
  2358         16  CF-PLAN-PREM-TOLERANCES.
  2359             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2360             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2361         16  CF-PLAN-PYMT-TOLERANCES.
  2362             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2363             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2364         16  CF-PLAN-MISC-DATA.
  2365             20  FILLER                     PIC X.
  2366             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2367             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2368         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2369         16  CF-PLAN-IND-GRP                PIC X.
  2370             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2371                                                     '1'.
  2372             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2373                                                     '2'.
  2374         16  CF-MIB-SEARCH-SW               PIC X.
  2375             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2376             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2377             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2378             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2379         16  CF-ALPHA-SEARCH-SW             PIC X.
  2380             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2381             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2382             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2383             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2384             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2385             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2386             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2387             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2388             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2389             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2390                                                     'A' 'B' 'C'
  2391                                                     'X' 'Y' 'Z'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  43
* SOCK03.cbl
  2392         16  CF-EFF-DT-RULE-SW              PIC X.
  2393             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2394             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2395             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2396             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2397             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2398         16  FILLER                         PIC X(4).
  2399         16  CF-HEALTH-QUESTIONS            PIC X.
  2400             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2401         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2402         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2403         16  CF-PLAN-SNGL-JNT               PIC X.
  2404             88  CF-COMBINED-PLAN              VALUE 'C'.
  2405             88  CF-JNT-PLAN                   VALUE 'J'.
  2406             88  CF-SNGL-PLAN                  VALUE 'S'.
  2407         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2408         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2409         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2410         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2411         16  CF-RERATE-CNTL                 PIC  X.
  2412             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2413             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2414             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2415             88  CF-AUTO-RECALC                 VALUE '4'.
  2416         16  CF-BENEFIT-TYPE                PIC  X.
  2417             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2418             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2419         16  CF-POLICY-FEE                  PIC S999V99
  2420                                                    COMP-3.
  2421         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2422         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2423         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2424         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2425         16  FILLER                         PIC  X(32).
  2426         16  CF-TERMINATION-FORM            PIC  X(04).
  2427         16  FILLER                         PIC  X(08).
  2428         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2429                                                       COMP-3.
  2430         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2431         16  CF-ISSUE-LETTER                PIC  X(4).
  2432         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2433         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2434             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2435             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2436         16  CF-MP-REFUND-CALC              PIC X.
  2437             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2438             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2439             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2440             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2441             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2442             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2443             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2444             88  CF-MP-REFD-MEAN                VALUE '8'.
  2445         16  CF-ALT-RATE-CODE               PIC  X(5).
  2446
  2447
  2448         16  FILLER                         PIC X(498).
  2449****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  44
* SOCK03.cbl
  2450*             MORTGAGE COMPANY MASTER RECORD                   *
  2451****************************************************************
  2452
  2453     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2454         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2455         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2456             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2457             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2458             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2459             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2460             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2461
  2462         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2463         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2464         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2465         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2466         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2467
  2468         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2469             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2470         16  CF-MP-RECON-USE-IND            PIC X(1).
  2471             88  CF-MP-USE-RECON             VALUE 'Y'.
  2472         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2473             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2474         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2475             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2476             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2477         16  FILLER                         PIC X(1).
  2478         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2479             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2480         16  CF-MORTG-MIB-VERSION           PIC X.
  2481             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2482             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2483             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2484         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2485             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2486                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2487             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2488                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2489             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2490                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2491             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2492                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2493             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2494                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2495             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2496                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2497         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2498         16  FILLER                         PIC X(7).
  2499         16  CF-MORTG-DESTINATION-SYMBOL.
  2500             20  CF-MORTG-MIB-COMM          PIC X(5).
  2501             20  CF-MORTG-MIB-TERM          PIC X(5).
  2502         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2503             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2504         16  FILLER                         PIC X(03).
  2505         16  CF-MP-CHECK-NO-CONTROL.
  2506             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2507                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  45
* SOCK03.cbl
  2508                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2509                                                ' ' LOW-VALUES.
  2510                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2511                                               VALUE '3'.
  2512         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2513         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2514         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2515             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2516                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2517             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2518                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2519             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2520                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2521             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2522                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2523             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2524                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2525             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2526                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2527         16  CF-MORTG-BILLING-AREA.
  2528             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2529                                            PIC X.
  2530         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2531         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2532         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2533         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2534             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2535             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2536         16  FILLER                         PIC X.
  2537         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2538             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2539             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2540         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2541         16  FILLER                         PIC X(8).
  2542         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2543         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2544         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2545         16  CF-ACH-COMPANY-ID.
  2546             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2547                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2548                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2549                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2550             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2551         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2552             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2553         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2554             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2555             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2556         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2557         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2558         16  FILLER                         PIC X(536).
  2559
  2560****************************************************************
  2561*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2562****************************************************************
  2563
  2564     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2565         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  46
* SOCK03.cbl
  2566             20  CF-FEMALE-HEIGHT.
  2567                 24  CF-FEMALE-FT           PIC 99.
  2568                 24  CF-FEMALE-IN           PIC 99.
  2569             20  CF-FEMALE-MIN-WT           PIC 999.
  2570             20  CF-FEMALE-MAX-WT           PIC 999.
  2571         16  FILLER                         PIC X(428).
  2572
  2573     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2574         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2575             20  CF-MALE-HEIGHT.
  2576                 24  CF-MALE-FT             PIC 99.
  2577                 24  CF-MALE-IN             PIC 99.
  2578             20  CF-MALE-MIN-WT             PIC 999.
  2579             20  CF-MALE-MAX-WT             PIC 999.
  2580         16  FILLER                         PIC X(428).
  2581******************************************************************
  2582*             AUTOMATIC ACTIVITY RECORD                          *
  2583******************************************************************
  2584     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2585         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2586             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2587             20  CF-SYS-LETTER-ID           PIC X(04).
  2588             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2589             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2590             20  CF-SYS-RESET-SW            PIC X(01).
  2591             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2592             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2593
  2594         16  FILLER                         PIC X(50).
  2595
  2596         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2597             20  CF-USER-ACTIVE-SW          PIC X(01).
  2598             20  CF-USER-LETTER-ID          PIC X(04).
  2599             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2600             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2601             20  CF-USER-RESET-SW           PIC X(01).
  2602             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2603             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2604             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2605
  2606         16  FILLER                         PIC X(246).
  2607*                                 COPY ERCACCT.
  2608******************************************************************
  2609*                                                                *
  2610*                                                                *
  2611*                            ERCACCT                             *
  2612*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2613*                            VMOD=2.031                          *
  2614*                                                                *
  2615*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2616*                                                                *
  2617*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2618*   VSAM ACCOUNT MASTER FILES.                                   *
  2619*                                                                *
  2620*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2621*                                                                *
  2622*   FILE TYPE = VSAM,KSDS                                        *
  2623*   RECORD SIZE = 2000  RECFORM = FIX                            *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  47
* SOCK03.cbl
  2624*                                                                *
  2625*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2626*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2627*                                                                *
  2628*   LOG = NO                                                     *
  2629*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2630*                                                                *
  2631*                                                                *
  2632******************************************************************
  2633*                   C H A N G E   L O G
  2634*
  2635* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2636*-----------------------------------------------------------------
  2637*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2638* EFFECTIVE    NUMBER
  2639*-----------------------------------------------------------------
  2640* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2641* 092705    2005050300006  PEMA  ADD SPP LEASES
  2642* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2643* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2644* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2645* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2646* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2647* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2648******************************************************************
  2649
  2650 01  ACCOUNT-MASTER.
  2651     12  AM-RECORD-ID                      PIC XX.
  2652         88  VALID-AM-ID                      VALUE 'AM'.
  2653
  2654     12  AM-CONTROL-PRIMARY.
  2655         16  AM-COMPANY-CD                 PIC X.
  2656         16  AM-MSTR-CNTRL.
  2657             20  AM-CONTROL-A.
  2658                 24  AM-CARRIER            PIC X.
  2659                 24  AM-GROUPING.
  2660                     28 AM-GROUPING-PREFIX PIC XXX.
  2661                     28 AM-GROUPING-PRIME  PIC XXX.
  2662                 24  AM-STATE              PIC XX.
  2663                 24  AM-ACCOUNT.
  2664                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2665                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2666             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2667                                           PIC X(19).
  2668             20  AM-CNTRL-B.
  2669                 24  AM-EXPIRATION-DT      PIC XX.
  2670                 24  FILLER                PIC X(4).
  2671             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2672                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2673
  2674     12  AM-CONTROL-BY-VAR-GRP.
  2675         16  AM-COMPANY-CD-A1              PIC X.
  2676         16  AM-VG-CARRIER                 PIC X.
  2677         16  AM-VG-GROUPING                PIC X(6).
  2678         16  AM-VG-STATE                   PIC XX.
  2679         16  AM-VG-ACCOUNT                 PIC X(10).
  2680         16  AM-VG-DATE.
  2681             20  AM-VG-EXPIRATION-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  48
* SOCK03.cbl
  2682             20  FILLER                    PIC X(4).
  2683         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2684                                           PIC 9(11)      COMP-3.
  2685     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2686         16  FILLER                        PIC X(10).
  2687         16  AM-VG-KEY3.
  2688             20  AM-VG3-ACCOUNT            PIC X(10).
  2689             20  AM-VG3-EXP-DT             PIC XX.
  2690         16  FILLER                        PIC X(4).
  2691     12  AM-MAINT-INFORMATION.
  2692         16  AM-LAST-MAINT-DT              PIC XX.
  2693         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2694         16  AM-LAST-MAINT-USER            PIC X(4).
  2695         16  FILLER                        PIC XX.
  2696
  2697     12  AM-EFFECTIVE-DT                   PIC XX.
  2698     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2699
  2700     12  AM-PREV-DATES  COMP-3.
  2701         16  AM-PREV-EXP-DT                PIC 9(11).
  2702         16  AM-PREV-EFF-DT                PIC 9(11).
  2703
  2704     12  AM-REPORT-CODE-1                  PIC X(10).
  2705     12  AM-REPORT-CODE-2                  PIC X(10).
  2706
  2707     12  AM-CITY-CODE                      PIC X(4).
  2708     12  AM-COUNTY-PARISH                  PIC X(6).
  2709
  2710     12  AM-NAME                           PIC X(30).
  2711     12  AM-PERSON                         PIC X(30).
  2712     12  AM-ADDRS                          PIC X(30).
  2713     12  AM-CITY.
  2714         16  AM-ADDR-CITY                  PIC X(28).
  2715         16  AM-ADDR-STATE                 PIC XX.
  2716     12  AM-ZIP.
  2717         16  AM-ZIP-PRIME.
  2718             20  AM-ZIP-PRI-1ST            PIC X.
  2719                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2720             20  FILLER                    PIC X(4).
  2721         16  AM-ZIP-PLUS4                  PIC X(4).
  2722     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2723         16  AM-CAN-POSTAL-1               PIC XXX.
  2724         16  AM-CAN-POSTAL-2               PIC XXX.
  2725         16  FILLER                        PIC XXX.
  2726     12  AM-TEL-NO.
  2727         16  AM-AREA-CODE                  PIC 999.
  2728         16  AM-TEL-PRE                    PIC 999.
  2729         16  AM-TEL-NBR                    PIC 9(4).
  2730     12  AM-TEL-LOC                        PIC X.
  2731         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2732         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2733
  2734     12  AM-COMM-STRUCTURE.
  2735         16  AM-DEFN-1.
  2736             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2737                 24  AM-AGT.
  2738                     28  AM-AGT-PREFIX     PIC X(4).
  2739                     28  AM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  49
* SOCK03.cbl
  2740                 24  AM-COM-TYP            PIC X.
  2741                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2742                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2743                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2744                 24  AM-RECALC-LV-INDIC    PIC X.
  2745                 24  AM-RETRO-LV-INDIC     PIC X.
  2746                 24  AM-GL-CODES           PIC X.
  2747                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2748                 24  FILLER                PIC X(01).
  2749         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2750             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2751                 24  FILLER                PIC X(11).
  2752                 24  AM-L-COMA             PIC XXX.
  2753                 24  AM-J-COMA             PIC XXX.
  2754                 24  AM-A-COMA             PIC XXX.
  2755                 24  FILLER                PIC X(6).
  2756
  2757     12  AM-COMM-CHANGE-STATUS             PIC X.
  2758         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2759
  2760     12  AM-CSR-CODE                       PIC X(4).
  2761
  2762     12  AM-BILLING-STATUS                 PIC X.
  2763         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2764         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2765     12  AM-AUTO-REFUND-SW                 PIC X.
  2766         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2767         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2768     12  AM-GPCD                           PIC 99.
  2769     12  AM-IG                             PIC X.
  2770         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2771         88  AM-HAS-GROUP                     VALUE '2'.
  2772     12  AM-STATUS                         PIC X.
  2773         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2774         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2775         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2776         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2777         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2778         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2779         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2780         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2781         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2782         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2783     12  AM-REMIT-TO                       PIC 99.
  2784     12  AM-ID-NO                          PIC X(11).
  2785
  2786     12  AM-CAL-TABLE                      PIC XX.
  2787     12  AM-LF-DEVIATION                   PIC XXX.
  2788     12  AM-AH-DEVIATION                   PIC XXX.
  2789     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2790     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2791     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2792     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2793     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2794     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2795
  2796     12  AM-USER-FIELDS.
  2797         16  AM-FLD-1                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  50
* SOCK03.cbl
  2798         16  AM-FLD-2                      PIC XX.
  2799         16  AM-FLD-3                      PIC XX.
  2800         16  AM-FLD-4                      PIC XX.
  2801         16  AM-FLD-5                      PIC XX.
  2802
  2803     12  AM-1ST-PROD-DATE.
  2804         16  AM-1ST-PROD-YR                PIC XX.
  2805         16  AM-1ST-PROD-MO                PIC XX.
  2806         16  AM-1ST-PROD-DA                PIC XX.
  2807     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2808     12  AM-CERTS-PURGED-DATE.
  2809         16  AM-PUR-YR                     PIC XX.
  2810         16  AM-PUR-MO                     PIC XX.
  2811         16  AM-PUR-DA                     PIC XX.
  2812     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2813     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2814     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2815     12  AM-INACTIVE-DATE.
  2816         16  AM-INA-MO                     PIC 99.
  2817         16  AM-INA-DA                     PIC 99.
  2818         16  AM-INA-YR                     PIC 99.
  2819     12  AM-AR-HI-CERT-DATE                PIC XX.
  2820
  2821     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2822     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2823
  2824     12  AM-OB-PAYMENT-MODE                PIC X.
  2825         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2826         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2827         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2828         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2829
  2830     12  AM-AH-ONLY-INDICATOR              PIC X.
  2831         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2832         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2833
  2834     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2835
  2836     12  AM-OVER-SHORT.
  2837         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2838         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2839
  2840     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2841     12  AM-DCC-CLP-STATE                  PIC XX.
  2842
  2843     12  AM-RECALC-COMM                    PIC X.
  2844     12  AM-RECALC-REIN                    PIC X.
  2845
  2846     12  AM-REI-TABLE                      PIC XXX.
  2847     12  AM-REI-ET-LF                      PIC X.
  2848     12  AM-REI-ET-AH                      PIC X.
  2849     12  AM-REI-PE-LF                      PIC X.
  2850     12  AM-REI-PE-AH                      PIC X.
  2851     12  AM-REI-PRT-ST                     PIC X.
  2852     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2853     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2854     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2855     12  AM-REI-GROUP-A                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  51
* SOCK03.cbl
  2856     12  AM-REI-MORT                       PIC X(4).
  2857     12  AM-REI-PRT-OW                     PIC X.
  2858     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2859     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2860     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2861     12  AM-REI-GROUP-B                    PIC X(6).
  2862
  2863     12  AM-TRUST-TYPE                     PIC X(2).
  2864
  2865     12  AM-EMPLOYER-STMT-USED             PIC X.
  2866     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2867
  2868     12  AM-STD-AH-TYPE                    PIC XX.
  2869     12  AM-EARN-METHODS.
  2870         16  AM-EARN-METHOD-R              PIC X.
  2871             88 AM-REF-RL-R78                 VALUE 'R'.
  2872             88 AM-REF-RL-PR                  VALUE 'P'.
  2873             88 AM-REF-RL-MEAN                VALUE 'M'.
  2874             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2875         16  AM-EARN-METHOD-L              PIC X.
  2876             88 AM-REF-LL-R78                 VALUE 'R'.
  2877             88 AM-REF-LL-PR                  VALUE 'P'.
  2878             88 AM-REF-LL-MEAN                VALUE 'M'.
  2879             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2880         16  AM-EARN-METHOD-A              PIC X.
  2881             88 AM-REF-AH-R78                 VALUE 'R'.
  2882             88 AM-REF-AH-PR                  VALUE 'P'.
  2883             88 AM-REF-AH-MEAN                VALUE 'M'.
  2884             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2885             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2886             88 AM-REF-AH-NET                 VALUE 'N'.
  2887
  2888     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2889     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2890     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2891
  2892     12  AM-RET-Y-N                        PIC X.
  2893     12  AM-RET-P-E                        PIC X.
  2894     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2895     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2896     12  AM-RET-GRP                        PIC X(6).
  2897     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2898         16  AM-POOL-PRIME                 PIC XXX.
  2899         16  AM-POOL-SUB                   PIC XXX.
  2900     12  AM-RETRO-EARNINGS.
  2901         16  AM-RET-EARN-R                 PIC X.
  2902         16  AM-RET-EARN-L                 PIC X.
  2903         16  AM-RET-EARN-A                 PIC X.
  2904     12  AM-RET-ST-TAX-USE                 PIC X.
  2905         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2906         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2907     12  AM-RETRO-BEG-EARNINGS.
  2908         16  AM-RET-BEG-EARN-R             PIC X.
  2909         16  AM-RET-BEG-EARN-L             PIC X.
  2910         16  AM-RET-BEG-EARN-A             PIC X.
  2911     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2912     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2913
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  52
* SOCK03.cbl
  2914     12  AM-USER-SELECT-OPTIONS.
  2915         16  AM-USER-SELECT-1              PIC X(10).
  2916         16  AM-USER-SELECT-2              PIC X(10).
  2917         16  AM-USER-SELECT-3              PIC X(10).
  2918         16  AM-USER-SELECT-4              PIC X(10).
  2919         16  AM-USER-SELECT-5              PIC X(10).
  2920
  2921     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2922
  2923     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2924
  2925     12  AM-RPT045A-SWITCH                 PIC X.
  2926         88  RPT045A-OFF                   VALUE 'N'.
  2927
  2928     12  AM-INSURANCE-LIMITS.
  2929         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2930         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2931
  2932     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2933         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2934
  2935     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2936         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2937         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2938
  2939     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2940
  2941     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2942     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2943     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2944     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2945     12  AM-DCC-UEF-STATE                  PIC XX.
  2946     12  FILLER                            PIC XXX.
  2947     12  AM-REPORT-CODE-3                  PIC X(10).
  2948*    12  FILLER                            PIC X(22).
  2949
  2950     12  AM-RESERVE-DATE.
  2951         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2952         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2953         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2954
  2955     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2956     12  AM-NOTIFICATION-TYPES.
  2957         16  AM-NOTIF-OF-LETTERS           PIC X.
  2958         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2959         16  AM-NOTIF-OF-REPORTS           PIC X.
  2960         16  AM-NOTIF-OF-STATUS            PIC X.
  2961
  2962     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2963         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2964         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2965         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2966         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2967
  2968     12  AM-BENEFIT-CONTROLS.
  2969         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2970             20  AM-BENEFIT-CODE           PIC XX.
  2971             20  AM-BENEFIT-TYPE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  53
* SOCK03.cbl
  2972             20  AM-BENEFIT-REVISION       PIC XXX.
  2973             20  AM-BENEFIT-REM-TERM       PIC X.
  2974             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2975             20  FILLER                    PIC XX.
  2976         16  FILLER                        PIC X(80).
  2977
  2978     12  AM-TRANSFER-DATA.
  2979         16  AM-TRANSFERRED-FROM.
  2980             20  AM-TRNFROM-CARRIER        PIC X.
  2981             20  AM-TRNFROM-GROUPING.
  2982                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2983                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2984             20  AM-TRNFROM-STATE          PIC XX.
  2985             20  AM-TRNFROM-ACCOUNT.
  2986                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2987                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2988             20  AM-TRNFROM-DTE            PIC XX.
  2989         16  AM-TRANSFERRED-TO.
  2990             20  AM-TRNTO-CARRIER          PIC X.
  2991             20  AM-TRNTO-GROUPING.
  2992                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2993                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2994             20  AM-TRNTO-STATE            PIC XX.
  2995             20  AM-TRNTO-ACCOUNT.
  2996                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2997                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2998             20  AM-TRNTO-DTE              PIC XX.
  2999         16  FILLER                        PIC X(10).
  3000
  3001     12  AM-SAVED-REMIT-TO                 PIC 99.
  3002
  3003     12  AM-COMM-STRUCTURE-SAVED.
  3004         16  AM-DEFN-1-SAVED.
  3005             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3006                 24  AM-AGT-SV             PIC X(10).
  3007                 24  AM-COM-TYP-SV         PIC X.
  3008                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3009                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3010                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3011                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3012                 24  FILLER                PIC X.
  3013                 24  AM-GL-CODES-SV        PIC X.
  3014                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3015                 24  FILLER                PIC X.
  3016         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3017             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3018                 24  FILLER                PIC X(11).
  3019                 24  AM-L-COMA-SV          PIC XXX.
  3020                 24  AM-J-COMA-SV          PIC XXX.
  3021                 24  AM-A-COMA-SV          PIC XXX.
  3022                 24  FILLER                PIC X(6).
  3023
  3024     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3025         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3026            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3027            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3028            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3029
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  54
* SOCK03.cbl
  3030     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3031     12  FILLER                            PIC X(120).
  3032
  3033     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3034         16  AM-CONTROL-NAME               PIC X(30).
  3035         16  AM-EXECUTIVE-ONE.
  3036             20  AM-EXEC1-NAME             PIC X(15).
  3037             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3038                                                          COMP-3.
  3039             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3040                                                          COMP-3.
  3041         16  AM-EXECUTIVE-TWO.
  3042             20  AM-EXEC2-NAME             PIC X(15).
  3043             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3044                                                          COMP-3.
  3045             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3046                                                          COMP-3.
  3047
  3048     12  AM-RETRO-ADDITIONAL-DATA.
  3049         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3050         16  AM-RETRO-PREM-P-E             PIC X.
  3051         16  AM-RETRO-CLMS-P-I             PIC X.
  3052         16  AM-RETRO-RET-BRACKET-LF.
  3053             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3054                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3055                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3056             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3057                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  3058                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3059             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3060                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3061                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3062         16  AM-RETRO-RET-BRACKET-AH.
  3063             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3064                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3065                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3066                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3067             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3068                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3069                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3070             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3071                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3072                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3073
  3074     12  AM-COMMENTS.
  3075         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3076
  3077     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3078         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3079         16  AM-FLI-BILLING-CODE           PIC X.
  3080         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3081         16  AM-FLI-UNITED-IDENT           PIC X.
  3082         16  AM-FLI-INTEREST-LOST-DATA.
  3083             20  AM-FLI-BANK-NO            PIC X(5).
  3084             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3085             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3086             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3087         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  55
* SOCK03.cbl
  3088             20  AM-FLI-AGT                PIC X(9).
  3089             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3090             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3091         16  FILLER                        PIC X(102).
  3092
  3093     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3094         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3095             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3096             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3097             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3098             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3099             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3100         16  FILLER                          PIC X(10).
  3101******************************************************************
  3102*                                 COPY ERCMAIL.
  3103******************************************************************
  3104*                                                                *
  3105*                                                                *
  3106*                            ERCMAIL                             *
  3107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3108*                            VMOD=2.003                          *
  3109*                                                                *
  3110*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3111*                                                                *
  3112*   FILE TYPE = VSAM,KSDS                                        *
  3113*   RECORD SIZE = 374   RECFORM = FIX                            *
  3114*                                                                *
  3115*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3116*   ALTERNATE PATH    = NOT USED                                 *
  3117*                                                                *
  3118*   LOG = YES                                                    *
  3119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3120******************************************************************
  3121*                   C H A N G E   L O G
  3122*
  3123* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3124*-----------------------------------------------------------------
  3125*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3126* EFFECTIVE    NUMBER
  3127*-----------------------------------------------------------------
  3128* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3129* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3130* 111108                   PEMA  ADD CRED BENE ADDR2
  3131******************************************************************
  3132
  3133 01  MAILING-DATA.
  3134     12  MA-RECORD-ID                      PIC XX.
  3135         88  VALID-MA-ID                       VALUE 'MA'.
  3136
  3137     12  MA-CONTROL-PRIMARY.
  3138         16  MA-COMPANY-CD                 PIC X.
  3139         16  MA-CARRIER                    PIC X.
  3140         16  MA-GROUPING.
  3141             20  MA-GROUPING-PREFIX        PIC XXX.
  3142             20  MA-GROUPING-PRIME         PIC XXX.
  3143         16  MA-STATE                      PIC XX.
  3144         16  MA-ACCOUNT.
  3145             20  MA-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  56
* SOCK03.cbl
  3146             20  MA-ACCOUNT-PRIME          PIC X(6).
  3147         16  MA-CERT-EFF-DT                PIC XX.
  3148         16  MA-CERT-NO.
  3149             20  MA-CERT-PRIME             PIC X(10).
  3150             20  MA-CERT-SFX               PIC X.
  3151
  3152     12  FILLER                            PIC XX.
  3153
  3154     12  MA-ACCESS-CONTROL.
  3155         16  MA-SOURCE-SYSTEM              PIC XX.
  3156             88  MA-FROM-CREDIT                VALUE 'CR'.
  3157             88  MA-FROM-VSI                   VALUE 'VS'.
  3158             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3159             88  MA-FROM-OTHER                 VALUE 'OT'.
  3160         16  MA-RECORD-ADD-DT              PIC XX.
  3161         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3162         16  MA-LAST-MAINT-DT              PIC XX.
  3163         16  MA-LAST-MAINT-BY              PIC XXXX.
  3164         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3165
  3166     12  MA-PROFILE-INFO.
  3167         16  MA-QUALIFY-CODE-1             PIC XX.
  3168         16  MA-QUALIFY-CODE-2             PIC XX.
  3169         16  MA-QUALIFY-CODE-3             PIC XX.
  3170         16  MA-QUALIFY-CODE-4             PIC XX.
  3171         16  MA-QUALIFY-CODE-5             PIC XX.
  3172
  3173         16  MA-INSURED-LAST-NAME          PIC X(15).
  3174         16  MA-INSURED-FIRST-NAME         PIC X(10).
  3175         16  MA-INSURED-MIDDLE-INIT        PIC X.
  3176         16  MA-INSURED-ISSUE-AGE          PIC 99.
  3177         16  MA-INSURED-BIRTH-DT           PIC XX.
  3178         16  MA-INSURED-SEX                PIC X.
  3179             88  MA-SEX-MALE                   VALUE 'M'.
  3180             88  MA-SEX-FEMALE                 VALUE 'F'.
  3181         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  3182
  3183         16  MA-ADDRESS-CORRECTED          PIC X.
  3184         16  MA-JOINT-BIRTH-DT             PIC XX.
  3185*        16  FILLER                        PIC X(12).
  3186
  3187         16  MA-ADDRESS-LINE-1             PIC X(30).
  3188         16  MA-ADDRESS-LINE-2             PIC X(30).
  3189         16  MA-CITY-STATE.
  3190             20  MA-CITY                   PIC X(28).
  3191             20  MA-ADDR-STATE             PIC XX.
  3192         16  MA-ZIP.
  3193             20  MA-ZIP-CODE.
  3194                 24  MA-ZIP-CODE-1ST       PIC X(1).
  3195                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3196                 24  FILLER                PIC X(4).
  3197             20  MA-ZIP-PLUS4              PIC X(4).
  3198         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  3199             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  3200             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  3201             20  FILLER                    PIC X(3).
  3202
  3203         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  57
* SOCK03.cbl
  3204
  3205         16  FILLER                        PIC XXX.
  3206*        16  FILLER                        PIC X(10).
  3207
  3208     12  MA-CRED-BENE-INFO.
  3209         16  MA-CRED-BENE-NAME                 PIC X(25).
  3210         16  MA-CRED-BENE-ADDR                 PIC X(30).
  3211         16  MA-CRED-BENE-ADDR2                PIC X(30).
  3212         16  MA-CRED-BENE-CTYST.
  3213             20  MA-CRED-BENE-CITY             PIC X(28).
  3214             20  MA-CRED-BENE-STATE            PIC XX.
  3215         16  MA-CRED-BENE-ZIP.
  3216             20  MA-CB-ZIP-CODE.
  3217                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  3218                     88  MA-CB-CANADIAN-POST-CODE
  3219                                           VALUE 'A' THRU 'Z'.
  3220                 24  FILLER                    PIC X(4).
  3221             20  MA-CB-ZIP-PLUS4               PIC X(4).
  3222         16  MA-CB-CANADIAN-POSTAL-CODE
  3223                            REDEFINES MA-CRED-BENE-ZIP.
  3224             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  3225             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  3226             20  FILLER                        PIC X(3).
  3227     12  MA-POST-CARD-MAIL-DATA.
  3228         16  MA-MAIL-DATA OCCURS 7.
  3229             20  MA-MAIL-TYPE              PIC X.
  3230                 88  MA-12MO-MAILING           VALUE '1'.
  3231                 88  MA-EXP-MAILING            VALUE '2'.
  3232             20  MA-MAIL-STATUS            PIC X.
  3233                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  3234                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  3235                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  3236             20  MA-MAIL-DATE              PIC XX.
  3237     12  FILLER                            PIC XX.
  3238     12  FILLER                            PIC XX.
  3239*    12  FILLER                            PIC X(30).
  3240******************************************************************
  3241*                                 COPY ELCCRTT.
  3242******************************************************************
  3243*                                                                *
  3244*                            ELCCRTT.                            *
  3245*                                                                *
  3246*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3247*                                                                *
  3248*   FILE TYPE = VSAM,KSDS                                        *
  3249*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3250*                                                                *
  3251*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3252*                                                                *
  3253*   LOG = YES                                                    *
  3254*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3255******************************************************************
  3256*                   C H A N G E   L O G
  3257*
  3258* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3259*-----------------------------------------------------------------
  3260*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3261* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  58
* SOCK03.cbl
  3262*-----------------------------------------------------------------
  3263* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3264* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3265* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3266* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3267* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3268* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3269* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3270* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3271* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3272* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3273* 091318  CR2018073000001  PEMA  ADD Refund methods
  3274* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3275******************************************************************
  3276
  3277 01  CERTIFICATE-TRAILERS.
  3278     12  CS-RECORD-ID                      PIC XX.
  3279         88  VALID-CS-ID                      VALUE 'CS'.
  3280
  3281     12  CS-CONTROL-PRIMARY.
  3282         16  CS-COMPANY-CD                 PIC X.
  3283         16  CS-CARRIER                    PIC X.
  3284         16  CS-GROUPING                   PIC X(6).
  3285         16  CS-STATE                      PIC XX.
  3286         16  CS-ACCOUNT                    PIC X(10).
  3287         16  CS-CERT-EFF-DT                PIC XX.
  3288         16  CS-CERT-NO.
  3289             20  CS-CERT-PRIME             PIC X(10).
  3290             20  CS-CERT-SFX               PIC X.
  3291         16  CS-TRAILER-TYPE               PIC X.
  3292             88  COMM-TRLR           VALUE 'A'.
  3293             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3294             88  CERT-DATA-TRLR      VALUE 'C'.
  3295
  3296     12  CS-DATA-AREA                      PIC X(516).
  3297
  3298     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3299         16  CS-BANK-COMMISSION-AREA.
  3300             20  CS-BANK-COMMS       OCCURS 10.
  3301                 24  CS-AGT                PIC X(10).
  3302                 24  CS-COM-TYP            PIC X.
  3303                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3304                 24  CS-RECALC-LV-INDIC    PIC X.
  3305                 24  FILLER                PIC X(10).
  3306         16  FILLER                        PIC X(256).
  3307
  3308     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3309****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3310         16  CS-MB-CLAIM-DATA OCCURS 24.
  3311             20  CS-CLAIM-NO               PIC X(7).
  3312             20  CS-CLAIM-TYPE             PIC X.
  3313                 88  CS-AH-CLM               VALUE 'A'.
  3314                 88  CS-IU-CLM               VALUE 'I'.
  3315                 88  CS-GP-CLM               VALUE 'G'.
  3316                 88  CS-LF-CLM               VALUE 'L'.
  3317                 88  CS-PR-CLM               VALUE 'P'.
  3318                 88  CS-FL-CLM               VALUE 'F'.
  3319                 88  CS-OT-CLM               VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  59
* SOCK03.cbl
  3320             20  CS-INSURED-TYPE           PIC X.
  3321                 88  CS-PRIM-INSURED          VALUE 'P'.
  3322                 88  CS-CO-BORROWER           VALUE 'C'.
  3323             20  CS-BENEFIT-PERIOD         PIC 99.
  3324             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3325             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3326             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3327         16  FILLER                        PIC X(12).
  3328     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3329         16  CS-VIN-NUMBER                 PIC X(17).
  3330         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3331         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3332         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3333         16  cs-agent-name.
  3334             20  cs-agent-fname            pic x(20).
  3335             20  cs-agent-mi               pic x.
  3336             20  cs-agent-lname            pic x(25).
  3337         16  cs-license-no                 pic x(15).
  3338         16  cs-npn-number                 pic x(10).
  3339         16  cs-agent-edit-status          pic x.
  3340             88  cs-ae-refer-to-manager      value 'M'.
  3341             88  cs-ae-cover-sheet           value 'C'.
  3342             88  cs-ae-sig-form              value 'S'.
  3343             88  cs-ae-verified              value 'V'.
  3344             88  cs-unidentified-signature   value 'U'.
  3345             88  cs-cert-returned            value 'R'.
  3346             88  cs-accept-no-commission     value 'N'.
  3347         16  cs-year                       pic 9999.
  3348         16  cs-make                       pic x(20).
  3349         16  cs-model                      pic x(20).
  3350         16  cs-future                     pic x(20).
  3351         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3352         16  cs-claim-verification-status  pic x.
  3353             88  cs-clm-ver-eligible         value 'A'.
  3354             88  cs-clm-ver-partial-elig     value 'B'.
  3355             88  cs-clm-ver-not-eligible     value 'C'.
  3356             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  3357             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3358             88  cs-clm-ver-ND-CERT          value 'F'.
  3359             88  cs-clm-ver-spec-other       value 'G'.
  3360             88  cs-clam-ver-pratial-corrected
  3361                                             value 'H'.
  3362             88  cs-clm-ver-no-matches       value 'I'.
  3363             88  cs-clm-ver-not-elig-corrected
  3364                                             value 'J'.
  3365             88  cs-clm-ver-needs-review     value 'R'.
  3366             88  cs-clm-ver-sent-to-claims   value 'W'.
  3367         16  CS-LF-REFUND-METHOD           PIC X.
  3368         16  CS-AH-REFUND-METHOD           PIC X.
  3369         16  FILLER                        PIC X(353). *> was 420
  3370*        16  FILLER                        PIC X(496).
  3371*                                 COPY ELCDATE.
  3372******************************************************************
  3373*                                                                *
  3374*                                                                *
  3375*                            ELCDATE.                            *
  3376*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3377*                            VMOD=2.003
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  60
* SOCK03.cbl
  3378*                                                                *
  3379*                                                                *
  3380*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3381*                 LENGTH = 200                                   *
  3382******************************************************************
  3383
  3384 01  DATE-CONVERSION-DATA.
  3385     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3386     12  DC-OPTION-CODE                PIC X.
  3387         88  BIN-TO-GREG                VALUE ' '.
  3388         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3389         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3390         88  YMD-GREG-TO-BIN            VALUE '3'.
  3391         88  MDY-GREG-TO-BIN            VALUE '4'.
  3392         88  JULIAN-TO-BIN              VALUE '5'.
  3393         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3394         88  FIND-CENTURY               VALUE '7'.
  3395         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3396         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3397         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3398         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3399         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3400         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3401         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3402         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3403         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3404         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3405         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3406         88  BIN-3-TO-GREG              VALUE 'I'.
  3407         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3408         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3409         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3410         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3411         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3412         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3413         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3414         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3415         88  THREE-CHARACTER-BIN
  3416                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3417         88  GREGORIAN-TO-BIN
  3418                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3419         88  BIN-TO-GREGORIAN
  3420                  VALUES ' ' '1' 'I' '8' 'G'.
  3421         88  JULIAN-TO-BINARY
  3422                  VALUES '5' 'C' 'E' 'F'.
  3423     12  DC-ERROR-CODE                 PIC X.
  3424         88  NO-CONVERSION-ERROR        VALUE ' '.
  3425         88  DATE-CONVERSION-ERROR
  3426                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3427         88  DATE-IS-ZERO               VALUE '1'.
  3428         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3429         88  DATE-IS-INVALID            VALUE '3'.
  3430         88  DATE1-GREATER-DATE2        VALUE '4'.
  3431         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3432         88  DATE-INVALID-OPTION        VALUE '9'.
  3433         88  INVALID-CENTURY            VALUE 'A'.
  3434         88  ONLY-CENTURY               VALUE 'B'.
  3435         88  ONLY-LEAP-YEAR             VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  61
* SOCK03.cbl
  3436         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3437     12  DC-END-OF-MONTH               PIC X.
  3438         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3439     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3440         88  USE-NORMAL-PROCESS         VALUE ' '.
  3441         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3442         88  ADJUST-UP-100-YRS          VALUE '2'.
  3443     12  FILLER                        PIC X.
  3444     12  DC-CONVERSION-DATES.
  3445         16  DC-BIN-DATE-1             PIC XX.
  3446         16  DC-BIN-DATE-2             PIC XX.
  3447         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3448         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3449                       DC-GREG-DATE-1-EDIT.
  3450             20  DC-EDIT1-MONTH        PIC 99.
  3451             20  SLASH1-1              PIC X.
  3452             20  DC-EDIT1-DAY          PIC 99.
  3453             20  SLASH1-2              PIC X.
  3454             20  DC-EDIT1-YEAR         PIC 99.
  3455         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3456         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3457                     DC-GREG-DATE-2-EDIT.
  3458             20  DC-EDIT2-MONTH        PIC 99.
  3459             20  SLASH2-1              PIC X.
  3460             20  DC-EDIT2-DAY          PIC 99.
  3461             20  SLASH2-2              PIC X.
  3462             20  DC-EDIT2-YEAR         PIC 99.
  3463         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3464         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3465                     DC-GREG-DATE-1-YMD.
  3466             20  DC-YMD-YEAR           PIC 99.
  3467             20  DC-YMD-MONTH          PIC 99.
  3468             20  DC-YMD-DAY            PIC 99.
  3469         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3470         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3471                      DC-GREG-DATE-1-MDY.
  3472             20  DC-MDY-MONTH          PIC 99.
  3473             20  DC-MDY-DAY            PIC 99.
  3474             20  DC-MDY-YEAR           PIC 99.
  3475         16  DC-GREG-DATE-1-ALPHA.
  3476             20  DC-ALPHA-MONTH        PIC X(10).
  3477             20  DC-ALPHA-DAY          PIC 99.
  3478             20  FILLER                PIC XX.
  3479             20  DC-ALPHA-CENTURY.
  3480                 24 DC-ALPHA-CEN-N     PIC 99.
  3481             20  DC-ALPHA-YEAR         PIC 99.
  3482         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3483         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3484         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3485         16  DC-JULIAN-DATE            PIC 9(05).
  3486         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3487                                       PIC 9(05).
  3488         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3489             20  DC-JULIAN-YEAR        PIC 99.
  3490             20  DC-JULIAN-DAYS        PIC 999.
  3491         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3492         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3493         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  62
* SOCK03.cbl
  3494     12  DATE-CONVERSION-VARIBLES.
  3495         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3496         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3497             20  FILLER                PIC 9(3).
  3498             20  HOLD-CEN-1-CCYY.
  3499                 24  HOLD-CEN-1-CC     PIC 99.
  3500                 24  HOLD-CEN-1-YY     PIC 99.
  3501             20  HOLD-CEN-1-MO         PIC 99.
  3502             20  HOLD-CEN-1-DA         PIC 99.
  3503         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3504             20  HOLD-CEN-1-R-MO       PIC 99.
  3505             20  HOLD-CEN-1-R-DA       PIC 99.
  3506             20  HOLD-CEN-1-R-CCYY.
  3507                 24  HOLD-CEN-1-R-CC   PIC 99.
  3508                 24  HOLD-CEN-1-R-YY   PIC 99.
  3509             20  FILLER                PIC 9(3).
  3510         16  HOLD-CENTURY-1-X.
  3511             20  FILLER                PIC X(3)  VALUE SPACES.
  3512             20  HOLD-CEN-1-X-CCYY.
  3513                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3514                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3515             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3516             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3517         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3518             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3519             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3520             20  HOLD-CEN-1-R-X-CCYY.
  3521                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3522                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3523             20  FILLER                PIC XXX.
  3524         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3525         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3526         16  DC-JULIAN-DATE-1          PIC 9(07).
  3527         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3528             20  DC-JULIAN-1-CCYY.
  3529                 24  DC-JULIAN-1-CC    PIC 99.
  3530                 24  DC-JULIAN-1-YR    PIC 99.
  3531             20  DC-JULIAN-DA-1        PIC 999.
  3532         16  DC-JULIAN-DATE-2          PIC 9(07).
  3533         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3534             20  DC-JULIAN-2-CCYY.
  3535                 24  DC-JULIAN-2-CC    PIC 99.
  3536                 24  DC-JULIAN-2-YR    PIC 99.
  3537             20  DC-JULIAN-DA-2        PIC 999.
  3538         16  DC-GREG-DATE-A-EDIT.
  3539             20  DC-EDITA-MONTH        PIC 99.
  3540             20  SLASHA-1              PIC X VALUE '/'.
  3541             20  DC-EDITA-DAY          PIC 99.
  3542             20  SLASHA-2              PIC X VALUE '/'.
  3543             20  DC-EDITA-CCYY.
  3544                 24  DC-EDITA-CENT     PIC 99.
  3545                 24  DC-EDITA-YEAR     PIC 99.
  3546         16  DC-GREG-DATE-B-EDIT.
  3547             20  DC-EDITB-MONTH        PIC 99.
  3548             20  SLASHB-1              PIC X VALUE '/'.
  3549             20  DC-EDITB-DAY          PIC 99.
  3550             20  SLASHB-2              PIC X VALUE '/'.
  3551             20  DC-EDITB-CCYY.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  63
* SOCK03.cbl
  3552                 24  DC-EDITB-CENT     PIC 99.
  3553                 24  DC-EDITB-YEAR     PIC 99.
  3554         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3555         16  DC-GREG-DATE-CYMD-R REDEFINES
  3556                              DC-GREG-DATE-CYMD.
  3557             20  DC-CYMD-CEN           PIC 99.
  3558             20  DC-CYMD-YEAR          PIC 99.
  3559             20  DC-CYMD-MONTH         PIC 99.
  3560             20  DC-CYMD-DAY           PIC 99.
  3561         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3562         16  DC-GREG-DATE-MDCY-R REDEFINES
  3563                              DC-GREG-DATE-MDCY.
  3564             20  DC-MDCY-MONTH         PIC 99.
  3565             20  DC-MDCY-DAY           PIC 99.
  3566             20  DC-MDCY-CEN           PIC 99.
  3567             20  DC-MDCY-YEAR          PIC 99.
  3568    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3569        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3570    12  DC-EL310-DATE                  PIC X(21).
  3571    12  FILLER                         PIC X(28).
  3572*                                 COPY ELCCALC.
  3573******************************************************************
  3574*                                                                *
  3575*                           ELCCALC.                            *
  3576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3577*                            VMOD=2.025                          *
  3578*                                                                *
  3579*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3580*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3581*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3582*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3583*                                                                *
  3584*  PASSED TO ELRTRM                                              *
  3585*  -----------------                                             *
  3586*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3587*  ORIGINAL TERM                                                 *
  3588*  BEGINNING DATE                                                *
  3589*  ENDING DATE                                                   *
  3590*  COMPANY I.D.                                                  *
  3591*  ACCOUNT MASTER USER FIELD                                     *
  3592*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3593*  FREE LOOK DAYS                                                *
  3594*                                                                *
  3595*  RETURNED FROM ELRTRM                                          *
  3596*  ---------------------                                         *
  3597*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3598*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3599*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3600*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3601*----------------------------------------------------------------*
  3602*  PASSED TO ELRAMT                                              *
  3603*  ----------------                                              *
  3604*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3605*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3606*  ORIGINAL AMOUNT                                               *
  3607*  ALTERNATE BENEFIT (BALLON)                                    *
  3608*  A.P.R. - NET PAY ONLY                                         *
  3609*  METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  64
* SOCK03.cbl
  3610*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3611*  COMPANY I.D.                                                  *
  3612*  BENEFIT TYPE                                                  *
  3613*                                                                *
  3614*  RETURNED FROM ELRAMT                                          *
  3615*  --------------------                                          *
  3616*  REMAINING AMOUNT 1 - CURRENT                                  *
  3617*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3618*  REMAINING AMOUNT FACTOR
  3619*----------------------------------------------------------------*
  3620*  PASSED TO ELRESV                                              *
  3621*  -----------------                                             *
  3622*  CERTIFICATE EFFECTIVE DATE                                    *
  3623*  VALUATION DATE                                                *
  3624*  PAID THRU DATE                                                *
  3625*  BENEFIT                                                       *
  3626*  INCURRED DATE                                                 *
  3627*  REPORTED DATE                                                 *
  3628*  ISSUE AGE                                                     *
  3629*  TERM                                                          *
  3630*  CDT PERCENT                                                   *
  3631*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3632* *CLAIM TYPE (LIFE, A/H)                                        *
  3633* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3634* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3635*                                                                *
  3636*  RETURNED FROM ELRESV                                          *
  3637*  --------------------                                          *
  3638*  CDT TABLE USED                                                *
  3639*  CDT FACTOR USED                                               *
  3640*  PAY TO CURRENT RESERVE                                        *
  3641*  I.B.N.R. - A/H ONLY                                           *
  3642*  FUTURE (ACCRUED) AH ONLY                                      *
  3643*----------------------------------------------------------------*
  3644*  PASSED TO ELRATE                                              *
  3645*  ----------------                                              *
  3646*  CERT ISSUE DATE                                               *
  3647*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3648*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3649*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3650*  STATE CODE (CLIENT DEFINED)                                   *
  3651*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3652*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3653*  DEVIATION CODE                                                *
  3654*  ISSUE AGE                                                     *
  3655*  ORIGINAL BENEFIT AMOUNT                                       *
  3656*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3657*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3658*  BENEFIT KIND (LIFE OR A/H)                                    *
  3659*  A.P.R.                                                        *
  3660*  METHOD
  3661*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3662*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3663*  COMPANY I.D. (3 CHARACTER)                                    *
  3664*  BENEFIT CODE                                                  *
  3665*  BENEFIT OVERRIDE CODE                                         *
  3666*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3667*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  65
* SOCK03.cbl
  3668*  JOINT INDICATOR (CSL ONLY)                                    *
  3669*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3670*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3671*                                                                *
  3672*  RETURNED FROM ELRATE                                          *
  3673*  --------------------                                          *
  3674*  CALCULATED PREMIUM                                            *
  3675*  PREMIUM RATE                                                  *
  3676*  MORTALITY CODE                                                *
  3677*  MAX ATTAINED AGE                                              *
  3678*  MAX AGE                                                       *
  3679*  MAX TERM                                                      *
  3680*  MAX MONTHLY BENEFIT                                           *
  3681*  MAX TOTAL BENIFIT                                             *
  3682*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3683*----------------------------------------------------------------*
  3684*  PASSED TO ELRFND                                              *
  3685*  ----------------                                              *
  3686*  CERT ISSUE DATE                                               *
  3687*  REFUND DATE                                                   *
  3688*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3689*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3690*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3691*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3692*  STATE CODE (CLIENT DEFINED)                                   *
  3693*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3694*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3695*  DEVIATION CODE                                                *
  3696*  ISSUE AGE                                                     *
  3697*  ORIGINAL BENEFIT AMOUNT                                       *
  3698*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3699*  PROCESS TYPE (CANCEL)                                         *
  3700*  BENEFIT KIND (LIFE OR A/H)                                    *
  3701*  A.P.R.                                                        *
  3702*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3703*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3704*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3705*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3706*  COMPANY I.D. (3 CHARACTER)                                    *
  3707*  BENEFIT CODE                                                  *
  3708*  BENEFIT OVERRIDE CODE                                         *
  3709*                                                                *
  3710*  RETURNED FROM ELRFND                                          *
  3711*  --------------------                                          *
  3712*  CALCULATED REFUND                                             *
  3713*----------------------------------------------------------------*
  3714*  PASSED TO ELEARN                                              *
  3715*  ----------------                                              *
  3716*  CERT ISSUE DATE                                               *
  3717*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3718*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3719*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3720*  STATE CODE (CLIENT DEFINED)                                   *
  3721*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3722*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3723*  DEVIATION CODE                                                *
  3724*  ISSUE AGE                                                     *
  3725*  ORIGINAL BENEFIT AMOUNT                                       *
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  66
* SOCK03.cbl
  3726*  BENEFIT KIND (LIFE OR A/H)                                    *
  3727*  A.P.R.                                                        *
  3728*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3729*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3730*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3731*  COMPANY I.D. (3 CHARACTER)                                    *
  3732*  BENEFIT CODE                                                  *
  3733*  BENEFIT OVERRIDE CODE                                         *
  3734*                                                                *
  3735*  RETURNED FROM ELEARN                                          *
  3736*  --------------------                                          *
  3737*  INDICATED  EARNINGS                                           *
  3738*----------------------------------------------------------------*
  3739*                 LENGTH = 450                                   *
  3740*                                                                *
  3741******************************************************************
  3742******************************************************************
  3743*                   C H A N G E   L O G
  3744*
  3745* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3746*-----------------------------------------------------------------
  3747*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3748* EFFECTIVE    NUMBER
  3749*-----------------------------------------------------------------
  3750* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3751* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3752* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3753* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3754* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3755* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3756* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3757* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3758* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3759* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3760* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3761******************************************************************
  3762
  3763 01  CALCULATION-PASS-AREA.
  3764     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3765                                     COMP.
  3766
  3767     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3768       88  NO-CP-ERROR                             VALUE ZERO.
  3769       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3770                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3771       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3772       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3773       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3774       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3775       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3776       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3777       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3778       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3779       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3780       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3781       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3782       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3783       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  67
* SOCK03.cbl
  3784       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3785       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3786       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3787       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3788
  3789     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3790       88  NO-CP-ERROR-2                           VALUE ZERO.
  3791***********************  INPUT AREAS ****************************
  3792
  3793     12  CP-CALCULATION-AREA.
  3794         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3795         16  CP-CERT-EFF-DT        PIC XX.
  3796         16  CP-VALUATION-DT       PIC XX.
  3797         16  CP-PAID-THRU-DT       PIC XX.
  3798         16  CP-BENEFIT-TYPE       PIC X.
  3799           88  CP-AH                               VALUE 'A' 'D'
  3800                                                   'I' 'U'.
  3801           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3802           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3803         16  CP-INCURRED-DT        PIC XX.
  3804         16  CP-REPORTED-DT        PIC XX.
  3805         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3806         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3807         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-CDT-METHOD         PIC X.
  3812           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3813           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3814           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3815         16  CP-CLAIM-TYPE         PIC X.
  3816           88  CP-AH-CLAIM                         VALUE 'A'.
  3817           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3818         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3819                                     COMP-3.
  3820         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-REM-TERM-METHOD    PIC X.
  3833           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3834           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3835           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3836           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3837           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3838           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3839           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3840         16  CP-EARNING-METHOD     PIC X.
  3841           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  68
* SOCK03.cbl
  3842           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3843           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3844           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3845           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3846           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3847           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3848           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3849           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3850           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3851           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3852           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3853           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3854           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3855         16  CP-PROCESS-TYPE       PIC X.
  3856           88  CP-CLAIM                            VALUE '1'.
  3857           88  CP-CANCEL                           VALUE '2'.
  3858           88  CP-ISSUE                            VALUE '3'.
  3859         16  CP-SPECIAL-CALC-CD    PIC X.
  3860           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3861           88  CP-1-MTH-INTEREST               VALUE ' '.
  3862           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3863           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3864           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3865           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3866           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3867           88  CP-FARM-PLAN                    VALUE 'F'.
  3868           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3869           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3870           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3871           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3872           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3873           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3874           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3875           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3876           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3877           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3878                                                     'W' 'X'.
  3879           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3880           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3881           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3882           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3883           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3884           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3885           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3886           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3887           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3888           88  CP-CSL-METH-1                   VALUE '5'.
  3889           88  CP-CSL-METH-2                   VALUE '6'.
  3890           88  CP-CSL-METH-3                   VALUE '7'.
  3891           88  CP-CSL-METH-4                   VALUE '8'.
  3892
  3893         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3894                                     COMP-3.
  3895         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3896         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3897         16  CP-STATE              PIC XX          VALUE SPACE.
  3898         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3899         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  69
* SOCK03.cbl
  3900           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3901               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3902         16  CP-R78-OPTION         PIC X.
  3903           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3904           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3905
  3906         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3907         16  CP-IBNR-RESERVE-SW    PIC X.
  3908         16  CP-CLAIM-STATUS       PIC X.
  3909         16  CP-RATE-FILE          PIC X.
  3910         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3911                                     COMP-3.
  3912
  3913         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3914         16  CP-AH-OVERRIDE-CODE   PIC X.
  3915
  3916         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3917                                     COMP-3.
  3918         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3919                                   PIC S9(5)V99 COMP-3.
  3920         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3923                                     COMP-3.
  3924         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3925                                     COMP-3.
  3926         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3927                                  PIC S9(7)V99 COMP-3.
  3928
  3929         16  CP-PAID-FROM-DATE     PIC X(02).
  3930         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3931         16  CP-EXT-DAYS-CALC      PIC X.
  3932           88  CP-EXT-NO-CHG                   VALUE ' '.
  3933           88  CP-EXT-CHG-LF                   VALUE '1'.
  3934           88  CP-EXT-CHG-AH                   VALUE '2'.
  3935           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3936         16  CP-DOMICILE-STATE     PIC XX.
  3937         16  CP-CARRIER            PIC X.
  3938         16  CP-REIN-FLAG          PIC X.
  3939         16  CP-REM-TRM-CALC-OPTION PIC X.
  3940           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3941                      '2' '3' '4' '5'.
  3942           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3943           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3944           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3945           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3946           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3947           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3948           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3949           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3950         16  CP-SIG-SWITCH         PIC X.
  3951         16  CP-RATING-METHOD      PIC X.
  3952           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3953           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3954           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3955           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3956           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3957           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  70
* SOCK03.cbl
  3958           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3959           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3960           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3961         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3962                                     COMP-3.
  3963         16  CP-BEN-CATEGORY       PIC X.
  3964         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3965         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3966                                   PIC S99V9(5) COMP-3.
  3967         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3968         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3969                                   PIC S99V9(5) COMP-3.
  3970         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3971         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3972         16  CP-EXPIRE-DT          PIC XX.
  3973         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3974         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3975         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3976         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3977         16  CP-DDF-SPEC-CALC      PIC X.
  3978             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3979             88  CP-CALC-CLP              VALUE 'C'.
  3980         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3981         16  CP-CANCEL-REASON      PIC X.
  3982         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3983         16  CP-PMT-MODE           PIC X.
  3984         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3985         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3986         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3987         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3988         16  FILLER                PIC X.
  3989
  3990***************    OUTPUT FROM ELRESV   ************************
  3991
  3992         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3993
  3994         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3995                                     COMP-3.
  3996         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3997                                     COMP-3.
  3998         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3999                                     COMP-3.
  4000         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  4001                                     COMP-3.
  4002         16  FILLER                PIC X(09).
  4003***************    OUTPUT FROM ELRTRM   *************************
  4004
  4005         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  4006                                     COMP-3.
  4007         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  4008                                     COMP-3.
  4009         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  4010                                     COMP-3.
  4011         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  4012                                     COMP-3.
  4013         16  FILLER                PIC X(12).
  4014
  4015***************    OUTPUT FROM ELRAMT   *************************
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  71
* SOCK03.cbl
  4016
  4017         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  4018                                     COMP-3.
  4019         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  4020                                     COMP-3.
  4021         16  FILLER                PIC X(12).
  4022
  4023***************    OUTPUT FROM ELRATE   *************************
  4024
  4025         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  4026                                     COMP-3.
  4027         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  4028                                     COMP-3.
  4029         16  CP-MORTALITY-CODE     PIC X(4).
  4030         16  CP-RATE-EDIT-FLAG     PIC X.
  4031             88  CP-RATES-NEED-APR                  VALUE '1'.
  4032         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  4033                                     COMP-3.
  4034         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  4035         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  4036         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  4037                                   PIC S9(7)V99 COMP-3.
  4038         16  FILLER                PIC X(07).
  4039
  4040***************    OUTPUT FROM ELRFND   *************************
  4041
  4042         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  4043                                     COMP-3.
  4044         16  CP-REFUND-TYPE-USED   PIC X.
  4045           88  CP-R-AS-R78                         VALUE '1'.
  4046           88  CP-R-AS-PRORATA                     VALUE '2'.
  4047           88  CP-R-AS-CALIF                       VALUE '3'.
  4048           88  CP-R-AS-TEXAS                       VALUE '4'.
  4049           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  4050           88  CP-R-AS-NET-PAY                     VALUE '5'.
  4051           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  4052           88  CP-R-AS-MEAN                        VALUE '8'.
  4053           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  4054           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  4055           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  4056           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  4057           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  4058           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  4059         16  FILLER                PIC X(12).
  4060
  4061***************    OUTPUT FROM ELEARN   *************************
  4062
  4063         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  4064                                     COMP-3.
  4065         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  4066                                     COMP-3.
  4067         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  4068                                     COMP-3.
  4069         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  4070                                     COMP-3.
  4071         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  4072                                     COMP-3.
  4073         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  72
* SOCK03.cbl
  4074                                     COMP-3.
  4075         16  CP-EARNING-TYPE-USED  PIC X.
  4076           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  4077           88  CP-E-AS-R78                         VALUE '1'.
  4078           88  CP-E-AS-PRORATA                     VALUE '2'.
  4079           88  CP-E-AS-TEXAS                       VALUE '4'.
  4080           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  4081           88  CP-E-AS-NET-PAY                     VALUE '5'.
  4082           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  4083           88  CP-E-AS-MEAN                        VALUE '8'.
  4084           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  4085         16  FILLER                PIC X(12).
  4086
  4087***************    OUTPUT FROM ELPMNT   *************************
  4088
  4089         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  4090                                     COMP-3.
  4091         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  4092                                     COMP-3.
  4093         16  FILLER                PIC X(12).
  4094
  4095***************   MISC WORK AREAS    *****************************
  4096         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4097                                     COMP-3.
  4098         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4099                                     COMP-3.
  4100         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4101                                     COMP-3.
  4102         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4103                                     COMP-3.
  4104         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4105                                     COMP-3.
  4106         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4107                                     COMP-3.
  4108         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4109             88  OPEN-RATE-FILE                   VALUE 'O'.
  4110             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4111             88  IO-ERROR                         VALUE 'E'.
  4112
  4113         16  CP-FIRST-PAY-DATE     PIC XX.
  4114
  4115         16  CP-JOINT-INDICATOR    PIC X.
  4116
  4117         16  CP-RESERVE-REMAINING-TERM
  4118                                   PIC S9(4)V9    VALUE ZERO
  4119                                     COMP-3.
  4120
  4121         16  CP-INSURED-BIRTH-DT   PIC XX.
  4122
  4123         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4124                                     COMP-3.
  4125
  4126         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4127                                     COMP-3.
  4128
  4129         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4130                                     COMP-3.
  4131
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  73
* SOCK03.cbl
  4132         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4133                                     COMP-3.
  4134
  4135         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4136                                     COMP-3.
  4137
  4138         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4139                                     COMP-3.
  4140
  4141         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4142                                     COMP-3.
  4143
  4144         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4145             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4146
  4147         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4148                                     COMP-3.
  4149         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4150                                     COMP-3.
  4151         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  4152         16  cp-extra-periods      pic 9 value zeros.
  4153         16  cp-net-only-state     pic x value spaces.
  4154         16  FILLER                PIC X(13).
  4155******************************************************************
  4156****************************************************************
  4157*
  4158* Copyright (c) 2007-2013 Dell Inc.
  4159* All rights reserved.
  4160*
  4161****************************************************************
  4162 01  DFHEIV.
  4163   02  DFHEIV0               PIC X(35).
  4164   02  DFHEIV1               PIC X(08).
  4165   02  DFHEIV2               PIC X(08).
  4166   02  DFHEIV3               PIC X(08).
  4167   02  DFHEIV4               PIC X(06).
  4168   02  DFHEIV5               PIC X(04).
  4169   02  DFHEIV6               PIC X(04).
  4170   02  DFHEIV7               PIC X(02).
  4171   02  DFHEIV8               PIC X(02).
  4172   02  DFHEIV9               PIC X(01).
  4173   02  DFHEIV10              PIC S9(7) COMP-3.
  4174   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4175   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4176   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4177   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4178   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4179   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4180   02  DFHEIV17              PIC X(04).
  4181   02  DFHEIV18              PIC X(04).
  4182   02  DFHEIV19              PIC X(04).
  4183   02  DFHEIV20              USAGE IS POINTER.
  4184   02  DFHEIV21              USAGE IS POINTER.
  4185   02  DFHEIV22              USAGE IS POINTER.
  4186   02  DFHEIV23              USAGE IS POINTER.
  4187   02  DFHEIV24              USAGE IS POINTER.
  4188   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4189   02  DFHEIV26              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  74
* SOCK03.cbl
  4190   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4191   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4192   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4193   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4194   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4195   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4196   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4197   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4198   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4199   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4200   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4201   02  FILLER                PIC X(02).
  4202   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4203   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4204   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4205   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4206   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4207   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4208   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4209 LINKAGE  SECTION.
  4210*****************************************************************
  4211*                                                               *
  4212* Copyright (c) 2007-2013 Dell Inc.                             *
  4213* All rights reserved.                                          *
  4214*                                                               *
  4215*****************************************************************
  4216 01  dfheiblk.
  4217     02  eibtime          pic s9(7) comp-3.
  4218     02  eibdate          pic s9(7) comp-3.
  4219     02  eibtrnid         pic x(4).
  4220     02  eibtaskn         pic s9(7) comp-3.
  4221     02  eibtrmid         pic x(4).
  4222     02  dfheigdi         pic s9(4) comp.
  4223     02  eibcposn         pic s9(4) comp.
  4224     02  eibcalen         pic s9(4) comp.
  4225     02  eibaid           pic x(1).
  4226     02  eibfiller1       pic x(1).
  4227     02  eibfn            pic x(2).
  4228     02  eibfiller2       pic x(2).
  4229     02  eibrcode         pic x(6).
  4230     02  eibfiller3       pic x(2).
  4231     02  eibds            pic x(8).
  4232     02  eibreqid         pic x(8).
  4233     02  eibrsrce         pic x(8).
  4234     02  eibsync          pic x(1).
  4235     02  eibfree          pic x(1).
  4236     02  eibrecv          pic x(1).
  4237     02  eibsend          pic x(1).
  4238     02  eibatt           pic x(1).
  4239     02  eibeoc           pic x(1).
  4240     02  eibfmh           pic x(1).
  4241     02  eibcompl         pic x(1).
  4242     02  eibsig           pic x(1).
  4243     02  eibconf          pic x(1).
  4244     02  eiberr           pic x(1).
  4245     02  eibrldbk         pic x(1).
  4246     02  eiberrcd         pic x(4).
  4247     02  eibsynrb         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  75
* SOCK03.cbl
  4248     02  eibnodat         pic x(1).
  4249     02  eibfiller5       pic x(2).
  4250     02  eibresp          pic s9(8) comp.
  4251     02  eibresp2         pic s9(8) comp.
  4252     02  dfheigdj         pic s9(4) comp.
  4253     02  dfheigdk         pic s9(4) comp.
  4254 01  DFHCOMMAREA.
  4255   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  4256   05 LSTN-NAME                PIC X(8).
  4257   05 LSTN-SUBNAME             PIC X(8).
  4258   05 CLIENT-IN-DATA.
  4259      15  CLIENT-CAR           PIC X.
  4260      15  CLIENT-GRP           PIC X(6).
  4261      15  CLIENT-STATE         PIC XX.
  4262      15  CLIENT-ACCOUNT       PIC X(10).
  4263*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  4264      15  CLIENT-EFF-DT        PIC X(8).
  4265      15  CLIENT-CERT-NO       PIC X(11).
  4266      15  CLIENT-LAST-NAME     PIC X(15).
  4267      15  CLIENT-FIRST-NAME    PIC X(10).
  4268      15  CLIENT-VAL-DT        PIC X(8).
  4269      15  CLIENT-CAN-REASON    PIC X.
  4270   05 SOCKADDR-IN-PARM.
  4271     15 SIN-FAMILY             PIC 9(4) COMP.
  4272     15 SIN-PORT               PIC 9(4) COMP.
  4273     15 SIN-ADDRESS            PIC 9(8) COMP.
  4274     15 SIN-ZERO               PIC X(8).
  4275 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  4276 0000-DFHEXIT SECTION.
  4277     MOVE '9#                    $   ' TO DFHEIV0.
  4278     MOVE 'SOCK03' TO DFHEIV1.
  4279     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4280     display '  BEGIN SOCK03 '
  4281     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  4282     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  4283     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  4284        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  4285        evaluate true
  4286           when client-in-data (8:3) = 'AHL'
  4287              MOVE X'06'         TO WS-COMP-CD
  4288              MOVE 'AHL'         TO WS-SEND-BUF (5:3)
  4289                                    WS-COMP-ID
  4290           when CLIENT-IN-DATA (8:3) = 'DCC'
  4291              MOVE X'05'         TO WS-COMP-CD
  4292              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  4293                                    WS-COMP-ID
  4294           when CLIENT-IN-DATA (8:3) = 'VPP'
  4295              MOVE X'07'         TO WS-COMP-CD
  4296              MOVE 'VPP'         TO WS-SEND-BUF (5:3)
  4297                                    WS-COMP-ID
  4298           when other
  4299              MOVE X'04'         TO WS-COMP-CD
  4300              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  4301                                    WS-COMP-ID
  4302        end-evaluate
  4303        move 'CSO'               to ws-send-buf (1:3)
  4304        move +25                 to ws-send-msg-size
  4305     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  76
* SOCK03.cbl
  4306     display 'SOCK03:sequence number  =', ws-seq-num.
  4307     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  4308     call "send" using by value GIVE-TAKE-SOCKET,
  4309         by reference ws-send-buf,
  4310         by value ws-send-msg-size,
  4311         by value ws-flags.
  4312     if return-code <= zero
  4313         display 'SOCK03:send error ',
  4314         go to socket-error.
  4315     move low-values to ws-recv-buf.
  4316     set ws-recv-total to zero.
  4317     compute ws-recv-left = ws-recv-msg-size.
  4318     display 'SOCK03:About to recv '
  4319     call "recv" using by value GIVE-TAKE-SOCKET,
  4320         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4321         by value ws-recv-left,
  4322         by value ws-flags.
  4323     if return-code < zero
  4324        display 'SOCK03:recv error ',
  4325        go to socket-error.
  4326     if return-code = zero
  4327        display 'SOCK03:client disconnected',
  4328        go to socket-error.
  4329*
  4330     display 'SOCK03:Good recv  '
  4331     display 'SOCK03:return code      = ', return-code
  4332     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  4333     move +4096                  to ws-send-msg-size
  4334*    move +750                   to ws-send-msg-size
  4335     move ws-recv-buf (1:72)     to client-in-data
  4336     MOVE SPACES                 TO WS-ELCERT-SW
  4337     MOVE X'0A'                  TO WS-HEX-0A
  4338     if client-account = 'EPIQ000001'
  4339        set ws-epiq-request to true
  4340        move spaces              to client-account
  4341     end-if
  4342     move +0 to ws-epiq-max
  4343     EVALUATE TRUE
  4344        WHEN (CLIENT-CAR NOT = SPACES)
  4345           AND (CLIENT-STATE NOT = SPACES)
  4346           AND (CLIENT-ACCOUNT NOT = SPACES)
  4347           AND (CLIENT-EFF-DT NOT = SPACES)
  4348           AND (CLIENT-CERT-NO NOT = SPACES)
  4349           SET WS-ELCERT-FULL    TO TRUE
  4350           DISPLAY ' SETTING FULL '
  4351        WHEN (CLIENT-CERT-NO NOT = SPACES)
  4352           SET WS-ELCERT-CERT-NO TO TRUE
  4353           DISPLAY ' SETTING CERT NO '
  4354*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  4355*          AND (CLIENT-LAST-NAME NOT = SPACES)
  4356        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  4357           AND (CLIENT-LAST-NAME NOT = SPACES)
  4358           SET WS-ELCERT-ACT-NAME TO TRUE
  4359        WHEN CLIENT-LAST-NAME NOT = SPACES
  4360           SET WS-ELCERT-NAME    TO TRUE
  4361           DISPLAY ' SETTING NAME '
  4362        WHEN OTHER
  4363           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  77
* SOCK03.cbl
  4364           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4365           MOVE ZEROS            TO WS-RESP
  4366           PERFORM 0030-BUILD-BUFFER
  4367                                 THRU 0030-EXIT
  4368           PERFORM 0020-SEND-BUFFER
  4369                                 THRU 0020-EXIT
  4370           PERFORM 0025-CLOSE-SOCKET
  4371                                 THRU 0025-EXIT
  4372           GO TO 0010-RETURN
  4373     END-EVALUATE
  4374     IF CLIENT-CAN-REASON = 'R'
  4375        MOVE 'R'                 TO WS-CANCEL-REASON
  4376     ELSE
  4377        MOVE ' '                 TO WS-CANCEL-REASON
  4378     END-IF
  4379     IF WS-ELCERT-KEY-SW NOT = SPACES
  4380        PERFORM 0050-BEGIN-REFUND-PROCESS
  4381                                 THRU 0050-EXIT
  4382     END-IF
  4383     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  4384     .
  4385 0010-RETURN.
  4386
  4387* exec cics return end-exec.
  4388*    MOVE '.(                    ''   #00004382' TO DFHEIV0
  4389     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4391     MOVE X'2020233030303034333832' TO DFHEIV0(25:11)
  4392     CALL 'kxdfhei1' USING DFHEIV0,
  4393           DFHEIV99,
  4394           DFHEIV99,
  4395           DFHEIV99,
  4396           DFHEIV99,
  4397           DFHEIV99,
  4398           DFHEIV99
  4399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4400
  4401
  4402* goback.
  4403     MOVE '9%                    "   ' TO DFHEIV0
  4404     MOVE 'SOCK03' TO DFHEIV1
  4405     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4406     goback.
  4407*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4408     .
  4409 0020-SEND-BUFFER.
  4410     display 'SOCK03:About to send      '
  4411     display 'SOCK03:sequence number  =', ws-seq-num.
  4412     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  4413     call "send" using by value GIVE-TAKE-SOCKET,
  4414         by reference ws-send-buf,
  4415         by value ws-send-msg-size,
  4416         by value ws-flags.
  4417     if return-code <= zero
  4418         display 'SOCK03:send error ' return-code,
  4419         go to socket-error.
  4420 0020-EXIT.
  4421     EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  78
* SOCK03.cbl
  4422 0025-CLOSE-SOCKET.
  4423*    display 'SOCK03:closing socket'.
  4424*    call "close" using by value GIVE-TAKE-SOCKET .
  4425     display 'SOCK03:done'.
  4426     .
  4427 0025-EXIT.
  4428     EXIT.
  4429*
  4430* set up the receive buffer
  4431*
  4432     move low-values to ws-recv-buf.
  4433     set ws-recv-total to zero.
  4434     compute ws-recv-left = ws-recv-msg-size.
  4435*
  4436* receive data
  4437*
  4438 recv-1.
  4439     call "recv" using by value GIVE-TAKE-SOCKET,
  4440         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  4441         by value ws-recv-left,
  4442         by value ws-flags.
  4443*
  4444* test what was received and decide what we should do
  4445*
  4446     if return-code < zero
  4447        display 'SOCK03:recv error ',
  4448        go to socket-error.
  4449     if return-code = zero
  4450        display 'SOCK03:client disconnected',
  4451        go to socket-error.
  4452*
  4453* have we received all the data yet?
  4454*
  4455     compute ws-recv-total = ws-recv-total + return-code.
  4456     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  4457*
  4458* not yet
  4459*
  4460     if ws-recv-left > 0 go to recv-1.
  4461*
  4462* received all the data
  4463*
  4464     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  4465*
  4466* make sure what we received was what we sent
  4467*
  4468*    if ws-recv-buf <> ws-send-buf
  4469*        display "SOCK03:data doesn't match",
  4470*        go to socket-error.
  4471*
  4472* end of pass
  4473*
  4474*loop-end.
  4475*    if ws-seq-num = 5 go to socket-error.
  4476*    go to loop-1.
  4477*
  4478* program end
  4479*
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  79
* SOCK03.cbl
  4480 socket-error.
  4481     if ws-seq-num <> 0
  4482         display "SOCK03:did not complete".
  4483*
  4484* flush the send buffer and deallocate
  4485*
  4486*    display 'SOCK03:closing socket'.
  4487*    call "close" using by value GIVE-TAKE-SOCKET .
  4488*
  4489* finised return to cics
  4490*
  4491 socket-fin.
  4492*    display 'SOCK03:closing socket'.
  4493*    call "close" using by value GIVE-TAKE-SOCKET .
  4494     display 'SOCK03:done'.
  4495
  4496* exec cics return end-exec.
  4497*    MOVE '.(                    ''   #00004472' TO DFHEIV0
  4498     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4499     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4500     MOVE X'2020233030303034343732' TO DFHEIV0(25:11)
  4501     CALL 'kxdfhei1' USING DFHEIV0,
  4502           DFHEIV99,
  4503           DFHEIV99,
  4504           DFHEIV99,
  4505           DFHEIV99,
  4506           DFHEIV99,
  4507           DFHEIV99
  4508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4509
  4510
  4511* goback.
  4512     MOVE '9%                    "   ' TO DFHEIV0
  4513     MOVE 'SOCK03' TO DFHEIV1
  4514     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4515     goback.
  4516 0030-BUILD-BUFFER.
  4517     MOVE SPACES                 TO WS-SEND-BUF
  4518     IF WS-CALL-TYPE = 'NEWBUS'
  4519        STRING
  4520           WS-COMMENT            ';'
  4521           WS-RESP               ';'
  4522           WS-CARRIER            ';'
  4523           WS-GROUPING           ';'
  4524           WS-STATE              ';'
  4525           WS-ACCOUNT            ';'
  4526           WS-CERT-EFF-DATE      ';'
  4527           WS-CERT-NO            ';'
  4528           WS-LAST-NAME          ';'
  4529           WS-FIRST-NAME         ';'
  4530           WS-MID-INIT           ';'
  4531           WS-LAST-JNAME         ';'
  4532           WS-FIRST-JNAME        ';'
  4533           WS-MID-JINIT          ';'
  4534           WS-POST-CARD-SW       ';'
  4535           ws-lf-coverage-type   ';'
  4536           WS-LF-STATUS          ';'
  4537           WS-LF-BEN-CODE        ';'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  80
* SOCK03.cbl
  4538           WS-LF-BEN-CODE-DESC   ';'
  4539           WS-LF-TERM            ';'
  4540           WS-LF-REM-TERM        ';'
  4541           WS-LF-PREM            ';'
  4542           WS-LF-REFUND          ';'
  4543           WS-LF-METHOD          ';'
  4544           WS-LF-ORIG-BENEFIT    ';'
  4545           WS-LF-REM-BEN         ';'
  4546           WS-LF-EXPIRE-DATE     ';'
  4547           WS-LF-COMM            ';'
  4548           WS-LF-UEC             ';'
  4549           WS-AH-COVERAGE-TYPE   ';'
  4550           WS-AH-STATUS          ';'
  4551           WS-AH-BEN-CODE        ';'
  4552           WS-AH-BEN-CODE-DESC   ';'
  4553           WS-AH-TERM            ';'
  4554           WS-AH-REM-TERM        ';'
  4555           WS-AH-PREM            ';'
  4556           WS-AH-REFUND          ';'
  4557           WS-AH-METHOD          ';'
  4558           WS-AH-ORIG-BENEFIT    ';'
  4559           WS-AH-REM-BEN         ';'
  4560           WS-AH-EXPIRE-DATE     ';'
  4561           WS-AH-COMM            ';'
  4562           WS-AH-UEC             ';'
  4563           WS-ACCOUNT-NAME       ';'
  4564           WS-REPORT-CODE-1      ';'
  4565           WS-REPORT-CODE-2      ';'
  4566           WS-REPORT-CODE-3      ';'
  4567           WS-CLM-PAID-THRU-DT   ';'
  4568           WS-LF-CANCEL-DATE     ';'
  4569           WS-AH-CANCEL-DATE     ';'
  4570           WS-VIN                ';'
  4571           WS-CRED-BENE-NAME     ';'
  4572           WS-HEX-0A
  4573            DELIMITED BY '  ' INTO WS-SEND-BUF
  4574        END-STRING
  4575     ELSE
  4576        STRING
  4577           WS-COMMENT            ';'
  4578           WS-RESP               ';'
  4579           WS-CARRIER            ';'
  4580           WS-GROUPING           ';'
  4581           WS-STATE              ';'
  4582           WS-ACCOUNT            ';'
  4583           WS-CERT-EFF-DATE      ';'
  4584           WS-CERT-NO            ';'
  4585           WS-LAST-NAME          ';'
  4586           WS-FIRST-NAME         ';'
  4587           WS-MID-INIT           ';'
  4588           WS-LAST-JNAME         ';'
  4589           WS-FIRST-JNAME        ';'
  4590           WS-MID-JINIT          ';'
  4591           WS-POST-CARD-SW       ';'
  4592           WS-LF-STATUS          ';'
  4593           WS-LF-BEN-CODE        ';'
  4594           WS-LF-BEN-CODE-DESC   ';'
  4595           WS-LF-TERM            ';'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  81
* SOCK03.cbl
  4596           WS-LF-REM-TERM        ';'
  4597           WS-LF-PREM            ';'
  4598           WS-LF-REFUND          ';'
  4599           WS-LF-METHOD          ';'
  4600           WS-LF-ORIG-BENEFIT    ';'
  4601           WS-LF-REM-BEN         ';'
  4602           WS-LF-EXPIRE-DATE     ';'
  4603           WS-LF-COMM            ';'
  4604           WS-LF-UEC             ';'
  4605           WS-AH-STATUS          ';'
  4606           WS-AH-BEN-CODE        ';'
  4607           WS-AH-BEN-CODE-DESC   ';'
  4608           WS-AH-TERM            ';'
  4609           WS-AH-REM-TERM        ';'
  4610           WS-AH-PREM            ';'
  4611           WS-AH-REFUND          ';'
  4612           WS-AH-METHOD          ';'
  4613           WS-AH-ORIG-BENEFIT    ';'
  4614           WS-AH-REM-BEN         ';'
  4615           WS-AH-EXPIRE-DATE     ';'
  4616           WS-AH-COMM            ';'
  4617           WS-AH-UEC             ';'
  4618           WS-ACCOUNT-NAME       ';'
  4619           WS-REPORT-CODE-1      ';'
  4620           WS-REPORT-CODE-2      ';'
  4621           WS-REPORT-CODE-3      ';'
  4622           WS-CLM-PAID-THRU-DT   ';'
  4623           WS-LF-CANCEL-DATE     ';'
  4624           WS-AH-CANCEL-DATE     ';'
  4625           WS-VIN                ';'
  4626           WS-CRED-BENE-NAME     ';'
  4627           'E'                   ';'
  4628            DELIMITED BY '  ' INTO WS-SEND-BUF
  4629        END-STRING
  4630     END-IF
  4631     .
  4632 0030-EXIT.
  4633     EXIT.
  4634 0050-BEGIN-REFUND-PROCESS.
  4635     IF WS-ELCERT-ACT-NAME
  4636        PERFORM 0060-FIND-FULL-KEY
  4637                                 THRU 0060-EXIT
  4638        MOVE AM-CARRIER          TO CLIENT-CAR
  4639        MOVE AM-GROUPING         TO CLIENT-GRP
  4640        MOVE AM-STATE            TO CLIENT-STATE
  4641     END-IF
  4642     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4643     IF NOT RESP-NORMAL
  4644        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4645        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4646        MOVE WS-RESPONSE         TO WS-RESP
  4647        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4648        PERFORM 0020-SEND-BUFFER
  4649                                 THRU 0020-EXIT
  4650        PERFORM 0025-CLOSE-SOCKET
  4651                                 THRU 0025-EXIT
  4652        GO TO 0010-RETURN
  4653     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  82
* SOCK03.cbl
  4654     PERFORM 0150-READ-NEXT-ELCERT
  4655                                 THRU 0150-EXIT
  4656*    display ' came back from 0150 ' ws-response
  4657     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4658        DISPLAY ' CERT NOT FOUND '
  4659        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4660        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4661        MOVE WS-RESPONSE         TO WS-RESP
  4662        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4663        PERFORM 0020-SEND-BUFFER
  4664                                 THRU 0020-EXIT
  4665        PERFORM 0025-CLOSE-SOCKET
  4666                                 THRU 0025-EXIT
  4667        GO TO 0010-RETURN
  4668     END-IF
  4669     PERFORM 0200-BEGIN-REFUND-PROCESS
  4670                                 THRU 0200-EXIT UNTIL
  4671        ELCERT-FINISHED
  4672     .
  4673 0050-EXIT.
  4674     EXIT.
  4675 0060-FIND-FULL-KEY.
  4676     MOVE ' ' TO WS-STOP-SW
  4677     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4678     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4679
  4680* EXEC CICS STARTBR
  4681*       DATASET  ('ERACCT3')
  4682*       RIDFLD   (WS-AM3-KEY)
  4683*       GTEQ
  4684*       RESP (WS-RESPONSE)
  4685*    END-EXEC
  4686     MOVE 'ERACCT3' TO DFHEIV1
  4687     MOVE 0
  4688       TO DFHEIV11
  4689*    MOVE '&,         G          &  N#00004637' TO DFHEIV0
  4690     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4691     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4692     MOVE X'204E233030303034363337' TO DFHEIV0(25:11)
  4693     CALL 'kxdfhei1' USING DFHEIV0,
  4694           DFHEIV1,
  4695           WS-AM3-KEY,
  4696           DFHEIV99,
  4697           DFHEIV11,
  4698           DFHEIV99
  4699     MOVE EIBRESP  TO WS-RESPONSE
  4700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4701     IF RESP-NORMAL
  4702        PERFORM UNTIL TOLD-TO-STOP
  4703
  4704* EXEC CICS READNEXT
  4705*             DATASET  ('ERACCT3')
  4706*             INTO     (ACCOUNT-MASTER)
  4707*             RIDFLD   (WS-AM3-KEY)
  4708*          END-EXEC
  4709     MOVE LENGTH OF
  4710      ACCOUNT-MASTER
  4711       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  83
* SOCK03.cbl
  4712     MOVE 'ERACCT3' TO DFHEIV1
  4713     MOVE 0
  4714       TO DFHEIV11
  4715*    MOVE '&.IL                  )   #00004645' TO DFHEIV0
  4716     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4717     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4718     MOVE X'2020233030303034363435' TO DFHEIV0(25:11)
  4719     CALL 'kxdfhei1' USING DFHEIV0,
  4720           DFHEIV1,
  4721           ACCOUNT-MASTER,
  4722           DFHEIV12,
  4723           WS-AM3-KEY,
  4724           DFHEIV99,
  4725           DFHEIV11,
  4726           DFHEIV99,
  4727           DFHEIV99
  4728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4729           EVALUATE TRUE
  4730              WHEN (RESP-NORMAL)
  4731                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4732                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4733                 SET TOLD-TO-STOP TO TRUE
  4734              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4735                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4736                 CONTINUE
  4737              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4738                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4739                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4740                 MOVE ZEROS      TO WS-RESP
  4741                 PERFORM 0030-BUILD-BUFFER
  4742                                 THRU 0030-EXIT
  4743                 PERFORM 0020-SEND-BUFFER
  4744                                 THRU 0020-EXIT
  4745                 PERFORM 0025-CLOSE-SOCKET
  4746                                 THRU 0025-EXIT
  4747                 GO TO 0010-RETURN
  4748           END-EVALUATE
  4749        END-PERFORM
  4750
  4751* EXEC CICS ENDBR
  4752*          DATASET   ('ERACCT3')
  4753*       END-EXEC
  4754     MOVE 'ERACCT3' TO DFHEIV1
  4755     MOVE 0
  4756       TO DFHEIV11
  4757*    MOVE '&2                    $   #00004671' TO DFHEIV0
  4758     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4759     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4760     MOVE X'2020233030303034363731' TO DFHEIV0(25:11)
  4761     CALL 'kxdfhei1' USING DFHEIV0,
  4762           DFHEIV1,
  4763           DFHEIV11,
  4764           DFHEIV99
  4765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4766     ELSE
  4767        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4768        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4769        MOVE ZEROS      TO WS-RESP
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  84
* SOCK03.cbl
  4770        PERFORM 0030-BUILD-BUFFER
  4771                                 THRU 0030-EXIT
  4772        PERFORM 0020-SEND-BUFFER
  4773                                 THRU 0020-EXIT
  4774        PERFORM 0025-CLOSE-SOCKET
  4775                                 THRU 0025-EXIT
  4776        GO TO 0010-RETURN
  4777     END-IF
  4778     .
  4779 0060-EXIT.
  4780     EXIT.
  4781 0100-START-ELCERT.
  4782     MOVE SPACES                 TO WS-SEND-BUF
  4783     INITIALIZE WS-STRING-DATA
  4784     MOVE LOW-VALUES             TO WS-CM-KEY
  4785                                    WS-CM-KEY-A1
  4786                                    WS-CM-KEY-A4
  4787     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4788                                    WS-CM-COMPANY-CD-A1
  4789                                    WS-CM-COMPANY-CD-A4
  4790     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4791     MOVE 'L'                    TO DC-OPTION-CODE
  4792     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4793     IF NO-CONVERSION-ERROR
  4794        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4795     ELSE
  4796        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4797        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4798        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4799        PERFORM 0020-SEND-BUFFER
  4800                                 THRU 0020-EXIT
  4801        PERFORM 0025-CLOSE-SOCKET
  4802                                 THRU 0025-EXIT
  4803        GO TO 0010-RETURN
  4804     END-IF
  4805     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4806        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4807        MOVE 'L'                 TO DC-OPTION-CODE
  4808        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4809        IF NO-CONVERSION-ERROR
  4810           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4811        ELSE
  4812           MOVE 'BAD EFF DT CONVERT '
  4813                                 TO WS-COMMENT
  4814           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4815           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4816           PERFORM 0020-SEND-BUFFER
  4817                                 THRU 0020-EXIT
  4818           PERFORM 0025-CLOSE-SOCKET
  4819                                 THRU 0025-EXIT
  4820           GO TO 0010-RETURN
  4821        END-IF
  4822     END-IF
  4823     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4824        (F1 > +10)
  4825        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4826     END-PERFORM
  4827     IF F1 > +1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  85
* SOCK03.cbl
  4828        SUBTRACT +1 FROM F1
  4829     END-IF
  4830     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4831        (L1 > +15)
  4832        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4833     END-PERFORM
  4834     IF L1 > +1
  4835        SUBTRACT +1 FROM L1
  4836     END-IF
  4837     EVALUATE TRUE
  4838        WHEN WS-ELCERT-FULL
  4839           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4840           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4841           MOVE CLIENT-STATE        TO WS-CM-STATE
  4842           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4843           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4844           MOVE CLIENT-CERT-NO (1:10)
  4845                                    TO WS-CM-CERT-NO
  4846
  4847* EXEC CICS READ
  4848*             INTO    (CERTIFICATE-MASTER)
  4849*             DATASET ('ELCERT')
  4850*             RIDFLD  (WS-CM-KEY)
  4851*             RESP    (WS-RESPONSE)
  4852*          END-EXEC
  4853     MOVE LENGTH OF
  4854      CERTIFICATE-MASTER
  4855       TO DFHEIV11
  4856     MOVE 'ELCERT' TO DFHEIV1
  4857*    MOVE '&"IL       E          (  N#00004755' TO DFHEIV0
  4858     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4859     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4860     MOVE X'204E233030303034373535' TO DFHEIV0(25:11)
  4861     CALL 'kxdfhei1' USING DFHEIV0,
  4862           DFHEIV1,
  4863           CERTIFICATE-MASTER,
  4864           DFHEIV11,
  4865           WS-CM-KEY,
  4866           DFHEIV99,
  4867           DFHEIV99,
  4868           DFHEIV99
  4869     MOVE EIBRESP  TO WS-RESPONSE
  4870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4871        WHEN WS-ELCERT-ACT-NAME
  4872           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4873           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4874           MOVE CLIENT-STATE        TO WS-CM-STATE
  4875           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4876           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4877           MOVE ZEROS               TO WS-CM-CERT-NO
  4878
  4879* EXEC CICS STARTBR
  4880*             DATASET ('ELCERT')
  4881*             RIDFLD  (WS-CM-KEY)
  4882*             RESP    (WS-RESPONSE)
  4883*          END-EXEC
  4884     MOVE 'ELCERT' TO DFHEIV1
  4885     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  86
* SOCK03.cbl
  4886       TO DFHEIV11
  4887*    MOVE '&,         G          &  N#00004768' TO DFHEIV0
  4888     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4889     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4890     MOVE X'204E233030303034373638' TO DFHEIV0(25:11)
  4891     CALL 'kxdfhei1' USING DFHEIV0,
  4892           DFHEIV1,
  4893           WS-CM-KEY,
  4894           DFHEIV99,
  4895           DFHEIV11,
  4896           DFHEIV99
  4897     MOVE EIBRESP  TO WS-RESPONSE
  4898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4899        WHEN WS-ELCERT-NAME
  4900           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4901           MOVE SPACES           TO WS-CM-INITIALS
  4902           COMPUTE WS-LENGTH = L1 + +1
  4903
  4904* EXEC CICS STARTBR
  4905*             DATASET   ('ELCERT2')
  4906*             RIDFLD    (WS-CM-KEY-A1)
  4907*             GENERIC
  4908*             KEYLENGTH (WS-LENGTH)
  4909*             GTEQ
  4910*             RESP      (WS-RESPONSE)
  4911*          END-EXEC
  4912     MOVE 'ELCERT2' TO DFHEIV1
  4913     MOVE 0
  4914       TO DFHEIV11
  4915*    MOVE '&,   KG    G          &  N#00004777' TO DFHEIV0
  4916     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4917     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4918     MOVE X'204E233030303034373737' TO DFHEIV0(25:11)
  4919     CALL 'kxdfhei1' USING DFHEIV0,
  4920           DFHEIV1,
  4921           WS-CM-KEY-A1,
  4922           WS-LENGTH,
  4923           DFHEIV11,
  4924           DFHEIV99
  4925     MOVE EIBRESP  TO WS-RESPONSE
  4926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4927*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4928*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4929        WHEN WS-ELCERT-CERT-NO
  4930* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4931           MOVE +11 TO WS-LENGTH
  4932           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4933
  4934* EXEC CICS STARTBR
  4935*             DATASET   ('ELCERT5')
  4936*             RIDFLD    (WS-CM-KEY-A4)
  4937*             GENERIC
  4938*             KEYLENGTH (WS-LENGTH)
  4939*             GTEQ
  4940*             RESP      (WS-RESPONSE)
  4941*          END-EXEC
  4942     MOVE 'ELCERT5' TO DFHEIV1
  4943     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  87
* SOCK03.cbl
  4944       TO DFHEIV11
  4945*    MOVE '&,   KG    G          &  N#00004791' TO DFHEIV0
  4946     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4947     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4948     MOVE X'204E233030303034373931' TO DFHEIV0(25:11)
  4949     CALL 'kxdfhei1' USING DFHEIV0,
  4950           DFHEIV1,
  4951           WS-CM-KEY-A4,
  4952           WS-LENGTH,
  4953           DFHEIV11,
  4954           DFHEIV99
  4955     MOVE EIBRESP  TO WS-RESPONSE
  4956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4957     END-EVALUATE
  4958     .
  4959 0100-EXIT.
  4960     EXIT.
  4961 0150-READ-NEXT-ELCERT.
  4962     EVALUATE TRUE
  4963        WHEN WS-ELCERT-ACT-NAME
  4964*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4965
  4966* EXEC CICS READNEXT
  4967*             DATASET   ('ELCERT')
  4968*             RIDFLD    (WS-CM-KEY)
  4969*             INTO      (CERTIFICATE-MASTER)
  4970*             RESP      (WS-RESPONSE)
  4971*          END-EXEC
  4972     MOVE LENGTH OF
  4973      CERTIFICATE-MASTER
  4974       TO DFHEIV12
  4975     MOVE 'ELCERT' TO DFHEIV1
  4976     MOVE 0
  4977       TO DFHEIV11
  4978*    MOVE '&.IL                  )  N#00004808' TO DFHEIV0
  4979     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4980     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4981     MOVE X'204E233030303034383038' TO DFHEIV0(25:11)
  4982     CALL 'kxdfhei1' USING DFHEIV0,
  4983           DFHEIV1,
  4984           CERTIFICATE-MASTER,
  4985           DFHEIV12,
  4986           WS-CM-KEY,
  4987           DFHEIV99,
  4988           DFHEIV11,
  4989           DFHEIV99,
  4990           DFHEIV99
  4991     MOVE EIBRESP  TO WS-RESPONSE
  4992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4993        WHEN WS-ELCERT-NAME
  4994*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4995
  4996* EXEC CICS READNEXT
  4997*             DATASET   ('ELCERT2')
  4998*             RIDFLD    (WS-CM-KEY-A1)
  4999*             INTO      (CERTIFICATE-MASTER)
  5000*             RESP      (WS-RESPONSE)
  5001*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  88
* SOCK03.cbl
  5002     MOVE LENGTH OF
  5003      CERTIFICATE-MASTER
  5004       TO DFHEIV12
  5005     MOVE 'ELCERT2' TO DFHEIV1
  5006     MOVE 0
  5007       TO DFHEIV11
  5008*    MOVE '&.IL                  )  N#00004816' TO DFHEIV0
  5009     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5010     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5011     MOVE X'204E233030303034383136' TO DFHEIV0(25:11)
  5012     CALL 'kxdfhei1' USING DFHEIV0,
  5013           DFHEIV1,
  5014           CERTIFICATE-MASTER,
  5015           DFHEIV12,
  5016           WS-CM-KEY-A1,
  5017           DFHEIV99,
  5018           DFHEIV11,
  5019           DFHEIV99,
  5020           DFHEIV99
  5021     MOVE EIBRESP  TO WS-RESPONSE
  5022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5023        WHEN WS-ELCERT-CERT-NO
  5024
  5025* EXEC CICS READNEXT
  5026*             DATASET   ('ELCERT5')
  5027*             RIDFLD    (WS-CM-KEY-A4)
  5028*             INTO      (CERTIFICATE-MASTER)
  5029*             RESP      (WS-RESPONSE)
  5030*          END-EXEC
  5031     MOVE LENGTH OF
  5032      CERTIFICATE-MASTER
  5033       TO DFHEIV12
  5034     MOVE 'ELCERT5' TO DFHEIV1
  5035     MOVE 0
  5036       TO DFHEIV11
  5037*    MOVE '&.IL                  )  N#00004823' TO DFHEIV0
  5038     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5039     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5040     MOVE X'204E233030303034383233' TO DFHEIV0(25:11)
  5041     CALL 'kxdfhei1' USING DFHEIV0,
  5042           DFHEIV1,
  5043           CERTIFICATE-MASTER,
  5044           DFHEIV12,
  5045           WS-CM-KEY-A4,
  5046           DFHEIV99,
  5047           DFHEIV11,
  5048           DFHEIV99,
  5049           DFHEIV99
  5050     MOVE EIBRESP  TO WS-RESPONSE
  5051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5052     END-EVALUATE
  5053     .
  5054 0150-EXIT.
  5055     EXIT.
  5056 0200-BEGIN-REFUND-PROCESS.
  5057     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5058                                    WS-ERACCT-SW
  5059     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  89
* SOCK03.cbl
  5060                                    WS-NCB-DIFF-ODD-DAYS
  5061     INITIALIZE WS-STRING-DATA
  5062     IF RESP-NORMAL OR RESP-DUPKEY
  5063        EVALUATE TRUE
  5064           WHEN WS-ELCERT-ACT-NAME
  5065              EVALUATE TRUE
  5066                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  5067                    OR (CM-CARRIER NOT = CLIENT-CAR)
  5068                    OR (CM-GROUPING NOT = CLIENT-GRP)
  5069                    OR (CM-STATE NOT = CLIENT-STATE)
  5070                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  5071                    SET ELCERT-FINISHED TO TRUE
  5072                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  5073                    CLIENT-LAST-NAME (1:L1))
  5074                    GO TO 0200-CONTINUE
  5075                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  5076                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5077                    GO TO 0200-CONTINUE
  5078                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  5079                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5080                     CLIENT-FIRST-NAME (1:F1)))
  5081                    GO TO 0200-CONTINUE
  5082                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  5083                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5084                    GO TO 0200-CONTINUE
  5085              END-EVALUATE
  5086           WHEN WS-ELCERT-CERT-NO
  5087              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5088                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  5089                 SET ELCERT-FINISHED TO TRUE
  5090              ELSE
  5091                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5092                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5093                              OR
  5094                    ((CLIENT-LAST-NAME NOT = SPACES)
  5095                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  5096                        CLIENT-LAST-NAME (1:L1)))
  5097                              OR
  5098                    ((CLIENT-FIRST-NAME NOT = SPACES)
  5099                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  5100                        CLIENT-FIRST-NAME (1:F1)))
  5101                              OR
  5102                    ((CLIENT-ACCOUNT NOT = SPACES)
  5103                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5104                     GO TO 0200-CONTINUE
  5105                 END-IF
  5106              END-IF
  5107           WHEN WS-ELCERT-NAME
  5108              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5109                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  5110                    CLIENT-LAST-NAME (1:L1))
  5111                  SET ELCERT-FINISHED TO TRUE
  5112              ELSE
  5113                 IF ((CLIENT-EFF-DT NOT = SPACES)
  5114                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5115                           OR
  5116                 ((CLIENT-FIRST-NAME NOT = SPACES)
  5117                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  90
* SOCK03.cbl
  5118                     CLIENT-FIRST-NAME (1:F1)))
  5119                           OR
  5120                 ((CLIENT-ACCOUNT NOT = SPACES)
  5121                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  5122                  GO TO 0200-CONTINUE
  5123                 END-IF
  5124              END-IF
  5125           WHEN OTHER
  5126              SET ELCERT-FINISHED   TO TRUE
  5127        END-EVALUATE
  5128     ELSE
  5129        SET ELCERT-FINISHED TO TRUE
  5130     END-IF
  5131*       IF WS-ELCERT-CERT-NO
  5132*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5133*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  5134*                          OR
  5135*                ((CLIENT-EFF-DT NOT = SPACES)
  5136*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5137*                          OR
  5138*                ((CLIENT-LAST-NAME NOT = SPACES)
  5139*                 AND (CM-INSURED-LAST-NAME NOT =
  5140*                    CLIENT-LAST-NAME))
  5141*                 SET ELCERT-FINISHED TO TRUE
  5142*          END-IF
  5143*          IF WS-ELCERT-NAME
  5144*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  5145*                OR (CM-INSURED-LAST-NAME NOT =
  5146*                   CLIENT-LAST-NAME)
  5147*                            OR
  5148*                ((CLIENT-EFF-DT NOT = SPACES)
  5149*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  5150*                 SET ELCERT-FINISHED TO TRUE
  5151*             END-IF
  5152*          ELSE
  5153*             SET ELCERT-FINISHED   TO TRUE
  5154*          END-IF
  5155     IF NOT WS-ELCERT-FULL
  5156        IF ELCERT-FINISHED
  5157           GO TO 0200-EXIT
  5158        END-IF
  5159     END-IF
  5160     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  5161        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  5162        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5163        PERFORM 0030-BUILD-BUFFER
  5164                                 THRU 0030-EXIT
  5165        PERFORM 0020-SEND-BUFFER
  5166                                 THRU 0020-EXIT
  5167        GO TO 0200-CONTINUE
  5168     END-IF
  5169     if (ws-epiq-request)
  5170        and (not EPIQ-CLASS)
  5171        go to 0200-continue
  5172     end-if
  5173
  5174     if ws-epiq-request
  5175        add +1 to ws-epiq-max
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  91
* SOCK03.cbl
  5176        if ws-epiq-max > +100
  5177           go to 0200-continue
  5178        end-if
  5179     end-if
  5180     PERFORM 0300-GET-ELCNTL-RECORDS
  5181                                 THRU 0300-EXIT
  5182     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  5183     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  5184     MOVE +0                     TO DC-ELAPSED-MONTHS
  5185                                    DC-ELAPSED-DAYS
  5186     MOVE '1'                    TO DC-OPTION-CODE
  5187     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5188     IF NO-CONVERSION-ERROR
  5189        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  5190        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  5191     END-IF
  5192     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  5193     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  5194     perform 0610-get-ermail     thru 0610-exit
  5195     perform 0620-get-elcrtt     thru 0620-exit
  5196     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  5197     IF NOT ALREADY-SENT
  5198        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  5199     END-IF
  5200     .
  5201 0200-CONTINUE.
  5202     PERFORM 0150-READ-NEXT-ELCERT
  5203                                 THRU 0150-EXIT
  5204     .
  5205 0200-EXIT.
  5206     EXIT.
  5207 0300-GET-ELCNTL-RECORDS.
  5208     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  5209     IF NOT RESP-NORMAL
  5210        MOVE ' COMPANY RECORD NOT FOUND '
  5211                                 TO WS-COMMENT
  5212        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5213        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5214        PERFORM 0020-SEND-BUFFER
  5215                                 THRU 0020-EXIT
  5216        PERFORM 0025-CLOSE-SOCKET
  5217                                 THRU 0025-EXIT
  5218        GO TO 0010-RETURN
  5219     END-IF
  5220     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  5221        PERFORM 0320-GET-LIFE-RECORD
  5222                                 THRU 0320-EXIT
  5223        IF NOT RESP-NORMAL
  5224           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  5225                                 TO WS-COMMENT
  5226           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5227           PERFORM 0030-BUILD-BUFFER
  5228                                 THRU 0030-EXIT
  5229           PERFORM 0020-SEND-BUFFER
  5230                                 THRU 0020-EXIT
  5231           PERFORM 0025-CLOSE-SOCKET
  5232                                 THRU 0025-EXIT
  5233           GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  92
* SOCK03.cbl
  5234        END-IF
  5235     END-IF
  5236     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5237        PERFORM 0330-GET-AH-RECORD
  5238                                 THRU 0330-EXIT
  5239        IF NOT RESP-NORMAL
  5240           MOVE ' AH BENEFIT RECORD NOT FOUND '
  5241                                 TO WS-COMMENT
  5242           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  5243           PERFORM 0030-BUILD-BUFFER
  5244                                 THRU 0030-EXIT
  5245           PERFORM 0020-SEND-BUFFER
  5246                                 THRU 0020-EXIT
  5247           PERFORM 0025-CLOSE-SOCKET
  5248                                 THRU 0025-EXIT
  5249           GO TO 0010-RETURN
  5250        END-IF
  5251     END-IF
  5252     PERFORM 0340-GET-STATE-RECORD
  5253                                 THRU 0340-EXIT
  5254     IF NOT RESP-NORMAL
  5255        MOVE ' STATE RECORD NOT FOUND '
  5256                                 TO WS-COMMENT
  5257        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5258        PERFORM 0030-BUILD-BUFFER
  5259                                 THRU 0030-EXIT
  5260        PERFORM 0020-SEND-BUFFER
  5261                                 THRU 0020-EXIT
  5262        PERFORM 0025-CLOSE-SOCKET
  5263                                 THRU 0025-EXIT
  5264        GO TO 0010-RETURN
  5265     END-IF
  5266     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  5267     IF NOT ERACCT-FOUND
  5268        MOVE ' ACCOUNT NOT FOUND '
  5269                                 TO WS-COMMENT
  5270        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  5271        PERFORM 0030-BUILD-BUFFER
  5272                                 THRU 0030-EXIT
  5273        PERFORM 0020-SEND-BUFFER
  5274                                 THRU 0020-EXIT
  5275        PERFORM 0025-CLOSE-SOCKET
  5276                                 THRU 0025-EXIT
  5277        GO TO 0010-RETURN
  5278     ELSE
  5279        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  5280        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  5281        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  5282        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  5283     END-IF
  5284     .
  5285 0300-EXIT.
  5286     EXIT.
  5287 0310-GET-COMPANY.
  5288     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  5289     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  5290     MOVE SPACES                 TO  WS-CF-ACCESS
  5291     MOVE +0                     TO  WS-CF-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  93
* SOCK03.cbl
  5292
  5293* EXEC CICS READ
  5294*       INTO    (CONTROL-FILE)
  5295*       DATASET ('ELCNTL')
  5296*       RIDFLD  (WS-CF-KEY)
  5297*       RESP    (WS-RESPONSE)
  5298*    END-EXEC
  5299     MOVE LENGTH OF
  5300      CONTROL-FILE
  5301       TO DFHEIV11
  5302     MOVE 'ELCNTL' TO DFHEIV1
  5303*    MOVE '&"IL       E          (  N#00005070' TO DFHEIV0
  5304     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5305     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5306     MOVE X'204E233030303035303730' TO DFHEIV0(25:11)
  5307     CALL 'kxdfhei1' USING DFHEIV0,
  5308           DFHEIV1,
  5309           CONTROL-FILE,
  5310           DFHEIV11,
  5311           WS-CF-KEY,
  5312           DFHEIV99,
  5313           DFHEIV99,
  5314           DFHEIV99
  5315     MOVE EIBRESP  TO WS-RESPONSE
  5316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5317     IF (RESP-NORMAL)
  5318        AND (CF-COMPANY-ID = WS-COMP-ID)
  5319        AND (CF-RECORD-TYPE = '1')
  5320        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  5321        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  5322        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  5323        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  5324        IF CF-DEFAULT-APR NUMERIC
  5325           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  5326        ELSE
  5327           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  5328        END-IF
  5329        IF CF-VALID-REM-TRM-OPTION
  5330           MOVE CF-REM-TRM-CALC-OPTION
  5331                                 TO WS-CF-REM-TRM-CALC-OPTION
  5332        ELSE
  5333           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  5334        END-IF
  5335     END-IF
  5336     .
  5337 0310-EXIT.
  5338     EXIT.
  5339 0320-GET-LIFE-RECORD.
  5340     MOVE '4'                    TO WS-CF-RECORD-TYPE
  5341     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5342                                    WS-LF-BEN-CODE
  5343     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5344
  5345* EXEC CICS READ
  5346*       INTO    (CONTROL-FILE)
  5347*       DATASET ('ELCNTL')
  5348*       RIDFLD  (WS-CF-KEY)
  5349*       GTEQ
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  94
* SOCK03.cbl
  5350*       RESP    (WS-RESPONSE)
  5351*    END-EXEC
  5352     MOVE LENGTH OF
  5353      CONTROL-FILE
  5354       TO DFHEIV11
  5355     MOVE 'ELCNTL' TO DFHEIV1
  5356*    MOVE '&"IL       G          (  N#00005103' TO DFHEIV0
  5357     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5358     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5359     MOVE X'204E233030303035313033' TO DFHEIV0(25:11)
  5360     CALL 'kxdfhei1' USING DFHEIV0,
  5361           DFHEIV1,
  5362           CONTROL-FILE,
  5363           DFHEIV11,
  5364           WS-CF-KEY,
  5365           DFHEIV99,
  5366           DFHEIV99,
  5367           DFHEIV99
  5368     MOVE EIBRESP  TO WS-RESPONSE
  5369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5370     IF RESP-NORMAL
  5371        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5372        AND (CF-RECORD-TYPE = '4')
  5373        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5374           (S1 > +8)
  5375           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5376        END-PERFORM
  5377        IF S1 > +8
  5378           CONTINUE
  5379        ELSE
  5380           MOVE CF-BENEFIT-DESCRIP (S1)
  5381                                 TO WS-LF-BEN-CODE-DESC
  5382           MOVE CF-LF-COVERAGE-TYPE (S1)
  5383                                 TO WS-CF-LF-COVERAGE-TYPE
  5384           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5385              MOVE 'S'           TO WS-LF-COVERAGE-TYPE
  5386           ELSE
  5387              MOVE 'J'           TO WS-LF-COVERAGE-TYPE
  5388           END-IF
  5389           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5390               MOVE CF-CO-REM-TERM-CALC (S1)
  5391                                 TO WS-LF-CO-REM-TERM-CALC
  5392           END-IF
  5393           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  5394               MOVE CF-CO-EARNINGS-CALC (S1)
  5395                                 TO WS-LF-CO-EARNINGS-CALC
  5396                                    WS-LF-CO-REFUND-CALC
  5397           END-IF
  5398           IF CF-SPECIAL-CALC-CD (S1) > ' '
  5399               MOVE CF-SPECIAL-CALC-CD (S1)
  5400                                 TO WS-LF-SPECIAL-CALC-CD
  5401           END-IF
  5402           IF CF-CO-REFUND-CALC (S1) > '0'
  5403               MOVE CF-CO-REFUND-CALC (S1)
  5404                                 TO WS-LF-CO-REFUND-CALC
  5405        END-IF
  5406     END-IF
  5407     .
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  95
* SOCK03.cbl
  5408 0320-EXIT.
  5409     EXIT.
  5410 0330-GET-AH-RECORD.
  5411     MOVE '5'                    TO WS-CF-RECORD-TYPE
  5412     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  5413     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5414
  5415* EXEC CICS READ
  5416*       INTO    (CONTROL-FILE)
  5417*       DATASET ('ELCNTL')
  5418*       RIDFLD  (WS-CF-KEY)
  5419*       GTEQ
  5420*       RESP    (WS-RESPONSE)
  5421*    END-EXEC
  5422     MOVE LENGTH OF
  5423      CONTROL-FILE
  5424       TO DFHEIV11
  5425     MOVE 'ELCNTL' TO DFHEIV1
  5426*    MOVE '&"IL       G          (  N#00005154' TO DFHEIV0
  5427     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  5428     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5429     MOVE X'204E233030303035313534' TO DFHEIV0(25:11)
  5430     CALL 'kxdfhei1' USING DFHEIV0,
  5431           DFHEIV1,
  5432           CONTROL-FILE,
  5433           DFHEIV11,
  5434           WS-CF-KEY,
  5435           DFHEIV99,
  5436           DFHEIV99,
  5437           DFHEIV99
  5438     MOVE EIBRESP  TO WS-RESPONSE
  5439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5440     IF RESP-NORMAL
  5441        AND (CF-COMPANY-ID  = WS-COMP-ID)
  5442        AND (CF-RECORD-TYPE = '5')
  5443        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5444           (S1 > +8)
  5445           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  5446        END-PERFORM
  5447        IF S1 > +8
  5448           CONTINUE
  5449        ELSE
  5450           MOVE CF-BENEFIT-DESCRIP (S1)
  5451                                 TO WS-AH-BEN-CODE-DESC
  5452           IF CF-JOINT-INDICATOR (S1) NOT = 'J'
  5453              MOVE 'S'           TO WS-AH-COVERAGE-TYPE
  5454           ELSE
  5455              MOVE 'J'           TO WS-AH-COVERAGE-TYPE
  5456           END-IF
  5457           IF CF-CO-REM-TERM-CALC (S1) > '0'
  5458              MOVE CF-CO-REM-TERM-CALC (S1)
  5459                                 TO WS-AH-CO-REM-TERM-CALC
  5460           END-IF
  5461           IF CF-CO-EARNINGS-CALC (S1) > ' '
  5462              MOVE CF-CO-EARNINGS-CALC (S1)
  5463                                 TO WS-AH-CO-EARNINGS-CALC
  5464                                    WS-AH-CO-REFUND-CALC
  5465           END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  96
* SOCK03.cbl
  5466           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  5467              MOVE CF-SPECIAL-CALC-CD (S1)
  5468                                 TO WS-AH-SPECIAL-CALC-CD
  5469           END-IF
  5470           IF CF-CO-REFUND-CALC (S1) > '0'
  5471              MOVE CF-CO-REFUND-CALC (S1)
  5472                                 TO WS-AH-CO-REFUND-CALC
  5473           END-IF
  5474           IF CF-BENEFIT-CATEGORY (S1) > ' '
  5475              MOVE CF-BENEFIT-CATEGORY (S1)
  5476                                 TO WS-AH-BEN-CATEGORY
  5477           END-IF
  5478        END-IF
  5479     END-IF
  5480     .
  5481 0330-EXIT.
  5482     EXIT.
  5483 0340-GET-STATE-RECORD.
  5484     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  5485     MOVE '3'                    TO WS-CF-RECORD-TYPE
  5486     MOVE CM-STATE               TO WS-CF-ACCESS
  5487     MOVE +0                     TO WS-CF-SEQUENCE-NO
  5488
  5489* EXEC CICS READ
  5490*       INTO    (CONTROL-FILE)
  5491*       DATASET ('ELCNTL')
  5492*       RIDFLD  (WS-CF-KEY)
  5493*       RESP    (WS-RESPONSE)
  5494*    END-EXEC
  5495     MOVE LENGTH OF
  5496      CONTROL-FILE
  5497       TO DFHEIV11
  5498     MOVE 'ELCNTL' TO DFHEIV1
  5499*    MOVE '&"IL       E          (  N#00005209' TO DFHEIV0
  5500     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5502     MOVE X'204E233030303035323039' TO DFHEIV0(25:11)
  5503     CALL 'kxdfhei1' USING DFHEIV0,
  5504           DFHEIV1,
  5505           CONTROL-FILE,
  5506           DFHEIV11,
  5507           WS-CF-KEY,
  5508           DFHEIV99,
  5509           DFHEIV99,
  5510           DFHEIV99
  5511     MOVE EIBRESP  TO WS-RESPONSE
  5512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5513     IF (RESP-NORMAL)
  5514        AND (CF-COMPANY-ID = WS-COMP-ID)
  5515        AND (CF-RECORD-TYPE = '3')
  5516        AND (CF-STATE-CODE = CM-STATE)
  5517        MOVE CF-ST-FREE-LOOK-PERIOD
  5518                                 TO WS-FREE-LOOK
  5519        MOVE CF-STATE-ABBREVIATION
  5520                                 TO WS-STATE-ABBREVIATION
  5521        MOVE CF-ST-FST-PMT-DAYS-CHG
  5522                                 TO  WS-STATE-EXT-DAYS-CHG
  5523        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  97
* SOCK03.cbl
  5524           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  5525           IF CF-ST-RT-CALC NOT = SPACES
  5526              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  5527           END-IF
  5528           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  5529              IF CF-ST-RF-LR-CALC > '0'
  5530                 MOVE CF-ST-RF-LR-CALC
  5531                                 TO WS-LF-ST-REFUND-CALC
  5532              END-IF
  5533              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  5534                 IF CF-ST-RF-LN-CALC > '0'
  5535                    MOVE CF-ST-RF-LN-CALC
  5536                                 TO WS-LF-ST-REFUND-CALC
  5537                 END-IF
  5538              END-IF
  5539           ELSE
  5540              IF CF-ST-RF-LL-CALC > '0'
  5541                 MOVE CF-ST-RF-LL-CALC
  5542                                 TO WS-LF-ST-REFUND-CALC
  5543              END-IF
  5544           END-IF
  5545           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5546              (S1 > 50)
  5547              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5548                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  5549           END-PERFORM
  5550           IF S1 < +51
  5551              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5552                 MOVE CF-ST-REM-TERM-CALC (S1)
  5553                                 TO WS-LF-ST-REM-TERM-CALC
  5554              END-IF
  5555              IF CF-ST-REFUND-CALC (S1) > '0'
  5556                 MOVE CF-ST-REFUND-CALC (S1)
  5557                                 TO WS-LF-ST-REFUND-CALC
  5558              END-IF
  5559           END-IF
  5560        END-IF
  5561        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  5562           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  5563           IF CF-ST-RT-CALC NOT = SPACES
  5564              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  5565           END-IF
  5566           IF CF-ST-RF-AH-CALC > '0'
  5567              MOVE CF-ST-RF-AH-CALC
  5568                                 TO WS-AH-ST-REFUND-CALC
  5569           END-IF
  5570           IF WS-AH-SPECIAL-CALC-CD = 'C'
  5571              IF CF-ST-RF-CP-CALC > '0'
  5572                 MOVE CF-ST-RF-CP-CALC
  5573                                 TO WS-AH-ST-REFUND-CALC
  5574              END-IF
  5575           END-IF
  5576           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  5577              (S1 > 50)
  5578              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  5579                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  5580           END-PERFORM
  5581           IF S1 < +51
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  98
* SOCK03.cbl
  5582              IF CF-ST-REM-TERM-CALC (S1) > '0'
  5583                 MOVE CF-ST-REM-TERM-CALC (S1)
  5584                                 TO WS-AH-ST-REM-TERM-CALC
  5585              END-IF
  5586              IF CF-ST-REFUND-CALC (S1) > '0'
  5587                 MOVE CF-ST-REFUND-CALC (S1)
  5588                                 TO WS-AH-ST-REFUND-CALC
  5589              END-IF
  5590           END-IF
  5591        END-IF
  5592     END-IF
  5593     .
  5594 0340-EXIT.
  5595     EXIT.
  5596 0350-GET-ERACCT.
  5597     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  5598                                    WS-AM-EARN-METHOD-R
  5599                                    WS-AM-EARN-METHOD-A
  5600                                    WS-LF-AM-REM-TERM-CALC
  5601                                    WS-AH-AM-REM-TERM-CALC
  5602     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  5603     MOVE CM-CARRIER             TO WS-AM-CARRIER
  5604     MOVE CM-GROUPING            TO WS-AM-GROUPING
  5605     MOVE CM-STATE               TO WS-AM-STATE
  5606     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  5607     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  5608     MOVE LOW-VALUES             TO WS-AM-FILLER
  5609     MOVE ' '                    TO WS-STOP-SW
  5610
  5611* EXEC CICS STARTBR
  5612*       DATASET  ('ERACCT')
  5613*       RIDFLD   (WS-AM-KEY)
  5614*       GTEQ
  5615*       RESP (WS-RESPONSE)
  5616*    END-EXEC
  5617     MOVE 'ERACCT' TO DFHEIV1
  5618     MOVE 0
  5619       TO DFHEIV11
  5620*    MOVE '&,         G          &  N#00005312' TO DFHEIV0
  5621     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5622     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5623     MOVE X'204E233030303035333132' TO DFHEIV0(25:11)
  5624     CALL 'kxdfhei1' USING DFHEIV0,
  5625           DFHEIV1,
  5626           WS-AM-KEY,
  5627           DFHEIV99,
  5628           DFHEIV11,
  5629           DFHEIV99
  5630     MOVE EIBRESP  TO WS-RESPONSE
  5631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5632     IF RESP-NORMAL
  5633        PERFORM UNTIL TOLD-TO-STOP
  5634
  5635* EXEC CICS READNEXT
  5636*             DATASET  ('ERACCT')
  5637*             INTO     (ACCOUNT-MASTER)
  5638*             RIDFLD   (WS-AM-KEY)
  5639*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page  99
* SOCK03.cbl
  5640     MOVE LENGTH OF
  5641      ACCOUNT-MASTER
  5642       TO DFHEIV12
  5643     MOVE 'ERACCT' TO DFHEIV1
  5644     MOVE 0
  5645       TO DFHEIV11
  5646*    MOVE '&.IL                  )   #00005320' TO DFHEIV0
  5647     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5648     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5649     MOVE X'2020233030303035333230' TO DFHEIV0(25:11)
  5650     CALL 'kxdfhei1' USING DFHEIV0,
  5651           DFHEIV1,
  5652           ACCOUNT-MASTER,
  5653           DFHEIV12,
  5654           WS-AM-KEY,
  5655           DFHEIV99,
  5656           DFHEIV11,
  5657           DFHEIV99,
  5658           DFHEIV99
  5659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5660           IF RESP-NORMAL
  5661              EVALUATE TRUE
  5662                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5663                    CM-CONTROL-PRIMARY (1:20)
  5664                    SET TOLD-TO-STOP TO TRUE
  5665                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5666                    CM-CONTROL-PRIMARY (1:20))
  5667                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5668                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5669                    SET ERACCT-FOUND      TO TRUE
  5670                    SET TOLD-TO-STOP TO TRUE
  5671              END-EVALUATE
  5672           ELSE
  5673              SET TOLD-TO-STOP TO TRUE
  5674           END-IF
  5675        END-PERFORM
  5676
  5677* EXEC CICS ENDBR
  5678*          DATASET   ('ERACCT')
  5679*       END-EXEC
  5680     MOVE 'ERACCT' TO DFHEIV1
  5681     MOVE 0
  5682       TO DFHEIV11
  5683*    MOVE '&2                    $   #00005341' TO DFHEIV0
  5684     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5685     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5686     MOVE X'2020233030303035333431' TO DFHEIV0(25:11)
  5687     CALL 'kxdfhei1' USING DFHEIV0,
  5688           DFHEIV1,
  5689           DFHEIV11,
  5690           DFHEIV99
  5691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5692     END-IF
  5693     .
  5694 0350-EXIT.
  5695     EXIT.
  5696 0400-PROCESS-LIFE.
  5697     MOVE SPACES                 TO WS-BUFF-SENT-SW
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 100
* SOCK03.cbl
  5698     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5699     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5700     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5701     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5702     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5703     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5704     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5705     MOVE CM-CARRIER             TO WS-CARRIER
  5706     MOVE CM-GROUPING            TO WS-GROUPING
  5707     MOVE CM-STATE               TO WS-STATE
  5708     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5709     MOVE CM-CERT-NO             TO WS-CERT-NO
  5710     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5711     MOVE ' '                    TO  DC-OPTION-CODE.
  5712     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5713     IF NO-CONVERSION-ERROR
  5714        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5715     ELSE
  5716        MOVE 99999999            TO WS-CERT-EFF-DATE
  5717     END-IF
  5718     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5719        GO TO 0400-EXIT
  5720     END-IF
  5721     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5722                                    WS-TOT-LF-PREM
  5723                                    WS-TOT-LF-COMM
  5724                                    WS-LF-CANCEL-DATE
  5725     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5726     MOVE ' '                    TO  DC-OPTION-CODE
  5727     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5728     IF NO-CONVERSION-ERROR
  5729        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5730     ELSE
  5731        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5732     END-IF
  5733     IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5734        MOVE CM-LF-DEATH-DT      TO DC-BIN-DATE-1
  5735        MOVE ' '                 TO DC-OPTION-CODE
  5736
  5737        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5738        IF NO-CONVERSION-ERROR
  5739           MOVE DC-GREG-DATE-CYMD
  5740                                 TO WS-LF-CANCEL-DATE
  5741        ELSE
  5742           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5743        END-IF
  5744     END-IF
  5745     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5746        MOVE CM-LF-CANCEL-DT     TO DC-BIN-DATE-1
  5747        MOVE ' '                 TO DC-OPTION-CODE
  5748
  5749        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5750        IF NO-CONVERSION-ERROR
  5751           MOVE DC-GREG-DATE-CYMD
  5752                                 TO WS-LF-CANCEL-DATE
  5753        ELSE
  5754           MOVE ZEROS            TO WS-LF-CANCEL-DATE
  5755        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 101
* SOCK03.cbl
  5756     END-IF
  5757     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5758     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5759     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5760     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5761     MOVE CM-STATE               TO CP-STATE
  5762     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5763     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5764     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5765     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5766     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5767     MOVE '2'                    TO CP-PROCESS-TYPE
  5768     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5769     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5770     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5771     MOVE WS-CF-REM-TRM-CALC-OPTION
  5772                                 TO CP-REM-TRM-CALC-OPTION
  5773     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5774     IF WS-LF-CO-REM-TERM-CALC > '0'
  5775        MOVE WS-LF-CO-REM-TERM-CALC
  5776                                 TO CP-REM-TERM-METHOD
  5777     END-IF
  5778     IF WS-LF-ST-REM-TERM-CALC > '0'
  5779         MOVE WS-LF-ST-REM-TERM-CALC
  5780                                 TO  CP-REM-TERM-METHOD.
  5781     IF WS-LF-AM-REM-TERM-CALC > '0'
  5782         MOVE WS-LF-AM-REM-TERM-CALC
  5783                                 TO  CP-REM-TERM-METHOD.
  5784     IF (WS-COMP-ID = 'CID')
  5785        AND (CP-STATE-STD-ABBRV = 'WI')
  5786        MOVE '7'                 TO CP-REM-TERM-METHOD
  5787        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5788     END-IF
  5789     IF (WS-COMP-ID = 'CID')
  5790        AND (CP-STATE-STD-ABBRV = 'MO')
  5791        AND (CM-CERT-EFF-DT >= X'9B41')
  5792        AND (CM-CERT-EFF-DT <= X'A2FB')
  5793        MOVE '7'                 TO CP-REM-TERM-METHOD
  5794        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5795     END-IF
  5796     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5797                                    CP-LOAN-TERM
  5798                                    WS-LF-TERM
  5799     IF CP-TRUNCATED-LIFE
  5800         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5801     IF CP-TERM-IS-DAYS
  5802        IF CM-LF-TERM-IN-DAYS NUMERIC
  5803           MOVE CM-LF-TERM-IN-DAYS
  5804                                 TO CP-TERM-OR-EXT-DAYS
  5805        ELSE
  5806           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5807        END-IF
  5808     ELSE
  5809        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5810           MOVE CM-PMT-EXTENSION-DAYS
  5811                                 TO CP-TERM-OR-EXT-DAYS
  5812        ELSE
  5813           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 102
* SOCK03.cbl
  5814        END-IF
  5815     END-IF
  5816     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5817     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5818        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5819        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5820     END-IF
  5821     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5822     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5823     MOVE ' '                    TO WS-CLM-STOP-SW
  5824     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5825     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5826
  5827* EXEC CICS STARTBR
  5828*       DATASET     ('ELMSTR5')
  5829*       RIDFLD      (ELMSTR-KEY)
  5830*       RESP        (WS-RESPONSE)
  5831*    END-EXEC
  5832     MOVE 'ELMSTR5' TO DFHEIV1
  5833     MOVE 0
  5834       TO DFHEIV11
  5835*    MOVE '&,         G          &  N#00005478' TO DFHEIV0
  5836     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5837     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5838     MOVE X'204E233030303035343738' TO DFHEIV0(25:11)
  5839     CALL 'kxdfhei1' USING DFHEIV0,
  5840           DFHEIV1,
  5841           ELMSTR-KEY,
  5842           DFHEIV99,
  5843           DFHEIV11,
  5844           DFHEIV99
  5845     MOVE EIBRESP  TO WS-RESPONSE
  5846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5847     DISPLAY ' AFTER START ' WS-RESPONSE
  5848     IF RESP-NORMAL
  5849        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5850
  5851* EXEC CICS READNEXT
  5852*             DATASET   ('ELMSTR5')
  5853*             RIDFLD    (ELMSTR-KEY)
  5854*             INTO      (CLAIM-MASTER)
  5855*             RESP      (WS-RESPONSE)
  5856*          END-EXEC
  5857     MOVE LENGTH OF
  5858      CLAIM-MASTER
  5859       TO DFHEIV12
  5860     MOVE 'ELMSTR5' TO DFHEIV1
  5861     MOVE 0
  5862       TO DFHEIV11
  5863*    MOVE '&.IL                  )  N#00005486' TO DFHEIV0
  5864     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5865     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5866     MOVE X'204E233030303035343836' TO DFHEIV0(25:11)
  5867     CALL 'kxdfhei1' USING DFHEIV0,
  5868           DFHEIV1,
  5869           CLAIM-MASTER,
  5870           DFHEIV12,
  5871           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 103
* SOCK03.cbl
  5872           DFHEIV99,
  5873           DFHEIV11,
  5874           DFHEIV99,
  5875           DFHEIV99
  5876     MOVE EIBRESP  TO WS-RESPONSE
  5877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5878        IF (RESP-NORMAL OR RESP-DUPKEY)
  5879           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5880           AND (CM-CERT-NO = CL-CERT-NO)
  5881           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5882              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5883              IF CL-CLAIM-TYPE = 'L' OR 'O'
  5884                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5885                    MOVE 'D'     TO WS-AH-STATUS
  5886                 END-IF
  5887                 IF CLAIM-IS-OPEN
  5888                    MOVE ' OPEN LIFE CLAIM '
  5889                                 TO WS-COMMENT
  5890                    MOVE 'L'     TO WS-LF-STATUS
  5891                    GO TO 0400-EXIT
  5892                 ELSE
  5893                    MOVE ' DEATH CLAIM APPLIED '
  5894                                 TO WS-COMMENT
  5895                    MOVE 'D'     TO WS-LF-STATUS
  5896*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5897*                      MOVE CL-PAID-THRU-DT
  5898*                                TO WS-LF-BIN-PAID-THRU-DT
  5899*                   END-IF
  5900                 END-IF
  5901              END-IF
  5902           END-IF
  5903        ELSE
  5904           SET I-SAY-TO-STOP TO TRUE
  5905        END-IF
  5906        END-PERFORM
  5907
  5908* EXEC CICS ENDBR
  5909*          DATASET   ('ELMSTR5')
  5910*       END-EXEC
  5911     MOVE 'ELMSTR5' TO DFHEIV1
  5912     MOVE 0
  5913       TO DFHEIV11
  5914*    MOVE '&2                    $   #00005521' TO DFHEIV0
  5915     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5916     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5917     MOVE X'2020233030303035353231' TO DFHEIV0(25:11)
  5918     CALL 'kxdfhei1' USING DFHEIV0,
  5919           DFHEIV1,
  5920           DFHEIV11,
  5921           DFHEIV99
  5922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5923     END-IF
  5924     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5925*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5926        MOVE WS-LF-BIN-PAID-THRU-DT
  5927                                 TO DC-BIN-DATE-1
  5928        MOVE ' '                 TO DC-OPTION-CODE
  5929        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 104
* SOCK03.cbl
  5930        IF NO-CONVERSION-ERROR
  5931           MOVE DC-GREG-DATE-CYMD
  5932                                 TO WS-CLM-PAID-THRU-DT
  5933        ELSE
  5934           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5935        END-IF
  5936*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5937*          MOVE 'CAN DT =< CLM PD THRU DT'
  5938*                                TO WS-COMMENT
  5939*          MOVE 'P'              TO WS-LF-STATUS
  5940*          GO TO 0400-EXIT
  5941*       END-IF
  5942        GO TO 0400-EXIT
  5943     END-IF
  5944     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5945     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5946        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5947        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5948        COMPUTE CP-REMAINING-TERM-1 =
  5949                CP-REMAINING-TERM-1 - +1
  5950        COMPUTE CP-REMAINING-TERM-2 =
  5951                CP-REMAINING-TERM-2 - +1
  5952     END-IF
  5953     IF CP-REMAINING-TERM-1 NEGATIVE
  5954        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5955     END-IF
  5956     IF CP-REMAINING-TERM-2 NEGATIVE
  5957        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5958     END-IF
  5959     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5960        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5961     END-IF
  5962     IF CM-LIFE-COMM-PCT > ZEROS
  5963        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5964           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5965     END-IF
  5966     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5967     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5968     IF CM-LF-CURRENT-STATUS = '8'
  5969        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5970           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5971                                 TO WS-COMMENT
  5972           MOVE 'C'              TO WS-LF-STATUS
  5973           move cm-lf-itd-cancel-amt
  5974                                 to ws-lf-refund
  5975*          PERFORM 0030-BUILD-BUFFER
  5976*                                THRU 0030-EXIT
  5977*          PERFORM 0020-SEND-BUFFER
  5978*                                THRU 0020-EXIT
  5979*          SET ALREADY-SENT      TO TRUE
  5980*          MOVE SPACES           TO WS-COMMENT
  5981           GO TO 0400-EXIT
  5982*          PERFORM 0025-CLOSE-SOCKET
  5983*                                THRU 0025-EXIT
  5984*          GO TO 0010-RETURN
  5985        END-IF
  5986     END-IF
  5987     IF CM-LF-CURRENT-STATUS = '7'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 105
* SOCK03.cbl
  5988        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5989           MOVE ' DEATH CLAIM APPLIED '
  5990                                 TO WS-COMMENT
  5991           MOVE 'D'              TO WS-LF-STATUS
  5992*          PERFORM 0030-BUILD-BUFFER
  5993*                                THRU 0030-EXIT
  5994*          IF NOT ALREADY-SENT
  5995*             PERFORM 0020-SEND-BUFFER
  5996*                                THRU 0020-EXIT
  5997*             SET ALREADY-SENT   TO TRUE
  5998*          END-IF
  5999           GO TO 0400-EXIT
  6000*          PERFORM 0025-CLOSE-SOCKET
  6001*                                THRU 0025-EXIT
  6002*          GO TO 0010-RETURN
  6003        END-IF
  6004     END-IF
  6005     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6006        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  6007        MOVE 'LF COVERAGE EXPIRED '
  6008                                 TO WS-COMMENT
  6009        MOVE 'E'                 TO WS-LF-STATUS
  6010        GO TO 0400-EXIT
  6011     END-IF
  6012     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6013        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6014        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6015     ELSE
  6016        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  6017     END-IF
  6018     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  6019     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  6020*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  6021     if ws-comp-id = 'AHL'
  6022        move cm-lf-class-cd      to cp-class-code
  6023        if cp-class-code = spaces
  6024           move zeros            to cp-class-code
  6025        end-if
  6026     else
  6027        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6028     end-if
  6029     IF (ws-comp-id = 'DCC' or 'VPP')
  6030        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6031        MOVE ' '                 TO WS-PDEF-RECORD-SW
  6032        PERFORM 0730-GET-DDF-FACTORS
  6033                                 THRU 0730-EXIT
  6034        IF PDEF-FOUND
  6035           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  6036              (P1 > +8)
  6037              OR (PD-PROD-CODE (P1) = 'L')
  6038           END-PERFORM
  6039           IF P1 < +9
  6040              MOVE PD-MAX-AMT (P1) TO CP-R-MAX-TOT-BEN
  6041           END-IF
  6042        END-IF
  6043     END-IF
  6044     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  6045*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 106
* SOCK03.cbl
  6046     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  6047        CM-LF-ALT-BENEFIT-AMT
  6048*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  6049     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  6050                                    WS-LF-REM-BEN
  6051     move cm-lf-premium-amt      to ws-tot-lf-prem
  6052     if ws-lf-co-earnings-calc = 'B'
  6053        COMPUTE WS-TOT-LF-PREM = ws-tot-lf-prem
  6054           + CM-LF-ALT-PREMIUM-AMT
  6055     end-if
  6056     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  6057     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  6058        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  6059        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  6060     ELSE
  6061        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  6062     END-IF
  6063     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6064     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6065     IF WS-LF-ST-REFUND-CALC > ZERO
  6066         MOVE WS-LF-ST-REFUND-CALC
  6067                                 TO  CP-EARNING-METHOD.
  6068     IF WS-LF-FO-REFUND-CALC > ZERO
  6069         MOVE WS-LF-FO-REFUND-CALC
  6070                                 TO  CP-EARNING-METHOD.
  6071     IF CP-RATING-METHOD = '4'
  6072        MOVE '4'                 TO CP-EARNING-METHOD
  6073     END-IF
  6074*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6075     if ws-comp-id = 'AHL'
  6076        move cm-lf-class-cd      to cp-class-code
  6077        if cp-class-code = spaces
  6078           move zeros            to cp-class-code
  6079        end-if
  6080     else
  6081        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6082     end-if
  6083     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6084     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6085                                     CP-RATING-BENEFIT-AMT.
  6086     IF CP-STATE-STD-ABBRV = 'OR'
  6087         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6088                                         CM-LF-ALT-BENEFIT-AMT.
  6089****   N O T E   ****
  6090*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  6091*      THE OH HARD CODING IN ELCRFNDP
  6092     IF WS-COMP-ID = 'CID'
  6093        IF CP-STATE-STD-ABBRV = 'OH'
  6094           MOVE WS-LF-CO-EARNINGS-CALC
  6095                                 TO CP-EARNING-METHOD
  6096        END-IF
  6097     END-IF
  6098****   N O T E   ****
  6099     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6100     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6101     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  6102     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6103     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 107
* SOCK03.cbl
  6104*    IF CP-EARN-AS-NET-PAY
  6105*       IF CP-LOAN-APR <= ZEROS
  6106*          IF WS-CF-DEFAULT-APR > ZEROS
  6107*             MOVE WS-CF-DEFAULT-APR
  6108*                                TO  CP-LOAN-APR
  6109*          END-IF
  6110*       END-IF
  6111*    END-IF
  6112*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  6113*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  6114*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  6115*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  6116*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  6117*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  6118*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  6119*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  6120*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  6121*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  6122*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  6123*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  6124*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  6125*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  6126*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  6127*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  6128*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  6129*    MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  6130     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6131     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  6132     DISPLAY ' MADE IT BACK FROM ELRFND '
  6133     IF (CP-ERROR-RATE-IS-ZERO)
  6134        OR (CP-ERROR-RATE-NOT-FOUND)
  6135        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6136        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  6137          DELIMITED BY SIZE INTO WS-COMMENT
  6138        END-STRING
  6139        MOVE 'X'                 TO WS-LF-STATUS
  6140        GO TO 0400-EXIT
  6141*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6142*       IF NOT ALREADY-SENT
  6143*          PERFORM 0020-SEND-BUFFER
  6144*                                THRU 0020-EXIT
  6145*          SET ALREADY-SENT      TO TRUE
  6146*       END-IF
  6147*       PERFORM 0025-CLOSE-SOCKET
  6148*                                THRU 0025-EXIT
  6149*       GO TO 0010-RETURN
  6150     END-IF
  6151     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  6152                                    WS-TOT-LF-RFND
  6153     IF (WS-LF-STATUS = SPACES)
  6154        OR (CP-CALC-REFUND > ZEROS)
  6155        MOVE 'A'                 TO WS-LF-STATUS
  6156     END-IF
  6157     EVALUATE TRUE
  6158        WHEN CP-R-AS-R78
  6159           MOVE 'RULE 78'          TO  WS-LF-METHOD
  6160        WHEN  CP-R-AS-PRORATA
  6161           MOVE 'PRO RATA'         TO  WS-LF-METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 108
* SOCK03.cbl
  6162        WHEN CP-R-AS-CALIF
  6163           MOVE 'CALIF'            TO  WS-LF-METHOD
  6164        WHEN CP-R-AS-TEXAS
  6165           MOVE 'IRREG'            TO  WS-LF-METHOD
  6166        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  6167           MOVE 'UTAH'             TO  WS-LF-METHOD
  6168        WHEN CP-R-AS-FARM-PLAN
  6169           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  6170        WHEN CP-R-AS-NET-PAY
  6171           MOVE 'NET PAY'          TO  WS-LF-METHOD
  6172        WHEN CP-R-AS-ANTICIPATION
  6173           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  6174        WHEN CP-R-AS-MEAN
  6175           MOVE 'MEAN'             TO  WS-LF-METHOD
  6176        WHEN CP-R-AS-SUM-OF-DIGITS
  6177           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  6178     END-EVALUATE
  6179     IF WS-TOT-LF-RFND > ZEROS
  6180        COMPUTE WS-WORK-FACTOR ROUNDED =
  6181           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  6182        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  6183           WS-TOT-LF-COMM
  6184     END-IF
  6185     IF ERACCT-FOUND
  6186        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6187           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6188        END-IF
  6189        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6190           IF (AM-COMM-CHARGEBACK (1) = 99)
  6191                     OR
  6192              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6193                     OR
  6194              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6195              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6196              MOVE ZEROS         TO WS-LF-UEC
  6197           END-IF
  6198        END-IF
  6199     END-IF
  6200     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  6201        GO TO 0400-EXIT
  6202     END-IF
  6203     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  6204     MOVE '2'                    TO  CP-EARNING-METHOD
  6205                                     CP-RATING-METHOD.
  6206     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  6207                                     CP-REMAINING-BENEFIT
  6208                                     CP-RATING-BENEFIT-AMT.
  6209     IF CP-STATE-STD-ABBRV = 'OR'
  6210         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  6211                                         CM-LF-ALT-BENEFIT-AMT.
  6212     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  6213     IF ws-comp-id = 'CID'
  6214        IF (CP-STATE-STD-ABBRV = 'MN')
  6215           AND (CM-CERT-EFF-DT > X'A4FF')
  6216           AND (WS-LF-CO-EARNINGS-CALC = 'B')
  6217           MOVE '5'              TO CP-EARNING-METHOD
  6218           MOVE WS-LF-CO-EARNINGS-CALC TO CP-RATING-METHOD
  6219        END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 109
* SOCK03.cbl
  6220     END-IF
  6221     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  6222     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  6223     IF (CP-ERROR-RATE-IS-ZERO)
  6224        OR (CP-ERROR-RATE-NOT-FOUND)
  6225        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6226        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  6227          DELIMITED BY SIZE INTO WS-COMMENT
  6228        END-STRING
  6229        MOVE 'X'              TO WS-LF-STATUS
  6230        GO TO 0400-EXIT
  6231*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6232*       IF NOT ALREADY-SENT
  6233*          PERFORM 0020-SEND-BUFFER
  6234*                                THRU 0020-EXIT
  6235*          SET ALREADY-SENT      TO TRUE
  6236*       END-IF
  6237*       PERFORM 0025-CLOSE-SOCKET
  6238*                                THRU 0025-EXIT
  6239*       GO TO 0010-RETURN
  6240     END-IF
  6241     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  6242     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  6243     IF WS-TOT-LF-RFND > ZEROS
  6244        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  6245           WS-TOT-LF-COMM
  6246     END-IF
  6247     IF ERACCT-FOUND
  6248        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6249           IF (AM-COMM-CHARGEBACK (1) = 99)
  6250                     OR
  6251              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6252                     OR
  6253              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6254              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6255              MOVE ZEROS         TO WS-LF-UEC
  6256           END-IF
  6257        END-IF
  6258     END-IF
  6259     .
  6260 0400-EXIT.
  6261     EXIT.
  6262 0500-PROCESS-AH.
  6263     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  6264        GO TO 0500-EXIT
  6265     END-IF
  6266     MOVE ZEROS                  TO WS-TOT-AH-RFND
  6267                                    WS-TOT-AH-PREM
  6268                                    WS-TOT-AH-COMM
  6269                                    WS-AH-CANCEL-DATE
  6270     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  6271     MOVE ' '                    TO  DC-OPTION-CODE
  6272     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6273     IF NO-CONVERSION-ERROR
  6274        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  6275     ELSE
  6276        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  6277     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 110
* SOCK03.cbl
  6278     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6279        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
  6280        MOVE ' '                 TO DC-OPTION-CODE
  6281
  6282        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6283        IF NO-CONVERSION-ERROR
  6284           MOVE DC-GREG-DATE-CYMD TO WS-AH-CANCEL-DATE
  6285        ELSE
  6286           MOVE ZEROS            TO WS-AH-CANCEL-DATE
  6287        END-IF
  6288     END-IF
  6289     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  6290     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  6291     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  6292     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  6293     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  6294     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  6295     MOVE CM-STATE               TO  CP-STATE.
  6296     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  6297     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  6298     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  6299     MOVE '2'                    TO  CP-PROCESS-TYPE.
  6300     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  6301     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  6302     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  6303     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  6304     MOVE WS-CF-CR-REM-TERM-CALC
  6305                                 TO  CP-REM-TERM-METHOD.
  6306     IF WS-AH-CO-REM-TERM-CALC > '0'
  6307         MOVE WS-AH-CO-REM-TERM-CALC
  6308                                 TO  CP-REM-TERM-METHOD.
  6309     IF WS-AH-ST-REM-TERM-CALC > '0'
  6310         MOVE WS-AH-ST-REM-TERM-CALC
  6311                                 TO  CP-REM-TERM-METHOD.
  6312     IF WS-AH-AM-REM-TERM-CALC > '0'
  6313         MOVE WS-AH-AM-REM-TERM-CALC
  6314                                 TO  CP-REM-TERM-METHOD.
  6315     IF (WS-COMP-ID = 'CID')
  6316        AND (CP-STATE-STD-ABBRV = 'WI')
  6317        MOVE '7'                 TO CP-REM-TERM-METHOD
  6318        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6319     END-IF
  6320     IF (WS-COMP-ID = 'CID')
  6321        AND (CP-STATE-STD-ABBRV = 'MO')
  6322        AND (CM-CERT-EFF-DT >= X'9B41')
  6323        AND (CM-CERT-EFF-DT <= X'A2FB')
  6324        MOVE '7'                 TO CP-REM-TERM-METHOD
  6325        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  6326     END-IF
  6327     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  6328                                     CP-LOAN-TERM.
  6329     IF  NOT  CP-TERM-IS-DAYS
  6330         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  6331             MOVE CM-PMT-EXTENSION-DAYS
  6332                                 TO  CP-TERM-OR-EXT-DAYS
  6333         ELSE
  6334             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  6335     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 111
* SOCK03.cbl
  6336     IF CM-AH-COMM-PCT > ZEROS
  6337        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  6338           CM-AH-PREMIUM-AMT
  6339     END-IF
  6340     IF (ws-comp-id = 'DCC' or 'VPP')
  6341        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6342        compute ws-tot-ah-comm = cm-ah-premium-amt -
  6343           (cm-ah-clp + cm-addl-clp)
  6344     end-if
  6345     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  6346     IF WS-AH-STATUS = 'D'
  6347        GO TO 0500-EXIT
  6348     END-IF
  6349     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  6350     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  6351     MOVE ' '                    TO WS-CLM-STOP-SW
  6352     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  6353     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  6354
  6355* EXEC CICS STARTBR
  6356*       DATASET     ('ELMSTR5')
  6357*       RIDFLD      (ELMSTR-KEY)
  6358*       RESP        (WS-RESPONSE)
  6359*    END-EXEC
  6360     MOVE 'ELMSTR5' TO DFHEIV1
  6361     MOVE 0
  6362       TO DFHEIV11
  6363*    MOVE '&,         G          &  N#00005955' TO DFHEIV0
  6364     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6366     MOVE X'204E233030303035393535' TO DFHEIV0(25:11)
  6367     CALL 'kxdfhei1' USING DFHEIV0,
  6368           DFHEIV1,
  6369           ELMSTR-KEY,
  6370           DFHEIV99,
  6371           DFHEIV11,
  6372           DFHEIV99
  6373     MOVE EIBRESP  TO WS-RESPONSE
  6374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6375     DISPLAY ' AFTER START ' WS-RESPONSE
  6376     IF RESP-NORMAL
  6377        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  6378           DISPLAY ' AH READNEXT '
  6379
  6380* EXEC CICS READNEXT
  6381*             DATASET   ('ELMSTR5')
  6382*             RIDFLD    (ELMSTR-KEY)
  6383*             INTO      (CLAIM-MASTER)
  6384*             RESP      (WS-RESPONSE)
  6385*          END-EXEC
  6386     MOVE LENGTH OF
  6387      CLAIM-MASTER
  6388       TO DFHEIV12
  6389     MOVE 'ELMSTR5' TO DFHEIV1
  6390     MOVE 0
  6391       TO DFHEIV11
  6392*    MOVE '&.IL                  )  N#00005964' TO DFHEIV0
  6393     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 112
* SOCK03.cbl
  6394     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6395     MOVE X'204E233030303035393634' TO DFHEIV0(25:11)
  6396     CALL 'kxdfhei1' USING DFHEIV0,
  6397           DFHEIV1,
  6398           CLAIM-MASTER,
  6399           DFHEIV12,
  6400           ELMSTR-KEY,
  6401           DFHEIV99,
  6402           DFHEIV11,
  6403           DFHEIV99,
  6404           DFHEIV99
  6405     MOVE EIBRESP  TO WS-RESPONSE
  6406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6407        IF (RESP-NORMAL OR RESP-DUPKEY)
  6408           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  6409           AND (CM-CERT-NO = CL-CERT-NO)
  6410           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  6411              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  6412              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G' OR 'F')
  6413                 IF CLAIM-IS-OPEN
  6414                    DISPLAY ' FOUND OPEN AH CLAIM '
  6415                    MOVE ' OPEN HEALTH CLAIM '
  6416                                 TO WS-COMMENT
  6417                    MOVE 'H'     TO WS-AH-STATUS
  6418                 ELSE
  6419                    DISPLAY ' FOUND CLOSED AH CLAIM '
  6420                    MOVE ' CLOSED HEALTH CLAIM '
  6421                                 TO WS-COMMENT
  6422                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  6423                       MOVE CL-PAID-THRU-DT
  6424                                 TO WS-AH-BIN-PAID-THRU-DT
  6425                    END-IF
  6426                 END-IF
  6427              END-IF
  6428           END-IF
  6429        ELSE
  6430           SET I-SAY-TO-STOP TO TRUE
  6431        END-IF
  6432        END-PERFORM
  6433
  6434* EXEC CICS ENDBR
  6435*          DATASET   ('ELMSTR5')
  6436*       END-EXEC
  6437     MOVE 'ELMSTR5' TO DFHEIV1
  6438     MOVE 0
  6439       TO DFHEIV11
  6440*    MOVE '&2                    $   #00005996' TO DFHEIV0
  6441     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6443     MOVE X'2020233030303035393936' TO DFHEIV0(25:11)
  6444     CALL 'kxdfhei1' USING DFHEIV0,
  6445           DFHEIV1,
  6446           DFHEIV11,
  6447           DFHEIV99
  6448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6449     END-IF
  6450     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  6451*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 113
* SOCK03.cbl
  6452        MOVE WS-AH-BIN-PAID-THRU-DT
  6453                                 TO DC-BIN-DATE-1
  6454        MOVE ' '                 TO DC-OPTION-CODE
  6455        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  6456        IF NO-CONVERSION-ERROR
  6457           MOVE DC-GREG-DATE-CYMD
  6458                                 TO WS-CLM-PAID-THRU-DT
  6459        ELSE
  6460           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  6461        END-IF
  6462        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  6463           MOVE 'CAN DT NOT > CLM CLOSE DT '
  6464                                 TO WS-COMMENT
  6465           MOVE 'P'              TO WS-AH-STATUS
  6466           GO TO 0500-EXIT
  6467        END-IF
  6468     END-IF
  6469     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  6470     IF CM-AH-CURRENT-STATUS = '8'
  6471        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  6472           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  6473                                 TO WS-COMMENT
  6474           MOVE 'C'              TO WS-AH-STATUS
  6475           move cm-ah-itd-cancel-amt
  6476                                 to ws-ah-refund
  6477           GO TO 0500-EXIT
  6478        END-IF
  6479     END-IF
  6480     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  6481        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  6482           MOVE ' SETTLEMENT CLAIM APPLIED '
  6483                                 TO WS-COMMENT
  6484           MOVE 'S'              TO WS-AH-STATUS
  6485*          PERFORM 0030-BUILD-BUFFER
  6486*                                THRU 0030-EXIT
  6487*          IF NOT ALREADY-SENT
  6488*             PERFORM 0020-SEND-BUFFER
  6489*                                THRU 0020-EXIT
  6490*             SET ALREADY-SENT   TO TRUE
  6491*          END-IF
  6492           GO TO 0500-EXIT
  6493*          PERFORM 0025-CLOSE-SOCKET
  6494*                                THRU 0025-EXIT
  6495*          GO TO 0010-RETURN
  6496        END-IF
  6497     END-IF
  6498     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  6499        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  6500        MOVE 'AH COVERAGE EXPIRED '
  6501                                 TO WS-COMMENT
  6502        MOVE 'E'                 TO WS-AH-STATUS
  6503        GO TO 0500-EXIT
  6504     END-IF
  6505     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  6506                                    WS-AH-PREM
  6507     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  6508     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  6509        * CP-REMAINING-TERM-1
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 114
* SOCK03.cbl
  6510     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  6511                                     WS-AH-REM-TERM
  6512     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  6513     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  6514     IF WS-AH-ST-REFUND-CALC > ZERO
  6515         MOVE WS-AH-ST-REFUND-CALC
  6516                                 TO  CP-EARNING-METHOD.
  6517     IF WS-AH-FO-REFUND-CALC > ZERO
  6518         MOVE WS-AH-FO-REFUND-CALC
  6519                                 TO  CP-EARNING-METHOD.
  6520*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  6521     if ws-comp-id = 'AHL'
  6522        move cm-ah-class-cd      to cp-class-code
  6523        if cp-class-code = spaces
  6524           move zeros            to cp-class-code
  6525        end-if
  6526     else
  6527        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  6528     end-if
  6529     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  6530     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  6531                                     CP-RATING-BENEFIT-AMT.
  6532     IF CP-STATE-STD-ABBRV = 'OR'
  6533         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  6534                                         CM-AH-ORIG-TERM.
  6535     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  6536     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  6537     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  6538     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  6539     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  6540     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  6541     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  6542     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  6543     MOVE ' '                    TO  DC-OPTION-CODE.
  6544     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  6545     IF CP-STATE-STD-ABBRV = 'OH'
  6546        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6547         IF (CP-ORIGINAL-TERM > 60)
  6548           AND (DC-GREG-DATE-1-YMD > '831101')
  6549           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  6550             MOVE '6'            TO  CP-EARNING-METHOD
  6551         END-IF
  6552        END-IF
  6553        IF WS-COMP-ID = 'CID'
  6554           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  6555                           LOW-VALUES)
  6556              IF CP-CRITICAL-PERIOD
  6557                 MOVE '2'       TO CP-EARNING-METHOD
  6558              ELSE
  6559                 MOVE '6'       TO CP-EARNING-METHOD
  6560              END-IF
  6561           ELSE
  6562              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  6563                 MOVE '2'       TO CP-EARNING-METHOD
  6564              ELSE
  6565                 IF ((CM-LF-ORIG-TERM > 60) AND
  6566                    (CM-RATE-CLASS NOT = 'L '))
  6567                               OR
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 115
* SOCK03.cbl
  6568                    (WS-LF-CO-EARNINGS-CALC = '5')
  6569                    IF CP-CRITICAL-PERIOD
  6570                       MOVE '2'  TO CP-EARNING-METHOD
  6571                    ELSE
  6572                       MOVE '6'  TO CP-EARNING-METHOD
  6573                    END-IF
  6574                 ELSE
  6575                    MOVE '1'     TO CP-EARNING-METHOD
  6576                 END-IF
  6577              END-IF
  6578           END-IF
  6579        END-IF
  6580     END-IF
  6581     IF CP-STATE-STD-ABBRV = 'VA'
  6582       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  6583         IF DC-GREG-DATE-1-YMD > '921231'
  6584            IF CP-ORIGINAL-TERM > 61
  6585                MOVE '6'            TO  CP-EARNING-METHOD
  6586            ELSE
  6587                MOVE '1'            TO  CP-EARNING-METHOD.
  6588*    IF CP-EARN-AS-NET-PAY
  6589*       IF CP-LOAN-APR <= ZEROS
  6590*          IF WS-CF-DEFAULT-APR > ZEROS
  6591*             MOVE WS-CF-DEFAULT-APR
  6592*                                TO  CP-LOAN-APR
  6593*          END-IF
  6594*       END-IF
  6595*    END-IF
  6596     IF WS-COMP-ID = 'DCC' or 'VPP'
  6597        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6598           AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
  6599           MOVE 'S'              TO CP-EARNING-METHOD
  6600        END-IF
  6601     END-IF
  6602     MOVE WS-CANCEL-REASON       TO CP-CANCEL-REASON
  6603     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6604        AND (CP-EARNING-METHOD = 'D')
  6605        MOVE +0                  TO WS-DDF-ADMIN-FEES
  6606                                    WS-DDF-CSO-ADMIN-FEE
  6607                                    WS-DDF-1ST-YR-TOT-EXP
  6608                                    WS-DDF-COMM-AND-MFEE
  6609        PERFORM VARYING S1 FROM +2 BY +1 UNTIL
  6610           S1 > +10
  6611           IF AM-COM-TYP (S1) = 'L' OR 'N' OR 'J' OR 'I'
  6612              IF (AM-A-COM (S1) NUMERIC)
  6613                 AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M')
  6614                 COMPUTE WS-COMM-PCT = (AM-A-COM (S1) * +1000)
  6615              ELSE
  6616                 MOVE +0         TO WS-COMM-PCT C0
  6617                 PERFORM 0740-GET-ERCTBL THRU 0740-EXIT
  6618                 COMPUTE WS-COMM-PCT = WS-COMM-PCT * +1000
  6619              END-IF
  6620              IF AM-COM-TYP (S1) = 'L' OR 'N'
  6621                 COMPUTE WS-DDF-ADMIN-FEES = WS-DDF-ADMIN-FEES
  6622                    + WS-COMM-PCT
  6623              END-IF
  6624              IF AM-COM-TYP (S1) = 'N'
  6625                 COMPUTE WS-DDF-CSO-ADMIN-FEE =
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 116
* SOCK03.cbl
  6626                    WS-DDF-CSO-ADMIN-FEE + WS-COMM-PCT
  6627              END-IF
  6628              IF AM-COM-TYP (S1) = 'J' OR 'L'
  6629                 COMPUTE WS-DDF-1ST-YR-TOT-EXP
  6630                    = WS-DDF-1ST-YR-TOT-EXP + WS-COMM-PCT
  6631              END-IF
  6632              IF AM-COM-TYP (S1) = 'I'
  6633                 COMPUTE WS-DDF-COMM-AND-MFEE
  6634                    = WS-DDF-COMM-AND-MFEE + WS-COMM-PCT
  6635              END-IF
  6636           END-IF
  6637        END-PERFORM
  6638        MOVE WS-DDF-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
  6639        MOVE WS-DDF-ADMIN-FEES   TO CP-DDF-ADMIN-FEES
  6640        COMPUTE WS-DDF-COMM-AND-MFEE = WS-DDF-COMM-AND-MFEE +
  6641           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
  6642     END-IF
  6643     IF (WS-COMP-ID = 'DCC' or 'VPP')
  6644        AND (CP-EARNING-METHOD = 'D')
  6645        AND (ws-CANCEL-REASON NOT = 'R')
  6646        PERFORM 0730-GET-DDF-FACTORS
  6647                                 THRU 0730-EXIT
  6648        IF NOT PDEF-FOUND
  6649           MOVE ' DDF UE FACTORS  NOT FOUND '
  6650                                 TO WS-COMMENT
  6651           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  6652           PERFORM 0030-BUILD-BUFFER
  6653                                 THRU 0030-EXIT
  6654           PERFORM 0020-SEND-BUFFER
  6655                                 THRU 0020-EXIT
  6656           PERFORM 0025-CLOSE-SOCKET
  6657                                 THRU 0025-EXIT
  6658           GO TO 0010-RETURN
  6659        END-IF
  6660*       IF NOT PDEF-FOUND
  6661*          MOVE ER-9999          TO EMI-ERROR
  6662*          PERFORM 9700-ERROR-FORMAT
  6663*                                THRU 9799-EXIT
  6664*          GO TO 8200-SEND-DATAONLY
  6665*       END-IF
  6666        MOVE PD-UEP-FACTOR (P1 P2 + 1)
  6667                                 TO CP-DDF-LO-FACT
  6668        MOVE PD-UEP-FACTOR (P1 P2)
  6669                                 TO CP-DDF-HI-FACT
  6670        MOVE WS-DDF-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
  6671        MOVE CM-AH-CLP           TO CP-DDF-CLP
  6672        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
  6673        COMPUTE CP-1ST-YR-ALLOW = WS-DDF-1ST-YR-TOT-EXP
  6674           + PD-1ST-YR-ADMIN-ALLOW
  6675        MOVE 'G'                 TO CP-DDF-SPEC-CALC
  6676*       IF PI-CLP-YN = 'Y'
  6677*          MOVE 'C'              TO CP-DDF-SPEC-CALC
  6678*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
  6679*                                   CP-DDF-CLP
  6680*          MOVE ZEROS            TO CP-1ST-YR-ALLOW
  6681*       END-IF
  6682        IF DD-IU-PRESENT
  6683           MOVE 'I'              TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 117
* SOCK03.cbl
  6684        END-IF
  6685        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6686                                    CP-CLP-RATE-UP
  6687        IF (CP-CALC-GROSS-FEE)
  6688           AND (CP-IU-RATE-UP NOT = ZEROS)
  6689           COMPUTE TEX-FACT-8 = 1 - ((CM-ADDL-CLP + CM-AH-CLP)
  6690              / CP-ORIGINAL-PREMIUM)
  6691           COMPUTE CP-IU-RATE-UP ROUNDED = CP-IU-RATE-UP
  6692              / (1 - TEX-FACT-8)
  6693        END-IF
  6694     END-IF
  6695     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  6696     IF (CP-ERROR-RATE-IS-ZERO)
  6697        OR (CP-ERROR-RATE-NOT-FOUND)
  6698        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  6699        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  6700          DELIMITED BY SIZE INTO WS-COMMENT
  6701        END-STRING
  6702        IF WS-AH-STATUS NOT = 'H'
  6703           MOVE 'X'                 TO WS-AH-STATUS
  6704        END-IF
  6705        GO TO 0500-EXIT
  6706*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  6707*       IF NOT ALREADY-SENT
  6708*          PERFORM 0020-SEND-BUFFER
  6709*                                THRU 0020-EXIT
  6710*          SET ALREADY-SENT      TO TRUE
  6711*       END-IF
  6712*       PERFORM 0025-CLOSE-SOCKET
  6713*                                THRU 0025-EXIT
  6714*       GO TO 0010-RETURN
  6715     END-IF
  6716     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  6717                                    WS-TOT-AH-RFND
  6718     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  6719     IF ((WS-AH-STATUS = SPACES)
  6720        OR (CP-CALC-REFUND > ZEROS))
  6721                  AND
  6722          (WS-AH-STATUS NOT = 'H')
  6723        MOVE 'A'                 TO WS-AH-STATUS
  6724     END-IF
  6725     IF WS-COMP-ID = 'DCC' or 'VPP'
  6726        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  6727        AND (CP-EARNING-METHOD = 'D' OR 'I')
  6728        MOVE CM-DDF-IU-RATE-UP   TO CP-IU-RATE-UP
  6729        MOVE 'C'                 TO CP-DDF-SPEC-CALC
  6730        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
  6731        MOVE ZEROS               TO CP-1ST-YR-ALLOW
  6732        PERFORM 0720-LINK-REFUND THRU  0720-EXIT
  6733        MOVE CP-CALC-REFUND      TO ws-ah-rfnd-clp
  6734        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
  6735     END-IF
  6736     EVALUATE TRUE
  6737        WHEN CP-R-AS-R78
  6738           MOVE 'RULE 78'          TO  WS-AH-METHOD
  6739        WHEN CP-R-AS-PRORATA
  6740           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  6741        WHEN CP-REFUND-TYPE-USED = '3'
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 118
* SOCK03.cbl
  6742           MOVE 'CALIF'            TO  WS-AH-METHOD
  6743        WHEN CP-R-AS-TEXAS
  6744           MOVE 'IRREG'            TO  WS-AH-METHOD
  6745        WHEN CP-R-AS-FARM-PLAN
  6746           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  6747        WHEN CP-R-AS-NET-PAY
  6748           MOVE 'NET PAY'          TO  WS-AH-METHOD
  6749        WHEN CP-R-AS-ANTICIPATION
  6750           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  6751        WHEN CP-R-AS-MEAN
  6752           MOVE 'MEAN'             TO  WS-AH-METHOD
  6753        WHEN CP-R-AS-SUM-OF-DIGITS
  6754           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  6755        WHEN CP-GAP-ACTUARIAL
  6756           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  6757     END-EVALUATE
  6758     IF WS-TOT-AH-RFND > ZEROS
  6759        IF (ws-comp-id = 'DCC' or 'VPP')
  6760           AND (AM-DCC-PRODUCT-CODE = 'DDF')
  6761           compute ws-work-factor rounded =
  6762              ws-ah-rfnd-clp / cm-ah-clp
  6763        else
  6764           COMPUTE WS-WORK-FACTOR ROUNDED =
  6765              WS-TOT-AH-RFND / WS-TOT-AH-PREM
  6766        end-if
  6767        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  6768           WS-TOT-AH-COMM
  6769     END-IF
  6770     IF ERACCT-FOUND
  6771        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  6772           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  6773        END-IF
  6774        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  6775           IF (AM-COMM-CHARGEBACK (1) = 99)
  6776                     OR
  6777              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  6778                     OR
  6779              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  6780              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  6781              MOVE ZEROS         TO WS-AH-UEC
  6782           END-IF
  6783        END-IF
  6784     END-IF
  6785     .
  6786 0500-EXIT.
  6787     EXIT.
  6788 0610-GET-ERMAIL.
  6789
  6790     MOVE WS-CM-KEY              TO WS-MA-KEY
  6791
  6792* EXEC CICS READ
  6793*       INTO    (MAILING-DATA)
  6794*       DATASET ('ERMAIL')
  6795*       RIDFLD  (WS-MA-KEY)
  6796*       RESP    (WS-RESPONSE)
  6797*    END-EXEC
  6798     MOVE LENGTH OF
  6799      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 119
* SOCK03.cbl
  6800       TO DFHEIV11
  6801     MOVE 'ERMAIL' TO DFHEIV1
  6802*    MOVE '&"IL       E          (  N#00006341' TO DFHEIV0
  6803     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6804     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6805     MOVE X'204E233030303036333431' TO DFHEIV0(25:11)
  6806     CALL 'kxdfhei1' USING DFHEIV0,
  6807           DFHEIV1,
  6808           MAILING-DATA,
  6809           DFHEIV11,
  6810           WS-MA-KEY,
  6811           DFHEIV99,
  6812           DFHEIV99,
  6813           DFHEIV99
  6814     MOVE EIBRESP  TO WS-RESPONSE
  6815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6816
  6817     IF RESP-NORMAL
  6818        MOVE MA-CRED-BENE-NAME   to ws-cred-bene-name
  6819     else
  6820        move spaces              to ws-cred-bene-name
  6821     end-if
  6822
  6823     .
  6824 0610-EXIT.
  6825     EXIT.
  6826 0620-GET-ELCRTT.
  6827
  6828     MOVE WS-CM-KEY              TO WS-CS-KEY
  6829     move 'C'                    to WS-CS-TRLR-TYPE
  6830
  6831
  6832* EXEC CICS READ
  6833*       INTO    (CERTIFICATE-TRAILERS)
  6834*       DATASET ('ELCRTT')
  6835*       RIDFLD  (WS-CS-KEY)
  6836*       RESP    (WS-RESPONSE)
  6837*    END-EXEC
  6838     MOVE LENGTH OF
  6839      CERTIFICATE-TRAILERS
  6840       TO DFHEIV11
  6841     MOVE 'ELCRTT' TO DFHEIV1
  6842*    MOVE '&"IL       E          (  N#00006362' TO DFHEIV0
  6843     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6844     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6845     MOVE X'204E233030303036333632' TO DFHEIV0(25:11)
  6846     CALL 'kxdfhei1' USING DFHEIV0,
  6847           DFHEIV1,
  6848           CERTIFICATE-TRAILERS,
  6849           DFHEIV11,
  6850           WS-CS-KEY,
  6851           DFHEIV99,
  6852           DFHEIV99,
  6853           DFHEIV99
  6854     MOVE EIBRESP  TO WS-RESPONSE
  6855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6856
  6857     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 120
* SOCK03.cbl
  6858        MOVE cs-vin-number       to ws-vin
  6859     else
  6860        move spaces              to ws-vin
  6861     end-if
  6862
  6863     .
  6864 0620-EXIT.
  6865     EXIT.
  6866 0700-LINK-REM-TERM.
  6867
  6868* EXEC CICS LINK
  6869*        PROGRAM   ('ELRTRM')
  6870*        COMMAREA  (CALCULATION-PASS-AREA)
  6871*        LENGTH    (CP-COMM-LENGTH)
  6872*    END-EXEC.
  6873     MOVE 'ELRTRM' TO DFHEIV1
  6874*    MOVE '."C                   (   #00006379' TO DFHEIV0
  6875     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6877     MOVE X'2020233030303036333739' TO DFHEIV0(25:11)
  6878     CALL 'kxdfhei1' USING DFHEIV0,
  6879           DFHEIV1,
  6880           CALCULATION-PASS-AREA,
  6881           CP-COMM-LENGTH,
  6882           DFHEIV99,
  6883           DFHEIV99,
  6884           DFHEIV99,
  6885           DFHEIV99
  6886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6887
  6888 0700-EXIT.
  6889     EXIT.
  6890 0710-LINK-REM-AMOUNT.
  6891
  6892* EXEC CICS LINK
  6893*        PROGRAM   ('ELRAMT')
  6894*        COMMAREA  (CALCULATION-PASS-AREA)
  6895*        LENGTH    (CP-COMM-LENGTH)
  6896*    END-EXEC
  6897     MOVE 'ELRAMT' TO DFHEIV1
  6898*    MOVE '."C                   (   #00006387' TO DFHEIV0
  6899     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6900     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6901     MOVE X'2020233030303036333837' TO DFHEIV0(25:11)
  6902     CALL 'kxdfhei1' USING DFHEIV0,
  6903           DFHEIV1,
  6904           CALCULATION-PASS-AREA,
  6905           CP-COMM-LENGTH,
  6906           DFHEIV99,
  6907           DFHEIV99,
  6908           DFHEIV99,
  6909           DFHEIV99
  6910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6911     .
  6912 0710-EXIT.
  6913     EXIT.
  6914 0720-LINK-REFUND.
  6915
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 121
* SOCK03.cbl
  6916* EXEC CICS LINK
  6917*        PROGRAM   ('ELRFND')
  6918*        COMMAREA  (CALCULATION-PASS-AREA)
  6919*        LENGTH    (CP-COMM-LENGTH)
  6920*    END-EXEC
  6921     MOVE 'ELRFND' TO DFHEIV1
  6922*    MOVE '."C                   (   #00006396' TO DFHEIV0
  6923     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6925     MOVE X'2020233030303036333936' TO DFHEIV0(25:11)
  6926     CALL 'kxdfhei1' USING DFHEIV0,
  6927           DFHEIV1,
  6928           CALCULATION-PASS-AREA,
  6929           CP-COMM-LENGTH,
  6930           DFHEIV99,
  6931           DFHEIV99,
  6932           DFHEIV99,
  6933           DFHEIV99
  6934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6935     .
  6936 0720-EXIT.
  6937     EXIT.
  6938 0730-GET-DDF-FACTORS.
  6939     MOVE ' '                    TO WS-PDEF-RECORD-SW
  6940     MOVE WS-COMP-CD             TO ERPDEF-KEY
  6941     MOVE CM-STATE               TO ERPDEF-STATE
  6942     if cm-clp-state not = cm-state and spaces and zeros
  6943        move cm-clp-state        to erpdef-state
  6944     end-if
  6945     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  6946     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  6947     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  6948     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
  6949     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  6950
  6951* EXEC CICS STARTBR
  6952*        DATASET  ('ERPDEF')
  6953*        RIDFLD   (ERPDEF-KEY)
  6954*        GTEQ
  6955*        RESP     (WS-RESPONSE)
  6956*    END-EXEC
  6957     MOVE 'ERPDEF' TO DFHEIV1
  6958     MOVE 0
  6959       TO DFHEIV11
  6960*    MOVE '&,         G          &  N#00006416' TO DFHEIV0
  6961     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6962     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6963     MOVE X'204E233030303036343136' TO DFHEIV0(25:11)
  6964     CALL 'kxdfhei1' USING DFHEIV0,
  6965           DFHEIV1,
  6966           ERPDEF-KEY,
  6967           DFHEIV99,
  6968           DFHEIV11,
  6969           DFHEIV99
  6970     MOVE EIBRESP  TO WS-RESPONSE
  6971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6972     IF NOT RESP-NORMAL
  6973        GO TO 0730-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 122
* SOCK03.cbl
  6974     END-IF
  6975     .
  6976 0730-READNEXT.
  6977
  6978* EXEC CICS READNEXT
  6979*       DATASET  ('ERPDEF')
  6980*       INTO     (PRODUCT-MASTER)
  6981*       RIDFLD   (ERPDEF-KEY)
  6982*       RESP     (WS-RESPONSE)
  6983*    END-EXEC
  6984     MOVE LENGTH OF
  6985      PRODUCT-MASTER
  6986       TO DFHEIV12
  6987     MOVE 'ERPDEF' TO DFHEIV1
  6988     MOVE 0
  6989       TO DFHEIV11
  6990*    MOVE '&.IL                  )  N#00006427' TO DFHEIV0
  6991     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6992     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6993     MOVE X'204E233030303036343237' TO DFHEIV0(25:11)
  6994     CALL 'kxdfhei1' USING DFHEIV0,
  6995           DFHEIV1,
  6996           PRODUCT-MASTER,
  6997           DFHEIV12,
  6998           ERPDEF-KEY,
  6999           DFHEIV99,
  7000           DFHEIV11,
  7001           DFHEIV99,
  7002           DFHEIV99
  7003     MOVE EIBRESP  TO WS-RESPONSE
  7004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7005     IF NOT RESP-NORMAL
  7006        GO TO 0730-ENDBR
  7007     END-IF
  7008     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  7009        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  7010           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  7011        ELSE
  7012           GO TO 0730-READNEXT
  7013        END-IF
  7014     ELSE
  7015        GO TO 0730-ENDBR
  7016     END-IF
  7017     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  7018        (P1 > +8)
  7019        OR (PD-PROD-CODE (P1) = 'I')
  7020     END-PERFORM
  7021     IF P1 < +9
  7022        SET DD-IU-PRESENT        TO TRUE
  7023     END-IF
  7024     IF CM-LOAN-TERM = ZEROS
  7025        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  7026     END-IF
  7027     IF PD-TRUNCATED = 'Y'
  7028        MOVE CM-LOAN-TERM        TO WS-TERM
  7029     ELSE
  7030        MOVE CP-ORIGINAL-TERM    TO WS-TERM
  7031     END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 123
* SOCK03.cbl
  7032     EVALUATE TRUE
  7033        WHEN WS-TERM > +168
  7034           MOVE 15               TO P1
  7035        WHEN WS-TERM > +156
  7036           MOVE 14               TO P1
  7037        WHEN WS-TERM > +144
  7038           MOVE 13               TO P1
  7039        WHEN WS-TERM > +132
  7040           MOVE 12               TO P1
  7041        WHEN WS-TERM > +120
  7042           MOVE 11               TO P1
  7043        WHEN WS-TERM > +108
  7044           MOVE 10               TO P1
  7045        WHEN WS-TERM > +96
  7046           MOVE 9                TO P1
  7047        WHEN WS-TERM > +84
  7048           MOVE 8                TO P1
  7049        WHEN WS-TERM > +72
  7050           MOVE 7                TO P1
  7051        WHEN WS-TERM > +60
  7052           MOVE 6                TO P1
  7053        WHEN WS-TERM > +48
  7054           MOVE 5                TO P1
  7055        WHEN WS-TERM > +36
  7056           MOVE 4                TO P1
  7057        WHEN WS-TERM > +24
  7058           MOVE 3                TO P1
  7059        WHEN WS-TERM > +12
  7060           MOVE 2                TO P1
  7061        WHEN OTHER
  7062           MOVE 1                TO P1
  7063     END-EVALUATE
  7064     EVALUATE TRUE
  7065*       WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13)
  7066*          AND (DD-IU-PRESENT)
  7067*          MOVE 2                TO P2
  7068*       WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
  7069*          MOVE 1                TO P2
  7070        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
  7071           MOVE 2                TO P2
  7072        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
  7073           MOVE 3                TO P2
  7074        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
  7075           MOVE 4                TO P2
  7076        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
  7077           MOVE 5                TO P2
  7078        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
  7079           MOVE 6                TO P2
  7080        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
  7081           MOVE 7                TO P2
  7082        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
  7083           MOVE 8                TO P2
  7084        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
  7085           MOVE 9                TO P2
  7086        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
  7087           MOVE 10               TO P2
  7088        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
  7089           MOVE 11               TO P2
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 124
* SOCK03.cbl
  7090        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
  7091           MOVE 12               TO P2
  7092        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
  7093           MOVE 13               TO P2
  7094        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
  7095           MOVE 14               TO P2
  7096        WHEN OTHER
  7097           MOVE 15               TO P2
  7098     END-EVALUATE
  7099     .
  7100 0730-ENDBR.
  7101
  7102* EXEC CICS ENDBR
  7103*       DATASET  ('ERPDEF')
  7104*    END-EXEC
  7105     MOVE 'ERPDEF' TO DFHEIV1
  7106     MOVE 0
  7107       TO DFHEIV11
  7108*    MOVE '&2                    $   #00006529' TO DFHEIV0
  7109     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7110     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7111     MOVE X'2020233030303036353239' TO DFHEIV0(25:11)
  7112     CALL 'kxdfhei1' USING DFHEIV0,
  7113           DFHEIV1,
  7114           DFHEIV11,
  7115           DFHEIV99
  7116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7117     .
  7118 0730-EXIT.
  7119     EXIT.
  7120 0740-GET-ERCTBL.
  7121     MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7122     MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7123     MOVE 'A'                    TO CTBL-BEN-TYPE
  7124     MOVE CM-AH-BENEFIT-CD       TO CTBL-BEN-CODE
  7125     MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7126     PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7127     IF RESP-NORMAL
  7128        PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7129     ELSE
  7130        MOVE AM-COMPANY-CD          TO CTBL-COMPANY-CD
  7131        MOVE AM-A-COMA (S1)         TO CTBL-TABLE
  7132        MOVE 'A'                    TO CTBL-BEN-TYPE
  7133        MOVE 'AA'                   TO CTBL-BEN-CODE
  7134        MOVE CTBL-KEY               TO CTBL-KEY-SAVE
  7135        PERFORM 0750-READ-ERCTBL    THRU 0750-EXIT
  7136        IF RESP-NORMAL
  7137           PERFORM 0760-FIND-COMM   THRU 0760-EXIT
  7138        END-IF
  7139     END-IF
  7140     .
  7141 0740-EXIT.
  7142     EXIT.
  7143 0750-READ-ERCTBL.
  7144
  7145* EXEC CICS READ
  7146*         INTO    (COMM-TABLE-RECORD)
  7147*         DATASET ('ERCTBL')
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 125
* SOCK03.cbl
  7148*         RIDFLD  (CTBL-KEY)
  7149*         RESP    (WS-RESPONSE)
  7150*    END-EXEC
  7151     MOVE LENGTH OF
  7152      COMM-TABLE-RECORD
  7153       TO DFHEIV11
  7154     MOVE 'ERCTBL' TO DFHEIV1
  7155*    MOVE '&"IL       E          (  N#00006559' TO DFHEIV0
  7156     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7158     MOVE X'204E233030303036353539' TO DFHEIV0(25:11)
  7159     CALL 'kxdfhei1' USING DFHEIV0,
  7160           DFHEIV1,
  7161           COMM-TABLE-RECORD,
  7162           DFHEIV11,
  7163           CTBL-KEY,
  7164           DFHEIV99,
  7165           DFHEIV99,
  7166           DFHEIV99
  7167     MOVE EIBRESP  TO WS-RESPONSE
  7168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7169     .
  7170 0750-EXIT.
  7171     EXIT.
  7172 0760-FIND-COMM.
  7173     PERFORM VARYING C1 FROM +1 BY +1 UNTIL
  7174        ((CM-AH-BENEFIT-AMT * CM-AH-ORIG-TERM) <= CT-TBF (C1))
  7175        OR (C1 > +3)
  7176     END-PERFORM
  7177     PERFORM VARYING C2 FROM +1 BY +1 UNTIL
  7178        (CM-INSURED-ISSUE-AGE <= CT-AGE (C2))
  7179        OR (C2 > +3)
  7180     END-PERFORM
  7181     PERFORM VARYING C3 FROM +1 BY +1 UNTIL
  7182        (CM-AH-ORIG-TERM <= CT-TRM (C3))
  7183        OR (C3 > +3)
  7184     END-PERFORM
  7185     IF C1 > +3
  7186        MOVE +1                  TO C1
  7187     END-IF
  7188     IF C2 > +3
  7189        MOVE +1                  TO C2
  7190     END-IF
  7191     IF C3 > +3
  7192        MOVE +1                  TO C3
  7193     END-IF
  7194     IF C1 = +3
  7195        MOVE +18                 TO C0
  7196     ELSE
  7197        IF C1 = +2
  7198           MOVE +9               TO C0
  7199        END-IF
  7200     END-IF
  7201     IF C2 = +3
  7202        ADD +6                   TO C0
  7203     ELSE
  7204        IF C2 = +2
  7205           ADD +3                TO C0
* Micro Focus Server Express         V5.1 revision 000 05-Oct-18 13:07 Page 126
* SOCK03.cbl
  7206        END-IF
  7207     END-IF
  7208     ADD C3                      TO C0
  7209     MOVE CT-RT (C0)             TO WS-COMM-PCT
  7210     .
  7211 0760-EXIT.
  7212     EXIT.
  7213 9700-DATE-LINK.
  7214
  7215* EXEC CICS LINK
  7216*         PROGRAM  ('ELDATCV')
  7217*         COMMAREA (DATE-CONVERSION-DATA)
  7218*         LENGTH   (DC-COMM-LENGTH)
  7219*    END-EXEC.
  7220     MOVE 'ELDATCV' TO DFHEIV1
  7221*    MOVE '."C                   (   #00006610' TO DFHEIV0
  7222     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7223     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7224     MOVE X'2020233030303036363130' TO DFHEIV0(25:11)
  7225     CALL 'kxdfhei1' USING DFHEIV0,
  7226           DFHEIV1,
  7227           DATE-CONVERSION-DATA,
  7228           DC-COMM-LENGTH,
  7229           DFHEIV99,
  7230           DFHEIV99,
  7231           DFHEIV99,
  7232           DFHEIV99
  7233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7234
  7235 9700-EXIT.
  7236      EXIT.
  7237
  7238 9999-DFHBACK SECTION.
  7239     MOVE '9%                    "   ' TO DFHEIV0
  7240     MOVE 'SOCK03' TO DFHEIV1
  7241     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7242     GOBACK.
  7243 9999-DFHEXIT.
  7244     IF DFHEIGDJ EQUAL 0001
  7245         NEXT SENTENCE.
  7246     MOVE '9%                    "   ' TO DFHEIV0
  7247     MOVE 'SOCK03' TO DFHEIV1
  7248     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  7249     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       20032     Code:       30103
