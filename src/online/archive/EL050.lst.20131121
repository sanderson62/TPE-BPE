* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46******************************************************************
    47 ENVIRONMENT DIVISION.
    48
    49 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   3
* EL050.cbl
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53
    54 77  FILLER   PIC X(32) VALUE '********************************'.
    55 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    56 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    57
    58 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    59 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    60                                   USAGE POINTER.
    61 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    62 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    63 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    64                                   USAGE IS POINTER.
    65 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    67                                   USAGE IS POINTER.
    68 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    69 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    70                                   USAGE IS POINTER.
    71
    72 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    73 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    74                                   USAGE IS POINTER.
    75
    76*    COPY ELC50WS.
    77*****************************************************************
    78*                                                               *
    79*                            ELC50WS.                           *
    80*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    81*                            VMOD=2.061.                        *
    82*                                                               *
    83*   THIS IS THE WORKING STORAGE FOR EL050                       *
    84*                                   EL517                       *
    85*****************************************************************
    86******************************************************************
    87*                   C H A N G E   L O G
    88*
    89* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    90*-----------------------------------------------------------------
    91*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    92* EFFECTIVE    NUMBER
    93*-----------------------------------------------------------------
    94* 123102                   PEMA  ADD DCC PROCESSING
    95* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    96* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    97* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    98* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    99* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   100* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   101* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   102* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   103* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   104* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   105* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   106* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   107* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   108* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   4
* EL050.cbl
   109* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   110* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   111* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   112* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   113* 030309  CR2009021700001  PEMA  ADD ER-2883
   114* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   115* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   117* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   118* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   119* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   120* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   121* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   122* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   123* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   124* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   125* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   126* 061412  CR2011022800001  AJRA  NAPERSOFT
   127* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   128* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   129* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   130*-----------------------------------------------------------------
   131
   132 01  WORK-AREAS.
   133
   134*****************************************************************
   135*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   136*****************************************************************
   137
   138     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   139     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   140     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   141     12  WS-NAME-EDIT-WORK-AREA.
   142         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   143         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   144             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   145         16  WS-WORK-NAME.
   146             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   147             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   148             20  FILLER           PIC X(10)     VALUE SPACES.
   149         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   150             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   151
   152*****************************************************************
   153*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   154*****************************************************************
   155
   156     12  WS-ERRESC-KEY.
   157         16 WS-ERRESC-SEARCH-KEY.
   158             20  WS-ERRESC-COMPANY-CD PIC  X.
   159             20  WS-ERRESC-CARRIER    PIC  X.
   160             20  WS-ERRESC-GROUP      PIC X(6).
   161             20  WS-ERRESC-STATE      PIC XX.
   162             20  WS-ERRESC-ACCOUNT    PIC X(10).
   163         16 WS-ERRESC-RESIDUAL-KEY.
   164             20  WS-ERRESC-AGENT      PIC X(10).
   165             20  WS-ERRESC-RES-STATE  PIC XX.
   166             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   5
* EL050.cbl
   167*                                          YYYYMMDD
   168     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   169     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   170
   171*RESIDENT STATE TAX MASTER(ERRESS)
   172*
   173     12  WS-ERRESS-KEY.
   174         16  WS-ERRESS-COMPANY-CD      PIC  X.
   175         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   176         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   177         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   178*                                          YYYYMMDD
   179
   180     12  WS-CONTRACT-DATE              PIC 9(8).
   181*                                          YYYYMMDD
   182     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   183     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   184         16 WS-YEAR-YY                 PIC   9999.
   185         16 FILLER                     PIC 9(4).
   186*                                          YYYYMMDD
   187     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   188     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   189     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   190     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   191
   192     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   193         88  DPRB-1ST-TIME                      VALUE ' '.
   194
   195*****************************************************************
   196*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   197*****************************************************************
   198
   199     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   200     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   201     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   202     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   203     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   204     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   205     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   206     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   207     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   208     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   209         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   210         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   211     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   212         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   213         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   214     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   215
   216     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   217     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   218
   219     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   220     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   221     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   6
* EL050.cbl
   225     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   226     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   229     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   230     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   231     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   232     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   233     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   234     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   237     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   242     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   243     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   253     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   255     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   256     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   257     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   258     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   259     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   260     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   261     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   262     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   263     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   264     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   265     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   266     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   267     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   268     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   269     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   270     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   271     12  WS-2671-SW               PIC X         VALUE SPACE.
   272     12  WS-2672-SW               PIC X         VALUE SPACE.
   273     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   274         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   275     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   276         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   277     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   278
   279     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   280         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   281         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   282         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   7
* EL050.cbl
   283         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   284
   285     12  WS-CREDIT-EDIT-CONTROLS.
   286         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   287         16  WS-MIN-AGE           PIC 99                VALUE  0.
   288         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   289         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   290         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   291         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   292
   293     12  WS-AGE-FIELDS.
   294         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   295         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   296         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   297         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   298
   299     12  WS-SAVE-ALLOWABLE-BENEFIT.
   300         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   301         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   302         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   303         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   304         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   305         16  FILLER                      PIC XX.
   306
   307     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   308     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   309     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   310     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   311     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   312     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   313     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   314     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   315     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   316     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   317
   318     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   319     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   320     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   321     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   322     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   323     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   324     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   325     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   326         88  WS-REDUCING              VALUE 'R'.
   327         88  WS-LEVEL                 VALUE 'L' 'P'.
   328     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   329
   330     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   331     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   332     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   333     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   334     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   335     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   336     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   337     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   338     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   339
   340     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   8
* EL050.cbl
   341     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   342     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   343     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   344     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   345     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   346     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   347     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   348     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   349     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   350     12  WS-ACCT-SIG-SW.
   351         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   352         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   353     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   354     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   355     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   356     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   357     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   358     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   359     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   360     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   361     12  WS-INITIALS.
   362         16  WS-INIT-1            PIC X         VALUE SPACES.
   363         16  WS-INIT-2            PIC X         VALUE SPACES.
   364
   365     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   366     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   367     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   368     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   369     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   370*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   371     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   372     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   373     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   374     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   375     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   376     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   377     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   378     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   379     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   380     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   381     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   382     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   383     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   384     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   385     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   386     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   387     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   388     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   389     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   390     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   391     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   392     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   393******** FLA
   394     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   395     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   398     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page   9
* EL050.cbl
   399********
   400     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   401     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   402     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   403     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   404     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   405     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   406     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   407     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   408     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   409     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   410
   411     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   412         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   413                                         '0' THRU '9'.
   414
   415     12  NUMBER-OF-MONTHS.
   416         16  SK-MO OCCURS 12 TIMES PIC X.
   417
   418     12  WS-WORK-DATE.
   419         16  WS-YEAR            PIC 99    VALUE 00.
   420         16  WS-MONTH           PIC 99    VALUE 00.
   421         16  WS-DAY             PIC 99    VALUE 00.
   422
   423     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   424     12  WS-WORK-CRIT-DEV       REDEFINES
   425         WS-WORK-LF-CRIT-PER    PIC X(03).
   426
   427     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   428     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   429
   430     12  WS-WORK-DATE-FROM.
   431         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   432         16  FILLER             PIC X  VALUE SPACE.
   433         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   434         16  FILLER             PIC X         VALUE SPACE.
   435         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   436
   437     12  WS-WORK-DATE-THRU.
   438         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   439         16  FILLER             PIC X         VALUE SPACE.
   440         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   441         16  FILLER             PIC X         VALUE SPACE.
   442         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   443
   444     12  WS-LF-INPUT-CD.
   445         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   446         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   447
   448     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   449     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   450         16  WS-AH-INPUT-CD-1   PIC X.
   451         16  WS-AH-INPUT-CD-2-3 PIC XX.
   452
   453     12  WS-SWITCHES.
   454         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   455         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   456             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  10
* EL050.cbl
   457         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   458             88  BANK-ACCT-FOUND          VALUE 'Y'.
   459         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   460             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   461         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   462             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   463         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   464             88  COMP-MASTER-FOUND        VALUE 'Y'.
   465         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   466             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   467         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   468             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   469         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   470             88  STAT-MASTER-FOUND        VALUE 'Y'.
   471         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   472             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   473         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   474             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   475         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   476             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   477         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   478             88  FORM-MASTER-FOUND        VALUE 'Y'.
   479         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   480             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   481         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   482             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   483         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   484             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   485         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   486             88  NO-BENEFIT-FOUND         VALUE 'N'.
   487         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   488             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   489         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   490             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   491         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   492             88  AH-BENEFIT-FOUND         VALUE ' '.
   493             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   494         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   495             88  LF-BENEFIT-FOUND         VALUE ' '.
   496             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   497         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   498             88  NO-STATE-RECORD          VALUE '1'.
   499         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   500             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   501         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   502             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   503         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   504             88  CERT-WAS-FOUND           VALUE ' '.
   505             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   506         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   507             88  BROWSE-STARTED           VALUE 'Y'.
   508         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   509             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   510         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   511             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   512         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   513             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   514         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  11
* EL050.cbl
   515             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   516         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   517             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   518         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   519             88  APP-CERT-USED            VALUE 'Y' 'A'.
   520         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   521             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   522             88  FIRST-TIME-THROUGH       VALUE '1'.
   523             88  CTBL-NOT-FOUND           VALUE '2'.
   524
   525         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   526             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   527
   528         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   529             88  DLO-ERROR-FOUND          VALUE 'Y'.
   530
   531********FLA
   532     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   533     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   534********
   535     12  RC-SW-1                  PIC X           VALUE '0'.
   536     12  RC-SW-2                  PIC X           VALUE '0'.
   537     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   538     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   539     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   540     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   541     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   542     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   543     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   544     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   545     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   546     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   547     12  LIT-SPACES               PIC X           VALUE SPACES.
   548     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   549     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   550     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   551     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   552     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   553     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   554     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   555         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   556         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   557     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   558         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   559
   560 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   561     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   562     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   563 01  WS-CRI-SSN-WORK-AREA.
   564     05  WS-CRI-SOC-SEC-NO.
   565         10  WS-SS-REPT-CD       PIC X(5).
   566         10  WS-SS-LAST-NAME     PIC X(5).
   567         10  WS-SS-INITIAL       PIC X.
   568
   569     05  WS-CRI-REPORT-CODE.
   570         10  FILLER              PIC X(5).
   571         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   572
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  12
* EL050.cbl
   573     05  WS-CRI-LAST-NAME.
   574         10  WS-CRI-NAME-MOVE    PIC X(5).
   575         10  FILLER              PIC X(10).
   576
   577 01  WS-NUM-TABLE                PIC X(26)  VALUE
   578     '12345678012345070923456789'.
   579 01  FILLER REDEFINES WS-NUM-TABLE.
   580     05  WS-NUM OCCURS 26        PIC 9.
   581 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   582 01  V1                          PIC S999 COMP-3.
   583 01  V2                          PIC S999 COMP-3.
   584 01  V3                          PIC S999 COMP-3.
   585 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   586 01  FILLER REDEFINES WS-WORK-VIN.
   587     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   588 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   589 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   590 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   591 01  WS-HEX-WORK.
   592     05  FILLER                  PIC X  VALUE LOW-VALUES.
   593     05  WS-HEX-BYTE             PIC X.
   594 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   595 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   596 01  WS-WORK-HIN-ROW-B.
   597     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   598
   599 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   600 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   601     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   602 01  WS-ROW-D-TABLE.
   603     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   604
   605 01  WS-HIN-TABLE-B.
   606     05  F                       PIC XX VALUE 'A2'.
   607     05  F                       PIC XX VALUE 'B3'.
   608     05  F                       PIC XX VALUE 'C4'.
   609     05  F                       PIC XX VALUE 'D5'.
   610     05  F                       PIC XX VALUE 'E6'.
   611     05  F                       PIC XX VALUE 'F7'.
   612     05  F                       PIC XX VALUE 'G8'.
   613     05  F                       PIC XX VALUE 'H9'.
   614     05  F                       PIC XX VALUE 'I1'.
   615     05  F                       PIC XX VALUE 'J2'.
   616     05  F                       PIC XX VALUE 'K3'.
   617     05  F                       PIC XX VALUE 'L4'.
   618     05  F                       PIC XX VALUE 'M5'.
   619     05  F                       PIC XX VALUE 'N6'.
   620     05  F                       PIC XX VALUE 'O0'.
   621     05  F                       PIC XX VALUE 'P7'.
   622     05  F                       PIC XX VALUE 'Q0'.
   623     05  F                       PIC XX VALUE 'R8'.
   624     05  F                       PIC XX VALUE 'S9'.
   625     05  F                       PIC XX VALUE 'T2'.
   626     05  F                       PIC XX VALUE 'U3'.
   627     05  F                       PIC XX VALUE 'V4'.
   628     05  F                       PIC XX VALUE 'W5'.
   629     05  F                       PIC XX VALUE 'X6'.
   630     05  F                       PIC XX VALUE 'Y7'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  13
* EL050.cbl
   631     05  F                       PIC XX VALUE 'Z8'.
   632 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   633     05  WS-VAL-IN               PIC X.
   634     05  WS-VAL-OUT              PIC 9.
   635 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   636 01  WS-COMPARE-BINARY-DATES.
   637     05  WS-971231                PIC XX VALUE X'92FF'.
   638     05  WS-931231                PIC XX VALUE X'8CFF'.
   639     05  WS-791231                PIC XX VALUE X'77FF'.
   640     05  WS-771001                PIC XX VALUE X'74A1'.
   641     05  WS-820301                PIC XX VALUE X'7B41'.
   642     05  WS-831031                PIC XX VALUE X'7DBF'.
   643     05  WS-831231                PIC XX VALUE X'7DFF'.
   644     05  WS-810831                PIC XX VALUE X'7A7F'.
   645     05  WS-830901                PIC XX VALUE X'7D81'.
   646
   647 01  FILE-ACCESS-IDS.
   648     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   649     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   650     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   651     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   652     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   653     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   654     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   655     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   656     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   657     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   658     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   659     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   660     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   661     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   662     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   663     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   664     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   665 01  DD-IU-SW                    PIC X   VALUE ' '.
   666     88  DD-IU-PRESENT                 VALUE 'Y'.
   667
   668 01  ACCESS-KEYS.
   669     12  ELMSTR-KEY.
   670         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   671         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   672     12  W-CLAIM-KEY.
   673         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   674         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   675
   676     12  ELCNTL-KEY.
   677         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   678         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   679         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   680         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   681
   682     12  ELCERT-KEY.
   683         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   684         16  CERT-CARRIER         PIC X       VALUE SPACE.
   685         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   686         16  CERT-STATE           PIC XX      VALUE SPACES.
   687         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   688         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  14
* EL050.cbl
   689         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   690
   691     12  ELCERT2-KEY.
   692         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   693         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   694
   695     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   696
   697     12  ELCERT-SAVE.
   698         16  FILLER                      PIC XX    VALUE SPACES.
   699
   700         16  WCS-CONTROL-PRIMARY.
   701             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   702             20  WCS-CARRIER             PIC X     VALUE SPACE.
   703             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   704             20  WCS-STATE               PIC XX    VALUE SPACES.
   705             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   706             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   707             20  WCS-CERT-NO.
   708                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   709                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   710
   711         16  CS-CONTROL-BY-NAME.
   712             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   713             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   714             20  CS-INSURED-INITIALS.
   715                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   716                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   717
   718         16  CS-CONTROL-BY-SSN.
   719             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   720             20  CS-SOC-SEC-NO.
   721                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   722                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   723                 24  CS-SSN-LN3.
   724                     28 CS-INSURED-INITIALS-A2   PIC XX
   725                                     VALUE SPACES.
   726                     28 CS-PART-LAST-NAME-A2     PIC X
   727                                     VALUE SPACE.
   728
   729         16  CS-CONTROL-BY-CERT-NO.
   730             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   731             20  CS-CERT-NO-A4           PIC X(11)
   732                                     VALUE SPACES.
   733
   734         16  CS-CONTROL-BY-MEMB.
   735             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   736             20  CS-MEMBER-NO.
   737                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   738                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   739                 24  CS-MEMB-LN4.
   740                     28 CS-INSURED-INITIALS-A5   PIC XX
   741                                      VALUE SPACES.
   742                     28 CS-PART-LAST-NAME-A5     PIC XX
   743                                      VALUE SPACES.
   744
   745         16  FILLER              PIC X(360) VALUE SPACES.
   746
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  15
* EL050.cbl
   747     12  ERACCT-KEY.
   748         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   749         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   750         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   751         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   752         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   753         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   754
   755     12  ERCOMP-KEY.
   756         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   757         16  COMP-CARRIER         PIC X     VALUE SPACES.
   758         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   759         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   760         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   761         16  COMP-TYPE            PIC X     VALUE SPACES.
   762
   763     12  ERLOFC-KEY.
   764         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   765         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   766         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   767         16  LOFC-STATE           PIC XX    VALUE SPACES.
   768         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   769         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   770
   771     12  WS-ELCRTT-KEY.
   772         16  WS-ELCRTT-PRIMARY       PIC X(33).
   773         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   774
   775     12  ERBXRF-KEY.
   776         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   777         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   778         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   779         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   780
   781     12  ERAGTC-KEY.
   782         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   783         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   784         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   785         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   786         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   787         16  AGTC-TYPE            PIC X     VALUE SPACES.
   788
   789     12  ERPLAN-KEY.
   790         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   791         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   792         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   793         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   794         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   795         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   796         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   797         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   798
   799     12  ERFORM-KEY.
   800         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   801         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   802         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   803         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   804
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  16
* EL050.cbl
   805     12  ERREIN-KEY.
   806         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   807         16  REIN-TYPE            PIC X     VALUE SPACES.
   808         16  REIN-TABLE-CO.
   809             20  REIN-CODE-1      PIC X     VALUE SPACE.
   810             20  REIN-CODE-2      PIC X     VALUE SPACE.
   811             20  REIN-CODE-3      PIC X     VALUE SPACE.
   812         16  FILLER               PIC X(3)  VALUE SPACES.
   813
   814     12  ERCTBL-KEY.
   815         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   816         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   817         16  CTBL-CNTRL-2.
   818             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   819             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   820
   821     12  ELCRTO-KEY.
   822         16  ELCRTO-COMPANY-CD       PIC X.
   823         16  ELCRTO-CARRIER          PIC X.
   824         16  ELCRTO-GROUPING         PIC X(6).
   825         16  ELCRTO-STATE            PIC XX.
   826         16  ELCRTO-ACCOUNT          PIC X(10).
   827         16  ELCRTO-CERT-EFF-DT      PIC XX.
   828         16  ELCRTO-CERT-NO.
   829             20  ELCRTO-CERT-PRIME   PIC X(10).
   830             20  ELCRTO-CERT-SFX     PIC X.
   831         16  ELCRTO-RECORD-TYPE      PIC X.
   832         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   833
   834
   835     12  WS-ACCESS.
   836         16  FILLER               PIC XX    VALUE SPACES.
   837         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   838
   839     12  WS-CARR-ACCESS.
   840         16  FILLER               PIC X(3)  VALUE SPACES.
   841         16  WS-CARR              PIC X     VALUE SPACE.
   842*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   843*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   844     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   845         88  WS-DMD-LF-RATING   VALUE 'Y'.
   846         88  WS-DMD-AH-RATING   VALUE 'Y'.
   847         88  WS-DMD-NO-RATING   VALUE 'N'.
   848
   849     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   850         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   851                                         'NJ' 'NL'
   852                                         'PJ' 'PL'
   853                                         'SJ' 'SL'.
   854     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   855         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   856                                         'NI' 'NJ' 'NL' 'NU'
   857                                         'PJ' 'PL' 'PI' 'PU'
   858                                         'SI' 'SJ' 'SL' 'SU'
   859                                         'MX' 'MY' 'MZ'.
   860 01  ERPDEF-KEY-SAVE             PIC X(18).
   861 01  ERPDEF-KEY.
   862     12  ERPDEF-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  17
* EL050.cbl
   863     12  ERPDEF-STATE            PIC XX.
   864     12  ERPDEF-PROD-CD          PIC XXX.
   865     12  F                       PIC X(7).
   866     12  ERPDEF-BEN-TYPE         PIC X.
   867     12  ERPDEF-BEN-CODE         PIC XX.
   868     12  ERPDEF-EXP-DT           PIC XX.
   869
   870 01  ELSTAT-KEY-SAVE             PIC X(20).
   871 01  ELSTAT-KEY.
   872     12  ELSTAT-COMPANY-ID       PIC XXX.
   873     12  ELSTAT-CARRIER          PIC X.
   874     12  ELSTAT-GROUP            PIC X(6).
   875     12  ELSTAT-STATE            PIC XX.
   876     12  ELSTAT-EXP-DT           PIC 9(8).
   877 01  WS-ERROR-VALUES.
   878     12  ER-1570                     PIC S9(4)   VALUE +1570.
   879     12  ER-1571                     PIC S9(4)   VALUE +1571.
   880     12  ER-1575                     PIC S9(4)   VALUE +1575.
   881     12  ER-1891                     PIC S9(4)   VALUE +1891.
   882     12  ER-1892                     PIC S9(4)   VALUE +1892.
   883     12  ER-1893                     PIC S9(4)   VALUE +1893.
   884     12  ER-1894                     PIC S9(4)   VALUE +1894.
   885     12  ER-1895                     PIC S9(4)   VALUE +1895.
   886     12  ER-1896                     PIC S9(4)   VALUE +1896.
   887     12  ER-1897                     PIC S9(4)   VALUE +1897.
   888     12  ER-1898                     PIC S9(4)   VALUE +1898.
   889     12  ER-1899                     PIC S9(4)   VALUE +1899.
   890     12  ER-1900                     PIC S9(4)   VALUE +1900.
   891     12  ER-1901                     PIC S9(4)   VALUE +1901.
   892     12  ER-1902                     PIC S9(4)   VALUE +1902.
   893     12  ER-1903                     PIC S9(4)   VALUE +1903.
   894     12  ER-1904                     PIC S9(4)   VALUE +1904.
   895     12  ER-1905                     PIC S9(4)   VALUE +1905.
   896     12  ER-1906                     PIC S9(4)   VALUE +1906.
   897     12  ER-1907                     PIC S9(4)   VALUE +1907.
   898     12  ER-1909                     PIC S9(4)   VALUE +1909.
   899     12  ER-1910                     PIC S9(4)   VALUE +1910.
   900     12  ER-1911                     PIC S9(4)   VALUE +1911.
   901     12  ER-1912                     PIC S9(4)   VALUE +1912.
   902     12  ER-1913                     PIC S9(4)   VALUE +1913.
   903     12  ER-1914                     PIC S9(4)   VALUE +1914.
   904     12  ER-1915                     PIC S9(4)   VALUE +1915.
   905     12  ER-1916                     PIC S9(4)   VALUE +1916.
   906     12  ER-1917                     PIC S9(4)   VALUE +1917.
   907     12  ER-1918                     PIC S9(4)   VALUE +1918.
   908     12  ER-1919                     PIC S9(4)   VALUE +1919.
   909     12  ER-1920                     PIC S9(4)   VALUE +1920.
   910     12  ER-1921                     PIC S9(4)   VALUE +1921.
   911     12  ER-1922                     PIC S9(4)   VALUE +1922.
   912     12  ER-1923                     PIC S9(4)   VALUE +1923.
   913     12  ER-1924                     PIC S9(4)   VALUE +1924.
   914     12  ER-1925                     PIC S9(4)   VALUE +1925.
   915     12  ER-1926                     PIC S9(4)   VALUE +1926.
   916     12  ER-1927                     PIC S9(4)   VALUE +1927.
   917     12  ER-2393                     PIC S9(4)   VALUE +2393.
   918     12  ER-2600                     PIC S9(4)   VALUE +2600.
   919     12  ER-2601                     PIC S9(4)   VALUE +2601.
   920     12  ER-2602                     PIC S9(4)   VALUE +2602.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  18
* EL050.cbl
   921     12  ER-2603                     PIC S9(4)   VALUE +2603.
   922     12  ER-2604                     PIC S9(4)   VALUE +2604.
   923     12  ER-2605                     PIC S9(4)   VALUE +2605.
   924     12  ER-2606                     PIC S9(4)   VALUE +2606.
   925     12  ER-2607                     PIC S9(4)   VALUE +2607.
   926     12  ER-2608                     PIC S9(4)   VALUE +2608.
   927     12  ER-2609                     PIC S9(4)   VALUE +2609.
   928     12  ER-2610                     PIC S9(4)   VALUE +2610.
   929     12  ER-2611                     PIC S9(4)   VALUE +2611.
   930     12  ER-2612                     PIC S9(4)   VALUE +2612.
   931     12  ER-2613                     PIC S9(4)   VALUE +2613.
   932     12  ER-2614                     PIC S9(4)   VALUE +2614.
   933     12  ER-2615                     PIC S9(4)   VALUE +2615.
   934     12  ER-2616                     PIC S9(4)   VALUE +2616.
   935     12  ER-2617                     PIC S9(4)   VALUE +2617.
   936     12  ER-2618                     PIC S9(4)   VALUE +2618.
   937     12  ER-2619                     PIC S9(4)   VALUE +2619.
   938     12  ER-2620                     PIC S9(4)   VALUE +2620.
   939     12  ER-2621                     PIC S9(4)   VALUE +2621.
   940     12  ER-2622                     PIC S9(4)   VALUE +2622.
   941     12  ER-2623                     PIC S9(4)   VALUE +2623.
   942     12  ER-2624                     PIC S9(4)   VALUE +2624.
   943     12  ER-2625                     PIC S9(4)   VALUE +2625.
   944     12  ER-2626                     PIC S9(4)   VALUE +2626.
   945     12  ER-2627                     PIC S9(4)   VALUE +2627.
   946     12  ER-2628                     PIC S9(4)   VALUE +2628.
   947     12  ER-2629                     PIC S9(4)   VALUE +2629.
   948     12  ER-2630                     PIC S9(4)   VALUE +2630.
   949     12  ER-2631                     PIC S9(4)   VALUE +2631.
   950     12  ER-2632                     PIC S9(4)   VALUE +2632.
   951     12  ER-2633                     PIC S9(4)   VALUE +2633.
   952     12  ER-2634                     PIC S9(4)   VALUE +2634.
   953     12  ER-2635                     PIC S9(4)   VALUE +2635.
   954     12  ER-2636                     PIC S9(4)   VALUE +2636.
   955     12  ER-2637                     PIC S9(4)   VALUE +2637.
   956     12  ER-2638                     PIC S9(4)   VALUE +2638.
   957     12  ER-2639                     PIC S9(4)   VALUE +2639.
   958     12  ER-2640                     PIC S9(4)   VALUE +2640.
   959     12  ER-2641                     PIC S9(4)   VALUE +2641.
   960     12  ER-2642                     PIC S9(4)   VALUE +2642.
   961     12  ER-2643                     PIC S9(4)   VALUE +2643.
   962     12  ER-2644                     PIC S9(4)   VALUE +2644.
   963     12  ER-2645                     PIC S9(4)   VALUE +2645.
   964     12  ER-2646                     PIC S9(4)   VALUE +2646.
   965     12  ER-2647                     PIC S9(4)   VALUE +2647.
   966     12  ER-2648                     PIC S9(4)   VALUE +2648.
   967     12  ER-2649                     PIC S9(4)   VALUE +2649.
   968     12  ER-2650                     PIC S9(4)   VALUE +2650.
   969     12  ER-2651                     PIC S9(4)   VALUE +2651.
   970     12  ER-2652                     PIC S9(4)   VALUE +2652.
   971     12  ER-2653                     PIC S9(4)   VALUE +2653.
   972     12  ER-2654                     PIC S9(4)   VALUE +2654.
   973     12  ER-2655                     PIC S9(4)   VALUE +2655.
   974     12  ER-2656                     PIC S9(4)   VALUE +2656.
   975     12  ER-2657                     PIC S9(4)   VALUE +2657.
   976     12  ER-2658                     PIC S9(4)   VALUE +2658.
   977     12  ER-2659                     PIC S9(4)   VALUE +2659.
   978     12  ER-2660                     PIC S9(4)   VALUE +2660.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  19
* EL050.cbl
   979     12  ER-2661                     PIC S9(4)   VALUE +2661.
   980     12  ER-2662                     PIC S9(4)   VALUE +2662.
   981     12  ER-2663                     PIC S9(4)   VALUE +2663.
   982     12  ER-2664                     PIC S9(4)   VALUE +2664.
   983     12  ER-2665                     PIC S9(4)   VALUE +2665.
   984     12  ER-2666                     PIC S9(4)   VALUE +2666.
   985     12  ER-2667                     PIC S9(4)   VALUE +2667.
   986     12  ER-2668                     PIC S9(4)   VALUE +2668.
   987     12  ER-2669                     PIC S9(4)   VALUE +2669.
   988     12  ER-2670                     PIC S9(4)   VALUE +2670.
   989     12  ER-2671                     PIC S9(4)   VALUE +2671.
   990     12  ER-2672                     PIC S9(4)   VALUE +2672.
   991     12  ER-2673                     PIC S9(4)   VALUE +2673.
   992     12  ER-2674                     PIC S9(4)   VALUE +2674.
   993     12  ER-2675                     PIC S9(4)   VALUE +2675.
   994     12  ER-2676                     PIC S9(4)   VALUE +2676.
   995     12  ER-2677                     PIC S9(4)   VALUE +2677.
   996     12  ER-2678                     PIC S9(4)   VALUE +2678.
   997     12  ER-2679                     PIC S9(4)   VALUE +2679.
   998     12  ER-2680                     PIC S9(4)   VALUE +2680.
   999     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1000     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1001     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1002     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1003     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1004     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1005     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1006     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1007     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1008     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1009     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1010     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1011     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1012     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1013     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1014     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1015     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1016     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1017     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1018     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1019     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1020     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1021     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1022     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1023     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1024     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1025     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1026     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1027     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1028     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1029     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1030     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1031     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1032     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1033     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1034     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1035     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1036     12  ER-2728                     PIC S9(4)   VALUE +2728.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  20
* EL050.cbl
  1037     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1038     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1039     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1040     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1041     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1042     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1043     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1044     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1045     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1046     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1047     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1048     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1049     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1050     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1051     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1052     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1053     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1054     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1055     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1056     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1057     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1058     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1059     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1060     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1061     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1062     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1063     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1064     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1065     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1066     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1067     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1068     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1069     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1070     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1071     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1072     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1073     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1074     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1075     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1076     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1077     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1078     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1079     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1080     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1081     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1082     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1083     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1084     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1085     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1086     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1087     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1088     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1089     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1090     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1091     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1092     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1093     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1094     12  ER-2788                     PIC S9(4)   VALUE +2788.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  21
* EL050.cbl
  1095     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1096     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1097     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1098     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1099     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1100     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1101     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1102     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1103     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1104     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1105     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1106     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1107     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1108     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1109     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1110     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1111     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1112     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1113     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1114     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1115     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1116     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1117     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1118     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1119     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1120     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1121     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1122     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1123     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1124     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1125     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1126     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1127     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1128     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1129     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1130     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1131     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1132     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1133     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1134     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1135     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1136     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1137     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1138     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1139     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1140     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1141     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1142     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1143     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1144     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1145     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1146     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1147     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1148     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1149     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1150     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1151     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1152     12  ER-8039                     PIC S9(4)   VALUE +8039.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  22
* EL050.cbl
  1153     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1154     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1155     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1156     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1157     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1158     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1159     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1160     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1161     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1162     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1163     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1164     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1165     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1166     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1167     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1168     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1169     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1170     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1171     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1172     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1173     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1174     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1175     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1176     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1177     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1178     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1179     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1180     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1181     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1182     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1183     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1184     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1185     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1186     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1187     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1188     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1189     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1190     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1191     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1192     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1193     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1194     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1195     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1196     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1197     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1198     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1199     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1200     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1201     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1202     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1203     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1204     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1205     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1206     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1207     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1208     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1209     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1210     12  ER-8313                     PIC S9(4)   VALUE +8313.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  23
* EL050.cbl
  1211     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1212     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1213     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1214     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1215     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1216     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1217     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1218     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1219     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1220******************************************************************
  1221***************   END OF ELC50WS     ****************************
  1222******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  24
* EL050.cbl
  1225 01  WORKING-STORAGE-WORK-AREAS.
  1226     12  WS-RESPONSE             PIC S9(8)  COMP.
  1227         88  WS-RESP-NORMAL           VALUE +00.
  1228         88  WS-RESP-ERROR            VALUE +01.
  1229         88  WS-RESP-NOTFND           VALUE +13.
  1230         88  WS-RESP-DUPREC           VALUE +14.
  1231         88  WS-RESP-ENDFILE          VALUE +20.
  1232     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1233     12  WORK-AREAS.
  1234         16  WK-CONV-GREG.
  1235             24  WCG-CENT             PIC XX.
  1236             24  WCG-REST             PIC X(4).
  1237         16  WORK-GREGORIAN-DATE.
  1238             24  WK-GREG-CENT         PIC XX.
  1239             24  WK-GREG-DATE-YYMMDD.
  1240                 28  WK-GREG-YYMM     PIC X(4).
  1241                 28  WK-GREG-DD       PIC XX.
  1242
  1243         16  WORK-SELECT-DATE.
  1244             24  WK-SELECT-CENT            PIC XX.
  1245             24  WK-SELECT-DATE-YYMMDD.
  1246                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1247                 28  FILLER                PIC XX.
  1248
  1249         16  WK-FORM-NO.
  1250             24  WK-FORM-BANK-ID       PIC X(5).
  1251             24  WK-FORM-UNDRWRTR      PIC X(1).
  1252             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1253
  1254         16  WK-MEMBER-NO.
  1255             24  WK-MEMBER-1-6        PIC X(6).
  1256             24  WK-MEMBER-7-12       PIC X(6).
  1257
  1258         16  WK-FULL-CERT-NO.
  1259             24  WK-CERT-POS-1-2      PIC X(2).
  1260             24  WK-CERT-POS-3        PIC X(1).
  1261             24  WK-CERT-POS-4        PIC X(1).
  1262             24  WK-CERT-POS-5-6      PIC X(2).
  1263             24  WK-CERT-POS-7        PIC X(1).
  1264             24  WK-CERT-POS-8-11     PIC X(4).
  1265
  1266         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1267             88  VALID-RATE-CODE        VALUE 'Y'.
  1268             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1269
  1270         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1271         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1272         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1273         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1274         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1275         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1276         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1277         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1278         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1279         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1280
  1281* DLO001
  1282 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  25
* EL050.cbl
  1283     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1284     12  DMPF-RETURN-CODE          PIC XX.
  1285         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1286         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1287         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1288         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1289         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1290         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1291
  1292* DLO002
  1293 01  WS-DLO-INTERNAL-POLICY-FORM.
  1294     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1295     12  DIPF-RETURN-CODE          PIC XX.
  1296         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1297         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1298         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1299         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1300         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1301         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1302
  1303* DLO003
  1304 01  WS-DLO-VALID-BANK-ID.
  1305     12  DVBI-BANK-ID              PIC X(5).
  1306     12  DVBI-BANK-ID-TYPE         PIC X.
  1307         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1308         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1309         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1310         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1311         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1312     12  DVBI-RETURN-CODE          PIC XX.
  1313         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1314         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1315         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1316         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1317         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1318         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1319         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1320         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1321         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1322
  1323* DLO007
  1324 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1325     12  DCUA-RES-STATE            PIC XX.
  1326     12  DCUA-BEN-TYPE             PIC XX.
  1327     12  DCUA-SYS-IDENT            PIC X.
  1328         88  DCUA-CLAIM                        VALUE 'C'.
  1329         88  DCUA-PREMIUM                      VALUE 'P'.
  1330     12  DCUA-COVERAGE-RULE        PIC X.
  1331     12  DCUA-CLIENT-ID            PIC X(10).
  1332     12  DCUA-EFF-DATE             PIC X(8).
  1333     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1334     12  DCUA-RETURN-CODE          PIC XX.
  1335         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1336     12  DCUA-CERT-NUMBER          PIC X(11).
  1337     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1338     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1339
  1340* DLO011
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  26
* EL050.cbl
  1341 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1342     12  DPRB-RATE-CODE            PIC X(4).
  1343     12  DPRB-COVERAGE-CATEG       PIC X.
  1344     12  DPRB-RETURN-CODE          PIC XX.
  1345         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1346         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1347         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1348         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1349         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1350         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1351         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1352         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1353         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1354     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1355     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1356     12  DPRB-BEN-TYPE             PIC XX.
  1357
  1358* DLO017
  1359 01  WS-DLO-VALID-RATE-CODE.
  1360     12  DVRC-RATE-CODE            PIC X(4).
  1361     12  DVRC-RETURN-CODE          PIC XX.
  1362         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1363         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1364         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1365         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1366         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1367         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1368
  1369* DLO019
  1370 01  WS-DLO-ORIG-COV-CAT.
  1371     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1372     12  DOCC-RETURN-CODE          PIC XX.
  1373     12  DOCC-ORIG-COV-CAT         PIC X.
  1374     12  DOCC-UNDERWITER           PIC XX.
  1375     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1376     12  DOCC-FILLER               PIC X(6).
  1377
  1378* DLO021
  1379 01  WS-DLO-VALID-LOAN-OFFICER.
  1380     12  DVLO-LOAN-OFFICER.
  1381         16  DVLO-BILL-TYPE        PIC X.
  1382         16  DVLO-BILL-SOURCE      PIC X.
  1383         16  DVLO-BATCH-TYPE       PIC X.
  1384     12  DVLO-RETURN-CODE          PIC XX.
  1385         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1386         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1387         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1388         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1389         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1390         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1391
  1392* DLO022
  1393 01  WS-DLO-VALID-STATE-CODE.
  1394     12  DVSC-STATE-CODE           PIC XX.
  1395     12  DVSC-RETURN-CODE          PIC XX.
  1396         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1397
  1398* DLO023
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  27
* EL050.cbl
  1399 01  WS-DLO-VALID-CODE-VALUES.
  1400     12  DVCV-SYSTEM-ID            PIC XX.
  1401         88  DVCV-CLAIMS                       VALUE 'CL'.
  1402         88  DVCV-CREDIT                       VALUE 'CR'.
  1403     12  DVCV-RECORD-TYPE          PIC XX.
  1404         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1405         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1406         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1407         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1408         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1409         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1410         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1411         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1412     12  DVCV-RECORD-KEY           PIC X(6).
  1413     12  DVCV-RETURN-CODE          PIC XX.
  1414         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1415         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1416         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1417         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1418         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1419         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1420         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1421     12  DVCV-CODE-DESC            PIC X(60).
  1422     12  DVCV-GEN-DESC-1           PIC X(20).
  1423     12  DVCV-GEN-DESC-2           PIC X(20).
  1424     12  DVCV-GEN-DESC-3           PIC X(20).
  1425
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  28
* EL050.cbl
  1427*    COPY ERCBXRF.
  1428******************************************************************
  1429*                                                                *
  1430*                                                                *
  1431*                            ERCBXRF                             *
  1432*                                                                *
  1433*   ONLINE CREDIT SYSTEM                                         *
  1434*                                                                *
  1435*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1436*                                                                *
  1437*   FILE TYPE = VSAM,KSDS                                        *
  1438*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1439*                                                                *
  1440*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1441*       ALTERNATE PATH = NONE                                    *
  1442*                                                                *
  1443*   LOG = NO                                                     *
  1444*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1445*                                                                *
  1446******************************************************************
  1447
  1448 01  BANK-CROSS-REFERENCE.
  1449     12  BK-RECORD-ID                PIC XX.
  1450         88  VALID-BK-ID             VALUE 'BK'.
  1451
  1452     12  BK-CONTROL-PRIMARY.
  1453         16  BK-COMPANY-CD           PIC X.
  1454         16  BK-CARRIER              PIC X.
  1455         16  BK-GROUPING             PIC X(6).
  1456         16  BK-BANK-NO              PIC X(10).
  1457
  1458     12  BK-MAINT-INFORMATION.
  1459         16  BK-LAST-MAINT-DT        PIC XX.
  1460         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1461         16  BK-LAST-MAINT-USER      PIC X(4).
  1462         16  FILLER                  PIC X(9).
  1463
  1464     12  FILLER                      PIC X(37).
  1465
  1466     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1467
  1468     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1469                            DEPENDING ON BK-BANK-POINTER-CNT.
  1470         16  BK-AM-ACCOUNT           PIC X(10).
  1471         16  BK-AM-EXP-DT            PIC XX.
  1472         16  BK-AM-EFF-DT            PIC XX.
  1473         16  BK-AM-STATE             PIC XX.
  1474         16  FILLER                  PIC X(20).
  1475
  1476******************************************************************
  1477
  1478*    COPY ERCCOMP.
  1479******************************************************************
  1480*                                                                *
  1481*                                                                *
  1482*                            ERCCOMP                             *
  1483*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1484*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  29
* EL050.cbl
  1485*                                                                *
  1486*   ONLINE CREDIT SYSTEM                                         *
  1487*                                                                *
  1488*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1489*                                                                *
  1490*   FILE TYPE = VSAM,KSDS                                        *
  1491*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1492*                                                                *
  1493*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1494*       ALTERNATE PATH = NONE                                    *
  1495*                                                                *
  1496*   LOG = NO                                                     *
  1497*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1498*                                                                *
  1499******************************************************************
  1500*                   C H A N G E   L O G
  1501*
  1502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1503*-----------------------------------------------------------------
  1504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1505* EFFECTIVE    NUMBER
  1506*-----------------------------------------------------------------
  1507* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1508* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1509* 092205    2005050300006  PEMA  ADD LEASE FEE
  1510* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1511* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1512* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1513* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1514* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1515* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1516******************************************************************
  1517
  1518 01  COMPENSATION-MASTER.
  1519     12  CO-RECORD-ID                          PIC XX.
  1520         88  VALID-CO-ID                          VALUE 'CO'.
  1521
  1522     12  CO-CONTROL-PRIMARY.
  1523         16  CO-COMPANY-CD                     PIC X.
  1524         16  CO-CONTROL.
  1525             20  CO-CTL-1.
  1526                 24  CO-CARR-GROUP.
  1527                     28  CO-CARRIER            PIC X.
  1528                     28  CO-GROUPING.
  1529                         32  CO-GROUP-PREFIX   PIC XXX.
  1530                         32  CO-GROUP-PRIME    PIC XXX.
  1531                 24  CO-RESP-NO.
  1532                     28  CO-RESP-PREFIX        PIC X(4).
  1533                     28  CO-RESP-PRIME         PIC X(6).
  1534             20  CO-CTL-2.
  1535                 24  CO-ACCOUNT.
  1536                     28  CO-ACCT-PREFIX        PIC X(4).
  1537                     28  CO-ACCT-PRIME         PIC X(6).
  1538         16  CO-TYPE                           PIC X.
  1539             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1540             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1541             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1542
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  30
* EL050.cbl
  1543     12  CO-MAINT-INFORMATION.
  1544         16  CO-LAST-MAINT-DT                  PIC XX.
  1545         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1546         16  CO-LAST-MAINT-USER                PIC X(4).
  1547     12  FILLER                                PIC XX.
  1548     12  CO-STMT-TYPE                          PIC XXX.
  1549     12  CO-COMP-TYPE                          PIC X.
  1550         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1551     12  CO-STMT-OWNER                         PIC X(4).
  1552     12  CO-BALANCE-CONTROL                    PIC X.
  1553         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1554         88  CO-NO-BALANCE                        VALUE 'N'.
  1555
  1556     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1557         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1558         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1559         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1560
  1561     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1562         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1563         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1564
  1565     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1566     12  CO-GA-DIRECT-DEP                      PIC X.
  1567     12  CO-FUTURE-SPACE                       PIC X.
  1568         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1569
  1570     12  CO-ACCT-NAME                          PIC X(30).
  1571     12  CO-MAIL-NAME                          PIC X(30).
  1572     12  CO-ADDR-1                             PIC X(30).
  1573     12  CO-ADDR-2                             PIC X(30).
  1574     12  CO-ADDR-3.
  1575         16  CO-ADDR-CITY                      PIC X(27).
  1576         16  CO-ADDR-STATE                     PIC XX.
  1577     12  CO-CSO-1099                           PIC X.
  1578     12  CO-ZIP.
  1579         16  CO-ZIP-PRIME.
  1580             20  CO-ZIP-PRI-1ST                PIC X.
  1581                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1582             20  FILLER                        PIC X(4).
  1583         16  CO-ZIP-PLUS4                      PIC X(4).
  1584     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1585         16  CO-CAN-POSTAL-1                   PIC XXX.
  1586         16  CO-CAN-POSTAL-2                   PIC XXX.
  1587         16  FILLER                            PIC XXX.
  1588     12  CO-SOC-SEC                            PIC X(13).
  1589     12  CO-TELEPHONE.
  1590         16  CO-AREA-CODE                      PIC XXX.
  1591         16  CO-PREFIX                         PIC XXX.
  1592         16  CO-PHONE                          PIC X(4).
  1593
  1594     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1595
  1596     12  CO-AR-BAL-LEVEL                       PIC X.
  1597         88  CO-AR-REF-LVL                        VALUE '1'.
  1598         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1599         88  CO-AR-BILL-LVL                       VALUE '2'.
  1600         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  31
* EL050.cbl
  1601         88  CO-AR-FR-LVL                         VALUE '4'.
  1602
  1603     12  CO-AR-NORMAL-PRINT                    PIC X.
  1604         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1605         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1606
  1607     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1608
  1609     12  CO-AR-REPORTING                       PIC X.
  1610         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1611         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1612
  1613     12  CO-AR-PULL-CHECK                      PIC X.
  1614         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1615         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1616
  1617     12  CO-AR-BALANCE-PRINT                   PIC X.
  1618         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1619
  1620     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1621         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1622         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1623         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1624
  1625     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1626
  1627     12  CO-USER-CODE                          PIC X.
  1628     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1629
  1630******************************************************************
  1631*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1632*    THE LAST MONTH END RUN.
  1633******************************************************************
  1634
  1635     12  CO-LAST-ACTIVITY-DATE.
  1636         16  CO-ACT-YEAR                       PIC 99.
  1637         16  CO-ACT-MONTH                      PIC 99.
  1638         16  CO-ACT-DAY                        PIC 99.
  1639
  1640     12  CO-LAST-STMT-DT.
  1641         16  CO-LAST-STMT-YEAR                 PIC 99.
  1642         16  CO-LAST-STMT-MONTH                PIC 99.
  1643         16  CO-LAST-STMT-DAY                  PIC 99.
  1644
  1645     12  CO-MO-END-TOTALS.
  1646         16  CO-MONTHLY-TOTALS.
  1647             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1648             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1649             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1650             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1651             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1652
  1653         16  CO-AGING-TOTALS.
  1654             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1655             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1656             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1657             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1658
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  32
* EL050.cbl
  1659         16  CO-YTD-TOTALS.
  1660             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1661             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1662
  1663         16  CO-OVER-UNDER-TOTALS.
  1664             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1665             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1666
  1667     12  CO-MISCELLANEOUS-TOTALS.
  1668         16  CO-FICA-TOTALS.
  1669             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1670             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1671
  1672         16  CO-CLAIM-TOTALS.
  1673             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1674             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1675
  1676******************************************************************
  1677*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1678*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1679******************************************************************
  1680
  1681     12  CO-CURRENT-TOTALS.
  1682         16  CO-CURRENT-LAST-STMT-DT.
  1683             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1684             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1685             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1686
  1687         16  CO-CURRENT-MONTHLY-TOTALS.
  1688             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1689             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1690             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1691             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1692             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1693
  1694         16  CO-CURRENT-AGING-TOTALS.
  1695             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1696             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1697             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1698             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1699
  1700         16  CO-CURRENT-YTD-TOTALS.
  1701             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1702             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1703
  1704     12  CO-PAID-COMM-TOTALS.
  1705         16  CO-YTD-PAID-COMMS.
  1706             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1707             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1708
  1709     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1710         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1711         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1712
  1713     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1714         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1715         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1716         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  33
* EL050.cbl
  1717         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1718         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1719         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1720         88  CO-FINAL-LETTER                  VALUE 'F'.
  1721         88  CO-RECONCILING                   VALUE 'R'.
  1722         88  CO-PHONE-CALL                    VALUE 'P'.
  1723         88  CO-LEGAL                         VALUE 'L'.
  1724         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1725         88  CO-WRITE-OFF                     VALUE 'W'.
  1726         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1727
  1728     12  CO-CSR-CODE                       PIC X(4).
  1729
  1730     12  CO-GA-STATUS-INFO.
  1731         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1732         16  CO-GA-TERMINATION-DT          PIC XX.
  1733         16  CO-GA-STATUS-CODE             PIC X.
  1734             88  CO-GA-ACTIVE                 VALUE 'A'.
  1735             88  CO-GA-INACTIVE               VALUE 'I'.
  1736             88  CO-GA-PENDING                VALUE 'P'.
  1737         16  CO-GA-COMMENTS.
  1738             20  CO-GA-COMMENT-1           PIC X(40).
  1739             20  CO-GA-COMMENT-2           PIC X(40).
  1740             20  CO-GA-COMMENT-3           PIC X(40).
  1741             20  CO-GA-COMMENT-4           PIC X(40).
  1742
  1743     12  CO-RPTCD2                         PIC X(10).
  1744     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1745         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1746         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1747
  1748     12  CO-TYPE-AGENT                     PIC X(01).
  1749         88  CO-CORPORATION                   VALUE 'C'.
  1750         88  CO-PARTNERSHIP                   VALUE 'P'.
  1751         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1752         88  CO-TRUST                         VALUE 'T'.
  1753         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1754
  1755     12  CO-FAXNO.
  1756         16  CO-FAX-AREA-CODE                  PIC XXX.
  1757         16  CO-FAX-PREFIX                     PIC XXX.
  1758         16  CO-FAX-PHONE                      PIC X(4).
  1759
  1760     12  CO-BANK-INFORMATION.
  1761         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1762         16  CO-BANK-TRANSIT-NON REDEFINES
  1763             CO-BANK-TRANSIT-NO                PIC 9(8).
  1764
  1765         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1766     12  CO-MISC-DEDUCT-INFO REDEFINES
  1767                  CO-BANK-INFORMATION.
  1768         16  CO-MD-GL-ACCT                     PIC X(10).
  1769         16  CO-MD-DIV                         PIC XX.
  1770         16  CO-MD-CENTER                      PIC X(4).
  1771         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1772         16  CO-CREATE-AP-CHECK                PIC X.
  1773         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1774         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  34
* EL050.cbl
  1775     12  CO-ACH-STATUS                         PIC X.
  1776         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1777         88  CO-ACH-PENDING                        VALUE 'P'.
  1778
  1779     12  CO-BILL-SW                            PIC X.
  1780     12  CO-CONTROL-NAME                       PIC X(30).
  1781     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1782     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1783     12  CO-CLP-STATE                          PIC XX.
  1784     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1785     12  CO-SPP-REFUND-EDIT                    PIC X.
  1786
  1787******************************************************************
  1788
  1789*    COPY ERCAGTC.
  1790******************************************************************
  1791*                                                                *
  1792*                                                                *
  1793*                            ERCAGTC                             *
  1794*                            VMOD=2.001                          *
  1795*                                                                *
  1796*   ONLINE CREDIT SYSTEM                                         *
  1797*                                                                *
  1798*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1799*                                                                *
  1800*   FILE TYPE = VSAM,KSDS                                        *
  1801*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1802*                                                                *
  1803*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1804*       ALTERNATE PATH = NONE                                    *
  1805*                                                                *
  1806*   LOG = NO                                                     *
  1807*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1808*                                                                *
  1809******************************************************************
  1810*                   C H A N G E   L O G
  1811*
  1812* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1813*-----------------------------------------------------------------
  1814*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1815* EFFECTIVE    NUMBER
  1816*-----------------------------------------------------------------
  1817* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1818* 111004                         NEW FILE AND COPYBOOK
  1819* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1820******************************************************************
  1821 01  AGENT-COMMISSIONS.
  1822     12  AG-RECORD-ID                          PIC XX.
  1823         88  VALID-CO-ID                          VALUE 'AG'.
  1824     12  AG-CONTROL-PRIMARY.
  1825         16  AG-COMPANY-CD                     PIC X.
  1826         16  AG-CONTROL.
  1827             20  AG-CTL-1.
  1828                 24  AG-CARR-GROUP.
  1829                     28  AG-CARRIER            PIC X.
  1830                     28  AG-GROUPING           PIC X(6).
  1831                 24  AG-BANK                   PIC X(10).
  1832             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  35
* EL050.cbl
  1833                 24  AG-EXP-DT                 PIC XX.
  1834         16  AG-TYPE                           PIC X.
  1835             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1836             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1837     12  AG-MAINT-INFORMATION.
  1838         16  AG-LAST-MAINT-DT                  PIC XX.
  1839         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1840         16  AG-LAST-MAINT-USER                PIC X(4).
  1841         16  FILLER                            PIC X(10).
  1842     12  AG-EFF-DT                             PIC XX.
  1843     12  AG-COMM-STRUCTURE.
  1844         16  AG-AGT-COMMS OCCURS 10.
  1845             20  AG-AGT                PIC X(10).
  1846             20  AG-COM-TYP            PIC X.
  1847             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1848             20  AG-RECALC-LV-INDIC    PIC X.
  1849             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1850             20  AG-LRCALC-LV-INDIC    PIC X.
  1851             20  FILLER                PIC X(05).
  1852     12  FILLER                  PIC X(145).
  1853******************************************************************
  1854*    COPY ERCRESS.
  1855******************************************************************
  1856*                                                                *
  1857*                            ERCRESS                             *
  1858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1859*                            VMOD=2.002                          *
  1860*                                                                *
  1861*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1862*                                                                *
  1863*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1864*   VSAM RESIDENT STATE TAX MASTER                              *
  1865*                                                                *
  1866*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1867*                                                                *
  1868*   FILE TYPE = VSAM,KSDS                                        *
  1869*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1870*                                                                *
  1871*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1872*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1873*                                                                *
  1874*   LOG = NO                                                     *
  1875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1876*                                                                *
  1877*                                                                *
  1878******************************************************************
  1879
  1880 01  RESIDENT-STATE-TAX-MASTER.
  1881
  1882     10  ERRESS-PRIMARY-KEY.
  1883         15  RES-COMPANY-CD        PIC X.
  1884         15  RES-RESIDENT-STATE    PIC XX.
  1885         15  RES-COVERAGE-CATEGORY PIC X.
  1886         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1887*                                      YYYYMMDD
  1888*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1889
  1890     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  36
* EL050.cbl
  1891
  1892         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1893         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1894         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1895         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1896
  1897     10 RES-RECALC-SW              PIC   X.
  1898         88 RECALC                VALUE 'Y'.
  1899         88 NO-RECALC             VALUE 'N'.
  1900     10  RES-MAINT-BY              PIC X(4).
  1901     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1902     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1903*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  37
* EL050.cbl
  1905*    COPY ERCRESC.
  1906******************************************************************
  1907*                                                                *
  1908*                            ERCRESC                             *
  1909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1910*                            VMOD=2.003                          *
  1911*                                                                *
  1912*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1913*                                                                *
  1914*   FILE TYPE = VSAM,KSDS                                        *
  1915*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1916*                                                                *
  1917*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1918*       ALTERNATE PATH1 = NONE                                   *
  1919*                                                                *
  1920*   LOG = NO                                                     *
  1921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1922*                                                                *
  1923******************************************************************
  1924
  1925 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1926
  1927     10  ERRESC-RECORD-KEY.
  1928         15  RESC-COMPANY-CD           PIC   X.
  1929         15  RESC-CARRIER              PIC   X.
  1930         15  RESC-GROUP                PIC   X(6).
  1931         15  RESC-STATE                PIC   XX.
  1932         15  RESC-ACCOUNT              PIC   X(10).
  1933         15  RESC-AGENT                PIC   X(10).
  1934         15  RESC-RESIDENT-STATE       PIC   XX.
  1935         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1936*                                           YYYYMMDD
  1937     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1938
  1939     10  RESC-COMM-RECORD-DATA.
  1940         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1941             20 RESC-COVERAGE-CAT      PIC    X.
  1942             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1943             20 RESC-COMMISSION-TAB REDEFINES
  1944                RESC-COMMISSION-PER    PIC  XXX.
  1945
  1946     10  RESC-MAINT-BY                 PIC X(4).
  1947     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1948     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1949*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  38
* EL050.cbl
  1951*    COPY ERCPLAN.
  1952******************************************************************
  1953*                                                                *
  1954*                                                                *
  1955*                            ERCPLAN                             *
  1956*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1957*                            VMOD=2.003                          *
  1958*                                                                *
  1959*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1960*                                                                *
  1961*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1962*   PLAN MASTER                                                  *
  1963*                                                                *
  1964*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1965*                                                                *
  1966*   FILE TYPE = VSAM,KSDS                                        *
  1967*   RECORD SIZE = 420   RECFORM = FIX                            *
  1968*                                                                *
  1969*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1970*       ALTERNATE PATH1 = N/A                                    *
  1971*                                                                *
  1972*   LOG = NO                                                     *
  1973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1974*                                                                *
  1975*                                                                *
  1976******************************************************************
  1977
  1978 01  PLAN-MASTER.
  1979     12  PL-RECORD-ID                      PIC XX.
  1980         88  VALID-PL-ID                      VALUE 'PL'.
  1981
  1982     12  PL-CONTROL-PRIMARY.
  1983         16  PL-COMPANY-CD                 PIC X.
  1984         16  PL-MSTR-CNTRL.
  1985             20  PL-CONTROL-A.
  1986                 24  PL-CARRIER            PIC X.
  1987                 24  PL-GROUPING           PIC X(6).
  1988                 24  PL-STATE              PIC XX.
  1989                 24  PL-ACCOUNT            PIC X(10).
  1990             20  PL-BENEFIT-TYPE           PIC X.
  1991             20  PL-BENEFIT-CODE           PIC XX.
  1992             20  PL-REVISION-NO            PIC X(3).
  1993
  1994     12  PL-CONTROL-BY-VAR-GRP.
  1995         16  PL-COMPANY-CD-A1              PIC X.
  1996         16  PL-VG-CARRIER                 PIC X.
  1997         16  PL-VG-GROUPING                PIC X(6).
  1998         16  PL-VG-STATE                   PIC XX.
  1999         16  PL-VG-ACCOUNT                 PIC X(10).
  2000         16  PL-BENEFIT-TYPE-A1            PIC X.
  2001         16  PL-BENEFIT-CODE-A1            PIC XX.
  2002         16  PL-REVISION-NO-A1             PIC 999.
  2003
  2004     12  PL-MAINT-INFORMATION.
  2005         16  PL-LAST-MAINT-DT              PIC XX.
  2006         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2007         16  PL-LAST-MAINT-USER            PIC X(4).
  2008         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  39
* EL050.cbl
  2009
  2010     12  PL-LIABILITY-LIMITS.
  2011         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2012         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2013             20  PL-LM-AGE                 PIC S99        COMP-3.
  2014             20  PL-LM-DUR                 PIC S999       COMP-3.
  2015             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2016             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2017
  2018     12  FILLER                            PIC X(30).
  2019
  2020     12  PL-GL-ACCOUNT-NOS.
  2021         16  PL-PREMIUM-GL                 PIC X(8).
  2022         16  PL-COMM-GL                    PIC X(8).
  2023         16  PL-CLAIM-GL                   PIC X(8).
  2024     12  FILLER                            PIC X(24).
  2025     12  PL-TOLERANCES.
  2026         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2027         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2028         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2029         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2030         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2031         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2032     12  PL-OVER-SHORT.
  2033         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2034         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2035     12  FILLER                            PIC X(24).
  2036     12  PLAN-MISC.
  2037         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2038         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2039         16  PL-IG                         PIC X.
  2040         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2041         16  PL-POLICY-FORM                PIC X(12).
  2042         16  PL-EDIT-FOR-FORM              PIC X(01).
  2043         16  PL-DEV-CODE                   PIC XXX.
  2044         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2045         16  PL-CALC-METHOD                PIC X.
  2046         16  PL-BENEFIT-GROUP              PIC X(05).
  2047         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2048
  2049         16  FILLER                        PIC X(99).
  2050******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  40
* EL050.cbl
  2052*    COPY ELCCERT.
  2053******************************************************************
  2054*                                                                *
  2055*                            ELCCERT.                            *
  2056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2057*                            VMOD=2.013                          *
  2058*                                                                *
  2059*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2060*                                                                *
  2061*   FILE TYPE = VSAM,KSDS                                        *
  2062*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2063*                                                                *
  2064*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2065*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2066*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2067*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2068*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2069*                                                                *
  2070*   LOG = YES                                                    *
  2071*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2072******************************************************************
  2073*                   C H A N G E   L O G
  2074*
  2075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2076*-----------------------------------------------------------------
  2077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2078* EFFECTIVE    NUMBER
  2079*-----------------------------------------------------------------
  2080* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2081* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2082* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2083* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2084* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2085* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2086* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2087* 032612  CR2011110200001  PEMA  AHL CHANGES
  2088******************************************************************
  2089
  2090 01  CERTIFICATE-MASTER.
  2091     12  CM-RECORD-ID                      PIC XX.
  2092         88  VALID-CM-ID                      VALUE 'CM'.
  2093
  2094     12  CM-CONTROL-PRIMARY.
  2095         16  CM-COMPANY-CD                 PIC X.
  2096         16  CM-CARRIER                    PIC X.
  2097         16  CM-GROUPING.
  2098             20  CM-GROUPING-PREFIX        PIC X(3).
  2099             20  CM-GROUPING-PRIME         PIC X(3).
  2100         16  CM-STATE                      PIC XX.
  2101         16  CM-ACCOUNT.
  2102             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2103             20  CM-ACCOUNT-PRIME          PIC X(6).
  2104         16  CM-CERT-EFF-DT                PIC XX.
  2105         16  CM-CERT-NO.
  2106             20  CM-CERT-PRIME             PIC X(10).
  2107             20  CM-CERT-SFX               PIC X.
  2108
  2109     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  41
* EL050.cbl
  2110         16  CM-COMPANY-CD-A1              PIC X.
  2111         16  CM-INSURED-LAST-NAME          PIC X(15).
  2112         16  CM-INSURED-INITIALS.
  2113             20  CM-INSURED-INITIAL1       PIC X.
  2114             20  CM-INSURED-INITIAL2       PIC X.
  2115
  2116     12  CM-CONTROL-BY-SSN.
  2117         16  CM-COMPANY-CD-A2              PIC X.
  2118         16  CM-SOC-SEC-NO.
  2119             20  CM-SSN-STATE              PIC XX.
  2120             20  CM-SSN-ACCOUNT            PIC X(6).
  2121             20  CM-SSN-LN3.
  2122                 25  CM-INSURED-INITIALS-A2.
  2123                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2124                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2125                 25 CM-PART-LAST-NAME-A2         PIC X.
  2126
  2127     12  CM-CONTROL-BY-CERT-NO.
  2128         16  CM-COMPANY-CD-A4              PIC X.
  2129         16  CM-CERT-NO-A4                 PIC X(11).
  2130
  2131     12  CM-CONTROL-BY-MEMB.
  2132         16  CM-COMPANY-CD-A5              PIC X.
  2133         16  CM-MEMBER-NO.
  2134             20  CM-MEMB-STATE             PIC XX.
  2135             20  CM-MEMB-ACCOUNT           PIC X(6).
  2136             20  CM-MEMB-LN4.
  2137                 25  CM-INSURED-INITIALS-A5.
  2138                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2139                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2140                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2141
  2142     12  CM-INSURED-PROFILE-DATA.
  2143         16  CM-INSURED-FIRST-NAME.
  2144             20  CM-INSURED-1ST-INIT       PIC X.
  2145             20  FILLER                    PIC X(9).
  2146         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2147         16  CM-INSURED-SEX                PIC X.
  2148             88  CM-SEX-MALE                  VALUE 'M'.
  2149             88  CM-SEX-FEMAL                 VALUE 'F'.
  2150         16  CM-INSURED-JOINT-AGE          PIC 99.
  2151         16  CM-JOINT-INSURED-NAME.
  2152             20  CM-JT-LAST-NAME           PIC X(15).
  2153             20  CM-JT-FIRST-NAME.
  2154                 24  CM-JT-1ST-INIT        PIC X.
  2155                 24  FILLER                PIC X(9).
  2156             20  CM-JT-INITIAL             PIC X.
  2157
  2158     12  CM-LIFE-DATA.
  2159         16  CM-LF-BENEFIT-CD              PIC XX.
  2160         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2161         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2162         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2163         16  CM-LF-DEV-CODE                PIC XXX.
  2164         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2165         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2166         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2167         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  42
* EL050.cbl
  2168         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2169         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2170         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2171         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2172         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2173         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2174         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2175         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2176         16  FILLER                        PIC XX.
  2177
  2178     12  CM-AH-DATA.
  2179         16  CM-AH-BENEFIT-CD              PIC XX.
  2180         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2181         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2182         16  CM-AH-DEV-CODE                PIC XXX.
  2183         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2184         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2185         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2186         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2187         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2188         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2189         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2190         16  CM-AH-PAID-THRU-DT            PIC XX.
  2191             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2192         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2193         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2194         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2195         16  FILLER                        PIC X.
  2196
  2197     12  CM-LOAN-INFORMATION.
  2198         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2199         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2200                                           PIC S9(5)V99  COMP-3.
  2201         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2202         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2203         16  CM-PAY-FREQUENCY              PIC S99.
  2204         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2205         16  CM-RATE-CLASS                 PIC XX.
  2206         16  CM-BENEFICIARY                PIC X(25).
  2207         16  CM-POLICY-FORM-NO             PIC X(12).
  2208         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2209         16  CM-LAST-ADD-ON-DT             PIC XX.
  2210         16  CM-DEDUCTIBLE-AMOUNTS.
  2211             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2212             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2213         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2214             20  CM-RESIDENT-STATE         PIC XX.
  2215             20  CM-RATE-CODE              PIC X(4).
  2216             20  FILLER                    PIC XX.
  2217         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2218             20  CM-LOAN-OFFICER           PIC X(5).
  2219             20  FILLER                    PIC XXX.
  2220         16  CM-CSR-CODE                   PIC XXX.
  2221         16  CM-UNDERWRITING-CODE          PIC X.
  2222             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2223         16  CM-POST-CARD-IND              PIC X.
  2224         16  CM-NH-INTERFACE-SW            PIC X.
  2225         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  43
* EL050.cbl
  2226             88  CM-SING-PRM                  VALUE '1'.
  2227             88  CM-O-B-COVERAGE              VALUE '2'.
  2228             88  CM-OPEN-END                  VALUE '3'.
  2229         16  CM-IND-GRP-TYPE               PIC X.
  2230             88  CM-INDIVIDUAL                VALUE 'I'.
  2231             88  CM-GROUP                     VALUE 'G'.
  2232         16  CM-SKIP-CODE                  PIC X.
  2233             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2234             88  SKIP-JULY                    VALUE '1'.
  2235             88  SKIP-AUGUST                  VALUE '2'.
  2236             88  SKIP-SEPTEMBER               VALUE '3'.
  2237             88  SKIP-JULY-AUG                VALUE '4'.
  2238             88  SKIP-AUG-SEPT                VALUE '5'.
  2239             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2240             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2241             88  SKIP-JUNE                    VALUE '8'.
  2242             88  SKIP-JUNE-JULY               VALUE '9'.
  2243             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2244             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2245         16  CM-PAYMENT-MODE               PIC X.
  2246             88  PAY-MONTHLY                  VALUE SPACE.
  2247             88  PAY-WEEKLY                   VALUE '1'.
  2248             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2249             88  PAY-BI-WEEKLY                VALUE '3'.
  2250             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2251         16  CM-LOAN-NUMBER                PIC X(8).
  2252         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2253         16  CM-OLD-LOF                    PIC XXX.
  2254*        16  CM-LOAN-OFFICER               PIC XXX.
  2255         16  CM-REIN-TABLE                 PIC XXX.
  2256         16  CM-SPECIAL-REIN-CODE          PIC X.
  2257         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2258         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2259         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2260
  2261     12  CM-STATUS-DATA.
  2262         16  CM-ENTRY-STATUS               PIC X.
  2263         16  CM-ENTRY-DT                   PIC XX.
  2264
  2265         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2266         16  CM-LF-CANCEL-DT               PIC XX.
  2267         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2268
  2269         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2270         16  CM-LF-DEATH-DT                PIC XX.
  2271         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2272
  2273         16  CM-LF-CURRENT-STATUS          PIC X.
  2274             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2275                                                'M' '4' '5' '9'.
  2276             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2277             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2278             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2279             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2280             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2281             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2282             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2283             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  44
* EL050.cbl
  2284             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2285             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2286             88  CM-LF-DECLINED               VALUE 'D'.
  2287             88  CM-LF-VOIDED                 VALUE 'V'.
  2288
  2289         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2290         16  CM-AH-CANCEL-DT               PIC XX.
  2291         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2292
  2293         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2294         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2295         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2296
  2297         16  CM-AH-CURRENT-STATUS          PIC X.
  2298             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2299                                                'M' '4' '5' '9'.
  2300             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2301             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2302             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2303             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2304             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2305             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2306             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2307             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2308             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2309             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2310             88  CM-AH-DECLINED               VALUE 'D'.
  2311             88  CM-AH-VOIDED                 VALUE 'V'.
  2312
  2313         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2314             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2315             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2316             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2317         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2318
  2319         16  CM-ENTRY-BATCH                PIC X(6).
  2320         16  CM-LF-EXIT-BATCH              PIC X(6).
  2321         16  CM-AH-EXIT-BATCH              PIC X(6).
  2322         16  CM-LAST-MONTH-END             PIC XX.
  2323
  2324     12  CM-NOTE-SW                        PIC X.
  2325         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2326         88  CERT-NOTES-PRESENT               VALUE '1'.
  2327         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2328         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2329         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2330         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2331         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2332         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2333     12  CM-COMP-EXCP-SW                   PIC X.
  2334         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2335         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2336     12  CM-INSURED-ADDRESS-SW             PIC X.
  2337         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2338         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2339
  2340*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2341     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  45
* EL050.cbl
  2342     12  FILLER                            PIC X.
  2343
  2344*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2345     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2346     12  FILLER                            PIC X.
  2347*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2348     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2349
  2350     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2351         88  CERT-ADDED-BATCH                 VALUE ' '.
  2352         88  CERT-ADDED-ONLINE                VALUE '1'.
  2353         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2354         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2355         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2356     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2357         88  CERT-AS-LOADED                   VALUE ' '.
  2358         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2359         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2360         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2361         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2362         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2363         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2364         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2365
  2366     12  CM-ACCOUNT-COMM-PCTS.
  2367         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2368         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2369
  2370     12  CM-USER-FIELD                     PIC X.
  2371     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2372     12  CM-CLP-STATE                      PIC XX.
  2373     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2374     12  CM-USER-RESERVED                  PIC XXX.
  2375     12  FILLER REDEFINES CM-USER-RESERVED.
  2376         16  CM-AH-CLASS-CD                PIC XX.
  2377         16  F                             PIC X.
  2378******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  46
* EL050.cbl
  2380*    COPY ERCMAIL.
  2381******************************************************************
  2382*                                                                *
  2383*                                                                *
  2384*                            ERCMAIL                             *
  2385*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2386*                            VMOD=2.003                          *
  2387*                                                                *
  2388*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2389*                                                                *
  2390*   FILE TYPE = VSAM,KSDS                                        *
  2391*   RECORD SIZE = 374   RECFORM = FIX                            *
  2392*                                                                *
  2393*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2394*   ALTERNATE PATH    = NOT USED                                 *
  2395*                                                                *
  2396*   LOG = YES                                                    *
  2397*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2398******************************************************************
  2399*                   C H A N G E   L O G
  2400*
  2401* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2402*-----------------------------------------------------------------
  2403*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2404* EFFECTIVE    NUMBER
  2405*-----------------------------------------------------------------
  2406* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2407* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2408* 111108                   PEMA  ADD CRED BENE ADDR2
  2409******************************************************************
  2410
  2411 01  MAILING-DATA.
  2412     12  MA-RECORD-ID                      PIC XX.
  2413         88  VALID-MA-ID                       VALUE 'MA'.
  2414
  2415     12  MA-CONTROL-PRIMARY.
  2416         16  MA-COMPANY-CD                 PIC X.
  2417         16  MA-CARRIER                    PIC X.
  2418         16  MA-GROUPING.
  2419             20  MA-GROUPING-PREFIX        PIC XXX.
  2420             20  MA-GROUPING-PRIME         PIC XXX.
  2421         16  MA-STATE                      PIC XX.
  2422         16  MA-ACCOUNT.
  2423             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2424             20  MA-ACCOUNT-PRIME          PIC X(6).
  2425         16  MA-CERT-EFF-DT                PIC XX.
  2426         16  MA-CERT-NO.
  2427             20  MA-CERT-PRIME             PIC X(10).
  2428             20  MA-CERT-SFX               PIC X.
  2429
  2430     12  FILLER                            PIC XX.
  2431
  2432     12  MA-ACCESS-CONTROL.
  2433         16  MA-SOURCE-SYSTEM              PIC XX.
  2434             88  MA-FROM-CREDIT                VALUE 'CR'.
  2435             88  MA-FROM-VSI                   VALUE 'VS'.
  2436             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2437             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  47
* EL050.cbl
  2438         16  MA-RECORD-ADD-DT              PIC XX.
  2439         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2440         16  MA-LAST-MAINT-DT              PIC XX.
  2441         16  MA-LAST-MAINT-BY              PIC XXXX.
  2442         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2443
  2444     12  MA-PROFILE-INFO.
  2445         16  MA-QUALIFY-CODE-1             PIC XX.
  2446         16  MA-QUALIFY-CODE-2             PIC XX.
  2447         16  MA-QUALIFY-CODE-3             PIC XX.
  2448         16  MA-QUALIFY-CODE-4             PIC XX.
  2449         16  MA-QUALIFY-CODE-5             PIC XX.
  2450
  2451         16  MA-INSURED-LAST-NAME          PIC X(15).
  2452         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2453         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2454         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2455         16  MA-INSURED-BIRTH-DT           PIC XX.
  2456         16  MA-INSURED-SEX                PIC X.
  2457             88  MA-SEX-MALE                   VALUE 'M'.
  2458             88  MA-SEX-FEMALE                 VALUE 'F'.
  2459         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2460
  2461         16  MA-ADDRESS-CORRECTED          PIC X.
  2462         16  MA-JOINT-BIRTH-DT             PIC XX.
  2463*        16  FILLER                        PIC X(12).
  2464
  2465         16  MA-ADDRESS-LINE-1             PIC X(30).
  2466         16  MA-ADDRESS-LINE-2             PIC X(30).
  2467         16  MA-CITY-STATE.
  2468             20  MA-CITY                   PIC X(28).
  2469             20  MA-ADDR-STATE             PIC XX.
  2470         16  MA-ZIP.
  2471             20  MA-ZIP-CODE.
  2472                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2473                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2474                 24  FILLER                PIC X(4).
  2475             20  MA-ZIP-PLUS4              PIC X(4).
  2476         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2477             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2478             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2479             20  FILLER                    PIC X(3).
  2480
  2481         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2482
  2483         16  FILLER                        PIC XXX.
  2484*        16  FILLER                        PIC X(10).
  2485
  2486     12  MA-CRED-BENE-INFO.
  2487         16  MA-CRED-BENE-NAME                 PIC X(25).
  2488         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2489         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2490         16  MA-CRED-BENE-CTYST.
  2491             20  MA-CRED-BENE-CITY             PIC X(28).
  2492             20  MA-CRED-BENE-STATE            PIC XX.
  2493         16  MA-CRED-BENE-ZIP.
  2494             20  MA-CB-ZIP-CODE.
  2495                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  48
* EL050.cbl
  2496                     88  MA-CB-CANADIAN-POST-CODE
  2497                                           VALUE 'A' THRU 'Z'.
  2498                 24  FILLER                    PIC X(4).
  2499             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2500         16  MA-CB-CANADIAN-POSTAL-CODE
  2501                            REDEFINES MA-CRED-BENE-ZIP.
  2502             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2503             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2504             20  FILLER                        PIC X(3).
  2505     12  MA-POST-CARD-MAIL-DATA.
  2506         16  MA-MAIL-DATA OCCURS 7.
  2507             20  MA-MAIL-TYPE              PIC X.
  2508                 88  MA-12MO-MAILING           VALUE '1'.
  2509                 88  MA-EXP-MAILING            VALUE '2'.
  2510             20  MA-MAIL-STATUS            PIC X.
  2511                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2512                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2513                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2514             20  MA-MAIL-DATE              PIC XX.
  2515     12  FILLER                            PIC XX.
  2516     12  FILLER                            PIC XX.
  2517*    12  FILLER                            PIC X(30).
  2518******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  49
* EL050.cbl
  2520*    COPY ERCPNDM.
  2521******************************************************************
  2522*                                                                *
  2523*                                                                *
  2524*                            ERCPNDM                             *
  2525*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2526*                            VMOD=2.003                          *
  2527*                                                                *
  2528*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2529*                                                                *
  2530*   FILE TYPE = VSAM,KSDS                                        *
  2531*   RECORD SIZE = 374   RECFORM = FIX                            *
  2532*                                                                *
  2533*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2534*   ALTERNATE PATH    = NOT USED                                 *
  2535*                                                                *
  2536*   LOG = YES                                                    *
  2537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2538******************************************************************
  2539*                   C H A N G E   L O G
  2540*
  2541* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2542*-----------------------------------------------------------------
  2543*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2544* EFFECTIVE    NUMBER
  2545*-----------------------------------------------------------------
  2546* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2547* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2548* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2549******************************************************************
  2550
  2551 01  PENDING-MAILING-DATA.
  2552     12  PM-RECORD-ID                      PIC XX.
  2553         88  VALID-MA-ID                       VALUE 'PM'.
  2554
  2555     12  PM-CONTROL-PRIMARY.
  2556         16  PM-COMPANY-CD                 PIC X.
  2557         16  PM-ENTRY-BATCH                PIC X(6).
  2558         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2559         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2560
  2561     12  FILLER                            PIC X(14).
  2562
  2563     12  PM-ACCESS-CONTROL.
  2564         16  PM-SOURCE-SYSTEM              PIC XX.
  2565             88  PM-FROM-CREDIT                VALUE 'CR'.
  2566             88  PM-FROM-VSI                   VALUE 'VS'.
  2567             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2568             88  PM-FROM-OTHER                 VALUE 'OT'.
  2569         16  PM-RECORD-ADD-DT              PIC XX.
  2570         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2571         16  PM-LAST-MAINT-DT              PIC XX.
  2572         16  PM-LAST-MAINT-BY              PIC XXXX.
  2573         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2574
  2575     12  PM-PROFILE-INFO.
  2576         16  PM-QUALIFY-CODE-1             PIC XX.
  2577         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  50
* EL050.cbl
  2578         16  PM-QUALIFY-CODE-3             PIC XX.
  2579         16  PM-QUALIFY-CODE-4             PIC XX.
  2580         16  PM-QUALIFY-CODE-5             PIC XX.
  2581
  2582         16  PM-INSURED-LAST-NAME          PIC X(15).
  2583         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2584         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2585         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2586         16  PM-INSURED-BIRTH-DT           PIC XX.
  2587         16  PM-INSURED-SEX                PIC X.
  2588             88  PM-SEX-MALE                   VALUE 'M'.
  2589             88  PM-SEX-FEMALE                 VALUE 'F'.
  2590         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2591
  2592         16  PM-ADDRESS-CORRECTED          PIC X.
  2593         16  PM-JOINT-BIRTH-DT             PIC XX.
  2594*        16  FILLER                        PIC X(12).
  2595
  2596         16  PM-ADDRESS-LINE-1             PIC X(30).
  2597         16  PM-ADDRESS-LINE-2             PIC X(30).
  2598         16  PM-CITY-STATE.
  2599             20  PM-CITY                   PIC X(28).
  2600             20  PM-STATE                  PIC XX.
  2601         16  PM-ZIP.
  2602             20  PM-ZIP-CODE.
  2603                 24  PM-ZIP-1              PIC X.
  2604                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2605                 24  FILLER                PIC X(4).
  2606             20  PM-ZIP-PLUS4              PIC X(4).
  2607         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2608             20  PM-CAN-POST1              PIC XXX.
  2609             20  PM-CAN-POST2              PIC XXX.
  2610             20  FILLER                    PIC XXX.
  2611
  2612         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2613
  2614         16  FILLER                        PIC X(03).
  2615
  2616     12  PM-CRED-BENE-INFO.
  2617         16  PM-CRED-BENE-NAME             PIC X(25).
  2618         16  PM-CRED-BENE-ADDR             PIC X(30).
  2619         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2620         16  PM-CRED-BENE-CTYST.
  2621             20  PM-CRED-BENE-CITY         PIC X(28).
  2622             20  PM-CRED-BENE-STATE        PIC XX.
  2623         16  PM-CRED-BENE-ZIP.
  2624             20  PM-CB-ZIP-CODE.
  2625                 24  PM-CB-ZIP-1           PIC X.
  2626                     88  PM-CB-CANADIAN-POST-CODE
  2627                                  VALUE 'A' THRU 'Z'.
  2628                 24  FILLER                PIC X(4).
  2629             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2630         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2631             20  PM-CB-CAN-POST1           PIC XXX.
  2632             20  PM-CB-CAN-POST2           PIC XXX.
  2633             20  FILLER                    PIC XXX.
  2634     12  PM-POST-CARD-MAIL-DATA.
  2635         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  51
* EL050.cbl
  2636             20  PM-MAIL-TYPE              PIC X.
  2637                 88  PM-12MO-MAILING           VALUE '1'.
  2638                 88  PM-EXP-MAILING            VALUE '2'.
  2639             20  PM-MAIL-STATUS            PIC X.
  2640                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2641                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2642                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2643             20  PM-MAIL-DATE              PIC XX.
  2644     12  FILLER                            PIC XX.
  2645     12  FILLER                            PIC X(12).
  2646*    12  FILLER                            PIC X(30).
  2647
  2648******************************************************************
  2649*                                COPY ERCLOFC.
  2650******************************************************************
  2651*                                                                *
  2652*                                                                *
  2653*                            ERCLOFC                             *
  2654*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2655*                            VMOD=2.003                          *
  2656*                                                                *
  2657*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2658*                                                                *
  2659*   FILE TYPE = VSAM,KSDS                                        *
  2660*   RECORD SIZE = 670   RECFORM = FIX                            *
  2661*                                                                *
  2662*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2663*                                                                *
  2664*   LOG = YES                                                    *
  2665*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2666*                                                                *
  2667******************************************************************
  2668
  2669 01  LOAN-OFFICER-MASTER.
  2670     12  LO-RECORD-ID                PIC XX.
  2671         88  VALID-LO-ID                VALUE 'LO'.
  2672
  2673     12  LO-CONTROL-PRIMARY.
  2674         16  LO-COMPANY-CD           PIC X.
  2675         16  LO-CARRIER              PIC X.
  2676         16  LO-GROUPING.
  2677             20  LO-GROUPING-PREFIX  PIC XXX.
  2678             20  LO-GROUPING-PRIME   PIC XXX.
  2679         16  LO-STATE                PIC XX.
  2680         16  LO-ACCOUNT.
  2681             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2682             20  LO-ACCOUNT-PRIME    PIC X(6).
  2683         16  LO-OFFICER-CODE         PIC X(5).
  2684
  2685     12  LO-OFFICER-NAME             PIC X(30).
  2686
  2687     12  LO-LAST-MAINT-DT            PIC XX.
  2688     12  LO-LAST-USER                PIC X(4).
  2689     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2690
  2691     12  LO-COMP-CONTROL             PIC X.
  2692             88  LO-SHOW-COMP           VALUE 'Y'.
  2693             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  52
* EL050.cbl
  2694     12  LO-DETAIL-CONTROL           PIC X.
  2695             88  LO-PRINT-DETAIL        VALUE 'D'.
  2696             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2697
  2698     12  LO-SV-CARRIER               PIC X.
  2699     12  LO-SV-GROUPING              PIC X(6).
  2700     12  LO-SV-STATE                 PIC XX.
  2701
  2702     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2703     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2704
  2705     12  LO-OFFICER-INFO.
  2706         16  FILLER OCCURS 12 TIMES.
  2707             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2708             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2709             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2710             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2711             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2712             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2713             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2714             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2715     12  FILLER                      PIC X(198).
  2716******************************************************************
  2717*                                COPY ERCPDEF.
  2718******************************************************************
  2719*                                                                *
  2720*                                                                *
  2721*                            ERCPDEF.                            *
  2722*                                                                *
  2723*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2724*                                                                *
  2725*    FILE TYPE = VSAM,KSDS                                       *
  2726*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2727*                                                                *
  2728*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2729*                                                                *
  2730*    LOG = YES                                                   *
  2731*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2732******************************************************************
  2733 01  PRODUCT-MASTER.
  2734    12  PD-RECORD-ID                 PIC X(02).
  2735        88  VALID-PD-ID                  VALUE 'PD'.
  2736    12  PD-CONTROL-PRIMARY.
  2737        16  PD-COMPANY-CD            PIC X.
  2738        16  PD-STATE                 PIC XX.
  2739        16  PD-PRODUCT-CD            PIC XXX.
  2740        16  PD-FILLER                PIC X(7).
  2741        16  PD-BEN-TYPE              PIC X.
  2742        16  PD-BEN-CODE              PIC XX.
  2743        16  PD-PROD-EXP-DT           PIC XX.
  2744    12  FILLER                       PIC X(50).
  2745    12  PD-PRODUCT-DATA OCCURS 8.
  2746        16  PD-PROD-CODE             PIC X.
  2747            88  PD-PROD-LIFE           VALUE 'L'.
  2748            88  PD-PROD-PROP           VALUE 'P'.
  2749            88  PD-PROD-AH             VALUE 'A'.
  2750            88  PD-PROD-IU             VALUE 'I'.
  2751            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  53
* EL050.cbl
  2752        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2753        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2754        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2755        16  PD-MAX-TERM              PIC S999        COMP-3.
  2756        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2757        16  FILLER                   PIC X.
  2758        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2759        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2760        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2761        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2762        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2763        16  PD-REC-CRIT-PERIOD       PIC X.
  2764        16  PD-RTW-MOS               PIC 99.
  2765        16  FILLER                   PIC X(5).
  2766    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2767    12  PD-TERM-LIMITS OCCURS 15.
  2768        16  PD-LOW-TERM              PIC S999        COMP-3.
  2769        16  PD-HI-TERM               PIC S999        COMP-3.
  2770*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2771    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2772        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2773        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2774    12  PD-EARN-FACTORS.
  2775        16  FILLER OCCURS 15.
  2776            20  FILLER OCCURS 15.
  2777                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2778    12  PD-PRODUCT-DESC              PIC X(80).
  2779    12  PD-TRUNCATED                 PIC X.
  2780    12  FILLER                       PIC X(59).
  2781    12  PD-MAINT-INFORMATION.
  2782        16  PD-LAST-MAINT-DT         PIC X(02).
  2783        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2784        16  PD-LAST-MAINT-BY         PIC X(04).
  2785*                                COPY ELCSTATE.
  2786******************************************************************
  2787*                                                                *
  2788*                                                                *
  2789*                            ELCSTATE.                           *
  2790*                                                                *
  2791*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2792*                                                                *
  2793*   FILE TYPE = VSAM,KSDS                                        *
  2794*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2795*                                                                *
  2796*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2797*       ALTERNATE INDEX = NONE                                   *
  2798*                                                                *
  2799*   LOG = YES                                                    *
  2800*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2801******************************************************************
  2802*                   C H A N G E   L O G
  2803*
  2804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2805*-----------------------------------------------------------------
  2806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2807* EFFECTIVE    NUMBER
  2808*-----------------------------------------------------------------
  2809* 122710  CR2010012700001  PEMA  NEW COPYBOOK
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  54
* EL050.cbl
  2810******************************************************************
  2811*
  2812 01  STATE-FILE.
  2813     12  SF-RECORD-ID                       PIC XX.
  2814         88  VALID-CF-ID                        VALUE 'SF'.
  2815     12  SF-CONTROL-PRIMARY.
  2816         16  SF-COMPANY-ID                  PIC XXX.
  2817         16  SF-CARRIER-CODE                PIC X.
  2818         16  SF-GROUPING                    PIC X(6).
  2819         16  SF-STATE-CODE                  PIC XX.
  2820         16  SF-EXPIRE-DATE                 PIC 9(8).
  2821****************************************************************
  2822*             STATE CONTROLS
  2823****************************************************************
  2824     12  SF-LAST-MAINT-DT                   PIC XX.
  2825     12  SF-LAST-MAINT-BY                   PIC X(4).
  2826     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2827     12  SF-STATE-RT-CONTROLS.
  2828         16  SF-ST-RT-CALC                  PIC X.
  2829     12  SF-ST-TAX-CONTROLS.
  2830         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2831         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2832         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2833     12  SF-ST-REFUND-OPTIONS.
  2834         16  SF-ST-RF-LR-CALC               PIC X.
  2835         16  SF-ST-RF-LL-CALC               PIC X.
  2836         16  SF-ST-RF-LN-CALC               PIC X.
  2837         16  SF-ST-RF-AH-CALC               PIC X.
  2838         16  SF-ST-RF-CP-CALC               PIC X.
  2839     12  SF-ST-UNEARN-PREM-OPTIONS.
  2840         16  SF-ST-LUEP-R78                 PIC X.
  2841         16  SF-ST-LUEP-PRO                 PIC X.
  2842         16  SF-ST-LUEP-ST                  PIC X.
  2843         16  SF-ST-LUEP-DOM                 PIC X.
  2844         16  SF-ST-AUEP-R78                 PIC X.
  2845         16  SF-ST-AUEP-PRO                 PIC X.
  2846         16  SF-ST-AUEP-ST                  PIC X.
  2847         16  SF-ST-AUEP-DOM                 PIC X.
  2848         16  SF-ST-CUEP-R78                 PIC X.
  2849         16  SF-ST-CUEP-PRO                 PIC X.
  2850         16  SF-ST-CUEP-ST                  PIC X.
  2851         16  SF-ST-CUEP-DOM                 PIC X.
  2852     12  SF-ST-EARN-PREM-OPTIONS.
  2853         16  SF-ST-LEP-R78                  PIC X.
  2854         16  SF-ST-LEP-PRO                  PIC X.
  2855         16  SF-ST-LEP-ST                   PIC X.
  2856         16  SF-ST-LEP-DOM                  PIC X.
  2857         16  SF-ST-AEP-R78                  PIC X.
  2858         16  SF-ST-AEP-PRO                  PIC X.
  2859         16  SF-ST-AEP-ST                   PIC X.
  2860         16  SF-ST-AEP-DOM                  PIC X.
  2861         16  SF-ST-CEP-R78                  PIC X.
  2862         16  SF-ST-CEP-PRO                  PIC X.
  2863         16  SF-ST-CEP-ST                   PIC X.
  2864         16  SF-ST-CEP-DOM                  PIC X.
  2865     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  55
* EL050.cbl
  2867*    COPY ELCCRTT.
  2868******************************************************************
  2869*                                                                *
  2870*                            ELCCRTT.                            *
  2871*                                                                *
  2872*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2873*                                                                *
  2874*   FILE TYPE = VSAM,KSDS                                        *
  2875*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2876*                                                                *
  2877*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2878*                                                                *
  2879*   LOG = YES                                                    *
  2880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2881******************************************************************
  2882*                   C H A N G E   L O G
  2883*
  2884* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2885*-----------------------------------------------------------------
  2886*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2887* EFFECTIVE    NUMBER
  2888*-----------------------------------------------------------------
  2889* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2890* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2891* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2892* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2893* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2894******************************************************************
  2895
  2896 01  CERTIFICATE-TRAILERS.
  2897     12  CS-RECORD-ID                      PIC XX.
  2898         88  VALID-CS-ID                      VALUE 'CS'.
  2899
  2900     12  CS-CONTROL-PRIMARY.
  2901         16  CS-COMPANY-CD                 PIC X.
  2902         16  CS-CARRIER                    PIC X.
  2903         16  CS-GROUPING                   PIC X(6).
  2904         16  CS-STATE                      PIC XX.
  2905         16  CS-ACCOUNT                    PIC X(10).
  2906         16  CS-CERT-EFF-DT                PIC XX.
  2907         16  CS-CERT-NO.
  2908             20  CS-CERT-PRIME             PIC X(10).
  2909             20  CS-CERT-SFX               PIC X.
  2910         16  CS-TRAILER-TYPE               PIC X.
  2911             88  COMM-TRLR           VALUE 'A'.
  2912             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2913             88  CERT-DATA-TRLR      VALUE 'C'.
  2914
  2915     12  CS-DATA-AREA                      PIC X(516).
  2916
  2917     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2918         16  CS-BANK-COMMISSION-AREA.
  2919             20  CS-BANK-COMMS       OCCURS 10.
  2920                 24  CS-AGT                PIC X(10).
  2921                 24  CS-COM-TYP            PIC X.
  2922                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2923                 24  CS-RECALC-LV-INDIC    PIC X.
  2924                 24  FILLER                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  56
* EL050.cbl
  2925         16  FILLER                        PIC X(256).
  2926
  2927     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2928****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2929****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  2930         16  CS-MB-CLAIM-DATA OCCURS 2.
  2931             20  FILLER OCCURS 10.
  2932                 24  CS-CLAIM-TYPE         PIC X.
  2933                     88  CS-AH-CLM           VALUE 'A'.
  2934                     88  CS-IU-CLM           VALUE 'I'.
  2935                     88  CS-GP-CLM           VALUE 'G'.
  2936                     88  CS-LF-CLM           VALUE 'L'.
  2937                     88  CS-PR-CLM           VALUE 'P'.
  2938                 24  CS-BANK               PIC S999 COMP-3.
  2939                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  2940                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  2941                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  2942         16  FILLER                        PIC X(216).
  2943     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2944         16  CS-VIN-NUMBER                 PIC X(17).
  2945         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2946         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2947         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2948         16  FILLER                        PIC X(496).
  2949******************************************************************
  2950*    COPY ELCCRTO.
  2951******************************************************************
  2952*                                                                *
  2953*                            ELCCRTO.                            *
  2954*                                                                *
  2955*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2956*                                                                *
  2957*   FILE TYPE = VSAM,KSDS                                        *
  2958*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2959*                                                                *
  2960*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2961*                                                                *
  2962*   LOG = YES                                                    *
  2963*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2964******************************************************************
  2965*                   C H A N G E   L O G
  2966*
  2967* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2968*-----------------------------------------------------------------
  2969*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2970* EFFECTIVE    NUMBER
  2971*-----------------------------------------------------------------
  2972* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  2973* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  2974* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  2975* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2976* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  2977******************************************************************
  2978 01  ORIGINAL-CERTIFICATE.
  2979     12  OC-RECORD-ID                      PIC XX.
  2980         88  VALID-OC-ID                      VALUE 'OC'.
  2981     12  OC-CONTROL-PRIMARY.
  2982         16  OC-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  57
* EL050.cbl
  2983         16  OC-CARRIER                    PIC X.
  2984         16  OC-GROUPING                   PIC X(6).
  2985         16  OC-STATE                      PIC XX.
  2986         16  OC-ACCOUNT                    PIC X(10).
  2987         16  OC-CERT-EFF-DT                PIC XX.
  2988         16  OC-CERT-NO.
  2989             20  OC-CERT-PRIME             PIC X(10).
  2990             20  OC-CERT-SFX               PIC X.
  2991         16  OC-RECORD-TYPE                PIC X.
  2992         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  2993     12  OC-LAST-MAINT-DT                  PIC XX.
  2994     12  OC-LAST-MAINT-BY                  PIC X(4).
  2995     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  2996     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  2997     12  FILLER                            PIC X(49).
  2998     12  OC-ORIG-REC.
  2999         16  OC-INS-LAST-NAME              PIC X(15).
  3000         16  OC-INS-FIRST-NAME             PIC X(10).
  3001         16  OC-INS-MIDDLE-INIT            PIC X.
  3002         16  OC-INS-AGE                    PIC S999     COMP-3.
  3003         16  OC-JNT-LAST-NAME              PIC X(15).
  3004         16  OC-JNT-FIRST-NAME             PIC X(10).
  3005         16  OC-JNT-MIDDLE-INIT            PIC X.
  3006         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3007         16  OC-LF-BENCD                   PIC XX.
  3008         16  OC-LF-TERM                    PIC S999      COMP-3.
  3009         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3010         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3011         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3012         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3013         16  OC-LF-EXP-DT                  PIC XX.
  3014         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3015         16  OC-LF-CANCEL-DT               PIC XX.
  3016         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3017         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3018         16  OC-AH-BENCD                   PIC XX.
  3019         16  OC-AH-TERM                    PIC S999      COMP-3.
  3020         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3021         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3022         16  OC-AH-EXP-DT                  PIC XX.
  3023         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3024         16  OC-AH-CP                      PIC 99.
  3025         16  OC-AH-CANCEL-DT               PIC XX.
  3026         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3027         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3028         16  OC-CRED-BENE-NAME             PIC X(25).
  3029         16  OC-1ST-PMT-DT                 PIC XX.
  3030         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3031         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3032         16  OC-ISSUE-TRAN-IND             PIC X.
  3033         16  OC-CANCEL-TRAN-IND            PIC X.
  3034         16  FILLER                        PIC X(211).
  3035
  3036     12  FILLER                            PIC X(50).
  3037******************************************************************
  3038
  3039*    COPY ELCDATE.
  3040******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  58
* EL050.cbl
  3041*                                                                *
  3042*                                                                *
  3043*                            ELCDATE.                            *
  3044*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3045*                            VMOD=2.003
  3046*                                                                *
  3047*                                                                *
  3048*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3049*                 LENGTH = 200                                   *
  3050******************************************************************
  3051
  3052 01  DATE-CONVERSION-DATA.
  3053     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3054     12  DC-OPTION-CODE                PIC X.
  3055         88  BIN-TO-GREG                VALUE ' '.
  3056         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3057         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3058         88  YMD-GREG-TO-BIN            VALUE '3'.
  3059         88  MDY-GREG-TO-BIN            VALUE '4'.
  3060         88  JULIAN-TO-BIN              VALUE '5'.
  3061         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3062         88  FIND-CENTURY               VALUE '7'.
  3063         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3064         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3065         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3066         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3067         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3068         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3069         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3070         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3071         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3072         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3073         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3074         88  BIN-3-TO-GREG              VALUE 'I'.
  3075         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3076         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3077         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3078         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3079         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3080         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3081         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3082         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3083         88  THREE-CHARACTER-BIN
  3084                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3085         88  GREGORIAN-TO-BIN
  3086                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3087         88  BIN-TO-GREGORIAN
  3088                  VALUES ' ' '1' 'I' '8' 'G'.
  3089         88  JULIAN-TO-BINARY
  3090                  VALUES '5' 'C' 'E' 'F'.
  3091     12  DC-ERROR-CODE                 PIC X.
  3092         88  NO-CONVERSION-ERROR        VALUE ' '.
  3093         88  DATE-CONVERSION-ERROR
  3094                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3095         88  DATE-IS-ZERO               VALUE '1'.
  3096         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3097         88  DATE-IS-INVALID            VALUE '3'.
  3098         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  59
* EL050.cbl
  3099         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3100         88  DATE-INVALID-OPTION        VALUE '9'.
  3101         88  INVALID-CENTURY            VALUE 'A'.
  3102         88  ONLY-CENTURY               VALUE 'B'.
  3103         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3104         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3105     12  DC-END-OF-MONTH               PIC X.
  3106         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3107     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3108         88  USE-NORMAL-PROCESS         VALUE ' '.
  3109         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3110         88  ADJUST-UP-100-YRS          VALUE '2'.
  3111     12  FILLER                        PIC X.
  3112     12  DC-CONVERSION-DATES.
  3113         16  DC-BIN-DATE-1             PIC XX.
  3114         16  DC-BIN-DATE-2             PIC XX.
  3115         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3116         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3117                       DC-GREG-DATE-1-EDIT.
  3118             20  DC-EDIT1-MONTH        PIC 99.
  3119             20  SLASH1-1              PIC X.
  3120             20  DC-EDIT1-DAY          PIC 99.
  3121             20  SLASH1-2              PIC X.
  3122             20  DC-EDIT1-YEAR         PIC 99.
  3123         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3124         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3125                     DC-GREG-DATE-2-EDIT.
  3126             20  DC-EDIT2-MONTH        PIC 99.
  3127             20  SLASH2-1              PIC X.
  3128             20  DC-EDIT2-DAY          PIC 99.
  3129             20  SLASH2-2              PIC X.
  3130             20  DC-EDIT2-YEAR         PIC 99.
  3131         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3132         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3133                     DC-GREG-DATE-1-YMD.
  3134             20  DC-YMD-YEAR           PIC 99.
  3135             20  DC-YMD-MONTH          PIC 99.
  3136             20  DC-YMD-DAY            PIC 99.
  3137         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3138         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3139                      DC-GREG-DATE-1-MDY.
  3140             20  DC-MDY-MONTH          PIC 99.
  3141             20  DC-MDY-DAY            PIC 99.
  3142             20  DC-MDY-YEAR           PIC 99.
  3143         16  DC-GREG-DATE-1-ALPHA.
  3144             20  DC-ALPHA-MONTH        PIC X(10).
  3145             20  DC-ALPHA-DAY          PIC 99.
  3146             20  FILLER                PIC XX.
  3147             20  DC-ALPHA-CENTURY.
  3148                 24 DC-ALPHA-CEN-N     PIC 99.
  3149             20  DC-ALPHA-YEAR         PIC 99.
  3150         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3151         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3152         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3153         16  DC-JULIAN-DATE            PIC 9(05).
  3154         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3155                                       PIC 9(05).
  3156         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  60
* EL050.cbl
  3157             20  DC-JULIAN-YEAR        PIC 99.
  3158             20  DC-JULIAN-DAYS        PIC 999.
  3159         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3160         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3161         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3162     12  DATE-CONVERSION-VARIBLES.
  3163         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3164         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3165             20  FILLER                PIC 9(3).
  3166             20  HOLD-CEN-1-CCYY.
  3167                 24  HOLD-CEN-1-CC     PIC 99.
  3168                 24  HOLD-CEN-1-YY     PIC 99.
  3169             20  HOLD-CEN-1-MO         PIC 99.
  3170             20  HOLD-CEN-1-DA         PIC 99.
  3171         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3172             20  HOLD-CEN-1-R-MO       PIC 99.
  3173             20  HOLD-CEN-1-R-DA       PIC 99.
  3174             20  HOLD-CEN-1-R-CCYY.
  3175                 24  HOLD-CEN-1-R-CC   PIC 99.
  3176                 24  HOLD-CEN-1-R-YY   PIC 99.
  3177             20  FILLER                PIC 9(3).
  3178         16  HOLD-CENTURY-1-X.
  3179             20  FILLER                PIC X(3)  VALUE SPACES.
  3180             20  HOLD-CEN-1-X-CCYY.
  3181                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3182                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3183             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3184             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3185         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3186             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3187             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3188             20  HOLD-CEN-1-R-X-CCYY.
  3189                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3190                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3191             20  FILLER                PIC XXX.
  3192         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3193         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3194         16  DC-JULIAN-DATE-1          PIC 9(07).
  3195         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3196             20  DC-JULIAN-1-CCYY.
  3197                 24  DC-JULIAN-1-CC    PIC 99.
  3198                 24  DC-JULIAN-1-YR    PIC 99.
  3199             20  DC-JULIAN-DA-1        PIC 999.
  3200         16  DC-JULIAN-DATE-2          PIC 9(07).
  3201         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3202             20  DC-JULIAN-2-CCYY.
  3203                 24  DC-JULIAN-2-CC    PIC 99.
  3204                 24  DC-JULIAN-2-YR    PIC 99.
  3205             20  DC-JULIAN-DA-2        PIC 999.
  3206         16  DC-GREG-DATE-A-EDIT.
  3207             20  DC-EDITA-MONTH        PIC 99.
  3208             20  SLASHA-1              PIC X VALUE '/'.
  3209             20  DC-EDITA-DAY          PIC 99.
  3210             20  SLASHA-2              PIC X VALUE '/'.
  3211             20  DC-EDITA-CCYY.
  3212                 24  DC-EDITA-CENT     PIC 99.
  3213                 24  DC-EDITA-YEAR     PIC 99.
  3214         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  61
* EL050.cbl
  3215             20  DC-EDITB-MONTH        PIC 99.
  3216             20  SLASHB-1              PIC X VALUE '/'.
  3217             20  DC-EDITB-DAY          PIC 99.
  3218             20  SLASHB-2              PIC X VALUE '/'.
  3219             20  DC-EDITB-CCYY.
  3220                 24  DC-EDITB-CENT     PIC 99.
  3221                 24  DC-EDITB-YEAR     PIC 99.
  3222         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3223         16  DC-GREG-DATE-CYMD-R REDEFINES
  3224                              DC-GREG-DATE-CYMD.
  3225             20  DC-CYMD-CEN           PIC 99.
  3226             20  DC-CYMD-YEAR          PIC 99.
  3227             20  DC-CYMD-MONTH         PIC 99.
  3228             20  DC-CYMD-DAY           PIC 99.
  3229         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3230         16  DC-GREG-DATE-MDCY-R REDEFINES
  3231                              DC-GREG-DATE-MDCY.
  3232             20  DC-MDCY-MONTH         PIC 99.
  3233             20  DC-MDCY-DAY           PIC 99.
  3234             20  DC-MDCY-CEN           PIC 99.
  3235             20  DC-MDCY-YEAR          PIC 99.
  3236    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3237        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3238    12  DC-EL310-DATE                  PIC X(21).
  3239    12  FILLER                         PIC X(28).
  3240
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  62
* EL050.cbl
  3242*    COPY ELCCALC.
  3243******************************************************************
  3244*                                                                *
  3245*                           ELCCALC.                            *
  3246*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3247*                            VMOD=2.025                          *
  3248*                                                                *
  3249*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3250*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3251*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3252*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3253*                                                                *
  3254*  PASSED TO ELRTRM                                              *
  3255*  -----------------                                             *
  3256*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3257*  ORIGINAL TERM                                                 *
  3258*  BEGINNING DATE                                                *
  3259*  ENDING DATE                                                   *
  3260*  COMPANY I.D.                                                  *
  3261*  ACCOUNT MASTER USER FIELD                                     *
  3262*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3263*  FREE LOOK DAYS                                                *
  3264*                                                                *
  3265*  RETURNED FROM ELRTRM                                          *
  3266*  ---------------------                                         *
  3267*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3268*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3269*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3270*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3271*----------------------------------------------------------------*
  3272*  PASSED TO ELRAMT                                              *
  3273*  ----------------                                              *
  3274*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3275*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3276*  ORIGINAL AMOUNT                                               *
  3277*  ALTERNATE BENEFIT (BALLON)                                    *
  3278*  A.P.R. - NET PAY ONLY                                         *
  3279*  METHOD
  3280*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3281*  COMPANY I.D.                                                  *
  3282*  BENEFIT TYPE                                                  *
  3283*                                                                *
  3284*  RETURNED FROM ELRAMT                                          *
  3285*  --------------------                                          *
  3286*  REMAINING AMOUNT 1 - CURRENT                                  *
  3287*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3288*  REMAINING AMOUNT FACTOR
  3289*----------------------------------------------------------------*
  3290*  PASSED TO ELRESV                                              *
  3291*  -----------------                                             *
  3292*  CERTIFICATE EFFECTIVE DATE                                    *
  3293*  VALUATION DATE                                                *
  3294*  PAID THRU DATE                                                *
  3295*  BENEFIT                                                       *
  3296*  INCURRED DATE                                                 *
  3297*  REPORTED DATE                                                 *
  3298*  ISSUE AGE                                                     *
  3299*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  63
* EL050.cbl
  3300*  CDT PERCENT                                                   *
  3301*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3302* *CLAIM TYPE (LIFE, A/H)                                        *
  3303* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3304* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3305*                                                                *
  3306*  RETURNED FROM ELRESV                                          *
  3307*  --------------------                                          *
  3308*  CDT TABLE USED                                                *
  3309*  CDT FACTOR USED                                               *
  3310*  PAY TO CURRENT RESERVE                                        *
  3311*  I.B.N.R. - A/H ONLY                                           *
  3312*  FUTURE (ACCRUED) AH ONLY                                      *
  3313*----------------------------------------------------------------*
  3314*  PASSED TO ELRATE                                              *
  3315*  ----------------                                              *
  3316*  CERT ISSUE DATE                                               *
  3317*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3318*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3319*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3320*  STATE CODE (CLIENT DEFINED)                                   *
  3321*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3322*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3323*  DEVIATION CODE                                                *
  3324*  ISSUE AGE                                                     *
  3325*  ORIGINAL BENEFIT AMOUNT                                       *
  3326*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3327*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3328*  BENEFIT KIND (LIFE OR A/H)                                    *
  3329*  A.P.R.                                                        *
  3330*  METHOD
  3331*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3332*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3333*  COMPANY I.D. (3 CHARACTER)                                    *
  3334*  BENEFIT CODE                                                  *
  3335*  BENEFIT OVERRIDE CODE                                         *
  3336*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3337*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3338*  JOINT INDICATOR (CSL ONLY)                                    *
  3339*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3340*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3341*                                                                *
  3342*  RETURNED FROM ELRATE                                          *
  3343*  --------------------                                          *
  3344*  CALCULATED PREMIUM                                            *
  3345*  PREMIUM RATE                                                  *
  3346*  MORTALITY CODE                                                *
  3347*  MAX ATTAINED AGE                                              *
  3348*  MAX AGE                                                       *
  3349*  MAX TERM                                                      *
  3350*  MAX MONTHLY BENEFIT                                           *
  3351*  MAX TOTAL BENIFIT                                             *
  3352*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3353*----------------------------------------------------------------*
  3354*  PASSED TO ELRFND                                              *
  3355*  ----------------                                              *
  3356*  CERT ISSUE DATE                                               *
  3357*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  64
* EL050.cbl
  3358*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3359*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3360*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3361*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3362*  STATE CODE (CLIENT DEFINED)                                   *
  3363*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3364*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3365*  DEVIATION CODE                                                *
  3366*  ISSUE AGE                                                     *
  3367*  ORIGINAL BENEFIT AMOUNT                                       *
  3368*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3369*  PROCESS TYPE (CANCEL)                                         *
  3370*  BENEFIT KIND (LIFE OR A/H)                                    *
  3371*  A.P.R.                                                        *
  3372*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3373*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3374*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3375*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3376*  COMPANY I.D. (3 CHARACTER)                                    *
  3377*  BENEFIT CODE                                                  *
  3378*  BENEFIT OVERRIDE CODE                                         *
  3379*                                                                *
  3380*  RETURNED FROM ELRFND                                          *
  3381*  --------------------                                          *
  3382*  CALCULATED REFUND                                             *
  3383*----------------------------------------------------------------*
  3384*  PASSED TO ELEARN                                              *
  3385*  ----------------                                              *
  3386*  CERT ISSUE DATE                                               *
  3387*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3388*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3389*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3390*  STATE CODE (CLIENT DEFINED)                                   *
  3391*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3392*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3393*  DEVIATION CODE                                                *
  3394*  ISSUE AGE                                                     *
  3395*  ORIGINAL BENEFIT AMOUNT                                       *
  3396*  BENEFIT KIND (LIFE OR A/H)                                    *
  3397*  A.P.R.                                                        *
  3398*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3399*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3400*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3401*  COMPANY I.D. (3 CHARACTER)                                    *
  3402*  BENEFIT CODE                                                  *
  3403*  BENEFIT OVERRIDE CODE                                         *
  3404*                                                                *
  3405*  RETURNED FROM ELEARN                                          *
  3406*  --------------------                                          *
  3407*  INDICATED  EARNINGS                                           *
  3408*----------------------------------------------------------------*
  3409*                 LENGTH = 450                                   *
  3410*                                                                *
  3411******************************************************************
  3412******************************************************************
  3413*                   C H A N G E   L O G
  3414*
  3415* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  65
* EL050.cbl
  3416*-----------------------------------------------------------------
  3417*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3418* EFFECTIVE    NUMBER
  3419*-----------------------------------------------------------------
  3420* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3421* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3422* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3423* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3424* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3425* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3426* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3427* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3428* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3429******************************************************************
  3430
  3431 01  CALCULATION-PASS-AREA.
  3432     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3433                                     COMP.
  3434
  3435     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3436       88  NO-CP-ERROR                             VALUE ZERO.
  3437       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3438                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3439       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3440       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3441       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3442       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3443       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3444       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3445       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3446       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3447       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3448       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3449       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3450       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3451       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3452       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3453       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3454       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3455       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3456
  3457     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3458       88  NO-CP-ERROR-2                           VALUE ZERO.
  3459***********************  INPUT AREAS ****************************
  3460
  3461     12  CP-CALCULATION-AREA.
  3462         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3463         16  CP-CERT-EFF-DT        PIC XX.
  3464         16  CP-VALUATION-DT       PIC XX.
  3465         16  CP-PAID-THRU-DT       PIC XX.
  3466         16  CP-BENEFIT-TYPE       PIC X.
  3467           88  CP-AH                               VALUE 'A' 'D'
  3468                                                   'I' 'U'.
  3469           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3470           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3471         16  CP-INCURRED-DT        PIC XX.
  3472         16  CP-REPORTED-DT        PIC XX.
  3473         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  66
* EL050.cbl
  3474         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3475         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3476                                     COMP-3.
  3477         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3478                                     COMP-3.
  3479         16  CP-CDT-METHOD         PIC X.
  3480           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3481           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3482           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3483         16  CP-CLAIM-TYPE         PIC X.
  3484           88  CP-AH-CLAIM                         VALUE 'A'.
  3485           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3486         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3487                                     COMP-3.
  3488         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3489                                     COMP-3.
  3490         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3491                                     COMP-3.
  3492         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3493                                     COMP-3.
  3494         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3495                                     COMP-3.
  3496         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3497                                     COMP-3.
  3498         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3499                                     COMP-3.
  3500         16  CP-REM-TERM-METHOD    PIC X.
  3501           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3502           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3503           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3504           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3505           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3506           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3507           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3508         16  CP-EARNING-METHOD     PIC X.
  3509           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3510           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3511           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3512           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3513           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3514           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3515           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3516           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3517           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3518           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3519           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3520           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3521           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3522           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3523         16  CP-PROCESS-TYPE       PIC X.
  3524           88  CP-CLAIM                            VALUE '1'.
  3525           88  CP-CANCEL                           VALUE '2'.
  3526           88  CP-ISSUE                            VALUE '3'.
  3527         16  CP-SPECIAL-CALC-CD    PIC X.
  3528           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3529           88  CP-1-MTH-INTEREST               VALUE ' '.
  3530           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3531           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  67
* EL050.cbl
  3532           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3533           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3534           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3535           88  CP-FARM-PLAN                    VALUE 'F'.
  3536           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3537           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3538           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3539           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3540           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3541           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3542           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3543           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3544           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3545           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3546                                                     'W' 'X'.
  3547           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3548           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3549           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3550           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3551           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3552           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3553           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3554           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3555           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3556           88  CP-CSL-METH-1                   VALUE '5'.
  3557           88  CP-CSL-METH-2                   VALUE '6'.
  3558           88  CP-CSL-METH-3                   VALUE '7'.
  3559           88  CP-CSL-METH-4                   VALUE '8'.
  3560
  3561         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3562                                     COMP-3.
  3563         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3564         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3565         16  CP-STATE              PIC XX          VALUE SPACE.
  3566         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3567         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3568           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3569               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3570         16  CP-R78-OPTION         PIC X.
  3571           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3572           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3573
  3574         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3575         16  CP-IBNR-RESERVE-SW    PIC X.
  3576         16  CP-CLAIM-STATUS       PIC X.
  3577         16  CP-RATE-FILE          PIC X.
  3578         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3579                                     COMP-3.
  3580
  3581         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3582         16  CP-AH-OVERRIDE-CODE   PIC X.
  3583
  3584         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3585                                     COMP-3.
  3586         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3587                                   PIC S9(5)V99 COMP-3.
  3588         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3589                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  68
* EL050.cbl
  3590         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3595                                  PIC S9(7)V99 COMP-3.
  3596
  3597         16  CP-PAID-FROM-DATE     PIC X(02).
  3598         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3599         16  CP-EXT-DAYS-CALC      PIC X.
  3600           88  CP-EXT-NO-CHG                   VALUE ' '.
  3601           88  CP-EXT-CHG-LF                   VALUE '1'.
  3602           88  CP-EXT-CHG-AH                   VALUE '2'.
  3603           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3604         16  CP-DOMICILE-STATE     PIC XX.
  3605         16  CP-CARRIER            PIC X.
  3606         16  CP-REIN-FLAG          PIC X.
  3607         16  CP-REM-TRM-CALC-OPTION PIC X.
  3608           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3609                      '2' '3' '4' '5'.
  3610           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3611           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3612           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3613           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3614           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3615           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3616           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3617           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3618         16  CP-SIG-SWITCH         PIC X.
  3619         16  CP-RATING-METHOD      PIC X.
  3620           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3621           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3622           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3623           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3624           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3625           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3626           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3627           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3628           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3629         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3630                                     COMP-3.
  3631         16  CP-BEN-CATEGORY       PIC X.
  3632         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3633         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3634                                   PIC S99V9(5) COMP-3.
  3635         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3636         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3637                                   PIC S99V9(5) COMP-3.
  3638         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3639         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3640         16  CP-EXPIRE-DT          PIC XX.
  3641         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3642         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3643         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3644         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3645         16  CP-DDF-SPEC-CALC      PIC X.
  3646             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3647             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  69
* EL050.cbl
  3648         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3649         16  CP-CANCEL-REASON      PIC X.
  3650         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3651         16  CP-PMT-MODE           PIC X.
  3652         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3653         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3654         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3655         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3656         16  FILLER                PIC X.
  3657
  3658***************    OUTPUT FROM ELRESV   ************************
  3659
  3660         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3661
  3662         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3667                                     COMP-3.
  3668         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3669                                     COMP-3.
  3670         16  FILLER                PIC X(09).
  3671***************    OUTPUT FROM ELRTRM   *************************
  3672
  3673         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3678                                     COMP-3.
  3679         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3680                                     COMP-3.
  3681         16  FILLER                PIC X(12).
  3682
  3683***************    OUTPUT FROM ELRAMT   *************************
  3684
  3685         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3686                                     COMP-3.
  3687         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3688                                     COMP-3.
  3689         16  FILLER                PIC X(12).
  3690
  3691***************    OUTPUT FROM ELRATE   *************************
  3692
  3693         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-MORTALITY-CODE     PIC X(4).
  3698         16  CP-RATE-EDIT-FLAG     PIC X.
  3699             88  CP-RATES-NEED-APR                  VALUE '1'.
  3700         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3701                                     COMP-3.
  3702         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3703         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3704         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3705                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  70
* EL050.cbl
  3706         16  FILLER                PIC X(07).
  3707
  3708***************    OUTPUT FROM ELRFND   *************************
  3709
  3710         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3711                                     COMP-3.
  3712         16  CP-REFUND-TYPE-USED   PIC X.
  3713           88  CP-R-AS-R78                         VALUE '1'.
  3714           88  CP-R-AS-PRORATA                     VALUE '2'.
  3715           88  CP-R-AS-CALIF                       VALUE '3'.
  3716           88  CP-R-AS-TEXAS                       VALUE '4'.
  3717           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3718           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3719           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3720           88  CP-R-AS-MEAN                        VALUE '8'.
  3721           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3722           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3723           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3724           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3725           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3726           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3727         16  FILLER                PIC X(12).
  3728
  3729***************    OUTPUT FROM ELEARN   *************************
  3730
  3731         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3732                                     COMP-3.
  3733         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3734                                     COMP-3.
  3735         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3736                                     COMP-3.
  3737         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3740                                     COMP-3.
  3741         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3742                                     COMP-3.
  3743         16  CP-EARNING-TYPE-USED  PIC X.
  3744           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3745           88  CP-E-AS-R78                         VALUE '1'.
  3746           88  CP-E-AS-PRORATA                     VALUE '2'.
  3747           88  CP-E-AS-TEXAS                       VALUE '4'.
  3748           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3749           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3750           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3751           88  CP-E-AS-MEAN                        VALUE '8'.
  3752           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3753         16  FILLER                PIC X(12).
  3754
  3755***************    OUTPUT FROM ELPMNT   *************************
  3756
  3757         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3758                                     COMP-3.
  3759         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3760                                     COMP-3.
  3761         16  FILLER                PIC X(12).
  3762
  3763***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  71
* EL050.cbl
  3764         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3773                                     COMP-3.
  3774         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3777             88  OPEN-RATE-FILE                   VALUE 'O'.
  3778             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3779             88  IO-ERROR                         VALUE 'E'.
  3780
  3781         16  CP-FIRST-PAY-DATE     PIC XX.
  3782
  3783         16  CP-JOINT-INDICATOR    PIC X.
  3784
  3785         16  CP-RESERVE-REMAINING-TERM
  3786                                   PIC S9(4)V9    VALUE ZERO
  3787                                     COMP-3.
  3788
  3789         16  CP-INSURED-BIRTH-DT   PIC XX.
  3790
  3791         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3792                                     COMP-3.
  3793
  3794         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3795                                     COMP-3.
  3796
  3797         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3798                                     COMP-3.
  3799
  3800         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3801                                     COMP-3.
  3802
  3803         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3804                                     COMP-3.
  3805
  3806         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3807                                     COMP-3.
  3808
  3809         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3810                                     COMP-3.
  3811
  3812         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3813             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3814
  3815         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3816                                     COMP-3.
  3817         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3818                                     COMP-3.
  3819         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3820         16  FILLER                PIC X(15).
  3821******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  72
* EL050.cbl
  3823******************************************************************
  3824*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3825*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3826*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3827*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3828*** MODIFICATION.                                              ***
  3829*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3830*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3831******************************************************************
  3832*    COPY ERCPNDB.
  3833******************************************************************
  3834*                                                                *
  3835*                                                                *
  3836*                            ERCPNDB.                            *
  3837*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3838*                            VMOD=2.025                          *
  3839*                                                                *
  3840*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3841*                                                                *
  3842******************************************************************
  3843*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3844*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3845******************************************************************
  3846*                                                                *
  3847*                                                                *
  3848*   FILE TYPE = VSAM,KSDS                                        *
  3849*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3850*                                                                *
  3851*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3852*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3853*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3854*                                                 RKP=13,LEN=36  *
  3855*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3856*                                      AND CHG-SEQ.)             *
  3857*                                                RKP=49,LEN=11   *
  3858*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3859*                                      AND CHG-SEQ.)             *
  3860*                                                RKP=60,LEN=15   *
  3861*                                                                *
  3862*   LOG = NO                                                     *
  3863*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3864******************************************************************
  3865******************************************************************
  3866*                   C H A N G E   L O G
  3867*
  3868* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3869*-----------------------------------------------------------------
  3870*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3871* EFFECTIVE    NUMBER
  3872*-----------------------------------------------------------------
  3873* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3874* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3875* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3876* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3877* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3878* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3879* 032306                   PEMA  ADD BOW LOAN NUMBER
  3880* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  73
* EL050.cbl
  3881* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3882* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3883* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3884* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3885* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3886* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3887* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3888******************************************************************
  3889
  3890 01  PENDING-BUSINESS.
  3891     12  PB-RECORD-ID                     PIC XX.
  3892         88  VALID-PB-ID                        VALUE 'PB'.
  3893
  3894     12  PB-CONTROL-PRIMARY.
  3895         16  PB-COMPANY-CD                PIC X.
  3896         16  PB-ENTRY-BATCH               PIC X(6).
  3897         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3898         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3899
  3900     12  PB-CONTROL-BY-ACCOUNT.
  3901         16  PB-COMPANY-CD-A1             PIC X.
  3902         16  PB-CARRIER                   PIC X.
  3903         16  PB-GROUPING.
  3904             20  PB-GROUPING-PREFIX       PIC XXX.
  3905             20  PB-GROUPING-PRIME        PIC XXX.
  3906         16  PB-STATE                     PIC XX.
  3907         16  PB-ACCOUNT.
  3908             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3909             20  PB-ACCOUNT-PRIME         PIC X(6).
  3910         16  PB-CERT-EFF-DT               PIC XX.
  3911         16  PB-CERT-NO.
  3912             20  PB-CERT-PRIME            PIC X(10).
  3913             20  PB-CERT-SFX              PIC X.
  3914         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3915
  3916         16  PB-RECORD-TYPE               PIC X.
  3917             88  PB-MAILING-DATA                VALUE '0'.
  3918             88  PB-ISSUE                       VALUE '1'.
  3919             88  PB-CANCELLATION                VALUE '2'.
  3920             88  PB-BATCH-TRAILER               VALUE '9'.
  3921
  3922     12  PB-CONTROL-BY-ORIG-BATCH.
  3923         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3924         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3925         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3926         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3927
  3928     12  PB-CONTROL-BY-CSR.
  3929         16  PB-CSR-COMPANY-CD            PIC X.
  3930         16  PB-CSR-ID                    PIC X(4).
  3931         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3932         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3933         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3934******************************************************************
  3935*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3936******************************************************************
  3937
  3938     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  74
* EL050.cbl
  3939     12  PB-LAST-MAINT-BY                 PIC X(4).
  3940     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3941
  3942     12  PB-RECORD-BODY                   PIC X(375).
  3943
  3944     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3945         16  PB-CERT-ORIGIN               PIC X.
  3946             88  CLASIC-CREATED-CERT         VALUE '1'.
  3947         16  PB-I-NAME.
  3948             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3949             20  PB-I-INSURED-FIRST-NAME.
  3950                 24  PB-I-INSURED-1ST-INIT PIC X.
  3951                 24  FILLER                PIC X(9).
  3952             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3953         16  PB-I-AGE                     PIC S99   COMP-3.
  3954         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3955         16  PB-I-BIRTHDAY                PIC XX.
  3956         16  PB-I-INSURED-SEX             PIC X.
  3957             88  PB-SEX-MALE     VALUE 'M'.
  3958             88  PB-SEX-FEMALE   VALUE 'F'.
  3959
  3960         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3961         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3962         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3963         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3964         16  PB-I-SKIP-CODE               PIC X.
  3965             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3966             88  PB-SKIP-JULY              VALUE '1'.
  3967             88  PB-SKIP-AUGUST            VALUE '2'.
  3968             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3969             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3970             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3971             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3972             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3973             88  PB-SKIP-JUNE              VALUE '8'.
  3974             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3975             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3976             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3977         16  PB-I-TERM-TYPE               PIC X.
  3978             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3979             88  PB-PAID-WEEKLY            VALUE 'W'.
  3980             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3981             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3982             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3983         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3984         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3985         16  PB-I-DATA-ENTRY-SW           PIC X.
  3986             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3987             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3988             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3989             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3990         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3991         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3992*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3993         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3994         16  FILLER                       PIC X.
  3995
  3996         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  75
* EL050.cbl
  3997             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3998             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3999                                                   '90' THRU '99'.
  4000         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4001                                          PIC XX.
  4002         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4003         16  PB-I-AMOUNT-FINANCED REDEFINES
  4004                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4005         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4006         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4007                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4008         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4009         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4010         16  PB-I-CLP-AMOUNT REDEFINES
  4011                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4012         16  PB-I-LF-CALC-FLAG            PIC X.
  4013             88 PB-COMP-LF-PREM               VALUE '?'.
  4014         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4015         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4016         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4017         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4018         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4019         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4020         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4021         16  PB-I-LF-ABBR                 PIC XXX.
  4022         16  PB-I-LF-INPUT-CD             PIC XX.
  4023
  4024         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4025             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4026             88  PB-INVALID-AH               VALUE '  ' '00'
  4027                                                   '90' THRU '99'.
  4028         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4029         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4030         16  PB-I-AH-CALC-FLAG            PIC X.
  4031             88 PB-COMP-AH-PREM                  VALUE '?'.
  4032         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4033         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4034         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4035         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4036         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4037         16  PB-I-AH-ABBR                 PIC XXX.
  4038         16  PB-I-AH-INPUT-CD             PIC XXX.
  4039
  4040         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4041         16  PB-I-REIN-TABLE              PIC XXX.
  4042         16  PB-I-BUSINESS-TYPE           PIC 99.
  4043         16  PB-I-INDV-GRP-CD             PIC X.
  4044         16  PB-I-MORT-CODE.
  4045             20  PB-I-TABLE               PIC X.
  4046             20  PB-I-INTEREST            PIC XX.
  4047             20  PB-I-MORT-TYP            PIC X.
  4048         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4049         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4050         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4051         16  PB-I-INDV-GRP-OVRD           PIC X.
  4052         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4053         16  PB-I-SIG-SW                  PIC X.
  4054             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  76
* EL050.cbl
  4055         16  PB-I-RATE-CLASS              PIC XX.
  4056         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4057         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4058         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4059         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4060         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4061         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4062         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4063         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4064         16  PB-I-OB-FLAG                 PIC X.
  4065             88  PB-I-OB                      VALUE 'B'.
  4066             88  PB-I-SUMMARY                 VALUE 'Z'.
  4067         16  PB-I-ENTRY-STATUS            PIC X.
  4068             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4069                                              'M' '5' '9' '2'.
  4070             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4071             88  PB-I-POLICY-PENDING          VALUE '2'.
  4072             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4073             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4074             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4075             88  PB-I-REIN-ONLY               VALUE '9'.
  4076             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4077             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4078             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4079             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4080         16  PB-I-INT-CODE                PIC X.
  4081             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4082             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4083         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4084         16  PB-I-SOC-SEC-NO              PIC X(11).
  4085         16  PB-I-MEMBER-NO               PIC X(12).
  4086         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4087*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4088         16  PB-I-OLD-LOF                 PIC XXX.
  4089         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4090         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4091         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4092         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4093         16  PB-I-LIFE-INDICATOR          PIC X.
  4094             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4095         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4096         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4097                                          PIC S9(5)V99    COMP-3.
  4098         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4099             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4100             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4101         16  PB-I-1ST-PMT-DT              PIC XX.
  4102         16  PB-I-JOINT-INSURED.
  4103             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4104             20 PB-I-JOINT-FIRST-NAME.
  4105                24  PB-I-JOINT-FIRST-INIT PIC X.
  4106                24  FILLER                PIC X(9).
  4107             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4108*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4109         16  PB-I-BENEFICIARY-NAME.
  4110             20  PB-I-BANK-NUMBER         PIC X(10).
  4111             20  FILLER                   PIC X(15).
  4112         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  77
* EL050.cbl
  4113         16  PB-I-REFERENCE               PIC X(12).
  4114         16  FILLER REDEFINES PB-I-REFERENCE.
  4115             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4116             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4117             20  PB-I-CLP-STATE           PIC XX.
  4118         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4119             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4120             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4121             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4122         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4123         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4124         16  PB-I-RESIDENT-STATE          PIC XX.
  4125         16  PB-I-RATE-CODE               PIC X(4).
  4126         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4127         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4128         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4129         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4130         16  PB-I-BANK-NOCHRGB            PIC 99.
  4131         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4132         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4133
  4134     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4135         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4136             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4137         16  PB-C-CANCEL-ORIGIN           PIC X.
  4138             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4139         16  PB-C-LF-CANCEL-DT            PIC XX.
  4140         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4141         16  PB-C-LF-CALC-REQ             PIC X.
  4142             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4143         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4144         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4145         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4146             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4147         16  PB-C-AH-CANCEL-DT            PIC XX.
  4148         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4149         16  PB-C-AH-CALC-REQ             PIC X.
  4150             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4151         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4152         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4153         16  PB-C-LAST-NAME               PIC X(15).
  4154         16  PB-C-REFUND-SW               PIC X.
  4155             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4156             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4157         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4158         16  PB-C-PAYEE-CODE              PIC X(6).
  4159         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4160         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4161         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4162         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4163         16  PB-C-REFERENCE               PIC X(12).
  4164         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4165         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4166         16  PB-C-POST-CARD-IND           PIC X.
  4167         16  PB-C-CANCEL-REASON           PIC X.
  4168         16  PB-C-REF-INTERFACE-SW        PIC X.
  4169         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4170         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  78
* EL050.cbl
  4171         16  FILLER                       PIC X(01).
  4172*        16  FILLER                       PIC X(18).
  4173         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4174*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4175         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4176         16  PB-CANCELED-CERT-DATA.
  4177             20  PB-CI-INSURED-NAME.
  4178                 24  PB-CI-LAST-NAME      PIC X(15).
  4179                 24  PB-CI-INITIALS       PIC XX.
  4180             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4181             20  PB-CI-INSURED-SEX        PIC X.
  4182             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4183             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4184             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4185             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4186             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4187             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4188             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4189             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4190             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4191             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4192             20  PB-CI-RATE-CLASS         PIC XX.
  4193             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4194             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4195             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4196             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4197             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4198             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4199             20  PB-CI-LF-ABBR            PIC X(3).
  4200             20  PB-CI-AH-ABBR            PIC X(3).
  4201             20  PB-CI-OB-FLAG            PIC X.
  4202                 88  PB-CI-OB                VALUE 'B'.
  4203             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4204                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4205                                           'M' '4' '5' '9' '2'.
  4206                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4207                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4208                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4209                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4210                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4211                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4212                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4213                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4214                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4215                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4216                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4217                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4218             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4219                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4220                                           'M' '4' '5' '9' '2'.
  4221                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4222                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4223                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4224                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4225                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4226                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4227                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4228                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  79
* EL050.cbl
  4229                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4230                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4231                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4232                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4233             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4234             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4235             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4236             20  PB-CI-MEMBER-NO          PIC X(12).
  4237             20  PB-CI-INT-CODE           PIC X.
  4238                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4239                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4240             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4241             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4242             20  PB-CI-COMP-EXCP-SW       PIC X.
  4243                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4244                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4245             20  PB-CI-ENTRY-STATUS       PIC X.
  4246             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4247             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4248             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4249             20  PB-CI-DEATH-DT           PIC XX.
  4250             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4251             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4252             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4253             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4254             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4255             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4256             20  PB-CI-ENTRY-DT              PIC XX.
  4257             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4258             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4259             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4260             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4261             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4262             20  PB-CI-OLD-LOF               PIC XXX.
  4263*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4264             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4265             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4266             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4267             20  PB-CI-INDV-GRP-CD           PIC X.
  4268             20  PB-CI-BENEFICIARY-NAME.
  4269                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4270                 24  FILLER                  PIC X(15).
  4271             20  PB-CI-NOTE-SW               PIC X.
  4272             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4273             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4274             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4275             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4276             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4277             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4278             20  PB-CI-FIRST-NAME            PIC X(10).
  4279             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4280
  4281         16  FILLER                       PIC X(13).
  4282*032306  16  FILLER                       PIC X(27).
  4283*        16  FILLER                       PIC X(46).
  4284
  4285     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4286         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  80
* EL050.cbl
  4287         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4288         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4289         16  PB-M-INSURED-MID-INIT        PIC X.
  4290         16  PB-M-INSURED-AGE             PIC 99.
  4291         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4292         16  PB-M-INSURED-SEX             PIC X.
  4293         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4294         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4295         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4296         16  PB-M-INSURED-CITY-STATE.
  4297             20  PB-M-INSURED-CITY        PIC X(28).
  4298             20  PB-M-INSURED-STATE       PIC XX.
  4299         16  PB-M-INSURED-ZIP-CODE.
  4300             20  PB-M-INSURED-ZIP-PRIME.
  4301                 24  PB-M-INSURED-ZIP-1   PIC X.
  4302                     88  PB-M-CANADIAN-POST-CODE
  4303                                             VALUE 'A' THRU 'Z'.
  4304                 24  FILLER               PIC X(4).
  4305             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4306         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4307                                        PB-M-INSURED-ZIP-CODE.
  4308             20  PM-M-INS-CAN-POST1       PIC XXX.
  4309             20  PM-M-INS-CAN-POST2       PIC XXX.
  4310             20  FILLER                   PIC XXX.
  4311         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4312         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4313         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4314         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4315         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4316         16  PB-M-CRED-BENE-CITYST.
  4317             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4318             20  PB-M-CRED-BENE-STATE     PIC XX.
  4319         16  FILLER                       PIC X(92).
  4320
  4321     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4322         16  FILLER                       PIC X(10).
  4323         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4324         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4325         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4326         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4327         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4328         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4329         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4330         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4331         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4332         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4333         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4334         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4335         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4336         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4337         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4338         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4339         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4340         16  PB-ACCOUNT-NAME              PIC X(30).
  4341         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4342         16  PB-REFERENCE                 PIC X(12).
  4343         16  PB-B-RECEIVED-DT             PIC XX.
  4344         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  81
* EL050.cbl
  4345
  4346     12  PB-RECORD-STATUS.
  4347         16  PB-CREDIT-SELECT-DT          PIC XX.
  4348         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4349         16  PB-BILLED-DT                 PIC XX.
  4350         16  PB-BILLING-STATUS            PIC X.
  4351             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4352             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4353             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4354         16  PB-RECORD-BILL               PIC X.
  4355             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4356             88  PB-RECORD-RETURNED           VALUE 'R'.
  4357             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4358             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4359             88  PB-OVERRIDE-AH               VALUE 'A'.
  4360             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4361         16  PB-BATCH-ENTRY               PIC X.
  4362             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4363             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4364             88  PB-REISSUED-CERT             VALUE 'E'.
  4365             88  PB-MONTHLY-CERT              VALUE 'M'.
  4366             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4367             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4368             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4369         16  PB-FORCE-CODE                PIC X.
  4370             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4371             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4372             88  PB-CANCEL-FORCE              VALUE '8'.
  4373             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4374             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4375             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4376             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4377             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4378             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4379             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4380         16  PB-FATAL-FLAG                PIC X.
  4381             88  PB-FATAL-ERRORS              VALUE 'X'.
  4382         16  PB-FORCE-ER-CD               PIC X.
  4383             88  PB-FORCE-ERRORS              VALUE 'F'.
  4384             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4385         16  PB-WARN-ER-CD                PIC X.
  4386             88  PB-WARNING-ERRORS            VALUE 'W'.
  4387         16  FILLER                       PIC X.
  4388         16  PB-OUT-BAL-CD                PIC X.
  4389             88  PB-OUT-OF-BAL                VALUE 'O'.
  4390         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4391         16  PB-AH-OVERRIDE-L1            PIC X.
  4392         16  PB-INPUT-DT                  PIC XX.
  4393         16  PB-INPUT-BY                  PIC X(4).
  4394         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4395         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4396         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4397         16  PB-LF-EARNING-METHOD         PIC X.
  4398         16  PB-AH-EARNING-METHOD         PIC X.
  4399         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4400         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4401         16  PB-REIN-CD                   PIC XXX.
  4402         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  82
* EL050.cbl
  4403         16  PB-AH-REFUND-TYPE            PIC X.
  4404         16  PB-ACCT-EFF-DT               PIC XX.
  4405         16  PB-ACCT-EXP-DT               PIC XX.
  4406         16  PB-COMPANY-ID                PIC X(3).
  4407         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4408         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4409         16  PB-SV-CARRIER                PIC X.
  4410         16  PB-SV-GROUPING               PIC X(6).
  4411         16  PB-SV-STATE                  PIC XX.
  4412         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4413         16  PB-GA-BILLING-INFO.
  4414             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4415                                          PIC XX.
  4416         16  PB-SV-REMIT-TO  REDEFINES
  4417             PB-GA-BILLING-INFO           PIC X(10).
  4418         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4419         16  PB-I-LOAN-OFFICER            PIC X(5).
  4420         16  PB-I-VIN                     PIC X(17).
  4421
  4422         16  FILLER                       PIC X(04).
  4423         16  IMNET-BYPASS-SW              PIC X.
  4424
  4425******************************************************************
  4426*                COMMON EDIT ERRORS                              *
  4427******************************************************************
  4428
  4429     12  PB-COMMON-ERRORS.
  4430         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4431                                           PIC S9(4)     COMP.
  4432
  4433******************************************************************
  4434
  4435* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4436*    COPY ELC50W1.
  4437******************************************************************
  4438*                                                                *
  4439*                                                                *
  4440*                             ELC50W1                            *
  4441*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4442*                            VMOD=2.004                          *
  4443*                                                                *
  4444*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4445*                                                                *
  4446*                                                                *
  4447******************************************************************
  4448
  4449     12  WK-WORK-AREA.
  4450         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4451         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4452         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4453         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4454         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4455         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4456         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4457         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4458         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4459         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4460         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  83
* EL050.cbl
  4461         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4462         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4463         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4464         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4465         16  WK-CREDIT-EDIT-CONTROLS.
  4466             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4467             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4468             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4469             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4470             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4471             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4472         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4473         16  WK-SAVE-REIN-DATA.
  4474             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4475             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4476             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4477         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4478             88  ENTRY-FROM-EL6311       VALUE '6'.
  4479         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4480         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4481     12  WK-RECORD-ADDRESSES.
  4482         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4483         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4484         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4485         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4486         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4487         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4488         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4489         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4490     12  WK-OVER-SHORT-AREA.
  4491         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4492         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4493         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4494             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4495         16  FILLER                   PIC X(5) VALUE SPACES.
  4496
  4497*    COPY ELCEDITC.
  4498******************************************************************
  4499*                                                                *
  4500*                                                                *
  4501*                            ELCEDITC                            *
  4502*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4503*                            VMOD=2.012                          *
  4504*                                                                *
  4505*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4506*                     EL6313, EL050 AND EL517.                   *
  4507*                                                                *
  4508******************************************************************
  4509******************************************************************
  4510*                   C H A N G E   L O G
  4511*
  4512* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4513*-----------------------------------------------------------------
  4514*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4515* EFFECTIVE    NUMBER
  4516*-----------------------------------------------------------------
  4517* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4518******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  84
* EL050.cbl
  4519
  4520     12  EDIT-CRITERIA-DATA.
  4521         16  EC-CO-MONTH-END-DT       PIC XX.
  4522         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4523         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4524         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4525         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4526         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4527         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4528         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4529         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4530         16  EC-CO-REM-TERM-CALC      PIC X.
  4531               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4532               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4533               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4534               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4535
  4536         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4537               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4538               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4539               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4540               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4541               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4542               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4543               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4544               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4545               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4546               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4547
  4548         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4549               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4550               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4551               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4552               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4553               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4554               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4555               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4556               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4557
  4558         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4559                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4560                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4561
  4562         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4563                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4564                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4565                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4566                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4567                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4568                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4569                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4570                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4571
  4572         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4573               88  EC-BR-REDUCING                   VALUE 'R'.
  4574               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4575
  4576         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  85
* EL050.cbl
  4577         16  EC-BR-LF-DESC             PIC X(10).
  4578         16  EC-BR-AH-DESC             PIC X(10).
  4579         16  EC-BR-LF-COMMENT          PIC X(10).
  4580         16  EC-BR-AH-COMMENT          PIC X(10).
  4581
  4582         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4583               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4584               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4585               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4586               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4587
  4588         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4589               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4590               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4591               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4592               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4593
  4594         16  EC-BR-LF-REFUND-CALC      PIC X.
  4595                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4596                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4597                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4598                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4599                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4600                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4601                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4602
  4603         16  EC-BR-AH-REFUND-CALC      PIC X.
  4604                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4605                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4606                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4607                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4608                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4609                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4610                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4611                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4612
  4613         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4614                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4615                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4616                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4617
  4618         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4619                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4620                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4621                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4622
  4623         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4624         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4625         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4626         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4627
  4628         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4629         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4630                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4631                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4632                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4633                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4634
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  86
* EL050.cbl
  4635         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4636               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4637               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4638               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4639               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4640               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4641
  4642         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4643               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4644               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4645               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4646               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4647               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4648
  4649         16  EC-ST-LF-REFUND-CALC      PIC X.
  4650                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4651                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4652                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4653                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4654                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4655                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4656                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4657                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4658
  4659         16  EC-ST-AH-REFUND-CALC      PIC X.
  4660                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4661                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4662                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4663                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4664                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4665                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4666                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4667                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4668
  4669         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4670         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4671         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4672         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4673         16  EC-AM-EXPIRATION-DT       PIC XX.
  4674         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4675         16  EC-AM-CLASS-CD            PIC XX.
  4676         16  EC-AM-LF-DEVIATION        PIC XXX.
  4677         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4678         16  EC-AM-AH-DEVIATION        PIC XXX.
  4679         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4680         16  EC-AM-PHONE-NO            PIC X(10).
  4681
  4682         16  EC-AM-LF-REFUND-CALC      PIC X.
  4683                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4684                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4685                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4686                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4687                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4688                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4689                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4690
  4691         16  EC-AM-AH-REFUND-CALC      PIC X.
  4692                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  87
* EL050.cbl
  4693                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4694                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4695                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4696                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4697                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4698                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4699
  4700         16  EC-AM-BEN-I-G-CD          PIC X.
  4701                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4702                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4703                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4704
  4705         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4706         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4707         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4708         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4709         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4710         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4711         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4712         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4713         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4714
  4715         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4716         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4717         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4718         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4719         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4720         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4721         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4722         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4723         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4724         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4725         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4726         16  EC-RT-LF-NSP-ST           PIC XX.
  4727         16  EC-RT-AH-NSP-ST           PIC XX.
  4728         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4729         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4730
  4731         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4732             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4733                                             'M' '5' '9' '2'.
  4734             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4735             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4736             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4737             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4738             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4739             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4740             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4741             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4742             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4743             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4744
  4745         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4746             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4747                                             'M' '5' '9' '2'.
  4748             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4749             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4750             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  88
* EL050.cbl
  4751             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4752             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4753             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4754             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4755             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4756             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4757             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4758
  4759         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4760         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4761         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4762         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4763         16  EC-CM-DEATH-DT            PIC XX.
  4764
  4765*DMD CUSTOM CODING FIELDS BELOW
  4766*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4767         16  EC-BR-DMD-RATING-SW       PIC X.
  4768                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4769                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4770                 88  NO-DMD-RATING               VALUE 'N'.
  4771
  4772         16  EC-NEW-CERT               PIC X(11).
  4773         16  EC-NEW-STATE              PIC XX.
  4774         16  FILLER                    PIC X.
  4775*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4776         16  OVER-SHORT-EDIT-FIELDS.
  4777             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4778             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4779             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4780             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4781             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4782             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4783             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4784             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4785             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4786         16  FILLER                    PIC X(71).
  4787******************************************************************
  4788
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  89
* EL050.cbl
  4790*    COPY ELCDIFRD.
  4791******************************************************************
  4792*                                                                *
  4793*                                                                *
  4794*                            ELCDIFRD.                           *
  4795*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4796*                            VMOD=2.004                          *
  4797*                                                                *
  4798*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4799*                                                                *
  4800******************************************************************
  4801*
  4802  01  WS-DIFFERENCE-CALCULATION.
  4803        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4804        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4805        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4806        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4807        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4808        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4809        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4810        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4811        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4812        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4813        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4814
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  90
* EL050.cbl
  4816****************************************************************
  4817*
  4818* Copyright (c) 2007 by Clerity Solutions, Inc.
  4819* All rights reserved.
  4820*
  4821****************************************************************
  4822 01  DFHEIV.
  4823   02  DFHEIV0               PIC X(35).
  4824   02  DFHEIV1               PIC X(08).
  4825   02  DFHEIV2               PIC X(08).
  4826   02  DFHEIV3               PIC X(08).
  4827   02  DFHEIV4               PIC X(06).
  4828   02  DFHEIV5               PIC X(04).
  4829   02  DFHEIV6               PIC X(04).
  4830   02  DFHEIV7               PIC X(02).
  4831   02  DFHEIV8               PIC X(02).
  4832   02  DFHEIV9               PIC X(01).
  4833   02  DFHEIV10              PIC S9(7) COMP-3.
  4834   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4835   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4836   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4837   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4838   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4839   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4840   02  DFHEIV17              PIC X(04).
  4841   02  DFHEIV18              PIC X(04).
  4842   02  DFHEIV19              PIC X(04).
  4843   02  DFHEIV20              USAGE IS POINTER.
  4844   02  DFHEIV21              USAGE IS POINTER.
  4845   02  DFHEIV22              USAGE IS POINTER.
  4846   02  DFHEIV23              USAGE IS POINTER.
  4847   02  DFHEIV24              USAGE IS POINTER.
  4848   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4849   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4850   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4851   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4852   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4853   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4854   02  FILLER                PIC X(02).
  4855   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4856   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4857   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4858   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4859   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4860 LINKAGE  SECTION.
  4861*****************************************************************
  4862*                                                               *
  4863* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4864* All rights reserved.                                          *
  4865*                                                               *
  4866*****************************************************************
  4867 01  dfheiblk.
  4868     02  eibtime          pic s9(7) comp-3.
  4869     02  eibdate          pic s9(7) comp-3.
  4870     02  eibtrnid         pic x(4).
  4871     02  eibtaskn         pic s9(7) comp-3.
  4872     02  eibtrmid         pic x(4).
  4873     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  91
* EL050.cbl
  4874     02  eibcposn         pic s9(4) comp.
  4875     02  eibcalen         pic s9(4) comp.
  4876     02  eibaid           pic x(1).
  4877     02  eibfiller1       pic x(1).
  4878     02  eibfn            pic x(2).
  4879     02  eibfiller2       pic x(2).
  4880     02  eibrcode         pic x(6).
  4881     02  eibfiller3       pic x(2).
  4882     02  eibds            pic x(8).
  4883     02  eibreqid         pic x(8).
  4884     02  eibrsrce         pic x(8).
  4885     02  eibsync          pic x(1).
  4886     02  eibfree          pic x(1).
  4887     02  eibrecv          pic x(1).
  4888     02  eibsend          pic x(1).
  4889     02  eibatt           pic x(1).
  4890     02  eibeoc           pic x(1).
  4891     02  eibfmh           pic x(1).
  4892     02  eibcompl         pic x(1).
  4893     02  eibsig           pic x(1).
  4894     02  eibconf          pic x(1).
  4895     02  eiberr           pic x(1).
  4896     02  eibrldbk         pic x(1).
  4897     02  eiberrcd         pic x(4).
  4898     02  eibsynrb         pic x(1).
  4899     02  eibnodat         pic x(1).
  4900     02  eibfiller5       pic x(2).
  4901     02  eibresp          pic 9(09) comp.
  4902     02  eibresp2         pic 9(09) comp.
  4903     02  dfheigdj         pic s9(4) comp.
  4904     02  dfheigdk         pic s9(4) comp.
  4905
  4906 01  DFHCOMMAREA                   PIC X(1036).
  4907
  4908*01 PARMLIST .
  4909*    02  FILLER                    PIC S9(8)   COMP.
  4910*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4911*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4912*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4913*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4914*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4915*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4916*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4917
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  92
* EL050.cbl
  4919*    COPY ELCCNTL.
  4920******************************************************************
  4921*                                                                *
  4922*                                                                *
  4923*                            ELCCNTL.                            *
  4924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4925*                            VMOD=2.059                          *
  4926*                                                                *
  4927*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4928*                                                                *
  4929*   FILE TYPE = VSAM,KSDS                                        *
  4930*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4931*                                                                *
  4932*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4933*       ALTERNATE INDEX = NONE                                   *
  4934*                                                                *
  4935*   LOG = YES                                                    *
  4936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4937******************************************************************
  4938*                   C H A N G E   L O G
  4939*
  4940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4941*-----------------------------------------------------------------
  4942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4943* EFFECTIVE    NUMBER
  4944*-----------------------------------------------------------------
  4945* 082503                   PEMA  ADD BENEFIT GROUP
  4946* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4947* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4948* 092705    2005050300006  PEMA  ADD SPP LEASES
  4949* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4950* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4951* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4952* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4953* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4954* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4955* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4956* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4957* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4958******************************************************************
  4959*
  4960 01  CONTROL-FILE.
  4961     12  CF-RECORD-ID                       PIC XX.
  4962         88  VALID-CF-ID                        VALUE 'CF'.
  4963
  4964     12  CF-CONTROL-PRIMARY.
  4965         16  CF-COMPANY-ID                  PIC XXX.
  4966         16  CF-RECORD-TYPE                 PIC X.
  4967             88  CF-COMPANY-MASTER              VALUE '1'.
  4968             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4969             88  CF-STATE-MASTER                VALUE '3'.
  4970             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4971             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4972             88  CF-CARRIER-MASTER              VALUE '6'.
  4973             88  CF-MORTALITY-MASTER            VALUE '7'.
  4974             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4975             88  CF-TERMINAL-MASTER             VALUE '9'.
  4976             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  93
* EL050.cbl
  4977             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4978             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4979             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4980             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4981             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4982             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4983             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4984             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4985         16  CF-ACCESS-CD-GENL              PIC X(4).
  4986         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4987             20  CF-PROCESSOR               PIC X(4).
  4988         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4989             20  CF-STATE-CODE              PIC XX.
  4990             20  FILLER                     PIC XX.
  4991         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4992             20  FILLER                     PIC XX.
  4993             20  CF-HI-BEN-IN-REC           PIC XX.
  4994         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4995             20  FILLER                     PIC XXX.
  4996             20  CF-CARRIER-CNTL            PIC X.
  4997         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4998             20  FILLER                     PIC XX.
  4999             20  CF-HI-TYPE-IN-REC          PIC 99.
  5000         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5001             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5002                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5003             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5004             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5005         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5006             20  FILLER                     PIC X.
  5007             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5008         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5009             20  FILLER                     PIC XX.
  5010             20  CF-MORTGAGE-PLAN           PIC XX.
  5011         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5012
  5013     12  CF-LAST-MAINT-DT                   PIC XX.
  5014     12  CF-LAST-MAINT-BY                   PIC X(4).
  5015     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5016
  5017     12  CF-RECORD-BODY                     PIC X(728).
  5018
  5019
  5020****************************************************************
  5021*             COMPANY MASTER RECORD                            *
  5022****************************************************************
  5023
  5024     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5025         16  CF-COMPANY-ADDRESS.
  5026             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5027             20  CF-CL-IN-CARE-OF           PIC X(30).
  5028             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5029             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5030             20  CF-CL-CITY-STATE           PIC X(30).
  5031             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5032             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5033         16  CF-COMPANY-CD                  PIC X.
  5034         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  94
* EL050.cbl
  5035         16  CF-SECURITY-OPTION             PIC X.
  5036             88  ALL-SECURITY                   VALUE '1'.
  5037             88  COMPANY-VERIFY                 VALUE '2'.
  5038             88  PROCESSOR-VERIFY               VALUE '3'.
  5039             88  NO-SECURITY                    VALUE '4'.
  5040             88  ALL-BUT-TERM                   VALUE '5'.
  5041         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5042             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5043         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5044             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5045         16  CF-INFORCE-LOCATION            PIC X.
  5046             88  CERTS-ARE-ONLINE               VALUE '1'.
  5047             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5048             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5049         16  CF-LOWER-CASE-LETTERS          PIC X.
  5050         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5051             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5052             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5053             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5054             88  CF-ACCNT-CNTL                  VALUE '3'.
  5055             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5056
  5057         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5058         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5059
  5060         16  CF-LGX-CREDIT-USER             PIC X.
  5061             88  CO-IS-NOT-USER                 VALUE 'N'.
  5062             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5063
  5064         16 CF-CREDIT-CALC-CODES.
  5065             20  CF-CR-REM-TERM-CALC PIC X.
  5066               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5067               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5068               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5069               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5070               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5071               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5072               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5073             20  CF-CR-R78-METHOD           PIC X.
  5074               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5075               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5076
  5077         16  CF-CLAIM-CONTROL-COUNTS.
  5078             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5079                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5080
  5081             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5082                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5083
  5084             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5085                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5086
  5087             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5088                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5089
  5090         16  CF-CURRENT-MONTH-END           PIC XX.
  5091
  5092         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  95
* EL050.cbl
  5093             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5094             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5095             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5096             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5097                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5098                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5099             20  CF-CO-PREM-REJECT-SW       PIC X.
  5100                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5101                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5102             20  CF-CO-REF-REJECT-SW        PIC X.
  5103                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5104                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5105
  5106         16  CF-CO-REPORTING-DT             PIC XX.
  5107         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5108         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5109           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5110           88  CF-CO-MONTH-END                  VALUE '1'.
  5111
  5112         16  CF-LGX-CLAIM-USER              PIC X.
  5113             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5114             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5115
  5116         16  CF-CREDIT-EDIT-CONTROLS.
  5117             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5118             20  CF-MIN-AGE                 PIC 99.
  5119             20  CF-DEFAULT-AGE             PIC 99.
  5120             20  CF-MIN-TERM                PIC S999      COMP-3.
  5121             20  CF-MAX-TERM                PIC S999      COMP-3.
  5122             20  CF-DEFAULT-SEX             PIC X.
  5123             20  CF-JOINT-AGE-INPUT         PIC X.
  5124                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5125             20  CF-BIRTH-DATE-INPUT        PIC X.
  5126                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5127             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5128                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5129                 88  CF-ZERO-CARRIER            VALUE '1'.
  5130                 88  CF-ZERO-GROUPING           VALUE '2'.
  5131                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5132             20  CF-EDIT-SW                 PIC X.
  5133                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5134             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5135             20  CF-CR-PR-METHOD            PIC X.
  5136               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5137               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5138             20  FILLER                     PIC X.
  5139
  5140         16  CF-CREDIT-MISC-CONTROLS.
  5141             20  CF-REIN-TABLE-SW           PIC X.
  5142                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5143             20  CF-COMP-TABLE-SW           PIC X.
  5144                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5145             20  CF-EXPERIENCE-RETENTION-AGE
  5146                                            PIC S9        COMP-3.
  5147             20  CF-CONVERSION-DT           PIC XX.
  5148             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5149             20  CF-RUN-FREQUENCY-SW        PIC X.
  5150                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  96
* EL050.cbl
  5151                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5152
  5153             20  CF-CR-CHECK-NO-CONTROL.
  5154                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5155                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5156                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5157                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5158                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5159                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5160
  5161                 24  CF-CR-CHECK-COUNT       REDEFINES
  5162                     CF-CR-CHECK-COUNTER      PIC X(4).
  5163
  5164                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5165                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5166
  5167                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5168                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5169                 24  CF-MAIL-PROCESSING       PIC X.
  5170                     88  MAIL-PROCESSING          VALUE 'Y'.
  5171
  5172         16  CF-MISC-SYSTEM-CONTROL.
  5173             20  CF-SYSTEM-C                 PIC X.
  5174                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5175             20  CF-SYSTEM-D                 PIC X.
  5176                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5177             20  CF-SOC-SEC-NO-SW            PIC X.
  5178                 88  SOC-SEC-NO-USED             VALUE '1'.
  5179             20  CF-MEMBER-NO-SW             PIC X.
  5180                 88  MEMBER-NO-USED              VALUE '1'.
  5181             20  CF-TAX-ID-NUMBER            PIC X(11).
  5182             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5183             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5184                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5185                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5186                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5187                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5188             20  CF-SYSTEM-E                 PIC X.
  5189                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5190
  5191         16  CF-LGX-LIFE-USER               PIC X.
  5192             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5193             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5194
  5195         16  CF-CR-MONTH-END-DT             PIC XX.
  5196
  5197         16  CF-FILE-MAINT-DATES.
  5198             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5199                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5200             20  CF-LAST-BATCH       REDEFINES
  5201                 CF-LAST-BATCH-NO               PIC X(4).
  5202             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5203             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5204             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5205             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5206             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5207             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5208             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  97
* EL050.cbl
  5209             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5210             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5211             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5212
  5213         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5214         16  FILLER                         PIC X.
  5215
  5216         16  CF-ALT-MORT-CODE               PIC X(4).
  5217         16  CF-MEMBER-CAPTION              PIC X(10).
  5218
  5219         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5220             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5221             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5222             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5223             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5224             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5225
  5226         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5227
  5228         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5229         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5230         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5231         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5232
  5233         16  CF-AH-OVERRIDE-L1              PIC X.
  5234         16  CF-AH-OVERRIDE-L2              PIC XX.
  5235         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5236         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5237
  5238         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5239         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5240
  5241         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5242         16  CF-AR-LAST-EL860-DT            PIC XX.
  5243         16  CF-MP-MONTH-END-DT             PIC XX.
  5244
  5245         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5246         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5247             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5248
  5249         16  CF-AR-MONTH-END-DT             PIC XX.
  5250
  5251         16  CF-CRDTCRD-USER                PIC X.
  5252             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5253             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5254
  5255         16  CF-CC-MONTH-END-DT             PIC XX.
  5256
  5257         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5258
  5259         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5260             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5261             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5262             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5263         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5264         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5265         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5266         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  98
* EL050.cbl
  5267             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5268             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5269         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5270         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5271         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5272             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5273         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5274
  5275         16  CF-CL-ZIP-CODE.
  5276             20  CF-CL-ZIP-PRIME.
  5277                 24  CF-CL-ZIP-1ST          PIC X.
  5278                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5279                 24  FILLER                 PIC X(4).
  5280             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5281         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5282             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5283             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5284             20  FILLER                     PIC XXX.
  5285
  5286         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5287         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5288         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5289         16  CF-CO-OPTION-START-DATE        PIC XX.
  5290         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5291           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5292                                                      '3' '4'.
  5293           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5294           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5295           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5296           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5297           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5298           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5299
  5300         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5301
  5302         16  CF-PAYMENT-APPROVAL-LEVELS.
  5303             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5304             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5305             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5306             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5307             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5308             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5309
  5310         16  CF-END-USER-REPORTING-USER     PIC X.
  5311             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5312             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5313
  5314         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5315             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5316             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5317
  5318         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5319
  5320         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5321         16  FILLER                         PIC X.
  5322
  5323         16  CF-CREDIT-ARCHIVE-CNTL.
  5324             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page  99
* EL050.cbl
  5325             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5326             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5327
  5328         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5329
  5330         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5331             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5332             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5333
  5334         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5335             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5336             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5337
  5338         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5339
  5340         16  CF-CO-ACH-ID-CODE              PIC  X.
  5341             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5342             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5343             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5344         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5345         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5346         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5347         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5348         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5349         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5350         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5351         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5352         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5353                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5354         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5355                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5356
  5357         16  CF-CO-OVER-SHORT.
  5358             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5359             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5360
  5361*         16  FILLER                         PIC X(102).
  5362         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5363             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5364             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5365
  5366         16  CF-AH-APPROVAL-DAYS.
  5367             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5368             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5369             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5370             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5371
  5372         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5373
  5374         16  CF-APPROV-LEV-5.
  5375             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5376             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5377             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5378
  5379         16  FILLER                         PIC X(68).
  5380****************************************************************
  5381*             PROCESSOR/USER RECORD                            *
  5382****************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 100
* EL050.cbl
  5383
  5384     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5385         16  CF-PROCESSOR-NAME              PIC X(30).
  5386         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5387         16  CF-PROCESSOR-TITLE             PIC X(26).
  5388         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5389                 88  MESSAGE-YES                VALUE 'Y'.
  5390                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5391
  5392*****************************************************
  5393****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5394****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5395****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5396****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5397*****************************************************
  5398
  5399         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5400             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5401             20  CF-APPLICATION-FORCE       PIC X.
  5402             20  CF-INDIVIDUAL-APP.
  5403                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5404                     28  CF-BROWSE-APP      PIC X.
  5405                     28  CF-UPDATE-APP      PIC X.
  5406
  5407         16  CF-CURRENT-TERM-ON             PIC X(4).
  5408         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5409             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5410             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5411             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5412             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5413             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5414             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5415             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5416         16  CF-PROCESSOR-CARRIER           PIC X.
  5417             88  NO-CARRIER-SECURITY            VALUE ' '.
  5418         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5419             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5420         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5421             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5422         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5423             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5424
  5425         16  CF-PROC-SYS-ACCESS-SW.
  5426             20  CF-PROC-CREDIT-CLAIMS-SW.
  5427                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5428                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5429                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5430                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5431             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5432                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5433                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5434             20  CF-PROC-LIFE-GNRLDGR-SW.
  5435                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5436                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5437                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5438                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5439             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5440                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 101
* EL050.cbl
  5441                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5442         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5443             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5444             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5445         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5446
  5447         16  CF-APPROVAL-LEVEL                  PIC X.
  5448             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5449             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5450             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5451             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5452             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5453
  5454         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5455
  5456         16  CF-LANGUAGE-TYPE                   PIC X.
  5457             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5458             88  CF-LANG-IS-FR                      VALUE 'F'.
  5459
  5460         16  CF-CSR-IND                         PIC X.
  5461         16  FILLER                             PIC X(239).
  5462
  5463****************************************************************
  5464*             PROCESSOR/REMINDERS RECORD                       *
  5465****************************************************************
  5466
  5467     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5468         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5469             20  CF-START-REMIND-DT         PIC XX.
  5470             20  CF-END-REMIND-DT           PIC XX.
  5471             20  CF-REMINDER-TEXT           PIC X(50).
  5472         16  FILLER                         PIC X(296).
  5473
  5474
  5475****************************************************************
  5476*             STATE MASTER RECORD                              *
  5477****************************************************************
  5478
  5479     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5480         16  CF-STATE-ABBREVIATION          PIC XX.
  5481         16  CF-STATE-NAME                  PIC X(25).
  5482         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5483         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5484             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5485             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5486             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5487             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5488                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5489                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5490             20  CF-ST-PREM-REJECT-SW       PIC X.
  5491                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5492                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5493             20  CF-ST-REF-REJECT-SW        PIC X.
  5494                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5495                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5496         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5497         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5498         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 102
* EL050.cbl
  5499             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5500             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5501             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5502         16  CF-ST-FST-PMT-EXTENSION.
  5503             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5504             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5505                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5506                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5507                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5508                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5509         16  CF-ST-STATE-CALL.
  5510             20  CF-ST-CALL-UNEARNED        PIC X.
  5511             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5512             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5513         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5514             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5515             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5516         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5517         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5518         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5519         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5520         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5521         16  FILLER                         PIC X.
  5522         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5523             20  CF-ST-BENEFIT-CD           PIC XX.
  5524             20  CF-ST-BENEFIT-KIND         PIC X.
  5525                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5526                 88  CF-ST-AH-KIND              VALUE 'A'.
  5527             20  CF-ST-REM-TERM-CALC        PIC X.
  5528                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5529                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5530                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5531                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5532                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5533                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5534                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5535                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5536
  5537             20  CF-ST-REFUND-CALC          PIC X.
  5538                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5539                 88  ST-REFD-BY-R78             VALUE '1'.
  5540                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5541                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5542                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5543                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5544                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5545                 88  ST-REFD-UTAH               VALUE '7'.
  5546                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5547                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5548                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5549
  5550             20  CF-ST-EARNING-CALC         PIC X.
  5551                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5552                 88  ST-EARN-BY-R78             VALUE '1'.
  5553                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5554                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5555                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5556                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 103
* EL050.cbl
  5557                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5558                 88  ST-EARN-MEAN               VALUE '8'.
  5559                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5560
  5561             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5562                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5563                 88  ST-OVRD-BY-R78             VALUE '1'.
  5564                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5565                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5566                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5567                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5568                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5569                 88  ST-OVRD-MEAN               VALUE '8'.
  5570                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5571             20  FILLER                     PIC X.
  5572
  5573         16  CF-ST-COMMISSION-CAPS.
  5574             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5575             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5576             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5577             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5578         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5579                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5580
  5581         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5582
  5583         16  CF-ST-STATUTORY-INTEREST.
  5584             20  CF-ST-STAT-DATE-FROM       PIC X.
  5585                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5586                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5587             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5588             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5589             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5590             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5591             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5592
  5593         16  CF-ST-OVER-SHORT.
  5594             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5595             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5596
  5597         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5598
  5599         16  CF-ST-RT-CALC                  PIC X.
  5600
  5601         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5602         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5603         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5604         16  CF-ST-RF-LR-CALC               PIC X.
  5605         16  CF-ST-RF-LL-CALC               PIC X.
  5606         16  CF-ST-RF-LN-CALC               PIC X.
  5607         16  CF-ST-RF-AH-CALC               PIC X.
  5608         16  CF-ST-RF-CP-CALC               PIC X.
  5609*        16  FILLER                         PIC X(206).
  5610*CIDMOD         16  FILLER                         PIC X(192).
  5611         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5612             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5613         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5614         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 104
* EL050.cbl
  5615         16  CF-ST-CAUSAL-STATE             PIC X.
  5616         16  FILLER                         PIC X(185).
  5617
  5618****************************************************************
  5619*             BENEFIT MASTER RECORD                            *
  5620****************************************************************
  5621
  5622     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5623         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5624             20  CF-BENEFIT-CODE            PIC XX.
  5625             20  CF-BENEFIT-NUMERIC  REDEFINES
  5626                 CF-BENEFIT-CODE            PIC XX.
  5627             20  CF-BENEFIT-ALPHA           PIC XXX.
  5628             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5629             20  CF-BENEFIT-COMMENT         PIC X(10).
  5630
  5631             20  CF-LF-COVERAGE-TYPE        PIC X.
  5632                 88  CF-REDUCING                VALUE 'R'.
  5633                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5634
  5635             20  CF-SPECIAL-CALC-CD         PIC X.
  5636                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5637                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5638                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5639                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5640                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5641                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5642                 88  CF-FARM-PLAN               VALUE 'F'.
  5643                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5644                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5645                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5646                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5647                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5648                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5649                 88  CF-PRUDENTIAL              VALUE 'P'.
  5650                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5651                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5652                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5653                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5654                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5655                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5656
  5657             20  CF-JOINT-INDICATOR         PIC X.
  5658                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5659
  5660*            20  FILLER                     PIC X(12).
  5661             20  FILLER                     PIC X(11).
  5662             20  CF-BENEFIT-CATEGORY        PIC X.
  5663             20  CF-LOAN-TYPE               PIC X(8).
  5664
  5665             20  CF-CO-REM-TERM-CALC        PIC X.
  5666                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5667                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5668                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5669                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5670                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5671
  5672             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 105
* EL050.cbl
  5673                 88  CO-EARN-BY-R78             VALUE '1'.
  5674                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5675                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5676                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5677                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5678                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5679                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5680                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5681
  5682             20  CF-CO-REFUND-CALC          PIC X.
  5683                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5684                 88  CO-REFD-BY-R78             VALUE '1'.
  5685                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5686                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5687                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5688                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5689                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5690                 88  CO-REFD-MEAN               VALUE '8'.
  5691                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5692                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5693                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5694
  5695             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5696                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5697                 88  CO-OVRD-BY-R78             VALUE '1'.
  5698                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5699                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5700                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5701                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5702                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5703                 88  CO-OVRD-MEAN               VALUE '8'.
  5704                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5705
  5706             20  CF-CO-BEN-I-G-CD           PIC X.
  5707                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5708                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5709                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5710
  5711         16  FILLER                         PIC X(304).
  5712
  5713
  5714****************************************************************
  5715*             CARRIER MASTER RECORD                            *
  5716****************************************************************
  5717
  5718     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5719         16  CF-ADDRESS-DATA.
  5720             20  CF-MAIL-TO-NAME            PIC X(30).
  5721             20  CF-IN-CARE-OF              PIC X(30).
  5722             20  CF-ADDRESS-LINE-1          PIC X(30).
  5723             20  CF-ADDRESS-LINE-2          PIC X(30).
  5724             20  CF-CITY-STATE              PIC X(30).
  5725             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5726             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5727
  5728         16  CF-CLAIM-NO-CONTROL.
  5729             20  CF-CLAIM-NO-METHOD         PIC X.
  5730                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 106
* EL050.cbl
  5731                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5732                 88  CLAIM-NO-SEQ               VALUE '3'.
  5733                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5734             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5735                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5736                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5737                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5738
  5739         16  CF-CHECK-NO-CONTROL.
  5740             20  CF-CHECK-NO-METHOD         PIC X.
  5741                 88  CHECK-NO-MANUAL            VALUE '1'.
  5742                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5743                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5744                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5745             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5746                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5747
  5748         16  CF-DOMICILE-STATE              PIC XX.
  5749
  5750         16  CF-EXPENSE-CONTROLS.
  5751             20  CF-EXPENSE-METHOD          PIC X.
  5752                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5753                 88  DOLLARS-PER-PMT            VALUE '2'.
  5754                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5755                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5756             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5757             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5758
  5759         16  CF-CORRESPONDENCE-CONTROL.
  5760             20  CF-LETTER-RESEND-OPT       PIC X.
  5761                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5762                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5763             20  FILLER                     PIC X(4).
  5764
  5765         16  CF-RESERVE-CONTROLS.
  5766             20  CF-MANUAL-SW               PIC X.
  5767                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5768             20  CF-FUTURE-SW               PIC X.
  5769                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5770             20  CF-PTC-SW                  PIC X.
  5771                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5772             20  CF-IBNR-SW                 PIC X.
  5773                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5774             20  CF-PTC-LF-SW               PIC X.
  5775                 88  CF-LF-PTC-USED             VALUE '1'.
  5776             20  CF-CDT-ACCESS-METHOD       PIC X.
  5777                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5778                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5779                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5780             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5781
  5782         16  CF-CLAIM-CALC-METHOD           PIC X.
  5783             88  360-PLUS-MONTHS                VALUE '1'.
  5784             88  365-PLUS-MONTHS                VALUE '2'.
  5785             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5786             88  360-DAILY                      VALUE '4'.
  5787             88  365-DAILY                      VALUE '5'.
  5788
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 107
* EL050.cbl
  5789         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5790         16  FILLER                         PIC X(11).
  5791
  5792         16  CF-LIMIT-AMOUNTS.
  5793             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5794             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5795             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5796             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5797             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5798             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5799             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5800             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5801             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5802             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5803
  5804         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5805         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5806         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5807
  5808         16  CF-ZIP-CODE.
  5809             20  CF-ZIP-PRIME.
  5810                 24  CF-ZIP-1ST             PIC X.
  5811                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5812                 24  FILLER                 PIC X(4).
  5813             20  CF-ZIP-PLUS4               PIC X(4).
  5814         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5815             20  CF-CAN-POSTAL-1            PIC XXX.
  5816             20  CF-CAN-POSTAL-2            PIC XXX.
  5817             20  FILLER                     PIC XXX.
  5818
  5819         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5820         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5821         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5822
  5823         16  CF-RATING-SWITCH               PIC X.
  5824             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5825             88  CF-NO-RATING                   VALUE 'N'.
  5826
  5827         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5828
  5829         16  CF-CARRIER-OVER-SHORT.
  5830             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5831             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5832
  5833         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5834         16  CF-SECPAY-SWITCH               PIC X.
  5835             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5836             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5837         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5838         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5839         16  FILLER                         PIC X(444).
  5840*        16  FILLER                         PIC X(452).
  5841
  5842
  5843****************************************************************
  5844*             MORTALITY MASTER RECORD                          *
  5845****************************************************************
  5846
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 108
* EL050.cbl
  5847     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5848         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5849                                INDEXED BY CF-MORT-NDX.
  5850             20  CF-MORT-TABLE              PIC X(5).
  5851             20  CF-MORT-TABLE-TYPE         PIC X.
  5852                 88  CF-MORT-JOINT              VALUE 'J'.
  5853                 88  CF-MORT-SINGLE             VALUE 'S'.
  5854                 88  CF-MORT-COMBINED           VALUE 'C'.
  5855                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5856                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5857             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5858             20  CF-MORT-AGE-METHOD         PIC XX.
  5859                 88  CF-AGE-LAST                VALUE 'AL'.
  5860                 88  CF-AGE-NEAR                VALUE 'AN'.
  5861             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5862             20  CF-MORT-ADJUSTMENT-DIRECTION
  5863                                            PIC X.
  5864                 88  CF-MINUS                   VALUE '-'.
  5865                 88  CF-PLUS                    VALUE '+'.
  5866             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5867             20  CF-MORT-JOINT-CODE         PIC X.
  5868                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5869             20  CF-MORT-PC-Q               PIC X.
  5870                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5871             20  CF-MORT-TABLE-CODE         PIC X(4).
  5872             20  CF-MORT-COMMENTS           PIC X(15).
  5873             20  FILLER                     PIC X(14).
  5874
  5875         16  FILLER                         PIC X(251).
  5876
  5877
  5878****************************************************************
  5879*             BUSSINESS TYPE MASTER RECORD                     *
  5880****************************************************************
  5881
  5882     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5883* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5884* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5885* AND RECORD 05 IS TYPES 81-99
  5886         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5887             20  CF-BUSINESS-TITLE          PIC  X(19).
  5888             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5889                                            PIC S9V9(4) COMP-3.
  5890             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5891             20  FILLER                     PIC  X.
  5892         16  FILLER                         PIC  X(248).
  5893
  5894
  5895****************************************************************
  5896*             TERMINAL MASTER RECORD                           *
  5897****************************************************************
  5898
  5899     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5900
  5901         16  CF-COMPANY-TERMINALS.
  5902             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5903                                  PIC X(4).
  5904         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 109
* EL050.cbl
  5905
  5906
  5907****************************************************************
  5908*             LIFE EDIT MASTER RECORD                          *
  5909****************************************************************
  5910
  5911     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5912         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5913             20  CF-LIFE-CODE-IN            PIC XX.
  5914             20  CF-LIFE-CODE-OUT           PIC XX.
  5915         16  FILLER                         PIC X(248).
  5916
  5917
  5918****************************************************************
  5919*             AH EDIT MASTER RECORD                            *
  5920****************************************************************
  5921
  5922     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5923         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5924             20  CF-AH-CODE-IN              PIC XXX.
  5925             20  CF-AH-CODE-OUT             PIC XX.
  5926         16  FILLER                         PIC X(248).
  5927
  5928
  5929****************************************************************
  5930*             CREDIBILITY TABLES                               *
  5931****************************************************************
  5932
  5933     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5934         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5935                             INDEXED BY CF-CRDB-NDX.
  5936             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5937             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5938             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5939         16  FILLER                         PIC  X(332).
  5940
  5941
  5942****************************************************************
  5943*             REPORT CUSTOMIZATION RECORD                      *
  5944****************************************************************
  5945
  5946     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5947         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5948             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5949             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5950             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5951**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5952****       A T-TRANSFER.                                   ****
  5953             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5954
  5955         16  FILLER                         PIC XX.
  5956
  5957         16  CF-CARRIER-CNTL-OPT.
  5958             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5959                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5960                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5961             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5962                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 110
* EL050.cbl
  5963         16  CF-GROUP-CNTL-OPT.
  5964             20  CF-GROUP-OPT-SEQ           PIC 9.
  5965                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5966                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5967             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5968                                            PIC X(6).
  5969         16  CF-STATE-CNTL-OPT.
  5970             20  CF-STATE-OPT-SEQ           PIC 9.
  5971                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5972                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5973             20  CF-STATE-SELECT OCCURS 3 TIMES
  5974                                            PIC XX.
  5975         16  CF-ACCOUNT-CNTL-OPT.
  5976             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5977                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5978                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5979             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5980                                            PIC X(10).
  5981         16  CF-BUS-TYP-CNTL-OPT.
  5982             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5983                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5984                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5985             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5986                                            PIC XX.
  5987         16  CF-LF-TYP-CNTL-OPT.
  5988             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5989                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5990                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5991             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5992                                            PIC XX.
  5993         16  CF-AH-TYP-CNTL-OPT.
  5994             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5995                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5996                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5997             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5998                                            PIC XX.
  5999         16  CF-REPTCD1-CNTL-OPT.
  6000             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6001                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6002                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6003             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6004                                            PIC X(10).
  6005         16  CF-REPTCD2-CNTL-OPT.
  6006             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6007                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6008                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6009             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6010                                            PIC X(10).
  6011         16  CF-USER1-CNTL-OPT.
  6012             20  CF-USER1-OPT-SEQ           PIC 9.
  6013                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6014                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6015             20  CF-USER1-SELECT OCCURS 3 TIMES
  6016                                            PIC X(10).
  6017         16  CF-USER2-CNTL-OPT.
  6018             20  CF-USER2-OPT-SEQ           PIC 9.
  6019                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6020                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 111
* EL050.cbl
  6021             20  CF-USER2-SELECT OCCURS 3 TIMES
  6022                                            PIC X(10).
  6023         16  CF-USER3-CNTL-OPT.
  6024             20  CF-USER3-OPT-SEQ           PIC 9.
  6025                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6026                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6027             20  CF-USER3-SELECT OCCURS 3 TIMES
  6028                                            PIC X(10).
  6029         16  CF-USER4-CNTL-OPT.
  6030             20  CF-USER4-OPT-SEQ           PIC 9.
  6031                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6032                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6033             20  CF-USER4-SELECT OCCURS 3 TIMES
  6034                                            PIC X(10).
  6035         16  CF-USER5-CNTL-OPT.
  6036             20  CF-USER5-OPT-SEQ           PIC 9.
  6037                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6038                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6039             20  CF-USER5-SELECT OCCURS 3 TIMES
  6040                                            PIC X(10).
  6041         16  CF-REINS-CNTL-OPT.
  6042             20  CF-REINS-OPT-SEQ           PIC 9.
  6043                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6044                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6045             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6046                 24  CF-REINS-PRIME         PIC XXX.
  6047                 24  CF-REINS-SUB           PIC XXX.
  6048
  6049         16  CF-AGENT-CNTL-OPT.
  6050             20  CF-AGENT-OPT-SEQ           PIC 9.
  6051                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6052                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6053             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6054                                            PIC X(10).
  6055
  6056         16  FILLER                         PIC X(43).
  6057
  6058         16  CF-LOSS-RATIO-SELECT.
  6059             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6060             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6061         16  CF-ENTRY-DATE-SELECT.
  6062             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6063             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6064         16  CF-EFFECTIVE-DATE-SELECT.
  6065             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6066             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6067
  6068         16  CF-EXCEPTION-LIST-IND          PIC X.
  6069             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6070
  6071         16  FILLER                         PIC X(318).
  6072
  6073****************************************************************
  6074*                  EXCEPTION REPORTING RECORD                  *
  6075****************************************************************
  6076
  6077     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6078         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 112
* EL050.cbl
  6079             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6080
  6081         16  CF-COMBINED-LIFE-AH-OPT.
  6082             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6083             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6084             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6085             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6086
  6087         16  CF-LIFE-OPT.
  6088             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6089             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6090             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6091             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6092             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6093             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6094             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6095             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6096             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6097             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6098
  6099         16  CF-AH-OPT.
  6100             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6101             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6102             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6103             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6104             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6105             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6106             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6107             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6108             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6109             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6110
  6111         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6112             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6113             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6114             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6115
  6116         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6117
  6118         16  FILLER                         PIC X(673).
  6119
  6120
  6121****************************************************************
  6122*             MORTGAGE SYSTEM PLAN RECORD                      *
  6123****************************************************************
  6124
  6125     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6126         16  CF-PLAN-TYPE                   PIC X.
  6127             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6128             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6129             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6130         16  CF-PLAN-ABBREV                 PIC XXX.
  6131         16  CF-PLAN-DESCRIPT               PIC X(10).
  6132         16  CF-PLAN-NOTES                  PIC X(20).
  6133         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6134         16  CF-PLAN-UNDERWRITING.
  6135             20  CF-PLAN-TERM-DATA.
  6136                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 113
* EL050.cbl
  6137                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6138             20  CF-PLAN-AGE-DATA.
  6139                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6140                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6141                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6142             20  CF-PLAN-BENEFIT-DATA.
  6143                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6144                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6145                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6146                                            PIC S9(7)V99  COMP-3.
  6147         16  CF-PLAN-POLICY-FORMS.
  6148             20  CF-POLICY-FORM             PIC X(12).
  6149             20  CF-MASTER-APPLICATION      PIC X(12).
  6150             20  CF-MASTER-POLICY           PIC X(12).
  6151         16  CF-PLAN-RATING.
  6152             20  CF-RATE-CODE               PIC X(5).
  6153             20  CF-SEX-RATING              PIC X.
  6154                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6155                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6156             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6157             20  CF-SUB-STD-TYPE            PIC X.
  6158                 88  CF-PCT-OF-PREM            VALUE '1'.
  6159                 88  CF-PCT-OF-BENE            VALUE '2'.
  6160         16  CF-PLAN-PREM-TOLERANCES.
  6161             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6162             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6163         16  CF-PLAN-PYMT-TOLERANCES.
  6164             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6165             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6166         16  CF-PLAN-MISC-DATA.
  6167             20  FILLER                     PIC X.
  6168             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6169             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6170         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6171         16  CF-PLAN-IND-GRP                PIC X.
  6172             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6173                                                     '1'.
  6174             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6175                                                     '2'.
  6176         16  CF-MIB-SEARCH-SW               PIC X.
  6177             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6178             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6179             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6180             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6181         16  CF-ALPHA-SEARCH-SW             PIC X.
  6182             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6183             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6184             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6185             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6186             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6187             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6188             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6189             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6190             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6191             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6192                                                     'A' 'B' 'C'
  6193                                                     'X' 'Y' 'Z'.
  6194         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 114
* EL050.cbl
  6195             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6196             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6197             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6198             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6199             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6200         16  FILLER                         PIC X(4).
  6201         16  CF-HEALTH-QUESTIONS            PIC X.
  6202             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6203         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6204         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6205         16  CF-PLAN-SNGL-JNT               PIC X.
  6206             88  CF-COMBINED-PLAN              VALUE 'C'.
  6207             88  CF-JNT-PLAN                   VALUE 'J'.
  6208             88  CF-SNGL-PLAN                  VALUE 'S'.
  6209         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6210         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6211         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6212         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6213         16  CF-RERATE-CNTL                 PIC  X.
  6214             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6215             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6216             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6217             88  CF-AUTO-RECALC                 VALUE '4'.
  6218         16  CF-BENEFIT-TYPE                PIC  X.
  6219             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6220             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6221         16  CF-POLICY-FEE                  PIC S999V99
  6222                                                    COMP-3.
  6223         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6224         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6225         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6226         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6227         16  FILLER                         PIC  X(32).
  6228         16  CF-TERMINATION-FORM            PIC  X(04).
  6229         16  FILLER                         PIC  X(08).
  6230         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6231                                                       COMP-3.
  6232         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6233         16  CF-ISSUE-LETTER                PIC  X(4).
  6234         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6235         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6236             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6237             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6238         16  CF-MP-REFUND-CALC              PIC X.
  6239             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6240             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6241             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6242             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6243             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6244             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6245             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6246             88  CF-MP-REFD-MEAN                VALUE '8'.
  6247         16  CF-ALT-RATE-CODE               PIC  X(5).
  6248
  6249
  6250         16  FILLER                         PIC X(498).
  6251****************************************************************
  6252*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 115
* EL050.cbl
  6253****************************************************************
  6254
  6255     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6256         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6257         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6258             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6259             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6260             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6261             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6262             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6263
  6264         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6265         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6266         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6267         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6268         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6269
  6270         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6271             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6272         16  CF-MP-RECON-USE-IND            PIC X(1).
  6273             88  CF-MP-USE-RECON             VALUE 'Y'.
  6274         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6275             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6276         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6277             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6278             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6279         16  FILLER                         PIC X(1).
  6280         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6281             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6282         16  CF-MORTG-MIB-VERSION           PIC X.
  6283             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6284             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6285             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6286         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6287             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6288                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6289             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6290                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6291             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6292                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6293             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6294                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6295             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6296                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6297             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6298                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6299         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6300         16  FILLER                         PIC X(7).
  6301         16  CF-MORTG-DESTINATION-SYMBOL.
  6302             20  CF-MORTG-MIB-COMM          PIC X(5).
  6303             20  CF-MORTG-MIB-TERM          PIC X(5).
  6304         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6305             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6306         16  FILLER                         PIC X(03).
  6307         16  CF-MP-CHECK-NO-CONTROL.
  6308             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6309                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6310                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 116
* EL050.cbl
  6311                                                ' ' LOW-VALUES.
  6312                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6313                                               VALUE '3'.
  6314         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6315         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6316         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6317             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6318                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6319             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6320                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6321             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6322                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6323             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6324                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6325             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6326                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6327             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6328                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6329         16  CF-MORTG-BILLING-AREA.
  6330             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6331                                            PIC X.
  6332         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6333         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6334         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6335         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6336             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6337             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6338         16  FILLER                         PIC X.
  6339         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6340             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6341             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6342         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6343         16  FILLER                         PIC X(8).
  6344         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6345         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6346         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6347         16  CF-ACH-COMPANY-ID.
  6348             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6349                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6350                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6351                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6352             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6353         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6354             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6355         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6356             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6357             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6358         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6359         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6360         16  FILLER                         PIC X(536).
  6361
  6362****************************************************************
  6363*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6364****************************************************************
  6365
  6366     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6367         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6368             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 117
* EL050.cbl
  6369                 24  CF-FEMALE-FT           PIC 99.
  6370                 24  CF-FEMALE-IN           PIC 99.
  6371             20  CF-FEMALE-MIN-WT           PIC 999.
  6372             20  CF-FEMALE-MAX-WT           PIC 999.
  6373         16  FILLER                         PIC X(428).
  6374
  6375     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6376         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6377             20  CF-MALE-HEIGHT.
  6378                 24  CF-MALE-FT             PIC 99.
  6379                 24  CF-MALE-IN             PIC 99.
  6380             20  CF-MALE-MIN-WT             PIC 999.
  6381             20  CF-MALE-MAX-WT             PIC 999.
  6382         16  FILLER                         PIC X(428).
  6383******************************************************************
  6384*             AUTOMATIC ACTIVITY RECORD                          *
  6385******************************************************************
  6386     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6387         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6388             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6389             20  CF-SYS-LETTER-ID           PIC X(04).
  6390             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6391             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6392             20  CF-SYS-RESET-SW            PIC X(01).
  6393             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6394             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6395
  6396         16  FILLER                         PIC X(50).
  6397
  6398         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6399             20  CF-USER-ACTIVE-SW          PIC X(01).
  6400             20  CF-USER-LETTER-ID          PIC X(04).
  6401             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6402             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6403             20  CF-USER-RESET-SW           PIC X(01).
  6404             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6405             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6406             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6407
  6408         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 118
* EL050.cbl
  6410*    COPY ERCACCT.
  6411******************************************************************
  6412*                                                                *
  6413*                                                                *
  6414*                            ERCACCT                             *
  6415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6416*                            VMOD=2.031                          *
  6417*                                                                *
  6418*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6419*                                                                *
  6420*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6421*   VSAM ACCOUNT MASTER FILES.                                   *
  6422*                                                                *
  6423*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6424*                                                                *
  6425*   FILE TYPE = VSAM,KSDS                                        *
  6426*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6427*                                                                *
  6428*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6429*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6430*                                                                *
  6431*   LOG = NO                                                     *
  6432*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6433*                                                                *
  6434*                                                                *
  6435******************************************************************
  6436*                   C H A N G E   L O G
  6437*
  6438* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6439*-----------------------------------------------------------------
  6440*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6441* EFFECTIVE    NUMBER
  6442*-----------------------------------------------------------------
  6443* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6444* 092705    2005050300006  PEMA  ADD SPP LEASES
  6445* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6446* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6447* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6448* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6449* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6450******************************************************************
  6451
  6452 01  ACCOUNT-MASTER.
  6453     12  AM-RECORD-ID                      PIC XX.
  6454         88  VALID-AM-ID                      VALUE 'AM'.
  6455
  6456     12  AM-CONTROL-PRIMARY.
  6457         16  AM-COMPANY-CD                 PIC X.
  6458         16  AM-MSTR-CNTRL.
  6459             20  AM-CONTROL-A.
  6460                 24  AM-CARRIER            PIC X.
  6461                 24  AM-GROUPING.
  6462                     28 AM-GROUPING-PREFIX PIC XXX.
  6463                     28 AM-GROUPING-PRIME  PIC XXX.
  6464                 24  AM-STATE              PIC XX.
  6465                 24  AM-ACCOUNT.
  6466                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6467                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 119
* EL050.cbl
  6468             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6469                                           PIC X(19).
  6470             20  AM-CNTRL-B.
  6471                 24  AM-EXPIRATION-DT      PIC XX.
  6472                 24  FILLER                PIC X(4).
  6473             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6474                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6475
  6476     12  AM-CONTROL-BY-VAR-GRP.
  6477         16  AM-COMPANY-CD-A1              PIC X.
  6478         16  AM-VG-CARRIER                 PIC X.
  6479         16  AM-VG-GROUPING                PIC X(6).
  6480         16  AM-VG-STATE                   PIC XX.
  6481         16  AM-VG-ACCOUNT                 PIC X(10).
  6482         16  AM-VG-DATE.
  6483             20  AM-VG-EXPIRATION-DT       PIC XX.
  6484             20  FILLER                    PIC X(4).
  6485         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6486                                           PIC 9(11)      COMP-3.
  6487     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6488         16  FILLER                        PIC X(10).
  6489         16  AM-VG-KEY3.
  6490             20  AM-VG3-ACCOUNT            PIC X(10).
  6491             20  AM-VG3-EXP-DT             PIC XX.
  6492         16  FILLER                        PIC X(4).
  6493     12  AM-MAINT-INFORMATION.
  6494         16  AM-LAST-MAINT-DT              PIC XX.
  6495         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6496         16  AM-LAST-MAINT-USER            PIC X(4).
  6497         16  FILLER                        PIC XX.
  6498
  6499     12  AM-EFFECTIVE-DT                   PIC XX.
  6500     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6501
  6502     12  AM-PREV-DATES  COMP-3.
  6503         16  AM-PREV-EXP-DT                PIC 9(11).
  6504         16  AM-PREV-EFF-DT                PIC 9(11).
  6505
  6506     12  AM-REPORT-CODE-1                  PIC X(10).
  6507     12  AM-REPORT-CODE-2                  PIC X(10).
  6508
  6509     12  AM-CITY-CODE                      PIC X(4).
  6510     12  AM-COUNTY-PARISH                  PIC X(6).
  6511
  6512     12  AM-NAME                           PIC X(30).
  6513     12  AM-PERSON                         PIC X(30).
  6514     12  AM-ADDRS                          PIC X(30).
  6515     12  AM-CITY.
  6516         16  AM-ADDR-CITY                  PIC X(28).
  6517         16  AM-ADDR-STATE                 PIC XX.
  6518     12  AM-ZIP.
  6519         16  AM-ZIP-PRIME.
  6520             20  AM-ZIP-PRI-1ST            PIC X.
  6521                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6522             20  FILLER                    PIC X(4).
  6523         16  AM-ZIP-PLUS4                  PIC X(4).
  6524     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6525         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 120
* EL050.cbl
  6526         16  AM-CAN-POSTAL-2               PIC XXX.
  6527         16  FILLER                        PIC XXX.
  6528     12  AM-TEL-NO.
  6529         16  AM-AREA-CODE                  PIC 999.
  6530         16  AM-TEL-PRE                    PIC 999.
  6531         16  AM-TEL-NBR                    PIC 9(4).
  6532     12  AM-TEL-LOC                        PIC X.
  6533         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6534         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6535
  6536     12  AM-COMM-STRUCTURE.
  6537         16  AM-DEFN-1.
  6538             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6539                 24  AM-AGT.
  6540                     28  AM-AGT-PREFIX     PIC X(4).
  6541                     28  AM-AGT-PRIME      PIC X(6).
  6542                 24  AM-COM-TYP            PIC X.
  6543                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6544                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6545                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6546                 24  AM-RECALC-LV-INDIC    PIC X.
  6547                 24  AM-RETRO-LV-INDIC     PIC X.
  6548                 24  AM-GL-CODES           PIC X.
  6549                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6550                 24  FILLER                PIC X(01).
  6551         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6552             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6553                 24  FILLER                PIC X(11).
  6554                 24  AM-L-COMA             PIC XXX.
  6555                 24  AM-J-COMA             PIC XXX.
  6556                 24  AM-A-COMA             PIC XXX.
  6557                 24  FILLER                PIC X(6).
  6558
  6559     12  AM-COMM-CHANGE-STATUS             PIC X.
  6560         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6561
  6562     12  AM-CSR-CODE                       PIC X(4).
  6563
  6564     12  AM-BILLING-STATUS                 PIC X.
  6565         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6566         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6567     12  AM-AUTO-REFUND-SW                 PIC X.
  6568         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6569         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6570     12  AM-GPCD                           PIC 99.
  6571     12  AM-IG                             PIC X.
  6572         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6573         88  AM-HAS-GROUP                     VALUE '2'.
  6574     12  AM-STATUS                         PIC X.
  6575         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6576         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6577         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6578         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6579         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6580         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6581     12  AM-REMIT-TO                       PIC 99.
  6582     12  AM-ID-NO                          PIC X(11).
  6583
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 121
* EL050.cbl
  6584     12  AM-CAL-TABLE                      PIC XX.
  6585     12  AM-LF-DEVIATION                   PIC XXX.
  6586     12  AM-AH-DEVIATION                   PIC XXX.
  6587     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6588     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6589     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6590     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6591     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6592     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6593
  6594     12  AM-USER-FIELDS.
  6595         16  AM-FLD-1                      PIC XX.
  6596         16  AM-FLD-2                      PIC XX.
  6597         16  AM-FLD-3                      PIC XX.
  6598         16  AM-FLD-4                      PIC XX.
  6599         16  AM-FLD-5                      PIC XX.
  6600
  6601     12  AM-1ST-PROD-DATE.
  6602         16  AM-1ST-PROD-YR                PIC XX.
  6603         16  AM-1ST-PROD-MO                PIC XX.
  6604         16  AM-1ST-PROD-DA                PIC XX.
  6605     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6606     12  AM-CERTS-PURGED-DATE.
  6607         16  AM-PUR-YR                     PIC XX.
  6608         16  AM-PUR-MO                     PIC XX.
  6609         16  AM-PUR-DA                     PIC XX.
  6610     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6611     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6612     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6613     12  AM-INACTIVE-DATE.
  6614         16  AM-INA-MO                     PIC 99.
  6615         16  AM-INA-DA                     PIC 99.
  6616         16  AM-INA-YR                     PIC 99.
  6617     12  AM-AR-HI-CERT-DATE                PIC XX.
  6618
  6619     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6620     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6621
  6622     12  AM-OB-PAYMENT-MODE                PIC X.
  6623         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6624         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6625         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6626         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6627
  6628     12  AM-AH-ONLY-INDICATOR              PIC X.
  6629         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6630         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6631
  6632     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6633
  6634     12  AM-OVER-SHORT.
  6635         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6636         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6637
  6638     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6639     12  AM-DCC-CLP-STATE                  PIC XX.
  6640
  6641     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 122
* EL050.cbl
  6642     12  AM-RECALC-REIN                    PIC X.
  6643
  6644     12  AM-REI-TABLE                      PIC XXX.
  6645     12  AM-REI-ET-LF                      PIC X.
  6646     12  AM-REI-ET-AH                      PIC X.
  6647     12  AM-REI-PE-LF                      PIC X.
  6648     12  AM-REI-PE-AH                      PIC X.
  6649     12  AM-REI-PRT-ST                     PIC X.
  6650     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6651     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6652     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6653     12  AM-REI-GROUP-A                    PIC X(6).
  6654     12  AM-REI-MORT                       PIC X(4).
  6655     12  AM-REI-PRT-OW                     PIC X.
  6656     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6657     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6658     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6659     12  AM-REI-GROUP-B                    PIC X(6).
  6660
  6661     12  AM-TRUST-TYPE                     PIC X(2).
  6662
  6663     12  AM-EMPLOYER-STMT-USED             PIC X.
  6664     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6665
  6666     12  AM-STD-AH-TYPE                    PIC XX.
  6667     12  AM-EARN-METHODS.
  6668         16  AM-EARN-METHOD-R              PIC X.
  6669             88 AM-REF-RL-R78                 VALUE 'R'.
  6670             88 AM-REF-RL-PR                  VALUE 'P'.
  6671             88 AM-REF-RL-MEAN                VALUE 'M'.
  6672             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6673         16  AM-EARN-METHOD-L              PIC X.
  6674             88 AM-REF-LL-R78                 VALUE 'R'.
  6675             88 AM-REF-LL-PR                  VALUE 'P'.
  6676             88 AM-REF-LL-MEAN                VALUE 'M'.
  6677             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6678         16  AM-EARN-METHOD-A              PIC X.
  6679             88 AM-REF-AH-R78                 VALUE 'R'.
  6680             88 AM-REF-AH-PR                  VALUE 'P'.
  6681             88 AM-REF-AH-MEAN                VALUE 'M'.
  6682             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6683             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6684             88 AM-REF-AH-NET                 VALUE 'N'.
  6685
  6686     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6687     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6688     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6689
  6690     12  AM-RET-Y-N                        PIC X.
  6691     12  AM-RET-P-E                        PIC X.
  6692     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6693     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6694     12  AM-RET-GRP                        PIC X(6).
  6695     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6696         16  AM-POOL-PRIME                 PIC XXX.
  6697         16  AM-POOL-SUB                   PIC XXX.
  6698     12  AM-RETRO-EARNINGS.
  6699         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 123
* EL050.cbl
  6700         16  AM-RET-EARN-L                 PIC X.
  6701         16  AM-RET-EARN-A                 PIC X.
  6702     12  AM-RET-ST-TAX-USE                 PIC X.
  6703         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6704         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6705     12  AM-RETRO-BEG-EARNINGS.
  6706         16  AM-RET-BEG-EARN-R             PIC X.
  6707         16  AM-RET-BEG-EARN-L             PIC X.
  6708         16  AM-RET-BEG-EARN-A             PIC X.
  6709     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6710     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6711
  6712     12  AM-USER-SELECT-OPTIONS.
  6713         16  AM-USER-SELECT-1              PIC X(10).
  6714         16  AM-USER-SELECT-2              PIC X(10).
  6715         16  AM-USER-SELECT-3              PIC X(10).
  6716         16  AM-USER-SELECT-4              PIC X(10).
  6717         16  AM-USER-SELECT-5              PIC X(10).
  6718
  6719     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6720
  6721     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6722
  6723     12  AM-RPT045A-SWITCH                 PIC X.
  6724         88  RPT045A-OFF                   VALUE 'N'.
  6725
  6726     12  AM-INSURANCE-LIMITS.
  6727         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6728         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6729
  6730     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6731         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6732
  6733     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6734         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6735         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6736
  6737     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6738
  6739     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6740     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6741     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6742     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6743     12  AM-DCC-UEF-STATE                  PIC XX.
  6744     12  FILLER                            PIC XXX.
  6745     12  AM-REPORT-CODE-3                  PIC X(10).
  6746*    12  FILLER                            PIC X(22).
  6747
  6748     12  AM-RESERVE-DATE.
  6749         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6750         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6751         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6752
  6753     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6754     12  AM-NOTIFICATION-TYPES.
  6755         16  AM-NOTIF-OF-LETTERS           PIC X.
  6756         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6757         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 124
* EL050.cbl
  6758         16  AM-NOTIF-OF-STATUS            PIC X.
  6759
  6760     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6761         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6762         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6763         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6764         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6765
  6766     12  AM-BENEFIT-CONTROLS.
  6767         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6768             20  AM-BENEFIT-CODE           PIC XX.
  6769             20  AM-BENEFIT-TYPE           PIC X.
  6770             20  AM-BENEFIT-REVISION       PIC XXX.
  6771             20  AM-BENEFIT-REM-TERM       PIC X.
  6772             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6773             20  FILLER                    PIC XX.
  6774         16  FILLER                        PIC X(80).
  6775
  6776     12  AM-TRANSFER-DATA.
  6777         16  AM-TRANSFERRED-FROM.
  6778             20  AM-TRNFROM-CARRIER        PIC X.
  6779             20  AM-TRNFROM-GROUPING.
  6780                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6781                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6782             20  AM-TRNFROM-STATE          PIC XX.
  6783             20  AM-TRNFROM-ACCOUNT.
  6784                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6785                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6786             20  AM-TRNFROM-DTE            PIC XX.
  6787         16  AM-TRANSFERRED-TO.
  6788             20  AM-TRNTO-CARRIER          PIC X.
  6789             20  AM-TRNTO-GROUPING.
  6790                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6791                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6792             20  AM-TRNTO-STATE            PIC XX.
  6793             20  AM-TRNTO-ACCOUNT.
  6794                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6795                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6796             20  AM-TRNTO-DTE              PIC XX.
  6797         16  FILLER                        PIC X(10).
  6798
  6799     12  AM-SAVED-REMIT-TO                 PIC 99.
  6800
  6801     12  AM-COMM-STRUCTURE-SAVED.
  6802         16  AM-DEFN-1-SAVED.
  6803             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6804                 24  AM-AGT-SV             PIC X(10).
  6805                 24  AM-COM-TYP-SV         PIC X.
  6806                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6807                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6808                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6809                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6810                 24  FILLER                PIC X.
  6811                 24  AM-GL-CODES-SV        PIC X.
  6812                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6813                 24  FILLER                PIC X.
  6814         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6815             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 125
* EL050.cbl
  6816                 24  FILLER                PIC X(11).
  6817                 24  AM-L-COMA-SV          PIC XXX.
  6818                 24  AM-J-COMA-SV          PIC XXX.
  6819                 24  AM-A-COMA-SV          PIC XXX.
  6820                 24  FILLER                PIC X(6).
  6821
  6822     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6823         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6824            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6825            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6826            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6827
  6828     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6829     12  FILLER                            PIC X(120).
  6830
  6831     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6832         16  AM-CONTROL-NAME               PIC X(30).
  6833         16  AM-EXECUTIVE-ONE.
  6834             20  AM-EXEC1-NAME             PIC X(15).
  6835             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6836                                                          COMP-3.
  6837             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6838                                                          COMP-3.
  6839         16  AM-EXECUTIVE-TWO.
  6840             20  AM-EXEC2-NAME             PIC X(15).
  6841             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6842                                                          COMP-3.
  6843             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6844                                                          COMP-3.
  6845
  6846     12  AM-RETRO-ADDITIONAL-DATA.
  6847         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6848         16  AM-RETRO-PREM-P-E             PIC X.
  6849         16  AM-RETRO-CLMS-P-I             PIC X.
  6850         16  AM-RETRO-RET-BRACKET-LF.
  6851             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6852                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6853                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6854             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6855                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6856                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6857             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6858                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6859                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6860         16  AM-RETRO-RET-BRACKET-AH.
  6861             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6862                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6863                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6864                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6865             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6866                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6867                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6868             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6869                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6870                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6871
  6872     12  AM-COMMENTS.
  6873         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 126
* EL050.cbl
  6874
  6875     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6876         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6877         16  AM-FLI-BILLING-CODE           PIC X.
  6878         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6879         16  AM-FLI-UNITED-IDENT           PIC X.
  6880         16  AM-FLI-INTEREST-LOST-DATA.
  6881             20  AM-FLI-BANK-NO            PIC X(5).
  6882             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6883             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6884             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6885         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6886             20  AM-FLI-AGT                PIC X(9).
  6887             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6888             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6889         16  FILLER                        PIC X(102).
  6890
  6891     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6892         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6893             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6894             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6895             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6896             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6897             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6898         16  FILLER                          PIC X(10).
  6899******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 127
* EL050.cbl
  6901*    COPY ERCREIN.
  6902******************************************************************
  6903*                                                                *
  6904*                            ERCREIN                             *
  6905*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6906*                            VMOD=2.010                          *
  6907*                                                                *
  6908*   ONLINE CREDIT SYSTEM                                         *
  6909*                                                                *
  6910*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6911*                                                                *
  6912*   FILE TYPE = VSAM,KSDS                                        *
  6913*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6914*                                                                *
  6915*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6916*       ALTERNATE PATH = NONE                                    *
  6917*                                                                *
  6918*   LOG = NO                                                     *
  6919*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6920*                                                                *
  6921******************************************************************
  6922*                   C H A N G E   L O G
  6923*
  6924* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6925*-----------------------------------------------------------------
  6926*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6927* EFFECTIVE    NUMBER
  6928*-----------------------------------------------------------------
  6929* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6930* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6931******************************************************************
  6932 01  REINSURANCE-RECORD.
  6933     12  RE-RECORD-ID                      PIC XX.
  6934         88  VALID-RE-ID                      VALUE 'RE'.
  6935
  6936     12  RE-CONTROL-PRIMARY.
  6937         16  RE-COMPANY-CD                 PIC X.
  6938         16  RE-KEY.
  6939             20  RE-CODE                   PIC X.
  6940                 88  RE-TABLE-RECORD          VALUE 'A'.
  6941                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6942             20  RE-TABLE                  PIC XXX.
  6943             20  FILLER                    PIC XXX.
  6944         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6945             20  FILLER                    PIC X.
  6946             20  RE-COMPANY.
  6947                 24  RE-COMP-PRIME         PIC XXX.
  6948                 24  RE-COMP-SUB           PIC XXX.
  6949
  6950     12  RE-MAINT-INFORMATION.
  6951         16  RE-LAST-MAINT-DT              PIC XX.
  6952         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6953         16  RE-LAST-MAINT-USER            PIC X(4).
  6954         16  FILLER                        PIC X(10).
  6955
  6956     12  RE-TABLE-DATA.
  6957         16  RE-100-COMP                   PIC 99.
  6958
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 128
* EL050.cbl
  6959         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6960             20  RE-REI-COMP-NO.
  6961                 24  RE-REI-COMP           PIC XXX.
  6962                 24  RE-REI-COMP-SUB       PIC XXX.
  6963             20  RE-LF-QC                  PIC X.
  6964             20  RE-AH-QC                  PIC X.
  6965             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6966             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6967             20  RE-LFAGE-LO               PIC 99.
  6968             20  RE-LFAGE-HI               PIC 99.
  6969             20  RE-AHAGE-LO               PIC 99.
  6970             20  RE-AHAGE-HI               PIC 99.
  6971             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6972             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6973             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6974             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6975             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6976             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6977             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6978             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6979             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6980             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6981             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6982             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6983             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6984             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6985             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6986             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6987             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6988             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6989             20  RE-LF-BEN-CODE            PIC X.
  6990             20  RE-AH-BEN-CODE            PIC X.
  6991             20  RE-INTERACTIVE            PIC X.
  6992             20  RE-REMAINING              PIC X.
  6993             20  RE-LF-RUNOFF-SW           PIC X.
  6994             20  RE-AH-RUNOFF-SW           PIC X.
  6995             20  FILLER                    PIC X(19).
  6996
  6997         16  RE-COMP-INFO-END              PIC X(6).
  6998         16  RE-NSP-ST-CD-LF               PIC XX.
  6999         16  RE-NSP-ST-CD-AH               PIC XX.
  7000         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7001             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7002
  7003         16  FILLER                        PIC X(27).
  7004
  7005     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7006         16  RE-NAME                       PIC X(30).
  7007         16  RE-LF-PE                      PIC X.
  7008         16  RE-AH-PE                      PIC X.
  7009         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7010         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7011         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7012         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7013         16  RE-PRT-ST                     PIC X.
  7014         16  RE-PRT-OW                     PIC X.
  7015         16  RE-MORT-CODE                  PIC X(4).
  7016         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 129
* EL050.cbl
  7017         16  RE-ZERO-LF-FEE                PIC X.
  7018         16  RE-ZERO-AH-FEE                PIC X.
  7019         16  RE-CEDE-NAME                  PIC X(30).
  7020         16  RE-LF-COMM                    PIC X.
  7021         16  RE-AH-COMM                    PIC X.
  7022         16  RE-LF-TAX                     PIC X.
  7023         16  RE-AH-TAX                     PIC X.
  7024         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7025         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7026         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7027
  7028         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7029             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7030
  7031         16  RE-LF-CEDING-FEE-BRACKETS.
  7032             20  RE-LF-FEE-METHOD          PIC X.
  7033                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7034                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7035                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7036                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7037             20  RE-LF-FEE-BASIS           PIC X.
  7038                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7039                 88  RE-LF-NET-CEDED               VALUE '2'.
  7040                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7041                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7042                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7043                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7044                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7045                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7046             20  FILLER                    PIC XXX.
  7047             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7048                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7049                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7050
  7051         16  RE-AH-CEDING-FEE-BRACKETS.
  7052             20  RE-AH-FEE-METHOD          PIC X.
  7053                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7054                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7055                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7056                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7057             20  RE-AH-FEE-BASIS           PIC X.
  7058                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7059                 88  RE-AH-NET-CEDED               VALUE '2'.
  7060                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7061                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7062                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7063                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7064                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7065                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7066             20  FILLER                    PIC XXX.
  7067             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7068                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7069                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7070
  7071         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7072
  7073         16  RE-OLD-CEDING-STMT            PIC X.
  7074
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 130
* EL050.cbl
  7075         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7076         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7077         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7078         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7079         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7080         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7081         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7082         16  RE-MORT-SW                    PIC X.
  7083         16  RE-CEDING-TYPE-FLAG           PIC X.
  7084             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7085             88  RE-CEDED                          VALUE 'C'.
  7086             88  RE-ASSUMED                        VALUE 'A'.
  7087             88  RE-PHANTOM                        VALUE 'P'.
  7088
  7089         16  RE-CEDING-STMT-OPT-A          PIC X.
  7090             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7091         16  RE-CEDING-STMT-OPT-B          PIC X.
  7092             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7093         16  RE-CEDING-STMT-OPT-C          PIC X.
  7094             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7095         16  RE-CEDING-STMT-OPT-D          PIC X.
  7096             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7097         16  RE-CEDING-STMT-OPT-E          PIC X.
  7098             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7099
  7100         16  RE-PRT-CRSV                   PIC X.
  7101
  7102         16  RE-GL-CENTER                  PIC X(4).
  7103
  7104         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7105
  7106         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7107
  7108         16  RE-EARN-STOP-CODE             PIC X.
  7109             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7110             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7111
  7112         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7113             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7114
  7115         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7116         16  FILLER                        PIC X(2281).
  7117
  7118         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7119
  7120******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 131
* EL050.cbl
  7122*    COPY ERCCTBL.
  7123******************************************************************
  7124*                                                                *
  7125*                                                                *
  7126*                            ERCCTBL                             *
  7127*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7128*                            VMOD=2.003
  7129*                                                                *
  7130*   ONLINE CREDIT SYSTEM                                         *
  7131*                                                                *
  7132*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7133*                                                                *
  7134*   FILE TYPE = VSAM,KSDS                                        *
  7135*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7136*                                                                *
  7137*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7138*       ALTERNATE PATH = NONE                                    *
  7139*                                                                *
  7140*   LOG = NO                                                     *
  7141*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7142*                                                                *
  7143*                                                                *
  7144******************************************************************
  7145
  7146 01  COMM-TABLE-RECORD.
  7147     12  CT-RECORD-ID                      PIC XX.
  7148         88  VALID-CT-ID                      VALUE 'CT'.
  7149
  7150     12  CT-CONTROL-PRIMARY.
  7151         16  CT-COMPANY-CD                 PIC X.
  7152         16  CT-TABLE                      PIC XXX.
  7153         16  CT-CNTRL-2.
  7154             20  CT-BEN-TYPE               PIC X.
  7155             20  CT-BEN-CODE               PIC XX.
  7156
  7157     12  CT-MAINT-INFORMATION.
  7158         16  CT-LAST-MAINT-DT              PIC XX.
  7159         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7160         16  CT-LAST-MAINT-USER            PIC X(4).
  7161         16  FILLER                        PIC X(31).
  7162
  7163     12  CT-LIMITS.
  7164         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7165
  7166         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7167
  7168         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7169
  7170     12  CT-RATES.
  7171         16  CT-RTX          OCCURS 27 TIMES.
  7172             20  CT-RT                     PIC SV9(5)     COMP-3.
  7173             20  CT-RT-R   REDEFINES
  7174                 CT-RT                     PIC XXX.
  7175
  7176     12  FILLER                            PIC  X(42).
  7177
  7178******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 132
* EL050.cbl
  7180*    COPY ERCFORM.
  7181******************************************************************
  7182*                                                                *
  7183*                                                                *
  7184*                            ERCFORM.                            *
  7185*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7186*                            VMOD=2.003                          *
  7187*                                                                *
  7188*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7189*                                                                *
  7190*    FILE TYPE = VSAM,KSDS                                       *
  7191*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7192*                                                                *
  7193*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7194*                                                                *
  7195*    LOG = YES                                                   *
  7196*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7197******************************************************************
  7198 01  FORM-MASTER.
  7199    12  FO-RECORD-ID                 PIC X(02).
  7200        88  VALID-FO-ID                  VALUE 'FO'.
  7201
  7202    12  FO-CONTROL-PRIMARY.
  7203        16  FO-COMPANY-CD            PIC X(01).
  7204        16  FO-STATE                 PIC X(02).
  7205        16  FO-FORM-ID               PIC X(12).
  7206        16  FO-FORM-EXP-DT           PIC X(02).
  7207
  7208    12  FO-POLICY-FORM-DATA.
  7209        16  FO-IND-GRP-CD            PIC X(01).
  7210        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7211        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7212        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7213        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7214        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7215        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7216        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7217        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7218        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7219        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7220        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7221        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7222        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7223        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7224        16  FO-APP-CERT-USE-CD       PIC X(01).
  7225
  7226    12  FILLER                       PIC X(29).
  7227
  7228    12  FO-FORM-PLAN-TABLE.
  7229        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7230            20  FO-PLAN-TYPE         PIC X(01).
  7231            20  FO-PLAN-ID           PIC X(02).
  7232            20  FO-PLAN-TERM         PIC 9(03).
  7233            20  FO-PLAN-REFUND-METHOD
  7234                                     PIC X.
  7235
  7236    12  FILLER                       PIC X(30).
  7237
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 133
* EL050.cbl
  7238    12  FO-COMMENTS-AREA.
  7239        16  FO-COMMENT-LINE-1        PIC X(78).
  7240
  7241    12  FILLER                       PIC X(20).
  7242
  7243    12  FO-MAINT-INFORMATION.
  7244        16  FO-LAST-MAINT-DT         PIC X(02).
  7245        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7246        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 134
* EL050.cbl
  7248*    COPY ELCMSTR.
  7249******************************************************************
  7250*                                                                *
  7251*                            ELCMSTR.                            *
  7252*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7253*                            VMOD=2.012                          *
  7254*                                                                *
  7255*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7256*                                                                *
  7257*   FILE TYPE = VSAM,KSDS                                        *
  7258*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7259*                                                                *
  7260*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7261*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7262*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7263*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7264*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7265*                                                 RKP=75,LEN=21  *
  7266*                                                                *
  7267*   **** NOTE ****                                               *
  7268*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7269*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7270*                                                                *
  7271*   LOG = YES                                                    *
  7272*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7273******************************************************************
  7274*                   C H A N G E   L O G
  7275*
  7276* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7277*-----------------------------------------------------------------
  7278*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7279* EFFECTIVE    NUMBER
  7280*-----------------------------------------------------------------
  7281* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7282* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7283* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7284******************************************************************
  7285 01  CLAIM-MASTER.
  7286     12  CL-RECORD-ID                PIC XX.
  7287         88  VALID-CL-ID         VALUE 'CL'.
  7288
  7289     12  CL-CONTROL-PRIMARY.
  7290         16  CL-COMPANY-CD           PIC X.
  7291         16  CL-CARRIER              PIC X.
  7292         16  CL-CLAIM-NO             PIC X(7).
  7293         16  CL-CERT-NO.
  7294             20  CL-CERT-PRIME       PIC X(10).
  7295             20  CL-CERT-SFX         PIC X.
  7296
  7297     12  CL-CONTROL-BY-NAME.
  7298         16  CL-COMPANY-CD-A1        PIC X.
  7299         16  CL-INSURED-LAST-NAME    PIC X(15).
  7300         16  CL-INSURED-NAME.
  7301             20  CL-INSURED-1ST-NAME PIC X(12).
  7302             20  CL-INSURED-MID-INIT PIC X.
  7303
  7304     12  CL-CONTROL-BY-SSN.
  7305         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 135
* EL050.cbl
  7306         16  CL-SOC-SEC-NO.
  7307             20  CL-SSN-STATE        PIC XX.
  7308             20  CL-SSN-ACCOUNT      PIC X(6).
  7309             20  CL-SSN-LN3          PIC X(3).
  7310
  7311     12  CL-CONTROL-BY-CERT-NO.
  7312         16  CL-COMPANY-CD-A4        PIC X.
  7313         16  CL-CERT-NO-A4.
  7314             20  CL-CERT-A4-PRIME    PIC X(10).
  7315             20  CL-CERT-A4-SFX      PIC X.
  7316
  7317     12  CL-CONTROL-BY-CCN.
  7318         16  CL-COMPANY-CD-A5        PIC X.
  7319         16  CL-CCN-A5.
  7320             20  CL-CCN.
  7321                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7322                 24  CL-CCN-PRIME-A5 PIC X(12).
  7323             20  CL-CCN-FILLER-A5    PIC X(4).
  7324
  7325     12  CL-INSURED-PROFILE-DATA.
  7326         16  CL-INSURED-BIRTH-DT     PIC XX.
  7327         16  CL-INSURED-SEX-CD       PIC X.
  7328             88  INSURED-IS-MALE        VALUE 'M'.
  7329             88  INSURED-IS-FEMALE      VALUE 'F'.
  7330             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7331         16  CL-INSURED-OCC-CD       PIC X(6).
  7332         16  FILLER                  PIC X(5).
  7333
  7334     12  CL-PROCESSING-INFO.
  7335         16  CL-PROCESSOR-ID         PIC X(4).
  7336         16  CL-CLAIM-STATUS         PIC X.
  7337             88  CLAIM-IS-OPEN          VALUE 'O'.
  7338             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7339         16  CL-CLAIM-TYPE           PIC X.
  7340*            88  AH-CLAIM               VALUE 'A'.
  7341*            88  LIFE-CLAIM             VALUE 'L'.
  7342*            88  PROPERTY-CLAIM         VALUE 'P'.
  7343*            88  IUI-CLAIM              VALUE 'I'.
  7344*            88  GAP-CLAIM              VALUE 'G'.
  7345         16  CL-CLAIM-PREM-TYPE      PIC X.
  7346             88  SINGLE-PREMIUM         VALUE '1'.
  7347             88  O-B-COVERAGE           VALUE '2'.
  7348             88  OPEN-END-COVERAGE      VALUE '3'.
  7349         16  CL-INCURRED-DT          PIC XX.
  7350         16  CL-REPORTED-DT          PIC XX.
  7351         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7352         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7353         16  CL-LAST-PMT-DT          PIC XX.
  7354         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7355         16  CL-PAID-THRU-DT         PIC XX.
  7356         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7357         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7358         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7359         16  CL-PMT-CALC-METHOD      PIC X.
  7360             88  CL-360-DAY-YR          VALUE '1'.
  7361             88  CL-365-DAY-YR          VALUE '2'.
  7362             88  CL-FULL-MONTHS         VALUE '3'.
  7363         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 136
* EL050.cbl
  7364
  7365         16  CL-PRIME-CERT-NO.
  7366             20  CL-PRIME-CERT-PRIME PIC X(10).
  7367             20  CL-PRIME-CERT-SFX   PIC X.
  7368
  7369         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7370             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7371             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7372
  7373         16  CL-MICROFILM-NO         PIC X(10).
  7374         16  CL-PROG-FORM-TYPE       PIC X.
  7375         16  CL-LAST-ADD-ON-DT       PIC XX.
  7376
  7377         16  CL-LAST-REOPEN-DT       PIC XX.
  7378         16  CL-LAST-CLOSE-DT        PIC XX.
  7379         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7380             88  FINAL-PAID             VALUE '1'.
  7381             88  CLAIM-DENIED           VALUE '2'.
  7382             88  AUTO-CLOSE             VALUE '3'.
  7383             88  MANUAL-CLOSE           VALUE '4'.
  7384             88  BENEFITS-CHANGED       VALUE 'C'.
  7385             88  SETUP-ERRORS           VALUE 'E'.
  7386         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7387         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7388         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7389             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7390         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7391         16  FILLER                  PIC X.
  7392
  7393     12  CL-CERTIFICATE-DATA.
  7394         16  CL-CERT-ORIGIN          PIC X.
  7395             88  CERT-WAS-ONLINE        VALUE '1'.
  7396             88  CERT-WAS-CREATED       VALUE '2'.
  7397             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7398         16  CL-CERT-KEY-DATA.
  7399             20  CL-CERT-CARRIER     PIC X.
  7400             20  CL-CERT-GROUPING    PIC X(6).
  7401             20  CL-CERT-STATE       PIC XX.
  7402             20  CL-CERT-ACCOUNT.
  7403                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7404                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7405             20  CL-CERT-EFF-DT      PIC XX.
  7406
  7407     12  CL-STATUS-CONTROLS.
  7408         16  CL-PRIORITY-CD          PIC X.
  7409             88  CONFIDENTIAL-DATA      VALUE '8'.
  7410             88  HIGHEST-PRIORITY       VALUE '9'.
  7411         16  CL-SUPV-ATTN-CD         PIC X.
  7412             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7413             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7414         16  CL-PURGED-DT            PIC XX.
  7415         16  CL-RESTORED-DT          PIC XX.
  7416         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7417         16  CL-NEXT-RESEND-DT       PIC XX.
  7418         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7419         16  CL-CRITICAL-PERIOD      PIC 99.
  7420*        16  FILLER                  PIC XX.
  7421         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 137
* EL050.cbl
  7422         16  CL-LAST-MAINT-USER      PIC X(4).
  7423         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7424         16  CL-LAST-MAINT-TYPE      PIC X.
  7425             88  CLAIM-SET-UP           VALUE ' '.
  7426             88  PAYMENT-MADE           VALUE '1'.
  7427             88  LETTER-SENT            VALUE '2'.
  7428             88  MASTER-WAS-ALTERED     VALUE '3'.
  7429             88  MASTER-WAS-RESTORED    VALUE '4'.
  7430             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7431             88  FILE-CONVERTED         VALUE '6'.
  7432             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7433             88  ERROR-CORRECTION       VALUE 'E'.
  7434         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7435         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7436         16  CL-BENEFICIARY          PIC X(10).
  7437         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7438         16  CL-DENIAL-TYPE          PIC X.
  7439             88  CL-TYPE-DENIAL          VALUE '1'.
  7440             88  CL-TYPE-RESCISSION      VALUE '2'.
  7441             88  CL-TYPE-REFORMATION     VALUE '3'.
  7442             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7443             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7444         16  CL-CRIT-PER-RECURRENT   PIC X.
  7445         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7446         16  CL-RTW-DT               PIC XX.
  7447
  7448     12  CL-TRAILER-CONTROLS.
  7449         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7450             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7451             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7452             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7453         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7454         16  FILLER                  PIC XX.
  7455         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7456         16  CL-ADDRESS-TRAILER-CNT.
  7457             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7458                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7459             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7460                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7461             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7462                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7463             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7464                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7465             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7466                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7467             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7468                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7469             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7470                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7471
  7472     12  CL-CV-REFERENCE-NO.
  7473         16  CL-CV-REFNO-PRIME       PIC X(18).
  7474         16  CL-CV-REFNO-SFX         PIC XX.
  7475
  7476     12  CL-FILE-LOCATION            PIC X(4).
  7477
  7478     12  CL-PROCESS-ERRORS.
  7479         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 138
* EL050.cbl
  7480             88  NO-FATAL-ERRORS        VALUE ZERO.
  7481         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7482             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7483
  7484     12  CL-PRODUCT-CD               PIC X.
  7485
  7486     12  CL-CURRENT-KEY-DATA.
  7487         16  CL-CURRENT-CARRIER      PIC X.
  7488         16  CL-CURRENT-GROUPING     PIC X(6).
  7489         16  CL-CURRENT-STATE        PIC XX.
  7490         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7491
  7492     12  CL-ASSOCIATES               PIC X.
  7493         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7494         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7495         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7496         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7497
  7498     12  CL-ACTIVITY-CODE            PIC 99.
  7499     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7500     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7501
  7502     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7503     12  CL-LAG-REPORT-CODE          PIC 9.
  7504     12  CL-LOAN-TYPE                PIC XX.
  7505     12  CL-LEGAL-STATE              PIC XX.
  7506
  7507     12  CL-YESNOSW                  PIC X.
  7508     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7509         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7510         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7511         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7512     12  cl-insured-claim            pic x.
  7513         88  cl-claim-on-primary         value 'P'.
  7514         88  cl-claim-on-secondary       value 'S'.
  7515     12  cl-benefit-expiration-dt    PIC XX.
  7516
  7517 01  PLAN-RECORDS.
  7518     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7519     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7520
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 139
* EL050.cbl
  7522 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7523                          ACCOUNT-MASTER REINSURANCE-RECORD
  7524                          COMM-TABLE-RECORD FORM-MASTER
  7525                          CLAIM-MASTER PLAN-RECORDS.
  7526 0000-DFHEXIT SECTION.
  7527     MOVE '9#                    $   ' TO DFHEIV0.
  7528     MOVE 'EL050' TO DFHEIV1.
  7529     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7530
  7531     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7532
  7533
  7534* EXEC CICS  HANDLE CONDITION
  7535*           ERROR    (9300-ABEND)
  7536*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7537*    END-EXEC.
  7538*    MOVE '"$.J                  ! " #00007529' TO DFHEIV0
  7539     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7541     MOVE X'2220233030303037353239' TO DFHEIV0(25:11)
  7542     CALL 'kxdfhei1' USING DFHEIV0
  7543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7544
  7545
  7546 0000-COPY-PROCEDURE-DIV.
  7547*                          COPY ELC50PD.
  7548******************************************************************
  7549*                                                                *
  7550*                            ELC50PD                             *
  7551*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7552*                            VMOD=2.188                          *
  7553*                                                                *
  7554******************************************************************
  7555*                   C H A N G E   L O G
  7556*
  7557* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7558*-----------------------------------------------------------------
  7559*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7560* EFFECTIVE    NUMBER
  7561*-----------------------------------------------------------------
  7562* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7563* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7564* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7565*                             2709 AND 2718
  7566* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7567* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7568* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7569* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7570* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7571*                                IS OPEN OR CNC DT < PD THRU
  7572* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7573* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7574* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7575* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7576* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7577* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7578* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7579* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 140
* EL050.cbl
  7580* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7581* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7582* 020906                   PEMA  EXPAND LOAN OFFICER
  7583* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7584* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7585* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7586* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7587* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7588* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7589* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7590* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7591* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7592* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7593* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7594* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7595* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7596* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7597* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7598* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7599* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7600* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7601* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7602* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7603* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7604* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7605* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7606* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7607* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7608*                                UPDATE VIN ON CERT TRAILER
  7609* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7610* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7611* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7612* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7613* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7614* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7615* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7616* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7617* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7618* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7619* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7620* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7621* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7622* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7623* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7624* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7625* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7626* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7627* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7628* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7629* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7630* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7631* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7632* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7633* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7634* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7635* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7636* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7637* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 141
* EL050.cbl
  7638* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7639* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7640* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7641* 032912  CR2011110200001  PEMA  AHL CHANGES
  7642* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7643* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7644* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7645* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7646* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7647* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7648* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7649* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7650* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7651* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7652* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7653* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7654* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7655* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7656* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7657* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7658* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7659******************************************************************
  7660************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7661******************************************************************
  7662
  7663     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7664
  7665     MOVE SPACES                 TO PB-FATAL-FLAG
  7666                                    PB-FORCE-ER-CD
  7667                                    PB-WARN-ER-CD
  7668                                    PB-OUT-BAL-CD.
  7669
  7670     MOVE SPACE                  TO WS-IG-OVRD-AH
  7671                                    WS-IG-OVRD-LF
  7672                                    WS-IG-OVRD-AM
  7673                                    WS-IG-OVRD
  7674                                    WS-IG-OVRD-AH-PL
  7675                                    WS-IG-OVRD-LF-PL
  7676                                    WS-IG-OVRD-AH-BEN
  7677                                    WS-IG-OVRD-LF-BEN.
  7678
  7679******************************************************************
  7680*************       INITIALIZE COMMON ERRORS       ***************
  7681******************************************************************
  7682
  7683     MOVE +0                     TO PB-NO-OF-ERRORS.
  7684     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7685
  7686******************************************************************
  7687
  7688     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7689     SET JULIAN-TO-BIN           TO TRUE.
  7690*    MOVE 5                      TO DC-OPTION-CODE.
  7691     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7692     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7693
  7694     MOVE ZERO                   TO  SUB4.
  7695
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 142
* EL050.cbl
  7696 0040-INITIALIZE-GA-BILL-DT.
  7697
  7698     ADD +1                      TO  SUB4.
  7699
  7700     IF  SUB4 GREATER THAN +5
  7701         GO TO 0050-CHECK-CNTL-FOUND.
  7702
  7703     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7704         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7705
  7706     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7707
  7708 0050-CHECK-CNTL-FOUND.
  7709
  7710     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7711        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7712                                         WS-AH-REM-TERM-CALC
  7713                                         EC-CO-REM-TERM-CALC
  7714        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7715        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7716        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7717                                         WS-TOL-AH-CLAIM
  7718        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7719                                         WS-TOL-AH-PREM
  7720                                         EC-CO-TOL-PREM
  7721        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7722                                         WS-TOL-AH-REFUND
  7723                                         EC-CO-TOL-REFUND
  7724        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7725                                         WS-AH-REFUND-OVS-AMT
  7726                                         EC-CO-OVR-SHT-AMT
  7727        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7728                                         WS-TOL-AH-PREM-PCT
  7729                                         EC-CO-TOL-PREM-PCT
  7730        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7731                                         WS-TOL-AH-REFUND-PCT
  7732                                         EC-CO-TOL-REFUND-PCT
  7733        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7734                                         WS-AH-REFUND-OVS-PCT
  7735                                         EC-CO-OVR-SHT-PCT
  7736        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7737        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7738        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7739        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7740        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7741        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7742        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7743        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7744        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7745        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7746        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7747        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7748                                         EC-CO-MONTH-END-DT
  7749        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7750          GO TO 0100-READ-ACCT.
  7751
  7752     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7753     MOVE SPACES                 TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 143
* EL050.cbl
  7754     MOVE '1'                    TO CNTL-REC-TYPE.
  7755     MOVE +0                     TO CNTL-SEQ-NO.
  7756
  7757     MOVE '1' TO RC-SW-1.
  7758     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7759     IF NOT CF-COMPANY-MASTER
  7760         MOVE ZEROS             TO WK-CO-TOL-PREM
  7761                                   WK-CO-TOL-CLAIM
  7762                                   WK-CO-TOL-REFUND
  7763                                   WK-REFUND-OVS-AMT
  7764                                   WK-REFUND-OVS-PCT
  7765                                   WK-CO-TOL-PREM-PCT
  7766                                   WK-CO-TOL-REFUND-PCT
  7767                                   WK-DEFAULT-APR
  7768                                   WK-CO-MAX-CAP
  7769        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7770                                   WK-CR-R78-METHOD
  7771                                   WK-CO-REF-REJECT-SW
  7772                                   WK-CO-PREM-REJECT-SW
  7773                                   WK-REM-TRM-CALC-OPTION
  7774                                   WK-BIRTH-DATE-INPUT
  7775                                   WK-JOINT-AGE-INPUT
  7776        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7777        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7778        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7779        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7780          GO TO 0099-COMPANY-NOT-FOUND.
  7781
  7782     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7783        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7784     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7785        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7786     IF CF-CO-TOL-CAP NOT NUMERIC
  7787        MOVE +0                    TO CF-CO-TOL-CAP.
  7788     IF CF-DEFAULT-APR NOT NUMERIC
  7789        MOVE +0                    TO CF-DEFAULT-APR.
  7790
  7791     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7792     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7793     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7794     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7795     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7796     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7797     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7798     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7799     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7800     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7801     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7802     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7803
  7804     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7805          CF-CO-OVR-SHT-AMT > +0
  7806        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7807
  7808     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7809          CF-CO-OVR-SHT-PCT > +0
  7810        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7811
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 144
* EL050.cbl
  7812     IF CF-VALID-REM-TRM-OPTION
  7813         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7814     ELSE
  7815         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7816
  7817     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7818     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7819     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7820     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7821
  7822     GO TO 0050-CHECK-CNTL-FOUND.
  7823
  7824 0099-COMPANY-NOT-FOUND.
  7825
  7826     MOVE ER-2616                TO WS-ERROR.
  7827     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7828
  7829 0100-READ-ACCT.
  7830
  7831     MOVE SPACES                 TO DATE-RANGE-SW.
  7832
  7833     IF WK-ACCT-ADDR = ZEROS
  7834        GO TO 0102-ACCT-GETMAIN.
  7835
  7836     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7837     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7838     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7839
  7840     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7841        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7842        GO TO 0105-READ-ACCT
  7843     END-IF
  7844
  7845     IF PB-CARRIER NOT = SPACES
  7846        IF PB-CARRIER NOT = AM-VG-CARRIER
  7847           GO TO 0105-READ-ACCT.
  7848
  7849     IF PB-STATE NOT = SPACES
  7850        IF PB-STATE NOT = AM-VG-STATE
  7851           GO TO 0105-READ-ACCT.
  7852
  7853     IF PB-GROUPING NOT = SPACES
  7854        IF PB-GROUPING NOT = AM-VG-GROUPING
  7855           GO TO 0105-READ-ACCT.
  7856
  7857     MOVE 'X'                 TO DATE-RANGE-SW.
  7858
  7859     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7860        MOVE 'X'                 TO DATE-RANGE-SW
  7861        GO TO 0105-READ-ACCT.
  7862
  7863     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7864        GO TO 0105-READ-ACCT.
  7865
  7866     GO TO 0180-ACCOUNT-FOUND.
  7867
  7868 0102-ACCT-GETMAIN.
  7869     PERFORM 8560-GETMAIN THRU 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 145
* EL050.cbl
  7870     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7871
  7872 0105-READ-ACCT.
  7873     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7874     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7875     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7876     MOVE PB-STATE               TO ACCT-STATE.
  7877     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7878     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7879
  7880     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7881
  7882     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7883
  7884 0110-FIND-ACCT-TOLERANCES-LOOP.
  7885     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7886
  7887     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7888        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7889        GO TO 0199-ACCT-NOT-FOUND
  7890     END-IF
  7891     IF PB-CARRIER NOT = SPACES
  7892        IF PB-CARRIER NOT = AM-VG-CARRIER
  7893           GO TO 0199-ACCT-NOT-FOUND.
  7894
  7895     IF PB-STATE NOT = SPACES
  7896        IF PB-STATE NOT = AM-VG-STATE
  7897           GO TO 0199-ACCT-NOT-FOUND.
  7898
  7899     IF PB-GROUPING NOT = SPACES
  7900        IF PB-GROUPING NOT = AM-VG-GROUPING
  7901           GO TO 0199-ACCT-NOT-FOUND.
  7902
  7903     MOVE 'X'                    TO DATE-RANGE-SW.
  7904
  7905     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7906        MOVE 'X'                 TO DATE-RANGE-SW
  7907        GO TO 0199-ACCT-NOT-FOUND.
  7908
  7909     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7910        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7911
  7912 0180-ACCOUNT-FOUND.
  7913     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7914     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7915     MOVE AM-STATE               TO PB-SV-STATE.
  7916     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7917
  7918     IF AM-CANCEL-FEE  NOT NUMERIC
  7919        MOVE ZEROS TO AM-CANCEL-FEE.
  7920
  7921     IF AM-MAX-MON-BEN NOT NUMERIC
  7922        MOVE ZEROS TO AM-MAX-MON-BEN.
  7923
  7924     IF AM-MAX-TOT-BEN NOT NUMERIC
  7925        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7926
  7927     IF AM-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 146
* EL050.cbl
  7928        MOVE +0                  TO AM-CLP-TOL-PCT
  7929     END-IF
  7930     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7931        MOVE +0                  TO AM-SPP-LEASE-COMM
  7932     END-IF
  7933     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7934        MOVE ER-2611             TO   WS-ERROR
  7935        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7936
  7937     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7938        MOVE ER-2621             TO   WS-ERROR
  7939        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7940
  7941     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7942        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7943        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7944        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7945         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7946
  7947     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7948     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7949     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  7950     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7951     IF AM-CLP-TOL-PCT NOT = ZEROS
  7952        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7953     END-IF
  7954     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7955        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7956     END-IF
  7957*    IF PB-COMPANY-ID = 'DCC'
  7958*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7959*                                   WS-ADMIN-FEES
  7960*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7961*          (SUB5 > +10)
  7962*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7963*             AND (AM-A-COM (SUB5) NUMERIC)
  7964*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7965*                + (AM-A-COM (SUB5) * 1000)
  7966*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7967*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7968*                + (AM-A-COM (SUB5) * 1000)
  7969*             END-IF
  7970*             IF AM-COM-TYP (SUB5) = 'N'
  7971*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7972*                + (AM-A-COM (SUB5) * 1000)
  7973*             END-IF
  7974*          END-IF
  7975*       END-PERFORM
  7976*    END-IF
  7977     IF (PB-COMPANY-ID = 'DCC')
  7978        AND (PB-ISSUE)
  7979        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7980        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7981           (SUB5 > +10)
  7982           MOVE +0 TO WS-WK-RATE
  7983           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7984              IF (AM-A-COM (SUB5) NUMERIC)
  7985                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 147
* EL050.cbl
  7986                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7987              ELSE
  7988                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7989                 IF PB-ISSUE
  7990                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7991                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7992                 ELSE
  7993                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7994                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7995                 END-IF
  7996                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7997                 MOVE ZEROS             TO WS-SUB1
  7998                                           WS-COMMISSION
  7999                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8000                 MOVE '0530'               TO CTBL-SW
  8001                 MOVE ' '                  TO WS-CTBL-READ-SW
  8002                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8003                 IF FIRST-TIME-THROUGH
  8004                    MOVE 'AA'              TO CTBL-BEN-CODE
  8005                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8006                 END-IF
  8007                 IF CTBL-TABLE-FOUND
  8008                    IF PB-ISSUE
  8009                       COMPUTE WS-COMM-CK-AMT =
  8010                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8011                    ELSE
  8012                       COMPUTE WS-COMM-CK-AMT =
  8013                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8014                    END-IF
  8015                    PERFORM 8800-GET-COMP-RATE
  8016                              THRU 8800-EXIT
  8017                 END-IF
  8018              END-IF
  8019              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8020                + (WS-WK-RATE * 1000)
  8021           END-IF
  8022        END-PERFORM
  8023     END-IF
  8024     IF PB-COMPANY-ID EQUAL 'CRI'
  8025         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8026
  8027     IF PB-COMPANY-ID EQUAL 'NCL'
  8028         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8029     END-IF
  8030
  8031     GO TO 0200-READ-CERT.
  8032
  8033 0199-ACCT-NOT-FOUND.
  8034
  8035     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8036
  8037     IF DATE-RANGE-SW NOT = SPACES
  8038        MOVE ER-2601             TO WS-ERROR
  8039        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8040     ELSE
  8041        MOVE ER-2619             TO WS-ERROR
  8042        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8043
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 148
* EL050.cbl
  8044     GO TO 9990-RETURN.
  8045
  8046 0200-READ-CERT.
  8047
  8048     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8049     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8050     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8051     MOVE PB-SV-STATE            TO CERT-STATE.
  8052     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8053     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8054     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8055
  8056     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8057
  8058     IF CERT-WAS-NOT-FOUND
  8059        GO TO 0299-CERT-NOT-FOUND.
  8060
  8061     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8062        MOVE ER-2759             TO WS-ERROR
  8063        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8064        GO TO 0298-UNLOCK-RETURN.
  8065
  8066     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8067         MOVE ER-2758            TO WS-ERROR
  8068         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8069         GO TO 0298-UNLOCK-RETURN.
  8070
  8071     IF PB-ISSUE
  8072        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8073           IF CERT-WAS-CREATED-FOR-CLAIM
  8074              NEXT SENTENCE
  8075            ELSE
  8076              MOVE ER-2626       TO WS-ERROR
  8077              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8078              GO TO 0298-UNLOCK-RETURN.
  8079
  8080     IF NOT PB-CANCELLATION
  8081        GO TO 0300-CONTINUE-EDIT.
  8082
  8083     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8084     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8085     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8086     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8087     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8088     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8089
  8090     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8091     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8092     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8093     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8094     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8095     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8096     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8097     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8098     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8099
  8100     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8101     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 149
* EL050.cbl
  8102     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8103     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8104     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8105     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8106     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8107
  8108     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8109     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8110
  8111     MOVE CM-CREDIT-INTERFACE-SW-1
  8112                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8113     MOVE CM-CREDIT-INTERFACE-SW-2
  8114                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8115
  8116     IF CM-O-B-COVERAGE
  8117         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8118
  8119     IF CM-LIVES NOT NUMERIC
  8120         MOVE ZERO                TO CM-LIVES.
  8121
  8122     IF CM-BILLED NOT NUMERIC
  8123         MOVE ZERO                TO CM-BILLED.
  8124
  8125     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8126         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8127         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8128         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8129         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8130         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8131         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8132         MOVE CM-LIVES             TO PB-CI-LIVES
  8133*The next line causes a problem with my change  I dont think it is
  8134*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8135
  8136     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8137     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8138     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8139     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8140     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8141     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8142
  8143     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8144     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8145     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8146     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8147
  8148     IF CM-LIFE-COMM-PCT NUMERIC
  8149         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8150     ELSE
  8151         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8152
  8153     IF CM-AH-COMM-PCT NUMERIC
  8154         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8155     ELSE
  8156         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8157
  8158     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8159
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 150
* EL050.cbl
  8160     IF CM-LOAN-APR       NOT NUMERIC
  8161           MOVE ZERO               TO CM-LOAN-APR.
  8162
  8163     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8164           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8165
  8166     IF CM-LOAN-TERM      NOT NUMERIC
  8167           MOVE ZERO               TO CM-LOAN-TERM.
  8168
  8169     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8170           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8171
  8172     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8173           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8174
  8175     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8176     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8177     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8178     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8179     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8180     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8181     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8182     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8183     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8184     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8185     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8186     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8187
  8188     IF CM-STATE = CM-SSN-STATE
  8189         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8190
  8191     IF CM-STATE NOT = CM-MEMB-STATE
  8192         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8193
  8194     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8195
  8196     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8197        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8198        IF CM-ADDL-CLP NOT NUMERIC
  8199           MOVE +0               TO CM-ADDL-CLP
  8200        END-IF
  8201        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8202        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8203           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8204        END-IF
  8205     END-IF
  8206     IF PB-COMPANY-ID = 'DCC'
  8207        MOVE +0                  TO WS-ADMIN-FEES
  8208                                    WS-CSO-ADMIN-FEE
  8209                                    WS-COMM-AND-MFEE
  8210                                    WS-1ST-YR-ALLOW
  8211        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8212           (SUB5 > +10)
  8213           MOVE +0 TO WS-WK-RATE
  8214           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8215              IF (AM-A-COM (SUB5) NUMERIC)
  8216                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8217                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 151
* EL050.cbl
  8218              ELSE
  8219                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8220                 IF PB-ISSUE
  8221                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8222                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8223                 ELSE
  8224                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8225                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8226                 END-IF
  8227                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8228                 MOVE ZEROS             TO WS-SUB1
  8229                                           WS-COMMISSION
  8230                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8231                 MOVE '0530'               TO CTBL-SW
  8232                 MOVE ' '                  TO WS-CTBL-READ-SW
  8233                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8234                 IF FIRST-TIME-THROUGH
  8235                    MOVE 'AA'              TO CTBL-BEN-CODE
  8236                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8237                 END-IF
  8238                 IF CTBL-TABLE-FOUND
  8239                    IF PB-ISSUE
  8240                       COMPUTE WS-COMM-CK-AMT =
  8241                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8242                    ELSE
  8243                       COMPUTE WS-COMM-CK-AMT =
  8244                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8245                    END-IF
  8246                    PERFORM 8800-GET-COMP-RATE
  8247                              THRU 8800-EXIT
  8248                 END-IF
  8249              END-IF
  8250              IF AM-COM-TYP (SUB5) = 'I'
  8251                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8252                   + (WS-WK-RATE * 1000)
  8253              END-IF
  8254              IF AM-COM-TYP (SUB5) = 'N'
  8255                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8256                   + (WS-WK-RATE * 1000)
  8257              END-IF
  8258              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8259                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8260                   + (WS-WK-RATE * 1000)
  8261              END-IF
  8262              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8263                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8264                   + (WS-WK-RATE * 1000)
  8265              END-IF
  8266           END-IF
  8267        END-PERFORM
  8268     END-IF
  8269     GO TO 0300-CONTINUE-EDIT.
  8270
  8271 0298-UNLOCK-RETURN.
  8272      PERFORM 9250-UNLOCK-RETURN
  8273      GO TO 9990-RETURN.
  8274
  8275 0299-CERT-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 152
* EL050.cbl
  8276
  8277     MOVE '1'                     TO CERT-STATUS-SW.
  8278
  8279     IF PB-COMPANY-ID = 'UCL'
  8280         IF WS-ERROR = ER-2799
  8281             GO TO 3000-CONTINUE-EDIT.
  8282
  8283     IF NOT PB-CANCELLATION
  8284         GO TO 0300-CONTINUE-EDIT.
  8285
  8286     MOVE ER-2726                  TO  WS-ERROR.
  8287     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8288     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8289     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8290                                    PB-CI-LF-TERM
  8291                                    PB-C-LF-REM-TERM
  8292                                    PB-CI-AH-TERM
  8293                                    PB-C-AH-REM-TERM
  8294                                    PB-CI-LF-BENEFIT-CD
  8295                                    PB-CI-LF-BENEFIT-AMT
  8296                                    PB-CI-LF-ALT-BENEFIT-AMT
  8297                                    PB-CI-LF-PREMIUM-AMT
  8298                                    PB-CI-LF-ALT-PREMIUM-AMT
  8299                                    PB-CI-AH-BENEFIT-CD
  8300                                    PB-CI-AH-BENEFIT-AMT
  8301                                    PB-CI-AH-PREMIUM-AMT
  8302                                    PB-CI-PAY-FREQUENCY
  8303                                    PB-CI-LOAN-APR
  8304                                    PB-CI-LOAN-TERM
  8305                                    PB-CI-LIFE-COMMISSION
  8306                                    PB-CI-AH-COMMISSION
  8307                                    PB-CI-CURR-SEQ
  8308                                    PB-CI-AH-CANCEL-AMT
  8309                                    PB-CI-LF-CANCEL-AMT
  8310                                    PB-CI-RATE-DEV-PCT-LF
  8311                                    PB-CI-RATE-DEV-PCT-AH
  8312                                    PB-CI-EXTENTION-DAYS
  8313                                    PB-CI-TERM-IN-DAYS
  8314                                    PB-CI-LIVES
  8315                                    PB-CI-LF-CRIT-PER
  8316                                    PB-CI-AH-CRIT-PER
  8317                                    PB-CI-ADDL-CLP
  8318                                    PB-CI-DDF-IU-RATE-UP.
  8319
  8320     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8321                                    PB-CI-AH-SETTLEMENT-DT
  8322                                    PB-CI-DEATH-DT
  8323                                    PB-CI-LF-PRIOR-CANCEL-DT
  8324                                    PB-CI-AH-PRIOR-CANCEL-DT
  8325                                    PB-CI-ENTRY-DT
  8326                                    PB-CI-LF-EXPIRE-DT
  8327                                    PB-CI-AH-EXPIRE-DT
  8328                                    PB-CI-LOAN-1ST-PMT-DT.
  8329
  8330     IF ACCOUNT-MAST-FOUND
  8331        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8332        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8333
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 153
* EL050.cbl
  8334     GO TO 3000-CONTINUE-EDIT.
  8335
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 154
* EL050.cbl
  8337
  8338 0300-CONTINUE-EDIT.
  8339
  8340     IF PB-ISSUE
  8341        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8342            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8343
  8344     IF PB-ISSUE
  8345        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8346            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8347
  8348     IF PB-ISSUE
  8349       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8350          (AM-NO-AH-ONLY)
  8351           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8352               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8353                   MOVE ER-2679 TO WS-ERROR
  8354                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8355
  8356     IF PB-ISSUE
  8357        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8358        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8359        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8360     ELSE
  8361        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8362        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8363        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8364
  8365     MOVE 'N'                    TO PLAN-MASTER-SW
  8366                                    PLAN-MASTER-LIFE-SW
  8367                                    FORM-MASTER-SW
  8368                                    WS-APP-CERT-SW.
  8369
  8370     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8371                                    WS-PL-TOL-LF-REFUND
  8372                                    WS-PL-REF-OVS-AMT
  8373                                    WS-PL-TOL-LF-PREM-PCT
  8374                                    WS-PL-TOL-LF-REFUND-PCT
  8375                                    WS-PL-REF-OVS-PCT
  8376                                    WS-PL-TOL-LF-CLAIM.
  8377
  8378     IF PB-COMPANY-ID = 'NCL'
  8379       IF PB-ISSUE
  8380         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8381             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8382             IF FORM-MASTER-FOUND
  8383                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8384
  8385     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8386        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8387
  8388********************** MON CODE **********************
  8389     IF PB-COMPANY-ID = 'MON'
  8390     IF PB-ISSUE
  8391     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8392        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8393             PB-I-LOAN-APR = ZERO)
  8394               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 155
* EL050.cbl
  8395******************************************************
  8396
  8397     IF PB-COMPANY-ID = 'NCL'
  8398       IF PB-ISSUE
  8399           IF FORM-MASTER-FOUND
  8400             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8401                AM-DISMBR-COVERAGE
  8402                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8403                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8404                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8405                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8406                                           PB-I-LIFE-BENEFIT-CD.
  8407
  8408     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8409
  8410     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8411         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8412         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8413         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8414         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8415         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8416           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8417             GO TO 0301-LIFE-BENEFIT-SEARCH
  8418         ELSE
  8419             NEXT SENTENCE
  8420     ELSE
  8421         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8422
  8423     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8424     MOVE '4'                    TO CNTL-REC-TYPE.
  8425     MOVE +0                     TO CNTL-SEQ-NO.
  8426     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8427
  8428     MOVE '1' TO RC-SW-2.
  8429     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8430
  8431     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8432        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8433         GO TO 0305-BENEFIT-NOT-FOUND.
  8434
  8435     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8436
  8437 0301-LIFE-BENEFIT-SEARCH.
  8438
  8439     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8440
  8441     IF NO-BENEFIT-FOUND
  8442        GO TO 0305-BENEFIT-NOT-FOUND.
  8443
  8444     IF WS-BEN-CD = '99'
  8445        GO TO 0305-BENEFIT-NOT-FOUND.
  8446
  8447     IF PB-COMPANY-ID = 'NCL'
  8448         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8449             GO TO 0304-LIFE-BENEFIT-FOUND.
  8450
  8451     MOVE +1                     TO SUB5.
  8452     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 156
* EL050.cbl
  8453
  8454* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8455* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8456     IF PB-COMPANY-ID = 'DMD'
  8457         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8458
  8459 0302-EDIT-ACCT-LF-BENEFITS.
  8460
  8461     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8462        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8463           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8464                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8465           GO TO 03XX-GET-LIFE-ERPLAN.
  8466
  8467     IF SUB5 LESS THAN +20
  8468        ADD +1                   TO SUB5
  8469        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8470
  8471     MOVE +1                     TO SUB5.
  8472
  8473     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8474        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8475
  8476 0303-EDIT-DMD-EXTRA-BENEFITS.
  8477
  8478     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8479        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8480           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8481                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8482           GO TO 03XX-GET-LIFE-ERPLAN.
  8483
  8484     IF SUB5 LESS THAN +30
  8485        ADD +1                   TO SUB5
  8486        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8487
  8488     MOVE +1                     TO SUB5.
  8489
  8490 03XX-EDIT-FOR-NINETY-LF.
  8491
  8492***************************************************************
  8493*                                                             *
  8494*    NINETY BENEFIT PLAN TYPES:                               *
  8495*                                                             *
  8496*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8497*      92 = ALL GROUP REDUCING BENEFITS                       *
  8498*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8499*      94 = ALL GROUP LEVEL BENEFITS                          *
  8500*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8501*           BENEFIT CONTROLS.                                 *
  8502*      99 = ALL BENEFITS                                      *
  8503*                                                             *
  8504***************************************************************
  8505
  8506     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8507                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8508
  8509     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8510       AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 157
* EL050.cbl
  8511        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8512        GO TO 03XX-GET-LIFE-ERPLAN.
  8513
  8514     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8515       AND
  8516        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8517        IF CF-REDUCING (SUB3)
  8518           IF (PB-I-INDV-GRP-OVRD = 'I')
  8519              OR
  8520           ((AM-IG = '1') AND
  8521           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8522              OR
  8523           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8524           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8525           (AM-IG NOT = '2'))
  8526              GO TO 03XX-GET-LIFE-ERPLAN.
  8527
  8528     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8529       AND
  8530        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8531        IF CF-REDUCING (SUB3)
  8532           IF (PB-I-INDV-GRP-OVRD = 'G')
  8533              OR
  8534           ((AM-IG = '2') AND
  8535           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8536              OR
  8537           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8538           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8539           (AM-IG NOT = '1'))
  8540              GO TO 03XX-GET-LIFE-ERPLAN.
  8541
  8542     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8543       AND
  8544        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8545        IF CF-LEVEL    (SUB3)
  8546           IF (PB-I-INDV-GRP-OVRD = 'I')
  8547              OR
  8548           ((AM-IG = '1') AND
  8549           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8550              OR
  8551           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8552           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8553            (AM-IG NOT = '2'))
  8554              GO TO 03XX-GET-LIFE-ERPLAN.
  8555
  8556     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8557       AND
  8558        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8559        IF CF-LEVEL    (SUB3)
  8560           IF (PB-I-INDV-GRP-OVRD = 'G')
  8561              OR
  8562           ((AM-IG = '2') AND
  8563           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8564              OR
  8565           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8566           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8567           (AM-IG NOT = '1'))
  8568              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 158
* EL050.cbl
  8569
  8570     IF SUB5 LESS THAN +20
  8571        ADD +1                   TO SUB5
  8572        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8573
  8574     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8575
  8576     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8577        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8578
  8579     MOVE +1                     TO SUB5.
  8580
  8581 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8582
  8583     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8584                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8585
  8586     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8587       AND
  8588        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8589        GO TO 03XX-GET-LIFE-ERPLAN.
  8590
  8591     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8592       AND
  8593        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8594        IF CF-REDUCING (SUB3)
  8595           IF (PB-I-INDV-GRP-OVRD = 'I')
  8596              OR
  8597           ((AM-IG = '1') AND
  8598           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8599              OR
  8600           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8601           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8602           (AM-IG NOT = '2'))
  8603              GO TO 03XX-GET-LIFE-ERPLAN.
  8604
  8605     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8606       AND
  8607        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8608        IF CF-REDUCING (SUB3)
  8609           IF (PB-I-INDV-GRP-OVRD = 'G')
  8610              OR
  8611           ((AM-IG = '2') AND
  8612           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8613              OR
  8614           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8615           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8616           (AM-IG NOT = '1'))
  8617              GO TO 03XX-GET-LIFE-ERPLAN.
  8618
  8619     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8620       AND
  8621        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8622        IF CF-LEVEL    (SUB3)
  8623           IF (PB-I-INDV-GRP-OVRD = 'I')
  8624              OR
  8625           ((AM-IG = '1') AND
  8626           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 159
* EL050.cbl
  8627              OR
  8628           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8629           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8630            (AM-IG NOT = '2'))
  8631              GO TO 03XX-GET-LIFE-ERPLAN.
  8632
  8633     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8634       AND
  8635        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8636        IF CF-LEVEL    (SUB3)
  8637           IF (PB-I-INDV-GRP-OVRD = 'G')
  8638              OR
  8639           ((AM-IG = '2') AND
  8640           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8641              OR
  8642           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8643           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8644           (AM-IG NOT = '1'))
  8645              GO TO 03XX-GET-LIFE-ERPLAN.
  8646
  8647     IF SUB5 LESS THAN +30
  8648        ADD +1                   TO SUB5
  8649        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8650
  8651     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8652
  8653 03XX-EDIT-FOR-NINETY-LF-CONT.
  8654
  8655     MOVE +99                    TO SUB5.
  8656
  8657     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8658        IF PB-ISSUE
  8659           MOVE ER-1924          TO  WS-ERROR
  8660           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8661
  8662     GO TO 0304-LIFE-BENEFIT-FOUND.
  8663
  8664 03XX-GET-LIFE-ERPLAN.
  8665
  8666     IF WK-PLAN-ADDR EQUAL +0
  8667        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8668
  8669     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8670     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8671     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8672     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8673     MOVE 'Y'                    TO PLAN-MASTER-SW
  8674                                    PLAN-MASTER-LIFE-SW.
  8675     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8676
  8677 03XX-ERPLAN-LIFE-GETMAIN.
  8678
  8679     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8680     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8681
  8682 03XX-ERPLAN-LIFE-READ.
  8683
  8684     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 160
* EL050.cbl
  8685     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8686     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8687     MOVE PB-SV-STATE            TO PLAN-STATE.
  8688     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8689     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8690     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8691     MOVE WS-SAVE-BENEFIT-REVISION
  8692                                 TO PLAN-REVISION-NO.
  8693
  8694     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8695     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8696
  8697     IF PB-COMPANY-ID = 'NCL'
  8698       IF NOT LF-PLAN-MASTER-FOUND
  8699         IF NOT PB-POLICY-IS-DECLINED  AND
  8700            NOT PB-POLICY-IS-VOIDED
  8701             MOVE  ER-1921         TO  WS-ERROR
  8702             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8703             GO TO 0304-LIFE-BENEFIT-FOUND.
  8704
  8705     IF NOT LF-PLAN-MASTER-FOUND
  8706        GO TO 0304-LIFE-BENEFIT-FOUND.
  8707
  8708 XXXX-CHECK-LF-PLAN-KEY.
  8709
  8710     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8711        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8712        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8713        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8714        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8715        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8716        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8717        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8718        MOVE 'N'                 TO PLAN-MASTER-SW
  8719          GO TO 03XX-ERPLAN-LIFE-READ.
  8720
  8721     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8722
  8723     IF  PB-CANCELLATION
  8724         GO TO  0303-LF-ACCT-BEN-FOUND.
  8725
  8726     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8727        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8728           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8729           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8730              MOVE ER-2644             TO WS-ERROR
  8731              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8732           ELSE
  8733              NEXT SENTENCE
  8734        ELSE
  8735           IF PB-COMPANY-ID NOT = 'NCL'
  8736              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8737                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8738
  8739 0303-LF-ACCT-BEN-FOUND.
  8740
  8741     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8742
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 161
* EL050.cbl
  8743     IF PL-DEV-CODE NOT = SPACES
  8744        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8745
  8746     IF PL-DEV-PCT NUMERIC AND
  8747        PL-DEV-PCT NOT = ZEROS
  8748        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8749
  8750     IF PL-TOL-PREM-AMT GREATER THAN +0
  8751        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8752
  8753     IF PL-TOL-REF-AMT GREATER THAN +0
  8754        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8755
  8756     IF PL-TOL-PREM-PCT GREATER THAN +0
  8757        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8758
  8759     IF PL-TOL-REF-PCT GREATER THAN +0
  8760        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8761
  8762     IF PL-TOL-CLM-AMT GREATER THAN +0
  8763        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8764
  8765     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8766                          PL-OVER-SHORT-AMT > +0
  8767        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8768
  8769     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8770                          PL-OVER-SHORT-PCT > +0
  8771        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8772
  8773     IF PL-SALES-TAX NUMERIC AND
  8774                          PL-SALES-TAX > +0
  8775         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8776
  8777     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8778        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8779                                    WS-IG-OVRD-AM.
  8780
  8781 0304-LIFE-BENEFIT-FOUND.
  8782
  8783     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8784
  8785     IF PB-ISSUE
  8786        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8787     ELSE
  8788        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8789
  8790     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8791     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8792     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8793     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8794     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8795                                         WS-LF-REFUND-CALC.
  8796
  8797     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8798        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8799
  8800     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 162
* EL050.cbl
  8801        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8802     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8803
  8804     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8805     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8806     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8807     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8808     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8809     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8810
  8811     IF PB-COMPANY-ID = 'NCL'  AND
  8812        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8813         NEXT SENTENCE
  8814     ELSE
  8815         IF SUB5 NOT GREATER THAN +20
  8816            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8817               MOVE WS-SAVE-BENEFIT-REM-TERM
  8818                                      TO WS-AM-LF-BENE-REM-TERM
  8819                                         EC-BR-LF-REM-TERM-CALC.
  8820
  8821     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8822     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8823
  8824     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8825
  8826 0305-BENEFIT-NOT-FOUND.
  8827
  8828     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8829     MOVE ER-2604                TO WS-ERROR.
  8830     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8831
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 163
* EL050.cbl
  8833
  8834 0310-FIND-AH-BENEFIT-RECORD.
  8835
  8836     MOVE 'N'                    TO PLAN-MASTER-SW
  8837                                    PLAN-MASTER-AH-SW.
  8838
  8839     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8840                                    WS-PL-TOL-AH-REFUND
  8841                                    WS-AH-PL-REF-OVS-AMT
  8842                                    WS-PL-TOL-AH-PREM-PCT
  8843                                    WS-PL-TOL-AH-REFUND-PCT
  8844                                    WS-AH-PL-REF-OVS-PCT
  8845                                    WS-PL-TOL-AH-CLAIM.
  8846     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8847
  8848
  8849     if pb-issue
  8850        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8851           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8852        end-if
  8853        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8854           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8855           GO TO 0399-BENEFIT-NOT-FOUND
  8856        end-if
  8857     end-if
  8858
  8859     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8860        GO TO 0400-FIND-CARRIER.
  8861
  8862     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8863
  8864     IF WK-AH-BEN-ADDR NOT = ZEROS
  8865         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8866         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8867         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8868         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8869           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8870             GO TO 0311-AH-BENEFIT-SEARCH
  8871         ELSE
  8872             NEXT SENTENCE
  8873     ELSE
  8874         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8875
  8876     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8877     MOVE '5'                    TO CNTL-REC-TYPE.
  8878     MOVE +0                     TO CNTL-SEQ-NO.
  8879     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8880
  8881     MOVE '2' TO RC-SW-2.
  8882     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8883
  8884     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8885        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8886          GO TO 0399-BENEFIT-NOT-FOUND.
  8887
  8888     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8889
  8890 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 164
* EL050.cbl
  8891
  8892     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8893
  8894     IF NO-BENEFIT-FOUND
  8895         GO TO 0399-BENEFIT-NOT-FOUND.
  8896
  8897     IF WS-BEN-CD = '99'
  8898        GO TO 0399-BENEFIT-NOT-FOUND.
  8899
  8900     IF PB-COMPANY-ID  =  'NCL'
  8901         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8902             GO TO 0314-A-H-BENEFIT-FOUND.
  8903
  8904     MOVE +1                     TO SUB5.
  8905     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8906
  8907* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8908* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8909     IF PB-COMPANY-ID = 'DMD'
  8910         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8911
  8912 0312-EDIT-ACCT-AH-BENEFITS.
  8913
  8914     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8915        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8916           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8917                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8918           GO TO 03XX-GET-AH-ERPLAN.
  8919
  8920     IF SUB5 LESS THAN +20
  8921        ADD +1                   TO SUB5
  8922        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8923
  8924     MOVE +1                     TO SUB5.
  8925
  8926     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8927        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8928
  8929 0313-EDIT-DMD-EXTRA-BENEFITS.
  8930
  8931     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8932        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8933           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8934                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8935           GO TO 03XX-GET-AH-ERPLAN.
  8936
  8937     IF SUB5 LESS THAN +30
  8938        ADD +1                   TO SUB5
  8939        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8940
  8941     MOVE +1                     TO SUB5.
  8942
  8943 03XX-EDIT-FOR-NINETY-AH.
  8944
  8945***************************************************************
  8946*                                                             *
  8947*    NINETY BENEFIT PLAN TYPES:                               *
  8948*                                                             *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 165
* EL050.cbl
  8949*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8950*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8951*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8952*           BENEFIT CONTROLS.                                 *
  8953*      99 = ALL BENEFITS.                                     *
  8954*                                                             *
  8955***************************************************************
  8956
  8957     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8958                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8959
  8960     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8961       AND
  8962        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8963        GO TO 03XX-GET-AH-ERPLAN.
  8964
  8965     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8966       AND
  8967        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8968           IF (PB-I-INDV-GRP-OVRD = 'I')
  8969              OR
  8970           ((AM-IG = '1') AND
  8971           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8972              OR
  8973           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8974           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8975           (AM-IG NOT = '2'))
  8976              GO TO 03XX-GET-AH-ERPLAN.
  8977
  8978     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8979       AND
  8980        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8981           IF (PB-I-INDV-GRP-OVRD = 'G')
  8982              OR
  8983           ((AM-IG = '2') AND
  8984           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8985              OR
  8986           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8987           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8988           (AM-IG NOT = '1'))
  8989              GO TO 03XX-GET-AH-ERPLAN.
  8990
  8991     IF SUB5 LESS THAN +20
  8992        ADD +1                   TO SUB5
  8993        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8994
  8995     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8996        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8997
  8998     MOVE +1                    TO SUB5.
  8999
  9000 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9001
  9002     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9003                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9004
  9005     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9006       AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 166
* EL050.cbl
  9007        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9008        GO TO 03XX-GET-AH-ERPLAN.
  9009
  9010     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9011       AND
  9012        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9013           IF (PB-I-INDV-GRP-OVRD = 'I')
  9014              OR
  9015           ((AM-IG = '1') AND
  9016           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9017              OR
  9018           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9019           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9020           (AM-IG NOT = '2'))
  9021              GO TO 03XX-GET-AH-ERPLAN.
  9022
  9023     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9024       AND
  9025        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9026           IF (PB-I-INDV-GRP-OVRD = 'G')
  9027              OR
  9028           ((AM-IG = '2') AND
  9029           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9030              OR
  9031           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9032           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9033           (AM-IG NOT = '1'))
  9034              GO TO 03XX-GET-AH-ERPLAN.
  9035
  9036     IF SUB5 LESS THAN +30
  9037        ADD +1                   TO SUB5
  9038        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9039
  9040 03XX-EDIT-FOR-NINETY-AH-CONT.
  9041
  9042     MOVE +99                    TO SUB5.
  9043
  9044     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9045
  9046     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9047        IF PB-ISSUE
  9048           MOVE ER-1925          TO  WS-ERROR
  9049           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9050
  9051     GO TO 0314-A-H-BENEFIT-FOUND.
  9052
  9053 03XX-GET-AH-ERPLAN.
  9054
  9055     IF WK-PLAN-ADDR EQUAL +0
  9056         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9057
  9058     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9059     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9060     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9061     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9062     MOVE 'Y'                    TO PLAN-MASTER-SW
  9063                                    PLAN-MASTER-AH-SW.
  9064*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 167
* EL050.cbl
  9065     GO TO 03XX-ERPLAN-AH-READ.
  9066
  9067 03XX-ERPLAN-AH-GETMAIN.
  9068
  9069     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9070     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9071
  9072 03XX-ERPLAN-AH-READ.
  9073
  9074     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9075     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9076     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9077     MOVE PB-SV-STATE            TO PLAN-STATE.
  9078     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9079     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9080     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9081     MOVE WS-SAVE-BENEFIT-REVISION
  9082                                 TO PLAN-REVISION-NO.
  9083
  9084     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9085     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9086
  9087     IF PB-COMPANY-ID = 'NCL'
  9088       IF NOT AH-PLAN-MASTER-FOUND
  9089         IF NOT PB-POLICY-IS-DECLINED  AND
  9090            NOT PB-POLICY-IS-VOIDED
  9091             MOVE  ER-1922         TO  WS-ERROR
  9092             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9093             GO TO 0314-A-H-BENEFIT-FOUND.
  9094
  9095     IF NOT AH-PLAN-MASTER-FOUND
  9096        GO TO 0314-A-H-BENEFIT-FOUND.
  9097
  9098 XXXX-CHECK-AH-PLAN-KEY.
  9099
  9100     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9101        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9102        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9103        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9104        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9105        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9106        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9107        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9108        MOVE 'N'                 TO PLAN-MASTER-SW
  9109          GO TO 03XX-ERPLAN-AH-READ.
  9110
  9111     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9112
  9113     IF  PB-CANCELLATION
  9114         GO TO  0313-AH-ACCT-BEN-FOUND.
  9115
  9116     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9117       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9118          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9119          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9120             MOVE ER-2644             TO WS-ERROR
  9121             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9122          ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 168
* EL050.cbl
  9123             NEXT SENTENCE
  9124       ELSE
  9125          IF PB-COMPANY-ID NOT = 'NCL'
  9126             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9127                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9128
  9129 0313-AH-ACCT-BEN-FOUND.
  9130
  9131     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9132
  9133     IF PL-DEV-CODE NOT = SPACES
  9134        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9135
  9136     IF PL-DEV-PCT NUMERIC AND
  9137        PL-DEV-PCT NOT = ZEROS
  9138        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9139
  9140     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9141        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9142
  9143     IF PL-TOL-REF-AMT NOT EQUAL +0
  9144        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9145
  9146     IF PL-TOL-PREM-PCT GREATER THAN +0
  9147        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9148
  9149     IF PL-TOL-REF-PCT GREATER THAN +0
  9150        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9151
  9152     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9153        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9154
  9155     IF PL-OVER-SHORT-AMT NUMERIC AND
  9156                          PL-OVER-SHORT-AMT > +0
  9157        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9158
  9159     IF PL-OVER-SHORT-PCT NUMERIC AND
  9160                          PL-OVER-SHORT-PCT > +0
  9161        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9162
  9163     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9164        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9165        IF WS-IG-OVRD-AM EQUAL SPACES
  9166            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9167
  9168 0314-A-H-BENEFIT-FOUND.
  9169
  9170     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9171
  9172     IF PB-ISSUE
  9173        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9174       ELSE
  9175        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9176
  9177     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9178     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9179     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9180     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 169
* EL050.cbl
  9181                                         WS-AH-REFUND-CALC.
  9182
  9183     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9184        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9185
  9186     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9187        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9188     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9189
  9190     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9191     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9192     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9193     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9194     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9195     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9196
  9197     IF PB-COMPANY-ID = 'NCL'  AND
  9198        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9199         NEXT SENTENCE
  9200     ELSE
  9201         IF SUB5 NOT GREATER THAN +20
  9202            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9203                MOVE WS-SAVE-BENEFIT-REM-TERM
  9204                                      TO WS-AM-AH-BENE-REM-TERM
  9205                                         EC-BR-AH-REM-TERM-CALC.
  9206
  9207     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9208     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9209
  9210     GO TO 0400-FIND-CARRIER.
  9211
  9212 0399-BENEFIT-NOT-FOUND.
  9213
  9214     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9215     MOVE ER-2605                TO WS-ERROR.
  9216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9217
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 170
* EL050.cbl
  9219
  9220 0400-FIND-CARRIER.
  9221
  9222     MOVE PB-SV-CARRIER          TO WS-CARR.
  9223
  9224     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9225     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9226     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9227     MOVE '6'                    TO CNTL-REC-TYPE.
  9228
  9229*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9230     MOVE SPACE                  TO WS-DMD-RATING-SW
  9231                                    EC-BR-DMD-RATING-SW.
  9232
  9233     MOVE '2'                    TO RC-SW-1.
  9234     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9235
  9236     IF NOT CF-CARRIER-MASTER
  9237        GO TO 0400-CARRIER-NOT-FOUND.
  9238
  9239 0400-BUILD-CARR-TOL.
  9240
  9241     IF CF-CR-TOL-PREM NUMERIC AND
  9242        CF-CR-TOL-PREM GREATER THAN +0
  9243        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9244                                    WS-TOL-AH-PREM.
  9245
  9246     IF CF-CR-TOL-REFUND NUMERIC AND
  9247        CF-CR-TOL-REFUND GREATER THAN +0
  9248        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9249                                    WS-TOL-AH-REFUND.
  9250
  9251     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9252        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9253        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9254                                    WS-AH-REFUND-OVS-AMT.
  9255
  9256     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9257        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9258        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9259                                    WS-AH-REFUND-OVS-PCT.
  9260
  9261     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9262        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9263        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9264                                    WS-TOL-AH-PREM-PCT.
  9265
  9266     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9267        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9268        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9269                                     WS-TOL-AH-REFUND-PCT.
  9270
  9271     IF CF-COMPANY-ID EQUAL 'DMD'
  9272         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9273                                    EC-BR-DMD-RATING-SW.
  9274
  9275     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9276     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 171
* EL050.cbl
  9277        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9278     END-IF
  9279     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9280        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9281     END-IF
  9282     IF WS-TOL-CLP-PCT = ZEROS
  9283        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9284     END-IF
  9285
  9286     IF WS-SPP-LEASE-COMM = ZEROS
  9287        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9288     END-IF
  9289     GO TO 0400-FIND-ERPDEF.
  9290
  9291 0400-CARRIER-NOT-FOUND.
  9292
  9293     MOVE ER-2602                TO WS-ERROR.
  9294     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9295
  9296 0400-FIND-ERPDEF.
  9297     IF PB-COMPANY-ID = 'DCC'
  9298        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9299        CONTINUE
  9300     ELSE
  9301        GO TO 0400-FIND-ERCOMP
  9302     END-IF
  9303     MOVE ' '                    TO PDEF-MASTER-SW
  9304     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9305     MOVE PB-STATE               TO ERPDEF-STATE
  9306     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9307     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9308     IF PB-ISSUE
  9309        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9310     ELSE
  9311        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9312     END-IF
  9313     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9314     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9315     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9316     IF PDEF-MASTER-FOUND
  9317        MOVE 'N'                 TO PDEF-MASTER-SW
  9318        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9319        IF PDEF-MASTER-FOUND
  9320           IF (ERPDEF-KEY-SAVE (1:16) =
  9321                        PD-CONTROL-PRIMARY (1:16))
  9322              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9323              CONTINUE
  9324           ELSE
  9325              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9326              IF (ERPDEF-KEY-SAVE (1:16) =
  9327                        PD-CONTROL-PRIMARY (1:16))
  9328                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9329                 CONTINUE
  9330              ELSE
  9331                 MOVE 'N'        TO PDEF-MASTER-SW
  9332              END-IF
  9333           END-IF
  9334        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 172
* EL050.cbl
  9335        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9336     END-IF
  9337     IF PDEF-MASTER-FOUND
  9338        IF PD-TRUNCATED = 'Y'
  9339           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9340        END-IF
  9341     END-IF
  9342     .
  9343 0400-FIND-ERCOMP.
  9344     IF PB-COMPANY-ID = 'DCC'
  9345        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9346           (WS-SUB1 > +10)
  9347           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9348                 OR 'A' OR 'N'
  9349              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9350              MOVE PB-CARRIER    TO COMP-CARRIER
  9351              MOVE PB-GROUPING   TO COMP-GROUPING
  9352              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9353              MOVE AM-AGT (WS-SUB1)
  9354                                 TO COMP-FIN-RESP
  9355              MOVE 'G'           TO COMP-TYPE
  9356              PERFORM 8582-READ-COMPENSATION-MASTER
  9357                                 THRU 8582-EXIT
  9358              IF COMP-MASTER-FOUND
  9359                 IF CO-GA-INACTIVE
  9360                    MOVE ER-2763 TO WS-ERROR
  9361                    PERFORM 9900-ERROR-FORMAT
  9362                                 THRU 9900-EXIT
  9363                    MOVE +11     TO WS-SUB1
  9364                 END-IF
  9365                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9366                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9367                    MOVE ER-2788 TO WS-ERROR
  9368                    PERFORM 9900-ERROR-FORMAT
  9369                                 THRU 9900-EXIT
  9370                    MOVE +11     TO WS-SUB1
  9371                 END-IF
  9372              END-IF
  9373           END-IF
  9374        END-PERFORM
  9375     END-IF
  9376     IF PB-COMPANY-ID = 'DCC'
  9377        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9378           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9379                                    WS-CLP-STATE
  9380        ELSE
  9381           MOVE SPACES           TO PB-I-CLP-STATE
  9382                                    WS-CLP-STATE
  9383        END-IF
  9384     END-IF
  9385
  9386     IF (PB-COMPANY-ID = 'DCC')
  9387        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9388        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9389        CONTINUE
  9390     ELSE
  9391        GO TO 0400-FIND-STATE-RECORD
  9392     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 173
* EL050.cbl
  9393     MOVE SPACES                 TO WS-CLP-STATE
  9394     MOVE +0                     TO WS-BANK-FEE
  9395                                    WS-BANK-LFEE
  9396                                    WS-BANK-NOCHRGB
  9397
  9398     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9399     IF (PB-ISSUE)
  9400        AND (PB-I-BANK-NUMBER NOT =
  9401            SPACES AND ZEROS AND LOW-VALUES)
  9402        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9403     ELSE
  9404        IF (PB-CANCELLATION)
  9405           AND (PB-CI-BANK-NUMBER NOT =
  9406                SPACES AND ZEROS AND LOW-VALUES)
  9407           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9408        END-IF
  9409     END-IF
  9410     IF COMP-FIN-RESP NOT = LOW-VALUES
  9411        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9412        MOVE PB-CARRIER          TO COMP-CARRIER
  9413        MOVE PB-GROUPING         TO COMP-GROUPING
  9414        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9415        MOVE 'B'                 TO COMP-TYPE
  9416        PERFORM 8582-READ-COMPENSATION-MASTER
  9417                                 THRU 8582-EXIT
  9418        IF COMP-MASTER-FOUND
  9419           IF CO-MAX-BANK-FEE NOT NUMERIC
  9420              MOVE +0            TO CO-MAX-BANK-FEE
  9421           END-IF
  9422           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9423              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9424           END-IF
  9425           IF CO-GA-INACTIVE
  9426              MOVE ER-2763       TO WS-ERROR
  9427              PERFORM 9900-ERROR-FORMAT
  9428                                 THRU 9900-EXIT
  9429           END-IF
  9430           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9431              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9432              MOVE ER-2788 TO WS-ERROR
  9433              PERFORM 9900-ERROR-FORMAT
  9434                                 THRU 9900-EXIT
  9435              MOVE +11     TO WS-SUB1
  9436           END-IF
  9437           IF WS-AH-BEN-CATEGORY = 'G'
  9438              MOVE CO-MAX-BANK-FEE
  9439                                 TO WS-BANK-FEE
  9440                                    PB-I-BANK-FEE
  9441           ELSE
  9442              MOVE CO-MAX-BANK-FEE-LEASE
  9443                                 TO WS-BANK-LFEE
  9444                                    PB-I-BANK-FEE
  9445           END-IF
  9446           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9447              AND (WS-AH-REFUND-CALC = 'G'))
  9448                        OR
  9449              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9450              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 174
* EL050.cbl
  9451              CONTINUE
  9452           ELSE
  9453              MOVE ER-2789 TO WS-ERROR
  9454              PERFORM 9900-ERROR-FORMAT
  9455                                 THRU 9900-EXIT
  9456           END-IF
  9457           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9458                                    PB-I-CLP-STATE
  9459           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9460           MOVE CO-CARRIER       TO BXRF-CARRIER
  9461           MOVE CO-GROUPING      TO BXRF-GROUPING
  9462           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9463           MOVE BXRF-MAX-REC-LENGTH
  9464                                 TO BXRF-REC-LENGTH
  9465           PERFORM 8584-READ-BANK-CROSS-REF
  9466                                 THRU 8584-EXIT
  9467           IF BXRF-MASTER-FOUND
  9468              MOVE ' '           TO BANK-ACCT-SW
  9469              MOVE BK-BANK-POINTER-CNT
  9470                                 TO BK-BANK-POINTER-CNT
  9471              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9472                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9473                 OR (BANK-ACCT-FOUND)
  9474                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9475                    AND (BK-AM-EXP-DT (WS-SUB1)
  9476                                 > PB-CERT-EFF-DT)
  9477                    AND (BK-AM-EFF-DT (WS-SUB1)
  9478                                 NOT > PB-CERT-EFF-DT)
  9479                    SET BANK-ACCT-FOUND TO TRUE
  9480                 END-IF
  9481              END-PERFORM
  9482              IF NOT BANK-ACCT-FOUND
  9483                 MOVE ZEROS      TO WS-BANK-FEE
  9484                                    WS-BANK-LFEE
  9485                 MOVE ER-2869    TO WS-ERROR
  9486                 PERFORM 9900-ERROR-FORMAT
  9487                                 THRU 9900-EXIT
  9488              ELSE
  9489                 PERFORM 5000-PROCESS-REPS
  9490                                 THRU 5000-EXIT
  9491                 IF AGENT-MASTER-FOUND
  9492                    MOVE +0      TO WS-BANK-FEE
  9493                                    WS-BANK-LFEE
  9494*                   MOVE AG-SPP-FEES (1)
  9495*                                TO PB-I-BANK-FEE
  9496*                                   WS-BANK-FEE
  9497                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9498                       (WS-SUB1 > +10)
  9499                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9500                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9501                       END-IF
  9502                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9503                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9504                       END-IF
  9505                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9506                          AG-SPP-FEES (WS-SUB1)
  9507                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9508                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 175
* EL050.cbl
  9509                    END-PERFORM
  9510                    IF WS-AH-BEN-CATEGORY = 'G'
  9511                       MOVE WS-BANK-FEE
  9512                                 TO PB-I-BANK-FEE
  9513                    ELSE
  9514                       MOVE WS-BANK-LFEE
  9515                                 TO PB-I-BANK-FEE
  9516                    END-IF
  9517                 END-IF
  9518              END-IF
  9519           END-IF
  9520        ELSE
  9521           MOVE ER-2879          TO WS-ERROR
  9522           PERFORM 9900-ERROR-FORMAT
  9523                                 THRU 9900-EXIT
  9524        END-IF
  9525     ELSE
  9526        MOVE ER-2879             TO WS-ERROR
  9527        PERFORM 9900-ERROR-FORMAT
  9528                                 THRU 9900-EXIT
  9529     END-IF
  9530     IF WS-AH-BEN-CATEGORY = 'G'
  9531        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9532        + WS-BANK-FEE
  9533     ELSE
  9534        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9535        + WS-BANK-LFEE
  9536     END-IF
  9537     .
  9538 0400-FIND-STATE-RECORD.
  9539
  9540     IF WK-STATE-ADDR NOT = ZEROS
  9541         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9542         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9543         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9544         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9545         IF PB-SV-STATE = CF-STATE-CODE
  9546             GO TO 0405-CONTINUE-EDIT
  9547         ELSE
  9548             NEXT SENTENCE
  9549     ELSE
  9550         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9551
  9552     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9553     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9554     MOVE '3'                    TO CNTL-REC-TYPE.
  9555     MOVE +0                     TO CNTL-SEQ-NO.
  9556
  9557     MOVE '3'                    TO RC-SW-2.
  9558     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9559
  9560     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9561        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9562        PB-SV-STATE   NOT = CF-STATE-CODE)
  9563        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9564                                    WS-TOL-AH-CLAIM
  9565                                    WS-MINIMUM-REFUND
  9566                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 176
* EL050.cbl
  9567                                    WS-TOL-AH-PREM
  9568                                    WS-TOL-LF-REFUND
  9569                                    WS-TOL-AH-REFUND
  9570                                    EC-ST-TOL-PREM-PCT
  9571                                    WS-TOL-LF-PREM-PCT
  9572                                    WS-TOL-AH-PREM-PCT
  9573                                    EC-ST-TOL-REFUND-PCT
  9574                                    WS-TOL-LF-REFUND-PCT
  9575                                    WS-TOL-AH-REFUND-PCT
  9576                                    EC-ST-TOL-PREM
  9577                                    EC-ST-TOL-REFUND
  9578                                    EC-ST-FST-PMT-DAYS-MAX
  9579                                    WS-FREE-LOOK-PERIOD
  9580                                    WS-ST-LF-PREM-TAX
  9581                                    WS-ST-AH-PREM-TAX-I
  9582                                    WS-ST-AH-PREM-TAX-G
  9583                                    WS-BANK-FEE
  9584                                    WS-BANK-LFEE
  9585                                    WS-TOL-CLP-PCT
  9586                                    WS-SPP-LEASE-COMM
  9587        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9588                                    EC-ST-FST-PMT-DAYS-CHG
  9589                                    WS-LF-REM-TERM-CALC
  9590                                    WS-LF-REFUND-CALC
  9591                                    EC-ST-LF-REM-TERM-CALC
  9592                                    EC-ST-LF-REFUND-CALC
  9593                                    WS-AH-REM-TERM-CALC
  9594                                    WS-AH-REFUND-CALC
  9595                                    WS-LF-BEN-CATEGORY
  9596                                    WS-AH-BEN-CATEGORY
  9597                                    WS-CLP-STATE
  9598                                    WS-ST-REFUND-CLAIM-FLAG
  9599                                    EC-ST-AH-REM-TERM-CALC
  9600                                    EC-ST-AH-REFUND-CALC
  9601          GO TO 0499-STATE-NOT-FOUND.
  9602
  9603     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9604
  9605 0405-CONTINUE-EDIT.
  9606
  9607     if pb-company-id = 'AHL'
  9608        continue
  9609     else
  9610        IF PB-CERT-PRIME NOT NUMERIC
  9611           MOVE ER-2722          TO WS-ERROR
  9612           PERFORM 9900-ERROR-FORMAT
  9613                                 THRU 9900-EXIT
  9614        end-if
  9615     END-IF
  9616*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9617*       MOVE +0                  TO SUB3
  9618*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9619*       IF SUB3 > +0
  9620*          MOVE ER-2722          TO WS-ERROR
  9621*          PERFORM 9900-ERROR-FORMAT
  9622*                                THRU 9900-EXIT
  9623*       END-IF
  9624*    END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 177
* EL050.cbl
  9625*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9626*       IF PB-CERT-PRIME NOT NUMERIC
  9627*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9628*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9629*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9630*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9631*
  9632*          MOVE ER-2722          TO WS-ERROR
  9633*          PERFORM 9900-ERROR-FORMAT
  9634*                                THRU 9900-EXIT
  9635*       END-IF
  9636*    END-IF
  9637
  9638     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9639
  9640     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9641        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9642                                    WS-TOL-AH-CLAIM.
  9643
  9644     IF CF-ST-REFUND-MIN NOT NUMERIC
  9645        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9646
  9647     IF CF-ST-REFUND-MIN NOT = ZEROS
  9648        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9649
  9650     IF CF-ST-TOL-PREM  NOT = ZEROS
  9651        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9652                                    WS-TOL-AH-PREM
  9653        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9654
  9655     IF CF-ST-TOL-REFUND NOT = ZEROS
  9656        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9657                                    WS-TOL-AH-REFUND
  9658        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9659
  9660     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9661        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9662        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9663                                    WS-AH-REFUND-OVS-AMT
  9664                                    EC-ST-OVR-SHT-AMT.
  9665
  9666     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9667        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9668        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9669                                    WS-TOL-LF-PREM-PCT
  9670                                    WS-TOL-AH-PREM-PCT.
  9671
  9672     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9673        CF-ST-TOL-REF-PCT GREATER THAN +0
  9674        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9675                                    WS-TOL-LF-REFUND-PCT
  9676                                    WS-TOL-AH-REFUND-PCT.
  9677
  9678     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9679        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9680        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9681                                    WS-AH-REFUND-OVS-PCT
  9682                                    EC-ST-OVR-SHT-PCT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 178
* EL050.cbl
  9683
  9684     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9685     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9686
  9687     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9688          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9689
  9690     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9691     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9692     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9693
  9694     IF CF-ST-LF-PREM-TAX NUMERIC
  9695        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9696     END-IF
  9697     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9698        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9699     END-IF
  9700     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9701        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9702     END-IF
  9703
  9704     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9705         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9706     END-IF.
  9707
  9708     IF WS-LF-BENEFIT-CD = ZEROS
  9709        GO TO 0410-CHECK-AH.
  9710
  9711     IF CF-ST-RT-CALC NOT = SPACES
  9712        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9713                                    EC-ST-LF-REM-TERM-CALC
  9714     END-IF
  9715
  9716     IF WS-LF-COVERAGE-TYPE = 'R'
  9717        IF WS-LF-EARNINGS-CALC = '5'
  9718           IF CF-ST-RF-LN-CALC > '0'
  9719              MOVE CF-ST-RF-LN-CALC
  9720                                 TO WS-LF-REFUND-CALC
  9721                                    EC-ST-LF-REFUND-CALC
  9722           END-IF
  9723        ELSE
  9724           IF CF-ST-RF-LR-CALC > '0'
  9725              MOVE CF-ST-RF-LR-CALC
  9726                                 TO WS-LF-REFUND-CALC
  9727                                    EC-ST-LF-REFUND-CALC
  9728           END-IF
  9729        END-IF
  9730     ELSE
  9731        IF CF-ST-RF-LL-CALC > '0'
  9732           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9733                                    EC-ST-LF-REFUND-CALC
  9734        END-IF
  9735     END-IF
  9736
  9737     IF CF-ST-RT-CALC NOT = SPACES
  9738        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9739                                    EC-ST-LF-REM-TERM-CALC
  9740     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 179
* EL050.cbl
  9741
  9742     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9743     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9744
  9745     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9746
  9747     IF NO-BENEFIT-FOUND
  9748        GO TO 0410-CHECK-AH.
  9749
  9750     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9751        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9752                                 TO EC-ST-LF-REM-TERM-CALC
  9753                                    WS-LF-REM-TERM-CALC
  9754     END-IF
  9755
  9756     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9757        MOVE CF-ST-REFUND-CALC (SUB3)
  9758                                 TO WS-LF-REFUND-CALC
  9759                                    EC-ST-LF-REFUND-CALC
  9760     END-IF
  9761*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9762
  9763     .
  9764 0410-CHECK-AH.
  9765
  9766     IF WS-AH-BENEFIT-CD = ZEROS
  9767        GO TO 0500-SET-ACCOUNT.
  9768
  9769     IF CF-ST-RT-CALC NOT = SPACES
  9770        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9771                                    EC-ST-AH-REM-TERM-CALC
  9772     END-IF
  9773
  9774     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9775        IF CF-ST-RF-CP-CALC > '0'
  9776           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9777                                    EC-ST-AH-REFUND-CALC
  9778        END-IF
  9779     ELSE
  9780        IF CF-ST-RF-AH-CALC > '0'
  9781           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9782                                    EC-ST-AH-REFUND-CALC
  9783        END-IF
  9784     END-IF
  9785     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9786     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9787
  9788     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9789
  9790     IF NO-BENEFIT-FOUND
  9791        GO TO 0500-SET-ACCOUNT.
  9792
  9793     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9794        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9795                                 TO WS-AH-REM-TERM-CALC
  9796                                    EC-ST-AH-REM-TERM-CALC
  9797     END-IF
  9798
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 180
* EL050.cbl
  9799     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9800        MOVE CF-ST-REFUND-CALC (SUB3)
  9801                                 TO WS-AH-REFUND-CALC
  9802                                    EC-ST-AH-REFUND-CALC
  9803     END-IF
  9804
  9805*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9806
  9807     GO TO 0500-SET-ACCOUNT.
  9808
  9809 0499-STATE-NOT-FOUND.
  9810
  9811     MOVE ER-2603                TO WS-ERROR.
  9812     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9813
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 181
* EL050.cbl
  9815
  9816 0500-SET-ACCOUNT.
  9817*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9818     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9819        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9820        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9821        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9822        MOVE '3'                 TO CNTL-REC-TYPE
  9823        MOVE +0                  TO CNTL-SEQ-NO
  9824
  9825        MOVE '3'                 TO RC-SW-2
  9826        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9827
  9828        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9829           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9830           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9831           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9832                                    WS-ST-AH-PREM-TAX-I
  9833                                    WS-ST-AH-PREM-TAX-G
  9834        ELSE
  9835           IF CF-ST-LF-PREM-TAX NUMERIC
  9836              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9837           END-IF
  9838           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9839              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9840           END-IF
  9841           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9842              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9843           END-IF
  9844        END-IF
  9845        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9846     END-IF
  9847*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9848*  FOR DCC ONLY
  9849     IF PB-COMPANY-ID = 'DCC'
  9850
  9851     MOVE ' '                    TO STAT-MASTER-SW
  9852     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9853     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9854     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9855     MOVE PB-STATE               TO ELSTAT-STATE
  9856     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9857        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9858     END-IF
  9859
  9860     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9861     SET BIN-TO-GREG             TO TRUE
  9862     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9863     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9864     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9865
  9866     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9867     IF STAT-MASTER-FOUND
  9868        MOVE 'N'                 TO STAT-MASTER-SW
  9869        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9870        IF STAT-MASTER-FOUND
  9871           IF (ELSTAT-KEY-SAVE (1:12) =
  9872                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 182
* EL050.cbl
  9873              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9874                 MOVE 'F'        TO STAT-MASTER-SW
  9875              ELSE
  9876                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9877                 IF (STAT-MASTER-FOUND)
  9878                    AND (ELSTAT-KEY-SAVE (1:12) =
  9879                        SF-CONTROL-PRIMARY (1:12))
  9880                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9881                    MOVE 'F'     TO STAT-MASTER-SW
  9882                 END-IF
  9883              END-IF
  9884           END-IF
  9885        END-IF
  9886     END-IF
  9887
  9888     IF STAT-MASTER-SW = 'F'
  9889        IF SF-ST-LF-PREM-TAX NUMERIC
  9890           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9891        END-IF
  9892        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9893           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9894        END-IF
  9895        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9896           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9897        END-IF
  9898     END-IF
  9899
  9900     END-IF
  9901     IF (PB-COMPANY-ID = 'DCC')
  9902        AND (PB-ISSUE)
  9903        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9904        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9905        AND (AM-GPCD = 06)
  9906        MOVE 'Y'                 TO WS-GOOD-HIN
  9907        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9908           MOVE PB-I-VIN         TO WS-WORK-VIN
  9909           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9910              (V1 > 16)
  9911              IF WS-WORK-VIN (V1:1) NUMERIC
  9912                 MOVE WS-WORK-VIN-N (V1)
  9913                                 TO WS-ROW-B-VAL (V1)
  9914              ELSE
  9915                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9916                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9917                    OR (V2 > 26)
  9918                 END-PERFORM
  9919                 IF V2 < 27
  9920                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9921                 ELSE
  9922                    MOVE 'N'     TO WS-GOOD-HIN
  9923                 END-IF
  9924              END-IF
  9925              COMPUTE WS-ROW-D-VAL (V1) =
  9926                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9927              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9928                 WS-ROW-D-VAL (V1)
  9929           END-PERFORM
  9930           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 183
* EL050.cbl
  9931           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9932             REMAINDER WS-VIN-REMAINDER
  9933           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9934              CONTINUE
  9935           ELSE
  9936              MOVE 'N'           TO WS-GOOD-HIN
  9937           END-IF
  9938        ELSE
  9939           MOVE 'N'              TO WS-GOOD-HIN
  9940        END-IF
  9941        IF WS-GOOD-HIN NOT = 'Y'
  9942           MOVE ER-3826           TO WS-ERROR
  9943           PERFORM 9900-ERROR-FORMAT
  9944                                 THRU 9900-EXIT
  9945        END-IF
  9946     END-IF
  9947     IF (PB-COMPANY-ID = 'DCC')
  9948        AND (PB-ISSUE)
  9949        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9950        AND (AM-GPCD NOT = 06)
  9951        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9952          MOVE PB-I-VIN          TO WS-WORK-VIN
  9953          MOVE +8                TO V2
  9954          MOVE ZEROS             TO WS-VIN-TOTAL
  9955          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9956           (V1 > 17)
  9957             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9958                MOVE ER-3825     TO WS-ERROR
  9959                PERFORM 9900-ERROR-FORMAT
  9960                                 THRU 9900-EXIT
  9961             ELSE
  9962                IF V1 = 8
  9963                   MOVE 10       TO V2
  9964                END-IF
  9965                IF V1 = 9
  9966                   MOVE 0        TO V2
  9967                END-IF
  9968                IF V1 = 10
  9969                   MOVE 9        TO V2
  9970                END-IF
  9971                IF WS-WORK-VIN (V1:1) NUMERIC
  9972                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9973                    + (WS-WORK-VIN-N (V1) * V2)
  9974                ELSE
  9975                   MOVE WS-WORK-VIN (V1:1)
  9976                                 TO WS-HEX-BYTE
  9977                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9978                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9979                    + (WS-NUM (V3) * V2)
  9980                END-IF
  9981                COMPUTE V2 = V2 - 1
  9982             END-IF
  9983          END-PERFORM
  9984          MOVE ZEROS TO WS-VIN-REMAINDER
  9985          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9986             REMAINDER WS-VIN-REMAINDER
  9987          IF ((WS-WORK-VIN (9:1) = 'X')
  9988             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 184
* EL050.cbl
  9989                     OR
  9990             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9991             CONTINUE
  9992          ELSE
  9993             MOVE ER-3826        TO WS-ERROR
  9994             PERFORM 9900-ERROR-FORMAT
  9995                                 THRU 9900-EXIT
  9996          END-IF
  9997        ELSE
  9998          MOVE ER-3826           TO WS-ERROR
  9999          PERFORM 9900-ERROR-FORMAT
 10000                                 THRU 9900-EXIT
 10001        END-IF
 10002     END-IF
 10003******************************************************************
 10004******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10005******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10006******* METHODS.
 10007******************************************************************
 10008     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10009        IF PB-CANCELLATION
 10010           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10011              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10012                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10013                IF FORM-MASTER-FOUND
 10014                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10015******************************************************************
 10016
 10017     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10018     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10019
 10020     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10021     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10022     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10023     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10024
 10025
 10026     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10027     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10028     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10029
 10030     IF AM-LF-OB-RATE NOT NUMERIC
 10031         MOVE ZERO               TO AM-LF-OB-RATE.
 10032
 10033     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10034         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10035
 10036     IF AM-AH-OB-RATE NOT NUMERIC
 10037         MOVE ZERO               TO AM-AH-OB-RATE.
 10038
 10039     IF WS-LF-JOINT-INDICATOR = 'J'
 10040         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10041     ELSE
 10042         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10043
 10044     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10045
 10046     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 185
* EL050.cbl
 10047         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10048
 10049     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10050         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10051                                       WS-IG-OVRD
 10052     ELSE
 10053         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10054             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10055                                       WS-IG-OVRD
 10056         ELSE
 10057             MOVE AM-IG             TO WS-IG-OVRD-AH
 10058                                       WS-IG-OVRD.
 10059
 10060     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10061         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10062                                       WS-IG-OVRD
 10063     ELSE
 10064         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10065             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10066                                       WS-IG-OVRD
 10067         ELSE
 10068             MOVE AM-IG             TO WS-IG-OVRD-LF
 10069                                       WS-IG-OVRD.
 10070
 10071     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10072     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10073     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10074     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10075     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10076
 10077     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10078     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10079     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10080     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10081
 10082     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10083     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10084     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10085     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10086     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10087     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10088     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10089
 10090     IF WS-ACCT-AH-DEV-PCT > +0
 10091        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10092     ELSE
 10093        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10094
 10095     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10096        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10097     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10098        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10099
 10100        IF AM-EARN-METHOD-L = 'S'
 10101            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10102                                        WS-LF-REFUND-CALC.
 10103
 10104        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 186
* EL050.cbl
 10105            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10106                                        WS-LF-REFUND-CALC.
 10107
 10108     IF WS-LF-COVERAGE-TYPE = 'R'
 10109         IF AM-EARN-METHOD-R = 'R'
 10110            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10111                                    WS-LF-REFUND-CALC.
 10112     IF WS-LF-COVERAGE-TYPE = 'R'
 10113         IF AM-EARN-METHOD-R = 'P'
 10114            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10115                                    WS-LF-REFUND-CALC.
 10116     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10117         IF AM-EARN-METHOD-L = 'R'
 10118            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10119                                    WS-LF-REFUND-CALC.
 10120     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10121         IF AM-EARN-METHOD-L = 'P'
 10122            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10123                                    WS-LF-REFUND-CALC.
 10124     IF WS-LF-COVERAGE-TYPE = 'R'
 10125         IF AM-EARN-METHOD-R = 'A'
 10126            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10127                                    WS-LF-REFUND-CALC.
 10128     IF WS-LF-COVERAGE-TYPE = 'R'
 10129         IF AM-EARN-METHOD-R = 'M'
 10130            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10131                                    WS-LF-REFUND-CALC.
 10132     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10133         IF AM-EARN-METHOD-L = 'A'
 10134            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10135                                    WS-LF-REFUND-CALC.
 10136     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10137         IF AM-EARN-METHOD-L = 'M'
 10138            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10139                                    WS-LF-REFUND-CALC.
 10140
 10141     IF AM-EARN-METHOD-A = 'R'
 10142        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10143                                    WS-AH-REFUND-CALC.
 10144     IF AM-EARN-METHOD-A = 'P'
 10145        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10146                                    WS-AH-REFUND-CALC.
 10147     IF AM-EARN-METHOD-A = 'C'
 10148        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10149                                    WS-AH-REFUND-CALC.
 10150     IF AM-EARN-METHOD-A = 'A'
 10151        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10152                                    WS-AH-REFUND-CALC.
 10153     IF AM-EARN-METHOD-A = 'M'
 10154        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10155                                    WS-AH-REFUND-CALC.
 10156     IF AM-EARN-METHOD-A = 'N'
 10157        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10158                                    WS-AH-REFUND-CALC.
 10159     IF AM-EARN-METHOD-A = 'S'
 10160        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10161                                    WS-AH-REFUND-CALC.
 10162
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 187
* EL050.cbl
 10163     IF AM-TOL-PREM NOT = ZEROS
 10164        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10165                                    WS-TOL-AH-PREM.
 10166
 10167     IF AM-OVR-SHT-AMT NUMERIC AND
 10168                  AM-OVR-SHT-AMT > 0
 10169        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10170                                    EC-AM-LF-OVR-SHT-AMT
 10171                                    WS-AH-REFUND-OVS-AMT
 10172                                    EC-AM-AH-OVR-SHT-AMT.
 10173
 10174     IF AM-OVR-SHT-PCT NUMERIC AND
 10175                    AM-OVR-SHT-PCT > 0
 10176        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10177                                    EC-AM-LF-OVR-SHT-PCT
 10178                                    WS-AH-REFUND-OVS-PCT
 10179                                    EC-AM-AH-OVR-SHT-PCT.
 10180
 10181     IF AM-TOL-REF-PCT NUMERIC AND
 10182                  AM-TOL-REF-PCT > 0
 10183        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10184                                    WS-TOL-AH-REFUND-PCT.
 10185
 10186     IF AM-TOL-REF  NOT = ZEROS  AND
 10187                  AM-TOL-REF NUMERIC
 10188        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10189                                    EC-AM-LF-TOL-REFUND
 10190                                    WS-TOL-AH-REFUND
 10191                                    EC-AM-AH-TOL-REFUND.
 10192
 10193     IF AM-TOL-CLM  NOT = ZEROS
 10194        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10195                                    WS-TOL-AH-CLAIM.
 10196
 10197     IF AM-CLP-TOL-PCT NOT NUMERIC
 10198        MOVE +0                  TO AM-CLP-TOL-PCT
 10199     END-IF
 10200
 10201     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10202        MOVE +0                  TO AM-SPP-LEASE-COMM
 10203     END-IF
 10204     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10205        MOVE WS-PL-TOL-LF-PREM-PCT
 10206                                 TO WS-TOL-LF-PREM-PCT.
 10207
 10208     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10209        MOVE WS-PL-TOL-AH-PREM-PCT
 10210                                 TO WS-TOL-AH-PREM-PCT.
 10211
 10212     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10213        MOVE WS-PL-TOL-LF-REFUND-PCT
 10214                                 TO WS-TOL-LF-REFUND-PCT.
 10215
 10216     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10217        MOVE WS-PL-TOL-AH-REFUND-PCT
 10218                                 TO WS-TOL-AH-REFUND-PCT.
 10219
 10220     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 188
* EL050.cbl
 10221        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10222
 10223     IF WS-PL-REF-OVS-PCT > +0
 10224        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10225
 10226     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10227        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10228     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10229        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10230     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10231        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10232     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10233        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10234     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10235        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10236     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10237        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10238
 10239     IF WS-AH-PL-REF-OVS-AMT > +0
 10240        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10241
 10242     IF WS-AH-PL-REF-OVS-PCT > +0
 10243        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10244
 10245     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10246     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10247
 10248     IF PB-CANCELLATION
 10249        GO TO 3000-CONTINUE-EDIT.
 10250
 10251     MOVE +1 TO SUB1.
 10252     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10253     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10254
 10255     IF CF-COMPANY-ID = 'DMD'
 10256       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10257         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10258        ELSE
 10259         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10260
 10261  0525-FIND-ACCT-COMM.
 10262     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10263        NEXT SENTENCE
 10264      ELSE
 10265         ADD +1 TO SUB1
 10266         IF SUB1 LESS +11
 10267            GO TO 0525-FIND-ACCT-COMM
 10268          ELSE
 10269             GO TO 0560-EDIT-CONTINUE.
 10270
 10271     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10272     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10273                                    PB-I-LIFE-COMMISSION.
 10274***  IF PB-COMPANY-ID = 'CRI'
 10275     IF PB-PREM-ACCTNG-ONLY
 10276         GO TO 0560-EDIT-CONTINUE.
 10277
 10278     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 189
* EL050.cbl
 10279     MOVE ' '    TO WS-CTBL-READ-SW.
 10280
 10281
 10282 0530-GET-AH-COMP.
 10283     IF NO-AH-COVERAGE  OR
 10284        NO-AH-BENEFIT-MATCH
 10285           GO TO 0540-NEXT-READ-STEP.
 10286
 10287     IF AM-A-COM (SUB1) NUMERIC
 10288        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10289         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10290         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10291         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10292         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10293     ELSE
 10294          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10295          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10296          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10297          MOVE ZEROS             TO WS-SUB1
 10298                                    WS-COMMISSION
 10299          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10300          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10301          IF WS-COMMISSION > ZEROS
 10302             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10303             GO TO 0540-NEXT-READ-STEP
 10304          END-IF
 10305          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10306          IF CTBL-TABLE-FOUND
 10307             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10308                                        PB-I-AH-TERM
 10309             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10310             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10311             GO TO 0540-NEXT-READ-STEP
 10312          ELSE
 10313             IF FIRST-TIME-THROUGH
 10314                 GO TO 0530-GET-AH-COMP
 10315             ELSE
 10316                 MOVE ER-2609                TO WS-ERROR
 10317                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10318
 10319 0540-NEXT-READ-STEP.
 10320     MOVE '0540' TO CTBL-SW.
 10321     MOVE ' '    TO WS-CTBL-READ-SW.
 10322
 10323 0540-GET-LF-COMP.
 10324     IF NO-LIFE-COVERAGE  OR
 10325        NO-LF-BENEFIT-MATCH
 10326           GO TO 0560-EDIT-CONTINUE.
 10327
 10328     IF WS-LF-JOINT-INDICATOR = 'J'
 10329        IF AM-J-COM (SUB1) NUMERIC
 10330           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10331           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10332           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10333           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10334           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10335        ELSE
 10336           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 190
* EL050.cbl
 10337           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10338           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10339           MOVE ZEROS                TO WS-SUB1
 10340                                        WS-COMMISSION
 10341           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10342           IF WS-COMMISSION > ZEROS
 10343              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10344              GO TO 0560-EDIT-CONTINUE
 10345           END-IF
 10346           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10347           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10348           IF CTBL-TABLE-FOUND
 10349              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10350              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10351              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10352              GO TO 0560-EDIT-CONTINUE
 10353           ELSE
 10354              IF FIRST-TIME-THROUGH
 10355                  GO TO 0540-GET-LF-COMP
 10356              ELSE
 10357                  MOVE ER-2609                TO WS-ERROR
 10358                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10359                  GO TO 0560-EDIT-CONTINUE.
 10360
 10361     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10362        IF AM-L-COM (SUB1) NUMERIC
 10363           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10364           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10365           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10366           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10367           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10368        ELSE
 10369           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10370           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10371           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10372           MOVE ZEROS                TO WS-SUB1
 10373                                        WS-COMMISSION
 10374           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10375           IF WS-COMMISSION IS GREATER THAN ZEROS
 10376              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10377              GO TO 0560-EDIT-CONTINUE
 10378           END-IF
 10379           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10380           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10381           IF CTBL-TABLE-FOUND
 10382              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10383              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10384              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10385              GO TO 0560-EDIT-CONTINUE
 10386           ELSE
 10387              IF FIRST-TIME-THROUGH
 10388                  GO TO 0540-GET-LF-COMP
 10389              ELSE
 10390                  MOVE ER-2609                TO WS-ERROR
 10391                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10392
 10393*    GO TO 0560-EDIT-CONTINUE.
 10394
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 191
* EL050.cbl
 10395 0560-EDIT-CONTINUE.
 10396     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10397                                    WS-AH-PMF-COMM
 10398*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10399*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10400     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10401        (SUB1 > +10)
 10402        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10403           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10404           MOVE '0530'           TO CTBL-SW
 10405           MOVE ' '              TO WS-CTBL-READ-SW
 10406           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10407           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10408           MOVE '0540'           TO CTBL-SW
 10409           MOVE ' '              TO WS-CTBL-READ-SW
 10410           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10411        END-IF
 10412     END-PERFORM
 10413     GO TO 0564-EDIT-CONTINUE
 10414     .
 10415 0561-CHECK-AH.
 10416     IF (NO-AH-COVERAGE)
 10417        OR (NO-AH-BENEFIT-MATCH)
 10418        CONTINUE
 10419     ELSE
 10420        IF (AM-A-COM (SUB1) NUMERIC)
 10421           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10422           IF (AM-COM-TYP (SUB1) = 'A')
 10423              AND (WS-AH-PMF-COMM = ZEROS)
 10424              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10425           END-IF
 10426           CONTINUE
 10427        ELSE
 10428           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10429           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10430           MOVE PB-AH-OVERRIDE-L1
 10431                                 TO CTBL-BEN-TYPE
 10432           MOVE ZEROS            TO WS-SUB1
 10433                                    WS-COMMISSION
 10434           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10435           PERFORM 8300-READ-CTBL-TABLE
 10436                                 THRU 8300-EXIT
 10437           IF CTBL-TABLE-FOUND
 10438              IF (AM-COM-TYP (SUB1) = 'A')
 10439                 AND (WS-AH-PMF-COMM = ZEROS)
 10440                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10441                                        PB-I-AH-TERM
 10442                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10443                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10444              END-IF
 10445              CONTINUE
 10446           ELSE
 10447              IF FIRST-TIME-THROUGH
 10448                 GO TO 0561-CHECK-AH
 10449              ELSE
 10450                 MOVE ER-2609    TO WS-ERROR
 10451                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10452              END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 192
* EL050.cbl
 10453           END-IF
 10454        END-IF
 10455     END-IF
 10456     .
 10457 0561-EXIT.
 10458     EXIT.
 10459 0563-CHECK-LF.
 10460     IF (NO-LIFE-COVERAGE)
 10461        OR (NO-LF-BENEFIT-MATCH)
 10462        CONTINUE
 10463     ELSE
 10464        IF WS-LF-JOINT-INDICATOR = 'J'
 10465           IF AM-J-COM (SUB1) NUMERIC
 10466              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10467              IF (AM-COM-TYP (SUB1) = 'A')
 10468                 AND (WS-LF-PMF-COMM = ZEROS)
 10469                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10470              END-IF
 10471              CONTINUE
 10472           ELSE
 10473              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10474              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10475              MOVE PB-LIFE-OVERRIDE-L1
 10476                                 TO CTBL-BEN-TYPE
 10477              MOVE ZEROS         TO WS-SUB1
 10478                                    WS-COMMISSION
 10479              MOVE AM-J-COMA (SUB1)
 10480                                 TO CTBL-TABLE
 10481              PERFORM 8300-READ-CTBL-TABLE
 10482                                 THRU 8300-EXIT
 10483              IF CTBL-TABLE-FOUND
 10484                 IF (AM-COM-TYP (SUB1) = 'A')
 10485                    AND (WS-LF-PMF-COMM = ZEROS)
 10486                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10487                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10488                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10489                 END-IF
 10490                 CONTINUE
 10491              ELSE
 10492                 IF FIRST-TIME-THROUGH
 10493                    GO TO 0563-CHECK-LF
 10494                 ELSE
 10495                    MOVE ER-2609 TO WS-ERROR
 10496                    PERFORM 9900-ERROR-FORMAT
 10497                                 THRU 9900-EXIT
 10498*                   GO TO 0560-EDIT-CONTINUE
 10499                 END-IF
 10500              END-IF
 10501           END-IF
 10502        ELSE
 10503           IF AM-L-COM (SUB1) NUMERIC
 10504              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10505              IF (AM-COM-TYP (SUB1) = 'A')
 10506                 AND (WS-LF-PMF-COMM = ZEROS)
 10507                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10508              END-IF
 10509              CONTINUE
 10510           ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 193
* EL050.cbl
 10511              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10512              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10513              MOVE PB-LIFE-OVERRIDE-L1
 10514                                 TO CTBL-BEN-TYPE
 10515              MOVE ZEROS         TO WS-SUB1
 10516                                    WS-COMMISSION
 10517              MOVE AM-L-COMA (SUB1)
 10518                                 TO CTBL-TABLE
 10519              PERFORM 8300-READ-CTBL-TABLE
 10520                                 THRU 8300-EXIT
 10521              IF CTBL-TABLE-FOUND
 10522                 CONTINUE
 10523              ELSE
 10524                 IF FIRST-TIME-THROUGH
 10525                    GO TO 0563-CHECK-LF
 10526                 ELSE
 10527                    MOVE ER-2609 TO WS-ERROR
 10528                    PERFORM 9900-ERROR-FORMAT
 10529                                 THRU 9900-EXIT
 10530                 END-IF
 10531              END-IF
 10532           END-IF
 10533        END-IF
 10534     END-IF
 10535     .
 10536 0563-EXIT.
 10537     EXIT.
 10538 0564-EDIT-CONTINUE.
 10539
 10540     IF  PB-COMPANY-ID EQUAL 'DMD'
 10541         IF PB-I-NUM-BILLED EQUAL ZEROS
 10542            MOVE ER-8148       TO WS-ERROR
 10543            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10544
 10545*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10546*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10547*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10548*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10549*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10550*         IF NO-CONVERSION-ERROR
 10551*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10552*         ELSE
 10553*             IF PB-COMPANY-ID EQUAL 'HAN'
 10554*                 MOVE ZEROS     TO PB-I-AGE.
 10555     IF PB-I-BIRTHDAY > LOW-VALUES
 10556        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10557        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10558        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10559        PERFORM 8500-DATE-CONVERT
 10560                                 THRU 8500-EXIT
 10561        IF NO-CONVERSION-ERROR
 10562           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10563           IF PB-I-AGE > ZEROS
 10564              IF WS-WORK-AGE NOT = PB-I-AGE
 10565                 MOVE ER-9501    TO WS-ERROR
 10566                 PERFORM 9900-ERROR-FORMAT
 10567                                 THRU 9900-EXIT
 10568              END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 194
* EL050.cbl
 10569           ELSE
 10570              MOVE WS-WORK-AGE   TO PB-I-AGE
 10571           END-IF
 10572        END-IF
 10573     END-IF
 10574     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10575                                   WS-INS-AGE-SET
 10576     IF PB-I-AGE = ZEROS
 10577        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10578           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10579                                   WS-INS-AGE-SET
 10580           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10581
 10582     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10583                                   WS-AH-EDIT-AGE.
 10584
 10585     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10586        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10587        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10588        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10589        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10590        IF NO-CONVERSION-ERROR
 10591           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10592           IF PB-I-JOINT-AGE > 0
 10593              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10594                 MOVE ER-9503    TO WS-ERROR
 10595                 PERFORM 9900-ERROR-FORMAT
 10596                                 THRU 9900-EXIT
 10597              END-IF
 10598           ELSE
 10599              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10600           END-IF
 10601        ELSE
 10602           MOVE ZEROS            TO PB-I-JOINT-AGE
 10603        END-IF
 10604     END-IF
 10605     IF PB-I-JOINT-AGE NOT NUMERIC
 10606        MOVE ZERO               TO PB-I-JOINT-AGE.
 10607
 10608     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10609                                   WS-JNT-AGE-SET
 10610     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10611        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10612           (WS-AH-JOINT-INDICATOR = 'J')
 10613           IF PB-I-JOINT-AGE = ZEROS
 10614               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10615                                          WS-JNT-AGE-SET
 10616               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10617           END-IF
 10618        END-IF
 10619     END-IF
 10620
 10621     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10622     IF WS-LF-JOINT-INDICATOR = 'J'
 10623        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10624        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10625            IF  PB-I-JOINT-AGE = ZERO
 10626                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 195
* EL050.cbl
 10627                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10628            ELSE
 10629                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10630                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10631                    IF PB-COMPANY-ID NOT = 'LBL'
 10632                        MOVE ER-2685    TO WS-ERROR
 10633                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10634
 10635     IF WS-AH-JOINT-INDICATOR = 'J'
 10636        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10637            IF  PB-I-JOINT-AGE = ZERO
 10638                MOVE ER-2686       TO WS-ERROR
 10639                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10640            ELSE
 10641                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10642                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10643                                           WS-EDIT-AGE
 10644                    IF PB-COMPANY-ID NOT = 'LBL'
 10645                        MOVE ER-2685    TO WS-ERROR
 10646                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10647
 10648******************************************************************
 10649*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10650******************************************************************
 10651
 10652     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10653        (WS-AH-SPECIAL-CALC-CD = 'O')
 10654        NEXT SENTENCE
 10655     ELSE
 10656        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10657          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10658           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10659            WS-AH-JOINT-INDICATOR = 'J')  AND
 10660           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10661            MOVE ER-2627             TO WS-ERROR
 10662            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10663
 10664     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10665        (WS-AH-SPECIAL-CALC-CD = 'O')
 10666         NEXT SENTENCE
 10667     ELSE
 10668         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10669            WS-AH-JOINT-INDICATOR = 'J'
 10670             IF PB-I-JOINT-INSURED = SPACES
 10671                 IF PB-COMPANY-ID NOT = 'JAL'
 10672                     MOVE ER-2696    TO WS-ERROR
 10673                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10674
 10675     IF PB-COMPANY-ID NOT = 'BOA'
 10676        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10677           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10678           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10679               PB-I-JOINT-INSURED NOT = SPACES)
 10680                MOVE ER-2691         TO WS-ERROR
 10681                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10682
 10683     IF PB-COMPANY-ID = 'BOA'
 10684        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 196
* EL050.cbl
 10685           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10686            IF PB-I-JOINT-AGE NOT = ZEROS
 10687                MOVE ER-2691         TO WS-ERROR
 10688                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10689
 10690     IF PB-COMPANY-ID = 'CRI'
 10691        IF PB-I-SIG-SW = 'J'
 10692           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10693              WS-AH-JOINT-INDICATOR NOT = 'J'
 10694              MOVE ER-2675       TO WS-ERROR
 10695              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10696
 10697     IF PB-COMPANY-ID = 'CRI'
 10698        IF PB-I-SIG-SW = 'S'
 10699           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10700              WS-AH-JOINT-INDICATOR = 'J'
 10701              MOVE ER-2676       TO WS-ERROR
 10702              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10703
 10704     IF PB-COMPANY-ID = 'CVL'
 10705         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10706            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10707              MOVE ER-2783           TO WS-ERROR
 10708              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10709     IF (WS-LF-JOINT-INDICATOR = 'J')
 10710        AND (WS-AH-JOINT-INDICATOR = 'J')
 10711        AND (PB-I-LF-TERM > 120)
 10712        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10713        MOVE ER-2783             TO WS-ERROR
 10714        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10715     END-IF
 10716     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10717
 10718     IF PB-I-INDV-GRP-OVRD = 'I'
 10719        MOVE ER-2666             TO WS-ERROR
 10720        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10721        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10722
 10723     IF PB-I-INDV-GRP-OVRD = 'G'
 10724        MOVE ER-2666             TO WS-ERROR
 10725        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10726        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10727
 10728     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10729        NEXT SENTENCE
 10730     ELSE
 10731        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10732
 10733     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10734        IF WS-ERROR = ER-2666
 10735           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10736           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10737
 10738     IF PB-COMPANY-ID = 'CID'
 10739        IF PB-STATE = 'UT' OR 'MO'
 10740           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10741                 OR '76' OR '77')
 10742                      OR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 197
* EL050.cbl
 10743               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10744                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10745                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10746                   OR '2K' OR '2L'))
 10747              AND PB-I-INDV-GRP-CD = 'I'
 10748              MOVE ER-2721             TO WS-ERROR
 10749              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10750           END-IF
 10751        END-IF
 10752     END-IF
 10753
 10754     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10755     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10756        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10757     ELSE
 10758        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10759     END-IF
 10760
 10761*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10762*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10763     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10764                                    ACCOUNT-AH-CK-SW.
 10765
 10766     IF PB-REISSUED-CERT       OR
 10767        PB-REIN-ONLY-CERT      OR
 10768        PB-POLICY-IS-DECLINED  OR
 10769        PB-POLICY-IS-VOIDED
 10770*       OR PB-MONTHLY-CERT
 10771         GO TO 3000-CONTINUE-EDIT.
 10772
 10773     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10774        IF WS-EDIT-AGE           > +65
 10775           MOVE ER-2709          TO WS-ERROR
 10776           PERFORM 9900-ERROR-FORMAT
 10777                                 THRU 9900-EXIT
 10778        ELSE
 10779           IF WS-EDIT-AGE        > +55
 10780              MOVE ER-2718       TO WS-ERROR
 10781              PERFORM 9900-ERROR-FORMAT
 10782                                 THRU 9900-EXIT
 10783           END-IF
 10784        END-IF
 10785     IF PB-COMPANY-ID = 'DCC'
 10786        IF WS-EDIT-AGE           > +65
 10787           MOVE ER-2709          TO WS-ERROR
 10788           PERFORM 9900-ERROR-FORMAT
 10789                                 THRU 9900-EXIT
 10790        END-IF
 10791     END-IF
 10792     .
 10793
 10794 0565-LIFE-PLAN-LIMIT-EDITS.
 10795
 10796     IF NOT LF-PLAN-MASTER-FOUND
 10797        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10798                                    EC-AM-LF-MAX-TOT-BEN
 10799        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10800
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 198
* EL050.cbl
 10801     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10802
 10803     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10804         IF PL-LM-AGE (1) = ZEROS
 10805             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10806
 10807     IF NO-LF-BENEFIT-MATCH          OR
 10808        WS-LF-BENEFIT-CD = ZEROS     OR
 10809        WS-LF-SPECIAL-CALC-CD = 'M'
 10810        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10811
 10812     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10813     MOVE +1                     TO SUB2.
 10814
 10815     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10816        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10817           MOVE +5   TO SUB2
 10818           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10819              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10820              (PL-LM-AGE (SUB2) EQUAL +0)
 10821              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10822              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10823
 10824     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10825
 10826     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10827                               + PB-I-LF-ALT-BENEFIT-AMT.
 10828
 10829 0568-CHECK-LIFE-ATT-AGE.
 10830
 10831     IF PL-ATT-AGE NUMERIC AND
 10832        PL-ATT-AGE > +0
 10833        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10834     END-IF
 10835*    IF PL-ATT-AGE NUMERIC AND
 10836*       PL-ATT-AGE > +0
 10837*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10838*       IF PB-I-BIRTHDAY > LOW-VALUES
 10839*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10840*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10841*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10842*          SET BIN-PLUS-ELAPSED  TO TRUE
 10843*          PERFORM 8500-DATE-CONVERT
 10844*                                THRU 8500-EXIT
 10845*          IF NO-CONVERSION-ERROR
 10846*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10847*             MOVE ER-2669       TO WS-ERROR
 10848*             PERFORM 9900-ERROR-FORMAT
 10849*                                THRU 9900-EXIT
 10850*          END-IF
 10851*       ELSE
 10852*          IF WS-ATT-AGE >= PL-ATT-AGE
 10853*             MOVE ER-2669       TO WS-ERROR
 10854*             PERFORM 9900-ERROR-FORMAT
 10855*                                THRU 9900-EXIT
 10856*          END-IF
 10857*       END-IF
 10858*    END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 199
* EL050.cbl
 10859     .
 10860 0570-CHECK-LIFE-LIMITS.
 10861
 10862     IF PB-COMPANY-ID EQUAL 'CRI'
 10863        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10864           IF SUB2 GREATER THAN +4
 10865              MOVE ER-2637 TO WS-ERROR
 10866              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10867              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10868
 10869     IF PB-COMPANY-ID  =  'NCL'
 10870        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10871            SUB2 GREATER THAN +8
 10872             MOVE 'U'         TO PB-BATCH-ENTRY
 10873             MOVE ER-2637     TO WS-ERROR
 10874             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10875             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10876
 10877     IF SUB2 > +8
 10878        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10879           AND (PB-I-SIG-SW = 'Y')
 10880           CONTINUE
 10881        ELSE
 10882           MOVE ER-2637          TO WS-ERROR
 10883           PERFORM 9900-ERROR-FORMAT
 10884                                 THRU 9900-EXIT
 10885        END-IF
 10886        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10887     END-IF
 10888     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10889     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10890     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10891
 10892     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10893        ADD +1  TO SUB2
 10894        GO TO 0570-CHECK-LIFE-LIMITS.
 10895
 10896     IF PB-COMPANY-ID = 'NCL'
 10897         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10898
 10899     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10900        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10901        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10902           AND (PB-I-SIG-SW = 'Y')
 10903           CONTINUE
 10904        ELSE
 10905           MOVE ER-2637          TO WS-ERROR
 10906           PERFORM 9900-ERROR-FORMAT
 10907                                 THRU 9900-EXIT
 10908        END-IF
 10909     END-IF
 10910     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10911
 10912
 10913 0570-CHECK-NCL-LIFE-LIMITS.
 10914
 10915     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10916        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 200
* EL050.cbl
 10917         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10918
 10919     IF APP-CERT-USED
 10920         IF SUB2  LESS THAN  +5
 10921             MOVE +5          TO SUB2
 10922             GO TO 0570-CHECK-LIFE-LIMITS.
 10923
 10924     MOVE ER-2637             TO WS-ERROR.
 10925     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10926
 10927     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10928
 10929 0575-CHECK-NCL-SIG-SWITCH.
 10930
 10931     IF NOT APP-CERT-USED
 10932         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10933
 10934     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10935        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10936        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10937        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10938         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10939
 10940     IF SUB2 GREATER THAN +4
 10941         IF PL-LM-AGE (5) = ZEROS  AND
 10942            PL-LM-AGE (6) = ZEROS  AND
 10943            PL-LM-AGE (7) = ZEROS  AND
 10944            PL-LM-AGE (8) = ZEROS
 10945             MOVE  ER-1927        TO WS-ERROR
 10946             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10947             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10948         ELSE
 10949             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10950                 MOVE  ER-1920    TO WS-ERROR
 10951                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10952
 10953     IF PB-I-SIG-SW  = 'Y'
 10954       IF NOT PB-I-POLICY-ACCEPTED  AND
 10955          NOT PB-I-POLICY-DECLINED
 10956           MOVE 'U'               TO PB-BATCH-ENTRY
 10957           MOVE  ER-1926          TO WS-ERROR
 10958           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10959
 10960
 10961 0580-AH-PLAN-LIMIT-EDITS.
 10962
 10963     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10964        IF PB-I-AH-BENEFIT-AMT > +1250
 10965           MOVE ER-2702          TO WS-ERROR
 10966           PERFORM 9900-ERROR-FORMAT
 10967                                 THRU 9900-EXIT
 10968        END-IF
 10969     END-IF
 10970
 10971     IF (PB-COMPANY-ID = 'DCC')
 10972        AND (PB-MONTHLY-CERT)
 10973        IF PB-I-AH-BENEFIT-AMT > +3000
 10974           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 201
* EL050.cbl
 10975           PERFORM 9900-ERROR-FORMAT
 10976                                 THRU 9900-EXIT
 10977        END-IF
 10978     END-IF
 10979     IF NOT AH-PLAN-MASTER-FOUND
 10980        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10981        GO TO 3000-CONTINUE-EDIT.
 10982
 10983     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10984
 10985     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10986         IF PL-LM-AGE (1) = ZEROS
 10987             GO TO 3000-CONTINUE-EDIT.
 10988
 10989     IF NO-AH-BENEFIT-MATCH          OR
 10990        WS-AH-BENEFIT-CD = ZEROS     OR
 10991        WS-AH-SPECIAL-CALC-CD = 'M'
 10992        GO TO 3000-CONTINUE-EDIT.
 10993
 10994     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10995     MOVE +1                     TO SUB2.
 10996
 10997     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10998        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10999           MOVE +5 TO SUB2
 11000           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11001              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11002              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11003              (PL-LM-AGE (SUB2) EQUAL +0)
 11004              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11005              GO TO 3000-CONTINUE-EDIT.
 11006
 11007     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11008
 11009 0590-CHECK-AH-ATT-AGE.
 11010
 11011     IF PL-ATT-AGE NUMERIC AND
 11012        PL-ATT-AGE GREATER THAN +0
 11013        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11014     END-IF
 11015*       IF WS-ATT-AGE >= PL-ATT-AGE
 11016*          MOVE ER-3054          TO WS-ERROR
 11017*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11018     .
 11019 0597-CHECK-AH-LIMITS.
 11020
 11021     IF PB-COMPANY-ID EQUAL 'CRI'
 11022        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11023           IF SUB2 GREATER THAN +4
 11024              MOVE ER-2638       TO WS-ERROR
 11025              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11026              GO TO 3000-CONTINUE-EDIT.
 11027
 11028     IF PB-COMPANY-ID  =  'NCL'
 11029        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11030            SUB2 GREATER THAN +8
 11031             MOVE 'U'            TO PB-BATCH-ENTRY
 11032             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 202
* EL050.cbl
 11033             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11034             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11035
 11036     IF SUB2 > +8
 11037        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11038           AND (PB-I-SIG-SW = 'Y')
 11039           CONTINUE
 11040        ELSE
 11041           MOVE ER-2638          TO WS-ERROR
 11042           PERFORM 9900-ERROR-FORMAT
 11043                                 THRU 9900-EXIT
 11044        END-IF
 11045        GO TO 3000-CONTINUE-EDIT
 11046     END-IF
 11047
 11048     IF PB-COMPANY-ID = 'CRI'
 11049        IF WS-ERROR = ER-2638
 11050           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11051
 11052     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11053     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11054     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11055     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11056
 11057     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11058        ADD +1                   TO SUB2
 11059        GO TO 0597-CHECK-AH-LIMITS.
 11060
 11061     IF PB-COMPANY-ID = 'NCL'
 11062         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11063
 11064     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11065        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11066        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11067                                 > PL-LM-AMT (SUB2))
 11068        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11069           AND (PB-I-SIG-SW = 'Y')
 11070           CONTINUE
 11071        ELSE
 11072           MOVE ER-2638          TO WS-ERROR
 11073           PERFORM 9900-ERROR-FORMAT
 11074                                 THRU 9900-EXIT
 11075        END-IF
 11076     END-IF
 11077
 11078     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11079         IF  WS-ERROR    EQUAL    ER-2638
 11080             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11081                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11082                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11083                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11084                MOVE  ER-1910    TO  WS-ERROR
 11085                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11086
 11087     IF PB-COMPANY-ID = 'CRI'
 11088        IF WS-ERROR = ER-2638
 11089            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11090            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 203
* EL050.cbl
 11091            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11092
 11093     GO TO 3000-CONTINUE-EDIT.
 11094
 11095 0597-CHECK-NCL-AH-LIMITS.
 11096
 11097     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11098        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11099        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11100                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11101         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11102
 11103     IF APP-CERT-USED
 11104         IF SUB2  LESS THAN  +5
 11105             MOVE +5             TO SUB2
 11106             GO TO 0597-CHECK-AH-LIMITS.
 11107
 11108     MOVE ER-2638                TO WS-ERROR.
 11109     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11110
 11111     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11112
 11113 0599-CHECK-NCL-SIG-SWITCH.
 11114
 11115     IF NOT APP-CERT-USED
 11116         GO TO 3000-CONTINUE-EDIT.
 11117
 11118     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11119        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11120        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11121        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11122         GO TO 3000-CONTINUE-EDIT.
 11123
 11124     IF SUB2 GREATER THAN +4
 11125         IF PL-LM-AGE (5) = ZEROS  AND
 11126            PL-LM-AGE (6) = ZEROS  AND
 11127            PL-LM-AGE (7) = ZEROS  AND
 11128            PL-LM-AGE (8) = ZEROS
 11129             MOVE  ER-1927        TO WS-ERROR
 11130             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11131             GO TO 3000-CONTINUE-EDIT
 11132         ELSE
 11133             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11134                 MOVE  ER-1920    TO WS-ERROR
 11135                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11136
 11137     IF PB-I-SIG-SW  = 'Y'
 11138       IF NOT PB-I-POLICY-ACCEPTED  AND
 11139          NOT PB-I-POLICY-DECLINED
 11140           MOVE 'U'               TO PB-BATCH-ENTRY
 11141           MOVE  ER-1926          TO WS-ERROR
 11142           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11143
 11144******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 204
* EL050.cbl
 11146
 11147 3000-CONTINUE-EDIT.
 11148
 11149     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11150     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11151     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11152     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11153     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11154
 11155     IF BROWSE-STARTED
 11156        PERFORM 9990-RETURN THRU 9990-EXIT
 11157        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11158
 11159     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11160        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11161        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11162        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11163*       MOVE 1                   TO DC-OPTION-CODE
 11164        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11165        IF DATE-CONVERSION-ERROR
 11166           MOVE ER-2622          TO WS-ERROR
 11167           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11168        ELSE
 11169           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11170              MOVE ER-2623       TO WS-ERROR
 11171              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11172           ELSE
 11173              MOVE ER-2622       TO WS-ERROR
 11174              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11175
 11176     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11177     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11178     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11179*    MOVE 1                      TO DC-OPTION-CODE.
 11180     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11181     IF DATE-CONVERSION-ERROR
 11182        GO TO 3005-EDIT-CONTINUE
 11183     ELSE
 11184        IF DC-ELAPSED-DAYS GREATER +180
 11185           MOVE ER-2613          TO WS-ERROR
 11186           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11187        ELSE
 11188           IF DC-ELAPSED-DAYS GREATER +90
 11189              MOVE ER-2612       TO WS-ERROR
 11190              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11191           ELSE
 11192             IF DC-ELAPSED-DAYS GREATER +60
 11193                MOVE ER-2614     TO WS-ERROR
 11194                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11195
 11196 3005-EDIT-CONTINUE.
 11197
 11198     IF PB-CANCELLATION
 11199         GO TO 3700-EDIT-CANCEL.
 11200
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 205
* EL050.cbl
 11202******************************************************************
 11203*                  E D I T   I S S U E                           *
 11204******************************************************************
 11205
 11206 3020-EDIT-ISSUE.
 11207
 11208      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11209      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11210      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11211      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11212      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11213
 11214     IF PB-ISSUE-FORCE
 11215        OR PB-ISSUE-DATE-FORCED
 11216        OR PB-FORCE-OFF
 11217        OR PB-OVERCHARGE-FORCE
 11218        CONTINUE
 11219     ELSE
 11220        MOVE ER-2670             TO WS-ERROR
 11221        PERFORM 9900-ERROR-FORMAT
 11222                                 THRU 9900-EXIT
 11223     END-IF
 11224     .
 11225 3022-SET-POLICY-STATUS.
 11226
 11227     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11228
 11229     IF (PB-REISSUED-CERT)
 11230             OR
 11231        ((PB-COMPANY-ID NOT = 'DCC')
 11232         AND (PB-MONTHLY-CERT))
 11233         MOVE '5'                TO PB-I-ENTRY-STATUS
 11234         MOVE 'E'                TO PB-BATCH-ENTRY
 11235     END-IF
 11236
 11237     IF PB-COMPANY-ID = 'DCC'
 11238        IF PB-MONTHLY-CERT
 11239           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11240        END-IF
 11241     END-IF
 11242     IF PB-POLICY-IS-DECLINED
 11243         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11244     IF PB-POLICY-IS-VOIDED
 11245         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11246     IF PB-NEEDS-UNDERWRITING
 11247         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11248     IF PB-REIN-ONLY-CERT
 11249         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11250     IF PB-PREM-ACCTNG-ONLY
 11251         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11252
 11253     MOVE SPACE                  TO PB-I-OB-FLAG.
 11254
 11255     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11256         MOVE ER-2665            TO WS-ERROR
 11257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11258         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11259
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 206
* EL050.cbl
 11260     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11261        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11262           MOVE 'Z'             TO PB-I-OB-FLAG.
 11263
 11264     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11265        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11266           MOVE 'Z'             TO PB-I-OB-FLAG.
 11267
 11268     IF ACCOUNT-MAST-FOUND
 11269         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11270         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11271         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11272         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11273         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11274         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11275         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11276     END-IF
 11277
 11278     IF ACCOUNT-MAST-FOUND
 11279        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11280         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11281
 11282     IF (ACCOUNT-MAST-FOUND)
 11283        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11284        IF PB-REISSUED-CERT
 11285           CONTINUE
 11286        ELSE
 11287           MOVE ER-2608          TO WS-ERROR
 11288           PERFORM 9900-ERROR-FORMAT
 11289                                 THRU 9900-EXIT
 11290         END-IF
 11291     END-IF
 11292
 11293     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11294        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11295        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11296
 11297**********   DMD CUSTOM CODE FOLLOWS  **********
 11298 3024-EDIT-DMD-FIELDS.
 11299     IF PB-COMPANY-ID NOT = 'DMD'
 11300        GO TO 3025-EDIT-REINSURANCE.
 11301
 11302*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11303*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11304*** ERROR IF THEY ARE NOT EQUAL.
 11305
 11306     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11307     SET BIN-TO-GREG               TO TRUE.
 11308     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11309     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11310**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11311
 11312     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11313     SET BIN-TO-GREG               TO TRUE.
 11314     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11315     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11316**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11317
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 207
* EL050.cbl
 11318     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11319        MOVE ER-8116               TO WS-ERROR
 11320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11321
 11322     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11323
 11324     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11325                                      WK-FULL-CERT-NO.
 11326     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11327
 11328     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11329
 11330     IF PB-VALID-LIFE
 11331        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11332     ELSE
 11333        IF PB-VALID-AH
 11334          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11335
 11336
 11337     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11338     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11339     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11340                                      DCUA-UNDRWRTR-CODE
 11341                                      DCUA-UNDRWRTR-GROUP-CODE
 11342                                      DCUA-RETURN-CODE.
 11343
 11344****************************************************************
 11345*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11346***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11347***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11348***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11349***   TO THIS RECORD.                                        ***
 11350****************************************************************
 11351     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11352     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11353     IF DCUA-SUCCESSFUL-PROCESS
 11354        GO TO 3024-EDIT-DL7-CONT.
 11355
 11356     IF DCUA-RETURN-CODE EQUAL '01'
 11357        MOVE ER-8110               TO WS-ERROR
 11358        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11359        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11360        GO TO 3024-EDIT-DL7-CONT.
 11361
 11362     IF DCUA-RETURN-CODE EQUAL '02'
 11363        MOVE ER-8111               TO WS-ERROR
 11364        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11365        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11366        GO TO 3024-EDIT-DL7-CONT.
 11367
 11368     IF DCUA-RETURN-CODE EQUAL '03'
 11369        MOVE ER-8074               TO WS-ERROR
 11370        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11371        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11372        GO TO 3024-EDIT-DL7-CONT.
 11373
 11374     IF DCUA-RETURN-CODE EQUAL '04'
 11375        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 208
* EL050.cbl
 11376        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11377        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11378        GO TO 3024-EDIT-DL7-CONT.
 11379
 11380     IF DCUA-RETURN-CODE EQUAL '05'
 11381        MOVE ER-8076               TO WS-ERROR
 11382        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11384        GO TO 3024-EDIT-DL7-CONT.
 11385
 11386     IF DCUA-RETURN-CODE EQUAL '06'
 11387        MOVE ER-8077               TO WS-ERROR
 11388        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11390        GO TO 3024-EDIT-DL7-CONT.
 11391
 11392     IF DCUA-RETURN-CODE EQUAL '07'
 11393        MOVE ER-8078               TO WS-ERROR
 11394        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11395        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11396        GO TO 3024-EDIT-DL7-CONT.
 11397
 11398     IF DCUA-RETURN-CODE EQUAL 'E1'
 11399        MOVE ER-8079               TO WS-ERROR
 11400        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11401        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11402        GO TO 3024-EDIT-DL7-CONT.
 11403
 11404     IF DCUA-RETURN-CODE EQUAL 'E2'
 11405        MOVE ER-8080               TO WS-ERROR
 11406        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11407        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11408        GO TO 3024-EDIT-DL7-CONT.
 11409
 11410     IF DCUA-RETURN-CODE EQUAL 'E3'
 11411        MOVE ER-8098               TO WS-ERROR
 11412        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11413        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11414        GO TO 3024-EDIT-DL7-CONT.
 11415
 11416     IF DCUA-RETURN-CODE EQUAL 'C1'
 11417        MOVE ER-8099               TO WS-ERROR
 11418        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11419        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11420        GO TO 3024-EDIT-DL7-CONT.
 11421
 11422     IF DCUA-RETURN-CODE EQUAL 'U1'
 11423        MOVE ER-8109               TO WS-ERROR
 11424        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11425        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11426        GO TO 3024-EDIT-DL7-CONT.
 11427
 11428     IF DCUA-RETURN-CODE EQUAL 'N1'
 11429        MOVE ER-8112               TO WS-ERROR
 11430        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11431        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11432        GO TO 3024-EDIT-DL7-CONT.
 11433
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 209
* EL050.cbl
 11434     IF DCUA-RETURN-CODE EQUAL 'N2'
 11435        MOVE ER-8113               TO WS-ERROR
 11436        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11437        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11438        GO TO 3024-EDIT-DL7-CONT.
 11439
 11440     IF DCUA-RETURN-CODE EQUAL 'N3'
 11441        MOVE ER-8114               TO WS-ERROR
 11442        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11444        GO TO 3024-EDIT-DL7-CONT.
 11445
 11446     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11447     MOVE ER-8097                  TO WS-ERROR.
 11448     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11449     GO TO 3024-EDIT-DL7-CONT.
 11450
 11451 3024-EDIT-DL7-CONT.
 11452
 11453     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11454     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11455     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11456        NEXT SENTENCE
 11457     ELSE
 11458        MOVE ER-9263               TO WS-ERROR
 11459        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11460
 11461******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11462******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11463     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11464        NEXT SENTENCE
 11465     ELSE
 11466        MOVE ER-8039               TO WS-ERROR
 11467        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11468
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 210
* EL050.cbl
 11470****************************************************************
 11471*** VALIDATE STATE  : DLO022                                 ***
 11472****************************************************************
 11473     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11474     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11475
 11476     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11477     IF DVSC-SUCCESSFUL-EDIT
 11478        GO TO 3024-EDIT-DL22-CONT.
 11479
 11480     IF DVSC-RETURN-CODE EQUAL '01'
 11481        MOVE ER-8300               TO WS-ERROR
 11482        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11483        GO TO 3024-EDIT-DL22-CONT.
 11484
 11485     IF DVSC-RETURN-CODE EQUAL '02'
 11486        MOVE ER-8301               TO WS-ERROR
 11487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11488        GO TO 3024-EDIT-DL22-CONT.
 11489
 11490     IF DVSC-RETURN-CODE EQUAL '03'
 11491        MOVE ER-8302               TO WS-ERROR
 11492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11493        GO TO 3024-EDIT-DL22-CONT.
 11494
 11495     IF DVSC-RETURN-CODE EQUAL 'N1'
 11496        MOVE ER-8304               TO WS-ERROR
 11497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11498        GO TO 3024-EDIT-DL22-CONT.
 11499
 11500     MOVE ER-8303                  TO WS-ERROR
 11501     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11502
 11503 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 211
* EL050.cbl
 11505****************************************************************
 11506*** VALIDATE LOAN OFFICER : DLO021                           ***
 11507****************************************************************
 11508
 11509     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11510     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11511     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11512     IF DVLO-SUCCESSFUL-EDIT
 11513        GO TO 3024-EDIT-DL21-CONT.
 11514
 11515     IF DVLO-RETURN-CODE EQUAL '01'
 11516        MOVE ER-8081               TO WS-ERROR
 11517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11518        GO TO 3024-EDIT-DL21-CONT.
 11519
 11520     IF DVLO-RETURN-CODE EQUAL '02'
 11521        MOVE ER-8082               TO WS-ERROR
 11522        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11523        GO TO 3024-EDIT-DL21-CONT.
 11524
 11525     IF DVLO-RETURN-CODE EQUAL '03'
 11526        MOVE ER-8083               TO WS-ERROR
 11527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11528        GO TO 3024-EDIT-DL21-CONT.
 11529
 11530     IF DVLO-RETURN-CODE EQUAL '04'
 11531        MOVE ER-8084               TO WS-ERROR
 11532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11533        GO TO 3024-EDIT-DL21-CONT.
 11534
 11535     IF DVLO-RETURN-CODE EQUAL '05'
 11536        MOVE ER-8085               TO WS-ERROR
 11537        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11538        GO TO 3024-EDIT-DL21-CONT.
 11539
 11540     MOVE ER-7825                  TO WS-ERROR
 11541     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11542     GO TO 3024-EDIT-DL21-CONT.
 11543
 11544 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 212
* EL050.cbl
 11546
 11547****************************************************************
 11548*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11549****************************************************************
 11550
 11551     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11552     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11553     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11554     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11555     IF DIPF-SUCCESSFUL-EDIT
 11556        GO TO 3024-EDIT-DL02-CONT.
 11557
 11558     IF DIPF-RETURN-CODE EQUAL '01'
 11559        MOVE ER-8086               TO WS-ERROR
 11560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11561        GO TO 3024-EDIT-DL02-CONT.
 11562
 11563     IF DIPF-RETURN-CODE EQUAL '02'
 11564        MOVE ER-8087               TO WS-ERROR
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL02-CONT.
 11567
 11568     IF DIPF-RETURN-CODE EQUAL '03'
 11569        MOVE ER-8088               TO WS-ERROR
 11570        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11571        GO TO 3024-EDIT-DL02-CONT.
 11572
 11573     MOVE ER-8095                  TO WS-ERROR
 11574     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11575     GO TO 3024-EDIT-DL02-CONT.
 11576
 11577 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 213
* EL050.cbl
 11579
 11580****************************************************************
 11581*** VALIDATE BANK ID : DLO003                                ***
 11582****************************************************************
 11583
 11584     MOVE WK-GREG-CENT           TO WCG-CENT.
 11585     MOVE WK-GREG-YYMM           TO WCG-REST.
 11586     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11587        MOVE ER-8040               TO WS-ERROR
 11588        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11589
 11590     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11591     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11592     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11593     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11594     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11595     IF DVBI-SUCCESSFUL-EDIT
 11596        GO TO 3024-EDIT-DL03-CONT.
 11597
 11598     IF DVBI-RETURN-CODE EQUAL '01'
 11599        MOVE ER-8089               TO WS-ERROR
 11600        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        GO TO 3024-EDIT-DL03-CONT.
 11602
 11603     IF DVBI-RETURN-CODE EQUAL '02'
 11604        MOVE ER-8090               TO WS-ERROR
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11606        GO TO 3024-EDIT-DL03-CONT.
 11607
 11608     IF DVBI-RETURN-CODE EQUAL '03'
 11609        MOVE ER-8091               TO WS-ERROR
 11610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11611        GO TO 3024-EDIT-DL03-CONT.
 11612
 11613     IF DVBI-RETURN-CODE EQUAL '04'
 11614        MOVE ER-8092               TO WS-ERROR
 11615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11616        GO TO 3024-EDIT-DL03-CONT.
 11617
 11618     IF DVBI-RETURN-CODE EQUAL '05'
 11619        MOVE ER-8093               TO WS-ERROR
 11620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11621        GO TO 3024-EDIT-DL03-CONT.
 11622
 11623     IF DVBI-RETURN-CODE EQUAL '06'
 11624        MOVE ER-8094               TO WS-ERROR
 11625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11626        GO TO 3024-EDIT-DL03-CONT.
 11627
 11628     MOVE ER-8096                  TO WS-ERROR
 11629     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11630     GO TO 3024-EDIT-DL03-CONT.
 11631
 11632 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 214
* EL050.cbl
 11634
 11635     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11636        NEXT SENTENCE
 11637     ELSE
 11638        MOVE ER-8042               TO WS-ERROR
 11639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11640
 11641     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11642     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11643     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11644
 11645     IF DMPF-RETURN-CODE = '01'
 11646        MOVE ER-8067               TO WS-ERROR
 11647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11648        GO TO 3024-EDIT-DL01-CONT.
 11649
 11650     IF DMPF-RETURN-CODE = '02'
 11651        MOVE ER-8068               TO WS-ERROR
 11652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11653        GO TO 3024-EDIT-DL01-CONT.
 11654
 11655     IF DMPF-RETURN-CODE = '03'
 11656        MOVE ER-8069               TO WS-ERROR
 11657        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658        GO TO 3024-EDIT-DL01-CONT.
 11659
 11660     IF DMPF-RETURN-CODE = 'E1'
 11661        MOVE ER-8070               TO WS-ERROR
 11662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11663        GO TO 3024-EDIT-DL01-CONT.
 11664
 11665     IF DMPF-RETURN-CODE = 'N1'
 11666        MOVE ER-8071               TO WS-ERROR
 11667        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11668        GO TO 3024-EDIT-DL01-CONT.
 11669
 11670     IF DMPF-RETURN-CODE NOT = 'OK'
 11671        MOVE ER-8072               TO WS-ERROR
 11672        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11673
 11674 3024-EDIT-DL01-CONT.
 11675******************************************************************
 11676***  VALIDATES RATE CODES : DLO017                             ***
 11677******************************************************************
 11678
 11679      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11680      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11681      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11682      IF DVRC-SUCCESSFUL-EDIT
 11683        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11684        GO TO 3024-CHECK-VALID-RATE.
 11685
 11686      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11687
 11688      IF DVRC-RETURN-CODE EQUAL '01'
 11689         MOVE ER-7817                   TO WS-ERROR
 11690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11691         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 215
* EL050.cbl
 11692
 11693      IF DVRC-RETURN-CODE EQUAL '02'
 11694         MOVE ER-7818                   TO WS-ERROR
 11695         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11696         GO TO 3025-EDIT-REINSURANCE.
 11697
 11698      IF DVRC-RETURN-CODE EQUAL '03'
 11699         MOVE ER-7819                   TO WS-ERROR
 11700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11701         GO TO 3025-EDIT-REINSURANCE.
 11702
 11703       MOVE ER-7820                     TO WS-ERROR.
 11704       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11705       GO TO 3025-EDIT-REINSURANCE.
 11706
 11707******************************************************************
 11708***  GET PREMIUM RATES : DLO011                                ***
 11709******************************************************************
 11710
 11711 3024-CHECK-VALID-RATE.
 11712
 11713     IF VALID-RATE-CODE
 11714        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11715        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11716        MOVE SPACES                TO DPRB-RETURN-CODE
 11717        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11718     ELSE
 11719         GO TO 3025-EDIT-REINSURANCE.
 11720
 11721      IF DPRB-SUCCESSFUL-PROCESS
 11722         IF PB-VALID-LIFE
 11723             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11724             GO TO 3025-EDIT-REINSURANCE
 11725         ELSE
 11726             IF PB-VALID-AH
 11727                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11728                 GO TO 3025-EDIT-REINSURANCE.
 11729
 11730      IF DPRB-RETURN-CODE EQUAL '01'
 11731         MOVE ER-7812                   TO WS-ERROR
 11732         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11733         GO TO 3025-EDIT-REINSURANCE.
 11734
 11735      IF DPRB-RETURN-CODE EQUAL '02'
 11736         MOVE ER-7813                   TO WS-ERROR
 11737         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11738         GO TO 3025-EDIT-REINSURANCE.
 11739
 11740      IF DPRB-RETURN-CODE EQUAL '03'
 11741         MOVE ER-7814                   TO WS-ERROR
 11742         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11743         GO TO 3025-EDIT-REINSURANCE.
 11744
 11745      IF DPRB-RETURN-CODE EQUAL '04'
 11746         IF NOT DPRB-1ST-TIME
 11747            MOVE ER-7815                   TO WS-ERROR
 11748            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11749            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 216
* EL050.cbl
 11750          ELSE
 11751         IF PB-VALID-LIFE
 11752            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11753          ELSE
 11754            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11755         END-IF
 11756         MOVE SPACES                TO DOCC-RETURN-CODE
 11757         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11758         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11759         IF DOCC-RETURN-CODE = 'OK'
 11760             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11761             GO TO 3024-CHECK-VALID-RATE
 11762           ELSE
 11763             MOVE ER-7823               TO WS-ERROR
 11764             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11765             GO TO 3025-EDIT-REINSURANCE.
 11766
 11767       MOVE ER-7816                     TO WS-ERROR.
 11768       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11769       GO TO 3025-EDIT-REINSURANCE.
 11770
 11771**********   DMD CUSTOM CODE ABOVE    **********
 11772
 11773 3025-EDIT-REINSURANCE.
 11774     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11775         GO TO 3027-EDIT-CONTINUE.
 11776
 11777     MOVE LOW-VALUES               TO ERREIN-KEY.
 11778     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11779     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11780                                      REIN-CODE-2
 11781                                      REIN-CODE-3.
 11782     MOVE 'A'                      TO REIN-TYPE.
 11783
 11784     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11785
 11786     MOVE '3026' TO REIN-SW.
 11787     MOVE ' '                   TO WS-REIN-READ-SW.
 11788
 11789     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11790     IF REIN-TABLE-NOT-FOUND
 11791         GO TO 3026-NO-SPEC-TABLE.
 11792
 11793     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11794     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11795                                   WS-NSP-ST-CD-LF.
 11796     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11797                                   WS-NSP-ST-CD-AH.
 11798
 11799     GO TO 3040-EDIT-CONTINUE.
 11800
 11801 3026-NO-SPEC-TABLE.
 11802
 11803     MOVE ER-2664                TO WS-ERROR.
 11804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11805     GO TO 3040-EDIT-CONTINUE.
 11806
 11807 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 217
* EL050.cbl
 11808
 11809     IF PB-I-REIN-TABLE = SPACES
 11810       GO TO 3040-EDIT-CONTINUE.
 11811
 11812     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11813          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11814          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11815           GO TO 3040-EDIT-CONTINUE.
 11816
 11817     MOVE LOW-VALUES            TO ERREIN-KEY.
 11818     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11819     MOVE 'A'                   TO REIN-TYPE.
 11820     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11821
 11822     MOVE '3028'                TO REIN-SW.
 11823     MOVE ' '                   TO WS-REIN-READ-SW.
 11824
 11825     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11826     IF REIN-TABLE-NOT-FOUND
 11827         GO TO 3028-NO-REIN-TABLE.
 11828
 11829     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11830     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11831                                   WS-NSP-ST-CD-LF.
 11832     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11833                                   WS-NSP-ST-CD-AH.
 11834
 11835     GO TO 3040-EDIT-CONTINUE.
 11836
 11837 3028-NO-REIN-TABLE.
 11838
 11839     MOVE ER-2615                TO WS-ERROR.
 11840     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11841     GO TO 3040-EDIT-CONTINUE.
 11842
 11843 3040-EDIT-CONTINUE.
 11844
 11845     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11846         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11847
 11848     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11849         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11850
 11851     IF (NOT PB-REISSUED-CERT)
 11852        AND (NOT PB-MONTHLY-CERT)
 11853        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11854            MOVE '001'           TO PB-I-LF-TERM
 11855            MOVE 'M'             TO PB-I-INSURED-SEX.
 11856
 11857     IF (NOT PB-REISSUED-CERT)
 11858        AND (NOT PB-MONTHLY-CERT)
 11859        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11860            MOVE '001'           TO PB-I-AH-TERM
 11861            MOVE 'M'             TO PB-I-INSURED-SEX.
 11862
 11863 3040-EDIT-1ST-PMT-DT.
 11864     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11865     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 218
* EL050.cbl
 11866         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11867
 11868******************************************************************
 11869*                                                                *
 11870*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11871*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11872*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11873*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11874*                                                                *
 11875******************************************************************
 11876
 11877     IF PB-EFF-DT-PROCESSING
 11878        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11879                                    PB-I-LF-EXPIRE-DT
 11880                                    PB-I-AH-EXPIRE-DT
 11881        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11882        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11883        MOVE ZERO                TO DC-ELAPSED-DAYS
 11884        MOVE +1                  TO DC-ELAPSED-MONTHS
 11885        SET BIN-PLUS-ELAPSED     TO TRUE
 11886*       MOVE 6                   TO DC-OPTION-CODE
 11887        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11888        IF NO-CONVERSION-ERROR
 11889           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11890
 11891******************************************************************
 11892*                                                                *
 11893*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11894*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11895*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11896*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11897*                                                                *
 11898******************************************************************
 11899
 11900     IF PB-EXT-DAYS-PROCESSING
 11901          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11902                                         PB-I-LF-EXPIRE-DT
 11903                                         PB-I-AH-EXPIRE-DT
 11904          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11905          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11906          MOVE +1                     TO DC-ELAPSED-MONTHS
 11907          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11908          SET BIN-PLUS-ELAPSED        TO TRUE
 11909*         MOVE 6                      TO DC-OPTION-CODE
 11910          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11911          IF NO-CONVERSION-ERROR
 11912             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11913
 11914******************************************************************
 11915*                                                                *
 11916*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11917*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11918*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11919*        (EXPIRE DATE - (TERM -1))  *  -1.
 11920*                                                                *
 11921******************************************************************
 11922
 11923     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 219
* EL050.cbl
 11924        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11925           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11926              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11927              MOVE PB-I-AH-TERM      TO WS-TERM
 11928           ELSE
 11929              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11930              MOVE PB-I-LF-TERM      TO WS-TERM
 11931        ELSE
 11932           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11933              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11934              MOVE PB-I-LF-TERM      TO WS-TERM
 11935           ELSE
 11936              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11937              MOVE PB-I-AH-TERM      TO WS-TERM.
 11938
 11939     IF PB-EXPIRE-DT-PROCESSING
 11940        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11941        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11942        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11943        MOVE ZERO                TO DC-ELAPSED-DAYS
 11944                                    DC-ODD-DAYS-OVER
 11945          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11946          SET BIN-PLUS-ELAPSED    TO TRUE
 11947*         MOVE 6                  TO DC-OPTION-CODE
 11948          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11949          IF NO-CONVERSION-ERROR
 11950             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11951
 11952******************************************************************
 11953*                                                                *
 11954*            1ST PAYMENT DATE PROCESSING                         *
 11955*                                                                *
 11956******************************************************************
 11957
 11958     IF PB-1ST-PMT-DT-PROCESSING
 11959        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11960                                    PB-I-AH-EXPIRE-DT
 11961        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11962
 11963     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11964         NEXT SENTENCE
 11965     ELSE
 11966         MOVE ER-2680                 TO WS-ERROR
 11967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11968         GO TO 3060-ORIG-TERM-CHECK.
 11969
 11970     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11971     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11972     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11973*    MOVE 1                      TO DC-OPTION-CODE.
 11974     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11975                                    DC-ELAPSED-DAYS
 11976                                    DC-ODD-DAYS-OVER.
 11977
 11978     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11979
 11980     IF DATE-CONVERSION-ERROR
 11981        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 220
* EL050.cbl
 11982
 11983     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11984     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 11985        AND (WS-LF-COVERAGE-TYPE = 'L')
 11986        IF (DC-ELAPSED-MONTHS > 1)
 11987                      OR
 11988           ((DC-ELAPSED-MONTHS = 1)
 11989           AND (DC-ODD-DAYS-OVER > 0))
 11990           MOVE ER-2882          TO WS-ERROR
 11991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11992        END-IF
 11993     END-IF
 11994     if dc-elapsed-months > 0
 11995        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 11996        + dc-odd-days-over
 11997     end-if
 11998     IF PB-EXT-DAYS-PROCESSING
 11999        CONTINUE
 12000     ELSE
 12001        IF DC-ELAPSED-MONTHS = +0
 12002           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12003        ELSE
 12004           IF (WS-LF-EARNINGS-CALC = '4')
 12005              AND (DC-ELAPSED-MONTHS > ZERO)
 12006              AND (DC-ELAPSED-DAYS > ZERO)
 12007              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12008           ELSE
 12009              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12010                                 THRU 6499-EXIT
 12011              MOVE WS-ODD-DAYS-OVER
 12012                                 TO PB-I-EXTENTION-DAYS
 12013           END-IF
 12014        END-IF
 12015     END-IF
 12016******************************************************************
 12017*                                                                *
 12018*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12019*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12020*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12021*            AND ANY ODD DAYS.                                   *
 12022*                                                                *
 12023******************************************************************
 12024
 12025     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12026                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12027     IF WS-LF-EARNINGS-CALC NOT = '4'
 12028        IF DC-ELAPSED-DAYS > ZEROS
 12029           MOVE ER-2681          TO WS-ERROR
 12030           PERFORM 9900-ERROR-FORMAT
 12031                                 THRU 9900-EXIT
 12032        END-IF
 12033     END-IF
 12034
 12035     IF WS-LF-EARNINGS-CALC NOT = '4'
 12036        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12037           MOVE ER-2681          TO WS-ERROR
 12038           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12039
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 221
* EL050.cbl
 12040     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12041        (PB-I-LF-TERM NOT = ZERO) AND
 12042         NOT NO-LIFE-COVERAGE
 12043          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12044          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12045          IF WS-LF-EARNINGS-CALC = '4'
 12046             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12047             PB-I-PAY-FREQUENCY
 12048          END-IF
 12049          MOVE ZERO              TO DC-ELAPSED-DAYS
 12050                                    DC-ODD-DAYS-OVER
 12051          MOVE 1                 TO DC-END-OF-MONTH
 12052          SET BIN-PLUS-ELAPSED        TO TRUE
 12053*         MOVE 6                 TO DC-OPTION-CODE
 12054          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12055          IF NO-CONVERSION-ERROR
 12056             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12057             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12058                (WS-LF-SPECIAL-CALC-CD = 'L')
 12059                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12060                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12061                  MOVE +1             TO DC-ELAPSED-MONTHS
 12062                  SET BIN-PLUS-ELAPSED  TO TRUE
 12063*                 MOVE 6              TO DC-OPTION-CODE
 12064                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12065                  IF NO-CONVERSION-ERROR
 12066                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12067
 12068* okay, i had to move the new att age edit down here because the
 12069* expiration date could get recalculated and i need the exp date
 12070     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12071        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12072        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12073        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12074           AND ZEROS
 12075           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12076           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12077           SET ELAPSED-BETWEEN-BIN TO TRUE
 12078           PERFORM 8500-DATE-CONVERT
 12079                                 THRU 8500-EXIT
 12080           IF NO-CONVERSION-ERROR
 12081              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12082                 MOVE ER-2669       TO WS-ERROR
 12083*                PERFORM 9900-ERROR-FORMAT
 12084*                                THRU 9900-EXIT
 12085              END-IF
 12086           END-IF
 12087        ELSE
 12088           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12089           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12090              MOVE ER-2669       TO WS-ERROR
 12091*             PERFORM 9900-ERROR-FORMAT
 12092*                                THRU 9900-EXIT
 12093           ELSE
 12094              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12095                 MOVE ER-1570    TO WS-ERROR
 12096                 PERFORM 9900-ERROR-FORMAT
 12097                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 222
* EL050.cbl
 12098              END-IF
 12099           END-IF
 12100        END-IF
 12101        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12102           AND ZEROS
 12103           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12104           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12105           SET ELAPSED-BETWEEN-BIN TO TRUE
 12106           PERFORM 8500-DATE-CONVERT
 12107                                 THRU 8500-EXIT
 12108           IF NO-CONVERSION-ERROR
 12109              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12110                 MOVE ER-2669       TO WS-ERROR
 12111*                PERFORM 9900-ERROR-FORMAT
 12112*                                THRU 9900-EXIT
 12113              END-IF
 12114           END-IF
 12115        ELSE
 12116           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12117             (PB-I-LF-TERM / 12)
 12118           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12119              MOVE ER-2669       TO WS-ERROR
 12120*             PERFORM 9900-ERROR-FORMAT
 12121*                                THRU 9900-EXIT
 12122           ELSE
 12123              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12124                 MOVE ER-1571    TO WS-ERROR
 12125                 PERFORM 9900-ERROR-FORMAT
 12126                                 THRU 9900-EXIT
 12127              END-IF
 12128           END-IF
 12129        END-IF
 12130        IF WS-ERROR = ER-2669
 12131           PERFORM 9900-ERROR-FORMAT
 12132                                 THRU 9900-EXIT
 12133        END-IF
 12134     END-IF
 12135     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12136        (PB-I-AH-TERM NOT = ZERO) AND
 12137         NOT NO-AH-COVERAGE
 12138          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12139             AND (PB-COMPANY-ID = 'DCC')
 12140             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12141             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12142          ELSE
 12143             IF WS-LF-EARNINGS-CALC = '4'
 12144                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12145                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12146                PB-I-PAY-FREQUENCY
 12147             ELSE
 12148                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12149                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12150             END-IF
 12151          END-IF
 12152          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12153                                         DC-ODD-DAYS-OVER
 12154          MOVE 1                      TO DC-END-OF-MONTH
 12155          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 223
* EL050.cbl
 12156*         MOVE 6                      TO DC-OPTION-CODE
 12157          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12158          IF NO-CONVERSION-ERROR
 12159             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12160     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12161        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12162        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12163        IF PB-I-BIRTHDAY > LOW-VALUES
 12164           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12165           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12166           SET ELAPSED-BETWEEN-BIN TO TRUE
 12167           PERFORM 8500-DATE-CONVERT
 12168                                 THRU 8500-EXIT
 12169           IF NO-CONVERSION-ERROR
 12170              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12171                 MOVE ER-3054       TO WS-ERROR
 12172*                PERFORM 9900-ERROR-FORMAT
 12173*                                THRU 9900-EXIT
 12174              END-IF
 12175           END-IF
 12176        ELSE
 12177           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12178           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12179              MOVE ER-3054       TO WS-ERROR
 12180*             PERFORM 9900-ERROR-FORMAT
 12181*                                THRU 9900-EXIT
 12182           END-IF
 12183        END-IF
 12184        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12185           AND ZEROS
 12186           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12187           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12188           SET ELAPSED-BETWEEN-BIN TO TRUE
 12189           PERFORM 8500-DATE-CONVERT
 12190                                 THRU 8500-EXIT
 12191           IF NO-CONVERSION-ERROR
 12192              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12193                 MOVE ER-3054       TO WS-ERROR
 12194*                PERFORM 9900-ERROR-FORMAT
 12195*                                THRU 9900-EXIT
 12196              END-IF
 12197           END-IF
 12198        ELSE
 12199           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12200             (PB-I-AH-TERM / 12)
 12201           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12202              MOVE ER-3054       TO WS-ERROR
 12203*             PERFORM 9900-ERROR-FORMAT
 12204*                                THRU 9900-EXIT
 12205           END-IF
 12206        END-IF
 12207        IF WS-ERROR = ER-3054
 12208           PERFORM 9900-ERROR-FORMAT
 12209                                 THRU 9900-EXIT
 12210        END-IF
 12211     END-IF
 12212     MOVE SPACE                       TO DC-END-OF-MONTH.
 12213
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 224
* EL050.cbl
 12214     IF PB-COMPANY-ID = 'NCB'
 12215        GO TO 3040-EDIT-EXTENSION-DAYS.
 12216
 12217     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12218       AND
 12219        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12220        NEXT SENTENCE
 12221     ELSE
 12222        GO TO 3040-EDIT-EXTENSION-DAYS.
 12223
 12224     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12225        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12226        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12227     ELSE
 12228        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12229        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12230
 12231     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12232*    MOVE '1'      TO DC-OPTION-CODE
 12233     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12234     IF (NO-CONVERSION-ERROR)
 12235        AND (DC-ELAPSED-MONTHS > +1)
 12236        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12237        MOVE ER-2668   TO WS-ERROR
 12238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12239
 12240 3040-EDIT-EXTENSION-DAYS.
 12241
 12242     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12243        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12244         GO TO 3050-EDIT-TERM-IN-DAYS
 12245     ELSE
 12246         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12247
 12248     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12249         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12250     ELSE
 12251        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12252           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12253           MOVE ER-2681         TO WS-ERROR
 12254           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12255
 12256     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12257        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12258        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12259         GO TO 3060-ORIG-TERM-CHECK.
 12260
 12261     GO TO 3060-ORIG-TERM-CHECK.
 12262
 12263 3050-EDIT-TERM-IN-DAYS.
 12264
 12265     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12266
 12267     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12268         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12269     ELSE
 12270         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12271            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 225
* EL050.cbl
 12272            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12273
 12274     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12275                                       REMAINDER WS-WORK-TERM.
 12276     IF WS-WORK-TERM GREATER THAN ZERO
 12277         ADD +1 TO PB-I-LF-TERM.
 12278
 12279     IF NOT NO-AH-COVERAGE
 12280         MOVE ER-2684            TO WS-ERROR
 12281         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12282
 12283
 12284 3060-ORIG-TERM-CHECK.
 12285
 12286******************************************************************
 12287*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12288******************************************************************
 12289
 12290     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12291        NEXT SENTENCE
 12292     ELSE
 12293        IF NOT NO-LIFE-COVERAGE
 12294           IF PB-I-LF-TERM NUMERIC
 12295              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12296              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12297              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12298                  NEXT SENTENCE
 12299           ELSE
 12300              MOVE ER-2647       TO WS-ERROR
 12301              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12302
 12303     IF NOT NO-AH-COVERAGE
 12304         IF PB-I-AH-TERM NUMERIC
 12305            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12306            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12307            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12308             NEXT SENTENCE
 12309          ELSE
 12310              MOVE ER-2658       TO WS-ERROR
 12311              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12312
 12313     IF PB-COMPANY-ID = 'NCB'
 12314        GO TO 3070-LOAN-TERM-CHECK.
 12315
 12316     IF POLICY-HAS-AH
 12317       AND
 12318        POLICY-HAS-LIFE
 12319       AND
 12320        PB-I-LF-TERM NUMERIC
 12321       AND
 12322        PB-I-AH-TERM NUMERIC
 12323        NEXT SENTENCE
 12324     ELSE
 12325        GO TO 3070-LOAN-TERM-CHECK.
 12326
 12327     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12328     IF WS-TEX-FACT-2 LESS THAN +0
 12329        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 226
* EL050.cbl
 12330
 12331     IF WS-TEX-FACT-2 GREATER THAN +1
 12332        MOVE ER-2668             TO WS-ERROR
 12333        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12334
 12335 3070-LOAN-TERM-CHECK.
 12336
 12337     IF (WS-LF-BENEFIT-CD = ZERO)
 12338         OR (NO-LF-BENEFIT-MATCH)
 12339            GO TO 3125-EDIT-PMT-FREQ.
 12340*    IF PB-COMPANY-ID NOT = 'DCC'
 12341*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12342*          AND 'V' AND 'W' AND 'X'
 12343*          GO TO 3125-EDIT-PMT-FREQ
 12344*       END-IF
 12345*    ELSE
 12346*       IF WS-AH-DCC-TRUNC = 'T'
 12347*          CONTINUE
 12348*       ELSE
 12349*          GO TO 3125-EDIT-PMT-FREQ
 12350*       END-IF
 12351*    END-IF
 12352     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12353                    OR
 12354        ((PB-COMPANY-ID = 'DCC')
 12355        AND (WS-AH-DCC-TRUNC = 'T'))
 12356        CONTINUE
 12357     ELSE
 12358        GO TO 3125-EDIT-PMT-FREQ
 12359     END-IF
 12360     IF PB-I-LOAN-TERM NOT NUMERIC
 12361         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12362
 12363     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12364        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12365*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12366        PB-I-LOAN-TERM NOT GREATER THAN +360
 12367         NEXT SENTENCE
 12368     ELSE
 12369         MOVE ER-2648            TO WS-ERROR
 12370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12371
 12372     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12373        MOVE ER-3058             TO WS-ERROR
 12374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12375     end-if
 12376
 12377     IF WS-STATE-ABBREVIATION = 'NC'
 12378        IF PB-I-LOAN-TERM > +59
 12379           CONTINUE
 12380        ELSE
 12381           MOVE ER-2792          TO WS-ERROR
 12382           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12383        END-IF
 12384     END-IF
 12385
 12386     .
 12387 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 227
* EL050.cbl
 12388     IF (WS-LF-BENEFIT-CD = ZERO)
 12389         OR (NO-LF-BENEFIT-MATCH)
 12390            GO TO 3127-EDIT-LOAN-OFFICER.
 12391     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12392                    OR
 12393        ((PB-COMPANY-ID = 'DCC')
 12394        AND (WS-AH-DCC-TRUNC = 'T'))
 12395                    OR
 12396         (PB-COMPANY-ID = 'AHL')
 12397        CONTINUE
 12398     ELSE
 12399        IF (PB-I-LOAN-TERM > ZEROS)
 12400           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12401           MOVE ER-1575          TO WS-ERROR
 12402           PERFORM 9900-ERROR-FORMAT
 12403                                 THRU 9900-EXIT
 12404        END-IF
 12405     END-IF
 12406     IF WS-LF-EARNINGS-CALC NOT = '4'
 12407         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12408            MOVE ER-2653         TO WS-ERROR
 12409            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12410            GO TO 3127-EDIT-LOAN-OFFICER
 12411         ELSE
 12412            GO TO 3127-EDIT-LOAN-OFFICER.
 12413
 12414     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12415         MOVE ER-2655            TO WS-ERROR
 12416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12417         GO TO 3127-EDIT-LOAN-OFFICER.
 12418
 12419     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12420         MOVE ER-2654            TO WS-ERROR
 12421         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12422         GO TO 3127-EDIT-LOAN-OFFICER.
 12423
 12424     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12425         GIVING WS-TEX-FACT-2
 12426             REMAINDER WS-TEX-FACT-3.
 12427
 12428*    IF WS-TEX-FACT-3 NOT = ZERO
 12429*       MOVE ER-2654             TO WS-ERROR
 12430*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12431
 12432
 12433 3127-EDIT-LOAN-OFFICER.
 12434
 12435     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12436        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12437           MOVE ER-2690          TO WS-ERROR
 12438           PERFORM 9900-ERROR-FORMAT
 12439                                 THRU 9900-EXIT
 12440        ELSE
 12441           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12442           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12443           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12444           MOVE PB-SV-STATE      TO LOFC-STATE
 12445           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 228
* EL050.cbl
 12446           MOVE PB-I-LOAN-OFFICER
 12447                                 TO LOFC-CODE
 12448           PERFORM 8586-READ-LOAN-OFFICER
 12449                                 THRU 8586-EXIT
 12450           IF (NOT LOFC-MASTER-FOUND)
 12451              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12452              MOVE ER-3006       TO WS-ERROR
 12453              PERFORM 9900-ERROR-FORMAT
 12454                                 THRU 9900-EXIT
 12455           END-IF
 12456        END-IF
 12457     END-IF
 12458     .
 12459 3129-EDIT-APR.
 12460
 12461     IF (WS-LF-BENEFIT-CD = ZERO)
 12462        OR (NO-LF-BENEFIT-MATCH)
 12463        IF PB-COMPANY-ID NOT = 'DCC'
 12464           GO TO 3130-EDIT-AGE
 12465*       ELSE
 12466*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12467*             GO TO 3130-EDIT-AGE
 12468*          END-IF
 12469        END-IF
 12470     END-IF
 12471
 12472     IF (WS-STATE-ABBREVIATION = 'OH')
 12473         AND (PB-I-RATE-CLASS NOT = 'L ')
 12474         AND (PB-I-LF-TERM GREATER THAN 60)
 12475         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12476         GO TO 3129-APR-CONT.
 12477
 12478     IF (WS-STATE-ABBREVIATION = 'RI')
 12479         AND (PB-I-LF-TERM GREATER THAN 60)
 12480         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12481         GO TO 3129-APR-CONT.
 12482
 12483     IF (WS-STATE-ABBREVIATION = 'UT')
 12484         AND (PB-I-LF-TERM GREATER THAN 62)
 12485         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12486         AND (PB-CERT-EFF-DT LESS WS-830901)
 12487         GO TO 3129-APR-CONT.
 12488
 12489     IF PB-COMPANY-ID = 'LAP'
 12490        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12491           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12492              MOVE ER-2656         TO WS-ERROR
 12493              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12494              GO TO 3130-EDIT-AGE.
 12495
 12496     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12497        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12498        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12499        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12500        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12501        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12502         GO TO 3130-EDIT-AGE.
 12503
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 229
* EL050.cbl
 12504 3129-APR-CONT.
 12505     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12506         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12507         GO TO 3130-EDIT-AGE.
 12508
 12509     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12510         WS-AH-BENEFIT-CD (1:1) = 'S')
 12511        AND (PB-COMPANY-ID = 'DCC')
 12512        AND (PB-I-LOAN-APR = ZERO)
 12513        MOVE ER-2657             TO WS-ERROR
 12514        PERFORM 9900-ERROR-FORMAT
 12515                                 THRU 9900-EXIT
 12516        GO TO 3130-EDIT-AGE
 12517     END-IF
 12518*    IF PB-I-LOAN-APR = ZERO
 12519*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12520*    END-IF
 12521
 12522     if pb-i-loan-apr = +99.9999
 12523        move er-2656             to ws-error
 12524        PERFORM 9900-ERROR-FORMAT
 12525                                 THRU 9900-EXIT
 12526        GO TO 3130-EDIT-AGE
 12527     end-if
 12528*    IF PB-I-LOAN-APR = ZERO
 12529*       MOVE ER-2656             TO WS-ERROR
 12530*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12531*       GO TO 3130-EDIT-AGE.
 12532
 12533*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12534     if pb-i-loan-apr not = +99.9999
 12535        IF PB-I-LOAN-APR > +30.000
 12536           MOVE ER-2657          TO WS-ERROR
 12537           PERFORM 9900-ERROR-FORMAT
 12538                                 THRU 9900-EXIT
 12539        end-if
 12540     end-if
 12541     .
 12542 3130-EDIT-AGE.
 12543
 12544******************************************************************
 12545*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12546******************************************************************
 12547
 12548     IF NOT NO-LIFE-COVERAGE
 12549        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12550           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12551               MOVE ER-2628             TO WS-ERROR
 12552               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12553
 12554     IF NOT NO-AH-COVERAGE
 12555        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12556           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12557               MOVE ER-2628         TO WS-ERROR
 12558               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12559
 12560 3133-SEX-CODE.
 12561     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 230
* EL050.cbl
 12562         IF WS-DEFAULT-SEX = 'M'
 12563             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12564          ELSE
 12565             IF WS-DEFAULT-SEX = 'F'
 12566             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12567
 12568     IF PB-I-INSURED-SEX = '1'
 12569         MOVE 'M' TO PB-I-INSURED-SEX.
 12570
 12571     IF PB-I-INSURED-SEX = '2'
 12572         MOVE 'F' TO PB-I-INSURED-SEX.
 12573
 12574 3134-SIG-SW-EDIT.
 12575     IF PB-I-SIG-SW = SPACE
 12576         MOVE 'N'                TO  PB-I-SIG-SW.
 12577
 12578     IF PB-COMPANY-ID = 'NCL'
 12579         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12580             NEXT SENTENCE
 12581         ELSE
 12582             MOVE ER-1923        TO  WS-ERROR
 12583             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12584     ELSE
 12585     IF PB-COMPANY-ID = 'CRI'
 12586         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12587             NEXT SENTENCE
 12588         ELSE
 12589             MOVE ER-2606        TO  WS-ERROR
 12590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12591     ELSE
 12592     IF PB-COMPANY-ID = 'TMS'
 12593         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12594             NEXT SENTENCE
 12595         ELSE
 12596             MOVE ER-2689        TO  WS-ERROR
 12597             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12598     ELSE
 12599         IF PB-I-SIG-SW = 'Y' OR 'N'
 12600             NEXT SENTENCE
 12601         ELSE
 12602             MOVE ER-2651        TO  WS-ERROR
 12603             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12604
 12605     IF PB-COMPANY-ID = 'FLA'
 12606         IF (WS-EDIT-AGE GREATER 54  OR
 12607             WS-AH-EDIT-AGE GREATER 54)  AND
 12608            PB-I-SIG-SW = 'N'
 12609            MOVE ER-2651         TO  WS-ERROR
 12610            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12611
 12612 3135-NAME-EDIT.
 12613
 12614     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12615        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12616        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12617           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12618                                 TO PB-I-JOINT-FIRST-NAME
 12619        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 231
* EL050.cbl
 12620     END-IF
 12621     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12622        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12623        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12624           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12625                                 TO PB-I-JOINT-LAST-NAME
 12626        END-PERFORM
 12627     END-IF
 12628     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12629        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12630        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12631           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12632                                 TO PB-I-INSURED-FIRST-NAME
 12633        END-PERFORM
 12634     END-IF
 12635     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12636        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12637        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12638           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12639                                 TO PB-I-INSURED-LAST-NAME
 12640        END-PERFORM
 12641     END-IF
 12642     IF PB-I-INSURED-LAST-NAME = SPACES
 12643       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12644       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12645           MOVE ER-2660    TO WS-ERROR
 12646           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12647
 12648 3136-EDIT-SEX.
 12649
 12650******************************************************************
 12651*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12652******************************************************************
 12653
 12654     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12655        (WS-AH-SPECIAL-CALC-CD = 'O')
 12656        NEXT SENTENCE
 12657     ELSE
 12658        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12659           NEXT SENTENCE
 12660        ELSE
 12661           MOVE ER-2629            TO WS-ERROR
 12662           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12663
 12664 3137-EDIT-EFF-DATE.
 12665
 12666     IF PB-REISSUED-CERT       OR
 12667        PB-POLICY-IS-DECLINED  OR
 12668        PB-POLICY-IS-VOIDED
 12669         GO TO 3139-EDIT-COVERAGE-CODES.
 12670
 12671     MOVE SPACE                  TO WS-2671-SW
 12672                                    WS-2672-SW.
 12673
 12674     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12675         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12676             MOVE ER-2703        TO WS-ERROR
 12677             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 232
* EL050.cbl
 12678             GO TO 3139-EDIT-COVERAGE-CODES.
 12679
 12680     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12681         GO TO 3139-EDIT-COVERAGE-CODES.
 12682
 12683     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12684     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12685*    MOVE '1'                    TO DC-OPTION-CODE.
 12686     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12687     MOVE +0                     TO DC-ELAPSED-MONTHS
 12688                                    DC-ELAPSED-DAYS.
 12689     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12690
 12691     IF DATE-CONVERSION-ERROR
 12692         GO TO 3139-EDIT-COVERAGE-CODES.
 12693
 12694     IF DC-ELAPSED-DAYS GREATER +180
 12695         MOVE ER-2672            TO WS-ERROR
 12696         MOVE 'Y'                TO WS-2672-SW
 12697         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12698     END-IF
 12699
 12700     IF WS-ERROR = ER-2671  AND
 12701        PB-COMPANY-ID  = 'LBL'
 12702        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12703        MOVE SPACE               TO WS-2671-SW
 12704        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12705
 12706     IF PB-ISSUE-DATE-FORCED  AND
 12707      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12708         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12709         MOVE ER-2673            TO WS-ERROR
 12710         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12711         MOVE SPACE              TO WS-2671-SW
 12712                                    WS-2672-SW.
 12713
 12714     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12715         IF PB-ISSUE-DATE-FORCED
 12716             MOVE ER-2600          TO  WS-ERROR
 12717             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12718         ELSE
 12719             MOVE ER-2692          TO  WS-ERROR
 12720             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12721
 12722
 12723 3139-EDIT-COVERAGE-CODES.
 12724
 12725     if pb-company-id not = 'AHL'
 12726        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12727           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12728           MOVE ER-2787          TO WS-ERROR
 12729           PERFORM 9900-ERROR-FORMAT
 12730                                 THRU 9900-EXIT
 12731        END-IF
 12732     end-if
 12733     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12734        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12735                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 233
* EL050.cbl
 12736           MOVE ER-2719          TO WS-ERROR
 12737           PERFORM 9900-ERROR-FORMAT
 12738                                 THRU 9900-EXIT
 12739        END-IF
 12740     END-IF
 12741
 12742     IF PB-POLICY-IS-DECLINED  OR
 12743        PB-POLICY-IS-VOIDED
 12744         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12745
 12746     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12747        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12748         MOVE ER-2630                TO WS-ERROR
 12749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12750
 12751     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12752        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12753        PB-I-LF-PREMIUM-AMT = ZERO
 12754         GO TO 3140-CHECK-AH-FOR-ZERO.
 12755
 12756     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12757        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12758        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12759         GO TO 3140-CHECK-AH-FOR-ZERO.
 12760
 12761     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12762        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12763        MOVE ER-2631             TO WS-ERROR
 12764        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12765     END-IF
 12766
 12767
 12768******************************************************************
 12769*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12770******************************************************************
 12771
 12772     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12773        NEXT SENTENCE
 12774     ELSE
 12775        IF PB-I-LF-BENEFIT-AMT = ZERO
 12776           MOVE ER-2632             TO WS-ERROR
 12777           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12778
 12779
 12780******************************************************************
 12781*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12782******************************************************************
 12783
 12784     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12785        CONTINUE
 12786     ELSE
 12787        IF PB-I-LF-PREMIUM-AMT = ZERO
 12788           IF (NOT PB-COMP-LF-PREM)
 12789              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12790              MOVE ER-2633       TO WS-ERROR
 12791              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12792           END-IF
 12793        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 234
* EL050.cbl
 12794     END-IF
 12795     .
 12796 3140-CHECK-AH-FOR-ZERO.
 12797
 12798     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12799        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12800        PB-I-AH-PREMIUM-AMT = ZERO
 12801         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12802
 12803     IF PB-COMPANY-ID = 'CSL'  AND
 12804        PB-I-AH-BENEFIT-CD = ZERO  AND
 12805        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12806        PB-I-AH-PREMIUM-AMT = ZERO
 12807         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12808
 12809     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12810        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12811        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12812         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12813
 12814     IF PB-I-AH-BENEFIT-CD = ZERO
 12815         MOVE ER-2634            TO WS-ERROR
 12816         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12817
 12818******************************************************************
 12819*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12820******************************************************************
 12821
 12822     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12823        NEXT SENTENCE
 12824     ELSE
 12825        IF PB-I-AH-BENEFIT-AMT = ZERO
 12826           MOVE ER-2635             TO WS-ERROR
 12827           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12828
 12829******************************************************************
 12830*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12831******************************************************************
 12832
 12833     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12834        NEXT SENTENCE
 12835     ELSE
 12836        IF PB-I-AH-PREMIUM-AMT = ZERO
 12837            IF NOT PB-COMP-AH-PREM
 12838                MOVE ER-2636    TO WS-ERROR
 12839                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12840
 12841
 12842 3140-EDIT-MAX-AMT-SIZES.
 12843* CUSTOM CODE FOR CLIENT    'DMD'
 12844     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12845                                     WS-RES-MUNI-TAX
 12846                                     PB-I-STATE-TAX
 12847                                     PB-I-MUNI-TAX.
 12848
 12849     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12850
 12851     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 235
* EL050.cbl
 12852        GO TO 3150-RATE-OUTSTAND-BAL.
 12853
 12854     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12855        GO TO 3150-RATE-OUTSTAND-BAL.
 12856
 12857     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12858        GO TO 3150-RATE-OUTSTAND-BAL.
 12859
 12860     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12861                             OR 'RIC')
 12862        GO TO 3150-RATE-OUTSTAND-BAL.
 12863
 12864     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12865        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12866            GO TO 3150-RATE-OUTSTAND-BAL
 12867        ELSE
 12868           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12869               GO TO 3150-RATE-OUTSTAND-BAL.
 12870
 12871     IF NOT PB-NO-MONTHS-SKIPPED
 12872        GO TO 3150-RATE-OUTSTAND-BAL.
 12873
 12874     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12875        GO TO 3150-RATE-OUTSTAND-BAL.
 12876
 12877     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12878        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12879           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12880             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12881           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12882           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12883              MOVE ER-2693     TO WS-ERROR
 12884              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12885              GO TO 3150-RATE-OUTSTAND-BAL
 12886           ELSE
 12887              GO TO 3150-RATE-OUTSTAND-BAL.
 12888
 12889 3150-RATE-OUTSTAND-BAL.
 12890
 12891* DMD RATING TEST
 12892     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12893         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12894         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12895         MOVE ER-2687                 TO WS-ERROR
 12896         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12897         MOVE 'B'                     TO PB-I-OB-FLAG
 12898         GO TO 3260-EDIT-CONTINUE.
 12899
 12900     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12901         IF  WS-ERROR    EQUAL    ER-2693
 12902             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12903                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12904                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12905                 MOVE  +0            TO  WS-ERROR.
 12906
 12907     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12908         IF  WS-ERROR    EQUAL    ER-2693
 12909             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 236
* EL050.cbl
 12910                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12911                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12912                 MOVE  +0            TO  WS-ERROR.
 12913
 12914     IF PLAN-MASTER-AH-SW = 'Y'
 12915        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12916            IF  WS-ERROR    EQUAL    ER-2693
 12917              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12918                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12919                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12920                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12921                 MOVE  ER-1910           TO  WS-ERROR
 12922                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12923
 12924     IF PLAN-MASTER-AH-SW = 'Y'
 12925        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12926            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12927               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12928               MOVE  ER-1910           TO  WS-ERROR
 12929               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12930
 12931     IF PLAN-MASTER-AH-SW = 'Y'
 12932        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12933            IF  WS-ERROR    EQUAL    ER-2693
 12934                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12935                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12936                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12937                 MOVE  +0       TO  WS-ERROR.
 12938
 12939     IF WS-ERROR = ER-2693
 12940        IF PB-COMPANY-ID = 'JAL' AND
 12941           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12942           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12943           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12944
 12945     IF WS-ERROR = ER-2693
 12946        IF PB-COMPANY-ID = 'NCL'  AND
 12947           PB-I-AH-BENEFIT-CD = 'OA'
 12948           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12949           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12950
 12951     IF WS-ERROR = ER-2693
 12952        IF PB-COMPANY-ID = 'CNL' AND
 12953           PB-I-LF-BENEFIT-CD = '71' OR '72'
 12954           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12955           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12956
 12957     IF WS-ERROR = ER-2693
 12958        IF PB-COMPANY-ID = 'HER'
 12959           IF WS-LEVEL
 12960              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12961              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12962
 12963     IF ((LF-BENEFIT-FOUND) AND
 12964         (NOT NO-LIFE-COVERAGE)  AND
 12965         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12966       OR   ((AH-BENEFIT-FOUND) AND
 12967             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 237
* EL050.cbl
 12968             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12969         NEXT SENTENCE
 12970     ELSE
 12971         GO TO 3215-EDIT-RATES.
 12972
 12973     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12974        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12975           MOVE ER-2674          TO WS-ERROR
 12976           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12977           GO TO 3215-EDIT-RATES.
 12978
 12979     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12980        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12981           MOVE ER-2674          TO WS-ERROR
 12982           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12983           GO TO 3215-EDIT-RATES.
 12984
 12985     MOVE 'B'                    TO PB-I-OB-FLAG.
 12986
 12987     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12988         NEXT SENTENCE
 12989     ELSE
 12990         IF NOT NO-LIFE-COVERAGE
 12991             IF WS-ACCT-LF-OB-RT = ZERO
 12992                MOVE ER-2641    TO WS-ERROR
 12993                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12994
 12995     IF PB-COMPANY-ID = 'CRI'
 12996       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12997         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12998         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12999         IF WS-ERROR = ER-2675
 13000            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13001            MOVE ER-2687              TO WS-ERROR
 13002            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13003         ELSE
 13004            MOVE ER-2687              TO WS-ERROR
 13005            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13006
 13007
 13008     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13009         NEXT SENTENCE
 13010     ELSE
 13011       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13012            NEXT SENTENCE
 13013       ELSE
 13014         IF NOT NO-AH-COVERAGE
 13015             IF WS-ACCT-AH-OB-RT = ZERO
 13016                MOVE ER-2642    TO WS-ERROR
 13017                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13018
 13019     IF PB-COMPANY-ID = 'CRI'
 13020       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13021         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13022         IF WS-ERROR = ER-2676
 13023            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13024            MOVE ER-2687              TO WS-ERROR
 13025            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 238
* EL050.cbl
 13026         ELSE
 13027            MOVE ER-2687              TO WS-ERROR
 13028            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13029
 13030     IF PB-COMPANY-ID NOT = 'GIC'
 13031         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13032            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13033     ELSE
 13034         IF PB-I-LF-PREM-CALC = ZEROS
 13035             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13036                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13037
 13038     IF PB-COMPANY-ID NOT = 'GIC'
 13039         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13040            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13041     ELSE
 13042         IF PB-I-AH-PREM-CALC = ZEROS
 13043             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13044                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13045
 13046     MOVE ZEROS TO PB-I-MORT-CODE.
 13047
 13048     GO TO 3260-EDIT-CONTINUE.
 13049
 13050
 13051 3215-EDIT-RATES.
 13052     IF ACCOUNT-MAST-FOUND
 13053         NEXT SENTENCE
 13054     ELSE
 13055         GO TO 3999-END-EDIT.
 13056
 13057 3220-CHECK-LF-RATES.
 13058
 13059     IF PB-COMPANY-ID = 'DCC'
 13060        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13061        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13062        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13063           AND (NOT WS-LF-CASH))
 13064                           OR
 13065           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13066           AND (NOT WS-AH-CASH)))
 13067                       AND
 13068           (PB-I-ENTRY-STATUS NOT = '5')
 13069           MOVE 'M'              TO PB-BATCH-ENTRY
 13070                                    PB-I-ENTRY-STATUS
 13071        END-IF
 13072     END-IF
 13073     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13074                                    PB-I-AH-PREM-CALC
 13075                                    PB-I-LF-ALT-PREM-CALC
 13076                                    PB-I-LF-ALT-RATE
 13077                                    PB-I-LF-REI-RATE
 13078                                    PB-I-LF-ALT-REI-RATE
 13079                                    PB-I-AH-REI-RATE
 13080                                    PB-I-TOT-FEES-CALC.
 13081
 13082     IF PB-COMPANY-ID EQUAL 'DMD'
 13083        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 239
* EL050.cbl
 13084     ELSE
 13085        MOVE ZEROS               TO PB-I-LF-RATE
 13086                                    PB-I-AH-RATE.
 13087
 13088     IF PB-I-TOT-FEES NOT NUMERIC
 13089        MOVE ZEROS               TO PB-I-TOT-FEES
 13090     END-IF
 13091     IF PB-I-LIVES NOT NUMERIC
 13092         MOVE ZERO               TO PB-I-LIVES.
 13093
 13094     IF PB-I-NUM-BILLED NOT NUMERIC
 13095         MOVE ZERO               TO PB-I-NUM-BILLED.
 13096
 13097     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13098        MOVE +0                  TO PB-I-LF-PREM-TAX
 13099     END-IF
 13100
 13101     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13102        MOVE +0                  TO PB-I-AH-PREM-TAX
 13103     END-IF
 13104
 13105     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13106        PB-I-PAY-FREQUENCY = ZEROS
 13107            MOVE 12 TO CP-PAY-FREQUENCY
 13108     ELSE
 13109            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13110
 13111     IF PB-I-STATE-TAX NOT NUMERIC
 13112         MOVE ZEROS               TO PB-I-STATE-TAX.
 13113
 13114     IF PB-I-MUNI-TAX NOT NUMERIC
 13115         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13116
 13117     MOVE SPACES                 TO CP-BEN-CATEGORY
 13118     IF PB-COMPANY-ID  = 'CSL'  AND
 13119        PB-I-LF-TERM NOT = ZERO
 13120        COMPUTE WS-PAYMENT-AMT =
 13121             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13122        COMPUTE WS-CSL-AMT1 =
 13123             PB-I-LF-TERM * AM-MAX-MON-BEN
 13124        COMPUTE WS-CSL-AMT2 =
 13125             WS-PAYMENT-AMT * PB-I-LF-TERM
 13126        IF CP-PAY-FREQUENCY NOT = 12
 13127           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13128           MOVE '8' TO WS-CSL-CALC-CD
 13129        ELSE
 13130           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13131              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13132               AM-MAX-TOT-BEN
 13133               MOVE '6' TO WS-CSL-CALC-CD
 13134           ELSE
 13135              IF (WS-CSL-AMT1  GREATER THAN
 13136                 AM-MAX-TOT-BEN) AND
 13137                 (WS-CSL-AMT2  GREATER THAN
 13138                 AM-MAX-TOT-BEN)
 13139                 MOVE '7' TO WS-CSL-CALC-CD
 13140              ELSE
 13141                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 240
* EL050.cbl
 13142
 13143     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13144         NEXT SENTENCE
 13145     ELSE
 13146         GO TO 3300-CHECK-AH-RATES.
 13147
 13148*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13149
 13150     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13151        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13152              OR
 13153           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13154           MOVE ER-2618          TO WS-ERROR
 13155           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13156           GO TO 3300-CHECK-AH-RATES.
 13157
 13158     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13159           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13160                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13161
 13162     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13163         MOVE ER-2687             TO WS-ERROR
 13164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165         MOVE 'Z000'              TO PB-I-MORT-CODE
 13166         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13167         GO TO 3300-CHECK-AH-RATES.
 13168
 13169     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13170        IF PB-I-LIVES = ZERO
 13171           MOVE ER-2688          TO WS-ERROR
 13172           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13173
 13174     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13175
 13176     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13177     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13178     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13179     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13180     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13181     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13182     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13183     MOVE '3'                    TO CP-PROCESS-TYPE.
 13184     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13185     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13186
 13187******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13188     IF PB-COMPANY-ID EQUAL 'CDL'
 13189         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13190            CP-EARN-AS-NET-PAY)
 13191             IF PB-CERT-EFF-DT GREATER  WS-931231
 13192                 MOVE '1'        TO CP-EARNING-METHOD.
 13193*******
 13194
 13195     MOVE PB-SV-STATE            TO CP-STATE.
 13196     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13197     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13198     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13199     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 241
* EL050.cbl
 13200     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13201                                    CP-RATING-BENEFIT-AMT.
 13202     IF CP-STATE-STD-ABBRV = 'OR'
 13203         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13204                                         PB-I-LF-ALT-BENEFIT-AMT.
 13205     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13206     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13207     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13208     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13209     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13210     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13211     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13212     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13213     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13214                                    CP-REMAINING-TERM
 13215                                    CP-LOAN-TERM.
 13216
 13217     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13218         NEXT SENTENCE
 13219     ELSE
 13220         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13221             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13222                                           PB-I-LF-PREMIUM-AMT.
 13223
 13224     IF PB-COMPANY-ID EQUAL 'CSL'
 13225        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13226           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13227                                         PB-I-LF-PREMIUM-AMT.
 13228
 13229     IF PB-COMPANY-ID EQUAL 'NCB'
 13230         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13231            CP-EARN-AS-NET-PAY
 13232             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13233                 PB-I-LF-PREMIUM-AMT.
 13234
 13235     IF (CP-TRUNCATED-LIFE)
 13236        or ((pb-company-id = 'AHL')
 13237           and (pb-i-loan-term > pb-i-lf-term))
 13238        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13239
 13240     IF PB-COMPANY-ID EQUAL 'CRI'
 13241        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13242
 13243     IF CP-TERM-IS-DAYS
 13244         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13245     ELSE
 13246         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13247     IF PB-COMPANY-ID = 'DCC'
 13248        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13249        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13250        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13251        IF WS-LF-BEN-CATEGORY = 'D'
 13252           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13253           MOVE PB-I-LIFE-COMMISSION
 13254                                 TO CP-DCC-ACT-COMM
 13255           MOVE WS-LF-BEN-CATEGORY
 13256                                 TO CP-BEN-CATEGORY
 13257        END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 242
* EL050.cbl
 13258        IF (CP-BENEFIT-CD (1:1) = 'P')
 13259           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13260           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13261           add pb-i-ah-premium-amt to cp-original-premium
 13262        END-IF
 13263     END-IF
 13264     IF PB-COMPANY-ID = 'CSL'
 13265         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13266         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13267         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13268
 13269     IF PB-COMPANY-ID = 'CSL'
 13270        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13271
 13272     IF (CP-SPECIAL-CALC-CD = 'H')
 13273        OR (PB-COMPANY-ID = 'DCC')
 13274         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13275                                    TO CP-ALTERNATE-BENEFIT
 13276         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13277
 13278     IF (PB-COMPANY-ID = 'CID')
 13279        AND (WS-LF-EARNINGS-CALC = 'B')
 13280        AND (CP-STATE-STD-ABBRV = 'MN')
 13281        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13282                                 TO CP-ALTERNATE-BENEFIT
 13283        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13284     END-IF
 13285     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13286     MOVE 'R'                   TO CP-RATE-FILE.
 13287     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13288
 13289     IF CP-ERROR-RATE-NOT-FOUND
 13290        MOVE ER-2641            TO WS-ERROR
 13291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13292        GO TO 3300-CHECK-AH-RATES.
 13293
 13294     IF PB-COMPANY-ID EQUAL 'CRI'
 13295        IF CP-ERROR-NO-LIMITS-CRI
 13296           IF NOT ACCOUNT-LIFE-CHECKED
 13297              MOVE ER-2607      TO WS-ERROR
 13298              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13299
 13300******************************************************************
 13301*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13302*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13303******************************************************************
 13304
 13305* CALC LIFE AGE AT EXPIRATION.
 13306
 13307     COMPUTE WS-AGE-AT-EXPIRE =
 13308          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13309
 13310*    IF PB-STATE = 'CO' OR 'UT'
 13311*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13312*        MOVE 'F'            TO PB-FATAL-FLAG
 13313*        MOVE ER-2709        TO WS-ERROR
 13314*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13315*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 243
* EL050.cbl
 13316
 13317*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13318*        MOVE 'X'            TO PB-FATAL-FLAG
 13319*        MOVE ER-2718        TO WS-ERROR
 13320*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13321*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13322
 13323* CALC A & H AGE AT EXPIRATION.
 13324
 13325     COMPUTE WS-AGE-AT-EXPIRE =
 13326          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13327
 13328*    IF PB-STATE = 'CO' OR 'UT'
 13329*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13330*        MOVE 'F'            TO PB-FATAL-FLAG
 13331*        MOVE ER-2709        TO WS-ERROR
 13332*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13333*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13334
 13335*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13336*        MOVE 'X'            TO PB-FATAL-FLAG
 13337*        MOVE ER-2718        TO WS-ERROR
 13338*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13339*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13340
 13341     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13342        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13343
 13344     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13345        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13346
 13347     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13348        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13349
 13350     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13351         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13352         MOVE ER-2639        TO WS-ERROR
 13353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13354
 13355
 13356******************************************************************
 13357*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13358******************************************************************
 13359
 13360 PREMIUM-EDITING-IS-BYPASSED.
 13361     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13362        AND (CP-R-MAX-ATT-AGE > +0)
 13363        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13364        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13365           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13366           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13367           MOVE '1'              TO DC-OPTION-CODE
 13368           PERFORM 8500-DATE-CONVERT
 13369                                 THRU 8500-EXIT
 13370           IF NO-CONVERSION-ERROR
 13371              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13372                 MOVE ER-2661       TO WS-ERROR
 13373*                PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 244
* EL050.cbl
 13374*                                THRU 9900-EXIT
 13375              END-IF
 13376           END-IF
 13377        ELSE
 13378           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13379           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13380              MOVE ER-2661       TO WS-ERROR
 13381*             PERFORM 9900-ERROR-FORMAT
 13382*                                THRU 9900-EXIT
 13383           ELSE
 13384              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13385                 MOVE ER-1570    TO WS-ERROR
 13386                 PERFORM 9900-ERROR-FORMAT
 13387                                 THRU 9900-EXIT
 13388              END-IF
 13389           END-IF
 13390        END-IF
 13391        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13392           MOVE PB-I-JOINT-BIRTHDAY
 13393                                 TO DC-BIN-DATE-1
 13394           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13395           MOVE '1'              TO DC-OPTION-CODE
 13396           PERFORM 8500-DATE-CONVERT
 13397                                 THRU 8500-EXIT
 13398           IF NO-CONVERSION-ERROR
 13399              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13400                 MOVE ER-2661       TO WS-ERROR
 13401*                PERFORM 9900-ERROR-FORMAT
 13402*                                THRU 9900-EXIT
 13403              END-IF
 13404           ELSE
 13405              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13406           END-IF
 13407        ELSE
 13408           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13409             (PB-I-LF-TERM / 12)
 13410           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13411              MOVE ER-2661       TO WS-ERROR
 13412*             PERFORM 9900-ERROR-FORMAT
 13413*                                THRU 9900-EXIT
 13414           ELSE
 13415              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13416                 MOVE ER-1571    TO WS-ERROR
 13417                 PERFORM 9900-ERROR-FORMAT
 13418                                 THRU 9900-EXIT
 13419              END-IF
 13420           END-IF
 13421        END-IF
 13422        IF WS-ERROR = ER-2661
 13423           PERFORM 9900-ERROR-FORMAT
 13424                                 THRU 9900-EXIT
 13425        END-IF
 13426     END-IF
 13427*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13428*       MOVE ER-2661             TO WS-ERROR
 13429*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13430
 13431     IF CP-ERROR-AGE-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 245
* EL050.cbl
 13432        MOVE ER-2662             TO WS-ERROR
 13433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13434
 13435     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13436        MOVE ER-2677             TO WS-ERROR
 13437        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13438
 13439     IF CP-ERROR-LOAN-TERM
 13440        MOVE ER-2648             TO WS-ERROR
 13441        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13442
 13443 3221-CHECK-ERROR-RATE-OPEN.
 13444
 13445     IF CP-ERROR-RATE-FILE-NOTOPEN
 13446         GO TO 3990-FILES-NOT-OPEN.
 13447
 13448     IF PB-COMPANY-ID NOT = 'DMD'
 13449        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13450     END-IF
 13451     .
 13452 3221-CONTINUE.
 13453     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13454                                    WS-DCC-AH-RATE
 13455     IF PB-COMPANY-ID = 'DCC'
 13456        IF WS-LF-BEN-CATEGORY = 'D'
 13457           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13458              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13459        END-IF
 13460     END-IF
 13461     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13462*   X'A4FF' = 12/31/2009
 13463     IF (PB-COMPANY-ID = 'CID')
 13464        AND (WS-LF-EARNINGS-CALC = 'B')
 13465        AND (CP-STATE-STD-ABBRV = 'MN')
 13466        AND (PB-CERT-EFF-DT > X'A4FF')
 13467        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13468     END-IF
 13469     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13470
 13471     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13472     IF (PB-COMPANY-ID = 'DCC')
 13473        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13474        AND (PB-I-POLICY-IS-MONTHLY)
 13475        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13476        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13477     END-IF
 13478     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13479     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13480     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13481     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13482     IF (PB-COMPANY-ID = 'DCC')
 13483        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13484        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13485        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13486        MOVE ER-2786             TO WS-ERROR
 13487        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13488     END-IF
 13489
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 246
* EL050.cbl
 13490     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13491
 13492******************************************************************
 13493*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13494******************************************************************
 13495     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13496        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13497
 13498     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13499        GO TO 3225-CHECK-ALT-LIFE-RATE
 13500     ELSE
 13501       IF PB-I-LF-RATE = ZERO
 13502          MOVE ER-2641          TO WS-ERROR
 13503          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13504
 13505 3225-CHECK-ALT-LIFE-RATE.
 13506
 13507     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13508        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13509        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13510         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13511
 13512     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13513         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13514             AND PB-COMPANY-ID NOT = 'DCC')
 13515                   OR
 13516              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13517              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13518              AND PB-COMPANY-ID NOT = 'DCC')
 13519             MOVE ER-2720        TO  WS-ERROR
 13520             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13521             GO TO 3225-RATING-CONT
 13522         ELSE
 13523             GO TO 3225-RATING-CONT.
 13524     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13525        AND (AM-GPCD = 01 OR 06 OR 15)
 13526        MOVE ER-2798             TO WS-ERROR
 13527        PERFORM 9900-ERROR-FORMAT
 13528                                 THRU 9900-EXIT
 13529*       GO TO 3225-RATING-CONT
 13530     END-IF
 13531     IF (PB-COMPANY-ID = 'CID')
 13532        AND (WS-LF-EARNINGS-CALC = 'B')
 13533        AND (CP-STATE-STD-ABBRV = 'MN')
 13534        AND (PB-CERT-EFF-DT > X'A4FF')
 13535        GO TO 3225-RATING-CONT
 13536     END-IF
 13537     IF PB-COMPANY-ID = 'DCC'
 13538        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13539           AND (PB-I-POLICY-IS-MONTHLY)
 13540           GO TO 3225-RATING-CONT
 13541        END-IF
 13542     END-IF
 13543
 13544     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13545        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13546        CP-EARN-AS-REG-BALLOON
 13547        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 247
* EL050.cbl
 13548     ELSE
 13549        MOVE '2'                 TO CP-EARNING-METHOD.
 13550
 13551 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13552
 13553     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13554
 13555     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13556        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13557        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13558         NEXT SENTENCE
 13559     ELSE
 13560         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13561
 13562     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13563     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13564     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13565                                     CP-RATING-BENEFIT-AMT.
 13566     IF CP-STATE-STD-ABBRV = 'OR'
 13567         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13568                                         PB-I-LF-ALT-BENEFIT-AMT.
 13569     IF PB-COMPANY-ID = 'DCC'
 13570        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13571     END-IF
 13572     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13573     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13574     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13575                                    CP-REMAINING-TERM
 13576                                    CP-LOAN-TERM.
 13577     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13578        ADD +1                   TO CP-ORIGINAL-TERM
 13579                                    CP-REMAINING-TERM
 13580                                    CP-LOAN-TERM.
 13581
 13582     MOVE 'R'                   TO CP-RATE-FILE.
 13583     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13584
 13585     IF CP-ERROR-RATE-NOT-FOUND
 13586         MOVE ER-2641            TO WS-ERROR
 13587         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13588         GO TO 3300-CHECK-AH-RATES.
 13589
 13590     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13591     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13592
 13593     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13594         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13595
 13596     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13597                               + PB-I-LF-ALT-BENEFIT-AMT.
 13598
 13599     IF ACCOUNT-LIFE-CHECKED  OR
 13600        PB-POLICY-IS-VOIDED   OR
 13601        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13602        GO TO 3225-CONTINUE.
 13603
 13604     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13605        GO TO 3225-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 248
* EL050.cbl
 13606
 13607     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13608                             EC-RT-LF-MAX-TOT-BEN
 13609        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13610        MOVE ER-2639       TO WS-ERROR
 13611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13612
 13613 3225-CONTINUE.
 13614     IF PB-I-LF-ALT-RATE = ZERO
 13615         MOVE ER-2659            TO WS-ERROR
 13616         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13617
 13618     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13619        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13620        MOVE ER-2698             TO WS-ERROR
 13621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13622
 13623 3225-RATING-CONT.
 13624
 13625     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13626         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13627         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13628         IF (PB-COMPANY-ID = 'DCC')
 13629            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13630            CONTINUE
 13631         ELSE
 13632            MOVE ER-2687         TO WS-ERROR
 13633            PERFORM 9900-ERROR-FORMAT
 13634                                 THRU 9900-EXIT
 13635         END-IF
 13636         GO TO 3290-EDIT-LF-REIN-RATE
 13637     END-IF
 13638
 13639* DMD RATING TEST
 13640     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13641         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13642         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13643         MOVE ER-2687                 TO WS-ERROR
 13644         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13645         GO TO 3290-EDIT-LF-REIN-RATE.
 13646
 13647 3230-CLIENT-MORT-CD-SPECIALS.
 13648
 13649     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13650     SET BIN-TO-GREG          TO TRUE.
 13651*    MOVE ' '                 TO DC-OPTION-CODE.
 13652     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13653     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13654
 13655 C-POS-3230-MORT-CD.
 13656     IF PB-COMPANY-ID = 'POS' AND
 13657        PB-SV-CARRIER = '2'
 13658         NEXT SENTENCE
 13659     ELSE
 13660         GO TO C-POS-3240-MORT-CD.
 13661
 13662     IF PB-SV-GROUPING = '030'
 13663        AND PB-CERT-EFF-DT GREATER THAN WS-791231
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 249
* EL050.cbl
 13664         MOVE '2350' TO PB-I-MORT-CODE
 13665      ELSE
 13666         MOVE '3300' TO PB-I-MORT-CODE.
 13667
 13668
 13669 C-POS-3240-MORT-CD.
 13670     IF PB-COMPANY-ID = 'POS' AND
 13671        PB-SV-CARRIER = '1'
 13672         NEXT SENTENCE
 13673     ELSE
 13674         GO TO 3230-CONTINUE.
 13675
 13676     IF PB-SV-STATE = '45' OR '47'
 13677        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13678         MOVE '5200' TO PB-I-MORT-CODE
 13679     ELSE
 13680         MOVE '8300' TO PB-I-MORT-CODE.
 13681
 13682 3230-CONTINUE.
 13683
 13684     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13685        GO TO 3240-CONTINUE
 13686     END-IF
 13687
 13688     IF PB-CERT-EFF-DT > WS-971231
 13689        GO TO 3240-CONTINUE
 13690     END-IF
 13691
 13692     IF LF-BENEFIT-FOUND AND
 13693        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13694         MOVE 'F250'       TO PB-I-MORT-CODE
 13695     ELSE
 13696         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13697             MOVE '7250'   TO PB-I-MORT-CODE
 13698         ELSE
 13699             MOVE '4251'   TO PB-I-MORT-CODE
 13700         END-IF
 13701     END-IF
 13702
 13703     .
 13704 3240-CONTINUE.
 13705
 13706     IF PB-COMPANY-ID NOT = 'GNL'
 13707         GO TO 3256-CONTINUE.
 13708
 13709     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13710         MOVE 'A300' TO PB-I-MORT-CODE
 13711     ELSE
 13712         MOVE '8350' TO PB-I-MORT-CODE.
 13713
 13714 3256-CONTINUE.
 13715     IF PB-COMPANY-ID NOT = 'ABL'
 13716         GO TO 3260-EDIT-CONTINUE.
 13717
 13718     IF PB-I-LF-TERM GREATER THAN 59
 13719         MOVE 'F550' TO PB-I-MORT-CODE
 13720     ELSE
 13721         MOVE 'E550' TO PB-I-MORT-CODE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 250
* EL050.cbl
 13722
 13723 3260-EDIT-CONTINUE.
 13724     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13725
 13726 3290-EDIT-LF-REIN-RATE.
 13727     IF LF-REIN-NSP-NOT-USED
 13728         GO TO 3290-RATING-CONT.
 13729
 13730     IF PB-COMPANY-ID = 'DCC'
 13731        GO TO 3290-RATING-CONT.
 13732     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13733     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13734     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13735     MOVE '3'                   TO CP-PROCESS-TYPE.
 13736     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13737
 13738******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13739     IF PB-COMPANY-ID EQUAL 'CDL'
 13740         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13741            CP-EARN-AS-NET-PAY)
 13742             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13743*            MOVE SPACE          TO DC-OPTION-CODE
 13744             SET BIN-TO-GREG     TO TRUE
 13745             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13746***  Y2K PROJ 7744
 13747             IF DC-GREG-DATE-CYMD GREATER 19931231
 13748                 MOVE '1'        TO CP-EARNING-METHOD.
 13749***  Y2K PROJ 7744
 13750*******
 13751
 13752     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13753     MOVE PB-SV-STATE           TO CP-STATE.
 13754     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13755     MOVE ZERO                  TO CP-DEVIATION-CODE
 13756                                   CP-RATE-DEV-PCT.
 13757     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13758     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13759                                   CP-RATING-BENEFIT-AMT.
 13760
 13761************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13762     IF PB-COMPANY-ID EQUAL 'NCB'
 13763         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13764            CP-EARN-AS-NET-PAY
 13765             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13766                 PB-I-LF-PREMIUM-AMT.
 13767************
 13768
 13769     IF CP-STATE-STD-ABBRV = 'OR'
 13770         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13771                                         PB-I-LF-ALT-BENEFIT-AMT.
 13772     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13773     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13774     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13775     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13776     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13777     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13778     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13779     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 251
* EL050.cbl
 13780                                   CP-REMAINING-TERM
 13781                                   CP-LOAN-TERM.
 13782     IF CP-TRUNCATED-LIFE
 13783        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13784
 13785     IF CP-TERM-IS-DAYS
 13786         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13787     ELSE
 13788         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13789
 13790     IF PB-COMPANY-ID = 'DCC'
 13791        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13792     END-IF
 13793     IF PB-COMPANY-ID NOT = 'TIC'
 13794          MOVE ZERO          TO CP-CLASS-CODE.
 13795
 13796     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13797
 13798     MOVE 'R'                   TO CP-RATE-FILE.
 13799     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13800
 13801     IF CP-ERROR-RATE-NOT-FOUND
 13802        IF PB-I-OB
 13803           MOVE ER-2625      TO WS-ERROR
 13804           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13805           GO TO 3299-EDIT-CONTINUE
 13806        ELSE
 13807           MOVE ER-2643      TO WS-ERROR
 13808           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13809           GO TO 3299-EDIT-CONTINUE.
 13810
 13811     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13812
 13813     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13814     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13815
 13816     IF PB-I-LF-REI-RATE = ZERO
 13817         MOVE ER-2643        TO WS-ERROR
 13818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13819
 13820 3290-CHECK-ALT-REIN-RATE.
 13821
 13822     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13823        GO TO 3290-RATING-CONT.
 13824
 13825     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13826     MOVE '2'                    TO CP-EARNING-METHOD.
 13827     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13828     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13829     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13830     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13831                                     CP-RATING-BENEFIT-AMT.
 13832     IF CP-STATE-STD-ABBRV = 'OR'
 13833         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13834                                         PB-I-LF-ALT-BENEFIT-AMT.
 13835     IF PB-COMPANY-ID = 'DCC'
 13836        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13837     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 252
* EL050.cbl
 13838     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13839     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13840     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13841                                    CP-REMAINING-TERM
 13842                                    CP-LOAN-TERM.
 13843     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13844        ADD +1                   TO CP-ORIGINAL-TERM
 13845                                    CP-REMAINING-TERM
 13846                                    CP-LOAN-TERM.
 13847
 13848     MOVE 'R'                   TO CP-RATE-FILE.
 13849     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13850
 13851     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13852
 13853     IF PB-I-LF-ALT-REI-RATE = ZERO
 13854         MOVE ER-2643            TO WS-ERROR
 13855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13856
 13857 3290-RATING-CONT.
 13858
 13859     IF PB-I-OB
 13860*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13861        GO TO 3300-CHECK-AH-RATES.
 13862
 13863 3299-EDIT-CONTINUE.
 13864
 13865     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13866         NEXT SENTENCE
 13867     ELSE
 13868         MOVE ER-2620           TO WS-ERROR
 13869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13870
 13871 3300-CHECK-AH-RATES.
 13872     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13873         NEXT SENTENCE
 13874     ELSE
 13875         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13876
 13877     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13878        ((CF-COMPANY-ID = 'DMD') AND
 13879                (NO-DMD-RATING))
 13880         IF (PB-COMPANY-ID = 'DCC')
 13881            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13882            CONTINUE
 13883         ELSE
 13884            MOVE ER-2687         TO WS-ERROR
 13885            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13886         END-IF
 13887         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13888         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13889     END-IF
 13890
 13891     IF PB-I-OB
 13892        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13893
 13894     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13895         MOVE ER-2687             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 253
* EL050.cbl
 13896         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13897         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13898         GO TO 3999-END-EDIT.
 13899
 13900*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13901
 13902     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13903        IF PB-I-AH-CRIT-PER = ZERO
 13904           IF PB-COMPANY-ID = 'DCC'
 13905              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13906              CONTINUE
 13907           ELSE
 13908              MOVE ER-2618       TO WS-ERROR
 13909              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13910              GO TO 3999-END-EDIT
 13911           END-IF
 13912        END-IF
 13913     END-IF
 13914     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13915     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13916     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13917     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13918     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13919     MOVE PB-SV-STATE            TO CP-STATE.
 13920     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13921     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13922     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13923*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13924     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13925     MOVE '3'                    TO CP-PROCESS-TYPE.
 13926     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13927     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13928                                    CP-RATING-BENEFIT-AMT.
 13929     IF PB-COMPANY-ID = 'CID'
 13930               OR
 13931        CP-STATE-STD-ABBRV = 'OR'
 13932         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13933                                         PB-I-AH-TERM.
 13934     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13935        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13936           AND (PB-I-POLICY-IS-MONTHLY)
 13937           MOVE PB-I-LF-BENEFIT-AMT
 13938                                 TO CP-NET-BENEFIT-AMT
 13939           move pb-i-ah-premium-amt to cp-original-premium
 13940           add pb-i-lf-premium-amt to cp-original-premium
 13941        END-IF
 13942     END-IF
 13943     MOVE SPACES                 TO CP-BEN-CATEGORY
 13944     IF PB-COMPANY-ID = 'DCC'
 13945        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13946        EVALUATE TRUE
 13947           WHEN (WS-AH-BEN-CATEGORY = 'G')
 13948              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13949              MOVE PB-I-LF-BENEFIT-AMT
 13950                                 TO CP-RATING-BENEFIT-AMT
 13951              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 13952           WHEN WS-AH-BEN-CATEGORY = 'G'
 13953              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 254
* EL050.cbl
 13954                                 TO CP-RATING-BENEFIT-AMT
 13955           WHEN WS-AH-BEN-CATEGORY = 'D'
 13956              MOVE WS-AH-PMF-COMM
 13957                                 TO CP-DCC-PMF-COMM
 13958              MOVE PB-I-AH-COMMISSION
 13959                                 TO CP-DCC-ACT-COMM
 13960        END-EVALUATE
 13961     END-IF
 13962     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13963     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13964     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13965     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13966     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13967     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13968     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13969                                    CP-REMAINING-TERM
 13970                                    WS-WORK-TERM.
 13971     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13972
 13973     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13974     SET BIN-TO-GREG             TO TRUE.
 13975*    MOVE ' '                    TO DC-OPTION-CODE.
 13976     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13977     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13978
 13979     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13980     IF NOT VALID-SKIP-CODE
 13981         MOVE ER-2683            TO WS-ERROR
 13982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13983         GO TO 3320-RATE-CONTINUE.
 13984
 13985     IF PB-NO-MONTHS-SKIPPED
 13986         GO TO 3320-RATE-CONTINUE.
 13987
 13988     MOVE SPACE TO NUMBER-OF-MONTHS.
 13989
 13990     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13991         MOVE 'S'                TO SK-MO (6).
 13992     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13993         MOVE 'S'                TO SK-MO (7).
 13994     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13995         MOVE 'S'                TO SK-MO (8).
 13996     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13997         MOVE 'S'                TO SK-MO (9).
 13998     IF PB-I-SKIP-CODE = 'A'
 13999         MOVE 'S'                TO SK-MO (10).
 14000
 14001     MOVE 1                      TO SUB2.
 14002     MOVE PB-I-AH-TERM           TO SUB3.
 14003     MOVE WS-MONTH               TO SUB1.
 14004     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14005     GO TO 3320-RATE-CONTINUE.
 14006
 14007 3310-GET-SKIP-MO.
 14008     IF SUB1 = 13
 14009         MOVE 1                  TO SUB1.
 14010
 14011     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 255
* EL050.cbl
 14012         SUBTRACT 1 FROM WS-WORK-TERM.
 14013
 14014     ADD 1 TO SUB2
 14015              SUB1.
 14016
 14017 3320-RATE-CONTINUE.
 14018
 14019     IF WS-WORK-TERM = ZERO
 14020         MOVE 1                  TO WS-WORK-TERM.
 14021
 14022     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14023                                    CP-LOAN-TERM.
 14024
 14025     IF PB-COMPANY-ID EQUAL 'DMD'
 14026         NEXT SENTENCE
 14027     ELSE
 14028         MOVE ZERO               TO PB-I-AH-RATE
 14029                                    PB-I-AH-REI-RATE.
 14030
 14031
 14032     IF PB-COMPANY-ID EQUAL 'CRI'
 14033        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14034
 14035     IF PB-COMPANY-ID = 'CSL'
 14036         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14037         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14038         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14039         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14040
 14041     IF PB-COMPANY-ID = 'DCC'
 14042        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14043           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14044              PB-I-RATE-DEV-PCT-LF
 14045        END-IF
 14046        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14047                                 TO CP-ALTERNATE-BENEFIT
 14048        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14049        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14050        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14051     END-IF
 14052     IF (PB-COMPANY-ID = 'CID')
 14053        AND (WS-LF-EARNINGS-CALC = 'B')
 14054        AND (CP-STATE-STD-ABBRV = 'MN')
 14055        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14056     ELSE
 14057        MOVE ' '                 TO CP-AH-BALLOON-SW
 14058     END-IF
 14059     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14060     MOVE 'R'                   TO CP-RATE-FILE.
 14061     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14062
 14063     IF CP-ERROR-RATE-NOT-FOUND
 14064        IF PB-I-OB
 14065           MOVE ER-2624          TO WS-ERROR
 14066           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14067           GO TO 3340-CALCULATE-PREMIUM-AMT
 14068        ELSE
 14069          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 256
* EL050.cbl
 14070              NEXT SENTENCE
 14071          ELSE
 14072           MOVE ER-2642          TO WS-ERROR
 14073           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14074           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14075
 14076     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14077        CP-ERROR-DIV-BY-ZERO
 14078           MOVE ER-3782          TO WS-ERROR
 14079           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14080
 14081     IF PB-COMPANY-ID EQUAL 'CRI'
 14082        IF CP-ERROR-NO-LIMITS-CRI
 14083           IF NOT ACCOUNT-AH-CHECKED
 14084              MOVE ER-2607          TO WS-ERROR
 14085              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14086
 14087     IF ACCOUNT-AH-CHECKED
 14088        NEXT SENTENCE
 14089     ELSE
 14090       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14091          MOVE ER-2640           TO WS-ERROR
 14092          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14093
 14094     IF PB-COMPANY-ID = 'CRI'
 14095         IF WS-ERROR = ER-2640
 14096             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14097     IF ACCOUNT-AH-CHECKED
 14098        CONTINUE
 14099     ELSE
 14100        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14101           AND (CP-R-MAX-ATT-AGE > +0)
 14102           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14103           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14104              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14105              MOVE PB-I-AH-EXPIRE-DT
 14106                                 TO DC-BIN-DATE-2
 14107              MOVE '1'           TO DC-OPTION-CODE
 14108              PERFORM 8500-DATE-CONVERT
 14109                                 THRU 8500-EXIT
 14110              IF NO-CONVERSION-ERROR
 14111                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14112                    MOVE ER-2661       TO WS-ERROR
 14113*                   PERFORM 9900-ERROR-FORMAT
 14114*                                THRU 9900-EXIT
 14115                 END-IF
 14116              END-IF
 14117           ELSE
 14118              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14119              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14120                 MOVE ER-2661    TO WS-ERROR
 14121*                PERFORM 9900-ERROR-FORMAT
 14122*                                THRU 9900-EXIT
 14123              ELSE
 14124                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14125                    MOVE ER-1570 TO WS-ERROR
 14126                    PERFORM 9900-ERROR-FORMAT
 14127                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 257
* EL050.cbl
 14128                 END-IF
 14129              END-IF
 14130           END-IF
 14131           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14132              MOVE PB-I-JOINT-BIRTHDAY
 14133                                    TO DC-BIN-DATE-1
 14134              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14135              MOVE '1'              TO DC-OPTION-CODE
 14136              PERFORM 8500-DATE-CONVERT
 14137                                    THRU 8500-EXIT
 14138              IF NO-CONVERSION-ERROR
 14139                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14140                    MOVE ER-2661       TO WS-ERROR
 14141*                   PERFORM 9900-ERROR-FORMAT
 14142*                                   THRU 9900-EXIT
 14143                 END-IF
 14144              END-IF
 14145           ELSE
 14146              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14147                (PB-I-AH-TERM / 12)
 14148              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14149                 MOVE ER-2661       TO WS-ERROR
 14150*                PERFORM 9900-ERROR-FORMAT
 14151*                                   THRU 9900-EXIT
 14152              ELSE
 14153                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14154                    MOVE ER-1571 TO WS-ERROR
 14155                    PERFORM 9900-ERROR-FORMAT
 14156                                 THRU 9900-EXIT
 14157                 END-IF
 14158              END-IF
 14159           END-IF
 14160           IF WS-ERROR = ER-2661
 14161              PERFORM 9900-ERROR-FORMAT
 14162                                    THRU 9900-EXIT
 14163           END-IF
 14164        END-IF
 14165     END-IF
 14166*    IF ACCOUNT-AH-CHECKED
 14167*       NEXT SENTENCE
 14168*    ELSE
 14169*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14170*          MOVE ER-2661          TO WS-ERROR
 14171*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14172
 14173     IF ACCOUNT-AH-CHECKED
 14174        NEXT SENTENCE
 14175     ELSE
 14176        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14177           MOVE ER-2663          TO WS-ERROR
 14178           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14179
 14180     IF ACCOUNT-AH-CHECKED OR
 14181        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14182         PB-POLICY-IS-VOIDED
 14183        NEXT SENTENCE
 14184     ELSE
 14185        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 258
* EL050.cbl
 14186           MOVE ER-2667            TO WS-ERROR
 14187           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14188
 14189     IF PB-COMPANY-ID = 'CRI'
 14190         IF WS-ERROR = ER-2667
 14191             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14192
 14193     IF ACCOUNT-AH-CHECKED
 14194        NEXT SENTENCE
 14195     ELSE
 14196        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14197           MOVE ER-2678            TO WS-ERROR
 14198           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14199
 14200     IF CP-ERROR-RATE-FILE-NOTOPEN
 14201         GO TO 3990-FILES-NOT-OPEN.
 14202
 14203 3321-CONTINUE.
 14204     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14205     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14206     IF (PB-COMPANY-ID = 'DCC')
 14207        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14208        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14209                                    PB-I-LF-ALT-PREM-CALC
 14210        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14211        IF WS-AH-BEN-CATEGORY = 'G'
 14212           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14213           + PB-I-ADDL-CLP)
 14214           * (1 + WS-TOL-CLP-PCT)
 14215*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14216        ELSE
 14217           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14218           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14219*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14220        END-IF
 14221        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14222                                 TO PB-I-AH-PREM-CALC
 14223        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14224           MOVE ER-8152          TO WS-ERROR
 14225           PERFORM 9900-ERROR-FORMAT
 14226                                 THRU 9900-EXIT
 14227        ELSE
 14228           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14229                 PB-I-ADDL-CLP)
 14230              MOVE ER-8148       TO WS-ERROR
 14231              PERFORM 9900-ERROR-FORMAT
 14232                                 THRU 9900-EXIT
 14233           END-IF
 14234        END-IF
 14235     END-IF
 14236     IF (PB-COMPANY-ID = 'DCC')
 14237        AND (PB-I-POLICY-IS-MONTHLY)
 14238        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14239        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14240        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14241           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14242        END-IF
 14243     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 259
* EL050.cbl
 14244     IF (PB-COMPANY-ID = 'DCC')
 14245        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14246        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14247        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14248        MOVE ER-2786             TO WS-ERROR
 14249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14250     END-IF
 14251     MOVE +0                     TO PB-I-AH-CLP
 14252     IF PB-COMPANY-ID = 'DCC'
 14253        IF WS-AH-BEN-CATEGORY = 'D'
 14254           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14255              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14256        ELSE
 14257           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14258              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14259           END-IF
 14260        END-IF
 14261     END-IF
 14262     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14263
 14264     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14265         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14266
 14267     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14268         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14269
 14270     IF PB-COMPANY-ID = 'CRI'
 14271         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14272            PB-I-PAYMENT-AMOUNT = ZERO
 14273             NEXT SENTENCE
 14274         ELSE
 14275             COMPUTE PB-I-AH-PREM-CALC =
 14276                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14277                 (CP-PREMIUM-RATE / 100)
 14278             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14279                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14280                                             PB-I-RATE-DEV-PCT-AH.
 14281
 14282     IF PB-I-AH-RATE  = ZERO
 14283       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14284           NEXT SENTENCE
 14285       ELSE
 14286         MOVE ER-2642            TO WS-ERROR
 14287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14288
 14289     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14290     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14291     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14292     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14293     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14294     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14295
 14296     IF (PB-COMPANY-ID = 'DCC')
 14297        AND (WS-AH-BEN-CATEGORY = 'G')
 14298        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14299        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14300        IF CP-DEVIATION-CODE NOT = '000'
 14301           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 260
* EL050.cbl
 14302           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14303           IF NO-CP-ERROR
 14304              COMPUTE PB-I-DDF-IU-RATE-UP =
 14305              PB-I-AH-CLP - CP-CALC-PREMIUM
 14306           ELSE
 14307              MOVE ER-3057        TO WS-ERROR
 14308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14309           END-IF
 14310        END-IF
 14311     END-IF
 14312     .
 14313 3335-EDIT-AH-REIN-NSP-RATE.
 14314     IF AH-REIN-NSP-NOT-USED
 14315         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14316
 14317     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14318     IF PB-COMPANY-ID = 'DCC'
 14319         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14320     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14321     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14322     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14323     MOVE PB-SV-STATE            TO CP-STATE.
 14324     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14325     MOVE ZERO                   TO CP-DEVIATION-CODE
 14326                                    CP-RATE-DEV-PCT.
 14327*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14328     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14329     MOVE '3'                    TO CP-PROCESS-TYPE.
 14330     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14331     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14332                                    CP-RATING-BENEFIT-AMT.
 14333     IF CP-STATE-STD-ABBRV = 'OR'
 14334         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14335                                         PB-I-AH-TERM.
 14336     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14337     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14338     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14339     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14340     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14341     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14342                                    CP-REMAINING-TERM
 14343                                    WS-WORK-TERM.
 14344     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14345     IF PB-COMPANY-ID = 'DCC'
 14346        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14347     END-IF
 14348     IF  PB-COMPANY-ID = 'TIC'
 14349         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14350            MOVE ZERO TO CP-CLASS-CODE.
 14351
 14352     IF PB-COMPANY-ID NOT = 'TIC'
 14353          MOVE ZERO          TO CP-CLASS-CODE.
 14354
 14355     MOVE ZERO               TO CP-DEVIATION-CODE.
 14356
 14357     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14358
 14359     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 261
* EL050.cbl
 14360
 14361     MOVE 'R'                   TO CP-RATE-FILE.
 14362     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14363
 14364     IF CP-ERROR-RATE-NOT-FOUND
 14365         MOVE ER-2645        TO WS-ERROR
 14366         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14367         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14368
 14369     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14370
 14371     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14372     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14373
 14374     IF PB-I-AH-REI-RATE = ZERO
 14375         MOVE ER-2645        TO WS-ERROR
 14376         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14377
 14378
 14379 3340-CALCULATE-PREMIUM-AMT.
 14380
 14381     IF PB-COMPANY-ID = 'NCL'
 14382         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14383             WS-AH-SPECIAL-CALC-CD = 'O')
 14384             GO TO 3999-END-EDIT.
 14385
 14386     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14387                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14388                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14389                         OR 'AHL'
 14390         NEXT SENTENCE
 14391     ELSE
 14392         IF WS-STATE-ABBREVIATION = 'CT'
 14393             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14394                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14395                 COMPUTE PB-I-LF-PREM-CALC =
 14396                                     PB-I-LF-PREM-CALC * .90
 14397                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14398                                     PB-I-LF-ALT-PREM-CALC * .90
 14399                 COMPUTE PB-I-AH-PREM-CALC =
 14400                                     PB-I-AH-PREM-CALC * .90.
 14401
 14402     IF PB-COMP-LF-PREM
 14403        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14404        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14405
 14406     IF PB-COMP-AH-PREM
 14407        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14408
 14409 3340-CHECK-DCC-TOT-FEES.
 14410     IF (PB-COMPANY-ID = 'DCC')
 14411        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14412        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14413        AND (PB-I-POLICY-IS-MONTHLY)
 14414        CONTINUE
 14415     ELSE
 14416        GO TO 3340-EDIT-LF-AH-TOL
 14417     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 262
* EL050.cbl
 14418     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14419     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14420     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14421        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14422           PB-I-RATE-DEV-PCT-LF
 14423     END-IF
 14424     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14425        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14426           PB-I-RATE-DEV-PCT-AH
 14427     END-IF
 14428     MOVE 'N'                    TO CP-BEN-CATEGORY
 14429     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14430
 14431     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14432     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14433     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14434     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14435     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14436     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14437     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14438     MOVE '3'                    TO CP-PROCESS-TYPE.
 14439     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14440     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14441
 14442     MOVE PB-SV-STATE            TO CP-STATE.
 14443     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14444     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14445     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14446     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14447     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14448                                    CP-RATING-BENEFIT-AMT.
 14449     IF CP-STATE-STD-ABBRV = 'OR'
 14450         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14451                                         PB-I-LF-ALT-BENEFIT-AMT.
 14452     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14453     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14454     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14455     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14456     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14457     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14458     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14459     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14460     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14461                                    CP-REMAINING-TERM
 14462                                    CP-LOAN-TERM.
 14463     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14464        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14465           PB-I-LF-PREMIUM-AMT
 14466     end-if
 14467
 14468     IF CP-TRUNCATED-LIFE
 14469        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14470
 14471     IF CP-TERM-IS-DAYS
 14472         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14473     ELSE
 14474         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14475
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 263
* EL050.cbl
 14476     IF PB-COMPANY-ID = 'DCC'
 14477        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14478     END-IF
 14479     IF CP-SPECIAL-CALC-CD = 'H'
 14480         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14481                                    TO CP-ALTERNATE-BENEFIT
 14482         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14483     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14484     MOVE 'R'                    TO CP-RATE-FILE
 14485     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14486     IF NOT CP-ERROR-RATE-NOT-FOUND
 14487        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14488        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14489           AND (CP-BENEFIT-CD (1:1) = 'S')
 14490           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14491                                    PB-I-LF-PREMIUM-AMT
 14492        END-IF
 14493     ELSE
 14494        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14495     END-IF
 14496     .
 14497 3340-EDIT-LF-AH-TOL.
 14498
 14499***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14500***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14501***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14502***
 14503     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14504         PB-I-AH-PREMIUM-AMT
 14505          GIVING WS-CALC-WORK.
 14506
 14507     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14508        AND WS-CALC-WORK NOT = ZERO
 14509         MOVE ER-2649            TO WS-ERROR
 14510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14511
 14512     SUBTRACT PB-I-LF-PREM-CALC
 14513             FROM PB-I-LF-PREMIUM-AMT
 14514                 GIVING WS-UNSIGN-WRK1.
 14515
 14516     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14517             FROM PB-I-LF-ALT-PREMIUM-AMT
 14518                 GIVING WS-UNSIGN-WRK4.
 14519
 14520     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14521                                + WS-UNSIGN-WRK4.
 14522
 14523     SUBTRACT PB-I-AH-PREM-CALC
 14524             FROM PB-I-AH-PREMIUM-AMT
 14525                 GIVING WS-UNSIGN-WRK2.
 14526
 14527******************************************************************
 14528*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14529******************************************************************
 14530
 14531     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14532         MOVE ZERO TO WS-UNSIGN-WRK1.
 14533
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 264
* EL050.cbl
 14534     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14535         MOVE ZERO TO WS-UNSIGN-WRK2.
 14536
 14537     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14538             GIVING WS-UNSIGN-WRK3.
 14539
 14540 3342-CONTINUE.
 14541
 14542     IF (PB-I-LF-RATE = ZERO  AND
 14543         PB-I-AH-RATE = ZERO)
 14544         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14545            WS-AH-SPECIAL-CALC-CD = 'O'
 14546              NEXT SENTENCE
 14547         ELSE
 14548             GO TO 3345-EDIT-CONTINUE.
 14549
 14550     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14551         NEXT SENTENCE
 14552     ELSE
 14553     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14554        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14555           IF (PB-REISSUED-CERT         OR
 14556               PB-POLICY-IS-DECLINED    OR
 14557               PB-POLICY-IS-VOIDED)
 14558              NEXT SENTENCE
 14559           ELSE
 14560              IF WS-PREM-REJECT-SW = SPACE
 14561                 MOVE ER-2652    TO WS-ERROR
 14562                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14563                 GO TO 3344-CHECK-AH
 14564              ELSE
 14565                 MOVE ER-2650    TO WS-ERROR
 14566                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14567                 GO TO 3344-CHECK-AH.
 14568
 14569***
 14570***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14571***
 14572
 14573     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14574         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14575            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14576             (1 + WS-TOL-LF-PREM-PCT)
 14577         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14578            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14579             (1 - WS-TOL-LF-PREM-PCT)
 14580     ELSE
 14581         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14582         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14583
 14584***
 14585***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14586***
 14587
 14588     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14589         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14590          WS-TOL-LF-PREM.
 14591
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 265
* EL050.cbl
 14592     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14593         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14594          WS-TOL-LF-PREM.
 14595
 14596     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14597        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14598
 14599     IF PB-REISSUED-CERT
 14600        or PB-POLICY-IS-DECLINED
 14601        or PB-POLICY-IS-VOIDED
 14602        continue
 14603     ELSE
 14604        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14605              > WS-TOL-LF-HIGH-PREM-AMT)
 14606           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14607              < WS-TOL-LF-LOW-PREM-AMT))
 14608                      or
 14609           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14610              > WS-TOL-LF-HIGH-PREM-PCT)
 14611           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14612              < WS-TOL-LF-LOW-PREM-PCT))
 14613           IF WS-PREM-REJECT-SW = SPACE
 14614              MOVE ER-2652       TO WS-ERROR
 14615              PERFORM 9900-ERROR-FORMAT
 14616                                 THRU 9900-EXIT
 14617           ELSE
 14618              MOVE ER-2650       TO WS-ERROR
 14619              PERFORM 9900-ERROR-FORMAT
 14620                                 THRU 9900-EXIT
 14621           end-if
 14622        end-if
 14623     end-if
 14624
 14625*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14626*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14627*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14628*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14629
 14630     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14631        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14632                      OR
 14633           ((PB-COMPANY-ID = 'DCC')
 14634           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14635           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14636           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14637        END-IF
 14638     END-IF
 14639
 14640     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14641        IF WS-COMP-MAX-CAP GREATER THAN +0
 14642           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14643              IF (PB-REISSUED-CERT         OR
 14644                  PB-POLICY-IS-DECLINED    OR
 14645                  PB-POLICY-IS-VOIDED)
 14646                 NEXT SENTENCE
 14647              ELSE
 14648                  MOVE ER-2646   TO  WS-ERROR
 14649                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 266
* EL050.cbl
 14650
 14651 3344-CVL-TOLERANCE-CHECK.
 14652
 14653      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14654          GO TO 3344-CHECK-AH.
 14655
 14656      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14657          GO TO 3344-CHECK-AH.
 14658
 14659      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14660                                     WS-UNSIGN-WRK6.
 14661
 14662      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14663          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14664                                 + PB-I-LF-PREMIUM-AMT
 14665                                 - PB-I-LF-PREM-CALC.
 14666
 14667      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14668          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14669                                 + PB-I-LF-ALT-PREMIUM-AMT
 14670                                 - PB-I-LF-ALT-PREM-CALC.
 14671
 14672      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14673          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14674              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14675                 MOVE ER-2652    TO  WS-ERROR
 14676                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14677              ELSE
 14678                 MOVE ER-2650    TO  WS-ERROR
 14679                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14680
 14681      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14682          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14683              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14684                 MOVE ER-2652    TO  WS-ERROR
 14685                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14686              ELSE
 14687                 MOVE ER-2650    TO  WS-ERROR
 14688                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14689
 14690 3344-CHECK-AH.
 14691
 14692****************************************************************
 14693***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14694***
 14695
 14696     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14697         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14698             (1 + WS-TOL-AH-PREM-PCT)
 14699         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14700             (1 - WS-TOL-AH-PREM-PCT)
 14701     ELSE
 14702         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14703         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14704
 14705***
 14706***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14707***
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 267
* EL050.cbl
 14708
 14709     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14710         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14711
 14712     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14713         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14714
 14715     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14716        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14717
 14718     IF (PB-REISSUED-CERT)
 14719        OR (PB-POLICY-IS-DECLINED)
 14720        OR (PB-POLICY-IS-VOIDED)
 14721        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14722        CONTINUE
 14723     ELSE
 14724        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14725              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14726                          or
 14727           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14728              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14729           IF WS-PREM-REJECT-SW = SPACE
 14730              MOVE ER-3052       TO WS-ERROR
 14731              PERFORM 9900-ERROR-FORMAT
 14732                                 THRU 9900-EXIT
 14733           ELSE
 14734              MOVE ER-3050       TO WS-ERROR
 14735              PERFORM 9900-ERROR-FORMAT
 14736                                 THRU 9900-EXIT
 14737           END-IF
 14738        END-IF
 14739     END-IF
 14740     if (pb-company-id = 'DCC')
 14741        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14742        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14743        and (pb-i-policy-is-monthly)
 14744        compute ws-tol-ah-high-prem-amt =
 14745           pb-i-tot-fees-calc + ws-tol-ah-prem
 14746        compute ws-tol-ah-low-prem-amt =
 14747           pb-i-tot-fees-calc - ws-tol-ah-prem
 14748        if ws-tol-ah-prem-pct > zeros
 14749           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14750              (1 + ws-tol-ah-prem-pct)
 14751           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14752              (1 - ws-tol-ah-prem-pct)
 14753        else
 14754           move +9999999.99      to ws-tol-ah-high-prem-pct
 14755           move +0               to ws-tol-ah-low-prem-pct
 14756        end-if
 14757        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14758            or
 14759           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14760                          or
 14761           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14762           or
 14763           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14764            move er-3049         to ws-error
 14765           perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 268
* EL050.cbl
 14766                                 thru 9900-exit
 14767
 14768        end-if
 14769     end-if
 14770     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14771         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14772             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14773             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14774
 14775     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14776        IF WS-COMP-MAX-CAP GREATER THAN +0
 14777           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14778              IF (PB-REISSUED-CERT         OR
 14779                  PB-POLICY-IS-DECLINED    OR
 14780                  PB-POLICY-IS-VOIDED)
 14781                 NEXT SENTENCE
 14782              ELSE
 14783                  MOVE ER-2646   TO  WS-ERROR
 14784                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14785
 14786     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14787        (WS-COMP-MAX-CAP EQUAL +0)
 14788           GO TO 3345-EDIT-CONTINUE.
 14789
 14790     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14791        GREATER THAN WS-COMP-MAX-CAP
 14792           MOVE ER-2646          TO  WS-ERROR
 14793           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14794
 14795 3345-EDIT-CONTINUE.
 14796
 14797*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14798*       IF PB-ENTRY-BATCH   NUMERIC
 14799*          IF PB-ISSUE
 14800*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14801*          ELSE
 14802*              IF PB-CANCELLATION
 14803*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14804
 14805*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14806*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14807*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14808*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14809*        ELSE
 14810*            MOVE  ER-1909            TO  WS-ERROR
 14811*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14812
 14813     IF PB-I-POLICY-ACCEPTED
 14814        IF PB-POLICY-IS-DECLINED  OR
 14815           PB-REISSUED-CERT  OR
 14816           PB-REIN-ONLY-CERT  OR
 14817           PB-POLICY-IS-VOIDED
 14818            MOVE  ER-1891         TO  WS-ERROR
 14819            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14820        ELSE
 14821            MOVE SPACE            TO  PB-BATCH-ENTRY
 14822            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14823
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 269
* EL050.cbl
 14824     IF PB-I-POLICY-DECLINED
 14825        IF PB-REISSUED-CERT  OR
 14826           PB-REIN-ONLY-CERT  OR
 14827           PB-POLICY-IS-VOIDED
 14828            MOVE  ER-1906         TO  WS-ERROR
 14829            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14830        ELSE
 14831            MOVE  'D'             TO  PB-BATCH-ENTRY
 14832                                      PB-I-ENTRY-STATUS.
 14833
 14834     IF PB-I-NEEDS-UNDERWRITING
 14835        IF PB-POLICY-IS-DECLINED OR
 14836           PB-REISSUED-CERT  OR
 14837           PB-REIN-ONLY-CERT  OR
 14838           PB-POLICY-IS-VOIDED
 14839            MOVE  ER-1907         TO  WS-ERROR
 14840            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14841        ELSE
 14842            MOVE 'U'              TO  PB-BATCH-ENTRY
 14843                                      PB-I-ENTRY-STATUS.
 14844
 14845     IF PB-NEEDS-UNDERWRITING
 14846        MOVE  ER-1901             TO  WS-ERROR
 14847        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14848     IF PB-COMPANY-ID = 'DCC'
 14849        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14850        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14851        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14852           AND (NOT WS-LF-CASH))
 14853                           OR
 14854           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14855           AND (NOT WS-AH-CASH)))
 14856                       AND
 14857           (PB-I-ENTRY-STATUS NOT = '5')
 14858           MOVE 'M'              TO PB-BATCH-ENTRY
 14859                                    PB-I-ENTRY-STATUS
 14860        END-IF
 14861     END-IF
 14862     IF  PB-COMPANY-ID NOT = 'NCL'
 14863         GO TO 3999-END-EDIT.
 14864
 14865     IF PB-REISSUED-CERT  OR
 14866        PB-POLICY-IS-DECLINED  OR
 14867        PB-POLICY-IS-VOIDED  OR
 14868        PB-I-OB
 14869         GO TO 3999-END-EDIT.
 14870
 14871     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14872         MOVE  ER-2644            TO  WS-ERROR
 14873         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14874         GO TO 3999-END-EDIT.
 14875
 14876     MOVE 'N'                     TO  FORM-MASTER-SW.
 14877     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14878
 14879     IF NOT FORM-MASTER-FOUND
 14880         GO TO 3999-END-EDIT.
 14881
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 270
* EL050.cbl
 14882     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14883                                      FORM-MASTER-AH-SW.
 14884
 14885     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14886         MOVE  +1                 TO SUB6
 14887         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14888
 14889     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14890         MOVE  +1                 TO SUB6
 14891         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14892
 14893     IF LF-FORM-MASTER-FOUND  OR
 14894        AH-FORM-MASTER-FOUND
 14895         GO TO 3360-CHECK-FORM-LIMITS
 14896     ELSE
 14897         GO TO 3999-END-EDIT.
 14898
 14899******************************************************************
 14900*                  3350-GET-ERFORM                               *
 14901*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14902*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14903******************************************************************
 14904
 14905 3350-GET-ERFORM.
 14906
 14907     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14908         GO TO  3350-ERFORM-GETMAIN.
 14909
 14910     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14911     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14912     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14913     MOVE 'Y'                     TO FORM-MASTER-SW.
 14914
 14915     IF PB-CANCELLATION
 14916         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14917            PB-SV-STATE          EQUAL   FO-STATE       AND
 14918            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14919              GO TO 3350-EXIT
 14920         ELSE
 14921             NEXT SENTENCE
 14922     ELSE
 14923         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14924            PB-SV-STATE          EQUAL   FO-STATE       AND
 14925            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14926              GO TO 3350-EXIT.
 14927
 14928 3350-ERFORM-GETMAIN.
 14929
 14930     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14931     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14932
 14933 3350-ERFORM-READ.
 14934
 14935     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14936     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14937     IF PB-CANCELLATION
 14938         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14939     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 271
* EL050.cbl
 14940         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14941     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14942
 14943     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14944
 14945     IF FORM-MASTER-FOUND
 14946       IF PB-CANCELLATION
 14947          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14948             PB-SV-STATE          EQUAL   FO-STATE       AND
 14949             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14950              GO  TO 3350-EXIT
 14951          ELSE
 14952              NEXT SENTENCE
 14953       ELSE
 14954          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14955             PB-SV-STATE          EQUAL   FO-STATE       AND
 14956             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14957              GO  TO 3350-EXIT.
 14958
 14959     MOVE  'N'                    TO  FORM-MASTER-SW.
 14960     MOVE  ER-1895                TO  WS-ERROR.
 14961     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14962
 14963 3350-EXIT.
 14964      EXIT.
 14965
 14966******************************************************************
 14967*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14968*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14969*   VALID FOR THE POLICY FORM USED.                              *
 14970******************************************************************
 14971
 14972 3355-EDIT-FORM-LF-BENEFITS.
 14973
 14974     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14975        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14976         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14977         GO TO   3355-EXIT.
 14978
 14979     IF  SUB6    LESS THAN   +40
 14980         ADD  +1      TO  SUB6
 14981         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 14982
 14983     MOVE  ER-1896         TO  WS-ERROR.
 14984     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14985
 14986 3355-EXIT.
 14987      EXIT.
 14988
 14989******************************************************************
 14990*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14991*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14992*   VALID FOR THE POLICY FORM USED.                              *
 14993******************************************************************
 14994
 14995 3356-EDIT-FORM-AH-BENEFITS.
 14996
 14997     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 272
* EL050.cbl
 14998        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14999         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15000         GO TO  3356-EXIT.
 15001
 15002      IF  SUB6    LESS THAN     +40
 15003          ADD  +1      TO  SUB6
 15004          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15005
 15006     MOVE  ER-1897         TO  WS-ERROR.
 15007     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15008
 15009 3356-EXIT.
 15010      EXIT.
 15011
 15012******************************************************************
 15013*                  3357-BENEFIT-SEARCH                           *
 15014*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15015*   CANCELLATIONS ONLY.                                          *
 15016******************************************************************
 15017 3357-BENEFIT-SEARCH.
 15018     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15019         MOVE +1                          TO SUB6
 15020         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15021
 15022     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15023         MOVE +1                          TO SUB6
 15024         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15025
 15026 3357-EXIT.
 15027     EXIT.
 15028
 15029******************************************************************
 15030*                  3358-BENEFIT-LIFE-SEARCH                      *
 15031*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15032*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15033*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15034******************************************************************
 15035 3358-BENEFIT-LIFE-SEARCH.
 15036     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15037       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15038         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15039           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15040              IF FO-PLAN-REFUND-METHOD (SUB6)
 15041                     IS GREATER THAN SPACES
 15042                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15043                                          WS-LF-REFUND-CALC
 15044                 GO TO 3358-EXIT.
 15045
 15046     IF SUB6 LESS THAN +40
 15047         ADD +1                 TO SUB6
 15048         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15049
 15050 3358-EXIT.
 15051     EXIT.
 15052******************************************************************
 15053*                  3359-BENEFIT-AH-SEARCH                        *
 15054*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15055*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 273
* EL050.cbl
 15056*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15057******************************************************************
 15058 3359-BENEFIT-AH-SEARCH.
 15059     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15060       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15061         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15062           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15063              IF FO-PLAN-REFUND-METHOD (SUB6)
 15064                      IS GREATER THAN SPACES
 15065                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15066                                          WS-AH-REFUND-CALC
 15067                 GO TO 3359-EXIT.
 15068
 15069     IF SUB6 LESS THAN +40
 15070         ADD +1                 TO SUB6
 15071         GO TO 3359-BENEFIT-AH-SEARCH.
 15072
 15073 3359-EXIT.
 15074     EXIT.
 15075
 15076******************************************************************
 15077*                  3360-CHECK-FORM-LIMITS                        *
 15078*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15079*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15080******************************************************************
 15081
 15082 3360-CHECK-FORM-LIMITS.
 15083
 15084     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15085         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15086
 15087     IF NOT LF-FORM-MASTER-FOUND
 15088         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15089
 15090 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15091
 15092     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15093       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15094        WS-LF-JOINT-INDICATOR = 'J'  AND
 15095        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15096         IF PB-COMPANY-ID = 'NCL'
 15097            MOVE  ER-1911          TO  WS-ERROR
 15098            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15099         ELSE
 15100            MOVE  ER-1892          TO  WS-ERROR
 15101            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15102
 15103 3360-CHECK-FORM-LF-ATT-AGE.
 15104
 15105     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15106
 15107     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15108         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15109         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15110            IF PB-COMPANY-ID = 'NCL'
 15111                MOVE  ER-1913      TO  WS-ERROR
 15112                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15113            ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 274
* EL050.cbl
 15114                MOVE  ER-1894      TO  WS-ERROR
 15115                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15116
 15117 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15118
 15119     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15120         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15121         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15122            IF PB-COMPANY-ID = 'NCL'
 15123                MOVE  ER-1914      TO  WS-ERROR
 15124                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15125            ELSE
 15126                MOVE  ER-1899      TO  WS-ERROR
 15127                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15128
 15129 3360-CHECK-FORM-LF-TERM-BAMT.
 15130
 15131     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15132         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15133         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15134           IF  PB-COMPANY-ID = 'NCL'
 15135               MOVE  ER-1916       TO  WS-ERROR
 15136               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15137           ELSE
 15138               MOVE  ER-1902       TO  WS-ERROR
 15139               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15140
 15141     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15142                                    PB-I-LF-ALT-BENEFIT-AMT.
 15143
 15144     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15145         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15146         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15147             IF  PB-COMPANY-ID = 'NCL'
 15148                 MOVE  ER-1918     TO  WS-ERROR
 15149                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15150             ELSE
 15151                 MOVE  ER-1904     TO  WS-ERROR
 15152                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15153
 15154******************************************************************
 15155*                  3360-CHECK-FORM-AH-LIMITS                     *
 15156*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15157*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15158******************************************************************
 15159
 15160 3360-CHECK-FORM-AH-LIMITS.
 15161
 15162     IF NOT AH-FORM-MASTER-FOUND
 15163         GO TO 3999-END-EDIT.
 15164
 15165 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15166
 15167     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15168       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15169        WS-AH-JOINT-INDICATOR = 'J'  AND
 15170        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15171         IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 275
* EL050.cbl
 15172            MOVE  ER-1912          TO  WS-ERROR
 15173            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15174         ELSE
 15175            MOVE  ER-1893          TO  WS-ERROR
 15176            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15177
 15178 3360-CHECK-FORM-AH-ATT-AGE.
 15179
 15180     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15181
 15182     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15183         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15184         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15185            IF PB-COMPANY-ID = 'NCL'
 15186                MOVE  ER-1913      TO  WS-ERROR
 15187                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15188            ELSE
 15189                MOVE  ER-1894      TO  WS-ERROR
 15190                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15191
 15192 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15193
 15194     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15195         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15196         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15197            IF PB-COMPANY-ID = 'NCL'
 15198                MOVE  ER-1915      TO  WS-ERROR
 15199                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15200            ELSE
 15201                MOVE  ER-1900      TO  WS-ERROR
 15202                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15203
 15204 3360-CHECK-FORM-AH-TERM-BAMT.
 15205
 15206     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15207         FO-AH-MAX-TERM    GREATER THAN  +0
 15208         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15209             IF  PB-COMPANY-ID = 'NCL'
 15210                 MOVE  ER-1917     TO  WS-ERROR
 15211                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15212             ELSE
 15213                  MOVE  ER-1903    TO  WS-ERROR
 15214                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15215
 15216     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15217         FO-MAX-AH-AMT    GREATER THAN  +0
 15218         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15219             IF  PB-COMPANY-ID = 'NCL'
 15220                 MOVE  ER-1919     TO  WS-ERROR
 15221                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15222             ELSE
 15223                 MOVE  ER-1905     TO  WS-ERROR
 15224                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15225
 15226     GO TO 3999-END-EDIT.
 15227
 15228******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 276
* EL050.cbl
 15230******************************************************************
 15231*                  E D I T   C A N C E L                         *
 15232******************************************************************
 15233
 15234 3700-EDIT-CANCEL.
 15235     IF PB-COMPANY-ID = 'DMD'
 15236         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15237                                         WS-RES-MUNI-TAX
 15238                                         PB-CI-STATE-TAX
 15239                                         PB-CI-MUNI-TAX
 15240         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15241
 15242*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15243*       IF PB-ENTRY-BATCH  NUMERIC
 15244*          IF PB-CANCELLATION
 15245*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15246*          ELSE
 15247*             IF PB-ISSUE
 15248*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15249
 15250     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15251        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15252     END-IF
 15253*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15254*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15255
 15256     IF CM-ENTRY-STATUS = 'V'
 15257        MOVE ER-2780             TO WS-ERROR
 15258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15259        GO TO 3999-END-EDIT.
 15260
 15261     IF CM-ENTRY-STATUS = 'D'
 15262        MOVE ER-2781             TO WS-ERROR
 15263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15264        GO TO 3999-END-EDIT.
 15265
 15266     IF CM-ENTRY-STATUS = 'U'
 15267        MOVE ER-2782             TO WS-ERROR
 15268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15269
 15270***************************************************************
 15271*                                                             *
 15272*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15273*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15274*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15275*   OF ANOTHER COVERAGE.                                      *
 15276*                                                             *
 15277***************************************************************
 15278
 15279     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15280                                    PB-C-AH-CANCEL-VOID-SW.
 15281
 15282     IF PB-C-LF-CANCEL-AMT = ZERO
 15283        NEXT SENTENCE
 15284     ELSE
 15285        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15286           AND
 15287           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 277
* EL050.cbl
 15288               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15289               MOVE ER-2745           TO WS-ERROR
 15290               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15291
 15292     IF PB-C-AH-CANCEL-AMT = ZERO
 15293        NEXT SENTENCE
 15294     ELSE
 15295        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15296           AND
 15297           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15298               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15299               MOVE ER-2745           TO WS-ERROR
 15300               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15301
 15302     IF WS-LF-EARNINGS-CALC = '4'
 15303        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15304
 15305     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15306     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15307     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15308     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15309     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15310     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15311
 15312     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15313                                      PB-C-AH-REF-CALC.
 15314     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15315
 15316******************************************************************
 15317*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15318*             TO VALIDATE COVERAGE.                              *
 15319******************************************************************
 15320
 15321     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15322        PB-C-LF-CANCEL-AMT = ZEROS
 15323          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15324      ELSE
 15325          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15326
 15327     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15328        PB-C-AH-CANCEL-AMT = ZEROS
 15329          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15330      ELSE
 15331          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15332
 15333     EVALUATE TRUE
 15334         WHEN PB-CANCEL-FORCE             OR
 15335              PB-CANCEL-DATE-FORCED       OR
 15336              PB-FORCE-OFF
 15337                  IF PB-COMPANY-ID = 'ACE'
 15338                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15339                  END-IF
 15340         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15341               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15342              (PB-COMPANY-ID = 'ACE' )
 15343                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15344         WHEN OTHER
 15345              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 278
* EL050.cbl
 15346                 MOVE ER-2794              TO WS-ERROR
 15347              ELSE
 15348                 MOVE ER-2749              TO WS-ERROR
 15349              END-IF
 15350              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15351     END-EVALUATE.
 15352
 15353
 15354*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15355*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15356*            MOVE  ER-1909            TO  WS-ERROR
 15357*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15358*        ELSE
 15359*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15360
 15361     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15362     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15363        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15364     ELSE
 15365        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15366     END-IF
 15367     .
 15368 3705-EDIT-CANCEL-DT.
 15369
 15370     IF LF-COVERAGE-CANCELLED
 15371        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15372         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15373         MOVE WS-CURRENT-MONTH-END
 15374                                 TO DC-BIN-DATE-2
 15375         SET ELAPSED-BETWEEN-BIN TO TRUE
 15376*        MOVE 1                  TO DC-OPTION-CODE
 15377         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15378         IF DATE-CONVERSION-ERROR
 15379            NEXT SENTENCE
 15380          ELSE
 15381             IF DC-ELAPSED-DAYS GREATER +180
 15382                IF PB-CANCEL-DATE-FORCED  OR
 15383                   PB-CANCEL-DATE-FORCED-NO-FEE
 15384                      MOVE ER-2751  TO WS-ERROR
 15385                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15386                 ELSE
 15387                   MOVE ER-2752  TO WS-ERROR
 15388                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15389
 15390     IF AH-COVERAGE-CANCELLED
 15391        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15392         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15393         MOVE WS-CURRENT-MONTH-END
 15394                                 TO DC-BIN-DATE-2
 15395         SET ELAPSED-BETWEEN-BIN TO TRUE
 15396*        MOVE 1                  TO DC-OPTION-CODE
 15397         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15398         IF DATE-CONVERSION-ERROR
 15399            NEXT SENTENCE
 15400          ELSE
 15401             IF DC-ELAPSED-DAYS GREATER +180
 15402                IF PB-CANCEL-DATE-FORCED OR
 15403                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 279
* EL050.cbl
 15404                      MOVE ER-2751  TO WS-ERROR
 15405                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15406                 ELSE
 15407                   MOVE ER-2752  TO WS-ERROR
 15408                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15409
 15410     IF WS-ERROR = ER-2752
 15411        AND (PB-COMPANY-ID = 'ABL'
 15412         OR  PB-COMPANY-ID = 'FGL'
 15413         OR  PB-COMPANY-ID = 'IST'
 15414         OR  PB-COMPANY-ID = 'JHL'
 15415         OR  PB-COMPANY-ID = 'LAP'
 15416         OR  PB-COMPANY-ID = 'LBL'
 15417         OR  PB-COMPANY-ID = 'NCB'
 15418         OR  PB-COMPANY-ID = 'NLI'
 15419         OR  PB-COMPANY-ID = 'OFI'
 15420         OR  PB-COMPANY-ID = 'PLI'
 15421         OR  PB-COMPANY-ID = 'TAO'
 15422         OR  PB-COMPANY-ID = 'TIC'
 15423         OR  PB-COMPANY-ID = 'HER'
 15424         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15425         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15426            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15427            MOVE ER-2762     TO WS-ERROR
 15428            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15429
 15430     IF LF-COVERAGE-CANCELLED
 15431        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15432        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15433             MOVE ER-2733         TO WS-ERROR
 15434             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15435
 15436     IF AH-COVERAGE-CANCELLED
 15437        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15438        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15439              MOVE ER-2733        TO WS-ERROR
 15440              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15441
 15442     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15443        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15444        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15445           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15446            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15447              IF PB-COMPANY-ID NOT = 'LAP'
 15448               MOVE ER-2704            TO WS-ERROR
 15449               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15450
 15451     IF CERT-WAS-NOT-FOUND
 15452         GO TO 3999-END-EDIT.
 15453
 15454     IF PB-COMPANY-ID EQUAL 'CDC'
 15455        IF LF-COVERAGE-CANCELLED
 15456           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15457            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15458            MOVE PB-C-LF-CANCEL-DT
 15459                                 TO DC-BIN-DATE-2
 15460            SET ELAPSED-BETWEEN-BIN TO TRUE
 15461*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 280
* EL050.cbl
 15462            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15463            IF DATE-CONVERSION-ERROR
 15464               NEXT SENTENCE
 15465             ELSE
 15466                IF DC-ELAPSED-DAYS GREATER +60
 15467                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15468
 15469     IF PB-COMPANY-ID EQUAL 'CDC'
 15470        IF AH-COVERAGE-CANCELLED
 15471           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15472            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15473            MOVE PB-C-AH-CANCEL-DT
 15474                                 TO DC-BIN-DATE-2
 15475            MOVE +0              TO DC-ELAPSED-DAYS
 15476                                    DC-ELAPSED-MONTHS
 15477            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15478*           MOVE 1               TO DC-OPTION-CODE
 15479            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15480            IF DATE-CONVERSION-ERROR
 15481               NEXT SENTENCE
 15482             ELSE
 15483                IF DC-ELAPSED-DAYS GREATER +60
 15484                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15485
 15486     MOVE +0                     TO DC-ELAPSED-DAYS
 15487                                    DC-ELAPSED-MONTHS.
 15488
 15489     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15490        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15491          MOVE 'Z'                TO PB-CI-OB-FLAG
 15492          MOVE ER-2767            TO WS-ERROR
 15493          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15494          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15495          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15496          GO TO 3775-OVER-REF-CHK
 15497        ELSE
 15498          MOVE ZEROS              TO PB-CI-LIVES
 15499                                     PB-C-LIVES
 15500          IF PB-CI-OB-FLAG NOT = 'B'
 15501             MOVE SPACE           TO PB-CI-OB-FLAG.
 15502
 15503     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15504         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15505     ELSE
 15506         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15507
 15508     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15509        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15510            MOVE ER-2760         TO WS-ERROR
 15511            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15512
 15513     IF LF-COVERAGE-CANCELLED
 15514        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15515         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15516            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15517               MOVE ER-2774       TO WS-ERROR
 15518               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15519
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 281
* EL050.cbl
 15520     IF AH-COVERAGE-CANCELLED
 15521        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15522         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15523            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15524               MOVE ER-2775       TO WS-ERROR
 15525               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15526
 15527     IF LF-COVERAGE-CANCELLED
 15528        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15529         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15530            MOVE ER-2776         TO WS-ERROR
 15531            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15532
 15533     IF AH-COVERAGE-CANCELLED
 15534        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15535         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15536            MOVE ER-2777         TO WS-ERROR
 15537            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15538     IF LF-COVERAGE-CANCELLED
 15539        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15540        if pb-ci-lf-expire-dt = low-values or spaces
 15541           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15542           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15543           MOVE PB-CI-EXTENTION-DAYS
 15544                                 TO DC-ELAPSED-DAYS
 15545           SET BIN-PLUS-ELAPSED  TO TRUE
 15546           PERFORM 8500-DATE-CONVERT
 15547                                 THRU 8500-EXIT
 15548           IF DATE-CONVERSION-ERROR
 15549              move low-values    to dc-bin-date-2
 15550           end-if
 15551        else
 15552           move pb-ci-lf-expire-dt
 15553                                 to dc-bin-date-2
 15554        end-if
 15555        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15556           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15557                             OR  'FIA'
 15558              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15559           ELSE
 15560              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15561              MOVE ER-2731       TO WS-ERROR
 15562              PERFORM 9900-ERROR-FORMAT
 15563                                 THRU 9900-EXIT
 15564           end-if
 15565        end-if
 15566     end-if
 15567*    IF LF-COVERAGE-CANCELLED
 15568*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15569*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15570*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15571*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15572*        SET BIN-PLUS-ELAPSED      TO TRUE
 15573*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15574*        IF DATE-CONVERSION-ERROR
 15575*           NEXT SENTENCE
 15576*         ELSE
 15577*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 282
* EL050.cbl
 15578*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15579*                            OR  'FIA'
 15580*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15581*              ELSE
 15582*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15583*               MOVE ER-2731       TO WS-ERROR
 15584*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15585     .
 15586 3705-EDIT-AH-CANCEL-DT.
 15587     IF AH-COVERAGE-CANCELLED
 15588        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15589        if pb-ci-AH-expire-dt = low-values or spaces
 15590           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15591           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15592           MOVE PB-CI-EXTENTION-DAYS
 15593                                 TO DC-ELAPSED-DAYS
 15594           SET BIN-PLUS-ELAPSED  TO TRUE
 15595           PERFORM 8500-DATE-CONVERT
 15596                                 THRU 8500-EXIT
 15597           IF DATE-CONVERSION-ERROR
 15598              move low-values    to dc-bin-date-2
 15599           end-if
 15600        else
 15601           move pb-ci-ah-expire-dt
 15602                                 to dc-bin-date-2
 15603        end-if
 15604        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15605           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15606                             OR  'FIA'
 15607              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15608           ELSE
 15609              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15610              MOVE ER-2771       TO WS-ERROR
 15611              PERFORM 9900-ERROR-FORMAT
 15612                                 THRU 9900-EXIT
 15613           end-if
 15614        end-if
 15615     end-if
 15616*    IF AH-COVERAGE-CANCELLED
 15617*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15618*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15619*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15620*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15621**       MOVE 6                    TO DC-OPTION-CODE
 15622*        SET BIN-PLUS-ELAPSED      TO TRUE
 15623*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15624*        IF DATE-CONVERSION-ERROR
 15625*           NEXT SENTENCE
 15626*         ELSE
 15627*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15628*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15629*                             OR 'FIA'
 15630*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15631*             ELSE
 15632*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15633*              MOVE ER-2771       TO WS-ERROR
 15634*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15635     .
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 283
* EL050.cbl
 15636 3705-EDIT-CONTINUED.
 15637
 15638*    IF LF-COVERAGE-CANCELLED
 15639*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15640*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15641*            MOVE ER-2727         TO WS-ERROR
 15642*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15643*
 15644*    IF AH-COVERAGE-CANCELLED
 15645*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15646*        IF PB-COMPANY-ID = 'ACE'
 15647*           MOVE ER-2727        TO WS-ERROR
 15648*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15649*        ELSE
 15650*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15651*              MOVE ER-2727     TO WS-ERROR
 15652*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15653
 15654     IF PB-COMPANY-ID = 'ACE'
 15655       IF AH-COVERAGE-CANCELLED
 15656         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15657           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15658              MOVE ER-2732      TO WS-ERROR
 15659              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15660
 15661     IF PB-COMPANY-ID      EQUAL   'HER'
 15662        IF WS-ERROR        EQUAL   ER-2727
 15663            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15664            MOVE  ER-2725          TO  WS-ERROR
 15665            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15666
 15667     IF PB-C-CLAIM-CREATED-CANCEL
 15668            MOVE ER-2748         TO WS-ERROR
 15669            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15670
 15671     IF PB-C-LAST-NAME NOT = SPACES
 15672         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15673            MOVE ER-2747         TO WS-ERROR
 15674            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15675
 15676 3710-EDIT-LUMP-SUM-PRIOR.
 15677
 15678     IF AH-COVERAGE-CANCELLED
 15679         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15680             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15681                MOVE ER-2735    TO WS-ERROR
 15682                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15683
 15684     IF LF-COVERAGE-CANCELLED
 15685         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15686             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15687                MOVE ER-2735    TO WS-ERROR
 15688                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15689
 15690 3710-EDIT-PRIOR-DEATH.
 15691
 15692*    IF LF-COVERAGE-CANCELLED
 15693*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 284
* EL050.cbl
 15694*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15695*           (NOT PB-CI-OB)
 15696*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15697*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15698*                   MOVE ER-2732  TO WS-ERROR
 15699*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15700*
 15701*    IF AH-COVERAGE-CANCELLED
 15702*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15703*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15704*           (NOT PB-CI-OB)
 15705*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15706*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15707*                   MOVE ER-2732  TO WS-ERROR
 15708*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15709
 15710     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15711         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15712            (NOT PB-COMP-LF-CANCEL)
 15713             NEXT SENTENCE
 15714         ELSE
 15715           IF PB-C-LF-CANCEL-VOIDED
 15716              NEXT SENTENCE
 15717           ELSE
 15718              MOVE ER-2753      TO WS-ERROR
 15719              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15720
 15721     IF CANCEL-FUTURE-DT
 15722         GO TO 3999-END-EDIT.
 15723
 15724 3715-GET-REMAIN-TERM-LF.
 15725
 15726     IF NO-LF-BENEFIT-MATCH  OR
 15727        WS-LF-BENEFIT-CD = ZEROS
 15728        GO TO 3730-GET-AH-REMAIN-TERM.
 15729
 15730     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15731     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15732     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15733     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15734     MOVE PB-SV-STATE            TO CP-STATE.
 15735     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15736     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15737     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15738     MOVE '2'                    TO CP-PROCESS-TYPE.
 15739     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15740     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15741     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15742     IF (PB-COMPANY-ID = 'CID')
 15743        AND (CP-STATE-STD-ABBRV = 'WI')
 15744        MOVE '7'                 TO CP-REM-TERM-METHOD
 15745        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15746     ELSE
 15747        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15748        MOVE WS-REM-TRM-CALC-OPTION
 15749                                 TO CP-REM-TRM-CALC-OPTION
 15750     END-IF
 15751**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 285
* EL050.cbl
 15752     IF (PB-COMPANY-ID = 'CID')
 15753        AND (CP-STATE-STD-ABBRV = 'MO')
 15754        AND (PB-CERT-EFF-DT >= X'9B41')
 15755        AND (PB-CERT-EFF-DT <= X'A2FB')
 15756        MOVE '7'                 TO CP-REM-TERM-METHOD
 15757        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15758     END-IF
 15759     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15760                                    CP-LOAN-TERM.
 15761     IF CP-TRUNCATED-LIFE
 15762        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15763
 15764     IF CP-TERM-IS-DAYS
 15765         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15766     ELSE
 15767         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15768
 15769     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15770
 15771     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15772
 15773     IF LF-COVERAGE-CANCELLED
 15774        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15775        NEXT SENTENCE
 15776      ELSE
 15777          GO TO 3730-GET-AH-REMAIN-TERM.
 15778
 15779 3720-GET-LF-REFUND.
 15780
 15781     IF PB-C-LF-CANCEL-VOIDED OR
 15782        PB-C-AH-CANCEL-VOIDED
 15783        GO TO 3780-UPDATE-CANCEL-CERT.
 15784
 15785     IF PB-COMPANY-ID EQUAL 'BOA'
 15786         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15787         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15788         GO TO 3730-GET-AH-REMAIN-TERM.
 15789
 15790     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15791        (WS-AH-SPECIAL-CALC-CD = 'M')
 15792         MOVE ER-2767            TO WS-ERROR
 15793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15794         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15795         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15796         GO TO 3780-UPDATE-CANCEL-CERT.
 15797
 15798     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15799
 15800     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15801     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15802     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15803     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15804     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15805     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15806     IF (PB-COMPANY-ID = 'DCC')
 15807        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15808        IF PDEF-MASTER-FOUND
 15809           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 286
* EL050.cbl
 15810              (V1 > +8)
 15811              OR (PD-PROD-CODE (V1) = 'L')
 15812           END-PERFORM
 15813           IF V1 < +9
 15814              MOVE PD-MAX-AMT (V1)
 15815                           TO CP-R-MAX-TOT-BEN
 15816                              EC-AM-LF-MAX-TOT-BEN
 15817           END-IF
 15818        ELSE
 15819        MOVE ' '                 TO PDEF-MASTER-SW
 15820        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15821        MOVE PB-STATE            TO ERPDEF-STATE
 15822        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15823        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15824        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15825        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15826        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15827        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15828        IF PDEF-MASTER-FOUND
 15829           MOVE 'N'              TO PDEF-MASTER-SW
 15830           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15831           IF PDEF-MASTER-FOUND
 15832              IF (ERPDEF-KEY-SAVE (1:16) =
 15833                           PD-CONTROL-PRIMARY (1:16))
 15834                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15835                 CONTINUE
 15836              ELSE
 15837                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15838                 IF (ERPDEF-KEY-SAVE (1:16) =
 15839                           PD-CONTROL-PRIMARY (1:16))
 15840                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15841                    CONTINUE
 15842                 ELSE
 15843                    MOVE 'N'     TO PDEF-MASTER-SW
 15844                 END-IF
 15845              END-IF
 15846              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15847
 15848              IF PDEF-MASTER-FOUND
 15849                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15850                    (V1 > +8)
 15851                    OR (PD-PROD-CODE (V1) = 'L')
 15852                 END-PERFORM
 15853                 IF V1 < +9
 15854                    MOVE PD-MAX-AMT (V1)
 15855                                 TO CP-R-MAX-TOT-BEN
 15856                                    EC-AM-LF-MAX-TOT-BEN
 15857                 END-IF
 15858              END-IF
 15859           END-IF
 15860           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15861        END-IF
 15862        END-IF
 15863     END-IF
 15864     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15865
 15866     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15867
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 287
* EL050.cbl
 15868     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15869                                    PB-C-LF-REM-TERM.
 15870
 15871     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15872     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15873
 15874     IF PB-COMPANY-ID EQUAL 'FLC'
 15875        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15876           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15877           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15878                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15879                    - CM-LF-ITD-DEATH-AMT
 15880           IF PB-C-LF-REF-CALC LESS THAN +0
 15881              MOVE +0            TO PB-C-LF-REF-CALC
 15882              GO TO 3730-GET-AH-REMAIN-TERM
 15883           ELSE
 15884              GO TO 3730-GET-AH-REMAIN-TERM.
 15885
 15886     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15887                            OR '4' OR '5' OR '6' OR '8'
 15888                            OR '9' OR 'G'
 15889        MOVE PB-C-LF-REFUND-OVERRIDE
 15890                                 TO CP-EARNING-METHOD.
 15891
 15892     if pb-company-id = 'AHL'
 15893        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15894        if cp-class-code = spaces
 15895           move zeros            to cp-class-code
 15896        end-if
 15897     ELSE
 15898        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15899     END-IF
 15900*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15901     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15902     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15903                                    CP-RATING-BENEFIT-AMT.
 15904     IF CP-STATE-STD-ABBRV = 'OR'
 15905         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15906                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15907     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15908     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15909     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15910     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15911     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15912     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15913     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15914     IF WS-DEFAULT-APR NOT NUMERIC
 15915         MOVE ZEROS TO WS-DEFAULT-APR.
 15916****   N O T E   ****
 15917*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15918*      THE OH HARD CODING IN ELCRFNDP
 15919
 15920     IF PB-COMPANY-ID = 'CID'
 15921        IF CP-STATE-STD-ABBRV = 'OH'
 15922           MOVE WS-LF-EARNINGS-CALC
 15923                                 TO CP-EARNING-METHOD
 15924        END-IF
 15925     END-IF
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 288
* EL050.cbl
 15926
 15927****   N O T E   ****
 15928
 15929     IF CP-EARN-AS-NET-PAY
 15930         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15931            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15932                MOVE WS-DEFAULT-APR
 15933                                 TO  CP-LOAN-APR
 15934                MOVE ER-3780     TO  WS-ERROR
 15935                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15936            ELSE
 15937                MOVE ER-3781     TO  WS-ERROR
 15938                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15939*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15940     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15941
 15942     IF CP-REFUND-TYPE-USED NOT = SPACE
 15943         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15944
 15945     IF CP-ERROR-RATE-IS-ZERO OR
 15946        CP-ERROR-RATE-NOT-FOUND
 15947        MOVE ER-2740             TO WS-ERROR
 15948        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15949
 15950     IF CP-ERROR-RATE-FILE-NOTOPEN
 15951        MOVE ER-2617             TO WS-ERROR
 15952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15953
 15954     IF PB-COMPANY-ID = 'DCC'
 15955        AND PB-CI-ENTRY-STATUS = 'M'
 15956        MOVE +0                  TO PB-C-LF-REF-CALC
 15957     ELSE
 15958        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15959     END-IF
 15960
 15961     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15962         GO TO 3730-GET-AH-REMAIN-TERM.
 15963
 15964*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15965*       ADD +1                   TO PB-C-LF-REM-TERM
 15966*                                   CP-REMAINING-TERM
 15967*                                   CP-ORIGINAL-TERM.
 15968
 15969     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15970     MOVE '2'                    TO CP-EARNING-METHOD
 15971                                    CP-RATING-METHOD.
 15972     IF PB-COMPANY-ID = 'CID'
 15973        IF (CP-STATE-STD-ABBRV = 'MN')
 15974           AND (PB-CERT-EFF-DT > X'A4FF')
 15975           AND (WS-LF-EARNINGS-CALC = 'B')
 15976           MOVE '5'              TO CP-EARNING-METHOD
 15977           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15978        END-IF
 15979     END-IF
 15980     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15981                                        CP-REMAINING-BENEFIT
 15982                                        CP-RATING-BENEFIT-AMT.
 15983     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 289
* EL050.cbl
 15984         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15985                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15986     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15987     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15988
 15989     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15990
 15991     IF CP-ERROR-RATE-IS-ZERO OR
 15992        CP-ERROR-RATE-NOT-FOUND
 15993        MOVE ER-2740             TO WS-ERROR
 15994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15995
 15996     IF CP-ERROR-RATE-FILE-NOTOPEN
 15997        MOVE ER-2617             TO WS-ERROR
 15998        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15999
 16000     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16001
 16002******************************************************************
 16003
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 290
* EL050.cbl
 16005 3730-GET-AH-REMAIN-TERM.
 16006     IF NO-AH-BENEFIT-MATCH  OR
 16007        WS-AH-BENEFIT-CD = ZEROS
 16008         GO TO 3770-CHECK-REFUNDS.
 16009
 16010     IF PB-CI-AH-LUMP-SUM-DISAB
 16011         IF  PB-C-AH-CANCEL-AMT = ZERO
 16012            IF NOT PB-COMP-AH-CANCEL
 16013             GO TO 3770-CHECK-REFUNDS.
 16014
 16015     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16016     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16017     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16018     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16019     MOVE PB-SV-STATE            TO CP-STATE.
 16020     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16021     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16022     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16023     MOVE '2'                    TO CP-PROCESS-TYPE.
 16024     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16025     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16026     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16027     IF (PB-COMPANY-ID = 'CID')
 16028        AND (CP-STATE-STD-ABBRV = 'WI')
 16029        MOVE '7'                 TO CP-REM-TERM-METHOD
 16030        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16031     ELSE
 16032        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16033        MOVE WS-REM-TRM-CALC-OPTION
 16034                                 TO CP-REM-TRM-CALC-OPTION
 16035     END-IF
 16036     IF (PB-COMPANY-ID = 'CID')
 16037        AND (CP-STATE-STD-ABBRV = 'MO')
 16038        AND (PB-CERT-EFF-DT >= X'9B41')
 16039        AND (PB-CERT-EFF-DT <= X'A2FB')
 16040        MOVE '7'                 TO CP-REM-TERM-METHOD
 16041        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16042     END-IF
 16043     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16044                                    CP-LOAN-TERM.
 16045     IF NOT CP-TERM-IS-DAYS
 16046         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16047
 16048     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16049
 16050     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16051
 16052     IF AH-COVERAGE-CANCELLED
 16053        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16054        NEXT SENTENCE
 16055      ELSE
 16056         GO TO 3770-CHECK-REFUNDS.
 16057
 16058 3740-GET-AH-REFUND.
 16059
 16060     IF PB-C-LF-CANCEL-VOIDED OR
 16061        PB-C-AH-CANCEL-VOIDED
 16062        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 291
* EL050.cbl
 16063
 16064     IF PB-COMPANY-ID = 'BOA'
 16065         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16066         GO TO 3770-CHECK-REFUNDS.
 16067
 16068     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16069*    MOVE ' '                    TO DC-OPTION-CODE
 16070     SET BIN-TO-GREG             TO TRUE
 16071     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16072     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16073                                    PB-C-AH-REM-TERM.
 16074     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16075     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16076
 16077     IF PB-COMPANY-ID EQUAL 'FLC'
 16078        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16079           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16080           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16081                    - CM-AH-ITD-AH-PMT)
 16082           IF PB-C-AH-REF-CALC LESS THAN +0
 16083              MOVE +0            TO PB-C-AH-REF-CALC
 16084              GO TO 3770-CHECK-REFUNDS
 16085           ELSE
 16086              GO TO 3770-CHECK-REFUNDS.
 16087
 16088     IF PB-COMPANY-ID = 'DCC'
 16089        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16090            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16091           MOVE 'S'              TO CP-EARNING-METHOD
 16092        END-IF
 16093     END-IF
 16094     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16095                            OR '4' OR '5' OR '6' OR '8'
 16096                            OR '9' OR 'G' OR 'S'
 16097        MOVE PB-C-AH-REFUND-OVERRIDE
 16098                                 TO CP-EARNING-METHOD.
 16099
 16100     if pb-company-id = 'AHL'
 16101        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16102        if cp-class-code = spaces
 16103           move zeros            to cp-class-code
 16104        end-if
 16105     ELSE
 16106        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16107     END-IF
 16108*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16109     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16110     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16111                                    CP-RATING-BENEFIT-AMT.
 16112     IF CP-STATE-STD-ABBRV = 'OR'
 16113         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16114                                         PB-CI-AH-TERM.
 16115     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16116     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16117     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16118     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16119     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16120     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 292
* EL050.cbl
 16121
 16122     IF CP-STATE-STD-ABBRV = 'OH'
 16123        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16124                                AND 'CID' AND 'DCC' AND 'AHL')
 16125           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16126              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16127              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16128              MOVE '6' TO CP-EARNING-METHOD
 16129           END-IF
 16130        END-IF
 16131        IF PB-COMPANY-ID = 'CID'
 16132           IF NO-LIFE-COVERAGE
 16133              IF CP-CRITICAL-PERIOD
 16134                 MOVE '2'       TO CP-EARNING-METHOD
 16135              ELSE
 16136                 MOVE '6'       TO CP-EARNING-METHOD
 16137              END-IF
 16138           ELSE
 16139              IF WS-LF-COVERAGE-TYPE = 'L'
 16140                 MOVE '2'       TO CP-EARNING-METHOD
 16141              ELSE
 16142                 IF (PB-CI-LF-TERM > +60) OR
 16143                    (WS-LF-EARNINGS-CALC = '5')
 16144                    IF CP-CRITICAL-PERIOD
 16145                       MOVE '2'  TO CP-EARNING-METHOD
 16146                    ELSE
 16147                       MOVE '6'  TO CP-EARNING-METHOD
 16148                    END-IF
 16149                 ELSE
 16150                    MOVE '1'     TO CP-EARNING-METHOD
 16151                 END-IF
 16152              END-IF
 16153           END-IF
 16154        END-IF
 16155     END-IF
 16156
 16157*    IF CP-STATE-STD-ABBRV = 'VA'
 16158*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16159*          IF CP-ORIGINAL-TERM GREATER 61
 16160*             MOVE '6' TO CP-EARNING-METHOD
 16161*          ELSE
 16162*             MOVE '1' TO CP-EARNING-METHOD.
 16163
 16164     IF WS-DEFAULT-APR NOT NUMERIC
 16165         MOVE ZEROS TO WS-DEFAULT-APR.
 16166     IF CP-EARN-AS-NET-PAY
 16167         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16168            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16169                MOVE WS-DEFAULT-APR
 16170                                 TO  CP-LOAN-APR
 16171                MOVE ER-3780     TO  WS-ERROR
 16172                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16173            ELSE
 16174                MOVE ER-3781     TO  WS-ERROR
 16175                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16176     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16177     IF PB-COMPANY-ID = 'DCC'
 16178        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 293
* EL050.cbl
 16179        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16180        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16181     END-IF
 16182     IF PB-COMPANY-ID = 'DCC'
 16183        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16184        AND (CP-EARNING-METHOD = 'D')
 16185        AND (CP-CANCEL-REASON NOT = 'R')
 16186        CONTINUE
 16187     ELSE
 16188        GO TO 3750-CONTINUE
 16189     END-IF
 16190     MOVE ' '                    TO DD-IU-SW
 16191     IF NOT PDEF-MASTER-FOUND
 16192        MOVE ' '                 TO PDEF-MASTER-SW
 16193        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16194        MOVE PB-STATE            TO ERPDEF-STATE
 16195        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16196        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16197        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16198        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16199        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16200        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16201        IF PDEF-MASTER-FOUND
 16202           MOVE 'N'              TO PDEF-MASTER-SW
 16203           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16204           IF PDEF-MASTER-FOUND
 16205              IF (ERPDEF-KEY-SAVE (1:16) =
 16206                           PD-CONTROL-PRIMARY (1:16))
 16207                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16208                 CONTINUE
 16209              ELSE
 16210                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16211                 IF (ERPDEF-KEY-SAVE (1:16) =
 16212                           PD-CONTROL-PRIMARY (1:16))
 16213                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16214                    CONTINUE
 16215                 ELSE
 16216                    MOVE ER-2740 TO WS-ERROR
 16217                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16218                    GO TO 3770-CHECK-REFUNDS
 16219                 END-IF
 16220              END-IF
 16221           END-IF
 16222           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16223        END-IF
 16224     END-IF
 16225     IF PDEF-MASTER-FOUND
 16226        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16227           (V1 > +8)
 16228           OR (PD-PROD-CODE (V1) = 'I')
 16229        END-PERFORM
 16230        IF V1 < +9
 16231           SET DD-IU-PRESENT        TO TRUE
 16232        END-IF
 16233        IF WS-AH-DCC-TRUNC = 'T'
 16234           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16235        ELSE
 16236           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 294
* EL050.cbl
 16237        END-IF
 16238        EVALUATE TRUE
 16239           WHEN WS-TERM > +168
 16240              MOVE 15               TO V1
 16241           WHEN WS-TERM > +156
 16242              MOVE 14               TO V1
 16243           WHEN WS-TERM > +144
 16244              MOVE 13               TO V1
 16245           WHEN WS-TERM > +132
 16246              MOVE 12               TO V1
 16247           WHEN WS-TERM > +120
 16248              MOVE 11               TO V1
 16249           WHEN WS-TERM > +108
 16250              MOVE 10               TO V1
 16251           WHEN WS-TERM > +96
 16252              MOVE 9                TO V1
 16253           WHEN WS-TERM > +84
 16254              MOVE 8                TO V1
 16255           WHEN WS-TERM > +72
 16256              MOVE 7                TO V1
 16257           WHEN WS-TERM > +60
 16258              MOVE 6                TO V1
 16259           WHEN WS-TERM > +48
 16260              MOVE 5                TO V1
 16261           WHEN WS-TERM > +36
 16262              MOVE 4                TO V1
 16263           WHEN WS-TERM > +24
 16264              MOVE 3                TO V1
 16265           WHEN WS-TERM > +12
 16266              MOVE 2                TO V1
 16267           WHEN OTHER
 16268              MOVE 1                TO V1
 16269        END-EVALUATE
 16270
 16271        EVALUATE TRUE
 16272*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16273*             < +13)
 16274*             AND (DD-IU-PRESENT)
 16275*             MOVE 2                TO V2
 16276*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16277*             MOVE 1                TO V2
 16278           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16279              MOVE 2                TO V2
 16280           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16281              MOVE 3                TO V2
 16282           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16283              MOVE 4                TO V2
 16284           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16285              MOVE 5                TO V2
 16286           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16287              MOVE 6                TO V2
 16288           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16289              MOVE 7                TO V2
 16290           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16291              MOVE 8                TO V2
 16292           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16293              MOVE 9                TO V2
 16294           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 295
* EL050.cbl
 16295              MOVE 10               TO V2
 16296           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16297              MOVE 11               TO V2
 16298           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16299              MOVE 12               TO V2
 16300           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16301              MOVE 13               TO V2
 16302           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16303              MOVE 14               TO V2
 16304           WHEN OTHER
 16305              MOVE 15               TO V2
 16306        END-EVALUATE
 16307
 16308        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16309                                 TO CP-DDF-LO-FACT
 16310        MOVE PD-UEP-FACTOR (V1 V2)
 16311                                 TO CP-DDF-HI-FACT
 16312
 16313        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16314        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16315        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16316           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16317        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16318        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16319        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16320           + PD-1ST-YR-ADMIN-ALLOW
 16321
 16322        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16323*       IF PI-CLP-YN = 'Y'
 16324*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16325*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16326*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16327*       END-IF
 16328
 16329        IF DD-IU-PRESENT
 16330           MOVE 'I'              TO CP-EARNING-METHOD
 16331        END-IF
 16332        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16333                                     CP-CLP-RATE-UP
 16334        IF CP-IU-RATE-UP NOT = ZEROS
 16335           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16336              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16337           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16338              / (1 - WS-WORK-FACT)
 16339        END-IF
 16340     END-IF
 16341     .
 16342 3750-CONTINUE.
 16343     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16344
 16345     IF CP-REFUND-TYPE-USED NOT = SPACE
 16346         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16347
 16348     IF CP-ERROR-RATE-IS-ZERO OR
 16349        CP-ERROR-RATE-NOT-FOUND
 16350        MOVE ER-2740             TO WS-ERROR
 16351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16352
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 296
* EL050.cbl
 16353     IF CP-ERROR-RATE-FILE-NOTOPEN
 16354        MOVE ER-2617             TO WS-ERROR
 16355        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16356     IF PB-COMPANY-ID = 'DCC'
 16357        AND PB-CI-ENTRY-STATUS = 'M'
 16358        MOVE +0                  TO PB-C-AH-REF-CALC
 16359     ELSE
 16360        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16361     END-IF
 16362     IF PB-COMPANY-ID = 'DCC'
 16363        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16364        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16365        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16366        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16367        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16368        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16369        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16370        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16371        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16372     END-IF
 16373     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 297
* EL050.cbl
 16375
 16376 3770-CHECK-REFUNDS.
 16377
 16378     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16379        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16380           MOVE ER-2766          TO WS-ERROR
 16381           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16382           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16383           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16384              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16385
 16386     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16387        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16388           MOVE ER-2766          TO WS-ERROR
 16389           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16390           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16391           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16392              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16393
 16394     IF PB-COMP-LF-CANCEL
 16395        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16396        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16397           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16398              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16399
 16400     IF PB-COMP-AH-CANCEL
 16401        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16402        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16403           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16404              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16405
 16406     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16407             GIVING WS-UNSIGN-WRK1
 16408     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16409             GIVING WS-UNSIGN-WRK2.
 16410
 16411     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16412         MOVE ZERO TO WS-UNSIGN-WRK1.
 16413
 16414     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16415         MOVE ZERO TO WS-UNSIGN-WRK2.
 16416
 16417     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16418
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 298
* EL050.cbl
 16420
 16421 3772-CONTINUE.
 16422
 16423**********************************
 16424*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16425*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16426*** DOUBLES THE TOLERANCE AMOUNT.
 16427***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16428**********************************
 16429     IF PB-COMPANY-ID = 'MON'
 16430     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16431         IF WS-REF-REJECT-SW = SPACE
 16432             MOVE ER-2754        TO WS-ERROR
 16433             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16434           ELSE
 16435             MOVE ER-2736        TO WS-ERROR
 16436             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16437**********************************
 16438
 16439 3773-CONTINUE.
 16440
 16441     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16442        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16443           MOVE ER-2723          TO WS-ERROR
 16444           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16445
 16446     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16447        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16448           MOVE ER-2724          TO WS-ERROR
 16449           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16450
 16451     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16452         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16453             (1 + WS-LF-REFUND-OVS-PCT)
 16454     ELSE
 16455         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16456
 16457     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16458         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16459             (1 - WS-TOL-LF-REFUND-PCT)
 16460     ELSE
 16461         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16462
 16463     IF (PB-COMPANY-ID = 'DCC')
 16464        AND (PB-CI-ENTRY-STATUS = 'M')
 16465        AND (PB-C-LF-CANCEL-AMT > +0)
 16466        MOVE ER-3843             TO WS-ERROR
 16467        PERFORM 9900-ERROR-FORMAT
 16468                                 THRU 9900-EXIT
 16469     END-IF
 16470     EVALUATE TRUE
 16471        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16472           CONTINUE
 16473        WHEN PB-C-LF-CANCEL-AMT = +0
 16474                 AND PB-C-LF-REF-CALC > +0
 16475           CONTINUE
 16476        WHEN WS-LF-REFUND-OVS-AMT = 0
 16477                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 299
* EL050.cbl
 16478           CONTINUE
 16479        WHEN OTHER
 16480           IF WS-TOL-LF-REFUND  = +0
 16481              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16482           END-IF
 16483           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16484                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16485                          (PB-C-LF-CANCEL-AMT))
 16486              CONTINUE
 16487           ELSE
 16488              IF WS-LF-REFUND-OVS-AMT = +0
 16489                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16490              END-IF
 16491              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16492                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16493                                       PB-C-LF-CANCEL-AMT)
 16494                 CONTINUE
 16495              ELSE
 16496                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16497                   MOVE ER-2754   TO  WS-ERROR
 16498                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16499                 ELSE
 16500                    MOVE ER-2736   TO  WS-ERROR
 16501                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16502                 END-IF
 16503              END-IF
 16504           END-IF
 16505     END-EVALUATE.
 16506
 16507     EVALUATE TRUE
 16508        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16509           CONTINUE
 16510        WHEN PB-C-LF-CANCEL-AMT = +0
 16511                 AND PB-C-LF-REF-CALC > +0
 16512           CONTINUE
 16513        WHEN OTHER
 16514           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16515               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16516              CONTINUE
 16517           ELSE
 16518              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16519               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16520                CONTINUE
 16521              ELSE
 16522                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16523                     MOVE ER-2754   TO  WS-ERROR
 16524                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16525                 ELSE
 16526                     MOVE ER-2736   TO  WS-ERROR
 16527                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16528                 END-IF
 16529              END-IF
 16530           END-IF
 16531     END-EVALUATE.
 16532
 16533     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16534         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16535             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 300
* EL050.cbl
 16536     ELSE
 16537         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16538
 16539     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16540         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16541             (1 - WS-TOL-AH-REFUND-PCT)
 16542     ELSE
 16543         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16544
 16545     IF (PB-COMPANY-ID = 'DCC')
 16546        AND (PB-CI-ENTRY-STATUS = 'M')
 16547        AND (PB-C-AH-CANCEL-AMT > +0)
 16548        MOVE ER-3843             TO WS-ERROR
 16549        PERFORM 9900-ERROR-FORMAT
 16550                                 THRU 9900-EXIT
 16551     END-IF
 16552     EVALUATE TRUE
 16553        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16554           CONTINUE
 16555*       WHEN PB-C-AH-REF-CALC = +0 AND
 16556*                  PB-C-AH-CANCEL-AMT > +0
 16557        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16558                   PB-C-AH-REF-CALC > +0
 16559           CONTINUE
 16560        WHEN WS-AH-REFUND-OVS-AMT = +0
 16561                AND WS-TOL-AH-REFUND = +0
 16562           CONTINUE
 16563        WHEN OTHER
 16564           IF WS-TOL-AH-REFUND = +0
 16565              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16566           END-IF
 16567           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16568               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16569                                         PB-C-AH-CANCEL-AMT)
 16570              CONTINUE
 16571           ELSE
 16572              IF WS-AH-REFUND-OVS-AMT = +0
 16573                 MOVE +9999999.99 TO
 16574                         WS-AH-REFUND-OVS-AMT
 16575              END-IF
 16576              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16577                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16578                                         PB-C-AH-CANCEL-AMT)
 16579                 CONTINUE
 16580              ELSE
 16581                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16582                    MOVE ER-2754   TO  WS-ERROR
 16583                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16584                 ELSE
 16585                    MOVE ER-2736   TO  WS-ERROR
 16586                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16587                 END-IF
 16588              END-IF
 16589           END-IF
 16590     END-EVALUATE.
 16591
 16592     EVALUATE TRUE
 16593        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 301
* EL050.cbl
 16594           CONTINUE
 16595*       WHEN PB-C-AH-REF-CALC > +0 AND
 16596*                  PB-C-AH-CANCEL-AMT = +0
 16597        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16598                   PB-C-AH-REF-CALC = +0
 16599           CONTINUE
 16600        WHEN OTHER
 16601           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16602               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16603              CONTINUE
 16604           ELSE
 16605              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16606                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16607                 CONTINUE
 16608              ELSE
 16609                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16610                     MOVE ER-2754   TO  WS-ERROR
 16611                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16612                 ELSE
 16613                     MOVE ER-2736   TO  WS-ERROR
 16614                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16615                 END-IF
 16616              END-IF
 16617           END-IF
 16618     END-EVALUATE.
 16619
 16620     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16621        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16622        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16623           AND  PB-C-LF-REF-CALC < +1.00
 16624           AND  PB-C-AH-REF-CALC < +1.00
 16625           CONTINUE
 16626        ELSE
 16627           IF (PB-COMPANY-ID = 'DCC')
 16628              AND (PB-CI-ENTRY-STATUS = 'M')
 16629              CONTINUE
 16630           ELSE
 16631              MOVE ER-2741       TO WS-ERROR
 16632              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16633           END-IF
 16634        END-IF
 16635     END-IF
 16636
 16637     IF (PB-C-LF-CANCEL-AMT = ZERO
 16638        AND WS-LF-BENEFIT-CD NOT = ZERO
 16639        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16640        AND PB-C-LF-REF-CALC NOT = ZERO)
 16641        OR
 16642        (PB-C-LF-CANCEL-AMT = ZERO
 16643        AND WS-LF-BENEFIT-CD NOT = ZERO
 16644        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16645             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16646                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16647                NEXT SENTENCE
 16648             ELSE
 16649                MOVE ER-2739        TO WS-ERROR
 16650                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16651
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 302
* EL050.cbl
 16652     IF (PB-C-AH-CANCEL-AMT = ZERO
 16653        AND WS-AH-BENEFIT-CD NOT = ZERO
 16654        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16655        AND PB-C-AH-REF-CALC NOT = ZERO)
 16656        OR
 16657        (PB-C-AH-CANCEL-AMT = ZERO
 16658        AND WS-AH-BENEFIT-CD NOT = ZERO
 16659        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16660             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16661                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16662                NEXT SENTENCE
 16663             ELSE
 16664                MOVE ER-2738        TO WS-ERROR
 16665                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16666
 16667 3775-OVER-REF-CHK.
 16668
 16669     IF PB-CI-ENTRY-STATUS = '5'
 16670        GO TO 3780-UPDATE-CANCEL-CERT.
 16671
 16672     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16673                              PB-CI-LF-ALT-PREMIUM-AMT.
 16674
 16675     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16676        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16677                                 PB-C-LF-REF-CALC
 16678      ELSE
 16679        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16680                                 PB-C-LF-CANCEL-AMT.
 16681
 16682     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16683        MOVE ER-2755             TO WS-ERROR
 16684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16685
 16686     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16687
 16688     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16689        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16690                                 PB-C-AH-REF-CALC
 16691      ELSE
 16692        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16693                                 PB-C-AH-CANCEL-AMT.
 16694
 16695     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16696        MOVE ER-2778             TO WS-ERROR
 16697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16698
 16699     IF PB-CI-OB-FLAG NOT = 'Z'
 16700        NEXT SENTENCE
 16701       ELSE
 16702         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16703            MOVE ER-2757           TO WS-ERROR
 16704            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16705
 16706 3780-UPDATE-CANCEL-CERT.
 16707
 16708     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16709        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 303
* EL050.cbl
 16710        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16711
 16712     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16713         MOVE ER-2729              TO WS-ERROR
 16714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16715
 16716     IF PB-CI-LF-BENEFIT-CD = ZERO
 16717         GO TO 3780-UPDATE-CONT-1.
 16718
 16719     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16720         GO TO 3780-UPDATE-CONT-1.
 16721
 16722     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16723       AND
 16724        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16725       AND
 16726        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16727       AND
 16728        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16729            NEXT SENTENCE
 16730       ELSE
 16731        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16732          AND
 16733***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16734***       AND
 16735           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16736            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16737               MOVE ER-2730      TO WS-ERROR
 16738               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16739               GO TO 3999-END-EDIT
 16740            ELSE
 16741               GO TO 3999-END-EDIT
 16742        ELSE
 16743            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16744               MOVE ER-2765           TO WS-ERROR
 16745               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16746               GO TO 3785-CHECK-NH.
 16747*              GO TO 3999-END-EDIT.
 16748
 16749 3780-UPDATE-CONT-1.
 16750     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16751
 16752     IF PB-CI-AH-BENEFIT-CD = ZERO
 16753         GO TO 3780-UPDATE-CONT-2.
 16754
 16755     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16756         GO TO 3780-UPDATE-CONT-2.
 16757
 16758     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16759
 16760     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16761       AND
 16762        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16763       AND
 16764        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16765       AND
 16766        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16767            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 304
* EL050.cbl
 16768       ELSE
 16769        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16770          AND
 16771***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16772***       AND
 16773           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16774           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16775            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16776               MOVE ER-2773      TO WS-ERROR
 16777               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16778               GO TO 3999-END-EDIT
 16779            ELSE
 16780               GO TO 3999-END-EDIT
 16781            END-IF
 16782           ELSE
 16783             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16784                MOVE ER-2890 TO WS-ERROR
 16785                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16786                GO TO 3999-END-EDIT
 16787             ELSE
 16788                GO TO 3785-CHECK-NH
 16789             END-IF
 16790           END-IF
 16791          ELSE
 16792            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16793              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16794                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16795                   MOVE ER-2890 TO WS-ERROR
 16796                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16797                   GO TO 3999-END-EDIT
 16798                ELSE
 16799                   MOVE ER-2765 TO WS-ERROR
 16800                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16801                   GO TO 3785-CHECK-NH
 16802                END-IF
 16803              ELSE
 16804               MOVE ER-2765      TO WS-ERROR
 16805               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16806               GO TO 3785-CHECK-NH.
 16807*              GO TO 3999-END-EDIT.
 16808
 16809 3780-UPDATE-CONT-2.
 16810
 16811     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16812        AND WS-LF-BENEFIT-CD = ZERO
 16813           MOVE ER-2743           TO WS-ERROR
 16814           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16815
 16816     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16817        AND WS-AH-BENEFIT-CD = ZERO
 16818           MOVE ER-2744           TO WS-ERROR
 16819           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16820
 16821     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16822        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16823        AND
 16824        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16825         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 305
* EL050.cbl
 16826           MOVE ER-2746           TO WS-ERROR
 16827           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16828
 16829     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16830       AND
 16831        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16832             MOVE ER-2737        TO WS-ERROR
 16833             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16834
 16835     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16836       AND
 16837        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16838             MOVE ER-2737        TO WS-ERROR
 16839             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16840
 16841     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16842         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16843             OR 'CID' OR 'DCC' OR 'AHL'
 16844             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16845         ELSE
 16846             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16847                 MOVE ER-2768    TO WS-ERROR
 16848                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16849             ELSE
 16850                 MOVE ER-2756    TO WS-ERROR
 16851                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16852
 16853     IF CERT-PEND-ISSUE-RETURNED
 16854        MOVE ER-2772             TO WS-ERROR
 16855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16856 3785-CHECK-NH.
 16857     IF PB-STATE NOT = 'NH'
 16858        GO TO 3999-END-EDIT
 16859     END-IF
 16860
 16861     MOVE ER-2796                TO WS-ERROR
 16862     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16863     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16864        OR (CM-NH-INTERFACE-SW = 'Y')
 16865        MOVE ER-2793             TO WS-ERROR
 16866        PERFORM 9900-ERROR-FORMAT
 16867                                 THRU 9900-EXIT
 16868     END-IF
 16869     MOVE +0                     TO WS-PAYMENT-AMT
 16870     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16871        GO TO 3999-END-EDIT
 16872     END-IF
 16873     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16874        GO TO 3999-END-EDIT
 16875     END-IF
 16876     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16877     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16878     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16879        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16880     END-IF
 16881     MOVE '1'                    TO DC-OPTION-CODE
 16882     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16883     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 306
* EL050.cbl
 16884        IF DC-ELAPSED-DAYS < +16
 16885           GO TO 3999-END-EDIT
 16886        END-IF
 16887     END-IF
 16888     MOVE +0                     TO DC-ELAPSED-DAYS
 16889     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16890     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16891     MOVE '1'                    TO DC-OPTION-CODE
 16892     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16893     IF NO-CONVERSION-ERROR
 16894        IF DC-ELAPSED-DAYS > +30
 16895           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16896        ELSE
 16897           GO TO 3999-END-EDIT
 16898        END-IF
 16899     ELSE
 16900        GO TO 3999-END-EDIT
 16901     END-IF
 16902     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16903        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16904           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16905     IF WS-PAYMENT-AMT < 600.00
 16906        GO TO 3999-END-EDIT
 16907     END-IF
 16908     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16909
 16910     IF (ERMAIL-FOUND = ' ')
 16911         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16912         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16913        GO TO 3999-END-EDIT
 16914     END-IF
 16915     MOVE ER-2795                TO WS-ERROR
 16916     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16917
 16918     GO TO 3999-END-EDIT.
 16919******************************************************************
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 307
* EL050.cbl
 16921 3990-FILES-NOT-OPEN.
 16922
 16923     MOVE ER-2617                TO WS-ERROR.
 16924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16925     GO TO 9990-RETURN.
 16926
 16927 3999-END-EDIT.
 16928
 16929     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16930
 16931     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16932         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16933         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16934             PERFORM 9250-UNLOCK-RETURN
 16935             GO TO 9990-RETURN
 16936          ELSE
 16937             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16938             GO TO 9990-RETURN.
 16939
 16940     IF PB-CANCELLATION
 16941          GO TO 9990-RETURN.
 16942
 16943     IF CERT-WAS-NOT-FOUND
 16944        MOVE SPACES              TO CERTIFICATE-MASTER.
 16945
 16946     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16947
 16948     IF CERT-WAS-FOUND
 16949         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16950             PERFORM 9250-UNLOCK-RETURN
 16951          ELSE
 16952            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16953      ELSE
 16954         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16955
 16956     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16957        IF PB-COMPANY-ID = 'DCC' AND
 16958           (PB-CARRIER = '2' OR '4' OR '6')
 16959              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16960        END-IF
 16961     END-IF.
 16962
 16963     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 16964         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 16965     END-IF.
 16966
 16967     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16968     IF ((PB-COMPANY-ID = 'DCC')
 16969        AND (WS-NO-SECURE-PAY))
 16970                  OR
 16971        (WS-LF-SPECIAL-CALC-CD = 'O'
 16972        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16973        SET SKIP-ADDR-EDIT       TO TRUE
 16974     END-IF
 16975     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16976        AND (NOT SKIP-ADDR-EDIT)
 16977        MOVE ER-2963             TO WS-ERROR
 16978        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 308
* EL050.cbl
 16979                                 THRU 9900-EXIT
 16980        GO TO 9990-RETURN
 16981     END-IF
 16982     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 16983     IF ERPNDM-FOUND NOT = 'X'
 16984        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16985           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16986           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16987           AND (NOT SKIP-ADDR-EDIT)
 16988           MOVE ER-2694          TO WS-ERROR
 16989           PERFORM 9900-ERROR-FORMAT
 16990                                 THRU 9900-EXIT
 16991        END-IF
 16992        MOVE ' '                 TO STATE-RECORD-ERROR
 16993        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16994        MOVE PM-STATE            TO CNTL-ACCESS
 16995        MOVE '3'                 TO CNTL-REC-TYPE
 16996        MOVE +0                  TO CNTL-SEQ-NO
 16997        MOVE '0'                 TO RC-SW-2
 16998        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16999        IF (NO-STATE-RECORD)
 17000           OR (CF-RECORD-TYPE NOT = '3')
 17001           OR (PM-STATE NOT = CF-STATE-CODE)
 17002           IF (PM-STATE = SPACES)
 17003              AND (SKIP-ADDR-EDIT)
 17004              CONTINUE
 17005           ELSE
 17006              MOVE ER-2963       TO WS-ERROR
 17007              PERFORM 9900-ERROR-FORMAT
 17008                                 THRU 9900-EXIT
 17009           END-IF
 17010        END-IF
 17011        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17012           MOVE ER-2883          TO WS-ERROR
 17013           PERFORM 9900-ERROR-FORMAT
 17014                                 THRU 9900-EXIT
 17015        END-IF
 17016        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17017           MOVE ' '                 TO STATE-RECORD-ERROR
 17018           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17019           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17020           MOVE '3'                 TO CNTL-REC-TYPE
 17021           MOVE +0                  TO CNTL-SEQ-NO
 17022           MOVE '0'                 TO RC-SW-2
 17023           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17024           IF NO-STATE-RECORD
 17025              OR (CF-RECORD-TYPE NOT = '3')
 17026              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17027              MOVE ER-2964          TO WS-ERROR
 17028              PERFORM 9900-ERROR-FORMAT
 17029                                    THRU 9900-EXIT
 17030           END-IF
 17031        END-IF
 17032     ELSE
 17033        IF NOT SKIP-ADDR-EDIT
 17034           MOVE ER-2393          TO WS-ERROR
 17035           PERFORM 9900-ERROR-FORMAT
 17036                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 309
* EL050.cbl
 17037        END-IF
 17038     END-IF
 17039
 17040     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17041
 17042     IF (ERMAIL-FOUND = ' ' AND
 17043        ERPNDM-FOUND = ' ')
 17044        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17045           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17046           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17047          OR
 17048           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17049          OR
 17050           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17051           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17052           GO TO 3999-UNLOCK-ERMAIL.
 17053
 17054     IF ERPNDM-FOUND = 'X'
 17055        GO TO 3999-UNLOCK-ERMAIL.
 17056
 17057     IF PM-INSURED-LAST-NAME      = SPACES
 17058        AND PM-INSURED-FIRST-NAME = SPACES
 17059        AND PM-ADDRESS-LINE-1     = SPACES
 17060        AND PM-ADDRESS-LINE-2     = SPACES
 17061        AND PM-CITY-STATE         = SPACES
 17062        AND PM-CRED-BENE-NAME     = SPACES
 17063        AND PM-CRED-BENE-ADDR     = SPACES
 17064        AND PM-CRED-BENE-CTYST    = SPACES
 17065        GO TO 3999-UNLOCK-ERMAIL
 17066     END-IF
 17067
 17068     MOVE SPACES                 TO MAILING-DATA.
 17069
 17070     MOVE 'MA'                   TO MA-RECORD-ID.
 17071     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17072     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17073     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17074     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17075     MOVE PB-SV-STATE            TO MA-STATE.
 17076     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17077     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17078
 17079     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17080     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17081
 17082     IF ERMAIL-FOUND = ' '
 17083        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17084     ELSE
 17085        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17086        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17087        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17088
 17089     GO TO 9990-RETURN.
 17090
 17091 3999-UNLOCK-ERMAIL.
 17092     IF ERMAIL-FOUND = ' '
 17093        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17094
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 310
* EL050.cbl
 17095     GO TO 9990-RETURN.
 17096******************************************************************
 17097
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 311
* EL050.cbl
 17099 4000-UPDATE-CANCELLED-CERT.
 17100     IF CERT-WAS-NOT-FOUND
 17101        GO TO 4299-EXIT.
 17102
 17103*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17104     IF PB-C-NH-INT-ON-REFS > ZEROS
 17105        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17106     END-IF
 17107     IF PB-C-REF-INTERFACE-SW = 'Y'
 17108        MOVE PB-C-REF-INTERFACE-SW
 17109                                 TO CM-NH-INTERFACE-SW
 17110     END-IF
 17111     IF PB-C-POST-CARD-IND = 'Y'
 17112        MOVE +8                  TO SUB
 17113        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17114        IF ERMAIL-FOUND = ' '
 17115           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17116              (SUB > +7)
 17117              OR (MA-MAIL-STATUS (SUB) = '1')
 17118           END-PERFORM
 17119        END-IF
 17120        IF (SUB > +7)
 17121           OR (ERMAIL-FOUND = 'X')
 17122           MOVE ER-3789          TO WS-ERROR
 17123           PERFORM 9900-ERROR-FORMAT
 17124                                 THRU 9900-EXIT
 17125        END-IF
 17126     ELSE
 17127        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17128     END-IF
 17129     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17130
 17131     IF PB-CI-OB-FLAG = 'Z'
 17132        GO TO 4150-SUMMARY-CERT-CANCEL.
 17133
 17134     IF PB-C-LF-CANCEL-VOIDED
 17135         PERFORM 4200-REVERSE-LF-CANCEL.
 17136     IF PB-C-AH-CANCEL-VOIDED
 17137         PERFORM 4200-REVERSE-AH-CANCEL.
 17138
 17139 4100-APPLY-LF-CANCEL.
 17140
 17141     MOVE +0                     TO WS-SUB.
 17142
 17143 4100-CHECK-LF-ERRORS.
 17144
 17145     ADD +1                       TO WS-SUB.
 17146
 17147     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17148        IF LF-COVERAGE-CANCELLED
 17149           GO TO 4100-LF-CANCEL-CONT
 17150        ELSE
 17151           GO TO 4100-UPDATE-LF-COVERAGE.
 17152
 17153     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17154                                   ER-2729 OR
 17155                                   ER-2730 OR
 17156                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 312
* EL050.cbl
 17157                                   ER-2732 OR
 17158                                   ER-2737 OR
 17159                                   ER-2740 OR
 17160                                   ER-2743 OR
 17161                                   ER-2749 OR
 17162                                   ER-2750 OR
 17163                                   ER-2755 OR
 17164                                   ER-2757 OR
 17165                                   ER-2760 OR
 17166                                   ER-2772 OR
 17167                                   ER-2774 OR
 17168                                   ER-2776 OR
 17169                                   ER-2794
 17170        GO TO 4100-UPDATE-LF-COVERAGE.
 17171
 17172     GO TO 4100-CHECK-LF-ERRORS.
 17173
 17174 4100-UPDATE-LF-COVERAGE.
 17175
 17176     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17177     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17178     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17179        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17180     END-IF
 17181     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17182                                      TO CM-CREDIT-INTERFACE-SW-2.
 17183     IF CM-LF-CANCEL-DT = LOW-VALUE
 17184         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17185
 17186     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17187         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17188                                         CM-LF-STATUS-AT-CANCEL.
 17189
 17190     GO TO 4100-APPLY-AH-CANCEL.
 17191
 17192 4100-LF-CANCEL-CONT.
 17193     IF PB-C-LF-CANCEL-VOIDED
 17194         GO TO 4100-APPLY-AH-CANCEL.
 17195
 17196     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17197         GO TO 4100-APPLY-AH-CANCEL.
 17198
 17199     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 17200        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17201           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17202        ELSE
 17203           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17204
 17205     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17206     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17207
 17208     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17209         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17210
 17211     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17212        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17213         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17214         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 313
* EL050.cbl
 17215
 17216     IF PB-RECORD-RETURNED
 17217        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17218      ELSE
 17219        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17220
 17221 4100-APPLY-AH-CANCEL.
 17222
 17223     MOVE +0                      TO WS-SUB.
 17224
 17225 4100-CHECK-AH-ERRORS.
 17226
 17227     ADD +1                       TO WS-SUB.
 17228
 17229     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17230        IF AH-COVERAGE-CANCELLED
 17231           GO TO 4100-AH-CANCEL-CONT
 17232        ELSE
 17233           GO TO 4100-UPDATE-AH-COVERAGE.
 17234
 17235     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17236                                   ER-2729 OR
 17237                                   ER-2732 OR
 17238                                   ER-2737 OR
 17239                                   ER-2740 OR
 17240                                   ER-2744 OR
 17241                                   ER-2749 OR
 17242                                   ER-2750 OR
 17243                                   ER-2755 OR
 17244                                   ER-2757 OR
 17245                                   ER-2760 OR
 17246                                   ER-2771 OR
 17247                                   ER-2772 OR
 17248                                   ER-2773 OR
 17249                                   ER-2775 OR
 17250                                   ER-2777 OR
 17251                                   ER-2794
 17252        GO TO 4100-UPDATE-AH-COVERAGE.
 17253
 17254     GO TO 4100-CHECK-AH-ERRORS.
 17255
 17256 4100-UPDATE-AH-COVERAGE.
 17257
 17258     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17259     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17260     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17261     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17262                                      TO CM-CREDIT-INTERFACE-SW-2.
 17263     IF CM-AH-CANCEL-DT = LOW-VALUE
 17264         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17265
 17266     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17267         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17268                                         CM-AH-STATUS-AT-CANCEL.
 17269
 17270     IF LF-COVERAGE-CANCELLED
 17271         IF PB-RECORD-RETURNED
 17272              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 314
* EL050.cbl
 17273          ELSE
 17274              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17275
 17276     GO TO 4299-EXIT.
 17277
 17278 4100-AH-CANCEL-CONT.
 17279     IF PB-C-AH-CANCEL-VOIDED
 17280         GO TO 4299-EXIT.
 17281     if cm-credit-interface-sw-2 = ' '
 17282        if pb-fatal-errors or pb-unforced-errors
 17283           move '4'              to cm-credit-interface-sw-2
 17284        else
 17285           move '1'              to cm-credit-interface-sw-2
 17286        end-if
 17287     end-if
 17288     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17289         GO TO 4299-EXIT.
 17290
 17291     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17292        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17293           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17294        ELSE
 17295           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17296
 17297     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17298     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17299
 17300     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17301         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17302
 17303     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17304         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17305         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17306
 17307     IF PB-RECORD-RETURNED
 17308        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17309      ELSE
 17310        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17311
 17312     GO TO 4299-EXIT.
 17313
 17314 4150-SUMMARY-CERT-CANCEL.
 17315     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17316
 17317     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17318        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17319                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17320     ELSE
 17321        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17322                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17323
 17324     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17325        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17326                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17327     ELSE
 17328        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17329                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17330
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 315
* EL050.cbl
 17331     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17332        NEXT SENTENCE
 17333     ELSE
 17334        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17335
 17336     GO TO 4299-EXIT.
 17337
 17338 4200-REVERSE-LF-CANCEL.
 17339     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17340
 17341     IF CM-LF-CANCEL-APPLIED
 17342        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17343        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17344        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17345
 17346     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17347
 17348     IF PB-RECORD-RETURNED
 17349        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17350       ELSE
 17351        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17352
 17353 4200-REVERSE-LF-EXIT.
 17354       EXIT.
 17355
 17356 4200-REVERSE-AH-CANCEL.
 17357     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17358
 17359     IF CM-AH-CANCEL-APPLIED
 17360        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17361        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17362        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17363
 17364     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17365
 17366     IF PB-RECORD-RETURNED
 17367        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17368       ELSE
 17369        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17370
 17371 4200-REVERSE-AH-EXIT.
 17372       EXIT.
 17373
 17374 4299-EXIT.
 17375       EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 316
* EL050.cbl
 17377
 17378 4500-UPDATE-NEW-CERT.
 17379     IF CERT-WAS-FOUND
 17380         NEXT SENTENCE
 17381       ELSE
 17382         GO TO 4520-BUILD-NEW-KEY.
 17383
 17384     IF  CLASIC-CREATED-CERT
 17385         GO TO 4999-EXIT.
 17386
 17387     IF  CERT-WAS-CREATED-FOR-CLAIM
 17388         GO TO 4520-BUILD-NEW-KEY.
 17389
 17390     IF CERT-ADDED-BATCH
 17391        IF CM-RECORD-ID = 'CM'
 17392            GO TO 4999-EXIT.
 17393
 17394 4520-BUILD-NEW-KEY.
 17395* BUILD CONTROL PRIMARY
 17396
 17397     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17398                                       CM-COMPANY-CD-A1
 17399                                       CM-COMPANY-CD-A2
 17400                                       CM-COMPANY-CD-A4
 17401                                       CM-COMPANY-CD-A5.
 17402
 17403     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17404     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17405     MOVE PB-SV-STATE               TO CM-STATE.
 17406     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17407     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17408     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17409     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17410
 17411     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17412
 17413     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17414     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17415     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17416     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17417
 17418     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17419        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17420
 17421     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17422         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17423         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17424         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17425         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17426     ELSE
 17427         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17428
 17429     IF PB-COMPANY-ID   EQUAL  'CRI'
 17430         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17431         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17432         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17433         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17434         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 317
* EL050.cbl
 17435
 17436     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17437        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17438         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17439
 17440     IF PB-COMPANY-ID  = 'LBL'
 17441        IF PB-I-JOINT-COVERAGE
 17442            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17443                                           PB-I-MEMBER-NO
 17444            GO TO 4550-CONT-CERT-PROCESS.
 17445
 17446     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17447        NEXT SENTENCE
 17448     ELSE
 17449        GO TO 4540-BUILD-MEMBER-NO.
 17450
 17451******************************************************************
 17452*                                                                *
 17453*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17454*    FOR 'MON'.                                                  *
 17455*                                                                *
 17456******************************************************************
 17457
 17458     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17459     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17460     MOVE +1                     TO WS-SUB1
 17461                                    WS-SUB2.
 17462
 17463 4530-EDIT-MEMB-NAME.
 17464
 17465     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17466        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17467        ADD +1                       TO WS-SUB2.
 17468
 17469     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17470        ADD +1                       TO WS-SUB1
 17471        GO TO 4530-EDIT-MEMB-NAME.
 17472
 17473     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17474     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17475     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17476*    MOVE SPACE                      TO DC-OPTION-CODE.
 17477     SET  BIN-TO-GREG                TO TRUE.
 17478     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17479     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17480
 17481     GO TO 4550-CONT-CERT-PROCESS.
 17482
 17483******************************************************************
 17484*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17485******************************************************************
 17486
 17487 4540-BUILD-MEMBER-NO.
 17488
 17489     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17490         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17491         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17492         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 318
* EL050.cbl
 17493         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17494     ELSE
 17495         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17496
 17497     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17498        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17499         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17500
 17501 4550-CONT-CERT-PROCESS.
 17502
 17503*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17504*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17505*    ELSE
 17506*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17507
 17508     IF CERT-WAS-CREATED-FOR-CLAIM
 17509        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17510        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17511
 17512     IF CERT-AND-CLAIM-ONLINE
 17513        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17514        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17515
 17516     MOVE 'CM'                     TO CM-RECORD-ID.
 17517     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17518
 17519     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17520        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17521        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17522     ELSE
 17523        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17524        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17525
 17526     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17527     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17528     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17529     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17530     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17531     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17532     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17533                                      CM-LF-ITD-CANCEL-AMT
 17534                                      CM-LF-ITD-DEATH-AMT
 17535                                      CM-AH-ITD-AH-PMT
 17536                                      CM-AH-ITD-LUMP-PMT
 17537                                      CM-AH-ITD-CANCEL-AMT
 17538                                      CM-LF-NSP-PREMIUM-AMT
 17539                                      CM-AH-NSP-PREMIUM-AMT.
 17540*                                     CM-CLAIM-DEDUCT-WITHHELD
 17541*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17542     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17543     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17544     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17545     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17546     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17547     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17548     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17549     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17550     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 319
* EL050.cbl
 17551     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17552     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17553     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17554
 17555     IF PB-I-LIVES NOT NUMERIC
 17556         MOVE ZERO                 TO PB-I-LIVES.
 17557
 17558     IF PB-I-NUM-BILLED NOT NUMERIC
 17559         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17560
 17561     MOVE PB-I-LIVES               TO CM-LIVES.
 17562     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17563
 17564     IF PB-COMPANY-ID EQUAL  'DMD'
 17565         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17566         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17567
 17568     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17569     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17570     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17571     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17572     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17573     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17574
 17575     IF PB-I-LF-POLICY-FEE NUMERIC
 17576        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17577     ELSE
 17578        MOVE +0                    TO CM-LF-POLICY-FEE.
 17579
 17580     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17581        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17582        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17583     ELSE
 17584        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17585
 17586     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17587     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17588     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17589     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17590     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17591     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17592     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17593     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17594     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17595
 17596     IF PB-I-AH-POLICY-FEE NUMERIC
 17597        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17598     ELSE
 17599        MOVE +0                    TO CM-AH-POLICY-FEE.
 17600
 17601     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17602        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17603     ELSE
 17604        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17605
 17606     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17607     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17608
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 320
* EL050.cbl
 17609     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17610                                      CM-LF-DEATH-EXIT-DT
 17611                                      CM-AH-SETTLEMENT-EXIT-DT.
 17612
 17613*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17614*                       'TIH' OR 'OFL' OR 'FLA' OR
 17615*                       'TII' OR 'TMS' OR 'CRI' OR
 17616*                       'NCL'
 17617     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17618
 17619     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17620         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17621            MOVE '2'                TO CM-PREMIUM-TYPE.
 17622
 17623     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17624         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17625            MOVE '2'                TO CM-PREMIUM-TYPE.
 17626
 17627     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17628         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17629     ELSE
 17630         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17631         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17632
 17633     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17634     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17635     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17636     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17637     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17638     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17639     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17640     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17641
 17642     IF PB-NO-MONTHS-SKIPPED
 17643         MOVE SPACE                 TO CM-SKIP-CODE
 17644     ELSE
 17645         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17646
 17647     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17648     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17649                                       CM-LF-STATUS-AT-CANCEL.
 17650
 17651     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17652     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17653                                       CM-AH-STATUS-AT-CANCEL.
 17654
 17655     MOVE '1'                       TO CM-ENTRY-STATUS.
 17656
 17657     IF PB-REISSUED-CERT
 17658        MOVE '5'                    TO CM-ENTRY-STATUS.
 17659
 17660     IF PB-MONTHLY-CERT
 17661        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17662
 17663     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17664     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17665     IF PB-POLICY-IS-DECLINED
 17666        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 321
* EL050.cbl
 17667
 17668     IF PB-POLICY-IS-VOIDED
 17669        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17670
 17671     IF PB-NEEDS-UNDERWRITING
 17672        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17673
 17674     IF PB-REIN-ONLY-CERT
 17675        MOVE '9'                    TO CM-ENTRY-STATUS.
 17676
 17677     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17678         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17679     ELSE
 17680         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17681
 17682     IF PB-RECORD-RETURNED
 17683        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17684      ELSE
 17685        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17686
 17687     IF PB-I-MAIL-ADDRS-PRESENT
 17688        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17689
 17690     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17691                                       CM-ENTRY-DT.
 17692
 17693 4999-EXIT.
 17694     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 322
* EL050.cbl
 17696
 17697 5000-PROCESS-REPS.
 17698     MOVE ' '                    TO AGTC-MASTER-SW
 17699     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17700     MOVE CO-TYPE                TO AGTC-TYPE
 17701     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17702     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17703     IF (AGTC-MASTER-SW NOT = 'N')
 17704        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17705        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17706        PERFORM 8583-READ-ERAGTC-NEXT
 17707                                 THRU 8583-EXIT
 17708     END-IF
 17709     IF AGTC-MASTER-SW = 'N'
 17710        CONTINUE
 17711     ELSE
 17712        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17713           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17714              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17715              MOVE 'Y'           TO AGTC-MASTER-SW
 17716           END-IF
 17717        END-IF
 17718     END-IF
 17719     .
 17720 5000-EXIT.
 17721     EXIT.
 17722 6370-EDIT-INPUT-LF-CODE.
 17723     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17724        MOVE +1                  TO SUB
 17725        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17726        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17727        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17728        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17729        GO TO 6370-SEARCH-LOOP.
 17730
 17731     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17732
 17733     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17734     MOVE SPACES                 TO CNTL-ACCESS.
 17735*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17736     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17737     MOVE +0                     TO CNTL-SEQ-NO.
 17738     MOVE '4' TO RC-SW-2.
 17739     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17740
 17741     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17742        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17743        GO TO 6370-NO-LF-FOUND.
 17744
 17745     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17746     MOVE +1                     TO SUB.
 17747
 17748 6370-SEARCH-LOOP.
 17749     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17750         GO TO 6370-NO-LF-FOUND.
 17751
 17752     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17753         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 323
* EL050.cbl
 17754         GO TO 6370-HER-NET-PAY-CHECK.
 17755
 17756     ADD 1   TO SUB.
 17757*    IF SUB GREATER 120
 17758     IF SUB GREATER 200
 17759         GO TO 6370-NO-LF-FOUND.
 17760
 17761     GO TO 6370-SEARCH-LOOP.
 17762
 17763 6370-NO-LF-FOUND.
 17764
 17765     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17766
 17767 6370-HER-NET-PAY-CHECK.
 17768
 17769     IF PB-COMPANY-ID = 'CID'
 17770        IF PB-SV-STATE = 'CA' OR 'MN'
 17771           IF PB-I-LF-BENEFIT-CD = '02'
 17772              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17773           ELSE
 17774              IF PB-I-LF-BENEFIT-CD = '04'
 17775                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17776              END-IF
 17777           END-IF
 17778        END-IF
 17779     END-IF
 17780
 17781     IF PB-COMPANY-ID NOT = 'HER'
 17782         GO TO 6370-EXIT.
 17783
 17784     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17785         GO TO 6370-EXIT.
 17786
 17787     IF PB-I-LF-TERM NOT NUMERIC
 17788         MOVE ZEROS              TO PB-I-LF-TERM.
 17789
 17790     IF PB-I-LOAN-TERM NOT NUMERIC
 17791         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17792
 17793     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17794         GO TO 6370-EXIT.
 17795
 17796     IF PB-I-LF-BENEFIT-CD = '33'
 17797         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17798
 17799     IF PB-I-LF-BENEFIT-CD = '34'
 17800         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17801
 17802 6370-EXIT.
 17803     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 324
* EL050.cbl
 17805
 17806 6380-EDIT-INPUT-AH-CODE.
 17807     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17808        MOVE +1                  TO SUB
 17809        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17810        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17811        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17812        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17813        GO TO 6380-SEARCH-LOOP.
 17814
 17815     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17816
 17817     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17818     MOVE SPACES                 TO CNTL-ACCESS.
 17819     MOVE 'A'                    TO CNTL-REC-TYPE.
 17820*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17821     MOVE +0                     TO CNTL-SEQ-NO.
 17822     MOVE '5' TO RC-SW-2.
 17823     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17824
 17825     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17826        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17827        GO TO 6380-NO-AH-FOUND.
 17828
 17829     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17830     MOVE +1 TO SUB.
 17831
 17832 6380-SEARCH-LOOP.
 17833     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17834         GO TO 6380-NO-AH-FOUND.
 17835
 17836     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17837         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17838         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17839
 17840     ADD 1   TO SUB.
 17841     IF SUB GREATER THAN 96
 17842*    IF SUB GREATER THAN 300
 17843         GO TO 6380-NO-AH-FOUND.
 17844
 17845     GO TO 6380-SEARCH-LOOP.
 17846
 17847 6380-NO-AH-FOUND.
 17848
 17849     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17850
 17851     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17852         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17853     ELSE
 17854         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17855
 17856 6380-CSO-AH-ONLY-CHECKS.
 17857
 17858     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17859        NEXT SENTENCE
 17860      ELSE
 17861        GO TO 6380-EXIT.
 17862
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 325
* EL050.cbl
 17863     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17864         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17865
 17866
 17867     GO TO 6380-EXIT
 17868     .
 17869 6380-CSO-LIFE-WITH-AH-CHECKS.
 17870
 17871
 17872     .
 17873 6380-EXIT.
 17874     EXIT.
 17875
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 326
* EL050.cbl
 17877
 17878 6400-COMPUTE-EXTENSION-DAYS.
 17879
 17880******************************************************************
 17881*                                                                *
 17882*                   COMPUTE EXTENSION DAYS                       *
 17883*                                                                *
 17884*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17885*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17886*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17887*    THE EXTENSION DAYS.                                         *
 17888*                                                                *
 17889******************************************************************
 17890
 17891     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17892     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17893
 17894******************************************************************
 17895*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17896*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17897******************************************************************
 17898
 17899     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17900        COMPUTE WS-ODD-DAYS-OVER =
 17901               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17902     ELSE
 17903        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17904
 17905     IF WS-ODD-DAYS-OVER = ZEROS
 17906           GO TO 6499-EXIT
 17907     ELSE
 17908        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17909           IF WS-WDF-MONTH = 02
 17910              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17911              ADD 2       TO  WS-ODD-DAYS-OVER
 17912              GO TO 6499-EXIT
 17913           ELSE
 17914              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17915                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17916                 GO TO 6499-EXIT
 17917               ELSE
 17918                 GO TO 6499-EXIT
 17919        ELSE
 17920           GO TO 6499-EXIT.
 17921
 17922 6412-CHECK-TO-DAY.
 17923
 17924        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17925           IF WS-WDT-DAY = 28
 17926              ADD 2              TO WS-ODD-DAYS-OVER
 17927           ELSE
 17928              IF WS-WDT-DAY = 29
 17929                 ADD 1           TO WS-ODD-DAYS-OVER
 17930              ELSE
 17931                 NEXT SENTENCE
 17932        ELSE
 17933           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17934              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 327
* EL050.cbl
 17935
 17936     GO TO 6499-EXIT.
 17937
 17938
 17939 6415-CHECK-LEAP-YEAR.
 17940
 17941     IF DC-DAYS-IN-MONTH = 29
 17942        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17943
 17944 6415-EXIT.
 17945     EXIT.
 17946
 17947 6499-EXIT.
 17948      EXIT.
 17949
 17950 6500-END.
 17951     EXIT.
 17952
 17953
 17954******************************************************************
 17955************* PROCEDURE DIVISION FOR EL050 ***********************
 17956********************** ELC50PD END *******************************
 17957
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 328
* EL050.cbl
 17959
 17960**START***********************************************************
 17961*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17962*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17963******************************************************************
 17964*
 17965 6600-GET-STATE-MUNICIPAL-TAX.
 17966
 17967     IF PB-COMPANY-ID NOT = 'DMD'
 17968         GO TO 6640-EXIT.
 17969
 17970     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17971     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17972     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17973*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17974*
 17975***  Y2K PROJ 7744
 17976     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17977     SET BIN-TO-GREG          TO TRUE.
 17978     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17979
 17980     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17981
 17982     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17983     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17984
 17985
 17986* EXEC CICS HANDLE CONDITION
 17987*        INVREQ    (6610-START-BROWSE)
 17988*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17989*        NOTFND    (6630-END-OF-FILE)
 17990*    END-EXEC.
 17991*    MOVE '"$8JI                 ! # #00017973' TO DFHEIV0
 17992     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17994     MOVE X'2320233030303137393733' TO DFHEIV0(25:11)
 17995     CALL 'kxdfhei1' USING DFHEIV0
 17996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17997
 17998
 17999 6610-START-BROWSE.
 18000
 18001
 18002* EXEC CICS HANDLE CONDITION
 18003*        NOTFND    (6630-END-OF-FILE)
 18004*        DISABLED  (6630-ERRESS-PROBLEM)
 18005*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18006*        ENDFILE   (6630-END-OF-FILE)
 18007*    END-EXEC.
 18008*    MOVE '"$IcJ''                ! $ #00017981' TO DFHEIV0
 18009     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18011     MOVE X'2420233030303137393831' TO DFHEIV0(25:11)
 18012     CALL 'kxdfhei1' USING DFHEIV0
 18013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18014
 18015
 18016
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 329
* EL050.cbl
 18017* EXEC CICS STARTBR
 18018*        DATASET (FILE-ID-ERRESS)
 18019*        RIDFLD  (WS-ERRESS-KEY)
 18020*        GTEQ
 18021*    END-EXEC.
 18022     MOVE 0
 18023       TO DFHEIV11
 18024*    MOVE '&,         G          &   #00017988' TO DFHEIV0
 18025     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18026     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18027     MOVE X'2020233030303137393838' TO DFHEIV0(25:11)
 18028     CALL 'kxdfhei1' USING DFHEIV0,
 18029           FILE-ID-ERRESS,
 18030           WS-ERRESS-KEY,
 18031           DFHEIV99,
 18032           DFHEIV11,
 18033           DFHEIV99
 18034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18035
 18036
 18037 6620-READ-NEXT-ERRESS-MASTER.
 18038
 18039
 18040* EXEC CICS HANDLE CONDITION
 18041*        NOTFND    (6630-END-OF-FILE)
 18042*        ENDFILE   (6630-END-OF-FILE)
 18043*        DISABLED  (6630-ERRESS-PROBLEM)
 18044*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18045*    END-EXEC.
 18046*    MOVE '"$I''cJ                ! % #00017996' TO DFHEIV0
 18047     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18048     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18049     MOVE X'2520233030303137393936' TO DFHEIV0(25:11)
 18050     CALL 'kxdfhei1' USING DFHEIV0
 18051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18052
 18053
 18054
 18055* EXEC CICS READNEXT
 18056*        DATASET (FILE-ID-ERRESS)
 18057*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18058*        RIDFLD  (WS-ERRESS-KEY)
 18059*    END-EXEC.
 18060     MOVE LENGTH OF
 18061      RESIDENT-STATE-TAX-MASTER
 18062       TO DFHEIV12
 18063     MOVE 0
 18064       TO DFHEIV11
 18065*    MOVE '&.IL                  )   #00018003' TO DFHEIV0
 18066     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18067     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18068     MOVE X'2020233030303138303033' TO DFHEIV0(25:11)
 18069     CALL 'kxdfhei1' USING DFHEIV0,
 18070           FILE-ID-ERRESS,
 18071           RESIDENT-STATE-TAX-MASTER,
 18072           DFHEIV12,
 18073           WS-ERRESS-KEY,
 18074           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 330
* EL050.cbl
 18075           DFHEIV11,
 18076           DFHEIV99,
 18077           DFHEIV99
 18078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18079
 18080
 18081     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18082
 18083* EXEC CICS ENDBR
 18084*            DATASET (FILE-ID-ERRESS)
 18085*       END-EXEC
 18086     MOVE 0
 18087       TO DFHEIV11
 18088*    MOVE '&2                    $   #00018010' TO DFHEIV0
 18089     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18090     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18091     MOVE X'2020233030303138303130' TO DFHEIV0(25:11)
 18092     CALL 'kxdfhei1' USING DFHEIV0,
 18093           FILE-ID-ERRESS,
 18094           DFHEIV11,
 18095           DFHEIV99
 18096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18097        GO TO 6630-END-OF-FILE.
 18098
 18099     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18100        NEXT SENTENCE
 18101      ELSE
 18102        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18103
 18104*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18105*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18106*
 18107     MOVE +2                     TO WS-SUB1.
 18108
 18109     IF PB-ISSUE
 18110     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18111        MOVE +1                  TO WS-SUB1.
 18112
 18113     IF PB-CANCELLATION
 18114     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18115        MOVE +1                  TO WS-SUB1.
 18116*
 18117*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18118*
 18119***  Y2K PROJ 7744
 18120     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18121***  Y2K PROJ 7744
 18122
 18123*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18124* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18125* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18126
 18127     ADD 1                    TO WS-YEAR-YY.
 18128
 18129     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18130         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18131                              TO WS-RES-STATE-TAX
 18132         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 331
* EL050.cbl
 18133                              TO WS-RES-MUNI-TAX
 18134     ELSE
 18135         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18136                              TO WS-RES-STATE-TAX
 18137         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18138                              TO WS-RES-MUNI-TAX.
 18139
 18140*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18141
 18142     IF PB-CANCELLATION
 18143         GO TO 6640-CANCEL-TAX.
 18144
 18145     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18146         COMPUTE PB-I-STATE-TAX ROUNDED =
 18147                                   PB-I-LF-PREMIUM-AMT
 18148                                 * WS-RES-STATE-TAX
 18149         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18150                                   PB-I-LF-PREMIUM-AMT
 18151                                 * WS-RES-MUNI-TAX
 18152     ELSE
 18153     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18154         COMPUTE PB-I-STATE-TAX ROUNDED =
 18155                                   PB-I-AH-PREMIUM-AMT
 18156                                 * WS-RES-STATE-TAX
 18157         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18158                                   PB-I-AH-PREMIUM-AMT
 18159                                 * WS-RES-MUNI-TAX.
 18160
 18161
 18162* EXEC CICS ENDBR
 18163*         DATASET (FILE-ID-ERRESS)
 18164*    END-EXEC.
 18165     MOVE 0
 18166       TO DFHEIV11
 18167*    MOVE '&2                    $   #00018077' TO DFHEIV0
 18168     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18170     MOVE X'2020233030303138303737' TO DFHEIV0(25:11)
 18171     CALL 'kxdfhei1' USING DFHEIV0,
 18172           FILE-ID-ERRESS,
 18173           DFHEIV11,
 18174           DFHEIV99
 18175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18176
 18177
 18178     GO TO 6640-EXIT.
 18179
 18180 6640-CANCEL-TAX.
 18181     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18182
 18183     IF PB-C-LF-CANCEL-AMT > ZEROS
 18184         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18185                                   PB-C-LF-CANCEL-AMT
 18186                                 * WS-RES-STATE-TAX
 18187         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18188                                   PB-C-LF-CANCEL-AMT
 18189                                *  WS-RES-MUNI-TAX
 18190     ELSE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 332
* EL050.cbl
 18191     IF PB-C-AH-CANCEL-AMT > ZEROS
 18192         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18193                                   PB-C-AH-CANCEL-AMT
 18194                                 * WS-RES-STATE-TAX
 18195         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18196                                   PB-C-AH-CANCEL-AMT
 18197                                *  WS-RES-MUNI-TAX.
 18198
 18199
 18200* EXEC CICS ENDBR
 18201*         DATASET (FILE-ID-ERRESS)
 18202*    END-EXEC.
 18203     MOVE 0
 18204       TO DFHEIV11
 18205*    MOVE '&2                    $   #00018102' TO DFHEIV0
 18206     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18207     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18208     MOVE X'2020233030303138313032' TO DFHEIV0(25:11)
 18209     CALL 'kxdfhei1' USING DFHEIV0,
 18210           FILE-ID-ERRESS,
 18211           DFHEIV11,
 18212           DFHEIV99
 18213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18214
 18215
 18216     GO TO 6640-EXIT.
 18217
 18218 6630-END-OF-FILE.
 18219     MOVE ER-8002              TO WS-ERROR.
 18220     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18221
 18222     GO TO 6640-EXIT.
 18223
 18224 6630-ERRESS-PROBLEM.
 18225     MOVE ER-8044              TO WS-ERROR.
 18226     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18227
 18228 6640-EXIT.
 18229     EXIT.
 18230
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 333
* EL050.cbl
 18232 6650-GET-RES-STATE-COMM.
 18233
 18234     IF PB-COMPANY-ID NOT = 'DMD'
 18235         GO TO 6700-COMM-EXIT.
 18236
 18237     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18238     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18239     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18240     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18241     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18242     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18243     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18244
 18245*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18246*
 18247***  Y2K PROJ 7744
 18248     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18249     SET BIN-TO-GREG          TO TRUE.
 18250     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18251
 18252     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18253***  Y2K PROJ 7744
 18254
 18255     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18256
 18257
 18258* EXEC CICS HANDLE CONDITION
 18259*        INVREQ    (6660-START-BROWSE)
 18260*        DISABLED  (6690-ERRESC-PROBLEM)
 18261*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18262*        NOTFND    (6690-END-OF-FILE)
 18263*    END-EXEC.
 18264*    MOVE '"$8cJI                ! & #00018147' TO DFHEIV0
 18265     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18266     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18267     MOVE X'2620233030303138313437' TO DFHEIV0(25:11)
 18268     CALL 'kxdfhei1' USING DFHEIV0
 18269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18270
 18271
 18272
 18273* EXEC CICS RESETBR
 18274*        DATASET (FILE-ID-ERRESC)
 18275*        RIDFLD  (WS-ERRESC-KEY)
 18276*    END-EXEC.
 18277     MOVE 0
 18278       TO DFHEIV11
 18279*    MOVE '&4         G          &   #00018154' TO DFHEIV0
 18280     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18282     MOVE X'2020233030303138313534' TO DFHEIV0(25:11)
 18283     CALL 'kxdfhei1' USING DFHEIV0,
 18284           FILE-ID-ERRESC,
 18285           WS-ERRESC-KEY,
 18286           DFHEIV99,
 18287           DFHEIV11,
 18288           DFHEIV99
 18289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 334
* EL050.cbl
 18290
 18291
 18292 6660-START-BROWSE.
 18293
 18294
 18295* EXEC CICS HANDLE CONDITION
 18296*        NOTFND    (6690-END-OF-FILE)
 18297*        DISABLED  (6690-ERRESC-PROBLEM)
 18298*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18299*        ENDFILE   (6690-END-OF-FILE)
 18300*    END-EXEC.
 18301*    MOVE '"$IcJ''                ! '' #00018161' TO DFHEIV0
 18302     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18304     MOVE X'2720233030303138313631' TO DFHEIV0(25:11)
 18305     CALL 'kxdfhei1' USING DFHEIV0
 18306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18307
 18308
 18309
 18310* EXEC CICS STARTBR
 18311*        DATASET (FILE-ID-ERRESC)
 18312*        RIDFLD  (WS-ERRESC-KEY)
 18313*        GTEQ
 18314*    END-EXEC.
 18315     MOVE 0
 18316       TO DFHEIV11
 18317*    MOVE '&,         G          &   #00018168' TO DFHEIV0
 18318     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18320     MOVE X'2020233030303138313638' TO DFHEIV0(25:11)
 18321     CALL 'kxdfhei1' USING DFHEIV0,
 18322           FILE-ID-ERRESC,
 18323           WS-ERRESC-KEY,
 18324           DFHEIV99,
 18325           DFHEIV11,
 18326           DFHEIV99
 18327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18328
 18329
 18330     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18331
 18332 6670-READ-NEXT-ERRESC-MASTER.
 18333
 18334
 18335* EXEC CICS HANDLE CONDITION
 18336*        NOTFND    (6690-END-OF-FILE)
 18337*        DISABLED  (6690-ERRESC-PROBLEM)
 18338*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18339*        ENDFILE   (6690-END-OF-FILE)
 18340*    END-EXEC.
 18341*    MOVE '"$IcJ''                ! ( #00018178' TO DFHEIV0
 18342     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18344     MOVE X'2820233030303138313738' TO DFHEIV0(25:11)
 18345     CALL 'kxdfhei1' USING DFHEIV0
 18346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18347
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 335
* EL050.cbl
 18348
 18349
 18350* EXEC CICS READNEXT
 18351*        DATASET (FILE-ID-ERRESC)
 18352*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18353*        RIDFLD  (ERRESC-RECORD-KEY)
 18354*    END-EXEC.
 18355     MOVE LENGTH OF
 18356      ACCOUNT-RESIDENT-ST-COMMISSION
 18357       TO DFHEIV12
 18358     MOVE 0
 18359       TO DFHEIV11
 18360*    MOVE '&.IL                  )   #00018185' TO DFHEIV0
 18361     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18362     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18363     MOVE X'2020233030303138313835' TO DFHEIV0(25:11)
 18364     CALL 'kxdfhei1' USING DFHEIV0,
 18365           FILE-ID-ERRESC,
 18366           ACCOUNT-RESIDENT-ST-COMMISSION,
 18367           DFHEIV12,
 18368           ERRESC-RECORD-KEY,
 18369           DFHEIV99,
 18370           DFHEIV11,
 18371           DFHEIV99,
 18372           DFHEIV99
 18373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18374
 18375
 18376     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18377        NEXT SENTENCE
 18378     ELSE
 18379
 18380* EXEC CICS ENDBR
 18381*            DATASET (FILE-ID-ERRESC)
 18382*       END-EXEC
 18383     MOVE 0
 18384       TO DFHEIV11
 18385*    MOVE '&2                    $   #00018194' TO DFHEIV0
 18386     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18387     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18388     MOVE X'2020233030303138313934' TO DFHEIV0(25:11)
 18389     CALL 'kxdfhei1' USING DFHEIV0,
 18390           FILE-ID-ERRESC,
 18391           DFHEIV11,
 18392           DFHEIV99
 18393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18394        GO TO 6690-END-OF-FILE.
 18395
 18396     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18397
 18398* EXEC CICS ENDBR
 18399*            DATASET (FILE-ID-ERRESC)
 18400*       END-EXEC
 18401     MOVE 0
 18402       TO DFHEIV11
 18403*    MOVE '&2                    $   #00018200' TO DFHEIV0
 18404     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 336
* EL050.cbl
 18406     MOVE X'2020233030303138323030' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0,
 18408           FILE-ID-ERRESC,
 18409           DFHEIV11,
 18410           DFHEIV99
 18411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18412        GO TO 6690-END-OF-FILE.
 18413
 18414     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18415        NEXT SENTENCE
 18416      ELSE
 18417        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18418
 18419* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18420*
 18421     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18422
 18423     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18424
 18425     IF WS-SUB1 > ZERO
 18426         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18427             PERFORM 6680-SET-COMMISSION
 18428         ELSE
 18429             PERFORM 6680-SET-TABLE-CODE.
 18430
 18431
 18432* EXEC CICS ENDBR
 18433*         DATASET (FILE-ID-ERRESC)
 18434*    END-EXEC.
 18435     MOVE 0
 18436       TO DFHEIV11
 18437*    MOVE '&2                    $   #00018222' TO DFHEIV0
 18438     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18439     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18440     MOVE X'2020233030303138323232' TO DFHEIV0(25:11)
 18441     CALL 'kxdfhei1' USING DFHEIV0,
 18442           FILE-ID-ERRESC,
 18443           DFHEIV11,
 18444           DFHEIV99
 18445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18446
 18447
 18448     GO TO 6700-COMM-EXIT.
 18449
 18450 6680-SET-TABLE-CODE.
 18451     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18452        MOVE ZEROS             TO WS-SUB1
 18453     ELSE
 18454* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18455* TO COMPUTE AH COMMISSION.
 18456        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18457        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18458        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18459        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18460        PERFORM 6680-READ-CTBL-TABLE
 18461        IF WS-CTBL-READ-SW NOT = 'Y'
 18462           MOVE ZEROS          TO WS-SUB1.
 18463
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 337
* EL050.cbl
 18464 6680-READ-CTBL-TABLE.
 18465*
 18466* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18467* TO COMPUTE LIFE COMMISSION
 18468
 18469     IF CTBL-SW = '0540'
 18470        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18471        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18472        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18473
 18474     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18475
 18476     IF CTBL-TABLE-FOUND
 18477        IF CTBL-SW = '0530'
 18478             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18479                                    * PB-I-AH-TERM
 18480             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18481             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18482        ELSE
 18483             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18484             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18485             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18486     ELSE
 18487        IF FIRST-TIME-THROUGH
 18488            GO TO 6680-READ-CTBL-TABLE
 18489        ELSE
 18490            MOVE ZEROS         TO WS-SUB1.
 18491
 18492 6680-SET-COMMISSION.
 18493     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18494           MOVE ZEROS          TO WS-SUB1
 18495       ELSE
 18496           MOVE RESC-COMMISSION-PER (WS-SUB)
 18497                               TO WS-COMMISSION
 18498           IF CTBL-SW = '0530'
 18499               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18500           ELSE
 18501               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18502
 18503 6680-SEARCH-CATEGORY.
 18504     ADD +1                   TO WS-SUB.
 18505     IF WS-SUB > +12
 18506         GO TO 6680-EXIT.
 18507
 18508     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18509          MOVE WS-SUB         TO WS-SUB1
 18510          GO TO 6680-EXIT.
 18511
 18512     GO TO 6680-SEARCH-CATEGORY.
 18513
 18514 6680-EXIT.
 18515     EXIT.
 18516
 18517 6690-END-OF-FILE.
 18518     GO TO 6700-COMM-EXIT.
 18519
 18520 6690-ERRESC-PROBLEM.
 18521      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 338
* EL050.cbl
 18522      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18523
 18524      GO TO 6700-COMM-EXIT.
 18525
 18526 6700-COMM-EXIT.
 18527     EXIT.
 18528
 18529 7000-GET-RATE.
 18530
 18531* EXEC CICS LINK
 18532*        PROGRAM    ('ELRATE')
 18533*        COMMAREA   (CALCULATION-PASS-AREA)
 18534*        LENGTH     (CP-COMM-LENGTH)
 18535*    END-EXEC.
 18536     MOVE 'ELRATE' TO DFHEIV1
 18537*    MOVE '."C                   (   #00018308' TO DFHEIV0
 18538     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18540     MOVE X'2020233030303138333038' TO DFHEIV0(25:11)
 18541     CALL 'kxdfhei1' USING DFHEIV0,
 18542           DFHEIV1,
 18543           CALCULATION-PASS-AREA,
 18544           CP-COMM-LENGTH,
 18545           DFHEIV99,
 18546           DFHEIV99,
 18547           DFHEIV99,
 18548           DFHEIV99
 18549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18550
 18551
 18552 7000-EXIT.
 18553     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 339
* EL050.cbl
 18555 7100-FIND-BENEFIT-IN-STATE.
 18556     MOVE 'N'                    TO BEN-SEARCH-SW.
 18557
 18558     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18559         VARYING SUB3 FROM 1 BY 1 UNTIL
 18560            ((SUB3 GREATER 50) OR
 18561              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18562               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18563
 18564     IF SUB3 NOT = 51
 18565         MOVE 'Y'                TO BEN-SEARCH-SW.
 18566
 18567     GO TO 7199-EXIT.
 18568
 18569 7100-BENEFIT-DUMMY.
 18570
 18571 7100-DUMMY-EXIT.
 18572     EXIT.
 18573
 18574 7199-EXIT.
 18575     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 340
* EL050.cbl
 18577 7200-FIND-BENEFIT.
 18578     MOVE 'N'                    TO BEN-SEARCH-SW.
 18579
 18580     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18581         VARYING SUB3 FROM 1 BY 1 UNTIL
 18582            ((SUB3 GREATER 8) OR
 18583            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18584
 18585     IF SUB3 NOT = 9
 18586         MOVE 'Y'                TO BEN-SEARCH-SW.
 18587
 18588     GO TO 7200-EXIT.
 18589
 18590 7200-BENEFIT-DUMMY.
 18591
 18592 7200-DUMMY-EXIT.
 18593     EXIT.
 18594
 18595 7200-EXIT.
 18596     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 341
* EL050.cbl
 18598 7250-LOOK-FOR-RESCINDED-CLAIM.
 18599     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18600                                    W-CL-COMP-CD.
 18601     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18602                                    W-CL-CERT-NO.
 18603
 18604
 18605* EXEC CICS HANDLE CONDITION
 18606*        NOTFND  (7250-CONTINUE)
 18607*        ENDFILE (7250-CONTINUE)
 18608*    END-EXEC.
 18609*    MOVE '"$I''                  ! ) #00018366' TO DFHEIV0
 18610     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18612     MOVE X'2920233030303138333636' TO DFHEIV0(25:11)
 18613     CALL 'kxdfhei1' USING DFHEIV0
 18614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18615
 18616
 18617
 18618* EXEC CICS IGNORE CONDITION
 18619*        DUPKEY
 18620*    END-EXEC.
 18621*    MOVE '"*$                   !   #00018371' TO DFHEIV0
 18622     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18623     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18624     MOVE X'2020233030303138333731' TO DFHEIV0(25:11)
 18625     CALL 'kxdfhei1' USING DFHEIV0
 18626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18627
 18628
 18629
 18630* EXEC CICS STARTBR
 18631*        DATASET   (CLMS-ID)
 18632*        RIDFLD    (ELMSTR-KEY)
 18633*        GENERIC   EQUAL
 18634*        KEYLENGTH (ELMSTR-LENGTH)
 18635*    END-EXEC.
 18636     MOVE 0
 18637       TO DFHEIV11
 18638*    MOVE '&,   KG    E          &   #00018375' TO DFHEIV0
 18639     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18640     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18641     MOVE X'2020233030303138333735' TO DFHEIV0(25:11)
 18642     CALL 'kxdfhei1' USING DFHEIV0,
 18643           CLMS-ID,
 18644           ELMSTR-KEY,
 18645           ELMSTR-LENGTH,
 18646           DFHEIV11,
 18647           DFHEIV99
 18648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18649
 18650
 18651     MOVE 'Y'                    TO W-BROWSE-SW.
 18652
 18653 7250-NEXT-CLAIM.
 18654
 18655
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 342
* EL050.cbl
 18656* EXEC CICS READNEXT
 18657*        DATASET   (CLMS-ID)
 18658*        RIDFLD    (ELMSTR-KEY)
 18659*        SET       (ADDRESS OF CLAIM-MASTER)
 18660*    END-EXEC.
 18661     MOVE 0
 18662       TO DFHEIV11
 18663*    MOVE '&.S                   )   #00018386' TO DFHEIV0
 18664     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18665     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18666     MOVE X'2020233030303138333836' TO DFHEIV0(25:11)
 18667     CALL 'kxdfhei1' USING DFHEIV0,
 18668           CLMS-ID,
 18669           DFHEIV20,
 18670           DFHEIV99,
 18671           ELMSTR-KEY,
 18672           DFHEIV99,
 18673           DFHEIV11,
 18674           DFHEIV99,
 18675           DFHEIV99
 18676     SET ADDRESS OF CLAIM-MASTER TO
 18677         DFHEIV20
 18678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18679
 18680
 18681     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18682        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18683         GO TO 7250-CONTINUE
 18684     END-IF.
 18685
 18686     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18687        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18688        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18689        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18690        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18691         GO TO 7250-NEXT-CLAIM
 18692     END-IF.
 18693
 18694     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18695        OR (CL-CLAIM-TYPE = 'I')
 18696        OR (CL-CLAIM-TYPE = 'G')
 18697          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18698              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18699              GO TO 7250-CONTINUE
 18700          END-IF
 18701     END-IF.
 18702
 18703     GO TO 7250-NEXT-CLAIM.
 18704
 18705 7250-CONTINUE.
 18706
 18707     IF W-BROWSE-SW = 'Y'
 18708
 18709* EXEC CICS ENDBR
 18710*            DATASET   (CLMS-ID)
 18711*        END-EXEC
 18712     MOVE 0
 18713       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 343
* EL050.cbl
 18714*    MOVE '&2                    $   #00018419' TO DFHEIV0
 18715     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18716     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18717     MOVE X'2020233030303138343139' TO DFHEIV0(25:11)
 18718     CALL 'kxdfhei1' USING DFHEIV0,
 18719           CLMS-ID,
 18720           DFHEIV11,
 18721           DFHEIV99
 18722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18723         MOVE 'N' TO W-BROWSE-SW
 18724     END-IF.
 18725
 18726 7250-EXIT.
 18727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 344
* EL050.cbl
 18729 7300-CHECK-FOR-OPEN-CLMS.
 18730
 18731*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18732*    MOVE SPACES                 TO CNTL-ACCESS.
 18733*    MOVE '1'                    TO CNTL-REC-TYPE.
 18734*    MOVE +0                     TO CNTL-SEQ-NO.
 18735
 18736*    MOVE '3'                    TO RC-SW-1.
 18737*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18738
 18739*    IF NOT CF-COMPANY-MASTER
 18740*         PERFORM 0099-COMPANY-NOT-FOUND
 18741*         GO TO 7300-EXIT.
 18742
 18743     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18744                                    W-CL-COMP-CD.
 18745     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18746                                    W-CL-CERT-NO.
 18747
 18748
 18749* EXEC CICS HANDLE CONDITION
 18750*        NOTFND  (7300-CONTINUE)
 18751*        ENDFILE (7300-CONTINUE)
 18752*    END-EXEC.
 18753*    MOVE '"$I''                  ! * #00018447' TO DFHEIV0
 18754     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18755     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18756     MOVE X'2A20233030303138343437' TO DFHEIV0(25:11)
 18757     CALL 'kxdfhei1' USING DFHEIV0
 18758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18759
 18760
 18761
 18762* EXEC CICS IGNORE CONDITION
 18763*        DUPKEY
 18764*    END-EXEC.
 18765*    MOVE '"*$                   !   #00018452' TO DFHEIV0
 18766     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18768     MOVE X'2020233030303138343532' TO DFHEIV0(25:11)
 18769     CALL 'kxdfhei1' USING DFHEIV0
 18770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18771
 18772
 18773
 18774* EXEC CICS STARTBR
 18775*        DATASET   (CLMS-ID)
 18776*        RIDFLD    (ELMSTR-KEY)
 18777*        GENERIC   EQUAL
 18778*        KEYLENGTH (ELMSTR-LENGTH)
 18779*    END-EXEC.
 18780     MOVE 0
 18781       TO DFHEIV11
 18782*    MOVE '&,   KG    E          &   #00018456' TO DFHEIV0
 18783     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18784     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18785     MOVE X'2020233030303138343536' TO DFHEIV0(25:11)
 18786     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 345
* EL050.cbl
 18787           CLMS-ID,
 18788           ELMSTR-KEY,
 18789           ELMSTR-LENGTH,
 18790           DFHEIV11,
 18791           DFHEIV99
 18792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18793
 18794
 18795     MOVE 'Y'                    TO W-BROWSE-SW.
 18796
 18797 7300-NEXT-CLAIM.
 18798
 18799
 18800* EXEC CICS READNEXT
 18801*        DATASET   (CLMS-ID)
 18802*        RIDFLD    (ELMSTR-KEY)
 18803*        SET       (ADDRESS OF CLAIM-MASTER)
 18804*    END-EXEC.
 18805     MOVE 0
 18806       TO DFHEIV11
 18807*    MOVE '&.S                   )   #00018467' TO DFHEIV0
 18808     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18809     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18810     MOVE X'2020233030303138343637' TO DFHEIV0(25:11)
 18811     CALL 'kxdfhei1' USING DFHEIV0,
 18812           CLMS-ID,
 18813           DFHEIV20,
 18814           DFHEIV99,
 18815           ELMSTR-KEY,
 18816           DFHEIV99,
 18817           DFHEIV11,
 18818           DFHEIV99,
 18819           DFHEIV99
 18820     SET ADDRESS OF CLAIM-MASTER TO
 18821         DFHEIV20
 18822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18823
 18824
 18825     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18826        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18827         GO TO 7300-CONTINUE.
 18828
 18829     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18830        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18831        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18832        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18833        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18834         GO TO 7300-NEXT-CLAIM.
 18835
 18836*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18837     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18838        OR (CL-CLAIM-TYPE = 'I')
 18839        OR (CL-CLAIM-TYPE = 'G')
 18840        IF CLAIM-IS-OPEN
 18841           EVALUATE TRUE
 18842             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18843                 MOVE ER-2884      TO WS-ERROR
 18844             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 346
* EL050.cbl
 18845                 MOVE ER-2887      TO WS-ERROR
 18846             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18847                 MOVE ER-2886      TO WS-ERROR
 18848             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18849                 MOVE ER-2888      TO WS-ERROR
 18850             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18851                 MOVE ER-2885      TO WS-ERROR
 18852             WHEN OTHER
 18853                 MOVE ER-2768      TO WS-ERROR
 18854           END-EVALUATE
 18855           IF PB-C-AH-CANCEL-VOIDED OR
 18856              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18857                NOT AH-COVERAGE-CANCELLED)
 18858               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18859               MOVE ER-2768      TO WS-ERROR
 18860           END-IF
 18861           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18862           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18863              PB-FORCE-CODE NOT EQUAL '8'
 18864               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18865           END-IF
 18866           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18867           GO TO 7300-CONTINUE
 18868        ELSE
 18869           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18870*****THIS IS A RESCISSION OR REFORMATION
 18871              IF (AH-COVERAGE-CANCELLED AND
 18872                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18873                    MOVE ER-2890 TO WS-ERROR
 18874                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18875                    GO TO 7300-CONTINUE
 18876              END-IF
 18877           ELSE
 18878              IF CL-DENIAL-TYPE = '1'  AND
 18879                 CL-TOTAL-PAID-AMT = 0
 18880                    GO TO 7300-NEXT-CLAIM
 18881              END-IF
 18882              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18883               AND PB-C-AH-CANCEL-DT > SPACES
 18884                 MOVE ER-2756        TO WS-ERROR
 18885                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18886                 GO TO 7300-CONTINUE
 18887              END-IF
 18888           END-IF
 18889        END-IF
 18890     ELSE
 18891*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18892        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18893           IF CLAIM-IS-OPEN
 18894              MOVE ER-2889      TO WS-ERROR
 18895              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18896              GO TO 7300-CONTINUE
 18897           ELSE
 18898              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18899*****THIS IS A RESCISSION OR REFORMATION
 18900                 IF (LF-COVERAGE-CANCELLED AND
 18901                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18902                       MOVE ER-2890 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 347
* EL050.cbl
 18903                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18904                       GO TO 7300-CONTINUE
 18905                 END-IF
 18906              ELSE
 18907                 IF CL-DENIAL-TYPE = '1'  AND
 18908                    CL-TOTAL-PAID-AMT = 0
 18909                       GO TO 7300-NEXT-CLAIM
 18910                 END-IF
 18911                 IF (AH-COVERAGE-CANCELLED AND
 18912                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18913                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18914                    (LF-COVERAGE-CANCELLED AND
 18915                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18916                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18917                       MOVE ER-2965 TO WS-ERROR
 18918                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18919                       GO TO 7300-CONTINUE
 18920                 END-IF
 18921                 IF LF-COVERAGE-CANCELLED
 18922                  IF CL-TOTAL-PAID-AMT > 0
 18923                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18924                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18925                        MOVE ER-2891 TO WS-ERROR
 18926                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18927                        GO TO 7300-CONTINUE
 18928                      END-IF
 18929                    ELSE
 18930                      MOVE ER-2892 TO WS-ERROR
 18931                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18932                      GO TO 7300-CONTINUE
 18933                    END-IF
 18934                  END-IF
 18935                 END-IF
 18936              END-IF
 18937           END-IF
 18938        END-IF
 18939     END-IF
 18940
 18941     GO TO 7300-NEXT-CLAIM.
 18942
 18943 7300-CONTINUE.
 18944
 18945     IF W-BROWSE-SW = 'Y'
 18946
 18947* EXEC CICS ENDBR
 18948*            DATASET   (CLMS-ID)
 18949*        END-EXEC.
 18950     MOVE 0
 18951       TO DFHEIV11
 18952*    MOVE '&2                    $   #00018594' TO DFHEIV0
 18953     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18954     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18955     MOVE X'2020233030303138353934' TO DFHEIV0(25:11)
 18956     CALL 'kxdfhei1' USING DFHEIV0,
 18957           CLMS-ID,
 18958           DFHEIV11,
 18959           DFHEIV99
 18960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 348
* EL050.cbl
 18961
 18962
 18963 7300-EXIT.
 18964     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 349
* EL050.cbl
 18966
 18967 7400-GET-REMAIN-TERM.
 18968
 18969* EXEC CICS LINK
 18970*        PROGRAM    ('ELRTRM')
 18971*        COMMAREA   (CALCULATION-PASS-AREA)
 18972*        LENGTH     (CP-COMM-LENGTH)
 18973*    END-EXEC.
 18974     MOVE 'ELRTRM' TO DFHEIV1
 18975*    MOVE '."C                   (   #00018603' TO DFHEIV0
 18976     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18977     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18978     MOVE X'2020233030303138363033' TO DFHEIV0(25:11)
 18979     CALL 'kxdfhei1' USING DFHEIV0,
 18980           DFHEIV1,
 18981           CALCULATION-PASS-AREA,
 18982           CP-COMM-LENGTH,
 18983           DFHEIV99,
 18984           DFHEIV99,
 18985           DFHEIV99,
 18986           DFHEIV99
 18987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18988
 18989
 18990 7400-EXIT.
 18991     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 350
* EL050.cbl
 18993
 18994 7500-GET-REMAIN-AMOUNT.
 18995
 18996* EXEC CICS LINK
 18997*        PROGRAM    ('ELRAMT')
 18998*        COMMAREA   (CALCULATION-PASS-AREA)
 18999*        LENGTH     (CP-COMM-LENGTH)
 19000*    END-EXEC.
 19001     MOVE 'ELRAMT' TO DFHEIV1
 19002*    MOVE '."C                   (   #00018614' TO DFHEIV0
 19003     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19004     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19005     MOVE X'2020233030303138363134' TO DFHEIV0(25:11)
 19006     CALL 'kxdfhei1' USING DFHEIV0,
 19007           DFHEIV1,
 19008           CALCULATION-PASS-AREA,
 19009           CP-COMM-LENGTH,
 19010           DFHEIV99,
 19011           DFHEIV99,
 19012           DFHEIV99,
 19013           DFHEIV99
 19014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19015
 19016
 19017 7500-EXIT.
 19018     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 351
* EL050.cbl
 19020
 19021 7600-GET-REFUND.
 19022
 19023* EXEC CICS LINK
 19024*        PROGRAM    ('ELRFND')
 19025*        COMMAREA   (CALCULATION-PASS-AREA)
 19026*        LENGTH     (CP-COMM-LENGTH)
 19027*    END-EXEC.
 19028     MOVE 'ELRFND' TO DFHEIV1
 19029*    MOVE '."C                   (   #00018625' TO DFHEIV0
 19030     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19032     MOVE X'2020233030303138363235' TO DFHEIV0(25:11)
 19033     CALL 'kxdfhei1' USING DFHEIV0,
 19034           DFHEIV1,
 19035           CALCULATION-PASS-AREA,
 19036           CP-COMM-LENGTH,
 19037           DFHEIV99,
 19038           DFHEIV99,
 19039           DFHEIV99,
 19040           DFHEIV99
 19041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19042
 19043
 19044 7600-EXIT.
 19045     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 352
* EL050.cbl
 19047 7700-CALL-DL1.
 19048
 19049* EXEC CICS LINK
 19050*        PROGRAM    ('DLO001')
 19051*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19052*        LENGTH     (DLO001-COMM-LENGTH)
 19053*    END-EXEC.
 19054     MOVE 'DLO001' TO DFHEIV1
 19055*    MOVE '."C                   (   #00018635' TO DFHEIV0
 19056     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19057     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19058     MOVE X'2020233030303138363335' TO DFHEIV0(25:11)
 19059     CALL 'kxdfhei1' USING DFHEIV0,
 19060           DFHEIV1,
 19061           WS-DLO-MASTER-POLICY-FORM,
 19062           DLO001-COMM-LENGTH,
 19063           DFHEIV99,
 19064           DFHEIV99,
 19065           DFHEIV99,
 19066           DFHEIV99
 19067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19068
 19069
 19070 7700-EXIT.
 19071     EXIT.
 19072
 19073 7710-CALL-DL2.
 19074
 19075* EXEC CICS LINK
 19076*        PROGRAM    ('DLO002')
 19077*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19078*        LENGTH     (DLO002-COMM-LENGTH)
 19079*    END-EXEC.
 19080     MOVE 'DLO002' TO DFHEIV1
 19081*    MOVE '."C                   (   #00018645' TO DFHEIV0
 19082     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19084     MOVE X'2020233030303138363435' TO DFHEIV0(25:11)
 19085     CALL 'kxdfhei1' USING DFHEIV0,
 19086           DFHEIV1,
 19087           WS-DLO-INTERNAL-POLICY-FORM,
 19088           DLO002-COMM-LENGTH,
 19089           DFHEIV99,
 19090           DFHEIV99,
 19091           DFHEIV99,
 19092           DFHEIV99
 19093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19094
 19095
 19096 7710-EXIT.
 19097     EXIT.
 19098
 19099 7720-CALL-DL3.
 19100
 19101* EXEC CICS LINK
 19102*        PROGRAM    ('DLO003')
 19103*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19104*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 353
* EL050.cbl
 19105*    END-EXEC.
 19106     MOVE 'DLO003' TO DFHEIV1
 19107*    MOVE '."C                   (   #00018655' TO DFHEIV0
 19108     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19110     MOVE X'2020233030303138363535' TO DFHEIV0(25:11)
 19111     CALL 'kxdfhei1' USING DFHEIV0,
 19112           DFHEIV1,
 19113           WS-DLO-VALID-BANK-ID,
 19114           DLO003-COMM-LENGTH,
 19115           DFHEIV99,
 19116           DFHEIV99,
 19117           DFHEIV99,
 19118           DFHEIV99
 19119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19120
 19121
 19122 7720-EXIT.
 19123     EXIT.
 19124
 19125 7730-CALL-DL7.
 19126
 19127* EXEC CICS LINK
 19128*        PROGRAM    ('DLO007')
 19129*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19130*        LENGTH     (DLO007-COMM-LENGTH)
 19131*    END-EXEC.
 19132     MOVE 'DLO007' TO DFHEIV1
 19133*    MOVE '."C                   (   #00018665' TO DFHEIV0
 19134     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19135     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19136     MOVE X'2020233030303138363635' TO DFHEIV0(25:11)
 19137     CALL 'kxdfhei1' USING DFHEIV0,
 19138           DFHEIV1,
 19139           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19140           DLO007-COMM-LENGTH,
 19141           DFHEIV99,
 19142           DFHEIV99,
 19143           DFHEIV99,
 19144           DFHEIV99
 19145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19146
 19147
 19148 7730-EXIT.
 19149     EXIT.
 19150
 19151 7740-CALL-DL11.
 19152
 19153* EXEC CICS LINK
 19154*        PROGRAM    ('DLO011')
 19155*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19156*        LENGTH     (DLO011-COMM-LENGTH)
 19157*    END-EXEC.
 19158     MOVE 'DLO011' TO DFHEIV1
 19159*    MOVE '."C                   (   #00018675' TO DFHEIV0
 19160     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19161     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19162     MOVE X'2020233030303138363735' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 354
* EL050.cbl
 19163     CALL 'kxdfhei1' USING DFHEIV0,
 19164           DFHEIV1,
 19165           WS-DLO-PREM-RATES-BEN-TYPE,
 19166           DLO011-COMM-LENGTH,
 19167           DFHEIV99,
 19168           DFHEIV99,
 19169           DFHEIV99,
 19170           DFHEIV99
 19171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19172
 19173
 19174 7740-EXIT.
 19175     EXIT.
 19176
 19177 7750-CALL-DL17.
 19178
 19179* EXEC CICS LINK
 19180*        PROGRAM    ('DLO017')
 19181*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19182*        LENGTH     (DLO017-COMM-LENGTH)
 19183*    END-EXEC.
 19184     MOVE 'DLO017' TO DFHEIV1
 19185*    MOVE '."C                   (   #00018685' TO DFHEIV0
 19186     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19188     MOVE X'2020233030303138363835' TO DFHEIV0(25:11)
 19189     CALL 'kxdfhei1' USING DFHEIV0,
 19190           DFHEIV1,
 19191           WS-DLO-VALID-RATE-CODE,
 19192           DLO017-COMM-LENGTH,
 19193           DFHEIV99,
 19194           DFHEIV99,
 19195           DFHEIV99,
 19196           DFHEIV99
 19197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19198
 19199
 19200 7750-EXIT.
 19201     EXIT.
 19202
 19203 7755-CALL-DL19.
 19204
 19205* EXEC CICS LINK
 19206*        PROGRAM    ('DLO019')
 19207*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19208*        LENGTH     (DLO019-COMM-LENGTH)
 19209*    END-EXEC.
 19210     MOVE 'DLO019' TO DFHEIV1
 19211*    MOVE '."C                   (   #00018695' TO DFHEIV0
 19212     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19213     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19214     MOVE X'2020233030303138363935' TO DFHEIV0(25:11)
 19215     CALL 'kxdfhei1' USING DFHEIV0,
 19216           DFHEIV1,
 19217           WS-DLO-ORIG-COV-CAT,
 19218           DLO019-COMM-LENGTH,
 19219           DFHEIV99,
 19220           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 355
* EL050.cbl
 19221           DFHEIV99,
 19222           DFHEIV99
 19223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19224
 19225
 19226 7755-EXIT.
 19227     EXIT.
 19228
 19229 7760-CALL-DL21.
 19230
 19231* EXEC CICS LINK
 19232*        PROGRAM    ('DLO021')
 19233*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19234*        LENGTH     (DLO021-COMM-LENGTH)
 19235*    END-EXEC.
 19236     MOVE 'DLO021' TO DFHEIV1
 19237*    MOVE '."C                   (   #00018705' TO DFHEIV0
 19238     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19240     MOVE X'2020233030303138373035' TO DFHEIV0(25:11)
 19241     CALL 'kxdfhei1' USING DFHEIV0,
 19242           DFHEIV1,
 19243           WS-DLO-VALID-LOAN-OFFICER,
 19244           DLO021-COMM-LENGTH,
 19245           DFHEIV99,
 19246           DFHEIV99,
 19247           DFHEIV99,
 19248           DFHEIV99
 19249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19250
 19251
 19252 7760-EXIT.
 19253     EXIT.
 19254
 19255 7770-CALL-DL22.
 19256
 19257* EXEC CICS LINK
 19258*        PROGRAM    ('DLO022')
 19259*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19260*        LENGTH     (DLO022-COMM-LENGTH)
 19261*    END-EXEC.
 19262     MOVE 'DLO022' TO DFHEIV1
 19263*    MOVE '."C                   (   #00018715' TO DFHEIV0
 19264     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19266     MOVE X'2020233030303138373135' TO DFHEIV0(25:11)
 19267     CALL 'kxdfhei1' USING DFHEIV0,
 19268           DFHEIV1,
 19269           WS-DLO-VALID-STATE-CODE,
 19270           DLO022-COMM-LENGTH,
 19271           DFHEIV99,
 19272           DFHEIV99,
 19273           DFHEIV99,
 19274           DFHEIV99
 19275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19276
 19277
 19278 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 356
* EL050.cbl
 19279     EXIT.
 19280
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 357
* EL050.cbl
 19282
 19283 7800-REWRITE-CERT.
 19284******************************************************************
 19285*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19286*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19287******************************************************************
 19288
 19289     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19290        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19291        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19292        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19293
 19294* EXEC CICS REWRITE
 19295*                  DATASET (CERT-ID)
 19296*                  FROM    (CERTIFICATE-MASTER)
 19297*              END-EXEC
 19298     MOVE LENGTH OF
 19299      CERTIFICATE-MASTER
 19300       TO DFHEIV11
 19301*    MOVE '&& L                  %   #00018736' TO DFHEIV0
 19302     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19303     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19304     MOVE X'2020233030303138373336' TO DFHEIV0(25:11)
 19305     CALL 'kxdfhei1' USING DFHEIV0,
 19306           CERT-ID,
 19307           CERTIFICATE-MASTER,
 19308           DFHEIV11,
 19309           DFHEIV99
 19310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19311        GO TO 7800-EXIT.
 19312
 19313       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19314       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19315
 19316 7800-EXIT.
 19317      EXIT.
 19318
 19319 7900-DELETE-CERT.
 19320
 19321* EXEC CICS DELETE
 19322*        DATASET (CERT-ID)
 19323*    END-EXEC.
 19324*    MOVE '&(                    &   #00018749' TO DFHEIV0
 19325     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19326     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19327     MOVE X'2020233030303138373439' TO DFHEIV0(25:11)
 19328     CALL 'kxdfhei1' USING DFHEIV0,
 19329           CERT-ID,
 19330           DFHEIV99,
 19331           DFHEIV99,
 19332           DFHEIV99,
 19333           DFHEIV99
 19334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19335
 19336
 19337 7900-EXIT.
 19338     EXIT.
 19339
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 358
* EL050.cbl
 19340 8000-WRITE-CERT.
 19341
 19342* EXEC CICS HANDLE CONDITION
 19343*        DUPKEY    (8000-FREE-MAIN)
 19344*    END-EXEC.
 19345*    MOVE '"$$                   ! + #00018757' TO DFHEIV0
 19346     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19348     MOVE X'2B20233030303138373537' TO DFHEIV0(25:11)
 19349     CALL 'kxdfhei1' USING DFHEIV0
 19350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19351
 19352
 19353
 19354* EXEC CICS WRITE
 19355*        DATASET     (CERT-ID)
 19356*        FROM        (CERTIFICATE-MASTER)
 19357*        RIDFLD      (ELCERT-KEY)
 19358*    END-EXEC.
 19359     MOVE LENGTH OF
 19360      CERTIFICATE-MASTER
 19361       TO DFHEIV11
 19362*    MOVE '&$ L                  ''   #00018761' TO DFHEIV0
 19363     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303138373631' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0,
 19367           CERT-ID,
 19368           CERTIFICATE-MASTER,
 19369           DFHEIV11,
 19370           ELCERT-KEY,
 19371           DFHEIV99,
 19372           DFHEIV99
 19373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19374
 19375
 19376 8000-FREE-MAIN.
 19377
 19378 8000-EXIT.
 19379      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 359
* EL050.cbl
 19381
 19382 8100-READ-ERPNDM.
 19383
 19384* EXEC CICS HANDLE CONDITION
 19385*         NOTFND     (8100-NOTFND)
 19386*         ENDFILE    (8100-NOTFND)
 19387*    END-EXEC.
 19388*    MOVE '"$I''                  ! , #00018774' TO DFHEIV0
 19389     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19391     MOVE X'2C20233030303138373734' TO DFHEIV0(25:11)
 19392     CALL 'kxdfhei1' USING DFHEIV0
 19393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19394
 19395
 19396     MOVE SPACES                 TO ERPNDM-FOUND.
 19397     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19398
 19399
 19400* EXEC CICS READ
 19401*         DATASET   (FILE-ERPNDM)
 19402*         RIDFLD    (PM-CONTROL-PRIMARY)
 19403*         INTO      (PENDING-MAILING-DATA)
 19404*    END-EXEC.
 19405     MOVE LENGTH OF
 19406      PENDING-MAILING-DATA
 19407       TO DFHEIV11
 19408*    MOVE '&"IL       E          (   #00018782' TO DFHEIV0
 19409     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19410     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19411     MOVE X'2020233030303138373832' TO DFHEIV0(25:11)
 19412     CALL 'kxdfhei1' USING DFHEIV0,
 19413           FILE-ERPNDM,
 19414           PENDING-MAILING-DATA,
 19415           DFHEIV11,
 19416           PM-CONTROL-PRIMARY,
 19417           DFHEIV99,
 19418           DFHEIV99,
 19419           DFHEIV99
 19420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19421
 19422
 19423     GO TO 8100-EXIT.
 19424
 19425 8100-NOTFND.
 19426
 19427     MOVE 'X'                    TO ERPNDM-FOUND.
 19428     MOVE ER-2694                TO WS-ERROR.
 19429     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19430     MOVE ER-2883                TO WS-ERROR
 19431     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19432     .
 19433 8100-EXIT.
 19434     EXIT.
 19435
 19436 8110-READ-ERMAIL.
 19437
 19438* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 360
* EL050.cbl
 19439*         NOTFND     (8110-NOTFND)
 19440*         ENDFILE    (8110-NOTFND)
 19441*    END-EXEC.
 19442*    MOVE '"$I''                  ! - #00018802' TO DFHEIV0
 19443     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19444     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19445     MOVE X'2D20233030303138383032' TO DFHEIV0(25:11)
 19446     CALL 'kxdfhei1' USING DFHEIV0
 19447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19448
 19449
 19450     MOVE SPACES                 TO ERMAIL-FOUND.
 19451     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19452     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19453     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19454     MOVE PB-SV-STATE            TO MA-STATE.
 19455
 19456
 19457* EXEC CICS READ
 19458*         UPDATE
 19459*         DATASET   (FILE-ERMAIL)
 19460*         RIDFLD    (MA-CONTROL-PRIMARY)
 19461*         INTO      (MAILING-DATA)
 19462*    END-EXEC.
 19463     MOVE LENGTH OF
 19464      MAILING-DATA
 19465       TO DFHEIV11
 19466*    MOVE '&"IL       EU         (   #00018813' TO DFHEIV0
 19467     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19468     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19469     MOVE X'2020233030303138383133' TO DFHEIV0(25:11)
 19470     CALL 'kxdfhei1' USING DFHEIV0,
 19471           FILE-ERMAIL,
 19472           MAILING-DATA,
 19473           DFHEIV11,
 19474           MA-CONTROL-PRIMARY,
 19475           DFHEIV99,
 19476           DFHEIV99,
 19477           DFHEIV99
 19478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19479
 19480
 19481     GO TO 8110-EXIT.
 19482
 19483 8110-NOTFND.
 19484     MOVE 'X'                    TO ERMAIL-FOUND.
 19485
 19486 8110-EXIT.
 19487     EXIT.
 19488
 19489 8120-REWRITE-ERMAIL.
 19490
 19491* EXEC CICS REWRITE
 19492*         DATASET    (FILE-ERMAIL)
 19493*         FROM       (MAILING-DATA)
 19494*    END-EXEC.
 19495     MOVE LENGTH OF
 19496      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 361
* EL050.cbl
 19497       TO DFHEIV11
 19498*    MOVE '&& L                  %   #00018829' TO DFHEIV0
 19499     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19500     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19501     MOVE X'2020233030303138383239' TO DFHEIV0(25:11)
 19502     CALL 'kxdfhei1' USING DFHEIV0,
 19503           FILE-ERMAIL,
 19504           MAILING-DATA,
 19505           DFHEIV11,
 19506           DFHEIV99
 19507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19508
 19509
 19510 8120-EXIT.
 19511     EXIT.
 19512
 19513 8130-WRITE-ERMAIL.
 19514
 19515* EXEC CICS HANDLE CONDITION
 19516*         DUPKEY   (8130-EXIT)
 19517*    END-EXEC.
 19518*    MOVE '"$$                   ! . #00018838' TO DFHEIV0
 19519     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19521     MOVE X'2E20233030303138383338' TO DFHEIV0(25:11)
 19522     CALL 'kxdfhei1' USING DFHEIV0
 19523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19524
 19525
 19526
 19527* EXEC CICS WRITE
 19528*         DATASET     (FILE-ERMAIL)
 19529*         RIDFLD      (MA-CONTROL-PRIMARY)
 19530*         FROM        (MAILING-DATA)
 19531*    END-EXEC.
 19532     MOVE LENGTH OF
 19533      MAILING-DATA
 19534       TO DFHEIV11
 19535*    MOVE '&$ L                  ''   #00018842' TO DFHEIV0
 19536     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19537     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19538     MOVE X'2020233030303138383432' TO DFHEIV0(25:11)
 19539     CALL 'kxdfhei1' USING DFHEIV0,
 19540           FILE-ERMAIL,
 19541           MAILING-DATA,
 19542           DFHEIV11,
 19543           MA-CONTROL-PRIMARY,
 19544           DFHEIV99,
 19545           DFHEIV99
 19546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19547
 19548
 19549 8130-EXIT.
 19550     EXIT.
 19551
 19552 8140-UNLOCK-ERMAIL.
 19553
 19554* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 362
* EL050.cbl
 19555*         DATASET   (FILE-ERMAIL)
 19556*    END-EXEC.
 19557*    MOVE '&*                    #   #00018852' TO DFHEIV0
 19558     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19559     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19560     MOVE X'2020233030303138383532' TO DFHEIV0(25:11)
 19561     CALL 'kxdfhei1' USING DFHEIV0,
 19562           FILE-ERMAIL,
 19563           DFHEIV99
 19564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19565
 19566
 19567 8140-EXIT.
 19568     EXIT.
 19569
 19570 8180-UPDATE-VIN-NUMBER.
 19571
 19572* EXEC CICS HANDLE CONDITION
 19573*        NOTFND   (8180-NOTFND)
 19574*    END-EXEC.
 19575*    MOVE '"$I                   ! / #00018860' TO DFHEIV0
 19576     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19578     MOVE X'2F20233030303138383630' TO DFHEIV0(25:11)
 19579     CALL 'kxdfhei1' USING DFHEIV0
 19580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19581
 19582
 19583     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19584     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19585
 19586
 19587* EXEC CICS READ
 19588*        UPDATE
 19589*        DATASET  (CRTT-ID)
 19590*        RIDFLD   (WS-ELCRTT-KEY)
 19591*        INTO     (CERTIFICATE-TRAILERS)
 19592*    END-EXEC.
 19593     MOVE LENGTH OF
 19594      CERTIFICATE-TRAILERS
 19595       TO DFHEIV11
 19596*    MOVE '&"IL       EU         (   #00018867' TO DFHEIV0
 19597     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19598     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19599     MOVE X'2020233030303138383637' TO DFHEIV0(25:11)
 19600     CALL 'kxdfhei1' USING DFHEIV0,
 19601           CRTT-ID,
 19602           CERTIFICATE-TRAILERS,
 19603           DFHEIV11,
 19604           WS-ELCRTT-KEY,
 19605           DFHEIV99,
 19606           DFHEIV99,
 19607           DFHEIV99
 19608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19609
 19610
 19611     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19612         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 363
* EL050.cbl
 19613
 19614* EXEC CICS REWRITE
 19615*           DATASET  (CRTT-ID)
 19616*           FROM     (CERTIFICATE-TRAILERS)
 19617*        END-EXEC
 19618     MOVE LENGTH OF
 19619      CERTIFICATE-TRAILERS
 19620       TO DFHEIV11
 19621*    MOVE '&& L                  %   #00018876' TO DFHEIV0
 19622     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19623     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19624     MOVE X'2020233030303138383736' TO DFHEIV0(25:11)
 19625     CALL 'kxdfhei1' USING DFHEIV0,
 19626           CRTT-ID,
 19627           CERTIFICATE-TRAILERS,
 19628           DFHEIV11,
 19629           DFHEIV99
 19630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19631     ELSE
 19632
 19633* EXEC CICS UNLOCK
 19634*          DATASET  (CRTT-ID)
 19635*       END-EXEC
 19636*    MOVE '&*                    #   #00018881' TO DFHEIV0
 19637     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19638     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19639     MOVE X'2020233030303138383831' TO DFHEIV0(25:11)
 19640     CALL 'kxdfhei1' USING DFHEIV0,
 19641           CRTT-ID,
 19642           DFHEIV99
 19643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19644     END-IF.
 19645
 19646     GO TO 8180-EXIT.
 19647
 19648 8180-NOTFND.
 19649
 19650     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19651     MOVE 'CS'         TO CS-RECORD-ID.
 19652     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19653     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19654     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19655     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19656
 19657* EXEC CICS WRITE
 19658*       DATASET  (CRTT-ID)
 19659*       RIDFLD   (WS-ELCRTT-KEY)
 19660*       FROM     (CERTIFICATE-TRAILERS)
 19661*    END-EXEC.
 19662     MOVE LENGTH OF
 19663      CERTIFICATE-TRAILERS
 19664       TO DFHEIV11
 19665*    MOVE '&$ L                  ''   #00018896' TO DFHEIV0
 19666     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19667     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19668     MOVE X'2020233030303138383936' TO DFHEIV0(25:11)
 19669     CALL 'kxdfhei1' USING DFHEIV0,
 19670           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 364
* EL050.cbl
 19671           CERTIFICATE-TRAILERS,
 19672           DFHEIV11,
 19673           WS-ELCRTT-KEY,
 19674           DFHEIV99,
 19675           DFHEIV99
 19676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19677
 19678
 19679 8180-EXIT.
 19680     EXIT.
 19681
 19682 8190-UPDATE-REFUND-CLAIM-FLAG.
 19683
 19684* EXEC CICS HANDLE CONDITION
 19685*        NOTFND   (8190-NOTFND)
 19686*    END-EXEC.
 19687*    MOVE '"$I                   ! 0 #00018906' TO DFHEIV0
 19688     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19690     MOVE X'3020233030303138393036' TO DFHEIV0(25:11)
 19691     CALL 'kxdfhei1' USING DFHEIV0
 19692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19693
 19694
 19695     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19696     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19697
 19698
 19699* EXEC CICS READ
 19700*        UPDATE
 19701*        DATASET  (CRTT-ID)
 19702*        RIDFLD   (WS-ELCRTT-KEY)
 19703*        INTO     (CERTIFICATE-TRAILERS)
 19704*    END-EXEC.
 19705     MOVE LENGTH OF
 19706      CERTIFICATE-TRAILERS
 19707       TO DFHEIV11
 19708*    MOVE '&"IL       EU         (   #00018913' TO DFHEIV0
 19709     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19710     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19711     MOVE X'2020233030303138393133' TO DFHEIV0(25:11)
 19712     CALL 'kxdfhei1' USING DFHEIV0,
 19713           CRTT-ID,
 19714           CERTIFICATE-TRAILERS,
 19715           DFHEIV11,
 19716           WS-ELCRTT-KEY,
 19717           DFHEIV99,
 19718           DFHEIV99,
 19719           DFHEIV99
 19720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19721
 19722
 19723     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19724
 19725* EXEC CICS REWRITE
 19726*       DATASET  (CRTT-ID)
 19727*       FROM     (CERTIFICATE-TRAILERS)
 19728*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 365
* EL050.cbl
 19729     MOVE LENGTH OF
 19730      CERTIFICATE-TRAILERS
 19731       TO DFHEIV11
 19732*    MOVE '&& L                  %   #00018921' TO DFHEIV0
 19733     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19734     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19735     MOVE X'2020233030303138393231' TO DFHEIV0(25:11)
 19736     CALL 'kxdfhei1' USING DFHEIV0,
 19737           CRTT-ID,
 19738           CERTIFICATE-TRAILERS,
 19739           DFHEIV11,
 19740           DFHEIV99
 19741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19742
 19743
 19744     GO TO 8190-EXIT.
 19745
 19746 8190-NOTFND.
 19747
 19748     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19749     MOVE 'CS'         TO CS-RECORD-ID.
 19750     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19751     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19752     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19753     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19754
 19755* EXEC CICS WRITE
 19756*       DATASET  (CRTT-ID)
 19757*       RIDFLD   (WS-ELCRTT-KEY)
 19758*       FROM     (CERTIFICATE-TRAILERS)
 19759*    END-EXEC.
 19760     MOVE LENGTH OF
 19761      CERTIFICATE-TRAILERS
 19762       TO DFHEIV11
 19763*    MOVE '&$ L                  ''   #00018936' TO DFHEIV0
 19764     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19765     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19766     MOVE X'2020233030303138393336' TO DFHEIV0(25:11)
 19767     CALL 'kxdfhei1' USING DFHEIV0,
 19768           CRTT-ID,
 19769           CERTIFICATE-TRAILERS,
 19770           DFHEIV11,
 19771           WS-ELCRTT-KEY,
 19772           DFHEIV99,
 19773           DFHEIV99
 19774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19775
 19776
 19777 8190-EXIT.
 19778     EXIT.
 19779
 19780 8195-UPDATE-AGE-FLAGS.
 19781
 19782* EXEC CICS HANDLE CONDITION
 19783*        NOTFND   (8195-NOTFND)
 19784*    END-EXEC.
 19785*    MOVE '"$I                   ! 1 #00018946' TO DFHEIV0
 19786     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 366
* EL050.cbl
 19787     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19788     MOVE X'3120233030303138393436' TO DFHEIV0(25:11)
 19789     CALL 'kxdfhei1' USING DFHEIV0
 19790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19791
 19792
 19793     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19794     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19795
 19796
 19797* EXEC CICS READ
 19798*        UPDATE
 19799*        DATASET  (CRTT-ID)
 19800*        RIDFLD   (WS-ELCRTT-KEY)
 19801*        INTO     (CERTIFICATE-TRAILERS)
 19802*    END-EXEC.
 19803     MOVE LENGTH OF
 19804      CERTIFICATE-TRAILERS
 19805       TO DFHEIV11
 19806*    MOVE '&"IL       EU         (   #00018953' TO DFHEIV0
 19807     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19808     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19809     MOVE X'2020233030303138393533' TO DFHEIV0(25:11)
 19810     CALL 'kxdfhei1' USING DFHEIV0,
 19811           CRTT-ID,
 19812           CERTIFICATE-TRAILERS,
 19813           DFHEIV11,
 19814           WS-ELCRTT-KEY,
 19815           DFHEIV99,
 19816           DFHEIV99,
 19817           DFHEIV99
 19818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19819
 19820
 19821     IF WS-INS-AGE-SET = 'Y'
 19822        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19823     END-IF
 19824     IF WS-JNT-AGE-SET = 'Y'
 19825        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 19826     END-IF
 19827
 19828
 19829* EXEC CICS REWRITE
 19830*       DATASET  (CRTT-ID)
 19831*       FROM     (CERTIFICATE-TRAILERS)
 19832*    END-EXEC.
 19833     MOVE LENGTH OF
 19834      CERTIFICATE-TRAILERS
 19835       TO DFHEIV11
 19836*    MOVE '&& L                  %   #00018967' TO DFHEIV0
 19837     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19838     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19839     MOVE X'2020233030303138393637' TO DFHEIV0(25:11)
 19840     CALL 'kxdfhei1' USING DFHEIV0,
 19841           CRTT-ID,
 19842           CERTIFICATE-TRAILERS,
 19843           DFHEIV11,
 19844           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 367
* EL050.cbl
 19845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19846
 19847
 19848     GO TO 8195-EXIT.
 19849
 19850 8195-NOTFND.
 19851
 19852     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19853     MOVE 'CS'         TO CS-RECORD-ID.
 19854     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19855     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19856     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19857     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 19858     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 19859
 19860* EXEC CICS WRITE
 19861*       DATASET  (CRTT-ID)
 19862*       RIDFLD   (WS-ELCRTT-KEY)
 19863*       FROM     (CERTIFICATE-TRAILERS)
 19864*    END-EXEC.
 19865     MOVE LENGTH OF
 19866      CERTIFICATE-TRAILERS
 19867       TO DFHEIV11
 19868*    MOVE '&$ L                  ''   #00018983' TO DFHEIV0
 19869     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19870     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19871     MOVE X'2020233030303138393833' TO DFHEIV0(25:11)
 19872     CALL 'kxdfhei1' USING DFHEIV0,
 19873           CRTT-ID,
 19874           CERTIFICATE-TRAILERS,
 19875           DFHEIV11,
 19876           WS-ELCRTT-KEY,
 19877           DFHEIV99,
 19878           DFHEIV99
 19879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19880
 19881
 19882 8195-EXIT.
 19883     EXIT.
 19884
 19885 8200-READ-REIN-TABLE.
 19886
 19887* EXEC CICS HANDLE CONDITION
 19888*         NOTFND   (8200-NOTFND)
 19889*    END-EXEC.
 19890*    MOVE '"$I                   ! 2 #00018993' TO DFHEIV0
 19891     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19893     MOVE X'3220233030303138393933' TO DFHEIV0(25:11)
 19894     CALL 'kxdfhei1' USING DFHEIV0
 19895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19896
 19897
 19898
 19899* EXEC CICS READ
 19900*        DATASET     (REIN-ID)
 19901*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19902*        RIDFLD      (ERREIN-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 368
* EL050.cbl
 19903*    END-EXEC.
 19904*    MOVE '&"S        E          (   #00018997' TO DFHEIV0
 19905     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19907     MOVE X'2020233030303138393937' TO DFHEIV0(25:11)
 19908     CALL 'kxdfhei1' USING DFHEIV0,
 19909           REIN-ID,
 19910           DFHEIV20,
 19911           DFHEIV99,
 19912           ERREIN-KEY,
 19913           DFHEIV99,
 19914           DFHEIV99,
 19915           DFHEIV99
 19916     SET ADDRESS OF REINSURANCE-RECORD TO
 19917         DFHEIV20
 19918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19919
 19920
 19921     GO TO 8200-EXIT.
 19922
 19923 8200-NOTFND.
 19924     MOVE 'N'             TO WS-REIN-READ-SW.
 19925
 19926 8200-EXIT.
 19927      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 369
* EL050.cbl
 19929
 19930 8300-READ-CTBL-TABLE.
 19931
 19932* EXEC CICS HANDLE CONDITION
 19933*        NOTFND    (8300-NOTFND)
 19934*        DISABLED  (8300-ERRESS-PROBLEM)
 19935*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19936*        ENDFILE   (8300-NOTFND)
 19937*    END-EXEC.
 19938*    MOVE '"$IcJ''                ! 3 #00019013' TO DFHEIV0
 19939     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19941     MOVE X'3320233030303139303133' TO DFHEIV0(25:11)
 19942     CALL 'kxdfhei1' USING DFHEIV0
 19943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19944
 19945
 19946
 19947* EXEC CICS READ
 19948*        DATASET     (CTBL-ID)
 19949*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19950*        RIDFLD      (ERCTBL-KEY)
 19951*    END-EXEC.
 19952*    MOVE '&"S        E          (   #00019020' TO DFHEIV0
 19953     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19955     MOVE X'2020233030303139303230' TO DFHEIV0(25:11)
 19956     CALL 'kxdfhei1' USING DFHEIV0,
 19957           CTBL-ID,
 19958           DFHEIV20,
 19959           DFHEIV99,
 19960           ERCTBL-KEY,
 19961           DFHEIV99,
 19962           DFHEIV99,
 19963           DFHEIV99
 19964     SET ADDRESS OF COMM-TABLE-RECORD TO
 19965         DFHEIV20
 19966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19967
 19968
 19969     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19970
 19971     GO TO 8300-EXIT.
 19972
 19973 8300-NOTFND.
 19974
 19975     IF CTBL-SW = '0530'
 19976         MOVE 'AA'                     TO WS-AH-COMP-CD
 19977         MOVE '0550'                   TO CTBL-SW
 19978         MOVE '1'                      TO WS-CTBL-READ-SW
 19979         GO TO 8300-EXIT.
 19980
 19981     IF CTBL-SW = '0540'
 19982         MOVE 'AA'                     TO WS-LF-COMP-CD
 19983         MOVE '0550'                   TO CTBL-SW
 19984         MOVE '1'                      TO WS-CTBL-READ-SW
 19985         GO TO 8300-EXIT.
 19986
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 370
* EL050.cbl
 19987     IF CTBL-SW = '0550'
 19988         MOVE '2'                      TO WS-CTBL-READ-SW
 19989         GO TO 8300-EXIT.
 19990
 19991     GO TO 8300-EXIT.
 19992
 19993 8300-ERRESS-PROBLEM.
 19994
 19995      MOVE ER-8050              TO WS-ERROR.
 19996      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19997
 19998     GO TO 8300-EXIT.
 19999
 20000 8300-EXIT.
 20001      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 371
* EL050.cbl
 20003
 20004
 20005 8400-GETMAIN-ERFORM.
 20006
 20007
 20008* EXEC CICS   GETMAIN
 20009*        LENGTH  (500)
 20010*        SET     (ADDRESS OF FORM-MASTER)
 20011*    END-EXEC.
 20012     MOVE 500
 20013       TO DFHEIV11
 20014*    MOVE '," L                  $   #00019064' TO DFHEIV0
 20015     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20016     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20017     MOVE X'2020233030303139303634' TO DFHEIV0(25:11)
 20018     CALL 'kxdfhei1' USING DFHEIV0,
 20019           DFHEIV20,
 20020           DFHEIV11,
 20021           DFHEIV99
 20022     SET ADDRESS OF FORM-MASTER TO
 20023         DFHEIV20
 20024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20025
 20026
 20027     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20028
 20029 8400-EXIT.
 20030      EXIT.
 20031
 20032 8450-READ-FORM-MASTER.
 20033
 20034
 20035* EXEC CICS  HANDLE CONDITION
 20036*        NOTFND   (8450-FORM-NOT-FOUND)
 20037*        ENDFILE  (8450-FORM-NOT-FOUND)
 20038*    END-EXEC.
 20039*    MOVE '"$I''                  ! 4 #00019076' TO DFHEIV0
 20040     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20042     MOVE X'3420233030303139303736' TO DFHEIV0(25:11)
 20043     CALL 'kxdfhei1' USING DFHEIV0
 20044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20045
 20046
 20047
 20048* EXEC CICS   READ
 20049*        DATASET   (FORM-ID)
 20050*        RIDFLD    (ERFORM-KEY)
 20051*        INTO      (FORM-MASTER)
 20052*        GTEQ
 20053*    END-EXEC.
 20054     MOVE LENGTH OF
 20055      FORM-MASTER
 20056       TO DFHEIV11
 20057*    MOVE '&"IL       G          (   #00019081' TO DFHEIV0
 20058     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20059     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20060     MOVE X'2020233030303139303831' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 372
* EL050.cbl
 20061     CALL 'kxdfhei1' USING DFHEIV0,
 20062           FORM-ID,
 20063           FORM-MASTER,
 20064           DFHEIV11,
 20065           ERFORM-KEY,
 20066           DFHEIV99,
 20067           DFHEIV99,
 20068           DFHEIV99
 20069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20070
 20071
 20072     MOVE  'Y'           TO  FORM-MASTER-SW.
 20073
 20074     GO TO  8450-EXIT.
 20075
 20076 8450-FORM-NOT-FOUND.
 20077
 20078     MOVE  'N'           TO  FORM-MASTER-SW.
 20079
 20080 8450-EXIT.
 20081      EXIT.
 20082
 20083 8500-DATE-CONVERT.
 20084
 20085* EXEC CICS LINK
 20086*        PROGRAM    ('ELDATCV')
 20087*        COMMAREA   (DATE-CONVERSION-DATA)
 20088*        LENGTH     (DC-COMM-LENGTH)
 20089*    END-EXEC.
 20090     MOVE 'ELDATCV' TO DFHEIV1
 20091*    MOVE '."C                   (   #00019100' TO DFHEIV0
 20092     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20093     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20094     MOVE X'2020233030303139313030' TO DFHEIV0(25:11)
 20095     CALL 'kxdfhei1' USING DFHEIV0,
 20096           DFHEIV1,
 20097           DATE-CONVERSION-DATA,
 20098           DC-COMM-LENGTH,
 20099           DFHEIV99,
 20100           DFHEIV99,
 20101           DFHEIV99,
 20102           DFHEIV99
 20103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20104
 20105
 20106 8500-EXIT.
 20107     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 373
* EL050.cbl
 20109
 20110 8555-RELOAD-CONTROL-FILE.
 20111     CONTINUE.
 20112
 20113 8555-EXIT.
 20114     EXIT.
 20115
 20116 8557-GETMAIN-ERPLAN.
 20117
 20118
 20119* EXEC CICS GETMAIN
 20120*        LENGTH    (840)
 20121*        SET       (ADDRESS OF PLAN-RECORDS)
 20122*    END-EXEC.
 20123     MOVE 840
 20124       TO DFHEIV11
 20125*    MOVE '," L                  $   #00019118' TO DFHEIV0
 20126     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20127     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20128     MOVE X'2020233030303139313138' TO DFHEIV0(25:11)
 20129     CALL 'kxdfhei1' USING DFHEIV0,
 20130           DFHEIV20,
 20131           DFHEIV11,
 20132           DFHEIV99
 20133     SET ADDRESS OF PLAN-RECORDS TO
 20134         DFHEIV20
 20135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20136
 20137
 20138     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20139
 20140 8557-EXIT.
 20141     EXIT.
 20142
 20143 8560-GETMAIN.
 20144
 20145* EXEC CICS GETMAIN
 20146*        LENGTH    (2000)
 20147*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20148*    END-EXEC.
 20149     MOVE 2000
 20150       TO DFHEIV11
 20151*    MOVE '," L                  $   #00019129' TO DFHEIV0
 20152     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20153     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20154     MOVE X'2020233030303139313239' TO DFHEIV0(25:11)
 20155     CALL 'kxdfhei1' USING DFHEIV0,
 20156           DFHEIV20,
 20157           DFHEIV11,
 20158           DFHEIV99
 20159     SET ADDRESS OF ACCOUNT-MASTER TO
 20160         DFHEIV20
 20161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20162
 20163
 20164     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20165
 20166 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 374
* EL050.cbl
 20167     EXIT.
 20168
 20169 8570-START-ACCOUNT-MASTER.
 20170
 20171* EXEC CICS HANDLE CONDITION
 20172*        NOTFND    (0199-ACCT-NOT-FOUND)
 20173*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20174*    END-EXEC.
 20175*    MOVE '"$I''                  ! 5 #00019140' TO DFHEIV0
 20176     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20177     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20178     MOVE X'3520233030303139313430' TO DFHEIV0(25:11)
 20179     CALL 'kxdfhei1' USING DFHEIV0
 20180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20181
 20182
 20183
 20184* EXEC CICS STARTBR
 20185*        DATASET    (ACCT-ID)
 20186*        RIDFLD     (ERACCT-KEY)
 20187*        GTEQ
 20188*    END-EXEC.
 20189     MOVE 0
 20190       TO DFHEIV11
 20191*    MOVE '&,         G          &   #00019145' TO DFHEIV0
 20192     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20194     MOVE X'2020233030303139313435' TO DFHEIV0(25:11)
 20195     CALL 'kxdfhei1' USING DFHEIV0,
 20196           ACCT-ID,
 20197           ERACCT-KEY,
 20198           DFHEIV99,
 20199           DFHEIV11,
 20200           DFHEIV99
 20201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20202
 20203
 20204 8570-EXIT.
 20205     EXIT.
 20206
 20207 8580-READ-ACCOUNT-MASTER.
 20208
 20209* EXEC CICS HANDLE CONDITION
 20210*        NOTFND    (0199-ACCT-NOT-FOUND)
 20211*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20212*    END-EXEC.
 20213*    MOVE '"$I''                  ! 6 #00019155' TO DFHEIV0
 20214     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20216     MOVE X'3620233030303139313535' TO DFHEIV0(25:11)
 20217     CALL 'kxdfhei1' USING DFHEIV0
 20218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20219
 20220
 20221
 20222* EXEC CICS READNEXT
 20223*        DATASET     (ACCT-ID)
 20224*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 375
* EL050.cbl
 20225*        RIDFLD      (ERACCT-KEY)
 20226*    END-EXEC.
 20227     MOVE LENGTH OF
 20228      ACCOUNT-MASTER
 20229       TO DFHEIV12
 20230     MOVE 0
 20231       TO DFHEIV11
 20232*    MOVE '&.IL                  )   #00019160' TO DFHEIV0
 20233     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20234     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20235     MOVE X'2020233030303139313630' TO DFHEIV0(25:11)
 20236     CALL 'kxdfhei1' USING DFHEIV0,
 20237           ACCT-ID,
 20238           ACCOUNT-MASTER,
 20239           DFHEIV12,
 20240           ERACCT-KEY,
 20241           DFHEIV99,
 20242           DFHEIV11,
 20243           DFHEIV99,
 20244           DFHEIV99
 20245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20246
 20247
 20248 8580-EXIT.
 20249     EXIT.
 20250
 20251 8582-READ-COMPENSATION-MASTER.
 20252
 20253* EXEC CICS HANDLE CONDITION
 20254*        NOTFND    (8582-COMP-NOT-FOUND)
 20255*        ENDFILE   (8582-COMP-NOT-FOUND)
 20256*    END-EXEC.
 20257*    MOVE '"$I''                  ! 7 #00019170' TO DFHEIV0
 20258     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20260     MOVE X'3720233030303139313730' TO DFHEIV0(25:11)
 20261     CALL 'kxdfhei1' USING DFHEIV0
 20262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20263
 20264
 20265
 20266* EXEC CICS READ
 20267*        DATASET     (COMP-ID)
 20268*        INTO        (COMPENSATION-MASTER)
 20269*        RIDFLD      (ERCOMP-KEY)
 20270*    END-EXEC.
 20271     MOVE LENGTH OF
 20272      COMPENSATION-MASTER
 20273       TO DFHEIV11
 20274*    MOVE '&"IL       E          (   #00019175' TO DFHEIV0
 20275     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303139313735' TO DFHEIV0(25:11)
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           COMP-ID,
 20280           COMPENSATION-MASTER,
 20281           DFHEIV11,
 20282           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 376
* EL050.cbl
 20283           DFHEIV99,
 20284           DFHEIV99,
 20285           DFHEIV99
 20286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20287
 20288
 20289     MOVE 'Y'                    TO COMP-MASTER-SW
 20290
 20291     GO TO 8582-EXIT
 20292     .
 20293 8582-COMP-NOT-FOUND.
 20294
 20295     MOVE 'N'                    TO COMP-MASTER-SW.
 20296
 20297 8582-EXIT.
 20298     EXIT.
 20299
 20300 8583-READ-ERAGTC.
 20301
 20302* EXEC CICS HANDLE CONDITION
 20303*        NOTFND    (8583-AGTC-NOT-FOUND)
 20304*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20305*    END-EXEC.
 20306*    MOVE '"$I''                  ! 8 #00019193' TO DFHEIV0
 20307     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20309     MOVE X'3820233030303139313933' TO DFHEIV0(25:11)
 20310     CALL 'kxdfhei1' USING DFHEIV0
 20311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20312
 20313
 20314
 20315* EXEC CICS STARTBR
 20316*        DATASET    (AGTC-ID)
 20317*        RIDFLD     (ERAGTC-KEY)
 20318*        GTEQ
 20319*    END-EXEC.
 20320     MOVE 0
 20321       TO DFHEIV11
 20322*    MOVE '&,         G          &   #00019198' TO DFHEIV0
 20323     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20324     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20325     MOVE X'2020233030303139313938' TO DFHEIV0(25:11)
 20326     CALL 'kxdfhei1' USING DFHEIV0,
 20327           AGTC-ID,
 20328           ERAGTC-KEY,
 20329           DFHEIV99,
 20330           DFHEIV11,
 20331           DFHEIV99
 20332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20333
 20334
 20335 8583-READ-ERAGTC-NEXT.
 20336
 20337* EXEC CICS READNEXT
 20338*        DATASET     (AGTC-ID)
 20339*        INTO        (AGENT-COMMISSIONS)
 20340*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 377
* EL050.cbl
 20341*    END-EXEC.
 20342     MOVE LENGTH OF
 20343      AGENT-COMMISSIONS
 20344       TO DFHEIV12
 20345     MOVE 0
 20346       TO DFHEIV11
 20347*    MOVE '&.IL                  )   #00019205' TO DFHEIV0
 20348     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20349     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20350     MOVE X'2020233030303139323035' TO DFHEIV0(25:11)
 20351     CALL 'kxdfhei1' USING DFHEIV0,
 20352           AGTC-ID,
 20353           AGENT-COMMISSIONS,
 20354           DFHEIV12,
 20355           ERAGTC-KEY,
 20356           DFHEIV99,
 20357           DFHEIV11,
 20358           DFHEIV99,
 20359           DFHEIV99
 20360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20361
 20362
 20363*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20364
 20365     GO TO 8583-EXIT
 20366     .
 20367 8583-AGTC-NOT-FOUND.
 20368
 20369     MOVE 'N'                    TO AGTC-MASTER-SW.
 20370
 20371 8583-EXIT.
 20372     EXIT.
 20373
 20374 8584-READ-BANK-CROSS-REF.
 20375
 20376* EXEC CICS HANDLE CONDITION
 20377*        NOTFND    (8584-BXRF-NOT-FOUND)
 20378*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20379*    END-EXEC.
 20380*    MOVE '"$I''                  ! 9 #00019223' TO DFHEIV0
 20381     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20382     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20383     MOVE X'3920233030303139323233' TO DFHEIV0(25:11)
 20384     CALL 'kxdfhei1' USING DFHEIV0
 20385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20386
 20387
 20388
 20389* EXEC CICS READ
 20390*        DATASET     (BXRF-ID)
 20391*        INTO        (BANK-CROSS-REFERENCE)
 20392*        RIDFLD      (ERBXRF-KEY)
 20393*        LENGTH      (BXRF-REC-LENGTH)
 20394*    END-EXEC.
 20395*    MOVE '&"IL       E          (   #00019228' TO DFHEIV0
 20396     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20398     MOVE X'2020233030303139323238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 378
* EL050.cbl
 20399     CALL 'kxdfhei1' USING DFHEIV0,
 20400           BXRF-ID,
 20401           BANK-CROSS-REFERENCE,
 20402           BXRF-REC-LENGTH,
 20403           ERBXRF-KEY,
 20404           DFHEIV99,
 20405           DFHEIV99,
 20406           DFHEIV99
 20407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20408
 20409
 20410     MOVE 'Y'                    TO BXRF-MASTER-SW
 20411
 20412     GO TO 8584-EXIT
 20413     .
 20414 8584-BXRF-NOT-FOUND.
 20415
 20416     MOVE 'N'                    TO BXRF-MASTER-SW.
 20417
 20418 8584-EXIT.
 20419     EXIT.
 20420
 20421 8585-READ-PLAN-MASTER.
 20422
 20423
 20424* EXEC CICS HANDLE CONDITION
 20425*        NOTFND    (8585-PLAN-NOT-FOUND)
 20426*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20427*    END-EXEC.
 20428*    MOVE '"$I''                  ! : #00019248' TO DFHEIV0
 20429     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20431     MOVE X'3A20233030303139323438' TO DFHEIV0(25:11)
 20432     CALL 'kxdfhei1' USING DFHEIV0
 20433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20434
 20435
 20436
 20437* EXEC CICS READ
 20438*        DATASET     (PLAN-ID)
 20439*        INTO        (PLAN-MASTER)
 20440*        RIDFLD      (ERPLAN-KEY)
 20441*    END-EXEC.
 20442     MOVE LENGTH OF
 20443      PLAN-MASTER
 20444       TO DFHEIV11
 20445*    MOVE '&"IL       E          (   #00019253' TO DFHEIV0
 20446     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20448     MOVE X'2020233030303139323533' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0,
 20450           PLAN-ID,
 20451           PLAN-MASTER,
 20452           DFHEIV11,
 20453           ERPLAN-KEY,
 20454           DFHEIV99,
 20455           DFHEIV99,
 20456           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 379
* EL050.cbl
 20457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20458
 20459
 20460     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20461
 20462     GO TO 8585-EXIT.
 20463
 20464 8585-PLAN-NOT-FOUND.
 20465
 20466     MOVE 'N'                    TO PLAN-MASTER-SW.
 20467
 20468 8585-EXIT.
 20469     EXIT.
 20470
 20471 8586-READ-LOAN-OFFICER.
 20472
 20473* EXEC CICS READ
 20474*        DATASET     (LOFC-ID)
 20475*        INTO        (LOAN-OFFICER-MASTER)
 20476*        RIDFLD      (ERLOFC-KEY)
 20477*        RESP        (WS-RESPONSE)
 20478*    END-EXEC
 20479     MOVE LENGTH OF
 20480      LOAN-OFFICER-MASTER
 20481       TO DFHEIV11
 20482*    MOVE '&"IL       E          (  N#00019271' TO DFHEIV0
 20483     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20485     MOVE X'204E233030303139323731' TO DFHEIV0(25:11)
 20486     CALL 'kxdfhei1' USING DFHEIV0,
 20487           LOFC-ID,
 20488           LOAN-OFFICER-MASTER,
 20489           DFHEIV11,
 20490           ERLOFC-KEY,
 20491           DFHEIV99,
 20492           DFHEIV99,
 20493           DFHEIV99
 20494     MOVE EIBRESP  TO WS-RESPONSE
 20495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20496
 20497     IF WS-RESP-NORMAL
 20498        MOVE 'Y'                 TO LOFC-MASTER-SW
 20499     ELSE
 20500        MOVE 'N'                 TO LOFC-MASTER-SW
 20501     END-IF
 20502     .
 20503 8586-EXIT.
 20504     EXIT.
 20505 8587-START-ERPDEF.
 20506
 20507* EXEC CICS STARTBR
 20508*       DATASET   (PDEF-ID)
 20509*       RIDFLD    (ERPDEF-KEY)
 20510*       GTEQ
 20511*       RESP      (WS-RESPONSE)
 20512*    END-EXEC
 20513     MOVE 0
 20514       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 380
* EL050.cbl
 20515*    MOVE '&,         G          &  N#00019287' TO DFHEIV0
 20516     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20517     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20518     MOVE X'204E233030303139323837' TO DFHEIV0(25:11)
 20519     CALL 'kxdfhei1' USING DFHEIV0,
 20520           PDEF-ID,
 20521           ERPDEF-KEY,
 20522           DFHEIV99,
 20523           DFHEIV11,
 20524           DFHEIV99
 20525     MOVE EIBRESP  TO WS-RESPONSE
 20526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20527     IF WS-RESP-NORMAL
 20528        MOVE 'Y'                 TO PDEF-MASTER-SW
 20529     ELSE
 20530        MOVE 'N'                 TO PDEF-MASTER-SW
 20531     END-IF
 20532     .
 20533 8587-EXIT.
 20534     EXIT.
 20535 8588-READ-ERPDEF.
 20536
 20537* EXEC CICS READNEXT
 20538*       DATASET   (PDEF-ID)
 20539*       RIDFLD    (ERPDEF-KEY)
 20540*       INTO      (PRODUCT-MASTER)
 20541*       RESP      (WS-RESPONSE)
 20542*    END-EXEC
 20543     MOVE LENGTH OF
 20544      PRODUCT-MASTER
 20545       TO DFHEIV12
 20546     MOVE 0
 20547       TO DFHEIV11
 20548*    MOVE '&.IL                  )  N#00019302' TO DFHEIV0
 20549     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20550     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20551     MOVE X'204E233030303139333032' TO DFHEIV0(25:11)
 20552     CALL 'kxdfhei1' USING DFHEIV0,
 20553           PDEF-ID,
 20554           PRODUCT-MASTER,
 20555           DFHEIV12,
 20556           ERPDEF-KEY,
 20557           DFHEIV99,
 20558           DFHEIV11,
 20559           DFHEIV99,
 20560           DFHEIV99
 20561     MOVE EIBRESP  TO WS-RESPONSE
 20562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20563     IF WS-RESP-NORMAL
 20564        MOVE 'Y'                 TO PDEF-MASTER-SW
 20565     ELSE
 20566        MOVE 'N'                 TO PDEF-MASTER-SW
 20567     END-IF
 20568     .
 20569 8588-EXIT.
 20570     EXIT.
 20571 8589-ENDBR-ERPDEF.
 20572
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 381
* EL050.cbl
 20573* EXEC CICS ENDBR
 20574*       DATASET   (PDEF-ID)
 20575*    END-EXEC
 20576     MOVE 0
 20577       TO DFHEIV11
 20578*    MOVE '&2                    $   #00019317' TO DFHEIV0
 20579     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20580     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20581     MOVE X'2020233030303139333137' TO DFHEIV0(25:11)
 20582     CALL 'kxdfhei1' USING DFHEIV0,
 20583           PDEF-ID,
 20584           DFHEIV11,
 20585           DFHEIV99
 20586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20587     .
 20588 8589-EXIT.
 20589     EXIT.
 20590 8590-READ-CERT-MASTER.
 20591     IF PB-COMPANY-ID = 'UCL'
 20592         GO TO 8690-READ-CERT-MASTER-UCL.
 20593
 20594
 20595* EXEC CICS HANDLE CONDITION
 20596*         NOTFND    (0299-CERT-NOT-FOUND)
 20597*    END-EXEC.
 20598*    MOVE '"$I                   ! ; #00019327' TO DFHEIV0
 20599     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20600     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20601     MOVE X'3B20233030303139333237' TO DFHEIV0(25:11)
 20602     CALL 'kxdfhei1' USING DFHEIV0
 20603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20604
 20605
 20606
 20607* EXEC CICS READ
 20608*        DATASET     (CERT-ID)
 20609*        INTO        (CERTIFICATE-MASTER)
 20610*        RIDFLD      (ELCERT-KEY)
 20611*        UPDATE
 20612*    END-EXEC.
 20613     MOVE LENGTH OF
 20614      CERTIFICATE-MASTER
 20615       TO DFHEIV11
 20616*    MOVE '&"IL       EU         (   #00019331' TO DFHEIV0
 20617     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20618     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20619     MOVE X'2020233030303139333331' TO DFHEIV0(25:11)
 20620     CALL 'kxdfhei1' USING DFHEIV0,
 20621           CERT-ID,
 20622           CERTIFICATE-MASTER,
 20623           DFHEIV11,
 20624           ELCERT-KEY,
 20625           DFHEIV99,
 20626           DFHEIV99,
 20627           DFHEIV99
 20628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20629
 20630
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 382
* EL050.cbl
 20631 8590-EXIT.
 20632     EXIT.
 20633
 20634 8690-READ-CERT-MASTER-UCL.
 20635
 20636* EXEC CICS HANDLE CONDITION
 20637*         NOTFND    (8700-READ-CERT-MASTER)
 20638*    END-EXEC.
 20639*    MOVE '"$I                   ! < #00019342' TO DFHEIV0
 20640     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20642     MOVE X'3C20233030303139333432' TO DFHEIV0(25:11)
 20643     CALL 'kxdfhei1' USING DFHEIV0
 20644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20645
 20646
 20647 8690-READ-CERT-CONT.
 20648
 20649* EXEC CICS READ
 20650*        DATASET     (CERT-ID)
 20651*        INTO        (CERTIFICATE-MASTER)
 20652*        RIDFLD      (ELCERT-KEY)
 20653*        UPDATE
 20654*    END-EXEC.
 20655     MOVE LENGTH OF
 20656      CERTIFICATE-MASTER
 20657       TO DFHEIV11
 20658*    MOVE '&"IL       EU         (   #00019347' TO DFHEIV0
 20659     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20661     MOVE X'2020233030303139333437' TO DFHEIV0(25:11)
 20662     CALL 'kxdfhei1' USING DFHEIV0,
 20663           CERT-ID,
 20664           CERTIFICATE-MASTER,
 20665           DFHEIV11,
 20666           ELCERT-KEY,
 20667           DFHEIV99,
 20668           DFHEIV99,
 20669           DFHEIV99
 20670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20671
 20672
 20673     GO TO 8590-EXIT.
 20674
 20675 8700-READ-CERT-MASTER.
 20676     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20677     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20678
 20679* EXEC CICS HANDLE CONDITION
 20680*         DUPKEY    (8720-COMP-ACCOUNTS)
 20681*         ENDFILE   (8730-END-BROWSE)
 20682*         NOTFND    (8740-NOT-FOUND)
 20683*    END-EXEC.
 20684*    MOVE '"$$''I                 ! = #00019359' TO DFHEIV0
 20685     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20686     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20687     MOVE X'3D20233030303139333539' TO DFHEIV0(25:11)
 20688     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 383
* EL050.cbl
 20689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20690
 20691
 20692
 20693* EXEC CICS STARTBR
 20694*        DATASET     ('ELCERT5')
 20695*        RIDFLD      (ELCERT2-KEY)
 20696*        EQUAL
 20697*    END-EXEC.
 20698     MOVE 'ELCERT5' TO DFHEIV1
 20699     MOVE 0
 20700       TO DFHEIV11
 20701*    MOVE '&,         E          &   #00019365' TO DFHEIV0
 20702     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20703     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20704     MOVE X'2020233030303139333635' TO DFHEIV0(25:11)
 20705     CALL 'kxdfhei1' USING DFHEIV0,
 20706           DFHEIV1,
 20707           ELCERT2-KEY,
 20708           DFHEIV99,
 20709           DFHEIV11,
 20710           DFHEIV99
 20711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20712
 20713
 20714 8710-READ-NEXT.
 20715
 20716* EXEC CICS READNEXT
 20717*        DATASET     ('ELCERT5')
 20718*        INTO        (CERTIFICATE-MASTER)
 20719*        RIDFLD      (ELCERT2-KEY)
 20720*    END-EXEC.
 20721     MOVE LENGTH OF
 20722      CERTIFICATE-MASTER
 20723       TO DFHEIV12
 20724     MOVE 'ELCERT5' TO DFHEIV1
 20725     MOVE 0
 20726       TO DFHEIV11
 20727*    MOVE '&.IL                  )   #00019372' TO DFHEIV0
 20728     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20729     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20730     MOVE X'2020233030303139333732' TO DFHEIV0(25:11)
 20731     CALL 'kxdfhei1' USING DFHEIV0,
 20732           DFHEIV1,
 20733           CERTIFICATE-MASTER,
 20734           DFHEIV12,
 20735           ELCERT2-KEY,
 20736           DFHEIV99,
 20737           DFHEIV11,
 20738           DFHEIV99,
 20739           DFHEIV99
 20740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20741
 20742
 20743 8720-COMP-ACCOUNTS.
 20744
 20745* EXEC CICS ENTER
 20746*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 384
* EL050.cbl
 20747*         FROM (PB-C-LAST-NAME)
 20748*    END-EXEC.
 20749     MOVE 001
 20750       TO DFHEIV11
 20751*    MOVE ':$F                   %   #00019379' TO DFHEIV0
 20752     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20754     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0,
 20756           DFHEIV11,
 20757           PB-C-LAST-NAME,
 20758           DFHEIV99,
 20759           DFHEIV99
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763
 20764* EXEC CICS ENTER
 20765*         TRACEID (002)
 20766*         FROM (CM-INSURED-LAST-NAME)
 20767*    END-EXEC.
 20768     MOVE 002
 20769       TO DFHEIV11
 20770*    MOVE ':$F                   %   #00019384' TO DFHEIV0
 20771     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20772     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20773     MOVE X'2020233030303139333834' TO DFHEIV0(25:11)
 20774     CALL 'kxdfhei1' USING DFHEIV0,
 20775           DFHEIV11,
 20776           CM-INSURED-LAST-NAME,
 20777           DFHEIV99,
 20778           DFHEIV99
 20779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20780
 20781
 20782     IF PB-CERT-NO NOT = CM-CERT-NO
 20783         GO TO 8730-END-BROWSE.
 20784
 20785     IF PB-ACCOUNT = CM-ACCOUNT
 20786         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20787             MOVE ER-2799        TO WS-ERROR
 20788             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20789             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20790             GO TO 8730-END-BROWSE.
 20791
 20792     GO TO 8710-READ-NEXT.
 20793
 20794 8730-END-BROWSE.
 20795
 20796* EXEC CICS ENDBR
 20797*         DATASET    ('ELCERT5')
 20798*    END-EXEC.
 20799     MOVE 'ELCERT5' TO DFHEIV1
 20800     MOVE 0
 20801       TO DFHEIV11
 20802*    MOVE '&2                    $   #00019402' TO DFHEIV0
 20803     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20804     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 385
* EL050.cbl
 20805     MOVE X'2020233030303139343032' TO DFHEIV0(25:11)
 20806     CALL 'kxdfhei1' USING DFHEIV0,
 20807           DFHEIV1,
 20808           DFHEIV11,
 20809           DFHEIV99
 20810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20811
 20812
 20813 8740-NOT-FOUND.
 20814     GO TO 0299-CERT-NOT-FOUND.
 20815
 20816 8750-START-ELSTAT.
 20817
 20818* EXEC CICS STARTBR
 20819*       DATASET   (STAT-ID)
 20820*       RIDFLD    (ELSTAT-KEY)
 20821*       GTEQ
 20822*       RESP      (WS-RESPONSE)
 20823*    END-EXEC
 20824     MOVE 0
 20825       TO DFHEIV11
 20826*    MOVE '&,         G          &  N#00019410' TO DFHEIV0
 20827     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20828     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20829     MOVE X'204E233030303139343130' TO DFHEIV0(25:11)
 20830     CALL 'kxdfhei1' USING DFHEIV0,
 20831           STAT-ID,
 20832           ELSTAT-KEY,
 20833           DFHEIV99,
 20834           DFHEIV11,
 20835           DFHEIV99
 20836     MOVE EIBRESP  TO WS-RESPONSE
 20837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20838     IF WS-RESP-NORMAL
 20839        MOVE 'Y'                 TO STAT-MASTER-SW
 20840     ELSE
 20841        MOVE 'N'                 TO STAT-MASTER-SW
 20842     END-IF
 20843     .
 20844 8750-EXIT.
 20845     EXIT.
 20846 8752-READ-ELSTAT.
 20847
 20848* EXEC CICS READNEXT
 20849*       DATASET   (STAT-ID)
 20850*       RIDFLD    (ELSTAT-KEY)
 20851*       INTO      (STATE-FILE)
 20852*       RESP      (WS-RESPONSE)
 20853*    END-EXEC
 20854     MOVE LENGTH OF
 20855      STATE-FILE
 20856       TO DFHEIV12
 20857     MOVE 0
 20858       TO DFHEIV11
 20859*    MOVE '&.IL                  )  N#00019425' TO DFHEIV0
 20860     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20861     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20862     MOVE X'204E233030303139343235' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 386
* EL050.cbl
 20863     CALL 'kxdfhei1' USING DFHEIV0,
 20864           STAT-ID,
 20865           STATE-FILE,
 20866           DFHEIV12,
 20867           ELSTAT-KEY,
 20868           DFHEIV99,
 20869           DFHEIV11,
 20870           DFHEIV99,
 20871           DFHEIV99
 20872     MOVE EIBRESP  TO WS-RESPONSE
 20873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20874     IF WS-RESP-NORMAL
 20875        MOVE 'Y'                 TO STAT-MASTER-SW
 20876     ELSE
 20877        MOVE 'N'                 TO STAT-MASTER-SW
 20878     END-IF
 20879     .
 20880 8752-EXIT.
 20881     EXIT.
 20882 8800-GET-COMP-RATE.
 20883     MOVE +1 TO IB.
 20884     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20885         ADD +9 TO IB
 20886         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20887             ADD +9 TO IB
 20888             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20889                MOVE ZEROS       TO WS-WK-RATE
 20890                GO TO 8800-EXIT.
 20891
 20892     IF PB-I-AGE GREATER CT-AGE (1)
 20893         ADD +3 TO IB
 20894         IF PB-I-AGE GREATER CT-AGE (2)
 20895             ADD +3 TO IB
 20896             IF PB-I-AGE GREATER CT-AGE (3)
 20897                MOVE ZEROS       TO WS-WK-RATE
 20898                GO TO 8800-EXIT.
 20899
 20900     IF WS-WORK-TERM GREATER CT-TRM (1)
 20901         ADD +1 TO IB
 20902         IF WS-WORK-TERM GREATER CT-TRM (2)
 20903             ADD +1 TO IB
 20904             IF WS-WORK-TERM GREATER CT-TRM (3)
 20905                MOVE ZEROS       TO WS-WK-RATE
 20906                GO TO 8800-EXIT.
 20907
 20908     IF CT-RT (IB) NOT NUMERIC
 20909         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20910         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20911         GO TO 8800-GET-COMP-RATE.
 20912
 20913     MOVE CT-RT (IB) TO WS-WK-RATE.
 20914
 20915 8800-EXIT.
 20916     EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 387
* EL050.cbl
 20918 8900-ADDRESS-FILE.
 20919     IF ERACCT-FILE-ADDRESSED
 20920         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20921         GO TO 8900-ADDRESS-EXIT.
 20922
 20923     IF ELCNTL-FILE-ADDRESSED
 20924         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20925         GO TO 8900-ADDRESS-EXIT.
 20926
 20927     IF ERPLAN-FILE-ADDRESSED
 20928         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20929         GO TO 8900-ADDRESS-EXIT.
 20930
 20931     IF ERFORM-FILE-ADDRESSED
 20932         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20933         GO TO 8900-ADDRESS-EXIT.
 20934
 20935 8900-ADDRESS-EXIT.
 20936     EXIT.
 20937
 20938 9000-READ-CONTROL.
 20939
 20940* EXEC CICS HANDLE CONDITION
 20941*        NOTFND    (9000-NOTFND)
 20942*    END-EXEC.
 20943*    MOVE '"$I                   ! > #00019496' TO DFHEIV0
 20944     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20945     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20946     MOVE X'3E20233030303139343936' TO DFHEIV0(25:11)
 20947     CALL 'kxdfhei1' USING DFHEIV0
 20948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20949
 20950
 20951
 20952* EXEC CICS READ
 20953*        DATASET     (CNTL-ID)
 20954*        SET         (ADDRESS OF CONTROL-FILE)
 20955*        RIDFLD      (ELCNTL-KEY)
 20956*        GTEQ
 20957*    END-EXEC.
 20958*    MOVE '&"S        G          (   #00019500' TO DFHEIV0
 20959     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20960     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20961     MOVE X'2020233030303139353030' TO DFHEIV0(25:11)
 20962     CALL 'kxdfhei1' USING DFHEIV0,
 20963           CNTL-ID,
 20964           DFHEIV20,
 20965           DFHEIV99,
 20966           ELCNTL-KEY,
 20967           DFHEIV99,
 20968           DFHEIV99,
 20969           DFHEIV99
 20970     SET ADDRESS OF CONTROL-FILE TO
 20971         DFHEIV20
 20972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20973
 20974
 20975     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 388
* EL050.cbl
 20976
 20977 9000-NOTFND.
 20978     IF RC-SW-1 = '1'
 20979        MOVE ER-2616              TO WS-ERROR
 20980        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20981        GO TO 9000-EXIT.
 20982
 20983     IF RC-SW-1 = '2'
 20984        MOVE ER-2602              TO WS-ERROR
 20985        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20986
 20987 9000-EXIT.
 20988      EXIT.
 20989
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 389
* EL050.cbl
 20991 9100-READ-CONTROL.
 20992
 20993* EXEC CICS HANDLE CONDITION
 20994*        NOTFND  (9100-NOTFND)
 20995*        ENDFILE (9100-NOTFND)
 20996*    END-EXEC.
 20997*    MOVE '"$I''                  ! ? #00019524' TO DFHEIV0
 20998     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21000     MOVE X'3F20233030303139353234' TO DFHEIV0(25:11)
 21001     CALL 'kxdfhei1' USING DFHEIV0
 21002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21003
 21004
 21005
 21006* EXEC CICS READ
 21007*        DATASET     (CNTL-ID)
 21008*        INTO        (CONTROL-FILE)
 21009*        RIDFLD      (ELCNTL-KEY)
 21010*        GTEQ
 21011*    END-EXEC.
 21012     MOVE LENGTH OF
 21013      CONTROL-FILE
 21014       TO DFHEIV11
 21015*    MOVE '&"IL       G          (   #00019529' TO DFHEIV0
 21016     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21017     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21018     MOVE X'2020233030303139353239' TO DFHEIV0(25:11)
 21019     CALL 'kxdfhei1' USING DFHEIV0,
 21020           CNTL-ID,
 21021           CONTROL-FILE,
 21022           DFHEIV11,
 21023           ELCNTL-KEY,
 21024           DFHEIV99,
 21025           DFHEIV99,
 21026           DFHEIV99
 21027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21028
 21029
 21030     GO TO 9100-EXIT.
 21031
 21032 9100-NOTFND.
 21033     IF RC-SW-2 = '0'
 21034        MOVE '1'                  TO STATE-RECORD-ERROR
 21035        GO TO 9100-EXIT
 21036     END-IF
 21037     IF RC-SW-2 = '1'
 21038        MOVE '1'                  TO LF-BENEFIT-ERROR
 21039        MOVE ER-2604              TO WS-ERROR
 21040        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21041        GO TO 9100-EXIT.
 21042
 21043     IF RC-SW-2 = '2'
 21044        MOVE '1'                  TO AH-BENEFIT-ERROR
 21045        MOVE ER-2605              TO WS-ERROR
 21046        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21047        GO TO 9100-EXIT.
 21048
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 390
* EL050.cbl
 21049     IF RC-SW-2 = '3'
 21050         MOVE ER-2603           TO WS-ERROR
 21051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21052         GO TO 9100-EXIT.
 21053
 21054     IF RC-SW-2 = '4'
 21055         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21056         GO TO 9100-EXIT.
 21057
 21058     IF RC-SW-2 = '5'
 21059         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21060         IF WS-AH-INPUT-CD-1 = SPACE
 21061             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21062         ELSE
 21063             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21064
 21065 9100-EXIT.
 21066      EXIT.
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 391
* EL050.cbl
 21068 9200-CONTROL-GETMAIN.
 21069
 21070* EXEC CICS GETMAIN
 21071*         LENGTH   (750)
 21072*         SET      (ADDRESS OF CONTROL-FILE)
 21073*    END-EXEC.
 21074     MOVE 750
 21075       TO DFHEIV11
 21076*    MOVE '," L                  $   #00019575' TO DFHEIV0
 21077     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21078     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21079     MOVE X'2020233030303139353735' TO DFHEIV0(25:11)
 21080     CALL 'kxdfhei1' USING DFHEIV0,
 21081           DFHEIV20,
 21082           DFHEIV11,
 21083           DFHEIV99
 21084     SET ADDRESS OF CONTROL-FILE TO
 21085         DFHEIV20
 21086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21087
 21088
 21089     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21090
 21091 9200-EXIT.
 21092     EXIT.
 21093
 21094 9250-UNLOCK-RETURN.
 21095
 21096* EXEC CICS UNLOCK
 21097*        DATASET   (CERT-ID)
 21098*    END-EXEC.
 21099*    MOVE '&*                    #   #00019586' TO DFHEIV0
 21100     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21101     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21102     MOVE X'2020233030303139353836' TO DFHEIV0(25:11)
 21103     CALL 'kxdfhei1' USING DFHEIV0,
 21104           CERT-ID,
 21105           DFHEIV99
 21106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21107
 21108
 21109 9300-ABEND.
 21110     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21111
 21112
 21113* EXEC CICS LINK
 21114*        PROGRAM   ('EL004')
 21115*        COMMAREA  (WS-ERROR-LINE)
 21116*        LENGTH    (72)
 21117*    END-EXEC.
 21118     MOVE 'EL004' TO DFHEIV1
 21119     MOVE 72
 21120       TO DFHEIV11
 21121*    MOVE '."C                   (   #00019593' TO DFHEIV0
 21122     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21123     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21124     MOVE X'2020233030303139353933' TO DFHEIV0(25:11)
 21125     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 392
* EL050.cbl
 21126           DFHEIV1,
 21127           WS-ERROR-LINE,
 21128           DFHEIV11,
 21129           DFHEIV99,
 21130           DFHEIV99,
 21131           DFHEIV99,
 21132           DFHEIV99
 21133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21134
 21135
 21136     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21137
 21138
 21139* EXEC CICS ABEND
 21140*        ABCODE ('EL50')
 21141*    END-EXEC.
 21142     MOVE 'EL50' TO DFHEIV5
 21143*    MOVE '.,A                   "   #00019601' TO DFHEIV0
 21144     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21145     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21146     MOVE X'2020233030303139363031' TO DFHEIV0(25:11)
 21147     CALL 'kxdfhei1' USING DFHEIV0,
 21148           DFHEIV5
 21149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21150
 21151
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 393
* EL050.cbl
 21153
 21154******************************************************************
 21155*                                                                *
 21156*            E R R O R   F O R M A T   R O U T I N E             *
 21157*                                                                *
 21158******************************************************************
 21159
 21160 9900-ERROR-FORMAT.
 21161
 21162     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21163                    PB-COMMON-ERROR (2) OR
 21164                    PB-COMMON-ERROR (3) OR
 21165                    PB-COMMON-ERROR (4) OR
 21166                    PB-COMMON-ERROR (5) OR
 21167                    PB-COMMON-ERROR (6) OR
 21168                    PB-COMMON-ERROR (7) OR
 21169                    PB-COMMON-ERROR (8) OR
 21170                    PB-COMMON-ERROR (9) OR
 21171                    PB-COMMON-ERROR (10)
 21172        GO TO 9900-EXIT.
 21173
 21174     IF PB-NO-OF-ERRORS = +10
 21175        GO TO 9900-EXIT.
 21176
 21177     ADD +1  TO PB-NO-OF-ERRORS.
 21178     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21179                                       (PB-NO-OF-ERRORS).
 21180 9900-EXIT.
 21181     EXIT.
 21182
 21183 9990-RETURN.
 21184     IF BROWSE-STARTED
 21185
 21186* EXEC CICS ENDBR
 21187*            DATASET  (ACCT-ID)
 21188*       END-EXEC.
 21189     MOVE 0
 21190       TO DFHEIV11
 21191*    MOVE '&2                    $   #00019638' TO DFHEIV0
 21192     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21193     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21194     MOVE X'2020233030303139363338' TO DFHEIV0(25:11)
 21195     CALL 'kxdfhei1' USING DFHEIV0,
 21196           ACCT-ID,
 21197           DFHEIV11,
 21198           DFHEIV99
 21199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21200
 21201
 21202 9990-EXIT.
 21203     EXIT.
 21204
 21205
 21206****Check for CRTO record, add one if not found.
 21207 9991-CHECK-FOR-ELCRTO.
 21208
 21209* EXEC CICS HANDLE CONDITION
 21210*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 394
* EL050.cbl
 21211*         ENDFILE (9991-CRTO-NOT-FOUND)
 21212*     END-EXEC.
 21213*    MOVE '"$I''                  ! @ #00019648' TO DFHEIV0
 21214     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21216     MOVE X'4020233030303139363438' TO DFHEIV0(25:11)
 21217     CALL 'kxdfhei1' USING DFHEIV0
 21218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21219
 21220     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21221     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21222     MOVE +0                     TO ELCRTO-SEQ-NO
 21223
 21224
 21225* EXEC CICS READ
 21226*       DATASET   ('ELCRTO')
 21227*       INTO      (ORIGINAL-CERTIFICATE)
 21228*       RIDFLD    (ELCRTO-KEY)
 21229*       GTEQ
 21230*       RESP      (WS-RESPONSE)
 21231*    END-EXEC
 21232     MOVE LENGTH OF
 21233      ORIGINAL-CERTIFICATE
 21234       TO DFHEIV11
 21235     MOVE 'ELCRTO' TO DFHEIV1
 21236*    MOVE '&"IL       G          (  N#00019656' TO DFHEIV0
 21237     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21239     MOVE X'204E233030303139363536' TO DFHEIV0(25:11)
 21240     CALL 'kxdfhei1' USING DFHEIV0,
 21241           DFHEIV1,
 21242           ORIGINAL-CERTIFICATE,
 21243           DFHEIV11,
 21244           ELCRTO-KEY,
 21245           DFHEIV99,
 21246           DFHEIV99,
 21247           DFHEIV99
 21248     MOVE EIBRESP  TO WS-RESPONSE
 21249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21250
 21251     IF WS-RESP-NORMAL
 21252        AND (OC-CONTROL-PRIMARY (1:33) =
 21253                 PB-CONTROL-BY-ACCOUNT (1:33))
 21254        AND (OC-RECORD-TYPE =  'I')
 21255           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21256               GO TO 9991-CHECK-INDICATORS
 21257           ELSE
 21258               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21259               GO TO 9991-CRTO-ADD-REC
 21260           END-IF
 21261     END-IF.
 21262
 21263 9991-CRTO-NOT-FOUND.
 21264
 21265     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21266     MOVE 'OC'                TO OC-RECORD-ID
 21267     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21268                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 395
* EL050.cbl
 21269     MOVE +4096               TO OC-KEY-SEQ-NO.
 21270
 21271 9991-CRTO-ADD-REC.
 21272
 21273     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21274     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21275     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21276     MOVE 'I'                 TO OC-RECORD-TYPE
 21277     IF PB-ISSUE
 21278         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21279         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21280         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21281         MOVE PB-I-AGE               TO OC-INS-AGE
 21282         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21283         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21284         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21285         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21286         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21287         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21288         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21289         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21290         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21291         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21292         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21293         IF PB-I-JOINT-COMMISSION > +0
 21294             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21295         ELSE
 21296             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21297         END-IF
 21298         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21299         MOVE +0                     TO OC-LF-CANCEL-AMT
 21300                                        OC-LF-ITD-CANCEL-AMT
 21301         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21302         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21303         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21304         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21305         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21306         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21307         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21308         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21309         MOVE +0                     TO OC-AH-CANCEL-AMT
 21310                                        OC-AH-ITD-CANCEL-AMT
 21311         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21312         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21313         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21314     ELSE
 21315         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21316         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21317         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21318         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21319         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21320         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21321         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21322         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21323         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21324          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21325             MOVE SPACES             TO OC-LF-BENCD
 21326             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 396
* EL050.cbl
 21327                                        OC-LF-BEN-AMT
 21328                                        OC-LF-PRM-AMT
 21329                                        OC-LF-ALT-BEN-AMT
 21330                                        OC-LF-ALT-PRM-AMT
 21331                                        OC-LF-COMM-PCT
 21332                                        OC-LF-CANCEL-AMT
 21333             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21334             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21335         ELSE
 21336             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21337             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21338             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21339             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21340             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21341             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21342             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21343             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21344             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21345             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21346         END-IF
 21347         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21348         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21349          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21350             MOVE SPACES             TO OC-AH-BENCD
 21351             MOVE ZEROS              TO OC-AH-TERM
 21352                                        OC-AH-BEN-AMT
 21353                                        OC-AH-PRM-AMT
 21354                                        OC-AH-COMM-PCT
 21355                                        OC-AH-CANCEL-AMT
 21356                                        OC-AH-CP
 21357             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21358             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21359         ELSE
 21360             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21361             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21362             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21363             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21364             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21365             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21366             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21367             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21368             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21369         END-IF
 21370         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21371         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21372         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21373         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21374     END-IF
 21375     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21376
 21377     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21378
 21379
 21380* EXEC CICS READ
 21381*         DATASET   (FILE-ERMAIL)
 21382*         RIDFLD    (MA-CONTROL-PRIMARY)
 21383*         INTO      (MAILING-DATA)
 21384*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 397
* EL050.cbl
 21385*    END-EXEC
 21386     MOVE LENGTH OF
 21387      MAILING-DATA
 21388       TO DFHEIV11
 21389*    MOVE '&"IL       E          (  N#00019792' TO DFHEIV0
 21390     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21391     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21392     MOVE X'204E233030303139373932' TO DFHEIV0(25:11)
 21393     CALL 'kxdfhei1' USING DFHEIV0,
 21394           FILE-ERMAIL,
 21395           MAILING-DATA,
 21396           DFHEIV11,
 21397           MA-CONTROL-PRIMARY,
 21398           DFHEIV99,
 21399           DFHEIV99,
 21400           DFHEIV99
 21401     MOVE EIBRESP  TO WS-RESPONSE
 21402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21403
 21404     IF WS-RESP-NORMAL
 21405         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21406     END-IF.
 21407
 21408     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21409     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21410
 21411
 21412* EXEC CICS READ
 21413*         DATASET  (CRTT-ID)
 21414*         RIDFLD   (WS-ELCRTT-KEY)
 21415*         INTO     (CERTIFICATE-TRAILERS)
 21416*         RESP     (WS-RESPONSE)
 21417*    END-EXEC
 21418     MOVE LENGTH OF
 21419      CERTIFICATE-TRAILERS
 21420       TO DFHEIV11
 21421*    MOVE '&"IL       E          (  N#00019806' TO DFHEIV0
 21422     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21423     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21424     MOVE X'204E233030303139383036' TO DFHEIV0(25:11)
 21425     CALL 'kxdfhei1' USING DFHEIV0,
 21426           CRTT-ID,
 21427           CERTIFICATE-TRAILERS,
 21428           DFHEIV11,
 21429           WS-ELCRTT-KEY,
 21430           DFHEIV99,
 21431           DFHEIV99,
 21432           DFHEIV99
 21433     MOVE EIBRESP  TO WS-RESPONSE
 21434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21435
 21436     IF WS-RESP-NORMAL
 21437         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21438         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21439     END-IF.
 21440
 21441
 21442* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 398
* EL050.cbl
 21443*       DATASET   ('ELCRTO')
 21444*       FROM      (ORIGINAL-CERTIFICATE)
 21445*       RIDFLD    (OC-CONTROL-PRIMARY)
 21446*       RESP      (WS-RESPONSE)
 21447*    END-EXEC.
 21448     MOVE LENGTH OF
 21449      ORIGINAL-CERTIFICATE
 21450       TO DFHEIV11
 21451     MOVE 'ELCRTO' TO DFHEIV1
 21452*    MOVE '&$ L                  ''  N#00019818' TO DFHEIV0
 21453     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21454     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21455     MOVE X'204E233030303139383138' TO DFHEIV0(25:11)
 21456     CALL 'kxdfhei1' USING DFHEIV0,
 21457           DFHEIV1,
 21458           ORIGINAL-CERTIFICATE,
 21459           DFHEIV11,
 21460           OC-CONTROL-PRIMARY,
 21461           DFHEIV99,
 21462           DFHEIV99
 21463     MOVE EIBRESP  TO WS-RESPONSE
 21464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21465
 21466
 21467     GO TO 9991-EXIT.
 21468
 21469 9991-CHECK-INDICATORS.
 21470
 21471     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21472         GO TO 9991-EXIT
 21473     END-IF.
 21474
 21475     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21476         GO TO 9991-EXIT
 21477     END-IF.
 21478
 21479
 21480* EXEC CICS READ
 21481*       DATASET   ('ELCRTO')
 21482*       INTO      (ORIGINAL-CERTIFICATE)
 21483*       RIDFLD    (OC-CONTROL-PRIMARY)
 21484*       UPDATE
 21485*       RESP      (WS-RESPONSE)
 21486*    END-EXEC
 21487     MOVE LENGTH OF
 21488      ORIGINAL-CERTIFICATE
 21489       TO DFHEIV11
 21490     MOVE 'ELCRTO' TO DFHEIV1
 21491*    MOVE '&"IL       EU         (  N#00019837' TO DFHEIV0
 21492     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21493     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21494     MOVE X'204E233030303139383337' TO DFHEIV0(25:11)
 21495     CALL 'kxdfhei1' USING DFHEIV0,
 21496           DFHEIV1,
 21497           ORIGINAL-CERTIFICATE,
 21498           DFHEIV11,
 21499           OC-CONTROL-PRIMARY,
 21500           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 399
* EL050.cbl
 21501           DFHEIV99,
 21502           DFHEIV99
 21503     MOVE EIBRESP  TO WS-RESPONSE
 21504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21505     IF WS-RESP-NORMAL
 21506        IF PB-ISSUE
 21507          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21508          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21509          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21510          MOVE PB-I-AGE               TO OC-INS-AGE
 21511          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21512          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21513          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21514          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21515          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21516          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21517          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21518          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21519          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21520          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21521          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21522          IF PB-I-JOINT-COMMISSION > +0
 21523              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21524          ELSE
 21525              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21526          END-IF
 21527          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21528          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21529          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21530          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21531          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21532          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21533          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21534          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21535          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21536
 21537          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21538
 21539* EXEC CICS READ
 21540*             DATASET   (FILE-ERMAIL)
 21541*             RIDFLD    (MA-CONTROL-PRIMARY)
 21542*             INTO      (MAILING-DATA)
 21543*             RESP      (WS-RESPONSE)
 21544*         END-EXEC
 21545     MOVE LENGTH OF
 21546      MAILING-DATA
 21547       TO DFHEIV11
 21548*    MOVE '&"IL       E          (  N#00019877' TO DFHEIV0
 21549     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21550     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21551     MOVE X'204E233030303139383737' TO DFHEIV0(25:11)
 21552     CALL 'kxdfhei1' USING DFHEIV0,
 21553           FILE-ERMAIL,
 21554           MAILING-DATA,
 21555           DFHEIV11,
 21556           MA-CONTROL-PRIMARY,
 21557           DFHEIV99,
 21558           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 400
* EL050.cbl
 21559           DFHEIV99
 21560     MOVE EIBRESP  TO WS-RESPONSE
 21561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21562          IF WS-RESP-NORMAL
 21563             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21564          END-IF
 21565
 21566          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21567          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21568
 21569* EXEC CICS READ
 21570*             DATASET  (CRTT-ID)
 21571*             RIDFLD   (WS-ELCRTT-KEY)
 21572*             INTO     (CERTIFICATE-TRAILERS)
 21573*             RESP     (WS-RESPONSE)
 21574*         END-EXEC
 21575     MOVE LENGTH OF
 21576      CERTIFICATE-TRAILERS
 21577       TO DFHEIV11
 21578*    MOVE '&"IL       E          (  N#00019889' TO DFHEIV0
 21579     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21580     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21581     MOVE X'204E233030303139383839' TO DFHEIV0(25:11)
 21582     CALL 'kxdfhei1' USING DFHEIV0,
 21583           CRTT-ID,
 21584           CERTIFICATE-TRAILERS,
 21585           DFHEIV11,
 21586           WS-ELCRTT-KEY,
 21587           DFHEIV99,
 21588           DFHEIV99,
 21589           DFHEIV99
 21590     MOVE EIBRESP  TO WS-RESPONSE
 21591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21592          IF WS-RESP-NORMAL
 21593             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21594                               OC-INS-AGE-DEFAULT-FLAG
 21595             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21596                               OC-JNT-AGE-DEFAULT-FLAG
 21597          END-IF
 21598
 21599        ELSE
 21600          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21601             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21602             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21603             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21604          END-IF
 21605          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21606             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21607             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21608             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21609          END-IF
 21610          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21611        END-IF
 21612
 21613* EXEC CICS REWRITE
 21614*          DATASET   ('ELCRTO')
 21615*          FROM      (ORIGINAL-CERTIFICATE)
 21616*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 401
* EL050.cbl
 21617*       END-EXEC
 21618     MOVE LENGTH OF
 21619      ORIGINAL-CERTIFICATE
 21620       TO DFHEIV11
 21621     MOVE 'ELCRTO' TO DFHEIV1
 21622*    MOVE '&& L                  %  N#00019915' TO DFHEIV0
 21623     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21624     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21625     MOVE X'204E233030303139393135' TO DFHEIV0(25:11)
 21626     CALL 'kxdfhei1' USING DFHEIV0,
 21627           DFHEIV1,
 21628           ORIGINAL-CERTIFICATE,
 21629           DFHEIV11,
 21630           DFHEIV99
 21631     MOVE EIBRESP  TO WS-RESPONSE
 21632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21633     END-IF.
 21634
 21635 9991-EXIT.
 21636     EXIT.
 21637
 21638
 21639 9999-RETURN.
 21640     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21641
 21642
 21643* EXEC CICS RETURN
 21644*    END-EXEC.
 21645*    MOVE '.(                    ''   #00019929' TO DFHEIV0
 21646     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21647     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21648     MOVE X'2020233030303139393239' TO DFHEIV0(25:11)
 21649     CALL 'kxdfhei1' USING DFHEIV0,
 21650           DFHEIV99,
 21651           DFHEIV99,
 21652           DFHEIV99,
 21653           DFHEIV99,
 21654           DFHEIV99,
 21655           DFHEIV99
 21656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21657
 21658
 21659
 21660* GOBACK.
 21661     MOVE '9%                    "   ' TO DFHEIV0
 21662     MOVE 'EL050' TO DFHEIV1
 21663     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21664     GOBACK.
 21665
 21666 9999-DFHBACK SECTION.
 21667     MOVE '9%                    "   ' TO DFHEIV0
 21668     MOVE 'EL050' TO DFHEIV1
 21669     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21670     GOBACK.
 21671 9999-DFHEXIT.
 21672     IF DFHEIGDJ EQUAL 0001
 21673         NEXT SENTENCE
 21674     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 402
* EL050.cbl
 21675         GO TO 9300-ABEND,
 21676               3990-FILES-NOT-OPEN
 21677         DEPENDING ON DFHEIGDI
 21678     ELSE IF DFHEIGDJ EQUAL 3
 21679         GO TO 6610-START-BROWSE,
 21680               6630-ERRESS-PROBLEM,
 21681               6630-END-OF-FILE
 21682         DEPENDING ON DFHEIGDI
 21683     ELSE IF DFHEIGDJ EQUAL 4
 21684         GO TO 6630-END-OF-FILE,
 21685               6630-ERRESS-PROBLEM,
 21686               6630-ERRESS-PROBLEM,
 21687               6630-END-OF-FILE
 21688         DEPENDING ON DFHEIGDI
 21689     ELSE IF DFHEIGDJ EQUAL 5
 21690         GO TO 6630-END-OF-FILE,
 21691               6630-END-OF-FILE,
 21692               6630-ERRESS-PROBLEM,
 21693               6630-ERRESS-PROBLEM
 21694         DEPENDING ON DFHEIGDI
 21695     ELSE IF DFHEIGDJ EQUAL 6
 21696         GO TO 6660-START-BROWSE,
 21697               6690-ERRESC-PROBLEM,
 21698               6690-ERRESC-PROBLEM,
 21699               6690-END-OF-FILE
 21700         DEPENDING ON DFHEIGDI
 21701     ELSE IF DFHEIGDJ EQUAL 7
 21702         GO TO 6690-END-OF-FILE,
 21703               6690-ERRESC-PROBLEM,
 21704               6690-ERRESC-PROBLEM,
 21705               6690-END-OF-FILE
 21706         DEPENDING ON DFHEIGDI
 21707     ELSE IF DFHEIGDJ EQUAL 8
 21708         GO TO 6690-END-OF-FILE,
 21709               6690-ERRESC-PROBLEM,
 21710               6690-ERRESC-PROBLEM,
 21711               6690-END-OF-FILE
 21712         DEPENDING ON DFHEIGDI
 21713     ELSE IF DFHEIGDJ EQUAL 9
 21714         GO TO 7250-CONTINUE,
 21715               7250-CONTINUE
 21716         DEPENDING ON DFHEIGDI
 21717     ELSE IF DFHEIGDJ EQUAL 10
 21718         GO TO 7300-CONTINUE,
 21719               7300-CONTINUE
 21720         DEPENDING ON DFHEIGDI
 21721     ELSE IF DFHEIGDJ EQUAL 11
 21722         GO TO 8000-FREE-MAIN
 21723         DEPENDING ON DFHEIGDI
 21724     ELSE IF DFHEIGDJ EQUAL 12
 21725         GO TO 8100-NOTFND,
 21726               8100-NOTFND
 21727         DEPENDING ON DFHEIGDI
 21728     ELSE IF DFHEIGDJ EQUAL 13
 21729         GO TO 8110-NOTFND,
 21730               8110-NOTFND
 21731         DEPENDING ON DFHEIGDI
 21732     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 403
* EL050.cbl
 21733         GO TO 8130-EXIT
 21734         DEPENDING ON DFHEIGDI
 21735     ELSE IF DFHEIGDJ EQUAL 15
 21736         GO TO 8180-NOTFND
 21737         DEPENDING ON DFHEIGDI
 21738     ELSE IF DFHEIGDJ EQUAL 16
 21739         GO TO 8190-NOTFND
 21740         DEPENDING ON DFHEIGDI
 21741     ELSE IF DFHEIGDJ EQUAL 17
 21742         GO TO 8195-NOTFND
 21743         DEPENDING ON DFHEIGDI
 21744     ELSE IF DFHEIGDJ EQUAL 18
 21745         GO TO 8200-NOTFND
 21746         DEPENDING ON DFHEIGDI
 21747     ELSE IF DFHEIGDJ EQUAL 19
 21748         GO TO 8300-NOTFND,
 21749               8300-ERRESS-PROBLEM,
 21750               8300-ERRESS-PROBLEM,
 21751               8300-NOTFND
 21752         DEPENDING ON DFHEIGDI
 21753     ELSE IF DFHEIGDJ EQUAL 20
 21754         GO TO 8450-FORM-NOT-FOUND,
 21755               8450-FORM-NOT-FOUND
 21756         DEPENDING ON DFHEIGDI
 21757     ELSE IF DFHEIGDJ EQUAL 21
 21758         GO TO 0199-ACCT-NOT-FOUND,
 21759               0199-ACCT-NOT-FOUND
 21760         DEPENDING ON DFHEIGDI
 21761     ELSE IF DFHEIGDJ EQUAL 22
 21762         GO TO 0199-ACCT-NOT-FOUND,
 21763               0199-ACCT-NOT-FOUND
 21764         DEPENDING ON DFHEIGDI
 21765     ELSE IF DFHEIGDJ EQUAL 23
 21766         GO TO 8582-COMP-NOT-FOUND,
 21767               8582-COMP-NOT-FOUND
 21768         DEPENDING ON DFHEIGDI
 21769     ELSE IF DFHEIGDJ EQUAL 24
 21770         GO TO 8583-AGTC-NOT-FOUND,
 21771               8583-AGTC-NOT-FOUND
 21772         DEPENDING ON DFHEIGDI
 21773     ELSE IF DFHEIGDJ EQUAL 25
 21774         GO TO 8584-BXRF-NOT-FOUND,
 21775               8584-BXRF-NOT-FOUND
 21776         DEPENDING ON DFHEIGDI
 21777     ELSE IF DFHEIGDJ EQUAL 26
 21778         GO TO 8585-PLAN-NOT-FOUND,
 21779               8585-PLAN-NOT-FOUND
 21780         DEPENDING ON DFHEIGDI
 21781     ELSE IF DFHEIGDJ EQUAL 27
 21782         GO TO 0299-CERT-NOT-FOUND
 21783         DEPENDING ON DFHEIGDI
 21784     ELSE IF DFHEIGDJ EQUAL 28
 21785         GO TO 8700-READ-CERT-MASTER
 21786         DEPENDING ON DFHEIGDI
 21787     ELSE IF DFHEIGDJ EQUAL 29
 21788         GO TO 8720-COMP-ACCOUNTS,
 21789               8730-END-BROWSE,
 21790               8740-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 15-Nov-13 10:56 Page 404
* EL050.cbl
 21791         DEPENDING ON DFHEIGDI
 21792     ELSE IF DFHEIGDJ EQUAL 30
 21793         GO TO 9000-NOTFND
 21794         DEPENDING ON DFHEIGDI
 21795     ELSE IF DFHEIGDJ EQUAL 31
 21796         GO TO 9100-NOTFND,
 21797               9100-NOTFND
 21798         DEPENDING ON DFHEIGDI
 21799     ELSE IF DFHEIGDJ EQUAL 32
 21800         GO TO 9991-CRTO-NOT-FOUND,
 21801               9991-CRTO-NOT-FOUND
 21802         DEPENDING ON DFHEIGDI.
 21803     MOVE '9%                    "   ' TO DFHEIV0
 21804     MOVE 'EL050' TO DFHEIV1
 21805     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21806     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39992     Code:       87775
