* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55* 013017  CR2016053100001  PEMA  ACH PROCESSING
    56* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
    57* 020218  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    58* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
    59* 092618  CR2018050200001  PEMA  Add check for open clm on issue
    60* 101019  CR2019100700001  PEMA  Disallow V status with claim
    61******************************************************************
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   3
* EL050.cbl
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER   PIC X(32) VALUE '********************************'.
    70 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    71 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    72
    73 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    74 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    75                                   USAGE POINTER.
    76 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    77 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    79                                   USAGE IS POINTER.
    80 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    82                                   USAGE IS POINTER.
    83 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    84 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    85                                   USAGE IS POINTER.
    86
    87 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    88 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    89                                   USAGE IS POINTER.
    90
    91*    COPY ELC50WS.
    92*****************************************************************
    93*                                                               *
    94*                            ELC50WS.                           *
    95*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    96*                            VMOD=2.061.                        *
    97*                                                               *
    98*   THIS IS THE WORKING STORAGE FOR EL050                       *
    99*                                   EL517                       *
   100*****************************************************************
   101******************************************************************
   102*                   C H A N G E   L O G
   103*
   104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   105*-----------------------------------------------------------------
   106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   107* EFFECTIVE    NUMBER
   108*-----------------------------------------------------------------
   109* 123102                   PEMA  ADD DCC PROCESSING
   110* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   111* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   112* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   113* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   114* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   115* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   116* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   117* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   118* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   119* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   120* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   121* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   122* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   123* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   4
* EL050.cbl
   124* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   125* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   126* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   127* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   128* 030309  CR2009021700001  PEMA  ADD ER-2883
   129* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   130* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   132* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   133* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   134* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   135* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   136* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   137* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   138* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   139* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   140* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   141* 061412  CR2011022800001  AJRA  NAPERSOFT
   142* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   143* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   144* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   145* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   146* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   147* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   148* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   149* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   150* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   151* 091114  IR2014091000001  TANA  ADD ERROR 2898
   152* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   153* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   154* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
   155* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
   156* 100617  CR2017062000003  PEMA  Inforce state comm cap
   157* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
   158* 062017  CR2015091000001  PEMA  ADD ST INT RATE FIELD
   159* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   160* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
   161* 100518  CR2017061500001  TANA  ADD NEW ERROR MSGS
   162* 092618  CR2018050200001  PEMA  Add check for open clm on issue
   163* 101019  CR2019100700001  PEMA  Add error 3281 V stat on claim
   164*-----------------------------------------------------------------
   165
   166 01  WORK-AREAS.
   167
   168*****************************************************************
   169*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   170*****************************************************************
   171
   172     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   173     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   174     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   175     12  WS-NAME-EDIT-WORK-AREA.
   176         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   177         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   178             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   179         16  WS-WORK-NAME.
   180             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   181             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   5
* EL050.cbl
   182             20  FILLER           PIC X(10)     VALUE SPACES.
   183         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   184             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   185
   186*****************************************************************
   187*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   188*****************************************************************
   189
   190     12  WS-ERRESC-KEY.
   191         16 WS-ERRESC-SEARCH-KEY.
   192             20  WS-ERRESC-COMPANY-CD PIC  X.
   193             20  WS-ERRESC-CARRIER    PIC  X.
   194             20  WS-ERRESC-GROUP      PIC X(6).
   195             20  WS-ERRESC-STATE      PIC XX.
   196             20  WS-ERRESC-ACCOUNT    PIC X(10).
   197         16 WS-ERRESC-RESIDUAL-KEY.
   198             20  WS-ERRESC-AGENT      PIC X(10).
   199             20  WS-ERRESC-RES-STATE  PIC XX.
   200             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   201*                                          YYYYMMDD
   202     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   203     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   204
   205*RESIDENT STATE TAX MASTER(ERRESS)
   206*
   207     12  WS-ERRESS-KEY.
   208         16  WS-ERRESS-COMPANY-CD      PIC  X.
   209         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   210         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   211         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   212*                                          YYYYMMDD
   213
   214     12  WS-CONTRACT-DATE              PIC 9(8).
   215*                                          YYYYMMDD
   216     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   217     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   218         16 WS-YEAR-YY                 PIC   9999.
   219         16 FILLER                     PIC 9(4).
   220*                                          YYYYMMDD
   221     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   222     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   223     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   224     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   225
   226     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   227         88  DPRB-1ST-TIME                      VALUE ' '.
   228
   229*****************************************************************
   230*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   231*****************************************************************
   232
   233     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   234     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   235     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   236     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   237     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   238     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   239     12  ws-st-refund-int-rate   pic s9v9(4) comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   6
* EL050.cbl
   240     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   241     12  ws-st-agent-sig-edit    pic x          value spaces.
   242     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   243     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   244     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   245     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   246         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   247         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   248     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   249         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   250         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   251     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   252
   253     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   254     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   255
   256     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   257     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   264     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   265     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   266     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   270     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   271     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   272     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   273     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   274     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   275     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   276     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   277     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   278     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   279     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   280     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   281     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   282     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   283     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   284     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   285     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   286     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   287     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   288     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   289     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   290     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   291     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   292     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   293     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   294     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   295     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   296     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   297     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   7
* EL050.cbl
   298     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   299     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   300     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   301     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   302     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   303     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   304     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   305     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   306     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   307     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   308     12  WS-2671-SW               PIC X         VALUE SPACE.
   309     12  WS-2672-SW               PIC X         VALUE SPACE.
   310     12  ws-9813-sw               pic x         value spaces.
   311     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   312         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   313     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   314         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   315     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   316
   317     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   318         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   319         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   320         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   321         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   322
   323     12  WS-CREDIT-EDIT-CONTROLS.
   324         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   325         16  WS-MIN-AGE           PIC 99                VALUE  0.
   326         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   327         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   328         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   329         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   330
   331     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   332     12  WS-AGE-FIELDS.
   333         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   334         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   335         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   336         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   337
   338     12  WS-SAVE-ALLOWABLE-BENEFIT.
   339         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   340         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   341         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   342         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   343         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   344         16  FILLER                      PIC XX.
   345
   346     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   347     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   348     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   349     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   350     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   351     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   352     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   353     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   354     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   355     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   8
* EL050.cbl
   356
   357     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   358     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   359     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   360     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   361     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   362     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   363     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   364     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   365         88  WS-REDUCING              VALUE 'R'.
   366         88  WS-LEVEL                 VALUE 'L' 'P'.
   367     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   368
   369     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   370     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   371     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   372     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   373     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   374     12  ws-ah-max-bens           pic 99        value zeros.
   375     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   376     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   377     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   378     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   379
   380     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   381     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   382     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   383     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   384     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   385     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   386     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   387     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   388     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   389     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   390     12  WS-ACCT-SIG-SW.
   391         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   392         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   393     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   394     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   395     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   396     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   397     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   398     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   399     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   400     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   401     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   402     12  WS-INITIALS.
   403         16  WS-INIT-1            PIC X         VALUE SPACES.
   404         16  WS-INIT-2            PIC X         VALUE SPACES.
   405
   406     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   407     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   408     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   409     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   410     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   411*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   412     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   413     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page   9
* EL050.cbl
   414     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   415     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   416     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   417     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   418     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   419     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   420     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   421     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   422     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   423     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   424     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   425     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   426     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   427     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   428     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   429     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   430     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   431     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   432     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   433     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   434******** FLA
   435     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   436     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   437     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   438     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   439     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   440********
   441     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   442     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   443     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   444     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   445     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   446     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   447     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   448     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   449     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   450     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   451
   452     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   453         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   454                                         '0' THRU '9'.
   455
   456     12  NUMBER-OF-MONTHS.
   457         16  SK-MO OCCURS 12 TIMES PIC X.
   458
   459     12  WS-WORK-DATE.
   460         16  WS-YEAR            PIC 99    VALUE 00.
   461         16  WS-MONTH           PIC 99    VALUE 00.
   462         16  WS-DAY             PIC 99    VALUE 00.
   463
   464     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   465     12  WS-WORK-CRIT-DEV       REDEFINES
   466         WS-WORK-LF-CRIT-PER    PIC X(03).
   467
   468     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   469     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   470
   471     12  WS-WORK-DATE-FROM.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  10
* EL050.cbl
   472         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   473         16  FILLER             PIC X  VALUE SPACE.
   474         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   475         16  FILLER             PIC X         VALUE SPACE.
   476         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   477
   478     12  WS-WORK-DATE-THRU.
   479         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   480         16  FILLER             PIC X         VALUE SPACE.
   481         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   482         16  FILLER             PIC X         VALUE SPACE.
   483         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   484
   485     12  WS-LF-INPUT-CD.
   486         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   487         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   488
   489     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   490     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   491         16  WS-AH-INPUT-CD-1   PIC X.
   492         16  WS-AH-INPUT-CD-2-3 PIC XX.
   493
   494     12  WS-SWITCHES.
   495         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   496         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   497             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   498         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   499             88  BANK-ACCT-FOUND          VALUE 'Y'.
   500         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   501             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   502         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   503             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   504         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   505             88  COMP-MASTER-FOUND        VALUE 'Y'.
   506         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   507             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   508         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   509             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   510         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   511             88  STAT-MASTER-FOUND        VALUE 'Y'.
   512         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   513             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   514         16  ELCRTT-FOUND-SW          PIC X    VALUE SPACES.
   515             88  ELCRTT-FOUND             VALUE 'Y'.
   516         16  ELCRTT-UPDATE-SW         PIC X    VALUE SPACES.
   517             88  ELCRTT-UPDATE            VALUE 'Y'.
   518         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   519             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   520         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   521             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   522         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   523             88  FORM-MASTER-FOUND        VALUE 'Y'.
   524         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   525             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   526         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   527             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   528         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   529             88  PROCESS-FORM-EDITS       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  11
* EL050.cbl
   530         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   531             88  NO-BENEFIT-FOUND         VALUE 'N'.
   532         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   533             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   534         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   535             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   536         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   537             88  AH-BENEFIT-FOUND         VALUE ' '.
   538             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   539         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   540             88  LF-BENEFIT-FOUND         VALUE ' '.
   541             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   542         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   543             88  NO-STATE-RECORD          VALUE '1'.
   544         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   545             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   546         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   547             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   548         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   549             88  CERT-WAS-FOUND           VALUE ' '.
   550             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   551         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   552             88  BROWSE-STARTED           VALUE 'Y'.
   553         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   554             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   555         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   556             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   557         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   558             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   559         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   560             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   561         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   562             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   563         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   564             88  APP-CERT-USED            VALUE 'Y' 'A'.
   565         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   566             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   567             88  FIRST-TIME-THROUGH       VALUE '1'.
   568             88  CTBL-NOT-FOUND           VALUE '2'.
   569
   570         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   571             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   572
   573         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   574             88  DLO-ERROR-FOUND          VALUE 'Y'.
   575
   576********FLA
   577     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   578     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   579********
   580     12  RC-SW-1                  PIC X           VALUE '0'.
   581     12  RC-SW-2                  PIC X           VALUE '0'.
   582     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   583     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   584     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   585     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   586     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   587     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  12
* EL050.cbl
   588     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   589     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   590     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   591     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   592     12  LIT-SPACES               PIC X           VALUE SPACES.
   593     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   594     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   595     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   596     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   597     12  erpndm-unlock-sw         pic x           value spaces.
   598         88  need-to-unlock-erpndm  value 'Y'.
   599     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   600     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   601     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   602         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   603         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   604     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   605         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   606
   607 01  WS-EXTRA-PERIODS-BY-STATE.
   608     12  WS-INT-PERIODS          PIC 9.
   609     12  WS-EXTRA-PMTS           PIC 9.
   610 01  ws-net-only-state           pic x value 'N'.
   611 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   612     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   613     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   614 01  WS-CRI-SSN-WORK-AREA.
   615     05  WS-CRI-SOC-SEC-NO.
   616         10  WS-SS-REPT-CD       PIC X(5).
   617         10  WS-SS-LAST-NAME     PIC X(5).
   618         10  WS-SS-INITIAL       PIC X.
   619
   620     05  WS-CRI-REPORT-CODE.
   621         10  FILLER              PIC X(5).
   622         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   623
   624     05  WS-CRI-LAST-NAME.
   625         10  WS-CRI-NAME-MOVE    PIC X(5).
   626         10  FILLER              PIC X(10).
   627
   628 01  ws-state-commission-caps.
   629     05  ws-sl-wk-rate           pic sv9(5) comp-3 value zeros.
   630     05  ws-jl-wk-rate           pic sv9(5) comp-3 value zeros.
   631     05  ws-sa-wk-rate           pic sv9(5) comp-3 value zeros.
   632     05  ws-ja-wk-rate           pic sv9(5) comp-3 value zeros.
   633     05  ws-ga-sl-wk-rate        pic sv9(5) comp-3 value zeros.
   634     05  ws-ga-jl-wk-rate        pic sv9(5) comp-3 value zeros.
   635     05  ws-ga-sa-wk-rate        pic sv9(5) comp-3 value zeros.
   636     05  ws-ga-ja-wk-rate        pic sv9(5) comp-3 value zeros.
   637     05  ws-tot-sl-wk-rate       pic sv9(5) comp-3 value zeros.
   638     05  ws-tot-jl-wk-rate       pic sv9(5) comp-3 value zeros.
   639     05  ws-tot-sa-wk-rate       pic sv9(5) comp-3 value zeros.
   640     05  ws-tot-ja-wk-rate       pic sv9(5) comp-3 value zeros.
   641     05  ws-st-cap-limit-to      pic x.
   642     05  ws-st-comm-cap-sl       pic s9v9(4) comp-3.
   643     05  ws-st-comm-cap-jl       pic s9v9(4) comp-3.
   644     05  ws-st-comm-cap-sa       pic s9v9(4) comp-3.
   645     05  ws-st-comm-cap-ja       pic s9v9(4) comp-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  13
* EL050.cbl
   646     05  ws-st-ga-comm-cap-sl    pic s9v9(4) comp-3.
   647     05  ws-st-ga-comm-cap-jl    pic s9v9(4) comp-3.
   648     05  ws-st-ga-comm-cap-sa    pic s9v9(4) comp-3.
   649     05  ws-st-ga-comm-cap-ja    pic s9v9(4) comp-3.
   650     05  ws-st-tot-comm-cap-sl   pic s9v9(4) comp-3.
   651     05  ws-st-tot-comm-cap-jl   pic s9v9(4) comp-3.
   652     05  ws-st-tot-comm-cap-sa   pic s9v9(4) comp-3.
   653     05  ws-st-tot-comm-cap-ja   pic s9v9(4) comp-3.
   654 01  WS-NUM-TABLE                PIC X(26)  VALUE
   655     '12345678012345070923456789'.
   656 01  FILLER REDEFINES WS-NUM-TABLE.
   657     05  WS-NUM OCCURS 26        PIC 9.
   658 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   659 01  V1                          PIC S999 COMP-3.
   660 01  V2                          PIC S999 COMP-3.
   661 01  V3                          PIC S999 COMP-3.
   662 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   663 01  FILLER REDEFINES WS-WORK-VIN.
   664     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   665 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   666 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   667 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   668 01  WS-HEX-WORK.
   669     05  FILLER                  PIC X  VALUE LOW-VALUES.
   670     05  WS-HEX-BYTE             PIC X.
   671 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   672 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   673 01  WS-WORK-HIN-ROW-B.
   674     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   675
   676 01  ws-benefit-cd-chg-sw      pic x value spaces.
   677     88  benefit-code-chg           value 'Y'.
   678 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   679 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   680     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   681 01  WS-ROW-D-TABLE.
   682     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   683
   684 01  WS-HIN-TABLE-B.
   685     05  F                       PIC XX VALUE 'A2'.
   686     05  F                       PIC XX VALUE 'B3'.
   687     05  F                       PIC XX VALUE 'C4'.
   688     05  F                       PIC XX VALUE 'D5'.
   689     05  F                       PIC XX VALUE 'E6'.
   690     05  F                       PIC XX VALUE 'F7'.
   691     05  F                       PIC XX VALUE 'G8'.
   692     05  F                       PIC XX VALUE 'H9'.
   693     05  F                       PIC XX VALUE 'I1'.
   694     05  F                       PIC XX VALUE 'J2'.
   695     05  F                       PIC XX VALUE 'K3'.
   696     05  F                       PIC XX VALUE 'L4'.
   697     05  F                       PIC XX VALUE 'M5'.
   698     05  F                       PIC XX VALUE 'N6'.
   699     05  F                       PIC XX VALUE 'O0'.
   700     05  F                       PIC XX VALUE 'P7'.
   701     05  F                       PIC XX VALUE 'Q0'.
   702     05  F                       PIC XX VALUE 'R8'.
   703     05  F                       PIC XX VALUE 'S9'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  14
* EL050.cbl
   704     05  F                       PIC XX VALUE 'T2'.
   705     05  F                       PIC XX VALUE 'U3'.
   706     05  F                       PIC XX VALUE 'V4'.
   707     05  F                       PIC XX VALUE 'W5'.
   708     05  F                       PIC XX VALUE 'X6'.
   709     05  F                       PIC XX VALUE 'Y7'.
   710     05  F                       PIC XX VALUE 'Z8'.
   711 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   712     05  WS-VAL-IN               PIC X.
   713     05  WS-VAL-OUT              PIC 9.
   714 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   715 01  ws-greg-eff-date            pic x(10) value ' '.
   716 01  WS-COMPARE-BINARY-DATES.
   717     05  WS-971231                PIC XX VALUE X'92FF'.
   718     05  WS-931231                PIC XX VALUE X'8CFF'.
   719     05  WS-791231                PIC XX VALUE X'77FF'.
   720     05  WS-771001                PIC XX VALUE X'74A1'.
   721     05  WS-820301                PIC XX VALUE X'7B41'.
   722     05  WS-831031                PIC XX VALUE X'7DBF'.
   723     05  WS-831231                PIC XX VALUE X'7DFF'.
   724     05  WS-810831                PIC XX VALUE X'7A7F'.
   725     05  WS-830901                PIC XX VALUE X'7D81'.
   726
   727 01  FILE-ACCESS-IDS.
   728     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   729     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   730     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   731     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   732     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   733     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   734     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   735     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   736     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   737     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   738     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   739     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   740     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   741     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   742     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   743     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   744     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   745 01  DD-IU-SW                    PIC X   VALUE ' '.
   746     88  DD-IU-PRESENT                 VALUE 'Y'.
   747
   748 01  ACCESS-KEYS.
   749     12  ELMSTR-KEY.
   750         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   751         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   752     12  W-CLAIM-KEY.
   753         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   754         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   755
   756     12  ELCNTL-KEY.
   757         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   758         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   759         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   760         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   761
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  15
* EL050.cbl
   762     12  ELCERT-KEY.
   763         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   764         16  CERT-CARRIER         PIC X       VALUE SPACE.
   765         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   766         16  CERT-STATE           PIC XX      VALUE SPACES.
   767         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   768         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   769         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   770
   771     12  ELCERT2-KEY.
   772         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   773         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   774
   775     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   776
   777     12  ELCERT-SAVE.
   778         16  FILLER                      PIC XX    VALUE SPACES.
   779
   780         16  WCS-CONTROL-PRIMARY.
   781             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   782             20  WCS-CARRIER             PIC X     VALUE SPACE.
   783             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   784             20  WCS-STATE               PIC XX    VALUE SPACES.
   785             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   786             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   787             20  WCS-CERT-NO.
   788                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   789                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   790
   791         16  CS-CONTROL-BY-NAME.
   792             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   793             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   794             20  CS-INSURED-INITIALS.
   795                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   796                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   797
   798         16  CS-CONTROL-BY-SSN.
   799             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   800             20  CS-SOC-SEC-NO.
   801                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   802                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   803                 24  CS-SSN-LN3.
   804                     28 CS-INSURED-INITIALS-A2   PIC XX
   805                                     VALUE SPACES.
   806                     28 CS-PART-LAST-NAME-A2     PIC X
   807                                     VALUE SPACE.
   808
   809         16  CS-CONTROL-BY-CERT-NO.
   810             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   811             20  CS-CERT-NO-A4           PIC X(11)
   812                                     VALUE SPACES.
   813
   814         16  CS-CONTROL-BY-MEMB.
   815             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   816             20  CS-MEMBER-NO.
   817                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   818                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   819                 24  CS-MEMB-LN4.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  16
* EL050.cbl
   820                     28 CS-INSURED-INITIALS-A5   PIC XX
   821                                      VALUE SPACES.
   822                     28 CS-PART-LAST-NAME-A5     PIC XX
   823                                      VALUE SPACES.
   824
   825         16  FILLER              PIC X(360) VALUE SPACES.
   826
   827     12  ERACCT-KEY.
   828         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   829         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   830         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   831         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   832         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   833         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   834
   835     12  ERCOMP-KEY.
   836         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   837         16  COMP-CARRIER         PIC X     VALUE SPACES.
   838         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   839         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   840         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   841         16  COMP-TYPE            PIC X     VALUE SPACES.
   842
   843     12  ERLOFC-KEY.
   844         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   845         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   846         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   847         16  LOFC-STATE           PIC XX    VALUE SPACES.
   848         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   849         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   850
   851     12  WS-ELCRTT-KEY.
   852         16  WS-ELCRTT-PRIMARY       PIC X(33).
   853         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   854
   855     12  ERBXRF-KEY.
   856         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   857         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   858         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   859         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   860
   861     12  ERAGTC-KEY.
   862         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   863         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   864         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   865         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   866         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   867         16  AGTC-TYPE            PIC X     VALUE SPACES.
   868
   869     12  ERPLAN-KEY.
   870         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   871         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   872         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   873         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   874         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   875         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   876         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   877         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  17
* EL050.cbl
   878
   879     12  ERFORM-KEY.
   880         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   881         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   882         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   883         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   884
   885     12  ERREIN-KEY.
   886         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   887         16  REIN-TYPE            PIC X     VALUE SPACES.
   888         16  REIN-TABLE-CO.
   889             20  REIN-CODE-1      PIC X     VALUE SPACE.
   890             20  REIN-CODE-2      PIC X     VALUE SPACE.
   891             20  REIN-CODE-3      PIC X     VALUE SPACE.
   892         16  FILLER               PIC X(3)  VALUE SPACES.
   893
   894     12  ERCTBL-KEY.
   895         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   896         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   897         16  CTBL-CNTRL-2.
   898             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   899             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   900
   901     12  ELCRTO-KEY.
   902         16  ELCRTO-COMPANY-CD       PIC X.
   903         16  ELCRTO-CARRIER          PIC X.
   904         16  ELCRTO-GROUPING         PIC X(6).
   905         16  ELCRTO-STATE            PIC XX.
   906         16  ELCRTO-ACCOUNT          PIC X(10).
   907         16  ELCRTO-CERT-EFF-DT      PIC XX.
   908         16  ELCRTO-CERT-NO.
   909             20  ELCRTO-CERT-PRIME   PIC X(10).
   910             20  ELCRTO-CERT-SFX     PIC X.
   911         16  ELCRTO-RECORD-TYPE      PIC X.
   912         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   913
   914
   915     12  WS-ACCESS.
   916         16  FILLER               PIC XX    VALUE SPACES.
   917         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   918
   919     12  WS-CARR-ACCESS.
   920         16  FILLER               PIC X(3)  VALUE SPACES.
   921         16  WS-CARR              PIC X     VALUE SPACE.
   922*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   923*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   924     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   925         88  WS-DMD-LF-RATING   VALUE 'Y'.
   926         88  WS-DMD-AH-RATING   VALUE 'Y'.
   927         88  WS-DMD-NO-RATING   VALUE 'N'.
   928
   929     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   930         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   931                                         'NJ' 'NL'
   932                                         'PJ' 'PL'
   933                                         'SJ' 'SL'.
   934     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   935         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  18
* EL050.cbl
   936                                         'NI' 'NJ' 'NL' 'NU'
   937                                         'PJ' 'PL' 'PI' 'PU'
   938                                         'SI' 'SJ' 'SL' 'SU'
   939                                         'MX' 'MY' 'MZ'.
   940 01  ERPDEF-KEY-SAVE             PIC X(18).
   941 01  ERPDEF-KEY.
   942     12  ERPDEF-COMPANY-CD       PIC X.
   943     12  ERPDEF-STATE            PIC XX.
   944     12  ERPDEF-PROD-CD          PIC XXX.
   945     12  F                       PIC X(7).
   946     12  ERPDEF-BEN-TYPE         PIC X.
   947     12  ERPDEF-BEN-CODE         PIC XX.
   948     12  ERPDEF-EXP-DT           PIC XX.
   949
   950 01  ELSTAT-KEY-SAVE             PIC X(20).
   951 01  ELSTAT-KEY.
   952     12  ELSTAT-COMPANY-ID       PIC XXX.
   953     12  ELSTAT-CARRIER          PIC X.
   954     12  ELSTAT-GROUP            PIC X(6).
   955     12  ELSTAT-STATE            PIC XX.
   956     12  ELSTAT-EXP-DT           PIC 9(8).
   957 01  WS-ERROR-VALUES.
   958     12  ER-1570                     PIC S9(4)   VALUE +1570.
   959     12  ER-1571                     PIC S9(4)   VALUE +1571.
   960     12  er-1572                     pic s9(4)   value +1572.
   961     12  er-1573                     pic s9(4)   value +1573.
   962     12  er-1574                     pic s9(4)   value +1574.
   963     12  ER-1575                     PIC S9(4)   VALUE +1575.
   964     12  er-1576                     pic s9(4)   value +1576.
   965     12  er-1583                     pic s9(4)   value +1583.
   966     12  er-1743                     pic s9(4)   value +1743.
   967     12  er-1744                     pic s9(4)   value +1744.
   968     12  er-1745                     pic s9(4)   value +1745.
   969     12  er-1746                     pic s9(4)   value +1746.
   970     12  er-1747                     pic s9(4)   value +1747.
   971     12  er-1748                     pic s9(4)   value +1748.
   972     12  er-1749                     pic s9(4)   value +1749.
   973     12  er-1750                     pic s9(4)   value +1750.
   974     12  er-1751                     pic s9(4)   value +1751.
   975     12  er-1752                     pic s9(4)   value +1752.
   976     12  er-1753                     pic s9(4)   value +1753.
   977     12  er-1754                     pic s9(4)   value +1754.
   978     12  er-1755                     pic s9(4)   value +1755.
   979     12  er-1756                     pic s9(4)   value +1756.
   980     12  er-1757                     pic s9(4)   value +1757.
   981     12  er-1758                     pic s9(4)   value +1758.
   982     12  er-1759                     pic s9(4)   value +1759.
   983     12  er-1760                     pic s9(4)   value +1760.
   984     12  er-1761                     pic s9(4)   value +1761.
   985     12  ER-1891                     PIC S9(4)   VALUE +1891.
   986     12  ER-1892                     PIC S9(4)   VALUE +1892.
   987     12  ER-1893                     PIC S9(4)   VALUE +1893.
   988     12  ER-1894                     PIC S9(4)   VALUE +1894.
   989     12  ER-1895                     PIC S9(4)   VALUE +1895.
   990     12  ER-1896                     PIC S9(4)   VALUE +1896.
   991     12  ER-1897                     PIC S9(4)   VALUE +1897.
   992     12  ER-1898                     PIC S9(4)   VALUE +1898.
   993     12  ER-1899                     PIC S9(4)   VALUE +1899.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  19
* EL050.cbl
   994     12  ER-1900                     PIC S9(4)   VALUE +1900.
   995     12  ER-1901                     PIC S9(4)   VALUE +1901.
   996     12  ER-1902                     PIC S9(4)   VALUE +1902.
   997     12  ER-1903                     PIC S9(4)   VALUE +1903.
   998     12  ER-1904                     PIC S9(4)   VALUE +1904.
   999     12  ER-1905                     PIC S9(4)   VALUE +1905.
  1000     12  ER-1906                     PIC S9(4)   VALUE +1906.
  1001     12  ER-1907                     PIC S9(4)   VALUE +1907.
  1002     12  ER-1909                     PIC S9(4)   VALUE +1909.
  1003     12  ER-1910                     PIC S9(4)   VALUE +1910.
  1004     12  ER-1911                     PIC S9(4)   VALUE +1911.
  1005     12  ER-1912                     PIC S9(4)   VALUE +1912.
  1006     12  ER-1913                     PIC S9(4)   VALUE +1913.
  1007     12  ER-1914                     PIC S9(4)   VALUE +1914.
  1008     12  ER-1915                     PIC S9(4)   VALUE +1915.
  1009     12  ER-1916                     PIC S9(4)   VALUE +1916.
  1010     12  ER-1917                     PIC S9(4)   VALUE +1917.
  1011     12  ER-1918                     PIC S9(4)   VALUE +1918.
  1012     12  ER-1919                     PIC S9(4)   VALUE +1919.
  1013     12  ER-1920                     PIC S9(4)   VALUE +1920.
  1014     12  ER-1921                     PIC S9(4)   VALUE +1921.
  1015     12  ER-1922                     PIC S9(4)   VALUE +1922.
  1016     12  ER-1923                     PIC S9(4)   VALUE +1923.
  1017     12  ER-1924                     PIC S9(4)   VALUE +1924.
  1018     12  ER-1925                     PIC S9(4)   VALUE +1925.
  1019     12  ER-1926                     PIC S9(4)   VALUE +1926.
  1020     12  ER-1927                     PIC S9(4)   VALUE +1927.
  1021     12  ER-1955                     PIC s9(4)   VALUE +1955.
  1022     12  ER-1956                     PIC s9(4)   VALUE +1956.
  1023     12  ER-1957                     PIC s9(4)   VALUE +1957.
  1024     12  ER-1958                     PIC s9(4)   VALUE +1958.
  1025     12  ER-1959                     PIC s9(4)   VALUE +1959.
  1026     12  ER-1960                     PIC s9(4)   VALUE +1960.
  1027     12  ER-1961                     PIC s9(4)   VALUE +1961.
  1028     12  ER-1962                     PIC s9(4)   VALUE +1962.
  1029     12  ER-1963                     PIC s9(4)   VALUE +1963.
  1030     12  ER-2393                     PIC S9(4)   VALUE +2393.
  1031     12  ER-2600                     PIC S9(4)   VALUE +2600.
  1032     12  ER-2601                     PIC S9(4)   VALUE +2601.
  1033     12  ER-2602                     PIC S9(4)   VALUE +2602.
  1034     12  ER-2603                     PIC S9(4)   VALUE +2603.
  1035     12  ER-2604                     PIC S9(4)   VALUE +2604.
  1036     12  ER-2605                     PIC S9(4)   VALUE +2605.
  1037     12  ER-2606                     PIC S9(4)   VALUE +2606.
  1038     12  ER-2607                     PIC S9(4)   VALUE +2607.
  1039     12  ER-2608                     PIC S9(4)   VALUE +2608.
  1040     12  ER-2609                     PIC S9(4)   VALUE +2609.
  1041     12  ER-2610                     PIC S9(4)   VALUE +2610.
  1042     12  ER-2611                     PIC S9(4)   VALUE +2611.
  1043     12  ER-2612                     PIC S9(4)   VALUE +2612.
  1044     12  ER-2613                     PIC S9(4)   VALUE +2613.
  1045     12  ER-2614                     PIC S9(4)   VALUE +2614.
  1046     12  ER-2615                     PIC S9(4)   VALUE +2615.
  1047     12  ER-2616                     PIC S9(4)   VALUE +2616.
  1048     12  ER-2617                     PIC S9(4)   VALUE +2617.
  1049     12  ER-2618                     PIC S9(4)   VALUE +2618.
  1050     12  ER-2619                     PIC S9(4)   VALUE +2619.
  1051     12  ER-2620                     PIC S9(4)   VALUE +2620.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  20
* EL050.cbl
  1052     12  ER-2621                     PIC S9(4)   VALUE +2621.
  1053     12  ER-2622                     PIC S9(4)   VALUE +2622.
  1054     12  ER-2623                     PIC S9(4)   VALUE +2623.
  1055     12  ER-2624                     PIC S9(4)   VALUE +2624.
  1056     12  ER-2625                     PIC S9(4)   VALUE +2625.
  1057     12  ER-2626                     PIC S9(4)   VALUE +2626.
  1058     12  ER-2627                     PIC S9(4)   VALUE +2627.
  1059     12  ER-2628                     PIC S9(4)   VALUE +2628.
  1060     12  ER-2629                     PIC S9(4)   VALUE +2629.
  1061     12  ER-2630                     PIC S9(4)   VALUE +2630.
  1062     12  ER-2631                     PIC S9(4)   VALUE +2631.
  1063     12  ER-2632                     PIC S9(4)   VALUE +2632.
  1064     12  ER-2633                     PIC S9(4)   VALUE +2633.
  1065     12  ER-2634                     PIC S9(4)   VALUE +2634.
  1066     12  ER-2635                     PIC S9(4)   VALUE +2635.
  1067     12  ER-2636                     PIC S9(4)   VALUE +2636.
  1068     12  ER-2637                     PIC S9(4)   VALUE +2637.
  1069     12  ER-2638                     PIC S9(4)   VALUE +2638.
  1070     12  ER-2639                     PIC S9(4)   VALUE +2639.
  1071     12  ER-2640                     PIC S9(4)   VALUE +2640.
  1072     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1073     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1074     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1075     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1076     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1077     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1078     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1079     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1080     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1081     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1082     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1083     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1084     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1085     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1086     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1087     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1088     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1089     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1090     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1091     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1092     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1093     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1094     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1095     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1096     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1097     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1098     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1099     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1100     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1101     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1102     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1103     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1104     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1105     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1106     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1107     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1108     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1109     12  ER-2678                     PIC S9(4)   VALUE +2678.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  21
* EL050.cbl
  1110     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1111     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1112     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1113     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1114     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1115     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1116     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1117     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1118     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1119     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1120     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1121     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1122     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1123     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1124     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1125     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1126     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1127     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1128     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1129     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1130     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1131     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1132     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1133     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1134     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1135     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1136     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1137     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1138     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1139     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1140     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1141     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1142     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1143     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1144     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1145     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1146     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1147     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1148     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1149     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1150     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1151     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1152     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1153     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1154     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1155     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1156     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1157     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1158     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1159     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1160     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1161     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1162     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1163     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1164     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1165     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1166     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1167     12  ER-2746                     PIC S9(4)   VALUE +2746.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  22
* EL050.cbl
  1168     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1169     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1170     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1171     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1172     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1173     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1174     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1175     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1176     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1177     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1178     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1179     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1180     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1181     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1182     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1183     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1184     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1185     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1186     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1187     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1188     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1189     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1190     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1191     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1192     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1193     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1194     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1195     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1196     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1197     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1198     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1199     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1200     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1201     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1202     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1203     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1204     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1205     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1206     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1207     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1208     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1209     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1210     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1211     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1212     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1213     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1214     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1215     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1216     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1217     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1218     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1219     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1220     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1221     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1222     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1223     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1224     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1225     12  ER-2888                     PIC S9(4)   VALUE +2888.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  23
* EL050.cbl
  1226     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1227     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1228     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1229     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1230     12  ER-2894                     PIC S9(4)   VALUE +2894.
  1231     12  ER-2895                     PIC S9(4)   VALUE +2895.
  1232     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1233     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1234     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1235     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1236     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1237     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1238     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1239     12  ER-2998                     PIC S9(4)   VALUE +2998.
  1240     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1241     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1242     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1243     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1244     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1245     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1246     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1247     12  ER-3059                     PIC S9(4)   VALUE +3059.
  1248     12  ER-3060                     PIC S9(4)   VALUE +3060.
  1249     12  ER-3061                     PIC S9(4)   VALUE +3061.
  1250     12  ER-3062                     PIC S9(4)   VALUE +3062.
  1251     12  ER-3063                     PIC S9(4)   VALUE +3063.
  1252     12  ER-3068                     PIC S9(4)   VALUE +3068.
  1253     12  er-3270                     pic s9(4)   value +3270.
  1254     12  er-3273                     pic s9(4)   value +3273.
  1255     12  er-3281                     pic s9(4)   value +3281.
  1256     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1257     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1258     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1259     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1260     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1261     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1262     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1263     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1264     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1265     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1266     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1267     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1268     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1269     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1270     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1271     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1272     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1273     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1274     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1275     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1276     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1277     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1278     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1279     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1280     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1281     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1282     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1283     12  ER-8041                     PIC S9(4)   VALUE +8041.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  24
* EL050.cbl
  1284     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1285     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1286     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1287     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1288     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1289     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1290     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1291     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1292     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1293     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1294     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1295     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1296     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1297     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1298     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1299     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1300     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1301     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1302     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1303     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1304     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1305     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1306     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1307     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1308     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1309     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1310     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1311     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1312     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1313     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1314     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1315     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1316     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1317     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1318     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1319     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1320     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1321     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1322     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1323     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1324     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1325     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1326     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1327     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1328     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1329     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1330     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1331     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1332     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1333     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1334     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1335     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1336     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1337     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1338     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1339     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1340     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1341     12  ER-8315                     PIC S9(4)   VALUE +8315.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  25
* EL050.cbl
  1342     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1343     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1344     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1345     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1346     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1347     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1348     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1349     12  er-9823                     pic s9(4)   value +9823.
  1350     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1351******************************************************************
  1352***************   END OF ELC50WS     ****************************
  1353******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  26
* EL050.cbl
  1356 01  WORKING-STORAGE-WORK-AREAS.
  1357     12  WS-RESPONSE             PIC S9(8)  COMP.
  1358         88  WS-RESP-NORMAL           VALUE +00.
  1359         88  WS-RESP-ERROR            VALUE +01.
  1360         88  WS-RESP-NOTFND           VALUE +13.
  1361         88  WS-RESP-DUPREC           VALUE +14.
  1362         88  WS-RESP-ENDFILE          VALUE +20.
  1363     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1364     12  WORK-AREAS.
  1365         16  WK-CONV-GREG.
  1366             24  WCG-CENT             PIC XX.
  1367             24  WCG-REST             PIC X(4).
  1368         16  WORK-GREGORIAN-DATE.
  1369             24  WK-GREG-CENT         PIC XX.
  1370             24  WK-GREG-DATE-YYMMDD.
  1371                 28  WK-GREG-YYMM     PIC X(4).
  1372                 28  WK-GREG-DD       PIC XX.
  1373
  1374         16  WORK-SELECT-DATE.
  1375             24  WK-SELECT-CENT            PIC XX.
  1376             24  WK-SELECT-DATE-YYMMDD.
  1377                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1378                 28  FILLER                PIC XX.
  1379
  1380         16  WK-FORM-NO.
  1381             24  WK-FORM-BANK-ID       PIC X(5).
  1382             24  WK-FORM-UNDRWRTR      PIC X(1).
  1383             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1384
  1385         16  WK-MEMBER-NO.
  1386             24  WK-MEMBER-1-6        PIC X(6).
  1387             24  WK-MEMBER-7-12       PIC X(6).
  1388
  1389         16  WK-FULL-CERT-NO.
  1390             24  WK-CERT-POS-1-2      PIC X(2).
  1391             24  WK-CERT-POS-3        PIC X(1).
  1392             24  WK-CERT-POS-4        PIC X(1).
  1393             24  WK-CERT-POS-5-6      PIC X(2).
  1394             24  WK-CERT-POS-7        PIC X(1).
  1395             24  WK-CERT-POS-8-11     PIC X(4).
  1396
  1397         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1398             88  VALID-RATE-CODE        VALUE 'Y'.
  1399             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1400
  1401         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1402         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1403         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1404         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1405         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1406         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1407         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1408         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1409         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1410         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1411
  1412* DLO001
  1413 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  27
* EL050.cbl
  1414     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1415     12  DMPF-RETURN-CODE          PIC XX.
  1416         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1417         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1418         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1419         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1420         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1421         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1422
  1423* DLO002
  1424 01  WS-DLO-INTERNAL-POLICY-FORM.
  1425     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1426     12  DIPF-RETURN-CODE          PIC XX.
  1427         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1428         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1429         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1430         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1431         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1432         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1433
  1434* DLO003
  1435 01  WS-DLO-VALID-BANK-ID.
  1436     12  DVBI-BANK-ID              PIC X(5).
  1437     12  DVBI-BANK-ID-TYPE         PIC X.
  1438         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1439         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1440         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1441         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1442         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1443     12  DVBI-RETURN-CODE          PIC XX.
  1444         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1445         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1446         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1447         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1448         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1449         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1450         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1451         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1452         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1453
  1454* DLO007
  1455 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1456     12  DCUA-RES-STATE            PIC XX.
  1457     12  DCUA-BEN-TYPE             PIC XX.
  1458     12  DCUA-SYS-IDENT            PIC X.
  1459         88  DCUA-CLAIM                        VALUE 'C'.
  1460         88  DCUA-PREMIUM                      VALUE 'P'.
  1461     12  DCUA-COVERAGE-RULE        PIC X.
  1462     12  DCUA-CLIENT-ID            PIC X(10).
  1463     12  DCUA-EFF-DATE             PIC X(8).
  1464     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1465     12  DCUA-RETURN-CODE          PIC XX.
  1466         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1467     12  DCUA-CERT-NUMBER          PIC X(11).
  1468     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1469     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1470
  1471* DLO011
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  28
* EL050.cbl
  1472 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1473     12  DPRB-RATE-CODE            PIC X(4).
  1474     12  DPRB-COVERAGE-CATEG       PIC X.
  1475     12  DPRB-RETURN-CODE          PIC XX.
  1476         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1477         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1478         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1479         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1480         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1481         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1482         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1483         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1484         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1485     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1486     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1487     12  DPRB-BEN-TYPE             PIC XX.
  1488
  1489* DLO017
  1490 01  WS-DLO-VALID-RATE-CODE.
  1491     12  DVRC-RATE-CODE            PIC X(4).
  1492     12  DVRC-RETURN-CODE          PIC XX.
  1493         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1494         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1495         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1496         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1497         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1498         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1499
  1500* DLO019
  1501 01  WS-DLO-ORIG-COV-CAT.
  1502     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1503     12  DOCC-RETURN-CODE          PIC XX.
  1504     12  DOCC-ORIG-COV-CAT         PIC X.
  1505     12  DOCC-UNDERWITER           PIC XX.
  1506     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1507     12  DOCC-FILLER               PIC X(6).
  1508
  1509* DLO021
  1510 01  WS-DLO-VALID-LOAN-OFFICER.
  1511     12  DVLO-LOAN-OFFICER.
  1512         16  DVLO-BILL-TYPE        PIC X.
  1513         16  DVLO-BILL-SOURCE      PIC X.
  1514         16  DVLO-BATCH-TYPE       PIC X.
  1515     12  DVLO-RETURN-CODE          PIC XX.
  1516         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1517         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1518         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1519         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1520         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1521         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1522
  1523* DLO022
  1524 01  WS-DLO-VALID-STATE-CODE.
  1525     12  DVSC-STATE-CODE           PIC XX.
  1526     12  DVSC-RETURN-CODE          PIC XX.
  1527         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1528
  1529* DLO023
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  29
* EL050.cbl
  1530 01  WS-DLO-VALID-CODE-VALUES.
  1531     12  DVCV-SYSTEM-ID            PIC XX.
  1532         88  DVCV-CLAIMS                       VALUE 'CL'.
  1533         88  DVCV-CREDIT                       VALUE 'CR'.
  1534     12  DVCV-RECORD-TYPE          PIC XX.
  1535         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1536         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1537         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1538         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1539         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1540         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1541         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1542         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1543     12  DVCV-RECORD-KEY           PIC X(6).
  1544     12  DVCV-RETURN-CODE          PIC XX.
  1545         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1546         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1547         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1548         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1549         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1550         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1551         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1552     12  DVCV-CODE-DESC            PIC X(60).
  1553     12  DVCV-GEN-DESC-1           PIC X(20).
  1554     12  DVCV-GEN-DESC-2           PIC X(20).
  1555     12  DVCV-GEN-DESC-3           PIC X(20).
  1556
  1557 01  hldi-pass-area-len          pic s9(4) comp value +214.
  1558 01  hldi-pass-area.
  1559     03  PA-VIN                  PIC X(17).
  1560     03  PA-ErrorCode            PIC X(10).
  1561     03  PA-ErrorDesc            PIC X(30).
  1562     03  PA-ModelYear            PIC 9(7).
  1563     03  PA-MakeName             PIC X(50).
  1564     03  PA-ModelName            PIC X(50).
  1565     03  PA-SeriesName           PIC X(50).
  1566 01  zipcd-pass-area-len         pic s9(4) comp value +67.
  1567 01  zipcd-pass-area.
  1568     03  PA-zip                  PIC X(5).
  1569     03  PA-ErrorCode-zip        PIC X(10).
  1570     03  PA-city                 PIC x(50).
  1571     03  PA-state                PIC Xx.
  1572 01  clmhs-pass-area-len         pic s9(4) comp value +40.
  1573 01  clmhs-pass-area.
  1574     03  pa-clmhs-state          pic xx.
  1575     03  pa-account              pic x(10).
  1576     03  pa-eff-dt               pic x(10).
  1577     03  pa-cert-no              pic x(11).
  1578     03  pa-clm-count            pic 9(5).
  1579****  this is for aggregate report.
  1580****  Length is erpndb + 100 of passed-key-area
  1581 01  ws-passed-key-length        pic s9(4) comp value +587.
  1582 01  ws-pass-to-pemaggo.
  1583     05  ws-passed-erpndb        pic x(585).
  1584     05  ws-exceed-limit-yn      pic x.
  1585     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  30
* EL050.cbl
  1587*    COPY ERCBXRF.
  1588******************************************************************
  1589*                                                                *
  1590*                                                                *
  1591*                            ERCBXRF                             *
  1592*                                                                *
  1593*   ONLINE CREDIT SYSTEM                                         *
  1594*                                                                *
  1595*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1596*                                                                *
  1597*   FILE TYPE = VSAM,KSDS                                        *
  1598*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1599*                                                                *
  1600*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1601*       ALTERNATE PATH = NONE                                    *
  1602*                                                                *
  1603*   LOG = NO                                                     *
  1604*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1605*                                                                *
  1606******************************************************************
  1607
  1608 01  BANK-CROSS-REFERENCE.
  1609     12  BK-RECORD-ID                PIC XX.
  1610         88  VALID-BK-ID             VALUE 'BK'.
  1611
  1612     12  BK-CONTROL-PRIMARY.
  1613         16  BK-COMPANY-CD           PIC X.
  1614         16  BK-CARRIER              PIC X.
  1615         16  BK-GROUPING             PIC X(6).
  1616         16  BK-BANK-NO              PIC X(10).
  1617
  1618     12  BK-MAINT-INFORMATION.
  1619         16  BK-LAST-MAINT-DT        PIC XX.
  1620         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1621         16  BK-LAST-MAINT-USER      PIC X(4).
  1622         16  FILLER                  PIC X(9).
  1623
  1624     12  FILLER                      PIC X(37).
  1625
  1626     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1627
  1628     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1629                            DEPENDING ON BK-BANK-POINTER-CNT.
  1630         16  BK-AM-ACCOUNT           PIC X(10).
  1631         16  BK-AM-EXP-DT            PIC XX.
  1632         16  BK-AM-EFF-DT            PIC XX.
  1633         16  BK-AM-STATE             PIC XX.
  1634         16  FILLER                  PIC X(20).
  1635
  1636******************************************************************
  1637
  1638*    COPY ERCCOMP.
  1639******************************************************************
  1640*                                                                *
  1641*                                                                *
  1642*                            ERCCOMP                             *
  1643*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1644*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  31
* EL050.cbl
  1645*                                                                *
  1646*   ONLINE CREDIT SYSTEM                                         *
  1647*                                                                *
  1648*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1649*                                                                *
  1650*   FILE TYPE = VSAM,KSDS                                        *
  1651*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1652*                                                                *
  1653*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1654*       ALTERNATE PATH = NONE                                    *
  1655*                                                                *
  1656*   LOG = NO                                                     *
  1657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1658*                                                                *
  1659******************************************************************
  1660*                   C H A N G E   L O G
  1661*
  1662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1663*-----------------------------------------------------------------
  1664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1665* EFFECTIVE    NUMBER
  1666*-----------------------------------------------------------------
  1667* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1668* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1669* 092205    2005050300006  PEMA  ADD LEASE FEE
  1670* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1671* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1672* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1673* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1674* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1675* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1676******************************************************************
  1677
  1678 01  COMPENSATION-MASTER.
  1679     12  CO-RECORD-ID                          PIC XX.
  1680         88  VALID-CO-ID                          VALUE 'CO'.
  1681
  1682     12  CO-CONTROL-PRIMARY.
  1683         16  CO-COMPANY-CD                     PIC X.
  1684         16  CO-CONTROL.
  1685             20  CO-CTL-1.
  1686                 24  CO-CARR-GROUP.
  1687                     28  CO-CARRIER            PIC X.
  1688                     28  CO-GROUPING.
  1689                         32  CO-GROUP-PREFIX   PIC XXX.
  1690                         32  CO-GROUP-PRIME    PIC XXX.
  1691                 24  CO-RESP-NO.
  1692                     28  CO-RESP-PREFIX        PIC X(4).
  1693                     28  CO-RESP-PRIME         PIC X(6).
  1694             20  CO-CTL-2.
  1695                 24  CO-ACCOUNT.
  1696                     28  CO-ACCT-PREFIX        PIC X(4).
  1697                     28  CO-ACCT-PRIME         PIC X(6).
  1698         16  CO-TYPE                           PIC X.
  1699             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1700             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1701             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1702
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  32
* EL050.cbl
  1703     12  CO-MAINT-INFORMATION.
  1704         16  CO-LAST-MAINT-DT                  PIC XX.
  1705         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1706         16  CO-LAST-MAINT-USER                PIC X(4).
  1707     12  FILLER                                PIC XX.
  1708     12  CO-STMT-TYPE                          PIC XXX.
  1709     12  CO-COMP-TYPE                          PIC X.
  1710         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1711     12  CO-STMT-OWNER                         PIC X(4).
  1712     12  CO-BALANCE-CONTROL                    PIC X.
  1713         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1714         88  CO-NO-BALANCE                        VALUE 'N'.
  1715
  1716     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1717         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1718         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1719         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1720
  1721     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1722         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1723         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1724
  1725     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1726     12  CO-GA-DIRECT-DEP                      PIC X.
  1727     12  CO-FUTURE-SPACE                       PIC X.
  1728         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1729
  1730     12  CO-ACCT-NAME                          PIC X(30).
  1731     12  CO-MAIL-NAME                          PIC X(30).
  1732     12  CO-ADDR-1                             PIC X(30).
  1733     12  CO-ADDR-2                             PIC X(30).
  1734     12  CO-ADDR-3.
  1735         16  CO-ADDR-CITY                      PIC X(27).
  1736         16  CO-ADDR-STATE                     PIC XX.
  1737     12  CO-CSO-1099                           PIC X.
  1738     12  CO-ZIP.
  1739         16  CO-ZIP-PRIME.
  1740             20  CO-ZIP-PRI-1ST                PIC X.
  1741                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1742             20  FILLER                        PIC X(4).
  1743         16  CO-ZIP-PLUS4                      PIC X(4).
  1744     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1745         16  CO-CAN-POSTAL-1                   PIC XXX.
  1746         16  CO-CAN-POSTAL-2                   PIC XXX.
  1747         16  FILLER                            PIC XXX.
  1748     12  CO-SOC-SEC                            PIC X(13).
  1749     12  CO-TELEPHONE.
  1750         16  CO-AREA-CODE                      PIC XXX.
  1751         16  CO-PREFIX                         PIC XXX.
  1752         16  CO-PHONE                          PIC X(4).
  1753
  1754     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1755
  1756     12  CO-AR-BAL-LEVEL                       PIC X.
  1757         88  CO-AR-REF-LVL                        VALUE '1'.
  1758         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1759         88  CO-AR-BILL-LVL                       VALUE '2'.
  1760         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  33
* EL050.cbl
  1761         88  CO-AR-FR-LVL                         VALUE '4'.
  1762
  1763     12  CO-AR-NORMAL-PRINT                    PIC X.
  1764         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1765         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1766
  1767     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1768
  1769     12  CO-AR-REPORTING                       PIC X.
  1770         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1771         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1772
  1773     12  CO-AR-PULL-CHECK                      PIC X.
  1774         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1775         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1776
  1777     12  CO-AR-BALANCE-PRINT                   PIC X.
  1778         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1779
  1780     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1781         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1782         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1783         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1784
  1785     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1786
  1787     12  CO-USER-CODE                          PIC X.
  1788     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1789
  1790******************************************************************
  1791*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1792*    THE LAST MONTH END RUN.
  1793******************************************************************
  1794
  1795     12  CO-LAST-ACTIVITY-DATE.
  1796         16  CO-ACT-YEAR                       PIC 99.
  1797         16  CO-ACT-MONTH                      PIC 99.
  1798         16  CO-ACT-DAY                        PIC 99.
  1799
  1800     12  CO-LAST-STMT-DT.
  1801         16  CO-LAST-STMT-YEAR                 PIC 99.
  1802         16  CO-LAST-STMT-MONTH                PIC 99.
  1803         16  CO-LAST-STMT-DAY                  PIC 99.
  1804
  1805     12  CO-MO-END-TOTALS.
  1806         16  CO-MONTHLY-TOTALS.
  1807             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1808             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1809             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1810             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1811             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1812
  1813         16  CO-AGING-TOTALS.
  1814             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1815             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1816             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1817             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1818
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  34
* EL050.cbl
  1819         16  CO-YTD-TOTALS.
  1820             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1821             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1822
  1823         16  CO-OVER-UNDER-TOTALS.
  1824             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1825             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1826
  1827     12  CO-MISCELLANEOUS-TOTALS.
  1828         16  CO-FICA-TOTALS.
  1829             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1830             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1831
  1832         16  CO-CLAIM-TOTALS.
  1833             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1834             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1835
  1836******************************************************************
  1837*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1838*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1839******************************************************************
  1840
  1841     12  CO-CURRENT-TOTALS.
  1842         16  CO-CURRENT-LAST-STMT-DT.
  1843             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1844             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1845             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1846
  1847         16  CO-CURRENT-MONTHLY-TOTALS.
  1848             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1849             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1850             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1851             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1852             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1853
  1854         16  CO-CURRENT-AGING-TOTALS.
  1855             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1856             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1857             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1858             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1859
  1860         16  CO-CURRENT-YTD-TOTALS.
  1861             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1862             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1863
  1864     12  CO-PAID-COMM-TOTALS.
  1865         16  CO-YTD-PAID-COMMS.
  1866             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1867             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1868
  1869     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1870         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1871         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1872
  1873     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1874         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1875         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1876         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  35
* EL050.cbl
  1877         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1878         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1879         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1880         88  CO-FINAL-LETTER                  VALUE 'F'.
  1881         88  CO-RECONCILING                   VALUE 'R'.
  1882         88  CO-PHONE-CALL                    VALUE 'P'.
  1883         88  CO-LEGAL                         VALUE 'L'.
  1884         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1885         88  CO-WRITE-OFF                     VALUE 'W'.
  1886         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1887
  1888     12  CO-CSR-CODE                       PIC X(4).
  1889
  1890     12  CO-GA-STATUS-INFO.
  1891         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1892         16  CO-GA-TERMINATION-DT          PIC XX.
  1893         16  CO-GA-STATUS-CODE             PIC X.
  1894             88  CO-GA-ACTIVE                 VALUE 'A'.
  1895             88  CO-GA-INACTIVE               VALUE 'I'.
  1896             88  CO-GA-PENDING                VALUE 'P'.
  1897         16  CO-GA-COMMENTS.
  1898             20  CO-GA-COMMENT-1           PIC X(40).
  1899             20  CO-GA-COMMENT-2           PIC X(40).
  1900             20  CO-GA-COMMENT-3           PIC X(40).
  1901             20  CO-GA-COMMENT-4           PIC X(40).
  1902
  1903     12  CO-RPTCD2                         PIC X(10).
  1904     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1905         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1906         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1907
  1908     12  CO-TYPE-AGENT                     PIC X(01).
  1909         88  CO-CORPORATION                   VALUE 'C'.
  1910         88  CO-PARTNERSHIP                   VALUE 'P'.
  1911         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1912         88  CO-TRUST                         VALUE 'T'.
  1913         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1914
  1915     12  CO-FAXNO.
  1916         16  CO-FAX-AREA-CODE                  PIC XXX.
  1917         16  CO-FAX-PREFIX                     PIC XXX.
  1918         16  CO-FAX-PHONE                      PIC X(4).
  1919
  1920     12  CO-BANK-INFORMATION.
  1921         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1922         16  CO-BANK-TRANSIT-NON REDEFINES
  1923             CO-BANK-TRANSIT-NO                PIC 9(8).
  1924
  1925         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1926     12  CO-MISC-DEDUCT-INFO REDEFINES
  1927                  CO-BANK-INFORMATION.
  1928         16  CO-MD-GL-ACCT                     PIC X(10).
  1929         16  CO-MD-DIV                         PIC XX.
  1930         16  CO-MD-CENTER                      PIC X(4).
  1931         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1932         16  CO-CREATE-AP-CHECK                PIC X.
  1933         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1934         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  36
* EL050.cbl
  1935     12  CO-ACH-STATUS                         PIC X.
  1936         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1937         88  CO-ACH-PENDING                        VALUE 'P'.
  1938
  1939     12  CO-BILL-SW                            PIC X.
  1940     12  CO-CONTROL-NAME                       PIC X(30).
  1941     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1942     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1943     12  CO-CLP-STATE                          PIC XX.
  1944     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1945     12  CO-SPP-REFUND-EDIT                    PIC X.
  1946
  1947******************************************************************
  1948
  1949*    COPY ERCAGTC.
  1950******************************************************************
  1951*                                                                *
  1952*                                                                *
  1953*                            ERCAGTC                             *
  1954*                            VMOD=2.001                          *
  1955*                                                                *
  1956*   ONLINE CREDIT SYSTEM                                         *
  1957*                                                                *
  1958*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1959*                                                                *
  1960*   FILE TYPE = VSAM,KSDS                                        *
  1961*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1962*                                                                *
  1963*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1964*       ALTERNATE PATH = NONE                                    *
  1965*                                                                *
  1966*   LOG = NO                                                     *
  1967*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1968*                                                                *
  1969******************************************************************
  1970*                   C H A N G E   L O G
  1971*
  1972* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1973*-----------------------------------------------------------------
  1974*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1975* EFFECTIVE    NUMBER
  1976*-----------------------------------------------------------------
  1977* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1978* 111004                         NEW FILE AND COPYBOOK
  1979* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1980******************************************************************
  1981 01  AGENT-COMMISSIONS.
  1982     12  AG-RECORD-ID                          PIC XX.
  1983         88  VALID-CO-ID                          VALUE 'AG'.
  1984     12  AG-CONTROL-PRIMARY.
  1985         16  AG-COMPANY-CD                     PIC X.
  1986         16  AG-CONTROL.
  1987             20  AG-CTL-1.
  1988                 24  AG-CARR-GROUP.
  1989                     28  AG-CARRIER            PIC X.
  1990                     28  AG-GROUPING           PIC X(6).
  1991                 24  AG-BANK                   PIC X(10).
  1992             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  37
* EL050.cbl
  1993                 24  AG-EXP-DT                 PIC XX.
  1994         16  AG-TYPE                           PIC X.
  1995             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1996             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1997     12  AG-MAINT-INFORMATION.
  1998         16  AG-LAST-MAINT-DT                  PIC XX.
  1999         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2000         16  AG-LAST-MAINT-USER                PIC X(4).
  2001         16  FILLER                            PIC X(10).
  2002     12  AG-EFF-DT                             PIC XX.
  2003     12  AG-COMM-STRUCTURE.
  2004         16  AG-AGT-COMMS OCCURS 10.
  2005             20  AG-AGT                PIC X(10).
  2006             20  AG-COM-TYP            PIC X.
  2007             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2008             20  AG-RECALC-LV-INDIC    PIC X.
  2009             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2010             20  AG-LRCALC-LV-INDIC    PIC X.
  2011             20  FILLER                PIC X(05).
  2012     12  FILLER                  PIC X(145).
  2013******************************************************************
  2014*    COPY ERCRESS.
  2015******************************************************************
  2016*                                                                *
  2017*                            ERCRESS                             *
  2018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2019*                            VMOD=2.002                          *
  2020*                                                                *
  2021*   CREDIT RESIDENT STATE TAXES MASTER                          *
  2022*                                                                *
  2023*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  2024*   VSAM RESIDENT STATE TAX MASTER                              *
  2025*                                                                *
  2026*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  2027*                                                                *
  2028*   FILE TYPE = VSAM,KSDS                                        *
  2029*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  2030*                                                                *
  2031*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  2032*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  2033*                                                                *
  2034*   LOG = NO                                                     *
  2035*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2036*                                                                *
  2037*                                                                *
  2038******************************************************************
  2039
  2040 01  RESIDENT-STATE-TAX-MASTER.
  2041
  2042     10  ERRESS-PRIMARY-KEY.
  2043         15  RES-COMPANY-CD        PIC X.
  2044         15  RES-RESIDENT-STATE    PIC XX.
  2045         15  RES-COVERAGE-CATEGORY PIC X.
  2046         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  2047*                                      YYYYMMDD
  2048*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  2049
  2050     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  38
* EL050.cbl
  2051
  2052         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  2053         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2054         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  2055         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  2056
  2057     10 RES-RECALC-SW              PIC   X.
  2058         88 RECALC                VALUE 'Y'.
  2059         88 NO-RECALC             VALUE 'N'.
  2060     10  RES-MAINT-BY              PIC X(4).
  2061     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  2062     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  2063*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  39
* EL050.cbl
  2065*    COPY ERCRESC.
  2066******************************************************************
  2067*                                                                *
  2068*                            ERCRESC                             *
  2069*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2070*                            VMOD=2.003                          *
  2071*                                                                *
  2072*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  2073*                                                                *
  2074*   FILE TYPE = VSAM,KSDS                                        *
  2075*   RECORD SIZE = 103 RECFORM = FIXED                            *
  2076*                                                                *
  2077*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  2078*       ALTERNATE PATH1 = NONE                                   *
  2079*                                                                *
  2080*   LOG = NO                                                     *
  2081*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2082*                                                                *
  2083******************************************************************
  2084
  2085 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  2086
  2087     10  ERRESC-RECORD-KEY.
  2088         15  RESC-COMPANY-CD           PIC   X.
  2089         15  RESC-CARRIER              PIC   X.
  2090         15  RESC-GROUP                PIC   X(6).
  2091         15  RESC-STATE                PIC   XX.
  2092         15  RESC-ACCOUNT              PIC   X(10).
  2093         15  RESC-AGENT                PIC   X(10).
  2094         15  RESC-RESIDENT-STATE       PIC   XX.
  2095         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  2096*                                           YYYYMMDD
  2097     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  2098
  2099     10  RESC-COMM-RECORD-DATA.
  2100         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  2101             20 RESC-COVERAGE-CAT      PIC    X.
  2102             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  2103             20 RESC-COMMISSION-TAB REDEFINES
  2104                RESC-COMMISSION-PER    PIC  XXX.
  2105
  2106     10  RESC-MAINT-BY                 PIC X(4).
  2107     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2108     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2109*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  40
* EL050.cbl
  2111*    COPY ERCPLAN.
  2112******************************************************************
  2113*                                                                *
  2114*                                                                *
  2115*                            ERCPLAN                             *
  2116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2117*                            VMOD=2.003                          *
  2118*                                                                *
  2119*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2120*                                                                *
  2121*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2122*   PLAN MASTER                                                  *
  2123*                                                                *
  2124*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2125*                                                                *
  2126*   FILE TYPE = VSAM,KSDS                                        *
  2127*   RECORD SIZE = 420   RECFORM = FIX                            *
  2128*                                                                *
  2129*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2130*       ALTERNATE PATH1 = N/A                                    *
  2131*                                                                *
  2132*   LOG = NO                                                     *
  2133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2134*                                                                *
  2135*                                                                *
  2136******************************************************************
  2137
  2138 01  PLAN-MASTER.
  2139     12  PL-RECORD-ID                      PIC XX.
  2140         88  VALID-PL-ID                      VALUE 'PL'.
  2141
  2142     12  PL-CONTROL-PRIMARY.
  2143         16  PL-COMPANY-CD                 PIC X.
  2144         16  PL-MSTR-CNTRL.
  2145             20  PL-CONTROL-A.
  2146                 24  PL-CARRIER            PIC X.
  2147                 24  PL-GROUPING           PIC X(6).
  2148                 24  PL-STATE              PIC XX.
  2149                 24  PL-ACCOUNT            PIC X(10).
  2150             20  PL-BENEFIT-TYPE           PIC X.
  2151             20  PL-BENEFIT-CODE           PIC XX.
  2152             20  PL-REVISION-NO            PIC X(3).
  2153
  2154     12  PL-CONTROL-BY-VAR-GRP.
  2155         16  PL-COMPANY-CD-A1              PIC X.
  2156         16  PL-VG-CARRIER                 PIC X.
  2157         16  PL-VG-GROUPING                PIC X(6).
  2158         16  PL-VG-STATE                   PIC XX.
  2159         16  PL-VG-ACCOUNT                 PIC X(10).
  2160         16  PL-BENEFIT-TYPE-A1            PIC X.
  2161         16  PL-BENEFIT-CODE-A1            PIC XX.
  2162         16  PL-REVISION-NO-A1             PIC 999.
  2163
  2164     12  PL-MAINT-INFORMATION.
  2165         16  PL-LAST-MAINT-DT              PIC XX.
  2166         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2167         16  PL-LAST-MAINT-USER            PIC X(4).
  2168         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  41
* EL050.cbl
  2169
  2170     12  PL-LIABILITY-LIMITS.
  2171         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2172         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2173             20  PL-LM-AGE                 PIC S99        COMP-3.
  2174             20  PL-LM-DUR                 PIC S999       COMP-3.
  2175             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2176             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2177
  2178     12  FILLER                            PIC X(30).
  2179
  2180     12  PL-GL-ACCOUNT-NOS.
  2181         16  PL-PREMIUM-GL                 PIC X(8).
  2182         16  PL-COMM-GL                    PIC X(8).
  2183         16  PL-CLAIM-GL                   PIC X(8).
  2184     12  FILLER                            PIC X(24).
  2185     12  PL-TOLERANCES.
  2186         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2187         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2188         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2189         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2190         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2191         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2192     12  PL-OVER-SHORT.
  2193         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2194         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2195     12  FILLER                            PIC X(24).
  2196     12  PLAN-MISC.
  2197         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2198         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2199         16  PL-IG                         PIC X.
  2200         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2201         16  PL-POLICY-FORM                PIC X(12).
  2202         16  PL-EDIT-FOR-FORM              PIC X(01).
  2203         16  PL-DEV-CODE                   PIC XXX.
  2204         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2205         16  PL-CALC-METHOD                PIC X.
  2206         16  PL-BENEFIT-GROUP              PIC X(05).
  2207         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2208
  2209         16  FILLER                        PIC X(99).
  2210******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  42
* EL050.cbl
  2212*    COPY ELCCERT.
  2213******************************************************************
  2214*                                                                *
  2215*                            ELCCERT.                            *
  2216*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2217*                            VMOD=2.013                          *
  2218*                                                                *
  2219*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2220*                                                                *
  2221*   FILE TYPE = VSAM,KSDS                                        *
  2222*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2223*                                                                *
  2224*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2225*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2226*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2227*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2228*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2229*                                                                *
  2230*   LOG = YES                                                    *
  2231*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2232******************************************************************
  2233*                   C H A N G E   L O G
  2234*
  2235* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2236*-----------------------------------------------------------------
  2237*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2238* EFFECTIVE    NUMBER
  2239*-----------------------------------------------------------------
  2240* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2241* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2242* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2243* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2244* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2245* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2246* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2247* 032612  CR2011110200001  PEMA  AHL CHANGES
  2248* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2249* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2250* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  2251******************************************************************
  2252
  2253 01  CERTIFICATE-MASTER.
  2254     12  CM-RECORD-ID                      PIC XX.
  2255         88  VALID-CM-ID                      VALUE 'CM'.
  2256
  2257     12  CM-CONTROL-PRIMARY.
  2258         16  CM-COMPANY-CD                 PIC X.
  2259         16  CM-CARRIER                    PIC X.
  2260         16  CM-GROUPING.
  2261             20  CM-GROUPING-PREFIX        PIC X(3).
  2262             20  CM-GROUPING-PRIME         PIC X(3).
  2263         16  CM-STATE                      PIC XX.
  2264         16  CM-ACCOUNT.
  2265             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2266             20  CM-ACCOUNT-PRIME          PIC X(6).
  2267         16  CM-CERT-EFF-DT                PIC XX.
  2268         16  CM-CERT-NO.
  2269             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  43
* EL050.cbl
  2270             20  CM-CERT-SFX               PIC X.
  2271
  2272     12  CM-CONTROL-BY-NAME.
  2273         16  CM-COMPANY-CD-A1              PIC X.
  2274         16  CM-INSURED-LAST-NAME          PIC X(15).
  2275         16  CM-INSURED-INITIALS.
  2276             20  CM-INSURED-INITIAL1       PIC X.
  2277             20  CM-INSURED-INITIAL2       PIC X.
  2278
  2279     12  CM-CONTROL-BY-SSN.
  2280         16  CM-COMPANY-CD-A2              PIC X.
  2281         16  CM-SOC-SEC-NO.
  2282             20  CM-SSN-STATE              PIC XX.
  2283             20  CM-SSN-ACCOUNT            PIC X(6).
  2284             20  CM-SSN-LN3.
  2285                 25  CM-INSURED-INITIALS-A2.
  2286                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2287                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2288                 25 CM-PART-LAST-NAME-A2         PIC X.
  2289
  2290     12  CM-CONTROL-BY-CERT-NO.
  2291         16  CM-COMPANY-CD-A4              PIC X.
  2292         16  CM-CERT-NO-A4                 PIC X(11).
  2293
  2294     12  CM-CONTROL-BY-MEMB.
  2295         16  CM-COMPANY-CD-A5              PIC X.
  2296         16  CM-MEMBER-NO.
  2297             20  CM-MEMB-STATE             PIC XX.
  2298             20  CM-MEMB-ACCOUNT           PIC X(6).
  2299             20  CM-MEMB-LN4.
  2300                 25  CM-INSURED-INITIALS-A5.
  2301                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2302                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2303                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2304
  2305     12  CM-INSURED-PROFILE-DATA.
  2306         16  CM-INSURED-FIRST-NAME.
  2307             20  CM-INSURED-1ST-INIT       PIC X.
  2308             20  FILLER                    PIC X(9).
  2309         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2310         16  CM-INSURED-SEX                PIC X.
  2311             88  CM-SEX-MALE                  VALUE 'M'.
  2312             88  CM-SEX-FEMAL                 VALUE 'F'.
  2313         16  CM-INSURED-JOINT-AGE          PIC 99.
  2314         16  CM-JOINT-INSURED-NAME.
  2315             20  CM-JT-LAST-NAME           PIC X(15).
  2316             20  CM-JT-FIRST-NAME.
  2317                 24  CM-JT-1ST-INIT        PIC X.
  2318                 24  FILLER                PIC X(9).
  2319             20  CM-JT-INITIAL             PIC X.
  2320
  2321     12  CM-LIFE-DATA.
  2322         16  CM-LF-BENEFIT-CD              PIC XX.
  2323         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2324         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2325         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2326         16  CM-LF-DEV-CODE                PIC XXX.
  2327         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  44
* EL050.cbl
  2328         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2329         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2330         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2331         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2332         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2333         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2334         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2335         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2336         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2337         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2338         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2339         16  cm-temp-epiq                  pic xx.
  2340             88  EPIQ-CLASS                  value 'EQ'.
  2341*        16  FILLER                        PIC XX.
  2342
  2343     12  CM-AH-DATA.
  2344         16  CM-AH-BENEFIT-CD              PIC XX.
  2345         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2346         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2347         16  CM-AH-DEV-CODE                PIC XXX.
  2348         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2349         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2350         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2351         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2352         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2353         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2354         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2355         16  CM-AH-PAID-THRU-DT            PIC XX.
  2356             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2357         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2358         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2359         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2360         16  FILLER                        PIC X.
  2361
  2362     12  CM-LOAN-INFORMATION.
  2363         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2364         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2365                                           PIC S9(5)V99  COMP-3.
  2366         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2367         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2368         16  CM-PAY-FREQUENCY              PIC S99.
  2369         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2370         16  CM-RATE-CLASS                 PIC XX.
  2371         16  CM-BENEFICIARY                PIC X(25).
  2372         16  CM-POLICY-FORM-NO             PIC X(12).
  2373         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2374         16  CM-LAST-ADD-ON-DT             PIC XX.
  2375         16  CM-DEDUCTIBLE-AMOUNTS.
  2376             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2377             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2378         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2379             20  CM-RESIDENT-STATE         PIC XX.
  2380             20  CM-RATE-CODE              PIC X(4).
  2381             20  FILLER                    PIC XX.
  2382         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2383             20  CM-LOAN-OFFICER           PIC X(5).
  2384             20  FILLER                    PIC XXX.
  2385         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  45
* EL050.cbl
  2386         16  CM-UNDERWRITING-CODE          PIC X.
  2387             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2388         16  CM-POST-CARD-IND              PIC X.
  2389         16  CM-REF-INTERFACE-SW           PIC X.
  2390         16  CM-PREMIUM-TYPE               PIC X.
  2391             88  CM-SING-PRM                  VALUE '1'.
  2392             88  CM-O-B-COVERAGE              VALUE '2'.
  2393             88  CM-OPEN-END                  VALUE '3'.
  2394         16  CM-IND-GRP-TYPE               PIC X.
  2395             88  CM-INDIVIDUAL                VALUE 'I'.
  2396             88  CM-GROUP                     VALUE 'G'.
  2397         16  CM-SKIP-CODE                  PIC X.
  2398             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2399             88  SKIP-JULY                    VALUE '1'.
  2400             88  SKIP-AUGUST                  VALUE '2'.
  2401             88  SKIP-SEPTEMBER               VALUE '3'.
  2402             88  SKIP-JULY-AUG                VALUE '4'.
  2403             88  SKIP-AUG-SEPT                VALUE '5'.
  2404             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2405             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2406             88  SKIP-JUNE                    VALUE '8'.
  2407             88  SKIP-JUNE-JULY               VALUE '9'.
  2408             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2409             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2410         16  CM-PAYMENT-MODE               PIC X.
  2411             88  PAY-MONTHLY                  VALUE SPACE.
  2412             88  PAY-WEEKLY                   VALUE '1'.
  2413             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2414             88  PAY-BI-WEEKLY                VALUE '3'.
  2415             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2416         16  CM-LOAN-NUMBER                PIC X(8).
  2417         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2418         16  CM-OLD-LOF                    PIC XXX.
  2419*        16  CM-LOAN-OFFICER               PIC XXX.
  2420         16  CM-REIN-TABLE                 PIC XXX.
  2421         16  CM-SPECIAL-REIN-CODE          PIC X.
  2422         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2423         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2424         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2425
  2426     12  CM-STATUS-DATA.
  2427         16  CM-ENTRY-STATUS               PIC X.
  2428         16  CM-ENTRY-DT                   PIC XX.
  2429
  2430         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2431         16  CM-LF-CANCEL-DT               PIC XX.
  2432         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2433
  2434         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2435         16  CM-LF-DEATH-DT                PIC XX.
  2436         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2437
  2438         16  CM-LF-CURRENT-STATUS          PIC X.
  2439             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2440                                                'M' '4' '5' '9'.
  2441             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2442             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2443             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  46
* EL050.cbl
  2444             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2445             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2446             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2447             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2448             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2449             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2450             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2451             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2452             88  CM-LF-DECLINED               VALUE 'D'.
  2453             88  CM-LF-VOIDED                 VALUE 'V'.
  2454
  2455         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2456         16  CM-AH-CANCEL-DT               PIC XX.
  2457         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2458
  2459         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2460         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2461         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2462
  2463         16  CM-AH-CURRENT-STATUS          PIC X.
  2464             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2465                                                'M' '4' '5' '9'.
  2466             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2467             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2468             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2469             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2470             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2471             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2472             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2473             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2474             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2475             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2476             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2477             88  CM-AH-DECLINED               VALUE 'D'.
  2478             88  CM-AH-VOIDED                 VALUE 'V'.
  2479
  2480         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2481             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2482             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2483             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2484         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2485
  2486         16  CM-ENTRY-BATCH                PIC X(6).
  2487         16  CM-LF-EXIT-BATCH              PIC X(6).
  2488         16  CM-AH-EXIT-BATCH              PIC X(6).
  2489         16  CM-LAST-MONTH-END             PIC XX.
  2490
  2491     12  CM-NOTE-SW                        PIC X.
  2492         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2493         88  CERT-NOTES-PRESENT               VALUE '1'.
  2494         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2495         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2496         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2497         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2498         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2499         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2500     12  CM-COMP-EXCP-SW                   PIC X.
  2501         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  47
* EL050.cbl
  2502         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2503     12  CM-INSURED-ADDRESS-SW             PIC X.
  2504         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2505         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2506
  2507*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2508     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2509     12  FILLER                            PIC X.
  2510
  2511*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2512     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2513     12  FILLER                            PIC X.
  2514*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2515     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  2516
  2517     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2518         88  CERT-ADDED-BATCH                 VALUE ' '.
  2519         88  CERT-ADDED-ONLINE                VALUE '1'.
  2520         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2521         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2522         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2523     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2524         88  CERT-AS-LOADED                   VALUE ' '.
  2525         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2526         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2527         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2528         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2529         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2530         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2531         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2532
  2533     12  CM-ACCOUNT-COMM-PCTS.
  2534         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2535         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2536
  2537     12  CM-USER-FIELD                     PIC X.
  2538     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2539     12  CM-CLP-STATE                      PIC XX.
  2540     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2541     12  CM-USER-RESERVED                  PIC XXX.
  2542     12  FILLER REDEFINES CM-USER-RESERVED.
  2543         16  CM-AH-CLASS-CD                PIC XX.
  2544         16  F                             PIC X.
  2545******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  48
* EL050.cbl
  2547*    COPY ERCMAIL.
  2548******************************************************************
  2549*                                                                *
  2550*                                                                *
  2551*                            ERCMAIL                             *
  2552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2553*                            VMOD=2.003                          *
  2554*                                                                *
  2555*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2556*                                                                *
  2557*   FILE TYPE = VSAM,KSDS                                        *
  2558*   RECORD SIZE = 374   RECFORM = FIX                            *
  2559*                                                                *
  2560*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2561*   ALTERNATE PATH    = NOT USED                                 *
  2562*                                                                *
  2563*   LOG = YES                                                    *
  2564*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2565******************************************************************
  2566*                   C H A N G E   L O G
  2567*
  2568* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2569*-----------------------------------------------------------------
  2570*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2571* EFFECTIVE    NUMBER
  2572*-----------------------------------------------------------------
  2573* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2574* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2575* 111108                   PEMA  ADD CRED BENE ADDR2
  2576******************************************************************
  2577
  2578 01  MAILING-DATA.
  2579     12  MA-RECORD-ID                      PIC XX.
  2580         88  VALID-MA-ID                       VALUE 'MA'.
  2581
  2582     12  MA-CONTROL-PRIMARY.
  2583         16  MA-COMPANY-CD                 PIC X.
  2584         16  MA-CARRIER                    PIC X.
  2585         16  MA-GROUPING.
  2586             20  MA-GROUPING-PREFIX        PIC XXX.
  2587             20  MA-GROUPING-PRIME         PIC XXX.
  2588         16  MA-STATE                      PIC XX.
  2589         16  MA-ACCOUNT.
  2590             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2591             20  MA-ACCOUNT-PRIME          PIC X(6).
  2592         16  MA-CERT-EFF-DT                PIC XX.
  2593         16  MA-CERT-NO.
  2594             20  MA-CERT-PRIME             PIC X(10).
  2595             20  MA-CERT-SFX               PIC X.
  2596
  2597     12  FILLER                            PIC XX.
  2598
  2599     12  MA-ACCESS-CONTROL.
  2600         16  MA-SOURCE-SYSTEM              PIC XX.
  2601             88  MA-FROM-CREDIT                VALUE 'CR'.
  2602             88  MA-FROM-VSI                   VALUE 'VS'.
  2603             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2604             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  49
* EL050.cbl
  2605         16  MA-RECORD-ADD-DT              PIC XX.
  2606         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2607         16  MA-LAST-MAINT-DT              PIC XX.
  2608         16  MA-LAST-MAINT-BY              PIC XXXX.
  2609         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2610
  2611     12  MA-PROFILE-INFO.
  2612         16  MA-QUALIFY-CODE-1             PIC XX.
  2613         16  MA-QUALIFY-CODE-2             PIC XX.
  2614         16  MA-QUALIFY-CODE-3             PIC XX.
  2615         16  MA-QUALIFY-CODE-4             PIC XX.
  2616         16  MA-QUALIFY-CODE-5             PIC XX.
  2617
  2618         16  MA-INSURED-LAST-NAME          PIC X(15).
  2619         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2620         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2621         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2622         16  MA-INSURED-BIRTH-DT           PIC XX.
  2623         16  MA-INSURED-SEX                PIC X.
  2624             88  MA-SEX-MALE                   VALUE 'M'.
  2625             88  MA-SEX-FEMALE                 VALUE 'F'.
  2626         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2627
  2628         16  MA-ADDRESS-CORRECTED          PIC X.
  2629         16  MA-JOINT-BIRTH-DT             PIC XX.
  2630*        16  FILLER                        PIC X(12).
  2631
  2632         16  MA-ADDRESS-LINE-1             PIC X(30).
  2633         16  MA-ADDRESS-LINE-2             PIC X(30).
  2634         16  MA-CITY-STATE.
  2635             20  MA-CITY                   PIC X(28).
  2636             20  MA-ADDR-STATE             PIC XX.
  2637         16  MA-ZIP.
  2638             20  MA-ZIP-CODE.
  2639                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2640                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2641                 24  FILLER                PIC X(4).
  2642             20  MA-ZIP-PLUS4              PIC X(4).
  2643         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2644             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2645             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2646             20  FILLER                    PIC X(3).
  2647
  2648         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2649
  2650         16  FILLER                        PIC XXX.
  2651*        16  FILLER                        PIC X(10).
  2652
  2653     12  MA-CRED-BENE-INFO.
  2654         16  MA-CRED-BENE-NAME                 PIC X(25).
  2655         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2656         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2657         16  MA-CRED-BENE-CTYST.
  2658             20  MA-CRED-BENE-CITY             PIC X(28).
  2659             20  MA-CRED-BENE-STATE            PIC XX.
  2660         16  MA-CRED-BENE-ZIP.
  2661             20  MA-CB-ZIP-CODE.
  2662                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  50
* EL050.cbl
  2663                     88  MA-CB-CANADIAN-POST-CODE
  2664                                           VALUE 'A' THRU 'Z'.
  2665                 24  FILLER                    PIC X(4).
  2666             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2667         16  MA-CB-CANADIAN-POSTAL-CODE
  2668                            REDEFINES MA-CRED-BENE-ZIP.
  2669             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2670             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2671             20  FILLER                        PIC X(3).
  2672     12  MA-POST-CARD-MAIL-DATA.
  2673         16  MA-MAIL-DATA OCCURS 7.
  2674             20  MA-MAIL-TYPE              PIC X.
  2675                 88  MA-12MO-MAILING           VALUE '1'.
  2676                 88  MA-EXP-MAILING            VALUE '2'.
  2677             20  MA-MAIL-STATUS            PIC X.
  2678                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2679                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2680                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2681             20  MA-MAIL-DATE              PIC XX.
  2682     12  FILLER                            PIC XX.
  2683     12  FILLER                            PIC XX.
  2684*    12  FILLER                            PIC X(30).
  2685******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  51
* EL050.cbl
  2687*    COPY ERCPNDM.
  2688******************************************************************
  2689*                                                                *
  2690*                                                                *
  2691*                            ERCPNDM                             *
  2692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2693*                            VMOD=2.003                          *
  2694*                                                                *
  2695*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2696*                                                                *
  2697*   FILE TYPE = VSAM,KSDS                                        *
  2698*   RECORD SIZE = 374   RECFORM = FIX                            *
  2699*                                                                *
  2700*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2701*   ALTERNATE PATH    = NOT USED                                 *
  2702*                                                                *
  2703*   LOG = YES                                                    *
  2704*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2705******************************************************************
  2706*                   C H A N G E   L O G
  2707*
  2708* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2709*-----------------------------------------------------------------
  2710*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2711* EFFECTIVE    NUMBER
  2712*-----------------------------------------------------------------
  2713* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2714* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2715* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2716* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  2717******************************************************************
  2718
  2719 01  PENDING-MAILING-DATA.
  2720     12  PM-RECORD-ID                      PIC XX.
  2721         88  VALID-MA-ID                       VALUE 'PM'.
  2722
  2723     12  PM-CONTROL-PRIMARY.
  2724         16  PM-COMPANY-CD                 PIC X.
  2725         16  PM-ENTRY-BATCH                PIC X(6).
  2726         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2727         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2728
  2729     12  FILLER                            PIC X(14).
  2730
  2731     12  PM-ACCESS-CONTROL.
  2732         16  PM-SOURCE-SYSTEM              PIC XX.
  2733             88  PM-FROM-CREDIT                VALUE 'CR'.
  2734             88  PM-FROM-VSI                   VALUE 'VS'.
  2735             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2736             88  PM-FROM-OTHER                 VALUE 'OT'.
  2737         16  PM-RECORD-ADD-DT              PIC XX.
  2738         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2739         16  PM-LAST-MAINT-DT              PIC XX.
  2740         16  PM-LAST-MAINT-BY              PIC XXXX.
  2741         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2742
  2743     12  PM-PROFILE-INFO.
  2744         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  52
* EL050.cbl
  2745         16  PM-QUALIFY-CODE-2             PIC XX.
  2746         16  PM-QUALIFY-CODE-3             PIC XX.
  2747         16  PM-QUALIFY-CODE-4             PIC XX.
  2748         16  PM-QUALIFY-CODE-5             PIC XX.
  2749
  2750         16  PM-INSURED-LAST-NAME          PIC X(15).
  2751         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2752         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2753         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2754         16  PM-INSURED-BIRTH-DT           PIC XX.
  2755         16  PM-INSURED-SEX                PIC X.
  2756             88  PM-SEX-MALE                   VALUE 'M'.
  2757             88  PM-SEX-FEMALE                 VALUE 'F'.
  2758         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2759
  2760         16  PM-ADDRESS-CORRECTED          PIC X.
  2761         16  PM-JOINT-BIRTH-DT             PIC XX.
  2762*        16  FILLER                        PIC X(12).
  2763
  2764         16  PM-ADDRESS-LINE-1             PIC X(30).
  2765         16  PM-ADDRESS-LINE-2             PIC X(30).
  2766         16  PM-CITY-STATE.
  2767             20  PM-CITY                   PIC X(28).
  2768             20  PM-STATE                  PIC XX.
  2769         16  PM-ZIP.
  2770             20  PM-ZIP-CODE.
  2771                 24  PM-ZIP-1              PIC X.
  2772                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2773                 24  FILLER                PIC X(4).
  2774             20  PM-ZIP-PLUS4              PIC X(4).
  2775         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2776             20  PM-CAN-POST1              PIC XXX.
  2777             20  PM-CAN-POST2              PIC XXX.
  2778             20  FILLER                    PIC XXX.
  2779
  2780         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2781         16  pm-city-st-zip-verified       pic x.
  2782         16  FILLER                        PIC XX.
  2783
  2784     12  PM-CRED-BENE-INFO.
  2785         16  PM-CRED-BENE-NAME             PIC X(25).
  2786         16  PM-CRED-BENE-ADDR             PIC X(30).
  2787         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2788         16  PM-CRED-BENE-CTYST.
  2789             20  PM-CRED-BENE-CITY         PIC X(28).
  2790             20  PM-CRED-BENE-STATE        PIC XX.
  2791         16  PM-CRED-BENE-ZIP.
  2792             20  PM-CB-ZIP-CODE.
  2793                 24  PM-CB-ZIP-1           PIC X.
  2794                     88  PM-CB-CANADIAN-POST-CODE
  2795                                  VALUE 'A' THRU 'Z'.
  2796                 24  FILLER                PIC X(4).
  2797             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2798         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2799             20  PM-CB-CAN-POST1           PIC XXX.
  2800             20  PM-CB-CAN-POST2           PIC XXX.
  2801             20  FILLER                    PIC XXX.
  2802     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  53
* EL050.cbl
  2803         16  PM-MAIL-DATA OCCURS 7.
  2804             20  PM-MAIL-TYPE              PIC X.
  2805                 88  PM-12MO-MAILING           VALUE '1'.
  2806                 88  PM-EXP-MAILING            VALUE '2'.
  2807             20  PM-MAIL-STATUS            PIC X.
  2808                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2809                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2810                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2811             20  PM-MAIL-DATE              PIC XX.
  2812     12  FILLER                            PIC XX.
  2813     12  FILLER                            PIC X(12).
  2814*    12  FILLER                            PIC X(30).
  2815
  2816******************************************************************
  2817*                                COPY ERCLOFC.
  2818******************************************************************
  2819*                                                                *
  2820*                                                                *
  2821*                            ERCLOFC                             *
  2822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2823*                            VMOD=2.003                          *
  2824*                                                                *
  2825*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2826*                                                                *
  2827*   FILE TYPE = VSAM,KSDS                                        *
  2828*   RECORD SIZE = 670   RECFORM = FIX                            *
  2829*                                                                *
  2830*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2831*                                                                *
  2832*   LOG = YES                                                    *
  2833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2834*                                                                *
  2835******************************************************************
  2836
  2837 01  LOAN-OFFICER-MASTER.
  2838     12  LO-RECORD-ID                PIC XX.
  2839         88  VALID-LO-ID                VALUE 'LO'.
  2840
  2841     12  LO-CONTROL-PRIMARY.
  2842         16  LO-COMPANY-CD           PIC X.
  2843         16  LO-CARRIER              PIC X.
  2844         16  LO-GROUPING.
  2845             20  LO-GROUPING-PREFIX  PIC XXX.
  2846             20  LO-GROUPING-PRIME   PIC XXX.
  2847         16  LO-STATE                PIC XX.
  2848         16  LO-ACCOUNT.
  2849             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2850             20  LO-ACCOUNT-PRIME    PIC X(6).
  2851         16  LO-OFFICER-CODE         PIC X(5).
  2852
  2853     12  LO-OFFICER-NAME             PIC X(30).
  2854
  2855     12  LO-LAST-MAINT-DT            PIC XX.
  2856     12  LO-LAST-USER                PIC X(4).
  2857     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2858
  2859     12  LO-COMP-CONTROL             PIC X.
  2860             88  LO-SHOW-COMP           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  54
* EL050.cbl
  2861             88  LO-SUPPRESS-COMP       VALUE 'N'.
  2862     12  LO-DETAIL-CONTROL           PIC X.
  2863             88  LO-PRINT-DETAIL        VALUE 'D'.
  2864             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2865
  2866     12  LO-SV-CARRIER               PIC X.
  2867     12  LO-SV-GROUPING              PIC X(6).
  2868     12  LO-SV-STATE                 PIC XX.
  2869
  2870     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2871     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2872
  2873     12  LO-OFFICER-INFO.
  2874         16  FILLER OCCURS 12 TIMES.
  2875             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2876             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2877             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2878             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2879             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2880             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2881             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2882             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2883     12  FILLER                      PIC X(198).
  2884******************************************************************
  2885*                                COPY ERCPDEF.
  2886******************************************************************
  2887*                                                                *
  2888*                                                                *
  2889*                            ERCPDEF.                            *
  2890*                                                                *
  2891*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2892*                                                                *
  2893*    FILE TYPE = VSAM,KSDS                                       *
  2894*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2895*                                                                *
  2896*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2897*                                                                *
  2898*    LOG = YES                                                   *
  2899*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2900******************************************************************
  2901*                   C H A N G E   L O G
  2902*
  2903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2904*-----------------------------------------------------------------
  2905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2906* EFFECTIVE    NUMBER
  2907*-----------------------------------------------------------------
  2908* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2909* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2910* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2911* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  2912******************************************************************
  2913 01  PRODUCT-MASTER.
  2914    12  PD-RECORD-ID                 PIC X(02).
  2915        88  VALID-PD-ID                  VALUE 'PD'.
  2916    12  PD-CONTROL-PRIMARY.
  2917        16  PD-COMPANY-CD            PIC X.
  2918        16  PD-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  55
* EL050.cbl
  2919        16  PD-PRODUCT-CD            PIC XXX.
  2920        16  PD-FILLER                PIC X(7).
  2921        16  PD-BEN-TYPE              PIC X.
  2922        16  PD-BEN-CODE              PIC XX.
  2923        16  PD-PROD-EXP-DT           PIC XX.
  2924    12  FILLER                       PIC X(50).
  2925    12  PD-PRODUCT-DATA OCCURS 8.
  2926        16  PD-PROD-CODE             PIC X.
  2927            88  PD-PROD-LIFE           VALUE 'L'.
  2928            88  PD-PROD-PROP           VALUE 'P'.
  2929            88  PD-PROD-AH             VALUE 'A'.
  2930            88  PD-PROD-IU             VALUE 'I'.
  2931            88  PD-PROD-GAP            VALUE 'G'.
  2932            88  PD-PROD-FAML           VALUE 'F'.
  2933            88  PD-PROD-OTH            VALUE 'O'.
  2934        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2935        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2936        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2937        16  PD-MAX-TERM              PIC S999        COMP-3.
  2938        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2939        16  FILLER                   PIC X.
  2940        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2941        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2942        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2943        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2944        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2945        16  PD-REC-CRIT-PERIOD       PIC 99.
  2946        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2947            20  PD-RECURRING-YN      PIC X.
  2948            20  FILLER               PIC X.
  2949        16  PD-RTW-MOS               PIC 99.
  2950        16  PD-MAX-EXTENSION         PIC 99.
  2951        16  pd-ben-pct               pic sv999 comp-3.
  2952*       16  FILLER                   PIC XX.
  2953    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2954    12  PD-TERM-LIMITS OCCURS 15.
  2955        16  PD-LOW-TERM              PIC S999        COMP-3.
  2956        16  PD-HI-TERM               PIC S999        COMP-3.
  2957*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2958    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2959        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2960        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2961    12  PD-EARN-FACTORS.
  2962        16  FILLER OCCURS 15.
  2963            20  FILLER OCCURS 15.
  2964                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2965    12  PD-PRODUCT-DESC              PIC X(80).
  2966    12  PD-TRUNCATED                 PIC X.
  2967    12  FILLER                       PIC X(59).
  2968    12  PD-MAINT-INFORMATION.
  2969        16  PD-LAST-MAINT-DT         PIC X(02).
  2970        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2971        16  PD-LAST-MAINT-BY         PIC X(04).
  2972*                                COPY ELCSTATE.
  2973******************************************************************
  2974*                                                                *
  2975*                                                                *
  2976*                            ELCSTATE.                           *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  56
* EL050.cbl
  2977*                                                                *
  2978*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2979*                                                                *
  2980*   FILE TYPE = VSAM,KSDS                                        *
  2981*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2982*                                                                *
  2983*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2984*       ALTERNATE INDEX = NONE                                   *
  2985*                                                                *
  2986*   LOG = YES                                                    *
  2987*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2988******************************************************************
  2989*                   C H A N G E   L O G
  2990*
  2991* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2992*-----------------------------------------------------------------
  2993*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2994* EFFECTIVE    NUMBER
  2995*-----------------------------------------------------------------
  2996* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2997******************************************************************
  2998*
  2999 01  STATE-FILE.
  3000     12  SF-RECORD-ID                       PIC XX.
  3001         88  VALID-CF-ID                        VALUE 'SF'.
  3002     12  SF-CONTROL-PRIMARY.
  3003         16  SF-COMPANY-ID                  PIC XXX.
  3004         16  SF-CARRIER-CODE                PIC X.
  3005         16  SF-GROUPING                    PIC X(6).
  3006         16  SF-STATE-CODE                  PIC XX.
  3007         16  SF-EXPIRE-DATE                 PIC 9(8).
  3008****************************************************************
  3009*             STATE CONTROLS
  3010****************************************************************
  3011     12  SF-LAST-MAINT-DT                   PIC XX.
  3012     12  SF-LAST-MAINT-BY                   PIC X(4).
  3013     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3014     12  SF-STATE-RT-CONTROLS.
  3015         16  SF-ST-RT-CALC                  PIC X.
  3016     12  SF-ST-TAX-CONTROLS.
  3017         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3018         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3019         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3020     12  SF-ST-REFUND-OPTIONS.
  3021         16  SF-ST-RF-LR-CALC               PIC X.
  3022         16  SF-ST-RF-LL-CALC               PIC X.
  3023         16  SF-ST-RF-LN-CALC               PIC X.
  3024         16  SF-ST-RF-AH-CALC               PIC X.
  3025         16  SF-ST-RF-CP-CALC               PIC X.
  3026     12  SF-ST-UNEARN-PREM-OPTIONS.
  3027         16  SF-ST-LUEP-R78                 PIC X.
  3028         16  SF-ST-LUEP-PRO                 PIC X.
  3029         16  SF-ST-LUEP-ST                  PIC X.
  3030         16  SF-ST-LUEP-DOM                 PIC X.
  3031         16  SF-ST-AUEP-R78                 PIC X.
  3032         16  SF-ST-AUEP-PRO                 PIC X.
  3033         16  SF-ST-AUEP-ST                  PIC X.
  3034         16  SF-ST-AUEP-DOM                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  57
* EL050.cbl
  3035         16  SF-ST-CUEP-R78                 PIC X.
  3036         16  SF-ST-CUEP-PRO                 PIC X.
  3037         16  SF-ST-CUEP-ST                  PIC X.
  3038         16  SF-ST-CUEP-DOM                 PIC X.
  3039     12  SF-ST-EARN-PREM-OPTIONS.
  3040         16  SF-ST-LEP-R78                  PIC X.
  3041         16  SF-ST-LEP-PRO                  PIC X.
  3042         16  SF-ST-LEP-ST                   PIC X.
  3043         16  SF-ST-LEP-DOM                  PIC X.
  3044         16  SF-ST-AEP-R78                  PIC X.
  3045         16  SF-ST-AEP-PRO                  PIC X.
  3046         16  SF-ST-AEP-ST                   PIC X.
  3047         16  SF-ST-AEP-DOM                  PIC X.
  3048         16  SF-ST-CEP-R78                  PIC X.
  3049         16  SF-ST-CEP-PRO                  PIC X.
  3050         16  SF-ST-CEP-ST                   PIC X.
  3051         16  SF-ST-CEP-DOM                  PIC X.
  3052     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  58
* EL050.cbl
  3054*    COPY ELCCRTT.
  3055******************************************************************
  3056*                                                                *
  3057*                            ELCCRTT.                            *
  3058*                                                                *
  3059*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3060*                                                                *
  3061*   FILE TYPE = VSAM,KSDS                                        *
  3062*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3063*                                                                *
  3064*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3065*                                                                *
  3066*   LOG = YES                                                    *
  3067*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3068******************************************************************
  3069*                   C H A N G E   L O G
  3070*
  3071* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3072*-----------------------------------------------------------------
  3073*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3074* EFFECTIVE    NUMBER
  3075*-----------------------------------------------------------------
  3076* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3077* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3078* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3079* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3080* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3081* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3082* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3083* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3084* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3085* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  3086* 091318  CR2018073000001  PEMA  ADD Refund methods
  3087* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  3088******************************************************************
  3089
  3090 01  CERTIFICATE-TRAILERS.
  3091     12  CS-RECORD-ID                      PIC XX.
  3092         88  VALID-CS-ID                      VALUE 'CS'.
  3093
  3094     12  CS-CONTROL-PRIMARY.
  3095         16  CS-COMPANY-CD                 PIC X.
  3096         16  CS-CARRIER                    PIC X.
  3097         16  CS-GROUPING                   PIC X(6).
  3098         16  CS-STATE                      PIC XX.
  3099         16  CS-ACCOUNT                    PIC X(10).
  3100         16  CS-CERT-EFF-DT                PIC XX.
  3101         16  CS-CERT-NO.
  3102             20  CS-CERT-PRIME             PIC X(10).
  3103             20  CS-CERT-SFX               PIC X.
  3104         16  CS-TRAILER-TYPE               PIC X.
  3105             88  COMM-TRLR           VALUE 'A'.
  3106             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3107             88  CERT-DATA-TRLR      VALUE 'C'.
  3108
  3109     12  CS-DATA-AREA                      PIC X(516).
  3110
  3111     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  59
* EL050.cbl
  3112         16  CS-BANK-COMMISSION-AREA.
  3113             20  CS-BANK-COMMS       OCCURS 10.
  3114                 24  CS-AGT                PIC X(10).
  3115                 24  CS-COM-TYP            PIC X.
  3116                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3117                 24  CS-RECALC-LV-INDIC    PIC X.
  3118                 24  FILLER                PIC X(10).
  3119         16  FILLER                        PIC X(256).
  3120
  3121     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3122****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3123         16  CS-MB-CLAIM-DATA OCCURS 24.
  3124             20  CS-CLAIM-NO               PIC X(7).
  3125             20  CS-CLAIM-TYPE             PIC X.
  3126                 88  CS-AH-CLM               VALUE 'A'.
  3127                 88  CS-IU-CLM               VALUE 'I'.
  3128                 88  CS-GP-CLM               VALUE 'G'.
  3129                 88  CS-LF-CLM               VALUE 'L'.
  3130                 88  CS-PR-CLM               VALUE 'P'.
  3131                 88  CS-FL-CLM               VALUE 'F'.
  3132                 88  CS-OT-CLM               VALUE 'O'.
  3133             20  CS-INSURED-TYPE           PIC X.
  3134                 88  CS-PRIM-INSURED          VALUE 'P'.
  3135                 88  CS-CO-BORROWER           VALUE 'C'.
  3136             20  CS-BENEFIT-PERIOD         PIC 99.
  3137             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3138             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3139             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3140         16  FILLER                        PIC X(12).
  3141     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3142         16  CS-VIN-NUMBER                 PIC X(17).
  3143         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3144         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3145         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3146         16  cs-agent-name.
  3147             20  cs-agent-fname            pic x(20).
  3148             20  cs-agent-mi               pic x.
  3149             20  cs-agent-lname            pic x(25).
  3150         16  cs-license-no                 pic x(15).
  3151         16  cs-npn-number                 pic x(10).
  3152         16  cs-agent-edit-status          pic x.
  3153             88  cs-ae-refer-to-manager      value 'M'.
  3154             88  cs-ae-cover-sheet           value 'C'.
  3155             88  cs-ae-sig-form              value 'S'.
  3156             88  cs-ae-verified              value 'V'.
  3157             88  cs-unidentified-signature   value 'U'.
  3158             88  cs-cert-returned            value 'R'.
  3159             88  cs-accept-no-commission     value 'N'.
  3160         16  cs-year                       pic 9999.
  3161         16  cs-make                       pic x(20).
  3162         16  cs-model                      pic x(20).
  3163         16  cs-future                     pic x(20).
  3164         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3165         16  cs-claim-verification-status  pic x.
  3166             88  cs-clm-ver-eligible         value 'A'.
  3167             88  cs-clm-ver-partial-elig     value 'B'.
  3168             88  cs-clm-ver-not-eligible     value 'C'.
  3169             88  cs-clm-ver-not-elig-opn-clm value 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  60
* EL050.cbl
  3170             88  cs-clm-ver-not-part-elig-rw value 'E'.
  3171             88  cs-clm-ver-ND-CERT          value 'F'.
  3172             88  cs-clm-ver-spec-other       value 'G'.
  3173             88  cs-clam-ver-pratial-corrected
  3174                                             value 'H'.
  3175             88  cs-clm-ver-no-matches       value 'I'.
  3176             88  cs-clm-ver-not-elig-corrected
  3177                                             value 'J'.
  3178             88  cs-clm-ver-needs-review     value 'R'.
  3179             88  cs-clm-ver-sent-to-claims   value 'W'.
  3180         16  CS-LF-REFUND-METHOD           PIC X.
  3181         16  CS-AH-REFUND-METHOD           PIC X.
  3182         16  FILLER                        PIC X(353). *> was 420
  3183*        16  FILLER                        PIC X(496).
  3184*    COPY ELCCRTO.
  3185******************************************************************
  3186*                                                                *
  3187*                            ELCCRTO.                            *
  3188*                                                                *
  3189*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3190*                                                                *
  3191*   FILE TYPE = VSAM,KSDS                                        *
  3192*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3193*                                                                *
  3194*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3195*                                                                *
  3196*   LOG = YES                                                    *
  3197*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3198******************************************************************
  3199*                   C H A N G E   L O G
  3200*
  3201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3202*-----------------------------------------------------------------
  3203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3204* EFFECTIVE    NUMBER
  3205*-----------------------------------------------------------------
  3206* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3207* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3208* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3209* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3210* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3211******************************************************************
  3212 01  ORIGINAL-CERTIFICATE.
  3213     12  OC-RECORD-ID                      PIC XX.
  3214         88  VALID-OC-ID                      VALUE 'OC'.
  3215     12  OC-CONTROL-PRIMARY.
  3216         16  OC-COMPANY-CD                 PIC X.
  3217         16  OC-CARRIER                    PIC X.
  3218         16  OC-GROUPING                   PIC X(6).
  3219         16  OC-STATE                      PIC XX.
  3220         16  OC-ACCOUNT                    PIC X(10).
  3221         16  OC-CERT-EFF-DT                PIC XX.
  3222         16  OC-CERT-NO.
  3223             20  OC-CERT-PRIME             PIC X(10).
  3224             20  OC-CERT-SFX               PIC X.
  3225         16  OC-RECORD-TYPE                PIC X.
  3226         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3227     12  OC-LAST-MAINT-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  61
* EL050.cbl
  3228     12  OC-LAST-MAINT-BY                  PIC X(4).
  3229     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3230     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3231     12  FILLER                            PIC X(49).
  3232     12  OC-ORIG-REC.
  3233         16  OC-INS-LAST-NAME              PIC X(15).
  3234         16  OC-INS-FIRST-NAME             PIC X(10).
  3235         16  OC-INS-MIDDLE-INIT            PIC X.
  3236         16  OC-INS-AGE                    PIC S999     COMP-3.
  3237         16  OC-JNT-LAST-NAME              PIC X(15).
  3238         16  OC-JNT-FIRST-NAME             PIC X(10).
  3239         16  OC-JNT-MIDDLE-INIT            PIC X.
  3240         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3241         16  OC-LF-BENCD                   PIC XX.
  3242         16  OC-LF-TERM                    PIC S999      COMP-3.
  3243         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3244         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3245         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3246         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3247         16  OC-LF-EXP-DT                  PIC XX.
  3248         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3249         16  OC-LF-CANCEL-DT               PIC XX.
  3250         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3251         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3252         16  OC-AH-BENCD                   PIC XX.
  3253         16  OC-AH-TERM                    PIC S999      COMP-3.
  3254         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3255         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3256         16  OC-AH-EXP-DT                  PIC XX.
  3257         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3258         16  OC-AH-CP                      PIC 99.
  3259         16  OC-AH-CANCEL-DT               PIC XX.
  3260         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3261         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3262         16  OC-CRED-BENE-NAME             PIC X(25).
  3263         16  OC-1ST-PMT-DT                 PIC XX.
  3264         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3265         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3266         16  OC-ISSUE-TRAN-IND             PIC X.
  3267         16  OC-CANCEL-TRAN-IND            PIC X.
  3268         16  FILLER                        PIC X(211).
  3269
  3270     12  FILLER                            PIC X(50).
  3271******************************************************************
  3272
  3273*    COPY ELCDATE.
  3274******************************************************************
  3275*                                                                *
  3276*                                                                *
  3277*                            ELCDATE.                            *
  3278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3279*                            VMOD=2.003
  3280*                                                                *
  3281*                                                                *
  3282*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3283*                 LENGTH = 200                                   *
  3284******************************************************************
  3285
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  62
* EL050.cbl
  3286 01  DATE-CONVERSION-DATA.
  3287     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3288     12  DC-OPTION-CODE                PIC X.
  3289         88  BIN-TO-GREG                VALUE ' '.
  3290         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3291         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3292         88  YMD-GREG-TO-BIN            VALUE '3'.
  3293         88  MDY-GREG-TO-BIN            VALUE '4'.
  3294         88  JULIAN-TO-BIN              VALUE '5'.
  3295         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3296         88  FIND-CENTURY               VALUE '7'.
  3297         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3298         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3299         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3300         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3301         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3302         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3303         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3304         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3305         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3306         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3307         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3308         88  BIN-3-TO-GREG              VALUE 'I'.
  3309         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3310         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3311         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3312         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3313         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3314         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3315         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3316         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3317         88  THREE-CHARACTER-BIN
  3318                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3319         88  GREGORIAN-TO-BIN
  3320                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3321         88  BIN-TO-GREGORIAN
  3322                  VALUES ' ' '1' 'I' '8' 'G'.
  3323         88  JULIAN-TO-BINARY
  3324                  VALUES '5' 'C' 'E' 'F'.
  3325     12  DC-ERROR-CODE                 PIC X.
  3326         88  NO-CONVERSION-ERROR        VALUE ' '.
  3327         88  DATE-CONVERSION-ERROR
  3328                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3329         88  DATE-IS-ZERO               VALUE '1'.
  3330         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3331         88  DATE-IS-INVALID            VALUE '3'.
  3332         88  DATE1-GREATER-DATE2        VALUE '4'.
  3333         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3334         88  DATE-INVALID-OPTION        VALUE '9'.
  3335         88  INVALID-CENTURY            VALUE 'A'.
  3336         88  ONLY-CENTURY               VALUE 'B'.
  3337         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3338         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3339     12  DC-END-OF-MONTH               PIC X.
  3340         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3341     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3342         88  USE-NORMAL-PROCESS         VALUE ' '.
  3343         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  63
* EL050.cbl
  3344         88  ADJUST-UP-100-YRS          VALUE '2'.
  3345     12  FILLER                        PIC X.
  3346     12  DC-CONVERSION-DATES.
  3347         16  DC-BIN-DATE-1             PIC XX.
  3348         16  DC-BIN-DATE-2             PIC XX.
  3349         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3350         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3351                       DC-GREG-DATE-1-EDIT.
  3352             20  DC-EDIT1-MONTH        PIC 99.
  3353             20  SLASH1-1              PIC X.
  3354             20  DC-EDIT1-DAY          PIC 99.
  3355             20  SLASH1-2              PIC X.
  3356             20  DC-EDIT1-YEAR         PIC 99.
  3357         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3358         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3359                     DC-GREG-DATE-2-EDIT.
  3360             20  DC-EDIT2-MONTH        PIC 99.
  3361             20  SLASH2-1              PIC X.
  3362             20  DC-EDIT2-DAY          PIC 99.
  3363             20  SLASH2-2              PIC X.
  3364             20  DC-EDIT2-YEAR         PIC 99.
  3365         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3366         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3367                     DC-GREG-DATE-1-YMD.
  3368             20  DC-YMD-YEAR           PIC 99.
  3369             20  DC-YMD-MONTH          PIC 99.
  3370             20  DC-YMD-DAY            PIC 99.
  3371         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3372         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3373                      DC-GREG-DATE-1-MDY.
  3374             20  DC-MDY-MONTH          PIC 99.
  3375             20  DC-MDY-DAY            PIC 99.
  3376             20  DC-MDY-YEAR           PIC 99.
  3377         16  DC-GREG-DATE-1-ALPHA.
  3378             20  DC-ALPHA-MONTH        PIC X(10).
  3379             20  DC-ALPHA-DAY          PIC 99.
  3380             20  FILLER                PIC XX.
  3381             20  DC-ALPHA-CENTURY.
  3382                 24 DC-ALPHA-CEN-N     PIC 99.
  3383             20  DC-ALPHA-YEAR         PIC 99.
  3384         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3385         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3386         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3387         16  DC-JULIAN-DATE            PIC 9(05).
  3388         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3389                                       PIC 9(05).
  3390         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3391             20  DC-JULIAN-YEAR        PIC 99.
  3392             20  DC-JULIAN-DAYS        PIC 999.
  3393         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3394         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3395         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3396     12  DATE-CONVERSION-VARIBLES.
  3397         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3398         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3399             20  FILLER                PIC 9(3).
  3400             20  HOLD-CEN-1-CCYY.
  3401                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  64
* EL050.cbl
  3402                 24  HOLD-CEN-1-YY     PIC 99.
  3403             20  HOLD-CEN-1-MO         PIC 99.
  3404             20  HOLD-CEN-1-DA         PIC 99.
  3405         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3406             20  HOLD-CEN-1-R-MO       PIC 99.
  3407             20  HOLD-CEN-1-R-DA       PIC 99.
  3408             20  HOLD-CEN-1-R-CCYY.
  3409                 24  HOLD-CEN-1-R-CC   PIC 99.
  3410                 24  HOLD-CEN-1-R-YY   PIC 99.
  3411             20  FILLER                PIC 9(3).
  3412         16  HOLD-CENTURY-1-X.
  3413             20  FILLER                PIC X(3)  VALUE SPACES.
  3414             20  HOLD-CEN-1-X-CCYY.
  3415                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3416                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3417             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3418             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3419         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3420             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3421             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3422             20  HOLD-CEN-1-R-X-CCYY.
  3423                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3424                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3425             20  FILLER                PIC XXX.
  3426         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3427         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3428         16  DC-JULIAN-DATE-1          PIC 9(07).
  3429         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3430             20  DC-JULIAN-1-CCYY.
  3431                 24  DC-JULIAN-1-CC    PIC 99.
  3432                 24  DC-JULIAN-1-YR    PIC 99.
  3433             20  DC-JULIAN-DA-1        PIC 999.
  3434         16  DC-JULIAN-DATE-2          PIC 9(07).
  3435         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3436             20  DC-JULIAN-2-CCYY.
  3437                 24  DC-JULIAN-2-CC    PIC 99.
  3438                 24  DC-JULIAN-2-YR    PIC 99.
  3439             20  DC-JULIAN-DA-2        PIC 999.
  3440         16  DC-GREG-DATE-A-EDIT.
  3441             20  DC-EDITA-MONTH        PIC 99.
  3442             20  SLASHA-1              PIC X VALUE '/'.
  3443             20  DC-EDITA-DAY          PIC 99.
  3444             20  SLASHA-2              PIC X VALUE '/'.
  3445             20  DC-EDITA-CCYY.
  3446                 24  DC-EDITA-CENT     PIC 99.
  3447                 24  DC-EDITA-YEAR     PIC 99.
  3448         16  DC-GREG-DATE-B-EDIT.
  3449             20  DC-EDITB-MONTH        PIC 99.
  3450             20  SLASHB-1              PIC X VALUE '/'.
  3451             20  DC-EDITB-DAY          PIC 99.
  3452             20  SLASHB-2              PIC X VALUE '/'.
  3453             20  DC-EDITB-CCYY.
  3454                 24  DC-EDITB-CENT     PIC 99.
  3455                 24  DC-EDITB-YEAR     PIC 99.
  3456         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3457         16  DC-GREG-DATE-CYMD-R REDEFINES
  3458                              DC-GREG-DATE-CYMD.
  3459             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  65
* EL050.cbl
  3460             20  DC-CYMD-YEAR          PIC 99.
  3461             20  DC-CYMD-MONTH         PIC 99.
  3462             20  DC-CYMD-DAY           PIC 99.
  3463         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3464         16  DC-GREG-DATE-MDCY-R REDEFINES
  3465                              DC-GREG-DATE-MDCY.
  3466             20  DC-MDCY-MONTH         PIC 99.
  3467             20  DC-MDCY-DAY           PIC 99.
  3468             20  DC-MDCY-CEN           PIC 99.
  3469             20  DC-MDCY-YEAR          PIC 99.
  3470    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3471        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3472    12  DC-EL310-DATE                  PIC X(21).
  3473    12  FILLER                         PIC X(28).
  3474
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  66
* EL050.cbl
  3476*    COPY ELCCALC.
  3477******************************************************************
  3478*                                                                *
  3479*                           ELCCALC.                            *
  3480*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3481*                            VMOD=2.025                          *
  3482*                                                                *
  3483*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3484*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3485*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3486*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3487*                                                                *
  3488*  PASSED TO ELRTRM                                              *
  3489*  -----------------                                             *
  3490*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3491*  ORIGINAL TERM                                                 *
  3492*  BEGINNING DATE                                                *
  3493*  ENDING DATE                                                   *
  3494*  COMPANY I.D.                                                  *
  3495*  ACCOUNT MASTER USER FIELD                                     *
  3496*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3497*  FREE LOOK DAYS                                                *
  3498*                                                                *
  3499*  RETURNED FROM ELRTRM                                          *
  3500*  ---------------------                                         *
  3501*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3502*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3503*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3504*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3505*----------------------------------------------------------------*
  3506*  PASSED TO ELRAMT                                              *
  3507*  ----------------                                              *
  3508*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3509*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3510*  ORIGINAL AMOUNT                                               *
  3511*  ALTERNATE BENEFIT (BALLON)                                    *
  3512*  A.P.R. - NET PAY ONLY                                         *
  3513*  METHOD
  3514*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3515*  COMPANY I.D.                                                  *
  3516*  BENEFIT TYPE                                                  *
  3517*                                                                *
  3518*  RETURNED FROM ELRAMT                                          *
  3519*  --------------------                                          *
  3520*  REMAINING AMOUNT 1 - CURRENT                                  *
  3521*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3522*  REMAINING AMOUNT FACTOR
  3523*----------------------------------------------------------------*
  3524*  PASSED TO ELRESV                                              *
  3525*  -----------------                                             *
  3526*  CERTIFICATE EFFECTIVE DATE                                    *
  3527*  VALUATION DATE                                                *
  3528*  PAID THRU DATE                                                *
  3529*  BENEFIT                                                       *
  3530*  INCURRED DATE                                                 *
  3531*  REPORTED DATE                                                 *
  3532*  ISSUE AGE                                                     *
  3533*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  67
* EL050.cbl
  3534*  CDT PERCENT                                                   *
  3535*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3536* *CLAIM TYPE (LIFE, A/H)                                        *
  3537* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3538* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3539*                                                                *
  3540*  RETURNED FROM ELRESV                                          *
  3541*  --------------------                                          *
  3542*  CDT TABLE USED                                                *
  3543*  CDT FACTOR USED                                               *
  3544*  PAY TO CURRENT RESERVE                                        *
  3545*  I.B.N.R. - A/H ONLY                                           *
  3546*  FUTURE (ACCRUED) AH ONLY                                      *
  3547*----------------------------------------------------------------*
  3548*  PASSED TO ELRATE                                              *
  3549*  ----------------                                              *
  3550*  CERT ISSUE DATE                                               *
  3551*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3552*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3553*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3554*  STATE CODE (CLIENT DEFINED)                                   *
  3555*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3556*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3557*  DEVIATION CODE                                                *
  3558*  ISSUE AGE                                                     *
  3559*  ORIGINAL BENEFIT AMOUNT                                       *
  3560*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3561*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3562*  BENEFIT KIND (LIFE OR A/H)                                    *
  3563*  A.P.R.                                                        *
  3564*  METHOD
  3565*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3566*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3567*  COMPANY I.D. (3 CHARACTER)                                    *
  3568*  BENEFIT CODE                                                  *
  3569*  BENEFIT OVERRIDE CODE                                         *
  3570*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3571*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3572*  JOINT INDICATOR (CSL ONLY)                                    *
  3573*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3574*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3575*                                                                *
  3576*  RETURNED FROM ELRATE                                          *
  3577*  --------------------                                          *
  3578*  CALCULATED PREMIUM                                            *
  3579*  PREMIUM RATE                                                  *
  3580*  MORTALITY CODE                                                *
  3581*  MAX ATTAINED AGE                                              *
  3582*  MAX AGE                                                       *
  3583*  MAX TERM                                                      *
  3584*  MAX MONTHLY BENEFIT                                           *
  3585*  MAX TOTAL BENIFIT                                             *
  3586*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3587*----------------------------------------------------------------*
  3588*  PASSED TO ELRFND                                              *
  3589*  ----------------                                              *
  3590*  CERT ISSUE DATE                                               *
  3591*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  68
* EL050.cbl
  3592*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3593*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3594*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3595*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3596*  STATE CODE (CLIENT DEFINED)                                   *
  3597*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3598*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3599*  DEVIATION CODE                                                *
  3600*  ISSUE AGE                                                     *
  3601*  ORIGINAL BENEFIT AMOUNT                                       *
  3602*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3603*  PROCESS TYPE (CANCEL)                                         *
  3604*  BENEFIT KIND (LIFE OR A/H)                                    *
  3605*  A.P.R.                                                        *
  3606*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3607*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3608*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3609*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3610*  COMPANY I.D. (3 CHARACTER)                                    *
  3611*  BENEFIT CODE                                                  *
  3612*  BENEFIT OVERRIDE CODE                                         *
  3613*                                                                *
  3614*  RETURNED FROM ELRFND                                          *
  3615*  --------------------                                          *
  3616*  CALCULATED REFUND                                             *
  3617*----------------------------------------------------------------*
  3618*  PASSED TO ELEARN                                              *
  3619*  ----------------                                              *
  3620*  CERT ISSUE DATE                                               *
  3621*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3622*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3623*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3624*  STATE CODE (CLIENT DEFINED)                                   *
  3625*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3626*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3627*  DEVIATION CODE                                                *
  3628*  ISSUE AGE                                                     *
  3629*  ORIGINAL BENEFIT AMOUNT                                       *
  3630*  BENEFIT KIND (LIFE OR A/H)                                    *
  3631*  A.P.R.                                                        *
  3632*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3633*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3634*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3635*  COMPANY I.D. (3 CHARACTER)                                    *
  3636*  BENEFIT CODE                                                  *
  3637*  BENEFIT OVERRIDE CODE                                         *
  3638*                                                                *
  3639*  RETURNED FROM ELEARN                                          *
  3640*  --------------------                                          *
  3641*  INDICATED  EARNINGS                                           *
  3642*----------------------------------------------------------------*
  3643*                 LENGTH = 450                                   *
  3644*                                                                *
  3645******************************************************************
  3646******************************************************************
  3647*                   C H A N G E   L O G
  3648*
  3649* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  69
* EL050.cbl
  3650*-----------------------------------------------------------------
  3651*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3652* EFFECTIVE    NUMBER
  3653*-----------------------------------------------------------------
  3654* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3655* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3656* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3657* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3658* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3659* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3660* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3661* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3662* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3663* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3664* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3665******************************************************************
  3666
  3667 01  CALCULATION-PASS-AREA.
  3668     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3669                                     COMP.
  3670
  3671     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3672       88  NO-CP-ERROR                             VALUE ZERO.
  3673       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3674                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3675       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3676       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3677       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3678       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3679       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3680       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3681       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3682       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3683       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3684       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3685       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3686       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3687       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3688       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3689       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3690       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3691       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3692
  3693     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3694       88  NO-CP-ERROR-2                           VALUE ZERO.
  3695***********************  INPUT AREAS ****************************
  3696
  3697     12  CP-CALCULATION-AREA.
  3698         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3699         16  CP-CERT-EFF-DT        PIC XX.
  3700         16  CP-VALUATION-DT       PIC XX.
  3701         16  CP-PAID-THRU-DT       PIC XX.
  3702         16  CP-BENEFIT-TYPE       PIC X.
  3703           88  CP-AH                               VALUE 'A' 'D'
  3704                                                   'I' 'U'.
  3705           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3706           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3707         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  70
* EL050.cbl
  3708         16  CP-REPORTED-DT        PIC XX.
  3709         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3710         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3711         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3712                                     COMP-3.
  3713         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3714                                     COMP-3.
  3715         16  CP-CDT-METHOD         PIC X.
  3716           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3717           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3718           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3719         16  CP-CLAIM-TYPE         PIC X.
  3720           88  CP-AH-CLAIM                         VALUE 'A'.
  3721           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3722         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3725                                     COMP-3.
  3726         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3727                                     COMP-3.
  3728         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3729                                     COMP-3.
  3730         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3735                                     COMP-3.
  3736         16  CP-REM-TERM-METHOD    PIC X.
  3737           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3738           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3739           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3740           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3741           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3742           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3743           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3744         16  CP-EARNING-METHOD     PIC X.
  3745           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3746           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3747           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3748           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3749           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3750           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3751           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3752           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3753           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3754           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3755           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3756           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3757           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3758           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3759         16  CP-PROCESS-TYPE       PIC X.
  3760           88  CP-CLAIM                            VALUE '1'.
  3761           88  CP-CANCEL                           VALUE '2'.
  3762           88  CP-ISSUE                            VALUE '3'.
  3763         16  CP-SPECIAL-CALC-CD    PIC X.
  3764           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3765           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  71
* EL050.cbl
  3766           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3767           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3768           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3769           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3770           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3771           88  CP-FARM-PLAN                    VALUE 'F'.
  3772           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3773           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3774           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3775           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3776           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3777           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3778           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3779           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3780           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3781           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3782                                                     'W' 'X'.
  3783           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3784           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3785           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3786           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3787           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3788           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3789           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3790           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3791           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3792           88  CP-CSL-METH-1                   VALUE '5'.
  3793           88  CP-CSL-METH-2                   VALUE '6'.
  3794           88  CP-CSL-METH-3                   VALUE '7'.
  3795           88  CP-CSL-METH-4                   VALUE '8'.
  3796
  3797         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3798                                     COMP-3.
  3799         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3800         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3801         16  CP-STATE              PIC XX          VALUE SPACE.
  3802         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3803         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3804           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3805               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3806         16  CP-R78-OPTION         PIC X.
  3807           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3808           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3809
  3810         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3811         16  CP-IBNR-RESERVE-SW    PIC X.
  3812         16  CP-CLAIM-STATUS       PIC X.
  3813         16  CP-RATE-FILE          PIC X.
  3814         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3815                                     COMP-3.
  3816
  3817         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3818         16  CP-AH-OVERRIDE-CODE   PIC X.
  3819
  3820         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3823                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  72
* EL050.cbl
  3824         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3831                                  PIC S9(7)V99 COMP-3.
  3832
  3833         16  CP-PAID-FROM-DATE     PIC X(02).
  3834         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3835         16  CP-EXT-DAYS-CALC      PIC X.
  3836           88  CP-EXT-NO-CHG                   VALUE ' '.
  3837           88  CP-EXT-CHG-LF                   VALUE '1'.
  3838           88  CP-EXT-CHG-AH                   VALUE '2'.
  3839           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3840         16  CP-DOMICILE-STATE     PIC XX.
  3841         16  CP-CARRIER            PIC X.
  3842         16  CP-REIN-FLAG          PIC X.
  3843         16  CP-REM-TRM-CALC-OPTION PIC X.
  3844           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3845                      '2' '3' '4' '5'.
  3846           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3847           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3848           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3849           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3850           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3851           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3852           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3853           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3854         16  CP-SIG-SWITCH         PIC X.
  3855         16  CP-RATING-METHOD      PIC X.
  3856           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3857           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3858           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3859           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3860           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3861           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3862           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3863           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3864           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3865         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3866                                     COMP-3.
  3867         16  CP-BEN-CATEGORY       PIC X.
  3868         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3869         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3870                                   PIC S99V9(5) COMP-3.
  3871         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3872         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3873                                   PIC S99V9(5) COMP-3.
  3874         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3875         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3876         16  CP-EXPIRE-DT          PIC XX.
  3877         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3878         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3879         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3880         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3881         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  73
* EL050.cbl
  3882             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3883             88  CP-CALC-CLP              VALUE 'C'.
  3884         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3885         16  CP-CANCEL-REASON      PIC X.
  3886         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3887         16  CP-PMT-MODE           PIC X.
  3888         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3889         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3890         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3891         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3892         16  FILLER                PIC X.
  3893
  3894***************    OUTPUT FROM ELRESV   ************************
  3895
  3896         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3897
  3898         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3899                                     COMP-3.
  3900         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3901                                     COMP-3.
  3902         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3903                                     COMP-3.
  3904         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3905                                     COMP-3.
  3906         16  FILLER                PIC X(09).
  3907***************    OUTPUT FROM ELRTRM   *************************
  3908
  3909         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3910                                     COMP-3.
  3911         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3912                                     COMP-3.
  3913         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3914                                     COMP-3.
  3915         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3916                                     COMP-3.
  3917         16  FILLER                PIC X(12).
  3918
  3919***************    OUTPUT FROM ELRAMT   *************************
  3920
  3921         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3922                                     COMP-3.
  3923         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3924                                     COMP-3.
  3925         16  FILLER                PIC X(12).
  3926
  3927***************    OUTPUT FROM ELRATE   *************************
  3928
  3929         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3930                                     COMP-3.
  3931         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3932                                     COMP-3.
  3933         16  CP-MORTALITY-CODE     PIC X(4).
  3934         16  CP-RATE-EDIT-FLAG     PIC X.
  3935             88  CP-RATES-NEED-APR                  VALUE '1'.
  3936         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3937                                     COMP-3.
  3938         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3939         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  74
* EL050.cbl
  3940         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3941                                   PIC S9(7)V99 COMP-3.
  3942         16  FILLER                PIC X(07).
  3943
  3944***************    OUTPUT FROM ELRFND   *************************
  3945
  3946         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3947                                     COMP-3.
  3948         16  CP-REFUND-TYPE-USED   PIC X.
  3949           88  CP-R-AS-R78                         VALUE '1'.
  3950           88  CP-R-AS-PRORATA                     VALUE '2'.
  3951           88  CP-R-AS-CALIF                       VALUE '3'.
  3952           88  CP-R-AS-TEXAS                       VALUE '4'.
  3953           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3954           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3955           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3956           88  CP-R-AS-MEAN                        VALUE '8'.
  3957           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3958           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3959           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3960           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3961           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3962           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3963         16  FILLER                PIC X(12).
  3964
  3965***************    OUTPUT FROM ELEARN   *************************
  3966
  3967         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3968                                     COMP-3.
  3969         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3970                                     COMP-3.
  3971         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3972                                     COMP-3.
  3973         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3974                                     COMP-3.
  3975         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3976                                     COMP-3.
  3977         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3978                                     COMP-3.
  3979         16  CP-EARNING-TYPE-USED  PIC X.
  3980           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3981           88  CP-E-AS-R78                         VALUE '1'.
  3982           88  CP-E-AS-PRORATA                     VALUE '2'.
  3983           88  CP-E-AS-TEXAS                       VALUE '4'.
  3984           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3985           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3986           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3987           88  CP-E-AS-MEAN                        VALUE '8'.
  3988           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3989         16  FILLER                PIC X(12).
  3990
  3991***************    OUTPUT FROM ELPMNT   *************************
  3992
  3993         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3994                                     COMP-3.
  3995         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3996                                     COMP-3.
  3997         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  75
* EL050.cbl
  3998
  3999***************   MISC WORK AREAS    *****************************
  4000         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  4001                                     COMP-3.
  4002         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  4003                                     COMP-3.
  4004         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  4005                                     COMP-3.
  4006         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  4007                                     COMP-3.
  4008         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  4009                                     COMP-3.
  4010         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  4011                                     COMP-3.
  4012         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  4013             88  OPEN-RATE-FILE                   VALUE 'O'.
  4014             88  CLOSE-RATE-FILE                  VALUE 'C'.
  4015             88  IO-ERROR                         VALUE 'E'.
  4016
  4017         16  CP-FIRST-PAY-DATE     PIC XX.
  4018
  4019         16  CP-JOINT-INDICATOR    PIC X.
  4020
  4021         16  CP-RESERVE-REMAINING-TERM
  4022                                   PIC S9(4)V9    VALUE ZERO
  4023                                     COMP-3.
  4024
  4025         16  CP-INSURED-BIRTH-DT   PIC XX.
  4026
  4027         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  4028                                     COMP-3.
  4029
  4030         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  4031                                     COMP-3.
  4032
  4033         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  4034                                     COMP-3.
  4035
  4036         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  4037                                     COMP-3.
  4038
  4039         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  4040                                     COMP-3.
  4041
  4042         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  4043                                     COMP-3.
  4044
  4045         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  4046                                     COMP-3.
  4047
  4048         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  4049             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  4050
  4051         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  4052                                     COMP-3.
  4053         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  4054                                     COMP-3.
  4055         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  76
* EL050.cbl
  4056         16  cp-extra-periods      pic 9 value zeros.
  4057         16  cp-net-only-state     pic x value spaces.
  4058         16  FILLER                PIC X(13).
  4059******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  77
* EL050.cbl
  4061******************************************************************
  4062*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  4063*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  4064*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  4065*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  4066*** MODIFICATION.                                              ***
  4067*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  4068*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  4069******************************************************************
  4070*    COPY ERCPNDB.
  4071******************************************************************
  4072*                                                                *
  4073*                                                                *
  4074*                            ERCPNDB.                            *
  4075*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4076*                            VMOD=2.025                          *
  4077*                                                                *
  4078*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4079*                                                                *
  4080******************************************************************
  4081*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4082*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4083******************************************************************
  4084*                                                                *
  4085*                                                                *
  4086*   FILE TYPE = VSAM,KSDS                                        *
  4087*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4088*                                                                *
  4089*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4090*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4091*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4092*                                                 RKP=13,LEN=36  *
  4093*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4094*                                      AND CHG-SEQ.)             *
  4095*                                                RKP=49,LEN=11   *
  4096*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4097*                                      AND CHG-SEQ.)             *
  4098*                                                RKP=60,LEN=15   *
  4099*                                                                *
  4100*   LOG = NO                                                     *
  4101*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4102******************************************************************
  4103******************************************************************
  4104*                   C H A N G E   L O G
  4105*
  4106* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4107*-----------------------------------------------------------------
  4108*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4109* EFFECTIVE    NUMBER
  4110*-----------------------------------------------------------------
  4111* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4112* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4113* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4114* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4115* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4116* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4117* 032306                   PEMA  ADD BOW LOAN NUMBER
  4118* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  78
* EL050.cbl
  4119* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4120* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4121* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4122* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4123* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4125* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4126* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4127* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4128* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4129* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4130******************************************************************
  4131
  4132 01  PENDING-BUSINESS.
  4133     12  PB-RECORD-ID                     PIC XX.
  4134         88  VALID-PB-ID                        VALUE 'PB'.
  4135
  4136     12  PB-CONTROL-PRIMARY.
  4137         16  PB-COMPANY-CD                PIC X.
  4138         16  PB-ENTRY-BATCH               PIC X(6).
  4139         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4140         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4141
  4142     12  PB-CONTROL-BY-ACCOUNT.
  4143         16  PB-COMPANY-CD-A1             PIC X.
  4144         16  PB-CARRIER                   PIC X.
  4145         16  PB-GROUPING.
  4146             20  PB-GROUPING-PREFIX       PIC XXX.
  4147             20  PB-GROUPING-PRIME        PIC XXX.
  4148         16  PB-STATE                     PIC XX.
  4149         16  PB-ACCOUNT.
  4150             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4151             20  PB-ACCOUNT-PRIME         PIC X(6).
  4152         16  PB-CERT-EFF-DT               PIC XX.
  4153         16  PB-CERT-NO.
  4154             20  PB-CERT-PRIME            PIC X(10).
  4155             20  PB-CERT-SFX              PIC X.
  4156         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4157
  4158         16  PB-RECORD-TYPE               PIC X.
  4159             88  PB-MAILING-DATA                VALUE '0'.
  4160             88  PB-ISSUE                       VALUE '1'.
  4161             88  PB-CANCELLATION                VALUE '2'.
  4162             88  PB-BATCH-TRAILER               VALUE '9'.
  4163
  4164     12  PB-CONTROL-BY-ORIG-BATCH.
  4165         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4166         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4167         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4168         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4169
  4170     12  PB-CONTROL-BY-CSR.
  4171         16  PB-CSR-COMPANY-CD            PIC X.
  4172         16  PB-CSR-ID                    PIC X(4).
  4173         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4174         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4175         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4176******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  79
* EL050.cbl
  4177*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4178******************************************************************
  4179
  4180     12  PB-LAST-MAINT-DT                 PIC XX.
  4181     12  PB-LAST-MAINT-BY                 PIC X(4).
  4182     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4183
  4184     12  PB-RECORD-BODY                   PIC X(375).
  4185
  4186     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4187         16  PB-CERT-ORIGIN               PIC X.
  4188             88  CLASIC-CREATED-CERT         VALUE '1'.
  4189         16  PB-I-NAME.
  4190             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4191             20  PB-I-INSURED-FIRST-NAME.
  4192                 24  PB-I-INSURED-1ST-INIT PIC X.
  4193                 24  FILLER                PIC X(9).
  4194             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4195         16  PB-I-AGE                     PIC S99   COMP-3.
  4196         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4197         16  PB-I-BIRTHDAY                PIC XX.
  4198         16  PB-I-INSURED-SEX             PIC X.
  4199             88  PB-SEX-MALE     VALUE 'M'.
  4200             88  PB-SEX-FEMALE   VALUE 'F'.
  4201
  4202         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4203         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4204         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4205         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4206         16  PB-I-SKIP-CODE               PIC X.
  4207             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4208             88  PB-SKIP-JULY              VALUE '1'.
  4209             88  PB-SKIP-AUGUST            VALUE '2'.
  4210             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4211             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4212             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4213             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4214             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4215             88  PB-SKIP-JUNE              VALUE '8'.
  4216             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4217             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4218             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4219         16  PB-I-TERM-TYPE               PIC X.
  4220             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4221             88  PB-PAID-WEEKLY            VALUE 'W'.
  4222             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4223             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4224             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4225         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4226         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4227         16  PB-I-DATA-ENTRY-SW           PIC X.
  4228             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4229             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4230             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4231             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4232         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4233         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4234*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  80
* EL050.cbl
  4235         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4236         16  FILLER                       PIC X.
  4237
  4238         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4239             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4240             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4241                                                   '90' THRU '99'.
  4242         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4243                                          PIC XX.
  4244         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4245         16  PB-I-AMOUNT-FINANCED REDEFINES
  4246                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4247         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4248         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4249                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4250         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4251         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4252         16  PB-I-CLP-AMOUNT REDEFINES
  4253                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4254         16  PB-I-LF-CALC-FLAG            PIC X.
  4255             88 PB-COMP-LF-PREM               VALUE '?'.
  4256         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4257         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4258         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4259         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4260         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4261         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4262         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4263         16  PB-I-LF-ABBR                 PIC XXX.
  4264         16  PB-I-LF-INPUT-CD             PIC XX.
  4265
  4266         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4267             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4268             88  PB-INVALID-AH               VALUE '  ' '00'
  4269                                                   '90' THRU '99'.
  4270         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4271         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4272         16  PB-I-AH-CALC-FLAG            PIC X.
  4273             88 PB-COMP-AH-PREM                  VALUE '?'.
  4274         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4275         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4276         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4277         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4278         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4279         16  PB-I-AH-ABBR                 PIC XXX.
  4280         16  PB-I-AH-INPUT-CD             PIC XXX.
  4281
  4282         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4283         16  PB-I-REIN-TABLE              PIC XXX.
  4284         16  PB-I-BUSINESS-TYPE           PIC 99.
  4285         16  PB-I-INDV-GRP-CD             PIC X.
  4286         16  PB-I-MORT-CODE.
  4287             20  PB-I-TABLE               PIC X.
  4288             20  PB-I-INTEREST            PIC XX.
  4289             20  PB-I-MORT-TYP            PIC X.
  4290         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4291         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4292         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  81
* EL050.cbl
  4293         16  PB-I-INDV-GRP-OVRD           PIC X.
  4294         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4295         16  PB-I-SIG-SW                  PIC X.
  4296             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4297         16  PB-I-RATE-CLASS              PIC XX.
  4298         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4299         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4300         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4301         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4302         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4303         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4304         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4305         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4306         16  PB-I-OB-FLAG                 PIC X.
  4307             88  PB-I-OB                      VALUE 'B'.
  4308             88  PB-I-SUMMARY                 VALUE 'Z'.
  4309         16  PB-I-ENTRY-STATUS            PIC X.
  4310             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4311                                              'M' '5' '9' '2'.
  4312             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4313             88  PB-I-POLICY-PENDING          VALUE '2'.
  4314             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4315             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4316             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4317             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4318             88  PB-I-REIN-ONLY               VALUE '9'.
  4319             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4320             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4321             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4322             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4323         16  PB-I-INT-CODE                PIC X.
  4324             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4325             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4326         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4327         16  PB-I-SOC-SEC-NO              PIC X(11).
  4328         16  PB-I-MEMBER-NO               PIC X(12).
  4329         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4330*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4331         16  PB-I-OLD-LOF                 PIC XXX.
  4332         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4333         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4334         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4335         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4336         16  PB-I-LIFE-INDICATOR          PIC X.
  4337             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4338         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4339         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4340                                          PIC S9(5)V99    COMP-3.
  4341         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4342             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4343             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4344         16  PB-I-1ST-PMT-DT              PIC XX.
  4345         16  PB-I-JOINT-INSURED.
  4346             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4347             20 PB-I-JOINT-FIRST-NAME.
  4348                24  PB-I-JOINT-FIRST-INIT PIC X.
  4349                24  FILLER                PIC X(9).
  4350             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  82
* EL050.cbl
  4351*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4352         16  PB-I-BENEFICIARY-NAME.
  4353             20  PB-I-BANK-NUMBER         PIC X(10).
  4354             20  FILLER                   PIC X(15).
  4355         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4356         16  PB-I-REFERENCE               PIC X(12).
  4357         16  FILLER REDEFINES PB-I-REFERENCE.
  4358             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4359             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4360             20  PB-I-CLP-STATE           PIC XX.
  4361         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4362             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4363             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4364             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4365         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4366         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4367         16  PB-I-RESIDENT-STATE          PIC XX.
  4368         16  PB-I-RATE-CODE               PIC X(4).
  4369         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4370         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4371         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4372         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4373         16  PB-I-BANK-NOCHRGB            PIC 99.
  4374         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4375         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4376
  4377     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4378         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4379             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4380         16  PB-C-CANCEL-ORIGIN           PIC X.
  4381             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4382         16  PB-C-LF-CANCEL-DT            PIC XX.
  4383         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4384         16  PB-C-LF-CALC-REQ             PIC X.
  4385             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4386         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4387         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4388         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4389             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4390         16  PB-C-AH-CANCEL-DT            PIC XX.
  4391         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4392         16  PB-C-AH-CALC-REQ             PIC X.
  4393             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4394         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4395         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4396         16  PB-C-LAST-NAME               PIC X(15).
  4397         16  PB-C-REFUND-SW               PIC X.
  4398             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4399             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4400         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4401         16  PB-C-PAYEE-CODE              PIC X(6).
  4402         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4403         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4404         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4405         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4406         16  PB-C-REFERENCE               PIC X(12).
  4407         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4408         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  83
* EL050.cbl
  4409         16  PB-C-POST-CARD-IND           PIC X.
  4410         16  PB-C-CANCEL-REASON           PIC X.
  4411         16  PB-C-REF-INTERFACE-SW        PIC X.
  4412         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4413         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4414         16  FILLER                       PIC X(01).
  4415*        16  FILLER                       PIC X(18).
  4416         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4417*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4418         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4419         16  PB-CANCELED-CERT-DATA.
  4420             20  PB-CI-INSURED-NAME.
  4421                 24  PB-CI-LAST-NAME      PIC X(15).
  4422                 24  PB-CI-INITIALS       PIC XX.
  4423             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4424             20  PB-CI-INSURED-SEX        PIC X.
  4425             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4426             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4427             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4428             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4429             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4430             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4431             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4432             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4433             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4434             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4435             20  PB-CI-RATE-CLASS         PIC XX.
  4436             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4437             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4438             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4439             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4440             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4441             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4442             20  PB-CI-LF-ABBR            PIC X(3).
  4443             20  PB-CI-AH-ABBR            PIC X(3).
  4444             20  PB-CI-OB-FLAG            PIC X.
  4445                 88  PB-CI-OB                VALUE 'B'.
  4446             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4447                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4448                                           'M' '4' '5' '9' '2'.
  4449                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4450                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4451                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4452                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4453                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4454                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4455                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4456                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4457                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4458                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4459                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4460                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4461                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4462             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4463                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4464                                           'M' '4' '5' '9' '2'.
  4465                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4466                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  84
* EL050.cbl
  4467                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4468                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4469                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4470                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4471                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4472                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4473                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4474                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4475                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4476                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4477                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4478             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4479             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4480             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4481             20  PB-CI-MEMBER-NO          PIC X(12).
  4482             20  PB-CI-INT-CODE           PIC X.
  4483                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4484                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4485             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4486             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4487             20  PB-CI-COMP-EXCP-SW       PIC X.
  4488                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4489                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4490             20  PB-CI-ENTRY-STATUS       PIC X.
  4491             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4492             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4493             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4494             20  PB-CI-DEATH-DT           PIC XX.
  4495             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4496             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4497             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4498             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4499             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4500             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4501             20  PB-CI-ENTRY-DT              PIC XX.
  4502             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4503             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4504             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4505             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4506             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4507             20  PB-CI-OLD-LOF               PIC XXX.
  4508*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4509             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4510             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4511             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4512             20  PB-CI-INDV-GRP-CD           PIC X.
  4513             20  PB-CI-BENEFICIARY-NAME.
  4514                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4515                 24  FILLER                  PIC X(15).
  4516             20  PB-CI-NOTE-SW               PIC X.
  4517             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4518             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4519             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4520             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4521             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4522             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4523             20  PB-CI-FIRST-NAME            PIC X(10).
  4524             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  85
* EL050.cbl
  4525
  4526         16  FILLER                       PIC X(13).
  4527*032306  16  FILLER                       PIC X(27).
  4528*        16  FILLER                       PIC X(46).
  4529
  4530     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4531         16  FILLER                       PIC X(10).
  4532         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4533         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4534         16  PB-M-INSURED-MID-INIT        PIC X.
  4535         16  PB-M-INSURED-AGE             PIC 99.
  4536         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4537         16  PB-M-INSURED-SEX             PIC X.
  4538         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4539         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4540         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4541         16  PB-M-INSURED-CITY-STATE.
  4542             20  PB-M-INSURED-CITY        PIC X(28).
  4543             20  PB-M-INSURED-STATE       PIC XX.
  4544         16  PB-M-INSURED-ZIP-CODE.
  4545             20  PB-M-INSURED-ZIP-PRIME.
  4546                 24  PB-M-INSURED-ZIP-1   PIC X.
  4547                     88  PB-M-CANADIAN-POST-CODE
  4548                                             VALUE 'A' THRU 'Z'.
  4549                 24  FILLER               PIC X(4).
  4550             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4551         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4552                                        PB-M-INSURED-ZIP-CODE.
  4553             20  PM-M-INS-CAN-POST1       PIC XXX.
  4554             20  PM-M-INS-CAN-POST2       PIC XXX.
  4555             20  FILLER                   PIC XXX.
  4556         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4557         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4558         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4559         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4560         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4561         16  PB-M-CRED-BENE-CITYST.
  4562             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4563             20  PB-M-CRED-BENE-STATE     PIC XX.
  4564         16  FILLER                       PIC X(92).
  4565
  4566     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4567         16  FILLER                       PIC X(10).
  4568         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4569         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4570         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4571         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4572         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4573         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4574         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4575         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4576         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4577         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4578         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4579         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4580         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4581         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4582         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  86
* EL050.cbl
  4583         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4584         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4585         16  PB-ACCOUNT-NAME              PIC X(30).
  4586         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4587         16  PB-REFERENCE                 PIC X(12).
  4588         16  PB-B-RECEIVED-DT             PIC XX.
  4589         16  FILLER                       PIC X(234).
  4590
  4591     12  PB-RECORD-STATUS.
  4592         16  PB-CREDIT-SELECT-DT          PIC XX.
  4593         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4594         16  PB-BILLED-DT                 PIC XX.
  4595         16  PB-BILLING-STATUS            PIC X.
  4596             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4597             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4598             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4599         16  PB-RECORD-BILL               PIC X.
  4600             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4601             88  PB-RECORD-RETURNED           VALUE 'R'.
  4602             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4603             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4604             88  PB-OVERRIDE-AH               VALUE 'A'.
  4605             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4606         16  PB-BATCH-ENTRY               PIC X.
  4607             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4608             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4609             88  PB-REISSUED-CERT             VALUE 'E'.
  4610             88  PB-CASH-CERT                 VALUE 'C'.
  4611             88  PB-MONTHLY-CERT              VALUE 'M'.
  4612             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4613             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4614             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4615         16  PB-FORCE-CODE                PIC X.
  4616             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4617             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4618             88  PB-CANCEL-FORCE              VALUE '8'.
  4619             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4620             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4621             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4622             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4623             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4624             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4625             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4626             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4627         16  PB-FATAL-FLAG                PIC X.
  4628             88  PB-FATAL-ERRORS              VALUE 'X'.
  4629         16  PB-FORCE-ER-CD               PIC X.
  4630             88  PB-FORCE-ERRORS              VALUE 'F'.
  4631             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4632         16  PB-WARN-ER-CD                PIC X.
  4633             88  PB-WARNING-ERRORS            VALUE 'W'.
  4634         16  FILLER                       PIC X.
  4635         16  PB-OUT-BAL-CD                PIC X.
  4636             88  PB-OUT-OF-BAL                VALUE 'O'.
  4637         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4638         16  PB-AH-OVERRIDE-L1            PIC X.
  4639         16  PB-INPUT-DT                  PIC XX.
  4640         16  PB-INPUT-BY                  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  87
* EL050.cbl
  4641         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4642         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4643         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4644         16  PB-LF-EARNING-METHOD         PIC X.
  4645         16  PB-AH-EARNING-METHOD         PIC X.
  4646         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4647         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4648         16  PB-REIN-CD                   PIC XXX.
  4649         16  PB-LF-REFUND-TYPE            PIC X.
  4650         16  PB-AH-REFUND-TYPE            PIC X.
  4651         16  PB-ACCT-EFF-DT               PIC XX.
  4652         16  PB-ACCT-EXP-DT               PIC XX.
  4653         16  PB-COMPANY-ID                PIC X(3).
  4654         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4655         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4656         16  PB-SV-CARRIER                PIC X.
  4657         16  PB-SV-GROUPING               PIC X(6).
  4658         16  PB-SV-STATE                  PIC XX.
  4659         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4660         16  PB-GA-BILLING-INFO.
  4661             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4662                                          PIC XX.
  4663         16  PB-SV-REMIT-TO  REDEFINES
  4664             PB-GA-BILLING-INFO           PIC X(10).
  4665         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4666         16  PB-I-LOAN-OFFICER            PIC X(5).
  4667         16  PB-I-VIN                     PIC X(17).
  4668
  4669         16  FILLER                       PIC X(04).
  4670         16  IMNET-BYPASS-SW              PIC X.
  4671
  4672******************************************************************
  4673*                COMMON EDIT ERRORS                              *
  4674******************************************************************
  4675
  4676     12  PB-COMMON-ERRORS.
  4677         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4678                                           PIC S9(4)     COMP.
  4679
  4680******************************************************************
  4681
  4682* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4683*    COPY ELC50W1.
  4684******************************************************************
  4685*                                                                *
  4686*                                                                *
  4687*                             ELC50W1                            *
  4688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4689*                            VMOD=2.004                          *
  4690*                                                                *
  4691*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4692*                                                                *
  4693*                                                                *
  4694******************************************************************
  4695
  4696     12  WK-WORK-AREA.
  4697         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4698         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  88
* EL050.cbl
  4699         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4700         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4701         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4702         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4703         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4704         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4705         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4706         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4707         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4708         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4709         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4710         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4711         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4712         16  WK-CREDIT-EDIT-CONTROLS.
  4713             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4714             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4715             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4716             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4717             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4718             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4719         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4720         16  WK-SAVE-REIN-DATA.
  4721             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4722             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4723             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4724         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4725             88  ENTRY-FROM-EL6311       VALUE '6'.
  4726         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4727         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4728     12  WK-RECORD-ADDRESSES.
  4729         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4730         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4731         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4732         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4733         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4734         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4735         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4736         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4737     12  WK-OVER-SHORT-AREA.
  4738         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4739         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4740         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4741             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4742         16  FILLER                   PIC X(5) VALUE SPACES.
  4743
  4744*    COPY ELCEDITC.
  4745******************************************************************
  4746*                                                                *
  4747*                                                                *
  4748*                            ELCEDITC                            *
  4749*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4750*                            VMOD=2.012                          *
  4751*                                                                *
  4752*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4753*                     EL6313, EL050 AND EL517.                   *
  4754*                                                                *
  4755******************************************************************
  4756******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  89
* EL050.cbl
  4757*                   C H A N G E   L O G
  4758*
  4759* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4760*-----------------------------------------------------------------
  4761*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4762* EFFECTIVE    NUMBER
  4763*-----------------------------------------------------------------
  4764* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4765******************************************************************
  4766
  4767     12  EDIT-CRITERIA-DATA.
  4768         16  EC-CO-MONTH-END-DT       PIC XX.
  4769         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4770         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4771         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4772         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4773         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4774         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4775         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4776         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4777         16  EC-CO-REM-TERM-CALC      PIC X.
  4778               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4779               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4780               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4781               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4782
  4783         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4784               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4785               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4786               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4787               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4788               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4789               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4790               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4791               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4792               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4793               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4794
  4795         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4796               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4797               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4798               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4799               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4800               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4801               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4802               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4803               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4804
  4805         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4806                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4807                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4808
  4809         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4810                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4811                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4812                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4813                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4814                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  90
* EL050.cbl
  4815                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4816                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4817                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4818
  4819         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4820               88  EC-BR-REDUCING                   VALUE 'R'.
  4821               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4822
  4823         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4824         16  EC-BR-LF-DESC             PIC X(10).
  4825         16  EC-BR-AH-DESC             PIC X(10).
  4826         16  EC-BR-LF-COMMENT          PIC X(10).
  4827         16  EC-BR-AH-COMMENT          PIC X(10).
  4828
  4829         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4830               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4831               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4832               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4833               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4834
  4835         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4836               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4837               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4838               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4839               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4840
  4841         16  EC-BR-LF-REFUND-CALC      PIC X.
  4842                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4843                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4844                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4845                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4846                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4847                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4848                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4849
  4850         16  EC-BR-AH-REFUND-CALC      PIC X.
  4851                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4852                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4853                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4854                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4855                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4856                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4857                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4858                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4859
  4860         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4861                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4862                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4863                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4864
  4865         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4866                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4867                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4868                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4869
  4870         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4871         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4872         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  91
* EL050.cbl
  4873         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4874
  4875         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4876         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4877                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4878                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4879                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4880                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4881
  4882         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4883               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4884               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4885               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4886               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4887               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4888
  4889         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4890               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4891               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4892               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4893               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4894               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4895
  4896         16  EC-ST-LF-REFUND-CALC      PIC X.
  4897                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4898                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4899                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4900                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4901                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4902                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4903                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4904                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4905
  4906         16  EC-ST-AH-REFUND-CALC      PIC X.
  4907                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4908                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4909                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4910                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4911                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4912                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4913                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4914                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4915
  4916         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4917         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4918         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4919         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4920         16  EC-AM-EXPIRATION-DT       PIC XX.
  4921         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4922         16  EC-AM-CLASS-CD            PIC XX.
  4923         16  EC-AM-LF-DEVIATION        PIC XXX.
  4924         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4925         16  EC-AM-AH-DEVIATION        PIC XXX.
  4926         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4927         16  EC-AM-PHONE-NO            PIC X(10).
  4928
  4929         16  EC-AM-LF-REFUND-CALC      PIC X.
  4930                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  92
* EL050.cbl
  4931                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4932                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4933                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4934                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4935                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4936                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4937
  4938         16  EC-AM-AH-REFUND-CALC      PIC X.
  4939                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4940                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4941                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4942                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4943                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4944                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4945                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4946
  4947         16  EC-AM-BEN-I-G-CD          PIC X.
  4948                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4949                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4950                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4951
  4952         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4953         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4954         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4955         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4956         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4957         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4958         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4959         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4960         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4961
  4962         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4963         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4964         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4965         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4966         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4967         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4968         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4969         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4970         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4971         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4972         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4973         16  EC-RT-LF-NSP-ST           PIC XX.
  4974         16  EC-RT-AH-NSP-ST           PIC XX.
  4975         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4976         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4977
  4978         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4979             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4980                                             'M' '5' '9' '2'.
  4981             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4982             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4983             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4984             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4985             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4986             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4987             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4988             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  93
* EL050.cbl
  4989             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4990             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4991
  4992         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4993             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4994                                             'M' '5' '9' '2'.
  4995             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4996             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4997             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4998             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4999             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  5000             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  5001             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  5002             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  5003             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  5004             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  5005
  5006         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5007         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  5008         16  EC-CM-LF-CANCEL-DT        PIC XX.
  5009         16  EC-CM-AH-CANCEL-DT        PIC XX.
  5010         16  EC-CM-DEATH-DT            PIC XX.
  5011
  5012*DMD CUSTOM CODING FIELDS BELOW
  5013*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  5014         16  EC-BR-DMD-RATING-SW       PIC X.
  5015                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  5016                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  5017                 88  NO-DMD-RATING               VALUE 'N'.
  5018
  5019         16  EC-NEW-CERT               PIC X(11).
  5020         16  EC-NEW-STATE              PIC XX.
  5021         16  FILLER                    PIC X.
  5022*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  5023         16  OVER-SHORT-EDIT-FIELDS.
  5024             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5025             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5026             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  5027             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  5028             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  5029             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5030             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5031             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  5032             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  5033         16  FILLER                    PIC X(71).
  5034******************************************************************
  5035
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  94
* EL050.cbl
  5037*    COPY ELCDIFRD.
  5038******************************************************************
  5039*                                                                *
  5040*                                                                *
  5041*                            ELCDIFRD.                           *
  5042*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5043*                            VMOD=2.004                          *
  5044*                                                                *
  5045*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  5046*                                                                *
  5047******************************************************************
  5048*
  5049  01  WS-DIFFERENCE-CALCULATION.
  5050        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  5051        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  5052        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  5053        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  5054        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  5055        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5056        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5057        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5058        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5059        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  5060        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  5061
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  95
* EL050.cbl
  5063****************************************************************
  5064*
  5065* Copyright (c) 2007-2013 Dell Inc.
  5066* All rights reserved.
  5067*
  5068****************************************************************
  5069 01  DFHEIV.
  5070   02  DFHEIV0               PIC X(35).
  5071   02  DFHEIV1               PIC X(08).
  5072   02  DFHEIV2               PIC X(08).
  5073   02  DFHEIV3               PIC X(08).
  5074   02  DFHEIV4               PIC X(06).
  5075   02  DFHEIV5               PIC X(04).
  5076   02  DFHEIV6               PIC X(04).
  5077   02  DFHEIV7               PIC X(02).
  5078   02  DFHEIV8               PIC X(02).
  5079   02  DFHEIV9               PIC X(01).
  5080   02  DFHEIV10              PIC S9(7) COMP-3.
  5081   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5082   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5083   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5084   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5085   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5086   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5087   02  DFHEIV17              PIC X(04).
  5088   02  DFHEIV18              PIC X(04).
  5089   02  DFHEIV19              PIC X(04).
  5090   02  DFHEIV20              USAGE IS POINTER.
  5091   02  DFHEIV21              USAGE IS POINTER.
  5092   02  DFHEIV22              USAGE IS POINTER.
  5093   02  DFHEIV23              USAGE IS POINTER.
  5094   02  DFHEIV24              USAGE IS POINTER.
  5095   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5096   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5097   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5098   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5099   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5100   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5101   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5102   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5103   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5104   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5105   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5106   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5107   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5108   02  FILLER                PIC X(02).
  5109   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5110   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5111   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5112   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5113   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5114   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5115   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5116 LINKAGE  SECTION.
  5117*****************************************************************
  5118*                                                               *
  5119* Copyright (c) 2007-2013 Dell Inc.                             *
  5120* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  96
* EL050.cbl
  5121*                                                               *
  5122*****************************************************************
  5123 01  dfheiblk.
  5124     02  eibtime          pic s9(7) comp-3.
  5125     02  eibdate          pic s9(7) comp-3.
  5126     02  eibtrnid         pic x(4).
  5127     02  eibtaskn         pic s9(7) comp-3.
  5128     02  eibtrmid         pic x(4).
  5129     02  dfheigdi         pic s9(4) comp.
  5130     02  eibcposn         pic s9(4) comp.
  5131     02  eibcalen         pic s9(4) comp.
  5132     02  eibaid           pic x(1).
  5133     02  eibfiller1       pic x(1).
  5134     02  eibfn            pic x(2).
  5135     02  eibfiller2       pic x(2).
  5136     02  eibrcode         pic x(6).
  5137     02  eibfiller3       pic x(2).
  5138     02  eibds            pic x(8).
  5139     02  eibreqid         pic x(8).
  5140     02  eibrsrce         pic x(8).
  5141     02  eibsync          pic x(1).
  5142     02  eibfree          pic x(1).
  5143     02  eibrecv          pic x(1).
  5144     02  eibsend          pic x(1).
  5145     02  eibatt           pic x(1).
  5146     02  eibeoc           pic x(1).
  5147     02  eibfmh           pic x(1).
  5148     02  eibcompl         pic x(1).
  5149     02  eibsig           pic x(1).
  5150     02  eibconf          pic x(1).
  5151     02  eiberr           pic x(1).
  5152     02  eibrldbk         pic x(1).
  5153     02  eiberrcd         pic x(4).
  5154     02  eibsynrb         pic x(1).
  5155     02  eibnodat         pic x(1).
  5156     02  eibfiller5       pic x(2).
  5157     02  eibresp          pic s9(8) comp.
  5158     02  eibresp2         pic s9(8) comp.
  5159     02  dfheigdj         pic s9(4) comp.
  5160     02  dfheigdk         pic s9(4) comp.
  5161
  5162 01  DFHCOMMAREA                   PIC X(1036).
  5163
  5164*01 PARMLIST .
  5165*    02  FILLER                    PIC S9(8)   COMP.
  5166*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5167*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5168*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5169*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5170*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5171*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5172*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5173
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  97
* EL050.cbl
  5175*    COPY ELCCNTL.
  5176******************************************************************
  5177*                                                                *
  5178*                                                                *
  5179*                            ELCCNTL.                            *
  5180*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5181*                            VMOD=2.059                          *
  5182*                                                                *
  5183*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5184*                                                                *
  5185*   FILE TYPE = VSAM,KSDS                                        *
  5186*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5187*                                                                *
  5188*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5189*       ALTERNATE INDEX = NONE                                   *
  5190*                                                                *
  5191*   LOG = YES                                                    *
  5192*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5193******************************************************************
  5194*                   C H A N G E   L O G
  5195*
  5196* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5197*-----------------------------------------------------------------
  5198*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5199* EFFECTIVE    NUMBER
  5200*-----------------------------------------------------------------
  5201* 082503                   PEMA  ADD BENEFIT GROUP
  5202* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5203* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5204* 092705    2005050300006  PEMA  ADD SPP LEASES
  5205* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5206* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5207* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5208* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5209* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5210* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5211* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5212* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5213* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5214* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5215* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5216******************************************************************
  5217*
  5218 01  CONTROL-FILE.
  5219     12  CF-RECORD-ID                       PIC XX.
  5220         88  VALID-CF-ID                        VALUE 'CF'.
  5221
  5222     12  CF-CONTROL-PRIMARY.
  5223         16  CF-COMPANY-ID                  PIC XXX.
  5224         16  CF-RECORD-TYPE                 PIC X.
  5225             88  CF-COMPANY-MASTER              VALUE '1'.
  5226             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5227             88  CF-STATE-MASTER                VALUE '3'.
  5228             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5229             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5230             88  CF-CARRIER-MASTER              VALUE '6'.
  5231             88  CF-MORTALITY-MASTER            VALUE '7'.
  5232             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  98
* EL050.cbl
  5233             88  CF-TERMINAL-MASTER             VALUE '9'.
  5234             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5235             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5236             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5237             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5238             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5239             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5240             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5241             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5242             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5243         16  CF-ACCESS-CD-GENL              PIC X(4).
  5244         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5245             20  CF-PROCESSOR               PIC X(4).
  5246         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5247             20  CF-STATE-CODE              PIC XX.
  5248             20  FILLER                     PIC XX.
  5249         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5250             20  FILLER                     PIC XX.
  5251             20  CF-HI-BEN-IN-REC           PIC XX.
  5252         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5253             20  FILLER                     PIC XXX.
  5254             20  CF-CARRIER-CNTL            PIC X.
  5255         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5256             20  FILLER                     PIC XX.
  5257             20  CF-HI-TYPE-IN-REC          PIC 99.
  5258         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5259             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5260                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5261             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5262             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5263         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5264             20  FILLER                     PIC X.
  5265             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5266         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5267             20  FILLER                     PIC XX.
  5268             20  CF-MORTGAGE-PLAN           PIC XX.
  5269         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5270
  5271     12  CF-LAST-MAINT-DT                   PIC XX.
  5272     12  CF-LAST-MAINT-BY                   PIC X(4).
  5273     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5274
  5275     12  CF-RECORD-BODY                     PIC X(728).
  5276
  5277
  5278****************************************************************
  5279*             COMPANY MASTER RECORD                            *
  5280****************************************************************
  5281
  5282     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5283         16  CF-COMPANY-ADDRESS.
  5284             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5285             20  CF-CL-IN-CARE-OF           PIC X(30).
  5286             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5287             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5288             20  CF-CL-CITY-STATE           PIC X(30).
  5289             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5290             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page  99
* EL050.cbl
  5291         16  CF-COMPANY-CD                  PIC X.
  5292         16  CF-COMPANY-PASSWORD            PIC X(8).
  5293         16  CF-SECURITY-OPTION             PIC X.
  5294             88  ALL-SECURITY                   VALUE '1'.
  5295             88  COMPANY-VERIFY                 VALUE '2'.
  5296             88  PROCESSOR-VERIFY               VALUE '3'.
  5297             88  NO-SECURITY                    VALUE '4'.
  5298             88  ALL-BUT-TERM                   VALUE '5'.
  5299         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5300             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5301         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5302             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5303         16  CF-INFORCE-LOCATION            PIC X.
  5304             88  CERTS-ARE-ONLINE               VALUE '1'.
  5305             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5306             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5307         16  CF-LOWER-CASE-LETTERS          PIC X.
  5308         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5309             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5310             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5311             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5312             88  CF-ACCNT-CNTL                  VALUE '3'.
  5313             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5314
  5315         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5316         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5317
  5318         16  CF-LGX-CREDIT-USER             PIC X.
  5319             88  CO-IS-NOT-USER                 VALUE 'N'.
  5320             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5321
  5322         16 CF-CREDIT-CALC-CODES.
  5323             20  CF-CR-REM-TERM-CALC PIC X.
  5324               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5325               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5326               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5327               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5328               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5329               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5330               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5331             20  CF-CR-R78-METHOD           PIC X.
  5332               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5333               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5334
  5335         16  CF-CLAIM-CONTROL-COUNTS.
  5336             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5337                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5338
  5339             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5340                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5341
  5342             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5343                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5344
  5345             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5346                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5347
  5348         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 100
* EL050.cbl
  5349
  5350         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5351             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5352             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5353             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5354             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5355                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5356                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5357             20  CF-CO-PREM-REJECT-SW       PIC X.
  5358                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5359                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5360             20  CF-CO-REF-REJECT-SW        PIC X.
  5361                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5362                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5363
  5364         16  CF-CO-REPORTING-DT             PIC XX.
  5365         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5366         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5367           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5368           88  CF-CO-MONTH-END                  VALUE '1'.
  5369
  5370         16  CF-LGX-CLAIM-USER              PIC X.
  5371             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5372             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5373
  5374         16  CF-CREDIT-EDIT-CONTROLS.
  5375             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5376             20  CF-MIN-AGE                 PIC 99.
  5377             20  CF-DEFAULT-AGE             PIC 99.
  5378             20  CF-MIN-TERM                PIC S999      COMP-3.
  5379             20  CF-MAX-TERM                PIC S999      COMP-3.
  5380             20  CF-DEFAULT-SEX             PIC X.
  5381             20  CF-JOINT-AGE-INPUT         PIC X.
  5382                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5383             20  CF-BIRTH-DATE-INPUT        PIC X.
  5384                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5385             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5386                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5387                 88  CF-ZERO-CARRIER            VALUE '1'.
  5388                 88  CF-ZERO-GROUPING           VALUE '2'.
  5389                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5390             20  CF-EDIT-SW                 PIC X.
  5391                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5392             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5393             20  CF-CR-PR-METHOD            PIC X.
  5394               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5395               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5396             20  FILLER                     PIC X.
  5397
  5398         16  CF-CREDIT-MISC-CONTROLS.
  5399             20  CF-REIN-TABLE-SW           PIC X.
  5400                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5401             20  CF-COMP-TABLE-SW           PIC X.
  5402                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5403             20  CF-EXPERIENCE-RETENTION-AGE
  5404                                            PIC S9        COMP-3.
  5405             20  CF-CONVERSION-DT           PIC XX.
  5406             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 101
* EL050.cbl
  5407             20  CF-RUN-FREQUENCY-SW        PIC X.
  5408                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5409                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5410
  5411             20  CF-CR-CHECK-NO-CONTROL.
  5412                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5413                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5414                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5415                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5416                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5417                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5418
  5419                 24  CF-CR-CHECK-COUNT       REDEFINES
  5420                     CF-CR-CHECK-COUNTER      PIC X(4).
  5421
  5422                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5423                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5424
  5425                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5426                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5427                 24  CF-MAIL-PROCESSING       PIC X.
  5428                     88  MAIL-PROCESSING          VALUE 'Y'.
  5429
  5430         16  CF-MISC-SYSTEM-CONTROL.
  5431             20  CF-SYSTEM-C                 PIC X.
  5432                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5433             20  CF-SYSTEM-D                 PIC X.
  5434                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5435             20  CF-SOC-SEC-NO-SW            PIC X.
  5436                 88  SOC-SEC-NO-USED             VALUE '1'.
  5437             20  CF-MEMBER-NO-SW             PIC X.
  5438                 88  MEMBER-NO-USED              VALUE '1'.
  5439             20  CF-TAX-ID-NUMBER            PIC X(11).
  5440             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5441             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5442                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5443                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5444                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5445                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5446             20  CF-SYSTEM-E                 PIC X.
  5447                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5448
  5449         16  CF-LGX-LIFE-USER               PIC X.
  5450             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5451             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5452
  5453         16  CF-CR-MONTH-END-DT             PIC XX.
  5454
  5455         16  CF-FILE-MAINT-DATES.
  5456             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5457                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5458             20  CF-LAST-BATCH       REDEFINES
  5459                 CF-LAST-BATCH-NO               PIC X(4).
  5460             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5461             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5462             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5463             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5464             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 102
* EL050.cbl
  5465             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5466             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5467             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5468             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5469             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5470
  5471         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5472         16  FILLER                         PIC X.
  5473
  5474         16  CF-ALT-MORT-CODE               PIC X(4).
  5475         16  CF-MEMBER-CAPTION              PIC X(10).
  5476
  5477         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5478             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5479             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5480             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5481             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5482             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5483
  5484         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5485
  5486         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5487         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5488         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5489         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5490
  5491         16  CF-AH-OVERRIDE-L1              PIC X.
  5492         16  CF-AH-OVERRIDE-L2              PIC XX.
  5493         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5494         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5495
  5496         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5497         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5498
  5499         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5500         16  CF-AR-LAST-EL860-DT            PIC XX.
  5501         16  CF-MP-MONTH-END-DT             PIC XX.
  5502
  5503         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5504         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5505             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5506
  5507         16  CF-AR-MONTH-END-DT             PIC XX.
  5508
  5509         16  CF-CRDTCRD-USER                PIC X.
  5510             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5511             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5512
  5513         16  CF-CC-MONTH-END-DT             PIC XX.
  5514
  5515         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5516
  5517         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5518             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5519             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5520             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5521         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5522         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 103
* EL050.cbl
  5523         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5524         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5525             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5526             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5527         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5528         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5529         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5530             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5531         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5532
  5533         16  CF-CL-ZIP-CODE.
  5534             20  CF-CL-ZIP-PRIME.
  5535                 24  CF-CL-ZIP-1ST          PIC X.
  5536                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5537                 24  FILLER                 PIC X(4).
  5538             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5539         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5540             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5541             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5542             20  FILLER                     PIC XXX.
  5543
  5544         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5545         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5546         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5547         16  CF-CO-OPTION-START-DATE        PIC XX.
  5548         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5549           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5550                                                      '3' '4'.
  5551           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5552           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5553           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5554           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5555           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5556           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5557
  5558         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5559
  5560         16  CF-PAYMENT-APPROVAL-LEVELS.
  5561             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5562             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5563             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5564             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5565             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5566             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5567
  5568         16  CF-END-USER-REPORTING-USER     PIC X.
  5569             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5570             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5571
  5572         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5573             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5574             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5575
  5576         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5577
  5578         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5579         16  FILLER                         PIC X.
  5580
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 104
* EL050.cbl
  5581         16  CF-CREDIT-ARCHIVE-CNTL.
  5582             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5583             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5584             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5585
  5586         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5587
  5588         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5589             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5590             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5591
  5592         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5593             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5594             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5595
  5596         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5597
  5598         16  CF-CO-ACH-ID-CODE              PIC  X.
  5599             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5600             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5601             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5602         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5603         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5604         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5605         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5606         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5607         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5608         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5609         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5610         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5611                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5612         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5613                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5614
  5615         16  CF-CO-OVER-SHORT.
  5616             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5617             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5618
  5619*         16  FILLER                         PIC X(102).
  5620         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5621             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5622             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5623
  5624         16  CF-AH-APPROVAL-DAYS.
  5625             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5626             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5627             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5628             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5629
  5630         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5631
  5632         16  CF-APPROV-LEV-5.
  5633             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5634             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5635             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5636
  5637         16  FILLER                         PIC X(68).
  5638****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 105
* EL050.cbl
  5639*             PROCESSOR/USER RECORD                            *
  5640****************************************************************
  5641
  5642     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5643         16  CF-PROCESSOR-NAME              PIC X(30).
  5644         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5645         16  CF-PROCESSOR-TITLE             PIC X(26).
  5646         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5647                 88  MESSAGE-YES                VALUE 'Y'.
  5648                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5649
  5650*****************************************************
  5651****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5652****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5653****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5654****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5655*****************************************************
  5656
  5657         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5658             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5659             20  CF-APPLICATION-FORCE       PIC X.
  5660             20  CF-INDIVIDUAL-APP.
  5661                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5662                     28  CF-BROWSE-APP      PIC X.
  5663                     28  CF-UPDATE-APP      PIC X.
  5664
  5665         16  CF-CURRENT-TERM-ON             PIC X(4).
  5666         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5667             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5668             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5669             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5670             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5671             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5672             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5673             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5674         16  CF-PROCESSOR-CARRIER           PIC X.
  5675             88  NO-CARRIER-SECURITY            VALUE ' '.
  5676         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5677             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5678         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5679             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5680         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5681             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5682
  5683         16  CF-PROC-SYS-ACCESS-SW.
  5684             20  CF-PROC-CREDIT-CLAIMS-SW.
  5685                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5686                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5687                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5688                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5689             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5690                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5691                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5692             20  CF-PROC-LIFE-GNRLDGR-SW.
  5693                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5694                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5695                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5696                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 106
* EL050.cbl
  5697             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5698                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5699                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5700         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5701             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5702             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5703         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5704
  5705         16  CF-APPROVAL-LEVEL                  PIC X.
  5706             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5707             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5708             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5709             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5710             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5711
  5712         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5713
  5714         16  CF-LANGUAGE-TYPE                   PIC X.
  5715             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5716             88  CF-LANG-IS-FR                      VALUE 'F'.
  5717
  5718         16  CF-CSR-IND                         PIC X.
  5719         16  FILLER                             PIC X(239).
  5720
  5721****************************************************************
  5722*             PROCESSOR/REMINDERS RECORD                       *
  5723****************************************************************
  5724
  5725     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5726         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5727             20  CF-START-REMIND-DT         PIC XX.
  5728             20  CF-END-REMIND-DT           PIC XX.
  5729             20  CF-REMINDER-TEXT           PIC X(50).
  5730         16  FILLER                         PIC X(296).
  5731
  5732
  5733****************************************************************
  5734*             STATE MASTER RECORD                              *
  5735****************************************************************
  5736
  5737     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5738         16  CF-STATE-ABBREVIATION          PIC XX.
  5739         16  CF-STATE-NAME                  PIC X(25).
  5740         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5741         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5742             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5743             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5744             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5745             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5746                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5747                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5748             20  CF-ST-PREM-REJECT-SW       PIC X.
  5749                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5750                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5751             20  CF-ST-REF-REJECT-SW        PIC X.
  5752                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5753                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5754         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 107
* EL050.cbl
  5755         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5756         16  CF-ST-REFUND-RULES.
  5757             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5758             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5759             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5760         16  CF-ST-FST-PMT-EXTENSION.
  5761             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5762             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5763                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5764                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5765                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5766                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5767         16  CF-ST-STATE-CALL.
  5768             20  CF-ST-CALL-UNEARNED        PIC X.
  5769             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5770             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5771         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5772             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5773             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5774         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5775         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5776         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5777         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5778         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5779         16  FILLER                         PIC X.
  5780         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5781             20  CF-ST-BENEFIT-CD           PIC XX.
  5782             20  CF-ST-BENEFIT-KIND         PIC X.
  5783                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5784                 88  CF-ST-AH-KIND              VALUE 'A'.
  5785             20  CF-ST-REM-TERM-CALC        PIC X.
  5786                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5787                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5788                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5789                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5790                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5791                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5792                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5793                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5794
  5795             20  CF-ST-REFUND-CALC          PIC X.
  5796                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5797                 88  ST-REFD-BY-R78             VALUE '1'.
  5798                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5799                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5800                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5801                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5802                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5803                 88  ST-REFD-UTAH               VALUE '7'.
  5804                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5805                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5806                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5807
  5808             20  CF-ST-EARNING-CALC         PIC X.
  5809                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5810                 88  ST-EARN-BY-R78             VALUE '1'.
  5811                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5812                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 108
* EL050.cbl
  5813                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5814                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5815                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5816                 88  ST-EARN-MEAN               VALUE '8'.
  5817                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5818
  5819             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5820                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5821                 88  ST-OVRD-BY-R78             VALUE '1'.
  5822                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5823                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5824                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5825                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5826                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5827                 88  ST-OVRD-MEAN               VALUE '8'.
  5828                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5829             20  cf-st-extra-periods        pic 9.
  5830*            20  FILLER                     PIC X.
  5831
  5832         16  CF-ST-COMMISSION-CAPS.
  5833             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5834             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5835             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5836             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5837         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5838                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5839                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5840                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5841
  5842         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5843
  5844         16  CF-ST-STATUTORY-INTEREST.
  5845             20  CF-ST-STAT-DATE-FROM       PIC X.
  5846                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5847                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5848             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5849             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5850             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5851             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5852             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5853
  5854         16  CF-ST-OVER-SHORT.
  5855             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5856             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5857
  5858         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5859
  5860         16  CF-ST-RT-CALC                  PIC X.
  5861
  5862         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5863         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5864         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5865         16  CF-ST-RF-LR-CALC               PIC X.
  5866         16  CF-ST-RF-LL-CALC               PIC X.
  5867         16  CF-ST-RF-LN-CALC               PIC X.
  5868         16  CF-ST-RF-AH-CALC               PIC X.
  5869         16  CF-ST-RF-CP-CALC               PIC X.
  5870*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 109
* EL050.cbl
  5871*CIDMOD         16  FILLER                         PIC X(192).
  5872         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5873             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5874         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5875         16  CF-ST-VFY-2ND-BENE             PIC X.
  5876         16  CF-ST-CAUSAL-STATE             PIC X.
  5877         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5878         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5879         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5880             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5881         16  CF-ST-NET-ONLY-STATE           PIC X.
  5882             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5883         16  cf-commission-cap-required     pic x.
  5884         16  CF-ST-GA-COMMISSION-CAPS.
  5885             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5886             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5887             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5888             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5889         16  CF-ST-TOT-COMMISSION-CAPS.
  5890             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5891             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5892             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5893             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5894         16  FILLER                         PIC X(156).
  5895
  5896****************************************************************
  5897*             BENEFIT MASTER RECORD                            *
  5898****************************************************************
  5899
  5900     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5901         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5902             20  CF-BENEFIT-CODE            PIC XX.
  5903             20  CF-BENEFIT-NUMERIC  REDEFINES
  5904                 CF-BENEFIT-CODE            PIC XX.
  5905             20  CF-BENEFIT-ALPHA           PIC XXX.
  5906             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5907             20  CF-BENEFIT-COMMENT         PIC X(10).
  5908
  5909             20  CF-LF-COVERAGE-TYPE        PIC X.
  5910                 88  CF-REDUCING                VALUE 'R'.
  5911                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5912
  5913             20  CF-SPECIAL-CALC-CD         PIC X.
  5914                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5915                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5916                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5917                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5918                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5919                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5920                 88  CF-FARM-PLAN               VALUE 'F'.
  5921                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5922                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5923                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5924                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5925                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5926                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5927                 88  CF-PRUDENTIAL              VALUE 'P'.
  5928                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 110
* EL050.cbl
  5929                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5930                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5931                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5932                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5933                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5934
  5935             20  CF-JOINT-INDICATOR         PIC X.
  5936                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5937
  5938*            20  FILLER                     PIC X(12).
  5939             20  cf-maximum-benefits        pic s999 comp-3.
  5940             20  FILLER                     PIC X(09).
  5941             20  CF-BENEFIT-CATEGORY        PIC X.
  5942             20  CF-LOAN-TYPE               PIC X(8).
  5943
  5944             20  CF-CO-REM-TERM-CALC        PIC X.
  5945                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5946                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5947                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5948                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5949                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5950
  5951             20  CF-CO-EARNINGS-CALC        PIC X.
  5952                 88  CO-EARN-BY-R78             VALUE '1'.
  5953                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5954                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5955                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5956                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5957                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5958                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5959                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5960
  5961             20  CF-CO-REFUND-CALC          PIC X.
  5962                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5963                 88  CO-REFD-BY-R78             VALUE '1'.
  5964                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5965                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5966                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5967                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5968                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5969                 88  CO-REFD-MEAN               VALUE '8'.
  5970                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5971                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5972                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5973
  5974             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5975                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5976                 88  CO-OVRD-BY-R78             VALUE '1'.
  5977                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5978                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5979                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5980                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5981                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5982                 88  CO-OVRD-MEAN               VALUE '8'.
  5983                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5984
  5985             20  CF-CO-BEN-I-G-CD           PIC X.
  5986                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 111
* EL050.cbl
  5987                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5988                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5989
  5990         16  FILLER                         PIC X(304).
  5991
  5992
  5993****************************************************************
  5994*             CARRIER MASTER RECORD                            *
  5995****************************************************************
  5996
  5997     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5998         16  CF-ADDRESS-DATA.
  5999             20  CF-MAIL-TO-NAME            PIC X(30).
  6000             20  CF-IN-CARE-OF              PIC X(30).
  6001             20  CF-ADDRESS-LINE-1          PIC X(30).
  6002             20  CF-ADDRESS-LINE-2          PIC X(30).
  6003             20  CF-CITY-STATE              PIC X(30).
  6004             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6005             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6006
  6007         16  CF-CLAIM-NO-CONTROL.
  6008             20  CF-CLAIM-NO-METHOD         PIC X.
  6009                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6010                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6011                 88  CLAIM-NO-SEQ               VALUE '3'.
  6012                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6013             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6014                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6015                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6016                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6017
  6018         16  CF-CHECK-NO-CONTROL.
  6019             20  CF-CHECK-NO-METHOD         PIC X.
  6020                 88  CHECK-NO-MANUAL            VALUE '1'.
  6021                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6022                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6023                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6024             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6025                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6026
  6027         16  CF-DOMICILE-STATE              PIC XX.
  6028
  6029         16  CF-EXPENSE-CONTROLS.
  6030             20  CF-EXPENSE-METHOD          PIC X.
  6031                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6032                 88  DOLLARS-PER-PMT            VALUE '2'.
  6033                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6034                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6035             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6036             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6037
  6038         16  CF-CORRESPONDENCE-CONTROL.
  6039             20  CF-LETTER-RESEND-OPT       PIC X.
  6040                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6041                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6042             20  FILLER                     PIC X(4).
  6043
  6044         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 112
* EL050.cbl
  6045             20  CF-MANUAL-SW               PIC X.
  6046                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6047             20  CF-FUTURE-SW               PIC X.
  6048                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6049             20  CF-PTC-SW                  PIC X.
  6050                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6051             20  CF-IBNR-SW                 PIC X.
  6052                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6053             20  CF-PTC-LF-SW               PIC X.
  6054                 88  CF-LF-PTC-USED             VALUE '1'.
  6055             20  CF-CDT-ACCESS-METHOD       PIC X.
  6056                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6057                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6058                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6059             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6060
  6061         16  CF-CLAIM-CALC-METHOD           PIC X.
  6062             88  360-PLUS-MONTHS                VALUE '1'.
  6063             88  365-PLUS-MONTHS                VALUE '2'.
  6064             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6065             88  360-DAILY                      VALUE '4'.
  6066             88  365-DAILY                      VALUE '5'.
  6067
  6068         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6069         16  FILLER                         PIC X(11).
  6070
  6071         16  CF-LIMIT-AMOUNTS.
  6072             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6073             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6074             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6075             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6076             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6077             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6078             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6079             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6080             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6081             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6082
  6083         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6084         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6085         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6086
  6087         16  CF-ZIP-CODE.
  6088             20  CF-ZIP-PRIME.
  6089                 24  CF-ZIP-1ST             PIC X.
  6090                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6091                 24  FILLER                 PIC X(4).
  6092             20  CF-ZIP-PLUS4               PIC X(4).
  6093         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6094             20  CF-CAN-POSTAL-1            PIC XXX.
  6095             20  CF-CAN-POSTAL-2            PIC XXX.
  6096             20  FILLER                     PIC XXX.
  6097
  6098         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6099         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6100         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6101
  6102         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 113
* EL050.cbl
  6103             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6104             88  CF-NO-RATING                   VALUE 'N'.
  6105
  6106         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6107
  6108         16  CF-CARRIER-OVER-SHORT.
  6109             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6110             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6111
  6112         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6113         16  CF-SECPAY-SWITCH               PIC X.
  6114             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6115             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6116         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6117         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6118         16  FILLER                         PIC X(444).
  6119*        16  FILLER                         PIC X(452).
  6120
  6121
  6122****************************************************************
  6123*             MORTALITY MASTER RECORD                          *
  6124****************************************************************
  6125
  6126     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6127         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6128                                INDEXED BY CF-MORT-NDX.
  6129             20  CF-MORT-TABLE              PIC X(5).
  6130             20  CF-MORT-TABLE-TYPE         PIC X.
  6131                 88  CF-MORT-JOINT              VALUE 'J'.
  6132                 88  CF-MORT-SINGLE             VALUE 'S'.
  6133                 88  CF-MORT-COMBINED           VALUE 'C'.
  6134                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6135                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6136             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6137             20  CF-MORT-AGE-METHOD         PIC XX.
  6138                 88  CF-AGE-LAST                VALUE 'AL'.
  6139                 88  CF-AGE-NEAR                VALUE 'AN'.
  6140             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6141             20  CF-MORT-ADJUSTMENT-DIRECTION
  6142                                            PIC X.
  6143                 88  CF-MINUS                   VALUE '-'.
  6144                 88  CF-PLUS                    VALUE '+'.
  6145             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6146             20  CF-MORT-JOINT-CODE         PIC X.
  6147                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6148             20  CF-MORT-PC-Q               PIC X.
  6149                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6150             20  CF-MORT-TABLE-CODE         PIC X(4).
  6151             20  CF-MORT-COMMENTS           PIC X(15).
  6152             20  FILLER                     PIC X(14).
  6153
  6154         16  FILLER                         PIC X(251).
  6155
  6156
  6157****************************************************************
  6158*             BUSSINESS TYPE MASTER RECORD                     *
  6159****************************************************************
  6160
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 114
* EL050.cbl
  6161     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6162* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6163* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6164* AND RECORD 05 IS TYPES 81-99
  6165         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6166             20  CF-BUSINESS-TITLE          PIC  X(19).
  6167             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6168                                            PIC S9V9(4) COMP-3.
  6169             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6170             20  FILLER                     PIC  X.
  6171         16  FILLER                         PIC  X(248).
  6172
  6173
  6174****************************************************************
  6175*             TERMINAL MASTER RECORD                           *
  6176****************************************************************
  6177
  6178     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6179
  6180         16  CF-COMPANY-TERMINALS.
  6181             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6182                                  PIC X(4).
  6183         16  FILLER               PIC X(248).
  6184
  6185
  6186****************************************************************
  6187*             LIFE EDIT MASTER RECORD                          *
  6188****************************************************************
  6189
  6190     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6191         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6192             20  CF-LIFE-CODE-IN            PIC XX.
  6193             20  CF-LIFE-CODE-OUT           PIC XX.
  6194         16  FILLER                         PIC X(248).
  6195
  6196
  6197****************************************************************
  6198*             AH EDIT MASTER RECORD                            *
  6199****************************************************************
  6200
  6201     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6202         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6203             20  CF-AH-CODE-IN              PIC XXX.
  6204             20  CF-AH-CODE-OUT             PIC XX.
  6205         16  FILLER                         PIC X(248).
  6206
  6207
  6208****************************************************************
  6209*             CREDIBILITY TABLES                               *
  6210****************************************************************
  6211
  6212     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6213         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6214                             INDEXED BY CF-CRDB-NDX.
  6215             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6216             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6217             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6218         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 115
* EL050.cbl
  6219
  6220
  6221****************************************************************
  6222*             REPORT CUSTOMIZATION RECORD                      *
  6223****************************************************************
  6224
  6225     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6226         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6227             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6228             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6229             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6230**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6231****       A T-TRANSFER.                                   ****
  6232             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6233
  6234         16  FILLER                         PIC XX.
  6235
  6236         16  CF-CARRIER-CNTL-OPT.
  6237             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6238                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6239                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6240             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6241                                            PIC X.
  6242         16  CF-GROUP-CNTL-OPT.
  6243             20  CF-GROUP-OPT-SEQ           PIC 9.
  6244                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6245                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6246             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6247                                            PIC X(6).
  6248         16  CF-STATE-CNTL-OPT.
  6249             20  CF-STATE-OPT-SEQ           PIC 9.
  6250                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6251                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6252             20  CF-STATE-SELECT OCCURS 3 TIMES
  6253                                            PIC XX.
  6254         16  CF-ACCOUNT-CNTL-OPT.
  6255             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6256                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6257                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6258             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6259                                            PIC X(10).
  6260         16  CF-BUS-TYP-CNTL-OPT.
  6261             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6262                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6263                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6264             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6265                                            PIC XX.
  6266         16  CF-LF-TYP-CNTL-OPT.
  6267             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6268                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6269                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6270             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6271                                            PIC XX.
  6272         16  CF-AH-TYP-CNTL-OPT.
  6273             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6274                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6275                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6276             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 116
* EL050.cbl
  6277                                            PIC XX.
  6278         16  CF-REPTCD1-CNTL-OPT.
  6279             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6280                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6281                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6282             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6283                                            PIC X(10).
  6284         16  CF-REPTCD2-CNTL-OPT.
  6285             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6286                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6287                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6288             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6289                                            PIC X(10).
  6290         16  CF-USER1-CNTL-OPT.
  6291             20  CF-USER1-OPT-SEQ           PIC 9.
  6292                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6293                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6294             20  CF-USER1-SELECT OCCURS 3 TIMES
  6295                                            PIC X(10).
  6296         16  CF-USER2-CNTL-OPT.
  6297             20  CF-USER2-OPT-SEQ           PIC 9.
  6298                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6299                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6300             20  CF-USER2-SELECT OCCURS 3 TIMES
  6301                                            PIC X(10).
  6302         16  CF-USER3-CNTL-OPT.
  6303             20  CF-USER3-OPT-SEQ           PIC 9.
  6304                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6305                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6306             20  CF-USER3-SELECT OCCURS 3 TIMES
  6307                                            PIC X(10).
  6308         16  CF-USER4-CNTL-OPT.
  6309             20  CF-USER4-OPT-SEQ           PIC 9.
  6310                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6311                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6312             20  CF-USER4-SELECT OCCURS 3 TIMES
  6313                                            PIC X(10).
  6314         16  CF-USER5-CNTL-OPT.
  6315             20  CF-USER5-OPT-SEQ           PIC 9.
  6316                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6317                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6318             20  CF-USER5-SELECT OCCURS 3 TIMES
  6319                                            PIC X(10).
  6320         16  CF-REINS-CNTL-OPT.
  6321             20  CF-REINS-OPT-SEQ           PIC 9.
  6322                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6323                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6324             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6325                 24  CF-REINS-PRIME         PIC XXX.
  6326                 24  CF-REINS-SUB           PIC XXX.
  6327
  6328         16  CF-AGENT-CNTL-OPT.
  6329             20  CF-AGENT-OPT-SEQ           PIC 9.
  6330                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6331                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6332             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6333                                            PIC X(10).
  6334
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 117
* EL050.cbl
  6335         16  FILLER                         PIC X(43).
  6336
  6337         16  CF-LOSS-RATIO-SELECT.
  6338             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6339             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6340         16  CF-ENTRY-DATE-SELECT.
  6341             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6342             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6343         16  CF-EFFECTIVE-DATE-SELECT.
  6344             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6345             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6346
  6347         16  CF-EXCEPTION-LIST-IND          PIC X.
  6348             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6349
  6350         16  FILLER                         PIC X(318).
  6351
  6352****************************************************************
  6353*                  EXCEPTION REPORTING RECORD                  *
  6354****************************************************************
  6355
  6356     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6357         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6358             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6359
  6360         16  CF-COMBINED-LIFE-AH-OPT.
  6361             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6362             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6363             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6364             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6365
  6366         16  CF-LIFE-OPT.
  6367             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6368             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6369             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6370             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6371             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6372             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6373             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6374             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6375             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6376             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6377
  6378         16  CF-AH-OPT.
  6379             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6380             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6381             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6382             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6383             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6384             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6385             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6386             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6387             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6388             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6389
  6390         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6391             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6392             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 118
* EL050.cbl
  6393             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6394
  6395         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6396
  6397         16  FILLER                         PIC X(673).
  6398
  6399
  6400****************************************************************
  6401*             MORTGAGE SYSTEM PLAN RECORD                      *
  6402****************************************************************
  6403
  6404     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6405         16  CF-PLAN-TYPE                   PIC X.
  6406             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6407             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6408             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6409         16  CF-PLAN-ABBREV                 PIC XXX.
  6410         16  CF-PLAN-DESCRIPT               PIC X(10).
  6411         16  CF-PLAN-NOTES                  PIC X(20).
  6412         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6413         16  CF-PLAN-UNDERWRITING.
  6414             20  CF-PLAN-TERM-DATA.
  6415                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6416                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6417             20  CF-PLAN-AGE-DATA.
  6418                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6419                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6420                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6421             20  CF-PLAN-BENEFIT-DATA.
  6422                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6423                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6424                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6425                                            PIC S9(7)V99  COMP-3.
  6426         16  CF-PLAN-POLICY-FORMS.
  6427             20  CF-POLICY-FORM             PIC X(12).
  6428             20  CF-MASTER-APPLICATION      PIC X(12).
  6429             20  CF-MASTER-POLICY           PIC X(12).
  6430         16  CF-PLAN-RATING.
  6431             20  CF-RATE-CODE               PIC X(5).
  6432             20  CF-SEX-RATING              PIC X.
  6433                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6434                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6435             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6436             20  CF-SUB-STD-TYPE            PIC X.
  6437                 88  CF-PCT-OF-PREM            VALUE '1'.
  6438                 88  CF-PCT-OF-BENE            VALUE '2'.
  6439         16  CF-PLAN-PREM-TOLERANCES.
  6440             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6441             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6442         16  CF-PLAN-PYMT-TOLERANCES.
  6443             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6444             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6445         16  CF-PLAN-MISC-DATA.
  6446             20  FILLER                     PIC X.
  6447             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6448             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6449         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6450         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 119
* EL050.cbl
  6451             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6452                                                     '1'.
  6453             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6454                                                     '2'.
  6455         16  CF-MIB-SEARCH-SW               PIC X.
  6456             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6457             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6458             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6459             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6460         16  CF-ALPHA-SEARCH-SW             PIC X.
  6461             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6462             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6463             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6464             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6465             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6466             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6467             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6468             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6469             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6470             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6471                                                     'A' 'B' 'C'
  6472                                                     'X' 'Y' 'Z'.
  6473         16  CF-EFF-DT-RULE-SW              PIC X.
  6474             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6475             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6476             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6477             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6478             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6479         16  FILLER                         PIC X(4).
  6480         16  CF-HEALTH-QUESTIONS            PIC X.
  6481             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6482         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6483         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6484         16  CF-PLAN-SNGL-JNT               PIC X.
  6485             88  CF-COMBINED-PLAN              VALUE 'C'.
  6486             88  CF-JNT-PLAN                   VALUE 'J'.
  6487             88  CF-SNGL-PLAN                  VALUE 'S'.
  6488         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6489         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6490         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6491         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6492         16  CF-RERATE-CNTL                 PIC  X.
  6493             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6494             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6495             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6496             88  CF-AUTO-RECALC                 VALUE '4'.
  6497         16  CF-BENEFIT-TYPE                PIC  X.
  6498             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6499             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6500         16  CF-POLICY-FEE                  PIC S999V99
  6501                                                    COMP-3.
  6502         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6503         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6504         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6505         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6506         16  FILLER                         PIC  X(32).
  6507         16  CF-TERMINATION-FORM            PIC  X(04).
  6508         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 120
* EL050.cbl
  6509         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6510                                                       COMP-3.
  6511         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6512         16  CF-ISSUE-LETTER                PIC  X(4).
  6513         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6514         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6515             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6516             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6517         16  CF-MP-REFUND-CALC              PIC X.
  6518             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6519             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6520             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6521             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6522             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6523             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6524             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6525             88  CF-MP-REFD-MEAN                VALUE '8'.
  6526         16  CF-ALT-RATE-CODE               PIC  X(5).
  6527
  6528
  6529         16  FILLER                         PIC X(498).
  6530****************************************************************
  6531*             MORTGAGE COMPANY MASTER RECORD                   *
  6532****************************************************************
  6533
  6534     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6535         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6536         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6537             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6538             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6539             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6540             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6541             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6542
  6543         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6544         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6545         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6546         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6547         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6548
  6549         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6550             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6551         16  CF-MP-RECON-USE-IND            PIC X(1).
  6552             88  CF-MP-USE-RECON             VALUE 'Y'.
  6553         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6554             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6555         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6556             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6557             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6558         16  FILLER                         PIC X(1).
  6559         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6560             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6561         16  CF-MORTG-MIB-VERSION           PIC X.
  6562             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6563             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6564             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6565         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6566             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 121
* EL050.cbl
  6567                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6568             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6569                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6570             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6571                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6572             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6573                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6574             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6575                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6576             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6577                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6578         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6579         16  FILLER                         PIC X(7).
  6580         16  CF-MORTG-DESTINATION-SYMBOL.
  6581             20  CF-MORTG-MIB-COMM          PIC X(5).
  6582             20  CF-MORTG-MIB-TERM          PIC X(5).
  6583         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6584             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6585         16  FILLER                         PIC X(03).
  6586         16  CF-MP-CHECK-NO-CONTROL.
  6587             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6588                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6589                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6590                                                ' ' LOW-VALUES.
  6591                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6592                                               VALUE '3'.
  6593         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6594         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6595         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6596             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6597                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6598             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6599                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6600             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6601                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6602             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6603                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6604             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6605                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6606             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6607                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6608         16  CF-MORTG-BILLING-AREA.
  6609             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6610                                            PIC X.
  6611         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6612         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6613         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6614         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6615             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6616             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6617         16  FILLER                         PIC X.
  6618         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6619             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6620             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6621         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6622         16  FILLER                         PIC X(8).
  6623         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6624         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 122
* EL050.cbl
  6625         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6626         16  CF-ACH-COMPANY-ID.
  6627             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6628                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6629                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6630                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6631             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6632         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6633             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6634         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6635             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6636             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6637         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6638         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6639         16  FILLER                         PIC X(536).
  6640
  6641****************************************************************
  6642*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6643****************************************************************
  6644
  6645     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6646         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6647             20  CF-FEMALE-HEIGHT.
  6648                 24  CF-FEMALE-FT           PIC 99.
  6649                 24  CF-FEMALE-IN           PIC 99.
  6650             20  CF-FEMALE-MIN-WT           PIC 999.
  6651             20  CF-FEMALE-MAX-WT           PIC 999.
  6652         16  FILLER                         PIC X(428).
  6653
  6654     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6655         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6656             20  CF-MALE-HEIGHT.
  6657                 24  CF-MALE-FT             PIC 99.
  6658                 24  CF-MALE-IN             PIC 99.
  6659             20  CF-MALE-MIN-WT             PIC 999.
  6660             20  CF-MALE-MAX-WT             PIC 999.
  6661         16  FILLER                         PIC X(428).
  6662******************************************************************
  6663*             AUTOMATIC ACTIVITY RECORD                          *
  6664******************************************************************
  6665     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6666         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6667             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6668             20  CF-SYS-LETTER-ID           PIC X(04).
  6669             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6670             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6671             20  CF-SYS-RESET-SW            PIC X(01).
  6672             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6673             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6674
  6675         16  FILLER                         PIC X(50).
  6676
  6677         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6678             20  CF-USER-ACTIVE-SW          PIC X(01).
  6679             20  CF-USER-LETTER-ID          PIC X(04).
  6680             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6681             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6682             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 123
* EL050.cbl
  6683             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6684             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6685             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6686
  6687         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 124
* EL050.cbl
  6689*    COPY ERCACCT.
  6690******************************************************************
  6691*                                                                *
  6692*                                                                *
  6693*                            ERCACCT                             *
  6694*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6695*                            VMOD=2.031                          *
  6696*                                                                *
  6697*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6698*                                                                *
  6699*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6700*   VSAM ACCOUNT MASTER FILES.                                   *
  6701*                                                                *
  6702*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6703*                                                                *
  6704*   FILE TYPE = VSAM,KSDS                                        *
  6705*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6706*                                                                *
  6707*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6708*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6709*                                                                *
  6710*   LOG = NO                                                     *
  6711*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6712*                                                                *
  6713*                                                                *
  6714******************************************************************
  6715*                   C H A N G E   L O G
  6716*
  6717* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6718*-----------------------------------------------------------------
  6719*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6720* EFFECTIVE    NUMBER
  6721*-----------------------------------------------------------------
  6722* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6723* 092705    2005050300006  PEMA  ADD SPP LEASES
  6724* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6725* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6726* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6727* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6728* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6729* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6730******************************************************************
  6731
  6732 01  ACCOUNT-MASTER.
  6733     12  AM-RECORD-ID                      PIC XX.
  6734         88  VALID-AM-ID                      VALUE 'AM'.
  6735
  6736     12  AM-CONTROL-PRIMARY.
  6737         16  AM-COMPANY-CD                 PIC X.
  6738         16  AM-MSTR-CNTRL.
  6739             20  AM-CONTROL-A.
  6740                 24  AM-CARRIER            PIC X.
  6741                 24  AM-GROUPING.
  6742                     28 AM-GROUPING-PREFIX PIC XXX.
  6743                     28 AM-GROUPING-PRIME  PIC XXX.
  6744                 24  AM-STATE              PIC XX.
  6745                 24  AM-ACCOUNT.
  6746                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 125
* EL050.cbl
  6747                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6748             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6749                                           PIC X(19).
  6750             20  AM-CNTRL-B.
  6751                 24  AM-EXPIRATION-DT      PIC XX.
  6752                 24  FILLER                PIC X(4).
  6753             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6754                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6755
  6756     12  AM-CONTROL-BY-VAR-GRP.
  6757         16  AM-COMPANY-CD-A1              PIC X.
  6758         16  AM-VG-CARRIER                 PIC X.
  6759         16  AM-VG-GROUPING                PIC X(6).
  6760         16  AM-VG-STATE                   PIC XX.
  6761         16  AM-VG-ACCOUNT                 PIC X(10).
  6762         16  AM-VG-DATE.
  6763             20  AM-VG-EXPIRATION-DT       PIC XX.
  6764             20  FILLER                    PIC X(4).
  6765         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6766                                           PIC 9(11)      COMP-3.
  6767     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6768         16  FILLER                        PIC X(10).
  6769         16  AM-VG-KEY3.
  6770             20  AM-VG3-ACCOUNT            PIC X(10).
  6771             20  AM-VG3-EXP-DT             PIC XX.
  6772         16  FILLER                        PIC X(4).
  6773     12  AM-MAINT-INFORMATION.
  6774         16  AM-LAST-MAINT-DT              PIC XX.
  6775         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6776         16  AM-LAST-MAINT-USER            PIC X(4).
  6777         16  FILLER                        PIC XX.
  6778
  6779     12  AM-EFFECTIVE-DT                   PIC XX.
  6780     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6781
  6782     12  AM-PREV-DATES  COMP-3.
  6783         16  AM-PREV-EXP-DT                PIC 9(11).
  6784         16  AM-PREV-EFF-DT                PIC 9(11).
  6785
  6786     12  AM-REPORT-CODE-1                  PIC X(10).
  6787     12  AM-REPORT-CODE-2                  PIC X(10).
  6788
  6789     12  AM-CITY-CODE                      PIC X(4).
  6790     12  AM-COUNTY-PARISH                  PIC X(6).
  6791
  6792     12  AM-NAME                           PIC X(30).
  6793     12  AM-PERSON                         PIC X(30).
  6794     12  AM-ADDRS                          PIC X(30).
  6795     12  AM-CITY.
  6796         16  AM-ADDR-CITY                  PIC X(28).
  6797         16  AM-ADDR-STATE                 PIC XX.
  6798     12  AM-ZIP.
  6799         16  AM-ZIP-PRIME.
  6800             20  AM-ZIP-PRI-1ST            PIC X.
  6801                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6802             20  FILLER                    PIC X(4).
  6803         16  AM-ZIP-PLUS4                  PIC X(4).
  6804     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 126
* EL050.cbl
  6805         16  AM-CAN-POSTAL-1               PIC XXX.
  6806         16  AM-CAN-POSTAL-2               PIC XXX.
  6807         16  FILLER                        PIC XXX.
  6808     12  AM-TEL-NO.
  6809         16  AM-AREA-CODE                  PIC 999.
  6810         16  AM-TEL-PRE                    PIC 999.
  6811         16  AM-TEL-NBR                    PIC 9(4).
  6812     12  AM-TEL-LOC                        PIC X.
  6813         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6814         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6815
  6816     12  AM-COMM-STRUCTURE.
  6817         16  AM-DEFN-1.
  6818             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6819                 24  AM-AGT.
  6820                     28  AM-AGT-PREFIX     PIC X(4).
  6821                     28  AM-AGT-PRIME      PIC X(6).
  6822                 24  AM-COM-TYP            PIC X.
  6823                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6824                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6825                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6826                 24  AM-RECALC-LV-INDIC    PIC X.
  6827                 24  AM-RETRO-LV-INDIC     PIC X.
  6828                 24  AM-GL-CODES           PIC X.
  6829                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6830                 24  FILLER                PIC X(01).
  6831         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6832             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6833                 24  FILLER                PIC X(11).
  6834                 24  AM-L-COMA             PIC XXX.
  6835                 24  AM-J-COMA             PIC XXX.
  6836                 24  AM-A-COMA             PIC XXX.
  6837                 24  FILLER                PIC X(6).
  6838
  6839     12  AM-COMM-CHANGE-STATUS             PIC X.
  6840         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6841
  6842     12  AM-CSR-CODE                       PIC X(4).
  6843
  6844     12  AM-BILLING-STATUS                 PIC X.
  6845         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6846         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6847     12  AM-AUTO-REFUND-SW                 PIC X.
  6848         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6849         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6850     12  AM-GPCD                           PIC 99.
  6851     12  AM-IG                             PIC X.
  6852         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6853         88  AM-HAS-GROUP                     VALUE '2'.
  6854     12  AM-STATUS                         PIC X.
  6855         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6856         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6857         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6858         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6859         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6860         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6861         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6862         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 127
* EL050.cbl
  6863         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6864         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6865     12  AM-REMIT-TO                       PIC 99.
  6866     12  AM-ID-NO                          PIC X(11).
  6867
  6868     12  AM-CAL-TABLE                      PIC XX.
  6869     12  AM-LF-DEVIATION                   PIC XXX.
  6870     12  AM-AH-DEVIATION                   PIC XXX.
  6871     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6872     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6873     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6874     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6875     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6876     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6877
  6878     12  AM-USER-FIELDS.
  6879         16  AM-FLD-1                      PIC XX.
  6880         16  AM-FLD-2                      PIC XX.
  6881         16  AM-FLD-3                      PIC XX.
  6882         16  AM-FLD-4                      PIC XX.
  6883         16  AM-FLD-5                      PIC XX.
  6884
  6885     12  AM-1ST-PROD-DATE.
  6886         16  AM-1ST-PROD-YR                PIC XX.
  6887         16  AM-1ST-PROD-MO                PIC XX.
  6888         16  AM-1ST-PROD-DA                PIC XX.
  6889     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6890     12  AM-CERTS-PURGED-DATE.
  6891         16  AM-PUR-YR                     PIC XX.
  6892         16  AM-PUR-MO                     PIC XX.
  6893         16  AM-PUR-DA                     PIC XX.
  6894     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6895     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6896     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6897     12  AM-INACTIVE-DATE.
  6898         16  AM-INA-MO                     PIC 99.
  6899         16  AM-INA-DA                     PIC 99.
  6900         16  AM-INA-YR                     PIC 99.
  6901     12  AM-AR-HI-CERT-DATE                PIC XX.
  6902
  6903     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6904     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6905
  6906     12  AM-OB-PAYMENT-MODE                PIC X.
  6907         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6908         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6909         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6910         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6911
  6912     12  AM-AH-ONLY-INDICATOR              PIC X.
  6913         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6914         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6915
  6916     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6917
  6918     12  AM-OVER-SHORT.
  6919         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6920         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 128
* EL050.cbl
  6921
  6922     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6923     12  AM-DCC-CLP-STATE                  PIC XX.
  6924
  6925     12  AM-RECALC-COMM                    PIC X.
  6926     12  AM-RECALC-REIN                    PIC X.
  6927
  6928     12  AM-REI-TABLE                      PIC XXX.
  6929     12  AM-REI-ET-LF                      PIC X.
  6930     12  AM-REI-ET-AH                      PIC X.
  6931     12  AM-REI-PE-LF                      PIC X.
  6932     12  AM-REI-PE-AH                      PIC X.
  6933     12  AM-REI-PRT-ST                     PIC X.
  6934     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6935     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6936     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6937     12  AM-REI-GROUP-A                    PIC X(6).
  6938     12  AM-REI-MORT                       PIC X(4).
  6939     12  AM-REI-PRT-OW                     PIC X.
  6940     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6941     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6942     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6943     12  AM-REI-GROUP-B                    PIC X(6).
  6944
  6945     12  AM-TRUST-TYPE                     PIC X(2).
  6946
  6947     12  AM-EMPLOYER-STMT-USED             PIC X.
  6948     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6949
  6950     12  AM-STD-AH-TYPE                    PIC XX.
  6951     12  AM-EARN-METHODS.
  6952         16  AM-EARN-METHOD-R              PIC X.
  6953             88 AM-REF-RL-R78                 VALUE 'R'.
  6954             88 AM-REF-RL-PR                  VALUE 'P'.
  6955             88 AM-REF-RL-MEAN                VALUE 'M'.
  6956             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6957         16  AM-EARN-METHOD-L              PIC X.
  6958             88 AM-REF-LL-R78                 VALUE 'R'.
  6959             88 AM-REF-LL-PR                  VALUE 'P'.
  6960             88 AM-REF-LL-MEAN                VALUE 'M'.
  6961             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6962         16  AM-EARN-METHOD-A              PIC X.
  6963             88 AM-REF-AH-R78                 VALUE 'R'.
  6964             88 AM-REF-AH-PR                  VALUE 'P'.
  6965             88 AM-REF-AH-MEAN                VALUE 'M'.
  6966             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6967             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6968             88 AM-REF-AH-NET                 VALUE 'N'.
  6969
  6970     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6971     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6972     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6973
  6974     12  AM-RET-Y-N                        PIC X.
  6975     12  AM-RET-P-E                        PIC X.
  6976     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6977     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6978     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 129
* EL050.cbl
  6979     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6980         16  AM-POOL-PRIME                 PIC XXX.
  6981         16  AM-POOL-SUB                   PIC XXX.
  6982     12  AM-RETRO-EARNINGS.
  6983         16  AM-RET-EARN-R                 PIC X.
  6984         16  AM-RET-EARN-L                 PIC X.
  6985         16  AM-RET-EARN-A                 PIC X.
  6986     12  AM-RET-ST-TAX-USE                 PIC X.
  6987         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6988         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6989     12  AM-RETRO-BEG-EARNINGS.
  6990         16  AM-RET-BEG-EARN-R             PIC X.
  6991         16  AM-RET-BEG-EARN-L             PIC X.
  6992         16  AM-RET-BEG-EARN-A             PIC X.
  6993     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6994     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6995
  6996     12  AM-USER-SELECT-OPTIONS.
  6997         16  AM-USER-SELECT-1              PIC X(10).
  6998         16  AM-USER-SELECT-2              PIC X(10).
  6999         16  AM-USER-SELECT-3              PIC X(10).
  7000         16  AM-USER-SELECT-4              PIC X(10).
  7001         16  AM-USER-SELECT-5              PIC X(10).
  7002
  7003     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7004
  7005     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  7006
  7007     12  AM-RPT045A-SWITCH                 PIC X.
  7008         88  RPT045A-OFF                   VALUE 'N'.
  7009
  7010     12  AM-INSURANCE-LIMITS.
  7011         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  7012         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  7013
  7014     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  7015         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  7016
  7017     12  AM-DISMBR-COVERAGE-SW             PIC X.
  7018         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  7019         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  7020
  7021     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  7022
  7023     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  7024     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  7025     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  7026     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  7027     12  AM-DCC-UEF-STATE                  PIC XX.
  7028     12  FILLER                            PIC XXX.
  7029     12  AM-REPORT-CODE-3                  PIC X(10).
  7030*    12  FILLER                            PIC X(22).
  7031
  7032     12  AM-RESERVE-DATE.
  7033         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  7034         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  7035         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  7036
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 130
* EL050.cbl
  7037     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  7038     12  AM-NOTIFICATION-TYPES.
  7039         16  AM-NOTIF-OF-LETTERS           PIC X.
  7040         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  7041         16  AM-NOTIF-OF-REPORTS           PIC X.
  7042         16  AM-NOTIF-OF-STATUS            PIC X.
  7043
  7044     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  7045         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  7046         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  7047         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  7048         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  7049
  7050     12  AM-BENEFIT-CONTROLS.
  7051         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  7052             20  AM-BENEFIT-CODE           PIC XX.
  7053             20  AM-BENEFIT-TYPE           PIC X.
  7054             20  AM-BENEFIT-REVISION       PIC XXX.
  7055             20  AM-BENEFIT-REM-TERM       PIC X.
  7056             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  7057             20  FILLER                    PIC XX.
  7058         16  FILLER                        PIC X(80).
  7059
  7060     12  AM-TRANSFER-DATA.
  7061         16  AM-TRANSFERRED-FROM.
  7062             20  AM-TRNFROM-CARRIER        PIC X.
  7063             20  AM-TRNFROM-GROUPING.
  7064                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  7065                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  7066             20  AM-TRNFROM-STATE          PIC XX.
  7067             20  AM-TRNFROM-ACCOUNT.
  7068                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  7069                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  7070             20  AM-TRNFROM-DTE            PIC XX.
  7071         16  AM-TRANSFERRED-TO.
  7072             20  AM-TRNTO-CARRIER          PIC X.
  7073             20  AM-TRNTO-GROUPING.
  7074                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  7075                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  7076             20  AM-TRNTO-STATE            PIC XX.
  7077             20  AM-TRNTO-ACCOUNT.
  7078                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  7079                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  7080             20  AM-TRNTO-DTE              PIC XX.
  7081         16  FILLER                        PIC X(10).
  7082
  7083     12  AM-SAVED-REMIT-TO                 PIC 99.
  7084
  7085     12  AM-COMM-STRUCTURE-SAVED.
  7086         16  AM-DEFN-1-SAVED.
  7087             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  7088                 24  AM-AGT-SV             PIC X(10).
  7089                 24  AM-COM-TYP-SV         PIC X.
  7090                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  7091                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  7092                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  7093                 24  AM-RECALC-LV-INDIC-SV PIC X.
  7094                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 131
* EL050.cbl
  7095                 24  AM-GL-CODES-SV        PIC X.
  7096                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  7097                 24  FILLER                PIC X.
  7098         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  7099             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  7100                 24  FILLER                PIC X(11).
  7101                 24  AM-L-COMA-SV          PIC XXX.
  7102                 24  AM-J-COMA-SV          PIC XXX.
  7103                 24  AM-A-COMA-SV          PIC XXX.
  7104                 24  FILLER                PIC X(6).
  7105
  7106     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  7107         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  7108            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  7109            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  7110            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  7111
  7112     12  AM-ORIG-DEALER-NO                 PIC X(10).
  7113     12  FILLER                            PIC X(120).
  7114
  7115     12  AM-ACCOUNT-EXECUTIVE-DATA.
  7116         16  AM-CONTROL-NAME               PIC X(30).
  7117         16  AM-EXECUTIVE-ONE.
  7118             20  AM-EXEC1-NAME             PIC X(15).
  7119             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  7120                                                          COMP-3.
  7121             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7122                                                          COMP-3.
  7123         16  AM-EXECUTIVE-TWO.
  7124             20  AM-EXEC2-NAME             PIC X(15).
  7125             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7126                                                          COMP-3.
  7127             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7128                                                          COMP-3.
  7129
  7130     12  AM-RETRO-ADDITIONAL-DATA.
  7131         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7132         16  AM-RETRO-PREM-P-E             PIC X.
  7133         16  AM-RETRO-CLMS-P-I             PIC X.
  7134         16  AM-RETRO-RET-BRACKET-LF.
  7135             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7136                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7137                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7138             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7139                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7140                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7141             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7142                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7143                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7144         16  AM-RETRO-RET-BRACKET-AH.
  7145             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7146                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7147                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7148                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7149             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7150                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7151                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7152             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 132
* EL050.cbl
  7153                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7154                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7155
  7156     12  AM-COMMENTS.
  7157         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7158
  7159     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7160         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7161         16  AM-FLI-BILLING-CODE           PIC X.
  7162         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7163         16  AM-FLI-UNITED-IDENT           PIC X.
  7164         16  AM-FLI-INTEREST-LOST-DATA.
  7165             20  AM-FLI-BANK-NO            PIC X(5).
  7166             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7167             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7168             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7169         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7170             20  AM-FLI-AGT                PIC X(9).
  7171             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7172             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7173         16  FILLER                        PIC X(102).
  7174
  7175     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7176         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7177             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7178             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7179             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7180             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7181             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7182         16  FILLER                          PIC X(10).
  7183******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 133
* EL050.cbl
  7185*    COPY ERCREIN.
  7186******************************************************************
  7187*                                                                *
  7188*                            ERCREIN                             *
  7189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7190*                            VMOD=2.010                          *
  7191*                                                                *
  7192*   ONLINE CREDIT SYSTEM                                         *
  7193*                                                                *
  7194*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7195*                                                                *
  7196*   FILE TYPE = VSAM,KSDS                                        *
  7197*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7198*                                                                *
  7199*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7200*       ALTERNATE PATH = NONE                                    *
  7201*                                                                *
  7202*   LOG = NO                                                     *
  7203*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7204*                                                                *
  7205******************************************************************
  7206*                   C H A N G E   L O G
  7207*
  7208* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7209*-----------------------------------------------------------------
  7210*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7211* EFFECTIVE    NUMBER
  7212*-----------------------------------------------------------------
  7213* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7214* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7215******************************************************************
  7216 01  REINSURANCE-RECORD.
  7217     12  RE-RECORD-ID                      PIC XX.
  7218         88  VALID-RE-ID                      VALUE 'RE'.
  7219
  7220     12  RE-CONTROL-PRIMARY.
  7221         16  RE-COMPANY-CD                 PIC X.
  7222         16  RE-KEY.
  7223             20  RE-CODE                   PIC X.
  7224                 88  RE-TABLE-RECORD          VALUE 'A'.
  7225                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7226             20  RE-TABLE                  PIC XXX.
  7227             20  FILLER                    PIC XXX.
  7228         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7229             20  FILLER                    PIC X.
  7230             20  RE-COMPANY.
  7231                 24  RE-COMP-PRIME         PIC XXX.
  7232                 24  RE-COMP-SUB           PIC XXX.
  7233
  7234     12  RE-MAINT-INFORMATION.
  7235         16  RE-LAST-MAINT-DT              PIC XX.
  7236         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7237         16  RE-LAST-MAINT-USER            PIC X(4).
  7238         16  FILLER                        PIC X(10).
  7239
  7240     12  RE-TABLE-DATA.
  7241         16  RE-100-COMP                   PIC 99.
  7242
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 134
* EL050.cbl
  7243         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7244             20  RE-REI-COMP-NO.
  7245                 24  RE-REI-COMP           PIC XXX.
  7246                 24  RE-REI-COMP-SUB       PIC XXX.
  7247             20  RE-LF-QC                  PIC X.
  7248             20  RE-AH-QC                  PIC X.
  7249             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7250             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7251             20  RE-LFAGE-LO               PIC 99.
  7252             20  RE-LFAGE-HI               PIC 99.
  7253             20  RE-AHAGE-LO               PIC 99.
  7254             20  RE-AHAGE-HI               PIC 99.
  7255             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7256             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7257             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7258             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7259             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7260             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7261             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7262             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7263             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7264             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7265             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7266             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7267             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7268             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7269             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7270             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7271             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7272             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7273             20  RE-LF-BEN-CODE            PIC X.
  7274             20  RE-AH-BEN-CODE            PIC X.
  7275             20  RE-INTERACTIVE            PIC X.
  7276             20  RE-REMAINING              PIC X.
  7277             20  RE-LF-RUNOFF-SW           PIC X.
  7278             20  RE-AH-RUNOFF-SW           PIC X.
  7279             20  FILLER                    PIC X(19).
  7280
  7281         16  RE-COMP-INFO-END              PIC X(6).
  7282         16  RE-NSP-ST-CD-LF               PIC XX.
  7283         16  RE-NSP-ST-CD-AH               PIC XX.
  7284         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7285             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7286
  7287         16  FILLER                        PIC X(27).
  7288
  7289     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7290         16  RE-NAME                       PIC X(30).
  7291         16  RE-LF-PE                      PIC X.
  7292         16  RE-AH-PE                      PIC X.
  7293         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7294         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7295         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7296         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7297         16  RE-PRT-ST                     PIC X.
  7298         16  RE-PRT-OW                     PIC X.
  7299         16  RE-MORT-CODE                  PIC X(4).
  7300         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 135
* EL050.cbl
  7301         16  RE-ZERO-LF-FEE                PIC X.
  7302         16  RE-ZERO-AH-FEE                PIC X.
  7303         16  RE-CEDE-NAME                  PIC X(30).
  7304         16  RE-LF-COMM                    PIC X.
  7305         16  RE-AH-COMM                    PIC X.
  7306         16  RE-LF-TAX                     PIC X.
  7307         16  RE-AH-TAX                     PIC X.
  7308         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7309         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7310         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7311
  7312         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7313             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7314
  7315         16  RE-LF-CEDING-FEE-BRACKETS.
  7316             20  RE-LF-FEE-METHOD          PIC X.
  7317                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7318                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7319                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7320                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7321             20  RE-LF-FEE-BASIS           PIC X.
  7322                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7323                 88  RE-LF-NET-CEDED               VALUE '2'.
  7324                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7325                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7326                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7327                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7328                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7329                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7330             20  FILLER                    PIC XXX.
  7331             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7332                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7333                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7334
  7335         16  RE-AH-CEDING-FEE-BRACKETS.
  7336             20  RE-AH-FEE-METHOD          PIC X.
  7337                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7338                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7339                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7340                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7341             20  RE-AH-FEE-BASIS           PIC X.
  7342                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7343                 88  RE-AH-NET-CEDED               VALUE '2'.
  7344                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7345                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7346                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7347                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7348                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7349                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7350             20  FILLER                    PIC XXX.
  7351             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7352                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7353                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7354
  7355         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7356
  7357         16  RE-OLD-CEDING-STMT            PIC X.
  7358
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 136
* EL050.cbl
  7359         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7360         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7361         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7362         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7363         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7364         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7365         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7366         16  RE-MORT-SW                    PIC X.
  7367         16  RE-CEDING-TYPE-FLAG           PIC X.
  7368             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7369             88  RE-CEDED                          VALUE 'C'.
  7370             88  RE-ASSUMED                        VALUE 'A'.
  7371             88  RE-PHANTOM                        VALUE 'P'.
  7372
  7373         16  RE-CEDING-STMT-OPT-A          PIC X.
  7374             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7375         16  RE-CEDING-STMT-OPT-B          PIC X.
  7376             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7377         16  RE-CEDING-STMT-OPT-C          PIC X.
  7378             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7379         16  RE-CEDING-STMT-OPT-D          PIC X.
  7380             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7381         16  RE-CEDING-STMT-OPT-E          PIC X.
  7382             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7383
  7384         16  RE-PRT-CRSV                   PIC X.
  7385
  7386         16  RE-GL-CENTER                  PIC X(4).
  7387
  7388         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7389
  7390         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7391
  7392         16  RE-EARN-STOP-CODE             PIC X.
  7393             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7394             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7395
  7396         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7397             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7398
  7399         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7400         16  FILLER                        PIC X(2281).
  7401
  7402         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7403
  7404******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 137
* EL050.cbl
  7406*    COPY ERCCTBL.
  7407******************************************************************
  7408*                                                                *
  7409*                                                                *
  7410*                            ERCCTBL                             *
  7411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7412*                            VMOD=2.003
  7413*                                                                *
  7414*   ONLINE CREDIT SYSTEM                                         *
  7415*                                                                *
  7416*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7417*                                                                *
  7418*   FILE TYPE = VSAM,KSDS                                        *
  7419*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7420*                                                                *
  7421*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7422*       ALTERNATE PATH = NONE                                    *
  7423*                                                                *
  7424*   LOG = NO                                                     *
  7425*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7426*                                                                *
  7427*                                                                *
  7428******************************************************************
  7429
  7430 01  COMM-TABLE-RECORD.
  7431     12  CT-RECORD-ID                      PIC XX.
  7432         88  VALID-CT-ID                      VALUE 'CT'.
  7433
  7434     12  CT-CONTROL-PRIMARY.
  7435         16  CT-COMPANY-CD                 PIC X.
  7436         16  CT-TABLE                      PIC XXX.
  7437         16  CT-CNTRL-2.
  7438             20  CT-BEN-TYPE               PIC X.
  7439             20  CT-BEN-CODE               PIC XX.
  7440
  7441     12  CT-MAINT-INFORMATION.
  7442         16  CT-LAST-MAINT-DT              PIC XX.
  7443         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7444         16  CT-LAST-MAINT-USER            PIC X(4).
  7445         16  FILLER                        PIC X(31).
  7446
  7447     12  CT-LIMITS.
  7448         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7449
  7450         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7451
  7452         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7453
  7454     12  CT-RATES.
  7455         16  CT-RTX          OCCURS 27 TIMES.
  7456             20  CT-RT                     PIC SV9(5)     COMP-3.
  7457             20  CT-RT-R   REDEFINES
  7458                 CT-RT                     PIC XXX.
  7459
  7460     12  FILLER                            PIC  X(42).
  7461
  7462******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 138
* EL050.cbl
  7464*    COPY ERCFORM.
  7465******************************************************************
  7466*                                                                *
  7467*                                                                *
  7468*                            ERCFORM.                            *
  7469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7470*                            VMOD=2.003                          *
  7471*                                                                *
  7472*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7473*                                                                *
  7474*    FILE TYPE = VSAM,KSDS                                       *
  7475*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7476*                                                                *
  7477*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7478*                                                                *
  7479*    LOG = YES                                                   *
  7480*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7481******************************************************************
  7482 01  FORM-MASTER.
  7483    12  FO-RECORD-ID                 PIC X(02).
  7484        88  VALID-FO-ID                  VALUE 'FO'.
  7485
  7486    12  FO-CONTROL-PRIMARY.
  7487        16  FO-COMPANY-CD            PIC X(01).
  7488        16  FO-STATE                 PIC X(02).
  7489        16  FO-FORM-ID               PIC X(12).
  7490        16  FO-FORM-EXP-DT           PIC X(02).
  7491
  7492    12  FO-POLICY-FORM-DATA.
  7493        16  FO-IND-GRP-CD            PIC X(01).
  7494        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7495        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7496        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7497        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7498        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7499        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7500        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7501        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7502        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7503        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7504        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7505        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7506        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7507        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7508        16  FO-APP-CERT-USE-CD       PIC X(01).
  7509
  7510    12  FILLER                       PIC X(29).
  7511
  7512    12  FO-FORM-PLAN-TABLE.
  7513        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7514            20  FO-PLAN-TYPE         PIC X(01).
  7515            20  FO-PLAN-ID           PIC X(02).
  7516            20  FO-PLAN-TERM         PIC 9(03).
  7517            20  FO-PLAN-REFUND-METHOD
  7518                                     PIC X.
  7519
  7520    12  FILLER                       PIC X(30).
  7521
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 139
* EL050.cbl
  7522    12  FO-COMMENTS-AREA.
  7523        16  FO-COMMENT-LINE-1        PIC X(78).
  7524
  7525    12  FILLER                       PIC X(20).
  7526
  7527    12  FO-MAINT-INFORMATION.
  7528        16  FO-LAST-MAINT-DT         PIC X(02).
  7529        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7530        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 140
* EL050.cbl
  7532*    COPY ELCMSTR.
  7533******************************************************************
  7534*                                                                *
  7535*                            ELCMSTR.                            *
  7536*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7537*                            VMOD=2.012                          *
  7538*                                                                *
  7539*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7540*                                                                *
  7541*   FILE TYPE = VSAM,KSDS                                        *
  7542*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7543*                                                                *
  7544*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7545*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7546*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7547*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7548*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7549*                                                 RKP=75,LEN=21  *
  7550*                                                                *
  7551*   **** NOTE ****                                               *
  7552*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7553*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7554*                                                                *
  7555*   LOG = YES                                                    *
  7556*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7557******************************************************************
  7558*                   C H A N G E   L O G
  7559*
  7560* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7561*-----------------------------------------------------------------
  7562*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7563* EFFECTIVE    NUMBER
  7564*-----------------------------------------------------------------
  7565* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7566* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7567* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7568* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7569* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7570* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  7571* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  7572******************************************************************
  7573 01  CLAIM-MASTER.
  7574     12  CL-RECORD-ID                PIC XX.
  7575         88  VALID-CL-ID         VALUE 'CL'.
  7576
  7577     12  CL-CONTROL-PRIMARY.
  7578         16  CL-COMPANY-CD           PIC X.
  7579         16  CL-CARRIER              PIC X.
  7580         16  CL-CLAIM-NO             PIC X(7).
  7581         16  CL-CERT-NO.
  7582             20  CL-CERT-PRIME       PIC X(10).
  7583             20  CL-CERT-SFX         PIC X.
  7584
  7585     12  CL-CONTROL-BY-NAME.
  7586         16  CL-COMPANY-CD-A1        PIC X.
  7587         16  CL-INSURED-LAST-NAME    PIC X(15).
  7588         16  CL-INSURED-NAME.
  7589             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 141
* EL050.cbl
  7590             20  CL-INSURED-MID-INIT PIC X.
  7591
  7592     12  CL-CONTROL-BY-SSN.
  7593         16  CL-COMPANY-CD-A2        PIC X.
  7594         16  CL-SOC-SEC-NO.
  7595             20  CL-SSN-STATE        PIC XX.
  7596             20  CL-SSN-ACCOUNT      PIC X(6).
  7597             20  CL-SSN-LN3          PIC X(3).
  7598
  7599     12  CL-CONTROL-BY-CERT-NO.
  7600         16  CL-COMPANY-CD-A4        PIC X.
  7601         16  CL-CERT-NO-A4.
  7602             20  CL-CERT-A4-PRIME    PIC X(10).
  7603             20  CL-CERT-A4-SFX      PIC X.
  7604
  7605     12  CL-CONTROL-BY-CCN.
  7606         16  CL-COMPANY-CD-A5        PIC X.
  7607         16  CL-CCN-A5.
  7608             20  CL-CCN.
  7609                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7610                 24  CL-CCN-PRIME-A5 PIC X(12).
  7611             20  CL-CCN-FILLER-A5    PIC X(4).
  7612
  7613     12  CL-INSURED-PROFILE-DATA.
  7614         16  CL-INSURED-BIRTH-DT     PIC XX.
  7615         16  CL-INSURED-SEX-CD       PIC X.
  7616             88  INSURED-IS-MALE        VALUE 'M'.
  7617             88  INSURED-IS-FEMALE      VALUE 'F'.
  7618             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7619         16  CL-INSURED-OCC-CD       PIC X(6).
  7620         16  FILLER                  PIC X(5).
  7621
  7622     12  CL-PROCESSING-INFO.
  7623         16  CL-PROCESSOR-ID         PIC X(4).
  7624         16  CL-CLAIM-STATUS         PIC X.
  7625             88  CLAIM-IS-OPEN          VALUE 'O'.
  7626             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7627         16  CL-CLAIM-TYPE           PIC X.
  7628*            88  AH-CLAIM               VALUE 'A'.
  7629*            88  LIFE-CLAIM             VALUE 'L'.
  7630*            88  PROPERTY-CLAIM         VALUE 'P'.
  7631*            88  IUI-CLAIM              VALUE 'I'.
  7632*            88  GAP-CLAIM              VALUE 'G'.
  7633*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7634*            88  OTHER-CLAIM            VALUE 'O'.
  7635         16  CL-CLAIM-PREM-TYPE      PIC X.
  7636             88  SINGLE-PREMIUM         VALUE '1'.
  7637             88  O-B-COVERAGE           VALUE '2'.
  7638             88  OPEN-END-COVERAGE      VALUE '3'.
  7639         16  CL-INCURRED-DT          PIC XX.
  7640         16  CL-REPORTED-DT          PIC XX.
  7641         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7642         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7643         16  CL-LAST-PMT-DT          PIC XX.
  7644         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7645         16  CL-PAID-THRU-DT         PIC XX.
  7646         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7647         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 142
* EL050.cbl
  7648         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7649         16  CL-PMT-CALC-METHOD      PIC X.
  7650             88  CL-360-DAY-YR          VALUE '1'.
  7651             88  CL-365-DAY-YR          VALUE '2'.
  7652             88  CL-FULL-MONTHS         VALUE '3'.
  7653         16  CL-CAUSE-CD             PIC X(6).
  7654
  7655         16  CL-PRIME-CERT-NO.
  7656             20  CL-PRIME-CERT-PRIME PIC X(10).
  7657             20  CL-PRIME-CERT-SFX   PIC X.
  7658
  7659         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7660             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7661             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7662
  7663         16  CL-MICROFILM-NO         PIC X(10).
  7664         16  FILLER REDEFINES CL-MICROFILM-NO.
  7665             20  CL-BENEFIT-PERIOD   PIC 99.
  7666             20  FILLER              PIC X(8).
  7667         16  CL-PROG-FORM-TYPE       PIC X.
  7668         16  CL-LAST-ADD-ON-DT       PIC XX.
  7669
  7670         16  CL-LAST-REOPEN-DT       PIC XX.
  7671         16  CL-LAST-CLOSE-DT        PIC XX.
  7672         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7673             88  FINAL-PAID             VALUE '1'.
  7674             88  CLAIM-DENIED           VALUE '2'.
  7675             88  AUTO-CLOSE             VALUE '3'.
  7676             88  MANUAL-CLOSE           VALUE '4'.
  7677             88  BENEFITS-CHANGED       VALUE 'C'.
  7678             88  SETUP-ERRORS           VALUE 'E'.
  7679         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7680         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7681         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7682             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7683         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7684         16  FILLER                  PIC X.
  7685
  7686     12  CL-CERTIFICATE-DATA.
  7687         16  CL-CERT-ORIGIN          PIC X.
  7688             88  CERT-WAS-ONLINE        VALUE '1'.
  7689             88  CERT-WAS-CREATED       VALUE '2'.
  7690             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7691         16  CL-CERT-KEY-DATA.
  7692             20  CL-CERT-CARRIER     PIC X.
  7693             20  CL-CERT-GROUPING    PIC X(6).
  7694             20  CL-CERT-STATE       PIC XX.
  7695             20  CL-CERT-ACCOUNT.
  7696                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7697                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7698             20  CL-CERT-EFF-DT      PIC XX.
  7699
  7700     12  CL-STATUS-CONTROLS.
  7701         16  CL-PRIORITY-CD          PIC X.
  7702             88  CONFIDENTIAL-DATA      VALUE '8'.
  7703             88  HIGHEST-PRIORITY       VALUE '9'.
  7704         16  CL-SUPV-ATTN-CD         PIC X.
  7705             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 143
* EL050.cbl
  7706             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7707         16  CL-PURGED-DT            PIC XX.
  7708         16  CL-RESTORED-DT          PIC XX.
  7709         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7710         16  CL-NEXT-RESEND-DT       PIC XX.
  7711         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7712         16  CL-CRITICAL-PERIOD      PIC 99.
  7713*        16  FILLER                  PIC XX.
  7714         16  CL-LAST-MAINT-DT        PIC XX.
  7715         16  CL-LAST-MAINT-USER      PIC X(4).
  7716         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7717         16  CL-LAST-MAINT-TYPE      PIC X.
  7718             88  CLAIM-SET-UP           VALUE ' '.
  7719             88  PAYMENT-MADE           VALUE '1'.
  7720             88  LETTER-SENT            VALUE '2'.
  7721             88  MASTER-WAS-ALTERED     VALUE '3'.
  7722             88  MASTER-WAS-RESTORED    VALUE '4'.
  7723             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7724             88  FILE-CONVERTED         VALUE '6'.
  7725             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7726             88  ERROR-CORRECTION       VALUE 'E'.
  7727         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7728         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7729         16  CL-BENEFICIARY          PIC X(10).
  7730         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7731         16  CL-DENIAL-TYPE          PIC X.
  7732             88  CL-TYPE-DENIAL          VALUE '1'.
  7733             88  CL-TYPE-RESCISSION      VALUE '2'.
  7734             88  CL-TYPE-REFORMATION     VALUE '3'.
  7735             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7736             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7737         16  CL-NO-OF-EXTENSIONS     PIC 99.
  7738         16  filler                  pic x(3).
  7739*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7740*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7741*        16  CL-RTW-DT               PIC XX.
  7742
  7743     12  CL-TRAILER-CONTROLS.
  7744         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7745             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7746             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7747             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7748         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7749         16  FILLER                  PIC XX.
  7750         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7751         16  CL-ADDRESS-TRAILER-CNT.
  7752             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7753                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7754             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7755                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7756             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7757                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7758             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7759                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7760             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7761                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7762             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7763                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 144
* EL050.cbl
  7764             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7765                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7766
  7767     12  CL-CV-REFERENCE-NO.
  7768         16  CL-CV-REFNO-PRIME       PIC X(18).
  7769         16  CL-CV-REFNO-SFX         PIC XX.
  7770
  7771     12  CL-FILE-LOCATION            PIC X(4).
  7772
  7773     12  CL-PROCESS-ERRORS.
  7774         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7775             88  NO-FATAL-ERRORS        VALUE ZERO.
  7776         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7777             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7778
  7779     12  CL-PRODUCT-CD               PIC X.
  7780
  7781     12  CL-CURRENT-KEY-DATA.
  7782         16  CL-CURRENT-CARRIER      PIC X.
  7783         16  CL-CURRENT-GROUPING     PIC X(6).
  7784         16  CL-CURRENT-STATE        PIC XX.
  7785         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7786
  7787     12  CL-ASSOCIATES               PIC X.
  7788         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7789         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7790         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7791         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7792
  7793     12  CL-ACTIVITY-CODE            PIC 99.
  7794     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7795     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7796
  7797     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7798     12  CL-LAG-REPORT-CODE          PIC 9.
  7799     12  CL-LOAN-TYPE                PIC XX.
  7800     12  CL-LEGAL-STATE              PIC XX.
  7801
  7802     12  CL-YESNOSW                  PIC X.
  7803     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7804         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7805         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7806         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7807     12  cl-insured-type             pic x.
  7808         88  cl-claim-on-primary         value 'P'.
  7809         88  cl-claim-on-co-borrower     value 'C'.
  7810     12  cl-benefit-expiration-dt    PIC XX.
  7811
  7812 01  PLAN-RECORDS.
  7813     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7814     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7815
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 145
* EL050.cbl
  7817 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7818                          ACCOUNT-MASTER REINSURANCE-RECORD
  7819                          COMM-TABLE-RECORD FORM-MASTER
  7820                          CLAIM-MASTER PLAN-RECORDS.
  7821 0000-DFHEXIT SECTION.
  7822     MOVE '9#                    $   ' TO DFHEIV0.
  7823     MOVE 'EL050' TO DFHEIV1.
  7824     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7825
  7826     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7827
  7828
  7829* EXEC CICS  HANDLE CONDITION
  7830*           ERROR    (9300-ABEND)
  7831*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7832*    END-EXEC.
  7833*    MOVE '"$.J                  ! " #00007824' TO DFHEIV0
  7834     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7835     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7836     MOVE X'2220233030303037383234' TO DFHEIV0(25:11)
  7837     CALL 'kxdfhei1' USING DFHEIV0
  7838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7839
  7840
  7841 0000-COPY-PROCEDURE-DIV.
  7842*                          COPY ELC50PD.
  7843******************************************************************
  7844*                                                                *
  7845*                            ELC50PD                             *
  7846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7847*                            VMOD=2.188                          *
  7848*                                                                *
  7849******************************************************************
  7850*                   C H A N G E   L O G
  7851*
  7852* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7853*-----------------------------------------------------------------
  7854*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7855* EFFECTIVE    NUMBER
  7856*-----------------------------------------------------------------
  7857* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7858* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7859* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7860*                             2709 AND 2718
  7861* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7862* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7863* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7864* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7865* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7866*                                IS OPEN OR CNC DT < PD THRU
  7867* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7868* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7869* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7870* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7871* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7872* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7873* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7874* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 146
* EL050.cbl
  7875* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7876* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7877* 020906                   PEMA  EXPAND LOAN OFFICER
  7878* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7879* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7880* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7881* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7882* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7883* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7884* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7885* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7886* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7887* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7888* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7889* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7890* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7891* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7892* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7893* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7894* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7895* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7896* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7897* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7898* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7899* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7900* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7901* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7902* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7903*                                UPDATE VIN ON CERT TRAILER
  7904* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7905* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7906* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7907* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7908* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7909* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7910* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7911* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7912* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7913* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7914* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7915* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7916* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7917* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7918* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7919* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7920* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7921* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7922* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7923* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7924* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7925* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7926* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7927* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7928* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7929* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7930* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7931* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7932* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 147
* EL050.cbl
  7933* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7934* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7935* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7936* 032912  CR2011110200001  PEMA  AHL CHANGES
  7937* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7938* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7939* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7940* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7941* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7942* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7943* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7944* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7945* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7946* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7947* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7948* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7949* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7950* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7951* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7952* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7953* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7954* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7955* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7956* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7957* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7958* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7959* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7960* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7961* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7962* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7963* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7964*                                CERT #, ADD 2898 FORCIBLE ERROR
  7965* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7966* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7967* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7968* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7969* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7970* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7971* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7972* 021916  CR2014010900001  TANA  ADD ACCT STATUS D,L,R,P
  7973* 032516  IR2016032100002  PEMA  Correct tolerance for DCC.
  7974* 041816  CR2009093000001  PEMA  enhance car, st lvl prem taxes
  7975* 052516  IR2016052400001  PEMA  Correct malformed IF stmt.
  7976* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
  7977* 052317  IR2017052300001  PEMA  Correct malformed conditional stm
  7978* 062717  IR2017061900003  PEMA  Fix 0% APR on refunds
  7979* 100217  CR2016091600001  PEMA  ADD EDIT FOR ZIP CODE
  7980* 100617  CR2017062000003  PEMA  New comm cap edits
  7981* 121117  IR2017121100002  PEMA  INITIALIZE NEW COMM CAP FIELDS.
  7982* 121317  IR2017110100001  PEMA  ERROR FOR CNC ADJ FOR DCC&VPP
  7983* 011718  IR2018011200001  PEMA  CORRECT ROA EXTENSION DAYS ISSUE
  7984* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
  7985* 030118  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  7986* 051518  CR2018051600001  PEMA  Add edit for spaces in certno
  7987* 070218  IR2018062700001  PEMA  Fix edit for spaces in certno
  7988* 092118  CR2018073000001  PEMA  Add lf & ah refund method to ELCR
  7989* 092618  CR2018050200001  PEMA  Add check for open clm on issue
  7990* 021519  CR2019021100001  PEMA  Non-monthly calcs for AL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 148
* EL050.cbl
  7991* 101019  CR2019100700001  PEMA  Disallow V status with claim
  7992******************************************************************
  7993************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7994******************************************************************
  7995
  7996     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7997
  7998     MOVE SPACES                 TO PB-FATAL-FLAG
  7999                                    PB-FORCE-ER-CD
  8000                                    PB-WARN-ER-CD
  8001                                    PB-OUT-BAL-CD.
  8002
  8003     MOVE SPACE                  TO WS-IG-OVRD-AH
  8004                                    WS-IG-OVRD-LF
  8005                                    WS-IG-OVRD-AM
  8006                                    WS-IG-OVRD
  8007                                    WS-IG-OVRD-AH-PL
  8008                                    WS-IG-OVRD-LF-PL
  8009                                    WS-IG-OVRD-AH-BEN
  8010                                    WS-IG-OVRD-LF-BEN.
  8011
  8012******************************************************************
  8013*************       INITIALIZE COMMON ERRORS       ***************
  8014******************************************************************
  8015
  8016     MOVE +0                     TO PB-NO-OF-ERRORS.
  8017     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8018
  8019******************************************************************
  8020
  8021     MOVE EIBDATE                TO DC-JULIAN-DATE.
  8022     SET JULIAN-TO-BIN           TO TRUE.
  8023*    MOVE 5                      TO DC-OPTION-CODE.
  8024     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8025     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  8026
  8027     MOVE ZERO                   TO  SUB4.
  8028
  8029 0040-INITIALIZE-GA-BILL-DT.
  8030
  8031     ADD +1                      TO  SUB4.
  8032
  8033     IF  SUB4 GREATER THAN +5
  8034         GO TO 0050-CHECK-CNTL-FOUND.
  8035
  8036     IF  PB-GA-BILL-DT (SUB4) = SPACES
  8037         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  8038
  8039     GO TO 0040-INITIALIZE-GA-BILL-DT.
  8040
  8041 0050-CHECK-CNTL-FOUND.
  8042
  8043     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  8044        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  8045                                         WS-AH-REM-TERM-CALC
  8046                                         EC-CO-REM-TERM-CALC
  8047        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  8048        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 149
* EL050.cbl
  8049        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  8050                                         WS-TOL-AH-CLAIM
  8051        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  8052                                         WS-TOL-AH-PREM
  8053                                         EC-CO-TOL-PREM
  8054        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  8055                                         WS-TOL-AH-REFUND
  8056                                         EC-CO-TOL-REFUND
  8057        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  8058                                         WS-AH-REFUND-OVS-AMT
  8059                                         EC-CO-OVR-SHT-AMT
  8060        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  8061                                         WS-TOL-AH-PREM-PCT
  8062                                         EC-CO-TOL-PREM-PCT
  8063        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  8064                                         WS-TOL-AH-REFUND-PCT
  8065                                         EC-CO-TOL-REFUND-PCT
  8066        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  8067                                         WS-AH-REFUND-OVS-PCT
  8068                                         EC-CO-OVR-SHT-PCT
  8069        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  8070        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  8071        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  8072        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  8073        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  8074        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  8075        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  8076        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  8077        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  8078        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  8079        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  8080        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  8081                                         EC-CO-MONTH-END-DT
  8082        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  8083          GO TO 0100-READ-ACCT.
  8084
  8085     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8086     MOVE SPACES                 TO CNTL-ACCESS.
  8087     MOVE '1'                    TO CNTL-REC-TYPE.
  8088     MOVE +0                     TO CNTL-SEQ-NO.
  8089
  8090     MOVE '1' TO RC-SW-1.
  8091     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  8092     IF NOT CF-COMPANY-MASTER
  8093         MOVE ZEROS             TO WK-CO-TOL-PREM
  8094                                   WK-CO-TOL-CLAIM
  8095                                   WK-CO-TOL-REFUND
  8096                                   WK-REFUND-OVS-AMT
  8097                                   WK-REFUND-OVS-PCT
  8098                                   WK-CO-TOL-PREM-PCT
  8099                                   WK-CO-TOL-REFUND-PCT
  8100                                   WK-DEFAULT-APR
  8101                                   WK-CO-MAX-CAP
  8102        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  8103                                   WK-CR-R78-METHOD
  8104                                   WK-CO-REF-REJECT-SW
  8105                                   WK-CO-PREM-REJECT-SW
  8106                                   WK-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 150
* EL050.cbl
  8107                                   WK-BIRTH-DATE-INPUT
  8108                                   WK-JOINT-AGE-INPUT
  8109        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  8110        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  8111        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  8112        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  8113          GO TO 0099-COMPANY-NOT-FOUND.
  8114
  8115     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  8116        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  8117     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  8118        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  8119     IF CF-CO-TOL-CAP NOT NUMERIC
  8120        MOVE +0                    TO CF-CO-TOL-CAP.
  8121     IF CF-DEFAULT-APR NOT NUMERIC
  8122        MOVE +0                    TO CF-DEFAULT-APR.
  8123
  8124     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  8125     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  8126     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  8127     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  8128     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  8129     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  8130     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  8131     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  8132     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  8133     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  8134     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  8135     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  8136
  8137     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  8138          CF-CO-OVR-SHT-AMT > +0
  8139        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  8140
  8141     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  8142          CF-CO-OVR-SHT-PCT > +0
  8143        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  8144
  8145     IF CF-VALID-REM-TRM-OPTION
  8146         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  8147     ELSE
  8148         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  8149
  8150     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  8151     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  8152     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  8153     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  8154
  8155     GO TO 0050-CHECK-CNTL-FOUND.
  8156
  8157 0099-COMPANY-NOT-FOUND.
  8158
  8159     MOVE ER-2616                TO WS-ERROR.
  8160     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8161
  8162 0100-READ-ACCT.
  8163
  8164     MOVE SPACES                 TO DATE-RANGE-SW.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 151
* EL050.cbl
  8165
  8166     IF WK-ACCT-ADDR = ZEROS
  8167        GO TO 0102-ACCT-GETMAIN.
  8168
  8169     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  8170     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  8171     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8172
  8173     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8174        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8175        GO TO 0105-READ-ACCT
  8176     END-IF
  8177
  8178     IF PB-CARRIER NOT = SPACES
  8179        IF PB-CARRIER NOT = AM-VG-CARRIER
  8180           GO TO 0105-READ-ACCT.
  8181
  8182     IF PB-STATE NOT = SPACES
  8183        IF PB-STATE NOT = AM-VG-STATE
  8184           GO TO 0105-READ-ACCT.
  8185
  8186     IF PB-GROUPING NOT = SPACES
  8187        IF PB-GROUPING NOT = AM-VG-GROUPING
  8188           GO TO 0105-READ-ACCT.
  8189
  8190     MOVE 'X'                 TO DATE-RANGE-SW.
  8191
  8192     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8193        MOVE 'X'                 TO DATE-RANGE-SW
  8194        GO TO 0105-READ-ACCT.
  8195
  8196     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8197        GO TO 0105-READ-ACCT.
  8198
  8199     GO TO 0180-ACCOUNT-FOUND.
  8200
  8201 0102-ACCT-GETMAIN.
  8202     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8203     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8204
  8205 0105-READ-ACCT.
  8206     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8207     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8208     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8209     MOVE PB-STATE               TO ACCT-STATE.
  8210     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8211     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8212
  8213     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8214
  8215     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8216
  8217 0110-FIND-ACCT-TOLERANCES-LOOP.
  8218     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8219
  8220     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8221        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8222        GO TO 0199-ACCT-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 152
* EL050.cbl
  8223     END-IF
  8224     IF PB-CARRIER NOT = SPACES
  8225        IF PB-CARRIER NOT = AM-VG-CARRIER
  8226           GO TO 0199-ACCT-NOT-FOUND.
  8227
  8228     IF PB-STATE NOT = SPACES
  8229        IF PB-STATE NOT = AM-VG-STATE
  8230           GO TO 0199-ACCT-NOT-FOUND.
  8231
  8232     IF PB-GROUPING NOT = SPACES
  8233        IF PB-GROUPING NOT = AM-VG-GROUPING
  8234           GO TO 0199-ACCT-NOT-FOUND.
  8235
  8236     MOVE 'X'                    TO DATE-RANGE-SW.
  8237
  8238     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8239        MOVE 'X'                 TO DATE-RANGE-SW
  8240        GO TO 0199-ACCT-NOT-FOUND.
  8241
  8242     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8243        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8244
  8245 0180-ACCOUNT-FOUND.
  8246     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8247     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8248     MOVE AM-STATE               TO PB-SV-STATE.
  8249     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8250
  8251     IF AM-CANCEL-FEE  NOT NUMERIC
  8252        MOVE ZEROS TO AM-CANCEL-FEE.
  8253
  8254     IF AM-MAX-MON-BEN NOT NUMERIC
  8255        MOVE ZEROS TO AM-MAX-MON-BEN.
  8256
  8257     IF AM-MAX-TOT-BEN NOT NUMERIC
  8258        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8259
  8260     IF AM-CLP-TOL-PCT NOT NUMERIC
  8261        MOVE +0                  TO AM-CLP-TOL-PCT
  8262     END-IF
  8263     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8264        MOVE +0                  TO AM-SPP-LEASE-COMM
  8265     END-IF
  8266     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8267        MOVE ER-2611             TO   WS-ERROR
  8268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8269
  8270     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8271        MOVE ER-2621             TO   WS-ERROR
  8272        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8273
  8274     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8275        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8276        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8277        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8278         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8279
  8280     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 153
* EL050.cbl
  8281     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8282     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8283     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8284     IF AM-CLP-TOL-PCT NOT = ZEROS
  8285        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8286     END-IF
  8287     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8288        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8289     END-IF
  8290*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8291*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8292*                                   WS-ADMIN-FEES
  8293*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8294*          (SUB5 > +10)
  8295*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8296*             AND (AM-A-COM (SUB5) NUMERIC)
  8297*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8298*                + (AM-A-COM (SUB5) * 1000)
  8299*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8300*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8301*                + (AM-A-COM (SUB5) * 1000)
  8302*             END-IF
  8303*             IF AM-COM-TYP (SUB5) = 'N'
  8304*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8305*                + (AM-A-COM (SUB5) * 1000)
  8306*             END-IF
  8307*          END-IF
  8308*       END-PERFORM
  8309*    END-IF
  8310     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8311        AND (PB-ISSUE)
  8312        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8313                                    ws-cred-union-fees
  8314        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8315           (SUB5 > +10)
  8316           MOVE +0 TO WS-WK-RATE
  8317           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8318                                   'O' OR 'S')
  8319              IF (AM-A-COM (SUB5) NUMERIC)
  8320                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8321                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8322              ELSE
  8323                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8324                 IF PB-ISSUE
  8325                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8326                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8327                 ELSE
  8328                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8329                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8330                 END-IF
  8331                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8332                 MOVE ZEROS             TO WS-SUB1
  8333                                           WS-COMMISSION
  8334                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8335                 MOVE '0530'               TO CTBL-SW
  8336                 MOVE ' '                  TO WS-CTBL-READ-SW
  8337                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8338                 IF FIRST-TIME-THROUGH
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 154
* EL050.cbl
  8339                    MOVE 'AA'              TO CTBL-BEN-CODE
  8340                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8341                 END-IF
  8342                 IF CTBL-TABLE-FOUND
  8343                    IF PB-ISSUE
  8344                       COMPUTE WS-COMM-CK-AMT =
  8345                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8346                    ELSE
  8347                       COMPUTE WS-COMM-CK-AMT =
  8348                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8349                    END-IF
  8350                    PERFORM 8800-GET-COMP-RATE
  8351                              THRU 8800-EXIT
  8352                 END-IF
  8353              END-IF
  8354              if am-com-typ (sub5) = 'O' or 'S'
  8355                 compute ws-cred-union-fees rounded =
  8356                    ws-cred-union-fees +
  8357                    (pb-i-ah-premium-amt * ws-wk-rate)
  8358              else
  8359                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8360                + (WS-WK-RATE * 1000)
  8361              end-if
  8362           END-IF
  8363        END-PERFORM
  8364     END-IF
  8365     IF PB-COMPANY-ID EQUAL 'CRI'
  8366         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8367
  8368     IF PB-COMPANY-ID EQUAL 'NCL'
  8369         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8370     END-IF
  8371
  8372     GO TO 0200-READ-CERT.
  8373
  8374 0199-ACCT-NOT-FOUND.
  8375
  8376     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8377
  8378     IF DATE-RANGE-SW NOT = SPACES
  8379        MOVE ER-2601             TO WS-ERROR
  8380        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8381     ELSE
  8382        MOVE ER-2619             TO WS-ERROR
  8383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8384
  8385     GO TO 9990-RETURN.
  8386
  8387 0200-READ-CERT.
  8388
  8389     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8390     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8391     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8392     MOVE PB-SV-STATE            TO CERT-STATE.
  8393     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8394     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8395     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8396
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 155
* EL050.cbl
  8397     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8398
  8399     IF CERT-WAS-NOT-FOUND
  8400        GO TO 0299-CERT-NOT-FOUND.
  8401
  8402     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8403        MOVE ER-2759             TO WS-ERROR
  8404        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8405        GO TO 0298-UNLOCK-RETURN.
  8406
  8407     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8408         MOVE ER-2758            TO WS-ERROR
  8409         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8410         GO TO 0298-UNLOCK-RETURN.
  8411
  8412     IF PB-ISSUE
  8413        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8414           IF CERT-WAS-CREATED-FOR-CLAIM
  8415              NEXT SENTENCE
  8416            ELSE
  8417              MOVE ER-2626       TO WS-ERROR
  8418              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419              GO TO 0298-UNLOCK-RETURN.
  8420
  8421     IF NOT PB-CANCELLATION
  8422        GO TO 0300-CONTINUE-EDIT.
  8423
  8424     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8425     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8426     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8427     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8428     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8429     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8430
  8431     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8432     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8433     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8434     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8435     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8436     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8437     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8438     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8439     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8440
  8441     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8442     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8443     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8444     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8445     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8446     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8447     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8448
  8449     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8450     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8451
  8452     MOVE CM-CREDIT-INTERFACE-SW-1
  8453                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8454     MOVE CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 156
* EL050.cbl
  8455                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8456
  8457     IF CM-O-B-COVERAGE
  8458         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8459
  8460     IF CM-LIVES NOT NUMERIC
  8461         MOVE ZERO                TO CM-LIVES.
  8462
  8463     IF CM-BILLED NOT NUMERIC
  8464         MOVE ZERO                TO CM-BILLED.
  8465
  8466     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8467         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8468         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8469         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8470         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8471         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8472         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8473         MOVE CM-LIVES             TO PB-CI-LIVES
  8474*The next line causes a problem with my change  I dont think it is
  8475*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8476
  8477     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8478     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8479     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8480     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8481     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8482     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8483
  8484     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8485     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8486     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8487     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8488
  8489     IF CM-LIFE-COMM-PCT NUMERIC
  8490         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8491     ELSE
  8492         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8493
  8494     IF CM-AH-COMM-PCT NUMERIC
  8495         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8496     ELSE
  8497         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8498
  8499     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8500
  8501     IF CM-LOAN-APR       NOT NUMERIC
  8502           MOVE ZERO               TO CM-LOAN-APR.
  8503
  8504     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8505           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8506
  8507     IF CM-LOAN-TERM      NOT NUMERIC
  8508           MOVE ZERO               TO CM-LOAN-TERM.
  8509
  8510     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8511           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8512
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 157
* EL050.cbl
  8513     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8514           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8515
  8516     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8517     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8518     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8519     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8520     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8521     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8522     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8523     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8524     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8525     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8526     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8527     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8528     MOVE CM-BENEFICIARY           TO PB-CI-BENEFICIARY-NAME
  8529
  8530     IF CM-STATE = CM-SSN-STATE
  8531         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8532
  8533     IF CM-STATE NOT = CM-MEMB-STATE
  8534         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8535
  8536     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8537
  8538     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8539*       MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8540        IF CM-ADDL-CLP NOT NUMERIC
  8541           MOVE +0               TO CM-ADDL-CLP
  8542        END-IF
  8543        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8544        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8545           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8546        END-IF
  8547     END-IF
  8548     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8549        MOVE +0                  TO WS-ADMIN-FEES
  8550                                    WS-CSO-ADMIN-FEE
  8551                                    WS-COMM-AND-MFEE
  8552                                    WS-1ST-YR-ALLOW
  8553        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8554           (SUB5 > +10)
  8555           MOVE +0 TO WS-WK-RATE
  8556           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8557              IF (AM-A-COM (SUB5) NUMERIC)
  8558                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8559                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8560              ELSE
  8561                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8562                 IF PB-ISSUE
  8563                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8564                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8565                 ELSE
  8566                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8567                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8568                 END-IF
  8569                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8570                 MOVE ZEROS             TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 158
* EL050.cbl
  8571                                           WS-COMMISSION
  8572                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8573                 MOVE '0530'               TO CTBL-SW
  8574                 MOVE ' '                  TO WS-CTBL-READ-SW
  8575                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8576                 IF FIRST-TIME-THROUGH
  8577                    MOVE 'AA'              TO CTBL-BEN-CODE
  8578                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8579                 END-IF
  8580                 IF CTBL-TABLE-FOUND
  8581                    IF PB-ISSUE
  8582                       COMPUTE WS-COMM-CK-AMT =
  8583                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8584                    ELSE
  8585                       COMPUTE WS-COMM-CK-AMT =
  8586                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8587                    END-IF
  8588                    PERFORM 8800-GET-COMP-RATE
  8589                              THRU 8800-EXIT
  8590                 END-IF
  8591              END-IF
  8592              IF AM-COM-TYP (SUB5) = 'I'
  8593                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8594                   + (WS-WK-RATE * 1000)
  8595              END-IF
  8596              IF AM-COM-TYP (SUB5) = 'N'
  8597                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8598                   + (WS-WK-RATE * 1000)
  8599              END-IF
  8600              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8601                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8602                   + (WS-WK-RATE * 1000)
  8603              END-IF
  8604              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8605                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8606                   + (WS-WK-RATE * 1000)
  8607              END-IF
  8608           END-IF
  8609        END-PERFORM
  8610     END-IF
  8611     GO TO 0300-CONTINUE-EDIT.
  8612
  8613 0298-UNLOCK-RETURN.
  8614      PERFORM 9250-UNLOCK-RETURN
  8615      GO TO 9990-RETURN.
  8616
  8617 0299-CERT-NOT-FOUND.
  8618
  8619     MOVE '1'                     TO CERT-STATUS-SW.
  8620
  8621     IF PB-COMPANY-ID = 'UCL'
  8622         IF WS-ERROR = ER-2799
  8623             GO TO 3000-CONTINUE-EDIT.
  8624
  8625     IF NOT PB-CANCELLATION
  8626         GO TO 0300-CONTINUE-EDIT.
  8627
  8628     MOVE ER-2726                  TO  WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 159
* EL050.cbl
  8629     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8630     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8631     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8632                                    PB-CI-LF-TERM
  8633                                    PB-C-LF-REM-TERM
  8634                                    PB-CI-AH-TERM
  8635                                    PB-C-AH-REM-TERM
  8636                                    PB-CI-LF-BENEFIT-CD
  8637                                    PB-CI-LF-BENEFIT-AMT
  8638                                    PB-CI-LF-ALT-BENEFIT-AMT
  8639                                    PB-CI-LF-PREMIUM-AMT
  8640                                    PB-CI-LF-ALT-PREMIUM-AMT
  8641                                    PB-CI-AH-BENEFIT-CD
  8642                                    PB-CI-AH-BENEFIT-AMT
  8643                                    PB-CI-AH-PREMIUM-AMT
  8644                                    PB-CI-PAY-FREQUENCY
  8645                                    PB-CI-LOAN-APR
  8646                                    PB-CI-LOAN-TERM
  8647                                    PB-CI-LIFE-COMMISSION
  8648                                    PB-CI-AH-COMMISSION
  8649                                    PB-CI-CURR-SEQ
  8650                                    PB-CI-AH-CANCEL-AMT
  8651                                    PB-CI-LF-CANCEL-AMT
  8652                                    PB-CI-RATE-DEV-PCT-LF
  8653                                    PB-CI-RATE-DEV-PCT-AH
  8654                                    PB-CI-EXTENTION-DAYS
  8655                                    PB-CI-TERM-IN-DAYS
  8656                                    PB-CI-LIVES
  8657                                    PB-CI-LF-CRIT-PER
  8658                                    PB-CI-AH-CRIT-PER
  8659                                    PB-CI-ADDL-CLP
  8660                                    PB-CI-DDF-IU-RATE-UP.
  8661
  8662     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8663                                    PB-CI-AH-SETTLEMENT-DT
  8664                                    PB-CI-DEATH-DT
  8665                                    PB-CI-LF-PRIOR-CANCEL-DT
  8666                                    PB-CI-AH-PRIOR-CANCEL-DT
  8667                                    PB-CI-ENTRY-DT
  8668                                    PB-CI-LF-EXPIRE-DT
  8669                                    PB-CI-AH-EXPIRE-DT
  8670                                    PB-CI-LOAN-1ST-PMT-DT.
  8671
  8672     IF ACCOUNT-MAST-FOUND
  8673        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8674        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8675
  8676
  8677 0300-CONTINUE-EDIT.
  8678
  8679     IF PB-ISSUE
  8680        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8681            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8682
  8683     IF PB-ISSUE
  8684        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8685            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8686
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 160
* EL050.cbl
  8687     IF PB-ISSUE
  8688       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8689          (AM-NO-AH-ONLY)
  8690           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8691               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8692                   MOVE ER-2679 TO WS-ERROR
  8693                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8694
  8695     IF PB-ISSUE
  8696        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8697        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8698        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8699     ELSE
  8700        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8701        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8702        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8703
  8704     MOVE 'N'                    TO PLAN-MASTER-SW
  8705                                    PLAN-MASTER-LIFE-SW
  8706                                    FORM-MASTER-SW
  8707                                    WS-APP-CERT-SW.
  8708
  8709     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8710                                    WS-PL-TOL-LF-REFUND
  8711                                    WS-PL-REF-OVS-AMT
  8712                                    WS-PL-TOL-LF-PREM-PCT
  8713                                    WS-PL-TOL-LF-REFUND-PCT
  8714                                    WS-PL-REF-OVS-PCT
  8715                                    WS-PL-TOL-LF-CLAIM.
  8716
  8717     IF PB-COMPANY-ID = 'NCL'
  8718       IF PB-ISSUE
  8719         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8720             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8721             IF FORM-MASTER-FOUND
  8722                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8723
  8724     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8725        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8726
  8727********************** MON CODE **********************
  8728     IF PB-COMPANY-ID = 'MON'
  8729     IF PB-ISSUE
  8730     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8731        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8732             PB-I-LOAN-APR = ZERO)
  8733               MOVE 14.0         TO PB-I-LOAN-APR.
  8734******************************************************
  8735
  8736     IF PB-COMPANY-ID = 'NCL'
  8737       IF PB-ISSUE
  8738           IF FORM-MASTER-FOUND
  8739             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8740                AM-DISMBR-COVERAGE
  8741                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8742                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8743                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8744                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 161
* EL050.cbl
  8745                                           PB-I-LIFE-BENEFIT-CD.
  8746
  8747     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8748
  8749     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8750         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8751         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8752         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8753         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8754         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8755           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8756             GO TO 0301-LIFE-BENEFIT-SEARCH
  8757         ELSE
  8758             NEXT SENTENCE
  8759     ELSE
  8760         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8761
  8762     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8763     MOVE '4'                    TO CNTL-REC-TYPE.
  8764     MOVE +0                     TO CNTL-SEQ-NO.
  8765     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8766
  8767     MOVE '1' TO RC-SW-2.
  8768     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8769
  8770     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8771        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8772         GO TO 0305-BENEFIT-NOT-FOUND.
  8773
  8774     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8775
  8776 0301-LIFE-BENEFIT-SEARCH.
  8777
  8778     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8779
  8780     IF NO-BENEFIT-FOUND
  8781        GO TO 0305-BENEFIT-NOT-FOUND.
  8782
  8783     IF WS-BEN-CD = '99'
  8784        GO TO 0305-BENEFIT-NOT-FOUND.
  8785
  8786     IF PB-COMPANY-ID = 'NCL'
  8787         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8788             GO TO 0304-LIFE-BENEFIT-FOUND.
  8789
  8790     MOVE +1                     TO SUB5.
  8791     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8792
  8793* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8794* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8795     IF PB-COMPANY-ID = 'DMD'
  8796         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8797
  8798 0302-EDIT-ACCT-LF-BENEFITS.
  8799
  8800     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8801        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8802           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 162
* EL050.cbl
  8803                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8804           GO TO 03XX-GET-LIFE-ERPLAN.
  8805
  8806     IF SUB5 LESS THAN +20
  8807        ADD +1                   TO SUB5
  8808        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8809
  8810     MOVE +1                     TO SUB5.
  8811
  8812     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8813        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8814
  8815 0303-EDIT-DMD-EXTRA-BENEFITS.
  8816
  8817     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8818        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8819           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8820                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8821           GO TO 03XX-GET-LIFE-ERPLAN.
  8822
  8823     IF SUB5 LESS THAN +30
  8824        ADD +1                   TO SUB5
  8825        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8826
  8827     MOVE +1                     TO SUB5.
  8828
  8829 03XX-EDIT-FOR-NINETY-LF.
  8830
  8831***************************************************************
  8832*                                                             *
  8833*    NINETY BENEFIT PLAN TYPES:                               *
  8834*                                                             *
  8835*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8836*      92 = ALL GROUP REDUCING BENEFITS                       *
  8837*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8838*      94 = ALL GROUP LEVEL BENEFITS                          *
  8839*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8840*           BENEFIT CONTROLS.                                 *
  8841*      99 = ALL BENEFITS                                      *
  8842*                                                             *
  8843***************************************************************
  8844
  8845     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8846                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8847
  8848     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8849       AND
  8850        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8851        GO TO 03XX-GET-LIFE-ERPLAN.
  8852
  8853     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8854       AND
  8855        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8856        IF CF-REDUCING (SUB3)
  8857           IF (PB-I-INDV-GRP-OVRD = 'I')
  8858              OR
  8859           ((AM-IG = '1') AND
  8860           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 163
* EL050.cbl
  8861              OR
  8862           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8863           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8864           (AM-IG NOT = '2'))
  8865              GO TO 03XX-GET-LIFE-ERPLAN.
  8866
  8867     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8868       AND
  8869        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8870        IF CF-REDUCING (SUB3)
  8871           IF (PB-I-INDV-GRP-OVRD = 'G')
  8872              OR
  8873           ((AM-IG = '2') AND
  8874           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8875              OR
  8876           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8877           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8878           (AM-IG NOT = '1'))
  8879              GO TO 03XX-GET-LIFE-ERPLAN.
  8880
  8881     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8882       AND
  8883        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8884        IF CF-LEVEL    (SUB3)
  8885           IF (PB-I-INDV-GRP-OVRD = 'I')
  8886              OR
  8887           ((AM-IG = '1') AND
  8888           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8889              OR
  8890           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8891           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8892            (AM-IG NOT = '2'))
  8893              GO TO 03XX-GET-LIFE-ERPLAN.
  8894
  8895     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8896       AND
  8897        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8898        IF CF-LEVEL    (SUB3)
  8899           IF (PB-I-INDV-GRP-OVRD = 'G')
  8900              OR
  8901           ((AM-IG = '2') AND
  8902           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8903              OR
  8904           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8905           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8906           (AM-IG NOT = '1'))
  8907              GO TO 03XX-GET-LIFE-ERPLAN.
  8908
  8909     IF SUB5 LESS THAN +20
  8910        ADD +1                   TO SUB5
  8911        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8912
  8913     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8914
  8915     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8916        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8917
  8918     MOVE +1                     TO SUB5.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 164
* EL050.cbl
  8919
  8920 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8921
  8922     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8923                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8924
  8925     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8926       AND
  8927        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8928        GO TO 03XX-GET-LIFE-ERPLAN.
  8929
  8930     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8931       AND
  8932        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8933        IF CF-REDUCING (SUB3)
  8934           IF (PB-I-INDV-GRP-OVRD = 'I')
  8935              OR
  8936           ((AM-IG = '1') AND
  8937           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8938              OR
  8939           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8940           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8941           (AM-IG NOT = '2'))
  8942              GO TO 03XX-GET-LIFE-ERPLAN.
  8943
  8944     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8945       AND
  8946        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8947        IF CF-REDUCING (SUB3)
  8948           IF (PB-I-INDV-GRP-OVRD = 'G')
  8949              OR
  8950           ((AM-IG = '2') AND
  8951           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8952              OR
  8953           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8954           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8955           (AM-IG NOT = '1'))
  8956              GO TO 03XX-GET-LIFE-ERPLAN.
  8957
  8958     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8959       AND
  8960        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8961        IF CF-LEVEL    (SUB3)
  8962           IF (PB-I-INDV-GRP-OVRD = 'I')
  8963              OR
  8964           ((AM-IG = '1') AND
  8965           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8966              OR
  8967           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8968           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8969            (AM-IG NOT = '2'))
  8970              GO TO 03XX-GET-LIFE-ERPLAN.
  8971
  8972     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8973       AND
  8974        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8975        IF CF-LEVEL    (SUB3)
  8976           IF (PB-I-INDV-GRP-OVRD = 'G')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 165
* EL050.cbl
  8977              OR
  8978           ((AM-IG = '2') AND
  8979           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8980              OR
  8981           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8982           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8983           (AM-IG NOT = '1'))
  8984              GO TO 03XX-GET-LIFE-ERPLAN.
  8985
  8986     IF SUB5 LESS THAN +30
  8987        ADD +1                   TO SUB5
  8988        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8989
  8990     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8991
  8992 03XX-EDIT-FOR-NINETY-LF-CONT.
  8993
  8994     MOVE +99                    TO SUB5.
  8995
  8996     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8997        IF PB-ISSUE
  8998           MOVE ER-1924          TO  WS-ERROR
  8999           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9000
  9001     GO TO 0304-LIFE-BENEFIT-FOUND.
  9002
  9003 03XX-GET-LIFE-ERPLAN.
  9004
  9005     IF WK-PLAN-ADDR EQUAL +0
  9006        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  9007
  9008     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9009     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9010     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9011     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  9012     MOVE 'Y'                    TO PLAN-MASTER-SW
  9013                                    PLAN-MASTER-LIFE-SW.
  9014     GO TO XXXX-CHECK-LF-PLAN-KEY.
  9015
  9016 03XX-ERPLAN-LIFE-GETMAIN.
  9017
  9018     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9019     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9020
  9021 03XX-ERPLAN-LIFE-READ.
  9022
  9023     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9024     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9025     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9026     MOVE PB-SV-STATE            TO PLAN-STATE.
  9027     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9028     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  9029     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9030     MOVE WS-SAVE-BENEFIT-REVISION
  9031                                 TO PLAN-REVISION-NO.
  9032
  9033     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9034     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 166
* EL050.cbl
  9035
  9036     IF PB-COMPANY-ID = 'NCL'
  9037       IF NOT LF-PLAN-MASTER-FOUND
  9038         IF NOT PB-POLICY-IS-DECLINED  AND
  9039            NOT PB-POLICY-IS-VOIDED
  9040             MOVE  ER-1921         TO  WS-ERROR
  9041             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9042             GO TO 0304-LIFE-BENEFIT-FOUND.
  9043
  9044     IF NOT LF-PLAN-MASTER-FOUND
  9045        GO TO 0304-LIFE-BENEFIT-FOUND.
  9046
  9047 XXXX-CHECK-LF-PLAN-KEY.
  9048
  9049     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9050        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9051        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9052        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9053        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9054        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9055        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9056        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9057        MOVE 'N'                 TO PLAN-MASTER-SW
  9058          GO TO 03XX-ERPLAN-LIFE-READ.
  9059
  9060     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  9061
  9062     IF  PB-CANCELLATION
  9063         GO TO  0303-LF-ACCT-BEN-FOUND.
  9064
  9065     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9066        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9067           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9068           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9069              MOVE ER-2644             TO WS-ERROR
  9070              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9071           ELSE
  9072              NEXT SENTENCE
  9073        ELSE
  9074           IF PB-COMPANY-ID NOT = 'NCL'
  9075              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9076                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9077
  9078 0303-LF-ACCT-BEN-FOUND.
  9079
  9080     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  9081
  9082     IF PL-DEV-CODE NOT = SPACES
  9083        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  9084
  9085     IF PL-DEV-PCT NUMERIC AND
  9086        PL-DEV-PCT NOT = ZEROS
  9087        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  9088
  9089     IF PL-TOL-PREM-AMT GREATER THAN +0
  9090        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  9091
  9092     IF PL-TOL-REF-AMT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 167
* EL050.cbl
  9093        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  9094
  9095     IF PL-TOL-PREM-PCT GREATER THAN +0
  9096        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  9097
  9098     IF PL-TOL-REF-PCT GREATER THAN +0
  9099        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  9100
  9101     IF PL-TOL-CLM-AMT GREATER THAN +0
  9102        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  9103
  9104     IF PL-OVER-SHORT-AMT NUMERIC  AND
  9105                          PL-OVER-SHORT-AMT > +0
  9106        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  9107
  9108     IF PL-OVER-SHORT-PCT NUMERIC  AND
  9109                          PL-OVER-SHORT-PCT > +0
  9110        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  9111
  9112     IF PL-SALES-TAX NUMERIC AND
  9113                          PL-SALES-TAX > +0
  9114         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  9115
  9116     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9117        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  9118                                    WS-IG-OVRD-AM.
  9119
  9120 0304-LIFE-BENEFIT-FOUND.
  9121
  9122     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  9123
  9124     IF PB-ISSUE
  9125        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  9126     ELSE
  9127        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  9128
  9129     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  9130     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  9131     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  9132     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  9133     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  9134                                         WS-LF-REFUND-CALC.
  9135     if (ws-lf-earnings-calc = '5')
  9136        and (pb-i-loan-apr = zeros)
  9137        and (benefit-code-chg)
  9138        move +99.9999 to pb-i-loan-apr
  9139     end-if
  9140
  9141     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9142        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  9143
  9144     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9145        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  9146     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  9147
  9148     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  9149     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  9150     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 168
* EL050.cbl
  9151     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  9152     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  9153     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  9154
  9155     IF PB-COMPANY-ID = 'NCL'  AND
  9156        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9157         NEXT SENTENCE
  9158     ELSE
  9159         IF SUB5 NOT GREATER THAN +20
  9160            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  9161               MOVE WS-SAVE-BENEFIT-REM-TERM
  9162                                      TO WS-AM-LF-BENE-REM-TERM
  9163                                         EC-BR-LF-REM-TERM-CALC.
  9164
  9165     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  9166     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  9167
  9168     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  9169
  9170 0305-BENEFIT-NOT-FOUND.
  9171
  9172     MOVE '1'                    TO LF-BENEFIT-ERROR.
  9173     MOVE ER-2604                TO WS-ERROR.
  9174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9175
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 169
* EL050.cbl
  9177
  9178 0310-FIND-AH-BENEFIT-RECORD.
  9179
  9180     MOVE 'N'                    TO PLAN-MASTER-SW
  9181                                    PLAN-MASTER-AH-SW.
  9182
  9183     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  9184                                    WS-PL-TOL-AH-REFUND
  9185                                    WS-AH-PL-REF-OVS-AMT
  9186                                    WS-PL-TOL-AH-PREM-PCT
  9187                                    WS-PL-TOL-AH-REFUND-PCT
  9188                                    WS-AH-PL-REF-OVS-PCT
  9189                                    WS-PL-TOL-AH-CLAIM.
  9190     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9191
  9192
  9193     if pb-issue
  9194        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9195           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9196        end-if
  9197        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9198           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9199           GO TO 0399-BENEFIT-NOT-FOUND
  9200        end-if
  9201     end-if
  9202
  9203     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9204        GO TO 0400-FIND-CARRIER.
  9205
  9206     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9207
  9208     IF WK-AH-BEN-ADDR NOT = ZEROS
  9209         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9210         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9211         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9212         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9213           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9214             GO TO 0311-AH-BENEFIT-SEARCH
  9215         ELSE
  9216             NEXT SENTENCE
  9217     ELSE
  9218         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9219
  9220     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9221     MOVE '5'                    TO CNTL-REC-TYPE.
  9222     MOVE +0                     TO CNTL-SEQ-NO.
  9223     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9224
  9225     MOVE '2' TO RC-SW-2.
  9226     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9227
  9228     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9229        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9230          GO TO 0399-BENEFIT-NOT-FOUND.
  9231
  9232     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9233
  9234 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 170
* EL050.cbl
  9235
  9236     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9237
  9238     IF NO-BENEFIT-FOUND
  9239         GO TO 0399-BENEFIT-NOT-FOUND.
  9240
  9241     IF WS-BEN-CD = '99'
  9242        GO TO 0399-BENEFIT-NOT-FOUND.
  9243
  9244     IF PB-COMPANY-ID  =  'NCL'
  9245         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9246             GO TO 0314-A-H-BENEFIT-FOUND.
  9247
  9248     MOVE +1                     TO SUB5.
  9249     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9250
  9251* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9252* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9253     IF PB-COMPANY-ID = 'DMD'
  9254         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9255
  9256 0312-EDIT-ACCT-AH-BENEFITS.
  9257
  9258     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9259        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9260           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9261                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9262           GO TO 03XX-GET-AH-ERPLAN.
  9263
  9264     IF SUB5 LESS THAN +20
  9265        ADD +1                   TO SUB5
  9266        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9267
  9268     MOVE +1                     TO SUB5.
  9269
  9270     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9271        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9272
  9273 0313-EDIT-DMD-EXTRA-BENEFITS.
  9274
  9275     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9276        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9277           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9278                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9279           GO TO 03XX-GET-AH-ERPLAN.
  9280
  9281     IF SUB5 LESS THAN +30
  9282        ADD +1                   TO SUB5
  9283        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9284
  9285     MOVE +1                     TO SUB5.
  9286
  9287 03XX-EDIT-FOR-NINETY-AH.
  9288
  9289***************************************************************
  9290*                                                             *
  9291*    NINETY BENEFIT PLAN TYPES:                               *
  9292*                                                             *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 171
* EL050.cbl
  9293*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9294*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9295*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9296*           BENEFIT CONTROLS.                                 *
  9297*      99 = ALL BENEFITS.                                     *
  9298*                                                             *
  9299***************************************************************
  9300
  9301     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9302                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9303
  9304     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9305       AND
  9306        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9307        GO TO 03XX-GET-AH-ERPLAN.
  9308
  9309     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9310       AND
  9311        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9312           IF (PB-I-INDV-GRP-OVRD = 'I')
  9313              OR
  9314           ((AM-IG = '1') AND
  9315           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9316              OR
  9317           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9318           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9319           (AM-IG NOT = '2'))
  9320              GO TO 03XX-GET-AH-ERPLAN.
  9321
  9322     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9323       AND
  9324        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9325           IF (PB-I-INDV-GRP-OVRD = 'G')
  9326              OR
  9327           ((AM-IG = '2') AND
  9328           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9329              OR
  9330           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9331           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9332           (AM-IG NOT = '1'))
  9333              GO TO 03XX-GET-AH-ERPLAN.
  9334
  9335     IF SUB5 LESS THAN +20
  9336        ADD +1                   TO SUB5
  9337        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9338
  9339     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9340        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9341
  9342     MOVE +1                    TO SUB5.
  9343
  9344 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9345
  9346     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9347                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9348
  9349     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9350       AND
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 172
* EL050.cbl
  9351        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9352        GO TO 03XX-GET-AH-ERPLAN.
  9353
  9354     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9355       AND
  9356        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9357           IF (PB-I-INDV-GRP-OVRD = 'I')
  9358              OR
  9359           ((AM-IG = '1') AND
  9360           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9361              OR
  9362           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9363           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9364           (AM-IG NOT = '2'))
  9365              GO TO 03XX-GET-AH-ERPLAN.
  9366
  9367     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9368       AND
  9369        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9370           IF (PB-I-INDV-GRP-OVRD = 'G')
  9371              OR
  9372           ((AM-IG = '2') AND
  9373           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9374              OR
  9375           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9376           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9377           (AM-IG NOT = '1'))
  9378              GO TO 03XX-GET-AH-ERPLAN.
  9379
  9380     IF SUB5 LESS THAN +30
  9381        ADD +1                   TO SUB5
  9382        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9383
  9384 03XX-EDIT-FOR-NINETY-AH-CONT.
  9385
  9386     MOVE +99                    TO SUB5.
  9387
  9388     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9389
  9390     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9391        IF PB-ISSUE
  9392           MOVE ER-1925          TO  WS-ERROR
  9393           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9394
  9395     GO TO 0314-A-H-BENEFIT-FOUND.
  9396
  9397 03XX-GET-AH-ERPLAN.
  9398
  9399     IF WK-PLAN-ADDR EQUAL +0
  9400         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9401
  9402     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9403     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9404     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9405     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9406     MOVE 'Y'                    TO PLAN-MASTER-SW
  9407                                    PLAN-MASTER-AH-SW.
  9408*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 173
* EL050.cbl
  9409     GO TO 03XX-ERPLAN-AH-READ.
  9410
  9411 03XX-ERPLAN-AH-GETMAIN.
  9412
  9413     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9414     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9415
  9416 03XX-ERPLAN-AH-READ.
  9417
  9418     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9419     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9420     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9421     MOVE PB-SV-STATE            TO PLAN-STATE.
  9422     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9423     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9424     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9425     MOVE WS-SAVE-BENEFIT-REVISION
  9426                                 TO PLAN-REVISION-NO.
  9427
  9428     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9429     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9430
  9431     IF PB-COMPANY-ID = 'NCL'
  9432       IF NOT AH-PLAN-MASTER-FOUND
  9433         IF NOT PB-POLICY-IS-DECLINED  AND
  9434            NOT PB-POLICY-IS-VOIDED
  9435             MOVE  ER-1922         TO  WS-ERROR
  9436             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9437             GO TO 0314-A-H-BENEFIT-FOUND.
  9438
  9439     IF NOT AH-PLAN-MASTER-FOUND
  9440        GO TO 0314-A-H-BENEFIT-FOUND.
  9441
  9442 XXXX-CHECK-AH-PLAN-KEY.
  9443
  9444     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9445        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9446        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9447        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9448        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9449        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9450        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9451        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9452        MOVE 'N'                 TO PLAN-MASTER-SW
  9453          GO TO 03XX-ERPLAN-AH-READ.
  9454
  9455     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9456
  9457     IF  PB-CANCELLATION
  9458         GO TO  0313-AH-ACCT-BEN-FOUND.
  9459
  9460     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9461       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9462          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9463          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9464             MOVE ER-2644             TO WS-ERROR
  9465             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9466          ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 174
* EL050.cbl
  9467             NEXT SENTENCE
  9468       ELSE
  9469          IF PB-COMPANY-ID NOT = 'NCL'
  9470             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9471                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9472
  9473 0313-AH-ACCT-BEN-FOUND.
  9474
  9475     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9476
  9477     IF PL-DEV-CODE NOT = SPACES
  9478        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9479
  9480     IF PL-DEV-PCT NUMERIC AND
  9481        PL-DEV-PCT NOT = ZEROS
  9482        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9483
  9484     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9485        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9486
  9487     IF PL-TOL-REF-AMT NOT EQUAL +0
  9488        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9489
  9490     IF PL-TOL-PREM-PCT GREATER THAN +0
  9491        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9492
  9493     IF PL-TOL-REF-PCT GREATER THAN +0
  9494        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9495
  9496     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9497        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9498
  9499     IF PL-OVER-SHORT-AMT NUMERIC AND
  9500                          PL-OVER-SHORT-AMT > +0
  9501        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9502
  9503     IF PL-OVER-SHORT-PCT NUMERIC AND
  9504                          PL-OVER-SHORT-PCT > +0
  9505        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9506
  9507     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9508        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9509        IF WS-IG-OVRD-AM EQUAL SPACES
  9510            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9511
  9512 0314-A-H-BENEFIT-FOUND.
  9513
  9514     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9515
  9516     IF PB-ISSUE
  9517        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9518       ELSE
  9519        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9520
  9521     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9522     if cf-maximum-benefits (sub3) numeric
  9523        move cf-maximum-benefits (sub3)
  9524                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 175
* EL050.cbl
  9525     else
  9526        move zeros               to ws-ah-max-bens
  9527     end-if
  9528     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9529     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9530     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9531                                         WS-AH-REFUND-CALC.
  9532
  9533     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9534        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9535
  9536     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9537        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9538     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9539
  9540     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9541     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9542     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9543     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9544     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9545     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9546
  9547     IF PB-COMPANY-ID = 'NCL'  AND
  9548        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9549         NEXT SENTENCE
  9550     ELSE
  9551         IF SUB5 NOT GREATER THAN +20
  9552            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9553                MOVE WS-SAVE-BENEFIT-REM-TERM
  9554                                      TO WS-AM-AH-BENE-REM-TERM
  9555                                         EC-BR-AH-REM-TERM-CALC.
  9556
  9557     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9558     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9559
  9560     GO TO 0400-FIND-CARRIER.
  9561
  9562 0399-BENEFIT-NOT-FOUND.
  9563
  9564     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9565     MOVE ER-2605                TO WS-ERROR.
  9566     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9567
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 176
* EL050.cbl
  9569
  9570 0400-FIND-CARRIER.
  9571
  9572     MOVE PB-SV-CARRIER          TO WS-CARR.
  9573
  9574     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9575     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9576     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9577     MOVE '6'                    TO CNTL-REC-TYPE.
  9578
  9579*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9580     MOVE SPACE                  TO WS-DMD-RATING-SW
  9581                                    EC-BR-DMD-RATING-SW.
  9582
  9583     MOVE '2'                    TO RC-SW-1.
  9584     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9585
  9586     IF NOT CF-CARRIER-MASTER
  9587        GO TO 0400-CARRIER-NOT-FOUND.
  9588
  9589 0400-BUILD-CARR-TOL.
  9590
  9591     IF CF-CR-TOL-PREM NUMERIC AND
  9592        CF-CR-TOL-PREM GREATER THAN +0
  9593        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9594                                    WS-TOL-AH-PREM.
  9595
  9596     IF CF-CR-TOL-REFUND NUMERIC AND
  9597        CF-CR-TOL-REFUND GREATER THAN +0
  9598        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9599                                    WS-TOL-AH-REFUND.
  9600
  9601     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9602        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9603        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9604                                    WS-AH-REFUND-OVS-AMT.
  9605
  9606     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9607        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9608        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9609                                    WS-AH-REFUND-OVS-PCT.
  9610
  9611     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9612        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9613        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9614                                    WS-TOL-AH-PREM-PCT.
  9615
  9616     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9617        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9618        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9619                                     WS-TOL-AH-REFUND-PCT.
  9620
  9621     IF CF-COMPANY-ID EQUAL 'DMD'
  9622         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9623                                    EC-BR-DMD-RATING-SW.
  9624
  9625     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9626     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 177
* EL050.cbl
  9627        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9628     END-IF
  9629     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9630        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9631     END-IF
  9632     IF WS-TOL-CLP-PCT = ZEROS
  9633        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9634     END-IF
  9635
  9636     IF WS-SPP-LEASE-COMM = ZEROS
  9637        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9638     END-IF
  9639     GO TO 0400-FIND-ERPDEF.
  9640
  9641 0400-CARRIER-NOT-FOUND.
  9642
  9643     MOVE ER-2602                TO WS-ERROR.
  9644     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9645
  9646 0400-FIND-ERPDEF.
  9647*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9648     IF (PB-COMPANY-ID = 'DCC')
  9649        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9650        CONTINUE
  9651     ELSE
  9652        GO TO 0400-FIND-ERCOMP
  9653     END-IF
  9654     MOVE ' '                    TO PDEF-MASTER-SW
  9655     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9656     MOVE PB-STATE               TO ERPDEF-STATE
  9657     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9658        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9659     END-IF
  9660     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9661     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9662     IF PB-ISSUE
  9663        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9664     ELSE
  9665        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9666     END-IF
  9667     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9668     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9669     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9670     IF PDEF-MASTER-FOUND
  9671        MOVE 'N'                 TO PDEF-MASTER-SW
  9672        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9673        IF PDEF-MASTER-FOUND
  9674           IF (ERPDEF-KEY-SAVE (1:16) =
  9675                        PD-CONTROL-PRIMARY (1:16))
  9676              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9677              CONTINUE
  9678           ELSE
  9679              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9680              IF (ERPDEF-KEY-SAVE (1:16) =
  9681                        PD-CONTROL-PRIMARY (1:16))
  9682                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9683                 CONTINUE
  9684              ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 178
* EL050.cbl
  9685                 MOVE 'N'        TO PDEF-MASTER-SW
  9686              END-IF
  9687           END-IF
  9688        END-IF
  9689        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9690     END-IF
  9691     IF PDEF-MASTER-FOUND
  9692        IF PD-TRUNCATED = 'Y'
  9693           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9694        END-IF
  9695     END-IF
  9696     .
  9697 0400-FIND-ERCOMP.
  9698     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9699        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9700           (WS-SUB1 > +10)
  9701           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9702                 OR 'A' OR 'N'
  9703              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9704              MOVE PB-CARRIER    TO COMP-CARRIER
  9705              MOVE PB-GROUPING   TO COMP-GROUPING
  9706              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9707              MOVE AM-AGT (WS-SUB1)
  9708                                 TO COMP-FIN-RESP
  9709              MOVE 'G'           TO COMP-TYPE
  9710              PERFORM 8582-READ-COMPENSATION-MASTER
  9711                                 THRU 8582-EXIT
  9712              IF COMP-MASTER-FOUND
  9713                 IF CO-GA-INACTIVE
  9714                    MOVE ER-2763 TO WS-ERROR
  9715                    PERFORM 9900-ERROR-FORMAT
  9716                                 THRU 9900-EXIT
  9717                    MOVE +11     TO WS-SUB1
  9718                 END-IF
  9719                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9720                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9721                    MOVE ER-2788 TO WS-ERROR
  9722                    PERFORM 9900-ERROR-FORMAT
  9723                                 THRU 9900-EXIT
  9724                    MOVE +11     TO WS-SUB1
  9725                 END-IF
  9726              END-IF
  9727           END-IF
  9728        END-PERFORM
  9729     END-IF
  9730     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9731        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9732           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9733                                    WS-CLP-STATE
  9734        ELSE
  9735           MOVE SPACES           TO PB-I-CLP-STATE
  9736                                    WS-CLP-STATE
  9737        END-IF
  9738     END-IF
  9739
  9740     IF (PB-COMPANY-ID = 'DCC')
  9741        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9742        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 179
* EL050.cbl
  9743        CONTINUE
  9744     ELSE
  9745        GO TO 0400-FIND-STATE-RECORD
  9746     END-IF
  9747     MOVE SPACES                 TO WS-CLP-STATE
  9748     MOVE +0                     TO WS-BANK-FEE
  9749                                    WS-BANK-LFEE
  9750                                    WS-BANK-NOCHRGB
  9751
  9752     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9753     IF (PB-ISSUE)
  9754        AND (PB-I-BANK-NUMBER NOT =
  9755            SPACES AND ZEROS AND LOW-VALUES)
  9756        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9757     ELSE
  9758        IF (PB-CANCELLATION)
  9759           AND (PB-CI-BANK-NUMBER NOT =
  9760                SPACES AND ZEROS AND LOW-VALUES)
  9761           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9762        END-IF
  9763     END-IF
  9764     IF COMP-FIN-RESP NOT = LOW-VALUES
  9765        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9766        MOVE PB-CARRIER          TO COMP-CARRIER
  9767        MOVE PB-GROUPING         TO COMP-GROUPING
  9768        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9769        MOVE 'B'                 TO COMP-TYPE
  9770        PERFORM 8582-READ-COMPENSATION-MASTER
  9771                                 THRU 8582-EXIT
  9772        IF COMP-MASTER-FOUND
  9773           IF CO-MAX-BANK-FEE NOT NUMERIC
  9774              MOVE +0            TO CO-MAX-BANK-FEE
  9775           END-IF
  9776           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9777              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9778           END-IF
  9779           IF CO-GA-INACTIVE
  9780              MOVE ER-2763       TO WS-ERROR
  9781              PERFORM 9900-ERROR-FORMAT
  9782                                 THRU 9900-EXIT
  9783           END-IF
  9784           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9785              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9786              MOVE ER-2788 TO WS-ERROR
  9787              PERFORM 9900-ERROR-FORMAT
  9788                                 THRU 9900-EXIT
  9789              MOVE +11     TO WS-SUB1
  9790           END-IF
  9791           IF WS-AH-BEN-CATEGORY = 'G'
  9792              MOVE CO-MAX-BANK-FEE
  9793                                 TO WS-BANK-FEE
  9794                                    PB-I-BANK-FEE
  9795           ELSE
  9796              MOVE CO-MAX-BANK-FEE-LEASE
  9797                                 TO WS-BANK-LFEE
  9798                                    PB-I-BANK-FEE
  9799           END-IF
  9800           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 180
* EL050.cbl
  9801              AND (WS-AH-REFUND-CALC = 'G'))
  9802                        OR
  9803              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9804              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9805              CONTINUE
  9806           ELSE
  9807              MOVE ER-2789 TO WS-ERROR
  9808              PERFORM 9900-ERROR-FORMAT
  9809                                 THRU 9900-EXIT
  9810           END-IF
  9811           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9812                                    PB-I-CLP-STATE
  9813           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9814           MOVE CO-CARRIER       TO BXRF-CARRIER
  9815           MOVE CO-GROUPING      TO BXRF-GROUPING
  9816           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9817           MOVE BXRF-MAX-REC-LENGTH
  9818                                 TO BXRF-REC-LENGTH
  9819           PERFORM 8584-READ-BANK-CROSS-REF
  9820                                 THRU 8584-EXIT
  9821           IF BXRF-MASTER-FOUND
  9822              MOVE ' '           TO BANK-ACCT-SW
  9823              MOVE BK-BANK-POINTER-CNT
  9824                                 TO BK-BANK-POINTER-CNT
  9825              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9826                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9827                 OR (BANK-ACCT-FOUND)
  9828                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9829                    AND (BK-AM-EXP-DT (WS-SUB1)
  9830                                 > PB-CERT-EFF-DT)
  9831                    AND (BK-AM-EFF-DT (WS-SUB1)
  9832                                 NOT > PB-CERT-EFF-DT)
  9833                    SET BANK-ACCT-FOUND TO TRUE
  9834                 END-IF
  9835              END-PERFORM
  9836              IF NOT BANK-ACCT-FOUND
  9837                 MOVE ZEROS      TO WS-BANK-FEE
  9838                                    WS-BANK-LFEE
  9839                 MOVE ER-2869    TO WS-ERROR
  9840                 PERFORM 9900-ERROR-FORMAT
  9841                                 THRU 9900-EXIT
  9842              ELSE
  9843                 PERFORM 5000-PROCESS-REPS
  9844                                 THRU 5000-EXIT
  9845                 IF AGENT-MASTER-FOUND
  9846                    MOVE +0      TO WS-BANK-FEE
  9847                                    WS-BANK-LFEE
  9848*                   MOVE AG-SPP-FEES (1)
  9849*                                TO PB-I-BANK-FEE
  9850*                                   WS-BANK-FEE
  9851                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9852                       (WS-SUB1 > +10)
  9853                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9854                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9855                       END-IF
  9856                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9857                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9858                       END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 181
* EL050.cbl
  9859                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9860                          AG-SPP-FEES (WS-SUB1)
  9861                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9862                          AG-SPP-LFEES (WS-SUB1)
  9863                    END-PERFORM
  9864                    IF WS-AH-BEN-CATEGORY = 'G'
  9865                       MOVE WS-BANK-FEE
  9866                                 TO PB-I-BANK-FEE
  9867                    ELSE
  9868                       MOVE WS-BANK-LFEE
  9869                                 TO PB-I-BANK-FEE
  9870                    END-IF
  9871                 END-IF
  9872              END-IF
  9873           END-IF
  9874        ELSE
  9875           MOVE ER-2879          TO WS-ERROR
  9876           PERFORM 9900-ERROR-FORMAT
  9877                                 THRU 9900-EXIT
  9878        END-IF
  9879     ELSE
  9880        MOVE ER-2879             TO WS-ERROR
  9881        PERFORM 9900-ERROR-FORMAT
  9882                                 THRU 9900-EXIT
  9883     END-IF
  9884     IF WS-AH-BEN-CATEGORY = 'G'
  9885        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9886        + WS-BANK-FEE
  9887     ELSE
  9888        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9889        + WS-BANK-LFEE
  9890     END-IF
  9891     .
  9892 0400-FIND-STATE-RECORD.
  9893
  9894     IF WK-STATE-ADDR NOT = ZEROS
  9895         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9896         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9897         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9898         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9899         IF PB-SV-STATE = CF-STATE-CODE
  9900             GO TO 0405-CONTINUE-EDIT
  9901         ELSE
  9902             NEXT SENTENCE
  9903     ELSE
  9904         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9905
  9906     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9907     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9908     MOVE '3'                    TO CNTL-REC-TYPE.
  9909     MOVE +0                     TO CNTL-SEQ-NO.
  9910
  9911     MOVE '3'                    TO RC-SW-2.
  9912     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9913
  9914     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9915        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9916        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 182
* EL050.cbl
  9917        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9918                                    WS-TOL-AH-CLAIM
  9919                                    WS-MINIMUM-REFUND
  9920                                    WS-TOL-LF-PREM
  9921                                    WS-TOL-AH-PREM
  9922                                    WS-TOL-LF-REFUND
  9923                                    WS-TOL-AH-REFUND
  9924                                    EC-ST-TOL-PREM-PCT
  9925                                    WS-TOL-LF-PREM-PCT
  9926                                    WS-TOL-AH-PREM-PCT
  9927                                    EC-ST-TOL-REFUND-PCT
  9928                                    WS-TOL-LF-REFUND-PCT
  9929                                    WS-TOL-AH-REFUND-PCT
  9930                                    EC-ST-TOL-PREM
  9931                                    EC-ST-TOL-REFUND
  9932                                    EC-ST-FST-PMT-DAYS-MAX
  9933                                    WS-FREE-LOOK-PERIOD
  9934                                    WS-ST-LF-PREM-TAX
  9935                                    WS-ST-AH-PREM-TAX-I
  9936                                    WS-ST-AH-PREM-TAX-G
  9937                                    WS-BANK-FEE
  9938                                    WS-BANK-LFEE
  9939                                    WS-TOL-CLP-PCT
  9940                                    WS-SPP-LEASE-COMM
  9941                                    WS-INT-PERIODS
  9942                                    WS-EXTRA-PMTS
  9943        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9944                                    EC-ST-FST-PMT-DAYS-CHG
  9945                                    WS-LF-REM-TERM-CALC
  9946                                    WS-LF-REFUND-CALC
  9947                                    EC-ST-LF-REM-TERM-CALC
  9948                                    EC-ST-LF-REFUND-CALC
  9949                                    WS-AH-REM-TERM-CALC
  9950                                    WS-AH-REFUND-CALC
  9951                                    WS-LF-BEN-CATEGORY
  9952                                    WS-AH-BEN-CATEGORY
  9953                                    WS-CLP-STATE
  9954                                    WS-ST-REFUND-CLAIM-FLAG
  9955                                    WS-ST-CAUSAL-STATE
  9956                                    ws-st-agent-sig-edit
  9957                                    EC-ST-AH-REM-TERM-CALC
  9958                                    EC-ST-AH-REFUND-CALC
  9959          GO TO 0499-STATE-NOT-FOUND.
  9960
  9961     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9962
  9963 0405-CONTINUE-EDIT.
  9964
  9965     IF (PB-COMPANY-ID <> 'AHL')
  9966        and (pb-issue)
  9967        MOVE +0                  TO SUB3
  9968        INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9969        IF SUB3 > +0
  9970           MOVE ER-3270          TO WS-ERROR
  9971           PERFORM 9900-ERROR-FORMAT
  9972                                 THRU 9900-EXIT
  9973        else
  9974           IF PB-CERT-PRIME NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 183
* EL050.cbl
  9975              MOVE ER-2722       TO WS-ERROR
  9976              PERFORM 9900-ERROR-FORMAT
  9977                                 THRU 9900-EXIT
  9978           end-if
  9979        END-IF
  9980     END-IF
  9981     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9982
  9983     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9984        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9985                                    WS-TOL-AH-CLAIM.
  9986
  9987     IF CF-ST-REFUND-MIN NOT NUMERIC
  9988        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9989
  9990     IF CF-ST-REFUND-MIN NOT = ZEROS
  9991        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9992
  9993     IF CF-ST-TOL-PREM  NOT = ZEROS
  9994        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9995                                    WS-TOL-AH-PREM
  9996        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9997
  9998     IF CF-ST-TOL-REFUND NOT = ZEROS
  9999        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
 10000                                    WS-TOL-AH-REFUND
 10001        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
 10002
 10003     IF CF-ST-OVR-SHT-AMT NUMERIC AND
 10004        CF-ST-OVR-SHT-AMT GREATER THAN +0
 10005        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
 10006                                    WS-AH-REFUND-OVS-AMT
 10007                                    EC-ST-OVR-SHT-AMT.
 10008
 10009     IF CF-ST-TOL-PREM-PCT NUMERIC AND
 10010        CF-ST-TOL-PREM-PCT GREATER THAN +0
 10011        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
 10012                                    WS-TOL-LF-PREM-PCT
 10013                                    WS-TOL-AH-PREM-PCT.
 10014
 10015     IF CF-ST-TOL-REF-PCT NUMERIC AND
 10016        CF-ST-TOL-REF-PCT GREATER THAN +0
 10017        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
 10018                                    WS-TOL-LF-REFUND-PCT
 10019                                    WS-TOL-AH-REFUND-PCT.
 10020
 10021     IF CF-ST-OVR-SHT-PCT NUMERIC AND
 10022        CF-ST-OVR-SHT-PCT GREATER THAN +0
 10023        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
 10024                                    WS-AH-REFUND-OVS-PCT
 10025                                    EC-ST-OVR-SHT-PCT.
 10026
 10027     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
 10028     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
 10029
 10030     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
 10031          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
 10032
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 184
* EL050.cbl
 10033     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
 10034     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
 10035     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
 10036
 10037     IF CF-ST-LF-PREM-TAX NUMERIC
 10038        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10039     END-IF
 10040     IF CF-ST-AH-PREM-TAX-I NUMERIC
 10041        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10042     END-IF
 10043     IF CF-ST-AH-PREM-TAX-G NUMERIC
 10044        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10045     END-IF
 10046
 10047     IF CF-ST-REF-AH-DEATH-IND > SPACES
 10048         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
 10049     END-IF.
 10050
 10051     IF CF-ST-CAUSAL-STATE > SPACES
 10052         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
 10053     END-IF.
 10054     if cf-st-extra-interest-periods not numeric
 10055        move zeros               to cf-st-extra-interest-periods
 10056     end-if
 10057     if cf-st-extra-payments not numeric
 10058        move zeros               to cf-st-extra-payments
 10059     end-if
 10060
 10061     move cf-st-extra-interest-periods
 10062                                 to ws-int-periods
 10063     move cf-st-extra-payments   to ws-extra-pmts
 10064     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
 10065     move cf-st-net-only-state   to ws-net-only-state
 10066     if cf-st-comm-cap-sl not numeric
 10067        move zeros               to cf-st-comm-cap-sl
 10068     end-if
 10069     if cf-st-comm-cap-jl not numeric
 10070        move zeros               to cf-st-comm-cap-jl
 10071     end-if
 10072     if cf-st-comm-cap-sa not numeric
 10073        move zeros               to cf-st-comm-cap-sa
 10074     end-if
 10075     if cf-st-comm-cap-ja not numeric
 10076        move zeros               to cf-st-comm-cap-ja
 10077     end-if
 10078     if cf-st-ga-comm-cap-sl not numeric
 10079        move zeros               to cf-st-ga-comm-cap-sl
 10080     end-if
 10081     if cf-st-ga-comm-cap-jl not numeric
 10082        move zeros               to cf-st-ga-comm-cap-jl
 10083     end-if
 10084     if cf-st-ga-comm-cap-sa not numeric
 10085        move zeros               to cf-st-ga-comm-cap-sa
 10086     end-if
 10087     if cf-st-ga-comm-cap-ja not numeric
 10088        move zeros               to cf-st-ga-comm-cap-ja
 10089     end-if
 10090
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 185
* EL050.cbl
 10091     if cf-st-tot-comm-cap-sl not numeric
 10092        move zeros               to cf-st-tot-comm-cap-sl
 10093     end-if
 10094     if cf-st-tot-comm-cap-jl not numeric
 10095        move zeros               to cf-st-tot-comm-cap-jl
 10096     end-if
 10097     if cf-st-tot-comm-cap-sa not numeric
 10098        move zeros               to cf-st-tot-comm-cap-sa
 10099     end-if
 10100     if cf-st-tot-comm-cap-ja not numeric
 10101        move zeros               to cf-st-tot-comm-cap-ja
 10102     end-if
 10103
 10104     move cf-comm-cap-limit-to   to ws-st-cap-limit-to
 10105     move cf-st-comm-cap-sl      to ws-st-comm-cap-sl
 10106     move cf-st-comm-cap-jl      to ws-st-comm-cap-jl
 10107     move cf-st-comm-cap-sa      to ws-st-comm-cap-sa
 10108     move cf-st-comm-cap-ja      to ws-st-comm-cap-ja
 10109     move cf-st-ga-comm-cap-sl   to ws-st-ga-comm-cap-sl
 10110     move cf-st-ga-comm-cap-jl   to ws-st-ga-comm-cap-jl
 10111     move cf-st-ga-comm-cap-sa   to ws-st-ga-comm-cap-sa
 10112     move cf-st-ga-comm-cap-ja   to ws-st-ga-comm-cap-ja
 10113     move cf-st-tot-comm-cap-sl  to ws-st-tot-comm-cap-sl
 10114     move cf-st-tot-comm-cap-jl  to ws-st-tot-comm-cap-jl
 10115     move cf-st-tot-comm-cap-sa  to ws-st-tot-comm-cap-sa
 10116     move cf-st-tot-comm-cap-ja  to ws-st-tot-comm-cap-ja
 10117     IF WS-LF-BENEFIT-CD = ZEROS
 10118        GO TO 0410-CHECK-AH.
 10119
 10120     IF CF-ST-RT-CALC NOT = SPACES
 10121        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10122                                    EC-ST-LF-REM-TERM-CALC
 10123     END-IF
 10124
 10125     IF WS-LF-COVERAGE-TYPE = 'R'
 10126        IF WS-LF-EARNINGS-CALC = '5'
 10127           IF CF-ST-RF-LN-CALC > '0'
 10128              MOVE CF-ST-RF-LN-CALC
 10129                                 TO WS-LF-REFUND-CALC
 10130                                    EC-ST-LF-REFUND-CALC
 10131           END-IF
 10132        ELSE
 10133           IF CF-ST-RF-LR-CALC > '0'
 10134              MOVE CF-ST-RF-LR-CALC
 10135                                 TO WS-LF-REFUND-CALC
 10136                                    EC-ST-LF-REFUND-CALC
 10137           END-IF
 10138        END-IF
 10139     ELSE
 10140        IF CF-ST-RF-LL-CALC > '0'
 10141           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
 10142                                    EC-ST-LF-REFUND-CALC
 10143        END-IF
 10144     END-IF
 10145
 10146     IF CF-ST-RT-CALC NOT = SPACES
 10147        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
 10148                                    EC-ST-LF-REM-TERM-CALC
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 186
* EL050.cbl
 10149     END-IF
 10150
 10151     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
 10152     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
 10153
 10154     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10155
 10156     IF NO-BENEFIT-FOUND
 10157        GO TO 0410-CHECK-AH.
 10158
 10159     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10160        MOVE CF-ST-REM-TERM-CALC  (SUB3)
 10161                                 TO EC-ST-LF-REM-TERM-CALC
 10162                                    WS-LF-REM-TERM-CALC
 10163     END-IF
 10164
 10165     IF CF-ST-REFUND-CALC (SUB3) > '0'
 10166        MOVE CF-ST-REFUND-CALC (SUB3)
 10167                                 TO WS-LF-REFUND-CALC
 10168                                    EC-ST-LF-REFUND-CALC
 10169     END-IF
 10170*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
 10171     if cf-st-extra-periods (sub3) not numeric
 10172        move zeros               to cf-st-extra-periods (sub3)
 10173     end-if
 10174     if cf-st-extra-periods (sub3) > zeros
 10175        if ws-lf-ben-category = 'P'
 10176           move cf-st-extra-periods (sub3)
 10177                                 to ws-extra-pmts
 10178        else
 10179           if ws-lf-ben-category = 'I'
 10180              move cf-st-extra-periods (sub3)
 10181                                 to ws-int-periods
 10182           end-if
 10183        end-if
 10184     end-if
 10185     .
 10186 0410-CHECK-AH.
 10187
 10188     IF WS-AH-BENEFIT-CD = ZEROS
 10189        GO TO 0500-SET-ACCOUNT.
 10190
 10191     IF CF-ST-RT-CALC NOT = SPACES
 10192        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
 10193                                    EC-ST-AH-REM-TERM-CALC
 10194     END-IF
 10195
 10196     IF WS-AH-SPECIAL-CALC-CD = 'C'
 10197        IF CF-ST-RF-CP-CALC > '0'
 10198           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
 10199                                    EC-ST-AH-REFUND-CALC
 10200        END-IF
 10201     ELSE
 10202        IF CF-ST-RF-AH-CALC > '0'
 10203           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
 10204                                    EC-ST-AH-REFUND-CALC
 10205        END-IF
 10206     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 187
* EL050.cbl
 10207     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
 10208     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
 10209
 10210     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
 10211
 10212     IF NO-BENEFIT-FOUND
 10213        GO TO 0500-SET-ACCOUNT.
 10214
 10215     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
 10216        MOVE CF-ST-REM-TERM-CALC (SUB3)
 10217                                 TO WS-AH-REM-TERM-CALC
 10218                                    EC-ST-AH-REM-TERM-CALC
 10219     END-IF
 10220
 10221     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
 10222        MOVE CF-ST-REFUND-CALC (SUB3)
 10223                                 TO WS-AH-REFUND-CALC
 10224                                    EC-ST-AH-REFUND-CALC
 10225     END-IF
 10226
 10227*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10228
 10229     GO TO 0500-SET-ACCOUNT.
 10230
 10231 0499-STATE-NOT-FOUND.
 10232
 10233     MOVE ER-2603                TO WS-ERROR.
 10234     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10235
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 188
* EL050.cbl
 10237
 10238 0500-SET-ACCOUNT.
 10239*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10240     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10241        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10242        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10243        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10244        MOVE '3'                 TO CNTL-REC-TYPE
 10245        MOVE +0                  TO CNTL-SEQ-NO
 10246
 10247        MOVE '3'                 TO RC-SW-2
 10248        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10249
 10250        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10251           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10252           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10253           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10254                                    WS-ST-AH-PREM-TAX-I
 10255                                    WS-ST-AH-PREM-TAX-G
 10256        ELSE
 10257           IF CF-ST-LF-PREM-TAX NUMERIC
 10258              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10259           END-IF
 10260           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10261              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10262           END-IF
 10263           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10264              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10265           END-IF
 10266        END-IF
 10267        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10268     END-IF
 10269*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10270*  FOR DCC ONLY
 10271     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10272
 10273        MOVE ' '                 TO STAT-MASTER-SW
 10274        MOVE PB-COMPANY-ID       TO ELSTAT-COMPANY-ID
 10275        MOVE PB-CARRIER          TO ELSTAT-CARRIER
 10276        MOVE PB-GROUPING         TO ELSTAT-GROUP
 10277        MOVE PB-STATE            TO ELSTAT-STATE
 10278        IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10279           MOVE WS-CLP-STATE     TO ELSTAT-STATE
 10280        END-IF
 10281
 10282        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 10283        SET BIN-TO-GREG          TO TRUE
 10284        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10285        MOVE DC-GREG-DATE-CYMD   TO ELSTAT-EXP-DT
 10286        MOVE ELSTAT-KEY          TO ELSTAT-KEY-SAVE
 10287
 10288        PERFORM 8750-START-ELSTAT THRU 8750-EXIT
 10289        IF STAT-MASTER-FOUND
 10290           MOVE 'N'              TO STAT-MASTER-SW
 10291           PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10292           IF STAT-MASTER-FOUND
 10293              IF (ELSTAT-KEY-SAVE (1:12) =
 10294                           SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 189
* EL050.cbl
 10295                 IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10296                    MOVE 'F'        TO STAT-MASTER-SW
 10297                 ELSE
 10298                    PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10299                    IF (STAT-MASTER-FOUND)
 10300                       AND (ELSTAT-KEY-SAVE (1:12) =
 10301                           SF-CONTROL-PRIMARY (1:12))
 10302                       AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10303                       MOVE 'F'     TO STAT-MASTER-SW
 10304                    END-IF
 10305                 END-IF
 10306              END-IF
 10307           END-IF
 10308        END-IF
 10309
 10310        IF STAT-MASTER-SW = 'F'
 10311           IF (SF-ST-LF-PREM-TAX NUMERIC)
 10312              and (sf-st-lf-prem-tax > zeros)
 10313              MOVE SF-ST-LF-PREM-TAX
 10314                                 TO WS-ST-LF-PREM-TAX
 10315           END-IF
 10316           IF (SF-ST-AH-PREM-TAX-I NUMERIC)
 10317              and (sf-st-ah-prem-tax-i > zeros)
 10318              MOVE SF-ST-AH-PREM-TAX-I
 10319                                 TO WS-ST-AH-PREM-TAX-I
 10320           END-IF
 10321           IF (SF-ST-AH-PREM-TAX-G NUMERIC)
 10322              and (sf-st-ah-prem-tax-g > zeros)
 10323              MOVE SF-ST-AH-PREM-TAX-G
 10324                                 TO WS-ST-AH-PREM-TAX-G
 10325           END-IF
 10326        END-IF
 10327     END-IF
 10328     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10329        AND (PB-ISSUE)
 10330        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10331        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10332        AND (AM-GPCD = 06)
 10333        MOVE 'Y'                 TO WS-GOOD-HIN
 10334        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10335           MOVE PB-I-VIN         TO WS-WORK-VIN
 10336           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10337              (V1 > 16)
 10338              IF WS-WORK-VIN (V1:1) NUMERIC
 10339                 MOVE WS-WORK-VIN-N (V1)
 10340                                 TO WS-ROW-B-VAL (V1)
 10341              ELSE
 10342                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10343                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10344                    OR (V2 > 26)
 10345                 END-PERFORM
 10346                 IF V2 < 27
 10347                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10348                 ELSE
 10349                    MOVE 'N'     TO WS-GOOD-HIN
 10350                 END-IF
 10351              END-IF
 10352              COMPUTE WS-ROW-D-VAL (V1) =
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 190
* EL050.cbl
 10353                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10354              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10355                 WS-ROW-D-VAL (V1)
 10356           END-PERFORM
 10357           MOVE ZEROS            TO WS-VIN-REMAINDER
 10358           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10359             REMAINDER WS-VIN-REMAINDER
 10360           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10361              CONTINUE
 10362           ELSE
 10363              MOVE 'N'           TO WS-GOOD-HIN
 10364           END-IF
 10365        ELSE
 10366           MOVE 'N'              TO WS-GOOD-HIN
 10367        END-IF
 10368        IF WS-GOOD-HIN NOT = 'Y'
 10369           MOVE ER-3826           TO WS-ERROR
 10370           PERFORM 9900-ERROR-FORMAT
 10371                                 THRU 9900-EXIT
 10372        END-IF
 10373     END-IF
 10374     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10375        AND (PB-ISSUE)
 10376        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10377        AND (AM-GPCD NOT = 06)
 10378        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10379           perform 3400-edit-vin thru 3400-exit
 10380        ELSE
 10381          MOVE ER-3826           TO WS-ERROR
 10382          PERFORM 9900-ERROR-FORMAT
 10383                                 THRU 9900-EXIT
 10384        END-IF
 10385     END-IF
 10386     if (pb-company-id = 'CID')
 10387        and (pb-issue)
 10388        and (pb-i-vin not = spaces and low-values and zeros)
 10389        perform 3400-edit-vin    thru 3400-exit
 10390     end-if
 10391******************************************************************
 10392******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10393******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10394******* METHODS.
 10395******************************************************************
 10396     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10397        IF PB-CANCELLATION
 10398           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10399              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10400                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10401                IF FORM-MASTER-FOUND
 10402                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10403******************************************************************
 10404
 10405     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10406     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10407
 10408     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10409     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10410     MOVE AM-STATUS              TO WS-ACCT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 191
* EL050.cbl
 10411     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10412
 10413
 10414     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10415     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10416     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10417
 10418     IF AM-LF-OB-RATE NOT NUMERIC
 10419         MOVE ZERO               TO AM-LF-OB-RATE.
 10420
 10421     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10422         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10423
 10424     IF AM-AH-OB-RATE NOT NUMERIC
 10425         MOVE ZERO               TO AM-AH-OB-RATE.
 10426
 10427     IF WS-LF-JOINT-INDICATOR = 'J'
 10428         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10429     ELSE
 10430         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10431
 10432     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10433
 10434     IF WS-IG-OVRD-AM  EQUAL SPACE
 10435         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10436
 10437     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10438         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10439                                       WS-IG-OVRD
 10440     ELSE
 10441         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10442             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10443                                       WS-IG-OVRD
 10444         ELSE
 10445             MOVE AM-IG             TO WS-IG-OVRD-AH
 10446                                       WS-IG-OVRD.
 10447
 10448     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10449         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10450                                       WS-IG-OVRD
 10451     ELSE
 10452         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10453             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10454                                       WS-IG-OVRD
 10455         ELSE
 10456             MOVE AM-IG             TO WS-IG-OVRD-LF
 10457                                       WS-IG-OVRD.
 10458
 10459     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10460     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10461     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10462     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10463*     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10464     INSPECT WS-ACCT-STATUS CONVERTING '9876543210'
 10465                                              TO 'PRLDSFCTIA'.
 10466
 10467     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10468     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 192
* EL050.cbl
 10469     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10470     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10471
 10472     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10473     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10474     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10475     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10476     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10477     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10478     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10479
 10480     IF WS-ACCT-AH-DEV-PCT > +0
 10481        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10482     ELSE
 10483        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10484
 10485     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10486        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10487     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10488        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10489
 10490        IF AM-EARN-METHOD-L = 'S'
 10491            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10492                                        WS-LF-REFUND-CALC.
 10493
 10494        IF AM-EARN-METHOD-R = 'S'
 10495            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10496                                        WS-LF-REFUND-CALC.
 10497
 10498     IF WS-LF-COVERAGE-TYPE = 'R'
 10499         IF AM-EARN-METHOD-R = 'R'
 10500            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10501                                    WS-LF-REFUND-CALC.
 10502     IF WS-LF-COVERAGE-TYPE = 'R'
 10503         IF AM-EARN-METHOD-R = 'P'
 10504            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10505                                    WS-LF-REFUND-CALC.
 10506     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10507         IF AM-EARN-METHOD-L = 'R'
 10508            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10509                                    WS-LF-REFUND-CALC.
 10510     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10511         IF AM-EARN-METHOD-L = 'P'
 10512            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10513                                    WS-LF-REFUND-CALC.
 10514     IF WS-LF-COVERAGE-TYPE = 'R'
 10515         IF AM-EARN-METHOD-R = 'A'
 10516            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10517                                    WS-LF-REFUND-CALC.
 10518     IF WS-LF-COVERAGE-TYPE = 'R'
 10519         IF AM-EARN-METHOD-R = 'M'
 10520            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10521                                    WS-LF-REFUND-CALC.
 10522     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10523         IF AM-EARN-METHOD-L = 'A'
 10524            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10525                                    WS-LF-REFUND-CALC.
 10526     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 193
* EL050.cbl
 10527         IF AM-EARN-METHOD-L = 'M'
 10528            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10529                                    WS-LF-REFUND-CALC.
 10530
 10531     IF AM-EARN-METHOD-A = 'R'
 10532        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10533                                    WS-AH-REFUND-CALC.
 10534     IF AM-EARN-METHOD-A = 'P'
 10535        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10536                                    WS-AH-REFUND-CALC.
 10537     IF AM-EARN-METHOD-A = 'C'
 10538        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10539                                    WS-AH-REFUND-CALC.
 10540     IF AM-EARN-METHOD-A = 'A'
 10541        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10542                                    WS-AH-REFUND-CALC.
 10543     IF AM-EARN-METHOD-A = 'M'
 10544        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10545                                    WS-AH-REFUND-CALC.
 10546     IF AM-EARN-METHOD-A = 'N'
 10547        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10548                                    WS-AH-REFUND-CALC.
 10549     IF AM-EARN-METHOD-A = 'S'
 10550        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10551                                    WS-AH-REFUND-CALC.
 10552
 10553     IF AM-TOL-PREM NOT = ZEROS
 10554        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10555                                    WS-TOL-AH-PREM.
 10556
 10557     IF AM-OVR-SHT-AMT NUMERIC AND
 10558                  AM-OVR-SHT-AMT > 0
 10559        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10560                                    EC-AM-LF-OVR-SHT-AMT
 10561                                    WS-AH-REFUND-OVS-AMT
 10562                                    EC-AM-AH-OVR-SHT-AMT.
 10563
 10564     IF AM-OVR-SHT-PCT NUMERIC AND
 10565                    AM-OVR-SHT-PCT > 0
 10566        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10567                                    EC-AM-LF-OVR-SHT-PCT
 10568                                    WS-AH-REFUND-OVS-PCT
 10569                                    EC-AM-AH-OVR-SHT-PCT.
 10570
 10571     IF AM-TOL-REF-PCT NUMERIC AND
 10572                  AM-TOL-REF-PCT > 0
 10573        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10574                                    WS-TOL-AH-REFUND-PCT.
 10575
 10576     IF AM-TOL-REF  NOT = ZEROS  AND
 10577                  AM-TOL-REF NUMERIC
 10578        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10579                                    EC-AM-LF-TOL-REFUND
 10580                                    WS-TOL-AH-REFUND
 10581                                    EC-AM-AH-TOL-REFUND.
 10582
 10583     IF AM-TOL-CLM  NOT = ZEROS
 10584        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 194
* EL050.cbl
 10585                                    WS-TOL-AH-CLAIM.
 10586
 10587     IF AM-CLP-TOL-PCT NOT NUMERIC
 10588        MOVE +0                  TO AM-CLP-TOL-PCT
 10589     END-IF
 10590
 10591     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10592        MOVE +0                  TO AM-SPP-LEASE-COMM
 10593     END-IF
 10594     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10595        MOVE WS-PL-TOL-LF-PREM-PCT
 10596                                 TO WS-TOL-LF-PREM-PCT.
 10597
 10598     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10599        MOVE WS-PL-TOL-AH-PREM-PCT
 10600                                 TO WS-TOL-AH-PREM-PCT.
 10601
 10602     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10603        MOVE WS-PL-TOL-LF-REFUND-PCT
 10604                                 TO WS-TOL-LF-REFUND-PCT.
 10605
 10606     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10607        MOVE WS-PL-TOL-AH-REFUND-PCT
 10608                                 TO WS-TOL-AH-REFUND-PCT.
 10609
 10610     IF WS-PL-REF-OVS-AMT > +0
 10611        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10612
 10613     IF WS-PL-REF-OVS-PCT > +0
 10614        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10615
 10616     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10617        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10618     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10619        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10620     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10621        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10622     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10623        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10624     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10625        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10626     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10627        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10628
 10629     IF WS-AH-PL-REF-OVS-AMT > +0
 10630        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10631
 10632     IF WS-AH-PL-REF-OVS-PCT > +0
 10633        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10634
 10635     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10636     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10637
 10638     IF PB-CANCELLATION
 10639        GO TO 3000-CONTINUE-EDIT.
 10640
 10641     MOVE +1 TO SUB1.
 10642     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 195
* EL050.cbl
 10643     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10644
 10645     IF CF-COMPANY-ID = 'DMD'
 10646       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10647         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10648        ELSE
 10649         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10650
 10651  0525-FIND-ACCT-COMM.
 10652     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10653        NEXT SENTENCE
 10654      ELSE
 10655         ADD +1 TO SUB1
 10656         IF SUB1 LESS +11
 10657            GO TO 0525-FIND-ACCT-COMM
 10658          ELSE
 10659             GO TO 0550-st-comm-cap-check.
 10660
 10661     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10662     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10663                                    PB-I-LIFE-COMMISSION.
 10664***  IF PB-COMPANY-ID = 'CRI'
 10665     IF PB-PREM-ACCTNG-ONLY
 10666         GO TO 0550-st-comm-cap-check.
 10667
 10668     MOVE '0530' TO CTBL-SW.
 10669     MOVE ' '    TO WS-CTBL-READ-SW.
 10670
 10671
 10672 0530-GET-AH-COMP.
 10673     IF NO-AH-COVERAGE  OR
 10674        NO-AH-BENEFIT-MATCH
 10675           GO TO 0540-NEXT-READ-STEP.
 10676
 10677     IF AM-A-COM (SUB1) NUMERIC
 10678        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10679         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10680         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10681         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10682         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10683     ELSE
 10684          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10685          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10686          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10687          MOVE ZEROS             TO WS-SUB1
 10688                                    WS-COMMISSION
 10689          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10690          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10691          IF WS-COMMISSION > ZEROS
 10692             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10693             GO TO 0540-NEXT-READ-STEP
 10694          END-IF
 10695          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10696          IF CTBL-TABLE-FOUND
 10697             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10698                                        PB-I-AH-TERM
 10699             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10700             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 196
* EL050.cbl
 10701             GO TO 0540-NEXT-READ-STEP
 10702          ELSE
 10703             IF FIRST-TIME-THROUGH
 10704                 GO TO 0530-GET-AH-COMP
 10705             ELSE
 10706                 MOVE ER-2609                TO WS-ERROR
 10707                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10708
 10709 0540-NEXT-READ-STEP.
 10710     MOVE '0540' TO CTBL-SW.
 10711     MOVE ' '    TO WS-CTBL-READ-SW.
 10712
 10713 0540-GET-LF-COMP.
 10714     IF NO-LIFE-COVERAGE  OR
 10715        NO-LF-BENEFIT-MATCH
 10716           GO TO 0550-st-comm-cap-check.
 10717
 10718     IF WS-LF-JOINT-INDICATOR = 'J'
 10719        IF AM-J-COM (SUB1) NUMERIC
 10720           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10721           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10722           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10723           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10724           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10725        ELSE
 10726           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10727           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10728           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10729           MOVE ZEROS                TO WS-SUB1
 10730                                        WS-COMMISSION
 10731           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10732           IF WS-COMMISSION > ZEROS
 10733              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10734              GO TO 0550-st-comm-cap-check
 10735           END-IF
 10736           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10737           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10738           IF CTBL-TABLE-FOUND
 10739              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10740              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10741              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10742              GO TO 0550-st-comm-cap-check
 10743           ELSE
 10744              IF FIRST-TIME-THROUGH
 10745                  GO TO 0540-GET-LF-COMP
 10746              ELSE
 10747                  MOVE ER-2609                TO WS-ERROR
 10748                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10749                  GO TO 0550-st-comm-cap-check.
 10750
 10751     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10752        IF AM-L-COM (SUB1) NUMERIC
 10753           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10754           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10755           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10756           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10757           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10758        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 197
* EL050.cbl
 10759           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10760           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10761           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10762           MOVE ZEROS                TO WS-SUB1
 10763                                        WS-COMMISSION
 10764           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10765           IF WS-COMMISSION IS GREATER THAN ZEROS
 10766              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10767              GO TO 0550-st-comm-cap-check
 10768           END-IF
 10769           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10770           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10771           IF CTBL-TABLE-FOUND
 10772              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10773              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10774              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10775              GO TO 0550-st-comm-cap-check
 10776           ELSE
 10777              IF FIRST-TIME-THROUGH
 10778                  GO TO 0540-GET-LF-COMP
 10779              ELSE
 10780                  MOVE ER-2609                TO WS-ERROR
 10781                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10782
 10783 0550-st-comm-cap-check.
 10784
 10785     move +0                     to ws-tot-sl-wk-rate
 10786                                    ws-sl-wk-rate
 10787                                    ws-ga-sl-wk-rate
 10788                                    ws-tot-jl-wk-rate
 10789                                    ws-jl-wk-rate
 10790                                    ws-ga-jl-wk-rate
 10791                                    ws-tot-sa-wk-rate
 10792                                    ws-sa-wk-rate
 10793                                    ws-ga-sa-wk-rate
 10794                                    ws-tot-ja-wk-rate
 10795                                    ws-ja-wk-rate
 10796                                    ws-ga-ja-wk-rate
 10797     perform varying sub5 from +1 by +1 until
 10798        (sub5 > +10)
 10799        move +0                  to ws-wk-rate
 10800        if (am-gl-codes (sub5) <> 'Y')
 10801           and (am-com-typ(sub5) = 'C' or 'D' or 'O' or 'P')
 10802           if pb-i-lf-benefit-cd <> '  ' and '00'
 10803              move zeros         to ws-wk-rate
 10804              if (am-l-com (sub5) numeric)
 10805                 and (am-l-coma (sub5) (3:1) not = 'L' and 'M')
 10806                 move am-l-com(sub5)
 10807                                 to ws-wk-rate
 10808              else
 10809                 move pb-company-cd to ctbl-company-cd
 10810                 move pb-i-lf-benefit-cd
 10811                                 to ctbl-ben-code
 10812                 move pb-i-lf-term  to ws-work-term
 10813                 move pb-life-override-l1
 10814                                 to ctbl-ben-type
 10815                 move zeros      to ws-sub1
 10816                                    ws-commission
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 198
* EL050.cbl
 10817                 move am-l-coma (sub5)
 10818                                 to ctbl-table
 10819                 move '0540'     to ctbl-sw
 10820                 perform 0552-get-it
 10821                                 thru 0552-exit
 10822              end-if
 10823              compute ws-tot-sl-wk-rate =
 10824                 ws-tot-sl-wk-rate + ws-wk-rate
 10825              if am-com-typ(sub5) = 'C' or 'D'
 10826                 compute ws-sl-wk-rate =
 10827                    ws-sl-wk-rate + ws-wk-rate
 10828              else
 10829                 if am-com-typ(sub5) = 'O' or 'P'
 10830                    compute ws-ga-sl-wk-rate =
 10831                       ws-ga-sl-wk-rate + ws-wk-rate
 10832                 end-if
 10833              end-if
 10834
 10835              move zeros         to ws-wk-rate
 10836              if (am-j-com (sub5) numeric)
 10837                 and (am-j-coma (sub5) (3:1) not = 'L' and 'M')
 10838                 move am-j-com(sub5)
 10839                                 to ws-wk-rate
 10840              else
 10841                 move pb-company-cd to ctbl-company-cd
 10842                 move pb-i-lf-benefit-cd
 10843                                 to ctbl-ben-code
 10844                 move pb-i-lf-term  to ws-work-term
 10845                 move pb-life-override-l1
 10846                                 to ctbl-ben-type
 10847                 move zeros      to ws-sub1
 10848                                    ws-commission
 10849                 move am-j-coma (sub5)
 10850                                 to ctbl-table
 10851                 move '0540'     to ctbl-sw
 10852                 perform 0552-get-it
 10853                                 thru 0552-exit
 10854              end-if
 10855              compute ws-tot-jl-wk-rate =
 10856                 ws-tot-jl-wk-rate + ws-wk-rate
 10857              if am-com-typ(sub5) = 'C' or 'D'
 10858                 compute ws-jl-wk-rate =
 10859                    ws-jl-wk-rate + ws-wk-rate
 10860              else
 10861                 if am-com-typ(sub5) = 'O' or 'P'
 10862                    compute ws-ga-jl-wk-rate =
 10863                       ws-ga-jl-wk-rate + ws-wk-rate
 10864                 end-if
 10865              end-if
 10866           end-if
 10867           move zeros            to ws-wk-rate
 10868
 10869           if pb-i-ah-benefit-cd <> '  ' and '00'
 10870              if (am-a-com (sub5) numeric)
 10871                 and (am-a-coma (sub5) (3:1) not = 'L' and 'M')
 10872                 move am-a-com(sub5)
 10873                                 to ws-wk-rate
 10874              else
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 199
* EL050.cbl
 10875                 move pb-company-cd to ctbl-company-cd
 10876                 move pb-i-ah-benefit-cd
 10877                                 to ctbl-ben-code
 10878                 move pb-i-ah-term  to ws-work-term
 10879                 move pb-ah-override-l1
 10880                                 to ctbl-ben-type
 10881                 move zeros      to ws-sub1
 10882                                    ws-commission
 10883                 move am-a-coma (sub5)
 10884                                 to ctbl-table
 10885                 move '0530'     to ctbl-sw
 10886                 perform 0552-get-it
 10887                                 thru 0552-exit
 10888              end-if
 10889              compute ws-tot-sa-wk-rate =
 10890                 ws-tot-sa-wk-rate + ws-wk-rate
 10891              if am-com-typ(sub5) = 'C' or 'D'
 10892                 compute ws-sa-wk-rate =
 10893                    ws-sa-wk-rate + ws-wk-rate
 10894              else
 10895                 if am-com-typ(sub5) = 'O' or 'P'
 10896                    compute ws-ga-sa-wk-rate =
 10897                       ws-ga-sa-wk-rate + ws-wk-rate
 10898                 end-if
 10899              end-if
 10900           end-if
 10901        end-if
 10902     end-perform
 10903
 10904     go to 0550-continue
 10905
 10906     .
 10907 0552-get-it.
 10908
 10909     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD
 10910     MOVE ZEROS                  TO WS-SUB1
 10911                                    WS-COMMISSION
 10912     MOVE ' '                    TO WS-CTBL-READ-SW
 10913     PERFORM 8300-READ-CTBL-TABLE
 10914                                 THRU 8300-EXIT
 10915     IF FIRST-TIME-THROUGH
 10916        MOVE 'AA'                TO CTBL-BEN-CODE
 10917        PERFORM 8300-READ-CTBL-TABLE
 10918                                 THRU 8300-EXIT
 10919     END-IF
 10920     IF CTBL-TABLE-FOUND
 10921        if pb-life-override-l1 = ctbl-ben-type
 10922           move pb-i-lf-benefit-amt
 10923                                 to WS-COMM-CK-AMT
 10924        else
 10925           compute ws-comm-ck-amt =
 10926              pb-I-ah-benefit-amt * pb-i-ah-term
 10927        end-if
 10928        PERFORM 8800-GET-COMP-RATE
 10929                                 THRU 8800-EXIT
 10930     else
 10931        move zeros               to ws-wk-rate
 10932     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 200
* EL050.cbl
 10933
 10934     .
 10935 0552-exit.
 10936     exit.
 10937
 10938 0550-continue.
 10939
 10940     if ws-lf-joint-indicator = 'J'
 10941        if (ws-jl-wk-rate > ws-st-comm-cap-jl)
 10942           and (ws-st-comm-cap-jl <> zeros)
 10943           MOVE ER-1956          TO WS-ERROR
 10944           PERFORM 9900-ERROR-FORMAT
 10945                                 THRU 9900-EXIT
 10946        end-if
 10947        if (ws-ga-jl-wk-rate > ws-st-ga-comm-cap-jl)
 10948           and (ws-st-ga-comm-cap-jl <> zeros)
 10949           MOVE ER-1959          TO WS-ERROR
 10950           PERFORM 9900-ERROR-FORMAT
 10951                                 THRU 9900-EXIT
 10952        end-if
 10953        if (ws-tot-jl-wk-rate > ws-st-tot-comm-cap-jl)
 10954           and (ws-st-tot-comm-cap-jl <> zeros)
 10955           MOVE ER-1962          TO WS-ERROR
 10956           PERFORM 9900-ERROR-FORMAT
 10957                                 THRU 9900-EXIT
 10958        end-if
 10959     else
 10960        if (ws-sl-wk-rate > ws-st-comm-cap-sl)
 10961           and (ws-st-comm-cap-sl <> zeros)
 10962           MOVE ER-1955          TO WS-ERROR
 10963           PERFORM 9900-ERROR-FORMAT
 10964                                 THRU 9900-EXIT
 10965        end-if
 10966        if (ws-ga-sl-wk-rate > ws-st-ga-comm-cap-sl)
 10967           and (ws-st-ga-comm-cap-sl <> zeros)
 10968           MOVE ER-1958          TO WS-ERROR
 10969           PERFORM 9900-ERROR-FORMAT
 10970                                 THRU 9900-EXIT
 10971        end-if
 10972        if (ws-tot-sl-wk-rate > ws-st-tot-comm-cap-sl)
 10973           and (ws-st-tot-comm-cap-sl <> zeros)
 10974           MOVE ER-1961          TO WS-ERROR
 10975           PERFORM 9900-ERROR-FORMAT
 10976                                 THRU 9900-EXIT
 10977        end-if
 10978
 10979     if ws-ah-joint-indicator = 'J'
 10980        if (ws-sa-wk-rate > ws-st-comm-cap-ja)
 10981           and (ws-st-comm-cap-ja <> zeros)
 10982           MOVE ER-1957          TO WS-ERROR
 10983           PERFORM 9900-ERROR-FORMAT
 10984                                 THRU 9900-EXIT
 10985        end-if
 10986        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-ja)
 10987           and (ws-st-ga-comm-cap-ja <> zeros)
 10988           MOVE ER-1960          TO WS-ERROR
 10989           PERFORM 9900-ERROR-FORMAT
 10990                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 201
* EL050.cbl
 10991        end-if
 10992        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-ja)
 10993           and (ws-st-tot-comm-cap-ja <> zeros)
 10994           MOVE ER-1963          TO WS-ERROR
 10995           PERFORM 9900-ERROR-FORMAT
 10996                                 THRU 9900-EXIT
 10997        end-if
 10998     else
 10999        if (ws-sa-wk-rate > ws-st-comm-cap-sa)
 11000           and (ws-st-comm-cap-sa <> zeros)
 11001           MOVE ER-1957          TO WS-ERROR
 11002           PERFORM 9900-ERROR-FORMAT
 11003                                 THRU 9900-EXIT
 11004        end-if
 11005        if (ws-ga-sa-wk-rate > ws-st-ga-comm-cap-sa)
 11006           and (ws-st-ga-comm-cap-sa <> zeros)
 11007           MOVE ER-1960          TO WS-ERROR
 11008           PERFORM 9900-ERROR-FORMAT
 11009                                 THRU 9900-EXIT
 11010        end-if
 11011        if (ws-tot-sa-wk-rate > ws-st-tot-comm-cap-sa)
 11012           and (ws-st-tot-comm-cap-sa <> zeros)
 11013           MOVE ER-1963          TO WS-ERROR
 11014           PERFORM 9900-ERROR-FORMAT
 11015                                 THRU 9900-EXIT
 11016        end-if
 11017     end-if
 11018     .
 11019 0560-EDIT-CONTINUE.
 11020     MOVE ZEROS                  TO WS-LF-PMF-COMM
 11021                                    WS-AH-PMF-COMM
 11022*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 11023*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 11024     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 11025        (SUB1 > +10)
 11026        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 11027           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 11028           MOVE '0530'           TO CTBL-SW
 11029           MOVE ' '              TO WS-CTBL-READ-SW
 11030           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 11031           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 11032           MOVE '0540'           TO CTBL-SW
 11033           MOVE ' '              TO WS-CTBL-READ-SW
 11034           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 11035        END-IF
 11036     END-PERFORM
 11037     GO TO 0564-EDIT-CONTINUE
 11038     .
 11039 0561-CHECK-AH.
 11040     IF (NO-AH-COVERAGE)
 11041        OR (NO-AH-BENEFIT-MATCH)
 11042        CONTINUE
 11043     ELSE
 11044        IF (AM-A-COM (SUB1) NUMERIC)
 11045           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11046           IF (AM-COM-TYP (SUB1) = 'A')
 11047              AND (WS-AH-PMF-COMM = ZEROS)
 11048              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 202
* EL050.cbl
 11049           END-IF
 11050           CONTINUE
 11051        ELSE
 11052           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 11053           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 11054           MOVE PB-AH-OVERRIDE-L1
 11055                                 TO CTBL-BEN-TYPE
 11056           MOVE ZEROS            TO WS-SUB1
 11057                                    WS-COMMISSION
 11058           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 11059           PERFORM 8300-READ-CTBL-TABLE
 11060                                 THRU 8300-EXIT
 11061           IF CTBL-TABLE-FOUND
 11062              IF (AM-COM-TYP (SUB1) = 'A')
 11063                 AND (WS-AH-PMF-COMM = ZEROS)
 11064                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 11065                                        PB-I-AH-TERM
 11066                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11067                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 11068              END-IF
 11069              CONTINUE
 11070           ELSE
 11071              IF FIRST-TIME-THROUGH
 11072                 GO TO 0561-CHECK-AH
 11073              ELSE
 11074                 MOVE ER-2609    TO WS-ERROR
 11075                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11076              END-IF
 11077           END-IF
 11078        END-IF
 11079     END-IF
 11080     .
 11081 0561-EXIT.
 11082     EXIT.
 11083 0563-CHECK-LF.
 11084     IF (NO-LIFE-COVERAGE)
 11085        OR (NO-LF-BENEFIT-MATCH)
 11086        CONTINUE
 11087     ELSE
 11088        IF WS-LF-JOINT-INDICATOR = 'J'
 11089           IF AM-J-COM (SUB1) NUMERIC
 11090              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11091              IF (AM-COM-TYP (SUB1) = 'A')
 11092                 AND (WS-LF-PMF-COMM = ZEROS)
 11093                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 11094              END-IF
 11095              CONTINUE
 11096           ELSE
 11097              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11098              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11099              MOVE PB-LIFE-OVERRIDE-L1
 11100                                 TO CTBL-BEN-TYPE
 11101              MOVE ZEROS         TO WS-SUB1
 11102                                    WS-COMMISSION
 11103              MOVE AM-J-COMA (SUB1)
 11104                                 TO CTBL-TABLE
 11105              PERFORM 8300-READ-CTBL-TABLE
 11106                                 THRU 8300-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 203
* EL050.cbl
 11107              IF CTBL-TABLE-FOUND
 11108                 IF (AM-COM-TYP (SUB1) = 'A')
 11109                    AND (WS-LF-PMF-COMM = ZEROS)
 11110                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 11111                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 11112                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 11113                 END-IF
 11114                 CONTINUE
 11115              ELSE
 11116                 IF FIRST-TIME-THROUGH
 11117                    GO TO 0563-CHECK-LF
 11118                 ELSE
 11119                    MOVE ER-2609 TO WS-ERROR
 11120                    PERFORM 9900-ERROR-FORMAT
 11121                                 THRU 9900-EXIT
 11122*                   GO TO 0560-EDIT-CONTINUE
 11123                 END-IF
 11124              END-IF
 11125           END-IF
 11126        ELSE
 11127           IF AM-L-COM (SUB1) NUMERIC
 11128              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 11129              IF (AM-COM-TYP (SUB1) = 'A')
 11130                 AND (WS-LF-PMF-COMM = ZEROS)
 11131                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 11132              END-IF
 11133              CONTINUE
 11134           ELSE
 11135              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 11136              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 11137              MOVE PB-LIFE-OVERRIDE-L1
 11138                                 TO CTBL-BEN-TYPE
 11139              MOVE ZEROS         TO WS-SUB1
 11140                                    WS-COMMISSION
 11141              MOVE AM-L-COMA (SUB1)
 11142                                 TO CTBL-TABLE
 11143              PERFORM 8300-READ-CTBL-TABLE
 11144                                 THRU 8300-EXIT
 11145              IF CTBL-TABLE-FOUND
 11146                 CONTINUE
 11147              ELSE
 11148                 IF FIRST-TIME-THROUGH
 11149                    GO TO 0563-CHECK-LF
 11150                 ELSE
 11151                    MOVE ER-2609 TO WS-ERROR
 11152                    PERFORM 9900-ERROR-FORMAT
 11153                                 THRU 9900-EXIT
 11154                 END-IF
 11155              END-IF
 11156           END-IF
 11157        END-IF
 11158     END-IF
 11159     .
 11160 0563-EXIT.
 11161     EXIT.
 11162 0564-EDIT-CONTINUE.
 11163
 11164     IF  PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 204
* EL050.cbl
 11165         IF PB-I-NUM-BILLED EQUAL ZEROS
 11166            MOVE ER-8148       TO WS-ERROR
 11167            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11168
 11169*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 11170*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11171*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 11172*         SET ELAPSED-BETWEEN-BIN TO TRUE
 11173*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11174*         IF NO-CONVERSION-ERROR
 11175*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 11176*         ELSE
 11177*             IF PB-COMPANY-ID EQUAL 'HAN'
 11178*                 MOVE ZEROS     TO PB-I-AGE.
 11179     IF PB-I-BIRTHDAY > LOW-VALUES
 11180        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 11181        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11182        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11183        PERFORM 8500-DATE-CONVERT
 11184                                 THRU 8500-EXIT
 11185        IF NO-CONVERSION-ERROR
 11186           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11187           IF PB-I-AGE > ZEROS
 11188              IF WS-WORK-AGE NOT = PB-I-AGE
 11189                 MOVE ER-9501    TO WS-ERROR
 11190                 PERFORM 9900-ERROR-FORMAT
 11191                                 THRU 9900-EXIT
 11192              END-IF
 11193           ELSE
 11194              MOVE WS-WORK-AGE   TO PB-I-AGE
 11195           END-IF
 11196        END-IF
 11197     END-IF
 11198     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 11199                                   WS-INS-AGE-SET
 11200     IF PB-I-AGE = ZEROS
 11201        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 11202           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11203                                   WS-INS-AGE-SET
 11204           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 11205
 11206     MOVE PB-I-AGE              TO WS-EDIT-AGE
 11207                                   WS-AH-EDIT-AGE.
 11208
 11209     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11210        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 11211        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11212        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11213        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11214        IF NO-CONVERSION-ERROR
 11215           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 11216           IF PB-I-JOINT-AGE > 0
 11217              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 11218                 MOVE ER-9503    TO WS-ERROR
 11219                 PERFORM 9900-ERROR-FORMAT
 11220                                 THRU 9900-EXIT
 11221              END-IF
 11222           ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 205
* EL050.cbl
 11223              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 11224           END-IF
 11225        ELSE
 11226           MOVE ZEROS            TO PB-I-JOINT-AGE
 11227        END-IF
 11228     END-IF
 11229     IF PB-I-JOINT-AGE NOT NUMERIC
 11230        MOVE ZERO               TO PB-I-JOINT-AGE.
 11231
 11232     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 11233                                   WS-JNT-AGE-SET
 11234     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 11235        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 11236           (WS-AH-JOINT-INDICATOR = 'J')
 11237           IF PB-I-JOINT-AGE = ZEROS
 11238               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 11239                                          WS-JNT-AGE-SET
 11240               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 11241           END-IF
 11242        END-IF
 11243     END-IF
 11244
 11245     MOVE ' ' TO PB-I-LIFE-INDICATOR
 11246     IF WS-LF-JOINT-INDICATOR = 'J'
 11247        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 11248        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11249            IF  PB-I-JOINT-AGE = ZERO
 11250                MOVE ER-2686       TO WS-ERROR
 11251                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11252            ELSE
 11253                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11254                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 11255                    IF PB-COMPANY-ID NOT = 'LBL'
 11256                        MOVE ER-2685    TO WS-ERROR
 11257                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11258
 11259     IF WS-AH-JOINT-INDICATOR = 'J'
 11260        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 11261            IF  PB-I-JOINT-AGE = ZERO
 11262                MOVE ER-2686       TO WS-ERROR
 11263                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11264            ELSE
 11265                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 11266                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 11267                                           WS-EDIT-AGE
 11268                    IF PB-COMPANY-ID NOT = 'LBL'
 11269                        MOVE ER-2685    TO WS-ERROR
 11270                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11271
 11272******************************************************************
 11273*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 11274******************************************************************
 11275
 11276     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11277        (WS-AH-SPECIAL-CALC-CD = 'O')
 11278        NEXT SENTENCE
 11279     ELSE
 11280        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 206
* EL050.cbl
 11281          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 11282           (WS-LF-JOINT-INDICATOR = 'J'  OR
 11283            WS-AH-JOINT-INDICATOR = 'J')  AND
 11284           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 11285            MOVE ER-2627             TO WS-ERROR
 11286            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11287
 11288     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 11289        (WS-AH-SPECIAL-CALC-CD = 'O')
 11290         NEXT SENTENCE
 11291     ELSE
 11292         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11293            WS-AH-JOINT-INDICATOR = 'J'
 11294             IF PB-I-JOINT-INSURED = SPACES
 11295                 IF PB-COMPANY-ID NOT = 'JAL'
 11296                     MOVE ER-2696    TO WS-ERROR
 11297                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11298
 11299     IF PB-COMPANY-ID NOT = 'BOA'
 11300        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11301           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11302           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 11303               PB-I-JOINT-INSURED NOT = SPACES)
 11304                MOVE ER-2691         TO WS-ERROR
 11305                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11306
 11307     IF PB-COMPANY-ID = 'BOA'
 11308        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 11309           (WS-AH-JOINT-INDICATOR NOT = 'J')
 11310            IF PB-I-JOINT-AGE NOT = ZEROS
 11311                MOVE ER-2691         TO WS-ERROR
 11312                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11313
 11314     IF PB-COMPANY-ID = 'CRI'
 11315        IF PB-I-SIG-SW = 'J'
 11316           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 11317              WS-AH-JOINT-INDICATOR NOT = 'J'
 11318              MOVE ER-2675       TO WS-ERROR
 11319              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11320
 11321     IF PB-COMPANY-ID = 'CRI'
 11322        IF PB-I-SIG-SW = 'S'
 11323           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 11324              WS-AH-JOINT-INDICATOR = 'J'
 11325              MOVE ER-2676       TO WS-ERROR
 11326              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11327
 11328     IF PB-COMPANY-ID = 'CVL'
 11329         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 11330            (WS-LF-JOINT-INDICATOR NOT = 'J')
 11331              MOVE ER-2783           TO WS-ERROR
 11332              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11333     IF (WS-LF-JOINT-INDICATOR = 'J')
 11334        AND (WS-AH-JOINT-INDICATOR = 'J')
 11335        AND (PB-I-LF-TERM > 120)
 11336        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 11337        MOVE ER-2783             TO WS-ERROR
 11338        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 207
* EL050.cbl
 11339     END-IF
 11340     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 11341
 11342     IF PB-I-INDV-GRP-OVRD = 'I'
 11343        MOVE ER-2666             TO WS-ERROR
 11344        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11345        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 11346
 11347     IF PB-I-INDV-GRP-OVRD = 'G'
 11348        MOVE ER-2666             TO WS-ERROR
 11349        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11350        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 11351
 11352     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 11353        NEXT SENTENCE
 11354     ELSE
 11355        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 11356
 11357     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 11358        IF WS-ERROR = ER-2666
 11359           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11360           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 11361
 11362     IF PB-COMPANY-ID = 'CID'
 11363        IF PB-STATE = 'UT' OR 'MO'
 11364           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 11365                 OR '76' OR '77')
 11366                      OR
 11367               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 11368                   OR '41' OR '42' OR '63' OR '64' OR '65'
 11369                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 11370                   OR '2K' OR '2L'))
 11371              AND PB-I-INDV-GRP-CD = 'I'
 11372              MOVE ER-2721             TO WS-ERROR
 11373              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11374           END-IF
 11375        END-IF
 11376     END-IF
 11377
 11378     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 11379     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 11380        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 11381     ELSE
 11382        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 11383     END-IF
 11384
 11385*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 11386*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 11387     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 11388                                    ACCOUNT-AH-CK-SW.
 11389
 11390     IF PB-REISSUED-CERT       OR
 11391        PB-REIN-ONLY-CERT      OR
 11392        PB-POLICY-IS-DECLINED  OR
 11393        PB-POLICY-IS-VOIDED
 11394*       OR PB-MONTHLY-CERT
 11395         GO TO 3000-CONTINUE-EDIT.
 11396
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 208
* EL050.cbl
 11397     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11398        IF WS-EDIT-AGE           > +65
 11399           MOVE ER-2709          TO WS-ERROR
 11400           PERFORM 9900-ERROR-FORMAT
 11401                                 THRU 9900-EXIT
 11402        ELSE
 11403           IF WS-EDIT-AGE        > +55
 11404              MOVE ER-2718       TO WS-ERROR
 11405              PERFORM 9900-ERROR-FORMAT
 11406                                 THRU 9900-EXIT
 11407           END-IF
 11408        END-IF
 11409     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11410        IF WS-EDIT-AGE           > +65
 11411           MOVE ER-2709          TO WS-ERROR
 11412           PERFORM 9900-ERROR-FORMAT
 11413                                 THRU 9900-EXIT
 11414        END-IF
 11415     END-IF
 11416     .
 11417
 11418 0565-LIFE-PLAN-LIMIT-EDITS.
 11419
 11420     IF NOT LF-PLAN-MASTER-FOUND
 11421        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 11422                                    EC-AM-LF-MAX-TOT-BEN
 11423        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11424
 11425     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 11426
 11427     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11428         IF PL-LM-AGE (1) = ZEROS
 11429             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11430
 11431     IF NO-LF-BENEFIT-MATCH          OR
 11432        WS-LF-BENEFIT-CD = ZEROS     OR
 11433        WS-LF-SPECIAL-CALC-CD = 'M'
 11434        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11435
 11436     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 11437     MOVE +1                     TO SUB2.
 11438
 11439     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11440        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11441           MOVE +5   TO SUB2
 11442           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11443              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11444              (PL-LM-AGE (SUB2) EQUAL +0)
 11445              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 11446              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11447
 11448     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 11449
 11450     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 11451                               + PB-I-LF-ALT-BENEFIT-AMT.
 11452
 11453 0568-CHECK-LIFE-ATT-AGE.
 11454
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 209
* EL050.cbl
 11455     IF PL-ATT-AGE NUMERIC AND
 11456        PL-ATT-AGE > +0
 11457        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11458     END-IF
 11459*    IF PL-ATT-AGE NUMERIC AND
 11460*       PL-ATT-AGE > +0
 11461*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 11462*       IF PB-I-BIRTHDAY > LOW-VALUES
 11463*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11464*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 11465*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11466*          SET BIN-PLUS-ELAPSED  TO TRUE
 11467*          PERFORM 8500-DATE-CONVERT
 11468*                                THRU 8500-EXIT
 11469*          IF NO-CONVERSION-ERROR
 11470*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11471*             MOVE ER-2669       TO WS-ERROR
 11472*             PERFORM 9900-ERROR-FORMAT
 11473*                                THRU 9900-EXIT
 11474*          END-IF
 11475*       ELSE
 11476*          IF WS-ATT-AGE >= PL-ATT-AGE
 11477*             MOVE ER-2669       TO WS-ERROR
 11478*             PERFORM 9900-ERROR-FORMAT
 11479*                                THRU 9900-EXIT
 11480*          END-IF
 11481*       END-IF
 11482*    END-IF
 11483     .
 11484 0570-CHECK-LIFE-LIMITS.
 11485
 11486     IF PB-COMPANY-ID EQUAL 'CRI'
 11487        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11488           IF SUB2 GREATER THAN +4
 11489              MOVE ER-2637 TO WS-ERROR
 11490              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11491              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11492
 11493     IF PB-COMPANY-ID  =  'NCL'
 11494        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11495            SUB2 GREATER THAN +8
 11496             MOVE 'U'         TO PB-BATCH-ENTRY
 11497             MOVE ER-2637     TO WS-ERROR
 11498             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11499             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11500
 11501     IF SUB2 > +8
 11502        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11503           AND (PB-I-SIG-SW = 'Y')
 11504           CONTINUE
 11505        ELSE
 11506           MOVE ER-2637          TO WS-ERROR
 11507           PERFORM 9900-ERROR-FORMAT
 11508                                 THRU 9900-EXIT
 11509        END-IF
 11510        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11511     END-IF
 11512     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 210
* EL050.cbl
 11513     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11514     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11515
 11516     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11517        ADD +1  TO SUB2
 11518        GO TO 0570-CHECK-LIFE-LIMITS.
 11519
 11520     IF PB-COMPANY-ID = 'NCL'
 11521         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 11522
 11523     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11524        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11525        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11526           AND (PB-I-SIG-SW = 'Y')
 11527           CONTINUE
 11528        ELSE
 11529           MOVE ER-2637          TO WS-ERROR
 11530           PERFORM 9900-ERROR-FORMAT
 11531                                 THRU 9900-EXIT
 11532        END-IF
 11533     END-IF
 11534     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11535
 11536
 11537 0570-CHECK-NCL-LIFE-LIMITS.
 11538
 11539     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11540        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11541         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11542
 11543     IF APP-CERT-USED
 11544         IF SUB2  LESS THAN  +5
 11545             MOVE +5          TO SUB2
 11546             GO TO 0570-CHECK-LIFE-LIMITS.
 11547
 11548     MOVE ER-2637             TO WS-ERROR.
 11549     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11550
 11551     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11552
 11553 0575-CHECK-NCL-SIG-SWITCH.
 11554
 11555     IF NOT APP-CERT-USED
 11556         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11557
 11558     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11559        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11560        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11561        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11562         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11563
 11564     IF SUB2 GREATER THAN +4
 11565         IF PL-LM-AGE (5) = ZEROS  AND
 11566            PL-LM-AGE (6) = ZEROS  AND
 11567            PL-LM-AGE (7) = ZEROS  AND
 11568            PL-LM-AGE (8) = ZEROS
 11569             MOVE  ER-1927        TO WS-ERROR
 11570             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 211
* EL050.cbl
 11571             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11572         ELSE
 11573             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11574                 MOVE  ER-1920    TO WS-ERROR
 11575                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11576
 11577     IF PB-I-SIG-SW  = 'Y'
 11578       IF NOT PB-I-POLICY-ACCEPTED  AND
 11579          NOT PB-I-POLICY-DECLINED
 11580           MOVE 'U'               TO PB-BATCH-ENTRY
 11581           MOVE  ER-1926          TO WS-ERROR
 11582           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11583
 11584
 11585 0580-AH-PLAN-LIMIT-EDITS.
 11586
 11587     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11588        IF PB-I-AH-BENEFIT-AMT > +1250
 11589           MOVE ER-2702          TO WS-ERROR
 11590           PERFORM 9900-ERROR-FORMAT
 11591                                 THRU 9900-EXIT
 11592        END-IF
 11593     END-IF
 11594
 11595     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11596        AND (PB-MONTHLY-CERT)
 11597        IF PB-I-AH-BENEFIT-AMT > +3000
 11598           MOVE ER-2881          TO WS-ERROR
 11599           PERFORM 9900-ERROR-FORMAT
 11600                                 THRU 9900-EXIT
 11601        END-IF
 11602     END-IF
 11603     IF NOT AH-PLAN-MASTER-FOUND
 11604        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11605        GO TO 3000-CONTINUE-EDIT.
 11606
 11607     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11608
 11609     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11610         IF PL-LM-AGE (1) = ZEROS
 11611             GO TO 3000-CONTINUE-EDIT.
 11612
 11613     IF NO-AH-BENEFIT-MATCH          OR
 11614        WS-AH-BENEFIT-CD = ZEROS     OR
 11615        WS-AH-SPECIAL-CALC-CD = 'M'
 11616        GO TO 3000-CONTINUE-EDIT.
 11617
 11618     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11619     MOVE +1                     TO SUB2.
 11620
 11621     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11622        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11623           MOVE +5 TO SUB2
 11624           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11625              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11626              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11627              (PL-LM-AGE (SUB2) EQUAL +0)
 11628              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 212
* EL050.cbl
 11629              GO TO 3000-CONTINUE-EDIT.
 11630
 11631     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11632
 11633 0590-CHECK-AH-ATT-AGE.
 11634
 11635     IF PL-ATT-AGE NUMERIC AND
 11636        PL-ATT-AGE GREATER THAN +0
 11637        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11638     END-IF
 11639*       IF WS-ATT-AGE >= PL-ATT-AGE
 11640*          MOVE ER-3054          TO WS-ERROR
 11641*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11642     .
 11643 0597-CHECK-AH-LIMITS.
 11644
 11645     IF PB-COMPANY-ID EQUAL 'CRI'
 11646        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11647           IF SUB2 GREATER THAN +4
 11648              MOVE ER-2638       TO WS-ERROR
 11649              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11650              GO TO 3000-CONTINUE-EDIT.
 11651
 11652     IF PB-COMPANY-ID  =  'NCL'
 11653        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11654            SUB2 GREATER THAN +8
 11655             MOVE 'U'            TO PB-BATCH-ENTRY
 11656             MOVE ER-2638        TO WS-ERROR
 11657             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11658             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11659
 11660     IF SUB2 > +8
 11661        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11662           AND (PB-I-SIG-SW = 'Y')
 11663           CONTINUE
 11664        ELSE
 11665           MOVE ER-2638          TO WS-ERROR
 11666           PERFORM 9900-ERROR-FORMAT
 11667                                 THRU 9900-EXIT
 11668        END-IF
 11669        GO TO 3000-CONTINUE-EDIT
 11670     END-IF
 11671
 11672     IF PB-COMPANY-ID = 'CRI'
 11673        IF WS-ERROR = ER-2638
 11674           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11675
 11676     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11677     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11678     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11679     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11680
 11681     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11682        ADD +1                   TO SUB2
 11683        GO TO 0597-CHECK-AH-LIMITS.
 11684
 11685     IF PB-COMPANY-ID = 'NCL'
 11686         GO TO 0597-CHECK-NCL-AH-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 213
* EL050.cbl
 11687
 11688     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11689        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11690        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11691                                 > PL-LM-AMT (SUB2))
 11692        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11693           AND (PB-I-SIG-SW = 'Y')
 11694           CONTINUE
 11695        ELSE
 11696           MOVE ER-2638          TO WS-ERROR
 11697           PERFORM 9900-ERROR-FORMAT
 11698                                 THRU 9900-EXIT
 11699        END-IF
 11700     END-IF
 11701
 11702     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11703         IF  WS-ERROR    EQUAL    ER-2638
 11704             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11705                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11706                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11707                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11708                MOVE  ER-1910    TO  WS-ERROR
 11709                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11710
 11711     IF PB-COMPANY-ID = 'CRI'
 11712        IF WS-ERROR = ER-2638
 11713            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11714            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11715            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11716
 11717     GO TO 3000-CONTINUE-EDIT.
 11718
 11719 0597-CHECK-NCL-AH-LIMITS.
 11720
 11721     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11722        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11723        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11724                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11725         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11726
 11727     IF APP-CERT-USED
 11728         IF SUB2  LESS THAN  +5
 11729             MOVE +5             TO SUB2
 11730             GO TO 0597-CHECK-AH-LIMITS.
 11731
 11732     MOVE ER-2638                TO WS-ERROR.
 11733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11734
 11735     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11736
 11737 0599-CHECK-NCL-SIG-SWITCH.
 11738
 11739     IF NOT APP-CERT-USED
 11740         GO TO 3000-CONTINUE-EDIT.
 11741
 11742     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11743        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11744        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 214
* EL050.cbl
 11745        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11746         GO TO 3000-CONTINUE-EDIT.
 11747
 11748     IF SUB2 GREATER THAN +4
 11749         IF PL-LM-AGE (5) = ZEROS  AND
 11750            PL-LM-AGE (6) = ZEROS  AND
 11751            PL-LM-AGE (7) = ZEROS  AND
 11752            PL-LM-AGE (8) = ZEROS
 11753             MOVE  ER-1927        TO WS-ERROR
 11754             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11755             GO TO 3000-CONTINUE-EDIT
 11756         ELSE
 11757             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11758                 MOVE  ER-1920    TO WS-ERROR
 11759                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11760
 11761     IF PB-I-SIG-SW  = 'Y'
 11762       IF NOT PB-I-POLICY-ACCEPTED  AND
 11763          NOT PB-I-POLICY-DECLINED
 11764           MOVE 'U'               TO PB-BATCH-ENTRY
 11765           MOVE  ER-1926          TO WS-ERROR
 11766           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11767
 11768******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 215
* EL050.cbl
 11770
 11771 3000-CONTINUE-EDIT.
 11772
 11773     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11774     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11775     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11776     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11777     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11778
 11779     IF BROWSE-STARTED
 11780        PERFORM 9990-RETURN THRU 9990-EXIT
 11781        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11782
 11783     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11784        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11785        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11786        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11787*       MOVE 1                   TO DC-OPTION-CODE
 11788        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11789        IF DATE-CONVERSION-ERROR
 11790           MOVE ER-2622          TO WS-ERROR
 11791           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792        ELSE
 11793           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11794              MOVE ER-2623       TO WS-ERROR
 11795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796           ELSE
 11797              MOVE ER-2622       TO WS-ERROR
 11798              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11799
 11800     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11801     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11802     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11803*    MOVE 1                      TO DC-OPTION-CODE.
 11804     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11805     IF DATE-CONVERSION-ERROR
 11806        GO TO 3005-EDIT-CONTINUE
 11807     ELSE
 11808        IF DC-ELAPSED-DAYS GREATER +180
 11809           MOVE ER-2613          TO WS-ERROR
 11810           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11811        ELSE
 11812           IF DC-ELAPSED-DAYS GREATER +90
 11813              MOVE ER-2612       TO WS-ERROR
 11814              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11815           ELSE
 11816             IF DC-ELAPSED-DAYS GREATER +60
 11817                MOVE ER-2614     TO WS-ERROR
 11818                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11819
 11820 3005-EDIT-CONTINUE.
 11821
 11822     IF PB-CANCELLATION
 11823         GO TO 3700-EDIT-CANCEL.
 11824
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 216
* EL050.cbl
 11826******************************************************************
 11827*                  E D I T   I S S U E                           *
 11828******************************************************************
 11829
 11830 3020-EDIT-ISSUE.
 11831
 11832      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11833      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11834      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11835      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11836      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11837
 11838     IF PB-ISSUE-FORCE
 11839        OR PB-ISSUE-DATE-FORCED
 11840        OR PB-FORCE-OFF
 11841        OR PB-OVERCHARGE-FORCE
 11842        or pb-exceeded-limit-forced
 11843        CONTINUE
 11844     ELSE
 11845        MOVE ER-2670             TO WS-ERROR
 11846        PERFORM 9900-ERROR-FORMAT
 11847                                 THRU 9900-EXIT
 11848     END-IF
 11849     .
 11850 3022-SET-POLICY-STATUS.
 11851
 11852     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11853
 11854     IF (PB-REISSUED-CERT)
 11855             OR
 11856        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11857         AND (PB-MONTHLY-CERT))
 11858         MOVE '5'                TO PB-I-ENTRY-STATUS
 11859         MOVE 'E'                TO PB-BATCH-ENTRY
 11860     END-IF
 11861
 11862     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11863        IF PB-MONTHLY-CERT
 11864           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11865        END-IF
 11866        IF PB-CASH-CERT
 11867           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11868        END-IF
 11869     END-IF
 11870     IF PB-POLICY-IS-DECLINED
 11871         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11872     IF PB-POLICY-IS-VOIDED
 11873         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11874     IF PB-NEEDS-UNDERWRITING
 11875         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11876     IF PB-REIN-ONLY-CERT
 11877         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11878     IF PB-PREM-ACCTNG-ONLY
 11879         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11880
 11881     MOVE SPACE                  TO PB-I-OB-FLAG.
 11882
 11883     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 217
* EL050.cbl
 11884         MOVE ER-2665            TO WS-ERROR
 11885         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11886         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11887
 11888     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11889        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11890           MOVE 'Z'             TO PB-I-OB-FLAG.
 11891
 11892     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11893        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11894           MOVE 'Z'             TO PB-I-OB-FLAG.
 11895
 11896     IF ACCOUNT-MAST-FOUND
 11897         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11898         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11899         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11900         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11901         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11902         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11903         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11904     END-IF
 11905
 11906     IF ACCOUNT-MAST-FOUND
 11907        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11908         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11909
 11910     IF (ACCOUNT-MAST-FOUND)
 11911*        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11912        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S' OR 'D' OR 'P')
 11913        IF PB-REISSUED-CERT
 11914           CONTINUE
 11915        ELSE
 11916           MOVE ER-2608          TO WS-ERROR
 11917           PERFORM 9900-ERROR-FORMAT
 11918                                 THRU 9900-EXIT
 11919         END-IF
 11920     END-IF
 11921
 11922     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11923        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11924        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11925
 11926**********   DMD CUSTOM CODE FOLLOWS  **********
 11927 3024-EDIT-DMD-FIELDS.
 11928     IF PB-COMPANY-ID NOT = 'DMD'
 11929        GO TO 3025-EDIT-REINSURANCE.
 11930
 11931*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11932*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11933*** ERROR IF THEY ARE NOT EQUAL.
 11934
 11935     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11936     SET BIN-TO-GREG               TO TRUE.
 11937     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11938     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11939**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11940
 11941     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 218
* EL050.cbl
 11942     SET BIN-TO-GREG               TO TRUE.
 11943     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11944     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11945**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11946
 11947     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11948        MOVE ER-8116               TO WS-ERROR
 11949        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11950
 11951     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11952
 11953     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11954                                      WK-FULL-CERT-NO.
 11955     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11956
 11957     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11958
 11959     IF PB-VALID-LIFE
 11960        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11961     ELSE
 11962        IF PB-VALID-AH
 11963          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11964
 11965
 11966     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11967     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11968     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11969                                      DCUA-UNDRWRTR-CODE
 11970                                      DCUA-UNDRWRTR-GROUP-CODE
 11971                                      DCUA-RETURN-CODE.
 11972
 11973****************************************************************
 11974*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11975***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11976***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11977***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11978***   TO THIS RECORD.                                        ***
 11979****************************************************************
 11980     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11981     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11982     IF DCUA-SUCCESSFUL-PROCESS
 11983        GO TO 3024-EDIT-DL7-CONT.
 11984
 11985     IF DCUA-RETURN-CODE EQUAL '01'
 11986        MOVE ER-8110               TO WS-ERROR
 11987        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11988        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11989        GO TO 3024-EDIT-DL7-CONT.
 11990
 11991     IF DCUA-RETURN-CODE EQUAL '02'
 11992        MOVE ER-8111               TO WS-ERROR
 11993        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11995        GO TO 3024-EDIT-DL7-CONT.
 11996
 11997     IF DCUA-RETURN-CODE EQUAL '03'
 11998        MOVE ER-8074               TO WS-ERROR
 11999        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 219
* EL050.cbl
 12000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12001        GO TO 3024-EDIT-DL7-CONT.
 12002
 12003     IF DCUA-RETURN-CODE EQUAL '04'
 12004        MOVE ER-8075               TO WS-ERROR
 12005        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12006        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12007        GO TO 3024-EDIT-DL7-CONT.
 12008
 12009     IF DCUA-RETURN-CODE EQUAL '05'
 12010        MOVE ER-8076               TO WS-ERROR
 12011        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12012        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12013        GO TO 3024-EDIT-DL7-CONT.
 12014
 12015     IF DCUA-RETURN-CODE EQUAL '06'
 12016        MOVE ER-8077               TO WS-ERROR
 12017        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12019        GO TO 3024-EDIT-DL7-CONT.
 12020
 12021     IF DCUA-RETURN-CODE EQUAL '07'
 12022        MOVE ER-8078               TO WS-ERROR
 12023        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12024        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12025        GO TO 3024-EDIT-DL7-CONT.
 12026
 12027     IF DCUA-RETURN-CODE EQUAL 'E1'
 12028        MOVE ER-8079               TO WS-ERROR
 12029        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12031        GO TO 3024-EDIT-DL7-CONT.
 12032
 12033     IF DCUA-RETURN-CODE EQUAL 'E2'
 12034        MOVE ER-8080               TO WS-ERROR
 12035        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12037        GO TO 3024-EDIT-DL7-CONT.
 12038
 12039     IF DCUA-RETURN-CODE EQUAL 'E3'
 12040        MOVE ER-8098               TO WS-ERROR
 12041        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12042        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12043        GO TO 3024-EDIT-DL7-CONT.
 12044
 12045     IF DCUA-RETURN-CODE EQUAL 'C1'
 12046        MOVE ER-8099               TO WS-ERROR
 12047        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12048        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12049        GO TO 3024-EDIT-DL7-CONT.
 12050
 12051     IF DCUA-RETURN-CODE EQUAL 'U1'
 12052        MOVE ER-8109               TO WS-ERROR
 12053        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12054        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12055        GO TO 3024-EDIT-DL7-CONT.
 12056
 12057     IF DCUA-RETURN-CODE EQUAL 'N1'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 220
* EL050.cbl
 12058        MOVE ER-8112               TO WS-ERROR
 12059        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12060        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12061        GO TO 3024-EDIT-DL7-CONT.
 12062
 12063     IF DCUA-RETURN-CODE EQUAL 'N2'
 12064        MOVE ER-8113               TO WS-ERROR
 12065        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12067        GO TO 3024-EDIT-DL7-CONT.
 12068
 12069     IF DCUA-RETURN-CODE EQUAL 'N3'
 12070        MOVE ER-8114               TO WS-ERROR
 12071        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 12072        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12073        GO TO 3024-EDIT-DL7-CONT.
 12074
 12075     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 12076     MOVE ER-8097                  TO WS-ERROR.
 12077     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 12078     GO TO 3024-EDIT-DL7-CONT.
 12079
 12080 3024-EDIT-DL7-CONT.
 12081
 12082     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 12083     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 12084     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 12085        NEXT SENTENCE
 12086     ELSE
 12087        MOVE ER-9263               TO WS-ERROR
 12088        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12089
 12090******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 12091******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 12092     IF DCUA-CERT-NUMBER = PB-CERT-NO
 12093        NEXT SENTENCE
 12094     ELSE
 12095        MOVE ER-8039               TO WS-ERROR
 12096        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12097
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 221
* EL050.cbl
 12099****************************************************************
 12100*** VALIDATE STATE  : DLO022                                 ***
 12101****************************************************************
 12102     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 12103     MOVE SPACES                   TO DVSC-RETURN-CODE.
 12104
 12105     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 12106     IF DVSC-SUCCESSFUL-EDIT
 12107        GO TO 3024-EDIT-DL22-CONT.
 12108
 12109     IF DVSC-RETURN-CODE EQUAL '01'
 12110        MOVE ER-8300               TO WS-ERROR
 12111        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12112        GO TO 3024-EDIT-DL22-CONT.
 12113
 12114     IF DVSC-RETURN-CODE EQUAL '02'
 12115        MOVE ER-8301               TO WS-ERROR
 12116        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12117        GO TO 3024-EDIT-DL22-CONT.
 12118
 12119     IF DVSC-RETURN-CODE EQUAL '03'
 12120        MOVE ER-8302               TO WS-ERROR
 12121        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12122        GO TO 3024-EDIT-DL22-CONT.
 12123
 12124     IF DVSC-RETURN-CODE EQUAL 'N1'
 12125        MOVE ER-8304               TO WS-ERROR
 12126        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12127        GO TO 3024-EDIT-DL22-CONT.
 12128
 12129     MOVE ER-8303                  TO WS-ERROR
 12130     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12131
 12132 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 222
* EL050.cbl
 12134****************************************************************
 12135*** VALIDATE LOAN OFFICER : DLO021                           ***
 12136****************************************************************
 12137
 12138     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 12139     MOVE SPACES                    TO DVLO-RETURN-CODE.
 12140     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 12141     IF DVLO-SUCCESSFUL-EDIT
 12142        GO TO 3024-EDIT-DL21-CONT.
 12143
 12144     IF DVLO-RETURN-CODE EQUAL '01'
 12145        MOVE ER-8081               TO WS-ERROR
 12146        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12147        GO TO 3024-EDIT-DL21-CONT.
 12148
 12149     IF DVLO-RETURN-CODE EQUAL '02'
 12150        MOVE ER-8082               TO WS-ERROR
 12151        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12152        GO TO 3024-EDIT-DL21-CONT.
 12153
 12154     IF DVLO-RETURN-CODE EQUAL '03'
 12155        MOVE ER-8083               TO WS-ERROR
 12156        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12157        GO TO 3024-EDIT-DL21-CONT.
 12158
 12159     IF DVLO-RETURN-CODE EQUAL '04'
 12160        MOVE ER-8084               TO WS-ERROR
 12161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12162        GO TO 3024-EDIT-DL21-CONT.
 12163
 12164     IF DVLO-RETURN-CODE EQUAL '05'
 12165        MOVE ER-8085               TO WS-ERROR
 12166        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12167        GO TO 3024-EDIT-DL21-CONT.
 12168
 12169     MOVE ER-7825                  TO WS-ERROR
 12170     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12171     GO TO 3024-EDIT-DL21-CONT.
 12172
 12173 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 223
* EL050.cbl
 12175
 12176****************************************************************
 12177*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 12178****************************************************************
 12179
 12180     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 12181     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 12182     MOVE SPACES                 TO DIPF-RETURN-CODE.
 12183     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 12184     IF DIPF-SUCCESSFUL-EDIT
 12185        GO TO 3024-EDIT-DL02-CONT.
 12186
 12187     IF DIPF-RETURN-CODE EQUAL '01'
 12188        MOVE ER-8086               TO WS-ERROR
 12189        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12190        GO TO 3024-EDIT-DL02-CONT.
 12191
 12192     IF DIPF-RETURN-CODE EQUAL '02'
 12193        MOVE ER-8087               TO WS-ERROR
 12194        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12195        GO TO 3024-EDIT-DL02-CONT.
 12196
 12197     IF DIPF-RETURN-CODE EQUAL '03'
 12198        MOVE ER-8088               TO WS-ERROR
 12199        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12200        GO TO 3024-EDIT-DL02-CONT.
 12201
 12202     MOVE ER-8095                  TO WS-ERROR
 12203     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12204     GO TO 3024-EDIT-DL02-CONT.
 12205
 12206 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 224
* EL050.cbl
 12208
 12209****************************************************************
 12210*** VALIDATE BANK ID : DLO003                                ***
 12211****************************************************************
 12212
 12213     MOVE WK-GREG-CENT           TO WCG-CENT.
 12214     MOVE WK-GREG-YYMM           TO WCG-REST.
 12215     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 12216        MOVE ER-8040               TO WS-ERROR
 12217        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12218
 12219     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 12220     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 12221     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 12222     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 12223     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 12224     IF DVBI-SUCCESSFUL-EDIT
 12225        GO TO 3024-EDIT-DL03-CONT.
 12226
 12227     IF DVBI-RETURN-CODE EQUAL '01'
 12228        MOVE ER-8089               TO WS-ERROR
 12229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12230        GO TO 3024-EDIT-DL03-CONT.
 12231
 12232     IF DVBI-RETURN-CODE EQUAL '02'
 12233        MOVE ER-8090               TO WS-ERROR
 12234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12235        GO TO 3024-EDIT-DL03-CONT.
 12236
 12237     IF DVBI-RETURN-CODE EQUAL '03'
 12238        MOVE ER-8091               TO WS-ERROR
 12239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12240        GO TO 3024-EDIT-DL03-CONT.
 12241
 12242     IF DVBI-RETURN-CODE EQUAL '04'
 12243        MOVE ER-8092               TO WS-ERROR
 12244        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12245        GO TO 3024-EDIT-DL03-CONT.
 12246
 12247     IF DVBI-RETURN-CODE EQUAL '05'
 12248        MOVE ER-8093               TO WS-ERROR
 12249        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12250        GO TO 3024-EDIT-DL03-CONT.
 12251
 12252     IF DVBI-RETURN-CODE EQUAL '06'
 12253        MOVE ER-8094               TO WS-ERROR
 12254        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12255        GO TO 3024-EDIT-DL03-CONT.
 12256
 12257     MOVE ER-8096                  TO WS-ERROR
 12258     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 12259     GO TO 3024-EDIT-DL03-CONT.
 12260
 12261 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 225
* EL050.cbl
 12263
 12264     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 12265        NEXT SENTENCE
 12266     ELSE
 12267        MOVE ER-8042               TO WS-ERROR
 12268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12269
 12270     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 12271     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 12272     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 12273
 12274     IF DMPF-RETURN-CODE = '01'
 12275        MOVE ER-8067               TO WS-ERROR
 12276        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12277        GO TO 3024-EDIT-DL01-CONT.
 12278
 12279     IF DMPF-RETURN-CODE = '02'
 12280        MOVE ER-8068               TO WS-ERROR
 12281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12282        GO TO 3024-EDIT-DL01-CONT.
 12283
 12284     IF DMPF-RETURN-CODE = '03'
 12285        MOVE ER-8069               TO WS-ERROR
 12286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12287        GO TO 3024-EDIT-DL01-CONT.
 12288
 12289     IF DMPF-RETURN-CODE = 'E1'
 12290        MOVE ER-8070               TO WS-ERROR
 12291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12292        GO TO 3024-EDIT-DL01-CONT.
 12293
 12294     IF DMPF-RETURN-CODE = 'N1'
 12295        MOVE ER-8071               TO WS-ERROR
 12296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12297        GO TO 3024-EDIT-DL01-CONT.
 12298
 12299     IF DMPF-RETURN-CODE NOT = 'OK'
 12300        MOVE ER-8072               TO WS-ERROR
 12301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12302
 12303 3024-EDIT-DL01-CONT.
 12304******************************************************************
 12305***  VALIDATES RATE CODES : DLO017                             ***
 12306******************************************************************
 12307
 12308      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 12309      MOVE SPACES                   TO DVRC-RETURN-CODE.
 12310      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 12311      IF DVRC-SUCCESSFUL-EDIT
 12312        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 12313        GO TO 3024-CHECK-VALID-RATE.
 12314
 12315      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 12316
 12317      IF DVRC-RETURN-CODE EQUAL '01'
 12318         MOVE ER-7817                   TO WS-ERROR
 12319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12320         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 226
* EL050.cbl
 12321
 12322      IF DVRC-RETURN-CODE EQUAL '02'
 12323         MOVE ER-7818                   TO WS-ERROR
 12324         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12325         GO TO 3025-EDIT-REINSURANCE.
 12326
 12327      IF DVRC-RETURN-CODE EQUAL '03'
 12328         MOVE ER-7819                   TO WS-ERROR
 12329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12330         GO TO 3025-EDIT-REINSURANCE.
 12331
 12332       MOVE ER-7820                     TO WS-ERROR.
 12333       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12334       GO TO 3025-EDIT-REINSURANCE.
 12335
 12336******************************************************************
 12337***  GET PREMIUM RATES : DLO011                                ***
 12338******************************************************************
 12339
 12340 3024-CHECK-VALID-RATE.
 12341
 12342     IF VALID-RATE-CODE
 12343        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 12344        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 12345        MOVE SPACES                TO DPRB-RETURN-CODE
 12346        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 12347     ELSE
 12348         GO TO 3025-EDIT-REINSURANCE.
 12349
 12350      IF DPRB-SUCCESSFUL-PROCESS
 12351         IF PB-VALID-LIFE
 12352             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 12353             GO TO 3025-EDIT-REINSURANCE
 12354         ELSE
 12355             IF PB-VALID-AH
 12356                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 12357                 GO TO 3025-EDIT-REINSURANCE.
 12358
 12359      IF DPRB-RETURN-CODE EQUAL '01'
 12360         MOVE ER-7812                   TO WS-ERROR
 12361         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12362         GO TO 3025-EDIT-REINSURANCE.
 12363
 12364      IF DPRB-RETURN-CODE EQUAL '02'
 12365         MOVE ER-7813                   TO WS-ERROR
 12366         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12367         GO TO 3025-EDIT-REINSURANCE.
 12368
 12369      IF DPRB-RETURN-CODE EQUAL '03'
 12370         MOVE ER-7814                   TO WS-ERROR
 12371         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12372         GO TO 3025-EDIT-REINSURANCE.
 12373
 12374      IF DPRB-RETURN-CODE EQUAL '04'
 12375         IF NOT DPRB-1ST-TIME
 12376            MOVE ER-7815                   TO WS-ERROR
 12377            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12378            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 227
* EL050.cbl
 12379          ELSE
 12380         IF PB-VALID-LIFE
 12381            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12382          ELSE
 12383            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 12384         END-IF
 12385         MOVE SPACES                TO DOCC-RETURN-CODE
 12386         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 12387         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 12388         IF DOCC-RETURN-CODE = 'OK'
 12389             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 12390             GO TO 3024-CHECK-VALID-RATE
 12391           ELSE
 12392             MOVE ER-7823               TO WS-ERROR
 12393             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 12394             GO TO 3025-EDIT-REINSURANCE.
 12395
 12396       MOVE ER-7816                     TO WS-ERROR.
 12397       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 12398       GO TO 3025-EDIT-REINSURANCE.
 12399
 12400**********   DMD CUSTOM CODE ABOVE    **********
 12401
 12402 3025-EDIT-REINSURANCE.
 12403     IF PB-I-SPECIAL-REIN-CODE = SPACE
 12404         GO TO 3027-EDIT-CONTINUE.
 12405
 12406     MOVE LOW-VALUES               TO ERREIN-KEY.
 12407     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 12408     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 12409                                      REIN-CODE-2
 12410                                      REIN-CODE-3.
 12411     MOVE 'A'                      TO REIN-TYPE.
 12412
 12413     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 12414
 12415     MOVE '3026' TO REIN-SW.
 12416     MOVE ' '                   TO WS-REIN-READ-SW.
 12417
 12418     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12419     IF REIN-TABLE-NOT-FOUND
 12420         GO TO 3026-NO-SPEC-TABLE.
 12421
 12422     MOVE RE-TABLE              TO WK-REIN-TABLE.
 12423     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12424                                   WS-NSP-ST-CD-LF.
 12425     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12426                                   WS-NSP-ST-CD-AH.
 12427
 12428     GO TO 3040-EDIT-CONTINUE.
 12429
 12430 3026-NO-SPEC-TABLE.
 12431
 12432     MOVE ER-2664                TO WS-ERROR.
 12433     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12434     GO TO 3040-EDIT-CONTINUE.
 12435
 12436 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 228
* EL050.cbl
 12437
 12438     IF PB-I-REIN-TABLE = SPACES
 12439       GO TO 3040-EDIT-CONTINUE.
 12440
 12441     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 12442          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 12443          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 12444           GO TO 3040-EDIT-CONTINUE.
 12445
 12446     MOVE LOW-VALUES            TO ERREIN-KEY.
 12447     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 12448     MOVE 'A'                   TO REIN-TYPE.
 12449     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 12450
 12451     MOVE '3028'                TO REIN-SW.
 12452     MOVE ' '                   TO WS-REIN-READ-SW.
 12453
 12454     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 12455     IF REIN-TABLE-NOT-FOUND
 12456         GO TO 3028-NO-REIN-TABLE.
 12457
 12458     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 12459     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 12460                                   WS-NSP-ST-CD-LF.
 12461     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 12462                                   WS-NSP-ST-CD-AH.
 12463
 12464     GO TO 3040-EDIT-CONTINUE.
 12465
 12466 3028-NO-REIN-TABLE.
 12467
 12468     MOVE ER-2615                TO WS-ERROR.
 12469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12470     GO TO 3040-EDIT-CONTINUE.
 12471
 12472 3040-EDIT-CONTINUE.
 12473
 12474     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12475         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12476
 12477     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12478         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12479
 12480     IF (NOT PB-REISSUED-CERT)
 12481        AND (NOT PB-MONTHLY-CERT)
 12482        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12483            MOVE '001'           TO PB-I-LF-TERM
 12484            MOVE 'M'             TO PB-I-INSURED-SEX.
 12485
 12486     IF (NOT PB-REISSUED-CERT)
 12487        AND (NOT PB-MONTHLY-CERT)
 12488        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12489            MOVE '001'           TO PB-I-AH-TERM
 12490            MOVE 'M'             TO PB-I-INSURED-SEX.
 12491
 12492 3040-EDIT-1ST-PMT-DT.
 12493     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12494     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 229
* EL050.cbl
 12495         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12496
 12497******************************************************************
 12498*                                                                *
 12499*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12500*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12501*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12502*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12503*                                                                *
 12504******************************************************************
 12505
 12506     IF PB-EFF-DT-PROCESSING
 12507        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12508                                    PB-I-LF-EXPIRE-DT
 12509                                    PB-I-AH-EXPIRE-DT
 12510        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12511        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12512        MOVE ZERO                TO DC-ELAPSED-DAYS
 12513        MOVE +1                  TO DC-ELAPSED-MONTHS
 12514        SET BIN-PLUS-ELAPSED     TO TRUE
 12515*       MOVE 6                   TO DC-OPTION-CODE
 12516        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12517        IF NO-CONVERSION-ERROR
 12518           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12519
 12520******************************************************************
 12521*                                                                *
 12522*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12523*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12524*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12525*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12526*                                                                *
 12527******************************************************************
 12528
 12529     IF PB-EXT-DAYS-PROCESSING
 12530          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12531                                         PB-I-LF-EXPIRE-DT
 12532                                         PB-I-AH-EXPIRE-DT
 12533          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12534          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12535          MOVE +1                     TO DC-ELAPSED-MONTHS
 12536          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12537          SET BIN-PLUS-ELAPSED        TO TRUE
 12538*         MOVE 6                      TO DC-OPTION-CODE
 12539          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12540          IF NO-CONVERSION-ERROR
 12541             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12542
 12543******************************************************************
 12544*                                                                *
 12545*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12546*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12547*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12548*        (EXPIRE DATE - (TERM -1))  *  -1.
 12549*                                                                *
 12550******************************************************************
 12551
 12552     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 230
* EL050.cbl
 12553        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12554           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12555              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12556              MOVE PB-I-AH-TERM      TO WS-TERM
 12557           ELSE
 12558              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12559              MOVE PB-I-LF-TERM      TO WS-TERM
 12560        ELSE
 12561           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12562              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12563              MOVE PB-I-LF-TERM      TO WS-TERM
 12564           ELSE
 12565              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12566              MOVE PB-I-AH-TERM      TO WS-TERM.
 12567
 12568     IF PB-EXPIRE-DT-PROCESSING
 12569        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12570        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12571        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12572        MOVE ZERO                TO DC-ELAPSED-DAYS
 12573                                    DC-ODD-DAYS-OVER
 12574          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12575          SET BIN-PLUS-ELAPSED    TO TRUE
 12576*         MOVE 6                  TO DC-OPTION-CODE
 12577          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12578          IF NO-CONVERSION-ERROR
 12579             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12580
 12581******************************************************************
 12582*                                                                *
 12583*            1ST PAYMENT DATE PROCESSING                         *
 12584*                                                                *
 12585******************************************************************
 12586
 12587     IF PB-1ST-PMT-DT-PROCESSING
 12588        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12589                                    PB-I-AH-EXPIRE-DT
 12590        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12591
 12592     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12593         NEXT SENTENCE
 12594     ELSE
 12595         MOVE ER-2680                 TO WS-ERROR
 12596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12597         GO TO 3060-ORIG-TERM-CHECK.
 12598
 12599     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12600     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12601     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12602*    MOVE 1                      TO DC-OPTION-CODE.
 12603     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12604                                    DC-ELAPSED-DAYS
 12605                                    DC-ODD-DAYS-OVER.
 12606
 12607     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12608
 12609     IF DATE-CONVERSION-ERROR
 12610        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 231
* EL050.cbl
 12611
 12612     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12613     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12614        AND (WS-LF-COVERAGE-TYPE = 'L')
 12615        IF (DC-ELAPSED-MONTHS > 1)
 12616                      OR
 12617           ((DC-ELAPSED-MONTHS = 1)
 12618           AND (DC-ODD-DAYS-OVER > 0))
 12619           MOVE ER-2882          TO WS-ERROR
 12620           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12621        END-IF
 12622     END-IF
 12623     if dc-elapsed-months > 0
 12624        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12625        + dc-odd-days-over
 12626     end-if
 12627     IF PB-EXT-DAYS-PROCESSING
 12628        CONTINUE
 12629     ELSE
 12630        IF DC-ELAPSED-MONTHS = +0
 12631           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12632        ELSE
 12633           IF (WS-LF-EARNINGS-CALC = '4')
 12634              AND (DC-ELAPSED-MONTHS > ZERO)
 12635              AND (DC-ELAPSED-DAYS > ZERO)
 12636              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12637           ELSE
 12638              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12639                                 THRU 6499-EXIT
 12640              MOVE WS-ODD-DAYS-OVER
 12641                                 TO PB-I-EXTENTION-DAYS
 12642           END-IF
 12643        END-IF
 12644     END-IF
 12645******************************************************************
 12646*                                                                *
 12647*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12648*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12649*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12650*            AND ANY ODD DAYS.                                   *
 12651*                                                                *
 12652******************************************************************
 12653
 12654     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12655                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12656     IF WS-LF-EARNINGS-CALC NOT = '4'
 12657        IF DC-ELAPSED-DAYS > ZEROS
 12658           MOVE ER-2681          TO WS-ERROR
 12659           PERFORM 9900-ERROR-FORMAT
 12660                                 THRU 9900-EXIT
 12661        END-IF
 12662     END-IF
 12663
 12664     IF WS-LF-EARNINGS-CALC NOT = '4'
 12665        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12666           MOVE ER-2681          TO WS-ERROR
 12667           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12668
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 232
* EL050.cbl
 12669     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12670        (PB-I-LF-TERM NOT = ZERO) AND
 12671         NOT NO-LIFE-COVERAGE
 12672          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12673          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12674          IF WS-LF-EARNINGS-CALC = '4'
 12675             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12676             PB-I-PAY-FREQUENCY
 12677          END-IF
 12678          MOVE ZERO              TO DC-ELAPSED-DAYS
 12679                                    DC-ODD-DAYS-OVER
 12680          MOVE 1                 TO DC-END-OF-MONTH
 12681          SET BIN-PLUS-ELAPSED        TO TRUE
 12682*         MOVE 6                 TO DC-OPTION-CODE
 12683          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12684          IF NO-CONVERSION-ERROR
 12685             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12686             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12687                (WS-LF-SPECIAL-CALC-CD = 'L')
 12688                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12689                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12690                  MOVE +1             TO DC-ELAPSED-MONTHS
 12691                  SET BIN-PLUS-ELAPSED  TO TRUE
 12692*                 MOVE 6              TO DC-OPTION-CODE
 12693                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12694                  IF NO-CONVERSION-ERROR
 12695                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12696
 12697* okay, i had to move the new att age edit down here because the
 12698* expiration date could get recalculated and i need the exp date
 12699     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12700        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12701        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12702        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12703           AND ZEROS
 12704           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12705           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12706           SET ELAPSED-BETWEEN-BIN TO TRUE
 12707           PERFORM 8500-DATE-CONVERT
 12708                                 THRU 8500-EXIT
 12709           IF NO-CONVERSION-ERROR
 12710              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12711                 MOVE ER-2669       TO WS-ERROR
 12712*                PERFORM 9900-ERROR-FORMAT
 12713*                                THRU 9900-EXIT
 12714              END-IF
 12715           END-IF
 12716        ELSE
 12717           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12718           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12719              MOVE ER-2669       TO WS-ERROR
 12720*             PERFORM 9900-ERROR-FORMAT
 12721*                                THRU 9900-EXIT
 12722           ELSE
 12723              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12724                 MOVE ER-1570    TO WS-ERROR
 12725                 PERFORM 9900-ERROR-FORMAT
 12726                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 233
* EL050.cbl
 12727              END-IF
 12728           END-IF
 12729        END-IF
 12730        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12731           AND ZEROS
 12732           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12733           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12734           SET ELAPSED-BETWEEN-BIN TO TRUE
 12735           PERFORM 8500-DATE-CONVERT
 12736                                 THRU 8500-EXIT
 12737           IF NO-CONVERSION-ERROR
 12738              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12739                 MOVE ER-2669       TO WS-ERROR
 12740*                PERFORM 9900-ERROR-FORMAT
 12741*                                THRU 9900-EXIT
 12742              END-IF
 12743           END-IF
 12744        ELSE
 12745           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12746             (PB-I-LF-TERM / 12)
 12747           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12748              MOVE ER-2669       TO WS-ERROR
 12749*             PERFORM 9900-ERROR-FORMAT
 12750*                                THRU 9900-EXIT
 12751           ELSE
 12752              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12753                 MOVE ER-1571    TO WS-ERROR
 12754                 PERFORM 9900-ERROR-FORMAT
 12755                                 THRU 9900-EXIT
 12756              END-IF
 12757           END-IF
 12758        END-IF
 12759        IF WS-ERROR = ER-2669
 12760           PERFORM 9900-ERROR-FORMAT
 12761                                 THRU 9900-EXIT
 12762        END-IF
 12763     END-IF
 12764     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12765        (PB-I-AH-TERM NOT = ZERO) AND
 12766         NOT NO-AH-COVERAGE
 12767          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12768             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12769             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12770             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12771          ELSE
 12772             IF WS-LF-EARNINGS-CALC = '4'
 12773                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12774                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12775                PB-I-PAY-FREQUENCY
 12776             ELSE
 12777                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12778                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12779             END-IF
 12780          END-IF
 12781          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12782                                         DC-ODD-DAYS-OVER
 12783          MOVE 1                      TO DC-END-OF-MONTH
 12784          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 234
* EL050.cbl
 12785*         MOVE 6                      TO DC-OPTION-CODE
 12786          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12787          IF NO-CONVERSION-ERROR
 12788             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12789     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12790        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12791        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12792        IF PB-I-BIRTHDAY > LOW-VALUES
 12793           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12794           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12795           SET ELAPSED-BETWEEN-BIN TO TRUE
 12796           PERFORM 8500-DATE-CONVERT
 12797                                 THRU 8500-EXIT
 12798           IF NO-CONVERSION-ERROR
 12799              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12800                 MOVE ER-3054       TO WS-ERROR
 12801*                PERFORM 9900-ERROR-FORMAT
 12802*                                THRU 9900-EXIT
 12803              END-IF
 12804           END-IF
 12805        ELSE
 12806           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12807           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12808              MOVE ER-3054       TO WS-ERROR
 12809*             PERFORM 9900-ERROR-FORMAT
 12810*                                THRU 9900-EXIT
 12811           END-IF
 12812        END-IF
 12813        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12814           AND ZEROS
 12815           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12816           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12817           SET ELAPSED-BETWEEN-BIN TO TRUE
 12818           PERFORM 8500-DATE-CONVERT
 12819                                 THRU 8500-EXIT
 12820           IF NO-CONVERSION-ERROR
 12821              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12822                 MOVE ER-3054       TO WS-ERROR
 12823*                PERFORM 9900-ERROR-FORMAT
 12824*                                THRU 9900-EXIT
 12825              END-IF
 12826           END-IF
 12827        ELSE
 12828           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12829             (PB-I-AH-TERM / 12)
 12830           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12831              MOVE ER-3054       TO WS-ERROR
 12832*             PERFORM 9900-ERROR-FORMAT
 12833*                                THRU 9900-EXIT
 12834           END-IF
 12835        END-IF
 12836        IF WS-ERROR = ER-3054
 12837           PERFORM 9900-ERROR-FORMAT
 12838                                 THRU 9900-EXIT
 12839        END-IF
 12840     END-IF
 12841     MOVE SPACE                       TO DC-END-OF-MONTH.
 12842
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 235
* EL050.cbl
 12843     IF PB-COMPANY-ID = 'NCB'
 12844        GO TO 3040-EDIT-EXTENSION-DAYS.
 12845
 12846     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12847       AND
 12848        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12849        NEXT SENTENCE
 12850     ELSE
 12851        GO TO 3040-EDIT-EXTENSION-DAYS.
 12852
 12853     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12854        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12855        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12856     ELSE
 12857        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12858        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12859
 12860     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12861*    MOVE '1'      TO DC-OPTION-CODE
 12862     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12863     IF (NO-CONVERSION-ERROR)
 12864        AND (DC-ELAPSED-MONTHS > +1)
 12865        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12866        MOVE ER-2668   TO WS-ERROR
 12867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12868
 12869 3040-EDIT-EXTENSION-DAYS.
 12870
 12871     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12872        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12873         GO TO 3050-EDIT-TERM-IN-DAYS
 12874     ELSE
 12875         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12876
 12877     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12878         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12879     ELSE
 12880        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12881           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12882           MOVE ER-2681         TO WS-ERROR
 12883           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12884
 12885     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12886        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12887        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12888         GO TO 3060-ORIG-TERM-CHECK.
 12889
 12890     GO TO 3060-ORIG-TERM-CHECK.
 12891
 12892 3050-EDIT-TERM-IN-DAYS.
 12893
 12894     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12895
 12896     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12897         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12898     ELSE
 12899         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12900            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 236
* EL050.cbl
 12901            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12902
 12903     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12904                                       REMAINDER WS-WORK-TERM.
 12905     IF WS-WORK-TERM GREATER THAN ZERO
 12906         ADD +1 TO PB-I-LF-TERM.
 12907
 12908     IF NOT NO-AH-COVERAGE
 12909         MOVE ER-2684            TO WS-ERROR
 12910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12911
 12912
 12913 3060-ORIG-TERM-CHECK.
 12914
 12915******************************************************************
 12916*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12917******************************************************************
 12918
 12919     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12920        NEXT SENTENCE
 12921     ELSE
 12922        IF NOT NO-LIFE-COVERAGE
 12923           IF PB-I-LF-TERM NUMERIC
 12924              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12925              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12926              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12927                  NEXT SENTENCE
 12928           ELSE
 12929              MOVE ER-2647       TO WS-ERROR
 12930              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12931
 12932     IF NOT NO-AH-COVERAGE
 12933         IF PB-I-AH-TERM NUMERIC
 12934            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12935            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12936            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12937             NEXT SENTENCE
 12938          ELSE
 12939              MOVE ER-2658       TO WS-ERROR
 12940              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12941
 12942     IF PB-COMPANY-ID = 'NCB'
 12943        GO TO 3070-LOAN-TERM-CHECK.
 12944
 12945     IF POLICY-HAS-AH
 12946       AND
 12947        POLICY-HAS-LIFE
 12948       AND
 12949        PB-I-LF-TERM NUMERIC
 12950       AND
 12951        PB-I-AH-TERM NUMERIC
 12952        NEXT SENTENCE
 12953     ELSE
 12954        GO TO 3070-LOAN-TERM-CHECK.
 12955
 12956     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12957     IF WS-TEX-FACT-2 LESS THAN +0
 12958        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 237
* EL050.cbl
 12959
 12960     IF WS-TEX-FACT-2 GREATER THAN +1
 12961        MOVE ER-2668             TO WS-ERROR
 12962        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12963
 12964 3070-LOAN-TERM-CHECK.
 12965
 12966     IF (WS-LF-BENEFIT-CD = ZERO)
 12967         OR (NO-LF-BENEFIT-MATCH)
 12968            GO TO 3125-EDIT-PMT-FREQ.
 12969*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12970*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12971*          AND 'V' AND 'W' AND 'X'
 12972*          GO TO 3125-EDIT-PMT-FREQ
 12973*       END-IF
 12974*    ELSE
 12975*       IF WS-AH-DCC-TRUNC = 'T'
 12976*          CONTINUE
 12977*       ELSE
 12978*          GO TO 3125-EDIT-PMT-FREQ
 12979*       END-IF
 12980*    END-IF
 12981     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12982                    OR
 12983        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12984        AND (WS-AH-DCC-TRUNC = 'T'))
 12985        CONTINUE
 12986     ELSE
 12987        GO TO 3125-EDIT-PMT-FREQ
 12988     END-IF
 12989     IF PB-I-LOAN-TERM NOT NUMERIC
 12990         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12991
 12992     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12993        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12994*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12995        PB-I-LOAN-TERM NOT GREATER THAN +360
 12996         NEXT SENTENCE
 12997     ELSE
 12998         MOVE ER-2648            TO WS-ERROR
 12999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13000
 13001     if  PB-I-LOAN-TERM > WS-MAX-TERM
 13002        MOVE ER-3058             TO WS-ERROR
 13003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13004     end-if
 13005
 13006     IF WS-STATE-ABBREVIATION = 'NC'
 13007        IF PB-I-LOAN-TERM > +59
 13008           CONTINUE
 13009        ELSE
 13010           MOVE ER-2792          TO WS-ERROR
 13011           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13012        END-IF
 13013     END-IF
 13014
 13015     .
 13016 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 238
* EL050.cbl
 13017     IF (WS-LF-BENEFIT-CD = ZERO)
 13018         OR (NO-LF-BENEFIT-MATCH)
 13019         or (pb-state = 'AL')
 13020            GO TO 3127-EDIT-LOAN-OFFICER.
 13021     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 13022                    OR
 13023        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 13024        AND (WS-AH-DCC-TRUNC = 'T'))
 13025                    OR
 13026         (PB-COMPANY-ID = 'AHL')
 13027        CONTINUE
 13028     ELSE
 13029        IF (PB-I-LOAN-TERM > ZEROS)
 13030           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 13031           MOVE ER-1575          TO WS-ERROR
 13032           PERFORM 9900-ERROR-FORMAT
 13033                                 THRU 9900-EXIT
 13034        END-IF
 13035     END-IF
 13036     IF WS-LF-EARNINGS-CALC NOT = '4'
 13037         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 13038            MOVE ER-2653         TO WS-ERROR
 13039            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13040            GO TO 3127-EDIT-LOAN-OFFICER
 13041         ELSE
 13042            GO TO 3127-EDIT-LOAN-OFFICER.
 13043
 13044     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 13045         MOVE ER-2655            TO WS-ERROR
 13046         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13047         GO TO 3127-EDIT-LOAN-OFFICER.
 13048
 13049     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 13050         MOVE ER-2654            TO WS-ERROR
 13051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13052         GO TO 3127-EDIT-LOAN-OFFICER.
 13053
 13054     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 13055         GIVING WS-TEX-FACT-2
 13056             REMAINDER WS-TEX-FACT-3.
 13057
 13058*    IF WS-TEX-FACT-3 NOT = ZERO
 13059*       MOVE ER-2654             TO WS-ERROR
 13060*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13061
 13062
 13063 3127-EDIT-LOAN-OFFICER.
 13064
 13065     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 13066        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 13067           MOVE ER-2690          TO WS-ERROR
 13068           PERFORM 9900-ERROR-FORMAT
 13069                                 THRU 9900-EXIT
 13070        ELSE
 13071           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 13072           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 13073           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 13074           MOVE PB-SV-STATE      TO LOFC-STATE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 239
* EL050.cbl
 13075           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 13076           MOVE PB-I-LOAN-OFFICER
 13077                                 TO LOFC-CODE
 13078           PERFORM 8586-READ-LOAN-OFFICER
 13079                                 THRU 8586-EXIT
 13080           IF (NOT LOFC-MASTER-FOUND)
 13081              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 13082              MOVE ER-3006       TO WS-ERROR
 13083              PERFORM 9900-ERROR-FORMAT
 13084                                 THRU 9900-EXIT
 13085           END-IF
 13086        END-IF
 13087     END-IF
 13088     .
 13089 3129-EDIT-APR.
 13090
 13091     IF (WS-LF-BENEFIT-CD = ZERO)
 13092        OR (NO-LF-BENEFIT-MATCH)
 13093        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 13094           GO TO 3130-EDIT-AGE
 13095*       ELSE
 13096*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13097*             GO TO 3130-EDIT-AGE
 13098*          END-IF
 13099        END-IF
 13100     END-IF
 13101
 13102     IF (WS-STATE-ABBREVIATION = 'OH')
 13103         AND (PB-I-RATE-CLASS NOT = 'L ')
 13104         AND (PB-I-LF-TERM GREATER THAN 60)
 13105         AND (PB-CERT-EFF-DT GREATER WS-831031)
 13106         GO TO 3129-APR-CONT.
 13107
 13108     IF (WS-STATE-ABBREVIATION = 'RI')
 13109         AND (PB-I-LF-TERM GREATER THAN 60)
 13110         AND (PB-CERT-EFF-DT GREATER WS-831231)
 13111         GO TO 3129-APR-CONT.
 13112
 13113     IF (WS-STATE-ABBREVIATION = 'UT')
 13114         AND (PB-I-LF-TERM GREATER THAN 62)
 13115         AND (PB-CERT-EFF-DT GREATER WS-810831)
 13116         AND (PB-CERT-EFF-DT LESS WS-830901)
 13117         GO TO 3129-APR-CONT.
 13118
 13119     IF PB-COMPANY-ID = 'LAP'
 13120        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 13121           IF PB-I-LOAN-APR GREATER THAN ZEROS
 13122              MOVE ER-2656         TO WS-ERROR
 13123              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13124              GO TO 3130-EDIT-AGE.
 13125
 13126     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13127        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 13128        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 13129        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13130        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 13131        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 13132         GO TO 3130-EDIT-AGE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 240
* EL050.cbl
 13133
 13134 3129-APR-CONT.
 13135     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 13136         (WS-LF-SPECIAL-CALC-CD = 'M'))
 13137         GO TO 3130-EDIT-AGE.
 13138
 13139     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 13140         WS-AH-BENEFIT-CD (1:1) = 'S')
 13141        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 13142        AND (PB-I-LOAN-APR = ZERO)
 13143        MOVE ER-2657             TO WS-ERROR
 13144        PERFORM 9900-ERROR-FORMAT
 13145                                 THRU 9900-EXIT
 13146        GO TO 3130-EDIT-AGE
 13147     END-IF
 13148*    IF PB-I-LOAN-APR = ZERO
 13149*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 13150*    END-IF
 13151
 13152     if pb-i-loan-apr = +99.9999
 13153        move er-2656             to ws-error
 13154        PERFORM 9900-ERROR-FORMAT
 13155                                 THRU 9900-EXIT
 13156        GO TO 3130-EDIT-AGE
 13157     end-if
 13158*    IF PB-I-LOAN-APR = ZERO
 13159*       MOVE ER-2656             TO WS-ERROR
 13160*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13161*       GO TO 3130-EDIT-AGE.
 13162
 13163*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 13164     if pb-i-loan-apr not = +99.9999
 13165        IF PB-I-LOAN-APR > +30.000
 13166           MOVE ER-2657          TO WS-ERROR
 13167           PERFORM 9900-ERROR-FORMAT
 13168                                 THRU 9900-EXIT
 13169        end-if
 13170     end-if
 13171     .
 13172 3130-EDIT-AGE.
 13173
 13174******************************************************************
 13175*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 13176******************************************************************
 13177
 13178     IF NOT NO-LIFE-COVERAGE
 13179        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13180           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 13181               MOVE ER-2628             TO WS-ERROR
 13182               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13183
 13184     IF NOT NO-AH-COVERAGE
 13185        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13186           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 13187               MOVE ER-2628         TO WS-ERROR
 13188               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13189
 13190 3133-SEX-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 241
* EL050.cbl
 13191     IF PB-I-INSURED-SEX = SPACE OR ZERO
 13192         IF WS-DEFAULT-SEX = 'M'
 13193             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 13194          ELSE
 13195             IF WS-DEFAULT-SEX = 'F'
 13196             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 13197
 13198     IF PB-I-INSURED-SEX = '1'
 13199         MOVE 'M' TO PB-I-INSURED-SEX.
 13200
 13201     IF PB-I-INSURED-SEX = '2'
 13202         MOVE 'F' TO PB-I-INSURED-SEX.
 13203
 13204 3134-SIG-SW-EDIT.
 13205     IF PB-I-SIG-SW = SPACE
 13206         MOVE 'N'                TO  PB-I-SIG-SW.
 13207
 13208     IF PB-COMPANY-ID = 'NCL'
 13209         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 13210             NEXT SENTENCE
 13211         ELSE
 13212             MOVE ER-1923        TO  WS-ERROR
 13213             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13214     ELSE
 13215     IF PB-COMPANY-ID = 'CRI'
 13216         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 13217             NEXT SENTENCE
 13218         ELSE
 13219             MOVE ER-2606        TO  WS-ERROR
 13220             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13221     ELSE
 13222     IF PB-COMPANY-ID = 'TMS'
 13223         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 13224             NEXT SENTENCE
 13225         ELSE
 13226             MOVE ER-2689        TO  WS-ERROR
 13227             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13228     ELSE
 13229         IF PB-I-SIG-SW = 'Y' OR 'N'
 13230             NEXT SENTENCE
 13231         ELSE
 13232             MOVE ER-2651        TO  WS-ERROR
 13233             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13234
 13235     IF PB-COMPANY-ID = 'FLA'
 13236         IF (WS-EDIT-AGE GREATER 54  OR
 13237             WS-AH-EDIT-AGE GREATER 54)  AND
 13238            PB-I-SIG-SW = 'N'
 13239            MOVE ER-2651         TO  WS-ERROR
 13240            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13241
 13242 3135-NAME-EDIT.
 13243
 13244     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 13245        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 13246        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 13247           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 13248                                 TO PB-I-JOINT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 242
* EL050.cbl
 13249        END-PERFORM
 13250     END-IF
 13251     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 13252        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 13253        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 13254           MOVE PB-I-JOINT-LAST-NAME (2:14)
 13255                                 TO PB-I-JOINT-LAST-NAME
 13256        END-PERFORM
 13257     END-IF
 13258     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 13259        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 13260        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 13261           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 13262                                 TO PB-I-INSURED-FIRST-NAME
 13263        END-PERFORM
 13264     END-IF
 13265     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 13266        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 13267        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 13268           MOVE PB-I-INSURED-LAST-NAME (2:14)
 13269                                 TO PB-I-INSURED-LAST-NAME
 13270        END-PERFORM
 13271     END-IF
 13272     IF PB-I-INSURED-LAST-NAME = SPACES
 13273       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13274       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 13275           MOVE ER-2660    TO WS-ERROR
 13276           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13277
 13278 3136-EDIT-SEX.
 13279
 13280******************************************************************
 13281*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 13282******************************************************************
 13283
 13284     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 13285        (WS-AH-SPECIAL-CALC-CD = 'O')
 13286        NEXT SENTENCE
 13287     ELSE
 13288        IF PB-I-INSURED-SEX = 'M' OR 'F'
 13289           NEXT SENTENCE
 13290        ELSE
 13291           MOVE ER-2629            TO WS-ERROR
 13292           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13293
 13294 3137-EDIT-EFF-DATE.
 13295
 13296     IF PB-REISSUED-CERT       OR
 13297        PB-POLICY-IS-DECLINED  OR
 13298        PB-POLICY-IS-VOIDED
 13299         GO TO 3139-EDIT-COVERAGE-CODES.
 13300
 13301     MOVE SPACE                  TO WS-2671-SW
 13302                                    WS-2672-SW.
 13303
 13304     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 13305         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 13306             MOVE ER-2703        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 243
* EL050.cbl
 13307             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13308             GO TO 3139-EDIT-COVERAGE-CODES.
 13309
 13310     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 13311         GO TO 3139-EDIT-COVERAGE-CODES.
 13312
 13313     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13314     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 13315*    MOVE '1'                    TO DC-OPTION-CODE.
 13316     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 13317     MOVE +0                     TO DC-ELAPSED-MONTHS
 13318                                    DC-ELAPSED-DAYS.
 13319     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13320
 13321     IF DATE-CONVERSION-ERROR
 13322         GO TO 3139-EDIT-COVERAGE-CODES.
 13323
 13324     IF DC-ELAPSED-DAYS GREATER +180
 13325         MOVE ER-2672            TO WS-ERROR
 13326         MOVE 'Y'                TO WS-2672-SW
 13327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13328     END-IF
 13329
 13330     IF WS-ERROR = ER-2671  AND
 13331        PB-COMPANY-ID  = 'LBL'
 13332        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13333        MOVE SPACE               TO WS-2671-SW
 13334        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 13335
 13336     IF PB-ISSUE-DATE-FORCED  AND
 13337      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 13338         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 13339         MOVE ER-2673            TO WS-ERROR
 13340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13341         MOVE SPACE              TO WS-2671-SW
 13342                                    WS-2672-SW.
 13343
 13344     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 13345         IF PB-ISSUE-DATE-FORCED
 13346             MOVE ER-2600          TO  WS-ERROR
 13347             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13348         ELSE
 13349             MOVE ER-2692          TO  WS-ERROR
 13350             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13351
 13352
 13353 3139-EDIT-COVERAGE-CODES.
 13354
 13355     if pb-company-id not = 'AHL'
 13356        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 13357           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 13358           MOVE ER-2787          TO WS-ERROR
 13359           PERFORM 9900-ERROR-FORMAT
 13360                                 THRU 9900-EXIT
 13361        END-IF
 13362     end-if
 13363     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13364        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 244
* EL050.cbl
 13365                                 > 250000.00
 13366           MOVE ER-2719          TO WS-ERROR
 13367           PERFORM 9900-ERROR-FORMAT
 13368                                 THRU 9900-EXIT
 13369        END-IF
 13370     END-IF
 13371
 13372     IF PB-POLICY-IS-DECLINED  OR
 13373        PB-POLICY-IS-VOIDED
 13374         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13375
 13376     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 13377        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 13378         MOVE ER-2630                TO WS-ERROR
 13379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13380
 13381     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 13382        PB-I-LF-BENEFIT-AMT = ZERO  AND
 13383        PB-I-LF-PREMIUM-AMT = ZERO
 13384         GO TO 3140-CHECK-AH-FOR-ZERO.
 13385
 13386     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 13387        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 13388        PB-I-LF-PREMIUM-AMT NOT = ZERO
 13389         GO TO 3140-CHECK-AH-FOR-ZERO.
 13390
 13391     IF (PB-I-LF-BENEFIT-CD = ZERO)
 13392        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13393        MOVE ER-2631             TO WS-ERROR
 13394        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13395     END-IF
 13396
 13397
 13398******************************************************************
 13399*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13400******************************************************************
 13401
 13402     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13403        NEXT SENTENCE
 13404     ELSE
 13405        IF PB-I-LF-BENEFIT-AMT = ZERO
 13406           MOVE ER-2632             TO WS-ERROR
 13407           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13408
 13409
 13410******************************************************************
 13411*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13412******************************************************************
 13413
 13414     IF WS-LF-SPECIAL-CALC-CD = 'O'
 13415        CONTINUE
 13416     ELSE
 13417        IF PB-I-LF-PREMIUM-AMT = ZERO
 13418           IF (NOT PB-COMP-LF-PREM)
 13419              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 13420              and (ws-lf-ben-category not = 'C')
 13421              MOVE ER-2633       TO WS-ERROR
 13422              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 245
* EL050.cbl
 13423           END-IF
 13424        END-IF
 13425     END-IF
 13426     .
 13427 3140-CHECK-AH-FOR-ZERO.
 13428
 13429     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 13430        PB-I-AH-BENEFIT-AMT = ZERO  AND
 13431        PB-I-AH-PREMIUM-AMT = ZERO
 13432         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13433
 13434     IF PB-COMPANY-ID = 'CSL'  AND
 13435        PB-I-AH-BENEFIT-CD = ZERO  AND
 13436        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13437        PB-I-AH-PREMIUM-AMT = ZERO
 13438         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13439
 13440     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 13441        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 13442        PB-I-AH-PREMIUM-AMT NOT = ZERO
 13443         GO TO 3140-EDIT-MAX-AMT-SIZES.
 13444
 13445     IF PB-I-AH-BENEFIT-CD = ZERO
 13446         MOVE ER-2634            TO WS-ERROR
 13447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13448
 13449******************************************************************
 13450*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13451******************************************************************
 13452
 13453     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13454        NEXT SENTENCE
 13455     ELSE
 13456        IF PB-I-AH-BENEFIT-AMT = ZERO
 13457           MOVE ER-2635             TO WS-ERROR
 13458           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13459
 13460******************************************************************
 13461*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 13462******************************************************************
 13463
 13464     IF WS-AH-SPECIAL-CALC-CD = 'O'
 13465        NEXT SENTENCE
 13466     ELSE
 13467        IF PB-I-AH-PREMIUM-AMT = ZERO
 13468            IF NOT PB-COMP-AH-PREM
 13469                MOVE ER-2636    TO WS-ERROR
 13470                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13471
 13472
 13473 3140-EDIT-MAX-AMT-SIZES.
 13474* CUSTOM CODE FOR CLIENT    'DMD'
 13475     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13476                                     WS-RES-MUNI-TAX
 13477                                     PB-I-STATE-TAX
 13478                                     PB-I-MUNI-TAX.
 13479
 13480     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 246
* EL050.cbl
 13481
 13482     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13483        GO TO 3150-RATE-OUTSTAND-BAL.
 13484
 13485     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13486        GO TO 3150-RATE-OUTSTAND-BAL.
 13487
 13488     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13489        GO TO 3150-RATE-OUTSTAND-BAL.
 13490
 13491     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13492                             OR 'RIC')
 13493        GO TO 3150-RATE-OUTSTAND-BAL.
 13494
 13495     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13496        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13497            GO TO 3150-RATE-OUTSTAND-BAL
 13498        ELSE
 13499           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13500               GO TO 3150-RATE-OUTSTAND-BAL.
 13501
 13502     IF NOT PB-NO-MONTHS-SKIPPED
 13503        GO TO 3150-RATE-OUTSTAND-BAL.
 13504
 13505     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13506        GO TO 3150-RATE-OUTSTAND-BAL.
 13507
 13508     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13509        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13510           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13511             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13512           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13513           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13514              MOVE ER-2693     TO WS-ERROR
 13515              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13516              GO TO 3150-RATE-OUTSTAND-BAL
 13517           ELSE
 13518              GO TO 3150-RATE-OUTSTAND-BAL.
 13519
 13520 3150-RATE-OUTSTAND-BAL.
 13521
 13522* DMD RATING TEST
 13523     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13524         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13525         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13526         MOVE ER-2687                 TO WS-ERROR
 13527         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13528         MOVE 'B'                     TO PB-I-OB-FLAG
 13529         GO TO 3260-EDIT-CONTINUE.
 13530
 13531     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13532         IF  WS-ERROR    EQUAL    ER-2693
 13533             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13534                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13535                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13536                 MOVE  +0            TO  WS-ERROR.
 13537
 13538     IF  PB-COMPANY-ID   EQUAL    'CDL'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 247
* EL050.cbl
 13539         IF  WS-ERROR    EQUAL    ER-2693
 13540             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13541                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13542                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13543                 MOVE  +0            TO  WS-ERROR.
 13544
 13545     IF PLAN-MASTER-AH-SW = 'Y'
 13546        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13547            IF  WS-ERROR    EQUAL    ER-2693
 13548              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13549                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13550                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13551                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13552                 MOVE  ER-1910           TO  WS-ERROR
 13553                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13554
 13555     IF PLAN-MASTER-AH-SW = 'Y'
 13556        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13557            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13558               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13559               MOVE  ER-1910           TO  WS-ERROR
 13560               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13561
 13562     IF PLAN-MASTER-AH-SW = 'Y'
 13563        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13564            IF  WS-ERROR    EQUAL    ER-2693
 13565                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13566                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13567                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13568                 MOVE  +0       TO  WS-ERROR.
 13569
 13570     IF WS-ERROR = ER-2693
 13571        IF PB-COMPANY-ID = 'JAL' AND
 13572           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13573           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13574           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13575
 13576     IF WS-ERROR = ER-2693
 13577        IF PB-COMPANY-ID = 'NCL'  AND
 13578           PB-I-AH-BENEFIT-CD = 'OA'
 13579           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13580           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13581
 13582     IF WS-ERROR = ER-2693
 13583        IF PB-COMPANY-ID = 'CNL' AND
 13584           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13585           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13586           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13587
 13588     IF WS-ERROR = ER-2693
 13589        IF PB-COMPANY-ID = 'HER'
 13590           IF WS-LEVEL
 13591              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13592              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13593
 13594     IF ((LF-BENEFIT-FOUND) AND
 13595         (NOT NO-LIFE-COVERAGE)  AND
 13596         (WS-LF-SPECIAL-CALC-CD = 'O'))
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 248
* EL050.cbl
 13597       OR   ((AH-BENEFIT-FOUND) AND
 13598             (NOT NO-AH-COVERAGE)    AND
 13599             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13600         NEXT SENTENCE
 13601     ELSE
 13602         GO TO 3215-EDIT-RATES.
 13603
 13604     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13605        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13606           MOVE ER-2674          TO WS-ERROR
 13607           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13608           GO TO 3215-EDIT-RATES.
 13609
 13610     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13611        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13612           MOVE ER-2674          TO WS-ERROR
 13613           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13614           GO TO 3215-EDIT-RATES.
 13615
 13616     MOVE 'B'                    TO PB-I-OB-FLAG.
 13617
 13618     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13619         NEXT SENTENCE
 13620     ELSE
 13621         IF NOT NO-LIFE-COVERAGE
 13622             IF WS-ACCT-LF-OB-RT = ZERO
 13623                MOVE ER-2641    TO WS-ERROR
 13624                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13625
 13626     IF PB-COMPANY-ID = 'CRI'
 13627       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13628         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13629         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13630         IF WS-ERROR = ER-2675
 13631            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13632            MOVE ER-2687              TO WS-ERROR
 13633            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13634         ELSE
 13635            MOVE ER-2687              TO WS-ERROR
 13636            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13637
 13638
 13639     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13640         NEXT SENTENCE
 13641     ELSE
 13642       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13643            NEXT SENTENCE
 13644       ELSE
 13645         IF NOT NO-AH-COVERAGE
 13646             IF WS-ACCT-AH-OB-RT = ZERO
 13647                MOVE ER-2642    TO WS-ERROR
 13648                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13649
 13650     IF PB-COMPANY-ID = 'CRI'
 13651       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13652         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13653         IF WS-ERROR = ER-2676
 13654            SUBTRACT +1               FROM PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 249
* EL050.cbl
 13655            MOVE ER-2687              TO WS-ERROR
 13656            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13657         ELSE
 13658            MOVE ER-2687              TO WS-ERROR
 13659            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13660
 13661     IF PB-COMPANY-ID NOT = 'GIC'
 13662         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13663            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13664     ELSE
 13665         IF PB-I-LF-PREM-CALC = ZEROS
 13666             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13667                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13668
 13669     IF PB-COMPANY-ID NOT = 'GIC'
 13670         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13671            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13672     ELSE
 13673         IF PB-I-AH-PREM-CALC = ZEROS
 13674             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13675                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13676
 13677     MOVE ZEROS TO PB-I-MORT-CODE.
 13678
 13679     GO TO 3260-EDIT-CONTINUE.
 13680
 13681
 13682 3215-EDIT-RATES.
 13683     IF ACCOUNT-MAST-FOUND
 13684         NEXT SENTENCE
 13685     ELSE
 13686         GO TO 3999-END-EDIT.
 13687
 13688 3220-CHECK-LF-RATES.
 13689
 13690     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13691        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13692        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13693        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13694           AND (NOT WS-LF-CASH))
 13695                           OR
 13696           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13697           AND (NOT WS-AH-CASH)))
 13698                       AND
 13699           (PB-I-ENTRY-STATUS NOT = '5')
 13700           MOVE 'M'              TO PB-BATCH-ENTRY
 13701                                    PB-I-ENTRY-STATUS
 13702        END-IF
 13703     END-IF
 13704     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13705                                    PB-I-AH-PREM-CALC
 13706                                    PB-I-LF-ALT-PREM-CALC
 13707                                    PB-I-LF-ALT-RATE
 13708                                    PB-I-LF-REI-RATE
 13709                                    PB-I-LF-ALT-REI-RATE
 13710                                    PB-I-AH-REI-RATE
 13711                                    PB-I-TOT-FEES-CALC.
 13712
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 250
* EL050.cbl
 13713     IF PB-COMPANY-ID EQUAL 'DMD'
 13714        NEXT SENTENCE
 13715     ELSE
 13716        MOVE ZEROS               TO PB-I-LF-RATE
 13717                                    PB-I-AH-RATE.
 13718
 13719     IF PB-I-TOT-FEES NOT NUMERIC
 13720        MOVE ZEROS               TO PB-I-TOT-FEES
 13721     END-IF
 13722     IF PB-I-LIVES NOT NUMERIC
 13723         MOVE ZERO               TO PB-I-LIVES.
 13724
 13725     IF PB-I-NUM-BILLED NOT NUMERIC
 13726         MOVE ZERO               TO PB-I-NUM-BILLED.
 13727
 13728     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13729        MOVE +0                  TO PB-I-LF-PREM-TAX
 13730     END-IF
 13731
 13732     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13733        MOVE +0                  TO PB-I-AH-PREM-TAX
 13734     END-IF
 13735
 13736     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13737        PB-I-PAY-FREQUENCY = ZEROS
 13738            MOVE 12 TO CP-PAY-FREQUENCY
 13739     ELSE
 13740            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13741
 13742     IF PB-I-STATE-TAX NOT NUMERIC
 13743         MOVE ZEROS               TO PB-I-STATE-TAX.
 13744
 13745     IF PB-I-MUNI-TAX NOT NUMERIC
 13746         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13747
 13748     MOVE SPACES                 TO CP-BEN-CATEGORY
 13749     IF PB-COMPANY-ID  = 'CSL'  AND
 13750        PB-I-LF-TERM NOT = ZERO
 13751        COMPUTE WS-PAYMENT-AMT =
 13752             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13753        COMPUTE WS-CSL-AMT1 =
 13754             PB-I-LF-TERM * AM-MAX-MON-BEN
 13755        COMPUTE WS-CSL-AMT2 =
 13756             WS-PAYMENT-AMT * PB-I-LF-TERM
 13757        IF CP-PAY-FREQUENCY NOT = 12
 13758           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13759           MOVE '8' TO WS-CSL-CALC-CD
 13760        ELSE
 13761           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13762              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13763               AM-MAX-TOT-BEN
 13764               MOVE '6' TO WS-CSL-CALC-CD
 13765           ELSE
 13766              IF (WS-CSL-AMT1  GREATER THAN
 13767                 AM-MAX-TOT-BEN) AND
 13768                 (WS-CSL-AMT2  GREATER THAN
 13769                 AM-MAX-TOT-BEN)
 13770                 MOVE '7' TO WS-CSL-CALC-CD
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 251
* EL050.cbl
 13771              ELSE
 13772                 MOVE '5' TO WS-CSL-CALC-CD.
 13773
 13774     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13775         NEXT SENTENCE
 13776     ELSE
 13777         GO TO 3300-CHECK-AH-RATES.
 13778
 13779*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13780
 13781     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13782        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13783              OR
 13784           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13785           MOVE ER-2618          TO WS-ERROR
 13786           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13787           GO TO 3300-CHECK-AH-RATES.
 13788
 13789     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13790           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13791                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13792
 13793     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13794         MOVE ER-2687             TO WS-ERROR
 13795         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13796         MOVE 'Z000'              TO PB-I-MORT-CODE
 13797         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13798         GO TO 3300-CHECK-AH-RATES.
 13799
 13800     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13801        IF PB-I-LIVES = ZERO
 13802           MOVE ER-2688          TO WS-ERROR
 13803           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13804
 13805     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13806
 13807     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13808     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13809     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13810     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13811     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13812     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13813     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13814     MOVE '3'                    TO CP-PROCESS-TYPE.
 13815     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13816     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13817
 13818******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13819     IF PB-COMPANY-ID EQUAL 'CDL'
 13820         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13821            CP-EARN-AS-NET-PAY)
 13822             IF PB-CERT-EFF-DT GREATER  WS-931231
 13823                 MOVE '1'        TO CP-EARNING-METHOD.
 13824*******
 13825
 13826     MOVE PB-SV-STATE            TO CP-STATE.
 13827     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13828     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 252
* EL050.cbl
 13829     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13830     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13831     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13832                                    CP-RATING-BENEFIT-AMT.
 13833     IF CP-STATE-STD-ABBRV = 'OR'
 13834         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13835                                         PB-I-LF-ALT-BENEFIT-AMT.
 13836     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13837     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13838     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13839     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13840     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13841     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13842     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13843     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13844     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13845                                    CP-REMAINING-TERM
 13846                                    CP-LOAN-TERM.
 13847
 13848     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13849         NEXT SENTENCE
 13850     ELSE
 13851         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13852             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13853                                           PB-I-LF-PREMIUM-AMT.
 13854
 13855     IF PB-COMPANY-ID EQUAL 'CSL'
 13856        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13857           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13858                                         PB-I-LF-PREMIUM-AMT.
 13859
 13860     IF PB-COMPANY-ID EQUAL 'NCB'
 13861         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13862            CP-EARN-AS-NET-PAY
 13863             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13864                 PB-I-LF-PREMIUM-AMT.
 13865
 13866     IF (CP-TRUNCATED-LIFE)
 13867        or ((pb-company-id = 'AHL')
 13868           and (pb-i-loan-term > pb-i-lf-term))
 13869        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13870
 13871     IF PB-COMPANY-ID EQUAL 'CRI'
 13872        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13873
 13874     IF CP-TERM-IS-DAYS
 13875         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13876     ELSE
 13877         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13878     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13879        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13880        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13881        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13882        IF WS-LF-BEN-CATEGORY = 'D'
 13883           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13884           MOVE PB-I-LIFE-COMMISSION
 13885                                 TO CP-DCC-ACT-COMM
 13886           MOVE WS-LF-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 253
* EL050.cbl
 13887                                 TO CP-BEN-CATEGORY
 13888        END-IF
 13889        IF (CP-BENEFIT-CD (1:1) = 'P')
 13890           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13891           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13892           add pb-i-ah-premium-amt to cp-original-premium
 13893        END-IF
 13894     END-IF
 13895     IF PB-COMPANY-ID = 'CSL'
 13896         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13897         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13898         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13899
 13900     IF PB-COMPANY-ID = 'CSL'
 13901        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13902
 13903     IF (CP-SPECIAL-CALC-CD = 'H')
 13904        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13905         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13906                                    TO CP-ALTERNATE-BENEFIT
 13907         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13908     if (pb-company-id = 'CID')
 13909        and (ws-lf-earnings-calc = '4')
 13910        and (cp-state-std-abbrv = 'MN' OR 'WA' or 'AL')
 13911        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13912        move pb-i-term-type      to cp-pmt-mode
 13913        move pb-i-no-of-payments to cp-no-of-pmts
 13914        move pb-i-ah-benefit-amt to cp-monthly-payment
 13915     end-if
 13916     move ws-net-only-state      to cp-net-only-state
 13917     IF (PB-COMPANY-ID = 'CID')
 13918        AND (WS-LF-EARNINGS-CALC = 'B')
 13919        AND (CP-STATE-STD-ABBRV = 'MN')
 13920        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13921                                 TO CP-ALTERNATE-BENEFIT
 13922        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13923     END-IF
 13924     IF (PB-COMPANY-ID = 'CID')
 13925        AND (WS-LF-EARNINGS-CALC = 'B')
 13926        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13927                                 TO CP-ALTERNATE-BENEFIT
 13928        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13929        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13930*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13931*         pb-i-lf-alt-premium-amt
 13932        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13933        IF WS-LF-BEN-CATEGORY = 'P'
 13934           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13935        ELSE
 13936           IF WS-LF-BEN-CATEGORY = 'I'
 13937              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13938           END-IF
 13939        END-IF
 13940     END-IF
 13941     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13942     MOVE 'R'                   TO CP-RATE-FILE.
 13943     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13944
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 254
* EL050.cbl
 13945     IF CP-ERROR-RATE-NOT-FOUND
 13946        MOVE ER-2641            TO WS-ERROR
 13947        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13948        GO TO 3300-CHECK-AH-RATES.
 13949
 13950     IF PB-COMPANY-ID EQUAL 'CRI'
 13951        IF CP-ERROR-NO-LIMITS-CRI
 13952           IF NOT ACCOUNT-LIFE-CHECKED
 13953              MOVE ER-2607      TO WS-ERROR
 13954              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13955
 13956******************************************************************
 13957*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13958*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13959******************************************************************
 13960
 13961* CALC LIFE AGE AT EXPIRATION.
 13962
 13963     COMPUTE WS-AGE-AT-EXPIRE =
 13964          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13965
 13966*    IF PB-STATE = 'CO' OR 'UT'
 13967*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13968*        MOVE 'F'            TO PB-FATAL-FLAG
 13969*        MOVE ER-2709        TO WS-ERROR
 13970*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13971*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13972
 13973*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13974*        MOVE 'X'            TO PB-FATAL-FLAG
 13975*        MOVE ER-2718        TO WS-ERROR
 13976*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13977*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13978
 13979* CALC A & H AGE AT EXPIRATION.
 13980
 13981     COMPUTE WS-AGE-AT-EXPIRE =
 13982          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13983
 13984*    IF PB-STATE = 'CO' OR 'UT'
 13985*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13986*        MOVE 'F'            TO PB-FATAL-FLAG
 13987*        MOVE ER-2709        TO WS-ERROR
 13988*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13989*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13990
 13991*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13992*        MOVE 'X'            TO PB-FATAL-FLAG
 13993*        MOVE ER-2718        TO WS-ERROR
 13994*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13995*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13996
 13997     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13998        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13999
 14000     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14001        and (not pb-monthly-cert)
 14002        GO TO 3221-CHECK-ERROR-RATE-OPEN
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 255
* EL050.cbl
 14003     end-if
 14004
 14005     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14006        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 14007
 14008     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14009         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 14010         MOVE ER-2639        TO WS-ERROR
 14011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14012
 14013
 14014******************************************************************
 14015*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14016******************************************************************
 14017
 14018 PREMIUM-EDITING-IS-BYPASSED.
 14019     IF (CP-R-MAX-ATT-AGE NUMERIC)
 14020        AND (CP-R-MAX-ATT-AGE > +0)
 14021        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 14022        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14023           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 14024           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14025           MOVE '1'              TO DC-OPTION-CODE
 14026           PERFORM 8500-DATE-CONVERT
 14027                                 THRU 8500-EXIT
 14028           IF NO-CONVERSION-ERROR
 14029              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14030                 MOVE ER-2661       TO WS-ERROR
 14031*                PERFORM 9900-ERROR-FORMAT
 14032*                                THRU 9900-EXIT
 14033              END-IF
 14034           END-IF
 14035        ELSE
 14036           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 14037           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14038              MOVE ER-2661       TO WS-ERROR
 14039*             PERFORM 9900-ERROR-FORMAT
 14040*                                THRU 9900-EXIT
 14041           ELSE
 14042              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14043                 MOVE ER-1570    TO WS-ERROR
 14044                 PERFORM 9900-ERROR-FORMAT
 14045                                 THRU 9900-EXIT
 14046              END-IF
 14047           END-IF
 14048        END-IF
 14049        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14050           MOVE PB-I-JOINT-BIRTHDAY
 14051                                 TO DC-BIN-DATE-1
 14052           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 14053           MOVE '1'              TO DC-OPTION-CODE
 14054           PERFORM 8500-DATE-CONVERT
 14055                                 THRU 8500-EXIT
 14056           IF NO-CONVERSION-ERROR
 14057              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14058                 MOVE ER-2661       TO WS-ERROR
 14059*                PERFORM 9900-ERROR-FORMAT
 14060*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 256
* EL050.cbl
 14061              END-IF
 14062           ELSE
 14063              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 14064           END-IF
 14065        ELSE
 14066           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14067             (PB-I-LF-TERM / 12)
 14068           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14069              MOVE ER-2661       TO WS-ERROR
 14070*             PERFORM 9900-ERROR-FORMAT
 14071*                                THRU 9900-EXIT
 14072           ELSE
 14073              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14074                 MOVE ER-1571    TO WS-ERROR
 14075                 PERFORM 9900-ERROR-FORMAT
 14076                                 THRU 9900-EXIT
 14077              END-IF
 14078           END-IF
 14079        END-IF
 14080        IF WS-ERROR = ER-2661
 14081           PERFORM 9900-ERROR-FORMAT
 14082                                 THRU 9900-EXIT
 14083        END-IF
 14084     END-IF
 14085*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14086*       MOVE ER-2661             TO WS-ERROR
 14087*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14088
 14089     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14090        MOVE ER-2662             TO WS-ERROR
 14091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14092
 14093     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14094        MOVE ER-2677             TO WS-ERROR
 14095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14096
 14097     IF CP-ERROR-LOAN-TERM
 14098        MOVE ER-2648             TO WS-ERROR
 14099        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14100
 14101 3221-CHECK-ERROR-RATE-OPEN.
 14102
 14103     IF CP-ERROR-RATE-FILE-NOTOPEN
 14104         GO TO 3990-FILES-NOT-OPEN.
 14105
 14106     IF PB-COMPANY-ID NOT = 'DMD'
 14107        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 14108     END-IF
 14109     .
 14110 3221-CONTINUE.
 14111     MOVE ZEROS                  TO WS-DCC-LF-RATE
 14112                                    WS-DCC-AH-RATE
 14113     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14114        IF WS-LF-BEN-CATEGORY = 'D'
 14115           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 14116              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14117        END-IF
 14118     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 257
* EL050.cbl
 14119     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 14120*   X'A4FF' = 12/31/2009
 14121     IF (PB-COMPANY-ID = 'CID')
 14122        AND (WS-LF-EARNINGS-CALC = 'B')
 14123        AND (CP-STATE-STD-ABBRV = 'MN')
 14124        AND (PB-CERT-EFF-DT > X'A4FF')
 14125        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 14126     END-IF
 14127     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 14128
 14129     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 14130     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14131        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14132        AND (PB-I-POLICY-IS-MONTHLY)
 14133        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 14134        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 14135     END-IF
 14136     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 14137     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 14138     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 14139     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 14140     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14141        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 14142        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14143        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 14144        MOVE ER-2786             TO WS-ERROR
 14145        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14146     END-IF
 14147
 14148     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 14149
 14150******************************************************************
 14151*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 14152******************************************************************
 14153     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14154        and ((not pb-monthly-cert)
 14155        or (ws-lf-ben-category = 'C'))
 14156        GO TO 3225-CHECK-ALT-LIFE-RATE.
 14157
 14158     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14159        GO TO 3225-CHECK-ALT-LIFE-RATE
 14160     ELSE
 14161       IF PB-I-LF-RATE = ZERO
 14162          MOVE ER-2641          TO WS-ERROR
 14163          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14164
 14165 3225-CHECK-ALT-LIFE-RATE.
 14166
 14167     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14168        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14169        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14170         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14171
 14172     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 14173         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 14174             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14175                   OR
 14176              (PB-I-LF-ALT-PREMIUM-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 258
* EL050.cbl
 14177              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 14178              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 14179             MOVE ER-2720        TO  WS-ERROR
 14180             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14181             GO TO 3225-RATING-CONT
 14182         ELSE
 14183             GO TO 3225-RATING-CONT.
 14184     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 14185        AND (AM-GPCD = 01 OR 06 OR 15)
 14186        MOVE ER-2798             TO WS-ERROR
 14187        PERFORM 9900-ERROR-FORMAT
 14188                                 THRU 9900-EXIT
 14189*       GO TO 3225-RATING-CONT
 14190     END-IF
 14191     if (pb-company-id = 'CID')
 14192        and (ws-lf-earnings-calc = 'B')
 14193        and (ws-lf-ben-category = 'P' or 'I')
 14194        and (ws-net-only-state = 'Y')
 14195        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 14196*       display ' balloon prem ' pb-i-lf-alt-prem-calc
 14197        go to 3225-rating-cont
 14198     end-if
 14199     IF (PB-COMPANY-ID = 'CID')
 14200        AND (WS-LF-EARNINGS-CALC = 'B')
 14201        AND (CP-STATE-STD-ABBRV = 'MN')
 14202        AND (PB-CERT-EFF-DT > X'A4FF')
 14203        GO TO 3225-RATING-CONT
 14204     END-IF
 14205     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14206        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14207           AND (PB-I-POLICY-IS-MONTHLY)
 14208           GO TO 3225-RATING-CONT
 14209        END-IF
 14210     END-IF
 14211
 14212     IF PB-COMPANY-ID EQUAL 'WDS' AND
 14213        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 14214        CP-EARN-AS-REG-BALLOON
 14215        NEXT SENTENCE
 14216     ELSE
 14217        MOVE '2'                 TO CP-EARNING-METHOD.
 14218
 14219 3225-SET-ALT-LIFE-RATE-LOOKUP.
 14220
 14221     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14222
 14223     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 14224        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 14225        (CP-SPECIAL-CALC-CD EQUAL 'H')
 14226         NEXT SENTENCE
 14227     ELSE
 14228         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 14229
 14230     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14231     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14232     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14233                                     CP-RATING-BENEFIT-AMT.
 14234     IF CP-STATE-STD-ABBRV = 'OR'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 259
* EL050.cbl
 14235         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14236                                         PB-I-LF-ALT-BENEFIT-AMT.
 14237     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14238        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14239     END-IF
 14240     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14241     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14242     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14243                                    CP-REMAINING-TERM
 14244                                    CP-LOAN-TERM.
 14245     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14246        ADD +1                   TO CP-ORIGINAL-TERM
 14247                                    CP-REMAINING-TERM
 14248                                    CP-LOAN-TERM.
 14249
 14250     MOVE 'R'                   TO CP-RATE-FILE.
 14251     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14252
 14253     IF CP-ERROR-RATE-NOT-FOUND
 14254         MOVE ER-2641            TO WS-ERROR
 14255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14256         GO TO 3300-CHECK-AH-RATES.
 14257
 14258     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 14259     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 14260
 14261     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 14262         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 14263
 14264     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 14265                               + PB-I-LF-ALT-BENEFIT-AMT.
 14266
 14267     IF ACCOUNT-LIFE-CHECKED  OR
 14268        PB-POLICY-IS-VOIDED   OR
 14269        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 14270        and (not pb-monthly-cert))
 14271        GO TO 3225-CONTINUE.
 14272
 14273     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14274        GO TO 3225-CONTINUE.
 14275
 14276     IF WS-LF-BENEFIT-AMT  GREATER THAN
 14277                             EC-RT-LF-MAX-TOT-BEN
 14278        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 14279        MOVE ER-2639       TO WS-ERROR
 14280        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14281
 14282 3225-CONTINUE.
 14283     IF PB-I-LF-ALT-RATE = ZERO
 14284         MOVE ER-2659            TO WS-ERROR
 14285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14286
 14287     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 14288        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 14289        MOVE ER-2698             TO WS-ERROR
 14290        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14291
 14292 3225-RATING-CONT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 260
* EL050.cbl
 14293
 14294     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 14295        and (not pb-monthly-cert)
 14296         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14297         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14298         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14299            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14300            CONTINUE
 14301         ELSE
 14302            MOVE ER-2687         TO WS-ERROR
 14303            PERFORM 9900-ERROR-FORMAT
 14304                                 THRU 9900-EXIT
 14305         END-IF
 14306         GO TO 3290-EDIT-LF-REIN-RATE
 14307     END-IF
 14308
 14309* DMD RATING TEST
 14310     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 14311         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 14312         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 14313         MOVE ER-2687                 TO WS-ERROR
 14314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14315         GO TO 3290-EDIT-LF-REIN-RATE.
 14316
 14317 3230-CLIENT-MORT-CD-SPECIALS.
 14318
 14319     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 14320     SET BIN-TO-GREG          TO TRUE.
 14321*    MOVE ' '                 TO DC-OPTION-CODE.
 14322     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14323     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 14324
 14325 C-POS-3230-MORT-CD.
 14326     IF PB-COMPANY-ID = 'POS' AND
 14327        PB-SV-CARRIER = '2'
 14328         NEXT SENTENCE
 14329     ELSE
 14330         GO TO C-POS-3240-MORT-CD.
 14331
 14332     IF PB-SV-GROUPING = '030'
 14333        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 14334         MOVE '2350' TO PB-I-MORT-CODE
 14335      ELSE
 14336         MOVE '3300' TO PB-I-MORT-CODE.
 14337
 14338
 14339 C-POS-3240-MORT-CD.
 14340     IF PB-COMPANY-ID = 'POS' AND
 14341        PB-SV-CARRIER = '1'
 14342         NEXT SENTENCE
 14343     ELSE
 14344         GO TO 3230-CONTINUE.
 14345
 14346     IF PB-SV-STATE = '45' OR '47'
 14347        OR PB-CERT-EFF-DT LESS THAN WS-771001
 14348         MOVE '5200' TO PB-I-MORT-CODE
 14349     ELSE
 14350         MOVE '8300' TO PB-I-MORT-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 261
* EL050.cbl
 14351
 14352 3230-CONTINUE.
 14353
 14354     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 14355        GO TO 3240-CONTINUE
 14356     END-IF
 14357
 14358     IF PB-CERT-EFF-DT > WS-971231
 14359        GO TO 3240-CONTINUE
 14360     END-IF
 14361
 14362     IF LF-BENEFIT-FOUND AND
 14363        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 14364         MOVE 'F250'       TO PB-I-MORT-CODE
 14365     ELSE
 14366         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 14367             MOVE '7250'   TO PB-I-MORT-CODE
 14368         ELSE
 14369             MOVE '4251'   TO PB-I-MORT-CODE
 14370         END-IF
 14371     END-IF
 14372
 14373     .
 14374 3240-CONTINUE.
 14375
 14376     IF PB-COMPANY-ID NOT = 'GNL'
 14377         GO TO 3256-CONTINUE.
 14378
 14379     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 14380         MOVE 'A300' TO PB-I-MORT-CODE
 14381     ELSE
 14382         MOVE '8350' TO PB-I-MORT-CODE.
 14383
 14384 3256-CONTINUE.
 14385     IF PB-COMPANY-ID NOT = 'ABL'
 14386         GO TO 3260-EDIT-CONTINUE.
 14387
 14388     IF PB-I-LF-TERM GREATER THAN 59
 14389         MOVE 'F550' TO PB-I-MORT-CODE
 14390     ELSE
 14391         MOVE 'E550' TO PB-I-MORT-CODE.
 14392
 14393 3260-EDIT-CONTINUE.
 14394     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 14395
 14396 3290-EDIT-LF-REIN-RATE.
 14397     IF LF-REIN-NSP-NOT-USED
 14398         GO TO 3290-RATING-CONT.
 14399
 14400     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14401        GO TO 3290-RATING-CONT.
 14402     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 14403     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14404     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 14405     MOVE '3'                   TO CP-PROCESS-TYPE.
 14406     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14407
 14408******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 262
* EL050.cbl
 14409     IF PB-COMPANY-ID EQUAL 'CDL'
 14410         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14411            CP-EARN-AS-NET-PAY)
 14412             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 14413*            MOVE SPACE          TO DC-OPTION-CODE
 14414             SET BIN-TO-GREG     TO TRUE
 14415             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 14416***  Y2K PROJ 7744
 14417             IF DC-GREG-DATE-CYMD GREATER 19931231
 14418                 MOVE '1'        TO CP-EARNING-METHOD.
 14419***  Y2K PROJ 7744
 14420*******
 14421
 14422     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14423     MOVE PB-SV-STATE           TO CP-STATE.
 14424     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 14425     MOVE ZERO                  TO CP-DEVIATION-CODE
 14426                                   CP-RATE-DEV-PCT.
 14427     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 14428     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 14429                                   CP-RATING-BENEFIT-AMT.
 14430
 14431************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 14432     IF PB-COMPANY-ID EQUAL 'NCB'
 14433         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 14434            CP-EARN-AS-NET-PAY
 14435             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14436                 PB-I-LF-PREMIUM-AMT.
 14437************
 14438
 14439     IF CP-STATE-STD-ABBRV = 'OR'
 14440         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14441                                         PB-I-LF-ALT-BENEFIT-AMT.
 14442     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 14443     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 14444     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 14445     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 14446     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 14447     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 14448     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 14449     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 14450                                   CP-REMAINING-TERM
 14451                                   CP-LOAN-TERM.
 14452     IF CP-TRUNCATED-LIFE
 14453        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 14454
 14455     IF CP-TERM-IS-DAYS
 14456         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 14457     ELSE
 14458         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14459
 14460     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14461        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14462     END-IF
 14463     IF PB-COMPANY-ID NOT = 'TIC'
 14464          MOVE ZERO          TO CP-CLASS-CODE.
 14465
 14466     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 263
* EL050.cbl
 14467
 14468     MOVE 'R'                   TO CP-RATE-FILE.
 14469     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14470
 14471     IF CP-ERROR-RATE-NOT-FOUND
 14472        IF PB-I-OB
 14473           MOVE ER-2625      TO WS-ERROR
 14474           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14475           GO TO 3299-EDIT-CONTINUE
 14476        ELSE
 14477           MOVE ER-2643      TO WS-ERROR
 14478           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14479           GO TO 3299-EDIT-CONTINUE.
 14480
 14481     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14482
 14483     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14484     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14485
 14486     IF PB-I-LF-REI-RATE = ZERO
 14487         MOVE ER-2643        TO WS-ERROR
 14488         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14489
 14490 3290-CHECK-ALT-REIN-RATE.
 14491
 14492     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14493        GO TO 3290-RATING-CONT.
 14494
 14495     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14496     MOVE '2'                    TO CP-EARNING-METHOD.
 14497     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14498     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14499     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14500     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14501                                     CP-RATING-BENEFIT-AMT.
 14502     IF CP-STATE-STD-ABBRV = 'OR'
 14503         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14504                                         PB-I-LF-ALT-BENEFIT-AMT.
 14505     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14506        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14507     END-IF
 14508     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14509     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14510     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14511                                    CP-REMAINING-TERM
 14512                                    CP-LOAN-TERM.
 14513     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14514        ADD +1                   TO CP-ORIGINAL-TERM
 14515                                    CP-REMAINING-TERM
 14516                                    CP-LOAN-TERM.
 14517
 14518     MOVE 'R'                   TO CP-RATE-FILE.
 14519     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14520
 14521     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14522
 14523     IF PB-I-LF-ALT-REI-RATE = ZERO
 14524         MOVE ER-2643            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 264
* EL050.cbl
 14525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14526
 14527 3290-RATING-CONT.
 14528
 14529     IF PB-I-OB
 14530*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14531        GO TO 3300-CHECK-AH-RATES.
 14532
 14533 3299-EDIT-CONTINUE.
 14534
 14535     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14536         NEXT SENTENCE
 14537     ELSE
 14538         MOVE ER-2620           TO WS-ERROR
 14539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14540
 14541 3300-CHECK-AH-RATES.
 14542     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14543         NEXT SENTENCE
 14544     ELSE
 14545         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14546
 14547     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14548        and (not pb-monthly-cert))
 14549                  or
 14550        ((CF-COMPANY-ID = 'DMD') AND
 14551                (NO-DMD-RATING))
 14552         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14553            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14554            CONTINUE
 14555         ELSE
 14556            MOVE ER-2687         TO WS-ERROR
 14557            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14558         END-IF
 14559         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14560         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14561     END-IF
 14562
 14563     IF PB-I-OB
 14564        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14565
 14566     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14567         MOVE ER-2687             TO WS-ERROR
 14568         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14569         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14570         GO TO 3999-END-EDIT.
 14571
 14572*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14573     if pb-company-id = 'AHL'
 14574        go to 3300-skip-crit-per
 14575     end-if
 14576     if (pb-i-ah-crit-per not = zeros)
 14577        and (ws-ah-special-calc-cd not = 'C')
 14578        MOVE ER-1572             TO WS-ERROR
 14579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14580        go to 3300-skip-crit-per
 14581     END-IF
 14582     if (pb-company-id = 'DCC' or 'VPP')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 265
* EL050.cbl
 14583        and (am-dcc-product-code not = spaces)
 14584        go to 3300-skip-crit-per
 14585     end-if
 14586     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14587        IF PB-I-AH-CRIT-PER = ZERO
 14588           move ws-ah-max-bens   to pb-i-ah-crit-per
 14589*          MOVE ER-2618       TO WS-ERROR
 14590*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14591*          GO TO 3999-END-EDIT
 14592        END-IF
 14593     END-IF
 14594     if (ws-ah-special-calc-cd = 'C')
 14595        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14596        MOVE ER-1576             TO WS-ERROR
 14597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14598     end-if
 14599
 14600     .
 14601 3300-skip-crit-per.
 14602     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14603     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14604     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14605     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14606     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14607     MOVE PB-SV-STATE            TO CP-STATE.
 14608     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14609     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14610     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14611*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14612     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14613     MOVE '3'                    TO CP-PROCESS-TYPE.
 14614     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14615     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14616                                    CP-RATING-BENEFIT-AMT.
 14617     IF PB-COMPANY-ID = 'CID'
 14618               OR
 14619        CP-STATE-STD-ABBRV = 'OR'
 14620         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14621                                         PB-I-AH-TERM.
 14622     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14623        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14624           AND (PB-I-POLICY-IS-MONTHLY)
 14625           MOVE PB-I-LF-BENEFIT-AMT
 14626                                 TO CP-NET-BENEFIT-AMT
 14627           move pb-i-ah-premium-amt to cp-original-premium
 14628           add pb-i-lf-premium-amt to cp-original-premium
 14629        END-IF
 14630     END-IF
 14631     MOVE SPACES                 TO CP-BEN-CATEGORY
 14632     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14633        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14634        EVALUATE TRUE
 14635           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14636              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14637              MOVE PB-I-LF-BENEFIT-AMT
 14638                                 TO CP-RATING-BENEFIT-AMT
 14639              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14640           WHEN WS-AH-BEN-CATEGORY = 'G'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 266
* EL050.cbl
 14641              MOVE PB-I-UNPAID-CASH-PRICE
 14642                                 TO CP-RATING-BENEFIT-AMT
 14643           WHEN WS-AH-BEN-CATEGORY = 'D'
 14644              MOVE WS-AH-PMF-COMM
 14645                                 TO CP-DCC-PMF-COMM
 14646              MOVE PB-I-AH-COMMISSION
 14647                                 TO CP-DCC-ACT-COMM
 14648        END-EVALUATE
 14649     END-IF
 14650     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14651     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14652     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14653     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14654     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14655     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14656     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14657                                    CP-REMAINING-TERM
 14658                                    WS-WORK-TERM.
 14659     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14660
 14661     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14662     SET BIN-TO-GREG             TO TRUE.
 14663*    MOVE ' '                    TO DC-OPTION-CODE.
 14664     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14665     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE
 14666
 14667     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14668     IF NOT VALID-SKIP-CODE
 14669         MOVE ER-2683            TO WS-ERROR
 14670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14671         GO TO 3320-RATE-CONTINUE.
 14672
 14673     IF PB-NO-MONTHS-SKIPPED
 14674         GO TO 3320-RATE-CONTINUE.
 14675
 14676     MOVE SPACE TO NUMBER-OF-MONTHS.
 14677
 14678     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14679         MOVE 'S'                TO SK-MO (6).
 14680     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14681         MOVE 'S'                TO SK-MO (7).
 14682     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14683         MOVE 'S'                TO SK-MO (8).
 14684     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14685         MOVE 'S'                TO SK-MO (9).
 14686     IF PB-I-SKIP-CODE = 'A'
 14687         MOVE 'S'                TO SK-MO (10).
 14688
 14689     MOVE 1                      TO SUB2.
 14690     MOVE PB-I-AH-TERM           TO SUB3.
 14691     MOVE WS-MONTH               TO SUB1.
 14692     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14693     GO TO 3320-RATE-CONTINUE.
 14694
 14695 3310-GET-SKIP-MO.
 14696     IF SUB1 = 13
 14697         MOVE 1                  TO SUB1.
 14698
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 267
* EL050.cbl
 14699     IF SK-MO (SUB1) = 'S'
 14700         SUBTRACT 1 FROM WS-WORK-TERM.
 14701
 14702     ADD 1 TO SUB2
 14703              SUB1.
 14704
 14705 3320-RATE-CONTINUE.
 14706
 14707     IF WS-WORK-TERM = ZERO
 14708         MOVE 1                  TO WS-WORK-TERM.
 14709
 14710     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14711                                    CP-LOAN-TERM.
 14712
 14713     IF PB-COMPANY-ID EQUAL 'DMD'
 14714         NEXT SENTENCE
 14715     ELSE
 14716         MOVE ZERO               TO PB-I-AH-RATE
 14717                                    PB-I-AH-REI-RATE.
 14718
 14719
 14720     IF PB-COMPANY-ID EQUAL 'CRI'
 14721        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14722
 14723     IF PB-COMPANY-ID = 'CSL'
 14724         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14725         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14726         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14727         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14728
 14729     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14730        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14731           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14732              PB-I-RATE-DEV-PCT-LF
 14733        END-IF
 14734        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14735                                 TO CP-ALTERNATE-BENEFIT
 14736        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14737        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14738        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14739     END-IF
 14740*    if ws-clp-state not = spaces
 14741*       move ws-clp-state to cp-state
 14742*    end-if
 14743     IF (PB-COMPANY-ID = 'CID')
 14744        AND (WS-LF-EARNINGS-CALC = 'B')
 14745        AND (CP-STATE-STD-ABBRV = 'MN')
 14746        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14747     ELSE
 14748        MOVE ' '                 TO CP-AH-BALLOON-SW
 14749     END-IF
 14750     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14751     MOVE 'R'                   TO CP-RATE-FILE.
 14752     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14753
 14754     IF (CP-ERROR-RATE-NOT-FOUND)
 14755        and (not pb-monthly-cert)
 14756        IF PB-I-OB
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 268
* EL050.cbl
 14757           MOVE ER-2624          TO WS-ERROR
 14758           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14759           GO TO 3340-CALCULATE-PREMIUM-AMT
 14760        ELSE
 14761          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14762              NEXT SENTENCE
 14763          ELSE
 14764           MOVE ER-2642          TO WS-ERROR
 14765           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14766           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14767
 14768     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14769        CP-ERROR-DIV-BY-ZERO
 14770           MOVE ER-3782          TO WS-ERROR
 14771           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14772
 14773     IF PB-COMPANY-ID EQUAL 'CRI'
 14774        IF CP-ERROR-NO-LIMITS-CRI
 14775           IF NOT ACCOUNT-AH-CHECKED
 14776              MOVE ER-2607          TO WS-ERROR
 14777              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14778
 14779     IF ACCOUNT-AH-CHECKED
 14780        NEXT SENTENCE
 14781     ELSE
 14782       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14783          MOVE ER-2640           TO WS-ERROR
 14784          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14785
 14786     IF PB-COMPANY-ID = 'CRI'
 14787         IF WS-ERROR = ER-2640
 14788             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14789     IF ACCOUNT-AH-CHECKED
 14790        CONTINUE
 14791     ELSE
 14792        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14793           AND (CP-R-MAX-ATT-AGE > +0)
 14794           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14795           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14796              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14797              MOVE PB-I-AH-EXPIRE-DT
 14798                                 TO DC-BIN-DATE-2
 14799              MOVE '1'           TO DC-OPTION-CODE
 14800              PERFORM 8500-DATE-CONVERT
 14801                                 THRU 8500-EXIT
 14802              IF NO-CONVERSION-ERROR
 14803                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14804                    MOVE ER-2661       TO WS-ERROR
 14805*                   PERFORM 9900-ERROR-FORMAT
 14806*                                THRU 9900-EXIT
 14807                 END-IF
 14808              END-IF
 14809           ELSE
 14810              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14811              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14812                 MOVE ER-2661    TO WS-ERROR
 14813*                PERFORM 9900-ERROR-FORMAT
 14814*                                THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 269
* EL050.cbl
 14815              ELSE
 14816                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14817                    MOVE ER-1570 TO WS-ERROR
 14818                    PERFORM 9900-ERROR-FORMAT
 14819                                 THRU 9900-EXIT
 14820                 END-IF
 14821              END-IF
 14822           END-IF
 14823           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14824              MOVE PB-I-JOINT-BIRTHDAY
 14825                                    TO DC-BIN-DATE-1
 14826              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14827              MOVE '1'              TO DC-OPTION-CODE
 14828              PERFORM 8500-DATE-CONVERT
 14829                                    THRU 8500-EXIT
 14830              IF NO-CONVERSION-ERROR
 14831                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14832                    MOVE ER-2661       TO WS-ERROR
 14833*                   PERFORM 9900-ERROR-FORMAT
 14834*                                   THRU 9900-EXIT
 14835                 END-IF
 14836              END-IF
 14837           ELSE
 14838              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14839                (PB-I-AH-TERM / 12)
 14840              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14841                 MOVE ER-2661       TO WS-ERROR
 14842*                PERFORM 9900-ERROR-FORMAT
 14843*                                   THRU 9900-EXIT
 14844              ELSE
 14845                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14846                    MOVE ER-1571 TO WS-ERROR
 14847                    PERFORM 9900-ERROR-FORMAT
 14848                                 THRU 9900-EXIT
 14849                 END-IF
 14850              END-IF
 14851           END-IF
 14852           IF WS-ERROR = ER-2661
 14853              PERFORM 9900-ERROR-FORMAT
 14854                                    THRU 9900-EXIT
 14855           END-IF
 14856        END-IF
 14857     END-IF
 14858*    IF ACCOUNT-AH-CHECKED
 14859*       NEXT SENTENCE
 14860*    ELSE
 14861*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14862*          MOVE ER-2661          TO WS-ERROR
 14863*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14864
 14865     IF ACCOUNT-AH-CHECKED
 14866        NEXT SENTENCE
 14867     ELSE
 14868        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14869           MOVE ER-2663          TO WS-ERROR
 14870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14871
 14872     IF ACCOUNT-AH-CHECKED OR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 270
* EL050.cbl
 14873        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14874         PB-POLICY-IS-VOIDED
 14875        NEXT SENTENCE
 14876     ELSE
 14877        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 14878           MOVE ER-2667            TO WS-ERROR
 14879           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14880
 14881     IF PB-COMPANY-ID = 'CRI'
 14882         IF WS-ERROR = ER-2667
 14883             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14884
 14885     IF ACCOUNT-AH-CHECKED
 14886        NEXT SENTENCE
 14887     ELSE
 14888        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14889           MOVE ER-2678            TO WS-ERROR
 14890           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14891
 14892     IF CP-ERROR-RATE-FILE-NOTOPEN
 14893         GO TO 3990-FILES-NOT-OPEN.
 14894
 14895 3321-CONTINUE.
 14896     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14897     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14898     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14899*    IF (PB-COMPANY-ID = 'DCC')
 14900        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14901        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14902                                    PB-I-LF-ALT-PREM-CALC
 14903        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14904        IF WS-AH-BEN-CATEGORY = 'G'
 14905           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14906           + PB-I-ADDL-CLP)
 14907           * (1 + WS-TOL-CLP-PCT)
 14908*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14909        ELSE
 14910           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14911           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14912*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14913        END-IF
 14914        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14915                                 TO PB-I-AH-PREM-CALC
 14916        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14917           MOVE ER-8152          TO WS-ERROR
 14918           PERFORM 9900-ERROR-FORMAT
 14919                                 THRU 9900-EXIT
 14920        ELSE
 14921           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14922                 PB-I-ADDL-CLP)
 14923              MOVE ER-8148       TO WS-ERROR
 14924              PERFORM 9900-ERROR-FORMAT
 14925                                 THRU 9900-EXIT
 14926           END-IF
 14927        END-IF
 14928     END-IF
 14929     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14930        AND (PB-I-POLICY-IS-MONTHLY)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 271
* EL050.cbl
 14931        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14932        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14933        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14934           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14935        END-IF
 14936     END-IF
 14937     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14938        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14939        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14940        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14941        MOVE ER-2786             TO WS-ERROR
 14942        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14943     END-IF
 14944     MOVE +0                     TO PB-I-AH-CLP
 14945     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14946        evaluate true
 14947           when WS-AH-BEN-CATEGORY = 'D'
 14948              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14949                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14950           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14951              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14952           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14953              compute ws-cred-union-fees rounded =
 14954                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14955                    pb-i-ah-commission)
 14956              COMPUTE PB-I-AH-CLP =
 14957                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14958        end-evaluate
 14959     END-IF
 14960     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14961
 14962     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14963         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14964
 14965     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14966         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14967
 14968     if (ws-ah-special-calc-cd = 'E')
 14969        and (pb-monthly-cert)
 14970        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14971     end-if
 14972     IF PB-COMPANY-ID = 'CRI'
 14973         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14974            PB-I-PAYMENT-AMOUNT = ZERO
 14975             NEXT SENTENCE
 14976         ELSE
 14977             COMPUTE PB-I-AH-PREM-CALC =
 14978                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14979                 (CP-PREMIUM-RATE / 100)
 14980             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14981                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14982                                             PB-I-RATE-DEV-PCT-AH.
 14983
 14984     IF (PB-I-AH-RATE  = ZERO)
 14985        and (not pb-monthly-cert)
 14986       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14987           NEXT SENTENCE
 14988       ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 272
* EL050.cbl
 14989         MOVE ER-2642            TO WS-ERROR
 14990         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14991
 14992     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14993     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14994     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14995     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14996     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14997     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14998
 14999     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15000        AND (WS-AH-BEN-CATEGORY = 'G')
 15001        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15002        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 15003        IF CP-DEVIATION-CODE NOT = '000'
 15004           MOVE '000'            TO CP-DEVIATION-CODE
 15005           PERFORM 7000-GET-RATE THRU 7000-EXIT
 15006           IF NO-CP-ERROR
 15007              COMPUTE PB-I-DDF-IU-RATE-UP =
 15008              PB-I-AH-CLP - CP-CALC-PREMIUM
 15009           ELSE
 15010              MOVE ER-3057        TO WS-ERROR
 15011              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15012           END-IF
 15013        END-IF
 15014     END-IF
 15015     .
 15016 3335-EDIT-AH-REIN-NSP-RATE.
 15017     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15018        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 15019              compute ws-cred-union-fees rounded =
 15020                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 15021                    pb-i-ah-commission)
 15022              COMPUTE PB-I-AH-CLP =
 15023                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 15024        end-if
 15025     END-IF
 15026     IF AH-REIN-NSP-NOT-USED
 15027         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15028
 15029     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 15030     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15031         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15032     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 15033     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 15034     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 15035     MOVE PB-SV-STATE            TO CP-STATE.
 15036     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15037     MOVE ZERO                   TO CP-DEVIATION-CODE
 15038                                    CP-RATE-DEV-PCT.
 15039*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 15040     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15041     MOVE '3'                    TO CP-PROCESS-TYPE.
 15042     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 15043     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15044                                    CP-RATING-BENEFIT-AMT.
 15045     IF CP-STATE-STD-ABBRV = 'OR'
 15046         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 273
* EL050.cbl
 15047                                         PB-I-AH-TERM.
 15048     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 15049     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15050     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15051     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15052     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15053     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 15054                                    CP-REMAINING-TERM
 15055                                    WS-WORK-TERM.
 15056     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 15057     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15058        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15059     END-IF
 15060     IF  PB-COMPANY-ID = 'TIC'
 15061         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 15062            MOVE ZERO TO CP-CLASS-CODE.
 15063
 15064     IF PB-COMPANY-ID NOT = 'TIC'
 15065          MOVE ZERO          TO CP-CLASS-CODE.
 15066
 15067     MOVE ZERO               TO CP-DEVIATION-CODE.
 15068
 15069     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 15070
 15071     MOVE ZERO               TO PB-I-AH-REI-RATE.
 15072
 15073     MOVE 'R'                   TO CP-RATE-FILE.
 15074     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 15075
 15076     IF CP-ERROR-RATE-NOT-FOUND
 15077         MOVE ER-2645        TO WS-ERROR
 15078         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15079         GO TO 3340-CALCULATE-PREMIUM-AMT.
 15080
 15081     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 15082
 15083     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 15084     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 15085
 15086     IF PB-I-AH-REI-RATE = ZERO
 15087         MOVE ER-2645        TO WS-ERROR
 15088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15089
 15090
 15091 3340-CALCULATE-PREMIUM-AMT.
 15092     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15093     SET BIN-TO-GREG             TO TRUE
 15094     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 15095     move dc-greg-date-a-edit    to ws-greg-eff-date
 15096
 15097     IF PB-COMPANY-ID = 'NCL'
 15098         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 15099             WS-AH-SPECIAL-CALC-CD = 'O')
 15100             GO TO 3999-END-EDIT.
 15101
 15102     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 15103                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 15104                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 274
* EL050.cbl
 15105                         OR 'AHL'
 15106         NEXT SENTENCE
 15107     ELSE
 15108         IF WS-STATE-ABBREVIATION = 'CT'
 15109             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 15110                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 15111                 COMPUTE PB-I-LF-PREM-CALC =
 15112                                     PB-I-LF-PREM-CALC * .90
 15113                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 15114                                     PB-I-LF-ALT-PREM-CALC * .90
 15115                 COMPUTE PB-I-AH-PREM-CALC =
 15116                                     PB-I-AH-PREM-CALC * .90.
 15117
 15118     IF PB-COMP-LF-PREM
 15119        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 15120        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 15121
 15122     IF PB-COMP-AH-PREM
 15123        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 15124
 15125 3340-CHECK-DCC-TOT-FEES.
 15126     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 15127        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 15128        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 15129        AND (PB-I-POLICY-IS-MONTHLY)
 15130        CONTINUE
 15131     ELSE
 15132        GO TO 3340-EDIT-LF-AH-TOL
 15133     END-IF
 15134     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 15135     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 15136     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 15137        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 15138           PB-I-RATE-DEV-PCT-LF
 15139     END-IF
 15140     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 15141        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 15142           PB-I-RATE-DEV-PCT-AH
 15143     END-IF
 15144     MOVE 'N'                    TO CP-BEN-CATEGORY
 15145     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15146
 15147     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 15148     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 15149     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 15150     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15151     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15152     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15153     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15154     MOVE '3'                    TO CP-PROCESS-TYPE.
 15155     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15156     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 15157
 15158     MOVE PB-SV-STATE            TO CP-STATE.
 15159     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 15160     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 15161     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 15162     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 275
* EL050.cbl
 15163     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 15164                                    CP-RATING-BENEFIT-AMT.
 15165     IF CP-STATE-STD-ABBRV = 'OR'
 15166         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 15167                                         PB-I-LF-ALT-BENEFIT-AMT.
 15168     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 15169     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 15170     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 15171     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15172     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15173     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15174     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 15175     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 15176     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 15177                                    CP-REMAINING-TERM
 15178                                    CP-LOAN-TERM.
 15179     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 15180        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 15181           PB-I-LF-PREMIUM-AMT
 15182     end-if
 15183
 15184     IF CP-TRUNCATED-LIFE
 15185        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 15186
 15187     IF CP-TERM-IS-DAYS
 15188         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 15189     ELSE
 15190         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15191
 15192     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 15193     IF CP-SPECIAL-CALC-CD = 'H'
 15194         MOVE PB-I-LF-ALT-BENEFIT-AMT
 15195                                    TO CP-ALTERNATE-BENEFIT
 15196         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 15197     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 15198     MOVE 'R'                    TO CP-RATE-FILE
 15199     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 15200     IF NOT CP-ERROR-RATE-NOT-FOUND
 15201        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 15202        IF (CP-DCC-LF-RATE NOT = ZEROS)
 15203           AND (CP-BENEFIT-CD (1:1) = 'S')
 15204           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 15205                                    PB-I-LF-PREMIUM-AMT
 15206        END-IF
 15207     ELSE
 15208        MOVE +0                  TO PB-I-TOT-FEES-CALC
 15209     END-IF
 15210     .
 15211 3340-EDIT-LF-AH-TOL.
 15212
 15213***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 15214***    UNSIGN-WRK2    =    AH   DIFFERENCE
 15215***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 15216***
 15217     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 15218         PB-I-AH-PREMIUM-AMT
 15219          GIVING WS-CALC-WORK.
 15220
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 276
* EL050.cbl
 15221     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 15222        AND WS-CALC-WORK NOT = ZERO
 15223         MOVE ER-2649            TO WS-ERROR
 15224         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15225
 15226     SUBTRACT PB-I-LF-PREM-CALC
 15227             FROM PB-I-LF-PREMIUM-AMT
 15228                 GIVING WS-UNSIGN-WRK1.
 15229
 15230     SUBTRACT PB-I-LF-ALT-PREM-CALC
 15231             FROM PB-I-LF-ALT-PREMIUM-AMT
 15232                 GIVING WS-UNSIGN-WRK4.
 15233
 15234     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 15235                                + WS-UNSIGN-WRK4.
 15236
 15237     SUBTRACT PB-I-AH-PREM-CALC
 15238             FROM PB-I-AH-PREMIUM-AMT
 15239                 GIVING WS-UNSIGN-WRK2.
 15240
 15241******************************************************************
 15242*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 15243******************************************************************
 15244
 15245     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15246         MOVE ZERO TO WS-UNSIGN-WRK1.
 15247
 15248     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15249         MOVE ZERO TO WS-UNSIGN-WRK2.
 15250
 15251     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 15252             GIVING WS-UNSIGN-WRK3.
 15253
 15254 3342-CONTINUE.
 15255
 15256     IF (PB-I-LF-RATE = ZERO  AND
 15257         PB-I-AH-RATE = ZERO)
 15258         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 15259            WS-AH-SPECIAL-CALC-CD = 'O'
 15260              NEXT SENTENCE
 15261         ELSE
 15262             GO TO 3345-EDIT-CONTINUE.
 15263
 15264     IF  PB-RECORD-BILL   =  'B' OR  'L'
 15265         NEXT SENTENCE
 15266     ELSE
 15267     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 15268        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 15269           IF (PB-REISSUED-CERT         OR
 15270               PB-POLICY-IS-DECLINED    OR
 15271               PB-POLICY-IS-VOIDED)
 15272              NEXT SENTENCE
 15273           ELSE
 15274              IF WS-PREM-REJECT-SW = SPACE
 15275                 MOVE ER-2652    TO WS-ERROR
 15276                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15277                 GO TO 3344-CHECK-AH
 15278              ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 277
* EL050.cbl
 15279                 MOVE ER-2650    TO WS-ERROR
 15280                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15281                 GO TO 3344-CHECK-AH.
 15282
 15283***
 15284***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 15285***
 15286
 15287     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 15288         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 15289            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15290             (1 + WS-TOL-LF-PREM-PCT)
 15291         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 15292            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 15293             (1 - WS-TOL-LF-PREM-PCT)
 15294     ELSE
 15295         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 15296         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 15297
 15298***
 15299***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 15300***
 15301
 15302     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 15303         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 15304          WS-TOL-LF-PREM.
 15305
 15306     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 15307         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 15308          WS-TOL-LF-PREM.
 15309
 15310     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15311        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 15312
 15313     IF PB-REISSUED-CERT
 15314        or PB-POLICY-IS-DECLINED
 15315        or PB-POLICY-IS-VOIDED
 15316        continue
 15317     ELSE
 15318        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15319              > WS-TOL-LF-HIGH-PREM-AMT)
 15320           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15321              < WS-TOL-LF-LOW-PREM-AMT))
 15322                      or
 15323           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15324              > WS-TOL-LF-HIGH-PREM-PCT)
 15325           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 15326              < WS-TOL-LF-LOW-PREM-PCT))
 15327           IF WS-PREM-REJECT-SW = SPACE
 15328              MOVE ER-2652       TO WS-ERROR
 15329              PERFORM 9900-ERROR-FORMAT
 15330                                 THRU 9900-EXIT
 15331           ELSE
 15332              MOVE ER-2650       TO WS-ERROR
 15333              PERFORM 9900-ERROR-FORMAT
 15334                                 THRU 9900-EXIT
 15335           end-if
 15336        end-if
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 278
* EL050.cbl
 15337     end-if
 15338
 15339*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 15340*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 15341*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15342*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15343
 15344     IF WS-ERROR  =  ER-2650  OR  ER-2652
 15345        IF (PB-RECORD-BILL   =  'B' OR  'L')
 15346                      OR
 15347           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 15348           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 15349           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15350           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 15351        END-IF
 15352     END-IF
 15353
 15354     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15355        IF WS-COMP-MAX-CAP GREATER THAN +0
 15356           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 15357              IF (PB-REISSUED-CERT         OR
 15358                  PB-POLICY-IS-DECLINED    OR
 15359                  PB-POLICY-IS-VOIDED)
 15360                 NEXT SENTENCE
 15361              ELSE
 15362                  MOVE ER-2646   TO  WS-ERROR
 15363                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15364
 15365 3344-CVL-TOLERANCE-CHECK.
 15366
 15367      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 15368          GO TO 3344-CHECK-AH.
 15369
 15370      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 15371          GO TO 3344-CHECK-AH.
 15372
 15373      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 15374                                     WS-UNSIGN-WRK6.
 15375
 15376      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15377          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 15378                                 + PB-I-LF-PREMIUM-AMT
 15379                                 - PB-I-LF-PREM-CALC.
 15380
 15381      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 15382          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 15383                                 + PB-I-LF-ALT-PREMIUM-AMT
 15384                                 - PB-I-LF-ALT-PREM-CALC.
 15385
 15386      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 15387          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 15388              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15389                 MOVE ER-2652    TO  WS-ERROR
 15390                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15391              ELSE
 15392                 MOVE ER-2650    TO  WS-ERROR
 15393                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15394
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 279
* EL050.cbl
 15395      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 15396          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 15397              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 15398                 MOVE ER-2652    TO  WS-ERROR
 15399                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15400              ELSE
 15401                 MOVE ER-2650    TO  WS-ERROR
 15402                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15403
 15404 3344-CHECK-AH.
 15405
 15406****************************************************************
 15407***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 15408***
 15409
 15410     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 15411         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 15412             (1 + WS-TOL-AH-PREM-PCT)
 15413         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 15414             (1 - WS-TOL-AH-PREM-PCT)
 15415     ELSE
 15416         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 15417         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 15418
 15419***
 15420***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 15421***
 15422
 15423     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 15424         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 15425
 15426     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 15427         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 15428
 15429     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 15430        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 15431
 15432     IF (PB-REISSUED-CERT)
 15433        OR (PB-POLICY-IS-DECLINED)
 15434        OR (PB-POLICY-IS-VOIDED)
 15435        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 15436        CONTINUE
 15437     ELSE
 15438        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 15439              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 15440                          or
 15441           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 15442              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 15443           IF WS-PREM-REJECT-SW = SPACE
 15444              MOVE ER-3052       TO WS-ERROR
 15445              PERFORM 9900-ERROR-FORMAT
 15446                                 THRU 9900-EXIT
 15447           ELSE
 15448              MOVE ER-3050       TO WS-ERROR
 15449              PERFORM 9900-ERROR-FORMAT
 15450                                 THRU 9900-EXIT
 15451           END-IF
 15452        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 280
* EL050.cbl
 15453     END-IF
 15454     if (pb-company-id = 'DCC' or 'VPP')
 15455        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 15456        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 15457        and (pb-i-policy-is-monthly)
 15458        compute ws-tol-ah-high-prem-amt =
 15459           pb-i-tot-fees-calc + ws-tol-ah-prem
 15460        compute ws-tol-ah-low-prem-amt =
 15461           pb-i-tot-fees-calc - ws-tol-ah-prem
 15462        if ws-tol-ah-prem-pct > zeros
 15463           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 15464              (1 + ws-tol-ah-prem-pct)
 15465           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 15466              (1 - ws-tol-ah-prem-pct)
 15467        else
 15468           move +9999999.99      to ws-tol-ah-high-prem-pct
 15469           move +0               to ws-tol-ah-low-prem-pct
 15470        end-if
 15471        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 15472            or
 15473           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 15474                          or
 15475           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15476           or
 15477           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15478            move er-3049         to ws-error
 15479           perform 9900-error-format
 15480                                 thru 9900-exit
 15481
 15482        end-if
 15483     end-if
 15484     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15485         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15486             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15487             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15488
 15489     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15490        IF WS-COMP-MAX-CAP GREATER THAN +0
 15491           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15492              IF (PB-REISSUED-CERT         OR
 15493                  PB-POLICY-IS-DECLINED    OR
 15494                  PB-POLICY-IS-VOIDED)
 15495                 NEXT SENTENCE
 15496              ELSE
 15497                  MOVE ER-2646   TO  WS-ERROR
 15498                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15499
 15500     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15501        (WS-COMP-MAX-CAP EQUAL +0)
 15502           GO TO 3345-EDIT-CONTINUE.
 15503
 15504     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15505        GREATER THAN WS-COMP-MAX-CAP
 15506           MOVE ER-2646          TO  WS-ERROR
 15507           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15508
 15509 3345-EDIT-CONTINUE.
 15510
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 281
* EL050.cbl
 15511*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15512*       IF PB-ENTRY-BATCH   NUMERIC
 15513*          IF PB-ISSUE
 15514*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15515*          ELSE
 15516*              IF PB-CANCELLATION
 15517*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15518
 15519*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15520*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15521*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15522*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15523*        ELSE
 15524*            MOVE  ER-1909            TO  WS-ERROR
 15525*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15526
 15527     IF PB-I-POLICY-ACCEPTED
 15528        IF PB-POLICY-IS-DECLINED  OR
 15529           PB-REISSUED-CERT  OR
 15530           PB-REIN-ONLY-CERT  OR
 15531           PB-POLICY-IS-VOIDED
 15532            MOVE  ER-1891         TO  WS-ERROR
 15533            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15534        ELSE
 15535            MOVE SPACE            TO  PB-BATCH-ENTRY
 15536            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15537
 15538     IF PB-I-POLICY-DECLINED
 15539        IF PB-REISSUED-CERT  OR
 15540           PB-REIN-ONLY-CERT  OR
 15541           PB-POLICY-IS-VOIDED
 15542            MOVE  ER-1906         TO  WS-ERROR
 15543            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15544        ELSE
 15545            MOVE  'D'             TO  PB-BATCH-ENTRY
 15546                                      PB-I-ENTRY-STATUS.
 15547
 15548     IF PB-I-NEEDS-UNDERWRITING
 15549        IF PB-POLICY-IS-DECLINED OR
 15550           PB-REISSUED-CERT  OR
 15551           PB-REIN-ONLY-CERT  OR
 15552           PB-POLICY-IS-VOIDED
 15553            MOVE  ER-1907         TO  WS-ERROR
 15554            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15555        ELSE
 15556            MOVE 'U'              TO  PB-BATCH-ENTRY
 15557                                      PB-I-ENTRY-STATUS.
 15558
 15559     IF PB-NEEDS-UNDERWRITING
 15560        MOVE  ER-1901             TO  WS-ERROR
 15561        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15562     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15563        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15564        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15565        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15566           AND (NOT WS-LF-CASH))
 15567                           OR
 15568           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 282
* EL050.cbl
 15569           AND (NOT WS-AH-CASH)))
 15570                       AND
 15571           (PB-I-ENTRY-STATUS NOT = '5')
 15572           MOVE 'M'              TO PB-BATCH-ENTRY
 15573                                    PB-I-ENTRY-STATUS
 15574        END-IF
 15575     END-IF
 15576     move pending-business       to ws-passed-erpndb
 15577     move ' '                    to ws-exceed-limit-yn
 15578     perform 7780-call-agg       thru 7780-exit
 15579*    display ' el050 exceed ' ws-exceed-limit-yn
 15580     if ws-exceed-limit-yn = 'Y'
 15581        MOVE  ER-9813            TO WS-ERROR
 15582        move 'Y'                 to ws-9813-sw
 15583        PERFORM  9900-ERROR-FORMAT
 15584                                 THRU 9900-EXIT
 15585     end-if
 15586     if (PB-EXCEEDED-LIMIT-FORCED)
 15587        and (ws-9813-sw = 'Y')
 15588        subtract +1 from PB-NO-OF-ERRORS
 15589        move er-9823             to ws-error
 15590        PERFORM  9900-ERROR-FORMAT
 15591                                 THRU 9900-EXIT
 15592     end-if
 15593     IF  PB-COMPANY-ID NOT = 'NCL'
 15594         GO TO 3999-END-EDIT.
 15595
 15596     IF PB-REISSUED-CERT  OR
 15597        PB-POLICY-IS-DECLINED  OR
 15598        PB-POLICY-IS-VOIDED  OR
 15599        PB-I-OB
 15600         GO TO 3999-END-EDIT.
 15601
 15602     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15603         MOVE  ER-2644            TO  WS-ERROR
 15604         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15605         GO TO 3999-END-EDIT.
 15606
 15607     MOVE 'N'                     TO  FORM-MASTER-SW.
 15608     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15609
 15610     IF NOT FORM-MASTER-FOUND
 15611         GO TO 3999-END-EDIT.
 15612
 15613     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15614                                      FORM-MASTER-AH-SW.
 15615
 15616     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15617         MOVE  +1                 TO SUB6
 15618         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15619
 15620     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15621         MOVE  +1                 TO SUB6
 15622         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15623
 15624     IF LF-FORM-MASTER-FOUND  OR
 15625        AH-FORM-MASTER-FOUND
 15626         GO TO 3360-CHECK-FORM-LIMITS
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 283
* EL050.cbl
 15627     ELSE
 15628         GO TO 3999-END-EDIT.
 15629
 15630******************************************************************
 15631*                  3350-GET-ERFORM                               *
 15632*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15633*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15634******************************************************************
 15635
 15636 3350-GET-ERFORM.
 15637
 15638     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15639         GO TO  3350-ERFORM-GETMAIN.
 15640
 15641     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15642     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15643     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15644     MOVE 'Y'                     TO FORM-MASTER-SW.
 15645
 15646     IF PB-CANCELLATION
 15647         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15648            PB-SV-STATE          EQUAL   FO-STATE       AND
 15649            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15650              GO TO 3350-EXIT
 15651         ELSE
 15652             NEXT SENTENCE
 15653     ELSE
 15654         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15655            PB-SV-STATE          EQUAL   FO-STATE       AND
 15656            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15657              GO TO 3350-EXIT.
 15658
 15659 3350-ERFORM-GETMAIN.
 15660
 15661     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15662     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15663
 15664 3350-ERFORM-READ.
 15665
 15666     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15667     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15668     IF PB-CANCELLATION
 15669         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15670     ELSE
 15671         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15672     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15673
 15674     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15675
 15676     IF FORM-MASTER-FOUND
 15677       IF PB-CANCELLATION
 15678          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15679             PB-SV-STATE          EQUAL   FO-STATE       AND
 15680             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15681              GO  TO 3350-EXIT
 15682          ELSE
 15683              NEXT SENTENCE
 15684       ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 284
* EL050.cbl
 15685          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15686             PB-SV-STATE          EQUAL   FO-STATE       AND
 15687             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15688              GO  TO 3350-EXIT.
 15689
 15690     MOVE  'N'                    TO  FORM-MASTER-SW.
 15691     MOVE  ER-1895                TO  WS-ERROR.
 15692     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15693
 15694 3350-EXIT.
 15695      EXIT.
 15696
 15697******************************************************************
 15698*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15699*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15700*   VALID FOR THE POLICY FORM USED.                              *
 15701******************************************************************
 15702
 15703 3355-EDIT-FORM-LF-BENEFITS.
 15704
 15705     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15706        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15707         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15708         GO TO   3355-EXIT.
 15709
 15710     IF  SUB6    LESS THAN   +40
 15711         ADD  +1      TO  SUB6
 15712         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15713
 15714     MOVE  ER-1896         TO  WS-ERROR.
 15715     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15716
 15717 3355-EXIT.
 15718      EXIT.
 15719
 15720******************************************************************
 15721*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15722*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15723*   VALID FOR THE POLICY FORM USED.                              *
 15724******************************************************************
 15725
 15726 3356-EDIT-FORM-AH-BENEFITS.
 15727
 15728     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15729        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15730         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15731         GO TO  3356-EXIT.
 15732
 15733      IF  SUB6    LESS THAN     +40
 15734          ADD  +1      TO  SUB6
 15735          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15736
 15737     MOVE  ER-1897         TO  WS-ERROR.
 15738     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15739
 15740 3356-EXIT.
 15741      EXIT.
 15742
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 285
* EL050.cbl
 15743******************************************************************
 15744*                  3357-BENEFIT-SEARCH                           *
 15745*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15746*   CANCELLATIONS ONLY.                                          *
 15747******************************************************************
 15748 3357-BENEFIT-SEARCH.
 15749     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15750         MOVE +1                          TO SUB6
 15751         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15752
 15753     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15754         MOVE +1                          TO SUB6
 15755         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15756
 15757 3357-EXIT.
 15758     EXIT.
 15759
 15760******************************************************************
 15761*                  3358-BENEFIT-LIFE-SEARCH                      *
 15762*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15763*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15764*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15765******************************************************************
 15766 3358-BENEFIT-LIFE-SEARCH.
 15767     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15768       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15769         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15770           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15771              IF FO-PLAN-REFUND-METHOD (SUB6)
 15772                     IS GREATER THAN SPACES
 15773                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15774                                          WS-LF-REFUND-CALC
 15775                 GO TO 3358-EXIT.
 15776
 15777     IF SUB6 LESS THAN +40
 15778         ADD +1                 TO SUB6
 15779         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15780
 15781 3358-EXIT.
 15782     EXIT.
 15783******************************************************************
 15784*                  3359-BENEFIT-AH-SEARCH                        *
 15785*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15786*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15787*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15788******************************************************************
 15789 3359-BENEFIT-AH-SEARCH.
 15790     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15791       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15792         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15793           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15794              IF FO-PLAN-REFUND-METHOD (SUB6)
 15795                      IS GREATER THAN SPACES
 15796                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15797                                          WS-AH-REFUND-CALC
 15798                 GO TO 3359-EXIT.
 15799
 15800     IF SUB6 LESS THAN +40
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 286
* EL050.cbl
 15801         ADD +1                 TO SUB6
 15802         GO TO 3359-BENEFIT-AH-SEARCH.
 15803
 15804 3359-EXIT.
 15805     EXIT.
 15806
 15807******************************************************************
 15808*                  3360-CHECK-FORM-LIMITS                        *
 15809*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15810*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15811******************************************************************
 15812
 15813 3360-CHECK-FORM-LIMITS.
 15814
 15815     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15816         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15817
 15818     IF NOT LF-FORM-MASTER-FOUND
 15819         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15820
 15821 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15822
 15823     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15824       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15825        WS-LF-JOINT-INDICATOR = 'J'  AND
 15826        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15827         IF PB-COMPANY-ID = 'NCL'
 15828            MOVE  ER-1911          TO  WS-ERROR
 15829            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15830         ELSE
 15831            MOVE  ER-1892          TO  WS-ERROR
 15832            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15833
 15834 3360-CHECK-FORM-LF-ATT-AGE.
 15835
 15836     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15837
 15838     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15839         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15840         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15841            IF PB-COMPANY-ID = 'NCL'
 15842                MOVE  ER-1913      TO  WS-ERROR
 15843                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15844            ELSE
 15845                MOVE  ER-1894      TO  WS-ERROR
 15846                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15847
 15848 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15849
 15850     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15851         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15852         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15853            IF PB-COMPANY-ID = 'NCL'
 15854                MOVE  ER-1914      TO  WS-ERROR
 15855                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15856            ELSE
 15857                MOVE  ER-1899      TO  WS-ERROR
 15858                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 287
* EL050.cbl
 15859
 15860 3360-CHECK-FORM-LF-TERM-BAMT.
 15861
 15862     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15863         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15864         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15865           IF  PB-COMPANY-ID = 'NCL'
 15866               MOVE  ER-1916       TO  WS-ERROR
 15867               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15868           ELSE
 15869               MOVE  ER-1902       TO  WS-ERROR
 15870               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15871
 15872     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15873                                    PB-I-LF-ALT-BENEFIT-AMT.
 15874
 15875     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15876         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15877         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15878             IF  PB-COMPANY-ID = 'NCL'
 15879                 MOVE  ER-1918     TO  WS-ERROR
 15880                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15881             ELSE
 15882                 MOVE  ER-1904     TO  WS-ERROR
 15883                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15884
 15885******************************************************************
 15886*                  3360-CHECK-FORM-AH-LIMITS                     *
 15887*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15888*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15889******************************************************************
 15890
 15891 3360-CHECK-FORM-AH-LIMITS.
 15892
 15893     IF NOT AH-FORM-MASTER-FOUND
 15894         GO TO 3999-END-EDIT.
 15895
 15896 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15897
 15898     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15899       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15900        WS-AH-JOINT-INDICATOR = 'J'  AND
 15901        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15902         IF PB-COMPANY-ID = 'NCL'
 15903            MOVE  ER-1912          TO  WS-ERROR
 15904            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15905         ELSE
 15906            MOVE  ER-1893          TO  WS-ERROR
 15907            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15908
 15909 3360-CHECK-FORM-AH-ATT-AGE.
 15910
 15911     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15912
 15913     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15914         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15915         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15916            IF PB-COMPANY-ID = 'NCL'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 288
* EL050.cbl
 15917                MOVE  ER-1913      TO  WS-ERROR
 15918                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15919            ELSE
 15920                MOVE  ER-1894      TO  WS-ERROR
 15921                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15922
 15923 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15924
 15925     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15926         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15927         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15928            IF PB-COMPANY-ID = 'NCL'
 15929                MOVE  ER-1915      TO  WS-ERROR
 15930                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15931            ELSE
 15932                MOVE  ER-1900      TO  WS-ERROR
 15933                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15934
 15935 3360-CHECK-FORM-AH-TERM-BAMT.
 15936
 15937     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15938         FO-AH-MAX-TERM    GREATER THAN  +0
 15939         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15940             IF  PB-COMPANY-ID = 'NCL'
 15941                 MOVE  ER-1917     TO  WS-ERROR
 15942                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15943             ELSE
 15944                  MOVE  ER-1903    TO  WS-ERROR
 15945                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15946
 15947     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15948         FO-MAX-AH-AMT    GREATER THAN  +0
 15949         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15950             IF  PB-COMPANY-ID = 'NCL'
 15951                 MOVE  ER-1919     TO  WS-ERROR
 15952                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15953             ELSE
 15954                 MOVE  ER-1905     TO  WS-ERROR
 15955                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15956
 15957     GO TO 3999-END-EDIT.
 15958
 15959******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 289
* EL050.cbl
 15961 3400-edit-vin.
 15962
 15963     move spaces                 to hldi-pass-area
 15964     MOVE PB-I-VIN               TO WS-WORK-VIN
 15965     MOVE +8                     TO V2
 15966     MOVE ZEROS                  TO WS-VIN-TOTAL
 15967     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15968      (V1 > 17)
 15969        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15970           MOVE ER-3825          TO WS-ERROR
 15971           PERFORM 9900-ERROR-FORMAT
 15972                                 THRU 9900-EXIT
 15973        ELSE
 15974           IF V1 = 8
 15975              MOVE 10            TO V2
 15976           END-IF
 15977           IF V1 = 9
 15978              MOVE 0             TO V2
 15979           END-IF
 15980           IF V1 = 10
 15981              MOVE 9             TO V2
 15982           END-IF
 15983           IF WS-WORK-VIN (V1:1) NUMERIC
 15984              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15985               + (WS-WORK-VIN-N (V1) * V2)
 15986           ELSE
 15987              MOVE WS-WORK-VIN (V1:1)
 15988                            TO WS-HEX-BYTE
 15989              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15990              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15991               + (WS-NUM (V3) * V2)
 15992           END-IF
 15993           COMPUTE V2 = V2 - 1
 15994        END-IF
 15995     END-PERFORM
 15996     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15997     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15998        REMAINDER WS-VIN-REMAINDER
 15999     IF ((WS-WORK-VIN (9:1) = 'X')
 16000        AND (WS-VIN-REMAINDER = 10))
 16001                OR
 16002        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 16003        if pb-company-id = 'VPP'
 16004           perform 3410-check-with-hldi
 16005                                 thru 3410-exit
 16006        end-if
 16007     ELSE
 16008        IF WS-WORK-VIN (1:1) > 0 AND < 6
 16009           MOVE ER-3826          TO WS-ERROR
 16010           PERFORM 9900-ERROR-FORMAT
 16011                                 THRU 9900-EXIT
 16012        ELSE
 16013           MOVE ER-3827          TO WS-ERROR
 16014           PERFORM 9900-ERROR-FORMAT
 16015                                 THRU 9900-EXIT
 16016        END-IF
 16017     END-IF
 16018
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 290
* EL050.cbl
 16019     .
 16020 3400-exit.
 16021     exit.
 16022 3410-check-with-hldi.
 16023     move spaces                 to hldi-pass-area
 16024     move pb-i-vin               to pa-vin
 16025     perform 7785-call-hldi      thru 7785-exit
 16026*    display 'PA-VIN        ' PA-VIN
 16027*    display 'PA-ErrorCode  ' PA-ErrorCode
 16028*    display 'PA-ErrorDesc  ' PA-ErrorDesc
 16029*    display 'PA-ModelYear  ' PA-ModelYear
 16030*    display 'PA-MakeName   ' PA-MakeName
 16031*    display 'PA-ModelName  ' PA-ModelName
 16032*    display 'PA-SeriesName ' PA-SeriesName
 16033     if pa-errorcode (1:1) not = '0'
 16034        move spaces              to hldi-pass-area
 16035        move pb-i-vin            to pa-vin
 16036*       move pa-errordesc        to pa-seriesname
 16037*       perform 7786-call-hldim  thru 7786-exit
 16038*       display 'PA-VIN        ' PA-VIN
 16039*       display 'PA-ErrorCode  ' PA-ErrorCode
 16040*       display 'PA-ErrorDesc  ' PA-ErrorDesc
 16041*       display 'PA-ModelYear  ' PA-ModelYear
 16042*       display 'PA-MakeName   ' PA-MakeName
 16043*       display 'PA-ModelName  ' PA-ModelName
 16044*       display 'PA-SeriesName ' PA-SeriesName
 16045     end-if
 16046     .
 16047 3410-exit.
 16048     exit.
 16049******************************************************************
 16050*                  E D I T   C A N C E L                         *
 16051******************************************************************
 16052
 16053 3700-EDIT-CANCEL.
 16054     IF PB-COMPANY-ID = 'DMD'
 16055         MOVE ZEROS                   TO WS-RES-STATE-TAX
 16056                                         WS-RES-MUNI-TAX
 16057                                         PB-CI-STATE-TAX
 16058                                         PB-CI-MUNI-TAX
 16059         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 16060
 16061*    IF PB-COMPANY-ID  EQUAL  'NCL'
 16062*       IF PB-ENTRY-BATCH  NUMERIC
 16063*          IF PB-CANCELLATION
 16064*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 16065*          ELSE
 16066*             IF PB-ISSUE
 16067*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 16068
 16069     IF PB-C-INT-ON-REFS NOT NUMERIC
 16070        MOVE ZEROS               TO PB-C-INT-ON-REFS
 16071     END-IF
 16072*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 16073*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 16074
 16075     IF CM-ENTRY-STATUS = 'V'
 16076        MOVE ER-2780             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 291
* EL050.cbl
 16077        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16078        GO TO 3999-END-EDIT.
 16079
 16080     IF CM-ENTRY-STATUS = 'D'
 16081        MOVE ER-2781             TO WS-ERROR
 16082        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16083        GO TO 3999-END-EDIT.
 16084
 16085     IF CM-ENTRY-STATUS = 'U'
 16086        MOVE ER-2782             TO WS-ERROR
 16087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16088
 16089***************************************************************
 16090*                                                             *
 16091*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 16092*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 16093*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 16094*   OF ANOTHER COVERAGE.                                      *
 16095*                                                             *
 16096***************************************************************
 16097
 16098     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 16099                                    PB-C-AH-CANCEL-VOID-SW.
 16100
 16101     if pb-company-id = 'DCC' or 'VPP'
 16102        if ((pb-ci-lf-cancel-amt <> zeros)
 16103                       or
 16104            (pb-ci-ah-cancel-amt <> zeros))
 16105           MOVE ER-3068          TO WS-ERROR
 16106           PERFORM 9900-ERROR-FORMAT
 16107                                 THRU 9900-EXIT
 16108           GO TO 3999-END-EDIT
 16109        end-if
 16110     end-if
 16111     IF PB-C-LF-CANCEL-AMT = ZERO
 16112        NEXT SENTENCE
 16113     ELSE
 16114        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16115           AND
 16116           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16117               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 16118               MOVE ER-2745           TO WS-ERROR
 16119               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16120
 16121     IF PB-C-AH-CANCEL-AMT = ZERO
 16122        NEXT SENTENCE
 16123     ELSE
 16124        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16125           AND
 16126           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 16127               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 16128               MOVE ER-2745           TO WS-ERROR
 16129               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16130
 16131     IF WS-LF-EARNINGS-CALC = '4'
 16132        MOVE '4'                   TO WS-LF-REFUND-CALC.
 16133
 16134     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 292
* EL050.cbl
 16135     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 16136     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 16137     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 16138     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 16139     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 16140
 16141     MOVE ZERO                     TO PB-C-LF-REF-CALC
 16142                                      PB-C-AH-REF-CALC.
 16143     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 16144
 16145******************************************************************
 16146*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 16147*             TO VALIDATE COVERAGE.                              *
 16148******************************************************************
 16149
 16150     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 16151        PB-C-LF-CANCEL-AMT = ZEROS
 16152          MOVE 'N'                 TO WS-LF-CANCEL-SW
 16153      ELSE
 16154          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 16155
 16156     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 16157        PB-C-AH-CANCEL-AMT = ZEROS
 16158          MOVE 'N'                 TO WS-AH-CANCEL-SW
 16159      ELSE
 16160          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 16161
 16162     EVALUATE TRUE
 16163         WHEN PB-CANCEL-FORCE             OR
 16164              PB-CANCEL-DATE-FORCED       OR
 16165              PB-FORCE-OFF
 16166                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16167                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 16168                  END-IF
 16169         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 16170               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 16171              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 16172                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 16173         WHEN OTHER
 16174              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 16175                 MOVE ER-2794              TO WS-ERROR
 16176              ELSE
 16177                 MOVE ER-2749              TO WS-ERROR
 16178              END-IF
 16179              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16180     END-EVALUATE.
 16181
 16182
 16183*    IF  PB-COMPANY-ID    EQUAL    'HER'
 16184*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 16185*            MOVE  ER-1909            TO  WS-ERROR
 16186*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 16187*        ELSE
 16188*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 16189
 16190     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 16191     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 16192        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 293
* EL050.cbl
 16193     ELSE
 16194        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 16195     END-IF
 16196     .
 16197 3705-EDIT-CANCEL-DT.
 16198
 16199     IF LF-COVERAGE-CANCELLED
 16200        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16201         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 16202         MOVE WS-CURRENT-MONTH-END
 16203                                 TO DC-BIN-DATE-2
 16204         SET ELAPSED-BETWEEN-BIN TO TRUE
 16205*        MOVE 1                  TO DC-OPTION-CODE
 16206         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16207         IF DATE-CONVERSION-ERROR
 16208            NEXT SENTENCE
 16209          ELSE
 16210             IF DC-ELAPSED-DAYS GREATER +180
 16211                IF PB-CANCEL-DATE-FORCED  OR
 16212                   PB-CANCEL-DATE-FORCED-NO-FEE
 16213                      MOVE ER-2751  TO WS-ERROR
 16214                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16215                 ELSE
 16216                   MOVE ER-2752  TO WS-ERROR
 16217                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16218
 16219     IF AH-COVERAGE-CANCELLED
 16220        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16221         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 16222         MOVE WS-CURRENT-MONTH-END
 16223                                 TO DC-BIN-DATE-2
 16224         SET ELAPSED-BETWEEN-BIN TO TRUE
 16225*        MOVE 1                  TO DC-OPTION-CODE
 16226         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16227         IF DATE-CONVERSION-ERROR
 16228            NEXT SENTENCE
 16229          ELSE
 16230             IF DC-ELAPSED-DAYS GREATER +180
 16231                IF PB-CANCEL-DATE-FORCED OR
 16232                   PB-CANCEL-DATE-FORCED-NO-FEE
 16233                      MOVE ER-2751  TO WS-ERROR
 16234                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16235                 ELSE
 16236                   MOVE ER-2752  TO WS-ERROR
 16237                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16238
 16239     IF WS-ERROR = ER-2752
 16240        AND (PB-COMPANY-ID = 'ABL'
 16241         OR  PB-COMPANY-ID = 'FGL'
 16242         OR  PB-COMPANY-ID = 'IST'
 16243         OR  PB-COMPANY-ID = 'JHL'
 16244         OR  PB-COMPANY-ID = 'LAP'
 16245         OR  PB-COMPANY-ID = 'LBL'
 16246         OR  PB-COMPANY-ID = 'NCB'
 16247         OR  PB-COMPANY-ID = 'NLI'
 16248         OR  PB-COMPANY-ID = 'OFI'
 16249         OR  PB-COMPANY-ID = 'PLI'
 16250         OR  PB-COMPANY-ID = 'TAO'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 294
* EL050.cbl
 16251         OR  PB-COMPANY-ID = 'TIC'
 16252         OR  PB-COMPANY-ID = 'HER'
 16253         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 16254         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 16255            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 16256            MOVE ER-2762     TO WS-ERROR
 16257            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16258
 16259     IF LF-COVERAGE-CANCELLED
 16260        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16261        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16262             MOVE ER-2733         TO WS-ERROR
 16263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16264
 16265     IF AH-COVERAGE-CANCELLED
 16266        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16267        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 16268              MOVE ER-2733        TO WS-ERROR
 16269              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16270
 16271     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 16272        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 16273        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 16274           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 16275            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 16276              IF PB-COMPANY-ID NOT = 'LAP'
 16277               MOVE ER-2704            TO WS-ERROR
 16278               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16279
 16280     IF CERT-WAS-NOT-FOUND
 16281         GO TO 3999-END-EDIT.
 16282
 16283     IF PB-COMPANY-ID EQUAL 'CDC'
 16284        IF LF-COVERAGE-CANCELLED
 16285           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16286            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16287            MOVE PB-C-LF-CANCEL-DT
 16288                                 TO DC-BIN-DATE-2
 16289            SET ELAPSED-BETWEEN-BIN TO TRUE
 16290*           MOVE 1               TO DC-OPTION-CODE
 16291            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16292            IF DATE-CONVERSION-ERROR
 16293               NEXT SENTENCE
 16294             ELSE
 16295                IF DC-ELAPSED-DAYS GREATER +60
 16296                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 16297
 16298     IF PB-COMPANY-ID EQUAL 'CDC'
 16299        IF AH-COVERAGE-CANCELLED
 16300           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16301            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 16302            MOVE PB-C-AH-CANCEL-DT
 16303                                 TO DC-BIN-DATE-2
 16304            MOVE +0              TO DC-ELAPSED-DAYS
 16305                                    DC-ELAPSED-MONTHS
 16306            SET ELAPSED-BETWEEN-BIN  TO TRUE
 16307*           MOVE 1               TO DC-OPTION-CODE
 16308            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 295
* EL050.cbl
 16309            IF DATE-CONVERSION-ERROR
 16310               NEXT SENTENCE
 16311             ELSE
 16312                IF DC-ELAPSED-DAYS GREATER +60
 16313                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 16314
 16315     MOVE +0                     TO DC-ELAPSED-DAYS
 16316                                    DC-ELAPSED-MONTHS.
 16317
 16318     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 16319        (WS-AH-SPECIAL-CALC-CD = 'Z')
 16320          MOVE 'Z'                TO PB-CI-OB-FLAG
 16321          MOVE ER-2767            TO WS-ERROR
 16322          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16323          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16324          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16325          GO TO 3775-OVER-REF-CHK
 16326        ELSE
 16327          MOVE ZEROS              TO PB-CI-LIVES
 16328                                     PB-C-LIVES
 16329          IF PB-CI-OB-FLAG NOT = 'B'
 16330             MOVE SPACE           TO PB-CI-OB-FLAG.
 16331
 16332     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 16333         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 16334     ELSE
 16335         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 16336
 16337     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 16338        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 16339            MOVE ER-2760         TO WS-ERROR
 16340            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16341
 16342     IF LF-COVERAGE-CANCELLED
 16343        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16344         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 16345            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 16346               MOVE ER-2774       TO WS-ERROR
 16347               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16348
 16349     IF AH-COVERAGE-CANCELLED
 16350        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16351         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 16352            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 16353               MOVE ER-2775       TO WS-ERROR
 16354               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16355
 16356     IF LF-COVERAGE-CANCELLED
 16357        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16358         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 16359            MOVE ER-2776         TO WS-ERROR
 16360            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16361
 16362     IF AH-COVERAGE-CANCELLED
 16363        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16364         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 16365            MOVE ER-2777         TO WS-ERROR
 16366            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 296
* EL050.cbl
 16367
 16368     IF LF-COVERAGE-CANCELLED
 16369        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16370        if pb-ci-lf-expire-dt = low-values or spaces
 16371           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16372           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 16373           MOVE PB-CI-EXTENTION-DAYS
 16374                                 TO DC-ELAPSED-DAYS
 16375           SET BIN-PLUS-ELAPSED  TO TRUE
 16376           PERFORM 8500-DATE-CONVERT
 16377                                 THRU 8500-EXIT
 16378           IF DATE-CONVERSION-ERROR
 16379              move low-values    to dc-bin-date-2
 16380           end-if
 16381        else
 16382           move pb-ci-lf-expire-dt
 16383                                 to dc-bin-date-2
 16384        end-if
 16385        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16386           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16387                             OR  'FIA'
 16388              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 16389           ELSE
 16390              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16391              MOVE ER-2731       TO WS-ERROR
 16392              PERFORM 9900-ERROR-FORMAT
 16393                                 THRU 9900-EXIT
 16394           end-if
 16395        end-if
 16396     end-if
 16397*    IF LF-COVERAGE-CANCELLED
 16398*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16399*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16400*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 16401*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16402*        SET BIN-PLUS-ELAPSED      TO TRUE
 16403*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16404*        IF DATE-CONVERSION-ERROR
 16405*           NEXT SENTENCE
 16406*         ELSE
 16407*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 16408*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16409*                            OR  'FIA'
 16410*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 16411*              ELSE
 16412*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16413*               MOVE ER-2731       TO WS-ERROR
 16414*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16415     .
 16416 3705-EDIT-AH-CANCEL-DT.
 16417     IF AH-COVERAGE-CANCELLED
 16418        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16419        if pb-ci-AH-expire-dt = low-values or spaces
 16420           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 16421           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 16422           MOVE PB-CI-EXTENTION-DAYS
 16423                                 TO DC-ELAPSED-DAYS
 16424           SET BIN-PLUS-ELAPSED  TO TRUE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 297
* EL050.cbl
 16425           PERFORM 8500-DATE-CONVERT
 16426                                 THRU 8500-EXIT
 16427           IF DATE-CONVERSION-ERROR
 16428              move low-values    to dc-bin-date-2
 16429           end-if
 16430        else
 16431           move pb-ci-ah-expire-dt
 16432                                 to dc-bin-date-2
 16433        end-if
 16434        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16435           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16436                             OR  'FIA'
 16437              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 16438           ELSE
 16439              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16440              MOVE ER-2771       TO WS-ERROR
 16441              PERFORM 9900-ERROR-FORMAT
 16442                                 THRU 9900-EXIT
 16443           end-if
 16444        end-if
 16445     end-if
 16446*    IF AH-COVERAGE-CANCELLED
 16447*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 16448*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 16449*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 16450*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 16451**       MOVE 6                    TO DC-OPTION-CODE
 16452*        SET BIN-PLUS-ELAPSED      TO TRUE
 16453*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 16454*        IF DATE-CONVERSION-ERROR
 16455*           NEXT SENTENCE
 16456*         ELSE
 16457*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 16458*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 16459*                             OR 'FIA'
 16460*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 16461*             ELSE
 16462*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 16463*              MOVE ER-2771       TO WS-ERROR
 16464*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16465     .
 16466 3705-EDIT-CONTINUED.
 16467
 16468*    IF LF-COVERAGE-CANCELLED
 16469*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16470*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16471*            MOVE ER-2727         TO WS-ERROR
 16472*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16473*
 16474*    IF AH-COVERAGE-CANCELLED
 16475*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16476*        IF PB-COMPANY-ID = 'ACE'
 16477*           MOVE ER-2727        TO WS-ERROR
 16478*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16479*        ELSE
 16480*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 16481*              MOVE ER-2727     TO WS-ERROR
 16482*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 298
* EL050.cbl
 16483
 16484     IF PB-COMPANY-ID = 'ACE'
 16485       IF AH-COVERAGE-CANCELLED
 16486         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 16487           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 16488              MOVE ER-2732      TO WS-ERROR
 16489              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16490
 16491     IF PB-COMPANY-ID      EQUAL   'HER'
 16492        IF WS-ERROR        EQUAL   ER-2727
 16493            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 16494            MOVE  ER-2725          TO  WS-ERROR
 16495            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 16496
 16497     IF PB-C-CLAIM-CREATED-CANCEL
 16498            MOVE ER-2748         TO WS-ERROR
 16499            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16500
 16501     IF PB-C-LAST-NAME NOT = SPACES
 16502         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 16503            MOVE ER-2747         TO WS-ERROR
 16504            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16505
 16506 3710-EDIT-LUMP-SUM-PRIOR.
 16507
 16508     IF AH-COVERAGE-CANCELLED
 16509         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16510             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 16511                MOVE ER-2735    TO WS-ERROR
 16512                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16513
 16514     IF LF-COVERAGE-CANCELLED
 16515         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 16516             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 16517                MOVE ER-2735    TO WS-ERROR
 16518                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16519
 16520 3710-EDIT-PRIOR-DEATH.
 16521
 16522*    IF LF-COVERAGE-CANCELLED
 16523*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16524*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16525*           (NOT PB-CI-OB)
 16526*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16527*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16528*                   MOVE ER-2732  TO WS-ERROR
 16529*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16530*
 16531*    IF AH-COVERAGE-CANCELLED
 16532*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16533*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16534*           (NOT PB-CI-OB)
 16535*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16536*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16537*                   MOVE ER-2732  TO WS-ERROR
 16538*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16539
 16540     IF PB-CI-DEATH-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 299
* EL050.cbl
 16541         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16542            (NOT PB-COMP-LF-CANCEL)
 16543             NEXT SENTENCE
 16544         ELSE
 16545           IF PB-C-LF-CANCEL-VOIDED
 16546              NEXT SENTENCE
 16547           ELSE
 16548              MOVE ER-2753      TO WS-ERROR
 16549              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16550
 16551     IF CANCEL-FUTURE-DT
 16552         GO TO 3999-END-EDIT.
 16553
 16554 3715-GET-REMAIN-TERM-LF.
 16555
 16556     IF NO-LF-BENEFIT-MATCH  OR
 16557        WS-LF-BENEFIT-CD = ZEROS
 16558        GO TO 3730-GET-AH-REMAIN-TERM.
 16559
 16560     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16561     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16562     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16563     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16564     MOVE PB-SV-STATE            TO CP-STATE.
 16565     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16566     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16567     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16568     MOVE '2'                    TO CP-PROCESS-TYPE.
 16569     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16570     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16571     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16572     IF (PB-COMPANY-ID = 'CID')
 16573        AND (CP-STATE-STD-ABBRV = 'WI')
 16574        MOVE '7'                 TO CP-REM-TERM-METHOD
 16575        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16576     ELSE
 16577        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16578        MOVE WS-REM-TRM-CALC-OPTION
 16579                                 TO CP-REM-TRM-CALC-OPTION
 16580     END-IF
 16581**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16582     IF (PB-COMPANY-ID = 'CID')
 16583        AND (CP-STATE-STD-ABBRV = 'MO')
 16584        AND (PB-CERT-EFF-DT >= X'9B41')
 16585        AND (PB-CERT-EFF-DT <= X'A2FB')
 16586        MOVE '7'                 TO CP-REM-TERM-METHOD
 16587        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16588     END-IF
 16589     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16590                                    CP-LOAN-TERM.
 16591     IF CP-TRUNCATED-LIFE
 16592        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16593
 16594     IF CP-TERM-IS-DAYS
 16595         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16596     ELSE
 16597         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16598
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 300
* EL050.cbl
 16599     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16600
 16601     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16602
 16603     IF LF-COVERAGE-CANCELLED
 16604        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16605        NEXT SENTENCE
 16606      ELSE
 16607          GO TO 3730-GET-AH-REMAIN-TERM.
 16608
 16609 3720-GET-LF-REFUND.
 16610
 16611     IF PB-C-LF-CANCEL-VOIDED
 16612        GO TO 3730-GET-AH-REMAIN-TERM
 16613     end-if
 16614
 16615     IF PB-COMPANY-ID EQUAL 'BOA'
 16616         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16617         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16618         GO TO 3730-GET-AH-REMAIN-TERM.
 16619
 16620     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16621        (WS-AH-SPECIAL-CALC-CD = 'M')
 16622         MOVE ER-2767            TO WS-ERROR
 16623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16624         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16625         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16626         GO TO 3780-UPDATE-CANCEL-CERT.
 16627
 16628*    if (ws-lf-earnings-calc = '6')
 16629*       or (pb-c-lf-refund-override = '6')
 16630*       move cp-remaining-term-1 to cp-remaining-term-2
 16631*    end-if
 16632     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16633
 16634     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16635     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16636     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16637     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16638     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16639     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16640     IF PB-COMPANY-ID = 'DCC'
 16641        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16642        IF PDEF-MASTER-FOUND
 16643           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16644              (V1 > +8)
 16645              OR (PD-PROD-CODE (V1) = 'L')
 16646           END-PERFORM
 16647           IF V1 < +9
 16648              MOVE PD-MAX-AMT (V1)
 16649                           TO CP-R-MAX-TOT-BEN
 16650                              EC-AM-LF-MAX-TOT-BEN
 16651           END-IF
 16652        ELSE
 16653        MOVE ' '                 TO PDEF-MASTER-SW
 16654        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16655        MOVE PB-STATE            TO ERPDEF-STATE
 16656        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 301
* EL050.cbl
 16657           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16658        END-IF
 16659        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16660        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16661        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16662        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16663        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16664        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16665        IF PDEF-MASTER-FOUND
 16666           MOVE 'N'              TO PDEF-MASTER-SW
 16667           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16668           IF PDEF-MASTER-FOUND
 16669              IF (ERPDEF-KEY-SAVE (1:16) =
 16670                           PD-CONTROL-PRIMARY (1:16))
 16671                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16672                 CONTINUE
 16673              ELSE
 16674                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16675                 IF (ERPDEF-KEY-SAVE (1:16) =
 16676                           PD-CONTROL-PRIMARY (1:16))
 16677                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16678                    CONTINUE
 16679                 ELSE
 16680                    MOVE 'N'     TO PDEF-MASTER-SW
 16681                 END-IF
 16682              END-IF
 16683
 16684              IF PDEF-MASTER-FOUND
 16685                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16686                    (V1 > +8)
 16687                    OR (PD-PROD-CODE (V1) = 'L')
 16688                 END-PERFORM
 16689                 IF V1 < +9
 16690                    MOVE PD-MAX-AMT (V1)
 16691                                 TO CP-R-MAX-TOT-BEN
 16692                                    EC-AM-LF-MAX-TOT-BEN
 16693                 END-IF
 16694              END-IF
 16695           END-IF
 16696           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16697        END-IF
 16698        END-IF
 16699     END-IF
 16700     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16701
 16702     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16703
 16704     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16705                                    PB-C-LF-REM-TERM.
 16706
 16707     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16708     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16709
 16710     IF PB-COMPANY-ID EQUAL 'FLC'
 16711        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16712           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16713           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16714                    + PB-CI-LF-ALT-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 302
* EL050.cbl
 16715                    - CM-LF-ITD-DEATH-AMT
 16716           IF PB-C-LF-REF-CALC LESS THAN +0
 16717              MOVE +0            TO PB-C-LF-REF-CALC
 16718              GO TO 3730-GET-AH-REMAIN-TERM
 16719           ELSE
 16720              GO TO 3730-GET-AH-REMAIN-TERM.
 16721
 16722     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16723                            OR '4' OR '5' OR '6' OR '8'
 16724                            OR '9' OR 'G'
 16725        MOVE PB-C-LF-REFUND-OVERRIDE
 16726                                 TO CP-EARNING-METHOD.
 16727
 16728     if pb-company-id = 'AHL'
 16729        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16730        if cp-class-code = spaces
 16731           move zeros            to cp-class-code
 16732        end-if
 16733     ELSE
 16734        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16735     END-IF
 16736*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16737     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16738     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16739                                    CP-RATING-BENEFIT-AMT.
 16740     IF CP-STATE-STD-ABBRV = 'OR'
 16741         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16742                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16743     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16744     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16745     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16746     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16747     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16748     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16749     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16750     IF WS-DEFAULT-APR NOT NUMERIC
 16751         MOVE ZEROS TO WS-DEFAULT-APR.
 16752****   N O T E   ****
 16753*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16754*      THE OH HARD CODING IN ELCRFNDP
 16755
 16756     IF PB-COMPANY-ID = 'CID'
 16757        IF CP-STATE-STD-ABBRV = 'OH'
 16758           MOVE WS-LF-EARNINGS-CALC
 16759                                 TO CP-EARNING-METHOD
 16760        END-IF
 16761     END-IF
 16762
 16763****   N O T E   ****
 16764
 16765*    IF CP-EARN-AS-NET-PAY
 16766*        IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16767*           IF WS-DEFAULT-APR GREATER THAN ZEROS
 16768*               MOVE WS-DEFAULT-APR
 16769*                                TO  CP-LOAN-APR
 16770*               MOVE ER-3780     TO  WS-ERROR
 16771*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16772*           ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 303
* EL050.cbl
 16773*               MOVE ER-3781     TO  WS-ERROR
 16774*               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16775*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16776     move ' '                    to cp-ext-days-calc
 16777     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16778
 16779     IF CP-REFUND-TYPE-USED NOT = SPACE
 16780         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16781
 16782     IF CP-ERROR-RATE-IS-ZERO OR
 16783        CP-ERROR-RATE-NOT-FOUND
 16784        MOVE ER-2740             TO WS-ERROR
 16785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16786
 16787     IF CP-ERROR-RATE-FILE-NOTOPEN
 16788        MOVE ER-2617             TO WS-ERROR
 16789        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16790
 16791     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16792        AND PB-CI-ENTRY-STATUS = 'M'
 16793        MOVE +0                  TO PB-C-LF-REF-CALC
 16794     ELSE
 16795        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16796     END-IF
 16797
 16798     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16799         GO TO 3730-GET-AH-REMAIN-TERM.
 16800
 16801*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16802*       ADD +1                   TO PB-C-LF-REM-TERM
 16803*                                   CP-REMAINING-TERM
 16804*                                   CP-ORIGINAL-TERM.
 16805
 16806     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16807     MOVE '2'                    TO CP-EARNING-METHOD
 16808                                    CP-RATING-METHOD.
 16809     IF PB-COMPANY-ID = 'CID'
 16810        IF (CP-STATE-STD-ABBRV = 'MN')
 16811           AND (PB-CERT-EFF-DT > X'A4FF')
 16812           AND (WS-LF-EARNINGS-CALC = 'B')
 16813           MOVE '5'              TO CP-EARNING-METHOD
 16814           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16815        END-IF
 16816     END-IF
 16817     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16818                                        CP-REMAINING-BENEFIT
 16819                                        CP-RATING-BENEFIT-AMT.
 16820     IF CP-STATE-STD-ABBRV = 'OR'
 16821         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16822                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16823     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16824     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16825
 16826     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16827
 16828     IF CP-ERROR-RATE-IS-ZERO OR
 16829        CP-ERROR-RATE-NOT-FOUND
 16830        MOVE ER-2740             TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 304
* EL050.cbl
 16831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16832
 16833     IF CP-ERROR-RATE-FILE-NOTOPEN
 16834        MOVE ER-2617             TO WS-ERROR
 16835        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16836
 16837     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16838
 16839******************************************************************
 16840
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 305
* EL050.cbl
 16842 3730-GET-AH-REMAIN-TERM.
 16843     IF NO-AH-BENEFIT-MATCH  OR
 16844        WS-AH-BENEFIT-CD = ZEROS
 16845         GO TO 3770-CHECK-REFUNDS.
 16846
 16847     IF PB-CI-AH-LUMP-SUM-DISAB
 16848         IF  PB-C-AH-CANCEL-AMT = ZERO
 16849            IF NOT PB-COMP-AH-CANCEL
 16850             GO TO 3770-CHECK-REFUNDS.
 16851
 16852     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16853     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16854     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16855     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16856     MOVE PB-SV-STATE            TO CP-STATE.
 16857     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16858     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16859     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16860     MOVE '2'                    TO CP-PROCESS-TYPE.
 16861     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16862     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16863     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16864     IF (PB-COMPANY-ID = 'CID')
 16865        AND (CP-STATE-STD-ABBRV = 'WI')
 16866        MOVE '7'                 TO CP-REM-TERM-METHOD
 16867        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16868     ELSE
 16869        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16870        MOVE WS-REM-TRM-CALC-OPTION
 16871                                 TO CP-REM-TRM-CALC-OPTION
 16872     END-IF
 16873     IF (PB-COMPANY-ID = 'CID')
 16874        AND (CP-STATE-STD-ABBRV = 'MO')
 16875        AND (PB-CERT-EFF-DT >= X'9B41')
 16876        AND (PB-CERT-EFF-DT <= X'A2FB')
 16877        MOVE '7'                 TO CP-REM-TERM-METHOD
 16878        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16879     END-IF
 16880     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16881                                    CP-LOAN-TERM.
 16882     IF NOT CP-TERM-IS-DAYS
 16883         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16884
 16885     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16886
 16887     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16888
 16889     IF AH-COVERAGE-CANCELLED
 16890        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16891        NEXT SENTENCE
 16892      ELSE
 16893         GO TO 3770-CHECK-REFUNDS.
 16894
 16895 3740-GET-AH-REFUND.
 16896
 16897     IF PB-C-AH-CANCEL-VOIDED
 16898        GO TO 3780-UPDATE-CANCEL-CERT
 16899     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 306
* EL050.cbl
 16900
 16901     IF PB-COMPANY-ID = 'BOA'
 16902         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16903         GO TO 3770-CHECK-REFUNDS.
 16904
 16905     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16906*    MOVE ' '                    TO DC-OPTION-CODE
 16907     SET BIN-TO-GREG             TO TRUE
 16908     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16909     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16910                                    PB-C-AH-REM-TERM.
 16911     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16912     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16913
 16914     IF PB-COMPANY-ID EQUAL 'FLC'
 16915        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16916           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16917           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16918                    - CM-AH-ITD-AH-PMT)
 16919           IF PB-C-AH-REF-CALC LESS THAN +0
 16920              MOVE +0            TO PB-C-AH-REF-CALC
 16921              GO TO 3770-CHECK-REFUNDS
 16922           ELSE
 16923              GO TO 3770-CHECK-REFUNDS.
 16924
 16925     IF PB-COMPANY-ID = 'DCC'
 16926        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16927            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16928           MOVE 'S'              TO CP-EARNING-METHOD
 16929        END-IF
 16930     END-IF
 16931     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16932                            OR '4' OR '5' OR '6' OR '8'
 16933                            OR '9' OR 'G' OR 'S'
 16934        MOVE PB-C-AH-REFUND-OVERRIDE
 16935                                 TO CP-EARNING-METHOD.
 16936
 16937     if pb-company-id = 'AHL'
 16938        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16939        if cp-class-code = spaces
 16940           move zeros            to cp-class-code
 16941        end-if
 16942     ELSE
 16943        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16944     END-IF
 16945*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16946     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16947     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16948                                    CP-RATING-BENEFIT-AMT.
 16949     IF CP-STATE-STD-ABBRV = 'OR'
 16950         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16951                                         PB-CI-AH-TERM.
 16952     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16953     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16954     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16955     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16956     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16957     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 307
* EL050.cbl
 16958
 16959     IF CP-STATE-STD-ABBRV = 'OH'
 16960        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16961                                AND 'CID' AND 'DCC' and 'VPP'
 16962                                AND 'AHL')
 16963           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16964              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16965              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16966              MOVE '6' TO CP-EARNING-METHOD
 16967           END-IF
 16968        END-IF
 16969        IF PB-COMPANY-ID = 'CID'
 16970           IF NO-LIFE-COVERAGE
 16971              IF CP-CRITICAL-PERIOD
 16972                 MOVE '2'       TO CP-EARNING-METHOD
 16973              ELSE
 16974                 MOVE '6'       TO CP-EARNING-METHOD
 16975              END-IF
 16976           ELSE
 16977              IF WS-LF-COVERAGE-TYPE = 'L'
 16978                 MOVE '2'       TO CP-EARNING-METHOD
 16979              ELSE
 16980                 IF (PB-CI-LF-TERM > +60) OR
 16981                    (WS-LF-EARNINGS-CALC = '5')
 16982                    IF CP-CRITICAL-PERIOD
 16983                       MOVE '2'  TO CP-EARNING-METHOD
 16984                    ELSE
 16985                       MOVE '6'  TO CP-EARNING-METHOD
 16986                    END-IF
 16987                 ELSE
 16988                    MOVE '1'     TO CP-EARNING-METHOD
 16989                 END-IF
 16990              END-IF
 16991           END-IF
 16992        END-IF
 16993     END-IF
 16994
 16995*    IF CP-STATE-STD-ABBRV = 'VA'
 16996*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16997*          IF CP-ORIGINAL-TERM GREATER 61
 16998*             MOVE '6' TO CP-EARNING-METHOD
 16999*          ELSE
 17000*             MOVE '1' TO CP-EARNING-METHOD.
 17001
 17002     IF WS-DEFAULT-APR NOT NUMERIC
 17003         MOVE ZEROS TO WS-DEFAULT-APR.
 17004     IF CP-EARN-AS-NET-PAY
 17005         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 17006            IF WS-DEFAULT-APR GREATER THAN ZEROS
 17007                MOVE WS-DEFAULT-APR
 17008                                 TO  CP-LOAN-APR
 17009                MOVE ER-3780     TO  WS-ERROR
 17010                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 17011            ELSE
 17012                MOVE ER-3781     TO  WS-ERROR
 17013                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 17014     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 17015     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 308
* EL050.cbl
 17016        AND CP-CANCEL-REASON = 'R'
 17017        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17018        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 17019     END-IF
 17020     IF PB-COMPANY-ID = 'DCC'
 17021        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17022        AND (CP-EARNING-METHOD = 'D')
 17023        AND (CP-CANCEL-REASON NOT = 'R')
 17024        CONTINUE
 17025     ELSE
 17026        GO TO 3750-CONTINUE
 17027     END-IF
 17028     MOVE ' '                    TO DD-IU-SW
 17029     IF NOT PDEF-MASTER-FOUND
 17030        MOVE ' '                 TO PDEF-MASTER-SW
 17031        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 17032        MOVE PB-STATE            TO ERPDEF-STATE
 17033        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 17034           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 17035        END-IF
 17036        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 17037        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 17038        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 17039        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 17040        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 17041        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 17042        IF PDEF-MASTER-FOUND
 17043           MOVE 'N'              TO PDEF-MASTER-SW
 17044           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17045           IF PDEF-MASTER-FOUND
 17046              IF (ERPDEF-KEY-SAVE (1:16) =
 17047                           PD-CONTROL-PRIMARY (1:16))
 17048                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17049                 CONTINUE
 17050              ELSE
 17051                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 17052                 IF (ERPDEF-KEY-SAVE (1:16) =
 17053                           PD-CONTROL-PRIMARY (1:16))
 17054                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 17055                    CONTINUE
 17056                 ELSE
 17057                    MOVE ER-2740 TO WS-ERROR
 17058                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17059                    GO TO 3770-CHECK-REFUNDS
 17060                 END-IF
 17061              END-IF
 17062           END-IF
 17063           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 17064        END-IF
 17065     END-IF
 17066     IF PDEF-MASTER-FOUND
 17067        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 17068           (V1 > +8)
 17069           OR (PD-PROD-CODE (V1) = 'I')
 17070        END-PERFORM
 17071        IF V1 < +9
 17072           SET DD-IU-PRESENT        TO TRUE
 17073        END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 309
* EL050.cbl
 17074        IF WS-AH-DCC-TRUNC = 'T'
 17075           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 17076        ELSE
 17077           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 17078        END-IF
 17079        EVALUATE TRUE
 17080           WHEN WS-TERM > +168
 17081              MOVE 15               TO V1
 17082           WHEN WS-TERM > +156
 17083              MOVE 14               TO V1
 17084           WHEN WS-TERM > +144
 17085              MOVE 13               TO V1
 17086           WHEN WS-TERM > +132
 17087              MOVE 12               TO V1
 17088           WHEN WS-TERM > +120
 17089              MOVE 11               TO V1
 17090           WHEN WS-TERM > +108
 17091              MOVE 10               TO V1
 17092           WHEN WS-TERM > +96
 17093              MOVE 9                TO V1
 17094           WHEN WS-TERM > +84
 17095              MOVE 8                TO V1
 17096           WHEN WS-TERM > +72
 17097              MOVE 7                TO V1
 17098           WHEN WS-TERM > +60
 17099              MOVE 6                TO V1
 17100           WHEN WS-TERM > +48
 17101              MOVE 5                TO V1
 17102           WHEN WS-TERM > +36
 17103              MOVE 4                TO V1
 17104           WHEN WS-TERM > +24
 17105              MOVE 3                TO V1
 17106           WHEN WS-TERM > +12
 17107              MOVE 2                TO V1
 17108           WHEN OTHER
 17109              MOVE 1                TO V1
 17110        END-EVALUATE
 17111
 17112        EVALUATE TRUE
 17113*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 17114*             < +13)
 17115*             AND (DD-IU-PRESENT)
 17116*             MOVE 2                TO V2
 17117*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 17118*             MOVE 1                TO V2
 17119           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 17120              MOVE 2                TO V2
 17121           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 17122              MOVE 3                TO V2
 17123           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 17124              MOVE 4                TO V2
 17125           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 17126              MOVE 5                TO V2
 17127           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 17128              MOVE 6                TO V2
 17129           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 17130              MOVE 7                TO V2
 17131           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 310
* EL050.cbl
 17132              MOVE 8                TO V2
 17133           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 17134              MOVE 9                TO V2
 17135           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 17136              MOVE 10               TO V2
 17137           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 17138              MOVE 11               TO V2
 17139           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 17140              MOVE 12               TO V2
 17141           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 17142              MOVE 13               TO V2
 17143           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 17144              MOVE 14               TO V2
 17145           WHEN OTHER
 17146              MOVE 15               TO V2
 17147        END-EVALUATE
 17148
 17149        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 17150                                 TO CP-DDF-LO-FACT
 17151        MOVE PD-UEP-FACTOR (V1 V2)
 17152                                 TO CP-DDF-HI-FACT
 17153
 17154        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 17155        MOVE CM-AH-CLP     TO CP-DDF-CLP
 17156        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 17157           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 17158        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 17159        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 17160        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 17161           + PD-1ST-YR-ADMIN-ALLOW
 17162
 17163        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 17164*       IF PI-CLP-YN = 'Y'
 17165*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 17166*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 17167*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 17168*       END-IF
 17169
 17170        IF DD-IU-PRESENT
 17171           MOVE 'I'              TO CP-EARNING-METHOD
 17172        END-IF
 17173        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17174                                     CP-CLP-RATE-UP
 17175        IF CP-IU-RATE-UP NOT = ZEROS
 17176           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 17177              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 17178           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 17179              / (1 - WS-WORK-FACT)
 17180        END-IF
 17181     END-IF
 17182     .
 17183 3750-CONTINUE.
 17184     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 17185
 17186     IF CP-REFUND-TYPE-USED NOT = SPACE
 17187         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 17188
 17189     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 311
* EL050.cbl
 17190        CP-ERROR-RATE-NOT-FOUND
 17191        MOVE ER-2740             TO WS-ERROR
 17192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17193
 17194     IF CP-ERROR-RATE-FILE-NOTOPEN
 17195        MOVE ER-2617             TO WS-ERROR
 17196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17197     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17198        AND (PB-CI-ENTRY-STATUS = 'M')
 17199        MOVE +0                  TO PB-C-AH-REF-CALC
 17200     ELSE
 17201        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 17202     END-IF
 17203     if pb-company-id = 'VPP'
 17204        MOVE cm-ah-clp           to cp-original-premium
 17205        move zeros               to cp-calc-refund
 17206        perform 7600-get-refund  thru 7600-exit
 17207        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 17208           move cp-calc-refund   to pb-c-ah-rfnd-clp
 17209        else
 17210           move zeros            to pb-c-ah-rfnd-clp
 17211        end-if
 17212        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 17213           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 17214           pb-ci-cancel-fee
 17215     end-if
 17216     IF PB-COMPANY-ID = 'DCC'
 17217        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 17218        AND (CP-EARNING-METHOD = 'D' OR 'I')
 17219        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 17220        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 17221        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 17222        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 17223        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 17224        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 17225*       if pb-c-cancel-amt < +0
 17226*          compute pb-c-ah-rfnd-clp = pb-c-ah-rfnd-clp * -1
 17227*       end-if
 17228*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 17229     END-IF
 17230     .
 17231 3770-CHECK-REFUNDS.
 17232
 17233     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 17234        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17235           MOVE ER-2766          TO WS-ERROR
 17236           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17237           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 17238           IF PB-C-LF-REF-CALC LESS THAN ZERO
 17239              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 17240
 17241     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 17242        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17243           MOVE ER-2766          TO WS-ERROR
 17244           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17245           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 17246           IF PB-C-AH-REF-CALC LESS THAN ZERO
 17247              MOVE ZEROS         TO PB-C-AH-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 312
* EL050.cbl
 17248
 17249     IF PB-COMP-LF-CANCEL
 17250        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 17251        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17252           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 17253              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 17254
 17255     IF PB-COMP-AH-CANCEL
 17256        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 17257        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 17258           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 17259              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 17260
 17261     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 17262             GIVING WS-UNSIGN-WRK1
 17263     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 17264             GIVING WS-UNSIGN-WRK2.
 17265
 17266     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17267         MOVE ZERO TO WS-UNSIGN-WRK1.
 17268
 17269     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17270         MOVE ZERO TO WS-UNSIGN-WRK2.
 17271
 17272     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 17273
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 313
* EL050.cbl
 17275
 17276 3772-CONTINUE.
 17277
 17278**********************************
 17279*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 17280*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 17281*** DOUBLES THE TOLERANCE AMOUNT.
 17282***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 17283**********************************
 17284     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 17285     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 17286         IF WS-REF-REJECT-SW = SPACE
 17287             MOVE ER-2754        TO WS-ERROR
 17288             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17289           ELSE
 17290             MOVE ER-2736        TO WS-ERROR
 17291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17292**********************************
 17293
 17294 3773-CONTINUE.
 17295
 17296     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 17297        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17298           MOVE ER-2723          TO WS-ERROR
 17299           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17300
 17301     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 17302        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 17303           MOVE ER-2724          TO WS-ERROR
 17304           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17305
 17306     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17307         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 17308             (1 + WS-LF-REFUND-OVS-PCT)
 17309     ELSE
 17310         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 17311
 17312     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 17313         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 17314             (1 - WS-TOL-LF-REFUND-PCT)
 17315     ELSE
 17316         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 17317
 17318     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17319        AND (PB-CI-ENTRY-STATUS = 'M')
 17320        AND (PB-C-LF-CANCEL-AMT > +0)
 17321        MOVE ER-3843             TO WS-ERROR
 17322        PERFORM 9900-ERROR-FORMAT
 17323                                 THRU 9900-EXIT
 17324     END-IF
 17325     EVALUATE TRUE
 17326        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17327           CONTINUE
 17328        WHEN PB-C-LF-CANCEL-AMT = +0
 17329                 AND PB-C-LF-REF-CALC > +0
 17330           CONTINUE
 17331        WHEN WS-LF-REFUND-OVS-AMT = 0
 17332                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 314
* EL050.cbl
 17333           CONTINUE
 17334        WHEN OTHER
 17335           IF WS-TOL-LF-REFUND  = +0
 17336              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 17337           END-IF
 17338           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17339                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 17340                          (PB-C-LF-CANCEL-AMT))
 17341              CONTINUE
 17342           ELSE
 17343              IF WS-LF-REFUND-OVS-AMT = +0
 17344                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 17345              END-IF
 17346              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17347                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 17348                                       PB-C-LF-CANCEL-AMT)
 17349                 CONTINUE
 17350              ELSE
 17351                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17352                   MOVE ER-2754   TO  WS-ERROR
 17353                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17354                 ELSE
 17355                    MOVE ER-2736   TO  WS-ERROR
 17356                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17357                 END-IF
 17358              END-IF
 17359           END-IF
 17360     END-EVALUATE.
 17361
 17362     EVALUATE TRUE
 17363        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 17364           CONTINUE
 17365        WHEN PB-C-LF-CANCEL-AMT = +0
 17366                 AND PB-C-LF-REF-CALC > +0
 17367           CONTINUE
 17368        WHEN OTHER
 17369           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 17370               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 17371              CONTINUE
 17372           ELSE
 17373              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 17374               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 17375                CONTINUE
 17376              ELSE
 17377                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17378                     MOVE ER-2754   TO  WS-ERROR
 17379                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17380                 ELSE
 17381                     MOVE ER-2736   TO  WS-ERROR
 17382                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17383                 END-IF
 17384              END-IF
 17385           END-IF
 17386     END-EVALUATE.
 17387
 17388     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 17389         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 17390             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 315
* EL050.cbl
 17391     ELSE
 17392         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 17393
 17394     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 17395         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 17396             (1 - WS-TOL-AH-REFUND-PCT)
 17397     ELSE
 17398         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 17399
 17400     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17401        AND (PB-CI-ENTRY-STATUS = 'M')
 17402        AND (PB-C-AH-CANCEL-AMT > +0)
 17403        MOVE ER-3843             TO WS-ERROR
 17404        PERFORM 9900-ERROR-FORMAT
 17405                                 THRU 9900-EXIT
 17406     END-IF
 17407     EVALUATE TRUE
 17408        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 17409           CONTINUE
 17410*       WHEN PB-C-AH-REF-CALC = +0 AND
 17411*                  PB-C-AH-CANCEL-AMT > +0
 17412        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 17413                   PB-C-AH-REF-CALC > +0
 17414           CONTINUE
 17415        WHEN WS-AH-REFUND-OVS-AMT = +0
 17416                AND WS-TOL-AH-REFUND = +0
 17417           CONTINUE
 17418        WHEN OTHER
 17419           IF WS-TOL-AH-REFUND = +0
 17420              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 17421           END-IF
 17422           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 17423               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 17424                                         PB-C-AH-CANCEL-AMT)
 17425              CONTINUE
 17426           ELSE
 17427              IF WS-AH-REFUND-OVS-AMT = +0
 17428                 MOVE +9999999.99 TO
 17429                         WS-AH-REFUND-OVS-AMT
 17430              END-IF
 17431              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17432                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 17433                                         PB-C-AH-CANCEL-AMT)
 17434                 CONTINUE
 17435              ELSE
 17436                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17437                    MOVE ER-2754   TO  WS-ERROR
 17438                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17439                 ELSE
 17440                    MOVE ER-2736   TO  WS-ERROR
 17441                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17442                 END-IF
 17443              END-IF
 17444           END-IF
 17445     END-EVALUATE.
 17446
 17447     EVALUATE TRUE
 17448        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 316
* EL050.cbl
 17449           CONTINUE
 17450*       WHEN PB-C-AH-REF-CALC > +0 AND
 17451*                  PB-C-AH-CANCEL-AMT = +0
 17452        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 17453                   PB-C-AH-REF-CALC = +0
 17454           CONTINUE
 17455        WHEN OTHER
 17456           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 17457               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 17458              CONTINUE
 17459           ELSE
 17460              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 17461                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 17462                 CONTINUE
 17463              ELSE
 17464                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 17465                     MOVE ER-2754   TO  WS-ERROR
 17466                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17467                 ELSE
 17468                     MOVE ER-2736   TO  WS-ERROR
 17469                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17470                 END-IF
 17471              END-IF
 17472           END-IF
 17473     END-EVALUATE.
 17474
 17475     IF (PB-C-LF-CANCEL-AMT = ZERO)
 17476        AND (PB-C-AH-CANCEL-AMT = ZERO)
 17477        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17478           AND  PB-C-LF-REF-CALC < +1.00
 17479           AND  PB-C-AH-REF-CALC < +1.00
 17480           CONTINUE
 17481        ELSE
 17482           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 17483              AND (PB-CI-ENTRY-STATUS = 'M')
 17484              CONTINUE
 17485           ELSE
 17486              MOVE ER-2741       TO WS-ERROR
 17487              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17488           END-IF
 17489        END-IF
 17490     END-IF
 17491
 17492     IF (PB-C-LF-CANCEL-AMT = ZERO
 17493        AND WS-LF-BENEFIT-CD NOT = ZERO
 17494        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 17495        AND PB-C-LF-REF-CALC NOT = ZERO)
 17496        OR
 17497        (PB-C-LF-CANCEL-AMT = ZERO
 17498        AND WS-LF-BENEFIT-CD NOT = ZERO
 17499        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 17500             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17501                AND PB-C-LF-REF-CALC LESS THAN +1.00
 17502                NEXT SENTENCE
 17503             ELSE
 17504                MOVE ER-2739        TO WS-ERROR
 17505                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17506
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 317
* EL050.cbl
 17507     IF (PB-C-AH-CANCEL-AMT = ZERO
 17508        AND WS-AH-BENEFIT-CD NOT = ZERO
 17509        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 17510        AND PB-C-AH-REF-CALC NOT = ZERO)
 17511        OR
 17512        (PB-C-AH-CANCEL-AMT = ZERO
 17513        AND WS-AH-BENEFIT-CD NOT = ZERO
 17514        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 17515             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 17516                AND PB-C-AH-REF-CALC LESS THAN +1.00
 17517                NEXT SENTENCE
 17518             ELSE
 17519                MOVE ER-2738        TO WS-ERROR
 17520                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17521
 17522 3775-OVER-REF-CHK.
 17523
 17524     IF PB-CI-ENTRY-STATUS = '5'
 17525        GO TO 3780-UPDATE-CANCEL-CERT.
 17526
 17527     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 17528                              PB-CI-LF-ALT-PREMIUM-AMT.
 17529
 17530     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17531        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17532                                 PB-C-LF-REF-CALC
 17533      ELSE
 17534        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17535                                 PB-C-LF-CANCEL-AMT.
 17536
 17537     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17538        MOVE ER-2755             TO WS-ERROR
 17539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17540
 17541     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17542
 17543     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17544        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17545                                 PB-C-AH-REF-CALC
 17546      ELSE
 17547        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17548                                 PB-C-AH-CANCEL-AMT.
 17549
 17550     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17551        MOVE ER-2778             TO WS-ERROR
 17552        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17553
 17554     IF PB-CI-OB-FLAG NOT = 'Z'
 17555        NEXT SENTENCE
 17556       ELSE
 17557         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17558            MOVE ER-2757           TO WS-ERROR
 17559            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17560
 17561 3780-UPDATE-CANCEL-CERT.
 17562
 17563     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17564        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 318
* EL050.cbl
 17565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17566
 17567     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17568         MOVE ER-2729              TO WS-ERROR
 17569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17570
 17571     IF PB-CI-LF-BENEFIT-CD = ZERO
 17572         GO TO 3780-UPDATE-CONT-1.
 17573
 17574     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17575         GO TO 3780-UPDATE-CONT-1.
 17576
 17577     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17578       AND
 17579        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17580       AND
 17581        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17582       AND
 17583        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17584            NEXT SENTENCE
 17585       ELSE
 17586        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17587          AND
 17588***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17589***       AND
 17590           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17591            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17592               MOVE ER-2730      TO WS-ERROR
 17593               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17594               GO TO 3999-END-EDIT
 17595            ELSE
 17596               GO TO 3999-END-EDIT
 17597        ELSE
 17598            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17599               MOVE ER-2765           TO WS-ERROR
 17600               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17601               GO TO 3785-CHECK-REF-INT.
 17602*              GO TO 3999-END-EDIT.
 17603
 17604 3780-UPDATE-CONT-1.
 17605     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17606
 17607     IF PB-CI-AH-BENEFIT-CD = ZERO
 17608         GO TO 3780-UPDATE-CONT-2.
 17609
 17610     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17611         GO TO 3780-UPDATE-CONT-2.
 17612
 17613     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17614
 17615     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17616       AND
 17617        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17618       AND
 17619        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17620       AND
 17621        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17622            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 319
* EL050.cbl
 17623       ELSE
 17624        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17625          AND
 17626***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17627***       AND
 17628           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17629           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17630            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17631               MOVE ER-2773      TO WS-ERROR
 17632               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17633               GO TO 3999-END-EDIT
 17634            ELSE
 17635               GO TO 3999-END-EDIT
 17636            END-IF
 17637           ELSE
 17638             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17639                IF MSTR-CERT-NO = W-CL-CERT-NO
 17640                   MOVE ER-2890 TO WS-ERROR
 17641                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17642                   GO TO 3999-END-EDIT
 17643                ELSE
 17644                   MOVE ER-2898 TO WS-ERROR
 17645                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17646                   GO TO 3999-END-EDIT
 17647                END-IF
 17648             ELSE
 17649                GO TO 3785-CHECK-REF-INT
 17650             END-IF
 17651           END-IF
 17652          ELSE
 17653            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17654              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17655                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17656                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17657                      MOVE ER-2890 TO WS-ERROR
 17658                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17659                      GO TO 3999-END-EDIT
 17660                   ELSE
 17661                      MOVE ER-2898 TO WS-ERROR
 17662                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17663                      GO TO 3999-END-EDIT
 17664                   END-IF
 17665                ELSE
 17666                   MOVE ER-2765 TO WS-ERROR
 17667                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17668                   GO TO 3785-CHECK-REF-INT
 17669                END-IF
 17670              ELSE
 17671               MOVE ER-2765      TO WS-ERROR
 17672               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17673               GO TO 3785-CHECK-REF-INT.
 17674*              GO TO 3999-END-EDIT.
 17675
 17676 3780-UPDATE-CONT-2.
 17677
 17678     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17679        AND WS-LF-BENEFIT-CD = ZERO
 17680           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 320
* EL050.cbl
 17681           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17682
 17683     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17684        AND WS-AH-BENEFIT-CD = ZERO
 17685           MOVE ER-2744           TO WS-ERROR
 17686           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17687
 17688     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17689        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17690        AND
 17691        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17692         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17693           MOVE ER-2746           TO WS-ERROR
 17694           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17695
 17696     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17697       AND
 17698        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17699             MOVE ER-2737        TO WS-ERROR
 17700             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17701
 17702     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17703       AND
 17704        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17705             MOVE ER-2737        TO WS-ERROR
 17706             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17707
 17708     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17709         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17710             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17711             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17712         ELSE
 17713             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17714                 MOVE ER-2768    TO WS-ERROR
 17715                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17716             ELSE
 17717                 MOVE ER-2756    TO WS-ERROR
 17718                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17719
 17720     IF CERT-PEND-ISSUE-RETURNED
 17721        MOVE ER-2772             TO WS-ERROR
 17722        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17723 3785-CHECK-REF-INT.
 17724*    IF PB-STATE NOT = 'NH' and 'TN'
 17725     IF PB-STATE NOT = 'NH'
 17726        GO TO 3999-END-EDIT
 17727     END-IF
 17728
 17729     MOVE ER-2796                TO WS-ERROR
 17730     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17731     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17732        OR (CM-REF-INTERFACE-SW = 'Y')
 17733        MOVE ER-2793             TO WS-ERROR
 17734        PERFORM 9900-ERROR-FORMAT
 17735                                 THRU 9900-EXIT
 17736     END-IF
 17737     MOVE +0                     TO WS-PAYMENT-AMT
 17738     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 321
* EL050.cbl
 17739        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17740               PB-C-AH-CANCEL-DT
 17741           GO TO 3999-END-EDIT
 17742        END-IF
 17743     end-if
 17744***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17745***-_-
 17746***-_-   For TN it's only flat cancels
 17747***-_-
 17748***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17749     if pb-state = 'TN'
 17750        if ((pb-c-lf-cancel-dt <> low-values)
 17751           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17752                      or
 17753           ((pb-c-ah-cancel-dt <> low-values)
 17754           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17755           GO TO 3999-END-EDIT
 17756        END-IF
 17757     end-if
 17758     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17759        GO TO 3999-END-EDIT
 17760     END-IF
 17761***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17762***-_-
 17763***-_-   if cancel date within 15 days of effective date, bypass
 17764***-_-
 17765***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17766     IF PB-STATE NOT = 'NH'
 17767        GO TO 3785-CONTINUE
 17768     END-IF
 17769     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17770     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17771     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17772        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17773     END-IF
 17774     MOVE '1'                    TO DC-OPTION-CODE
 17775     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17776     IF NO-CONVERSION-ERROR
 17777        IF DC-ELAPSED-DAYS < +16
 17778           GO TO 3999-END-EDIT
 17779        END-IF
 17780     END-IF
 17781***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17782***-_-
 17783***-_-   if cancel date within 30 days of current date then
 17784***-_-   bypass else subtract 15 days from period
 17785***-_-
 17786***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17787     MOVE +0                     TO DC-ELAPSED-DAYS
 17788     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17789     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17790     MOVE '1'                    TO DC-OPTION-CODE
 17791     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17792     IF NO-CONVERSION-ERROR
 17793        IF DC-ELAPSED-DAYS > +30
 17794           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17795        ELSE
 17796           GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 322
* EL050.cbl
 17797        END-IF
 17798     ELSE
 17799        GO TO 3999-END-EDIT
 17800     END-IF
 17801     .
 17802 3785-CONTINUE.
 17803     if pb-state = 'TN'
 17804        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 17805        MOVE PB-INPUT-DT         TO DC-BIN-DATE-2
 17806        MOVE '1'                 TO DC-OPTION-CODE
 17807        PERFORM 8500-DATE-CONVERT
 17808                                 THRU 8500-EXIT
 17809        IF no-CONVERSION-ERROR
 17810           IF DC-ELAPSED-DAYS < +16
 17811              GO TO 3999-END-EDIT
 17812           END-IF
 17813        END-IF
 17814     end-if
 17815***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17816***-_-
 17817***-_-   'NH' is 10%, TN is 3.5%
 17818***-_-
 17819***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17820*    if pb-state = 'NH'
 17821*       move +1.10               to ws-work-rate
 17822*    else
 17823*       move +1.035              to ws-work-rate
 17824*    end-if
 17825     compute ws-work-rate = (1 + ws-st-refund-int-rate)
 17826     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17827        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17828           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17829     IF WS-PAYMENT-AMT < 10.00
 17830        GO TO 3999-END-EDIT
 17831     END-IF
 17832*    PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17833
 17834     if (cm-soc-sec-no(1:9) numeric)
 17835        and (cm-soc-sec-no(1:9) not = zeros)
 17836        GO TO 3999-END-EDIT
 17837     END-IF
 17838     MOVE ER-2795                TO WS-ERROR
 17839     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17840
 17841     GO TO 3999-END-EDIT.
 17842******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 323
* EL050.cbl
 17844 3990-FILES-NOT-OPEN.
 17845
 17846     MOVE ER-2617                TO WS-ERROR.
 17847     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17848     GO TO 9990-RETURN.
 17849
 17850 3999-END-EDIT.
 17851
 17852     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17853
 17854     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17855         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17856         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17857             PERFORM 9250-UNLOCK-RETURN
 17858             GO TO 9990-RETURN
 17859          ELSE
 17860             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17861             GO TO 9990-RETURN.
 17862
 17863     IF PB-CANCELLATION
 17864          GO TO 9990-RETURN.
 17865
 17866     IF CERT-WAS-NOT-FOUND
 17867        MOVE SPACES              TO CERTIFICATE-MASTER.
 17868
 17869     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17870
 17871     IF CERT-WAS-FOUND
 17872         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17873             PERFORM 9250-UNLOCK-RETURN
 17874          ELSE
 17875            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17876      ELSE
 17877         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17878
 17879*    if pb-company-id = 'VPP'
 17880*       perform 8150-read-elcrtt thru 8150-exit
 17881*       if ws-vehicle-odometer numeric
 17882*          if ws-vehicle-odometer > 6000
 17883*             move er-1583       to ws-error
 17884*             PERFORM 9900-ERROR-FORMAT
 17885*                                THRU 9900-EXIT
 17886*          end-if
 17887*       end-if
 17888*    end-if
 17889     if (pb-cert-sfx not = ' ')
 17890                 or
 17891        (pb-i-entry-status = 'V')
 17892        perform 7320-CHECK-FOR-OPEN-CLMS-issue
 17893                                 thru 7320-exit
 17894     end-if
 17895     perform 8145-read-elcrtt-upd thru 8145-exit
 17896     if not elcrtt-found
 17897        move 'CS'                to certificate-trailers
 17898        move cm-control-primary  to cs-control-primary
 17899        move 'C'                 TO cs-trailer-type
 17900        move zeros               to cs-vehicle-odometer
 17901     end-if
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 324
* EL050.cbl
 17902     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17903        IF ((PB-COMPANY-ID = 'DCC')
 17904           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17905                         or
 17906           (pb-company-id = 'CID' or 'VPP')
 17907           IF (PB-I-VIN NOT EQUAL CS-VIN-NUMBER)
 17908               or (hldi-pass-area not = spaces)
 17909               move pa-modelyear        to cs-year
 17910               move pa-makename         to cs-make
 17911               move pa-modelname        to cs-model
 17912               move pa-seriesname       to cs-future
 17913               MOVE PB-I-VIN            TO CS-VIN-NUMBER
 17914               move 'Y'                 to elcrtt-update-sw
 17915           end-if
 17916        end-if
 17917     end-if
 17918     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17919        IF WS-INS-AGE-SET = 'Y'
 17920           MOVE WS-INS-AGE-DEFAULTED
 17921                                 TO CS-INS-AGE-DEFAULT-FLAG
 17922           move 'Y'              to elcrtt-update-sw
 17923        END-IF
 17924        IF WS-JNT-AGE-SET = 'Y'
 17925           MOVE WS-JNT-AGE-DEFAULTED
 17926                                 TO CS-JNT-AGE-DEFAULT-FLAG
 17927           move 'Y'              to elcrtt-update-sw
 17928        END-IF
 17929     end-if
 17930     move cs-ins-age-default-flag to ws-ins-age-defaulted
 17931     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 17932     move cs-vehicle-odometer    to ws-vehicle-odometer
 17933     if ws-ins-age-defaulted = 'Y'
 17934        move er-1573             to ws-error
 17935        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17936     end-if
 17937
 17938     if ws-jnt-age-defaulted = 'Y'
 17939        move er-1574             to ws-error
 17940        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17941     end-if
 17942***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17943***                                                           ****
 17944***  Set an error if the state requires verification of agent ****
 17945***  and agent hasn't verified yet and the status is not =    ****
 17946***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17947***  and the entry date > 09/01/2015.                         ****
 17948***                                                           ****
 17949***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17950     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17951        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17952        and (pb-account (9:2) not = 'OB')
 17953        if (ws-st-agent-sig-edit = 'Y')
 17954           and (am-report-code-1 not = 'CONLEY')
 17955           evaluate true
 17956              when cs-agent-edit-status = 'C'
 17957                 move er-1743    to ws-error
 17958                 perform 9900-error-format
 17959                                 thru 9900-exit
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 325
* EL050.cbl
 17960              when cs-agent-edit-status = 'S'
 17961                 move er-1744    to ws-error
 17962                 perform 9900-error-format
 17963                                 thru 9900-exit
 17964              when cs-agent-edit-status = 'M'
 17965                 move er-1745    to ws-error
 17966                 perform 9900-error-format
 17967                                 thru 9900-exit
 17968              when cs-agent-edit-status = 'R'
 17969                 move er-1747    to ws-error
 17970                 perform 9900-error-format
 17971                                 thru 9900-exit
 17972              when cs-agent-edit-status = 'N'
 17973                 move er-1748    to ws-error
 17974                 perform 9900-error-format
 17975                                 thru 9900-exit
 17976              when cs-agent-edit-status <> 'V' and 'U' and
 17977                                           'R' and 'N' and
 17978                                           'H'
 17979                 move er-1746    to ws-error
 17980                 perform 9900-error-format
 17981                                 thru 9900-exit
 17982           end-evaluate
 17983        end-if
 17984     end-if
 17985*    move ' ' to cs-claim-verification-status
 17986*    move 'Y' to elcrtt-update-sw
 17987     if cs-claim-verification-status = ' ' or 'R'
 17988        move pb-state            to pa-clmhs-state
 17989        move pb-account          to pa-account
 17990        move ws-greg-eff-date    to pa-eff-dt
 17991        move pb-cert-no          to pa-cert-no
 17992        perform 7795-call-sqlclmhs
 17993                                 thru 7795-exit
 17994        if pa-clm-count > 0
 17995           if cs-claim-verification-status = ' '
 17996              move 'R'           to cs-claim-verification-status
 17997*             display 'Updating elcrtt ' pb-state ' '
 17998*                pb-account ' ' pb-cert-no
 17999              move 'Y'           to elcrtt-update-sw
 18000           end-if
 18001        else
 18002           if cs-claim-verification-status = 'R'
 18003              move ' '           to cs-claim-verification-status
 18004              move 'Y'           to elcrtt-update-sw
 18005           end-if
 18006        end-if
 18007     end-if
 18008
 18009     if cs-claim-verification-status <> ' '
 18010        evaluate true
 18011           when cs-claim-verification-status = 'R'
 18012              move er-1749    to ws-error
 18013              perform 9900-error-format
 18014                              thru 9900-exit
 18015           when cs-claim-verification-status = 'W'
 18016              move er-1750    to ws-error
 18017              perform 9900-error-format
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 326
* EL050.cbl
 18018                              thru 9900-exit
 18019           when cs-claim-verification-status = 'I'
 18020              move er-1751    to ws-error
 18021              perform 9900-error-format
 18022                              thru 9900-exit
 18023           when cs-claim-verification-status = 'K'
 18024              move er-1761    to ws-error
 18025              perform 9900-error-format
 18026                              thru 9900-exit
 18027           when cs-claim-verification-status = 'A'
 18028              move er-1752    to ws-error
 18029              perform 9900-error-format
 18030                              thru 9900-exit
 18031           when cs-claim-verification-status = 'B'
 18032              move er-1754    to ws-error
 18033              perform 9900-error-format
 18034                              thru 9900-exit
 18035           when cs-claim-verification-status = 'C'
 18036              move er-1753    to ws-error
 18037              perform 9900-error-format
 18038                              thru 9900-exit
 18039           when cs-claim-verification-status = 'D'
 18040              move er-1757    to ws-error
 18041              perform 9900-error-format
 18042                              thru 9900-exit
 18043           when cs-claim-verification-status = 'E'
 18044              move er-1758    to ws-error
 18045              perform 9900-error-format
 18046                              thru 9900-exit
 18047           when cs-claim-verification-status = 'F'
 18048              move er-1759    to ws-error
 18049              perform 9900-error-format
 18050                              thru 9900-exit
 18051           when cs-claim-verification-status = 'G'
 18052              move er-1760    to ws-error
 18053              perform 9900-error-format
 18054                              thru 9900-exit
 18055*          when cs-claim-verification-status = 'H'
 18056*             move er-1756    to ws-error
 18057*             perform 9900-error-format
 18058*                             thru 9900-exit
 18059*          when cs-claim-verification-status = 'J'
 18060*             move er-1755    to ws-error
 18061*             perform 9900-error-format
 18062*                             thru 9900-exit
 18063        end-evaluate
 18064     end-if
 18065
 18066     IF ELCRTT-UPDATE
 18067        perform 8150-update-elcrtt thru 8150-exit
 18068*       display ' back from 8150 ' elcrtt-file-status
 18069     else
 18070        if elcrtt-found
 18071           perform 8155-unlock-elcrtt
 18072                                 thru 8155-exit
 18073        end-if
 18074     end-if
 18075     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 327
* EL050.cbl
 18076     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 18077        AND (WS-NO-SECURE-PAY))
 18078                  OR
 18079        (WS-LF-SPECIAL-CALC-CD = 'O'
 18080        OR WS-AH-SPECIAL-CALC-CD = 'O')
 18081        SET SKIP-ADDR-EDIT       TO TRUE
 18082     END-IF
 18083     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 18084        AND (NOT SKIP-ADDR-EDIT)
 18085        MOVE ER-2963             TO WS-ERROR
 18086        PERFORM 9900-ERROR-FORMAT
 18087                                 THRU 9900-EXIT
 18088        GO TO 9990-RETURN
 18089     END-IF
 18090     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 18091     IF ERPNDM-FOUND NOT = 'X'
 18092        move 'Y'                 to erpndm-unlock-sw
 18093        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18094           OR (PM-CITY        = SPACES OR LOW-VALUES)
 18095           OR (PM-STATE       = SPACES OR LOW-VALUES)
 18096           OR (PM-ZIP         = SPACES OR LOW-VALUES)
 18097           or (pm-zip-code    = zeros)
 18098           or (pm-zip-code not numeric))
 18099           AND (NOT SKIP-ADDR-EDIT)
 18100           MOVE ER-2694          TO WS-ERROR
 18101           PERFORM 9900-ERROR-FORMAT
 18102                                 THRU 9900-EXIT
 18103        END-IF
 18104        MOVE ' '                 TO STATE-RECORD-ERROR
 18105        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18106        MOVE PM-STATE            TO CNTL-ACCESS
 18107        MOVE '3'                 TO CNTL-REC-TYPE
 18108        MOVE +0                  TO CNTL-SEQ-NO
 18109        MOVE '0'                 TO RC-SW-2
 18110        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18111        IF (NO-STATE-RECORD)
 18112           OR (CF-RECORD-TYPE NOT = '3')
 18113           OR (PM-STATE NOT = CF-STATE-CODE)
 18114           IF (PM-STATE = SPACES)
 18115              AND (SKIP-ADDR-EDIT)
 18116              CONTINUE
 18117           ELSE
 18118              MOVE ER-2963       TO WS-ERROR
 18119              PERFORM 9900-ERROR-FORMAT
 18120                                 THRU 9900-EXIT
 18121           END-IF
 18122        END-IF
 18123        if (ws-error not = er-2963 and er-2694)
 18124           and (pm-city-st-zip-verified = ' ')
 18125           and (pb-company-id = 'CID')
 18126           move spaces           to zipcd-pass-area
 18127           move pm-zip-code      to pa-zip
 18128           move pm-city          to pa-city
 18129           move pm-state         to pa-state
 18130           perform 7790-call-zip-verify
 18131                                 thru 7790-exit
 18132           if pa-errorcode-zip (1:1) = ' '
 18133                    move 'Y'     to pm-city-st-zip-verified
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 328
* EL050.cbl
 18134                    PERFORM 8102-REWRITE-ERPNDM
 18135                                 THRU 8102-EXIT
 18136                    move 'N'     to erpndm-unlock-sw
 18137           else
 18138              MOVE ER-3061       TO WS-ERROR
 18139              PERFORM 9900-ERROR-FORMAT
 18140                                 THRU 9900-EXIT
 18141           end-if
 18142        end-if
 18143        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 18144           MOVE ER-2883          TO WS-ERROR
 18145           PERFORM 9900-ERROR-FORMAT
 18146                                 THRU 9900-EXIT
 18147        END-IF
 18148        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 18149           MOVE ' '                 TO STATE-RECORD-ERROR
 18150           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 18151           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 18152           MOVE '3'                 TO CNTL-REC-TYPE
 18153           MOVE +0                  TO CNTL-SEQ-NO
 18154           MOVE '0'                 TO RC-SW-2
 18155           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 18156           IF NO-STATE-RECORD
 18157              OR (CF-RECORD-TYPE NOT = '3')
 18158              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 18159              MOVE ER-2964          TO WS-ERROR
 18160              PERFORM 9900-ERROR-FORMAT
 18161                                    THRU 9900-EXIT
 18162           END-IF
 18163        END-IF
 18164     ELSE
 18165        IF NOT SKIP-ADDR-EDIT
 18166           MOVE ER-2393          TO WS-ERROR
 18167           PERFORM 9900-ERROR-FORMAT
 18168                                 THRU 9900-EXIT
 18169        END-IF
 18170     END-IF
 18171     if need-to-unlock-erpndm
 18172        perform 8104-unlock-erpndm
 18173                                 thru 8104-exit
 18174     end-if
 18175     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 18176
 18177     IF (ERMAIL-FOUND = ' ' AND
 18178        ERPNDM-FOUND = ' ')
 18179        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 18180           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 18181           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 18182          OR
 18183           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 18184          OR
 18185           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 18186           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 18187           GO TO 3999-UNLOCK-ERMAIL.
 18188
 18189     IF ERPNDM-FOUND = 'X'
 18190        GO TO 3999-UNLOCK-ERMAIL.
 18191
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 329
* EL050.cbl
 18192     IF PM-INSURED-LAST-NAME      = SPACES
 18193        AND PM-INSURED-FIRST-NAME = SPACES
 18194        AND PM-ADDRESS-LINE-1     = SPACES
 18195        AND PM-ADDRESS-LINE-2     = SPACES
 18196        AND PM-CITY-STATE         = SPACES
 18197        AND PM-CRED-BENE-NAME     = SPACES
 18198        AND PM-CRED-BENE-ADDR     = SPACES
 18199        AND PM-CRED-BENE-CTYST    = SPACES
 18200        GO TO 3999-UNLOCK-ERMAIL
 18201     END-IF
 18202
 18203     MOVE SPACES                 TO MAILING-DATA.
 18204
 18205     MOVE 'MA'                   TO MA-RECORD-ID.
 18206     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18207     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 18208     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18209     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18210     MOVE PB-SV-STATE            TO MA-STATE.
 18211     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 18212     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 18213
 18214     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 18215     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 18216
 18217     IF ERMAIL-FOUND = ' '
 18218        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 18219     ELSE
 18220        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 18221        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 18222        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 18223
 18224     GO TO 9990-RETURN.
 18225
 18226 3999-UNLOCK-ERMAIL.
 18227     IF ERMAIL-FOUND = ' '
 18228        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 18229
 18230     GO TO 9990-RETURN.
 18231******************************************************************
 18232
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 330
* EL050.cbl
 18234 4000-UPDATE-CANCELLED-CERT.
 18235     IF CERT-WAS-NOT-FOUND
 18236        GO TO 4299-EXIT.
 18237
 18238*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 18239     IF PB-C-INT-ON-REFS > ZEROS
 18240        MOVE PB-C-INT-ON-REFS TO CM-INT-ON-REFS
 18241     END-IF
 18242     IF PB-C-REF-INTERFACE-SW = 'Y'
 18243        MOVE PB-C-REF-INTERFACE-SW
 18244                                 TO CM-ref-INTERFACE-SW
 18245     END-IF
 18246*    IF ERMAIL-FOUND = ' '
 18247*       PERFORM 8140-UNLOCK-ERMAIL
 18248*                                THRU 8140-EXIT
 18249*    end-if
 18250     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18251     IF ERMAIL-FOUND = 'X'
 18252        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 18253        OR (MA-CITY        = SPACES OR LOW-VALUES)
 18254        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 18255        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 18256           MOVE ER-2694          TO WS-ERROR
 18257           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18258     END-IF
 18259
 18260     IF PB-C-POST-CARD-IND = 'Y'
 18261        MOVE +8                  TO SUB
 18262*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 18263        IF ERMAIL-FOUND = ' '
 18264           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 18265              (SUB > +7)
 18266              OR (MA-MAIL-STATUS (SUB) = '1')
 18267           END-PERFORM
 18268        END-IF
 18269        IF (SUB > +7)
 18270           OR (ERMAIL-FOUND = 'X')
 18271           MOVE ER-3789          TO WS-ERROR
 18272           PERFORM 9900-ERROR-FORMAT
 18273                                 THRU 9900-EXIT
 18274        END-IF
 18275     ELSE
 18276        MOVE 'N'                 TO PB-C-POST-CARD-IND
 18277     END-IF
 18278
 18279     IF ERMAIL-FOUND = ' '
 18280        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 18281     END-IF.
 18282
 18283     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 18284
 18285     IF PB-CI-OB-FLAG = 'Z'
 18286        GO TO 4150-SUMMARY-CERT-CANCEL.
 18287     perform 8145-read-elcrtt-upd thru 8145-exit
 18288     if not elcrtt-found
 18289        move 'CS'                to certificate-trailers
 18290        move cm-control-primary  to cs-control-primary
 18291        move 'C'                 TO cs-trailer-type
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 331
* EL050.cbl
 18292        move zeros               to cs-vehicle-odometer
 18293     end-if
 18294
 18295     if pb-lf-refund-type <> cs-lf-refund-method
 18296        move pb-lf-refund-type   to cs-lf-refund-method
 18297        set elcrtt-update to true
 18298     end-if
 18299     if pb-ah-refund-type <> cs-ah-refund-method
 18300        move pb-ah-refund-type   to cs-ah-refund-method
 18301        set elcrtt-update to true
 18302     end-if
 18303     IF PB-C-LF-CANCEL-VOIDED
 18304         PERFORM 4200-REVERSE-LF-CANCEL.
 18305     IF PB-C-AH-CANCEL-VOIDED
 18306         PERFORM 4200-REVERSE-AH-CANCEL.
 18307     IF ELCRTT-UPDATE
 18308        perform 8150-update-elcrtt thru 8150-exit
 18309     else
 18310        if elcrtt-found
 18311           perform 8155-unlock-elcrtt
 18312                                 thru 8155-exit
 18313        end-if
 18314     end-if
 18315     .
 18316 4100-APPLY-LF-CANCEL.
 18317
 18318     MOVE +0                     TO WS-SUB.
 18319
 18320 4100-CHECK-LF-ERRORS.
 18321
 18322     ADD +1                       TO WS-SUB.
 18323
 18324     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18325        IF LF-COVERAGE-CANCELLED
 18326           GO TO 4100-LF-CANCEL-CONT
 18327        ELSE
 18328           GO TO 4100-UPDATE-LF-COVERAGE.
 18329
 18330     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18331                                   ER-2729 OR
 18332                                   ER-2730 OR
 18333                                   ER-2731 OR
 18334                                   ER-2732 OR
 18335                                   ER-2737 OR
 18336                                   ER-2740 OR
 18337                                   ER-2743 OR
 18338                                   ER-2749 OR
 18339                                   ER-2750 OR
 18340                                   ER-2755 OR
 18341                                   ER-2757 OR
 18342                                   ER-2760 OR
 18343                                   ER-2772 OR
 18344                                   ER-2774 OR
 18345                                   ER-2776 OR
 18346                                   ER-2794
 18347        GO TO 4100-UPDATE-LF-COVERAGE.
 18348
 18349     GO TO 4100-CHECK-LF-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 332
* EL050.cbl
 18350
 18351 4100-UPDATE-LF-COVERAGE.
 18352
 18353     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 18354     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 18355     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 18356        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 18357     END-IF
 18358     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18359                                      TO CM-CREDIT-INTERFACE-SW-2.
 18360     IF CM-LF-CANCEL-DT = LOW-VALUE
 18361         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 18362
 18363     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 18364         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 18365                                         CM-LF-STATUS-AT-CANCEL.
 18366
 18367     GO TO 4100-APPLY-AH-CANCEL.
 18368
 18369 4100-LF-CANCEL-CONT.
 18370     IF PB-C-LF-CANCEL-VOIDED
 18371         GO TO 4100-APPLY-AH-CANCEL.
 18372
 18373     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18374         GO TO 4100-APPLY-AH-CANCEL.
 18375
 18376     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 18377        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18378           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 18379        ELSE
 18380           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 18381
 18382     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 18383     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 18384
 18385     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 18386         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 18387
 18388     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 18389        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 18390         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 18391         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 18392
 18393     IF PB-RECORD-RETURNED
 18394        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18395      ELSE
 18396        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 18397
 18398 4100-APPLY-AH-CANCEL.
 18399
 18400     MOVE +0                      TO WS-SUB.
 18401
 18402 4100-CHECK-AH-ERRORS.
 18403
 18404     ADD +1                       TO WS-SUB.
 18405
 18406     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 18407        IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 333
* EL050.cbl
 18408           GO TO 4100-AH-CANCEL-CONT
 18409        ELSE
 18410           GO TO 4100-UPDATE-AH-COVERAGE.
 18411
 18412     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 18413                                   ER-2729 OR
 18414                                   ER-2732 OR
 18415                                   ER-2737 OR
 18416                                   ER-2740 OR
 18417                                   ER-2744 OR
 18418                                   ER-2749 OR
 18419                                   ER-2750 OR
 18420                                   ER-2755 OR
 18421                                   ER-2757 OR
 18422                                   ER-2760 OR
 18423                                   ER-2771 OR
 18424                                   ER-2772 OR
 18425                                   ER-2773 OR
 18426                                   ER-2775 OR
 18427                                   ER-2777 OR
 18428                                   ER-2778 OR
 18429                                   ER-2794
 18430        GO TO 4100-UPDATE-AH-COVERAGE.
 18431
 18432     GO TO 4100-CHECK-AH-ERRORS.
 18433
 18434 4100-UPDATE-AH-COVERAGE.
 18435
 18436     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 18437     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 18438     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 18439     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 18440                                      TO CM-CREDIT-INTERFACE-SW-2.
 18441     IF CM-AH-CANCEL-DT = LOW-VALUE
 18442         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 18443
 18444     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 18445         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 18446                                         CM-AH-STATUS-AT-CANCEL.
 18447
 18448     IF LF-COVERAGE-CANCELLED
 18449         IF PB-RECORD-RETURNED
 18450              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 18451          ELSE
 18452              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 18453
 18454     GO TO 4299-EXIT.
 18455
 18456 4100-AH-CANCEL-CONT.
 18457     IF PB-C-AH-CANCEL-VOIDED
 18458         GO TO 4299-EXIT.
 18459
 18460     if cm-credit-interface-sw-2 = ' '
 18461        if pb-fatal-errors or pb-unforced-errors
 18462           move '4'              to cm-credit-interface-sw-2
 18463        else
 18464           move '1'              to cm-credit-interface-sw-2
 18465        end-if
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 334
* EL050.cbl
 18466     end-if
 18467     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 18468         GO TO 4299-EXIT.
 18469
 18470     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 18471        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18472           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 18473        ELSE
 18474           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 18475
 18476     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 18477     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 18478
 18479     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 18480         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 18481
 18482     IF CM-AH-STATUS-AT-CANCEL = SPACE
 18483         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 18484         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 18485
 18486     IF PB-RECORD-RETURNED
 18487        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 18488      ELSE
 18489        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 18490
 18491     GO TO 4299-EXIT.
 18492
 18493 4150-SUMMARY-CERT-CANCEL.
 18494     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 18495
 18496     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18497        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18498                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 18499     ELSE
 18500        COMPUTE CM-LF-ITD-CANCEL-AMT =
 18501                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 18502
 18503     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 18504        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18505                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 18506     ELSE
 18507        COMPUTE CM-AH-ITD-CANCEL-AMT =
 18508                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 18509
 18510     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 18511        NEXT SENTENCE
 18512     ELSE
 18513        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 18514
 18515     GO TO 4299-EXIT.
 18516
 18517 4200-REVERSE-LF-CANCEL.
 18518     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 18519
 18520     IF CM-LF-CANCEL-APPLIED
 18521        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 18522        MOVE SPACES                TO CM-LF-EXIT-BATCH
 18523        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 335
* EL050.cbl
 18524
 18525     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 18526
 18527     IF PB-RECORD-RETURNED
 18528        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18529       ELSE
 18530        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18531
 18532 4200-REVERSE-LF-EXIT.
 18533       EXIT.
 18534
 18535 4200-REVERSE-AH-CANCEL.
 18536     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 18537
 18538     IF CM-AH-CANCEL-APPLIED
 18539        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 18540        MOVE SPACES                TO CM-AH-EXIT-BATCH
 18541        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 18542
 18543     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 18544
 18545     IF PB-RECORD-RETURNED
 18546        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 18547       ELSE
 18548        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 18549
 18550 4200-REVERSE-AH-EXIT.
 18551       EXIT.
 18552
 18553 4299-EXIT.
 18554       EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 336
* EL050.cbl
 18556
 18557 4500-UPDATE-NEW-CERT.
 18558     IF CERT-WAS-FOUND
 18559         NEXT SENTENCE
 18560       ELSE
 18561         GO TO 4520-BUILD-NEW-KEY.
 18562
 18563     IF  CLASIC-CREATED-CERT
 18564         GO TO 4999-EXIT.
 18565
 18566     IF  CERT-WAS-CREATED-FOR-CLAIM
 18567         GO TO 4520-BUILD-NEW-KEY.
 18568
 18569     IF CERT-ADDED-BATCH
 18570        IF CM-RECORD-ID = 'CM'
 18571            GO TO 4999-EXIT.
 18572
 18573 4520-BUILD-NEW-KEY.
 18574* BUILD CONTROL PRIMARY
 18575
 18576     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 18577                                       CM-COMPANY-CD-A1
 18578                                       CM-COMPANY-CD-A2
 18579                                       CM-COMPANY-CD-A4
 18580                                       CM-COMPANY-CD-A5.
 18581
 18582     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 18583     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 18584     MOVE PB-SV-STATE               TO CM-STATE.
 18585     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 18586     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 18587     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 18588     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 18589
 18590     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 18591
 18592     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 18593     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 18594     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 18595     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 18596
 18597     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 18598        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 18599
 18600     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 18601         MOVE PB-SV-STATE            TO CM-SSN-STATE
 18602         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 18603         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 18604         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 18605     ELSE
 18606         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 18607
 18608     IF PB-COMPANY-ID   EQUAL  'CRI'
 18609         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 18610         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 18611         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 18612         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 18613         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 337
* EL050.cbl
 18614
 18615     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 18616        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18617         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 18618
 18619     IF PB-COMPANY-ID  = 'LBL'
 18620        IF PB-I-JOINT-COVERAGE
 18621            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 18622                                           PB-I-MEMBER-NO
 18623            GO TO 4550-CONT-CERT-PROCESS.
 18624
 18625     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 18626        NEXT SENTENCE
 18627     ELSE
 18628        GO TO 4540-BUILD-MEMBER-NO.
 18629
 18630******************************************************************
 18631*                                                                *
 18632*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 18633*    FOR 'MON'.                                                  *
 18634*                                                                *
 18635******************************************************************
 18636
 18637     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 18638     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 18639     MOVE +1                     TO WS-SUB1
 18640                                    WS-SUB2.
 18641
 18642 4530-EDIT-MEMB-NAME.
 18643
 18644     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 18645        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 18646        ADD +1                       TO WS-SUB2.
 18647
 18648     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 18649        ADD +1                       TO WS-SUB1
 18650        GO TO 4530-EDIT-MEMB-NAME.
 18651
 18652     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 18653     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 18654     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 18655*    MOVE SPACE                      TO DC-OPTION-CODE.
 18656     SET  BIN-TO-GREG                TO TRUE.
 18657     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18658     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 18659
 18660     GO TO 4550-CONT-CERT-PROCESS.
 18661
 18662******************************************************************
 18663*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 18664******************************************************************
 18665
 18666 4540-BUILD-MEMBER-NO.
 18667
 18668     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 18669         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 18670         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 18671         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 338
* EL050.cbl
 18672         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 18673     ELSE
 18674         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 18675
 18676     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 18677        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 18678         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 18679
 18680 4550-CONT-CERT-PROCESS.
 18681
 18682*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 18683*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 18684*    ELSE
 18685*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 18686
 18687     IF CERT-WAS-CREATED-FOR-CLAIM
 18688        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18689        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 18690
 18691     IF CERT-AND-CLAIM-ONLINE
 18692        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 18693        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 18694
 18695     MOVE 'CM'                     TO CM-RECORD-ID.
 18696     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 18697
 18698     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 18699        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 18700        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 18701     ELSE
 18702        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 18703        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 18704
 18705     MOVE ZERO                     TO CM-LOAN-BALANCE.
 18706     MOVE '1'                      TO CM-PREMIUM-TYPE.
 18707     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 18708     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 18709     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 18710     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 18711     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 18712                                      CM-LF-ITD-CANCEL-AMT
 18713                                      CM-LF-ITD-DEATH-AMT
 18714                                      CM-AH-ITD-AH-PMT
 18715                                      CM-AH-ITD-LUMP-PMT
 18716                                      CM-AH-ITD-CANCEL-AMT
 18717                                      CM-LF-NSP-PREMIUM-AMT
 18718                                      CM-AH-NSP-PREMIUM-AMT.
 18719*                                     CM-CLAIM-DEDUCT-WITHHELD
 18720*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18721     if pb-i-loan-apr = +99.9999
 18722        move zeros                 to cm-loan-apr
 18723     else
 18724        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18725     end-if
 18726     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18727     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18728     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18729     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 339
* EL050.cbl
 18730     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18731     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18732     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18733     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18734     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18735     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18736     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18737
 18738     IF PB-I-LIVES NOT NUMERIC
 18739         MOVE ZERO                 TO PB-I-LIVES.
 18740
 18741     IF PB-I-NUM-BILLED NOT NUMERIC
 18742         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18743
 18744     MOVE PB-I-LIVES               TO CM-LIVES.
 18745     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18746
 18747     IF PB-COMPANY-ID EQUAL  'DMD'
 18748         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18749         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18750
 18751     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18752     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18753     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18754     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18755     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18756     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18757
 18758     IF PB-I-LF-POLICY-FEE NUMERIC
 18759        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18760     ELSE
 18761        MOVE +0                    TO CM-LF-POLICY-FEE.
 18762
 18763     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18764        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18765        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18766     ELSE
 18767        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18768
 18769     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18770     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18771     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18772     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18773     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18774     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18775     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18776     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18777     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18778
 18779     IF PB-I-CANCEL-FEE NUMERIC
 18780        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18781     ELSE
 18782        MOVE +0                  TO CM-CANCEL-FEE
 18783     END-IF
 18784
 18785     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18786        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18787     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 340
* EL050.cbl
 18788        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18789
 18790     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18791     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18792
 18793     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18794                                      CM-LF-DEATH-EXIT-DT
 18795                                      CM-AH-SETTLEMENT-EXIT-DT.
 18796
 18797*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18798*                       'TIH' OR 'OFL' OR 'FLA' OR
 18799*                       'TII' OR 'TMS' OR 'CRI' OR
 18800*                       'NCL'
 18801     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18802
 18803     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18804         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18805            MOVE '2'                TO CM-PREMIUM-TYPE.
 18806
 18807     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18808         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18809            MOVE '2'                TO CM-PREMIUM-TYPE.
 18810
 18811     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18812         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18813     ELSE
 18814         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18815         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18816
 18817     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18818     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18819     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18820     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18821     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18822     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18823     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18824     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18825
 18826     IF PB-NO-MONTHS-SKIPPED
 18827         MOVE SPACE                 TO CM-SKIP-CODE
 18828     ELSE
 18829         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18830
 18831     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18832     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18833                                       CM-LF-STATUS-AT-CANCEL.
 18834
 18835     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18836     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18837                                       CM-AH-STATUS-AT-CANCEL.
 18838
 18839     MOVE '1'                       TO CM-ENTRY-STATUS.
 18840
 18841     IF PB-REISSUED-CERT
 18842        MOVE '5'                    TO CM-ENTRY-STATUS.
 18843
 18844     IF PB-MONTHLY-CERT
 18845        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 341
* EL050.cbl
 18846
 18847     IF PB-CASH-CERT
 18848        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18849
 18850     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18851     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18852     IF PB-POLICY-IS-DECLINED
 18853        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18854
 18855     IF PB-POLICY-IS-VOIDED
 18856        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18857
 18858     IF PB-NEEDS-UNDERWRITING
 18859        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18860
 18861     IF PB-REIN-ONLY-CERT
 18862        MOVE '9'                    TO CM-ENTRY-STATUS.
 18863
 18864     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18865         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18866     ELSE
 18867         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18868
 18869     IF PB-RECORD-RETURNED
 18870        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18871      ELSE
 18872        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18873
 18874     IF PB-I-MAIL-ADDRS-PRESENT
 18875        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18876
 18877     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18878                                       CM-ENTRY-DT.
 18879
 18880 4999-EXIT.
 18881     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 342
* EL050.cbl
 18883
 18884 5000-PROCESS-REPS.
 18885     MOVE ' '                    TO AGTC-MASTER-SW
 18886     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18887     MOVE CO-TYPE                TO AGTC-TYPE
 18888     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18889     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18890     IF (AGTC-MASTER-SW NOT = 'N')
 18891        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18892        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18893        PERFORM 8583-READ-ERAGTC-NEXT
 18894                                 THRU 8583-EXIT
 18895     END-IF
 18896     IF AGTC-MASTER-SW = 'N'
 18897        CONTINUE
 18898     ELSE
 18899        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18900           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18901              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18902              MOVE 'Y'           TO AGTC-MASTER-SW
 18903           END-IF
 18904        END-IF
 18905     END-IF
 18906     .
 18907 5000-EXIT.
 18908     EXIT.
 18909 6370-EDIT-INPUT-LF-CODE.
 18910     move ' ' to ws-benefit-cd-chg-sw
 18911     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18912        MOVE +1                  TO SUB
 18913        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18914        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18915        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18916        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18917        GO TO 6370-SEARCH-LOOP.
 18918
 18919     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18920
 18921     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18922     MOVE SPACES                 TO CNTL-ACCESS.
 18923*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18924     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18925     MOVE +0                     TO CNTL-SEQ-NO.
 18926     MOVE '4' TO RC-SW-2.
 18927     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18928
 18929     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18930        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18931        GO TO 6370-NO-LF-FOUND.
 18932
 18933     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18934     MOVE +1                     TO SUB.
 18935
 18936 6370-SEARCH-LOOP.
 18937     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18938         GO TO 6370-NO-LF-FOUND.
 18939
 18940     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 343
* EL050.cbl
 18941        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18942           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18943           set benefit-code-chg to true
 18944        end-if
 18945        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18946        GO TO 6370-HER-NET-PAY-CHECK.
 18947
 18948     ADD 1   TO SUB.
 18949*    IF SUB GREATER 120
 18950     IF SUB GREATER 200
 18951         GO TO 6370-NO-LF-FOUND.
 18952
 18953     GO TO 6370-SEARCH-LOOP.
 18954
 18955 6370-NO-LF-FOUND.
 18956
 18957     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18958        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18959        set benefit-code-chg to true
 18960     end-if
 18961     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18962
 18963 6370-HER-NET-PAY-CHECK.
 18964
 18965     IF PB-COMPANY-ID = 'CID'
 18966        IF PB-SV-STATE = 'CA' OR 'MN'
 18967           IF PB-I-LF-BENEFIT-CD = '02'
 18968              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18969           ELSE
 18970              IF PB-I-LF-BENEFIT-CD = '04'
 18971                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18972              END-IF
 18973           END-IF
 18974        END-IF
 18975     END-IF
 18976
 18977     IF PB-COMPANY-ID NOT = 'HER'
 18978         GO TO 6370-EXIT.
 18979
 18980     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18981         GO TO 6370-EXIT.
 18982
 18983     IF PB-I-LF-TERM NOT NUMERIC
 18984         MOVE ZEROS              TO PB-I-LF-TERM.
 18985
 18986     IF PB-I-LOAN-TERM NOT NUMERIC
 18987         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18988
 18989     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18990         GO TO 6370-EXIT.
 18991
 18992     IF PB-I-LF-BENEFIT-CD = '33'
 18993         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18994
 18995     IF PB-I-LF-BENEFIT-CD = '34'
 18996         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18997
 18998 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 344
* EL050.cbl
 18999     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 345
* EL050.cbl
 19001
 19002 6380-EDIT-INPUT-AH-CODE.
 19003     IF WK-AH-EDIT-ADDR NOT = ZEROS
 19004        MOVE +1                  TO SUB
 19005        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 19006        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 19007        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 19008        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 19009        GO TO 6380-SEARCH-LOOP.
 19010
 19011     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 19012
 19013     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 19014     MOVE SPACES                 TO CNTL-ACCESS.
 19015     MOVE 'A'                    TO CNTL-REC-TYPE.
 19016*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 19017     MOVE +0                     TO CNTL-SEQ-NO.
 19018     MOVE '5' TO RC-SW-2.
 19019     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 19020
 19021     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 19022        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 19023        GO TO 6380-NO-AH-FOUND.
 19024
 19025     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 19026     MOVE +1 TO SUB.
 19027
 19028 6380-SEARCH-LOOP.
 19029     IF CF-AH-CODE-OUT (SUB) = ZEROS
 19030         GO TO 6380-NO-AH-FOUND.
 19031
 19032     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 19033         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 19034         GO TO 6380-CSO-AH-ONLY-CHECKS.
 19035
 19036     ADD 1   TO SUB.
 19037     IF SUB GREATER THAN 96
 19038*    IF SUB GREATER THAN 300
 19039         GO TO 6380-NO-AH-FOUND.
 19040
 19041     GO TO 6380-SEARCH-LOOP.
 19042
 19043 6380-NO-AH-FOUND.
 19044
 19045     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 19046
 19047     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 19048         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 19049     ELSE
 19050         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 19051
 19052 6380-CSO-AH-ONLY-CHECKS.
 19053
 19054     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 19055        NEXT SENTENCE
 19056      ELSE
 19057        GO TO 6380-EXIT.
 19058
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 346
* EL050.cbl
 19059     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 19060         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 19061
 19062
 19063     GO TO 6380-EXIT
 19064     .
 19065 6380-CSO-LIFE-WITH-AH-CHECKS.
 19066
 19067
 19068     .
 19069 6380-EXIT.
 19070     EXIT.
 19071
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 347
* EL050.cbl
 19073
 19074 6400-COMPUTE-EXTENSION-DAYS.
 19075
 19076******************************************************************
 19077*                                                                *
 19078*                   COMPUTE EXTENSION DAYS                       *
 19079*                                                                *
 19080*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 19081*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 19082*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 19083*    THE EXTENSION DAYS.                                         *
 19084*                                                                *
 19085******************************************************************
 19086
 19087     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 19088     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 19089
 19090******************************************************************
 19091*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 19092*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 19093******************************************************************
 19094
 19095     IF DC-ELAPSED-MONTHS GREATER THAN +0
 19096        COMPUTE WS-ODD-DAYS-OVER =
 19097               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 19098     ELSE
 19099        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 19100
 19101     IF WS-ODD-DAYS-OVER = ZEROS
 19102           GO TO 6499-EXIT
 19103     ELSE
 19104        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 19105           IF WS-WDF-MONTH = 02
 19106              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 19107              ADD 2       TO  WS-ODD-DAYS-OVER
 19108              GO TO 6499-EXIT
 19109           ELSE
 19110              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 19111                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 19112                 GO TO 6499-EXIT
 19113               ELSE
 19114                 GO TO 6499-EXIT
 19115        ELSE
 19116           GO TO 6499-EXIT.
 19117
 19118 6412-CHECK-TO-DAY.
 19119
 19120        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 19121           IF WS-WDT-DAY = 28
 19122              ADD 2              TO WS-ODD-DAYS-OVER
 19123           ELSE
 19124              IF WS-WDT-DAY = 29
 19125                 ADD 1           TO WS-ODD-DAYS-OVER
 19126              ELSE
 19127                 NEXT SENTENCE
 19128        ELSE
 19129           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 19130              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 348
* EL050.cbl
 19131
 19132     GO TO 6499-EXIT.
 19133
 19134
 19135 6415-CHECK-LEAP-YEAR.
 19136
 19137     IF DC-DAYS-IN-MONTH = 29
 19138        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 19139
 19140 6415-EXIT.
 19141     EXIT.
 19142
 19143 6499-EXIT.
 19144      EXIT.
 19145
 19146 6500-END.
 19147     EXIT.
 19148
 19149
 19150******************************************************************
 19151************* PROCEDURE DIVISION FOR EL050 ***********************
 19152********************** ELC50PD END *******************************
 19153
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 349
* EL050.cbl
 19155
 19156**START***********************************************************
 19157*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 19158*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 19159******************************************************************
 19160*
 19161 6600-GET-STATE-MUNICIPAL-TAX.
 19162
 19163     IF PB-COMPANY-ID NOT = 'DMD'
 19164         GO TO 6640-EXIT.
 19165
 19166     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 19167     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 19168     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 19169*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 19170*
 19171***  Y2K PROJ 7744
 19172     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19173     SET BIN-TO-GREG          TO TRUE.
 19174     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19175
 19176     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19177
 19178     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 19179     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 19180
 19181
 19182* EXEC CICS HANDLE CONDITION
 19183*        INVREQ    (6610-START-BROWSE)
 19184*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19185*        NOTFND    (6630-END-OF-FILE)
 19186*    END-EXEC.
 19187*    MOVE '"$8JI                 ! # #00019171' TO DFHEIV0
 19188     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 19189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19190     MOVE X'2320233030303139313731' TO DFHEIV0(25:11)
 19191     CALL 'kxdfhei1' USING DFHEIV0
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19193
 19194
 19195 6610-START-BROWSE.
 19196
 19197
 19198* EXEC CICS HANDLE CONDITION
 19199*        NOTFND    (6630-END-OF-FILE)
 19200*        DISABLED  (6630-ERRESS-PROBLEM)
 19201*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19202*        ENDFILE   (6630-END-OF-FILE)
 19203*    END-EXEC.
 19204*    MOVE '"$IcJ''                ! $ #00019179' TO DFHEIV0
 19205     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19206     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19207     MOVE X'2420233030303139313739' TO DFHEIV0(25:11)
 19208     CALL 'kxdfhei1' USING DFHEIV0
 19209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19210
 19211
 19212
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 350
* EL050.cbl
 19213* EXEC CICS STARTBR
 19214*        DATASET (FILE-ID-ERRESS)
 19215*        RIDFLD  (WS-ERRESS-KEY)
 19216*        GTEQ
 19217*    END-EXEC.
 19218     MOVE 0
 19219       TO DFHEIV11
 19220*    MOVE '&,         G          &   #00019186' TO DFHEIV0
 19221     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19222     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19223     MOVE X'2020233030303139313836' TO DFHEIV0(25:11)
 19224     CALL 'kxdfhei1' USING DFHEIV0,
 19225           FILE-ID-ERRESS,
 19226           WS-ERRESS-KEY,
 19227           DFHEIV99,
 19228           DFHEIV11,
 19229           DFHEIV99
 19230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19231
 19232
 19233 6620-READ-NEXT-ERRESS-MASTER.
 19234
 19235
 19236* EXEC CICS HANDLE CONDITION
 19237*        NOTFND    (6630-END-OF-FILE)
 19238*        ENDFILE   (6630-END-OF-FILE)
 19239*        DISABLED  (6630-ERRESS-PROBLEM)
 19240*        NOTOPEN   (6630-ERRESS-PROBLEM)
 19241*    END-EXEC.
 19242*    MOVE '"$I''cJ                ! % #00019194' TO DFHEIV0
 19243     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 19244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19245     MOVE X'2520233030303139313934' TO DFHEIV0(25:11)
 19246     CALL 'kxdfhei1' USING DFHEIV0
 19247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19248
 19249
 19250
 19251* EXEC CICS READNEXT
 19252*        DATASET (FILE-ID-ERRESS)
 19253*        INTO    (RESIDENT-STATE-TAX-MASTER)
 19254*        RIDFLD  (WS-ERRESS-KEY)
 19255*    END-EXEC.
 19256     MOVE LENGTH OF
 19257      RESIDENT-STATE-TAX-MASTER
 19258       TO DFHEIV12
 19259     MOVE 0
 19260       TO DFHEIV11
 19261*    MOVE '&.IL                  )   #00019201' TO DFHEIV0
 19262     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19263     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19264     MOVE X'2020233030303139323031' TO DFHEIV0(25:11)
 19265     CALL 'kxdfhei1' USING DFHEIV0,
 19266           FILE-ID-ERRESS,
 19267           RESIDENT-STATE-TAX-MASTER,
 19268           DFHEIV12,
 19269           WS-ERRESS-KEY,
 19270           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 351
* EL050.cbl
 19271           DFHEIV11,
 19272           DFHEIV99,
 19273           DFHEIV99
 19274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19275
 19276
 19277     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 19278
 19279* EXEC CICS ENDBR
 19280*            DATASET (FILE-ID-ERRESS)
 19281*       END-EXEC
 19282     MOVE 0
 19283       TO DFHEIV11
 19284*    MOVE '&2                    $   #00019208' TO DFHEIV0
 19285     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19286     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19287     MOVE X'2020233030303139323038' TO DFHEIV0(25:11)
 19288     CALL 'kxdfhei1' USING DFHEIV0,
 19289           FILE-ID-ERRESS,
 19290           DFHEIV11,
 19291           DFHEIV99
 19292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19293        GO TO 6630-END-OF-FILE.
 19294
 19295     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 19296        NEXT SENTENCE
 19297      ELSE
 19298        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 19299
 19300*IS IT LIFE(1) OR IS IT P&C(2) ?????
 19301*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 19302*
 19303     MOVE +2                     TO WS-SUB1.
 19304
 19305     IF PB-ISSUE
 19306     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 19307        MOVE +1                  TO WS-SUB1.
 19308
 19309     IF PB-CANCELLATION
 19310     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 19311        MOVE +1                  TO WS-SUB1.
 19312*
 19313*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 19314*
 19315***  Y2K PROJ 7744
 19316     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 19317***  Y2K PROJ 7744
 19318
 19319*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 19320* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 19321* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 19322
 19323     ADD 1                    TO WS-YEAR-YY.
 19324
 19325     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 19326         MOVE RES-REN-STATE-TAX (WS-SUB1)
 19327                              TO WS-RES-STATE-TAX
 19328         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 352
* EL050.cbl
 19329                              TO WS-RES-MUNI-TAX
 19330     ELSE
 19331         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 19332                              TO WS-RES-STATE-TAX
 19333         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 19334                              TO WS-RES-MUNI-TAX.
 19335
 19336*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 19337
 19338     IF PB-CANCELLATION
 19339         GO TO 6640-CANCEL-TAX.
 19340
 19341     IF PB-I-LF-PREMIUM-AMT > ZEROS
 19342         COMPUTE PB-I-STATE-TAX ROUNDED =
 19343                                   PB-I-LF-PREMIUM-AMT
 19344                                 * WS-RES-STATE-TAX
 19345         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19346                                   PB-I-LF-PREMIUM-AMT
 19347                                 * WS-RES-MUNI-TAX
 19348     ELSE
 19349     IF PB-I-AH-PREMIUM-AMT > ZEROS
 19350         COMPUTE PB-I-STATE-TAX ROUNDED =
 19351                                   PB-I-AH-PREMIUM-AMT
 19352                                 * WS-RES-STATE-TAX
 19353         COMPUTE PB-I-MUNI-TAX ROUNDED =
 19354                                   PB-I-AH-PREMIUM-AMT
 19355                                 * WS-RES-MUNI-TAX.
 19356
 19357
 19358* EXEC CICS ENDBR
 19359*         DATASET (FILE-ID-ERRESS)
 19360*    END-EXEC.
 19361     MOVE 0
 19362       TO DFHEIV11
 19363*    MOVE '&2                    $   #00019275' TO DFHEIV0
 19364     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19365     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19366     MOVE X'2020233030303139323735' TO DFHEIV0(25:11)
 19367     CALL 'kxdfhei1' USING DFHEIV0,
 19368           FILE-ID-ERRESS,
 19369           DFHEIV11,
 19370           DFHEIV99
 19371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19372
 19373
 19374     GO TO 6640-EXIT.
 19375
 19376 6640-CANCEL-TAX.
 19377     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 19378
 19379     IF PB-C-LF-CANCEL-AMT > ZEROS
 19380         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19381                                   PB-C-LF-CANCEL-AMT
 19382                                 * WS-RES-STATE-TAX
 19383         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19384                                   PB-C-LF-CANCEL-AMT
 19385                                *  WS-RES-MUNI-TAX
 19386     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 353
* EL050.cbl
 19387     IF PB-C-AH-CANCEL-AMT > ZEROS
 19388         COMPUTE PB-CI-STATE-TAX ROUNDED =
 19389                                   PB-C-AH-CANCEL-AMT
 19390                                 * WS-RES-STATE-TAX
 19391         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 19392                                   PB-C-AH-CANCEL-AMT
 19393                                *  WS-RES-MUNI-TAX.
 19394
 19395
 19396* EXEC CICS ENDBR
 19397*         DATASET (FILE-ID-ERRESS)
 19398*    END-EXEC.
 19399     MOVE 0
 19400       TO DFHEIV11
 19401*    MOVE '&2                    $   #00019300' TO DFHEIV0
 19402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19404     MOVE X'2020233030303139333030' TO DFHEIV0(25:11)
 19405     CALL 'kxdfhei1' USING DFHEIV0,
 19406           FILE-ID-ERRESS,
 19407           DFHEIV11,
 19408           DFHEIV99
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412     GO TO 6640-EXIT.
 19413
 19414 6630-END-OF-FILE.
 19415     MOVE ER-8002              TO WS-ERROR.
 19416     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19417
 19418     GO TO 6640-EXIT.
 19419
 19420 6630-ERRESS-PROBLEM.
 19421     MOVE ER-8044              TO WS-ERROR.
 19422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19423
 19424 6640-EXIT.
 19425     EXIT.
 19426
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 354
* EL050.cbl
 19428 6650-GET-RES-STATE-COMM.
 19429
 19430     IF PB-COMPANY-ID NOT = 'DMD'
 19431         GO TO 6700-COMM-EXIT.
 19432
 19433     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19434     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 19435     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 19436     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 19437     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19438     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 19439     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19440
 19441*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 19442*
 19443***  Y2K PROJ 7744
 19444     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 19445     SET BIN-TO-GREG          TO TRUE.
 19446     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 19447
 19448     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 19449***  Y2K PROJ 7744
 19450
 19451     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 19452
 19453
 19454* EXEC CICS HANDLE CONDITION
 19455*        INVREQ    (6660-START-BROWSE)
 19456*        DISABLED  (6690-ERRESC-PROBLEM)
 19457*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19458*        NOTFND    (6690-END-OF-FILE)
 19459*    END-EXEC.
 19460*    MOVE '"$8cJI                ! & #00019345' TO DFHEIV0
 19461     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 19462     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19463     MOVE X'2620233030303139333435' TO DFHEIV0(25:11)
 19464     CALL 'kxdfhei1' USING DFHEIV0
 19465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19466
 19467
 19468
 19469* EXEC CICS RESETBR
 19470*        DATASET (FILE-ID-ERRESC)
 19471*        RIDFLD  (WS-ERRESC-KEY)
 19472*    END-EXEC.
 19473     MOVE 0
 19474       TO DFHEIV11
 19475*    MOVE '&4         G          &   #00019352' TO DFHEIV0
 19476     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19477     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19478     MOVE X'2020233030303139333532' TO DFHEIV0(25:11)
 19479     CALL 'kxdfhei1' USING DFHEIV0,
 19480           FILE-ID-ERRESC,
 19481           WS-ERRESC-KEY,
 19482           DFHEIV99,
 19483           DFHEIV11,
 19484           DFHEIV99
 19485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 355
* EL050.cbl
 19486
 19487
 19488 6660-START-BROWSE.
 19489
 19490
 19491* EXEC CICS HANDLE CONDITION
 19492*        NOTFND    (6690-END-OF-FILE)
 19493*        DISABLED  (6690-ERRESC-PROBLEM)
 19494*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19495*        ENDFILE   (6690-END-OF-FILE)
 19496*    END-EXEC.
 19497*    MOVE '"$IcJ''                ! '' #00019359' TO DFHEIV0
 19498     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19499     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19500     MOVE X'2720233030303139333539' TO DFHEIV0(25:11)
 19501     CALL 'kxdfhei1' USING DFHEIV0
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19503
 19504
 19505
 19506* EXEC CICS STARTBR
 19507*        DATASET (FILE-ID-ERRESC)
 19508*        RIDFLD  (WS-ERRESC-KEY)
 19509*        GTEQ
 19510*    END-EXEC.
 19511     MOVE 0
 19512       TO DFHEIV11
 19513*    MOVE '&,         G          &   #00019366' TO DFHEIV0
 19514     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19515     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19516     MOVE X'2020233030303139333636' TO DFHEIV0(25:11)
 19517     CALL 'kxdfhei1' USING DFHEIV0,
 19518           FILE-ID-ERRESC,
 19519           WS-ERRESC-KEY,
 19520           DFHEIV99,
 19521           DFHEIV11,
 19522           DFHEIV99
 19523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19524
 19525
 19526     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 19527
 19528 6670-READ-NEXT-ERRESC-MASTER.
 19529
 19530
 19531* EXEC CICS HANDLE CONDITION
 19532*        NOTFND    (6690-END-OF-FILE)
 19533*        DISABLED  (6690-ERRESC-PROBLEM)
 19534*        NOTOPEN   (6690-ERRESC-PROBLEM)
 19535*        ENDFILE   (6690-END-OF-FILE)
 19536*    END-EXEC.
 19537*    MOVE '"$IcJ''                ! ( #00019376' TO DFHEIV0
 19538     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19540     MOVE X'2820233030303139333736' TO DFHEIV0(25:11)
 19541     CALL 'kxdfhei1' USING DFHEIV0
 19542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19543
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 356
* EL050.cbl
 19544
 19545
 19546* EXEC CICS READNEXT
 19547*        DATASET (FILE-ID-ERRESC)
 19548*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 19549*        RIDFLD  (ERRESC-RECORD-KEY)
 19550*    END-EXEC.
 19551     MOVE LENGTH OF
 19552      ACCOUNT-RESIDENT-ST-COMMISSION
 19553       TO DFHEIV12
 19554     MOVE 0
 19555       TO DFHEIV11
 19556*    MOVE '&.IL                  )   #00019383' TO DFHEIV0
 19557     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19558     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19559     MOVE X'2020233030303139333833' TO DFHEIV0(25:11)
 19560     CALL 'kxdfhei1' USING DFHEIV0,
 19561           FILE-ID-ERRESC,
 19562           ACCOUNT-RESIDENT-ST-COMMISSION,
 19563           DFHEIV12,
 19564           ERRESC-RECORD-KEY,
 19565           DFHEIV99,
 19566           DFHEIV11,
 19567           DFHEIV99,
 19568           DFHEIV99
 19569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19570
 19571
 19572     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 19573        NEXT SENTENCE
 19574     ELSE
 19575
 19576* EXEC CICS ENDBR
 19577*            DATASET (FILE-ID-ERRESC)
 19578*       END-EXEC
 19579     MOVE 0
 19580       TO DFHEIV11
 19581*    MOVE '&2                    $   #00019392' TO DFHEIV0
 19582     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19583     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19584     MOVE X'2020233030303139333932' TO DFHEIV0(25:11)
 19585     CALL 'kxdfhei1' USING DFHEIV0,
 19586           FILE-ID-ERRESC,
 19587           DFHEIV11,
 19588           DFHEIV99
 19589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19590        GO TO 6690-END-OF-FILE.
 19591
 19592     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 19593
 19594* EXEC CICS ENDBR
 19595*            DATASET (FILE-ID-ERRESC)
 19596*       END-EXEC
 19597     MOVE 0
 19598       TO DFHEIV11
 19599*    MOVE '&2                    $   #00019398' TO DFHEIV0
 19600     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19601     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 357
* EL050.cbl
 19602     MOVE X'2020233030303139333938' TO DFHEIV0(25:11)
 19603     CALL 'kxdfhei1' USING DFHEIV0,
 19604           FILE-ID-ERRESC,
 19605           DFHEIV11,
 19606           DFHEIV99
 19607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19608        GO TO 6690-END-OF-FILE.
 19609
 19610     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 19611        NEXT SENTENCE
 19612      ELSE
 19613        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 19614
 19615* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19616*
 19617     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19618
 19619     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19620
 19621     IF WS-SUB1 > ZERO
 19622         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 19623             PERFORM 6680-SET-COMMISSION
 19624         ELSE
 19625             PERFORM 6680-SET-TABLE-CODE.
 19626
 19627
 19628* EXEC CICS ENDBR
 19629*         DATASET (FILE-ID-ERRESC)
 19630*    END-EXEC.
 19631     MOVE 0
 19632       TO DFHEIV11
 19633*    MOVE '&2                    $   #00019420' TO DFHEIV0
 19634     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19635     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19636     MOVE X'2020233030303139343230' TO DFHEIV0(25:11)
 19637     CALL 'kxdfhei1' USING DFHEIV0,
 19638           FILE-ID-ERRESC,
 19639           DFHEIV11,
 19640           DFHEIV99
 19641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19642
 19643
 19644     GO TO 6700-COMM-EXIT.
 19645
 19646 6680-SET-TABLE-CODE.
 19647     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19648        MOVE ZEROS             TO WS-SUB1
 19649     ELSE
 19650* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19651* TO COMPUTE AH COMMISSION.
 19652        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 19653        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 19654        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 19655        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 19656        PERFORM 6680-READ-CTBL-TABLE
 19657        IF WS-CTBL-READ-SW NOT = 'Y'
 19658           MOVE ZEROS          TO WS-SUB1.
 19659
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 358
* EL050.cbl
 19660 6680-READ-CTBL-TABLE.
 19661*
 19662* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 19663* TO COMPUTE LIFE COMMISSION
 19664
 19665     IF CTBL-SW = '0540'
 19666        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 19667        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 19668        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 19669
 19670     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 19671
 19672     IF CTBL-TABLE-FOUND
 19673        IF CTBL-SW = '0530'
 19674             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 19675                                    * PB-I-AH-TERM
 19676             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19677             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 19678        ELSE
 19679             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 19680             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 19681             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 19682     ELSE
 19683        IF FIRST-TIME-THROUGH
 19684            GO TO 6680-READ-CTBL-TABLE
 19685        ELSE
 19686            MOVE ZEROS         TO WS-SUB1.
 19687
 19688 6680-SET-COMMISSION.
 19689     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19690           MOVE ZEROS          TO WS-SUB1
 19691       ELSE
 19692           MOVE RESC-COMMISSION-PER (WS-SUB)
 19693                               TO WS-COMMISSION
 19694           IF CTBL-SW = '0530'
 19695               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19696           ELSE
 19697               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19698
 19699 6680-SEARCH-CATEGORY.
 19700     ADD +1                   TO WS-SUB.
 19701     IF WS-SUB > +12
 19702         GO TO 6680-EXIT.
 19703
 19704     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19705          MOVE WS-SUB         TO WS-SUB1
 19706          GO TO 6680-EXIT.
 19707
 19708     GO TO 6680-SEARCH-CATEGORY.
 19709
 19710 6680-EXIT.
 19711     EXIT.
 19712
 19713 6690-END-OF-FILE.
 19714     GO TO 6700-COMM-EXIT.
 19715
 19716 6690-ERRESC-PROBLEM.
 19717      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 359
* EL050.cbl
 19718      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19719
 19720      GO TO 6700-COMM-EXIT.
 19721
 19722 6700-COMM-EXIT.
 19723     EXIT.
 19724
 19725 7000-GET-RATE.
 19726
 19727* EXEC CICS LINK
 19728*        PROGRAM    ('ELRATE')
 19729*        COMMAREA   (CALCULATION-PASS-AREA)
 19730*        LENGTH     (CP-COMM-LENGTH)
 19731*    END-EXEC.
 19732     MOVE 'ELRATE' TO DFHEIV1
 19733*    MOVE '."C                   (   #00019506' TO DFHEIV0
 19734     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19736     MOVE X'2020233030303139353036' TO DFHEIV0(25:11)
 19737     CALL 'kxdfhei1' USING DFHEIV0,
 19738           DFHEIV1,
 19739           CALCULATION-PASS-AREA,
 19740           CP-COMM-LENGTH,
 19741           DFHEIV99,
 19742           DFHEIV99,
 19743           DFHEIV99,
 19744           DFHEIV99
 19745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19746
 19747
 19748 7000-EXIT.
 19749     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 360
* EL050.cbl
 19751 7100-FIND-BENEFIT-IN-STATE.
 19752     MOVE 'N'                    TO BEN-SEARCH-SW.
 19753
 19754     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19755         VARYING SUB3 FROM 1 BY 1 UNTIL
 19756            ((SUB3 GREATER 50) OR
 19757              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19758               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19759
 19760     IF SUB3 NOT = 51
 19761         MOVE 'Y'                TO BEN-SEARCH-SW.
 19762
 19763     GO TO 7199-EXIT.
 19764
 19765 7100-BENEFIT-DUMMY.
 19766
 19767 7100-DUMMY-EXIT.
 19768     EXIT.
 19769
 19770 7199-EXIT.
 19771     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 361
* EL050.cbl
 19773 7200-FIND-BENEFIT.
 19774     MOVE 'N'                    TO BEN-SEARCH-SW.
 19775
 19776     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19777         VARYING SUB3 FROM 1 BY 1 UNTIL
 19778            ((SUB3 GREATER 8) OR
 19779            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19780
 19781     IF SUB3 NOT = 9
 19782         MOVE 'Y'                TO BEN-SEARCH-SW.
 19783
 19784     GO TO 7200-EXIT.
 19785
 19786 7200-BENEFIT-DUMMY.
 19787
 19788 7200-DUMMY-EXIT.
 19789     EXIT.
 19790
 19791 7200-EXIT.
 19792     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 362
* EL050.cbl
 19794 7250-LOOK-FOR-RESCINDED-CLAIM.
 19795     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19796                                    W-CL-COMP-CD.
 19797     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19798                                    W-CL-CERT-NO.
 19799
 19800
 19801* EXEC CICS HANDLE CONDITION
 19802*        NOTFND  (7250-CONTINUE)
 19803*        ENDFILE (7250-CONTINUE)
 19804*    END-EXEC.
 19805*    MOVE '"$I''                  ! ) #00019564' TO DFHEIV0
 19806     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19807     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19808     MOVE X'2920233030303139353634' TO DFHEIV0(25:11)
 19809     CALL 'kxdfhei1' USING DFHEIV0
 19810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19811
 19812
 19813
 19814* EXEC CICS IGNORE CONDITION
 19815*        DUPKEY
 19816*    END-EXEC.
 19817*    MOVE '"*$                   !   #00019569' TO DFHEIV0
 19818     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19820     MOVE X'2020233030303139353639' TO DFHEIV0(25:11)
 19821     CALL 'kxdfhei1' USING DFHEIV0
 19822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19823
 19824
 19825
 19826* EXEC CICS STARTBR
 19827*        DATASET   (CLMS-ID)
 19828*        RIDFLD    (ELMSTR-KEY)
 19829*        GENERIC   EQUAL
 19830*        KEYLENGTH (ELMSTR-LENGTH)
 19831*    END-EXEC.
 19832     MOVE 0
 19833       TO DFHEIV11
 19834*    MOVE '&,   KG    E          &   #00019573' TO DFHEIV0
 19835     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19836     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19837     MOVE X'2020233030303139353733' TO DFHEIV0(25:11)
 19838     CALL 'kxdfhei1' USING DFHEIV0,
 19839           CLMS-ID,
 19840           ELMSTR-KEY,
 19841           ELMSTR-LENGTH,
 19842           DFHEIV11,
 19843           DFHEIV99
 19844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19845
 19846
 19847     MOVE 'Y'                    TO W-BROWSE-SW.
 19848
 19849 7250-NEXT-CLAIM.
 19850
 19851
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 363
* EL050.cbl
 19852* EXEC CICS READNEXT
 19853*        DATASET   (CLMS-ID)
 19854*        RIDFLD    (ELMSTR-KEY)
 19855*        SET       (ADDRESS OF CLAIM-MASTER)
 19856*    END-EXEC.
 19857     MOVE 0
 19858       TO DFHEIV11
 19859*    MOVE '&.S                   )   #00019584' TO DFHEIV0
 19860     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19861     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19862     MOVE X'2020233030303139353834' TO DFHEIV0(25:11)
 19863     CALL 'kxdfhei1' USING DFHEIV0,
 19864           CLMS-ID,
 19865           DFHEIV20,
 19866           DFHEIV99,
 19867           ELMSTR-KEY,
 19868           DFHEIV99,
 19869           DFHEIV11,
 19870           DFHEIV99,
 19871           DFHEIV99
 19872     SET ADDRESS OF CLAIM-MASTER TO
 19873         DFHEIV20
 19874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19875
 19876
 19877     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19878        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19879         GO TO 7250-CONTINUE
 19880     END-IF.
 19881
 19882     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19883        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19884        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19885        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19886        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19887         GO TO 7250-NEXT-CLAIM
 19888     END-IF.
 19889
 19890     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19891        OR (CL-CLAIM-TYPE = 'I')
 19892        OR (CL-CLAIM-TYPE = 'G')
 19893        OR (CL-CLAIM-TYPE = 'F')
 19894          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19895              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19896              GO TO 7250-CONTINUE
 19897          END-IF
 19898     END-IF.
 19899
 19900     GO TO 7250-NEXT-CLAIM.
 19901
 19902 7250-CONTINUE.
 19903
 19904     IF W-BROWSE-SW = 'Y'
 19905
 19906* EXEC CICS ENDBR
 19907*            DATASET   (CLMS-ID)
 19908*        END-EXEC
 19909     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 364
* EL050.cbl
 19910       TO DFHEIV11
 19911*    MOVE '&2                    $   #00019618' TO DFHEIV0
 19912     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19913     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19914     MOVE X'2020233030303139363138' TO DFHEIV0(25:11)
 19915     CALL 'kxdfhei1' USING DFHEIV0,
 19916           CLMS-ID,
 19917           DFHEIV11,
 19918           DFHEIV99
 19919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19920         MOVE 'N' TO W-BROWSE-SW
 19921     END-IF.
 19922
 19923 7250-EXIT.
 19924     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 365
* EL050.cbl
 19926 7300-CHECK-FOR-OPEN-CLMS.
 19927
 19928*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19929*    MOVE SPACES                 TO CNTL-ACCESS.
 19930*    MOVE '1'                    TO CNTL-REC-TYPE.
 19931*    MOVE +0                     TO CNTL-SEQ-NO.
 19932
 19933*    MOVE '3'                    TO RC-SW-1.
 19934*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19935
 19936*    IF NOT CF-COMPANY-MASTER
 19937*         PERFORM 0099-COMPANY-NOT-FOUND
 19938*         GO TO 7300-EXIT.
 19939
 19940     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19941                                    W-CL-COMP-CD.
 19942     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19943                                    W-CL-CERT-NO.
 19944
 19945
 19946* EXEC CICS HANDLE CONDITION
 19947*        NOTFND  (7300-CONTINUE)
 19948*        ENDFILE (7300-CONTINUE)
 19949*    END-EXEC.
 19950*    MOVE '"$I''                  ! * #00019646' TO DFHEIV0
 19951     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19952     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19953     MOVE X'2A20233030303139363436' TO DFHEIV0(25:11)
 19954     CALL 'kxdfhei1' USING DFHEIV0
 19955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19956
 19957
 19958
 19959* EXEC CICS IGNORE CONDITION
 19960*        DUPKEY
 19961*    END-EXEC.
 19962*    MOVE '"*$                   !   #00019651' TO DFHEIV0
 19963     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19964     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19965     MOVE X'2020233030303139363531' TO DFHEIV0(25:11)
 19966     CALL 'kxdfhei1' USING DFHEIV0
 19967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19968
 19969
 19970
 19971* EXEC CICS STARTBR
 19972*        DATASET   (CLMS-ID)
 19973*        RIDFLD    (ELMSTR-KEY)
 19974*        GENERIC   EQUAL
 19975*        KEYLENGTH (ELMSTR-LENGTH)
 19976*    END-EXEC.
 19977     MOVE 0
 19978       TO DFHEIV11
 19979*    MOVE '&,   KG    E          &   #00019655' TO DFHEIV0
 19980     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19981     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19982     MOVE X'2020233030303139363535' TO DFHEIV0(25:11)
 19983     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 366
* EL050.cbl
 19984           CLMS-ID,
 19985           ELMSTR-KEY,
 19986           ELMSTR-LENGTH,
 19987           DFHEIV11,
 19988           DFHEIV99
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19990
 19991
 19992     MOVE 'Y'                    TO W-BROWSE-SW.
 19993
 19994 7300-NEXT-CLAIM.
 19995
 19996
 19997* EXEC CICS READNEXT
 19998*        DATASET   (CLMS-ID)
 19999*        RIDFLD    (ELMSTR-KEY)
 20000*        SET       (ADDRESS OF CLAIM-MASTER)
 20001*    END-EXEC.
 20002     MOVE 0
 20003       TO DFHEIV11
 20004*    MOVE '&.S                   )   #00019666' TO DFHEIV0
 20005     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20006     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20007     MOVE X'2020233030303139363636' TO DFHEIV0(25:11)
 20008     CALL 'kxdfhei1' USING DFHEIV0,
 20009           CLMS-ID,
 20010           DFHEIV20,
 20011           DFHEIV99,
 20012           ELMSTR-KEY,
 20013           DFHEIV99,
 20014           DFHEIV11,
 20015           DFHEIV99,
 20016           DFHEIV99
 20017     SET ADDRESS OF CLAIM-MASTER TO
 20018         DFHEIV20
 20019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20020
 20021
 20022     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20023        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20024         GO TO 7300-CONTINUE.
 20025
 20026     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20027        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20028        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20029        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20030        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20031         GO TO 7300-NEXT-CLAIM.
 20032
 20033*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 20034     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 20035        OR (CL-CLAIM-TYPE = 'I')
 20036        OR (CL-CLAIM-TYPE = 'G')
 20037        OR (CL-CLAIM-TYPE = 'F')
 20038        IF CLAIM-IS-OPEN
 20039           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20040             AND PB-C-AH-CANCEL-DT > SPACES
 20041              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 367
* EL050.cbl
 20042              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20043           END-IF
 20044           EVALUATE TRUE
 20045             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 20046                 MOVE ER-2884      TO WS-ERROR
 20047             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 20048                 MOVE ER-2887      TO WS-ERROR
 20049             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 20050                 MOVE ER-2886      TO WS-ERROR
 20051             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 20052                 MOVE ER-2888      TO WS-ERROR
 20053             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 20054                 MOVE ER-2885      TO WS-ERROR
 20055             WHEN OTHER
 20056                 MOVE ER-2768      TO WS-ERROR
 20057           END-EVALUATE
 20058           IF PB-C-AH-CANCEL-VOIDED OR
 20059              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20060                NOT AH-COVERAGE-CANCELLED)
 20061               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20062               MOVE ER-2768      TO WS-ERROR
 20063           END-IF
 20064           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20065           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 20066              PB-FORCE-CODE NOT EQUAL '8'
 20067               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 20068           END-IF
 20069           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 20070           GO TO 7300-NEXT-CLAIM
 20071        ELSE
 20072           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20073*****THIS IS A RESCISSION OR REFORMATION
 20074              IF AH-COVERAGE-CANCELLED
 20075                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 20076                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 20077                    MOVE 1                   TO DC-ELAPSED-DAYS
 20078                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 20079                    SET BIN-PLUS-ELAPSED     TO TRUE
 20080                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 20081                    IF NO-CONVERSION-ERROR
 20082                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 20083                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 20084                          MOVE ER-2897 TO WS-ERROR
 20085                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20086                          GO TO 7300-NEXT-CLAIM
 20087                       END-IF
 20088                    END-IF
 20089                 ELSE
 20090                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 20091                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20092                         MOVE ER-2890 TO WS-ERROR
 20093                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20094                         GO TO 7300-NEXT-CLAIM
 20095                      ELSE
 20096                         MOVE ER-2898 TO WS-ERROR
 20097                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20098                         GO TO 7300-NEXT-CLAIM
 20099                      END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 368
* EL050.cbl
 20100                   END-IF
 20101                 END-IF
 20102              END-IF
 20103           ELSE
 20104              IF CL-DENIAL-TYPE = '1'  AND
 20105                 CL-TOTAL-PAID-AMT = 0
 20106                    GO TO 7300-NEXT-CLAIM
 20107              END-IF
 20108              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 20109               AND PB-C-AH-CANCEL-DT > SPACES
 20110                 MOVE ER-2756        TO WS-ERROR
 20111                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20112                 GO TO 7300-NEXT-CLAIM
 20113              END-IF
 20114           END-IF
 20115        END-IF
 20116     ELSE
 20117*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 20118        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 20119          OR (CL-CLAIM-TYPE = 'O')
 20120           IF (CLAIM-IS-OPEN)
 20121              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 20122                 <> zeros
 20123              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 20124                 <> zeros)
 20125              MOVE ER-2889      TO WS-ERROR
 20126              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20127              GO TO 7300-NEXT-CLAIM
 20128           ELSE
 20129              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 20130*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 20131                 IF (LF-COVERAGE-CANCELLED AND
 20132                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 20133                      IF MSTR-CERT-NO = W-CL-CERT-NO
 20134                         MOVE ER-2890 TO WS-ERROR
 20135                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20136                         GO TO 7300-NEXT-CLAIM
 20137                      ELSE
 20138                         MOVE ER-2898 TO WS-ERROR
 20139                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20140                         GO TO 7300-NEXT-CLAIM
 20141                      END-IF
 20142                 END-IF
 20143              ELSE
 20144                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 20145                    and (CL-TOTAL-PAID-AMT = 0)
 20146                    GO TO 7300-NEXT-CLAIM
 20147                 END-IF
 20148                 IF (
 20149                      (AH-COVERAGE-CANCELLED)
 20150                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 20151                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 20152                      and (pb-ci-ah-cancel-amt +
 20153                         pb-c-ah-cancel-amt) <> zeros
 20154                    )
 20155                               OR
 20156                    (
 20157                      (LF-COVERAGE-CANCELLED)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 369
* EL050.cbl
 20158                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
 20159                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 20160                      and (pb-ci-lf-cancel-amt +
 20161                         pb-c-lf-cancel-amt) <> zeros
 20162                    )
 20163                       IF CL-CLAIM-TYPE = 'O'
 20164                          MOVE ER-2998 TO WS-ERROR
 20165                       ELSE
 20166                          MOVE ER-2965 TO WS-ERROR
 20167                       END-IF
 20168                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20169                       GO TO 7300-NEXT-CLAIM
 20170                 END-IF
 20171                 IF LF-COVERAGE-CANCELLED
 20172                  IF CL-TOTAL-PAID-AMT > 0
 20173                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 20174                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 20175                        MOVE ER-2891 TO WS-ERROR
 20176                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20177                        GO TO 7300-NEXT-CLAIM
 20178                      END-IF
 20179                    ELSE
 20180****only show this error if cert num matches exactly
 20181                      IF PB-CERT-NO = CL-CERT-NO
 20182                         IF CL-CLAIM-TYPE = 'O'
 20183                            MOVE ER-2895 TO WS-ERROR
 20184                         ELSE
 20185                            MOVE ER-2892 TO WS-ERROR
 20186                         END-IF
 20187                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20188                         GO TO 7300-NEXT-CLAIM
 20189                      END-IF
 20190                    END-IF
 20191                  END-IF
 20192                 END-IF
 20193              END-IF
 20194           END-IF
 20195        END-IF
 20196     END-IF
 20197
 20198     GO TO 7300-NEXT-CLAIM.
 20199
 20200 7300-CONTINUE.
 20201
 20202     IF W-BROWSE-SW = 'Y'
 20203
 20204* EXEC CICS ENDBR
 20205*            DATASET   (CLMS-ID)
 20206*        END-EXEC.
 20207     MOVE 0
 20208       TO DFHEIV11
 20209*    MOVE '&2                    $   #00019853' TO DFHEIV0
 20210     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20211     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20212     MOVE X'2020233030303139383533' TO DFHEIV0(25:11)
 20213     CALL 'kxdfhei1' USING DFHEIV0,
 20214           CLMS-ID,
 20215           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 370
* EL050.cbl
 20216           DFHEIV99
 20217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20218
 20219
 20220 7300-EXIT.
 20221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 371
* EL050.cbl
 20223 7320-CHECK-FOR-OPEN-CLMS-issue.
 20224
 20225     move ' '                    to w-browse-sw
 20226     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 20227                                    W-CL-COMP-CD
 20228     MOVE PB-CERT-NO(1:10)       TO MSTR-CERT-NO
 20229                                    W-CL-CERT-NO
 20230
 20231
 20232* EXEC CICS HANDLE CONDITION
 20233*        NOTFND  (7320-CONTINUE)
 20234*        ENDFILE (7320-CONTINUE)
 20235*    END-EXEC.
 20236*    MOVE '"$I''                  ! + #00019868' TO DFHEIV0
 20237     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20239     MOVE X'2B20233030303139383638' TO DFHEIV0(25:11)
 20240     CALL 'kxdfhei1' USING DFHEIV0
 20241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20242
 20243
 20244
 20245* EXEC CICS IGNORE CONDITION
 20246*        DUPKEY
 20247*    END-EXEC.
 20248*    MOVE '"*$                   !   #00019873' TO DFHEIV0
 20249     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20251     MOVE X'2020233030303139383733' TO DFHEIV0(25:11)
 20252     CALL 'kxdfhei1' USING DFHEIV0
 20253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20254
 20255
 20256
 20257* EXEC CICS STARTBR
 20258*        DATASET   (CLMS-ID)
 20259*        RIDFLD    (ELMSTR-KEY)
 20260*        GENERIC   EQUAL
 20261*        KEYLENGTH (ELMSTR-LENGTH)
 20262*    END-EXEC.
 20263     MOVE 0
 20264       TO DFHEIV11
 20265*    MOVE '&,   KG    E          &   #00019877' TO DFHEIV0
 20266     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20267     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20268     MOVE X'2020233030303139383737' TO DFHEIV0(25:11)
 20269     CALL 'kxdfhei1' USING DFHEIV0,
 20270           CLMS-ID,
 20271           ELMSTR-KEY,
 20272           ELMSTR-LENGTH,
 20273           DFHEIV11,
 20274           DFHEIV99
 20275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20276
 20277
 20278     MOVE 'Y'                    TO W-BROWSE-SW.
 20279
 20280 7320-NEXT-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 372
* EL050.cbl
 20281
 20282
 20283* EXEC CICS READNEXT
 20284*        DATASET   (CLMS-ID)
 20285*        RIDFLD    (ELMSTR-KEY)
 20286*        SET       (ADDRESS OF CLAIM-MASTER)
 20287*    END-EXEC.
 20288     MOVE 0
 20289       TO DFHEIV11
 20290*    MOVE '&.S                   )   #00019888' TO DFHEIV0
 20291     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20292     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20293     MOVE X'2020233030303139383838' TO DFHEIV0(25:11)
 20294     CALL 'kxdfhei1' USING DFHEIV0,
 20295           CLMS-ID,
 20296           DFHEIV20,
 20297           DFHEIV99,
 20298           ELMSTR-KEY,
 20299           DFHEIV99,
 20300           DFHEIV11,
 20301           DFHEIV99,
 20302           DFHEIV99
 20303     SET ADDRESS OF CLAIM-MASTER TO
 20304         DFHEIV20
 20305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20306
 20307
 20308     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 20309        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 20310         GO TO 7320-CONTINUE.
 20311
 20312     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 20313        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 20314        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 20315        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 20316        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 20317         GO TO 7320-NEXT-CLAIM.
 20318
 20319     IF CLAIM-IS-OPEN
 20320        MOVE ER-3273             TO WS-ERROR
 20321        PERFORM 9900-ERROR-FORMAT
 20322                                 THRU 9900-EXIT
 20323     END-IF
 20324     if pb-i-entry-status = 'V'
 20325        IF CLAIM-IS-OPEN
 20326             OR
 20327           CL-LAST-PMT-DT NOT = LOW-VALUES
 20328             OR
 20329           CL-LAST-PMT-AMT > 0
 20330           MOVE ER-3281          TO WS-ERROR
 20331           PERFORM 9900-ERROR-FORMAT
 20332                                 THRU 9900-EXIT
 20333        END-IF
 20334     END-IF
 20335
 20336     GO TO 7320-NEXT-CLAIM.
 20337
 20338 7320-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 373
* EL050.cbl
 20339
 20340     IF W-BROWSE-SW = 'Y'
 20341
 20342* EXEC CICS ENDBR
 20343*            DATASET   (CLMS-ID)
 20344*        END-EXEC.
 20345     MOVE 0
 20346       TO DFHEIV11
 20347*    MOVE '&2                    $   #00019927' TO DFHEIV0
 20348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20350     MOVE X'2020233030303139393237' TO DFHEIV0(25:11)
 20351     CALL 'kxdfhei1' USING DFHEIV0,
 20352           CLMS-ID,
 20353           DFHEIV11,
 20354           DFHEIV99
 20355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20356
 20357
 20358 7320-EXIT.
 20359     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 374
* EL050.cbl
 20361 7400-GET-REMAIN-TERM.
 20362
 20363* EXEC CICS LINK
 20364*        PROGRAM    ('ELRTRM')
 20365*        COMMAREA   (CALCULATION-PASS-AREA)
 20366*        LENGTH     (CP-COMM-LENGTH)
 20367*    END-EXEC.
 20368     MOVE 'ELRTRM' TO DFHEIV1
 20369*    MOVE '."C                   (   #00019935' TO DFHEIV0
 20370     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20371     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20372     MOVE X'2020233030303139393335' TO DFHEIV0(25:11)
 20373     CALL 'kxdfhei1' USING DFHEIV0,
 20374           DFHEIV1,
 20375           CALCULATION-PASS-AREA,
 20376           CP-COMM-LENGTH,
 20377           DFHEIV99,
 20378           DFHEIV99,
 20379           DFHEIV99,
 20380           DFHEIV99
 20381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20382
 20383
 20384 7400-EXIT.
 20385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 375
* EL050.cbl
 20387
 20388 7500-GET-REMAIN-AMOUNT.
 20389
 20390* EXEC CICS LINK
 20391*        PROGRAM    ('ELRAMT')
 20392*        COMMAREA   (CALCULATION-PASS-AREA)
 20393*        LENGTH     (CP-COMM-LENGTH)
 20394*    END-EXEC.
 20395     MOVE 'ELRAMT' TO DFHEIV1
 20396*    MOVE '."C                   (   #00019946' TO DFHEIV0
 20397     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20399     MOVE X'2020233030303139393436' TO DFHEIV0(25:11)
 20400     CALL 'kxdfhei1' USING DFHEIV0,
 20401           DFHEIV1,
 20402           CALCULATION-PASS-AREA,
 20403           CP-COMM-LENGTH,
 20404           DFHEIV99,
 20405           DFHEIV99,
 20406           DFHEIV99,
 20407           DFHEIV99
 20408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20409
 20410
 20411 7500-EXIT.
 20412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 376
* EL050.cbl
 20414
 20415 7600-GET-REFUND.
 20416
 20417* EXEC CICS LINK
 20418*        PROGRAM    ('ELRFND')
 20419*        COMMAREA   (CALCULATION-PASS-AREA)
 20420*        LENGTH     (CP-COMM-LENGTH)
 20421*    END-EXEC.
 20422     MOVE 'ELRFND' TO DFHEIV1
 20423*    MOVE '."C                   (   #00019957' TO DFHEIV0
 20424     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20426     MOVE X'2020233030303139393537' TO DFHEIV0(25:11)
 20427     CALL 'kxdfhei1' USING DFHEIV0,
 20428           DFHEIV1,
 20429           CALCULATION-PASS-AREA,
 20430           CP-COMM-LENGTH,
 20431           DFHEIV99,
 20432           DFHEIV99,
 20433           DFHEIV99,
 20434           DFHEIV99
 20435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20436
 20437
 20438 7600-EXIT.
 20439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 377
* EL050.cbl
 20441 7700-CALL-DL1.
 20442
 20443* EXEC CICS LINK
 20444*        PROGRAM    ('DLO001')
 20445*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 20446*        LENGTH     (DLO001-COMM-LENGTH)
 20447*    END-EXEC.
 20448     MOVE 'DLO001' TO DFHEIV1
 20449*    MOVE '."C                   (   #00019967' TO DFHEIV0
 20450     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20452     MOVE X'2020233030303139393637' TO DFHEIV0(25:11)
 20453     CALL 'kxdfhei1' USING DFHEIV0,
 20454           DFHEIV1,
 20455           WS-DLO-MASTER-POLICY-FORM,
 20456           DLO001-COMM-LENGTH,
 20457           DFHEIV99,
 20458           DFHEIV99,
 20459           DFHEIV99,
 20460           DFHEIV99
 20461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20462
 20463
 20464 7700-EXIT.
 20465     EXIT.
 20466
 20467 7710-CALL-DL2.
 20468
 20469* EXEC CICS LINK
 20470*        PROGRAM    ('DLO002')
 20471*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 20472*        LENGTH     (DLO002-COMM-LENGTH)
 20473*    END-EXEC.
 20474     MOVE 'DLO002' TO DFHEIV1
 20475*    MOVE '."C                   (   #00019977' TO DFHEIV0
 20476     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20478     MOVE X'2020233030303139393737' TO DFHEIV0(25:11)
 20479     CALL 'kxdfhei1' USING DFHEIV0,
 20480           DFHEIV1,
 20481           WS-DLO-INTERNAL-POLICY-FORM,
 20482           DLO002-COMM-LENGTH,
 20483           DFHEIV99,
 20484           DFHEIV99,
 20485           DFHEIV99,
 20486           DFHEIV99
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20488
 20489
 20490 7710-EXIT.
 20491     EXIT.
 20492
 20493 7720-CALL-DL3.
 20494
 20495* EXEC CICS LINK
 20496*        PROGRAM    ('DLO003')
 20497*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 20498*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 378
* EL050.cbl
 20499*    END-EXEC.
 20500     MOVE 'DLO003' TO DFHEIV1
 20501*    MOVE '."C                   (   #00019987' TO DFHEIV0
 20502     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20504     MOVE X'2020233030303139393837' TO DFHEIV0(25:11)
 20505     CALL 'kxdfhei1' USING DFHEIV0,
 20506           DFHEIV1,
 20507           WS-DLO-VALID-BANK-ID,
 20508           DLO003-COMM-LENGTH,
 20509           DFHEIV99,
 20510           DFHEIV99,
 20511           DFHEIV99,
 20512           DFHEIV99
 20513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20514
 20515
 20516 7720-EXIT.
 20517     EXIT.
 20518
 20519 7730-CALL-DL7.
 20520
 20521* EXEC CICS LINK
 20522*        PROGRAM    ('DLO007')
 20523*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 20524*        LENGTH     (DLO007-COMM-LENGTH)
 20525*    END-EXEC.
 20526     MOVE 'DLO007' TO DFHEIV1
 20527*    MOVE '."C                   (   #00019997' TO DFHEIV0
 20528     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20530     MOVE X'2020233030303139393937' TO DFHEIV0(25:11)
 20531     CALL 'kxdfhei1' USING DFHEIV0,
 20532           DFHEIV1,
 20533           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 20534           DLO007-COMM-LENGTH,
 20535           DFHEIV99,
 20536           DFHEIV99,
 20537           DFHEIV99,
 20538           DFHEIV99
 20539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20540
 20541
 20542 7730-EXIT.
 20543     EXIT.
 20544
 20545 7740-CALL-DL11.
 20546
 20547* EXEC CICS LINK
 20548*        PROGRAM    ('DLO011')
 20549*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 20550*        LENGTH     (DLO011-COMM-LENGTH)
 20551*    END-EXEC.
 20552     MOVE 'DLO011' TO DFHEIV1
 20553*    MOVE '."C                   (   #00020007' TO DFHEIV0
 20554     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20555     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20556     MOVE X'2020233030303230303037' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 379
* EL050.cbl
 20557     CALL 'kxdfhei1' USING DFHEIV0,
 20558           DFHEIV1,
 20559           WS-DLO-PREM-RATES-BEN-TYPE,
 20560           DLO011-COMM-LENGTH,
 20561           DFHEIV99,
 20562           DFHEIV99,
 20563           DFHEIV99,
 20564           DFHEIV99
 20565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20566
 20567
 20568 7740-EXIT.
 20569     EXIT.
 20570
 20571 7750-CALL-DL17.
 20572
 20573* EXEC CICS LINK
 20574*        PROGRAM    ('DLO017')
 20575*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 20576*        LENGTH     (DLO017-COMM-LENGTH)
 20577*    END-EXEC.
 20578     MOVE 'DLO017' TO DFHEIV1
 20579*    MOVE '."C                   (   #00020017' TO DFHEIV0
 20580     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20582     MOVE X'2020233030303230303137' TO DFHEIV0(25:11)
 20583     CALL 'kxdfhei1' USING DFHEIV0,
 20584           DFHEIV1,
 20585           WS-DLO-VALID-RATE-CODE,
 20586           DLO017-COMM-LENGTH,
 20587           DFHEIV99,
 20588           DFHEIV99,
 20589           DFHEIV99,
 20590           DFHEIV99
 20591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20592
 20593
 20594 7750-EXIT.
 20595     EXIT.
 20596
 20597 7755-CALL-DL19.
 20598
 20599* EXEC CICS LINK
 20600*        PROGRAM    ('DLO019')
 20601*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 20602*        LENGTH     (DLO019-COMM-LENGTH)
 20603*    END-EXEC.
 20604     MOVE 'DLO019' TO DFHEIV1
 20605*    MOVE '."C                   (   #00020027' TO DFHEIV0
 20606     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20607     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20608     MOVE X'2020233030303230303237' TO DFHEIV0(25:11)
 20609     CALL 'kxdfhei1' USING DFHEIV0,
 20610           DFHEIV1,
 20611           WS-DLO-ORIG-COV-CAT,
 20612           DLO019-COMM-LENGTH,
 20613           DFHEIV99,
 20614           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 380
* EL050.cbl
 20615           DFHEIV99,
 20616           DFHEIV99
 20617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20618
 20619
 20620 7755-EXIT.
 20621     EXIT.
 20622
 20623 7760-CALL-DL21.
 20624
 20625* EXEC CICS LINK
 20626*        PROGRAM    ('DLO021')
 20627*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 20628*        LENGTH     (DLO021-COMM-LENGTH)
 20629*    END-EXEC.
 20630     MOVE 'DLO021' TO DFHEIV1
 20631*    MOVE '."C                   (   #00020037' TO DFHEIV0
 20632     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20633     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20634     MOVE X'2020233030303230303337' TO DFHEIV0(25:11)
 20635     CALL 'kxdfhei1' USING DFHEIV0,
 20636           DFHEIV1,
 20637           WS-DLO-VALID-LOAN-OFFICER,
 20638           DLO021-COMM-LENGTH,
 20639           DFHEIV99,
 20640           DFHEIV99,
 20641           DFHEIV99,
 20642           DFHEIV99
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20644
 20645
 20646 7760-EXIT.
 20647     EXIT.
 20648
 20649 7770-CALL-DL22.
 20650
 20651* EXEC CICS LINK
 20652*        PROGRAM    ('DLO022')
 20653*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 20654*        LENGTH     (DLO022-COMM-LENGTH)
 20655*    END-EXEC.
 20656     MOVE 'DLO022' TO DFHEIV1
 20657*    MOVE '."C                   (   #00020047' TO DFHEIV0
 20658     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20659     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20660     MOVE X'2020233030303230303437' TO DFHEIV0(25:11)
 20661     CALL 'kxdfhei1' USING DFHEIV0,
 20662           DFHEIV1,
 20663           WS-DLO-VALID-STATE-CODE,
 20664           DLO022-COMM-LENGTH,
 20665           DFHEIV99,
 20666           DFHEIV99,
 20667           DFHEIV99,
 20668           DFHEIV99
 20669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20670
 20671
 20672 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 381
* EL050.cbl
 20673     EXIT.
 20674
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 382
* EL050.cbl
 20676
 20677 7780-CALL-AGG.
 20678
 20679* EXEC CICS LINK
 20680*        PROGRAM    ('ELAGGO')
 20681*        COMMAREA   (WS-PASS-to-pemaggo)
 20682*        LENGTH     (ws-passed-key-LENGTH)
 20683*    END-EXEC.
 20684     MOVE 'ELAGGO' TO DFHEIV1
 20685*    MOVE '."C                   (   #00020059' TO DFHEIV0
 20686     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20688     MOVE X'2020233030303230303539' TO DFHEIV0(25:11)
 20689     CALL 'kxdfhei1' USING DFHEIV0,
 20690           DFHEIV1,
 20691           WS-PASS-to-pemaggo,
 20692           ws-passed-key-LENGTH,
 20693           DFHEIV99,
 20694           DFHEIV99,
 20695           DFHEIV99,
 20696           DFHEIV99
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20698
 20699 7780-EXIT.
 20700     EXIT.
 20701 7785-CALL-HLDI.
 20702
 20703* EXEC CICS LINK
 20704*        PROGRAM    ('ELHLDI')
 20705*        COMMAREA   (HLDI-PASS-AREA)
 20706*        LENGTH     (HLDI-PASS-AREA-LEN)
 20707*    END-EXEC.
 20708     MOVE 'ELHLDI' TO DFHEIV1
 20709*    MOVE '."C                   (   #00020067' TO DFHEIV0
 20710     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20711     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20712     MOVE X'2020233030303230303637' TO DFHEIV0(25:11)
 20713     CALL 'kxdfhei1' USING DFHEIV0,
 20714           DFHEIV1,
 20715           HLDI-PASS-AREA,
 20716           HLDI-PASS-AREA-LEN,
 20717           DFHEIV99,
 20718           DFHEIV99,
 20719           DFHEIV99,
 20720           DFHEIV99
 20721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20722
 20723 7785-EXIT.
 20724     EXIT.
 20725 7786-CALL-HLDIM.
 20726
 20727* EXEC CICS LINK
 20728*        PROGRAM    ('ELHLDIM')
 20729*        COMMAREA   (HLDI-PASS-AREA)
 20730*        LENGTH     (HLDI-PASS-AREA-LEN)
 20731*    END-EXEC.
 20732     MOVE 'ELHLDIM' TO DFHEIV1
 20733*    MOVE '."C                   (   #00020075' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 383
* EL050.cbl
 20734     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20736     MOVE X'2020233030303230303735' TO DFHEIV0(25:11)
 20737     CALL 'kxdfhei1' USING DFHEIV0,
 20738           DFHEIV1,
 20739           HLDI-PASS-AREA,
 20740           HLDI-PASS-AREA-LEN,
 20741           DFHEIV99,
 20742           DFHEIV99,
 20743           DFHEIV99,
 20744           DFHEIV99
 20745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20746
 20747 7786-EXIT.
 20748     EXIT.
 20749 7790-CALL-ZIP-VERIFY.
 20750
 20751
 20752* EXEC CICS LINK
 20753*        PROGRAM    ('WSZIPCD')
 20754*        COMMAREA   (ZIPCD-PASS-AREA)
 20755*        LENGTH     (ZIPCD-PASS-AREA-LEN)
 20756*    END-EXEC.
 20757     MOVE 'WSZIPCD' TO DFHEIV1
 20758*    MOVE '."C                   (   #00020084' TO DFHEIV0
 20759     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20761     MOVE X'2020233030303230303834' TO DFHEIV0(25:11)
 20762     CALL 'kxdfhei1' USING DFHEIV0,
 20763           DFHEIV1,
 20764           ZIPCD-PASS-AREA,
 20765           ZIPCD-PASS-AREA-LEN,
 20766           DFHEIV99,
 20767           DFHEIV99,
 20768           DFHEIV99,
 20769           DFHEIV99
 20770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20771
 20772
 20773 7790-EXIT.
 20774     EXIT.
 20775 7795-call-sqlclmhs.
 20776
 20777
 20778* EXEC CICS LINK
 20779*        PROGRAM    ('SQLCLMHS')
 20780*        COMMAREA   (clmhs-PASS-AREA)
 20781*        LENGTH     (clmhs-PASS-AREA-LEN)
 20782*    END-EXEC.
 20783     MOVE 'SQLCLMHS' TO DFHEIV1
 20784*    MOVE '."C                   (   #00020094' TO DFHEIV0
 20785     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20787     MOVE X'2020233030303230303934' TO DFHEIV0(25:11)
 20788     CALL 'kxdfhei1' USING DFHEIV0,
 20789           DFHEIV1,
 20790           clmhs-PASS-AREA,
 20791           clmhs-PASS-AREA-LEN,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 384
* EL050.cbl
 20792           DFHEIV99,
 20793           DFHEIV99,
 20794           DFHEIV99,
 20795           DFHEIV99
 20796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20797
 20798
 20799 7795-EXIT.
 20800     EXIT.
 20801 7800-REWRITE-CERT.
 20802******************************************************************
 20803*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 20804*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 20805******************************************************************
 20806
 20807     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 20808        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 20809        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 20810        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 20811
 20812* EXEC CICS REWRITE
 20813*                  DATASET (CERT-ID)
 20814*                  FROM    (CERTIFICATE-MASTER)
 20815*              END-EXEC
 20816     MOVE LENGTH OF
 20817      CERTIFICATE-MASTER
 20818       TO DFHEIV11
 20819*    MOVE '&& L                  %   #00020112' TO DFHEIV0
 20820     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20821     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20822     MOVE X'2020233030303230313132' TO DFHEIV0(25:11)
 20823     CALL 'kxdfhei1' USING DFHEIV0,
 20824           CERT-ID,
 20825           CERTIFICATE-MASTER,
 20826           DFHEIV11,
 20827           DFHEIV99
 20828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20829        GO TO 7800-EXIT.
 20830
 20831       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 20832       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 20833
 20834 7800-EXIT.
 20835      EXIT.
 20836
 20837 7900-DELETE-CERT.
 20838
 20839* EXEC CICS DELETE
 20840*        DATASET (CERT-ID)
 20841*    END-EXEC.
 20842*    MOVE '&(                    &   #00020125' TO DFHEIV0
 20843     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 20844     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20845     MOVE X'2020233030303230313235' TO DFHEIV0(25:11)
 20846     CALL 'kxdfhei1' USING DFHEIV0,
 20847           CERT-ID,
 20848           DFHEIV99,
 20849           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 385
* EL050.cbl
 20850           DFHEIV99,
 20851           DFHEIV99
 20852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20853
 20854
 20855 7900-EXIT.
 20856     EXIT.
 20857
 20858 8000-WRITE-CERT.
 20859
 20860* EXEC CICS HANDLE CONDITION
 20861*        DUPKEY    (8000-FREE-MAIN)
 20862*    END-EXEC.
 20863*    MOVE '"$$                   ! , #00020133' TO DFHEIV0
 20864     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20865     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20866     MOVE X'2C20233030303230313333' TO DFHEIV0(25:11)
 20867     CALL 'kxdfhei1' USING DFHEIV0
 20868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20869
 20870
 20871
 20872* EXEC CICS WRITE
 20873*        DATASET     (CERT-ID)
 20874*        FROM        (CERTIFICATE-MASTER)
 20875*        RIDFLD      (ELCERT-KEY)
 20876*    END-EXEC.
 20877     MOVE LENGTH OF
 20878      CERTIFICATE-MASTER
 20879       TO DFHEIV11
 20880*    MOVE '&$ L                  ''   #00020137' TO DFHEIV0
 20881     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20882     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20883     MOVE X'2020233030303230313337' TO DFHEIV0(25:11)
 20884     CALL 'kxdfhei1' USING DFHEIV0,
 20885           CERT-ID,
 20886           CERTIFICATE-MASTER,
 20887           DFHEIV11,
 20888           ELCERT-KEY,
 20889           DFHEIV99,
 20890           DFHEIV99
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894 8000-FREE-MAIN.
 20895
 20896 8000-EXIT.
 20897      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 386
* EL050.cbl
 20899
 20900 8100-READ-ERPNDM.
 20901
 20902* EXEC CICS HANDLE CONDITION
 20903*         NOTFND     (8100-NOTFND)
 20904*         ENDFILE    (8100-NOTFND)
 20905*    END-EXEC.
 20906*    MOVE '"$I''                  ! - #00020150' TO DFHEIV0
 20907     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20909     MOVE X'2D20233030303230313530' TO DFHEIV0(25:11)
 20910     CALL 'kxdfhei1' USING DFHEIV0
 20911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20912
 20913
 20914     MOVE SPACES                 TO ERPNDM-FOUND.
 20915     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 20916
 20917
 20918* EXEC CICS READ UPDATE
 20919*         DATASET   (FILE-ERPNDM)
 20920*         RIDFLD    (PM-CONTROL-PRIMARY)
 20921*         INTO      (PENDING-MAILING-DATA)
 20922*    END-EXEC.
 20923     MOVE LENGTH OF
 20924      PENDING-MAILING-DATA
 20925       TO DFHEIV11
 20926*    MOVE '&"IL       EU         (   #00020158' TO DFHEIV0
 20927     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20928     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20929     MOVE X'2020233030303230313538' TO DFHEIV0(25:11)
 20930     CALL 'kxdfhei1' USING DFHEIV0,
 20931           FILE-ERPNDM,
 20932           PENDING-MAILING-DATA,
 20933           DFHEIV11,
 20934           PM-CONTROL-PRIMARY,
 20935           DFHEIV99,
 20936           DFHEIV99,
 20937           DFHEIV99
 20938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20939
 20940
 20941     GO TO 8100-EXIT.
 20942
 20943 8100-NOTFND.
 20944
 20945     MOVE 'X'                    TO ERPNDM-FOUND.
 20946     MOVE ER-2694                TO WS-ERROR.
 20947     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20948     MOVE ER-2883                TO WS-ERROR
 20949     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 20950     .
 20951 8100-EXIT.
 20952     EXIT.
 20953 8102-REWRITE-ERPNDM.
 20954
 20955
 20956* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 387
* EL050.cbl
 20957*         DATASET    (FILE-ERPNDM)
 20958*         FROM       (PENDING-MAILING-DATA)
 20959*    END-EXEC
 20960     MOVE LENGTH OF
 20961      PENDING-MAILING-DATA
 20962       TO DFHEIV11
 20963*    MOVE '&& L                  %   #00020178' TO DFHEIV0
 20964     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20965     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20966     MOVE X'2020233030303230313738' TO DFHEIV0(25:11)
 20967     CALL 'kxdfhei1' USING DFHEIV0,
 20968           FILE-ERPNDM,
 20969           PENDING-MAILING-DATA,
 20970           DFHEIV11,
 20971           DFHEIV99
 20972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20973
 20974     .
 20975 8102-EXIT.
 20976     EXIT.
 20977 8104-UNLOCK-ERPNDM.
 20978
 20979
 20980* EXEC CICS UNLOCK
 20981*         DATASET   (FILE-ERPNDM)
 20982*    END-EXEC
 20983*    MOVE '&*                    #   #00020188' TO DFHEIV0
 20984     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20985     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20986     MOVE X'2020233030303230313838' TO DFHEIV0(25:11)
 20987     CALL 'kxdfhei1' USING DFHEIV0,
 20988           FILE-ERPNDM,
 20989           DFHEIV99
 20990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20991
 20992     .
 20993 8104-EXIT.
 20994     EXIT.
 20995 8110-READ-ERMAIL.
 20996
 20997* EXEC CICS HANDLE CONDITION
 20998*         NOTFND     (8110-NOTFND)
 20999*         ENDFILE    (8110-NOTFND)
 21000*    END-EXEC.
 21001*    MOVE '"$I''                  ! . #00020196' TO DFHEIV0
 21002     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21004     MOVE X'2E20233030303230313936' TO DFHEIV0(25:11)
 21005     CALL 'kxdfhei1' USING DFHEIV0
 21006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21007
 21008
 21009     MOVE SPACES                 TO ERMAIL-FOUND.
 21010     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 21011     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 21012     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 21013     MOVE PB-SV-STATE            TO MA-STATE.
 21014
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 388
* EL050.cbl
 21015
 21016* EXEC CICS READ
 21017*         UPDATE
 21018*         DATASET   (FILE-ERMAIL)
 21019*         RIDFLD    (MA-CONTROL-PRIMARY)
 21020*         INTO      (MAILING-DATA)
 21021*    END-EXEC.
 21022     MOVE LENGTH OF
 21023      MAILING-DATA
 21024       TO DFHEIV11
 21025*    MOVE '&"IL       EU         (   #00020207' TO DFHEIV0
 21026     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21027     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21028     MOVE X'2020233030303230323037' TO DFHEIV0(25:11)
 21029     CALL 'kxdfhei1' USING DFHEIV0,
 21030           FILE-ERMAIL,
 21031           MAILING-DATA,
 21032           DFHEIV11,
 21033           MA-CONTROL-PRIMARY,
 21034           DFHEIV99,
 21035           DFHEIV99,
 21036           DFHEIV99
 21037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21038
 21039
 21040     GO TO 8110-EXIT.
 21041
 21042 8110-NOTFND.
 21043     MOVE 'X'                    TO ERMAIL-FOUND.
 21044
 21045 8110-EXIT.
 21046     EXIT.
 21047
 21048 8120-REWRITE-ERMAIL.
 21049
 21050* EXEC CICS REWRITE
 21051*         DATASET    (FILE-ERMAIL)
 21052*         FROM       (MAILING-DATA)
 21053*    END-EXEC.
 21054     MOVE LENGTH OF
 21055      MAILING-DATA
 21056       TO DFHEIV11
 21057*    MOVE '&& L                  %   #00020223' TO DFHEIV0
 21058     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21059     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21060     MOVE X'2020233030303230323233' TO DFHEIV0(25:11)
 21061     CALL 'kxdfhei1' USING DFHEIV0,
 21062           FILE-ERMAIL,
 21063           MAILING-DATA,
 21064           DFHEIV11,
 21065           DFHEIV99
 21066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21067
 21068
 21069 8120-EXIT.
 21070     EXIT.
 21071
 21072 8130-WRITE-ERMAIL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 389
* EL050.cbl
 21073
 21074* EXEC CICS HANDLE CONDITION
 21075*         DUPKEY   (8130-EXIT)
 21076*    END-EXEC.
 21077*    MOVE '"$$                   ! / #00020232' TO DFHEIV0
 21078     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 21079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21080     MOVE X'2F20233030303230323332' TO DFHEIV0(25:11)
 21081     CALL 'kxdfhei1' USING DFHEIV0
 21082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21083
 21084
 21085
 21086* EXEC CICS WRITE
 21087*         DATASET     (FILE-ERMAIL)
 21088*         RIDFLD      (MA-CONTROL-PRIMARY)
 21089*         FROM        (MAILING-DATA)
 21090*    END-EXEC.
 21091     MOVE LENGTH OF
 21092      MAILING-DATA
 21093       TO DFHEIV11
 21094*    MOVE '&$ L                  ''   #00020236' TO DFHEIV0
 21095     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21096     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21097     MOVE X'2020233030303230323336' TO DFHEIV0(25:11)
 21098     CALL 'kxdfhei1' USING DFHEIV0,
 21099           FILE-ERMAIL,
 21100           MAILING-DATA,
 21101           DFHEIV11,
 21102           MA-CONTROL-PRIMARY,
 21103           DFHEIV99,
 21104           DFHEIV99
 21105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21106
 21107
 21108 8130-EXIT.
 21109     EXIT.
 21110
 21111 8140-UNLOCK-ERMAIL.
 21112
 21113* EXEC CICS UNLOCK
 21114*         DATASET   (FILE-ERMAIL)
 21115*    END-EXEC.
 21116*    MOVE '&*                    #   #00020246' TO DFHEIV0
 21117     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21118     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21119     MOVE X'2020233030303230323436' TO DFHEIV0(25:11)
 21120     CALL 'kxdfhei1' USING DFHEIV0,
 21121           FILE-ERMAIL,
 21122           DFHEIV99
 21123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21124
 21125
 21126 8140-EXIT.
 21127     EXIT.
 21128
 21129 8145-read-elcrtt-upd.
 21130
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 390
* EL050.cbl
 21131     move ' '                    to elcrtt-found-sw
 21132                                    elcrtt-update-sw
 21133
 21134* EXEC CICS HANDLE CONDITION
 21135*        NOTFND   (8145-exit)
 21136*    END-EXEC
 21137*    MOVE '"$I                   ! 0 #00020257' TO DFHEIV0
 21138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21140     MOVE X'3020233030303230323537' TO DFHEIV0(25:11)
 21141     CALL 'kxdfhei1' USING DFHEIV0
 21142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21143
 21144     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21145     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21146
 21147
 21148* EXEC CICS READ UPDATE
 21149*        DATASET  (CRTT-ID)
 21150*        RIDFLD   (WS-ELCRTT-KEY)
 21151*        INTO     (CERTIFICATE-TRAILERS)
 21152*    END-EXEC
 21153     MOVE LENGTH OF
 21154      CERTIFICATE-TRAILERS
 21155       TO DFHEIV11
 21156*    MOVE '&"IL       EU         (   #00020264' TO DFHEIV0
 21157     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21158     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21159     MOVE X'2020233030303230323634' TO DFHEIV0(25:11)
 21160     CALL 'kxdfhei1' USING DFHEIV0,
 21161           CRTT-ID,
 21162           CERTIFICATE-TRAILERS,
 21163           DFHEIV11,
 21164           WS-ELCRTT-KEY,
 21165           DFHEIV99,
 21166           DFHEIV99,
 21167           DFHEIV99
 21168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21169
 21170     set elcrtt-found to true
 21171
 21172     .
 21173 8145-exit.
 21174     exit.
 21175 8150-UPDATE-ELCRTT.
 21176
 21177     if elcrtt-found
 21178
 21179* EXEC CICS REWRITE
 21180*           DATASET  (CRTT-ID)
 21181*           FROM     (CERTIFICATE-TRAILERS)
 21182*        END-EXEC
 21183     MOVE LENGTH OF
 21184      CERTIFICATE-TRAILERS
 21185       TO DFHEIV11
 21186*    MOVE '&& L                  %   #00020278' TO DFHEIV0
 21187     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21188     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 391
* EL050.cbl
 21189     MOVE X'2020233030303230323738' TO DFHEIV0(25:11)
 21190     CALL 'kxdfhei1' USING DFHEIV0,
 21191           CRTT-ID,
 21192           CERTIFICATE-TRAILERS,
 21193           DFHEIV11,
 21194           DFHEIV99
 21195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21196     ELSE
 21197
 21198* EXEC CICS WRITE
 21199*          DATASET  (CRTT-ID)
 21200*          RIDFLD   (WS-ELCRTT-KEY)
 21201*          FROM     (CERTIFICATE-TRAILERS)
 21202*       END-EXEC
 21203     MOVE LENGTH OF
 21204      CERTIFICATE-TRAILERS
 21205       TO DFHEIV11
 21206*    MOVE '&$ L                  ''   #00020283' TO DFHEIV0
 21207     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21208     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21209     MOVE X'2020233030303230323833' TO DFHEIV0(25:11)
 21210     CALL 'kxdfhei1' USING DFHEIV0,
 21211           CRTT-ID,
 21212           CERTIFICATE-TRAILERS,
 21213           DFHEIV11,
 21214           WS-ELCRTT-KEY,
 21215           DFHEIV99,
 21216           DFHEIV99
 21217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21218     end-if
 21219
 21220     .
 21221 8150-EXIT.
 21222     EXIT.
 21223
 21224 8155-unlock-elcrtt.
 21225
 21226
 21227* EXEC CICS UNLOCK
 21228*       DATASET  (CRTT-ID)
 21229*    END-EXEC
 21230*    MOVE '&*                    #   #00020296' TO DFHEIV0
 21231     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21232     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21233     MOVE X'2020233030303230323936' TO DFHEIV0(25:11)
 21234     CALL 'kxdfhei1' USING DFHEIV0,
 21235           CRTT-ID,
 21236           DFHEIV99
 21237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21238
 21239     .
 21240 8155-exit.
 21241     exit.
 21242
 21243 8190-UPDATE-REFUND-CLAIM-FLAG.
 21244
 21245* EXEC CICS HANDLE CONDITION
 21246*        NOTFND   (8190-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 392
* EL050.cbl
 21247*    END-EXEC.
 21248*    MOVE '"$I                   ! 1 #00020305' TO DFHEIV0
 21249     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21251     MOVE X'3120233030303230333035' TO DFHEIV0(25:11)
 21252     CALL 'kxdfhei1' USING DFHEIV0
 21253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21254
 21255
 21256     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21257     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21258
 21259
 21260* EXEC CICS READ
 21261*        UPDATE
 21262*        DATASET  (CRTT-ID)
 21263*        RIDFLD   (WS-ELCRTT-KEY)
 21264*        INTO     (CERTIFICATE-TRAILERS)
 21265*    END-EXEC.
 21266     MOVE LENGTH OF
 21267      CERTIFICATE-TRAILERS
 21268       TO DFHEIV11
 21269*    MOVE '&"IL       EU         (   #00020312' TO DFHEIV0
 21270     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21271     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21272     MOVE X'2020233030303230333132' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0,
 21274           CRTT-ID,
 21275           CERTIFICATE-TRAILERS,
 21276           DFHEIV11,
 21277           WS-ELCRTT-KEY,
 21278           DFHEIV99,
 21279           DFHEIV99,
 21280           DFHEIV99
 21281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21282
 21283
 21284     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21285
 21286* EXEC CICS REWRITE
 21287*       DATASET  (CRTT-ID)
 21288*       FROM     (CERTIFICATE-TRAILERS)
 21289*    END-EXEC.
 21290     MOVE LENGTH OF
 21291      CERTIFICATE-TRAILERS
 21292       TO DFHEIV11
 21293*    MOVE '&& L                  %   #00020320' TO DFHEIV0
 21294     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21295     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21296     MOVE X'2020233030303230333230' TO DFHEIV0(25:11)
 21297     CALL 'kxdfhei1' USING DFHEIV0,
 21298           CRTT-ID,
 21299           CERTIFICATE-TRAILERS,
 21300           DFHEIV11,
 21301           DFHEIV99
 21302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21303
 21304
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 393
* EL050.cbl
 21305     GO TO 8190-EXIT.
 21306
 21307 8190-NOTFND.
 21308
 21309     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21310     MOVE 'CS'         TO CS-RECORD-ID.
 21311     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21312     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21313     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21314     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 21315
 21316* EXEC CICS WRITE
 21317*       DATASET  (CRTT-ID)
 21318*       RIDFLD   (WS-ELCRTT-KEY)
 21319*       FROM     (CERTIFICATE-TRAILERS)
 21320*    END-EXEC.
 21321     MOVE LENGTH OF
 21322      CERTIFICATE-TRAILERS
 21323       TO DFHEIV11
 21324*    MOVE '&$ L                  ''   #00020335' TO DFHEIV0
 21325     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21327     MOVE X'2020233030303230333335' TO DFHEIV0(25:11)
 21328     CALL 'kxdfhei1' USING DFHEIV0,
 21329           CRTT-ID,
 21330           CERTIFICATE-TRAILERS,
 21331           DFHEIV11,
 21332           WS-ELCRTT-KEY,
 21333           DFHEIV99,
 21334           DFHEIV99
 21335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21336
 21337
 21338 8190-EXIT.
 21339     EXIT.
 21340
 21341 8195-UPDATE-AGE-FLAGS.
 21342
 21343* EXEC CICS HANDLE CONDITION
 21344*        NOTFND   (8195-NOTFND)
 21345*    END-EXEC.
 21346*    MOVE '"$I                   ! 2 #00020345' TO DFHEIV0
 21347     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21349     MOVE X'3220233030303230333435' TO DFHEIV0(25:11)
 21350     CALL 'kxdfhei1' USING DFHEIV0
 21351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21352
 21353
 21354     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 21355     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 21356
 21357
 21358* EXEC CICS READ
 21359*        UPDATE
 21360*        DATASET  (CRTT-ID)
 21361*        RIDFLD   (WS-ELCRTT-KEY)
 21362*        INTO     (CERTIFICATE-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 394
* EL050.cbl
 21363*    END-EXEC.
 21364     MOVE LENGTH OF
 21365      CERTIFICATE-TRAILERS
 21366       TO DFHEIV11
 21367*    MOVE '&"IL       EU         (   #00020352' TO DFHEIV0
 21368     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21369     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21370     MOVE X'2020233030303230333532' TO DFHEIV0(25:11)
 21371     CALL 'kxdfhei1' USING DFHEIV0,
 21372           CRTT-ID,
 21373           CERTIFICATE-TRAILERS,
 21374           DFHEIV11,
 21375           WS-ELCRTT-KEY,
 21376           DFHEIV99,
 21377           DFHEIV99,
 21378           DFHEIV99
 21379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21380
 21381
 21382     IF WS-INS-AGE-SET = 'Y'
 21383        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 21384     END-IF
 21385     IF WS-JNT-AGE-SET = 'Y'
 21386        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 21387     END-IF
 21388
 21389
 21390* EXEC CICS REWRITE
 21391*       DATASET  (CRTT-ID)
 21392*       FROM     (CERTIFICATE-TRAILERS)
 21393*    END-EXEC.
 21394     MOVE LENGTH OF
 21395      CERTIFICATE-TRAILERS
 21396       TO DFHEIV11
 21397*    MOVE '&& L                  %   #00020366' TO DFHEIV0
 21398     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21399     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21400     MOVE X'2020233030303230333636' TO DFHEIV0(25:11)
 21401     CALL 'kxdfhei1' USING DFHEIV0,
 21402           CRTT-ID,
 21403           CERTIFICATE-TRAILERS,
 21404           DFHEIV11,
 21405           DFHEIV99
 21406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21407
 21408
 21409     GO TO 8195-EXIT.
 21410
 21411 8195-NOTFND.
 21412
 21413     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 21414     MOVE 'CS'         TO CS-RECORD-ID.
 21415     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 21416     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 21417     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 21418     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 21419     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 21420
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 395
* EL050.cbl
 21421* EXEC CICS WRITE
 21422*       DATASET  (CRTT-ID)
 21423*       RIDFLD   (WS-ELCRTT-KEY)
 21424*       FROM     (CERTIFICATE-TRAILERS)
 21425*    END-EXEC.
 21426     MOVE LENGTH OF
 21427      CERTIFICATE-TRAILERS
 21428       TO DFHEIV11
 21429*    MOVE '&$ L                  ''   #00020382' TO DFHEIV0
 21430     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21432     MOVE X'2020233030303230333832' TO DFHEIV0(25:11)
 21433     CALL 'kxdfhei1' USING DFHEIV0,
 21434           CRTT-ID,
 21435           CERTIFICATE-TRAILERS,
 21436           DFHEIV11,
 21437           WS-ELCRTT-KEY,
 21438           DFHEIV99,
 21439           DFHEIV99
 21440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21441
 21442
 21443 8195-EXIT.
 21444     EXIT.
 21445
 21446 8200-READ-REIN-TABLE.
 21447
 21448* EXEC CICS HANDLE CONDITION
 21449*         NOTFND   (8200-NOTFND)
 21450*    END-EXEC.
 21451*    MOVE '"$I                   ! 3 #00020392' TO DFHEIV0
 21452     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21453     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21454     MOVE X'3320233030303230333932' TO DFHEIV0(25:11)
 21455     CALL 'kxdfhei1' USING DFHEIV0
 21456     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21457
 21458
 21459
 21460* EXEC CICS READ
 21461*        DATASET     (REIN-ID)
 21462*        SET         (ADDRESS OF REINSURANCE-RECORD)
 21463*        RIDFLD      (ERREIN-KEY)
 21464*    END-EXEC.
 21465*    MOVE '&"S        E          (   #00020396' TO DFHEIV0
 21466     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21468     MOVE X'2020233030303230333936' TO DFHEIV0(25:11)
 21469     CALL 'kxdfhei1' USING DFHEIV0,
 21470           REIN-ID,
 21471           DFHEIV20,
 21472           DFHEIV99,
 21473           ERREIN-KEY,
 21474           DFHEIV99,
 21475           DFHEIV99,
 21476           DFHEIV99
 21477     SET ADDRESS OF REINSURANCE-RECORD TO
 21478         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 396
* EL050.cbl
 21479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21480
 21481
 21482     GO TO 8200-EXIT.
 21483
 21484 8200-NOTFND.
 21485     MOVE 'N'             TO WS-REIN-READ-SW.
 21486
 21487 8200-EXIT.
 21488      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 397
* EL050.cbl
 21490
 21491 8300-READ-CTBL-TABLE.
 21492
 21493* EXEC CICS HANDLE CONDITION
 21494*        NOTFND    (8300-NOTFND)
 21495*        DISABLED  (8300-ERRESS-PROBLEM)
 21496*        NOTOPEN   (8300-ERRESS-PROBLEM)
 21497*        ENDFILE   (8300-NOTFND)
 21498*    END-EXEC.
 21499*    MOVE '"$IcJ''                ! 4 #00020412' TO DFHEIV0
 21500     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 21501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21502     MOVE X'3420233030303230343132' TO DFHEIV0(25:11)
 21503     CALL 'kxdfhei1' USING DFHEIV0
 21504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21505
 21506
 21507
 21508* EXEC CICS READ
 21509*        DATASET     (CTBL-ID)
 21510*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 21511*        RIDFLD      (ERCTBL-KEY)
 21512*    END-EXEC.
 21513*    MOVE '&"S        E          (   #00020419' TO DFHEIV0
 21514     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21516     MOVE X'2020233030303230343139' TO DFHEIV0(25:11)
 21517     CALL 'kxdfhei1' USING DFHEIV0,
 21518           CTBL-ID,
 21519           DFHEIV20,
 21520           DFHEIV99,
 21521           ERCTBL-KEY,
 21522           DFHEIV99,
 21523           DFHEIV99,
 21524           DFHEIV99
 21525     SET ADDRESS OF COMM-TABLE-RECORD TO
 21526         DFHEIV20
 21527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21528
 21529
 21530     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 21531
 21532     GO TO 8300-EXIT.
 21533
 21534 8300-NOTFND.
 21535
 21536     IF CTBL-SW = '0530'
 21537         MOVE 'AA'                     TO WS-AH-COMP-CD
 21538         MOVE '0550'                   TO CTBL-SW
 21539         MOVE '1'                      TO WS-CTBL-READ-SW
 21540         GO TO 8300-EXIT.
 21541
 21542     IF CTBL-SW = '0540'
 21543         MOVE 'AA'                     TO WS-LF-COMP-CD
 21544         MOVE '0550'                   TO CTBL-SW
 21545         MOVE '1'                      TO WS-CTBL-READ-SW
 21546         GO TO 8300-EXIT.
 21547
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 398
* EL050.cbl
 21548     IF CTBL-SW = '0550'
 21549         MOVE '2'                      TO WS-CTBL-READ-SW
 21550         GO TO 8300-EXIT.
 21551
 21552     GO TO 8300-EXIT.
 21553
 21554 8300-ERRESS-PROBLEM.
 21555
 21556      MOVE ER-8050              TO WS-ERROR.
 21557      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21558
 21559     GO TO 8300-EXIT.
 21560
 21561 8300-EXIT.
 21562      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 399
* EL050.cbl
 21564
 21565
 21566 8400-GETMAIN-ERFORM.
 21567
 21568
 21569* EXEC CICS   GETMAIN
 21570*        LENGTH  (500)
 21571*        SET     (ADDRESS OF FORM-MASTER)
 21572*    END-EXEC.
 21573     MOVE 500
 21574       TO DFHEIV11
 21575*    MOVE '," L                  $   #00020463' TO DFHEIV0
 21576     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21577     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21578     MOVE X'2020233030303230343633' TO DFHEIV0(25:11)
 21579     CALL 'kxdfhei1' USING DFHEIV0,
 21580           DFHEIV20,
 21581           DFHEIV11,
 21582           DFHEIV99
 21583     SET ADDRESS OF FORM-MASTER TO
 21584         DFHEIV20
 21585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21586
 21587
 21588     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 21589
 21590 8400-EXIT.
 21591      EXIT.
 21592
 21593 8450-READ-FORM-MASTER.
 21594
 21595
 21596* EXEC CICS  HANDLE CONDITION
 21597*        NOTFND   (8450-FORM-NOT-FOUND)
 21598*        ENDFILE  (8450-FORM-NOT-FOUND)
 21599*    END-EXEC.
 21600*    MOVE '"$I''                  ! 5 #00020475' TO DFHEIV0
 21601     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21602     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21603     MOVE X'3520233030303230343735' TO DFHEIV0(25:11)
 21604     CALL 'kxdfhei1' USING DFHEIV0
 21605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21606
 21607
 21608
 21609* EXEC CICS   READ
 21610*        DATASET   (FORM-ID)
 21611*        RIDFLD    (ERFORM-KEY)
 21612*        INTO      (FORM-MASTER)
 21613*        GTEQ
 21614*    END-EXEC.
 21615     MOVE LENGTH OF
 21616      FORM-MASTER
 21617       TO DFHEIV11
 21618*    MOVE '&"IL       G          (   #00020480' TO DFHEIV0
 21619     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21620     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21621     MOVE X'2020233030303230343830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 400
* EL050.cbl
 21622     CALL 'kxdfhei1' USING DFHEIV0,
 21623           FORM-ID,
 21624           FORM-MASTER,
 21625           DFHEIV11,
 21626           ERFORM-KEY,
 21627           DFHEIV99,
 21628           DFHEIV99,
 21629           DFHEIV99
 21630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21631
 21632
 21633     MOVE  'Y'           TO  FORM-MASTER-SW.
 21634
 21635     GO TO  8450-EXIT.
 21636
 21637 8450-FORM-NOT-FOUND.
 21638
 21639     MOVE  'N'           TO  FORM-MASTER-SW.
 21640
 21641 8450-EXIT.
 21642      EXIT.
 21643
 21644 8500-DATE-CONVERT.
 21645
 21646* EXEC CICS LINK
 21647*        PROGRAM    ('ELDATCV')
 21648*        COMMAREA   (DATE-CONVERSION-DATA)
 21649*        LENGTH     (DC-COMM-LENGTH)
 21650*    END-EXEC.
 21651     MOVE 'ELDATCV' TO DFHEIV1
 21652*    MOVE '."C                   (   #00020499' TO DFHEIV0
 21653     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21655     MOVE X'2020233030303230343939' TO DFHEIV0(25:11)
 21656     CALL 'kxdfhei1' USING DFHEIV0,
 21657           DFHEIV1,
 21658           DATE-CONVERSION-DATA,
 21659           DC-COMM-LENGTH,
 21660           DFHEIV99,
 21661           DFHEIV99,
 21662           DFHEIV99,
 21663           DFHEIV99
 21664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21665
 21666
 21667 8500-EXIT.
 21668     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 401
* EL050.cbl
 21670
 21671 8555-RELOAD-CONTROL-FILE.
 21672     CONTINUE.
 21673
 21674 8555-EXIT.
 21675     EXIT.
 21676
 21677 8557-GETMAIN-ERPLAN.
 21678
 21679
 21680* EXEC CICS GETMAIN
 21681*        LENGTH    (840)
 21682*        SET       (ADDRESS OF PLAN-RECORDS)
 21683*    END-EXEC.
 21684     MOVE 840
 21685       TO DFHEIV11
 21686*    MOVE '," L                  $   #00020517' TO DFHEIV0
 21687     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21688     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21689     MOVE X'2020233030303230353137' TO DFHEIV0(25:11)
 21690     CALL 'kxdfhei1' USING DFHEIV0,
 21691           DFHEIV20,
 21692           DFHEIV11,
 21693           DFHEIV99
 21694     SET ADDRESS OF PLAN-RECORDS TO
 21695         DFHEIV20
 21696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21697
 21698
 21699     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 21700
 21701 8557-EXIT.
 21702     EXIT.
 21703
 21704 8560-GETMAIN.
 21705
 21706* EXEC CICS GETMAIN
 21707*        LENGTH    (2000)
 21708*        SET       (ADDRESS OF ACCOUNT-MASTER)
 21709*    END-EXEC.
 21710     MOVE 2000
 21711       TO DFHEIV11
 21712*    MOVE '," L                  $   #00020528' TO DFHEIV0
 21713     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21714     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21715     MOVE X'2020233030303230353238' TO DFHEIV0(25:11)
 21716     CALL 'kxdfhei1' USING DFHEIV0,
 21717           DFHEIV20,
 21718           DFHEIV11,
 21719           DFHEIV99
 21720     SET ADDRESS OF ACCOUNT-MASTER TO
 21721         DFHEIV20
 21722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21723
 21724
 21725     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 21726
 21727 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 402
* EL050.cbl
 21728     EXIT.
 21729
 21730 8570-START-ACCOUNT-MASTER.
 21731
 21732* EXEC CICS HANDLE CONDITION
 21733*        NOTFND    (0199-ACCT-NOT-FOUND)
 21734*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21735*    END-EXEC.
 21736*    MOVE '"$I''                  ! 6 #00020539' TO DFHEIV0
 21737     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21738     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21739     MOVE X'3620233030303230353339' TO DFHEIV0(25:11)
 21740     CALL 'kxdfhei1' USING DFHEIV0
 21741     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21742
 21743
 21744
 21745* EXEC CICS STARTBR
 21746*        DATASET    (ACCT-ID)
 21747*        RIDFLD     (ERACCT-KEY)
 21748*        GTEQ
 21749*    END-EXEC.
 21750     MOVE 0
 21751       TO DFHEIV11
 21752*    MOVE '&,         G          &   #00020544' TO DFHEIV0
 21753     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21754     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21755     MOVE X'2020233030303230353434' TO DFHEIV0(25:11)
 21756     CALL 'kxdfhei1' USING DFHEIV0,
 21757           ACCT-ID,
 21758           ERACCT-KEY,
 21759           DFHEIV99,
 21760           DFHEIV11,
 21761           DFHEIV99
 21762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21763
 21764
 21765 8570-EXIT.
 21766     EXIT.
 21767
 21768 8580-READ-ACCOUNT-MASTER.
 21769
 21770* EXEC CICS HANDLE CONDITION
 21771*        NOTFND    (0199-ACCT-NOT-FOUND)
 21772*        ENDFILE   (0199-ACCT-NOT-FOUND)
 21773*    END-EXEC.
 21774*    MOVE '"$I''                  ! 7 #00020554' TO DFHEIV0
 21775     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21777     MOVE X'3720233030303230353534' TO DFHEIV0(25:11)
 21778     CALL 'kxdfhei1' USING DFHEIV0
 21779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21780
 21781
 21782
 21783* EXEC CICS READNEXT
 21784*        DATASET     (ACCT-ID)
 21785*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 403
* EL050.cbl
 21786*        RIDFLD      (ERACCT-KEY)
 21787*    END-EXEC.
 21788     MOVE LENGTH OF
 21789      ACCOUNT-MASTER
 21790       TO DFHEIV12
 21791     MOVE 0
 21792       TO DFHEIV11
 21793*    MOVE '&.IL                  )   #00020559' TO DFHEIV0
 21794     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21795     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21796     MOVE X'2020233030303230353539' TO DFHEIV0(25:11)
 21797     CALL 'kxdfhei1' USING DFHEIV0,
 21798           ACCT-ID,
 21799           ACCOUNT-MASTER,
 21800           DFHEIV12,
 21801           ERACCT-KEY,
 21802           DFHEIV99,
 21803           DFHEIV11,
 21804           DFHEIV99,
 21805           DFHEIV99
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21807
 21808
 21809 8580-EXIT.
 21810     EXIT.
 21811
 21812 8582-READ-COMPENSATION-MASTER.
 21813
 21814* EXEC CICS HANDLE CONDITION
 21815*        NOTFND    (8582-COMP-NOT-FOUND)
 21816*        ENDFILE   (8582-COMP-NOT-FOUND)
 21817*    END-EXEC.
 21818*    MOVE '"$I''                  ! 8 #00020569' TO DFHEIV0
 21819     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21821     MOVE X'3820233030303230353639' TO DFHEIV0(25:11)
 21822     CALL 'kxdfhei1' USING DFHEIV0
 21823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21824
 21825
 21826
 21827* EXEC CICS READ
 21828*        DATASET     (COMP-ID)
 21829*        INTO        (COMPENSATION-MASTER)
 21830*        RIDFLD      (ERCOMP-KEY)
 21831*    END-EXEC.
 21832     MOVE LENGTH OF
 21833      COMPENSATION-MASTER
 21834       TO DFHEIV11
 21835*    MOVE '&"IL       E          (   #00020574' TO DFHEIV0
 21836     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21838     MOVE X'2020233030303230353734' TO DFHEIV0(25:11)
 21839     CALL 'kxdfhei1' USING DFHEIV0,
 21840           COMP-ID,
 21841           COMPENSATION-MASTER,
 21842           DFHEIV11,
 21843           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 404
* EL050.cbl
 21844           DFHEIV99,
 21845           DFHEIV99,
 21846           DFHEIV99
 21847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21848
 21849
 21850     MOVE 'Y'                    TO COMP-MASTER-SW
 21851
 21852     GO TO 8582-EXIT
 21853     .
 21854 8582-COMP-NOT-FOUND.
 21855
 21856     MOVE 'N'                    TO COMP-MASTER-SW.
 21857
 21858 8582-EXIT.
 21859     EXIT.
 21860
 21861 8583-READ-ERAGTC.
 21862
 21863* EXEC CICS HANDLE CONDITION
 21864*        NOTFND    (8583-AGTC-NOT-FOUND)
 21865*        ENDFILE   (8583-AGTC-NOT-FOUND)
 21866*    END-EXEC.
 21867*    MOVE '"$I''                  ! 9 #00020592' TO DFHEIV0
 21868     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21870     MOVE X'3920233030303230353932' TO DFHEIV0(25:11)
 21871     CALL 'kxdfhei1' USING DFHEIV0
 21872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21873
 21874
 21875
 21876* EXEC CICS STARTBR
 21877*        DATASET    (AGTC-ID)
 21878*        RIDFLD     (ERAGTC-KEY)
 21879*        GTEQ
 21880*    END-EXEC.
 21881     MOVE 0
 21882       TO DFHEIV11
 21883*    MOVE '&,         G          &   #00020597' TO DFHEIV0
 21884     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21885     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21886     MOVE X'2020233030303230353937' TO DFHEIV0(25:11)
 21887     CALL 'kxdfhei1' USING DFHEIV0,
 21888           AGTC-ID,
 21889           ERAGTC-KEY,
 21890           DFHEIV99,
 21891           DFHEIV11,
 21892           DFHEIV99
 21893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21894
 21895
 21896 8583-READ-ERAGTC-NEXT.
 21897
 21898* EXEC CICS READNEXT
 21899*        DATASET     (AGTC-ID)
 21900*        INTO        (AGENT-COMMISSIONS)
 21901*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 405
* EL050.cbl
 21902*    END-EXEC.
 21903     MOVE LENGTH OF
 21904      AGENT-COMMISSIONS
 21905       TO DFHEIV12
 21906     MOVE 0
 21907       TO DFHEIV11
 21908*    MOVE '&.IL                  )   #00020604' TO DFHEIV0
 21909     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21910     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21911     MOVE X'2020233030303230363034' TO DFHEIV0(25:11)
 21912     CALL 'kxdfhei1' USING DFHEIV0,
 21913           AGTC-ID,
 21914           AGENT-COMMISSIONS,
 21915           DFHEIV12,
 21916           ERAGTC-KEY,
 21917           DFHEIV99,
 21918           DFHEIV11,
 21919           DFHEIV99,
 21920           DFHEIV99
 21921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21922
 21923
 21924*    MOVE 'Y'                    TO AGTC-MASTER-SW
 21925
 21926     GO TO 8583-EXIT
 21927     .
 21928 8583-AGTC-NOT-FOUND.
 21929
 21930     MOVE 'N'                    TO AGTC-MASTER-SW.
 21931
 21932 8583-EXIT.
 21933     EXIT.
 21934
 21935 8584-READ-BANK-CROSS-REF.
 21936
 21937* EXEC CICS HANDLE CONDITION
 21938*        NOTFND    (8584-BXRF-NOT-FOUND)
 21939*        ENDFILE   (8584-BXRF-NOT-FOUND)
 21940*    END-EXEC.
 21941*    MOVE '"$I''                  ! : #00020622' TO DFHEIV0
 21942     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21944     MOVE X'3A20233030303230363232' TO DFHEIV0(25:11)
 21945     CALL 'kxdfhei1' USING DFHEIV0
 21946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21947
 21948
 21949
 21950* EXEC CICS READ
 21951*        DATASET     (BXRF-ID)
 21952*        INTO        (BANK-CROSS-REFERENCE)
 21953*        RIDFLD      (ERBXRF-KEY)
 21954*        LENGTH      (BXRF-REC-LENGTH)
 21955*    END-EXEC.
 21956*    MOVE '&"IL       E          (   #00020627' TO DFHEIV0
 21957     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21959     MOVE X'2020233030303230363237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 406
* EL050.cbl
 21960     CALL 'kxdfhei1' USING DFHEIV0,
 21961           BXRF-ID,
 21962           BANK-CROSS-REFERENCE,
 21963           BXRF-REC-LENGTH,
 21964           ERBXRF-KEY,
 21965           DFHEIV99,
 21966           DFHEIV99,
 21967           DFHEIV99
 21968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21969
 21970
 21971     MOVE 'Y'                    TO BXRF-MASTER-SW
 21972
 21973     GO TO 8584-EXIT
 21974     .
 21975 8584-BXRF-NOT-FOUND.
 21976
 21977     MOVE 'N'                    TO BXRF-MASTER-SW.
 21978
 21979 8584-EXIT.
 21980     EXIT.
 21981
 21982 8585-READ-PLAN-MASTER.
 21983
 21984
 21985* EXEC CICS HANDLE CONDITION
 21986*        NOTFND    (8585-PLAN-NOT-FOUND)
 21987*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21988*    END-EXEC.
 21989*    MOVE '"$I''                  ! ; #00020647' TO DFHEIV0
 21990     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21992     MOVE X'3B20233030303230363437' TO DFHEIV0(25:11)
 21993     CALL 'kxdfhei1' USING DFHEIV0
 21994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21995
 21996
 21997
 21998* EXEC CICS READ
 21999*        DATASET     (PLAN-ID)
 22000*        INTO        (PLAN-MASTER)
 22001*        RIDFLD      (ERPLAN-KEY)
 22002*    END-EXEC.
 22003     MOVE LENGTH OF
 22004      PLAN-MASTER
 22005       TO DFHEIV11
 22006*    MOVE '&"IL       E          (   #00020652' TO DFHEIV0
 22007     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22008     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22009     MOVE X'2020233030303230363532' TO DFHEIV0(25:11)
 22010     CALL 'kxdfhei1' USING DFHEIV0,
 22011           PLAN-ID,
 22012           PLAN-MASTER,
 22013           DFHEIV11,
 22014           ERPLAN-KEY,
 22015           DFHEIV99,
 22016           DFHEIV99,
 22017           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 407
* EL050.cbl
 22018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22019
 22020
 22021     MOVE 'Y'                    TO PLAN-MASTER-SW.
 22022
 22023     GO TO 8585-EXIT.
 22024
 22025 8585-PLAN-NOT-FOUND.
 22026
 22027     MOVE 'N'                    TO PLAN-MASTER-SW.
 22028
 22029 8585-EXIT.
 22030     EXIT.
 22031
 22032 8586-READ-LOAN-OFFICER.
 22033
 22034* EXEC CICS READ
 22035*        DATASET     (LOFC-ID)
 22036*        INTO        (LOAN-OFFICER-MASTER)
 22037*        RIDFLD      (ERLOFC-KEY)
 22038*        RESP        (WS-RESPONSE)
 22039*    END-EXEC
 22040     MOVE LENGTH OF
 22041      LOAN-OFFICER-MASTER
 22042       TO DFHEIV11
 22043*    MOVE '&"IL       E          (  N#00020670' TO DFHEIV0
 22044     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22046     MOVE X'204E233030303230363730' TO DFHEIV0(25:11)
 22047     CALL 'kxdfhei1' USING DFHEIV0,
 22048           LOFC-ID,
 22049           LOAN-OFFICER-MASTER,
 22050           DFHEIV11,
 22051           ERLOFC-KEY,
 22052           DFHEIV99,
 22053           DFHEIV99,
 22054           DFHEIV99
 22055     MOVE EIBRESP  TO WS-RESPONSE
 22056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22057
 22058     IF WS-RESP-NORMAL
 22059        MOVE 'Y'                 TO LOFC-MASTER-SW
 22060     ELSE
 22061        MOVE 'N'                 TO LOFC-MASTER-SW
 22062     END-IF
 22063     .
 22064 8586-EXIT.
 22065     EXIT.
 22066 8587-START-ERPDEF.
 22067
 22068* EXEC CICS STARTBR
 22069*       DATASET   (PDEF-ID)
 22070*       RIDFLD    (ERPDEF-KEY)
 22071*       GTEQ
 22072*       RESP      (WS-RESPONSE)
 22073*    END-EXEC
 22074     MOVE 0
 22075       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 408
* EL050.cbl
 22076*    MOVE '&,         G          &  N#00020686' TO DFHEIV0
 22077     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22078     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22079     MOVE X'204E233030303230363836' TO DFHEIV0(25:11)
 22080     CALL 'kxdfhei1' USING DFHEIV0,
 22081           PDEF-ID,
 22082           ERPDEF-KEY,
 22083           DFHEIV99,
 22084           DFHEIV11,
 22085           DFHEIV99
 22086     MOVE EIBRESP  TO WS-RESPONSE
 22087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22088     IF WS-RESP-NORMAL
 22089        MOVE 'Y'                 TO PDEF-MASTER-SW
 22090     ELSE
 22091        MOVE 'N'                 TO PDEF-MASTER-SW
 22092     END-IF
 22093     .
 22094 8587-EXIT.
 22095     EXIT.
 22096 8588-READ-ERPDEF.
 22097
 22098* EXEC CICS READNEXT
 22099*       DATASET   (PDEF-ID)
 22100*       RIDFLD    (ERPDEF-KEY)
 22101*       INTO      (PRODUCT-MASTER)
 22102*       RESP      (WS-RESPONSE)
 22103*    END-EXEC
 22104     MOVE LENGTH OF
 22105      PRODUCT-MASTER
 22106       TO DFHEIV12
 22107     MOVE 0
 22108       TO DFHEIV11
 22109*    MOVE '&.IL                  )  N#00020701' TO DFHEIV0
 22110     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22111     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22112     MOVE X'204E233030303230373031' TO DFHEIV0(25:11)
 22113     CALL 'kxdfhei1' USING DFHEIV0,
 22114           PDEF-ID,
 22115           PRODUCT-MASTER,
 22116           DFHEIV12,
 22117           ERPDEF-KEY,
 22118           DFHEIV99,
 22119           DFHEIV11,
 22120           DFHEIV99,
 22121           DFHEIV99
 22122     MOVE EIBRESP  TO WS-RESPONSE
 22123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22124     IF WS-RESP-NORMAL
 22125        MOVE 'Y'                 TO PDEF-MASTER-SW
 22126     ELSE
 22127        MOVE 'N'                 TO PDEF-MASTER-SW
 22128     END-IF
 22129     .
 22130 8588-EXIT.
 22131     EXIT.
 22132 8589-ENDBR-ERPDEF.
 22133
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 409
* EL050.cbl
 22134* EXEC CICS ENDBR
 22135*       DATASET   (PDEF-ID)
 22136*    END-EXEC
 22137     MOVE 0
 22138       TO DFHEIV11
 22139*    MOVE '&2                    $   #00020716' TO DFHEIV0
 22140     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22141     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22142     MOVE X'2020233030303230373136' TO DFHEIV0(25:11)
 22143     CALL 'kxdfhei1' USING DFHEIV0,
 22144           PDEF-ID,
 22145           DFHEIV11,
 22146           DFHEIV99
 22147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22148     .
 22149 8589-EXIT.
 22150     EXIT.
 22151 8590-READ-CERT-MASTER.
 22152     IF PB-COMPANY-ID = 'UCL'
 22153         GO TO 8690-READ-CERT-MASTER-UCL.
 22154
 22155
 22156* EXEC CICS HANDLE CONDITION
 22157*         NOTFND    (0299-CERT-NOT-FOUND)
 22158*    END-EXEC.
 22159*    MOVE '"$I                   ! < #00020726' TO DFHEIV0
 22160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22162     MOVE X'3C20233030303230373236' TO DFHEIV0(25:11)
 22163     CALL 'kxdfhei1' USING DFHEIV0
 22164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22165
 22166
 22167
 22168* EXEC CICS READ
 22169*        DATASET     (CERT-ID)
 22170*        INTO        (CERTIFICATE-MASTER)
 22171*        RIDFLD      (ELCERT-KEY)
 22172*        UPDATE
 22173*    END-EXEC.
 22174     MOVE LENGTH OF
 22175      CERTIFICATE-MASTER
 22176       TO DFHEIV11
 22177*    MOVE '&"IL       EU         (   #00020730' TO DFHEIV0
 22178     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22179     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22180     MOVE X'2020233030303230373330' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0,
 22182           CERT-ID,
 22183           CERTIFICATE-MASTER,
 22184           DFHEIV11,
 22185           ELCERT-KEY,
 22186           DFHEIV99,
 22187           DFHEIV99,
 22188           DFHEIV99
 22189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22190
 22191
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 410
* EL050.cbl
 22192 8590-EXIT.
 22193     EXIT.
 22194
 22195 8690-READ-CERT-MASTER-UCL.
 22196
 22197* EXEC CICS HANDLE CONDITION
 22198*         NOTFND    (8700-READ-CERT-MASTER)
 22199*    END-EXEC.
 22200*    MOVE '"$I                   ! = #00020741' TO DFHEIV0
 22201     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22202     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22203     MOVE X'3D20233030303230373431' TO DFHEIV0(25:11)
 22204     CALL 'kxdfhei1' USING DFHEIV0
 22205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22206
 22207
 22208 8690-READ-CERT-CONT.
 22209
 22210* EXEC CICS READ
 22211*        DATASET     (CERT-ID)
 22212*        INTO        (CERTIFICATE-MASTER)
 22213*        RIDFLD      (ELCERT-KEY)
 22214*        UPDATE
 22215*    END-EXEC.
 22216     MOVE LENGTH OF
 22217      CERTIFICATE-MASTER
 22218       TO DFHEIV11
 22219*    MOVE '&"IL       EU         (   #00020746' TO DFHEIV0
 22220     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22221     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22222     MOVE X'2020233030303230373436' TO DFHEIV0(25:11)
 22223     CALL 'kxdfhei1' USING DFHEIV0,
 22224           CERT-ID,
 22225           CERTIFICATE-MASTER,
 22226           DFHEIV11,
 22227           ELCERT-KEY,
 22228           DFHEIV99,
 22229           DFHEIV99,
 22230           DFHEIV99
 22231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22232
 22233
 22234     GO TO 8590-EXIT.
 22235
 22236 8700-READ-CERT-MASTER.
 22237     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 22238     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 22239
 22240* EXEC CICS HANDLE CONDITION
 22241*         DUPKEY    (8720-COMP-ACCOUNTS)
 22242*         ENDFILE   (8730-END-BROWSE)
 22243*         NOTFND    (8740-NOT-FOUND)
 22244*    END-EXEC.
 22245*    MOVE '"$$''I                 ! > #00020758' TO DFHEIV0
 22246     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 22247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22248     MOVE X'3E20233030303230373538' TO DFHEIV0(25:11)
 22249     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 411
* EL050.cbl
 22250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22251
 22252
 22253
 22254* EXEC CICS STARTBR
 22255*        DATASET     ('ELCERT5')
 22256*        RIDFLD      (ELCERT2-KEY)
 22257*        EQUAL
 22258*    END-EXEC.
 22259     MOVE 'ELCERT5' TO DFHEIV1
 22260     MOVE 0
 22261       TO DFHEIV11
 22262*    MOVE '&,         E          &   #00020764' TO DFHEIV0
 22263     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 22264     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22265     MOVE X'2020233030303230373634' TO DFHEIV0(25:11)
 22266     CALL 'kxdfhei1' USING DFHEIV0,
 22267           DFHEIV1,
 22268           ELCERT2-KEY,
 22269           DFHEIV99,
 22270           DFHEIV11,
 22271           DFHEIV99
 22272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22273
 22274
 22275 8710-READ-NEXT.
 22276
 22277* EXEC CICS READNEXT
 22278*        DATASET     ('ELCERT5')
 22279*        INTO        (CERTIFICATE-MASTER)
 22280*        RIDFLD      (ELCERT2-KEY)
 22281*    END-EXEC.
 22282     MOVE LENGTH OF
 22283      CERTIFICATE-MASTER
 22284       TO DFHEIV12
 22285     MOVE 'ELCERT5' TO DFHEIV1
 22286     MOVE 0
 22287       TO DFHEIV11
 22288*    MOVE '&.IL                  )   #00020771' TO DFHEIV0
 22289     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22290     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22291     MOVE X'2020233030303230373731' TO DFHEIV0(25:11)
 22292     CALL 'kxdfhei1' USING DFHEIV0,
 22293           DFHEIV1,
 22294           CERTIFICATE-MASTER,
 22295           DFHEIV12,
 22296           ELCERT2-KEY,
 22297           DFHEIV99,
 22298           DFHEIV11,
 22299           DFHEIV99,
 22300           DFHEIV99
 22301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22302
 22303
 22304 8720-COMP-ACCOUNTS.
 22305
 22306* EXEC CICS ENTER
 22307*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 412
* EL050.cbl
 22308*         FROM (PB-C-LAST-NAME)
 22309*    END-EXEC.
 22310     MOVE 001
 22311       TO DFHEIV11
 22312*    MOVE ':$F                   %   #00020778' TO DFHEIV0
 22313     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22314     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22315     MOVE X'2020233030303230373738' TO DFHEIV0(25:11)
 22316     CALL 'kxdfhei1' USING DFHEIV0,
 22317           DFHEIV11,
 22318           PB-C-LAST-NAME,
 22319           DFHEIV99,
 22320           DFHEIV99
 22321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22322
 22323
 22324
 22325* EXEC CICS ENTER
 22326*         TRACEID (002)
 22327*         FROM (CM-INSURED-LAST-NAME)
 22328*    END-EXEC.
 22329     MOVE 002
 22330       TO DFHEIV11
 22331*    MOVE ':$F                   %   #00020783' TO DFHEIV0
 22332     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 22333     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22334     MOVE X'2020233030303230373833' TO DFHEIV0(25:11)
 22335     CALL 'kxdfhei1' USING DFHEIV0,
 22336           DFHEIV11,
 22337           CM-INSURED-LAST-NAME,
 22338           DFHEIV99,
 22339           DFHEIV99
 22340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22341
 22342
 22343     IF PB-CERT-NO NOT = CM-CERT-NO
 22344         GO TO 8730-END-BROWSE.
 22345
 22346     IF PB-ACCOUNT = CM-ACCOUNT
 22347         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 22348             MOVE ER-2799        TO WS-ERROR
 22349             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22350             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 22351             GO TO 8730-END-BROWSE.
 22352
 22353     GO TO 8710-READ-NEXT.
 22354
 22355 8730-END-BROWSE.
 22356
 22357* EXEC CICS ENDBR
 22358*         DATASET    ('ELCERT5')
 22359*    END-EXEC.
 22360     MOVE 'ELCERT5' TO DFHEIV1
 22361     MOVE 0
 22362       TO DFHEIV11
 22363*    MOVE '&2                    $   #00020801' TO DFHEIV0
 22364     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22365     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 413
* EL050.cbl
 22366     MOVE X'2020233030303230383031' TO DFHEIV0(25:11)
 22367     CALL 'kxdfhei1' USING DFHEIV0,
 22368           DFHEIV1,
 22369           DFHEIV11,
 22370           DFHEIV99
 22371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22372
 22373
 22374 8740-NOT-FOUND.
 22375     GO TO 0299-CERT-NOT-FOUND.
 22376
 22377 8750-START-ELSTAT.
 22378
 22379* EXEC CICS STARTBR
 22380*       DATASET   (STAT-ID)
 22381*       RIDFLD    (ELSTAT-KEY)
 22382*       GTEQ
 22383*       RESP      (WS-RESPONSE)
 22384*    END-EXEC
 22385     MOVE 0
 22386       TO DFHEIV11
 22387*    MOVE '&,         G          &  N#00020809' TO DFHEIV0
 22388     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 22389     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 22390     MOVE X'204E233030303230383039' TO DFHEIV0(25:11)
 22391     CALL 'kxdfhei1' USING DFHEIV0,
 22392           STAT-ID,
 22393           ELSTAT-KEY,
 22394           DFHEIV99,
 22395           DFHEIV11,
 22396           DFHEIV99
 22397     MOVE EIBRESP  TO WS-RESPONSE
 22398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22399     IF WS-RESP-NORMAL
 22400        MOVE 'Y'                 TO STAT-MASTER-SW
 22401     ELSE
 22402        MOVE 'N'                 TO STAT-MASTER-SW
 22403     END-IF
 22404     .
 22405 8750-EXIT.
 22406     EXIT.
 22407 8752-READ-ELSTAT.
 22408
 22409* EXEC CICS READNEXT
 22410*       DATASET   (STAT-ID)
 22411*       RIDFLD    (ELSTAT-KEY)
 22412*       INTO      (STATE-FILE)
 22413*       RESP      (WS-RESPONSE)
 22414*    END-EXEC
 22415     MOVE LENGTH OF
 22416      STATE-FILE
 22417       TO DFHEIV12
 22418     MOVE 0
 22419       TO DFHEIV11
 22420*    MOVE '&.IL                  )  N#00020824' TO DFHEIV0
 22421     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 22422     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22423     MOVE X'204E233030303230383234' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 414
* EL050.cbl
 22424     CALL 'kxdfhei1' USING DFHEIV0,
 22425           STAT-ID,
 22426           STATE-FILE,
 22427           DFHEIV12,
 22428           ELSTAT-KEY,
 22429           DFHEIV99,
 22430           DFHEIV11,
 22431           DFHEIV99,
 22432           DFHEIV99
 22433     MOVE EIBRESP  TO WS-RESPONSE
 22434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22435     IF WS-RESP-NORMAL
 22436        MOVE 'Y'                 TO STAT-MASTER-SW
 22437     ELSE
 22438        MOVE 'N'                 TO STAT-MASTER-SW
 22439     END-IF
 22440     .
 22441 8752-EXIT.
 22442     EXIT.
 22443 8800-GET-COMP-RATE.
 22444     MOVE +1 TO IB.
 22445     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 22446         ADD +9 TO IB
 22447         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 22448             ADD +9 TO IB
 22449             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 22450                MOVE ZEROS       TO WS-WK-RATE
 22451                GO TO 8800-EXIT.
 22452
 22453     IF PB-I-AGE GREATER CT-AGE (1)
 22454         ADD +3 TO IB
 22455         IF PB-I-AGE GREATER CT-AGE (2)
 22456             ADD +3 TO IB
 22457             IF PB-I-AGE GREATER CT-AGE (3)
 22458                MOVE ZEROS       TO WS-WK-RATE
 22459                GO TO 8800-EXIT.
 22460
 22461     IF WS-WORK-TERM GREATER CT-TRM (1)
 22462         ADD +1 TO IB
 22463         IF WS-WORK-TERM GREATER CT-TRM (2)
 22464             ADD +1 TO IB
 22465             IF WS-WORK-TERM GREATER CT-TRM (3)
 22466                MOVE ZEROS       TO WS-WK-RATE
 22467                GO TO 8800-EXIT.
 22468
 22469     IF CT-RT (IB) NOT NUMERIC
 22470         MOVE CT-RT-R (IB) TO CTBL-TABLE
 22471         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 22472         GO TO 8800-GET-COMP-RATE.
 22473
 22474     MOVE CT-RT (IB) TO WS-WK-RATE.
 22475
 22476 8800-EXIT.
 22477     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 415
* EL050.cbl
 22479 8900-ADDRESS-FILE.
 22480     IF ERACCT-FILE-ADDRESSED
 22481         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 22482         GO TO 8900-ADDRESS-EXIT.
 22483
 22484     IF ELCNTL-FILE-ADDRESSED
 22485         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 22486         GO TO 8900-ADDRESS-EXIT.
 22487
 22488     IF ERPLAN-FILE-ADDRESSED
 22489         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 22490         GO TO 8900-ADDRESS-EXIT.
 22491
 22492     IF ERFORM-FILE-ADDRESSED
 22493         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 22494         GO TO 8900-ADDRESS-EXIT.
 22495
 22496 8900-ADDRESS-EXIT.
 22497     EXIT.
 22498
 22499 9000-READ-CONTROL.
 22500
 22501* EXEC CICS HANDLE CONDITION
 22502*        NOTFND    (9000-NOTFND)
 22503*    END-EXEC.
 22504*    MOVE '"$I                   ! ? #00020895' TO DFHEIV0
 22505     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22507     MOVE X'3F20233030303230383935' TO DFHEIV0(25:11)
 22508     CALL 'kxdfhei1' USING DFHEIV0
 22509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22510
 22511
 22512
 22513* EXEC CICS READ
 22514*        DATASET     (CNTL-ID)
 22515*        SET         (ADDRESS OF CONTROL-FILE)
 22516*        RIDFLD      (ELCNTL-KEY)
 22517*        GTEQ
 22518*    END-EXEC.
 22519*    MOVE '&"S        G          (   #00020899' TO DFHEIV0
 22520     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22522     MOVE X'2020233030303230383939' TO DFHEIV0(25:11)
 22523     CALL 'kxdfhei1' USING DFHEIV0,
 22524           CNTL-ID,
 22525           DFHEIV20,
 22526           DFHEIV99,
 22527           ELCNTL-KEY,
 22528           DFHEIV99,
 22529           DFHEIV99,
 22530           DFHEIV99
 22531     SET ADDRESS OF CONTROL-FILE TO
 22532         DFHEIV20
 22533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22534
 22535
 22536     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 416
* EL050.cbl
 22537
 22538 9000-NOTFND.
 22539     IF RC-SW-1 = '1'
 22540        MOVE ER-2616              TO WS-ERROR
 22541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22542        GO TO 9000-EXIT.
 22543
 22544     IF RC-SW-1 = '2'
 22545        MOVE ER-2602              TO WS-ERROR
 22546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22547
 22548 9000-EXIT.
 22549      EXIT.
 22550
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 417
* EL050.cbl
 22552 9100-READ-CONTROL.
 22553
 22554* EXEC CICS HANDLE CONDITION
 22555*        NOTFND  (9100-NOTFND)
 22556*        ENDFILE (9100-NOTFND)
 22557*    END-EXEC.
 22558*    MOVE '"$I''                  ! @ #00020923' TO DFHEIV0
 22559     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22561     MOVE X'4020233030303230393233' TO DFHEIV0(25:11)
 22562     CALL 'kxdfhei1' USING DFHEIV0
 22563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22564
 22565
 22566
 22567* EXEC CICS READ
 22568*        DATASET     (CNTL-ID)
 22569*        INTO        (CONTROL-FILE)
 22570*        RIDFLD      (ELCNTL-KEY)
 22571*        GTEQ
 22572*    END-EXEC.
 22573     MOVE LENGTH OF
 22574      CONTROL-FILE
 22575       TO DFHEIV11
 22576*    MOVE '&"IL       G          (   #00020928' TO DFHEIV0
 22577     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22579     MOVE X'2020233030303230393238' TO DFHEIV0(25:11)
 22580     CALL 'kxdfhei1' USING DFHEIV0,
 22581           CNTL-ID,
 22582           CONTROL-FILE,
 22583           DFHEIV11,
 22584           ELCNTL-KEY,
 22585           DFHEIV99,
 22586           DFHEIV99,
 22587           DFHEIV99
 22588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22589
 22590
 22591     GO TO 9100-EXIT.
 22592
 22593 9100-NOTFND.
 22594     IF RC-SW-2 = '0'
 22595        MOVE '1'                  TO STATE-RECORD-ERROR
 22596        GO TO 9100-EXIT
 22597     END-IF
 22598     IF RC-SW-2 = '1'
 22599        MOVE '1'                  TO LF-BENEFIT-ERROR
 22600        MOVE ER-2604              TO WS-ERROR
 22601        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22602        GO TO 9100-EXIT.
 22603
 22604     IF RC-SW-2 = '2'
 22605        MOVE '1'                  TO AH-BENEFIT-ERROR
 22606        MOVE ER-2605              TO WS-ERROR
 22607        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22608        GO TO 9100-EXIT.
 22609
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 418
* EL050.cbl
 22610     IF RC-SW-2 = '3'
 22611         MOVE ER-2603           TO WS-ERROR
 22612         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22613         GO TO 9100-EXIT.
 22614
 22615     IF RC-SW-2 = '4'
 22616         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 22617         GO TO 9100-EXIT.
 22618
 22619     IF RC-SW-2 = '5'
 22620         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 22621         IF WS-AH-INPUT-CD-1 = SPACE
 22622             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 22623         ELSE
 22624             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 22625
 22626 9100-EXIT.
 22627      EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 419
* EL050.cbl
 22629 9200-CONTROL-GETMAIN.
 22630
 22631* EXEC CICS GETMAIN
 22632*         LENGTH   (750)
 22633*         SET      (ADDRESS OF CONTROL-FILE)
 22634*    END-EXEC.
 22635     MOVE 750
 22636       TO DFHEIV11
 22637*    MOVE '," L                  $   #00020974' TO DFHEIV0
 22638     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 22639     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22640     MOVE X'2020233030303230393734' TO DFHEIV0(25:11)
 22641     CALL 'kxdfhei1' USING DFHEIV0,
 22642           DFHEIV20,
 22643           DFHEIV11,
 22644           DFHEIV99
 22645     SET ADDRESS OF CONTROL-FILE TO
 22646         DFHEIV20
 22647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22648
 22649
 22650     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 22651
 22652 9200-EXIT.
 22653     EXIT.
 22654
 22655 9250-UNLOCK-RETURN.
 22656
 22657* EXEC CICS UNLOCK
 22658*        DATASET   (CERT-ID)
 22659*    END-EXEC.
 22660*    MOVE '&*                    #   #00020985' TO DFHEIV0
 22661     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22662     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22663     MOVE X'2020233030303230393835' TO DFHEIV0(25:11)
 22664     CALL 'kxdfhei1' USING DFHEIV0,
 22665           CERT-ID,
 22666           DFHEIV99
 22667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22668
 22669
 22670 9300-ABEND.
 22671     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 22672
 22673
 22674* EXEC CICS LINK
 22675*        PROGRAM   ('EL004')
 22676*        COMMAREA  (WS-ERROR-LINE)
 22677*        LENGTH    (72)
 22678*    END-EXEC.
 22679     MOVE 'EL004' TO DFHEIV1
 22680     MOVE 72
 22681       TO DFHEIV11
 22682*    MOVE '."C                   (   #00020992' TO DFHEIV0
 22683     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 22684     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22685     MOVE X'2020233030303230393932' TO DFHEIV0(25:11)
 22686     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 420
* EL050.cbl
 22687           DFHEIV1,
 22688           WS-ERROR-LINE,
 22689           DFHEIV11,
 22690           DFHEIV99,
 22691           DFHEIV99,
 22692           DFHEIV99,
 22693           DFHEIV99
 22694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22695
 22696
 22697     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 22698
 22699
 22700* EXEC CICS ABEND
 22701*        ABCODE ('EL50')
 22702*    END-EXEC.
 22703     MOVE 'EL50' TO DFHEIV5
 22704*    MOVE '.,A                   "   #00021000' TO DFHEIV0
 22705     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 22706     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 22707     MOVE X'2020233030303231303030' TO DFHEIV0(25:11)
 22708     CALL 'kxdfhei1' USING DFHEIV0,
 22709           DFHEIV5
 22710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22711
 22712
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 421
* EL050.cbl
 22714
 22715******************************************************************
 22716*                                                                *
 22717*            E R R O R   F O R M A T   R O U T I N E             *
 22718*                                                                *
 22719******************************************************************
 22720
 22721 9900-ERROR-FORMAT.
 22722
 22723     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 22724                    PB-COMMON-ERROR (2) OR
 22725                    PB-COMMON-ERROR (3) OR
 22726                    PB-COMMON-ERROR (4) OR
 22727                    PB-COMMON-ERROR (5) OR
 22728                    PB-COMMON-ERROR (6) OR
 22729                    PB-COMMON-ERROR (7) OR
 22730                    PB-COMMON-ERROR (8) OR
 22731                    PB-COMMON-ERROR (9) OR
 22732                    PB-COMMON-ERROR (10)
 22733        GO TO 9900-EXIT.
 22734
 22735     IF PB-NO-OF-ERRORS = +10
 22736        GO TO 9900-EXIT.
 22737
 22738     ADD +1  TO PB-NO-OF-ERRORS.
 22739     MOVE WS-ERROR               TO PB-COMMON-ERROR
 22740                                       (PB-NO-OF-ERRORS).
 22741 9900-EXIT.
 22742     EXIT.
 22743
 22744 9990-RETURN.
 22745     IF BROWSE-STARTED
 22746
 22747* EXEC CICS ENDBR
 22748*            DATASET  (ACCT-ID)
 22749*       END-EXEC.
 22750     MOVE 0
 22751       TO DFHEIV11
 22752*    MOVE '&2                    $   #00021037' TO DFHEIV0
 22753     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22755     MOVE X'2020233030303231303337' TO DFHEIV0(25:11)
 22756     CALL 'kxdfhei1' USING DFHEIV0,
 22757           ACCT-ID,
 22758           DFHEIV11,
 22759           DFHEIV99
 22760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22761
 22762
 22763 9990-EXIT.
 22764     EXIT.
 22765
 22766
 22767****Check for CRTO record, add one if not found.
 22768 9991-CHECK-FOR-ELCRTO.
 22769
 22770* EXEC CICS HANDLE CONDITION
 22771*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 422
* EL050.cbl
 22772*         ENDFILE (9991-CRTO-NOT-FOUND)
 22773*     END-EXEC.
 22774*    MOVE '"$I''                  ! A #00021047' TO DFHEIV0
 22775     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22777     MOVE X'4120233030303231303437' TO DFHEIV0(25:11)
 22778     CALL 'kxdfhei1' USING DFHEIV0
 22779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22780
 22781     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 22782     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 22783     MOVE +0                     TO ELCRTO-SEQ-NO
 22784
 22785
 22786* EXEC CICS READ
 22787*       DATASET   ('ELCRTO')
 22788*       INTO      (ORIGINAL-CERTIFICATE)
 22789*       RIDFLD    (ELCRTO-KEY)
 22790*       GTEQ
 22791*       RESP      (WS-RESPONSE)
 22792*    END-EXEC
 22793     MOVE LENGTH OF
 22794      ORIGINAL-CERTIFICATE
 22795       TO DFHEIV11
 22796     MOVE 'ELCRTO' TO DFHEIV1
 22797*    MOVE '&"IL       G          (  N#00021055' TO DFHEIV0
 22798     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22800     MOVE X'204E233030303231303535' TO DFHEIV0(25:11)
 22801     CALL 'kxdfhei1' USING DFHEIV0,
 22802           DFHEIV1,
 22803           ORIGINAL-CERTIFICATE,
 22804           DFHEIV11,
 22805           ELCRTO-KEY,
 22806           DFHEIV99,
 22807           DFHEIV99,
 22808           DFHEIV99
 22809     MOVE EIBRESP  TO WS-RESPONSE
 22810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22811
 22812     IF WS-RESP-NORMAL
 22813        AND (OC-CONTROL-PRIMARY (1:33) =
 22814                 PB-CONTROL-BY-ACCOUNT (1:33))
 22815        AND (OC-RECORD-TYPE =  'I')
 22816           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 22817               GO TO 9991-CHECK-INDICATORS
 22818           ELSE
 22819               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 22820               GO TO 9991-CRTO-ADD-REC
 22821           END-IF
 22822     END-IF.
 22823
 22824 9991-CRTO-NOT-FOUND.
 22825
 22826     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 22827     MOVE 'OC'                TO OC-RECORD-ID
 22828     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 22829                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 423
* EL050.cbl
 22830     MOVE +4096               TO OC-KEY-SEQ-NO.
 22831
 22832 9991-CRTO-ADD-REC.
 22833
 22834     MOVE 'E050'              TO OC-LAST-MAINT-BY
 22835     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 22836     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 22837     MOVE 'I'                 TO OC-RECORD-TYPE
 22838     IF PB-ISSUE
 22839         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22840         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22841         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22842         MOVE PB-I-AGE               TO OC-INS-AGE
 22843         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22844         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22845         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22846         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22847         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22848         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22849         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22850         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22851         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22852         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22853         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22854         IF PB-I-JOINT-COMMISSION > +0
 22855             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22856         ELSE
 22857             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22858         END-IF
 22859         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 22860         MOVE +0                     TO OC-LF-CANCEL-AMT
 22861                                        OC-LF-ITD-CANCEL-AMT
 22862         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22863         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22864         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22865         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22866         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22867         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22868         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22869         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 22870         MOVE +0                     TO OC-AH-CANCEL-AMT
 22871                                        OC-AH-ITD-CANCEL-AMT
 22872         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22873         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22874         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 22875     ELSE
 22876         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 22877         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 22878         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 22879         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 22880         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 22881         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 22882         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 22883         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 22884         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22885          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22886             MOVE SPACES             TO OC-LF-BENCD
 22887             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 424
* EL050.cbl
 22888                                        OC-LF-BEN-AMT
 22889                                        OC-LF-PRM-AMT
 22890                                        OC-LF-ALT-BEN-AMT
 22891                                        OC-LF-ALT-PRM-AMT
 22892                                        OC-LF-COMM-PCT
 22893                                        OC-LF-CANCEL-AMT
 22894             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 22895             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 22896         ELSE
 22897             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 22898             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 22899             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 22900             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 22901             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22902             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22903             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 22904             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 22905             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22906             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22907         END-IF
 22908         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 22909         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 22910          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 22911             MOVE SPACES             TO OC-AH-BENCD
 22912             MOVE ZEROS              TO OC-AH-TERM
 22913                                        OC-AH-BEN-AMT
 22914                                        OC-AH-PRM-AMT
 22915                                        OC-AH-COMM-PCT
 22916                                        OC-AH-CANCEL-AMT
 22917                                        OC-AH-CP
 22918             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 22919             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 22920         ELSE
 22921             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 22922             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 22923             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 22924             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 22925             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 22926             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 22927             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 22928             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22929             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22930         END-IF
 22931         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 22932         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 22933         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 22934         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 22935     END-IF
 22936     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 22937
 22938     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22939
 22940
 22941* EXEC CICS READ
 22942*         DATASET   (FILE-ERMAIL)
 22943*         RIDFLD    (MA-CONTROL-PRIMARY)
 22944*         INTO      (MAILING-DATA)
 22945*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 425
* EL050.cbl
 22946*    END-EXEC
 22947     MOVE LENGTH OF
 22948      MAILING-DATA
 22949       TO DFHEIV11
 22950*    MOVE '&"IL       E          (  N#00021191' TO DFHEIV0
 22951     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22953     MOVE X'204E233030303231313931' TO DFHEIV0(25:11)
 22954     CALL 'kxdfhei1' USING DFHEIV0,
 22955           FILE-ERMAIL,
 22956           MAILING-DATA,
 22957           DFHEIV11,
 22958           MA-CONTROL-PRIMARY,
 22959           DFHEIV99,
 22960           DFHEIV99,
 22961           DFHEIV99
 22962     MOVE EIBRESP  TO WS-RESPONSE
 22963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22964
 22965     IF WS-RESP-NORMAL
 22966         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22967     END-IF.
 22968
 22969     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22970     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22971
 22972
 22973* EXEC CICS READ
 22974*         DATASET  (CRTT-ID)
 22975*         RIDFLD   (WS-ELCRTT-KEY)
 22976*         INTO     (CERTIFICATE-TRAILERS)
 22977*         RESP     (WS-RESPONSE)
 22978*    END-EXEC
 22979     MOVE LENGTH OF
 22980      CERTIFICATE-TRAILERS
 22981       TO DFHEIV11
 22982*    MOVE '&"IL       E          (  N#00021205' TO DFHEIV0
 22983     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22984     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22985     MOVE X'204E233030303231323035' TO DFHEIV0(25:11)
 22986     CALL 'kxdfhei1' USING DFHEIV0,
 22987           CRTT-ID,
 22988           CERTIFICATE-TRAILERS,
 22989           DFHEIV11,
 22990           WS-ELCRTT-KEY,
 22991           DFHEIV99,
 22992           DFHEIV99,
 22993           DFHEIV99
 22994     MOVE EIBRESP  TO WS-RESPONSE
 22995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22996
 22997     IF WS-RESP-NORMAL
 22998         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22999         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 23000     END-IF.
 23001
 23002
 23003* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 426
* EL050.cbl
 23004*       DATASET   ('ELCRTO')
 23005*       FROM      (ORIGINAL-CERTIFICATE)
 23006*       RIDFLD    (OC-CONTROL-PRIMARY)
 23007*       RESP      (WS-RESPONSE)
 23008*    END-EXEC.
 23009     MOVE LENGTH OF
 23010      ORIGINAL-CERTIFICATE
 23011       TO DFHEIV11
 23012     MOVE 'ELCRTO' TO DFHEIV1
 23013*    MOVE '&$ L                  ''  N#00021217' TO DFHEIV0
 23014     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 23015     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23016     MOVE X'204E233030303231323137' TO DFHEIV0(25:11)
 23017     CALL 'kxdfhei1' USING DFHEIV0,
 23018           DFHEIV1,
 23019           ORIGINAL-CERTIFICATE,
 23020           DFHEIV11,
 23021           OC-CONTROL-PRIMARY,
 23022           DFHEIV99,
 23023           DFHEIV99
 23024     MOVE EIBRESP  TO WS-RESPONSE
 23025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23026
 23027
 23028     GO TO 9991-EXIT.
 23029
 23030 9991-CHECK-INDICATORS.
 23031
 23032     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 23033         GO TO 9991-EXIT
 23034     END-IF.
 23035
 23036     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 23037         GO TO 9991-EXIT
 23038     END-IF.
 23039
 23040
 23041* EXEC CICS READ
 23042*       DATASET   ('ELCRTO')
 23043*       INTO      (ORIGINAL-CERTIFICATE)
 23044*       RIDFLD    (OC-CONTROL-PRIMARY)
 23045*       UPDATE
 23046*       RESP      (WS-RESPONSE)
 23047*    END-EXEC
 23048     MOVE LENGTH OF
 23049      ORIGINAL-CERTIFICATE
 23050       TO DFHEIV11
 23051     MOVE 'ELCRTO' TO DFHEIV1
 23052*    MOVE '&"IL       EU         (  N#00021236' TO DFHEIV0
 23053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23054     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23055     MOVE X'204E233030303231323336' TO DFHEIV0(25:11)
 23056     CALL 'kxdfhei1' USING DFHEIV0,
 23057           DFHEIV1,
 23058           ORIGINAL-CERTIFICATE,
 23059           DFHEIV11,
 23060           OC-CONTROL-PRIMARY,
 23061           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 427
* EL050.cbl
 23062           DFHEIV99,
 23063           DFHEIV99
 23064     MOVE EIBRESP  TO WS-RESPONSE
 23065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23066     IF WS-RESP-NORMAL
 23067        IF PB-ISSUE
 23068          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 23069          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 23070          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 23071          MOVE PB-I-AGE               TO OC-INS-AGE
 23072          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 23073          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 23074          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 23075          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 23076          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 23077          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 23078          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 23079          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 23080          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 23081          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 23082          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 23083          IF PB-I-JOINT-COMMISSION > +0
 23084              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 23085          ELSE
 23086              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 23087          END-IF
 23088          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 23089          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 23090          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 23091          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 23092          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 23093          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 23094          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 23095          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 23096          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 23097
 23098          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 23099
 23100* EXEC CICS READ
 23101*             DATASET   (FILE-ERMAIL)
 23102*             RIDFLD    (MA-CONTROL-PRIMARY)
 23103*             INTO      (MAILING-DATA)
 23104*             RESP      (WS-RESPONSE)
 23105*         END-EXEC
 23106     MOVE LENGTH OF
 23107      MAILING-DATA
 23108       TO DFHEIV11
 23109*    MOVE '&"IL       E          (  N#00021276' TO DFHEIV0
 23110     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23112     MOVE X'204E233030303231323736' TO DFHEIV0(25:11)
 23113     CALL 'kxdfhei1' USING DFHEIV0,
 23114           FILE-ERMAIL,
 23115           MAILING-DATA,
 23116           DFHEIV11,
 23117           MA-CONTROL-PRIMARY,
 23118           DFHEIV99,
 23119           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 428
* EL050.cbl
 23120           DFHEIV99
 23121     MOVE EIBRESP  TO WS-RESPONSE
 23122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23123          IF WS-RESP-NORMAL
 23124             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 23125          END-IF
 23126
 23127          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 23128          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 23129
 23130* EXEC CICS READ
 23131*             DATASET  (CRTT-ID)
 23132*             RIDFLD   (WS-ELCRTT-KEY)
 23133*             INTO     (CERTIFICATE-TRAILERS)
 23134*             RESP     (WS-RESPONSE)
 23135*         END-EXEC
 23136     MOVE LENGTH OF
 23137      CERTIFICATE-TRAILERS
 23138       TO DFHEIV11
 23139*    MOVE '&"IL       E          (  N#00021288' TO DFHEIV0
 23140     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 23141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23142     MOVE X'204E233030303231323838' TO DFHEIV0(25:11)
 23143     CALL 'kxdfhei1' USING DFHEIV0,
 23144           CRTT-ID,
 23145           CERTIFICATE-TRAILERS,
 23146           DFHEIV11,
 23147           WS-ELCRTT-KEY,
 23148           DFHEIV99,
 23149           DFHEIV99,
 23150           DFHEIV99
 23151     MOVE EIBRESP  TO WS-RESPONSE
 23152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23153          IF WS-RESP-NORMAL
 23154             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 23155                               OC-INS-AGE-DEFAULT-FLAG
 23156             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 23157                               OC-JNT-AGE-DEFAULT-FLAG
 23158          END-IF
 23159
 23160        ELSE
 23161          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23162             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 23163             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 23164             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 23165          END-IF
 23166          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 23167             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 23168             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 23169             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 23170          END-IF
 23171          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 23172        END-IF
 23173
 23174* EXEC CICS REWRITE
 23175*          DATASET   ('ELCRTO')
 23176*          FROM      (ORIGINAL-CERTIFICATE)
 23177*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 429
* EL050.cbl
 23178*       END-EXEC
 23179     MOVE LENGTH OF
 23180      ORIGINAL-CERTIFICATE
 23181       TO DFHEIV11
 23182     MOVE 'ELCRTO' TO DFHEIV1
 23183*    MOVE '&& L                  %  N#00021314' TO DFHEIV0
 23184     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23185     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23186     MOVE X'204E233030303231333134' TO DFHEIV0(25:11)
 23187     CALL 'kxdfhei1' USING DFHEIV0,
 23188           DFHEIV1,
 23189           ORIGINAL-CERTIFICATE,
 23190           DFHEIV11,
 23191           DFHEIV99
 23192     MOVE EIBRESP  TO WS-RESPONSE
 23193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23194     END-IF.
 23195
 23196 9991-EXIT.
 23197     EXIT.
 23198
 23199
 23200 9999-RETURN.
 23201     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 23202
 23203
 23204* EXEC CICS RETURN
 23205*    END-EXEC.
 23206*    MOVE '.(                    ''   #00021328' TO DFHEIV0
 23207     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23208     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23209     MOVE X'2020233030303231333238' TO DFHEIV0(25:11)
 23210     CALL 'kxdfhei1' USING DFHEIV0,
 23211           DFHEIV99,
 23212           DFHEIV99,
 23213           DFHEIV99,
 23214           DFHEIV99,
 23215           DFHEIV99,
 23216           DFHEIV99
 23217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23218
 23219
 23220
 23221* GOBACK.
 23222     MOVE '9%                    "   ' TO DFHEIV0
 23223     MOVE 'EL050' TO DFHEIV1
 23224     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23225     GOBACK.
 23226
 23227 9999-DFHBACK SECTION.
 23228     MOVE '9%                    "   ' TO DFHEIV0
 23229     MOVE 'EL050' TO DFHEIV1
 23230     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23231     GOBACK.
 23232 9999-DFHEXIT.
 23233     IF DFHEIGDJ EQUAL 0001
 23234         NEXT SENTENCE
 23235     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 430
* EL050.cbl
 23236         GO TO 9300-ABEND,
 23237               3990-FILES-NOT-OPEN
 23238         DEPENDING ON DFHEIGDI
 23239     ELSE IF DFHEIGDJ EQUAL 3
 23240         GO TO 6610-START-BROWSE,
 23241               6630-ERRESS-PROBLEM,
 23242               6630-END-OF-FILE
 23243         DEPENDING ON DFHEIGDI
 23244     ELSE IF DFHEIGDJ EQUAL 4
 23245         GO TO 6630-END-OF-FILE,
 23246               6630-ERRESS-PROBLEM,
 23247               6630-ERRESS-PROBLEM,
 23248               6630-END-OF-FILE
 23249         DEPENDING ON DFHEIGDI
 23250     ELSE IF DFHEIGDJ EQUAL 5
 23251         GO TO 6630-END-OF-FILE,
 23252               6630-END-OF-FILE,
 23253               6630-ERRESS-PROBLEM,
 23254               6630-ERRESS-PROBLEM
 23255         DEPENDING ON DFHEIGDI
 23256     ELSE IF DFHEIGDJ EQUAL 6
 23257         GO TO 6660-START-BROWSE,
 23258               6690-ERRESC-PROBLEM,
 23259               6690-ERRESC-PROBLEM,
 23260               6690-END-OF-FILE
 23261         DEPENDING ON DFHEIGDI
 23262     ELSE IF DFHEIGDJ EQUAL 7
 23263         GO TO 6690-END-OF-FILE,
 23264               6690-ERRESC-PROBLEM,
 23265               6690-ERRESC-PROBLEM,
 23266               6690-END-OF-FILE
 23267         DEPENDING ON DFHEIGDI
 23268     ELSE IF DFHEIGDJ EQUAL 8
 23269         GO TO 6690-END-OF-FILE,
 23270               6690-ERRESC-PROBLEM,
 23271               6690-ERRESC-PROBLEM,
 23272               6690-END-OF-FILE
 23273         DEPENDING ON DFHEIGDI
 23274     ELSE IF DFHEIGDJ EQUAL 9
 23275         GO TO 7250-CONTINUE,
 23276               7250-CONTINUE
 23277         DEPENDING ON DFHEIGDI
 23278     ELSE IF DFHEIGDJ EQUAL 10
 23279         GO TO 7300-CONTINUE,
 23280               7300-CONTINUE
 23281         DEPENDING ON DFHEIGDI
 23282     ELSE IF DFHEIGDJ EQUAL 11
 23283         GO TO 7320-CONTINUE,
 23284               7320-CONTINUE
 23285         DEPENDING ON DFHEIGDI
 23286     ELSE IF DFHEIGDJ EQUAL 12
 23287         GO TO 8000-FREE-MAIN
 23288         DEPENDING ON DFHEIGDI
 23289     ELSE IF DFHEIGDJ EQUAL 13
 23290         GO TO 8100-NOTFND,
 23291               8100-NOTFND
 23292         DEPENDING ON DFHEIGDI
 23293     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 431
* EL050.cbl
 23294         GO TO 8110-NOTFND,
 23295               8110-NOTFND
 23296         DEPENDING ON DFHEIGDI
 23297     ELSE IF DFHEIGDJ EQUAL 15
 23298         GO TO 8130-EXIT
 23299         DEPENDING ON DFHEIGDI
 23300     ELSE IF DFHEIGDJ EQUAL 16
 23301         GO TO 8145-exit
 23302         DEPENDING ON DFHEIGDI
 23303     ELSE IF DFHEIGDJ EQUAL 17
 23304         GO TO 8190-NOTFND
 23305         DEPENDING ON DFHEIGDI
 23306     ELSE IF DFHEIGDJ EQUAL 18
 23307         GO TO 8195-NOTFND
 23308         DEPENDING ON DFHEIGDI
 23309     ELSE IF DFHEIGDJ EQUAL 19
 23310         GO TO 8200-NOTFND
 23311         DEPENDING ON DFHEIGDI
 23312     ELSE IF DFHEIGDJ EQUAL 20
 23313         GO TO 8300-NOTFND,
 23314               8300-ERRESS-PROBLEM,
 23315               8300-ERRESS-PROBLEM,
 23316               8300-NOTFND
 23317         DEPENDING ON DFHEIGDI
 23318     ELSE IF DFHEIGDJ EQUAL 21
 23319         GO TO 8450-FORM-NOT-FOUND,
 23320               8450-FORM-NOT-FOUND
 23321         DEPENDING ON DFHEIGDI
 23322     ELSE IF DFHEIGDJ EQUAL 22
 23323         GO TO 0199-ACCT-NOT-FOUND,
 23324               0199-ACCT-NOT-FOUND
 23325         DEPENDING ON DFHEIGDI
 23326     ELSE IF DFHEIGDJ EQUAL 23
 23327         GO TO 0199-ACCT-NOT-FOUND,
 23328               0199-ACCT-NOT-FOUND
 23329         DEPENDING ON DFHEIGDI
 23330     ELSE IF DFHEIGDJ EQUAL 24
 23331         GO TO 8582-COMP-NOT-FOUND,
 23332               8582-COMP-NOT-FOUND
 23333         DEPENDING ON DFHEIGDI
 23334     ELSE IF DFHEIGDJ EQUAL 25
 23335         GO TO 8583-AGTC-NOT-FOUND,
 23336               8583-AGTC-NOT-FOUND
 23337         DEPENDING ON DFHEIGDI
 23338     ELSE IF DFHEIGDJ EQUAL 26
 23339         GO TO 8584-BXRF-NOT-FOUND,
 23340               8584-BXRF-NOT-FOUND
 23341         DEPENDING ON DFHEIGDI
 23342     ELSE IF DFHEIGDJ EQUAL 27
 23343         GO TO 8585-PLAN-NOT-FOUND,
 23344               8585-PLAN-NOT-FOUND
 23345         DEPENDING ON DFHEIGDI
 23346     ELSE IF DFHEIGDJ EQUAL 28
 23347         GO TO 0299-CERT-NOT-FOUND
 23348         DEPENDING ON DFHEIGDI
 23349     ELSE IF DFHEIGDJ EQUAL 29
 23350         GO TO 8700-READ-CERT-MASTER
 23351         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 16-Oct-19 09:06 Page 432
* EL050.cbl
 23352     ELSE IF DFHEIGDJ EQUAL 30
 23353         GO TO 8720-COMP-ACCOUNTS,
 23354               8730-END-BROWSE,
 23355               8740-NOT-FOUND
 23356         DEPENDING ON DFHEIGDI
 23357     ELSE IF DFHEIGDJ EQUAL 31
 23358         GO TO 9000-NOTFND
 23359         DEPENDING ON DFHEIGDI
 23360     ELSE IF DFHEIGDJ EQUAL 32
 23361         GO TO 9100-NOTFND,
 23362               9100-NOTFND
 23363         DEPENDING ON DFHEIGDI
 23364     ELSE IF DFHEIGDJ EQUAL 33
 23365         GO TO 9991-CRTO-NOT-FOUND,
 23366               9991-CRTO-NOT-FOUND
 23367         DEPENDING ON DFHEIGDI.
 23368     MOVE '9%                    "   ' TO DFHEIV0
 23369     MOVE 'EL050' TO DFHEIV1
 23370     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23371     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       41832     Code:       95885
