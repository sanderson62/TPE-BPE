* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   1
* EL1044.cbl
* Options: int("EL1044.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1044.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1044.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1044.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1044.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   2
* EL1044.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS FOR ACCOUNT SERVICES
    19*    SCREENS     - EL1044Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122011    2011022800001  AJRA  ADD ELCZREC COPYBOOK
    40* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    41* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    42* 080113    2013062000003  AJRA  ADD BARCODE,RETURN ENV FLAG
    43* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    44* 010914    2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    45******************************************************************
    46 ENVIRONMENT DIVISION.
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*   EL1044 WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    53 77  M1                          PIC S999 COMP-3 VALUE +0.
    54 77  M2                          PIC S999 COMP-3 VALUE +0.
    55 77  WS-STOP-SW                  PIC X  VALUE ' '.
    56     88  I-SAY-TO-STOP              VALUE 'Y'.
    57 77  WS-FIND-SW                  PIC X  VALUE ' '.
    58     88  WE-FOUND-IT                VALUE 'Y'.
    59 77  WS-DONE-WITH-ENCC           PIC X  VALUE ' '.
    60     88  DONE-WITH-ENCC             VALUE 'Y'.
    61 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    62 01  ACCESS-KEYS.
    63     12  ELLETR-KEY.
    64         16  ELLETR-COMPANY-CD   PIC X.
    65         16  ELLETR-ACCESS-CD    PIC X(12).
    66         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    67
    68     12  ELENCC-KEY.
    69         16  ELENCC-COMPANY-CD    PIC X.
    70         16  ELENCC-REC-TYPE      PIC X.
    71         16  ELENCC-ENC-CODE      PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   3
* EL1044.cbl
    72         16  F                    PIC X(09).
    73 01  WS-DATE-AREA.
    74     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    75     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    76 01  MISC-WORK-AREAS.
    77     12  WS-RESPONSE             PIC S9(8)   COMP.
    78         88  RESP-NORMAL              VALUE +00.
    79         88  RESP-ERROR               VALUE +01.
    80         88  RESP-NOTFND              VALUE +13.
    81         88  RESP-NOTOPEN             VALUE +19.
    82         88  RESP-ENDFILE             VALUE +20.
    83     12  WS-NUMVAL.
    84         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    85         16  WS-9V999-OF-DEEDIT REDEFINES
    86             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    87     12  DEEDIT-FIELD                PIC X(11).
    88     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    89                                     PIC S9(11).
    90     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    91                                     PIC S9(09)V99.
    92
    93     12  WS-TEST-STATE               PIC X(2) VALUE SPACES.
    94         88 STATE-SPECIFIC    VALUES 'AK','AL','AR','AS','AZ',
    95            'CA','CO','CT','DC','DE','FL','GA','GU','HI','IA',
    96            'ID','IL','IN','KS','KY','LA','MA','MD','ME','MI',
    97            'MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM',
    98            'NV','NY','OH','OK','OR','PA','PR','RI','SC','SD',
    99            'TN','TX','UT','VA','VI','VT','WA','WI','WV','WY'.
   100 01  STANDARD-AREAS.
   101     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
   102     12  TRANS-ID                    PIC X(04)   VALUE 'EX1F'.
   103     12  PGM-NAME                    PIC X(08).
   104     12  TIME-IN                     PIC S9(07).
   105     12  TIME-OUT-R  REDEFINES TIME-IN.
   106         16  FILLER                  PIC X(01).
   107         16  TIME-OUT                PIC 99V99.
   108         16  FILLER                  PIC X(02).
   109     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   110     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   111     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   112     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   113     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   114     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   115     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   116     12  THIS-PGM                    PIC X(08)   VALUE 'EL1044'.
   117     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   118     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   119     12  ELENCC-FILE-ID              PIC X(08)   VALUE 'ELENCC'.
   120     12  ELENCC-LENGTH               PIC S9(04)  VALUE +400  COMP.
   121     12  SUB                         PIC 9(02).
   122     12  SUB-1                       PIC 9(02).
   123     12  SUB2                        PIC 9(02).
   124     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   125     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1044S'.
   126     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL1044Z'.
   127     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   128     12  HOLD-ENC-CODES              PIC X(120)  VALUE SPACES.
   129     12  WS-SUB1                     PIC S9(03).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   4
* EL1044.cbl
   130     12  WS-SUB2                     PIC S9(03).
   131     12  WS-SUB3                     PIC S9(03).
   132****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   133*                                    COPY ELCZREC.
   134******************************************************************
   135*                                                                *
   136*                                                                *
   137*                            ELCZREC.                            *
   138*                                                                *
   139*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   140*                                                                *
   141******************************************************************
   142*-----------------------------------------------------------------
   143*                   C H A N G E   L O G
   144*
   145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   146*-----------------------------------------------------------------
   147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   148* EFFECTIVE    NUMBER
   149*-----------------------------------------------------------------
   150* 122011    2011022800001  AJRA  NEW FILE
   151* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   152* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   153* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   154* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   155*-----------------------------------------------------------------
   156 01  W-Z-CONTROL-DATA.
   157     05  W-NUMBER-OF-COPIES      PIC  9.
   158     05  FILLER                  PIC  X.
   159     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   160     05  FILLER                  PIC  X.
   161     05  W-DAYS-TO-RESEND        PIC  999.
   162     05  FILLER                  PIC  X.
   163     05  W-FORM-TO-RESEND        PIC  X(4).
   164     05  W-ADD-BAR-CODE          PIC  X.
   165     05  W-PROMPT-LETTER         PIC  X.
   166     05  W-HAS-RETURN-ENV        PIC  X.
   167     05  W-ENCLOSURE-CD          PIC  XXX.
   168     05  W-SIG-FLAG-DEFAULT      PIC  X.
   169     05  W-AUTO-CLOSE-IND        PIC  X.
   170     05  FILLER                  PIC  X.
   171     05  W-LETTER-TO-BENE        PIC  X.
   172     05  FILLER                  PIC  X.
   173     05  W-LETTER-TO-ACCT        PIC  X.
   174     05  FILLER                  PIC  X.
   175     05  W-LETTER-TYPE           PIC  X.
   176     05  FILLER                  PIC  X.
   177     05  W-PRINT-CERTIFICATE     PIC  X.
   178     05  FILLER                  PIC  X.
   179     05  W-REFUND-REQUIRED       PIC  X.
   180     05  FILLER                  PIC  X.
   181     05  W-ONBASE-CODE           PIC  XX.
   182     05  FILLER                  PIC  X.
   183     05  W-ACCT-SUMM             PIC  X.
   184     05  FILLER                  PIC  X.
   185     05  W-CSO-SUMM              PIC  X.
   186     05  FILLER                  PIC  X.
   187     05  W-REASONS-REQUIRED      PIC  X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   5
* EL1044.cbl
   188     05  FILLER                  PIC  X(29).
   189*                                    COPY ELCSCTM.
   190******************************************************************
   191*                                                                *
   192*                                                                *
   193*                            ELCSCTM                             *
   194*                            VMOD=2.001                          *
   195*                                                                *
   196*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   197*                                                                *
   198******************************************************************
   199 01  SECURITY-MESSAGE.
   200     12  FILLER                          PIC X(30)
   201            VALUE '** LOGIC SECURITY VIOLATION -'.
   202     12  SM-READ                         PIC X(6).
   203     12  FILLER                          PIC X(5)
   204            VALUE ' PGM='.
   205     12  SM-PGM                          PIC X(6).
   206     12  FILLER                          PIC X(5)
   207            VALUE ' OPR='.
   208     12  SM-PROCESSOR-ID                 PIC X(4).
   209     12  FILLER                          PIC X(6)
   210            VALUE ' TERM='.
   211     12  SM-TERMID                       PIC X(4).
   212     12  FILLER                          PIC XX   VALUE SPACE.
   213     12  SM-JUL-DATE                     PIC 9(5).
   214     12  FILLER                          PIC X    VALUE SPACE.
   215     12  SM-TIME                         PIC 99.99.
   216
   217*                                    COPY ELCSCRTY.
   218******************************************************************
   219*                                                                *
   220*                                                                *
   221*                            ELCSCRTY                            *
   222*                            VMOD=2.001                          *
   223*                                                                *
   224*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   225*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   226*        SAVED IN PI-SECURITY-ADDRESS.                           *
   227*                                                                *
   228******************************************************************
   229 01  SECURITY-CONTROL.
   230     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   231     12  FILLER                       PIC XX    VALUE 'SC'.
   232     12  SC-CREDIT-CODES.
   233         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   234             20  SC-CREDIT-DISPLAY    PIC X.
   235             20  SC-CREDIT-UPDATE     PIC X.
   236     12  SC-CLAIMS-CODES.
   237         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   238             20  SC-CLAIMS-DISPLAY    PIC X.
   239             20  SC-CLAIMS-UPDATE     PIC X.
   240 01  ERROR-MESSAGES.
   241     12  ER-0000                     PIC X(04)   VALUE '0000'.
   242     12  ER-0005                     PIC X(04)   VALUE '0005'.
   243     12  ER-0023                     PIC X(04)   VALUE '0023'.
   244     12  ER-0029                     PIC X(04)   VALUE '0029'.
   245     12  ER-0050                     PIC X(04)   VALUE '0050'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   6
* EL1044.cbl
   246     12  ER-0068                     PIC X(04)   VALUE '0068'.
   247     12  ER-0070                     PIC X(04)   VALUE '0070'.
   248     12  ER-0130                     PIC X(04)   VALUE '0130'.
   249     12  ER-0131                     PIC X(04)   VALUE '0131'.
   250     12  ER-0132                     PIC X(04)   VALUE '0132'.
   251     12  ER-0138                     PIC X(04)   VALUE '0138'.
   252     12  ER-0144                     PIC X(04)   VALUE '0144'.
   253     12  ER-0145                     PIC X(04)   VALUE '0145'.
   254     12  ER-0184                     PIC X(04)   VALUE '0184'.
   255     12  ER-0418                     PIC X(04)   VALUE '0418'.
   256     12  ER-0491                     PIC X(04)   VALUE '0491'.
   257     12  ER-0582                     PIC X(04)   VALUE '0582'.
   258     12  ER-0627                     PIC X(04)   VALUE '0627'.
   259     12  ER-0701                     PIC X(04)   VALUE '0701'.
   260     12  ER-0702                     PIC X(04)   VALUE '0702'.
   261     12  ER-0703                     PIC X(04)   VALUE '0703'.
   262     12  ER-0704                     PIC X(04)   VALUE '0704'.
   263     12  ER-0705                     PIC X(04)   VALUE '0705'.
   264     12  ER-0706                     PIC X(04)   VALUE '0706'.
   265     12  ER-0707                     PIC X(04)   VALUE '0707'.
   266     12  ER-0708                     PIC X(04)   VALUE '0708'.
   267     12  ER-0709                     PIC X(04)   VALUE '0709'.
   268     12  ER-0710                     PIC X(04)   VALUE '0710'.
   269     12  ER-0711                     PIC X(04)   VALUE '0711'.
   270     12  ER-0712                     PIC X(04)   VALUE '0712'.
   271     12  ER-0713                     PIC X(04)   VALUE '0713'.
   272     12  ER-0717                     PIC X(04)   VALUE '0717'.
   273     12  ER-0718                     PIC X(04)   VALUE '0718'.
   274     12  ER-0719                     PIC X(04)   VALUE '0719'.
   275     12  ER-0720                     PIC X(04)   VALUE '0720'.
   276     12  ER-0721                     PIC X(04)   VALUE '0721'.
   277     12  ER-0722                     PIC X(04)   VALUE '0722'.
   278     12  ER-0723                     PIC X(04)   VALUE '0723'.
   279     12  ER-0724                     PIC X(04)   VALUE '0724'.
   280     12  ER-0725                     PIC X(04)   VALUE '0725'.
   281     12  ER-0726                     PIC X(04)   VALUE '0726'.
   282     12  ER-0727                     PIC X(04)   VALUE '0727'.
   283     12  ER-0729                     PIC X(04)   VALUE '0729'.
   284     12  ER-0754                     PIC X(04)   VALUE '0754'.
   285     12  ER-1560                     PIC X(04)   VALUE '1560'.
   286     12  ER-1562                     PIC X(04)   VALUE '1562'.
   287     12  ER-1564                     PIC X(04)   VALUE '1564'.
   288     12  ER-2241                     PIC X(04)   VALUE '2241'.
   289     12  ER-2276                     PIC X(04)   VALUE '2276'.
   290     12  ER-3804                     PIC X(04)   VALUE '3804'.
   291     12  ER-3820                     PIC X(04)   VALUE '3820'.
   292     12  ER-3821                     PIC X(04)   VALUE '3821'.
   293     12  ER-7008                     PIC X(04)   VALUE '7008'.
   294     12  ER-7031                     PIC X(04)   VALUE '7031'.
   295     12  ER-7123                     PIC X(04)   VALUE '7123'.
   296     12  ER-8150                     PIC X(04)   VALUE '8150'.
   297     12  ER-9999                     PIC XXXX    VALUE '9999'.
   298*                                    COPY ELCDATE.
   299******************************************************************
   300*                                                                *
   301*                                                                *
   302*                            ELCDATE.                            *
   303*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   7
* EL1044.cbl
   304*                            VMOD=2.003
   305*                                                                *
   306*                                                                *
   307*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   308*                 LENGTH = 200                                   *
   309******************************************************************
   310
   311 01  DATE-CONVERSION-DATA.
   312     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   313     12  DC-OPTION-CODE                PIC X.
   314         88  BIN-TO-GREG                VALUE ' '.
   315         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   316         88  EDIT-GREG-TO-BIN           VALUE '2'.
   317         88  YMD-GREG-TO-BIN            VALUE '3'.
   318         88  MDY-GREG-TO-BIN            VALUE '4'.
   319         88  JULIAN-TO-BIN              VALUE '5'.
   320         88  BIN-PLUS-ELAPSED           VALUE '6'.
   321         88  FIND-CENTURY               VALUE '7'.
   322         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   323         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   324         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   325         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   326         88  JULIAN-TO-BIN-3            VALUE 'C'.
   327         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   328         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   329         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   330         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   331         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   332         88  CHECK-LEAP-YEAR            VALUE 'H'.
   333         88  BIN-3-TO-GREG              VALUE 'I'.
   334         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   335         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   336         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   337         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   338         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   339         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   340         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   341         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   342         88  THREE-CHARACTER-BIN
   343                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   344         88  GREGORIAN-TO-BIN
   345                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   346         88  BIN-TO-GREGORIAN
   347                  VALUES ' ' '1' 'I' '8' 'G'.
   348         88  JULIAN-TO-BINARY
   349                  VALUES '5' 'C' 'E' 'F'.
   350     12  DC-ERROR-CODE                 PIC X.
   351         88  NO-CONVERSION-ERROR        VALUE ' '.
   352         88  DATE-CONVERSION-ERROR
   353                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   354         88  DATE-IS-ZERO               VALUE '1'.
   355         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   356         88  DATE-IS-INVALID            VALUE '3'.
   357         88  DATE1-GREATER-DATE2        VALUE '4'.
   358         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   359         88  DATE-INVALID-OPTION        VALUE '9'.
   360         88  INVALID-CENTURY            VALUE 'A'.
   361         88  ONLY-CENTURY               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   8
* EL1044.cbl
   362         88  ONLY-LEAP-YEAR             VALUE 'C'.
   363         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   364     12  DC-END-OF-MONTH               PIC X.
   365         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   366     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   367         88  USE-NORMAL-PROCESS         VALUE ' '.
   368         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   369         88  ADJUST-UP-100-YRS          VALUE '2'.
   370     12  FILLER                        PIC X.
   371     12  DC-CONVERSION-DATES.
   372         16  DC-BIN-DATE-1             PIC XX.
   373         16  DC-BIN-DATE-2             PIC XX.
   374         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   375         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   376                       DC-GREG-DATE-1-EDIT.
   377             20  DC-EDIT1-MONTH        PIC 99.
   378             20  SLASH1-1              PIC X.
   379             20  DC-EDIT1-DAY          PIC 99.
   380             20  SLASH1-2              PIC X.
   381             20  DC-EDIT1-YEAR         PIC 99.
   382         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   383         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   384                     DC-GREG-DATE-2-EDIT.
   385             20  DC-EDIT2-MONTH        PIC 99.
   386             20  SLASH2-1              PIC X.
   387             20  DC-EDIT2-DAY          PIC 99.
   388             20  SLASH2-2              PIC X.
   389             20  DC-EDIT2-YEAR         PIC 99.
   390         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   391         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   392                     DC-GREG-DATE-1-YMD.
   393             20  DC-YMD-YEAR           PIC 99.
   394             20  DC-YMD-MONTH          PIC 99.
   395             20  DC-YMD-DAY            PIC 99.
   396         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   397         16  DC-GREG-DATE-1-MDY-R REDEFINES
   398                      DC-GREG-DATE-1-MDY.
   399             20  DC-MDY-MONTH          PIC 99.
   400             20  DC-MDY-DAY            PIC 99.
   401             20  DC-MDY-YEAR           PIC 99.
   402         16  DC-GREG-DATE-1-ALPHA.
   403             20  DC-ALPHA-MONTH        PIC X(10).
   404             20  DC-ALPHA-DAY          PIC 99.
   405             20  FILLER                PIC XX.
   406             20  DC-ALPHA-CENTURY.
   407                 24 DC-ALPHA-CEN-N     PIC 99.
   408             20  DC-ALPHA-YEAR         PIC 99.
   409         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   410         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   411         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   412         16  DC-JULIAN-DATE            PIC 9(05).
   413         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   414                                       PIC 9(05).
   415         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   416             20  DC-JULIAN-YEAR        PIC 99.
   417             20  DC-JULIAN-DAYS        PIC 999.
   418         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   419         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page   9
* EL1044.cbl
   420         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   421     12  DATE-CONVERSION-VARIBLES.
   422         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   423         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   424             20  FILLER                PIC 9(3).
   425             20  HOLD-CEN-1-CCYY.
   426                 24  HOLD-CEN-1-CC     PIC 99.
   427                 24  HOLD-CEN-1-YY     PIC 99.
   428             20  HOLD-CEN-1-MO         PIC 99.
   429             20  HOLD-CEN-1-DA         PIC 99.
   430         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   431             20  HOLD-CEN-1-R-MO       PIC 99.
   432             20  HOLD-CEN-1-R-DA       PIC 99.
   433             20  HOLD-CEN-1-R-CCYY.
   434                 24  HOLD-CEN-1-R-CC   PIC 99.
   435                 24  HOLD-CEN-1-R-YY   PIC 99.
   436             20  FILLER                PIC 9(3).
   437         16  HOLD-CENTURY-1-X.
   438             20  FILLER                PIC X(3)  VALUE SPACES.
   439             20  HOLD-CEN-1-X-CCYY.
   440                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   441                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   442             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   443             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   444         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   445             20  HOLD-CEN-1-R-X-MO     PIC XX.
   446             20  HOLD-CEN-1-R-X-DA     PIC XX.
   447             20  HOLD-CEN-1-R-X-CCYY.
   448                 24  HOLD-CEN-1-R-X-CC PIC XX.
   449                 24  HOLD-CEN-1-R-X-YY PIC XX.
   450             20  FILLER                PIC XXX.
   451         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   452         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   453         16  DC-JULIAN-DATE-1          PIC 9(07).
   454         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   455             20  DC-JULIAN-1-CCYY.
   456                 24  DC-JULIAN-1-CC    PIC 99.
   457                 24  DC-JULIAN-1-YR    PIC 99.
   458             20  DC-JULIAN-DA-1        PIC 999.
   459         16  DC-JULIAN-DATE-2          PIC 9(07).
   460         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   461             20  DC-JULIAN-2-CCYY.
   462                 24  DC-JULIAN-2-CC    PIC 99.
   463                 24  DC-JULIAN-2-YR    PIC 99.
   464             20  DC-JULIAN-DA-2        PIC 999.
   465         16  DC-GREG-DATE-A-EDIT.
   466             20  DC-EDITA-MONTH        PIC 99.
   467             20  SLASHA-1              PIC X VALUE '/'.
   468             20  DC-EDITA-DAY          PIC 99.
   469             20  SLASHA-2              PIC X VALUE '/'.
   470             20  DC-EDITA-CCYY.
   471                 24  DC-EDITA-CENT     PIC 99.
   472                 24  DC-EDITA-YEAR     PIC 99.
   473         16  DC-GREG-DATE-B-EDIT.
   474             20  DC-EDITB-MONTH        PIC 99.
   475             20  SLASHB-1              PIC X VALUE '/'.
   476             20  DC-EDITB-DAY          PIC 99.
   477             20  SLASHB-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  10
* EL1044.cbl
   478             20  DC-EDITB-CCYY.
   479                 24  DC-EDITB-CENT     PIC 99.
   480                 24  DC-EDITB-YEAR     PIC 99.
   481         16  DC-GREG-DATE-CYMD         PIC 9(08).
   482         16  DC-GREG-DATE-CYMD-R REDEFINES
   483                              DC-GREG-DATE-CYMD.
   484             20  DC-CYMD-CEN           PIC 99.
   485             20  DC-CYMD-YEAR          PIC 99.
   486             20  DC-CYMD-MONTH         PIC 99.
   487             20  DC-CYMD-DAY           PIC 99.
   488         16  DC-GREG-DATE-MDCY         PIC 9(08).
   489         16  DC-GREG-DATE-MDCY-R REDEFINES
   490                              DC-GREG-DATE-MDCY.
   491             20  DC-MDCY-MONTH         PIC 99.
   492             20  DC-MDCY-DAY           PIC 99.
   493             20  DC-MDCY-CEN           PIC 99.
   494             20  DC-MDCY-YEAR          PIC 99.
   495    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   496        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   497    12  DC-EL310-DATE                  PIC X(21).
   498    12  FILLER                         PIC X(28).
   499*                                    COPY ELCLOGOF.
   500******************************************************************
   501*                                                                *
   502*                                                                *
   503*                            ELCLOGOF.                           *
   504*                            VMOD=2.001                          *
   505*                                                                *
   506*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   507*                                                                *
   508******************************************************************
   509 01  CLASIC-LOGOFF.
   510     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   511     12  LOGOFF-TEXT.
   512         16  FILLER          PIC X(5)    VALUE SPACES.
   513         16  LOGOFF-MSG.
   514             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   515             20  FILLER      PIC X       VALUE SPACES.
   516             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   517         16  FILLER          PIC X(80)
   518           VALUE '* YOU ARE NOW LOGGED OFF'.
   519         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   520         16  FILLER          PIC X       VALUE QUOTE.
   521         16  LOGOFF-SYS-MSG  PIC X(17)
   522           VALUE 'S CLAS-IC SYSTEM '.
   523     12  TEXT-MESSAGES.
   524         16  UNACCESS-MSG    PIC X(29)
   525             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   526         16  PGMIDERR-MSG    PIC X(17)
   527             VALUE 'PROGRAM NOT FOUND'.
   528*                                    COPY ELCATTR.
   529******************************************************************
   530*                                                                *
   531*                            ELCATTR.                            *
   532*                            VMOD=2.001                          *
   533*                                                                *
   534*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   535*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  11
* EL1044.cbl
   536*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   537*                                                                *
   538*                   POS 1   P=PROTECTED                          *
   539*                           U=UNPROTECTED                        *
   540*                           S=ASKIP                              *
   541*                   POS 2   A=ALPHA/NUMERIC                      *
   542*                           N=NUMERIC                            *
   543*                   POS 3   N=NORMAL                             *
   544*                           B=BRIGHT                             *
   545*                           D=DARK                               *
   546*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   547*                           OF=MODIFIED DATA TAG OFF             *
   548*                                                                *
   549*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   550******************************************************************
   551 01  ATTRIBUTE-LIST.
   552     12  AL-PABOF            PIC X       VALUE 'Y'.
   553     12  AL-PABON            PIC X       VALUE 'Z'.
   554     12  AL-PADOF            PIC X       VALUE '%'.
   555     12  AL-PADON            PIC X       VALUE '_'.
   556     12  AL-PANOF            PIC X       VALUE '-'.
   557     12  AL-PANON            PIC X       VALUE '/'.
   558     12  AL-SABOF            PIC X       VALUE '8'.
   559     12  AL-SABON            PIC X       VALUE '9'.
   560     12  AL-SADOF            PIC X       VALUE '@'.
   561     12  AL-SADON            PIC X       VALUE QUOTE.
   562     12  AL-SANOF            PIC X       VALUE '0'.
   563     12  AL-SANON            PIC X       VALUE '1'.
   564     12  AL-UABOF            PIC X       VALUE 'H'.
   565     12  AL-UABON            PIC X       VALUE 'I'.
   566     12  AL-UADOF            PIC X       VALUE '<'.
   567     12  AL-UADON            PIC X       VALUE '('.
   568     12  AL-UANOF            PIC X       VALUE ' '.
   569     12  AL-UANON            PIC X       VALUE 'A'.
   570     12  AL-UNBOF            PIC X       VALUE 'Q'.
   571     12  AL-UNBON            PIC X       VALUE 'R'.
   572     12  AL-UNDOF            PIC X       VALUE '*'.
   573     12  AL-UNDON            PIC X       VALUE ')'.
   574     12  AL-UNNOF            PIC X       VALUE '&'.
   575     12  AL-UNNON            PIC X       VALUE 'J'.
   576*                                    COPY ELCEMIB.
   577******************************************************************
   578*                                                                *
   579*                                                                *
   580*                            ELCEMIB.                            *
   581*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   582*                            VMOD=2.005                          *
   583*                                                                *
   584*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   585*                                                                *
   586******************************************************************
   587 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   588     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   589     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   590     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   591     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   592     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   593     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  12
* EL1044.cbl
   594     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   595     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   596     12  EMI-SWITCH1             PIC X        VALUE '1'.
   597         88  EMI-NO-ERRORS                    VALUE '1'.
   598         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   599         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   600     12  EMI-SWITCH2             PIC X        VALUE '1'.
   601         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   602     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   603         88  EMI-AREA1-EMPTY                  VALUE '1'.
   604         88  EMI-AREA1-FULL                   VALUE '2'.
   605     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   606         88  EMI-AREA2-EMPTY                  VALUE '1'.
   607         88  EMI-AREA2-FULL                   VALUE '2'.
   608     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   609         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   610         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   611         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   612         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   613         88  EMI-BYPASS-FATALS                VALUE 'X'.
   614     12  EMI-ERROR-LINES.
   615         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   616         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   617         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   618         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   619             20  EMI-ERR-CODES OCCURS 10 TIMES.
   620                 24  EMI-ERR-NUM         PIC X(4).
   621                 24  EMI-FILLER          PIC X.
   622                 24  EMI-SEV             PIC X.
   623                 24  FILLER              PIC X.
   624             20  FILLER                  PIC X(02).
   625     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   626         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   627             20  EMI-ERROR-NUMBER    PIC X(4).
   628             20  EMI-FILL            PIC X.
   629             20  EMI-SEVERITY        PIC X.
   630             20  FILLER              PIC X.
   631             20  EMI-ERROR-TEXT.
   632                 24  EMI-TEXT-VARIABLE   PIC X(10).
   633                 24  FILLER          PIC X(55).
   634     12  EMI-SEVERITY-SAVE           PIC X.
   635         88  EMI-NOTE                    VALUE 'N'.
   636         88  EMI-WARNING                 VALUE 'W'.
   637         88  EMI-FORCABLE                VALUE 'F'.
   638         88  EMI-FATAL                   VALUE 'X'.
   639     12  EMI-MESSAGE-FLAG            PIC X.
   640         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   641         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   642     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   643     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   644         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   645         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   646         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   647     12  emi-claim-no                pic x(7).
   648     12  emi-claim-type              pic x(6).
   649     12  FILLER                      PIC X(124)  VALUE SPACES.
   650     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   651     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  13
* EL1044.cbl
   652     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   653     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   654*                                    COPY ELCJPFX.
   655******************************************************************
   656*                                                                *
   657*                                                                *
   658*                            ELCJPFX.                            *
   659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   660*                            VMOD=2.002                          *
   661*                                                                *
   662*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   663*                                                                *
   664*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   665*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   666*        ELCNTL - CONTROL FILE                                   *
   667*        ELMSTR - CLAIM MASTERS                                  *
   668*        ELTRLR - ACTIVITY TRAILERS                              *
   669*        ELCHKQ - CHECK QUE                                      *
   670******************************************************************
   671 01  JOURNAL-RECORD.
   672     12  jp-date                     pic s9(5) comp-3.
   673     12  jp-time                     pic s9(7) comp-3.
   674     12  JP-USER-ID                  PIC X(4).
   675     12  JP-FILE-ID                  PIC X(8).
   676     12  JP-PROGRAM-ID               PIC X(8).
   677     12  JP-RECORD-TYPE              PIC X.
   678         88 JP-ADD              VALUE 'A'.
   679         88 JP-BEFORE-CHANGE    VALUE 'B'.
   680         88 JP-AFTER-CHANGE     VALUE 'C'.
   681         88 JP-DELETE           VALUE 'D'.
   682         88 JP-GENERIC-DELETE   VALUE 'G'.
   683         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   684         88 JP-KEY-CHG-ADD      VALUE 'N'.
   685     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   686     12  JP-RECORD-AREA
   687
   688
   689                                     PIC X(530).
   690*                                    COPY ELCINTF.
   691******************************************************************
   692*                                                                *
   693*                                                                *
   694*                            ELCINTF.                            *
   695*                            VMOD=2.017                          *
   696*                                                                *
   697*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   698*                                                                *
   699*       LENGTH = 1024                                            *
   700*                                                                *
   701******************************************************************
   702*                   C H A N G E   L O G
   703*
   704* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   705*-----------------------------------------------------------------
   706*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   707* EFFECTIVE    NUMBER
   708*-----------------------------------------------------------------
   709* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  14
* EL1044.cbl
   710******************************************************************
   711 01  PROGRAM-INTERFACE-BLOCK.
   712     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   713     12  PI-CALLING-PROGRAM              PIC X(8).
   714     12  PI-SAVED-PROGRAM-1              PIC X(8).
   715     12  PI-SAVED-PROGRAM-2              PIC X(8).
   716     12  PI-SAVED-PROGRAM-3              PIC X(8).
   717     12  PI-SAVED-PROGRAM-4              PIC X(8).
   718     12  PI-SAVED-PROGRAM-5              PIC X(8).
   719     12  PI-SAVED-PROGRAM-6              PIC X(8).
   720     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   721     12  PI-COMPANY-ID                   PIC XXX.
   722     12  PI-COMPANY-CD                   PIC X.
   723
   724     12  PI-COMPANY-PASSWORD             PIC X(8).
   725
   726     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   727
   728     12  PI-CONTROL-IN-PROGRESS.
   729         16  PI-CARRIER                  PIC X.
   730         16  PI-GROUPING                 PIC X(6).
   731         16  PI-STATE                    PIC XX.
   732         16  PI-ACCOUNT                  PIC X(10).
   733         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   734                                         PIC X(10).
   735         16  PI-CLAIM-CERT-GRP.
   736             20  PI-CLAIM-NO             PIC X(7).
   737             20  PI-CERT-NO.
   738                 25  PI-CERT-PRIME       PIC X(10).
   739                 25  PI-CERT-SFX         PIC X.
   740             20  PI-CERT-EFF-DT          PIC XX.
   741         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   742             20  PI-PLAN-CODE            PIC X(2).
   743             20  PI-REVISION-NUMBER      PIC X(3).
   744             20  PI-PLAN-EFF-DT          PIC X(2).
   745             20  PI-PLAN-EXP-DT          PIC X(2).
   746             20  FILLER                  PIC X(11).
   747         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   748             20  PI-OE-REFERENCE-1.
   749                 25  PI-OE-REF-1-PRIME   PIC X(18).
   750                 25  PI-OE-REF-1-SUFF    PIC XX.
   751
   752     12  PI-SESSION-IN-PROGRESS          PIC X.
   753         88  CLAIM-SESSION                   VALUE '1'.
   754         88  CREDIT-SESSION                  VALUE '2'.
   755         88  WARRANTY-SESSION                VALUE '3'.
   756         88  MORTGAGE-SESSION                VALUE '4'.
   757         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   758
   759
   760*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   761
   762     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   763     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   764
   765     12  PI-CREDIT-USER                  PIC X.
   766         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   767         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  15
* EL1044.cbl
   768
   769     12  PI-CLAIM-USER                   PIC X.
   770         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   771         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   772
   773     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   774         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   775         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   776         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   777         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   778         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   779
   780     12  PI-PROCESSOR-ID                 PIC X(4).
   781
   782     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   783
   784     12  PI-MEMBER-CAPTION               PIC X(10).
   785
   786     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   787         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   788
   789     12  PI-LIFE-OVERRIDE-L1             PIC X.
   790     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   791     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   792     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   793
   794     12  PI-AH-OVERRIDE-L1               PIC X.
   795     12  PI-AH-OVERRIDE-L2               PIC XX.
   796     12  PI-AH-OVERRIDE-L6               PIC X(6).
   797     12  PI-AH-OVERRIDE-L12              PIC X(12).
   798
   799     12  PI-NEW-SYSTEM                   PIC X(2).
   800
   801     12  PI-PRIMARY-CERT-NO              PIC X(11).
   802     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   803         88  PI-USES-PAID-TO                 VALUE '1'.
   804     12  PI-CRDTCRD-SYSTEM.
   805         16  PI-CRDTCRD-USER             PIC X.
   806             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   807             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   808         16  PI-CC-MONTH-END-DT          PIC XX.
   809     12  PI-PROCESSOR-PRINTER            PIC X(4).
   810
   811     12  PI-OE-REFERENCE-2.
   812         16  PI-OE-REF-2-PRIME           PIC X(10).
   813         16  PI-OE-REF-2-SUFF            PIC X.
   814
   815     12  PI-REM-TRM-CALC-OPTION          PIC X.
   816
   817     12  PI-LANGUAGE-TYPE                PIC X.
   818             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   819             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   820             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   821
   822     12  PI-POLICY-LINKAGE-IND           PIC X.
   823         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   824         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   825                                                   LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  16
* EL1044.cbl
   826
   827     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   828     12  PI-CLAIM-PW-SESSION             PIC X(1).
   829         88  PI-CLAIM-CREDIT                 VALUE '1'.
   830         88  PI-CLAIM-CONVEN                 VALUE '2'.
   831
   832     12  PI-PROCESSOR-CSR-IND            PIC X.
   833         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   834         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   835
   836     12  FILLER                          PIC X(3).
   837
   838     12  PI-SYSTEM-LEVEL                 PIC X(145).
   839
   840     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   841         PI-SYSTEM-LEVEL.
   842
   843         16  PI-ENTRY-CODES.
   844             20  PI-ENTRY-CD-1           PIC X.
   845             20  PI-ENTRY-CD-2           PIC X.
   846
   847         16  PI-RETURN-CODES.
   848             20  PI-RETURN-CD-1          PIC X.
   849             20  PI-RETURN-CD-2          PIC X.
   850
   851         16  PI-UPDATE-STATUS-SAVE.
   852             20  PI-UPDATE-BY            PIC X(4).
   853             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   854
   855         16  PI-LOWER-CASE-LETTERS       PIC X.
   856             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   857
   858*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   859*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   860*            88  CARRIER-CLM-CNTL            VALUE '2'.
   861
   862         16  PI-CERT-ACCESS-CONTROL      PIC X.
   863             88  ST-ACCNT-CNTL               VALUE ' '.
   864             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   865             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   866             88  ACCNT-CNTL                  VALUE '3'.
   867             88  CARR-ACCNT-CNTL             VALUE '4'.
   868
   869         16  PI-PROCESSOR-CAP-LIST.
   870             20  PI-SYSTEM-CONTROLS.
   871                24 PI-SYSTEM-DISPLAY     PIC X.
   872                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   873                24 PI-SYSTEM-MODIFY      PIC X.
   874                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   875             20  FILLER                  PIC XX.
   876             20  PI-DISPLAY-CAP          PIC X.
   877                 88  DISPLAY-CAP             VALUE 'Y'.
   878             20  PI-MODIFY-CAP           PIC X.
   879                 88  MODIFY-CAP              VALUE 'Y'.
   880             20  PI-MSG-AT-LOGON-CAP     PIC X.
   881                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   882             20  PI-FORCE-CAP            PIC X.
   883                 88  FORCE-CAP               VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  17
* EL1044.cbl
   884
   885         16  PI-PROGRAM-CONTROLS.
   886             20  PI-PGM-PRINT-OPT        PIC X.
   887             20  PI-PGM-FORMAT-OPT       PIC X.
   888             20  PI-PGM-PROCESS-OPT      PIC X.
   889             20  PI-PGM-TOTALS-OPT       PIC X.
   890
   891         16  PI-HELP-INTERFACE.
   892             20  PI-LAST-ERROR-NO        PIC X(4).
   893             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   894
   895         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   896             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   897
   898         16  PI-CR-CONTROL-IN-PROGRESS.
   899             20  PI-CR-CARRIER           PIC X.
   900             20  PI-CR-GROUPING          PIC X(6).
   901             20  PI-CR-STATE             PIC XX.
   902             20  PI-CR-ACCOUNT           PIC X(10).
   903             20  PI-CR-FIN-RESP          PIC X(10).
   904             20  PI-CR-TYPE              PIC X.
   905
   906         16  PI-CR-BATCH-NUMBER          PIC X(6).
   907
   908         16  PI-CR-MONTH-END-DT          PIC XX.
   909
   910         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   911             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   912             88  PI-ZERO-CARRIER             VALUE '1'.
   913             88  PI-ZERO-GROUPING            VALUE '2'.
   914             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   915
   916         16  PI-CARRIER-SECURITY         PIC X.
   917             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   918
   919         16  PI-ACCOUNT-SECURITY         PIC X(10).
   920             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   921             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   922
   923         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   924             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   925                                         INDEXED BY PI-ACCESS-NDX
   926                                         PIC X.
   927
   928         16  PI-GA-BILLING-CONTROL       PIC X.
   929             88  PI-GA-BILLING               VALUE '1'.
   930
   931         16  PI-MAIL-PROCESSING          PIC X.
   932             88  PI-MAIL-YES                 VALUE 'Y'.
   933
   934         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   935
   936         16  PI-AR-SYSTEM.
   937             20  PI-AR-PROCESSING-CNTL   PIC X.
   938                 88  PI-AR-PROCESSING        VALUE 'Y'.
   939             20  PI-AR-SUMMARY-CODE      PIC X(6).
   940             20  PI-AR-MONTH-END-DT      PIC XX.
   941
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  18
* EL1044.cbl
   942         16  PI-MP-SYSTEM.
   943             20  PI-MORTGAGE-USER            PIC X.
   944                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   945                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   946             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   947                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   948                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   949                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   950                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   951                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   952             20  PI-MP-MONTH-END-DT          PIC XX.
   953             20  PI-MP-REFERENCE-NO.
   954                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   955                 24  PI-MP-REFERENCE-SFX     PIC XX.
   956
   957         16  PI-LABEL-CONTROL            PIC X(01).
   958             88  PI-CREATE-LABELS                    VALUE 'Y'.
   959             88  PI-BYPASS-LABELS                    VALUE 'N'.
   960
   961         16  PI-BILL-GROUPING-CODE       PIC X(01).
   962             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   963
   964         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   965             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   966             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   967
   968         16  FILLER                      PIC X(14).
   969
   970     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   971******************************************************************
   972     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   973*                                    COPY ELC1042.
   974******************************************************************
   975*                                                                *
   976*                                                                *
   977*                           ELC1042                              *
   978*                            VMOD=2.002                          *
   979*                                                                *
   980*    NOTE                                                        *
   981*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   982*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   983*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   984*        TO THESE PROGRAMS.                                      *
   985*                                                                *
   986*    NOTE                                                        *
   987*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   988*        USE ONLY!                                               *
   989*                                                                *
   990******************************************************************
   991
   992         16  PI-1042-WA.
   993             20  PI-ACTION       PIC  X(01).
   994                 88 PI-SHOW-MODE           VALUE '1'.
   995                 88 PI-CLEAR-MODE          VALUE '2'.
   996                 88 PI-CREATE-MODE         VALUE '3'.
   997             20  PI-COMM-CONTROL PIC  X(12).
   998             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   999             20  PI-EOF-SW       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  19
* EL1044.cbl
  1000                 88  PI-FILE-EOF           VALUE 'Y'.
  1001             20  PI-FILETYP      PIC  X(01).
  1002             20  PI-FORM-SQUEEZE-CONTROL
  1003                                 PIC  X(01).
  1004                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1005                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1006             20  PI-LAST-CONTROL PIC  X(12).
  1007             20  PI-TEMP-STOR-ITEMS
  1008                                 PIC S9(04) COMP.
  1009             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1010             20  PI-UPDATE-SW    PIC  9(01).
  1011                 88 ANY-UPDATES            VALUE 1.
  1012             20  PI-104-SCREEN-SENT-IND
  1013                                 PIC  X(01).
  1014                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1015                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1016             20  PI-1042-SCREEN-SENT-IND
  1017                                 PIC  X(01).
  1018                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1019                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1020             20  PI-1042-ARCHIVE-IND
  1021                                 PIC  X(01).
  1022                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1023             20  FILLER          PIC  X(29).
  1024         16  PI-PREV-LETR-KEY        PIC X(15).
  1025         16  PI-CURR-LETR-KEY        PIC X(15).
  1026         16  PI-UPDATE-DT            PIC XX.
  1027         16  PI-ENC-CODES            PIC X(120).
  1028         16  PI-SPLIT-SUB            PIC S9(3)  COMP.
  1029         16  FILLER                  PIC X(434).
  1030*                                    COPY ELCAID.
  1031******************************************************************
  1032*                                                                *
  1033*                            ELCAID.                             *
  1034*                            VMOD=2.001                          *
  1035*                                                                *
  1036*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1037*                                                                *
  1038*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1039*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1040******************************************************************
  1041
  1042 01  DFHAID.
  1043   02  DFHNULL   PIC  X  VALUE  ' '.
  1044   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1045   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1046   02  DFHPEN    PIC  X  VALUE  '='.
  1047   02  DFHOPID   PIC  X  VALUE  'W'.
  1048   02  DFHPA1    PIC  X  VALUE  '%'.
  1049   02  DFHPA2    PIC  X  VALUE  '>'.
  1050   02  DFHPA3    PIC  X  VALUE  ','.
  1051   02  DFHPF1    PIC  X  VALUE  '1'.
  1052   02  DFHPF2    PIC  X  VALUE  '2'.
  1053   02  DFHPF3    PIC  X  VALUE  '3'.
  1054   02  DFHPF4    PIC  X  VALUE  '4'.
  1055   02  DFHPF5    PIC  X  VALUE  '5'.
  1056   02  DFHPF6    PIC  X  VALUE  '6'.
  1057   02  DFHPF7    PIC  X  VALUE  '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  20
* EL1044.cbl
  1058   02  DFHPF8    PIC  X  VALUE  '8'.
  1059   02  DFHPF9    PIC  X  VALUE  '9'.
  1060   02  DFHPF10   PIC  X  VALUE  ':'.
  1061   02  DFHPF11   PIC  X  VALUE  '#'.
  1062   02  DFHPF12   PIC  X  VALUE  '@'.
  1063   02  DFHPF13   PIC  X  VALUE  'A'.
  1064   02  DFHPF14   PIC  X  VALUE  'B'.
  1065   02  DFHPF15   PIC  X  VALUE  'C'.
  1066   02  DFHPF16   PIC  X  VALUE  'D'.
  1067   02  DFHPF17   PIC  X  VALUE  'E'.
  1068   02  DFHPF18   PIC  X  VALUE  'F'.
  1069   02  DFHPF19   PIC  X  VALUE  'G'.
  1070   02  DFHPF20   PIC  X  VALUE  'H'.
  1071   02  DFHPF21   PIC  X  VALUE  'I'.
  1072*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1073   02  DFHPF22   PIC  X  VALUE  '['.
  1074   02  DFHPF23   PIC  X  VALUE  '.'.
  1075   02  DFHPF24   PIC  X  VALUE  '<'.
  1076   02  DFHMSRE   PIC  X  VALUE  'X'.
  1077   02  DFHSTRF   PIC  X  VALUE  'h'.
  1078   02  DFHTRIG   PIC  X  VALUE  '"'.
  1079 01  FILLER    REDEFINES DFHAID.
  1080     12  FILLER                      PIC X(08).
  1081     12  PF-VALUES                   PIC X         OCCURS 24.
  1082*                                    COPY EL1044S.
  1083 01  EL1044ZI.
  1084     05  FILLER            PIC  X(0012).
  1085*    -------------------------------
  1086     05  DATEL PIC S9(0004) COMP.
  1087     05  DATEF PIC  X(0001).
  1088     05  FILLER REDEFINES DATEF.
  1089         10  DATEA PIC  X(0001).
  1090     05  FILLER            PIC  X(3).
  1091     05  DATEI PIC  X(0008).
  1092*    -------------------------------
  1093     05  TIMEL PIC S9(0004) COMP.
  1094     05  TIMEF PIC  X(0001).
  1095     05  FILLER REDEFINES TIMEF.
  1096         10  TIMEA PIC  X(0001).
  1097     05  FILLER            PIC  X(3).
  1098     05  TIMEI PIC  X(0005).
  1099*    -------------------------------
  1100     05  CMPNYIDL PIC S9(0004) COMP.
  1101     05  CMPNYIDF PIC  X(0001).
  1102     05  FILLER REDEFINES CMPNYIDF.
  1103         10  CMPNYIDA PIC  X(0001).
  1104     05  FILLER            PIC  X(3).
  1105     05  CMPNYIDI PIC  X(0003).
  1106*    -------------------------------
  1107     05  USERIDL PIC S9(0004) COMP.
  1108     05  USERIDF PIC  X(0001).
  1109     05  FILLER REDEFINES USERIDF.
  1110         10  USERIDA PIC  X(0001).
  1111     05  FILLER            PIC  X(3).
  1112     05  USERIDI PIC  X(0004).
  1113*    -------------------------------
  1114     05  MAINTL PIC S9(0004) COMP.
  1115     05  MAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  21
* EL1044.cbl
  1116     05  FILLER REDEFINES MAINTF.
  1117         10  MAINTA PIC  X(0001).
  1118     05  FILLER            PIC  X(3).
  1119     05  MAINTI PIC  X(0001).
  1120*    -------------------------------
  1121     05  LSTUSRL PIC S9(0004) COMP.
  1122     05  LSTUSRF PIC  X(0001).
  1123     05  FILLER REDEFINES LSTUSRF.
  1124         10  LSTUSRA PIC  X(0001).
  1125     05  FILLER            PIC  X(3).
  1126     05  LSTUSRI PIC  X(0004).
  1127*    -------------------------------
  1128     05  LSTDTEL PIC S9(0004) COMP.
  1129     05  LSTDTEF PIC  X(0001).
  1130     05  FILLER REDEFINES LSTDTEF.
  1131         10  LSTDTEA PIC  X(0001).
  1132     05  FILLER            PIC  X(3).
  1133     05  LSTDTEI PIC  X(0008).
  1134*    -------------------------------
  1135     05  ZLETRL PIC S9(0004) COMP.
  1136     05  ZLETRF PIC  X(0001).
  1137     05  FILLER REDEFINES ZLETRF.
  1138         10  ZLETRA PIC  X(0001).
  1139     05  FILLER            PIC  X(3).
  1140     05  ZLETRI PIC  X(0004).
  1141*    -------------------------------
  1142     05  ZCOPIESL PIC S9(0004) COMP.
  1143     05  ZCOPIESF PIC  X(0001).
  1144     05  FILLER REDEFINES ZCOPIESF.
  1145         10  ZCOPIESA PIC  X(0001).
  1146     05  FILLER            PIC  X(3).
  1147     05  ZCOPIESI PIC  X(0001).
  1148*    -------------------------------
  1149     05  ZPROMPTL PIC S9(0004) COMP.
  1150     05  ZPROMPTF PIC  X(0001).
  1151     05  FILLER REDEFINES ZPROMPTF.
  1152         10  ZPROMPTA PIC  X(0001).
  1153     05  FILLER            PIC  X(3).
  1154     05  ZPROMPTI PIC  X(0001).
  1155*    -------------------------------
  1156     05  ZENCCDL PIC S9(0004) COMP.
  1157     05  ZENCCDF PIC  X(0001).
  1158     05  FILLER REDEFINES ZENCCDF.
  1159         10  ZENCCDA PIC  X(0001).
  1160     05  FILLER            PIC  X(3).
  1161     05  ZENCCDI PIC  X(0003).
  1162*    -------------------------------
  1163     05  ZRDAYSL PIC S9(0004) COMP.
  1164     05  ZRDAYSF PIC  X(0001).
  1165     05  FILLER REDEFINES ZRDAYSF.
  1166         10  ZRDAYSA PIC  X(0001).
  1167     05  FILLER            PIC  X(3).
  1168     05  ZRDAYSI PIC  X(0003).
  1169*    -------------------------------
  1170     05  ZFORML PIC S9(0004) COMP.
  1171     05  ZFORMF PIC  X(0001).
  1172     05  FILLER REDEFINES ZFORMF.
  1173         10  ZFORMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  22
* EL1044.cbl
  1174     05  FILLER            PIC  X(3).
  1175     05  ZFORMI PIC  X(0004).
  1176*    -------------------------------
  1177     05  ZBENEL PIC S9(0004) COMP.
  1178     05  ZBENEF PIC  X(0001).
  1179     05  FILLER REDEFINES ZBENEF.
  1180         10  ZBENEA PIC  X(0001).
  1181     05  FILLER            PIC  X(3).
  1182     05  ZBENEI PIC  X(0001).
  1183*    -------------------------------
  1184     05  ZACCTL PIC S9(0004) COMP.
  1185     05  ZACCTF PIC  X(0001).
  1186     05  FILLER REDEFINES ZACCTF.
  1187         10  ZACCTA PIC  X(0001).
  1188     05  FILLER            PIC  X(3).
  1189     05  ZACCTI PIC  X(0001).
  1190*    -------------------------------
  1191     05  ZTYPEL PIC S9(0004) COMP.
  1192     05  ZTYPEF PIC  X(0001).
  1193     05  FILLER REDEFINES ZTYPEF.
  1194         10  ZTYPEA PIC  X(0001).
  1195     05  FILLER            PIC  X(3).
  1196     05  ZTYPEI PIC  X(0001).
  1197*    -------------------------------
  1198     05  ZPRTCRTL PIC S9(0004) COMP.
  1199     05  ZPRTCRTF PIC  X(0001).
  1200     05  FILLER REDEFINES ZPRTCRTF.
  1201         10  ZPRTCRTA PIC  X(0001).
  1202     05  FILLER            PIC  X(3).
  1203     05  ZPRTCRTI PIC  X(0001).
  1204*    -------------------------------
  1205     05  ZREFREQL PIC S9(0004) COMP.
  1206     05  ZREFREQF PIC  X(0001).
  1207     05  FILLER REDEFINES ZREFREQF.
  1208         10  ZREFREQA PIC  X(0001).
  1209     05  FILLER            PIC  X(3).
  1210     05  ZREFREQI PIC  X(0001).
  1211*    -------------------------------
  1212     05  ZONBASEL PIC S9(0004) COMP.
  1213     05  ZONBASEF PIC  X(0001).
  1214     05  FILLER REDEFINES ZONBASEF.
  1215         10  ZONBASEA PIC  X(0001).
  1216     05  FILLER            PIC  X(3).
  1217     05  ZONBASEI PIC  X(0002).
  1218*    -------------------------------
  1219     05  ZACTSUML PIC S9(0004) COMP.
  1220     05  ZACTSUMF PIC  X(0001).
  1221     05  FILLER REDEFINES ZACTSUMF.
  1222         10  ZACTSUMA PIC  X(0001).
  1223     05  FILLER            PIC  X(3).
  1224     05  ZACTSUMI PIC  X(0001).
  1225*    -------------------------------
  1226     05  ZCSOSUML PIC S9(0004) COMP.
  1227     05  ZCSOSUMF PIC  X(0001).
  1228     05  FILLER REDEFINES ZCSOSUMF.
  1229         10  ZCSOSUMA PIC  X(0001).
  1230     05  FILLER            PIC  X(3).
  1231     05  ZCSOSUMI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  23
* EL1044.cbl
  1232*    -------------------------------
  1233     05  ZREASONL PIC S9(0004) COMP.
  1234     05  ZREASONF PIC  X(0001).
  1235     05  FILLER REDEFINES ZREASONF.
  1236         10  ZREASONA PIC  X(0001).
  1237     05  FILLER            PIC  X(3).
  1238     05  ZREASONI PIC  X(0001).
  1239*    -------------------------------
  1240     05  ZBARCODL PIC S9(0004) COMP.
  1241     05  ZBARCODF PIC  X(0001).
  1242     05  FILLER REDEFINES ZBARCODF.
  1243         10  ZBARCODA PIC  X(0001).
  1244     05  FILLER            PIC  X(3).
  1245     05  ZBARCODI PIC  X(0001).
  1246*    -------------------------------
  1247     05  ZRETENVL PIC S9(0004) COMP.
  1248     05  ZRETENVF PIC  X(0001).
  1249     05  FILLER REDEFINES ZRETENVF.
  1250         10  ZRETENVA PIC  X(0001).
  1251     05  FILLER            PIC  X(3).
  1252     05  ZRETENVI PIC  X(0001).
  1253*    -------------------------------
  1254     05  ZSIGFLGL PIC S9(0004) COMP.
  1255     05  ZSIGFLGF PIC  X(0001).
  1256     05  FILLER REDEFINES ZSIGFLGF.
  1257         10  ZSIGFLGA PIC  X(0001).
  1258     05  FILLER            PIC  X(3).
  1259     05  ZSIGFLGI PIC  X(0001).
  1260*    -------------------------------
  1261     05  ZCODES1L PIC S9(0004) COMP.
  1262     05  ZCODES1F PIC  X(0001).
  1263     05  FILLER REDEFINES ZCODES1F.
  1264         10  ZCODES1A PIC  X(0001).
  1265     05  FILLER            PIC  X(3).
  1266     05  ZCODES1I PIC  X(0053).
  1267*    -------------------------------
  1268     05  ZCODES2L PIC S9(0004) COMP.
  1269     05  ZCODES2F PIC  X(0001).
  1270     05  FILLER REDEFINES ZCODES2F.
  1271         10  ZCODES2A PIC  X(0001).
  1272     05  FILLER            PIC  X(3).
  1273     05  ZCODES2I PIC  X(0078).
  1274*    -------------------------------
  1275     05  ZFADAYSL PIC S9(0004) COMP.
  1276     05  ZFADAYSF PIC  X(0001).
  1277     05  FILLER REDEFINES ZFADAYSF.
  1278         10  ZFADAYSA PIC  X(0001).
  1279     05  FILLER            PIC  X(3).
  1280     05  ZFADAYSI PIC  X(0003).
  1281*    -------------------------------
  1282     05  ZACLOSEL PIC S9(0004) COMP.
  1283     05  ZACLOSEF PIC  X(0001).
  1284     05  FILLER REDEFINES ZACLOSEF.
  1285         10  ZACLOSEA PIC  X(0001).
  1286     05  FILLER            PIC  X(3).
  1287     05  ZACLOSEI PIC  X(0001).
  1288*    -------------------------------
  1289     05  ERRMSGL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  24
* EL1044.cbl
  1290     05  ERRMSGF PIC  X(0001).
  1291     05  FILLER REDEFINES ERRMSGF.
  1292         10  ERRMSGA PIC  X(0001).
  1293     05  FILLER            PIC  X(3).
  1294     05  ERRMSGI PIC  X(0072).
  1295*    -------------------------------
  1296     05  PFKEYL PIC S9(0004) COMP.
  1297     05  PFKEYF PIC  X(0001).
  1298     05  FILLER REDEFINES PFKEYF.
  1299         10  PFKEYA PIC  X(0001).
  1300     05  FILLER            PIC  X(3).
  1301     05  PFKEYI PIC  99.
  1302 01  EL1044ZO REDEFINES EL1044ZI.
  1303     05  FILLER            PIC  X(0012).
  1304*    -------------------------------
  1305     05  FILLER            PIC  X(3).
  1306     05  DATEC PIC  X(0001).
  1307     05  DATEH PIC  X(0001).
  1308     05  DATEU PIC  X(0001).
  1309     05  DATEO PIC  X(0008).
  1310*    -------------------------------
  1311     05  FILLER            PIC  X(3).
  1312     05  TIMEC PIC  X(0001).
  1313     05  TIMEH PIC  X(0001).
  1314     05  TIMEU PIC  X(0001).
  1315     05  TIMEO PIC  99.99.
  1316*    -------------------------------
  1317     05  FILLER            PIC  X(3).
  1318     05  CMPNYIDC PIC  X(0001).
  1319     05  CMPNYIDH PIC  X(0001).
  1320     05  CMPNYIDU PIC  X(0001).
  1321     05  CMPNYIDO PIC  X(0003).
  1322*    -------------------------------
  1323     05  FILLER            PIC  X(3).
  1324     05  USERIDC PIC  X(0001).
  1325     05  USERIDH PIC  X(0001).
  1326     05  USERIDU PIC  X(0001).
  1327     05  USERIDO PIC  X(0004).
  1328*    -------------------------------
  1329     05  FILLER            PIC  X(3).
  1330     05  MAINTC PIC  X(0001).
  1331     05  MAINTH PIC  X(0001).
  1332     05  MAINTU PIC  X(0001).
  1333     05  MAINTO PIC  X(0001).
  1334*    -------------------------------
  1335     05  FILLER            PIC  X(3).
  1336     05  LSTUSRC PIC  X(0001).
  1337     05  LSTUSRH PIC  X(0001).
  1338     05  LSTUSRU PIC  X(0001).
  1339     05  LSTUSRO PIC  X(0004).
  1340*    -------------------------------
  1341     05  FILLER            PIC  X(3).
  1342     05  LSTDTEC PIC  X(0001).
  1343     05  LSTDTEH PIC  X(0001).
  1344     05  LSTDTEU PIC  X(0001).
  1345     05  LSTDTEO PIC  X(0008).
  1346*    -------------------------------
  1347     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  25
* EL1044.cbl
  1348     05  ZLETRC PIC  X(0001).
  1349     05  ZLETRH PIC  X(0001).
  1350     05  ZLETRU PIC  X(0001).
  1351     05  ZLETRO PIC  X(0004).
  1352*    -------------------------------
  1353     05  FILLER            PIC  X(3).
  1354     05  ZCOPIESC PIC  X(0001).
  1355     05  ZCOPIESH PIC  X(0001).
  1356     05  ZCOPIESU PIC  X(0001).
  1357     05  ZCOPIESO PIC  9.
  1358*    -------------------------------
  1359     05  FILLER            PIC  X(3).
  1360     05  ZPROMPTC PIC  X(0001).
  1361     05  ZPROMPTH PIC  X(0001).
  1362     05  ZPROMPTU PIC  X(0001).
  1363     05  ZPROMPTO PIC  X(0001).
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(3).
  1366     05  ZENCCDC PIC  X(0001).
  1367     05  ZENCCDH PIC  X(0001).
  1368     05  ZENCCDU PIC  X(0001).
  1369     05  ZENCCDO PIC  X(0003).
  1370*    -------------------------------
  1371     05  FILLER            PIC  X(3).
  1372     05  ZRDAYSC PIC  X(0001).
  1373     05  ZRDAYSH PIC  X(0001).
  1374     05  ZRDAYSU PIC  X(0001).
  1375     05  ZRDAYSO PIC  999.
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(3).
  1378     05  ZFORMC PIC  X(0001).
  1379     05  ZFORMH PIC  X(0001).
  1380     05  ZFORMU PIC  X(0001).
  1381     05  ZFORMO PIC  X(0004).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(3).
  1384     05  ZBENEC PIC  X(0001).
  1385     05  ZBENEH PIC  X(0001).
  1386     05  ZBENEU PIC  X(0001).
  1387     05  ZBENEO PIC  X(0001).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(3).
  1390     05  ZACCTC PIC  X(0001).
  1391     05  ZACCTH PIC  X(0001).
  1392     05  ZACCTU PIC  X(0001).
  1393     05  ZACCTO PIC  X(0001).
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(3).
  1396     05  ZTYPEC PIC  X(0001).
  1397     05  ZTYPEH PIC  X(0001).
  1398     05  ZTYPEU PIC  X(0001).
  1399     05  ZTYPEO PIC  X(0001).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(3).
  1402     05  ZPRTCRTC PIC  X(0001).
  1403     05  ZPRTCRTH PIC  X(0001).
  1404     05  ZPRTCRTU PIC  X(0001).
  1405     05  ZPRTCRTO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  26
* EL1044.cbl
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(3).
  1408     05  ZREFREQC PIC  X(0001).
  1409     05  ZREFREQH PIC  X(0001).
  1410     05  ZREFREQU PIC  X(0001).
  1411     05  ZREFREQO PIC  X(0001).
  1412*    -------------------------------
  1413     05  FILLER            PIC  X(3).
  1414     05  ZONBASEC PIC  X(0001).
  1415     05  ZONBASEH PIC  X(0001).
  1416     05  ZONBASEU PIC  X(0001).
  1417     05  ZONBASEO PIC  X(0002).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(3).
  1420     05  ZACTSUMC PIC  X(0001).
  1421     05  ZACTSUMH PIC  X(0001).
  1422     05  ZACTSUMU PIC  X(0001).
  1423     05  ZACTSUMO PIC  X(0001).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(3).
  1426     05  ZCSOSUMC PIC  X(0001).
  1427     05  ZCSOSUMH PIC  X(0001).
  1428     05  ZCSOSUMU PIC  X(0001).
  1429     05  ZCSOSUMO PIC  X(0001).
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(3).
  1432     05  ZREASONC PIC  X(0001).
  1433     05  ZREASONH PIC  X(0001).
  1434     05  ZREASONU PIC  X(0001).
  1435     05  ZREASONO PIC  X(0001).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(3).
  1438     05  ZBARCODC PIC  X(0001).
  1439     05  ZBARCODH PIC  X(0001).
  1440     05  ZBARCODU PIC  X(0001).
  1441     05  ZBARCODO PIC  X(0001).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(3).
  1444     05  ZRETENVC PIC  X(0001).
  1445     05  ZRETENVH PIC  X(0001).
  1446     05  ZRETENVU PIC  X(0001).
  1447     05  ZRETENVO PIC  X(0001).
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(3).
  1450     05  ZSIGFLGC PIC  X(0001).
  1451     05  ZSIGFLGH PIC  X(0001).
  1452     05  ZSIGFLGU PIC  X(0001).
  1453     05  ZSIGFLGO PIC  X(0001).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(3).
  1456     05  ZCODES1C PIC  X(0001).
  1457     05  ZCODES1H PIC  X(0001).
  1458     05  ZCODES1U PIC  X(0001).
  1459     05  ZCODES1O PIC  X(0053).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(3).
  1462     05  ZCODES2C PIC  X(0001).
  1463     05  ZCODES2H PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  27
* EL1044.cbl
  1464     05  ZCODES2U PIC  X(0001).
  1465     05  ZCODES2O PIC  X(0078).
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(3).
  1468     05  ZFADAYSC PIC  X(0001).
  1469     05  ZFADAYSH PIC  X(0001).
  1470     05  ZFADAYSU PIC  X(0001).
  1471     05  ZFADAYSO PIC  999.
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(3).
  1474     05  ZACLOSEC PIC  X(0001).
  1475     05  ZACLOSEH PIC  X(0001).
  1476     05  ZACLOSEU PIC  X(0001).
  1477     05  ZACLOSEO PIC  X(0001).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(3).
  1480     05  ERRMSGC PIC  X(0001).
  1481     05  ERRMSGH PIC  X(0001).
  1482     05  ERRMSGU PIC  X(0001).
  1483     05  ERRMSGO PIC  X(0072).
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(3).
  1486     05  PFKEYC PIC  X(0001).
  1487     05  PFKEYH PIC  X(0001).
  1488     05  PFKEYU PIC  X(0001).
  1489     05  PFKEYO PIC  99.
  1490*    -------------------------------
  1491****************************************************************
  1492*
  1493* Copyright (c) 2007 by Clerity Solutions, Inc.
  1494* All rights reserved.
  1495*
  1496****************************************************************
  1497 01  DFHEIV.
  1498   02  DFHEIV0               PIC X(35).
  1499   02  DFHEIV1               PIC X(08).
  1500   02  DFHEIV2               PIC X(08).
  1501   02  DFHEIV3               PIC X(08).
  1502   02  DFHEIV4               PIC X(06).
  1503   02  DFHEIV5               PIC X(04).
  1504   02  DFHEIV6               PIC X(04).
  1505   02  DFHEIV7               PIC X(02).
  1506   02  DFHEIV8               PIC X(02).
  1507   02  DFHEIV9               PIC X(01).
  1508   02  DFHEIV10              PIC S9(7) COMP-3.
  1509   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1510   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1511   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1512   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1513   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1514   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1515   02  DFHEIV17              PIC X(04).
  1516   02  DFHEIV18              PIC X(04).
  1517   02  DFHEIV19              PIC X(04).
  1518   02  DFHEIV20              USAGE IS POINTER.
  1519   02  DFHEIV21              USAGE IS POINTER.
  1520   02  DFHEIV22              USAGE IS POINTER.
  1521   02  DFHEIV23              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  28
* EL1044.cbl
  1522   02  DFHEIV24              USAGE IS POINTER.
  1523   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1524   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1525   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1526   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1527   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1528   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1529   02  FILLER                PIC X(02).
  1530   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1531   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1532   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1533   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1534   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1535 LINKAGE  SECTION.
  1536*****************************************************************
  1537*                                                               *
  1538* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1539* All rights reserved.                                          *
  1540*                                                               *
  1541*****************************************************************
  1542 01  dfheiblk.
  1543     02  eibtime          pic s9(7) comp-3.
  1544     02  eibdate          pic s9(7) comp-3.
  1545     02  eibtrnid         pic x(4).
  1546     02  eibtaskn         pic s9(7) comp-3.
  1547     02  eibtrmid         pic x(4).
  1548     02  dfheigdi         pic s9(4) comp.
  1549     02  eibcposn         pic s9(4) comp.
  1550     02  eibcalen         pic s9(4) comp.
  1551     02  eibaid           pic x(1).
  1552     02  eibfiller1       pic x(1).
  1553     02  eibfn            pic x(2).
  1554     02  eibfiller2       pic x(2).
  1555     02  eibrcode         pic x(6).
  1556     02  eibfiller3       pic x(2).
  1557     02  eibds            pic x(8).
  1558     02  eibreqid         pic x(8).
  1559     02  eibrsrce         pic x(8).
  1560     02  eibsync          pic x(1).
  1561     02  eibfree          pic x(1).
  1562     02  eibrecv          pic x(1).
  1563     02  eibsend          pic x(1).
  1564     02  eibatt           pic x(1).
  1565     02  eibeoc           pic x(1).
  1566     02  eibfmh           pic x(1).
  1567     02  eibcompl         pic x(1).
  1568     02  eibsig           pic x(1).
  1569     02  eibconf          pic x(1).
  1570     02  eiberr           pic x(1).
  1571     02  eibrldbk         pic x(1).
  1572     02  eiberrcd         pic x(4).
  1573     02  eibsynrb         pic x(1).
  1574     02  eibnodat         pic x(1).
  1575     02  eibfiller5       pic x(2).
  1576     02  eibresp          pic 9(09) comp.
  1577     02  eibresp2         pic 9(09) comp.
  1578     02  dfheigdj         pic s9(4) comp.
  1579     02  dfheigdk         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  29
* EL1044.cbl
  1580 01  DFHCOMMAREA                     PIC X(1024).
  1581*                                    COPY ELCTEXT.
  1582******************************************************************
  1583*                                                                *
  1584*                                                                *
  1585*                            ELCTEXT.                            *
  1586*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1587*                            VMOD=2.008                          *
  1588*                                                                *
  1589*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1590*                                     FORM LETTERS,              *
  1591*                                     CERT FORM DISPLAY.
  1592*                                                                *
  1593*   FILE TYPE = VSAM,KSDS                                        *
  1594*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1595*                                                                *
  1596*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1597*       ALTERNATE INDEX = NONE                                   *
  1598*                                                                *
  1599*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1600*       ALTERNATE INDEX = NONE                                   *
  1601*                                                                *
  1602*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1603*       ALTERNATE INDEX = NONE                                   *
  1604*                                                                *
  1605*   LOG = NO                                                     *
  1606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1607******************************************************************
  1608 01  TEXT-FILES.
  1609     12  TEXT-FILE-ID                PIC XX.
  1610         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1611         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1612         88  HELP-FILE-TEXT             VALUE 'TH'.
  1613
  1614     12  TX-CONTROL-PRIMARY.
  1615         16  TX-COMPANY-CD           PIC X.
  1616             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1617         16  TX-ACCESS-CD-GENL       PIC X(12).
  1618
  1619         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1620             20  TX-LETTER-NO        PIC X(4).
  1621             20  FILLER              PIC X(8).
  1622
  1623         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1624             20  TX-FORM-NO          PIC X(12).
  1625
  1626         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1627             20  TX-HELP-TYPE        PIC X.
  1628                 88  HELP-FOR-GENERAL   VALUE ' '.
  1629                 88  HELP-BY-SCREEN     VALUE 'S'.
  1630                 88  HELP-BY-ERROR      VALUE 'E'.
  1631             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1632                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1633             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1634                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1635             20  FILLER              PIC X(4).
  1636
  1637         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  30
* EL1044.cbl
  1638
  1639     12  TX-PROCESS-CONTROL          PIC XX.
  1640         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1641
  1642     12  TX-TEXT-LINE                PIC X(70).
  1643
  1644     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1645         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1646         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1647         88  TX-VALID-FORM-SQUEEZE-VALUE
  1648                                        VALUE 'Y' ' '.
  1649
  1650     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1651         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1652         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1653         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1654         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1655         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1656         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1657         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1658                                              'K' 'N' ' '
  1659                                              'Z'.
  1660
  1661     12  TX-ARCHIVE-SW               PIC X.
  1662         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1663         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1664         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1665
  1666     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1667     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1668
  1669     12  TX-BSR-CODE                 PIC X.
  1670         88  TX-BSR-LETTER              VALUE 'B'.
  1671         88  TX-NON-BSR-LETTER          VALUE ' '.
  1672
  1673     12  FILLER                      PIC X.
  1674*****************************************************************
  1675*                                    COPY ELCENCC.
  1676******************************************************************
  1677*                                                                *
  1678*                                                                *
  1679*                            ELCENCC                             *
  1680*                            VMOD=2.001                          *
  1681*                                                                *
  1682*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  1683*                                                                *
  1684*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  1685*   A NAPERSOFT DOCUMENT                                         *
  1686*                                                                *
  1687*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  1688*                                                                *
  1689*   FILE TYPE = VSAM,KSDS                                        *
  1690*   RECORD SIZE = 400   RECFORM = FIX                            *
  1691*                                                                *
  1692*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  1693*                                                                *
  1694*   LOG = NO                                                     *
  1695*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  31
* EL1044.cbl
  1696*                                                                *
  1697*                                                                *
  1698******************************************************************
  1699*                   C H A N G E   L O G
  1700*
  1701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1702*-----------------------------------------------------------------
  1703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1704* EFFECTIVE    NUMBER
  1705*-----------------------------------------------------------------
  1706* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  1707******************************************************************
  1708 01  ENCLOSURE-CODES.
  1709     12  NC-RECORD-ID                      PIC XX.
  1710         88  VALID-NC-ID                      VALUE 'NC'.
  1711     12  NC-CONTROL-PRIMARY.
  1712         16  NC-COMPANY-CD                 PIC X.
  1713         16  NC-REC-TYPE                   PIC X.
  1714             88  NC-CLAIMS                   VALUE '1'.
  1715             88  NC-ADMIN                    VALUE '2'.
  1716         16  NC-ENC-CODE                   PIC X(5).
  1717         16  FILLER                        PIC X(09).
  1718     12  NC-MAINT-INFORMATION.
  1719         16  NC-LAST-MAINT-DT              PIC XX.
  1720         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1721         16  NC-LAST-MAINT-USER            PIC X(4).
  1722         16  FILLER                        PIC XX.
  1723     12  NC-OUTPUT-STACK                   PIC XXX.
  1724     12  NC-ENCLOSURE-LINE                 PIC X(100).
  1725     12  NC-ATTACHMENTS                    PIC X(100).
  1726     12  NC-FUTURE                         PIC X(50).
  1727     12  FILLER                            PIC X(117).
  1728******************************************************************
  1729 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
  1730                          ENCLOSURE-CODES.
  1731 0000-DFHEXIT SECTION.
  1732     MOVE '9#                    $   ' TO DFHEIV0.
  1733     MOVE 'EL1044' TO DFHEIV1.
  1734     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1735     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1736     MOVE '5'                    TO DC-OPTION-CODE
  1737     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1738     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1739     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1740     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1741     IF EIBCALEN = 0
  1742        GO TO 8800-UNAUTHORIZED-ACCESS.
  1743     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1744     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1745     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1746
  1747* EXEC CICS HANDLE CONDITION
  1748*        DUPREC     (8850-DUPREC)
  1749*        NOTOPEN    (8870-NOTOPEN)
  1750*        NOTFND     (8880-NOT-FOUND)
  1751*        PGMIDERR   (9600-PGMID-ERROR)
  1752*        ERROR      (9990-ABEND)
  1753*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  32
* EL1044.cbl
  1754*    MOVE '"$%JIL.               ! " #00001742' TO DFHEIV0
  1755     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1757     MOVE X'2220233030303031373432' TO DFHEIV0(25:11)
  1758     CALL 'kxdfhei1' USING DFHEIV0
  1759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1760
  1761     .
  1762 0150-SET-PROGRAM-SAVES.
  1763     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1764         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1765             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1766             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1767             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1768             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1769             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1770             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1771             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1772             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1773         ELSE
  1774             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1775             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1776             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1777             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1778             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1779             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1780             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1781             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1782     ELSE
  1783         GO TO 0200-RECEIVE.
  1784*    DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1785     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1786     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1787     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1788     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1789                                    PI-PREV-LETR-KEY
  1790
  1791     PERFORM 6500-BUILD-CURRENT-CODES THRU 6500-EXIT
  1792
  1793     GO TO 1000-SHOW-LETR-RECORD
  1794     .
  1795 0200-RECEIVE.
  1796     IF EIBAID = DFHCLEAR
  1797        GO TO 9400-CLEAR.
  1798     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1799         MOVE LOW-VALUES             TO  EL1044ZI
  1800         MOVE ER-7008                TO  EMI-ERROR
  1801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1802         MOVE -1                     TO  MAINTL
  1803         GO TO 8200-SEND-DATAONLY.
  1804     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1805         NEXT SENTENCE
  1806     ELSE
  1807
  1808* EXEC CICS READQ TS
  1809*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1810*            INTO   (SECURITY-CONTROL)
  1811*            LENGTH (SC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  33
* EL1044.cbl
  1812*            ITEM   (SC-ITEM)
  1813*        END-EXEC
  1814*    MOVE '*$II   L              ''   #00001795' TO DFHEIV0
  1815     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1816     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1817     MOVE X'2020233030303031373935' TO DFHEIV0(25:11)
  1818     CALL 'kxdfhei1' USING DFHEIV0,
  1819           PI-SECURITY-TEMP-STORE-ID,
  1820           SECURITY-CONTROL,
  1821           SC-COMM-LENGTH,
  1822           SC-ITEM,
  1823           DFHEIV99,
  1824           DFHEIV99
  1825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1826         MOVE SC-CREDIT-DISPLAY (3)  TO  PI-DISPLAY-CAP
  1827         MOVE SC-CREDIT-UPDATE  (3)  TO  PI-MODIFY-CAP.
  1828
  1829* EXEC CICS RECEIVE
  1830*        MAP      (WS-MAP-NAME)
  1831*        MAPSET   (MAPSET-NAME)
  1832*        INTO     (EL1044ZI)
  1833*    END-EXEC
  1834     MOVE LENGTH OF
  1835      EL1044ZI
  1836       TO DFHEIV11
  1837*    MOVE '8"T I  L              ''   #00001803' TO DFHEIV0
  1838     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1839     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1840     MOVE X'2020233030303031383033' TO DFHEIV0(25:11)
  1841     CALL 'kxdfhei1' USING DFHEIV0,
  1842           WS-MAP-NAME,
  1843           EL1044ZI,
  1844           DFHEIV11,
  1845           MAPSET-NAME,
  1846           DFHEIV99,
  1847           DFHEIV99
  1848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1849     IF PFKEYL = +0
  1850         GO TO 0300-CHECK-PFKEYS.
  1851     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1852         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1853     ELSE
  1854         MOVE ER-0029                TO  EMI-ERROR
  1855         GO TO 0320-INPUT-ERROR.
  1856 0300-CHECK-PFKEYS.
  1857*    DISPLAY ' MADE IT TO 0300 '
  1858     IF EIBAID EQUAL DFHPF23
  1859         GO TO 8810-PF23.
  1860     IF EIBAID EQUAL DFHPF24
  1861         GO TO 9200-RETURN-MAIN-MENU.
  1862     IF EIBAID EQUAL DFHPF12
  1863         GO TO 9500-PF12.
  1864     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1865         MOVE ER-0050            TO EMI-ERROR
  1866         GO TO 0320-INPUT-ERROR.
  1867     IF EIBAID EQUAL DFHENTER
  1868         GO TO 0330-EDIT-DATA.
  1869     MOVE ER-0029                    TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  34
* EL1044.cbl
  1870 0320-INPUT-ERROR.
  1871*    DISPLAY ' MADE IT TO 0320 '
  1872     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1873     MOVE AL-UNBON                   TO  PFKEYA.
  1874     MOVE -1                         TO  PFKEYL.
  1875     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  35
* EL1044.cbl
  1877 0330-EDIT-DATA.
  1878     IF NOT DISPLAY-CAP
  1879         MOVE 'READ'                 TO  SM-READ
  1880         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1881         MOVE ER-0070                TO  EMI-ERROR
  1882         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1883         MOVE -1                     TO  MAINTL
  1884         GO TO 8100-SEND-INITIAL-MAP.
  1885     IF MAINTI EQUAL 'S'
  1886        GO TO 1000-SHOW-LETR-RECORD.
  1887     IF MAINTI = 'C' OR 'A'
  1888        IF NOT MODIFY-CAP
  1889           PERFORM 9995-SECURITY-VIOLATION
  1890                                 THRU 9995-EXIT
  1891           MOVE ER-0070          TO EMI-ERROR
  1892           PERFORM 9900-ERROR-FORMAT
  1893                                 THRU 9900-EXIT
  1894           MOVE LOW-VALUES       TO EL1044ZO
  1895           MOVE -1               TO MAINTL
  1896           GO TO 8100-SEND-INITIAL-MAP
  1897        END-IF
  1898     END-IF
  1899     IF MAINTI = 'C'
  1900        GO TO 2000-CHANGE-LETR-RECORD
  1901     END-IF
  1902     IF MAINTI = 'A'
  1903        GO TO 3000-ADD-LETR-RECORD
  1904     END-IF
  1905     MOVE ER-0023                    TO  EMI-ERROR.
  1906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1907     MOVE -1                         TO  MAINTL.
  1908     MOVE AL-UABON                   TO  MAINTA.
  1909     GO TO 8200-SEND-DATAONLY.
  1910 1000-SHOW-LETR-RECORD.
  1911     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1912
  1913* EXEC CICS STARTBR
  1914*        DATASET   (ELLETR-FILE-ID)
  1915*        RIDFLD    (ELLETR-KEY)
  1916*        GTEQ
  1917*        RESP      (WS-RESPONSE)
  1918*    END-EXEC
  1919     MOVE 0
  1920       TO DFHEIV11
  1921*    MOVE '&,         G          &  N#00001871' TO DFHEIV0
  1922     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1924     MOVE X'204E233030303031383731' TO DFHEIV0(25:11)
  1925     CALL 'kxdfhei1' USING DFHEIV0,
  1926           ELLETR-FILE-ID,
  1927           ELLETR-KEY,
  1928           DFHEIV99,
  1929           DFHEIV11,
  1930           DFHEIV99
  1931     MOVE EIBRESP  TO WS-RESPONSE
  1932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1933     IF RESP-NORMAL
  1934        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  36
* EL1044.cbl
  1935           OR WE-FOUND-IT
  1936
  1937* EXEC CICS READNEXT
  1938*              DATASET    (ELLETR-FILE-ID)
  1939*              SET        (ADDRESS OF TEXT-FILES)
  1940*              RIDFLD     (ELLETR-KEY)
  1941*              RESP       (WS-RESPONSE)
  1942*          END-EXEC
  1943     MOVE 0
  1944       TO DFHEIV11
  1945*    MOVE '&.S                   )  N#00001880' TO DFHEIV0
  1946     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1947     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1948     MOVE X'204E233030303031383830' TO DFHEIV0(25:11)
  1949     CALL 'kxdfhei1' USING DFHEIV0,
  1950           ELLETR-FILE-ID,
  1951           DFHEIV20,
  1952           DFHEIV99,
  1953           ELLETR-KEY,
  1954           DFHEIV99,
  1955           DFHEIV11,
  1956           DFHEIV99,
  1957           DFHEIV99
  1958     SET ADDRESS OF TEXT-FILES TO
  1959         DFHEIV20
  1960     MOVE EIBRESP  TO WS-RESPONSE
  1961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1962           IF (RESP-NORMAL)
  1963              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1964              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1965                 SET WE-FOUND-IT   TO TRUE
  1966              END-IF
  1967           ELSE
  1968              SET I-SAY-TO-STOP  TO TRUE
  1969           END-IF
  1970        END-PERFORM
  1971     END-IF
  1972     IF WE-FOUND-IT
  1973        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1974                                    PI-PREV-LETR-KEY
  1975        GO TO 7000-BUILD-OUTPUT-MAP
  1976     END-IF
  1977     MOVE ER-0418                TO EMI-ERROR.
  1978     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1979     MOVE -1                     TO MAINTL
  1980     MOVE 'A'                    TO MAINTI
  1981     MOVE AL-UANON               TO MAINTA
  1982     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1983     MOVE +4                     TO ZLETRL
  1984     MOVE AL-UANON               TO ZLETRA
  1985     GO TO 8100-SEND-INITIAL-MAP
  1986     .
  1987 2000-CHANGE-LETR-RECORD.
  1988*    display ' made it to 2000 '
  1989*    display ' curr   ' pi-curr-letr-key
  1990*    display ' prev   ' pi-prev-letr-key
  1991     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1992        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  37
* EL1044.cbl
  1993        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1994        MOVE -1                  TO MAINTL
  1995        GO TO 8200-SEND-DATAONLY
  1996     END-IF
  1997     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1998     IF NOT EMI-NO-ERRORS
  1999         GO TO 8200-SEND-DATAONLY.
  2000     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  2001     .
  2002 2000-CHANGE-CONTINUE.
  2003
  2004* EXEC CICS READ
  2005*        DATASET    (ELLETR-FILE-ID)
  2006*        SET        (ADDRESS OF TEXT-FILES)
  2007*        RIDFLD     (ELLETR-KEY)
  2008*        UPDATE
  2009*        RESP       (WS-RESPONSE)
  2010*    END-EXEC
  2011*    MOVE '&"S        EU         (  N#00001927' TO DFHEIV0
  2012     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2013     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2014     MOVE X'204E233030303031393237' TO DFHEIV0(25:11)
  2015     CALL 'kxdfhei1' USING DFHEIV0,
  2016           ELLETR-FILE-ID,
  2017           DFHEIV20,
  2018           DFHEIV99,
  2019           ELLETR-KEY,
  2020           DFHEIV99,
  2021           DFHEIV99,
  2022           DFHEIV99
  2023     SET ADDRESS OF TEXT-FILES TO
  2024         DFHEIV20
  2025     MOVE EIBRESP  TO WS-RESPONSE
  2026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2027     IF RESP-NOTFND
  2028        IF ELLETR-SEQ-NO = +0
  2029           GO TO 2000-CONTINUE-CHANGE
  2030        END-IF
  2031     END-IF
  2032     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  2033        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  2034
  2035* EXEC CICS UNLOCK
  2036*            DATASET   (ELLETR-FILE-ID)
  2037*        END-EXEC
  2038*    MOVE '&*                    #   #00001941' TO DFHEIV0
  2039     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2040     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2041     MOVE X'2020233030303031393431' TO DFHEIV0(25:11)
  2042     CALL 'kxdfhei1' USING DFHEIV0,
  2043           ELLETR-FILE-ID,
  2044           DFHEIV99
  2045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2046         MOVE ER-0068                TO  EMI-ERROR
  2047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2048         GO TO 1000-SHOW-LETR-RECORD.
  2049     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2050     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  38
* EL1044.cbl
  2051     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2052     IF ZCOPIESL > +0
  2053        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2054     END-IF
  2055     IF ZFADAYSL > +0
  2056        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2057     END-IF
  2058     IF ZRDAYSL > +0
  2059        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2060     END-IF
  2061     IF ZFORML > +0
  2062        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2063     END-IF
  2064     IF ZPROMPTL > +0
  2065        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2066     END-IF
  2067     IF ZENCCDL > +0
  2068        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2069     END-IF
  2070     IF ZACLOSEL > +0
  2071        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2072     END-IF
  2073     IF ZBENEL > +0
  2074        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2075     END-IF
  2076     IF ZACCTL > +0
  2077        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2078     END-IF
  2079     IF ZTYPEL > +0
  2080        MOVE ZTYPEI              TO W-LETTER-TYPE
  2081     END-IF
  2082     IF ZPRTCRTL > +0
  2083        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2084     END-IF
  2085     IF ZREFREQL > +0
  2086        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2087     END-IF
  2088     IF ZONBASEL > +0
  2089         MOVE ZONBASEI           TO W-ONBASE-CODE
  2090     END-IF
  2091
  2092     IF ZACTSUML > +0
  2093         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2094     END-IF
  2095
  2096     IF ZCSOSUML > +0
  2097         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2098     END-IF
  2099
  2100     IF ZREASONL > +0
  2101        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2102     END-IF
  2103
  2104     IF ZBARCODL > +0
  2105        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2106     END-IF
  2107
  2108     IF ZRETENVL > +0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  39
* EL1044.cbl
  2109        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2110     END-IF
  2111
  2112     IF ZSIGFLGL > +0
  2113        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2114     END-IF
  2115     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2116     .
  2117 2000-CONTINUE-CHANGE.
  2118*    DISPLAY ' ABOUT TO REWRITE '
  2119
  2120* EXEC CICS REWRITE
  2121*        DATASET   (ELLETR-FILE-ID)
  2122*        FROM      (TEXT-FILES)
  2123*    END-EXEC.
  2124     MOVE LENGTH OF
  2125      TEXT-FILES
  2126       TO DFHEIV11
  2127*    MOVE '&& L                  %   #00002017' TO DFHEIV0
  2128     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2129     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2130     MOVE X'2020233030303032303137' TO DFHEIV0(25:11)
  2131     CALL 'kxdfhei1' USING DFHEIV0,
  2132           ELLETR-FILE-ID,
  2133           TEXT-FILES,
  2134           DFHEIV11,
  2135           DFHEIV99
  2136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2137
  2138     MOVE ER-0000                    TO  EMI-ERROR.
  2139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2140     GO TO 1000-SHOW-LETR-RECORD
  2141     .
  2142 3000-ADD-LETR-RECORD.
  2143*    display ' made it to 3000 '
  2144*    display ' curr   ' pi-curr-letr-key
  2145*    display ' prev   ' pi-prev-letr-key
  2146     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2147     .
  2148 3000-CONTINUE-ADD.
  2149     IF NOT EMI-NO-ERRORS
  2150        GO TO 8200-SEND-DATAONLY
  2151     END-IF
  2152     MOVE SPACES                 TO ELLETR-KEY
  2153     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2154     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2155     MOVE +0                     TO ELLETR-SEQ-NO
  2156
  2157* EXEC CICS READ
  2158*        DATASET    (ELLETR-FILE-ID)
  2159*        SET        (ADDRESS OF TEXT-FILES)
  2160*        RIDFLD     (ELLETR-KEY)
  2161*        GTEQ
  2162*        RESP       (WS-RESPONSE)
  2163*    END-EXEC
  2164*    MOVE '&"S        G          (  N#00002039' TO DFHEIV0
  2165     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  40
* EL1044.cbl
  2167     MOVE X'204E233030303032303339' TO DFHEIV0(25:11)
  2168     CALL 'kxdfhei1' USING DFHEIV0,
  2169           ELLETR-FILE-ID,
  2170           DFHEIV20,
  2171           DFHEIV99,
  2172           ELLETR-KEY,
  2173           DFHEIV99,
  2174           DFHEIV99,
  2175           DFHEIV99
  2176     SET ADDRESS OF TEXT-FILES TO
  2177         DFHEIV20
  2178     MOVE EIBRESP  TO WS-RESPONSE
  2179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2180     IF RESP-NORMAL
  2181        IF TX-LETTER-NO = ZLETRI
  2182           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2183              MOVE ER-0132       TO EMI-ERROR
  2184              PERFORM 9900-ERROR-FORMAT
  2185                                 THRU 9900-EXIT
  2186              MOVE -1            TO ZLETRL
  2187              MOVE AL-UABON      TO ZLETRA
  2188              GO TO 8200-SEND-DATAONLY
  2189           ELSE
  2190              MOVE +0            TO WS-SEQ-NO-TO-USE
  2191           END-IF
  2192        ELSE
  2193           MOVE +1               TO WS-SEQ-NO-TO-USE
  2194        END-IF
  2195     ELSE
  2196        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2197     END-IF
  2198
  2199* EXEC CICS GETMAIN
  2200*       SET(ADDRESS OF TEXT-FILES)
  2201*       LENGTH(ELLETR-LENGTH)
  2202*    END-EXEC
  2203*    MOVE '," L                  $   #00002064' TO DFHEIV0
  2204     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2205     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2206     MOVE X'2020233030303032303634' TO DFHEIV0(25:11)
  2207     CALL 'kxdfhei1' USING DFHEIV0,
  2208           DFHEIV20,
  2209           ELLETR-LENGTH,
  2210           DFHEIV99
  2211     SET ADDRESS OF TEXT-FILES TO
  2212         DFHEIV20
  2213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2214     MOVE SPACES                 TO TEXT-FILES
  2215     MOVE 'TL'                   TO TEXT-FILE-ID
  2216     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2217     MOVE ZLETRI                 TO TX-LETTER-NO
  2218     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2219     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2220     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2221     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2222     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2223     IF ZCOPIESL > +0
  2224        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  41
* EL1044.cbl
  2225     ELSE
  2226        MOVE 1                   TO W-NUMBER-OF-COPIES
  2227     END-IF
  2228     IF ZFADAYSL > +0
  2229        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2230     END-IF
  2231     IF ZRDAYSL > +0
  2232        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2233     ELSE
  2234        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2235     END-IF
  2236     IF ZFORML > +0
  2237        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2238     END-IF
  2239     IF ZPROMPTL > +0
  2240        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2241     END-IF
  2242     IF ZENCCDL > +0
  2243        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2244     END-IF
  2245     IF ZACLOSEL > +0
  2246        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2247     END-IF
  2248     IF ZBENEL > +0
  2249        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2250     END-IF
  2251     IF ZACCTL > +0
  2252        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2253     END-IF
  2254     IF ZTYPEL > +0
  2255        MOVE ZTYPEI              TO W-LETTER-TYPE
  2256     END-IF
  2257     IF ZPRTCRTL > +0
  2258        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2259     END-IF
  2260     IF ZREFREQL > +0
  2261        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2262     END-IF
  2263     IF ZONBASEL > +0
  2264        MOVE ZONBASEI            TO W-ONBASE-CODE
  2265     END-IF
  2266
  2267     IF ZACTSUML > +0
  2268         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2269     END-IF
  2270
  2271     IF ZCSOSUML > +0
  2272         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2273     END-IF
  2274
  2275     IF ZREASONL > +0
  2276        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2277     END-IF
  2278
  2279     IF ZBARCODL > +0
  2280        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2281     END-IF
  2282
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  42
* EL1044.cbl
  2283     IF ZRETENVL > +0
  2284        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2285     END-IF
  2286
  2287     IF ZSIGFLGL > +0
  2288        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2289     END-IF
  2290     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2291*    DISPLAY ' ABOUT TO WRITE '
  2292     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2293                                    PI-CURR-LETR-KEY
  2294                                    PI-PREV-LETR-KEY
  2295
  2296* EXEC CICS WRITE
  2297*       DATASET (ELLETR-FILE-ID)
  2298*       FROM    (TEXT-FILES)
  2299*       RIDFLD  (ELLETR-KEY)
  2300*    END-EXEC
  2301     MOVE LENGTH OF
  2302      TEXT-FILES
  2303       TO DFHEIV11
  2304*    MOVE '&$ L                  ''   #00002149' TO DFHEIV0
  2305     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2306     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2307     MOVE X'2020233030303032313439' TO DFHEIV0(25:11)
  2308     CALL 'kxdfhei1' USING DFHEIV0,
  2309           ELLETR-FILE-ID,
  2310           TEXT-FILES,
  2311           DFHEIV11,
  2312           ELLETR-KEY,
  2313           DFHEIV99,
  2314           DFHEIV99
  2315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2316     MOVE ER-0000                    TO  EMI-ERROR.
  2317     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2318     GO TO 1000-SHOW-LETR-RECORD
  2319     .
  2320 5000-FIND-NEXT-PROD-RECORD.
  2321*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2322*
  2323*    EXEC CICS STARTBR
  2324*        DATASET   (ELLETR-FILE-ID)
  2325*        RIDFLD    (ELLETR-KEY)
  2326*        GTEQ
  2327*        RESP      (WS-RESPONSE)
  2328*    END-EXEC
  2329*
  2330*    IF NOT RESP-NORMAL
  2331*       MOVE -1                  TO PFKEYL
  2332*       MOVE ER-0130             TO EMI-ERROR
  2333*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2334*       GO TO 8200-SEND-DATAONLY
  2335*    END-IF
  2336     .
  2337 5000-READNEXT-LOOP.
  2338*    EXEC CICS READNEXT
  2339*        DATASET   (ELLETR-FILE-ID)
  2340*        SET       (ADDRESS OF PRODUCT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  43
* EL1044.cbl
  2341*        RIDFLD    (ELLETR-KEY)
  2342*        RESP      (WS-RESPONSE)
  2343*    END-EXEC
  2344*
  2345*    IF (NOT RESP-NORMAL)
  2346*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2347*       PERFORM 5000-END-BROWSE
  2348*       MOVE -1                  TO PFKEYL
  2349*       MOVE ER-0130             TO EMI-ERROR
  2350*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2351*       GO TO 1000-SHOW-LETR-RECORD
  2352*    END-IF
  2353*
  2354*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2355*       GO TO 5000-READNEXT-LOOP
  2356*    END-IF
  2357*
  2358*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2359*
  2360*    PERFORM 5000-END-BROWSE
  2361*    GO TO 7000-BUILD-OUTPUT-MAP
  2362     .
  2363 5000-END-BROWSE.
  2364*    EXEC CICS ENDBR
  2365*        DATASET   (ELLETR-FILE-ID)
  2366*    END-EXEC
  2367     .
  2368 5100-FIND-PREV-PROD-RECORD.
  2369*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2370*    IF STATEL > +0
  2371*       MOVE STATEI              TO ELLETR-STATE
  2372*    END-IF
  2373*    IF PRODCDL > +0
  2374*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2375*    END-IF
  2376*    IF BENTYPL > +0
  2377*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2378*    IF BENCODEL > +0
  2379*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2380*    IF EXPDTL IS GREATER THAN +0
  2381*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2382*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2383*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2384*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2385*        ELSE
  2386*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2387*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2388*          END-STRING
  2389*           MOVE 'L'                    TO  DC-OPTION-CODE
  2390*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2391*            IF NO-CONVERSION-ERROR
  2392*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2393*            ELSE
  2394*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2395*
  2396*    EXEC CICS HANDLE CONDITION
  2397*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2398*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  44
* EL1044.cbl
  2399*
  2400*    EXEC CICS STARTBR
  2401*        DATASET   (ELLETR-FILE-ID)
  2402*        RIDFLD    (ELLETR-KEY)
  2403*        GTEQ
  2404*    END-EXEC.
  2405 5100-READPREV-LOOP.
  2406*    EXEC CICS READPREV
  2407*        DATASET   (ELLETR-FILE-ID)
  2408*        SET       (ADDRESS OF PRODUCT-MASTER)
  2409*        RIDFLD    (ELLETR-KEY)
  2410*    END-EXEC.
  2411*
  2412*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2413*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2414*
  2415*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2416*        GO TO 5100-READPREV-LOOP.
  2417*
  2418*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2419*
  2420*    GO TO 7000-BUILD-OUTPUT-MAP.
  2421 5100-END-BROWSE.
  2422*    EXEC CICS ENDBR
  2423*        DATASET   (ELLETR-FILE-ID)
  2424*    END-EXEC.
  2425 5100-UNSUCCESSFUL-SEARCH.
  2426     PERFORM 5100-END-BROWSE.
  2427     MOVE ER-0131                    TO  EMI-ERROR.
  2428     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2429     GO TO 1000-SHOW-LETR-RECORD.
  2430     .
  2431 6000-EDIT-INPUT-DATA.
  2432     IF MAINTI = 'A'
  2433        IF ZLETRL > +0
  2434           AND ZLETRI NOT = SPACES
  2435           CONTINUE
  2436        ELSE
  2437           MOVE AL-UNBON         TO ZCOPIESA
  2438           MOVE -1               TO ZCOPIESL
  2439           MOVE ER-0005          TO EMI-ERROR
  2440           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2441        END-IF
  2442     END-IF
  2443     IF ZCOPIESL > +0
  2444        IF ZCOPIESI NUMERIC
  2445           CONTINUE
  2446        ELSE
  2447           MOVE AL-UNBON         TO ZCOPIESA
  2448           MOVE -1               TO ZCOPIESL
  2449           MOVE ER-0184          TO EMI-ERROR
  2450           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2451        END-IF
  2452     END-IF
  2453     IF ZFADAYSL > +0
  2454       IF ZFADAYSI NOT EQUAL SPACES
  2455          IF ZFADAYSI NUMERIC
  2456             CONTINUE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  45
* EL1044.cbl
  2457          ELSE
  2458             MOVE AL-UNBON         TO ZFADAYSA
  2459             MOVE -1               TO ZFADAYSL
  2460             MOVE ER-0491          TO EMI-ERROR
  2461             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2462          END-IF
  2463       END-IF
  2464     END-IF
  2465     IF ZRDAYSL > +0
  2466       IF ZRDAYSI NOT EQUAL SPACES
  2467          IF ZRDAYSI NUMERIC
  2468             CONTINUE
  2469          ELSE
  2470             MOVE AL-UNBON         TO ZRDAYSA
  2471             MOVE -1               TO ZRDAYSL
  2472             MOVE ER-0491          TO EMI-ERROR
  2473             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2474          END-IF
  2475       END-IF
  2476     END-IF
  2477     IF ZPROMPTL > +0
  2478        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2479           CONTINUE
  2480        ELSE
  2481           MOVE AL-UABON         TO ZPROMPTA
  2482           MOVE -1               TO ZPROMPTL
  2483           MOVE ER-0627          TO EMI-ERROR
  2484           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2485        END-IF
  2486     END-IF
  2487     IF MAINTI = 'A'
  2488        AND ZENCCDL <= 0
  2489        MOVE AL-UABON            TO ZENCCDA
  2490        MOVE -1                  TO ZENCCDL
  2491        MOVE ER-1560             TO EMI-ERROR
  2492        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2493     END-IF
  2494     IF ZENCCDL > +0
  2495        IF ZENCCDI = '@'
  2496            CONTINUE
  2497        ELSE
  2498           MOVE SPACES             TO ELENCC-KEY
  2499           MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2500           MOVE '2'                TO ELENCC-REC-TYPE
  2501           MOVE ZENCCDI            TO ELENCC-ENC-CODE
  2502
  2503
  2504* EXEC CICS READ
  2505*              DATASET    (ELENCC-FILE-ID)
  2506*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2507*              RIDFLD     (ELENCC-KEY)
  2508*              RESP       (WS-RESPONSE)
  2509*          END-EXEC
  2510*    MOVE '&"S        E          (  N#00002341' TO DFHEIV0
  2511     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2513     MOVE X'204E233030303032333431' TO DFHEIV0(25:11)
  2514     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  46
* EL1044.cbl
  2515           ELENCC-FILE-ID,
  2516           DFHEIV20,
  2517           DFHEIV99,
  2518           ELENCC-KEY,
  2519           DFHEIV99,
  2520           DFHEIV99,
  2521           DFHEIV99
  2522     SET ADDRESS OF ENCLOSURE-CODES TO
  2523         DFHEIV20
  2524     MOVE EIBRESP  TO WS-RESPONSE
  2525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2526
  2527           IF RESP-NORMAL
  2528              CONTINUE
  2529           ELSE
  2530              MOVE AL-UABON         TO ZENCCDA
  2531              MOVE -1               TO ZENCCDL
  2532              MOVE ER-1560          TO EMI-ERROR
  2533              PERFORM 9900-ERROR-FORMAT
  2534                                 THRU 9900-EXIT
  2535           END-IF
  2536        END-IF
  2537     END-IF
  2538     IF MAINTI = 'A'
  2539        AND ZTYPEL <= 0
  2540        MOVE AL-UABON            TO ZTYPEA
  2541        MOVE -1                  TO ZTYPEL
  2542        MOVE ER-1564             TO EMI-ERROR
  2543        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2544     END-IF
  2545     IF ZTYPEL > +0
  2546        IF ZTYPEI = 'C' OR 'P' OR 'U'
  2547           CONTINUE
  2548        ELSE
  2549           MOVE -1               TO ZTYPEL
  2550           MOVE AL-UABON         TO ZTYPEA
  2551           MOVE ER-1564          TO EMI-ERROR
  2552           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2553        END-IF
  2554     END-IF
  2555     IF ZACLOSEL > +0
  2556        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2557           CONTINUE
  2558        ELSE
  2559           MOVE -1               TO ZACLOSEL
  2560           MOVE AL-UABON         TO ZACLOSEA
  2561           MOVE ER-1562          TO EMI-ERROR
  2562           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2563        END-IF
  2564     END-IF
  2565     IF ZPRTCRTL > +0
  2566        IF ZPRTCRTI = 'Y' OR 'N' OR ' '
  2567           CONTINUE
  2568        ELSE
  2569           MOVE AL-UABON         TO ZPRTCRTA
  2570           MOVE -1               TO ZPRTCRTL
  2571           MOVE ER-0627          TO EMI-ERROR
  2572           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  47
* EL1044.cbl
  2573        END-IF
  2574     END-IF
  2575     IF ZREFREQL > +0
  2576        IF ZREFREQI = 'Y' OR 'N' OR ' '
  2577           CONTINUE
  2578        ELSE
  2579           MOVE AL-UABON         TO ZREFREQA
  2580           MOVE -1               TO ZREFREQL
  2581           MOVE ER-0627          TO EMI-ERROR
  2582           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2583        END-IF
  2584     END-IF
  2585     IF MAINTI = 'A'
  2586        AND ZONBASEL <= 0
  2587        MOVE AL-UABON            TO ZONBASEA
  2588        MOVE -1                  TO ZONBASEL
  2589        MOVE ER-3804             TO EMI-ERROR
  2590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2591     END-IF
  2592     IF ZONBASEL > +0
  2593        IF ZONBASEI = ' '
  2594           MOVE AL-UABON            TO ZONBASEA
  2595           MOVE -1                  TO ZONBASEL
  2596           MOVE ER-3804             TO EMI-ERROR
  2597           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2598        END-IF
  2599     END-IF
  2600
  2601     IF ZACTSUML > +0
  2602        IF ZACTSUMI = '1' OR '2' OR ' '
  2603           CONTINUE
  2604        ELSE
  2605           MOVE AL-UABON         TO ZACTSUMA
  2606           MOVE -1               TO ZACTSUML
  2607           MOVE ER-3820          TO EMI-ERROR
  2608           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2609        END-IF
  2610     END-IF
  2611
  2612     IF ZCSOSUML > +0
  2613        IF ZCSOSUMI = '3' OR '4' OR ' '
  2614           CONTINUE
  2615        ELSE
  2616           MOVE AL-UABON         TO ZCSOSUMA
  2617           MOVE -1               TO ZCSOSUML
  2618           MOVE ER-3821          TO EMI-ERROR
  2619           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2620        END-IF
  2621     END-IF
  2622
  2623     IF ZREASONL > +0
  2624        IF ZREASONI = 'Y' OR 'N' OR ' '
  2625           CONTINUE
  2626        ELSE
  2627           MOVE AL-UABON         TO ZREASONA
  2628           MOVE -1               TO ZREASONL
  2629           MOVE ER-0627          TO EMI-ERROR
  2630           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  48
* EL1044.cbl
  2631        END-IF
  2632     END-IF
  2633
  2634     IF ZBARCODL > +0
  2635        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2636           CONTINUE
  2637        ELSE
  2638           MOVE AL-UABON         TO ZBARCODA
  2639           MOVE -1               TO ZBARCODL
  2640           MOVE ER-0627          TO EMI-ERROR
  2641           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2642        END-IF
  2643     END-IF
  2644
  2645     IF ZRETENVL > +0
  2646        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2647           CONTINUE
  2648        ELSE
  2649           MOVE AL-UABON         TO ZRETENVA
  2650           MOVE -1               TO ZRETENVL
  2651           MOVE ER-0627          TO EMI-ERROR
  2652           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2653        END-IF
  2654     END-IF
  2655
  2656     IF ZSIGFLGL > +0
  2657        IF ZSIGFLGI = 'Y' OR 'N' OR ' '
  2658           CONTINUE
  2659        ELSE
  2660           MOVE AL-UABON         TO ZSIGFLGA
  2661           MOVE -1               TO ZSIGFLGL
  2662           MOVE ER-0627          TO EMI-ERROR
  2663           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2664        END-IF
  2665     END-IF
  2666
  2667     .
  2668 6000-EXIT.
  2669     EXIT.
  2670
  2671
  2672 6500-BUILD-CURRENT-CODES.
  2673      MOVE SPACES             TO ELENCC-KEY
  2674      MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2675      MOVE '2'                TO ELENCC-REC-TYPE
  2676      MOVE LOW-VALUES         TO ELENCC-ENC-CODE
  2677      MOVE SPACES             TO HOLD-ENC-CODES
  2678      MOVE '@'                TO HOLD-ENC-CODES (1:1)
  2679      MOVE HOLD-ENC-CODES     TO PI-ENC-CODES
  2680
  2681
  2682* EXEC CICS STARTBR
  2683*        DATASET   (ELENCC-FILE-ID)
  2684*        RIDFLD    (ELENCC-KEY)
  2685*        GTEQ
  2686*        RESP      (WS-RESPONSE)
  2687*     END-EXEC
  2688     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  49
* EL1044.cbl
  2689       TO DFHEIV11
  2690*    MOVE '&,         G          &  N#00002502' TO DFHEIV0
  2691     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2692     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2693     MOVE X'204E233030303032353032' TO DFHEIV0(25:11)
  2694     CALL 'kxdfhei1' USING DFHEIV0,
  2695           ELENCC-FILE-ID,
  2696           ELENCC-KEY,
  2697           DFHEIV99,
  2698           DFHEIV11,
  2699           DFHEIV99
  2700     MOVE EIBRESP  TO WS-RESPONSE
  2701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2702
  2703      IF RESP-NORMAL
  2704        PERFORM UNTIL DONE-WITH-ENCC
  2705           MOVE PI-ENC-CODES TO HOLD-ENC-CODES
  2706
  2707* EXEC CICS READNEXT
  2708*              DATASET    (ELENCC-FILE-ID)
  2709*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2710*              RIDFLD     (ELENCC-KEY)
  2711*              RESP       (WS-RESPONSE)
  2712*          END-EXEC
  2713     MOVE 0
  2714       TO DFHEIV11
  2715*    MOVE '&.S                   )  N#00002512' TO DFHEIV0
  2716     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2717     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2718     MOVE X'204E233030303032353132' TO DFHEIV0(25:11)
  2719     CALL 'kxdfhei1' USING DFHEIV0,
  2720           ELENCC-FILE-ID,
  2721           DFHEIV20,
  2722           DFHEIV99,
  2723           ELENCC-KEY,
  2724           DFHEIV99,
  2725           DFHEIV11,
  2726           DFHEIV99,
  2727           DFHEIV99
  2728     SET ADDRESS OF ENCLOSURE-CODES TO
  2729         DFHEIV20
  2730     MOVE EIBRESP  TO WS-RESPONSE
  2731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2732           IF (RESP-NORMAL)
  2733              AND (ELENCC-COMPANY-CD = PI-COMPANY-CD)
  2734              AND (ELENCC-REC-TYPE = '2')
  2735                 PERFORM VARYING WS-SUB1 FROM 5 BY -1
  2736                      UNTIL ELENCC-ENC-CODE (WS-SUB1:1) <> ' '
  2737                 END-PERFORM
  2738                 IF WS-SUB1 > 2
  2739                     SUBTRACT +1 FROM WS-SUB1
  2740                 END-IF
  2741                 MOVE ELENCC-ENC-CODE (WS-SUB1:2) TO
  2742                             WS-TEST-STATE
  2743                 IF STATE-SPECIFIC AND
  2744                    ELENCC-ENC-CODE NOT = 'ENV'
  2745                    CONTINUE
  2746                 ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  50
* EL1044.cbl
  2747                    STRING HOLD-ENC-CODES DELIMITED BY ' '
  2748                         ','
  2749                         ELENCC-ENC-CODE DELIMITED BY ' '
  2750                    INTO PI-ENC-CODES
  2751                 END-IF
  2752           ELSE
  2753              SET DONE-WITH-ENCC  TO TRUE
  2754           END-IF
  2755        END-PERFORM
  2756     END-IF
  2757
  2758     MOVE +53 TO PI-SPLIT-SUB
  2759     PERFORM UNTIL PI-ENC-CODES (PI-SPLIT-SUB:1) = ' ' OR ','
  2760         SUBTRACT +1 FROM PI-SPLIT-SUB
  2761     END-PERFORM
  2762
  2763     .
  2764 6500-EXIT.
  2765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  51
* EL1044.cbl
  2767 7000-BUILD-OUTPUT-MAP.
  2768     MOVE LOW-VALUES             TO EL1044ZO
  2769     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2770     MOVE TX-LETTER-NO           TO ZLETRO
  2771     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2772     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2773     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2774     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2775     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2776     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2777     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2778     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2779     MOVE W-LETTER-TO-ACCT       TO ZACCTO
  2780     MOVE W-LETTER-TYPE          TO ZTYPEO
  2781     MOVE W-PRINT-CERTIFICATE    TO ZPRTCRTO
  2782     MOVE W-REFUND-REQUIRED      TO ZREFREQO
  2783     MOVE W-ONBASE-CODE          TO ZONBASEO
  2784     MOVE W-ACCT-SUMM            TO ZACTSUMO
  2785     MOVE W-CSO-SUMM             TO ZCSOSUMO
  2786     MOVE W-REASONS-REQUIRED     TO ZREASONO
  2787     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2788     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2789     MOVE W-SIG-FLAG-DEFAULT     TO ZSIGFLGO
  2790     MOVE PI-SPLIT-SUB           TO WS-SUB1
  2791     COMPUTE WS-SUB2 = PI-SPLIT-SUB + 1
  2792     COMPUTE WS-SUB3 = 120 - PI-SPLIT-SUB
  2793     MOVE PI-ENC-CODES (1:WS-SUB1) TO ZCODES1O
  2794     MOVE PI-ENC-CODES (WS-SUB2:WS-SUB3) TO ZCODES2O
  2795     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2796                                    PI-UPDATE-BY
  2797     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2798                                    DC-BIN-DATE-1
  2799     MOVE ' '                    TO DC-OPTION-CODE
  2800     MOVE +0                     TO DC-ELAPSED-DAYS
  2801                                     DC-ELAPSED-MONTHS.
  2802     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2803     IF NO-CONVERSION-ERROR
  2804        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2805     ELSE
  2806        MOVE LOW-VALUES          TO LSTDTEO
  2807     END-IF
  2808     MOVE -1                     TO MAINTL
  2809     .
  2810 8100-SEND-INITIAL-MAP.
  2811     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2812     MOVE EIBTIME                    TO  TIME-IN.
  2813     MOVE SAVE-DATE                  TO  DATEO.
  2814     MOVE TIME-OUT                   TO  TIMEO
  2815     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2816     MOVE PI-PROCESSOR-ID        TO USERIDO
  2817
  2818* EXEC CICS SEND
  2819*        MAP      (WS-MAP-NAME)
  2820*        MAPSET   (MAPSET-NAME)
  2821*        FROM     (EL1044ZO)
  2822*        ERASE
  2823*        CURSOR
  2824*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  52
* EL1044.cbl
  2825     MOVE LENGTH OF
  2826      EL1044ZO
  2827       TO DFHEIV12
  2828     MOVE -1
  2829       TO DFHEIV11
  2830*    MOVE '8$     CT  E    H L F ,   #00002603' TO DFHEIV0
  2831     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2832     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2833     MOVE X'2020233030303032363033' TO DFHEIV0(25:11)
  2834     CALL 'kxdfhei1' USING DFHEIV0,
  2835           WS-MAP-NAME,
  2836           EL1044ZO,
  2837           DFHEIV12,
  2838           MAPSET-NAME,
  2839           DFHEIV99,
  2840           DFHEIV99,
  2841           DFHEIV99,
  2842           DFHEIV11,
  2843           DFHEIV99,
  2844           DFHEIV99,
  2845           DFHEIV99
  2846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2847
  2848     MOVE '044Z'                 TO PI-CURRENT-SCREEN-NO
  2849     GO TO 9100-RETURN-TRAN
  2850     .
  2851 8200-SEND-DATAONLY.
  2852*    DISPLAY ' MADE IT TO 8200 '
  2853     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2854     MOVE EIBTIME                    TO  TIME-IN.
  2855     MOVE SAVE-DATE                  TO  DATEO.
  2856     MOVE TIME-OUT                   TO  TIMEO.
  2857     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2858     MOVE PI-PROCESSOR-ID        TO USERIDO
  2859
  2860* EXEC CICS SEND
  2861*        MAP      (WS-MAP-NAME)
  2862*        MAPSET   (MAPSET-NAME)
  2863*        FROM     (EL1044ZO)
  2864*        DATAONLY
  2865*        CURSOR
  2866*    END-EXEC.
  2867     MOVE LENGTH OF
  2868      EL1044ZO
  2869       TO DFHEIV12
  2870     MOVE -1
  2871       TO DFHEIV11
  2872*    MOVE '8$D    CT       H L F ,   #00002621' TO DFHEIV0
  2873     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2874     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2875     MOVE X'2020233030303032363231' TO DFHEIV0(25:11)
  2876     CALL 'kxdfhei1' USING DFHEIV0,
  2877           WS-MAP-NAME,
  2878           EL1044ZO,
  2879           DFHEIV12,
  2880           MAPSET-NAME,
  2881           DFHEIV99,
  2882           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  53
* EL1044.cbl
  2883           DFHEIV99,
  2884           DFHEIV11,
  2885           DFHEIV99,
  2886           DFHEIV99,
  2887           DFHEIV99
  2888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2889
  2890     GO TO 9100-RETURN-TRAN
  2891     .
  2892 8300-SEND-TEXT.
  2893
  2894* EXEC CICS SEND TEXT
  2895*        FROM  (LOGOFF-TEXT)
  2896*        LENGTH(LOGOFF-LENGTH)
  2897*        ERASE
  2898*        FREEKB
  2899*    END-EXEC.
  2900*    MOVE '8&      T  E F  H   F -   #00002631' TO DFHEIV0
  2901     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2902     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2903     MOVE X'2020233030303032363331' TO DFHEIV0(25:11)
  2904     CALL 'kxdfhei1' USING DFHEIV0,
  2905           LOGOFF-TEXT,
  2906           LOGOFF-LENGTH,
  2907           DFHEIV99,
  2908           DFHEIV99,
  2909           DFHEIV99,
  2910           DFHEIV99,
  2911           DFHEIV99,
  2912           DFHEIV99,
  2913           DFHEIV99,
  2914           DFHEIV99,
  2915           DFHEIV99,
  2916           DFHEIV99
  2917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2918
  2919
  2920* EXEC CICS RETURN
  2921*        END-EXEC.
  2922*    MOVE '.(                    ''   #00002637' TO DFHEIV0
  2923     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2925     MOVE X'2020233030303032363337' TO DFHEIV0(25:11)
  2926     CALL 'kxdfhei1' USING DFHEIV0,
  2927           DFHEIV99,
  2928           DFHEIV99,
  2929           DFHEIV99,
  2930           DFHEIV99,
  2931           DFHEIV99,
  2932           DFHEIV99
  2933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2934
  2935     .
  2936 8500-DEEDIT.
  2937     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2938                                 TO WS-9V999-OF-DEEDIT
  2939     .
  2940 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  54
* EL1044.cbl
  2941     EXIT.
  2942 8600-DEEDIT.
  2943     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2944                                 TO WS-NUMVAL-OF-DEEDIT
  2945     .
  2946 8600-EXIT.
  2947     EXIT.
  2948 8800-UNAUTHORIZED-ACCESS.
  2949     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2950     GO TO 8300-SEND-TEXT.
  2951 8810-PF23.
  2952     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2953     MOVE XCTL-005                   TO  PGM-NAME.
  2954     GO TO 9300-XCTL.
  2955 8850-DUPREC.
  2956     MOVE ER-0132                    TO  EMI-ERROR.
  2957     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2958     MOVE -1                         TO  MAINTL
  2959     MOVE AL-UABON                   TO  ZLETRA
  2960     GO TO 8100-SEND-INITIAL-MAP.
  2961 8870-NOTOPEN.
  2962     MOVE LOW-VALUES                 TO  EL1044ZO.
  2963     MOVE -1                         TO  MAINTL.
  2964     MOVE ER-0701                    TO  EMI-ERROR.
  2965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2966     GO TO 8100-SEND-INITIAL-MAP.
  2967 8880-NOT-FOUND.
  2968     MOVE ER-0702                    TO  EMI-ERROR.
  2969     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2970     MOVE -1                         TO  MAINTL
  2971     MOVE AL-UABON                   TO  ZLETRA
  2972     GO TO 8100-SEND-INITIAL-MAP.
  2973     .
  2974 9100-RETURN-TRAN.
  2975     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2976
  2977* EXEC CICS RETURN
  2978*        TRANSID    (TRANS-ID)
  2979*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2980*        LENGTH     (PI-COMM-LENGTH)
  2981*    END-EXEC.
  2982*    MOVE '.(CT                  ''   #00002680' TO DFHEIV0
  2983     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2985     MOVE X'2020233030303032363830' TO DFHEIV0(25:11)
  2986     CALL 'kxdfhei1' USING DFHEIV0,
  2987           TRANS-ID,
  2988           PROGRAM-INTERFACE-BLOCK,
  2989           PI-COMM-LENGTH,
  2990           DFHEIV99,
  2991           DFHEIV99,
  2992           DFHEIV99
  2993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2994
  2995 9200-RETURN-MAIN-MENU.
  2996     MOVE XCTL-626                   TO  PGM-NAME.
  2997     GO TO 9300-XCTL.
  2998 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  55
* EL1044.cbl
  2999
  3000* EXEC CICS XCTL
  3001*        PROGRAM    (PGM-NAME)
  3002*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3003*        LENGTH     (PI-COMM-LENGTH)
  3004*    END-EXEC.
  3005*    MOVE '.$C                   %   #00002689' TO DFHEIV0
  3006     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3007     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3008     MOVE X'2020233030303032363839' TO DFHEIV0(25:11)
  3009     CALL 'kxdfhei1' USING DFHEIV0,
  3010           PGM-NAME,
  3011           PROGRAM-INTERFACE-BLOCK,
  3012           PI-COMM-LENGTH,
  3013           DFHEIV99
  3014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3015
  3016 9400-CLEAR.
  3017     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  3018     GO TO 9300-XCTL.
  3019 9500-PF12.
  3020     MOVE XCTL-010                   TO  PGM-NAME.
  3021     GO TO 9300-XCTL.
  3022 9600-PGMID-ERROR.
  3023
  3024* EXEC CICS HANDLE CONDITION
  3025*        PGMIDERR   (8300-SEND-TEXT)
  3026*    END-EXEC.
  3027*    MOVE '"$L                   ! # #00002701' TO DFHEIV0
  3028     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3030     MOVE X'2320233030303032373031' TO DFHEIV0(25:11)
  3031     CALL 'kxdfhei1' USING DFHEIV0
  3032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3033
  3034     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  3035     MOVE ' '                        TO  PI-ENTRY-CD-1.
  3036     MOVE XCTL-005                   TO  PGM-NAME.
  3037     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  3038     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  3039     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  56
* EL1044.cbl
  3041 9700-LINK-DATE-CONVERT.
  3042
  3043* EXEC CICS LINK
  3044*        PROGRAM    ('ELDATCV')
  3045*        COMMAREA   (DATE-CONVERSION-DATA)
  3046*        LENGTH     (DC-COMM-LENGTH)
  3047*    END-EXEC.
  3048     MOVE 'ELDATCV' TO DFHEIV1
  3049*    MOVE '."C                   (   #00002712' TO DFHEIV0
  3050     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3051     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3052     MOVE X'2020233030303032373132' TO DFHEIV0(25:11)
  3053     CALL 'kxdfhei1' USING DFHEIV0,
  3054           DFHEIV1,
  3055           DATE-CONVERSION-DATA,
  3056           DC-COMM-LENGTH,
  3057           DFHEIV99,
  3058           DFHEIV99,
  3059           DFHEIV99,
  3060           DFHEIV99
  3061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3062
  3063 9700-EXIT.
  3064     EXIT.
  3065 9900-ERROR-FORMAT.
  3066     IF NOT EMI-ERRORS-COMPLETE
  3067         MOVE LINK-001               TO  PGM-NAME
  3068
  3069* EXEC CICS LINK
  3070*            PROGRAM    (PGM-NAME)
  3071*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3072*            LENGTH     (EMI-COMM-LENGTH)
  3073*        END-EXEC.
  3074*    MOVE '."C                   (   #00002722' TO DFHEIV0
  3075     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3077     MOVE X'2020233030303032373232' TO DFHEIV0(25:11)
  3078     CALL 'kxdfhei1' USING DFHEIV0,
  3079           PGM-NAME,
  3080           ERROR-MESSAGE-INTERFACE-BLOCK,
  3081           EMI-COMM-LENGTH,
  3082           DFHEIV99,
  3083           DFHEIV99,
  3084           DFHEIV99,
  3085           DFHEIV99
  3086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3087
  3088 9900-EXIT.
  3089     EXIT.
  3090 9990-ABEND.
  3091     MOVE LINK-004                   TO  PGM-NAME.
  3092     MOVE DFHEIBLK                   TO  EMI-LINE1.
  3093
  3094* EXEC CICS LINK
  3095*        PROGRAM   (PGM-NAME)
  3096*        COMMAREA  (EMI-LINE1)
  3097*        LENGTH    (72)
  3098*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  57
* EL1044.cbl
  3099     MOVE 72
  3100       TO DFHEIV11
  3101*    MOVE '."C                   (   #00002732' TO DFHEIV0
  3102     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3103     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3104     MOVE X'2020233030303032373332' TO DFHEIV0(25:11)
  3105     CALL 'kxdfhei1' USING DFHEIV0,
  3106           PGM-NAME,
  3107           EMI-LINE1,
  3108           DFHEIV11,
  3109           DFHEIV99,
  3110           DFHEIV99,
  3111           DFHEIV99,
  3112           DFHEIV99
  3113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3114
  3115     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  58
* EL1044.cbl
  3117 9995-SECURITY-VIOLATION.
  3118*                            COPY ELCSCTP.
  3119******************************************************************
  3120*                                                                *
  3121*                            ELCSCTP                             *
  3122*                            VMOD=2.001                          *
  3123*                                                                *
  3124*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3125******************************************************************
  3126
  3127
  3128     MOVE EIBDATE          TO SM-JUL-DATE.
  3129     MOVE EIBTRMID         TO SM-TERMID.
  3130     MOVE THIS-PGM         TO SM-PGM.
  3131     MOVE EIBTIME          TO TIME-IN.
  3132     MOVE TIME-OUT         TO SM-TIME.
  3133     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3134
  3135
  3136* EXEC CICS LINK
  3137*         PROGRAM  ('EL003')
  3138*         COMMAREA (SECURITY-MESSAGE)
  3139*         LENGTH   (80)
  3140*    END-EXEC.
  3141     MOVE 'EL003' TO DFHEIV1
  3142     MOVE 80
  3143       TO DFHEIV11
  3144*    MOVE '."C                   (   #00002757' TO DFHEIV0
  3145     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3146     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3147     MOVE X'2020233030303032373537' TO DFHEIV0(25:11)
  3148     CALL 'kxdfhei1' USING DFHEIV0,
  3149           DFHEIV1,
  3150           SECURITY-MESSAGE,
  3151           DFHEIV11,
  3152           DFHEIV99,
  3153           DFHEIV99,
  3154           DFHEIV99,
  3155           DFHEIV99
  3156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3157
  3158
  3159******************************************************************
  3160
  3161 9995-EXIT.
  3162     EXIT.
  3163
  3164 9999-DFHBACK SECTION.
  3165     MOVE '9%                    "   ' TO DFHEIV0
  3166     MOVE 'EL1044' TO DFHEIV1
  3167     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3168     GOBACK.
  3169 9999-DFHEXIT.
  3170     IF DFHEIGDJ EQUAL 0001
  3171         NEXT SENTENCE
  3172     ELSE IF DFHEIGDJ EQUAL 2
  3173         GO TO 8850-DUPREC,
  3174               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:52 Page  59
* EL1044.cbl
  3175               8880-NOT-FOUND,
  3176               9600-PGMID-ERROR,
  3177               9990-ABEND
  3178         DEPENDING ON DFHEIGDI
  3179     ELSE IF DFHEIGDJ EQUAL 3
  3180         GO TO 8300-SEND-TEXT
  3181         DEPENDING ON DFHEIGDI.
  3182     MOVE '9%                    "   ' TO DFHEIV0
  3183     MOVE 'EL1044' TO DFHEIV1
  3184     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3185     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4964     Code:        8629
