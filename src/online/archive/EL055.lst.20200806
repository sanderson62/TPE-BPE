* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   1
* EL055.cbl
* Options: int("EL055.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL055.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL055.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL055.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 identification division.
     2 program-id. EL055.
     3******************************************************************
     4*                   C H A N G E   L O G
     5*
     6* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     7*-----------------------------------------------------------------
     8*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
     9* EFFECTIVE    NUMBER
    10*-----------------------------------------------------------------
    11* 052020  CR2019111300001  PEMA  New program for 'K' transaction
    12* 072320  IR2020072100002  PEMA  Allow deletion of dup pend issue
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   2
* EL055.cbl
    14 environment division.
    15 data division.
    16 working-storage section.
    17 01  DFH-START PIC X(04).
    18 77  s1                          pic s999 comp-3 value +0.
    19 77  ns1                         pic s9(5) comp-3 value +0.
    20 77  nscntr                      pic s999 comp-3 value +0.
    21 77  ws-eof-sw                   pic x  value spaces.
    22     88  end-of-input                  value 'Y'.
    23 77  ws-error-sw                 pic x  value spaces.
    24     88  error-found               value 'Y'.
    25 77  ws-string-len               pic s999 comp-3 value zeros.
    26 77  ws-startbr-ind              pic x value spaces.
    27 77  ws-NS-startbr-ind           pic x value spaces.
    28 77  ws-bypass-ind               pic x value spaces.
    29     88  bypass-copy-files         value 'Y'.
    30 01  P pointer.
    31 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    32 01  var-ptr pointer.
    33 01  env-var-len                 pic 9(4)  binary.
    34 01  rc                          pic 9(9)  binary.
    35 01  ws-new-greg-eff-date        pic x(10).
    36 01  ws-old-greg-eff-date        pic x(10).
    37 01  WS-KIXSYS.
    38     05  WS-KIX-FIL1             PIC X(10).
    39     05  WS-KIX-APPS             PIC X(10).
    40     05  WS-KIX-ENV              PIC X(10).
    41     05  WS-KIX-MYENV            PIC X(10).
    42     05  WS-KIX-SYS              PIC X(10).
    43*                                copy ERCPNDB.
    44******************************************************************
    45*                                                                *
    46*                                                                *
    47*                            ERCPNDB.                            *
    48*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    49*                            VMOD=2.025                          *
    50*                                                                *
    51*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
    52*                                                                *
    53******************************************************************
    54*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
    55*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
    56******************************************************************
    57*                                                                *
    58*                                                                *
    59*   FILE TYPE = VSAM,KSDS                                        *
    60*   RECORD SIZE = 585  RECFORM = FIXED                           *
    61*                                                                *
    62*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
    63*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
    64*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
    65*                                                 RKP=13,LEN=36  *
    66*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
    67*                                      AND CHG-SEQ.)             *
    68*                                                RKP=49,LEN=11   *
    69*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
    70*                                      AND CHG-SEQ.)             *
    71*                                                RKP=60,LEN=15   *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   3
* EL055.cbl
    72*                                                                *
    73*   LOG = NO                                                     *
    74*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    75******************************************************************
    76******************************************************************
    77*                   C H A N G E   L O G
    78*
    79* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    80*-----------------------------------------------------------------
    81*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    82* EFFECTIVE    NUMBER
    83*-----------------------------------------------------------------
    84* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    85* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
    86* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    87* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    88* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
    89* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    90* 032306                   PEMA  ADD BOW LOAN NUMBER
    91* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
    92* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    93* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    94* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    95* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
    96* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
    97* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    98* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    99* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   100* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   101* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
   102* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   103* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
   104******************************************************************
   105
   106 01  PENDING-BUSINESS.
   107     12  PB-RECORD-ID                     PIC XX.
   108         88  VALID-PB-ID                        VALUE 'PB'.
   109
   110     12  PB-CONTROL-PRIMARY.
   111         16  PB-COMPANY-CD                PIC X.
   112         16  PB-ENTRY-BATCH               PIC X(6).
   113         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   114         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   115
   116     12  PB-CONTROL-BY-ACCOUNT.
   117         16  PB-COMPANY-CD-A1             PIC X.
   118         16  PB-CARRIER                   PIC X.
   119         16  PB-GROUPING.
   120             20  PB-GROUPING-PREFIX       PIC XXX.
   121             20  PB-GROUPING-PRIME        PIC XXX.
   122         16  PB-STATE                     PIC XX.
   123         16  PB-ACCOUNT.
   124             20  PB-ACCOUNT-PREFIX        PIC X(4).
   125             20  PB-ACCOUNT-PRIME         PIC X(6).
   126         16  PB-CERT-EFF-DT               PIC XX.
   127         16  PB-CERT-NO.
   128             20  PB-CERT-PRIME            PIC X(10).
   129             20  PB-CERT-SFX              PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   4
* EL055.cbl
   130         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   131
   132         16  PB-RECORD-TYPE               PIC X.
   133             88  PB-MAILING-DATA                VALUE '0'.
   134             88  PB-ISSUE                       VALUE '1'.
   135             88  PB-CANCELLATION                VALUE '2'.
   136             88  PB-BATCH-TRAILER               VALUE '9'.
   137
   138     12  PB-CONTROL-BY-ORIG-BATCH.
   139         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   140         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   141         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   142         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   143
   144     12  PB-CONTROL-BY-CSR.
   145         16  PB-CSR-COMPANY-CD            PIC X.
   146         16  PB-CSR-ID                    PIC X(4).
   147         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   148         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   149         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   150******************************************************************
   151*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   152******************************************************************
   153
   154     12  PB-LAST-MAINT-DT                 PIC XX.
   155     12  PB-LAST-MAINT-BY                 PIC X(4).
   156     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   157
   158     12  PB-RECORD-BODY                   PIC X(375).
   159
   160     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   161         16  PB-CERT-ORIGIN               PIC X.
   162             88  CLASIC-CREATED-CERT         VALUE '1'.
   163         16  PB-I-NAME.
   164             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   165             20  PB-I-INSURED-FIRST-NAME.
   166                 24  PB-I-INSURED-1ST-INIT PIC X.
   167                 24  FILLER                PIC X(9).
   168             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   169         16  PB-I-AGE                     PIC S99   COMP-3.
   170         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   171         16  PB-I-BIRTHDAY                PIC XX.
   172         16  PB-I-INSURED-SEX             PIC X.
   173             88  PB-SEX-MALE     VALUE 'M'.
   174             88  PB-SEX-FEMALE   VALUE 'F'.
   175
   176         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   177         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   178         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   179         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   180         16  PB-I-SKIP-CODE               PIC X.
   181             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   182             88  PB-SKIP-JULY              VALUE '1'.
   183             88  PB-SKIP-AUGUST            VALUE '2'.
   184             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   185             88  PB-SKIP-JULY-AUG          VALUE '4'.
   186             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   187             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   5
* EL055.cbl
   188             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   189             88  PB-SKIP-JUNE              VALUE '8'.
   190             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   191             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   192             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   193         16  PB-I-TERM-TYPE               PIC X.
   194             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   195             88  PB-PAID-WEEKLY            VALUE 'W'.
   196             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   197             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   198             88  PB-PAID-13-YEARLY         VALUE 'T'.
   199         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   200         16  PB-I-POLICY-FORM-NO          PIC X(12).
   201         16  PB-I-DATA-ENTRY-SW           PIC X.
   202             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   203             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   204             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   205             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   206         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   207         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   208*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   209         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   210         16  PB-I-LETTER-REQD             PIC X.
   211
   212         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   213             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   214             88  PB-INVALID-LIFE             VALUE '  ' '00'
   215                                                   '90' THRU '99'.
   216         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   217                                          PIC XX.
   218         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   219         16  PB-I-AMOUNT-FINANCED REDEFINES
   220                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   221         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   222         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   223                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   224         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   225         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   226         16  PB-I-CLP-AMOUNT REDEFINES
   227                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   228         16  PB-I-LF-CALC-FLAG            PIC X.
   229             88 PB-COMP-LF-PREM               VALUE '?'.
   230         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   231         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   232         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   233         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   234         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   235         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   236         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   237         16  PB-I-LF-ABBR                 PIC XXX.
   238         16  PB-I-LF-INPUT-CD             PIC XX.
   239
   240         16  PB-I-AH-BENEFIT-CD           PIC XX.
   241             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   242             88  PB-INVALID-AH               VALUE '  ' '00'
   243                                                   '90' THRU '99'.
   244         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   245         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   6
* EL055.cbl
   246         16  PB-I-AH-CALC-FLAG            PIC X.
   247             88 PB-COMP-AH-PREM                  VALUE '?'.
   248         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   249         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   250         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
   251         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   252         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   253         16  PB-I-AH-ABBR                 PIC XXX.
   254         16  PB-I-AH-INPUT-CD             PIC XXX.
   255
   256         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   257         16  PB-I-REIN-TABLE              PIC XXX.
   258         16  PB-I-BUSINESS-TYPE           PIC 99.
   259         16  PB-I-INDV-GRP-CD             PIC X.
   260         16  PB-I-MORT-CODE.
   261             20  PB-I-TABLE               PIC X.
   262             20  PB-I-INTEREST            PIC XX.
   263             20  PB-I-MORT-TYP            PIC X.
   264         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   265         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   266         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   267         16  PB-I-INDV-GRP-OVRD           PIC X.
   268         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   269         16  PB-I-SIG-SW                  PIC X.
   270             88  PB-POLICY-SIGNED             VALUE 'Y'.
   271         16  PB-I-RATE-CLASS              PIC XX.
   272         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   273         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   274         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   275         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   276         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   277         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   278         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   279         16  PB-I-BENEFIT-TYPE            PIC XXX.
   280         16  PB-I-OB-FLAG                 PIC X.
   281             88  PB-I-OB                      VALUE 'B'.
   282             88  PB-I-SUMMARY                 VALUE 'Z'.
   283         16  PB-I-ENTRY-STATUS            PIC X.
   284             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   285                                              'M' '5' '9' '2'.
   286             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   287             88  PB-I-POLICY-PENDING          VALUE '2'.
   288             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   289             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   290             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
   291             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   292             88  PB-I-REIN-ONLY               VALUE '9'.
   293             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   294             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   295             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   296             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   297         16  PB-I-INT-CODE                PIC X.
   298             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   299             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   300         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   301         16  PB-I-SOC-SEC-NO              PIC X(11).
   302         16  PB-I-MEMBER-NO               PIC X(12).
   303         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   7
* EL055.cbl
   304*        16  PB-I-LOAN-OFFICER            PIC XXX.
   305         16  PB-I-OLD-LOF                 PIC XXX.
   306         16  PB-I-LF-EXPIRE-DT            PIC XX.
   307         16  PB-I-AH-EXPIRE-DT            PIC XX.
   308         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   309         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   310         16  PB-I-LIFE-INDICATOR          PIC X.
   311             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   312         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   313         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
   314                                          PIC S9(5)V99    COMP-3.
   315         16  PB-I-MAIL-ADDRS-SW           PIC X.
   316             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   317             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   318         16  PB-I-1ST-PMT-DT              PIC XX.
   319         16  PB-I-JOINT-INSURED.
   320             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   321             20 PB-I-JOINT-FIRST-NAME.
   322                24  PB-I-JOINT-FIRST-INIT PIC X.
   323                24  FILLER                PIC X(9).
   324             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   325*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   326         16  PB-I-BENEFICIARY-NAME.
   327             20  PB-I-BANK-NUMBER         PIC X(10).
   328             20  FILLER                   PIC X(15).
   329         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   330         16  PB-I-REFERENCE               PIC X(12).
   331         16  FILLER REDEFINES PB-I-REFERENCE.
   332             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   333             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   334             20  PB-I-CLP-STATE           PIC XX.
   335         16  PB-I-UNDERWRITING-STATUS     PIC X.
   336             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   337             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   338             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   339         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   340         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   341         16  PB-I-RESIDENT-STATE          PIC XX.
   342         16  PB-I-RATE-CODE               PIC X(4).
   343         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   344         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   345         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   346         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   347         16  PB-I-BANK-NOCHRGB            PIC 99.
   348         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   349         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   350
   351     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   352         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   353             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   354         16  PB-C-CANCEL-ORIGIN           PIC X.
   355             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   356         16  PB-C-LF-CANCEL-DT            PIC XX.
   357         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   358         16  PB-C-LF-CALC-REQ             PIC X.
   359             88 PB-COMP-LF-CANCEL            VALUE '?'.
   360         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   361         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   8
* EL055.cbl
   362         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   363             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   364         16  PB-C-AH-CANCEL-DT            PIC XX.
   365         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   366         16  PB-C-AH-CALC-REQ             PIC X.
   367             88 PB-COMP-AH-CANCEL            VALUE '?'.
   368         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   369         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   370         16  PB-C-LAST-NAME               PIC X(15).
   371         16  PB-C-REFUND-SW               PIC X.
   372             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   373             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   374         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   375         16  PB-C-PAYEE-CODE              PIC X(6).
   376         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   377         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   378         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   379         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   380         16  PB-C-REFERENCE               PIC X(12).
   381         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   382         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   383         16  PB-C-POST-CARD-IND           PIC X.
   384         16  PB-C-CANCEL-REASON           PIC X.
   385         16  PB-C-REF-INTERFACE-SW        PIC X.
   386         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   387         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   388         16  FILLER                       PIC X(01).
   389*        16  FILLER                       PIC X(18).
   390         16  PB-C-POLICY-FORM-NO          PIC X(12).
   391*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   392         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
   393         16  PB-CANCELED-CERT-DATA.
   394             20  PB-CI-INSURED-NAME.
   395                 24  PB-CI-LAST-NAME      PIC X(15).
   396                 24  PB-CI-INITIALS       PIC XX.
   397             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   398             20  PB-CI-INSURED-SEX        PIC X.
   399             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   400             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   401             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   402             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   403             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   404             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   405             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   406             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   407             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   408             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   409             20  PB-CI-RATE-CLASS         PIC XX.
   410             20  PB-CI-RATE-DEV-LF        PIC XXX.
   411             20  PB-CI-RATE-DEV-AH        PIC XXX.
   412             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   413             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   414             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   415             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   416             20  PB-CI-LF-ABBR            PIC X(3).
   417             20  PB-CI-AH-ABBR            PIC X(3).
   418             20  PB-CI-OB-FLAG            PIC X.
   419                 88  PB-CI-OB                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page   9
* EL055.cbl
   420             20  PB-CI-LF-POLICY-STATUS   PIC X.
   421                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   422                                           'M' '4' '5' '9' '2'.
   423                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   424                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   425                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   426                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   427                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   428                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
   429                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   430                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   431                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   432                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   433                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   434                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   435                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   436             20  PB-CI-AH-POLICY-STATUS   PIC X.
   437                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   438                                           'M' '4' '5' '9' '2'.
   439                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   440                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   441                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   442                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   443                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   444                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
   445                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   446                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   447                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   448                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   449                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   450                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   451                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   452             20  PB-CI-PAY-FREQUENCY      PIC 99.
   453             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   454             20  PB-CI-SOC-SEC-NO         PIC X(11).
   455             20  PB-CI-MEMBER-NO          PIC X(12).
   456             20  PB-CI-INT-CODE           PIC X.
   457                 88  PB-CI-ADD-ON                  VALUE 'A'.
   458                 88  PB-CI-SIMPLE                  VALUE 'S'.
   459             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   460             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   461             20  PB-CI-COMP-EXCP-SW       PIC X.
   462                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   463                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   464             20  PB-CI-ENTRY-STATUS       PIC X.
   465             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   466             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   467             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   468             20  PB-CI-DEATH-DT           PIC XX.
   469             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   470             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   471             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   472             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   473             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   474             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   475             20  PB-CI-ENTRY-DT              PIC XX.
   476             20  PB-CI-ENTRY-BATCH           PIC X(6).
   477             20  PB-CI-LF-EXPIRE-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  10
* EL055.cbl
   478             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   479             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   480             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   481             20  PB-CI-OLD-LOF               PIC XXX.
   482*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   483             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   484             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   485             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   486             20  PB-CI-INDV-GRP-CD           PIC X.
   487             20  PB-CI-BENEFICIARY-NAME.
   488                 24  PB-CI-BANK-NUMBER       PIC X(10).
   489                 24  FILLER                  PIC X(15).
   490             20  PB-CI-NOTE-SW               PIC X.
   491             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   492             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   493             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   494             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   495             20  PB-CI-LOAN-OFFICER          PIC X(5).
   496             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   497             20  PB-CI-FIRST-NAME            PIC X(10).
   498             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   499
   500         16  FILLER                       PIC X(13).
   501*032306  16  FILLER                       PIC X(27).
   502*        16  FILLER                       PIC X(46).
   503
   504     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   505         16  FILLER                       PIC X(10).
   506         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   507         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   508         16  PB-M-INSURED-MID-INIT        PIC X.
   509         16  PB-M-INSURED-AGE             PIC 99.
   510         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   511         16  PB-M-INSURED-SEX             PIC X.
   512         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   513         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   514         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   515         16  PB-M-INSURED-CITY-STATE.
   516             20  PB-M-INSURED-CITY        PIC X(28).
   517             20  PB-M-INSURED-STATE       PIC XX.
   518         16  PB-M-INSURED-ZIP-CODE.
   519             20  PB-M-INSURED-ZIP-PRIME.
   520                 24  PB-M-INSURED-ZIP-1   PIC X.
   521                     88  PB-M-CANADIAN-POST-CODE
   522                                             VALUE 'A' THRU 'Z'.
   523                 24  FILLER               PIC X(4).
   524             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   525         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   526                                        PB-M-INSURED-ZIP-CODE.
   527             20  PM-M-INS-CAN-POST1       PIC XXX.
   528             20  PM-M-INS-CAN-POST2       PIC XXX.
   529             20  FILLER                   PIC XXX.
   530         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   531         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   532         16  PB-M-CRED-BENE-NAME          PIC X(30).
   533         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   534         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   535         16  PB-M-CRED-BENE-CITYST.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  11
* EL055.cbl
   536             20  PB-M-CRED-BENE-CITY      PIC X(28).
   537             20  PB-M-CRED-BENE-STATE     PIC XX.
   538         16  FILLER                       PIC X(92).
   539
   540     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   541         16  FILLER                       PIC X(10).
   542         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   543         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   544         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   545         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   546         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   547         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   548         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   549         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   550         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   551         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   552         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   553         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   554         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   555         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   556         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   557         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   558         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   559         16  PB-ACCOUNT-NAME              PIC X(30).
   560         16  PB-PREM-REF-RPT-FLAG         PIC X.
   561         16  PB-REFERENCE                 PIC X(12).
   562         16  PB-B-RECEIVED-DT             PIC XX.
   563         16  FILLER                       PIC X(234).
   564
   565     12  PB-RECORD-STATUS.
   566         16  PB-CREDIT-SELECT-DT          PIC XX.
   567         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   568         16  PB-BILLED-DT                 PIC XX.
   569         16  PB-BILLING-STATUS            PIC X.
   570             88  PB-ENTRY-REVERSED            VALUE 'R'.
   571             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   572             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   573         16  PB-RECORD-BILL               PIC X.
   574             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   575             88  PB-RECORD-RETURNED           VALUE 'R'.
   576             88  PB-RECORD-ENDORSED           VALUE 'E'.
   577             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   578             88  PB-OVERRIDE-AH               VALUE 'A'.
   579             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   580         16  PB-BATCH-ENTRY               PIC X.
   581             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   582             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   583             88  PB-REISSUED-CERT             VALUE 'E'.
   584             88  PB-CASH-CERT                 VALUE 'C'.
   585             88  PB-MONTHLY-CERT              VALUE 'M'.
   586             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   587             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   588             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   589         16  PB-FORCE-CODE                PIC X.
   590             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   591             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   592             88  PB-CANCEL-FORCE              VALUE '8'.
   593             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  12
* EL055.cbl
   594             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   595             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   596             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   597             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   598             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   599             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
   600             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   601         16  PB-FATAL-FLAG                PIC X.
   602             88  PB-FATAL-ERRORS              VALUE 'X'.
   603         16  PB-FORCE-ER-CD               PIC X.
   604             88  PB-FORCE-ERRORS              VALUE 'F'.
   605             88  PB-UNFORCED-ERRORS           VALUE 'X'.
   606         16  PB-WARN-ER-CD                PIC X.
   607             88  PB-WARNING-ERRORS            VALUE 'W'.
   608         16  FILLER                       PIC X.
   609         16  PB-OUT-BAL-CD                PIC X.
   610             88  PB-OUT-OF-BAL                VALUE 'O'.
   611         16  PB-LIFE-OVERRIDE-L1          PIC X.
   612         16  PB-AH-OVERRIDE-L1            PIC X.
   613         16  PB-INPUT-DT                  PIC XX.
   614         16  PB-INPUT-BY                  PIC X(4).
   615         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
   616         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
   617         16  PB-TOLERANCE-REJECT-SW       PIC X.
   618         16  PB-LF-EARNING-METHOD         PIC X.
   619         16  PB-AH-EARNING-METHOD         PIC X.
   620         16  PB-LF-TERM-CALC-METHOD       PIC X.
   621         16  PB-AH-TERM-CALC-METHOD       PIC X.
   622         16  PB-REIN-CD                   PIC XXX.
   623         16  PB-LF-REFUND-TYPE            PIC X.
   624         16  PB-AH-REFUND-TYPE            PIC X.
   625         16  PB-ACCT-EFF-DT               PIC XX.
   626         16  PB-ACCT-EXP-DT               PIC XX.
   627         16  PB-COMPANY-ID                PIC X(3).
   628         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   629         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   630         16  PB-SV-CARRIER                PIC X.
   631         16  PB-SV-GROUPING               PIC X(6).
   632         16  PB-SV-STATE                  PIC XX.
   633         16  PB-CONFIRMATION-REPT-DT      PIC XX.
   634         16  PB-GA-BILLING-INFO.
   635             20  PB-GA-BILL-DT OCCURS 5 TIMES
   636                                          PIC XX.
   637         16  PB-SV-REMIT-TO  REDEFINES
   638             PB-GA-BILLING-INFO           PIC X(10).
   639         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
   640         16  PB-I-LOAN-OFFICER            PIC X(5).
   641         16  PB-I-VIN                     PIC X(17).
   642
   643         16  FILLER                       PIC X(04).
   644         16  IMNET-BYPASS-SW              PIC X.
   645
   646******************************************************************
   647*                COMMON EDIT ERRORS                              *
   648******************************************************************
   649
   650     12  PB-COMMON-ERRORS.
   651         16  PB-COMMON-ERROR    OCCURS 10 TIMES
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  13
* EL055.cbl
   652                                           PIC S9(4)     COMP.
   653
   654******************************************************************
   655*                                copy ELCCERT.
   656******************************************************************
   657*                                                                *
   658*                            ELCCERT.                            *
   659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   660*                            VMOD=2.013                          *
   661*                                                                *
   662*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   663*                                                                *
   664*   FILE TYPE = VSAM,KSDS                                        *
   665*   RECORD SIZE = 450  RECFORM = FIXED                           *
   666*                                                                *
   667*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   668*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   669*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   670*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   671*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   672*                                                                *
   673*   LOG = YES                                                    *
   674*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   675******************************************************************
   676*                   C H A N G E   L O G
   677*
   678* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   679*-----------------------------------------------------------------
   680*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   681* EFFECTIVE    NUMBER
   682*-----------------------------------------------------------------
   683* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   684* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   685* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   686* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   687* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   688* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   689* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   690* 032612  CR2011110200001  PEMA  AHL CHANGES
   691* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   692* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   693* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   694******************************************************************
   695
   696 01  CERTIFICATE-MASTER.
   697     12  CM-RECORD-ID                      PIC XX.
   698         88  VALID-CM-ID                      VALUE 'CM'.
   699
   700     12  CM-CONTROL-PRIMARY.
   701         16  CM-COMPANY-CD                 PIC X.
   702         16  CM-CARRIER                    PIC X.
   703         16  CM-GROUPING.
   704             20  CM-GROUPING-PREFIX        PIC X(3).
   705             20  CM-GROUPING-PRIME         PIC X(3).
   706         16  CM-STATE                      PIC XX.
   707         16  CM-ACCOUNT.
   708             20  CM-ACCOUNT-PREFIX         PIC X(4).
   709             20  CM-ACCOUNT-PRIME          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  14
* EL055.cbl
   710         16  CM-CERT-EFF-DT                PIC XX.
   711         16  CM-CERT-NO.
   712             20  CM-CERT-PRIME             PIC X(10).
   713             20  CM-CERT-SFX               PIC X.
   714
   715     12  CM-CONTROL-BY-NAME.
   716         16  CM-COMPANY-CD-A1              PIC X.
   717         16  CM-INSURED-LAST-NAME          PIC X(15).
   718         16  CM-INSURED-INITIALS.
   719             20  CM-INSURED-INITIAL1       PIC X.
   720             20  CM-INSURED-INITIAL2       PIC X.
   721
   722     12  CM-CONTROL-BY-SSN.
   723         16  CM-COMPANY-CD-A2              PIC X.
   724         16  CM-SOC-SEC-NO.
   725             20  CM-SSN-STATE              PIC XX.
   726             20  CM-SSN-ACCOUNT            PIC X(6).
   727             20  CM-SSN-LN3.
   728                 25  CM-INSURED-INITIALS-A2.
   729                     30 CM-INSURED-INITIAL1-A2   PIC X.
   730                     30 CM-INSURED-INITIAL2-A2   PIC X.
   731                 25 CM-PART-LAST-NAME-A2         PIC X.
   732
   733     12  CM-CONTROL-BY-CERT-NO.
   734         16  CM-COMPANY-CD-A4              PIC X.
   735         16  CM-CERT-NO-A4                 PIC X(11).
   736
   737     12  CM-CONTROL-BY-MEMB.
   738         16  CM-COMPANY-CD-A5              PIC X.
   739         16  CM-MEMBER-NO.
   740             20  CM-MEMB-STATE             PIC XX.
   741             20  CM-MEMB-ACCOUNT           PIC X(6).
   742             20  CM-MEMB-LN4.
   743                 25  CM-INSURED-INITIALS-A5.
   744                     30 CM-INSURED-INITIAL1-A5   PIC X.
   745                     30 CM-INSURED-INITIAL2-A5   PIC X.
   746                 25 CM-PART-LAST-NAME-A5         PIC XX.
   747
   748     12  CM-INSURED-PROFILE-DATA.
   749         16  CM-INSURED-FIRST-NAME.
   750             20  CM-INSURED-1ST-INIT       PIC X.
   751             20  FILLER                    PIC X(9).
   752         16  CM-INSURED-ISSUE-AGE          PIC 99.
   753         16  CM-INSURED-SEX                PIC X.
   754             88  CM-SEX-MALE                  VALUE 'M'.
   755             88  CM-SEX-FEMAL                 VALUE 'F'.
   756         16  CM-INSURED-JOINT-AGE          PIC 99.
   757         16  CM-JOINT-INSURED-NAME.
   758             20  CM-JT-LAST-NAME           PIC X(15).
   759             20  CM-JT-FIRST-NAME.
   760                 24  CM-JT-1ST-INIT        PIC X.
   761                 24  FILLER                PIC X(9).
   762             20  CM-JT-INITIAL             PIC X.
   763
   764     12  CM-LIFE-DATA.
   765         16  CM-LF-BENEFIT-CD              PIC XX.
   766         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   767         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  15
* EL055.cbl
   768         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   769         16  CM-LF-DEV-CODE                PIC XXX.
   770         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   771         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   772         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   773         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   774         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   775         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   776         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   777         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   778         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   779         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   780         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   781         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   782         16  cm-temp-epiq                  pic xx.
   783             88  EPIQ-CLASS                  value 'EQ'.
   784*        16  FILLER                        PIC XX.
   785
   786     12  CM-AH-DATA.
   787         16  CM-AH-BENEFIT-CD              PIC XX.
   788         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   789         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   790         16  CM-AH-DEV-CODE                PIC XXX.
   791         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   792         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   793         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   794         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   795         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   796         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   797         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   798         16  CM-AH-PAID-THRU-DT            PIC XX.
   799             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   800         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   801         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   802         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   803         16  FILLER                        PIC X.
   804
   805     12  CM-LOAN-INFORMATION.
   806         16  CM-LIVES                      PIC S9(7)     COMP-3.
   807         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   808                                           PIC S9(5)V99  COMP-3.
   809         16  CM-BILLED                     PIC S9(7)     COMP-3.
   810         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   811         16  CM-PAY-FREQUENCY              PIC S99.
   812         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   813         16  CM-RATE-CLASS                 PIC XX.
   814         16  CM-BENEFICIARY                PIC X(25).
   815         16  CM-POLICY-FORM-NO             PIC X(12).
   816         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   817         16  CM-LAST-ADD-ON-DT             PIC XX.
   818         16  CM-DEDUCTIBLE-AMOUNTS.
   819             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   820             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   821         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   822             20  CM-RESIDENT-STATE         PIC XX.
   823             20  CM-RATE-CODE              PIC X(4).
   824             20  FILLER                    PIC XX.
   825         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  16
* EL055.cbl
   826             20  CM-LOAN-OFFICER           PIC X(5).
   827             20  FILLER                    PIC XXX.
   828         16  CM-CSR-CODE                   PIC XXX.
   829         16  CM-UNDERWRITING-CODE          PIC X.
   830             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   831         16  CM-POST-CARD-IND              PIC X.
   832         16  CM-REF-INTERFACE-SW           PIC X.
   833         16  CM-PREMIUM-TYPE               PIC X.
   834             88  CM-SING-PRM                  VALUE '1'.
   835             88  CM-O-B-COVERAGE              VALUE '2'.
   836             88  CM-OPEN-END                  VALUE '3'.
   837         16  CM-IND-GRP-TYPE               PIC X.
   838             88  CM-INDIVIDUAL                VALUE 'I'.
   839             88  CM-GROUP                     VALUE 'G'.
   840         16  CM-SKIP-CODE                  PIC X.
   841             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   842             88  SKIP-JULY                    VALUE '1'.
   843             88  SKIP-AUGUST                  VALUE '2'.
   844             88  SKIP-SEPTEMBER               VALUE '3'.
   845             88  SKIP-JULY-AUG                VALUE '4'.
   846             88  SKIP-AUG-SEPT                VALUE '5'.
   847             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   848             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   849             88  SKIP-JUNE                    VALUE '8'.
   850             88  SKIP-JUNE-JULY               VALUE '9'.
   851             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   852             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   853         16  CM-PAYMENT-MODE               PIC X.
   854             88  PAY-MONTHLY                  VALUE SPACE.
   855             88  PAY-WEEKLY                   VALUE '1'.
   856             88  PAY-SEMI-MONTHLY             VALUE '2'.
   857             88  PAY-BI-WEEKLY                VALUE '3'.
   858             88  PAY-SEMI-ANUALLY             VALUE '4'.
   859         16  CM-LOAN-NUMBER                PIC X(8).
   860         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   861         16  CM-OLD-LOF                    PIC XXX.
   862*        16  CM-LOAN-OFFICER               PIC XXX.
   863         16  CM-REIN-TABLE                 PIC XXX.
   864         16  CM-SPECIAL-REIN-CODE          PIC X.
   865         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   866         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   867         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   868
   869     12  CM-STATUS-DATA.
   870         16  CM-ENTRY-STATUS               PIC X.
   871         16  CM-ENTRY-DT                   PIC XX.
   872
   873         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   874         16  CM-LF-CANCEL-DT               PIC XX.
   875         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   876
   877         16  CM-LF-STATUS-AT-DEATH         PIC X.
   878         16  CM-LF-DEATH-DT                PIC XX.
   879         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   880
   881         16  CM-LF-CURRENT-STATUS          PIC X.
   882             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   883                                                'M' '4' '5' '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  17
* EL055.cbl
   884             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   885             88  CM-LF-POLICY-PENDING         VALUE '2'.
   886             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   887             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   888             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   889             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   890             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   891             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   892             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   893             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   894             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   895             88  CM-LF-DECLINED               VALUE 'D'.
   896             88  CM-LF-VOIDED                 VALUE 'V'.
   897
   898         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   899         16  CM-AH-CANCEL-DT               PIC XX.
   900         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   901
   902         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   903         16  CM-AH-SETTLEMENT-DT           PIC XX.
   904         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   905
   906         16  CM-AH-CURRENT-STATUS          PIC X.
   907             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   908                                                'M' '4' '5' '9'.
   909             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   910             88  CM-AH-POLICY-PENDING         VALUE '2'.
   911             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   912             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   913             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   914             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   915             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   916             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   917             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   918             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   919             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   920             88  CM-AH-DECLINED               VALUE 'D'.
   921             88  CM-AH-VOIDED                 VALUE 'V'.
   922
   923         16  CM-CLAIM-INTERFACE-SW         PIC X.
   924             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   925             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   926             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   927         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   928
   929         16  CM-ENTRY-BATCH                PIC X(6).
   930         16  CM-LF-EXIT-BATCH              PIC X(6).
   931         16  CM-AH-EXIT-BATCH              PIC X(6).
   932         16  CM-LAST-MONTH-END             PIC XX.
   933
   934     12  CM-NOTE-SW                        PIC X.
   935         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   936         88  CERT-NOTES-PRESENT               VALUE '1'.
   937         88  BILLING-NOTES-PRESENT            VALUE '2'.
   938         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   939         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   940         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   941         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  18
* EL055.cbl
   942         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   943     12  CM-COMP-EXCP-SW                   PIC X.
   944         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   945         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   946     12  CM-INSURED-ADDRESS-SW             PIC X.
   947         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   948         88  INSURED-ADDR-PRESENT             VALUE '1'.
   949
   950*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   951     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   952     12  FILLER                            PIC X.
   953
   954*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   955     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   956     12  FILLER                            PIC X.
   957*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   958     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   959
   960     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   961         88  CERT-ADDED-BATCH                 VALUE ' '.
   962         88  CERT-ADDED-ONLINE                VALUE '1'.
   963         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   964         88  CERT-PURGED-OFFLINE              VALUE '3'.
   965         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   966     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   967         88  CERT-AS-LOADED                   VALUE ' '.
   968         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   969         88  CERT-CLAIM-ONLINE                VALUE '2'.
   970         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   971         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   972         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   973         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   974         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   975
   976     12  CM-ACCOUNT-COMM-PCTS.
   977         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   978         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   979
   980     12  CM-USER-FIELD                     PIC X.
   981     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   982     12  CM-CLP-STATE                      PIC XX.
   983     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   984     12  CM-USER-RESERVED                  PIC XXX.
   985     12  FILLER REDEFINES CM-USER-RESERVED.
   986         16  CM-AH-CLASS-CD                PIC XX.
   987         16  F                             PIC X.
   988******************************************************************
   989*                                copy ELCCRTO.
   990******************************************************************
   991*                                                                *
   992*                            ELCCRTO.                            *
   993*                                                                *
   994*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
   995*                                                                *
   996*   FILE TYPE = VSAM,KSDS                                        *
   997*   RECORD SIZE = 524  RECFORM = FIXED                           *
   998*                                                                *
   999*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  19
* EL055.cbl
  1000*                                                                *
  1001*   LOG = YES                                                    *
  1002*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1003******************************************************************
  1004*                   C H A N G E   L O G
  1005*
  1006* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1007*-----------------------------------------------------------------
  1008*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1009* EFFECTIVE    NUMBER
  1010*-----------------------------------------------------------------
  1011* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1012* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1013* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1014* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1015* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1016******************************************************************
  1017 01  ORIGINAL-CERTIFICATE.
  1018     12  OC-RECORD-ID                      PIC XX.
  1019         88  VALID-OC-ID                      VALUE 'OC'.
  1020     12  OC-CONTROL-PRIMARY.
  1021         16  OC-COMPANY-CD                 PIC X.
  1022         16  OC-CARRIER                    PIC X.
  1023         16  OC-GROUPING                   PIC X(6).
  1024         16  OC-STATE                      PIC XX.
  1025         16  OC-ACCOUNT                    PIC X(10).
  1026         16  OC-CERT-EFF-DT                PIC XX.
  1027         16  OC-CERT-NO.
  1028             20  OC-CERT-PRIME             PIC X(10).
  1029             20  OC-CERT-SFX               PIC X.
  1030         16  OC-RECORD-TYPE                PIC X.
  1031         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1032     12  OC-LAST-MAINT-DT                  PIC XX.
  1033     12  OC-LAST-MAINT-BY                  PIC X(4).
  1034     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1035     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1036     12  FILLER                            PIC X(49).
  1037     12  OC-ORIG-REC.
  1038         16  OC-INS-LAST-NAME              PIC X(15).
  1039         16  OC-INS-FIRST-NAME             PIC X(10).
  1040         16  OC-INS-MIDDLE-INIT            PIC X.
  1041         16  OC-INS-AGE                    PIC S999     COMP-3.
  1042         16  OC-JNT-LAST-NAME              PIC X(15).
  1043         16  OC-JNT-FIRST-NAME             PIC X(10).
  1044         16  OC-JNT-MIDDLE-INIT            PIC X.
  1045         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1046         16  OC-LF-BENCD                   PIC XX.
  1047         16  OC-LF-TERM                    PIC S999      COMP-3.
  1048         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1049         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1050         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1051         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1052         16  OC-LF-EXP-DT                  PIC XX.
  1053         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1054         16  OC-LF-CANCEL-DT               PIC XX.
  1055         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1056         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1057         16  OC-AH-BENCD                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  20
* EL055.cbl
  1058         16  OC-AH-TERM                    PIC S999      COMP-3.
  1059         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1060         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1061         16  OC-AH-EXP-DT                  PIC XX.
  1062         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1063         16  OC-AH-CP                      PIC 99.
  1064         16  OC-AH-CANCEL-DT               PIC XX.
  1065         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1066         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1067         16  OC-CRED-BENE-NAME             PIC X(25).
  1068         16  OC-1ST-PMT-DT                 PIC XX.
  1069         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1070         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1071         16  OC-ISSUE-TRAN-IND             PIC X.
  1072         16  OC-CANCEL-TRAN-IND            PIC X.
  1073         16  FILLER                        PIC X(211).
  1074
  1075     12  FILLER                            PIC X(50).
  1076******************************************************************
  1077*                                copy ELCCRTT.
  1078******************************************************************
  1079*                                                                *
  1080*                            ELCCRTT.                            *
  1081*                                                                *
  1082*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  1083*                                                                *
  1084*   FILE TYPE = VSAM,KSDS                                        *
  1085*   RECORD SIZE = 552  RECFORM = FIXED                           *
  1086*                                                                *
  1087*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  1088*                                                                *
  1089*   LOG = YES                                                    *
  1090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1091******************************************************************
  1092*                   C H A N G E   L O G
  1093*
  1094* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1095*-----------------------------------------------------------------
  1096*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1097* EFFECTIVE    NUMBER
  1098*-----------------------------------------------------------------
  1099* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1100* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  1101* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  1102* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1103* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1104* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1105* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1106* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1107* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1108* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  1109* 091318  CR2018073000001  PEMA  ADD Refund methods
  1110* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1111******************************************************************
  1112
  1113 01  CERTIFICATE-TRAILERS.
  1114     12  CS-RECORD-ID                      PIC XX.
  1115         88  VALID-CS-ID                      VALUE 'CS'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  21
* EL055.cbl
  1116
  1117     12  CS-CONTROL-PRIMARY.
  1118         16  CS-COMPANY-CD                 PIC X.
  1119         16  CS-CARRIER                    PIC X.
  1120         16  CS-GROUPING                   PIC X(6).
  1121         16  CS-STATE                      PIC XX.
  1122         16  CS-ACCOUNT                    PIC X(10).
  1123         16  CS-CERT-EFF-DT                PIC XX.
  1124         16  CS-CERT-NO.
  1125             20  CS-CERT-PRIME             PIC X(10).
  1126             20  CS-CERT-SFX               PIC X.
  1127         16  CS-TRAILER-TYPE               PIC X.
  1128             88  COMM-TRLR           VALUE 'A'.
  1129             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1130             88  CERT-DATA-TRLR      VALUE 'C'.
  1131
  1132     12  CS-DATA-AREA                      PIC X(516).
  1133
  1134     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1135         16  CS-BANK-COMMISSION-AREA.
  1136             20  CS-BANK-COMMS       OCCURS 10.
  1137                 24  CS-AGT                PIC X(10).
  1138                 24  CS-COM-TYP            PIC X.
  1139                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1140                 24  CS-RECALC-LV-INDIC    PIC X.
  1141                 24  FILLER                PIC X(10).
  1142         16  FILLER                        PIC X(256).
  1143
  1144     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1145****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1146         16  CS-MB-CLAIM-DATA OCCURS 24.
  1147             20  CS-CLAIM-NO               PIC X(7).
  1148             20  CS-CLAIM-TYPE             PIC X.
  1149                 88  CS-AH-CLM               VALUE 'A'.
  1150                 88  CS-IU-CLM               VALUE 'I'.
  1151                 88  CS-GP-CLM               VALUE 'G'.
  1152                 88  CS-LF-CLM               VALUE 'L'.
  1153                 88  CS-PR-CLM               VALUE 'P'.
  1154                 88  CS-FL-CLM               VALUE 'F'.
  1155                 88  CS-OT-CLM               VALUE 'O'.
  1156             20  CS-INSURED-TYPE           PIC X.
  1157                 88  CS-PRIM-INSURED          VALUE 'P'.
  1158                 88  CS-CO-BORROWER           VALUE 'C'.
  1159             20  CS-BENEFIT-PERIOD         PIC 99.
  1160             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1161             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1162             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1163         16  FILLER                        PIC X(12).
  1164     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1165         16  CS-VIN-NUMBER                 PIC X(17).
  1166         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1167         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1168         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1169         16  cs-agent-name.
  1170             20  cs-agent-fname            pic x(20).
  1171             20  cs-agent-mi               pic x.
  1172             20  cs-agent-lname            pic x(25).
  1173         16  cs-license-no                 pic x(15).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  22
* EL055.cbl
  1174         16  cs-npn-number                 pic x(10).
  1175         16  cs-agent-edit-status          pic x.
  1176             88  cs-ae-refer-to-manager      value 'M'.
  1177             88  cs-ae-cover-sheet           value 'C'.
  1178             88  cs-ae-sig-form              value 'S'.
  1179             88  cs-ae-verified              value 'V'.
  1180             88  cs-unidentified-signature   value 'U'.
  1181             88  cs-cert-returned            value 'R'.
  1182             88  cs-accept-no-commission     value 'N'.
  1183         16  cs-year                       pic 9999.
  1184         16  cs-make                       pic x(20).
  1185         16  cs-model                      pic x(20).
  1186         16  cs-future                     pic x(20).
  1187         16  cs-vehicle-odometer           pic s9(7) comp-3.
  1188         16  cs-claim-verification-status  pic x.
  1189             88  cs-clm-ver-eligible         value 'A'.
  1190             88  cs-clm-ver-partial-elig     value 'B'.
  1191             88  cs-clm-ver-not-eligible     value 'C'.
  1192             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  1193             88  cs-clm-ver-not-part-elig-rw value 'E'.
  1194             88  cs-clm-ver-ND-CERT          value 'F'.
  1195             88  cs-clm-ver-spec-other       value 'G'.
  1196             88  cs-clam-ver-pratial-corrected
  1197                                             value 'H'.
  1198             88  cs-clm-ver-no-matches       value 'I'.
  1199             88  cs-clm-ver-not-elig-corrected
  1200                                             value 'J'.
  1201             88  cs-clm-ver-needs-review     value 'R'.
  1202             88  cs-clm-ver-sent-to-claims   value 'W'.
  1203         16  CS-LF-REFUND-METHOD           PIC X.
  1204         16  CS-AH-REFUND-METHOD           PIC X.
  1205         16  FILLER                        PIC X(353). *> was 420
  1206*        16  FILLER                        PIC X(496).
  1207*                                copy ERCARCH.
  1208******************************************************************
  1209*                                                                *
  1210*                            ERCARCH.                            *
  1211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1212*                            VMOD=2.002                          *
  1213*                                                                *
  1214*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  1215*                                                                *
  1216*   FILE TYPE = VSAM,KSDS                                        *
  1217*   RECORD SIZE = 250  RECFORM = FIXED                           *
  1218*                                                                *
  1219*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  1220*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  1221*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  1222*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  1223*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  1224*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  1225*                                                                *
  1226*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1227******************************************************************
  1228*                   C H A N G E   L O G
  1229*
  1230* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1231*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  23
* EL055.cbl
  1232*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1233* EFFECTIVE    NUMBER
  1234*-----------------------------------------------------------------
  1235* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1236* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  1237* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1238* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  1239******************************************************************
  1240 01  LETTER-ARCHIVE.
  1241     12  LA-RECORD-ID                PIC  X(02).
  1242         88  LA-VALID-ID                VALUE 'LA'.
  1243
  1244     12  LA-CONTROL-PRIMARY.
  1245         16  LA-COMPANY-CD           PIC  X(01).
  1246         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  1247
  1248     12  LA-CONTROL-BY-CERT-RESP.
  1249         16  LA-COMPANY-CD-A2        PIC  X(01).
  1250         16  LA-CERT-NO-A2.
  1251             20  LA-CERT-PRIME-A2    PIC  X(10).
  1252             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  1253         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  1254             20  LA-RESP-PERSON-A2   PIC  X(10).
  1255             20  LA-TYPE-A2          PIC  X(01).
  1256         16  LA-CARRIER-A2           PIC  X(01).
  1257         16  LA-GROUPING-A2          PIC  X(06).
  1258         16  LA-STATE-A2             PIC  X(02).
  1259         16  LA-ACCOUNT-A2           PIC  X(10).
  1260         16  LA-EFFECT-DATE-A2       PIC  X(02).
  1261         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  1262
  1263     12  LA-CONTROL-BY-FORM.
  1264         16  LA-COMPANY-CD-A3        PIC  X(01).
  1265         16  LA-FORM-A3              PIC  X(04).
  1266         16  LA-CARRIER-A3           PIC  X(01).
  1267         16  LA-GROUPING-A3          PIC  X(06).
  1268         16  LA-STATE-A3             PIC  X(02).
  1269         16  LA-ACCOUNT-A3           PIC  X(10).
  1270         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  1271
  1272     12  LA-CONTROL-BY-PROCESSOR.
  1273         16  LA-COMPANY-CD-A4        PIC  X(01).
  1274         16  LA-PROCESSOR-CD         PIC  X(04).
  1275         16  LA-CARRIER-A4           PIC  X(01).
  1276         16  LA-GROUPING-A4          PIC  X(06).
  1277         16  LA-STATE-A4             PIC  X(02).
  1278         16  LA-ACCOUNT-A4           PIC  X(10).
  1279         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  1280
  1281     12  LA-CONTROL-BY-KEY-FIELDS.
  1282         16  LA-COMPANY-CD-A5        PIC  X(01).
  1283         16  LA-CARRIER-A5           PIC  X(01).
  1284         16  LA-GROUPING-A5          PIC  X(06).
  1285         16  LA-STATE-A5             PIC  X(02).
  1286         16  LA-ACCOUNT-A5           PIC  X(10).
  1287         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  1288
  1289     12  LA-CONTROL-BY-GROUP-CODE.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  24
* EL055.cbl
  1290         16  LA-COMPANY-CD-A6        PIC  X(01).
  1291         16  LA-ENTRY-A6.
  1292             20  LA-FILLER           PIC  X(02).
  1293             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  1294         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  1295
  1296     12  FILLER                      PIC  X(09).
  1297
  1298     12  LA-HEADER-RECORD.
  1299         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  1300         16  LA-CREATION-DATE        PIC  X(02).
  1301         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  1302         16  LA-FINAL-ACT-DATE       REDEFINES
  1303               LA-FOLLOW-UP-DATE     PIC  X(02).
  1304         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  1305         16  LA-NO-OF-COPIES         PIC S9(01).
  1306         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  1307         16  LA-REPLY-DATE           PIC  X(02).
  1308         16  LA-RESEND-DATES.
  1309             20  LA-RESEND-DATE      PIC  X(02).
  1310             20  LA-SENT-DATE        PIC  X(02).
  1311             20  FILLER              PIC  X(08).
  1312         16  LA-SOURCE-INFORMATION.
  1313             20  LA-DATA-SOURCE      PIC  X(01).
  1314             20  LA-ADDR-SOURCE      PIC  X(01).
  1315         16  LA-STATUS               PIC  X(01).
  1316             88  LA-STATUS-ACTIVE         VALUE 'A'.
  1317             88  LA-STATUS-COMPLETED      VALUE 'C'.
  1318             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  1319             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  1320             88  LA-STATUS-PURGED         VALUE 'P'.
  1321             88  LA-STATUS-VOIDED         VALUE 'V'.
  1322         16  LA-LAST-RESENT-PRINT-DATE
  1323                                     PIC  X(02).
  1324         16  LA-PRINT-RESTRICTION    PIC  X(01).
  1325             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  1326                                          VALUE 'C'.
  1327             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  1328                                          VALUE 'F'.
  1329             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  1330                                          VALUE 'P'.
  1331         16  LA-PURGED-DATE          PIC  X(02).
  1332         16  LA-VOIDED-DATE          PIC  X(02).
  1333         16  LA-RESEND-LETR          PIC  X(4).
  1334         16  LA-VOID-ONBASE-YN       PIC  X.
  1335         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  1336         16  FILLER                  PIC  X(04).
  1337*        16  LA-RESEND-LETR-2        PIC  X(4).
  1338*        16  LA-RESEND-LETR-3        PIC  X(4).
  1339*        16  FILLER                  PIC  X(59).
  1340         16  LA-ARCHIVE-STATUS       PIC  X.
  1341             88  LA-TEMP                VALUE 'T'.
  1342             88  LA-QWS                 VALUE 'Q'.
  1343             88  LA-BATCH               VALUE 'B'.
  1344         16  LA-FINAL-ACT-IND        PIC  X(1).
  1345         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  1346         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  1347         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  25
* EL055.cbl
  1348                                     PIC X(4).
  1349         16  FILLER                  PIC  X(42).
  1350*        16  FILLER                  PIC  X(71).
  1351         16  LA-LAST-MAINT-DATE      PIC  X(2).
  1352         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  1353         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  1354                                     PIC  X(4).
  1355         16  LA-LAST-UPDATED-BY      PIC  X(4).
  1356
  1357******************************************************************
  1358*                                copy NSCASEXTR.
  1359******************************************************************
  1360*                                                                *
  1361*                                                                *
  1362*                            NSCASEXTR.                          *
  1363*                            VMOD=2.001                          *
  1364*                                                                *
  1365*   FILE DESCRIPTION = NAPERSOFT ADMIN SERVICES EXTRACT FILE     *
  1366*                                                                *
  1367*   FILE TYPE = VSAM,KSDS                                        *
  1368*   RECORD SIZE = 4500 RECFORM = FIXED                           *
  1369*                                                                *
  1370*   BASE CLUSTER = NSASEXTR                       RKP=0,LEN=07   *
  1371*                                                                *
  1372*   LOG = NO                                                     *
  1373*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1374******************************************************************
  1375*-----------------------------------------------------------------
  1376*                   C H A N G E   L O G
  1377*
  1378* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1379*-----------------------------------------------------------------
  1380*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1381* EFFECTIVE    NUMBER
  1382*-----------------------------------------------------------------
  1383* 072211    2011022800001  PEMA  NEW FILE
  1384*-----------------------------------------------------------------
  1385 01 NSAS-EXTRACT-RECORD.
  1386    05  NSAS-CONTROL-PRIMARY.
  1387        10  NSAS-COMPANY-CD      PIC X.
  1388        10  NSAS-ARCHIVE-NO      PIC 9(8) BINARY.
  1389        10  NSAS-SEQ-NO          PIC 9(4) BINARY.
  1390    05  NSAS-LETTER-VARIABLES    PIC X(4350).
  1391    05  FILLER                   PIC X(143).
  1392*                                copy ERCCHEK.
  1393******************************************************************
  1394*                                                                *
  1395*                                                                *
  1396*                            ERCCHEK                             *
  1397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1398*                            VMOD=2.008                          *
  1399*                                                                *
  1400*   FILE DESCRIPTION = CHECK RECORDS                             *
  1401*                                                                *
  1402*   FILE TYPE = VSAM,KSDS                                        *
  1403*   RECORD SIZE = 600    RECFORM = FIXED                         *
  1404*                                                                *
  1405*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  26
* EL055.cbl
  1406*       ALTERNATE INDEX = NONE                                   *
  1407*                                                                *
  1408*   LOG = YES                                                    *
  1409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1410******************************************************************
  1411*                   C H A N G E   L O G
  1412*
  1413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1414*-----------------------------------------------------------------
  1415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1416* EFFECTIVE    NUMBER
  1417*-----------------------------------------------------------------
  1418* 021414    2003053000001  PEMA  changes for auto chk request
  1419******************************************************************
  1420 01  CHECK-RECORDS.
  1421     12  CH-RECORD-ID                      PIC XX.
  1422         88  VALID-CH-ID                      VALUE 'CH'.
  1423
  1424     12  CH-CONTROL-PRIMARY.
  1425         16  CH-COMPANY-CD                 PIC X.
  1426         16  CH-CARRIER                    PIC X.
  1427         16  CH-GROUPING                   PIC X(6).
  1428         16  CH-STATE                      PIC XX.
  1429         16  CH-ACCOUNT                    PIC X(10).
  1430         16  CH-CERT-EFF-DT                PIC XX.
  1431         16  CH-CERT-NO.
  1432             20  CH-CERT-PRIME             PIC X(10).
  1433             20  CH-CERT-SFX               PIC X.
  1434         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  1435
  1436     12  CH-RECORDED-DT                    PIC XX.
  1437     12  CH-RECORDED-BY                    PIC X(4).
  1438     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  1439
  1440     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  1441     12  CH-CHECK-NO                       PIC X(7).
  1442     12  CH-REASON-FOR-CHECK               PIC X(25).
  1443     12  CH-CHECK-WRITTEN-DT               PIC XX.
  1444     12  FILLER                            PIC X.
  1445
  1446     12  CH-PAYEE-INFO.
  1447         16  CH-PAYEE-NAME-1               PIC X(30).
  1448         16  CH-PAYEE-NAME-2               PIC X(30).
  1449         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  1450         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  1451         16  CH-PAYEE-CITY-ST.
  1452             20  CH-PAYEE-CITY             PIC X(28).
  1453             20  CH-PAYEE-STATE            PIC XX.
  1454         16  CH-PAYEE-ZIP-CODE.
  1455             20  CH-PAYEE-ZIP.
  1456                 24  CH-ZIP-PRI-1ST        PIC X.
  1457                     88  CH-CANADIAN-POST-CODE
  1458                                           VALUES 'A' THRU 'Z'.
  1459                 24  FILLER                PIC X(4).
  1460             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  1461         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  1462             20  CH-CAN-POSTAL-1           PIC XXX.
  1463             20  CH-CAN-POSTAL-2           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  27
* EL055.cbl
  1464             20  FILLER                    PIC XXX.
  1465
  1466     12  CH-CHECK-STUB-TEXT.
  1467         16  CH-STUB-LINE-1                PIC X(30).
  1468         16  CH-TEXT-LINE-1                PIC X(50).
  1469         16  CH-TEXT-LINE-2                PIC X(50).
  1470         16  CH-TEXT-LINE-3                PIC X(40).
  1471     12  CH-RETURN-TO                      PIC X(30).
  1472
  1473     12  CH-COMPENSATION-CONTROL.
  1474         16  CH-COMP-CARRIER               PIC X.
  1475         16  CH-COMP-GROUPING              PIC X(6).
  1476         16  CH-COMP-FIN-RESP              PIC X(10).
  1477         16  CH-COMP-ACCOUNT               PIC X(10).
  1478
  1479     12  CH-CREDIT-SELECT-DT               PIC XX.
  1480     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  1481     12  CH-PAYEE-CODE                     PIC X(6).
  1482
  1483     12  CH-VOID-DATA.
  1484         20  CH-VOID-DT                    PIC XX.
  1485         20  CH-VOID-BY                    PIC X(4).
  1486         20  CH-VOID-REASON                PIC X(25).
  1487
  1488     12  CH-APPROVAL-DATA.
  1489         20  CH-APPROVAL-DT                PIC XX.
  1490         20  CH-APPROVAL-STATUS            PIC X.
  1491             88  CH-IN-LIMBO                  VALUE ' '.
  1492             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  1493             88  CH-APPROVED                  VALUE 'A'.
  1494             88  CH-DENIED                    VALUE 'D'.
  1495         20  CH-APPROVED-BY                PIC XXXX.
  1496     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  1497             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1498     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  1499
  1500     12  ch-released-dt                    pic xx.
  1501     12  ch-check-cashed-dt                pic xx.
  1502     12  FILLER                            PIC X.
  1503*    12  CH-CHECK-REFERENCE                PIC X(12).
  1504     12  CH-CHECK-ORIGIN-SW                PIC X.
  1505             88  CH-REFUND-CHECK              VALUE 'R'.
  1506             88  CH-MAINT-CHECK               VALUE 'M'.
  1507
  1508     12  CH-CANC-DT                        PIC XX.
  1509     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  1510     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  1511
  1512     12  CH-INSURED-NAME                   PIC X(28).
  1513
  1514     12  ch-released-by                    pic x(4).
  1515     12  ch-csr                            pic x(4).
  1516     12  ch-deduct-commission              pic x.
  1517         88  ch-deduct-comm                  value 'Y'.
  1518         88  ch-do-not-deduct-comm           value 'N'.
  1519
  1520     12  FILLER                            PIC X(11).
  1521*    12  CH-LETTER-TABLE.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  28
* EL055.cbl
  1522*        16  CH-LETTERS OCCURS 3 TIMES
  1523*                       INDEXED BY CH-LT-NDX
  1524*                                          PIC X(04).
  1525
  1526     12  FILLER                            PIC X(07).
  1527
  1528*                                copy ERCCNOT.
  1529******************************************************************
  1530*                                                                *
  1531*                            ERCCNOT                             *
  1532*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1533*                            VMOD=2.003                          *
  1534*                                                                *
  1535*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1536*                                                                *
  1537*        FILE TYPE= VSAM,KSDS                                    *
  1538*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1539*                                                                *
  1540*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1541*                                                                *
  1542*        LOG = YES                                               *
  1543*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1544*                                                                *
  1545******************************************************************
  1546*                   C H A N G E   L O G
  1547*
  1548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1549*-----------------------------------------------------------------
  1550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1551* EFFECTIVE    NUMBER
  1552*-----------------------------------------------------------------
  1553* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1554******************************************************************
  1555
  1556 01  CERT-NOTE-FILE.
  1557     12  CZ-RECORD-ID                PIC  XX.
  1558         88  VALID-CZ-ID                  VALUE 'CZ'.
  1559
  1560     12  CZ-CONTROL-PRIMARY.
  1561         16  CZ-COMPANY-CD           PIC X.
  1562         16  CZ-CARRIER              PIC X.
  1563         16  CZ-GROUPING.
  1564             20 CZ-GROUPING-PREFIX   PIC XXX.
  1565             20 CZ-GROUPING-PRIME    PIC XXX.
  1566         16  CZ-STATE                PIC XX.
  1567         16  CZ-ACCOUNT.
  1568             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1569             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1570         16  CZ-CERT-EFF-DT          PIC XX.
  1571         16  CZ-CERT-NO.
  1572             20  CZ-CERT-PRIME       PIC X(10).
  1573             20  CZ-CERT-SFX         PIC X.
  1574         16  CZ-RECORD-TYPE          PIC X.
  1575             88  CERT-NOTE           VALUE '1'.
  1576             88  CLAIM-CERT-NOTE     VALUE '2'.
  1577         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1578
  1579     12  CZ-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  29
* EL055.cbl
  1580     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1581     12  CZ-LAST-MAINT-USER          PIC X(4).
  1582
  1583     12  CZ-NOTE-INFORMATION.
  1584         16  CZ-NOTE                 PIC X(63).
  1585         16  FILLER                  PIC X(39).
  1586******************************************************************
  1587*                                copy ERCNOTE.
  1588******************************************************************
  1589*                                                                *
  1590*                                                                *
  1591*                            ERCNOTE                             *
  1592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1593*                            VMOD=2.003                          *
  1594*                                                                *
  1595*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  1596*                                                                *
  1597*        FILE TYPE= VSAM,KSDS                                    *
  1598*        RECORD SIZE = 825    RECFORM = FIXED                    *
  1599*                                                                *
  1600*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  1601*                                                                *
  1602*        LOG = YES                                               *
  1603*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1604*                                                                *
  1605******************************************************************
  1606*                   C H A N G E   L O G
  1607*
  1608* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1609*-----------------------------------------------------------------
  1610*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1611* EFFECTIVE    NUMBER
  1612*-----------------------------------------------------------------
  1613* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  1614*                                FILE WILL CONTAIN BILLING NOTES O
  1615******************************************************************
  1616
  1617 01  CERTIFICATE-NOTE.
  1618     12  CN-RECORD-ID                PIC  XX.
  1619         88  VALID-CN-ID                  VALUE 'CN'.
  1620
  1621     12  CN-CONTROL-PRIMARY.
  1622         16  CN-COMPANY-CD           PIC X.
  1623         16  CN-CARRIER              PIC X.
  1624         16  CN-GROUPING.
  1625             20 CN-GROUPING-PREFIX   PIC XXX.
  1626             20 CN-GROUPING-PRIME    PIC XXX.
  1627         16  CN-STATE                PIC XX.
  1628         16  CN-ACCOUNT.
  1629             20 CN-ACCOUNT-PREFIX    PIC X(4).
  1630             20 CN-ACCOUNT-PRIME     PIC X(6).
  1631         16  CN-CERT-EFF-DT          PIC XX.
  1632         16  CN-CERT-NO.
  1633             20  CN-CERT-PRIME       PIC X(10).
  1634             20  CN-CERT-SFX         PIC X.
  1635
  1636     12  CN-BILLING-START-LINE-NO    PIC 99.
  1637     12  CN-BILLING-END-LINE-NO      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  30
* EL055.cbl
  1638
  1639     12  CN-LINES.
  1640         16  CN-LINE OCCURS 10       PIC X(77).
  1641
  1642     12  CN-LAST-MAINT-DT            PIC XX.
  1643     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1644     12  CN-LAST-MAINT-USER          PIC X(4).
  1645     12  FILLER                      PIC X(6).
  1646******************************************************************
  1647*                                copy ERCMAIL.
  1648******************************************************************
  1649*                                                                *
  1650*                                                                *
  1651*                            ERCMAIL                             *
  1652*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1653*                            VMOD=2.003                          *
  1654*                                                                *
  1655*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  1656*                                                                *
  1657*   FILE TYPE = VSAM,KSDS                                        *
  1658*   RECORD SIZE = 374   RECFORM = FIX                            *
  1659*                                                                *
  1660*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  1661*   ALTERNATE PATH    = NOT USED                                 *
  1662*                                                                *
  1663*   LOG = YES                                                    *
  1664*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1665******************************************************************
  1666*                   C H A N G E   L O G
  1667*
  1668* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1669*-----------------------------------------------------------------
  1670*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1671* EFFECTIVE    NUMBER
  1672*-----------------------------------------------------------------
  1673* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  1674* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1675* 111108                   PEMA  ADD CRED BENE ADDR2
  1676******************************************************************
  1677
  1678 01  MAILING-DATA.
  1679     12  MA-RECORD-ID                      PIC XX.
  1680         88  VALID-MA-ID                       VALUE 'MA'.
  1681
  1682     12  MA-CONTROL-PRIMARY.
  1683         16  MA-COMPANY-CD                 PIC X.
  1684         16  MA-CARRIER                    PIC X.
  1685         16  MA-GROUPING.
  1686             20  MA-GROUPING-PREFIX        PIC XXX.
  1687             20  MA-GROUPING-PRIME         PIC XXX.
  1688         16  MA-STATE                      PIC XX.
  1689         16  MA-ACCOUNT.
  1690             20  MA-ACCOUNT-PREFIX         PIC X(4).
  1691             20  MA-ACCOUNT-PRIME          PIC X(6).
  1692         16  MA-CERT-EFF-DT                PIC XX.
  1693         16  MA-CERT-NO.
  1694             20  MA-CERT-PRIME             PIC X(10).
  1695             20  MA-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  31
* EL055.cbl
  1696
  1697     12  FILLER                            PIC XX.
  1698
  1699     12  MA-ACCESS-CONTROL.
  1700         16  MA-SOURCE-SYSTEM              PIC XX.
  1701             88  MA-FROM-CREDIT                VALUE 'CR'.
  1702             88  MA-FROM-VSI                   VALUE 'VS'.
  1703             88  MA-FROM-WARRANTY              VALUE 'WA'.
  1704             88  MA-FROM-OTHER                 VALUE 'OT'.
  1705         16  MA-RECORD-ADD-DT              PIC XX.
  1706         16  MA-RECORD-ADDED-BY            PIC XXXX.
  1707         16  MA-LAST-MAINT-DT              PIC XX.
  1708         16  MA-LAST-MAINT-BY              PIC XXXX.
  1709         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  1710
  1711     12  MA-PROFILE-INFO.
  1712         16  MA-QUALIFY-CODE-1             PIC XX.
  1713         16  MA-QUALIFY-CODE-2             PIC XX.
  1714         16  MA-QUALIFY-CODE-3             PIC XX.
  1715         16  MA-QUALIFY-CODE-4             PIC XX.
  1716         16  MA-QUALIFY-CODE-5             PIC XX.
  1717
  1718         16  MA-INSURED-LAST-NAME          PIC X(15).
  1719         16  MA-INSURED-FIRST-NAME         PIC X(10).
  1720         16  MA-INSURED-MIDDLE-INIT        PIC X.
  1721         16  MA-INSURED-ISSUE-AGE          PIC 99.
  1722         16  MA-INSURED-BIRTH-DT           PIC XX.
  1723         16  MA-INSURED-SEX                PIC X.
  1724             88  MA-SEX-MALE                   VALUE 'M'.
  1725             88  MA-SEX-FEMALE                 VALUE 'F'.
  1726         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  1727
  1728         16  MA-ADDRESS-CORRECTED          PIC X.
  1729         16  MA-JOINT-BIRTH-DT             PIC XX.
  1730*        16  FILLER                        PIC X(12).
  1731
  1732         16  MA-ADDRESS-LINE-1             PIC X(30).
  1733         16  MA-ADDRESS-LINE-2             PIC X(30).
  1734         16  MA-CITY-STATE.
  1735             20  MA-CITY                   PIC X(28).
  1736             20  MA-ADDR-STATE             PIC XX.
  1737         16  MA-ZIP.
  1738             20  MA-ZIP-CODE.
  1739                 24  MA-ZIP-CODE-1ST       PIC X(1).
  1740                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1741                 24  FILLER                PIC X(4).
  1742             20  MA-ZIP-PLUS4              PIC X(4).
  1743         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  1744             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  1745             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  1746             20  FILLER                    PIC X(3).
  1747
  1748         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  1749
  1750         16  FILLER                        PIC XXX.
  1751*        16  FILLER                        PIC X(10).
  1752
  1753     12  MA-CRED-BENE-INFO.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  32
* EL055.cbl
  1754         16  MA-CRED-BENE-NAME                 PIC X(25).
  1755         16  MA-CRED-BENE-ADDR                 PIC X(30).
  1756         16  MA-CRED-BENE-ADDR2                PIC X(30).
  1757         16  MA-CRED-BENE-CTYST.
  1758             20  MA-CRED-BENE-CITY             PIC X(28).
  1759             20  MA-CRED-BENE-STATE            PIC XX.
  1760         16  MA-CRED-BENE-ZIP.
  1761             20  MA-CB-ZIP-CODE.
  1762                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  1763                     88  MA-CB-CANADIAN-POST-CODE
  1764                                           VALUE 'A' THRU 'Z'.
  1765                 24  FILLER                    PIC X(4).
  1766             20  MA-CB-ZIP-PLUS4               PIC X(4).
  1767         16  MA-CB-CANADIAN-POSTAL-CODE
  1768                            REDEFINES MA-CRED-BENE-ZIP.
  1769             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  1770             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  1771             20  FILLER                        PIC X(3).
  1772     12  MA-POST-CARD-MAIL-DATA.
  1773         16  MA-MAIL-DATA OCCURS 7.
  1774             20  MA-MAIL-TYPE              PIC X.
  1775                 88  MA-12MO-MAILING           VALUE '1'.
  1776                 88  MA-EXP-MAILING            VALUE '2'.
  1777             20  MA-MAIL-STATUS            PIC X.
  1778                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  1779                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  1780                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  1781             20  MA-MAIL-DATE              PIC XX.
  1782     12  FILLER                            PIC XX.
  1783     12  FILLER                            PIC XX.
  1784*    12  FILLER                            PIC X(30).
  1785******************************************************************
  1786*                                copy ERCENDR.
  1787******************************************************************
  1788*                                                                *
  1789*                                                                *
  1790*                            ERCENDR.                            *
  1791*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1792*                            VMOD=2.001                          *
  1793*                                                                *
  1794*   FILE DESCRIPTION = ENDORSEMENT SUMMARY BY ACCOUNT            *
  1795*                                                                *
  1796*                                                                *
  1797*                                                                *
  1798*   FILE TYPE = VSAM,KSDS                                        *
  1799*   RECORD SIZE = 513  RECFORM = FIXED                           *
  1800*                                                                *
  1801*   BASE CLUSTER = ERENDR                         RKP=2,LEN=36   *
  1802*                                                                *
  1803*   LOG = NO                                                     *
  1804*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1805******************************************************************
  1806*-----------------------------------------------------------------
  1807*                   C H A N G E   L O G
  1808*
  1809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1810*-----------------------------------------------------------------
  1811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  33
* EL055.cbl
  1812* EFFECTIVE    NUMBER
  1813*-----------------------------------------------------------------
  1814* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1815*                                WITH OPEN CLAIMS
  1816*-----------------------------------------------------------------
  1817 01  ENDORSEMENT-RECORD.
  1818     12  EN-RECORD-ID            PIC XX.
  1819         88  VALID-EN-ID             VALUE 'EN'.
  1820     12  EN-CONTROL-PRIMARY.
  1821         16  EN-COMPANY-CD       PIC X.
  1822         16  EN-CARRIER          PIC X.
  1823         16  EN-GROUPING         PIC X(6).
  1824         16  EN-STATE            PIC XX.
  1825         16  EN-ACCOUNT          PIC X(10).
  1826         16  EN-CERT-EFF-DT      PIC XX.
  1827         16  EN-CERT-NO.
  1828             20  EN-CERT-PRIME   PIC X(10).
  1829             20  EN-CERT-SFX     PIC X.
  1830         16  EN-SEQ-NO           PIC S9(04) COMP.
  1831         16  EN-REC-TYPE         PIC X.
  1832             88  EN-ISSUE             VALUE '1'.
  1833             88  EN-CANCELLATION      VALUE '2'.
  1834     12  EN-LAST-MAINT-DT        PIC XX.
  1835     12  EN-LAST-MAINT-BY        PIC X(4).
  1836     12  EN-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1837     12  EN-LAST-NAME            PIC X(15).
  1838     12  EN-FIRST-NAME           PIC X(10).
  1839     12  EN-MIDDLE-INIT          PIC X.
  1840     12  EN-JOINT-LAST-NAME      PIC X(15).
  1841     12  EN-JOINT-FIRST-NAME     PIC X(10).
  1842     12  EN-JOINT-MIDDLE-INIT    PIC X.
  1843     12  EN-LF-TERM              PIC S999      COMP-3.
  1844     12  EN-AH-TERM              PIC S999      COMP-3.
  1845     12  EN-LF-BEN-ENT-AMT       PIC S9(9)V99  COMP-3.
  1846     12  EN-AH-BEN-ENT-AMT       PIC S9(7)V99  COMP-3.
  1847     12  EN-LF-BEN-CAL-AMT       PIC S9(9)V99  COMP-3.
  1848     12  EN-AH-BEN-CAL-AMT       PIC S9(7)V99  COMP-3.
  1849     12  EN-LF-PREM-ENT-AMT      PIC S9(7)V99  COMP-3.
  1850     12  EN-AH-PREM-ENT-AMT      PIC S9(7)V99  COMP-3.
  1851     12  EN-LF-CANC-ENT-AMT      PIC S9(7)V99  COMP-3.
  1852     12  EN-AH-CANC-ENT-AMT      PIC S9(7)V99  COMP-3.
  1853     12  EN-LF-PREM-CAL-AMT      PIC S9(7)V99  COMP-3.
  1854     12  EN-AH-PREM-CAL-AMT      PIC S9(7)V99  COMP-3.
  1855     12  EN-LF-CANC-CAL-AMT      PIC S9(7)V99  COMP-3.
  1856     12  EN-AH-CANC-CAL-AMT      PIC S9(7)V99  COMP-3.
  1857     12  EN-LF-CANC-DT           PIC XX.
  1858     12  EN-AH-CANC-DT           PIC XX.
  1859     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  1860     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  1861     12  EN-LF-BEN-CD            PIC XX.
  1862     12  EN-AH-BEN-CD            PIC XX.
  1863*           12  FILLER                  PIC X(18).
  1864     12  FILLER                  PIC X(17).
  1865     12  EN-FLAG-CERT            PIC X.
  1866     12  EN-INPUT-DT             PIC XX.
  1867     12  EN-PRINT-DT             PIC XX.
  1868     12  EN-SIG-SW               PIC X.
  1869     12  EN-COMMENTS1            PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  34
* EL055.cbl
  1870     12  EN-COMMENTS2            PIC X(70).
  1871     12  EN-COMMENTS3            PIC X(70).
  1872     12  EN-COMMENTS4            PIC X(70).
  1873     12  FILLER                  PIC X(30).
  1874******************************************************************
  1875*                                copy ERCENDT replacing
  1876*          ENDORSEMENT-RECORD by ENDT-RECORD
  1877*          LEADING ==EN-== BY ==ET-==.
  1878******************************************************************
  1879*                                                                *
  1880*                                                                *
  1881*                            ERCENDT.                            *
  1882*                            VMOD=2.001                          *
  1883*                                                                *
  1884*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  1885*                                                                *
  1886*   FILE TYPE = VSAM,KSDS                                        *
  1887*   RECORD SIZE = 579  RECFORM = FIXED                           *
  1888*                                                                *
  1889*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  1890*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  1891*                                                                *
  1892*   LOG = NO                                                     *
  1893*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1894******************************************************************
  1895*-----------------------------------------------------------------
  1896*                   C H A N G E   L O G
  1897*
  1898* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1899*-----------------------------------------------------------------
  1900*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1901* EFFECTIVE    NUMBER
  1902*-----------------------------------------------------------------
  1903* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  1904*                                WITH OPEN CLAIMS
  1905* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  1906* 110612    2012101700002  AJRA  ADD NEW FIELDS
  1907* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1908* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  1909*-----------------------------------------------------------------
  1910 01  ENDT-RECORD.
  1911     12  ET-RECORD-ID                PIC XX.
  1912         88  VALID-EN-ID                VALUE 'EN'.
  1913     12  ET-CONTROL-PRIMARY.
  1914         16  ET-COMPANY-CD           PIC X.
  1915         16  ET-CARRIER              PIC X.
  1916         16  ET-GROUPING             PIC X(6).
  1917         16  ET-STATE                PIC XX.
  1918         16  ET-ACCOUNT              PIC X(10).
  1919         16  ET-CERT-EFF-DT          PIC XX.
  1920         16  ET-CERT-NO.
  1921             20  ET-CERT-PRIME       PIC X(10).
  1922             20  ET-CERT-SFX         PIC X.
  1923         16  ET-REC-TYPE             PIC X.
  1924             88  ET-ISSUE               VALUE 'I'.
  1925             88  ET-CANCELLATION        VALUE 'C'.
  1926         16  ET-SEQ-NO               PIC 9(04) BINARY.
  1927     12  ET-CONTROL-BY-ARCH-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  35
* EL055.cbl
  1928         16  ET-COMPANY-CD-A1              PIC X.
  1929         16  ET-ARCHIVE-NO                 PIC 9(8) BINARY.
  1930     12  ET-LAST-MAINT-DT            PIC XX.
  1931     12  ET-LAST-MAINT-BY            PIC X(4).
  1932     12  ET-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  1933     12  ET-ENDORSEMENT-RECORD       PIC X(329).
  1934     12  ET-ISSUE-RECORD REDEFINES ET-ENDORSEMENT-RECORD.
  1935         16  ET-INS-ORIG-LAST-NAME   PIC X(15).
  1936         16  ET-INS-ORIG-FIRST-NAME  PIC X(10).
  1937         16  ET-INS-ORIG-MIDDLE-INIT PIC X.
  1938         16  ET-INS-ORIG-AGE         PIC S999     COMP-3.
  1939         16  ET-JNT-ORIG-LAST-NAME   PIC X(15).
  1940         16  ET-JNT-ORIG-FIRST-NAME  PIC X(10).
  1941         16  ET-JNT-ORIG-MIDDLE-INIT PIC X.
  1942         16  ET-JNT-ORIG-AGE         PIC S999     COMP-3.
  1943         16  ET-LF-ORIG-BENCD        PIC XX.
  1944         16  ET-LF-ORIG-TERM         PIC S999      COMP-3.
  1945         16  ET-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1946         16  ET-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1947         16  ET-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  1948         16  ET-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  1949         16  ET-LF-ORIG-EXP-DT       PIC XX.
  1950*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  1951         16  ET-ORIG-CRED-BENE       PIC X(25).
  1952         16  ET-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1953         16  FILLER                  PIC X.
  1954         16  ET-AH-ORIG-BENCD        PIC XX.
  1955         16  ET-AH-ORIG-TERM         PIC S999      COMP-3.
  1956         16  ET-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  1957         16  ET-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  1958         16  ET-AH-ORIG-EXP-DT       PIC XX.
  1959*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  1960*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  1961         16  ET-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  1962         16  F                       PIC X(09).
  1963         16  ET-AH-ORIG-CP           PIC 99.
  1964         16  ET-INS-NEW-LAST-NAME    PIC X(15).
  1965         16  ET-INS-NEW-FIRST-NAME   PIC X(10).
  1966         16  ET-INS-NEW-MIDDLE-INIT  PIC X.
  1967         16  ET-INS-NEW-AGE          PIC S999     COMP-3.
  1968         16  ET-JNT-NEW-LAST-NAME    PIC X(15).
  1969         16  ET-JNT-NEW-FIRST-NAME   PIC X(10).
  1970         16  ET-JNT-NEW-MIDDLE-INIT  PIC X.
  1971         16  ET-JNT-NEW-AGE          PIC S999     COMP-3.
  1972         16  ET-LF-NEW-BENCD         PIC XX.
  1973         16  ET-LF-NEW-TERM          PIC S999      COMP-3.
  1974         16  ET-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1975         16  ET-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  1976         16  ET-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  1977         16  ET-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  1978         16  ET-LF-NEW-EXP-DT        PIC XX.
  1979         16  ET-NEW-CRED-BENE        PIC X(25).
  1980         16  ET-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1981         16  FILLER                  PIC X.
  1982         16  ET-AH-NEW-BENCD         PIC XX.
  1983         16  ET-AH-NEW-TERM          PIC S999      COMP-3.
  1984         16  ET-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  1985         16  ET-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  36
* EL055.cbl
  1986         16  ET-AH-NEW-EXP-DT        PIC XX.
  1987*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  1988*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  1989*        16  F                       PIC X(12).
  1990         16  ET-AH-NEW-CP            PIC 99.
  1991         16  ET-SIG-SW               PIC X.
  1992         16  ET-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  1993         16  ET-INS-ORIG-AGE-DEF-FLAG PIC X.
  1994         16  ET-JNT-ORIG-AGE-DEF-FLAG PIC X.
  1995         16  ET-INS-NEW-AGE-DEF-FLAG PIC X.
  1996         16  ET-JNT-NEW-AGE-DEF-FLAG PIC X.
  1997         16  FILLER                  PIC X(33).
  1998     12  ET-CANCEL-RECORD REDEFINES ET-ENDORSEMENT-RECORD.
  1999         16  ET-LF-ORIG-REF-DT       PIC XX.
  2000         16  ET-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  2001         16  ET-AH-ORIG-REF-DT       PIC XX.
  2002         16  ET-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  2003         16  ET-LF-NEW-REF-DT        PIC XX.
  2004         16  ET-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  2005         16  ET-AH-NEW-REF-DT        PIC XX.
  2006         16  ET-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  2007         16  ET-FLAG-CERT            PIC X.
  2008         16  ET-INS-LAST-NAME        PIC X(15).
  2009         16  ET-INS-FIRST-NAME       PIC X(10).
  2010         16  ET-INS-MIDDLE-INIT      PIC X.
  2011         16  ET-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  2012         16  ET-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  2013         16  ET-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  2014         16  ET-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  2015         16  FILLER                  PIC X(262).
  2016     12  ET-MONEY-SW             PIC X.
  2017     12  ET-HEALTH-APP           PIC X.
  2018     12  ET-VOUCHER-SW           PIC X.
  2019     12  ET-PAYEE                PIC X(14).
  2020     12  ET-INPUT-DT             PIC XX.
  2021     12  ET-PROCESS-DT           PIC XX.
  2022     12  ET-LF-COMMISSION        PIC SV9(5)    COMP-3.
  2023     12  ET-AH-COMMISSION        PIC SV9(5)    COMP-3.
  2024     12  ET-REASON-CODES.
  2025         16  F OCCURS 12.
  2026             20  ET-REASON-CODE  PIC X(4).
  2027     12  ET-TEMPLATE-USED        PIC X(8).
  2028     12  ET-DOCU-TYPE            PIC X.
  2029         88  ET-VERI-DOCU          VALUE 'V'.
  2030         88  ET-GCE-DOCU           VALUE 'G'.
  2031         88  ET-CANC-DOCU          VALUE 'C'.
  2032     12  ET-COMMENTS1            PIC X(13).
  2033     12  ET-COMMENTS2            PIC X(70).
  2034     12  ET-COMM-CHGBK           PIC X.
  2035         88  ET-DO-NOT-CHG-ACCT    VALUE 'N'.
  2036         88  ET-CHG-ACCT           VALUE 'Y'.
  2037     12  ET-CSO-PORTION          PIC S9(5)V99  COMP-3.
  2038     12  ET-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  2039     12  ET-BATCH-NUMBER         PIC X(6).
  2040     12  ET-ACCT-SUMM            PIC X.
  2041     12  ET-CSO-SUMM             PIC X.
  2042     12  en-check-type           pic x.
  2043     12  FILLER                  PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  37
* EL055.cbl
  2044******************************************************************
  2045 01  ws-dummy-area               pic x(1000).
  2046 01  ws-misc.
  2047     05  ws-old-pndb-key.
  2048         10  opk-company-cd      pic x.
  2049         10  opk-carrier         pic x.
  2050         10  opk-group           pic x(6).
  2051         10  opk-state           pic xx.
  2052         10  opk-account         pic x(10).
  2053         10  opk-eff-dt          pic xx.
  2054         10  opk-cert-no         pic x(11).
  2055         10  opk-seq-no          pic xx.
  2056         10  opk-rec-type        pic x.
  2057 01  ws-disp-code                pic s9(11).
  2058 01  WS-RESPONSE2                PIC S9(8) COMP VALUE +0.
  2059 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
  2060     88  RESP-NORMAL                    VALUE +0.
  2061     88  resp-file-notfnd               value +12.
  2062     88  RESP-NOTFND                    VALUE +13.
  2063     88  resp-duprec                    value +14.
  2064     88  resp-dupkey                    value +15.
  2065     88  resp-invreq                    value +16.
  2066     88  RESP-NOTOPEN                   VALUE +19.
  2067     88  RESP-ENDFILE                   VALUE +20.
  2068     88  resp-lengtherr                 value +22.
  2069 01  erpndb-ridfld               pic x(11).
  2070 01  erpndb2-ridfld              pic x(36).
  2071 01  elcert-ridfld               pic x(33).
  2072 01  elcrto-ridfld.
  2073     05  filler                  pic x(33).
  2074     05  elcrto-rec-type         pic x.
  2075     05  elcrto-seq-no           pic s9(4) comp.
  2076 01  nsasextr-ridfld.
  2077     05  filler                  pic x(5).
  2078     05  nsasextr-seq-no         pic s9(4) comp.
  2079 01  elcrtt-ridfld.
  2080     05  filler                  pic x(33).
  2081     05  elcrtt-rec-type         pic x.
  2082 01  erarch-ridfld               pic x(5).
  2083 01  erarch2-ridfld.  *>  pic x(37).
  2084     05  erarch2-company-cd      pic x.
  2085     05  erarch2-cert-no         pic x(11).
  2086     05  erarch2-carrier         pic x.
  2087     05  erarch2-group           pic x(6).
  2088     05  erarch2-state           pic xx.
  2089     05  erarch2-account         pic x(10).
  2090     05  erarch2-eff-dt          pic xx.
  2091     05  erarch2-arch-no         pic s9(8) comp.
  2092 01  erchek-ridfld.
  2093     05  filler                  pic x(33).
  2094     05  erchek-seq-no           pic s9(4) comp.
  2095 01  ercnot-ridfld.
  2096     05  filler                  pic x(33).
  2097     05  ercnot-rec-type         pic x.
  2098     05  ercnot-seq-no           pic s9(4) comp.
  2099 01  ernote-ridfld               pic x(33).
  2100 01  ermail-ridfld               pic x(33).
  2101 01  erendr-ridfld.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  38
* EL055.cbl
  2102     05  filler                  pic x(33).
  2103     05  erendr-seq-no           pic s9(4) comp.
  2104     05  erendr-rec-type         pic x.
  2105 01  erendt-ridfld.
  2106     05  filler                  pic x(33).
  2107     05  erendt-rec-type         pic x.
  2108     05  erendt-seq-no           pic s9(4) comp.
  2109 01  msg-error.
  2110     05  filler                  pic x(08) value ' error- '.
  2111     05  me-response             pic 9(5)  value zeros.
  2112     05  filler                  pic xx value spaces.
  2113     05  me-response2            pic 9(5)  value zeros.
  2114     05  filler                  pic x(5)  value spaces.
  2115     05  me-command              pic x(20) value spaces.
  2116 01  WS-PASS-AREA.
  2117     05  PA-ERPNDB-KEY           PIC X(11).
  2118     05  pa-new-pndb-key.
  2119         10  filler              pic x(20).
  2120         10  pa-new-eff-dt       pic xx.
  2121         10  pa-new-cert-no      pic x(11).
  2122         10  filler              pic xxx.
  2123     05  pa-return-area.
  2124         10  ra-status-code      pic 9(4).
  2125         10  ra-message          pic x(205).
  2126*                                COPY ELCDATE.
  2127******************************************************************
  2128*                                                                *
  2129*                                                                *
  2130*                            ELCDATE.                            *
  2131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2132*                            VMOD=2.003
  2133*                                                                *
  2134*                                                                *
  2135*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2136*                 LENGTH = 200                                   *
  2137******************************************************************
  2138
  2139 01  DATE-CONVERSION-DATA.
  2140     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2141     12  DC-OPTION-CODE                PIC X.
  2142         88  BIN-TO-GREG                VALUE ' '.
  2143         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2144         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2145         88  YMD-GREG-TO-BIN            VALUE '3'.
  2146         88  MDY-GREG-TO-BIN            VALUE '4'.
  2147         88  JULIAN-TO-BIN              VALUE '5'.
  2148         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2149         88  FIND-CENTURY               VALUE '7'.
  2150         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2151         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2152         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2153         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2154         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2155         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2156         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2157         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2158         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2159         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  39
* EL055.cbl
  2160         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2161         88  BIN-3-TO-GREG              VALUE 'I'.
  2162         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2163         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2164         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2165         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2166         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2167         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2168         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2169         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2170         88  THREE-CHARACTER-BIN
  2171                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2172         88  GREGORIAN-TO-BIN
  2173                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2174         88  BIN-TO-GREGORIAN
  2175                  VALUES ' ' '1' 'I' '8' 'G'.
  2176         88  JULIAN-TO-BINARY
  2177                  VALUES '5' 'C' 'E' 'F'.
  2178     12  DC-ERROR-CODE                 PIC X.
  2179         88  NO-CONVERSION-ERROR        VALUE ' '.
  2180         88  DATE-CONVERSION-ERROR
  2181                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2182         88  DATE-IS-ZERO               VALUE '1'.
  2183         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2184         88  DATE-IS-INVALID            VALUE '3'.
  2185         88  DATE1-GREATER-DATE2        VALUE '4'.
  2186         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2187         88  DATE-INVALID-OPTION        VALUE '9'.
  2188         88  INVALID-CENTURY            VALUE 'A'.
  2189         88  ONLY-CENTURY               VALUE 'B'.
  2190         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2191         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2192     12  DC-END-OF-MONTH               PIC X.
  2193         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2194     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2195         88  USE-NORMAL-PROCESS         VALUE ' '.
  2196         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2197         88  ADJUST-UP-100-YRS          VALUE '2'.
  2198     12  FILLER                        PIC X.
  2199     12  DC-CONVERSION-DATES.
  2200         16  DC-BIN-DATE-1             PIC XX.
  2201         16  DC-BIN-DATE-2             PIC XX.
  2202         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2203         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2204                       DC-GREG-DATE-1-EDIT.
  2205             20  DC-EDIT1-MONTH        PIC 99.
  2206             20  SLASH1-1              PIC X.
  2207             20  DC-EDIT1-DAY          PIC 99.
  2208             20  SLASH1-2              PIC X.
  2209             20  DC-EDIT1-YEAR         PIC 99.
  2210         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2211         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2212                     DC-GREG-DATE-2-EDIT.
  2213             20  DC-EDIT2-MONTH        PIC 99.
  2214             20  SLASH2-1              PIC X.
  2215             20  DC-EDIT2-DAY          PIC 99.
  2216             20  SLASH2-2              PIC X.
  2217             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  40
* EL055.cbl
  2218         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2219         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2220                     DC-GREG-DATE-1-YMD.
  2221             20  DC-YMD-YEAR           PIC 99.
  2222             20  DC-YMD-MONTH          PIC 99.
  2223             20  DC-YMD-DAY            PIC 99.
  2224         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2225         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2226                      DC-GREG-DATE-1-MDY.
  2227             20  DC-MDY-MONTH          PIC 99.
  2228             20  DC-MDY-DAY            PIC 99.
  2229             20  DC-MDY-YEAR           PIC 99.
  2230         16  DC-GREG-DATE-1-ALPHA.
  2231             20  DC-ALPHA-MONTH        PIC X(10).
  2232             20  DC-ALPHA-DAY          PIC 99.
  2233             20  FILLER                PIC XX.
  2234             20  DC-ALPHA-CENTURY.
  2235                 24 DC-ALPHA-CEN-N     PIC 99.
  2236             20  DC-ALPHA-YEAR         PIC 99.
  2237         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2238         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2239         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2240         16  DC-JULIAN-DATE            PIC 9(05).
  2241         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2242                                       PIC 9(05).
  2243         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2244             20  DC-JULIAN-YEAR        PIC 99.
  2245             20  DC-JULIAN-DAYS        PIC 999.
  2246         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2247         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2248         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2249     12  DATE-CONVERSION-VARIBLES.
  2250         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2251         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2252             20  FILLER                PIC 9(3).
  2253             20  HOLD-CEN-1-CCYY.
  2254                 24  HOLD-CEN-1-CC     PIC 99.
  2255                 24  HOLD-CEN-1-YY     PIC 99.
  2256             20  HOLD-CEN-1-MO         PIC 99.
  2257             20  HOLD-CEN-1-DA         PIC 99.
  2258         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2259             20  HOLD-CEN-1-R-MO       PIC 99.
  2260             20  HOLD-CEN-1-R-DA       PIC 99.
  2261             20  HOLD-CEN-1-R-CCYY.
  2262                 24  HOLD-CEN-1-R-CC   PIC 99.
  2263                 24  HOLD-CEN-1-R-YY   PIC 99.
  2264             20  FILLER                PIC 9(3).
  2265         16  HOLD-CENTURY-1-X.
  2266             20  FILLER                PIC X(3)  VALUE SPACES.
  2267             20  HOLD-CEN-1-X-CCYY.
  2268                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2269                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2270             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2271             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2272         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2273             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2274             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2275             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  41
* EL055.cbl
  2276                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2277                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2278             20  FILLER                PIC XXX.
  2279         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2280         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2281         16  DC-JULIAN-DATE-1          PIC 9(07).
  2282         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2283             20  DC-JULIAN-1-CCYY.
  2284                 24  DC-JULIAN-1-CC    PIC 99.
  2285                 24  DC-JULIAN-1-YR    PIC 99.
  2286             20  DC-JULIAN-DA-1        PIC 999.
  2287         16  DC-JULIAN-DATE-2          PIC 9(07).
  2288         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2289             20  DC-JULIAN-2-CCYY.
  2290                 24  DC-JULIAN-2-CC    PIC 99.
  2291                 24  DC-JULIAN-2-YR    PIC 99.
  2292             20  DC-JULIAN-DA-2        PIC 999.
  2293         16  DC-GREG-DATE-A-EDIT.
  2294             20  DC-EDITA-MONTH        PIC 99.
  2295             20  SLASHA-1              PIC X VALUE '/'.
  2296             20  DC-EDITA-DAY          PIC 99.
  2297             20  SLASHA-2              PIC X VALUE '/'.
  2298             20  DC-EDITA-CCYY.
  2299                 24  DC-EDITA-CENT     PIC 99.
  2300                 24  DC-EDITA-YEAR     PIC 99.
  2301         16  DC-GREG-DATE-B-EDIT.
  2302             20  DC-EDITB-MONTH        PIC 99.
  2303             20  SLASHB-1              PIC X VALUE '/'.
  2304             20  DC-EDITB-DAY          PIC 99.
  2305             20  SLASHB-2              PIC X VALUE '/'.
  2306             20  DC-EDITB-CCYY.
  2307                 24  DC-EDITB-CENT     PIC 99.
  2308                 24  DC-EDITB-YEAR     PIC 99.
  2309         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2310         16  DC-GREG-DATE-CYMD-R REDEFINES
  2311                              DC-GREG-DATE-CYMD.
  2312             20  DC-CYMD-CEN           PIC 99.
  2313             20  DC-CYMD-YEAR          PIC 99.
  2314             20  DC-CYMD-MONTH         PIC 99.
  2315             20  DC-CYMD-DAY           PIC 99.
  2316         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2317         16  DC-GREG-DATE-MDCY-R REDEFINES
  2318                              DC-GREG-DATE-MDCY.
  2319             20  DC-MDCY-MONTH         PIC 99.
  2320             20  DC-MDCY-DAY           PIC 99.
  2321             20  DC-MDCY-CEN           PIC 99.
  2322             20  DC-MDCY-YEAR          PIC 99.
  2323    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2324        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2325    12  DC-EL310-DATE                  PIC X(21).
  2326    12  FILLER                         PIC X(28).
  2327****************************************************************
  2328*
  2329* Copyright (c) 2007-2013 Dell Inc.
  2330* All rights reserved.
  2331*
  2332****************************************************************
  2333 01  DFHEIV.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  42
* EL055.cbl
  2334   02  DFHEIV0               PIC X(35).
  2335   02  DFHEIV1               PIC X(08).
  2336   02  DFHEIV2               PIC X(08).
  2337   02  DFHEIV3               PIC X(08).
  2338   02  DFHEIV4               PIC X(06).
  2339   02  DFHEIV5               PIC X(04).
  2340   02  DFHEIV6               PIC X(04).
  2341   02  DFHEIV7               PIC X(02).
  2342   02  DFHEIV8               PIC X(02).
  2343   02  DFHEIV9               PIC X(01).
  2344   02  DFHEIV10              PIC S9(7) COMP-3.
  2345   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2346   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2347   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2348   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2349   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2350   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2351   02  DFHEIV17              PIC X(04).
  2352   02  DFHEIV18              PIC X(04).
  2353   02  DFHEIV19              PIC X(04).
  2354   02  DFHEIV20              USAGE IS POINTER.
  2355   02  DFHEIV21              USAGE IS POINTER.
  2356   02  DFHEIV22              USAGE IS POINTER.
  2357   02  DFHEIV23              USAGE IS POINTER.
  2358   02  DFHEIV24              USAGE IS POINTER.
  2359   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2360   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2361   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2362   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2363   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2364   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2365   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2366   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2367   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2368   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2369   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2370   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2371   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2372   02  FILLER                PIC X(02).
  2373   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2374   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2375   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2376   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2377   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2378   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2379   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2380 LINKAGE  SECTION.
  2381*****************************************************************
  2382*                                                               *
  2383* Copyright (c) 2007-2013 Dell Inc.                             *
  2384* All rights reserved.                                          *
  2385*                                                               *
  2386*****************************************************************
  2387 01  dfheiblk.
  2388     02  eibtime          pic s9(7) comp-3.
  2389     02  eibdate          pic s9(7) comp-3.
  2390     02  eibtrnid         pic x(4).
  2391     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  43
* EL055.cbl
  2392     02  eibtrmid         pic x(4).
  2393     02  dfheigdi         pic s9(4) comp.
  2394     02  eibcposn         pic s9(4) comp.
  2395     02  eibcalen         pic s9(4) comp.
  2396     02  eibaid           pic x(1).
  2397     02  eibfiller1       pic x(1).
  2398     02  eibfn            pic x(2).
  2399     02  eibfiller2       pic x(2).
  2400     02  eibrcode         pic x(6).
  2401     02  eibfiller3       pic x(2).
  2402     02  eibds            pic x(8).
  2403     02  eibreqid         pic x(8).
  2404     02  eibrsrce         pic x(8).
  2405     02  eibsync          pic x(1).
  2406     02  eibfree          pic x(1).
  2407     02  eibrecv          pic x(1).
  2408     02  eibsend          pic x(1).
  2409     02  eibatt           pic x(1).
  2410     02  eibeoc           pic x(1).
  2411     02  eibfmh           pic x(1).
  2412     02  eibcompl         pic x(1).
  2413     02  eibsig           pic x(1).
  2414     02  eibconf          pic x(1).
  2415     02  eiberr           pic x(1).
  2416     02  eibrldbk         pic x(1).
  2417     02  eiberrcd         pic x(4).
  2418     02  eibsynrb         pic x(1).
  2419     02  eibnodat         pic x(1).
  2420     02  eibfiller5       pic x(2).
  2421     02  eibresp          pic s9(8) comp.
  2422     02  eibresp2         pic s9(8) comp.
  2423     02  dfheigdj         pic s9(4) comp.
  2424     02  dfheigdk         pic s9(4) comp.
  2425 01  DFHCOMMAREA                 PIC X(256).
  2426 01  var  pic x(30).
  2427 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2428 0000-DFHEXIT SECTION.
  2429     MOVE '9#                    $   ' TO DFHEIV0.
  2430     MOVE 'EL055' TO DFHEIV1.
  2431     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2432     display ' entering program EL055'
  2433     perform 0010-init           thru 0010-exit
  2434     perform 0100-check-validity thru 0100-exit
  2435     perform 0200-convert-key    thru 0200-exit
  2436     perform 0050-bld-return-area thru 0050-exit
  2437     .
  2438 0000-return.
  2439     move ws-pass-area           to dfhcommarea
  2440
  2441* exec cics return
  2442*    end-exec
  2443*    MOVE '.(                    ''   #00002436' TO DFHEIV0
  2444     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2445     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2446     MOVE X'2020233030303032343336' TO DFHEIV0(25:11)
  2447     CALL 'kxdfhei1' USING DFHEIV0,
  2448           DFHEIV99,
  2449           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  44
* EL055.cbl
  2450           DFHEIV99,
  2451           DFHEIV99,
  2452           DFHEIV99,
  2453           DFHEIV99
  2454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2455
  2456* GOBACK
  2457
  2458     MOVE '9%                    "   ' TO DFHEIV0
  2459     MOVE 'EL055' TO DFHEIV1
  2460     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2461     GOBACK
  2462     .
  2463 0010-init.
  2464     move dfhcommarea            to ws-pass-AREA
  2465     set P to address of KIXSYS
  2466     CALL "getenv" using by value P returning var-ptr
  2467     if var-ptr = null then
  2468        display ' kixsys not set '
  2469     else
  2470        set address of var to var-ptr
  2471        move 0 to env-var-len
  2472        inspect var tallying env-var-len
  2473          for characters before X'00'
  2474        unstring var (1:env-var-len) delimited by '/'
  2475           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2476              WS-KIX-SYS
  2477        end-unstring
  2478     end-if
  2479     .
  2480 0010-exit.
  2481     exit.
  2482 0050-bld-return-area.
  2483     move zeros                  to ra-status-code
  2484     move 'SUCCESS'              to ra-message
  2485     .
  2486 0050-exit.
  2487     exit.
  2488 0100-check-validity.
  2489**** ======================================================== ****
  2490****                                                          ****
  2491****    Make sure Key to change exists on ERPNDB              ****
  2492****                                                          ****
  2493**** ======================================================== ****
  2494     move PA-ERPNDB-KEY          to erpndb-ridfld
  2495
  2496* exec cics read
  2497*       dataset    ('ERPNDB')
  2498*       ridfld     (erpndb-ridfld)
  2499*       into       (pending-business)
  2500*       resp       (ws-response)
  2501*    end-exec
  2502     MOVE LENGTH OF
  2503      pending-business
  2504       TO DFHEIV11
  2505     MOVE 'ERPNDB' TO DFHEIV1
  2506*    MOVE '&"IL       E          (  N#00002472' TO DFHEIV0
  2507     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  45
* EL055.cbl
  2508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2509     MOVE X'204E233030303032343732' TO DFHEIV0(25:11)
  2510     CALL 'kxdfhei1' USING DFHEIV0,
  2511           DFHEIV1,
  2512           pending-business,
  2513           DFHEIV11,
  2514           erpndb-ridfld,
  2515           DFHEIV99,
  2516           DFHEIV99,
  2517           DFHEIV99
  2518     MOVE EIBRESP  TO ws-response
  2519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2520     if not resp-normal
  2521        move ws-response         to ra-status-code
  2522        move ' erpndb read error '
  2523                                 to ra-message
  2524        display 'error-erpndb-read ' ws-response
  2525        go to 0000-return
  2526     end-if
  2527     move pb-control-by-account  to ws-old-pndb-key
  2528     move pb-cert-eff-dt         to dc-bin-date-1
  2529     move ' '                    to dc-option-code
  2530     perform 8500-date-convert   thru 8500-exit
  2531     if no-conversion-error
  2532        string
  2533           dc-cymd-cen
  2534           dc-cymd-year   '-'
  2535           dc-cymd-month  '-'
  2536           dc-cymd-day delimited by size
  2537              into ws-old-greg-eff-date
  2538        end-string
  2539     else
  2540        display ' Bad eff date convert ' pb-cert-no
  2541        go to 0000-return
  2542     end-if
  2543***  Might as well convert the new effective dt while we're at it
  2544     move pa-new-eff-dt          to dc-bin-date-1
  2545     move ' '                    to dc-option-code
  2546     perform 8500-date-convert   thru 8500-exit
  2547     if no-conversion-error
  2548        string
  2549           dc-cymd-cen
  2550           dc-cymd-year   '-'
  2551           dc-cymd-month  '-'
  2552           dc-cymd-day delimited by size
  2553              into ws-new-greg-eff-date
  2554        end-string
  2555     else
  2556        display ' Bad new eff date convert ' pb-cert-no
  2557        go to 0000-return
  2558     end-if
  2559**** ======================================================== ****
  2560**** ======================================================== ****
  2561****                                                          ****
  2562****    Make sure Key to change exists on ELCERT              ****
  2563****                                                          ****
  2564**** ======================================================== ****
  2565     move spaces                 to ws-bypass-ind
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  46
* EL055.cbl
  2566     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2567
  2568* exec cics read
  2569*       dataset    ('ELCERT')
  2570*       ridfld     (elcert-ridfld)
  2571*       into       (certificate-master)
  2572*       resp       (ws-response)
  2573*    end-exec
  2574     MOVE LENGTH OF
  2575      certificate-master
  2576       TO DFHEIV11
  2577     MOVE 'ELCERT' TO DFHEIV1
  2578*    MOVE '&"IL       E          (  N#00002525' TO DFHEIV0
  2579     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2580     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2581     MOVE X'204E233030303032353235' TO DFHEIV0(25:11)
  2582     CALL 'kxdfhei1' USING DFHEIV0,
  2583           DFHEIV1,
  2584           certificate-master,
  2585           DFHEIV11,
  2586           elcert-ridfld,
  2587           DFHEIV99,
  2588           DFHEIV99,
  2589           DFHEIV99
  2590     MOVE EIBRESP  TO ws-response
  2591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2592     if not resp-normal
  2593        move ws-response         to ra-status-code
  2594        move ' elcert read error '
  2595                                 to ra-message
  2596        display 'error-elcert-read ' ws-response
  2597        go to 0000-return
  2598     end-if
  2599     if cert-added-batch
  2600        set bypass-copy-files to true
  2601     end-if
  2602     if (cert-and-claim-online)
  2603        or (cert-was-created-for-claim)
  2604        or (cm-claim-attached-count > zeros)
  2605        move +99                 to ra-status-code
  2606        move 'Claim Exists '     to ra-message
  2607        go to 0000-return
  2608     end-if
  2609**** ======================================================== ****
  2610**** ======================================================== ****
  2611****                                                          ****
  2612****    Make sure new key does NOT exist on ERPNDB2           ****
  2613****                                                          ****
  2614**** ======================================================== ****
  2615     move PA-new-pndb-key        to erpndb2-ridfld
  2616
  2617* exec cics read
  2618*       dataset    ('ERPNDB2')
  2619*       ridfld     (erpndb2-ridfld)
  2620*       into       (ws-dummy-area)
  2621*       resp       (ws-response)
  2622*    end-exec
  2623     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  47
* EL055.cbl
  2624      ws-dummy-area
  2625       TO DFHEIV11
  2626     MOVE 'ERPNDB2' TO DFHEIV1
  2627*    MOVE '&"IL       E          (  N#00002555' TO DFHEIV0
  2628     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2629     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2630     MOVE X'204E233030303032353535' TO DFHEIV0(25:11)
  2631     CALL 'kxdfhei1' USING DFHEIV0,
  2632           DFHEIV1,
  2633           ws-dummy-area,
  2634           DFHEIV11,
  2635           erpndb2-ridfld,
  2636           DFHEIV99,
  2637           DFHEIV99,
  2638           DFHEIV99
  2639     MOVE EIBRESP  TO ws-response
  2640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2641     if (not RESP-NOTFND)
  2642        and (not resp-endfile)
  2643        move +88                 to ra-status-code
  2644        move ' pndb already exists '
  2645                                 to ra-message
  2646        display 'error-erpndb2-read ' ws-response
  2647        go to 0000-return
  2648     end-if
  2649**** ======================================================== ****
  2650**** ======================================================== ****
  2651****                                                          ****
  2652****    Make sure new key does NOT exist on ELCERT            ****
  2653****                                                          ****
  2654**** ======================================================== ****
  2655     move PA-new-pndb-key(1:33)  to elcert-ridfld
  2656
  2657* exec cics read
  2658*       dataset    ('ELCERT')
  2659*       ridfld     (elcert-ridfld)
  2660*       into       (ws-dummy-area)
  2661*       resp       (ws-response)
  2662*    end-exec
  2663     MOVE LENGTH OF
  2664      ws-dummy-area
  2665       TO DFHEIV11
  2666     MOVE 'ELCERT' TO DFHEIV1
  2667*    MOVE '&"IL       E          (  N#00002576' TO DFHEIV0
  2668     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2669     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2670     MOVE X'204E233030303032353736' TO DFHEIV0(25:11)
  2671     CALL 'kxdfhei1' USING DFHEIV0,
  2672           DFHEIV1,
  2673           ws-dummy-area,
  2674           DFHEIV11,
  2675           elcert-ridfld,
  2676           DFHEIV99,
  2677           DFHEIV99,
  2678           DFHEIV99
  2679     MOVE EIBRESP  TO ws-response
  2680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2681     if (not RESP-NOTFND)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  48
* EL055.cbl
  2682        and (not resp-endfile)
  2683        display ' setting status to 88 '
  2684        move +88                 to ra-status-code
  2685        move ' elcert already exist '
  2686                                 to ra-message
  2687        display 'error-elcert-read-exists ' ws-response
  2688        go to 0000-return
  2689     end-if
  2690**** ======================================================== ****
  2691**** ======================================================== ****
  2692****                                                          ****
  2693****    Right here, 1)rewrite erpndb with new key, 2)delete   ****
  2694****  elcert.                                                 ****
  2695****                                                          ****
  2696**** ======================================================== ****
  2697** 1)  Rewrite erpndb with new key
  2698     move PA-ERPNDB-KEY          to erpndb-ridfld
  2699
  2700* exec cics read update
  2701*       dataset    ('ERPNDB')
  2702*       ridfld     (erpndb-ridfld)
  2703*       into       (pending-business)
  2704*       resp       (ws-response)
  2705*    end-exec
  2706     MOVE LENGTH OF
  2707      pending-business
  2708       TO DFHEIV11
  2709     MOVE 'ERPNDB' TO DFHEIV1
  2710*    MOVE '&"IL       EU         (  N#00002600' TO DFHEIV0
  2711     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2713     MOVE X'204E233030303032363030' TO DFHEIV0(25:11)
  2714     CALL 'kxdfhei1' USING DFHEIV0,
  2715           DFHEIV1,
  2716           pending-business,
  2717           DFHEIV11,
  2718           erpndb-ridfld,
  2719           DFHEIV99,
  2720           DFHEIV99,
  2721           DFHEIV99
  2722     MOVE EIBRESP  TO ws-response
  2723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2724     if not resp-normal
  2725        move ws-response         to ra-status-code
  2726        move ' erpndb read update error '
  2727                                 to ra-message
  2728        display 'error-erpndb-read update ' ws-response
  2729        go to 0000-return
  2730     end-if
  2731     move pa-new-eff-dt          to pb-cert-eff-dt
  2732     move pa-new-cert-no         to pb-cert-no
  2733
  2734* exec cics rewrite
  2735*       dataset  ('ERPNDB')
  2736*       from     (pending-business)
  2737*       resp     (ws-response)
  2738*    end-exec
  2739     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  49
* EL055.cbl
  2740      pending-business
  2741       TO DFHEIV11
  2742     MOVE 'ERPNDB' TO DFHEIV1
  2743*    MOVE '&& L                  %  N#00002615' TO DFHEIV0
  2744     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2745     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2746     MOVE X'204E233030303032363135' TO DFHEIV0(25:11)
  2747     CALL 'kxdfhei1' USING DFHEIV0,
  2748           DFHEIV1,
  2749           pending-business,
  2750           DFHEIV11,
  2751           DFHEIV99
  2752     MOVE EIBRESP  TO ws-response
  2753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2754     if not resp-normal
  2755        move ws-response         to ra-status-code
  2756        move ' erpndb rewrite error '
  2757                                 to ra-message
  2758        display 'error-erpndb-rewrite ' ws-response
  2759        go to 0000-return
  2760     end-if
  2761     .
  2762 0100-check-for-claim.
  2763     if bypass-copy-files
  2764        go to 0000-return
  2765     end-if
  2766     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2767
  2768* exec cics read update
  2769*       dataset    ('ELCERT')
  2770*       ridfld     (elcert-ridfld)
  2771*       into       (certificate-master)
  2772*       resp       (ws-response)
  2773*    end-exec
  2774     MOVE LENGTH OF
  2775      certificate-master
  2776       TO DFHEIV11
  2777     MOVE 'ELCERT' TO DFHEIV1
  2778*    MOVE '&"IL       EU         (  N#00002633' TO DFHEIV0
  2779     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2780     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2781     MOVE X'204E233030303032363333' TO DFHEIV0(25:11)
  2782     CALL 'kxdfhei1' USING DFHEIV0,
  2783           DFHEIV1,
  2784           certificate-master,
  2785           DFHEIV11,
  2786           elcert-ridfld,
  2787           DFHEIV99,
  2788           DFHEIV99,
  2789           DFHEIV99
  2790     MOVE EIBRESP  TO ws-response
  2791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2792     if (cert-added-batch)
  2793        or (cert-and-claim-online)
  2794        or (cert-was-created-for-claim)
  2795        continue
  2796     else
  2797        go to 0100-delete-elcert
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  50
* EL055.cbl
  2798     end-if
  2799     if (no-claim-attached)
  2800        or (cert-added-batch)
  2801
  2802* exec cics unlock
  2803*          dataset   ('ELCERT')
  2804*          resp      (ws-response)
  2805*       end-exec
  2806     MOVE 'ELCERT' TO DFHEIV1
  2807*    MOVE '&*                    #  N#00002648' TO DFHEIV0
  2808     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2809     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2810     MOVE X'204E233030303032363438' TO DFHEIV0(25:11)
  2811     CALL 'kxdfhei1' USING DFHEIV0,
  2812           DFHEIV1,
  2813           DFHEIV99
  2814     MOVE EIBRESP  TO ws-response
  2815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2816     else
  2817        move spaces              to cm-credit-interface-sw-1
  2818        move '2'                 to cm-claim-interface-sw
  2819
  2820* exec cics rewrite
  2821*          dataset   ('ELCERT')
  2822*          from      (certificate-master)
  2823*          resp      (ws-response)
  2824*       end-exec
  2825     MOVE LENGTH OF
  2826      certificate-master
  2827       TO DFHEIV11
  2828     MOVE 'ELCERT' TO DFHEIV1
  2829*    MOVE '&& L                  %  N#00002655' TO DFHEIV0
  2830     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2831     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2832     MOVE X'204E233030303032363535' TO DFHEIV0(25:11)
  2833     CALL 'kxdfhei1' USING DFHEIV0,
  2834           DFHEIV1,
  2835           certificate-master,
  2836           DFHEIV11,
  2837           DFHEIV99
  2838     MOVE EIBRESP  TO ws-response
  2839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2840     end-if
  2841     if not resp-normal
  2842        move ws-response         to ra-status-code
  2843        move ' elcert rewrite error clm '
  2844                                 to ra-message
  2845        display 'error-elcert-rewrite ' ws-response
  2846        go to 0000-return
  2847     end-if
  2848     go to 0100-write-new-elcert
  2849     .
  2850 0100-delete-elcert.
  2851** 2)  Delete ELCERT (old key)
  2852     move ws-old-pndb-key(1:33)  to elcert-ridfld
  2853
  2854* exec cics delete
  2855*       dataset  ('ELCERT')
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  51
* EL055.cbl
  2856*       resp     (ws-response)
  2857*    end-exec
  2858     MOVE 'ELCERT' TO DFHEIV1
  2859*    MOVE '&(                    &  N#00002673' TO DFHEIV0
  2860     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2861     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2862     MOVE X'204E233030303032363733' TO DFHEIV0(25:11)
  2863     CALL 'kxdfhei1' USING DFHEIV0,
  2864           DFHEIV1,
  2865           DFHEIV99,
  2866           DFHEIV99,
  2867           DFHEIV99,
  2868           DFHEIV99
  2869     MOVE EIBRESP  TO ws-response
  2870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2871     if not resp-normal
  2872        move ws-response         to ra-status-code
  2873        move ' elcert delete error '
  2874                                 to ra-message
  2875        display 'error-elcert-delete  ' ws-response
  2876        go to 0000-return
  2877     end-if
  2878     .
  2879 0100-write-new-elcert.
  2880**  This is commented out because I want EL6311 to write
  2881**    the new ELCERT record.
  2882** 3)  Write new ELCERT record
  2883**  Not now. Let el6311 write the new one??
  2884**   move pa-new-eff-dt          to cm-cert-eff-dt
  2885**   move pa-new-cert-no         to cm-cert-no
  2886**
  2887**   exec cics write
  2888**      dataset  ('ELCERT')
  2889**      from     (certificate-master)
  2890**      ridfld   (cm-control-primary)
  2891**      resp     (ws-response)
  2892**   end-exec
  2893**
  2894**   if not resp-normal
  2895**      move ws-response         to ra-status-code
  2896**                               to ra-message
  2897**      display 'error-elcert-write   ' ws-response
  2898**      go to 0000-return
  2899**   end-if
  2900**** ======================================================== ****
  2901****                                                          ****
  2902****    Check for ELCRTO records                              ****
  2903****                                                          ****
  2904**** ======================================================== ****
  2905     move ' '                    to ws-startbr-ind
  2906     move ws-old-pndb-key(1:33)  to elcrto-ridfld(1:33)
  2907     move opk-rec-type           to elcrto-rec-type
  2908     move +0                     to elcrto-seq-no
  2909
  2910* exec cics startbr
  2911*       dataset    ('ELCRTO')
  2912*       ridfld     (elcrto-ridfld)
  2913*       gteq
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  52
* EL055.cbl
  2914*       resp       (ws-response)
  2915*    end-exec
  2916     MOVE 'ELCRTO' TO DFHEIV1
  2917     MOVE 0
  2918       TO DFHEIV11
  2919*    MOVE '&,         G          &  N#00002716' TO DFHEIV0
  2920     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2921     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2922     MOVE X'204E233030303032373136' TO DFHEIV0(25:11)
  2923     CALL 'kxdfhei1' USING DFHEIV0,
  2924           DFHEIV1,
  2925           elcrto-ridfld,
  2926           DFHEIV99,
  2927           DFHEIV11,
  2928           DFHEIV99
  2929     MOVE EIBRESP  TO ws-response
  2930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2931     if RESP-NOTFND or resp-endfile
  2932        go to 0100-end-elcrto
  2933     else
  2934        if not resp-normal
  2935           move ws-response      to ra-status-code
  2936           move ' elcrto error startbr '
  2937                                 to ra-message
  2938           display 'error-elcrto-startbr ' ws-response
  2939           go to 0000-return
  2940        end-if
  2941     end-if
  2942     move 'Y'                    to ws-startbr-ind
  2943     .
  2944 0100-elcrto-loop.
  2945
  2946* exec cics readnext
  2947*       dataset    ('ELCRTO')
  2948*       ridfld     (elcrto-ridfld)
  2949*       into       (original-certificate)
  2950*       resp       (ws-response)
  2951*    end-exec
  2952     MOVE LENGTH OF
  2953      original-certificate
  2954       TO DFHEIV12
  2955     MOVE 'ELCRTO' TO DFHEIV1
  2956     MOVE 0
  2957       TO DFHEIV11
  2958*    MOVE '&.IL                  )  N#00002736' TO DFHEIV0
  2959     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2960     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2961     MOVE X'204E233030303032373336' TO DFHEIV0(25:11)
  2962     CALL 'kxdfhei1' USING DFHEIV0,
  2963           DFHEIV1,
  2964           original-certificate,
  2965           DFHEIV12,
  2966           elcrto-ridfld,
  2967           DFHEIV99,
  2968           DFHEIV11,
  2969           DFHEIV99,
  2970           DFHEIV99
  2971     MOVE EIBRESP  TO ws-response
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  53
* EL055.cbl
  2972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2973     if (RESP-NOTFND)
  2974        or (resp-endfile)
  2975        or (elcrto-ridfld(1:33) <> ws-old-pndb-key(1:33))
  2976        go to 0100-end-elcrto
  2977     else
  2978        if not resp-normal
  2979           move ws-response      to ra-status-code
  2980           move ' elcrto error readnext '
  2981                                 to ra-message
  2982           display 'error-elcrto-readnext ' ws-response
  2983           go to 0000-return
  2984        end-if
  2985     end-if
  2986     if opk-rec-type <> oc-record-type
  2987        go to 0100-elcrto-loop
  2988     end-if
  2989***  delete and add with new key right here!!!
  2990
  2991* exec cics delete
  2992*       dataset  ('ELCRTO')
  2993*       ridfld   (elcrto-ridfld)
  2994*       resp     (ws-response)
  2995*    end-exec
  2996     MOVE 'ELCRTO' TO DFHEIV1
  2997*    MOVE '&(  R                 &  N#00002759' TO DFHEIV0
  2998     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  2999     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3000     MOVE X'204E233030303032373539' TO DFHEIV0(25:11)
  3001     CALL 'kxdfhei1' USING DFHEIV0,
  3002           DFHEIV1,
  3003           elcrto-ridfld,
  3004           DFHEIV99,
  3005           DFHEIV99,
  3006           DFHEIV99
  3007     MOVE EIBRESP  TO ws-response
  3008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3009     if not resp-normal
  3010        move ws-response         to ra-status-code
  3011        move ' elcrto delete error '
  3012                                 to ra-message
  3013        display 'error-elcrto-delete  ' ws-response
  3014        go to 0000-return
  3015     end-if
  3016     move pa-new-eff-dt          to oc-cert-eff-dt
  3017     move pa-new-cert-no         to oc-cert-no
  3018
  3019* exec cics write
  3020*       dataset  ('ELCRTO')
  3021*       from     (original-certificate)
  3022*       ridfld   (oc-control-primary)
  3023*       resp     (ws-response)
  3024*    end-exec
  3025     MOVE LENGTH OF
  3026      original-certificate
  3027       TO DFHEIV11
  3028     MOVE 'ELCRTO' TO DFHEIV1
  3029*    MOVE '&$ L                  ''  N#00002773' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  54
* EL055.cbl
  3030     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3031     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3032     MOVE X'204E233030303032373733' TO DFHEIV0(25:11)
  3033     CALL 'kxdfhei1' USING DFHEIV0,
  3034           DFHEIV1,
  3035           original-certificate,
  3036           DFHEIV11,
  3037           oc-control-primary,
  3038           DFHEIV99,
  3039           DFHEIV99
  3040     MOVE EIBRESP  TO ws-response
  3041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3042     if not resp-normal
  3043        move ws-response         to ra-status-code
  3044        move ' elcrto write  error '
  3045                                 to ra-message
  3046        display 'error-elcrto-write   ' ws-response
  3047        go to 0000-return
  3048     end-if
  3049     go to 0100-elcrto-loop
  3050     .
  3051 0100-end-elcrto.
  3052     if ws-startbr-ind = 'Y'
  3053
  3054* exec cics endbr
  3055*          dataset     ('ELCRTO')
  3056*       end-exec
  3057     MOVE 'ELCRTO' TO DFHEIV1
  3058     MOVE 0
  3059       TO DFHEIV11
  3060*    MOVE '&2                    $   #00002790' TO DFHEIV0
  3061     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3062     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3063     MOVE X'2020233030303032373930' TO DFHEIV0(25:11)
  3064     CALL 'kxdfhei1' USING DFHEIV0,
  3065           DFHEIV1,
  3066           DFHEIV11,
  3067           DFHEIV99
  3068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3069     end-if
  3070      .
  3071 0100-elcrtt.
  3072**** ======================================================== ****
  3073****                                                          ****
  3074****    Check for ELCRTT records                              ****
  3075****                                                          ****
  3076**** ======================================================== ****
  3077     move ' '                    to ws-startbr-ind
  3078     move ws-old-pndb-key(1:33)  to elcrtt-ridfld(1:33)
  3079     move ' '                    to elcrtt-rec-type
  3080
  3081* exec cics startbr
  3082*       dataset    ('ELCRTT')
  3083*       ridfld     (elcrtt-ridfld)
  3084*       gteq
  3085*       resp       (ws-response)
  3086*    end-exec
  3087     MOVE 'ELCRTT' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  55
* EL055.cbl
  3088     MOVE 0
  3089       TO DFHEIV11
  3090*    MOVE '&,         G          &  N#00002804' TO DFHEIV0
  3091     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3092     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3093     MOVE X'204E233030303032383034' TO DFHEIV0(25:11)
  3094     CALL 'kxdfhei1' USING DFHEIV0,
  3095           DFHEIV1,
  3096           elcrtt-ridfld,
  3097           DFHEIV99,
  3098           DFHEIV11,
  3099           DFHEIV99
  3100     MOVE EIBRESP  TO ws-response
  3101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3102     if RESP-NOTFND or resp-endfile
  3103        go to 0100-end-elcrtt
  3104     else
  3105        if not resp-normal
  3106           move ws-response      to ra-status-code
  3107           move ' elcrtt error startbr '
  3108                                 to ra-message
  3109           display 'error-elcrtt-startbr ' ws-response
  3110           go to 0000-return
  3111        end-if
  3112     end-if
  3113     move 'Y'                    to ws-startbr-ind
  3114     .
  3115 0100-elcrtt-loop.
  3116
  3117* exec cics readnext
  3118*       dataset    ('ELCRTT')
  3119*       ridfld     (elcrtt-ridfld)
  3120*       into       (certificate-trailers)
  3121*       resp       (ws-response)
  3122*    end-exec
  3123     MOVE LENGTH OF
  3124      certificate-trailers
  3125       TO DFHEIV12
  3126     MOVE 'ELCRTT' TO DFHEIV1
  3127     MOVE 0
  3128       TO DFHEIV11
  3129*    MOVE '&.IL                  )  N#00002824' TO DFHEIV0
  3130     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3131     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3132     MOVE X'204E233030303032383234' TO DFHEIV0(25:11)
  3133     CALL 'kxdfhei1' USING DFHEIV0,
  3134           DFHEIV1,
  3135           certificate-trailers,
  3136           DFHEIV12,
  3137           elcrtt-ridfld,
  3138           DFHEIV99,
  3139           DFHEIV11,
  3140           DFHEIV99,
  3141           DFHEIV99
  3142     MOVE EIBRESP  TO ws-response
  3143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3144     if (RESP-NOTFND)
  3145        or (resp-endfile)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  56
* EL055.cbl
  3146        or (elcrtt-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3147        go to 0100-end-elcrtt
  3148     else
  3149        if not resp-normal
  3150           move ws-response      to ra-status-code
  3151           move ' elcrtt error readnext '
  3152                                 to ra-message
  3153           display 'error-elcrtt-readnext ' ws-response
  3154           go to 0000-return
  3155        end-if
  3156     end-if
  3157***  delete and add with new key right here!!!
  3158
  3159* exec cics delete
  3160*       dataset  ('ELCRTT')
  3161*       ridfld   (elcrtt-ridfld)
  3162*       resp     (ws-response)
  3163*    end-exec
  3164     MOVE 'ELCRTT' TO DFHEIV1
  3165*    MOVE '&(  R                 &  N#00002844' TO DFHEIV0
  3166     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3167     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3168     MOVE X'204E233030303032383434' TO DFHEIV0(25:11)
  3169     CALL 'kxdfhei1' USING DFHEIV0,
  3170           DFHEIV1,
  3171           elcrtt-ridfld,
  3172           DFHEIV99,
  3173           DFHEIV99,
  3174           DFHEIV99
  3175     MOVE EIBRESP  TO ws-response
  3176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3177     if not resp-normal
  3178        move ws-response         to ra-status-code
  3179        move ' elcrtt delete error '
  3180                                 to ra-message
  3181        display 'error-elcrtt-delete  ' ws-response
  3182        go to 0000-return
  3183     end-if
  3184     move pa-new-eff-dt          to cs-cert-eff-dt
  3185     move pa-new-cert-no         to cs-cert-no
  3186
  3187* exec cics write
  3188*       dataset  ('ELCRTT')
  3189*       from     (certificate-trailers)
  3190*       ridfld   (cs-control-primary)
  3191*       resp     (ws-response)
  3192*    end-exec
  3193     MOVE LENGTH OF
  3194      certificate-trailers
  3195       TO DFHEIV11
  3196     MOVE 'ELCRTT' TO DFHEIV1
  3197*    MOVE '&$ L                  ''  N#00002858' TO DFHEIV0
  3198     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3199     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3200     MOVE X'204E233030303032383538' TO DFHEIV0(25:11)
  3201     CALL 'kxdfhei1' USING DFHEIV0,
  3202           DFHEIV1,
  3203           certificate-trailers,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  57
* EL055.cbl
  3204           DFHEIV11,
  3205           cs-control-primary,
  3206           DFHEIV99,
  3207           DFHEIV99
  3208     MOVE EIBRESP  TO ws-response
  3209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3210     if not resp-normal
  3211        move ws-response         to ra-status-code
  3212        move ' elcrtt write  error '
  3213                                 to ra-message
  3214        display 'error-elcrtt-write   ' ws-response
  3215        go to 0000-return
  3216     end-if
  3217     go to 0100-elcrtt-loop
  3218     .
  3219 0100-end-elcrtt.
  3220     if ws-startbr-ind = 'Y'
  3221
  3222* exec cics endbr
  3223*          dataset     ('ELCRTT')
  3224*       end-exec
  3225     MOVE 'ELCRTT' TO DFHEIV1
  3226     MOVE 0
  3227       TO DFHEIV11
  3228*    MOVE '&2                    $   #00002875' TO DFHEIV0
  3229     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3230     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3231     MOVE X'2020233030303032383735' TO DFHEIV0(25:11)
  3232     CALL 'kxdfhei1' USING DFHEIV0,
  3233           DFHEIV1,
  3234           DFHEIV11,
  3235           DFHEIV99
  3236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3237     end-if
  3238     .
  3239 0100-erarch.
  3240**** ======================================================== ****
  3241****                                                          ****
  3242****    Check for ERARCH records                              ****
  3243****                                                          ****
  3244**** ======================================================== ****
  3245     move ' '                    to ws-startbr-ind
  3246     move opk-company-cd         to erarch2-company-cd
  3247     move opk-cert-no            to erarch2-cert-no
  3248     move ws-old-pndb-key(1:21)  to erarch2-ridfld(13:21)
  3249     move +0                     to erarch2-arch-no
  3250
  3251* exec cics startbr
  3252*       dataset    ('ERARCH2')
  3253*       ridfld     (erarch2-ridfld)
  3254*       gteq
  3255*       resp       (ws-response)
  3256*    end-exec
  3257     MOVE 'ERARCH2' TO DFHEIV1
  3258     MOVE 0
  3259       TO DFHEIV11
  3260*    MOVE '&,         G          &  N#00002891' TO DFHEIV0
  3261     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  58
* EL055.cbl
  3262     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3263     MOVE X'204E233030303032383931' TO DFHEIV0(25:11)
  3264     CALL 'kxdfhei1' USING DFHEIV0,
  3265           DFHEIV1,
  3266           erarch2-ridfld,
  3267           DFHEIV99,
  3268           DFHEIV11,
  3269           DFHEIV99
  3270     MOVE EIBRESP  TO ws-response
  3271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3272     if RESP-NOTFND or resp-endfile
  3273        go to 0100-end-erarch
  3274     else
  3275        if not resp-normal
  3276           move ws-response      to ra-status-code
  3277           move ' erarch2 error startbr '
  3278                                 to ra-message
  3279           display 'error-erarch2-startbr ' ws-response
  3280           go to 0000-return
  3281        end-if
  3282     end-if
  3283     move 'Y'                    to ws-startbr-ind
  3284     .
  3285 0100-erarch-loop.
  3286
  3287* exec cics readnext
  3288*       dataset    ('ERARCH2')
  3289*       ridfld     (erarch2-ridfld)
  3290*       into       (letter-archive)
  3291*       resp       (ws-response)
  3292*    end-exec
  3293     MOVE LENGTH OF
  3294      letter-archive
  3295       TO DFHEIV12
  3296     MOVE 'ERARCH2' TO DFHEIV1
  3297     MOVE 0
  3298       TO DFHEIV11
  3299*    MOVE '&.IL                  )  N#00002911' TO DFHEIV0
  3300     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3301     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3302     MOVE X'204E233030303032393131' TO DFHEIV0(25:11)
  3303     CALL 'kxdfhei1' USING DFHEIV0,
  3304           DFHEIV1,
  3305           letter-archive,
  3306           DFHEIV12,
  3307           erarch2-ridfld,
  3308           DFHEIV99,
  3309           DFHEIV11,
  3310           DFHEIV99,
  3311           DFHEIV99
  3312     MOVE EIBRESP  TO ws-response
  3313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3314     if (RESP-NOTFND)
  3315        or (resp-endfile)
  3316        or (erarch2-company-cd <> opk-company-cd)
  3317        or (erarch2-cert-no <> opk-cert-no)
  3318        go to 0100-end-erarch
  3319     else
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  59
* EL055.cbl
  3320        if not resp-normal
  3321           move ws-response      to ra-status-code
  3322           move ' erarch2 error readnext '
  3323                                 to ra-message
  3324           display 'error-erarch2-readnext ' ws-response
  3325           go to 0000-return
  3326        end-if
  3327     end-if
  3328     if (opk-carrier <> la-carrier-a2)
  3329        or (opk-group <> la-grouping-a2)
  3330        or (opk-state <> la-state-a2)
  3331        or (opk-account <> la-account-a2)
  3332        or (opk-eff-dt <> la-effect-date-a2)
  3333        go to 0100-erarch-loop
  3334     end-if
  3335***  Do rewrites to base cluster right here!!!
  3336     move la-control-primary     to erarch-ridfld
  3337                                    nsasextr-ridfld
  3338
  3339* exec cics read update
  3340*       dataset  ('ERARCH')
  3341*       into     (letter-archive)
  3342*       ridfld   (erarch-ridfld)
  3343*       resp     (ws-response)
  3344*    end-exec
  3345     MOVE LENGTH OF
  3346      letter-archive
  3347       TO DFHEIV11
  3348     MOVE 'ERARCH' TO DFHEIV1
  3349*    MOVE '&"IL       EU         (  N#00002941' TO DFHEIV0
  3350     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3351     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3352     MOVE X'204E233030303032393431' TO DFHEIV0(25:11)
  3353     CALL 'kxdfhei1' USING DFHEIV0,
  3354           DFHEIV1,
  3355           letter-archive,
  3356           DFHEIV11,
  3357           erarch-ridfld,
  3358           DFHEIV99,
  3359           DFHEIV99,
  3360           DFHEIV99
  3361     MOVE EIBRESP  TO ws-response
  3362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3363     if not resp-normal
  3364        move ws-response         to ra-status-code
  3365        move ' erarch read update error '
  3366                                 to ra-message
  3367        display 'error-erarch-read update ' ws-response
  3368        go to 0000-return
  3369     end-if
  3370     move pa-new-eff-dt          to la-effect-date-a2
  3371     move pa-new-cert-no         to la-cert-no-a2
  3372
  3373* exec cics rewrite
  3374*       dataset  ('ERARCH')
  3375*       from     (letter-archive)
  3376*       resp     (ws-response)
  3377*    end-exec
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  60
* EL055.cbl
  3378     MOVE LENGTH OF
  3379      letter-archive
  3380       TO DFHEIV11
  3381     MOVE 'ERARCH' TO DFHEIV1
  3382*    MOVE '&& L                  %  N#00002956' TO DFHEIV0
  3383     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3384     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3385     MOVE X'204E233030303032393536' TO DFHEIV0(25:11)
  3386     CALL 'kxdfhei1' USING DFHEIV0,
  3387           DFHEIV1,
  3388           letter-archive,
  3389           DFHEIV11,
  3390           DFHEIV99
  3391     MOVE EIBRESP  TO ws-response
  3392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3393     if not resp-normal
  3394        move ws-response         to ra-status-code
  3395        move ' erarch write  error '
  3396                                 to ra-message
  3397        display 'error-erarch-write   ' ws-response
  3398        go to 0000-return
  3399     end-if
  3400     perform 0500-process-nsasextr thru 0500-exit
  3401     go to 0100-erarch-loop
  3402     .
  3403 0100-end-erarch.
  3404     if ws-startbr-ind = 'Y'
  3405
  3406* exec cics endbr
  3407*          dataset     ('ERARCH2')
  3408*       end-exec
  3409     MOVE 'ERARCH2' TO DFHEIV1
  3410     MOVE 0
  3411       TO DFHEIV11
  3412*    MOVE '&2                    $   #00002973' TO DFHEIV0
  3413     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3414     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3415     MOVE X'2020233030303032393733' TO DFHEIV0(25:11)
  3416     CALL 'kxdfhei1' USING DFHEIV0,
  3417           DFHEIV1,
  3418           DFHEIV11,
  3419           DFHEIV99
  3420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3421     end-if
  3422     .
  3423 0100-erchek.
  3424**** ======================================================== ****
  3425****                                                          ****
  3426****    Check for ERCHEK records                              ****
  3427****                                                          ****
  3428**** ======================================================== ****
  3429     move ' '                    to ws-startbr-ind
  3430     move ws-old-pndb-key(1:33)  to erchek-ridfld(1:33)
  3431     move +0                     to erchek-seq-no
  3432
  3433* exec cics startbr
  3434*       dataset    ('ERCHEK')
  3435*       ridfld     (erchek-ridfld)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  61
* EL055.cbl
  3436*       gteq
  3437*       resp       (ws-response)
  3438*    end-exec
  3439     MOVE 'ERCHEK' TO DFHEIV1
  3440     MOVE 0
  3441       TO DFHEIV11
  3442*    MOVE '&,         G          &  N#00002987' TO DFHEIV0
  3443     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3444     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3445     MOVE X'204E233030303032393837' TO DFHEIV0(25:11)
  3446     CALL 'kxdfhei1' USING DFHEIV0,
  3447           DFHEIV1,
  3448           erchek-ridfld,
  3449           DFHEIV99,
  3450           DFHEIV11,
  3451           DFHEIV99
  3452     MOVE EIBRESP  TO ws-response
  3453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3454     if RESP-NOTFND or resp-endfile
  3455        go to 0100-end-erchek
  3456     else
  3457        if not resp-normal
  3458           move ws-response      to ra-status-code
  3459           move ' erchek error startbr '
  3460                                 to ra-message
  3461           display 'error-erchek-startbr ' ws-response
  3462           go to 0000-return
  3463        end-if
  3464     end-if
  3465     move 'Y'                    to ws-startbr-ind
  3466     .
  3467 0100-erchek-loop.
  3468
  3469* exec cics readnext
  3470*       dataset    ('ERCHEK')
  3471*       ridfld     (erchek-ridfld)
  3472*       into       (check-records)
  3473*       resp       (ws-response)
  3474*    end-exec
  3475     MOVE LENGTH OF
  3476      check-records
  3477       TO DFHEIV12
  3478     MOVE 'ERCHEK' TO DFHEIV1
  3479     MOVE 0
  3480       TO DFHEIV11
  3481*    MOVE '&.IL                  )  N#00003007' TO DFHEIV0
  3482     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3484     MOVE X'204E233030303033303037' TO DFHEIV0(25:11)
  3485     CALL 'kxdfhei1' USING DFHEIV0,
  3486           DFHEIV1,
  3487           check-records,
  3488           DFHEIV12,
  3489           erchek-ridfld,
  3490           DFHEIV99,
  3491           DFHEIV11,
  3492           DFHEIV99,
  3493           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  62
* EL055.cbl
  3494     MOVE EIBRESP  TO ws-response
  3495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3496     if (RESP-NOTFND)
  3497        or (resp-endfile)
  3498        or (erchek-ridfld(1:33) <> ws-old-pndb-key(1:33))
  3499        go to 0100-end-erchek
  3500     else
  3501        if not resp-normal
  3502           move ws-response      to ra-status-code
  3503           move ' erchek error readnext '
  3504                                 to ra-message
  3505           display 'error-erchek-readnext ' ws-response
  3506           go to 0000-return
  3507        end-if
  3508     end-if
  3509***  delete and add with new key right here!!!
  3510
  3511* exec cics delete
  3512*       dataset  ('ERCHEK')
  3513*       ridfld   (erchek-ridfld)
  3514*       resp     (ws-response)
  3515*    end-exec
  3516     MOVE 'ERCHEK' TO DFHEIV1
  3517*    MOVE '&(  R                 &  N#00003027' TO DFHEIV0
  3518     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3520     MOVE X'204E233030303033303237' TO DFHEIV0(25:11)
  3521     CALL 'kxdfhei1' USING DFHEIV0,
  3522           DFHEIV1,
  3523           erchek-ridfld,
  3524           DFHEIV99,
  3525           DFHEIV99,
  3526           DFHEIV99
  3527     MOVE EIBRESP  TO ws-response
  3528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3529     if not resp-normal
  3530        move ws-response         to ra-status-code
  3531        move ' erchek delete error '
  3532                                 to ra-message
  3533        display 'error-erchek-delete  ' ws-response
  3534        go to 0000-return
  3535     end-if
  3536     move pa-new-eff-dt          to ch-cert-eff-dt
  3537     move pa-new-cert-no         to ch-cert-no
  3538
  3539* exec cics write
  3540*       dataset  ('ERCHEK')
  3541*       from     (check-records)
  3542*       ridfld   (ch-control-primary)
  3543*       resp     (ws-response)
  3544*    end-exec
  3545     MOVE LENGTH OF
  3546      check-records
  3547       TO DFHEIV11
  3548     MOVE 'ERCHEK' TO DFHEIV1
  3549*    MOVE '&$ L                  ''  N#00003041' TO DFHEIV0
  3550     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3551     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  63
* EL055.cbl
  3552     MOVE X'204E233030303033303431' TO DFHEIV0(25:11)
  3553     CALL 'kxdfhei1' USING DFHEIV0,
  3554           DFHEIV1,
  3555           check-records,
  3556           DFHEIV11,
  3557           ch-control-primary,
  3558           DFHEIV99,
  3559           DFHEIV99
  3560     MOVE EIBRESP  TO ws-response
  3561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3562     if not resp-normal
  3563        move ws-response         to ra-status-code
  3564        move ' erchek write  error '
  3565                                 to ra-message
  3566        display 'error-erchek-write   ' ws-response
  3567        go to 0000-return
  3568     end-if
  3569     go to 0100-erchek-loop
  3570     .
  3571 0100-end-erchek.
  3572     if ws-startbr-ind = 'Y'
  3573
  3574* exec cics endbr
  3575*          dataset     ('ERCHEK')
  3576*       end-exec
  3577     MOVE 'ERCHEK' TO DFHEIV1
  3578     MOVE 0
  3579       TO DFHEIV11
  3580*    MOVE '&2                    $   #00003058' TO DFHEIV0
  3581     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3582     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3583     MOVE X'2020233030303033303538' TO DFHEIV0(25:11)
  3584     CALL 'kxdfhei1' USING DFHEIV0,
  3585           DFHEIV1,
  3586           DFHEIV11,
  3587           DFHEIV99
  3588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3589     end-if
  3590     .
  3591 0100-ercnot.
  3592**** ======================================================== ****
  3593****                                                          ****
  3594****    Check for ERCNOT records                              ****
  3595****                                                          ****
  3596**** ======================================================== ****
  3597     move ' '                    to ws-startbr-ind
  3598     move ws-old-pndb-key(1:33)  to ercnot-ridfld(1:33)
  3599     move opk-rec-type           to ercnot-rec-type
  3600     move +0                     to ercnot-seq-no
  3601
  3602* exec cics startbr
  3603*       dataset    ('ERCNOT')
  3604*       ridfld     (ercnot-ridfld)
  3605*       gteq
  3606*       resp       (ws-response)
  3607*    end-exec
  3608     MOVE 'ERCNOT' TO DFHEIV1
  3609     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  64
* EL055.cbl
  3610       TO DFHEIV11
  3611*    MOVE '&,         G          &  N#00003073' TO DFHEIV0
  3612     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  3613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3614     MOVE X'204E233030303033303733' TO DFHEIV0(25:11)
  3615     CALL 'kxdfhei1' USING DFHEIV0,
  3616           DFHEIV1,
  3617           ercnot-ridfld,
  3618           DFHEIV99,
  3619           DFHEIV11,
  3620           DFHEIV99
  3621     MOVE EIBRESP  TO ws-response
  3622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3623     if RESP-NOTFND or resp-endfile
  3624        go to 0100-end-ercnot
  3625     else
  3626        if not resp-normal
  3627           move ws-response      to ra-status-code
  3628           move ' ercnot error startbr '
  3629                                 to ra-message
  3630           display 'error-ercnot-startbr ' ws-response
  3631           go to 0000-return
  3632        end-if
  3633     end-if
  3634     move 'Y'                    to ws-startbr-ind
  3635     .
  3636 0100-ercnot-loop.
  3637
  3638* exec cics readnext
  3639*       dataset    ('ERCNOT')
  3640*       ridfld     (ercnot-ridfld)
  3641*       into       (cert-note-file)
  3642*       resp       (ws-response)
  3643*    end-exec
  3644     MOVE LENGTH OF
  3645      cert-note-file
  3646       TO DFHEIV12
  3647     MOVE 'ERCNOT' TO DFHEIV1
  3648     MOVE 0
  3649       TO DFHEIV11
  3650*    MOVE '&.IL                  )  N#00003093' TO DFHEIV0
  3651     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  3652     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3653     MOVE X'204E233030303033303933' TO DFHEIV0(25:11)
  3654     CALL 'kxdfhei1' USING DFHEIV0,
  3655           DFHEIV1,
  3656           cert-note-file,
  3657           DFHEIV12,
  3658           ercnot-ridfld,
  3659           DFHEIV99,
  3660           DFHEIV11,
  3661           DFHEIV99,
  3662           DFHEIV99
  3663     MOVE EIBRESP  TO ws-response
  3664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3665     if (RESP-NOTFND)
  3666        or (resp-endfile)
  3667        or (ercnot-ridfld(1:33) <> ws-old-pndb-key(1:33))
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  65
* EL055.cbl
  3668        go to 0100-end-ercnot
  3669     else
  3670        if not resp-normal
  3671           move ws-response      to ra-status-code
  3672           move ' ercnot error readnext '
  3673                                 to ra-message
  3674           display 'error-ercnot-readnext ' ws-response
  3675           go to 0000-return
  3676        end-if
  3677     end-if
  3678     if cz-record-type <> '1'  *>  cert note
  3679        go to 0100-ercnot-loop
  3680     end-if
  3681***  delete and add with new key right here!!!
  3682
  3683* exec cics delete
  3684*       dataset  ('ERCNOT')
  3685*       ridfld   (ercnot-ridfld)
  3686*       resp     (ws-response)
  3687*    end-exec
  3688     MOVE 'ERCNOT' TO DFHEIV1
  3689*    MOVE '&(  R                 &  N#00003116' TO DFHEIV0
  3690     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3691     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3692     MOVE X'204E233030303033313136' TO DFHEIV0(25:11)
  3693     CALL 'kxdfhei1' USING DFHEIV0,
  3694           DFHEIV1,
  3695           ercnot-ridfld,
  3696           DFHEIV99,
  3697           DFHEIV99,
  3698           DFHEIV99
  3699     MOVE EIBRESP  TO ws-response
  3700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3701     if not resp-normal
  3702        move ws-response         to ra-status-code
  3703        move ' ercnot delete error '
  3704                                 to ra-message
  3705        display 'error-ercnot-delete  ' ws-response
  3706        go to 0000-return
  3707     end-if
  3708     move pa-new-eff-dt          to cz-cert-eff-dt
  3709     move pa-new-cert-no         to cz-cert-no
  3710
  3711* exec cics write
  3712*       dataset  ('ERCNOT')
  3713*       from     (cert-note-file)
  3714*       ridfld   (cz-control-primary)
  3715*       resp     (ws-response)
  3716*    end-exec
  3717     MOVE LENGTH OF
  3718      cert-note-file
  3719       TO DFHEIV11
  3720     MOVE 'ERCNOT' TO DFHEIV1
  3721*    MOVE '&$ L                  ''  N#00003130' TO DFHEIV0
  3722     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3723     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3724     MOVE X'204E233030303033313330' TO DFHEIV0(25:11)
  3725     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  66
* EL055.cbl
  3726           DFHEIV1,
  3727           cert-note-file,
  3728           DFHEIV11,
  3729           cz-control-primary,
  3730           DFHEIV99,
  3731           DFHEIV99
  3732     MOVE EIBRESP  TO ws-response
  3733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3734     if not resp-normal
  3735        move ws-response         to ra-status-code
  3736        move ' ercnot write  error '
  3737                                 to ra-message
  3738        display 'error-ercnot-write   ' ws-response
  3739        go to 0000-return
  3740     end-if
  3741     go to 0100-ercnot-loop
  3742     .
  3743 0100-end-ercnot.
  3744     if ws-startbr-ind = 'Y'
  3745
  3746* exec cics endbr
  3747*          dataset     ('ERCNOT')
  3748*       end-exec
  3749     MOVE 'ERCNOT' TO DFHEIV1
  3750     MOVE 0
  3751       TO DFHEIV11
  3752*    MOVE '&2                    $   #00003147' TO DFHEIV0
  3753     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3755     MOVE X'2020233030303033313437' TO DFHEIV0(25:11)
  3756     CALL 'kxdfhei1' USING DFHEIV0,
  3757           DFHEIV1,
  3758           DFHEIV11,
  3759           DFHEIV99
  3760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3761     end-if
  3762      .
  3763 0100-ernote.
  3764**** ======================================================== ****
  3765****                                                          ****
  3766****    Check for ERNOTE record.                              ****
  3767****                                                          ****
  3768**** ======================================================== ****
  3769     move ws-old-pndb-key(1:33)  to ernote-ridfld
  3770
  3771* exec cics read
  3772*       dataset    ('ERNOTE')
  3773*       ridfld     (ernote-ridfld)
  3774*       into       (certificate-note)
  3775*       resp       (ws-response)
  3776*    end-exec
  3777     MOVE LENGTH OF
  3778      certificate-note
  3779       TO DFHEIV11
  3780     MOVE 'ERNOTE' TO DFHEIV1
  3781*    MOVE '&"IL       E          (  N#00003159' TO DFHEIV0
  3782     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3783     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  67
* EL055.cbl
  3784     MOVE X'204E233030303033313539' TO DFHEIV0(25:11)
  3785     CALL 'kxdfhei1' USING DFHEIV0,
  3786           DFHEIV1,
  3787           certificate-note,
  3788           DFHEIV11,
  3789           ernote-ridfld,
  3790           DFHEIV99,
  3791           DFHEIV99,
  3792           DFHEIV99
  3793     MOVE EIBRESP  TO ws-response
  3794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3795     if (RESP-NOTFND)
  3796        or (resp-endfile)
  3797        go to 0100-end-ernote
  3798     else
  3799        if not resp-normal
  3800           move ws-response      to ra-status-code
  3801           move ' ernote error readnext '
  3802                                 to ra-message
  3803           display 'error-ernote-readnext ' ws-response
  3804           go to 0000-return
  3805        end-if
  3806     end-if
  3807***  delete and add with new key right here!!!
  3808** 1)  Delete ERNOTE (old key)
  3809
  3810* exec cics delete
  3811*       dataset  ('ERNOTE')
  3812*       ridfld   (ernote-ridfld)
  3813*       resp     (ws-response)
  3814*    end-exec
  3815     MOVE 'ERNOTE' TO DFHEIV1
  3816*    MOVE '&(  R                 &  N#00003179' TO DFHEIV0
  3817     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3819     MOVE X'204E233030303033313739' TO DFHEIV0(25:11)
  3820     CALL 'kxdfhei1' USING DFHEIV0,
  3821           DFHEIV1,
  3822           ernote-ridfld,
  3823           DFHEIV99,
  3824           DFHEIV99,
  3825           DFHEIV99
  3826     MOVE EIBRESP  TO ws-response
  3827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3828     if not resp-normal
  3829        move ws-response         to ra-status-code
  3830        move ' ernote delete error '
  3831                                 to ra-message
  3832        display 'error-ernote-delete  ' ws-response
  3833        go to 0000-return
  3834     end-if
  3835** 2)  Write new ERNOTE record
  3836     move pa-new-eff-dt          to cn-cert-eff-dt
  3837     move pa-new-cert-no         to cn-cert-no
  3838
  3839* exec cics write
  3840*       dataset  ('ERNOTE')
  3841*       from     (certificate-note)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  68
* EL055.cbl
  3842*       ridfld   (cn-control-primary)
  3843*       resp     (ws-response)
  3844*    end-exec
  3845     MOVE LENGTH OF
  3846      certificate-note
  3847       TO DFHEIV11
  3848     MOVE 'ERNOTE' TO DFHEIV1
  3849*    MOVE '&$ L                  ''  N#00003194' TO DFHEIV0
  3850     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3851     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3852     MOVE X'204E233030303033313934' TO DFHEIV0(25:11)
  3853     CALL 'kxdfhei1' USING DFHEIV0,
  3854           DFHEIV1,
  3855           certificate-note,
  3856           DFHEIV11,
  3857           cn-control-primary,
  3858           DFHEIV99,
  3859           DFHEIV99
  3860     MOVE EIBRESP  TO ws-response
  3861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3862     if not resp-normal
  3863        move ws-response         to ra-status-code
  3864        move ' ernote write  error '
  3865                                 to ra-message
  3866        display 'error-ernote-write   ' ws-response
  3867        go to 0000-return
  3868     end-if
  3869     .
  3870 0100-end-ernote.
  3871     .
  3872 0100-ermail.
  3873**** ======================================================== ****
  3874****                                                          ****
  3875****    Check for ERMAIL record.                              ****
  3876****                                                          ****
  3877**** ======================================================== ****
  3878     move ws-old-pndb-key(1:33)  to ermail-ridfld
  3879
  3880* exec cics read
  3881*       dataset    ('ERMAIL')
  3882*       ridfld     (ermail-ridfld)
  3883*       into       (mailing-data)
  3884*       resp       (ws-response)
  3885*    end-exec
  3886     MOVE LENGTH OF
  3887      mailing-data
  3888       TO DFHEIV11
  3889     MOVE 'ERMAIL' TO DFHEIV1
  3890*    MOVE '&"IL       E          (  N#00003217' TO DFHEIV0
  3891     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3893     MOVE X'204E233030303033323137' TO DFHEIV0(25:11)
  3894     CALL 'kxdfhei1' USING DFHEIV0,
  3895           DFHEIV1,
  3896           mailing-data,
  3897           DFHEIV11,
  3898           ermail-ridfld,
  3899           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  69
* EL055.cbl
  3900           DFHEIV99,
  3901           DFHEIV99
  3902     MOVE EIBRESP  TO ws-response
  3903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3904     if (RESP-NOTFND)
  3905        or (resp-endfile)
  3906        go to 0100-end-ermail
  3907     else
  3908        if not resp-normal
  3909           move ws-response      to ra-status-code
  3910           move ' ermail error readnext '
  3911                                 to ra-message
  3912           display 'error-ermail-readnext ' ws-response
  3913           go to 0000-return
  3914        end-if
  3915     end-if
  3916***  delete and add with new key right here!!!
  3917** 1)  Delete ERMAIL (old key)
  3918
  3919* exec cics delete
  3920*       dataset  ('ERMAIL')
  3921*       ridfld   (ermail-ridfld)
  3922*       resp     (ws-response)
  3923*    end-exec
  3924     MOVE 'ERMAIL' TO DFHEIV1
  3925*    MOVE '&(  R                 &  N#00003237' TO DFHEIV0
  3926     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3927     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3928     MOVE X'204E233030303033323337' TO DFHEIV0(25:11)
  3929     CALL 'kxdfhei1' USING DFHEIV0,
  3930           DFHEIV1,
  3931           ermail-ridfld,
  3932           DFHEIV99,
  3933           DFHEIV99,
  3934           DFHEIV99
  3935     MOVE EIBRESP  TO ws-response
  3936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3937     if not resp-normal
  3938        move ws-response         to ra-status-code
  3939        move ' ermail delete error '
  3940                                 to ra-message
  3941        display 'error-ermail-delete  ' ws-response
  3942        go to 0000-return
  3943     end-if
  3944** 2)  Write new ERMAIL record
  3945     move pa-new-eff-dt          to ma-cert-eff-dt
  3946     move pa-new-cert-no         to ma-cert-no
  3947
  3948* exec cics write
  3949*       dataset  ('ERMAIL')
  3950*       from     (mailing-data)
  3951*       ridfld   (ma-control-primary)
  3952*       resp     (ws-response)
  3953*    end-exec
  3954     MOVE LENGTH OF
  3955      mailing-data
  3956       TO DFHEIV11
  3957     MOVE 'ERMAIL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  70
* EL055.cbl
  3958*    MOVE '&$ L                  ''  N#00003252' TO DFHEIV0
  3959     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3961     MOVE X'204E233030303033323532' TO DFHEIV0(25:11)
  3962     CALL 'kxdfhei1' USING DFHEIV0,
  3963           DFHEIV1,
  3964           mailing-data,
  3965           DFHEIV11,
  3966           ma-control-primary,
  3967           DFHEIV99,
  3968           DFHEIV99
  3969     MOVE EIBRESP  TO ws-response
  3970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3971     if not resp-normal
  3972        move ws-response         to ra-status-code
  3973        move ' ermail write  error '
  3974                                 to ra-message
  3975        display 'error-ermail-write   ' ws-response
  3976        go to 0000-return
  3977     end-if
  3978     .
  3979 0100-end-ermail.
  3980     .
  3981 0100-erendr.
  3982**** ======================================================== ****
  3983****                                                          ****
  3984****    Check for ERENDR records                              ****
  3985****                                                          ****
  3986**** ======================================================== ****
  3987     move ' '                    to ws-startbr-ind
  3988     move ws-old-pndb-key(1:33)  to erendr-ridfld(1:33)
  3989     move +0                     to erendr-seq-no
  3990     move ' '                    to erendr-rec-type
  3991
  3992* exec cics startbr
  3993*       dataset    ('ERENDR')
  3994*       ridfld     (erendr-ridfld)
  3995*       gteq
  3996*       resp       (ws-response)
  3997*    end-exec
  3998     MOVE 'ERENDR' TO DFHEIV1
  3999     MOVE 0
  4000       TO DFHEIV11
  4001*    MOVE '&,         G          &  N#00003278' TO DFHEIV0
  4002     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4003     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4004     MOVE X'204E233030303033323738' TO DFHEIV0(25:11)
  4005     CALL 'kxdfhei1' USING DFHEIV0,
  4006           DFHEIV1,
  4007           erendr-ridfld,
  4008           DFHEIV99,
  4009           DFHEIV11,
  4010           DFHEIV99
  4011     MOVE EIBRESP  TO ws-response
  4012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4013     if RESP-NOTFND or resp-endfile
  4014        go to 0100-end-erendr
  4015     else
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  71
* EL055.cbl
  4016        if not resp-normal
  4017           move ws-response      to ra-status-code
  4018           move ' erendr error startbr '
  4019                                 to ra-message
  4020           display 'error-erendr-startbr ' ws-response
  4021           go to 0000-return
  4022        end-if
  4023     end-if
  4024     move 'Y'                    to ws-startbr-ind
  4025     .
  4026 0100-erendr-loop.
  4027
  4028* exec cics readnext
  4029*       dataset    ('ERENDR')
  4030*       ridfld     (erendr-ridfld)
  4031*       into       (endorsement-record)
  4032*       resp       (ws-response)
  4033*    end-exec
  4034     MOVE LENGTH OF
  4035      endorsement-record
  4036       TO DFHEIV12
  4037     MOVE 'ERENDR' TO DFHEIV1
  4038     MOVE 0
  4039       TO DFHEIV11
  4040*    MOVE '&.IL                  )  N#00003298' TO DFHEIV0
  4041     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4042     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4043     MOVE X'204E233030303033323938' TO DFHEIV0(25:11)
  4044     CALL 'kxdfhei1' USING DFHEIV0,
  4045           DFHEIV1,
  4046           endorsement-record,
  4047           DFHEIV12,
  4048           erendr-ridfld,
  4049           DFHEIV99,
  4050           DFHEIV11,
  4051           DFHEIV99,
  4052           DFHEIV99
  4053     MOVE EIBRESP  TO ws-response
  4054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4055     if (RESP-NOTFND)
  4056        or (resp-endfile)
  4057        or (erendr-ridfld(1:33) <> ws-old-pndb-key(1:33))
  4058        go to 0100-end-erendr
  4059     else
  4060        if not resp-normal
  4061           move ws-response      to ra-status-code
  4062           move ' erendr error readnext '
  4063                                 to ra-message
  4064           display 'error-erendr-readnext ' ws-response
  4065           go to 0000-return
  4066        end-if
  4067     end-if
  4068     if en-rec-type <> '1'  *>  Issue record
  4069        go to 0100-erendr-loop
  4070     end-if
  4071***  delete and add with new key right here!!!
  4072
  4073* exec cics delete
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  72
* EL055.cbl
  4074*       dataset  ('ERENDR')
  4075*       ridfld   (erendr-ridfld)
  4076*       resp     (ws-response)
  4077*    end-exec
  4078     MOVE 'ERENDR' TO DFHEIV1
  4079*    MOVE '&(  R                 &  N#00003321' TO DFHEIV0
  4080     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  4081     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4082     MOVE X'204E233030303033333231' TO DFHEIV0(25:11)
  4083     CALL 'kxdfhei1' USING DFHEIV0,
  4084           DFHEIV1,
  4085           erendr-ridfld,
  4086           DFHEIV99,
  4087           DFHEIV99,
  4088           DFHEIV99
  4089     MOVE EIBRESP  TO ws-response
  4090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4091     if not resp-normal
  4092        move ws-response         to ra-status-code
  4093        move ' erendr delete error '
  4094                                 to ra-message
  4095        display 'error-erendr-delete  ' ws-response
  4096        go to 0000-return
  4097     end-if
  4098     move pa-new-eff-dt          to en-cert-eff-dt
  4099     move pa-new-cert-no         to en-cert-no
  4100
  4101* exec cics write
  4102*       dataset  ('ERENDR')
  4103*       from     (ENDORSEMENT-RECORD)
  4104*       ridfld   (en-control-primary)
  4105*       resp     (ws-response)
  4106*    end-exec
  4107     MOVE LENGTH OF
  4108      ENDORSEMENT-RECORD
  4109       TO DFHEIV11
  4110     MOVE 'ERENDR' TO DFHEIV1
  4111*    MOVE '&$ L                  ''  N#00003335' TO DFHEIV0
  4112     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4114     MOVE X'204E233030303033333335' TO DFHEIV0(25:11)
  4115     CALL 'kxdfhei1' USING DFHEIV0,
  4116           DFHEIV1,
  4117           ENDORSEMENT-RECORD,
  4118           DFHEIV11,
  4119           en-control-primary,
  4120           DFHEIV99,
  4121           DFHEIV99
  4122     MOVE EIBRESP  TO ws-response
  4123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4124     if not resp-normal
  4125        move ws-response         to ra-status-code
  4126        move ' erendr write  error '
  4127                                 to ra-message
  4128        display 'error-erendr-write   ' ws-response
  4129        go to 0000-return
  4130     end-if
  4131     go to 0100-erendr-loop
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  73
* EL055.cbl
  4132     .
  4133 0100-end-erendr.
  4134     if ws-startbr-ind = 'Y'
  4135
  4136* exec cics endbr
  4137*          dataset     ('ERENDR')
  4138*       end-exec
  4139     MOVE 'ERENDR' TO DFHEIV1
  4140     MOVE 0
  4141       TO DFHEIV11
  4142*    MOVE '&2                    $   #00003352' TO DFHEIV0
  4143     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4144     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4145     MOVE X'2020233030303033333532' TO DFHEIV0(25:11)
  4146     CALL 'kxdfhei1' USING DFHEIV0,
  4147           DFHEIV1,
  4148           DFHEIV11,
  4149           DFHEIV99
  4150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4151     end-if
  4152     .
  4153 0100-erendt.
  4154**** ======================================================== ****
  4155****                                                          ****
  4156****    Check for ERENDT records                              ****
  4157****                                                          ****
  4158**** ======================================================== ****
  4159     move ' '                    to ws-startbr-ind
  4160     move ws-old-pndb-key(1:33)  to erendt-ridfld(1:33)
  4161     move ' '                    to erendt-rec-type
  4162     move +0                     to erendt-seq-no
  4163
  4164* exec cics startbr
  4165*       dataset    ('ERENDT')
  4166*       ridfld     (erendt-ridfld)
  4167*       gteq
  4168*       resp       (ws-response)
  4169*    end-exec
  4170     MOVE 'ERENDT' TO DFHEIV1
  4171     MOVE 0
  4172       TO DFHEIV11
  4173*    MOVE '&,         G          &  N#00003367' TO DFHEIV0
  4174     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4175     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4176     MOVE X'204E233030303033333637' TO DFHEIV0(25:11)
  4177     CALL 'kxdfhei1' USING DFHEIV0,
  4178           DFHEIV1,
  4179           erendt-ridfld,
  4180           DFHEIV99,
  4181           DFHEIV11,
  4182           DFHEIV99
  4183     MOVE EIBRESP  TO ws-response
  4184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4185     if RESP-NOTFND or resp-endfile
  4186        go to 0100-end-erendt
  4187     else
  4188        if not resp-normal
  4189           move ws-response      to ra-status-code
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  74
* EL055.cbl
  4190           move ' erendt error startbr '
  4191                                 to ra-message
  4192           display 'error-erendt-startbr ' ws-response
  4193           go to 0000-return
  4194        end-if
  4195     end-if
  4196     move 'Y'                    to ws-startbr-ind
  4197     .
  4198 0100-erendt-loop.
  4199
  4200* exec cics readnext
  4201*       dataset    ('ERENDT')
  4202*       ridfld     (erendt-ridfld)
  4203*       into       (endt-record)
  4204*       resp       (ws-response)
  4205*    end-exec
  4206     MOVE LENGTH OF
  4207      endt-record
  4208       TO DFHEIV12
  4209     MOVE 'ERENDT' TO DFHEIV1
  4210     MOVE 0
  4211       TO DFHEIV11
  4212*    MOVE '&.IL                  )  N#00003387' TO DFHEIV0
  4213     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4214     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4215     MOVE X'204E233030303033333837' TO DFHEIV0(25:11)
  4216     CALL 'kxdfhei1' USING DFHEIV0,
  4217           DFHEIV1,
  4218           endt-record,
  4219           DFHEIV12,
  4220           erendt-ridfld,
  4221           DFHEIV99,
  4222           DFHEIV11,
  4223           DFHEIV99,
  4224           DFHEIV99
  4225     MOVE EIBRESP  TO ws-response
  4226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4227     if (RESP-NOTFND)
  4228        or (resp-endfile)
  4229        or (erendt-ridfld(1:33) <> ws-old-pndb-key(1:33))
  4230        go to 0100-end-erendt
  4231     else
  4232        if not resp-normal
  4233           move ws-response      to ra-status-code
  4234           move ' erendt error readnext '
  4235                                 to ra-message
  4236           display 'error-erendt-readnext ' ws-response
  4237           go to 0000-return
  4238        end-if
  4239     end-if
  4240     if et-rec-type <> 'I'  *>  Issue record
  4241        go to 0100-erendt-loop
  4242     end-if
  4243***  delete and add with new key right here!!!
  4244
  4245* exec cics delete
  4246*       dataset  ('ERENDT')
  4247*       ridfld   (erendt-ridfld)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  75
* EL055.cbl
  4248*       resp     (ws-response)
  4249*    end-exec
  4250     MOVE 'ERENDT' TO DFHEIV1
  4251*    MOVE '&(  R                 &  N#00003410' TO DFHEIV0
  4252     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  4253     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4254     MOVE X'204E233030303033343130' TO DFHEIV0(25:11)
  4255     CALL 'kxdfhei1' USING DFHEIV0,
  4256           DFHEIV1,
  4257           erendt-ridfld,
  4258           DFHEIV99,
  4259           DFHEIV99,
  4260           DFHEIV99
  4261     MOVE EIBRESP  TO ws-response
  4262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4263     if not resp-normal
  4264        move ws-response         to ra-status-code
  4265        move ' erendt delete error '
  4266                                 to ra-message
  4267        display 'error-erendt-delete  ' ws-response
  4268        go to 0000-return
  4269     end-if
  4270     move pa-new-eff-dt          to et-cert-eff-dt
  4271     move pa-new-cert-no         to et-cert-no
  4272
  4273* exec cics write
  4274*       dataset  ('ERENDT')
  4275*       from     (ENDT-RECORD)
  4276*       ridfld   (et-control-primary)
  4277*       resp     (ws-response)
  4278*    end-exec
  4279     MOVE LENGTH OF
  4280      ENDT-RECORD
  4281       TO DFHEIV11
  4282     MOVE 'ERENDT' TO DFHEIV1
  4283*    MOVE '&$ L                  ''  N#00003424' TO DFHEIV0
  4284     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4286     MOVE X'204E233030303033343234' TO DFHEIV0(25:11)
  4287     CALL 'kxdfhei1' USING DFHEIV0,
  4288           DFHEIV1,
  4289           ENDT-RECORD,
  4290           DFHEIV11,
  4291           et-control-primary,
  4292           DFHEIV99,
  4293           DFHEIV99
  4294     MOVE EIBRESP  TO ws-response
  4295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4296     if not resp-normal
  4297        move ws-response         to ra-status-code
  4298        move ' erendt write  error '
  4299                                 to ra-message
  4300        display 'error-erendt-write   ' ws-response
  4301        go to 0000-return
  4302     end-if
  4303     go to 0100-erendt-loop
  4304     .
  4305 0100-end-erendt.
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  76
* EL055.cbl
  4306     if ws-startbr-ind = 'Y'
  4307
  4308* exec cics endbr
  4309*          dataset     ('ERENDT')
  4310*       end-exec
  4311     MOVE 'ERENDT' TO DFHEIV1
  4312     MOVE 0
  4313       TO DFHEIV11
  4314*    MOVE '&2                    $   #00003441' TO DFHEIV0
  4315     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4316     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4317     MOVE X'2020233030303033343431' TO DFHEIV0(25:11)
  4318     CALL 'kxdfhei1' USING DFHEIV0,
  4319           DFHEIV1,
  4320           DFHEIV11,
  4321           DFHEIV99
  4322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4323     end-if
  4324     .
  4325 0100-exit.
  4326     exit.
  4327 0200-convert-key.
  4328     .
  4329 0200-exit.
  4330     exit.
  4331 0500-process-nsasextr.
  4332**** ======================================================== ****
  4333****                                                          ****
  4334****    Check for NSASEXTR records                            ****
  4335****                                                          ****
  4336**** ======================================================== ****
  4337     move ' '                    to ws-NS-startbr-ind
  4338     move +0                     to nsasextr-seq-no
  4339
  4340* exec cics startbr
  4341*       dataset    ('NSASEXTR')
  4342*       ridfld     (nsasextr-ridfld)
  4343*       gteq
  4344*       resp       (ws-response)
  4345*    end-exec
  4346     MOVE 'NSASEXTR' TO DFHEIV1
  4347     MOVE 0
  4348       TO DFHEIV11
  4349*    MOVE '&,         G          &  N#00003460' TO DFHEIV0
  4350     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4351     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4352     MOVE X'204E233030303033343630' TO DFHEIV0(25:11)
  4353     CALL 'kxdfhei1' USING DFHEIV0,
  4354           DFHEIV1,
  4355           nsasextr-ridfld,
  4356           DFHEIV99,
  4357           DFHEIV11,
  4358           DFHEIV99
  4359     MOVE EIBRESP  TO ws-response
  4360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4361     if RESP-NOTFND or resp-endfile
  4362        go to 0500-end-nsasextr
  4363     else
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  77
* EL055.cbl
  4364        if not resp-normal
  4365           move ws-response      to ra-status-code
  4366           move ' nsasextr error startbr '
  4367                                 to ra-message
  4368           display 'error-nsasextr-startbr ' ws-response
  4369           go to 0000-return
  4370        end-if
  4371     end-if
  4372     move 'Y'                    to ws-NS-startbr-ind
  4373     .
  4374 0500-nsasextr-loop.
  4375
  4376* exec cics readnext
  4377*       dataset    ('NSASEXTR')
  4378*       ridfld     (nsasextr-ridfld)
  4379*       into       (nsas-extract-record)
  4380*       resp       (ws-response)
  4381*    end-exec
  4382     MOVE LENGTH OF
  4383      nsas-extract-record
  4384       TO DFHEIV12
  4385     MOVE 'NSASEXTR' TO DFHEIV1
  4386     MOVE 0
  4387       TO DFHEIV11
  4388*    MOVE '&.IL                  )  N#00003480' TO DFHEIV0
  4389     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4390     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4391     MOVE X'204E233030303033343830' TO DFHEIV0(25:11)
  4392     CALL 'kxdfhei1' USING DFHEIV0,
  4393           DFHEIV1,
  4394           nsas-extract-record,
  4395           DFHEIV12,
  4396           nsasextr-ridfld,
  4397           DFHEIV99,
  4398           DFHEIV11,
  4399           DFHEIV99,
  4400           DFHEIV99
  4401     MOVE EIBRESP  TO ws-response
  4402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4403     if (RESP-NOTFND)
  4404        or (resp-endfile)
  4405        or (nsas-company-cd <> opk-company-cd)
  4406        or (nsas-archive-no <> la-archive-no)
  4407        go to 0500-end-nsasextr
  4408     else
  4409        if not resp-normal
  4410           move ws-response      to ra-status-code
  4411           move ' nsasextr error readnext '
  4412                                 to ra-message
  4413           display 'error-nsasextr-readnext ' ws-response
  4414           go to 0000-return
  4415        end-if
  4416     end-if
  4417     move nsas-control-primary   to nsasextr-ridfld
  4418
  4419* exec cics read update
  4420*       dataset  ('NSASEXTR')
  4421*       into     (nsas-extract-record)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  78
* EL055.cbl
  4422*       ridfld   (nsasextr-ridfld)
  4423*       resp     (ws-response)
  4424*    end-exec
  4425     MOVE LENGTH OF
  4426      nsas-extract-record
  4427       TO DFHEIV11
  4428     MOVE 'NSASEXTR' TO DFHEIV1
  4429*    MOVE '&"IL       EU         (  N#00003501' TO DFHEIV0
  4430     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4431     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4432     MOVE X'204E233030303033353031' TO DFHEIV0(25:11)
  4433     CALL 'kxdfhei1' USING DFHEIV0,
  4434           DFHEIV1,
  4435           nsas-extract-record,
  4436           DFHEIV11,
  4437           nsasextr-ridfld,
  4438           DFHEIV99,
  4439           DFHEIV99,
  4440           DFHEIV99
  4441     MOVE EIBRESP  TO ws-response
  4442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4443     if not resp-normal
  4444        move ws-response         to ra-status-code
  4445        move ' nsasextr read update error '
  4446                                 to ra-message
  4447        display 'error-nsasextr-read update ' ws-response
  4448        go to 0000-return
  4449     end-if
  4450     move zeros                  to nscntr
  4451     perform varying ns1 from +1 by +1 until
  4452        nscntr = +10
  4453        if nsas-letter-variables(ns1:1) = '~'
  4454           compute nscntr = nscntr + 1
  4455        end-if
  4456     end-perform
  4457     if nscntr = +10
  4458        if (nsas-letter-variables(ns1:10) =
  4459              ws-old-greg-eff-date)
  4460           and (nsas-letter-variables(ns1:10) <>
  4461              ws-new-greg-eff-date)
  4462           move ws-new-greg-eff-date
  4463                                 to nsas-letter-variables(ns1:10)
  4464        end-if
  4465        perform varying ns1 from ns1 by +1
  4466           until (nsas-letter-variables(ns1:1) = '~')
  4467              or (ns1 > +4000)
  4468        end-perform
  4469        compute ns1 = ns1 + 1
  4470        if ns1 < +4000
  4471           if (nsas-letter-variables(ns1:11) =
  4472                 opk-cert-no)
  4473              and (nsas-letter-variables(ns1:11) <>
  4474                 pa-new-cert-no)
  4475              move pa-new-cert-no to
  4476                 nsas-letter-variables(ns1:11)
  4477           end-if
  4478        end-if
  4479     end-if
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  79
* EL055.cbl
  4480
  4481* exec cics rewrite
  4482*       dataset  ('NSASEXTR')
  4483*       from     (nsas-extract-record)
  4484*       resp     (ws-response)
  4485*    end-exec
  4486     MOVE LENGTH OF
  4487      nsas-extract-record
  4488       TO DFHEIV11
  4489     MOVE 'NSASEXTR' TO DFHEIV1
  4490*    MOVE '&& L                  %  N#00003544' TO DFHEIV0
  4491     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4492     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4493     MOVE X'204E233030303033353434' TO DFHEIV0(25:11)
  4494     CALL 'kxdfhei1' USING DFHEIV0,
  4495           DFHEIV1,
  4496           nsas-extract-record,
  4497           DFHEIV11,
  4498           DFHEIV99
  4499     MOVE EIBRESP  TO ws-response
  4500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4501     if not resp-normal
  4502        move ws-response         to ra-status-code
  4503        move ' nsasextr write  error '
  4504                                 to ra-message
  4505        display 'error-nsasextr-write   ' ws-response
  4506        go to 0000-return
  4507     end-if
  4508     go to 0500-nsasextr-loop
  4509     .
  4510 0500-end-nsasextr.
  4511     if ws-NS-startbr-ind = 'Y'
  4512
  4513* exec cics endbr
  4514*          dataset     ('NSASEXTR')
  4515*       end-exec
  4516     MOVE 'NSASEXTR' TO DFHEIV1
  4517     MOVE 0
  4518       TO DFHEIV11
  4519*    MOVE '&2                    $   #00003560' TO DFHEIV0
  4520     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4521     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4522     MOVE X'2020233030303033353630' TO DFHEIV0(25:11)
  4523     CALL 'kxdfhei1' USING DFHEIV0,
  4524           DFHEIV1,
  4525           DFHEIV11,
  4526           DFHEIV99
  4527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4528     end-if
  4529     .
  4530 0500-exit.
  4531     exit.
  4532 8500-DATE-CONVERT.
  4533
  4534* EXEC CICS LINK
  4535*        PROGRAM  ('ELDATCV')
  4536*        COMMAREA (DATE-CONVERSION-DATA)
  4537*        LENGTH   (DC-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 29-Jul-20 14:46 Page  80
* EL055.cbl
  4538*    END-EXEC
  4539     MOVE 'ELDATCV' TO DFHEIV1
  4540*    MOVE '."C                   (   #00003568' TO DFHEIV0
  4541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4543     MOVE X'2020233030303033353638' TO DFHEIV0(25:11)
  4544     CALL 'kxdfhei1' USING DFHEIV0,
  4545           DFHEIV1,
  4546           DATE-CONVERSION-DATA,
  4547           DC-COMM-LENGTH,
  4548           DFHEIV99,
  4549           DFHEIV99,
  4550           DFHEIV99,
  4551           DFHEIV99
  4552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4553     .
  4554 8500-EXIT.
  4555     EXIT.
  4556
  4557 9999-DFHBACK SECTION.
  4558     MOVE '9%                    "   ' TO DFHEIV0
  4559     MOVE 'EL055' TO DFHEIV1
  4560     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4561     GOBACK.
  4562 9999-DFHEXIT.
  4563     IF DFHEIGDJ EQUAL 0001
  4564         NEXT SENTENCE.
  4565     MOVE '9%                    "   ' TO DFHEIV0
  4566     MOVE 'EL055' TO DFHEIV1
  4567     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4568     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13696     Code:       16127
