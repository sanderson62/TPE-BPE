* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   1
* EL202.cbl
* Options: int("EL202.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL202.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL202.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL202.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL202.
    10*
    11*AUTHOR.    Cowtown.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   2
* EL202.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  This program is waken up by a webservice request/http     ***
    17***  request and is passed a remit id. The program will next   ***
    18***  read tables CUC_Logic_Remittance and CUC_Logic_Remittance_***
    19***  cert using the remit id passed and will in turn generate  ***
    20***  a ERPYAJ record, ERPNDB and ERPNDM records.               ***
    21***                                                            ***
    22***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 091114  CR2013121800001  PEMA  NEW PROGRAM
    32* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    33* 040516  IR2016040100001  PEMA  CNVT ALL TEXT TO UPPER CASE
    34* 080116  IR2016090100005  PEMA  Expand numeric fields
    35*-----------------------------------------------------------------
    36 environment division.
    37 data division.
    38 working-storage section.
    39 01  DFH-START PIC X(04).
    40 77  s1                          pic s999 comp-3 value +0.
    41 77  s2                          pic s999 comp-3 value +0.
    42 77  i1                          pic s999 comp-3 value +0.
    43 77  o1                          pic s999 comp-3 value +0.
    44 77  ws-bin-current-dt           pic xx value low-values.
    45 77  ws-bin-eom-dt               pic xx value low-values.
    46 77  ws-table-sw                 pic x    value spaces.
    47     88  table-found               value 'Y'.
    48 77  ws-sql-code                 pic s9(7) value zeros.
    49 77  ws-dis-sql-code             pic -9999999 value zeros.
    50 77  ws-remit-sw                 pic x value ' '.
    51     88  ws-remit-not-found        value 'N'.
    52 77  work-seq-no                 pic s9(8) comp-3 value +0.
    53 77  ws-rollback-sw              pic x  value spaces.
    54     88  rollback-needed            value 'Y'.
    55 77  ws-commit-sw                pic x  value spaces.
    56     88  commit-needed              value 'Y'.
    57 77  ROLL-BACK                   PIC X(08) VALUE 'ROLLBACK'.
    58 01  P pointer.
    59 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    60 01  var-ptr pointer.
    61 01  env-var-len                 pic 9(4)  binary.
    62 01  rc                          pic 9(9)  binary.
    63 01  WS-KIXSYS.
    64     05  WS-KIX-FIL1             PIC X(10).
    65     05  WS-KIX-APPS             PIC X(10).
    66     05  WS-KIX-ENV              PIC X(10).
    67     05  WS-KIX-MYENV            PIC X(10).
    68     05  WS-KIX-SYS              PIC X(10).
*   69 EXEC SQL
*   70    INCLUDE SQLDA
*   71 END-EXEC
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   3
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72 01 SQLDA sync.
    73    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    74    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    75    05 SQLN                  PIC S9(4) COMP-5 value 0.
    76    05 SQLD                  PIC S9(4) COMP-5 value 0.
    77    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    78       10 SQLTYPE            PIC S9(4) COMP-5.
    79       10 SQLLEN             PIC S9(4) COMP-5.
    80$IF P64 SET
    81X      *> For 64-bit environments, ensure that SQLDATA is
    82X      *> aligned on an 8-byte boundary.
    83X      10 FILLER             PIC S9(9) COMP-5.
    84$END
    85       10 SQLDATA            USAGE POINTER.
    86       10 SQLIND             USAGE POINTER.
    87       10 SQLNAME.
    88          15 SQLNAMEL        PIC S9(4) COMP-5.
    89          15 SQLNAMEC        PIC X(30).
    90
    91* Values for SQLTYPE
    92
    93 78  ESQL-DATE-CHAR              VALUE 384.
    94 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    95 78  ESQL-DATE-REC               VALUE 386.
    96 78  ESQL-DATE-REC-NULL          VALUE 387.
    97 78  ESQL-TIME-CHAR              VALUE 388.
    98 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    99 78  ESQL-TIME-REC               VALUE 390.
   100 78  ESQL-TIME-REC-NULL          VALUE 391.
   101 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   102 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   103 78  ESQL-TIMESTAMP-REC          VALUE 394.
   104 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   105 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   106 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   107 78  ESQL-TS-OFFSET-REC          VALUE 398.
   108 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   109 78  ESQL-LONGVARBINARY          VALUE 404.
   110 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   111 78  ESQL-LONGVARCHAR            VALUE 408.
   112 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   113 78  ESQL-BINARY                 VALUE 444.
   114 78  ESQL-BINARY-NULL            VALUE 445.
   115 78  ESQL-VARBINARY              VALUE 446.
   116 78  ESQL-VARBINARY-NULL         VALUE 447.
   117 78  ESQL-VARCHAR                VALUE 448.
   118 78  ESQL-VARCHAR-NULL           VALUE 449.
   119
   120 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   121 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   122
   123 78  ESQL-CHAR                   VALUE 452.
   124 78  ESQL-CHAR-NULL              VALUE 453.
   125
   126 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   127 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   128
   129 78  ESQL-DOUBLE                 VALUE 480.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   4
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-DOUBLE-NULL            VALUE 481.
   131 78  ESQL-REAL                   VALUE 482.
   132 78  ESQL-REAL-NULL              VALUE 483.
   133 78  ESQL-DECIMAL                VALUE 484.
   134 78  ESQL-DECIMAL-NULL           VALUE 485.
   135 78  ESQL-INTEGER                VALUE 496.
   136 78  ESQL-INTEGER-NULL           VALUE 497.
   137 78  ESQL-SMALLINT               VALUE 500.
   138 78  ESQL-SMALLINT-NULL          VALUE 501.
   139 78  ESQL-TINYINT                VALUE 502.
   140 78  ESQL-TINYINT-NULL           VALUE 503.
*  141 EXEC SQL
*  142    INCLUDE SQLCA
*  143 END-EXEC
   144 01 SQLCA.
   145     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   146     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   147     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   148     05  SQLERRM.
   149         49  SQLERRML    PIC S9(4) COMP-5.
   150         49  SQLERRMC    PIC X(70).
   151     05  SQLERRP         PIC X(8).
   152     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   153     05  SQLWARN.
   154         10  SQLWARN0    PIC X.
   155         10  SQLWARN1    PIC X.
   156         10  SQLWARN2    PIC X.
   157         10  SQLWARN3    PIC X.
   158         10  SQLWARN4    PIC X.
   159         10  SQLWARN5    PIC X.
   160         10  SQLWARN6    PIC X.
   161         10  SQLWARN7    PIC X.
   162     05  SQLEXT.
   163         10  SQLWARN8    PIC X.
   164         10  SQLWARN9    PIC X.
   165         10  SQLWARN10   PIC X.
   166         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   167     05  SQLSTATE    PIC X(5).
   168 EXEC SQL
   169    BEGIN DECLARE SECTION
   170 END-EXEC
   171 01  ws-remit-id-a               pic x(10).
   172 01  ws-remit-id redefines
   173     ws-remit-id-a               pic 9(10).
   174 01  ws-key-stuff.
   175     05  ws-batch-no             pic x(6) value zeros.
   176     05  ws-batch-no-n redefines
   177         ws-batch-no             pic 9(6).
   178     05  ws-check-key            pic 9(7).
   179     05  ws-check-no             pic x(7).
   180     05  ws-compid               pic xxx.
   181     05  ws-carrier              pic x.
   182     05  ws-grouping             pic x(6).
   183     05  ws-state                pic xx.
   184     05  ws-account              pic x(10).
   185     05  ws-eff-date             pic x(10).
   186     05  ws-certificate          pic x(10).
   187     05  ws-cert-sfx             pic x.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   5
* EL202.cbl
   188     05  ws-seq-no               pic 999.
   189     05  ws-type                 pic 999.
   190 01  ws-status-code-a            pic x(7) value zeros.
   191 01  ws-status-code redefines
   192     ws-status-code-a            pic 9(7).
   193 01  ws-error-message            pic x(50) value spaces.
   194 01  ws-status-date              pic x(10).
   195 01  sqlcmd                      pic x(1024).
   196 01  svr                         pic x(32).
   197 01  usr                         pic x(32).
   198 01  pass                        pic x(32).
   199 01  usr-pass                    pic x(64).
   200 01  ws-disp-code                pic s9(11).
   201***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   202***                                                            ***
   203***  These indicators are used to determine if a variable      ***
   204***  is        null.           The indicator will be -1        ***
   205***  if the value        is null  and +0 if the value is       ***
   206***  something other than null.  Here is an example on how     ***
   207***  to use the indicator variables.                           ***
   208***                                                            ***
   209***     EXEC SQL                                               ***
   210***        fetch checkapp into                                 ***
   211***           :db-app-status :nu-app-status,                   ***
   212***           :db-app-by     :nu-app-by,                       ***
   213***           :db-app-date   :nu-app-date,                     ***
   214***           :db-app-batch  :nu-app-batch                     ***
   215***     END-EXEC                                               ***
   216***                                                            ***
   217***           OR This way on an update                         ***
   218***                                                            ***
   219***     EXEC SQL                                               ***
   220***        UPDATE                                              ***
   221***           CUC_Logic_Remittance                             ***
   222***        SET                                                 ***
   223***           LogicStatus     = :ws-status-code,               ***
   224***           LogicStatusDate = :ws-status-date,               ***
   225***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   226***        WHERE                                               ***
   227***           RemitId = :ws-remit-id                           ***
   228***     END-EXEC                                               ***
   229***                                                            ***
   230***    Also, when the table has a column with a data type of   ***
   231***  "BIT" and used as true/false move the 1 byte receiving    ***
   232***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   233***  then its false. I think true would be 256.                ***
   234***                                                            ***
   235***                                                            ***
   236***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   237 01  ws-bit                      pic x.
   238 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   239 01  indicator-vaiables-for-nulls.
   240     05  nu-app-status           pic s9(4) comp value +0.
   241     05  nu-app-by               pic s9(4) comp value +0.
   242     05  nu-app-date             pic s9(4) comp value +0.
   243     05  nu-app-batch            pic s9(4) comp value +0.
   244     05  nu-fincar               pic s9(4) comp value +0.
   245     05  nu-batchno              pic s9(4) comp value +0.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   6
* EL202.cbl
   246     05  nu-error-message        pic s9(4) comp value +0.
   247 01  sql-remit-record.
   248     05  sql-py-RemitId          pic 9(9).
   249     05  sql-py-Carrier          pic x.
   250     05  sql-py-Group            pic x(6).
   251     05  sql-py-State            pic xx.
   252     05  sql-py-AccountNumber    pic x(10).
   253     05  sql-py-Name             pic x(50).
   254     05  sql-py-Addr1            pic x(50).
   255     05  sql-py-Addr2            pic x(50).
   256     05  sql-py-AddrCity         pic x(50).
   257     05  sql-py-AddrState        pic xx.
   258     05  sql-py-AddrZIP          pic x(9).
   259     05  sql-py-ResponsibleCarrier
   260                                 pic x.
   261     05  sql-py-ResponsibleNumber
   262                                 pic x(10).
   263     05  sql-py-LogicStatus      pic 9(7).
   264     05  sql-py-LogicStatusDate  pic x(30).
   265     05  sql-py-company          pic xxx.
   266     05  sql-py-tot-prem         pic x(12).
   267     05  sql-py-tot-prem-n redefines
   268         sql-py-tot-prem         pic 9(9).99.
   269     05  sql-is-ach              pic x.
   270 01  sql-cert-records.
   271     05  sql-pb-CertId           pic 9(9).
   272     05  sql-pb-RemitId          pic 9(9).
   273     05  sql-pb-CertNumber       pic x(11).
   274     05  sql-pb-EffectiveDate    pic x(30).
   275     05  sql-pb-FirstPaymentDate pic x(30).
   276     05  sql-pb-FirstName        pic x(30).
   277     05  sql-pb-LastName         pic x(30).
   278     05  sql-pb-CashIndicator    pic x.
   279     05  sql-pb-LivesCovered     pic 9(7).
   280     05  sql-pb-LfBenCode        pic xx.
   281     05  sql-pb-LfTerm           pic 999.
   282     05  sql-pb-LfBenefit        pic x(12).
   283     05  sql-pb-lfbenefit-n redefines
   284         sql-pb-lfbenefit        pic 9(9).99.
   285     05  sql-pb-LfPremium        pic x(10).
   286     05  sql-pb-lfpremium-n redefines
   287         sql-pb-lfpremium        pic 9(7).99.
   288     05  sql-pb-AhBenCode        pic xx.
   289     05  sql-pb-AhTerm           pic 999.
   290     05  sql-pb-AhBenefit        pic x(12).
   291     05  sql-pb-ahbenefit-n redefines
   292         sql-pb-ahbenefit        pic 9(9).99.
   293     05  sql-pb-AhPremium        pic x(10).
   294     05  sql-pb-ahpremium-n redefines
   295         sql-pb-ahpremium        pic 9(7).99.
   296     05  sql-pb-ErrorMessage     pic x(50).
   297 EXEC SQL
   298    END DECLARE SECTION
   299 END-EXEC
   300 01  ws-roll-back-keys.
   301     05  ws-rb-erpyaj-key        pic x(33) value spaces.
   302 01  ws-batch-header-work-area.
   303     05  ws-lf-iss-premium          pic s9(9)v99 comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   7
* EL202.cbl
   304     05  ws-ah-iss-premium          pic s9(9)v99 comp-3 value +0.
   305     05  ws-iss-cnt                 pic s9(3) comp-3 value +0.
   306     05  ws-cnc-cnt                 pic s9(3) comp-3 value +0.
   307     05  ws-highest-seq-no          pic s9(4) comp value +0.
   308 01  FILE-KEYS.
   309     12  ELCNTL-KEY.
   310         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   311         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   312         16 ELCNTL-ACCESS.
   313             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   314             20  FILLER              PIC X       VALUE SPACES.
   315             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   316         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   317 01  ws-init-erpndb-rec          pic x(585) value spaces.
   318 01  ws-init-erpndm              pic x(374) value spaces.
   319 01  f.
   320     05  ws-batch-seq-no         pic s9(4) comp value +0.
   321     05  ws-connect-sw               pic x  value ' '.
   322         88  connected-to-db             value 'Y'.
   323     05  ws-comp-id              pic xxx.
   324     05  ws-comp-cd              pic x.
   325 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   326     88  RESP-NORMAL                    VALUE +0.
   327     88  resp-file-notfnd               value +12.
   328     88  RESP-NOTFND                    VALUE +13.
   329     88  resp-duprec                    value +14.
   330     88  resp-dupkey                    value +15.
   331     88  resp-invreq                    value +16.
   332     88  RESP-NOTOPEN                   VALUE +19.
   333     88  RESP-ENDFILE                   VALUE +20.
   334     88  resp-lengtherr                 value +22.
   335 01  ws-display-response         pic s9(5) value zeros.
   336 01  ws-work-time-a              pic x(6).
   337 01  ws-work-time redefines ws-work-time-a
   338                                 pic 9(6).
   339 01  ws-work-amt-alpha           pic x(11).
   340 01  ws-work-amt-num redefines ws-work-amt-alpha
   341                                 pic 9(9)v99.
   342 01  ws-qry-string               pic x(80) value spaces.
   343 01  ws-qrystr-len               pic s9(8) comp value +60.
   344 01  ws-var-alpha                pic x(10).
   345 01  ws-seq-alpha                pic x(5).
   346 01  ws-seq-no-num redefines ws-seq-alpha
   347                                 pic 9(5).
   348*                                copy ELCFUNDT.
   349*****************************************************************
   350*                                                               *
   351*                            ELCFUNDT.                          *
   352*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   353*                            VMOD=2.001                         *
   354*                                                               *
   355*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   356*                                                               *
   357*****************************************************************
   358
   359
   360 01  FUNCTION-DATE.
   361     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   8
* EL202.cbl
   362     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   363         10  WS-FN-CCYR            PIC 9(4).
   364         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   365             15  WS-FN-CC          PIC 99.
   366             15  WS-FN-YR          PIC 99.
   367         10  WS-FN-MO              PIC 99.
   368         10  WS-FN-DA              PIC 99.
   369     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   370     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   371     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   372     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   373     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   374         88  WS-BEHIND-GMT                     VALUE '-'.
   375         88  WS-AFTER-GMT                      VALUE '+'.
   376         88  WS-NO-GMT                         VALUE ZERO.
   377     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   378     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   379*                                COPY ELCDATE.
   380******************************************************************
   381*                                                                *
   382*                                                                *
   383*                            ELCDATE.                            *
   384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   385*                            VMOD=2.003
   386*                                                                *
   387*                                                                *
   388*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   389*                 LENGTH = 200                                   *
   390******************************************************************
   391
   392 01  DATE-CONVERSION-DATA.
   393     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   394     12  DC-OPTION-CODE                PIC X.
   395         88  BIN-TO-GREG                VALUE ' '.
   396         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   397         88  EDIT-GREG-TO-BIN           VALUE '2'.
   398         88  YMD-GREG-TO-BIN            VALUE '3'.
   399         88  MDY-GREG-TO-BIN            VALUE '4'.
   400         88  JULIAN-TO-BIN              VALUE '5'.
   401         88  BIN-PLUS-ELAPSED           VALUE '6'.
   402         88  FIND-CENTURY               VALUE '7'.
   403         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   404         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   405         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   406         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   407         88  JULIAN-TO-BIN-3            VALUE 'C'.
   408         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   409         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   410         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   411         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   412         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   413         88  CHECK-LEAP-YEAR            VALUE 'H'.
   414         88  BIN-3-TO-GREG              VALUE 'I'.
   415         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   416         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   417         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   418         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   419         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page   9
* EL202.cbl
   420         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   421         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   422         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   423         88  THREE-CHARACTER-BIN
   424                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   425         88  GREGORIAN-TO-BIN
   426                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   427         88  BIN-TO-GREGORIAN
   428                  VALUES ' ' '1' 'I' '8' 'G'.
   429         88  JULIAN-TO-BINARY
   430                  VALUES '5' 'C' 'E' 'F'.
   431     12  DC-ERROR-CODE                 PIC X.
   432         88  NO-CONVERSION-ERROR        VALUE ' '.
   433         88  DATE-CONVERSION-ERROR
   434                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   435         88  DATE-IS-ZERO               VALUE '1'.
   436         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   437         88  DATE-IS-INVALID            VALUE '3'.
   438         88  DATE1-GREATER-DATE2        VALUE '4'.
   439         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   440         88  DATE-INVALID-OPTION        VALUE '9'.
   441         88  INVALID-CENTURY            VALUE 'A'.
   442         88  ONLY-CENTURY               VALUE 'B'.
   443         88  ONLY-LEAP-YEAR             VALUE 'C'.
   444         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   445     12  DC-END-OF-MONTH               PIC X.
   446         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   447     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   448         88  USE-NORMAL-PROCESS         VALUE ' '.
   449         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   450         88  ADJUST-UP-100-YRS          VALUE '2'.
   451     12  FILLER                        PIC X.
   452     12  DC-CONVERSION-DATES.
   453         16  DC-BIN-DATE-1             PIC XX.
   454         16  DC-BIN-DATE-2             PIC XX.
   455         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   456         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   457                       DC-GREG-DATE-1-EDIT.
   458             20  DC-EDIT1-MONTH        PIC 99.
   459             20  SLASH1-1              PIC X.
   460             20  DC-EDIT1-DAY          PIC 99.
   461             20  SLASH1-2              PIC X.
   462             20  DC-EDIT1-YEAR         PIC 99.
   463         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   464         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   465                     DC-GREG-DATE-2-EDIT.
   466             20  DC-EDIT2-MONTH        PIC 99.
   467             20  SLASH2-1              PIC X.
   468             20  DC-EDIT2-DAY          PIC 99.
   469             20  SLASH2-2              PIC X.
   470             20  DC-EDIT2-YEAR         PIC 99.
   471         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   472         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   473                     DC-GREG-DATE-1-YMD.
   474             20  DC-YMD-YEAR           PIC 99.
   475             20  DC-YMD-MONTH          PIC 99.
   476             20  DC-YMD-DAY            PIC 99.
   477         16  DC-GREG-DATE-1-MDY        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  10
* EL202.cbl
   478         16  DC-GREG-DATE-1-MDY-R REDEFINES
   479                      DC-GREG-DATE-1-MDY.
   480             20  DC-MDY-MONTH          PIC 99.
   481             20  DC-MDY-DAY            PIC 99.
   482             20  DC-MDY-YEAR           PIC 99.
   483         16  DC-GREG-DATE-1-ALPHA.
   484             20  DC-ALPHA-MONTH        PIC X(10).
   485             20  DC-ALPHA-DAY          PIC 99.
   486             20  FILLER                PIC XX.
   487             20  DC-ALPHA-CENTURY.
   488                 24 DC-ALPHA-CEN-N     PIC 99.
   489             20  DC-ALPHA-YEAR         PIC 99.
   490         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   491         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   492         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   493         16  DC-JULIAN-DATE            PIC 9(05).
   494         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   495                                       PIC 9(05).
   496         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   497             20  DC-JULIAN-YEAR        PIC 99.
   498             20  DC-JULIAN-DAYS        PIC 999.
   499         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   500         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   501         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   502     12  DATE-CONVERSION-VARIBLES.
   503         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   504         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   505             20  FILLER                PIC 9(3).
   506             20  HOLD-CEN-1-CCYY.
   507                 24  HOLD-CEN-1-CC     PIC 99.
   508                 24  HOLD-CEN-1-YY     PIC 99.
   509             20  HOLD-CEN-1-MO         PIC 99.
   510             20  HOLD-CEN-1-DA         PIC 99.
   511         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   512             20  HOLD-CEN-1-R-MO       PIC 99.
   513             20  HOLD-CEN-1-R-DA       PIC 99.
   514             20  HOLD-CEN-1-R-CCYY.
   515                 24  HOLD-CEN-1-R-CC   PIC 99.
   516                 24  HOLD-CEN-1-R-YY   PIC 99.
   517             20  FILLER                PIC 9(3).
   518         16  HOLD-CENTURY-1-X.
   519             20  FILLER                PIC X(3)  VALUE SPACES.
   520             20  HOLD-CEN-1-X-CCYY.
   521                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   522                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   523             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   524             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   525         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   526             20  HOLD-CEN-1-R-X-MO     PIC XX.
   527             20  HOLD-CEN-1-R-X-DA     PIC XX.
   528             20  HOLD-CEN-1-R-X-CCYY.
   529                 24  HOLD-CEN-1-R-X-CC PIC XX.
   530                 24  HOLD-CEN-1-R-X-YY PIC XX.
   531             20  FILLER                PIC XXX.
   532         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   533         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   534         16  DC-JULIAN-DATE-1          PIC 9(07).
   535         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  11
* EL202.cbl
   536             20  DC-JULIAN-1-CCYY.
   537                 24  DC-JULIAN-1-CC    PIC 99.
   538                 24  DC-JULIAN-1-YR    PIC 99.
   539             20  DC-JULIAN-DA-1        PIC 999.
   540         16  DC-JULIAN-DATE-2          PIC 9(07).
   541         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   542             20  DC-JULIAN-2-CCYY.
   543                 24  DC-JULIAN-2-CC    PIC 99.
   544                 24  DC-JULIAN-2-YR    PIC 99.
   545             20  DC-JULIAN-DA-2        PIC 999.
   546         16  DC-GREG-DATE-A-EDIT.
   547             20  DC-EDITA-MONTH        PIC 99.
   548             20  SLASHA-1              PIC X VALUE '/'.
   549             20  DC-EDITA-DAY          PIC 99.
   550             20  SLASHA-2              PIC X VALUE '/'.
   551             20  DC-EDITA-CCYY.
   552                 24  DC-EDITA-CENT     PIC 99.
   553                 24  DC-EDITA-YEAR     PIC 99.
   554         16  DC-GREG-DATE-B-EDIT.
   555             20  DC-EDITB-MONTH        PIC 99.
   556             20  SLASHB-1              PIC X VALUE '/'.
   557             20  DC-EDITB-DAY          PIC 99.
   558             20  SLASHB-2              PIC X VALUE '/'.
   559             20  DC-EDITB-CCYY.
   560                 24  DC-EDITB-CENT     PIC 99.
   561                 24  DC-EDITB-YEAR     PIC 99.
   562         16  DC-GREG-DATE-CYMD         PIC 9(08).
   563         16  DC-GREG-DATE-CYMD-R REDEFINES
   564                              DC-GREG-DATE-CYMD.
   565             20  DC-CYMD-CEN           PIC 99.
   566             20  DC-CYMD-YEAR          PIC 99.
   567             20  DC-CYMD-MONTH         PIC 99.
   568             20  DC-CYMD-DAY           PIC 99.
   569         16  DC-GREG-DATE-MDCY         PIC 9(08).
   570         16  DC-GREG-DATE-MDCY-R REDEFINES
   571                              DC-GREG-DATE-MDCY.
   572             20  DC-MDCY-MONTH         PIC 99.
   573             20  DC-MDCY-DAY           PIC 99.
   574             20  DC-MDCY-CEN           PIC 99.
   575             20  DC-MDCY-YEAR          PIC 99.
   576    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   577        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   578    12  DC-EL310-DATE                  PIC X(21).
   579    12  FILLER                         PIC X(28).
   580*                                COPY ELCCNTL.
   581******************************************************************
   582*                                                                *
   583*                                                                *
   584*                            ELCCNTL.                            *
   585*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   586*                            VMOD=2.059                          *
   587*                                                                *
   588*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   589*                                                                *
   590*   FILE TYPE = VSAM,KSDS                                        *
   591*   RECORD SIZE = 750  RECFORM = FIXED                           *
   592*                                                                *
   593*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  12
* EL202.cbl
   594*       ALTERNATE INDEX = NONE                                   *
   595*                                                                *
   596*   LOG = YES                                                    *
   597*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   598******************************************************************
   599*                   C H A N G E   L O G
   600*
   601* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   602*-----------------------------------------------------------------
   603*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   604* EFFECTIVE    NUMBER
   605*-----------------------------------------------------------------
   606* 082503                   PEMA  ADD BENEFIT GROUP
   607* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   608* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   609* 092705    2005050300006  PEMA  ADD SPP LEASES
   610* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   611* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   612* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   613* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   614* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   615* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   616* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   617* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   618* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   619* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   620******************************************************************
   621*
   622 01  CONTROL-FILE.
   623     12  CF-RECORD-ID                       PIC XX.
   624         88  VALID-CF-ID                        VALUE 'CF'.
   625
   626     12  CF-CONTROL-PRIMARY.
   627         16  CF-COMPANY-ID                  PIC XXX.
   628         16  CF-RECORD-TYPE                 PIC X.
   629             88  CF-COMPANY-MASTER              VALUE '1'.
   630             88  CF-PROCESSOR-MASTER            VALUE '2'.
   631             88  CF-STATE-MASTER                VALUE '3'.
   632             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   633             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   634             88  CF-CARRIER-MASTER              VALUE '6'.
   635             88  CF-MORTALITY-MASTER            VALUE '7'.
   636             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   637             88  CF-TERMINAL-MASTER             VALUE '9'.
   638             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   639             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   640             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   641             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   642             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   643             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   644             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   645             88  CF-REMINDERS-MASTER            VALUE 'R'.
   646             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   647         16  CF-ACCESS-CD-GENL              PIC X(4).
   648         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   649             20  CF-PROCESSOR               PIC X(4).
   650         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   651             20  CF-STATE-CODE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  13
* EL202.cbl
   652             20  FILLER                     PIC XX.
   653         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   654             20  FILLER                     PIC XX.
   655             20  CF-HI-BEN-IN-REC           PIC XX.
   656         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   657             20  FILLER                     PIC XXX.
   658             20  CF-CARRIER-CNTL            PIC X.
   659         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   660             20  FILLER                     PIC XX.
   661             20  CF-HI-TYPE-IN-REC          PIC 99.
   662         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   663             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   664                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   665             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   666             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   667         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   668             20  FILLER                     PIC X.
   669             20  CF-CUSTOM-REPORT-NO        PIC 999.
   670         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   671             20  FILLER                     PIC XX.
   672             20  CF-MORTGAGE-PLAN           PIC XX.
   673         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   674
   675     12  CF-LAST-MAINT-DT                   PIC XX.
   676     12  CF-LAST-MAINT-BY                   PIC X(4).
   677     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   678
   679     12  CF-RECORD-BODY                     PIC X(728).
   680
   681
   682****************************************************************
   683*             COMPANY MASTER RECORD                            *
   684****************************************************************
   685
   686     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   687         16  CF-COMPANY-ADDRESS.
   688             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   689             20  CF-CL-IN-CARE-OF           PIC X(30).
   690             20  CF-CL-ADDR-LINE-1          PIC X(30).
   691             20  CF-CL-ADDR-LINE-2          PIC X(30).
   692             20  CF-CL-CITY-STATE           PIC X(30).
   693             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   694             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   695         16  CF-COMPANY-CD                  PIC X.
   696         16  CF-COMPANY-PASSWORD            PIC X(8).
   697         16  CF-SECURITY-OPTION             PIC X.
   698             88  ALL-SECURITY                   VALUE '1'.
   699             88  COMPANY-VERIFY                 VALUE '2'.
   700             88  PROCESSOR-VERIFY               VALUE '3'.
   701             88  NO-SECURITY                    VALUE '4'.
   702             88  ALL-BUT-TERM                   VALUE '5'.
   703         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   704             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   705         16  CF-LGX-INTERFACE-CNTL          PIC X.
   706             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   707         16  CF-INFORCE-LOCATION            PIC X.
   708             88  CERTS-ARE-ONLINE               VALUE '1'.
   709             88  CERTS-ARE-OFFLINE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  14
* EL202.cbl
   710             88  NO-CERTS-AVAILABLE             VALUE '3'.
   711         16  CF-LOWER-CASE-LETTERS          PIC X.
   712         16  CF-CERT-ACCESS-CONTROL         PIC X.
   713             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   714             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   715             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   716             88  CF-ACCNT-CNTL                  VALUE '3'.
   717             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   718
   719         16  CF-FORMS-PRINTER-ID            PIC X(4).
   720         16  CF-CHECK-PRINTER-ID            PIC X(4).
   721
   722         16  CF-LGX-CREDIT-USER             PIC X.
   723             88  CO-IS-NOT-USER                 VALUE 'N'.
   724             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   725
   726         16 CF-CREDIT-CALC-CODES.
   727             20  CF-CR-REM-TERM-CALC PIC X.
   728               88  CR-EARN-AFTER-15TH           VALUE '1'.
   729               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   730               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   731               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   732               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   733               88  CR-EARN-AFTER-14TH           VALUE '6'.
   734               88  CR-EARN-AFTER-16TH           VALUE '7'.
   735             20  CF-CR-R78-METHOD           PIC X.
   736               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   737               88  DONT-USE-PLUS-ONE            VALUE '1'.
   738
   739         16  CF-CLAIM-CONTROL-COUNTS.
   740             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   741                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   742
   743             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   744                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   745
   746             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   747                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   748
   749             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   750                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   751
   752         16  CF-CURRENT-MONTH-END           PIC XX.
   753
   754         16  CF-CO-CALC-QUOTE-TOLERANCE.
   755             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   756             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   757             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   758             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   759                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   760                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   761             20  CF-CO-PREM-REJECT-SW       PIC X.
   762                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   763                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   764             20  CF-CO-REF-REJECT-SW        PIC X.
   765                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   766                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   767
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  15
* EL202.cbl
   768         16  CF-CO-REPORTING-DT             PIC XX.
   769         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   770         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   771           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   772           88  CF-CO-MONTH-END                  VALUE '1'.
   773
   774         16  CF-LGX-CLAIM-USER              PIC X.
   775             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   776             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   777
   778         16  CF-CREDIT-EDIT-CONTROLS.
   779             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   780             20  CF-MIN-AGE                 PIC 99.
   781             20  CF-DEFAULT-AGE             PIC 99.
   782             20  CF-MIN-TERM                PIC S999      COMP-3.
   783             20  CF-MAX-TERM                PIC S999      COMP-3.
   784             20  CF-DEFAULT-SEX             PIC X.
   785             20  CF-JOINT-AGE-INPUT         PIC X.
   786                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   787             20  CF-BIRTH-DATE-INPUT        PIC X.
   788                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   789             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   790                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   791                 88  CF-ZERO-CARRIER            VALUE '1'.
   792                 88  CF-ZERO-GROUPING           VALUE '2'.
   793                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   794             20  CF-EDIT-SW                 PIC X.
   795                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   796             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   797             20  CF-CR-PR-METHOD            PIC X.
   798               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   799               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   800             20  FILLER                     PIC X.
   801
   802         16  CF-CREDIT-MISC-CONTROLS.
   803             20  CF-REIN-TABLE-SW           PIC X.
   804                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   805             20  CF-COMP-TABLE-SW           PIC X.
   806                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   807             20  CF-EXPERIENCE-RETENTION-AGE
   808                                            PIC S9        COMP-3.
   809             20  CF-CONVERSION-DT           PIC XX.
   810             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   811             20  CF-RUN-FREQUENCY-SW        PIC X.
   812                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   813                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   814
   815             20  CF-CR-CHECK-NO-CONTROL.
   816                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   817                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   818                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   819                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   820                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   821                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   822
   823                 24  CF-CR-CHECK-COUNT       REDEFINES
   824                     CF-CR-CHECK-COUNTER      PIC X(4).
   825
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  16
* EL202.cbl
   826                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   827                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   828
   829                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   830                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   831                 24  CF-MAIL-PROCESSING       PIC X.
   832                     88  MAIL-PROCESSING          VALUE 'Y'.
   833
   834         16  CF-MISC-SYSTEM-CONTROL.
   835             20  CF-SYSTEM-C                 PIC X.
   836                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   837             20  CF-SYSTEM-D                 PIC X.
   838                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   839             20  CF-SOC-SEC-NO-SW            PIC X.
   840                 88  SOC-SEC-NO-USED             VALUE '1'.
   841             20  CF-MEMBER-NO-SW             PIC X.
   842                 88  MEMBER-NO-USED              VALUE '1'.
   843             20  CF-TAX-ID-NUMBER            PIC X(11).
   844             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   845             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   846                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   847                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   848                 88  CF-ALL-APPROVED             VALUE 'Y'.
   849                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   850             20  CF-SYSTEM-E                 PIC X.
   851                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   852
   853         16  CF-LGX-LIFE-USER               PIC X.
   854             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   855             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   856
   857         16  CF-CR-MONTH-END-DT             PIC XX.
   858
   859         16  CF-FILE-MAINT-DATES.
   860             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   861                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   862             20  CF-LAST-BATCH       REDEFINES
   863                 CF-LAST-BATCH-NO               PIC X(4).
   864             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   865             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   866             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   867             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   868             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   869             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   870             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   871             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   872             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   873             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   874
   875         16  CF-NEXT-COMPANY-ID             PIC XXX.
   876         16  FILLER                         PIC X.
   877
   878         16  CF-ALT-MORT-CODE               PIC X(4).
   879         16  CF-MEMBER-CAPTION              PIC X(10).
   880
   881         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   882             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   883             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  17
* EL202.cbl
   884             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
   885             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   886             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   887
   888         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   889
   890         16  CF-LIFE-OVERRIDE-L1            PIC X.
   891         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   892         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   893         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   894
   895         16  CF-AH-OVERRIDE-L1              PIC X.
   896         16  CF-AH-OVERRIDE-L2              PIC XX.
   897         16  CF-AH-OVERRIDE-L6              PIC X(6).
   898         16  CF-AH-OVERRIDE-L12             PIC X(12).
   899
   900         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   901         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   902
   903         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   904         16  CF-AR-LAST-EL860-DT            PIC XX.
   905         16  CF-MP-MONTH-END-DT             PIC XX.
   906
   907         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   908         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   909             88  CF-CLAIM-PAID-TO               VALUE '1'.
   910
   911         16  CF-AR-MONTH-END-DT             PIC XX.
   912
   913         16  CF-CRDTCRD-USER                PIC X.
   914             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   915             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   916
   917         16  CF-CC-MONTH-END-DT             PIC XX.
   918
   919         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   920
   921         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   922             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   923             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   924             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   925         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   926         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   927         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   928         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   929             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   930             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   931         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   932         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   933         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   934             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   935         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   936
   937         16  CF-CL-ZIP-CODE.
   938             20  CF-CL-ZIP-PRIME.
   939                 24  CF-CL-ZIP-1ST          PIC X.
   940                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   941                 24  FILLER                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  18
* EL202.cbl
   942             20  CF-CL-ZIP-PLUS4            PIC X(4).
   943         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   944             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   945             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   946             20  FILLER                     PIC XXX.
   947
   948         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   949         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   950         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   951         16  CF-CO-OPTION-START-DATE        PIC XX.
   952         16  CF-REM-TRM-CALC-OPTION         PIC X.
   953           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   954                                                      '3' '4'.
   955           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   956           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   957           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   958           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   959           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   960           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   961
   962         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   963
   964         16  CF-PAYMENT-APPROVAL-LEVELS.
   965             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   966             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   967             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   968             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   969             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   970             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   971
   972         16  CF-END-USER-REPORTING-USER     PIC X.
   973             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   974             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   975
   976         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   977             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   978             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   979
   980         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   981
   982         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   983         16  FILLER                         PIC X.
   984
   985         16  CF-CREDIT-ARCHIVE-CNTL.
   986             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   987             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   988             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   989
   990         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   991
   992         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   993             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   994             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   995
   996         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   997             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   998             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   999
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  19
* EL202.cbl
  1000         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1001
  1002         16  CF-CO-ACH-ID-CODE              PIC  X.
  1003             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1004             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1005             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1006         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1007         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1008         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1009         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1010         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1011         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1012         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1013         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1014         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1015                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1016         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1017                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1018
  1019         16  CF-CO-OVER-SHORT.
  1020             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1021             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1022
  1023*         16  FILLER                         PIC X(102).
  1024         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1025             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1026             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1027
  1028         16  CF-AH-APPROVAL-DAYS.
  1029             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1030             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1031             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1032             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1033
  1034         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1035
  1036         16  CF-APPROV-LEV-5.
  1037             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1038             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1039             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1040
  1041         16  FILLER                         PIC X(68).
  1042****************************************************************
  1043*             PROCESSOR/USER RECORD                            *
  1044****************************************************************
  1045
  1046     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1047         16  CF-PROCESSOR-NAME              PIC X(30).
  1048         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1049         16  CF-PROCESSOR-TITLE             PIC X(26).
  1050         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1051                 88  MESSAGE-YES                VALUE 'Y'.
  1052                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1053
  1054*****************************************************
  1055****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1056****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1057****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  20
* EL202.cbl
  1058****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1059*****************************************************
  1060
  1061         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1062             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1063             20  CF-APPLICATION-FORCE       PIC X.
  1064             20  CF-INDIVIDUAL-APP.
  1065                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1066                     28  CF-BROWSE-APP      PIC X.
  1067                     28  CF-UPDATE-APP      PIC X.
  1068
  1069         16  CF-CURRENT-TERM-ON             PIC X(4).
  1070         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1071             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1072             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1073             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1074             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1075             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1076             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1077             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1078         16  CF-PROCESSOR-CARRIER           PIC X.
  1079             88  NO-CARRIER-SECURITY            VALUE ' '.
  1080         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1081             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1082         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1083             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1084         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1085             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1086
  1087         16  CF-PROC-SYS-ACCESS-SW.
  1088             20  CF-PROC-CREDIT-CLAIMS-SW.
  1089                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1090                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1091                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1092                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1093             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1094                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1095                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1096             20  CF-PROC-LIFE-GNRLDGR-SW.
  1097                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1098                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1099                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1100                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1101             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1102                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1103                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1104         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1105             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1106             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1107         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1108
  1109         16  CF-APPROVAL-LEVEL                  PIC X.
  1110             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1111             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1112             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1113             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1114             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1115
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  21
* EL202.cbl
  1116         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1117
  1118         16  CF-LANGUAGE-TYPE                   PIC X.
  1119             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1120             88  CF-LANG-IS-FR                      VALUE 'F'.
  1121
  1122         16  CF-CSR-IND                         PIC X.
  1123         16  FILLER                             PIC X(239).
  1124
  1125****************************************************************
  1126*             PROCESSOR/REMINDERS RECORD                       *
  1127****************************************************************
  1128
  1129     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1130         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1131             20  CF-START-REMIND-DT         PIC XX.
  1132             20  CF-END-REMIND-DT           PIC XX.
  1133             20  CF-REMINDER-TEXT           PIC X(50).
  1134         16  FILLER                         PIC X(296).
  1135
  1136
  1137****************************************************************
  1138*             STATE MASTER RECORD                              *
  1139****************************************************************
  1140
  1141     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1142         16  CF-STATE-ABBREVIATION          PIC XX.
  1143         16  CF-STATE-NAME                  PIC X(25).
  1144         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1145         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1146             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1147             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1148             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1149             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1150                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1151                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1152             20  CF-ST-PREM-REJECT-SW       PIC X.
  1153                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1154                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1155             20  CF-ST-REF-REJECT-SW        PIC X.
  1156                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1157                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1158         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1159         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1160         16  CF-ST-REFUND-RULES.
  1161             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1162             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1163             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1164         16  CF-ST-FST-PMT-EXTENSION.
  1165             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1166             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1167                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1168                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1169                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1170                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1171         16  CF-ST-STATE-CALL.
  1172             20  CF-ST-CALL-UNEARNED        PIC X.
  1173             20  CF-ST-CALL-RPT-CNTL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  22
* EL202.cbl
  1174             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1175         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1176             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1177             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1178         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1179         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1180         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1181         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1182         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1183         16  FILLER                         PIC X.
  1184         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1185             20  CF-ST-BENEFIT-CD           PIC XX.
  1186             20  CF-ST-BENEFIT-KIND         PIC X.
  1187                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1188                 88  CF-ST-AH-KIND              VALUE 'A'.
  1189             20  CF-ST-REM-TERM-CALC        PIC X.
  1190                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1191                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1192                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1193                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1194                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1195                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1196                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1197                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1198
  1199             20  CF-ST-REFUND-CALC          PIC X.
  1200                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1201                 88  ST-REFD-BY-R78             VALUE '1'.
  1202                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1203                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1204                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1205                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1206                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1207                 88  ST-REFD-UTAH               VALUE '7'.
  1208                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1209                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1210                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1211
  1212             20  CF-ST-EARNING-CALC         PIC X.
  1213                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1214                 88  ST-EARN-BY-R78             VALUE '1'.
  1215                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1216                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1217                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1218                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1219                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1220                 88  ST-EARN-MEAN               VALUE '8'.
  1221                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1222
  1223             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1224                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1225                 88  ST-OVRD-BY-R78             VALUE '1'.
  1226                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1227                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1228                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1229                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1230                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1231                 88  ST-OVRD-MEAN               VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  23
* EL202.cbl
  1232                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1233             20  cf-st-extra-periods        pic 9.
  1234*            20  FILLER                     PIC X.
  1235
  1236         16  CF-ST-COMMISSION-CAPS.
  1237             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1238             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1239             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1240             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1241         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1242                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1243
  1244         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1245
  1246         16  CF-ST-STATUTORY-INTEREST.
  1247             20  CF-ST-STAT-DATE-FROM       PIC X.
  1248                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1249                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1250             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1251             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1252             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1253             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1254             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1255
  1256         16  CF-ST-OVER-SHORT.
  1257             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1258             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1259
  1260         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1261
  1262         16  CF-ST-RT-CALC                  PIC X.
  1263
  1264         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1265         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1266         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1267         16  CF-ST-RF-LR-CALC               PIC X.
  1268         16  CF-ST-RF-LL-CALC               PIC X.
  1269         16  CF-ST-RF-LN-CALC               PIC X.
  1270         16  CF-ST-RF-AH-CALC               PIC X.
  1271         16  CF-ST-RF-CP-CALC               PIC X.
  1272*        16  FILLER                         PIC X(206).
  1273*CIDMOD         16  FILLER                         PIC X(192).
  1274         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1275             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1276         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1277         16  CF-ST-VFY-2ND-BENE             PIC X.
  1278         16  CF-ST-CAUSAL-STATE             PIC X.
  1279         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1280         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1281         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1282             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1283         16  CF-ST-NET-ONLY-STATE           PIC X.
  1284             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1285         16  FILLER                         PIC X(181).
  1286
  1287****************************************************************
  1288*             BENEFIT MASTER RECORD                            *
  1289****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  24
* EL202.cbl
  1290
  1291     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1292         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1293             20  CF-BENEFIT-CODE            PIC XX.
  1294             20  CF-BENEFIT-NUMERIC  REDEFINES
  1295                 CF-BENEFIT-CODE            PIC XX.
  1296             20  CF-BENEFIT-ALPHA           PIC XXX.
  1297             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1298             20  CF-BENEFIT-COMMENT         PIC X(10).
  1299
  1300             20  CF-LF-COVERAGE-TYPE        PIC X.
  1301                 88  CF-REDUCING                VALUE 'R'.
  1302                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1303
  1304             20  CF-SPECIAL-CALC-CD         PIC X.
  1305                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1306                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1307                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1308                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1309                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1310                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1311                 88  CF-FARM-PLAN               VALUE 'F'.
  1312                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1313                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1314                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1315                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1316                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1317                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1318                 88  CF-PRUDENTIAL              VALUE 'P'.
  1319                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1320                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1321                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1322                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1323                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1324                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1325
  1326             20  CF-JOINT-INDICATOR         PIC X.
  1327                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1328
  1329*            20  FILLER                     PIC X(12).
  1330             20  cf-maximum-benefits        pic s999 comp-3.
  1331             20  FILLER                     PIC X(09).
  1332             20  CF-BENEFIT-CATEGORY        PIC X.
  1333             20  CF-LOAN-TYPE               PIC X(8).
  1334
  1335             20  CF-CO-REM-TERM-CALC        PIC X.
  1336                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1337                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1338                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1339                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1340                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1341
  1342             20  CF-CO-EARNINGS-CALC        PIC X.
  1343                 88  CO-EARN-BY-R78             VALUE '1'.
  1344                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1345                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1346                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1347                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  25
* EL202.cbl
  1348                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1349                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1350                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1351
  1352             20  CF-CO-REFUND-CALC          PIC X.
  1353                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1354                 88  CO-REFD-BY-R78             VALUE '1'.
  1355                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1356                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1357                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1358                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1359                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1360                 88  CO-REFD-MEAN               VALUE '8'.
  1361                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1362                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1363                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1364
  1365             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1366                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1367                 88  CO-OVRD-BY-R78             VALUE '1'.
  1368                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1369                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1370                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1371                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1372                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1373                 88  CO-OVRD-MEAN               VALUE '8'.
  1374                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1375
  1376             20  CF-CO-BEN-I-G-CD           PIC X.
  1377                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1378                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1379                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1380
  1381         16  FILLER                         PIC X(304).
  1382
  1383
  1384****************************************************************
  1385*             CARRIER MASTER RECORD                            *
  1386****************************************************************
  1387
  1388     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1389         16  CF-ADDRESS-DATA.
  1390             20  CF-MAIL-TO-NAME            PIC X(30).
  1391             20  CF-IN-CARE-OF              PIC X(30).
  1392             20  CF-ADDRESS-LINE-1          PIC X(30).
  1393             20  CF-ADDRESS-LINE-2          PIC X(30).
  1394             20  CF-CITY-STATE              PIC X(30).
  1395             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1396             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1397
  1398         16  CF-CLAIM-NO-CONTROL.
  1399             20  CF-CLAIM-NO-METHOD         PIC X.
  1400                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1401                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1402                 88  CLAIM-NO-SEQ               VALUE '3'.
  1403                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1404             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1405                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  26
* EL202.cbl
  1406                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1407                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1408
  1409         16  CF-CHECK-NO-CONTROL.
  1410             20  CF-CHECK-NO-METHOD         PIC X.
  1411                 88  CHECK-NO-MANUAL            VALUE '1'.
  1412                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1413                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1414                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1415             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1416                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1417
  1418         16  CF-DOMICILE-STATE              PIC XX.
  1419
  1420         16  CF-EXPENSE-CONTROLS.
  1421             20  CF-EXPENSE-METHOD          PIC X.
  1422                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1423                 88  DOLLARS-PER-PMT            VALUE '2'.
  1424                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1425                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1426             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1427             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1428
  1429         16  CF-CORRESPONDENCE-CONTROL.
  1430             20  CF-LETTER-RESEND-OPT       PIC X.
  1431                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1432                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1433             20  FILLER                     PIC X(4).
  1434
  1435         16  CF-RESERVE-CONTROLS.
  1436             20  CF-MANUAL-SW               PIC X.
  1437                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1438             20  CF-FUTURE-SW               PIC X.
  1439                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1440             20  CF-PTC-SW                  PIC X.
  1441                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1442             20  CF-IBNR-SW                 PIC X.
  1443                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1444             20  CF-PTC-LF-SW               PIC X.
  1445                 88  CF-LF-PTC-USED             VALUE '1'.
  1446             20  CF-CDT-ACCESS-METHOD       PIC X.
  1447                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1448                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1449                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1450             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1451
  1452         16  CF-CLAIM-CALC-METHOD           PIC X.
  1453             88  360-PLUS-MONTHS                VALUE '1'.
  1454             88  365-PLUS-MONTHS                VALUE '2'.
  1455             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1456             88  360-DAILY                      VALUE '4'.
  1457             88  365-DAILY                      VALUE '5'.
  1458
  1459         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1460         16  FILLER                         PIC X(11).
  1461
  1462         16  CF-LIMIT-AMOUNTS.
  1463             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  27
* EL202.cbl
  1464             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1465             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1466             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1467             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1468             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1469             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1470             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1471             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1472             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1473
  1474         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1475         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1476         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1477
  1478         16  CF-ZIP-CODE.
  1479             20  CF-ZIP-PRIME.
  1480                 24  CF-ZIP-1ST             PIC X.
  1481                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1482                 24  FILLER                 PIC X(4).
  1483             20  CF-ZIP-PLUS4               PIC X(4).
  1484         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1485             20  CF-CAN-POSTAL-1            PIC XXX.
  1486             20  CF-CAN-POSTAL-2            PIC XXX.
  1487             20  FILLER                     PIC XXX.
  1488
  1489         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1490         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1491         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1492
  1493         16  CF-RATING-SWITCH               PIC X.
  1494             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1495             88  CF-NO-RATING                   VALUE 'N'.
  1496
  1497         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1498
  1499         16  CF-CARRIER-OVER-SHORT.
  1500             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1501             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1502
  1503         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1504         16  CF-SECPAY-SWITCH               PIC X.
  1505             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1506             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1507         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1508         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1509         16  FILLER                         PIC X(444).
  1510*        16  FILLER                         PIC X(452).
  1511
  1512
  1513****************************************************************
  1514*             MORTALITY MASTER RECORD                          *
  1515****************************************************************
  1516
  1517     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1518         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1519                                INDEXED BY CF-MORT-NDX.
  1520             20  CF-MORT-TABLE              PIC X(5).
  1521             20  CF-MORT-TABLE-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  28
* EL202.cbl
  1522                 88  CF-MORT-JOINT              VALUE 'J'.
  1523                 88  CF-MORT-SINGLE             VALUE 'S'.
  1524                 88  CF-MORT-COMBINED           VALUE 'C'.
  1525                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1526                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1527             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1528             20  CF-MORT-AGE-METHOD         PIC XX.
  1529                 88  CF-AGE-LAST                VALUE 'AL'.
  1530                 88  CF-AGE-NEAR                VALUE 'AN'.
  1531             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1532             20  CF-MORT-ADJUSTMENT-DIRECTION
  1533                                            PIC X.
  1534                 88  CF-MINUS                   VALUE '-'.
  1535                 88  CF-PLUS                    VALUE '+'.
  1536             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1537             20  CF-MORT-JOINT-CODE         PIC X.
  1538                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1539             20  CF-MORT-PC-Q               PIC X.
  1540                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1541             20  CF-MORT-TABLE-CODE         PIC X(4).
  1542             20  CF-MORT-COMMENTS           PIC X(15).
  1543             20  FILLER                     PIC X(14).
  1544
  1545         16  FILLER                         PIC X(251).
  1546
  1547
  1548****************************************************************
  1549*             BUSSINESS TYPE MASTER RECORD                     *
  1550****************************************************************
  1551
  1552     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1553* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1554* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1555* AND RECORD 05 IS TYPES 81-99
  1556         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1557             20  CF-BUSINESS-TITLE          PIC  X(19).
  1558             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1559                                            PIC S9V9(4) COMP-3.
  1560             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1561             20  FILLER                     PIC  X.
  1562         16  FILLER                         PIC  X(248).
  1563
  1564
  1565****************************************************************
  1566*             TERMINAL MASTER RECORD                           *
  1567****************************************************************
  1568
  1569     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1570
  1571         16  CF-COMPANY-TERMINALS.
  1572             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1573                                  PIC X(4).
  1574         16  FILLER               PIC X(248).
  1575
  1576
  1577****************************************************************
  1578*             LIFE EDIT MASTER RECORD                          *
  1579****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  29
* EL202.cbl
  1580
  1581     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1582         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1583             20  CF-LIFE-CODE-IN            PIC XX.
  1584             20  CF-LIFE-CODE-OUT           PIC XX.
  1585         16  FILLER                         PIC X(248).
  1586
  1587
  1588****************************************************************
  1589*             AH EDIT MASTER RECORD                            *
  1590****************************************************************
  1591
  1592     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1593         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1594             20  CF-AH-CODE-IN              PIC XXX.
  1595             20  CF-AH-CODE-OUT             PIC XX.
  1596         16  FILLER                         PIC X(248).
  1597
  1598
  1599****************************************************************
  1600*             CREDIBILITY TABLES                               *
  1601****************************************************************
  1602
  1603     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1604         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1605                             INDEXED BY CF-CRDB-NDX.
  1606             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1607             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1608             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1609         16  FILLER                         PIC  X(332).
  1610
  1611
  1612****************************************************************
  1613*             REPORT CUSTOMIZATION RECORD                      *
  1614****************************************************************
  1615
  1616     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1617         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1618             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1619             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1620             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1621**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1622****       A T-TRANSFER.                                   ****
  1623             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1624
  1625         16  FILLER                         PIC XX.
  1626
  1627         16  CF-CARRIER-CNTL-OPT.
  1628             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1629                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1630                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1631             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1632                                            PIC X.
  1633         16  CF-GROUP-CNTL-OPT.
  1634             20  CF-GROUP-OPT-SEQ           PIC 9.
  1635                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1636                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1637             20  CF-GROUP-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  30
* EL202.cbl
  1638                                            PIC X(6).
  1639         16  CF-STATE-CNTL-OPT.
  1640             20  CF-STATE-OPT-SEQ           PIC 9.
  1641                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1642                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1643             20  CF-STATE-SELECT OCCURS 3 TIMES
  1644                                            PIC XX.
  1645         16  CF-ACCOUNT-CNTL-OPT.
  1646             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1647                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1648                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1649             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1650                                            PIC X(10).
  1651         16  CF-BUS-TYP-CNTL-OPT.
  1652             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1653                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1654                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1655             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1656                                            PIC XX.
  1657         16  CF-LF-TYP-CNTL-OPT.
  1658             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1659                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1660                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1661             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1662                                            PIC XX.
  1663         16  CF-AH-TYP-CNTL-OPT.
  1664             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1665                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1666                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1667             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1668                                            PIC XX.
  1669         16  CF-REPTCD1-CNTL-OPT.
  1670             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1671                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1672                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1673             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1674                                            PIC X(10).
  1675         16  CF-REPTCD2-CNTL-OPT.
  1676             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1677                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1678                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1679             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1680                                            PIC X(10).
  1681         16  CF-USER1-CNTL-OPT.
  1682             20  CF-USER1-OPT-SEQ           PIC 9.
  1683                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1684                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1685             20  CF-USER1-SELECT OCCURS 3 TIMES
  1686                                            PIC X(10).
  1687         16  CF-USER2-CNTL-OPT.
  1688             20  CF-USER2-OPT-SEQ           PIC 9.
  1689                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1690                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1691             20  CF-USER2-SELECT OCCURS 3 TIMES
  1692                                            PIC X(10).
  1693         16  CF-USER3-CNTL-OPT.
  1694             20  CF-USER3-OPT-SEQ           PIC 9.
  1695                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  31
* EL202.cbl
  1696                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1697             20  CF-USER3-SELECT OCCURS 3 TIMES
  1698                                            PIC X(10).
  1699         16  CF-USER4-CNTL-OPT.
  1700             20  CF-USER4-OPT-SEQ           PIC 9.
  1701                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1702                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1703             20  CF-USER4-SELECT OCCURS 3 TIMES
  1704                                            PIC X(10).
  1705         16  CF-USER5-CNTL-OPT.
  1706             20  CF-USER5-OPT-SEQ           PIC 9.
  1707                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1708                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1709             20  CF-USER5-SELECT OCCURS 3 TIMES
  1710                                            PIC X(10).
  1711         16  CF-REINS-CNTL-OPT.
  1712             20  CF-REINS-OPT-SEQ           PIC 9.
  1713                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1714                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1715             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1716                 24  CF-REINS-PRIME         PIC XXX.
  1717                 24  CF-REINS-SUB           PIC XXX.
  1718
  1719         16  CF-AGENT-CNTL-OPT.
  1720             20  CF-AGENT-OPT-SEQ           PIC 9.
  1721                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1722                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1723             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1724                                            PIC X(10).
  1725
  1726         16  FILLER                         PIC X(43).
  1727
  1728         16  CF-LOSS-RATIO-SELECT.
  1729             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1730             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1731         16  CF-ENTRY-DATE-SELECT.
  1732             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1733             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1734         16  CF-EFFECTIVE-DATE-SELECT.
  1735             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1736             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1737
  1738         16  CF-EXCEPTION-LIST-IND          PIC X.
  1739             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1740
  1741         16  FILLER                         PIC X(318).
  1742
  1743****************************************************************
  1744*                  EXCEPTION REPORTING RECORD                  *
  1745****************************************************************
  1746
  1747     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1748         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1749             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1750
  1751         16  CF-COMBINED-LIFE-AH-OPT.
  1752             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1753             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  32
* EL202.cbl
  1754             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1755             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1756
  1757         16  CF-LIFE-OPT.
  1758             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1759             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1760             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1761             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1762             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1763             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1764             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1765             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1766             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1767             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1768
  1769         16  CF-AH-OPT.
  1770             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1771             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1772             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1773             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1774             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1775             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1776             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1777             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1778             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1779             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1780
  1781         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1782             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1783             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1784             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1785
  1786         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1787
  1788         16  FILLER                         PIC X(673).
  1789
  1790
  1791****************************************************************
  1792*             MORTGAGE SYSTEM PLAN RECORD                      *
  1793****************************************************************
  1794
  1795     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1796         16  CF-PLAN-TYPE                   PIC X.
  1797             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1798             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1799             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1800         16  CF-PLAN-ABBREV                 PIC XXX.
  1801         16  CF-PLAN-DESCRIPT               PIC X(10).
  1802         16  CF-PLAN-NOTES                  PIC X(20).
  1803         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1804         16  CF-PLAN-UNDERWRITING.
  1805             20  CF-PLAN-TERM-DATA.
  1806                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1807                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1808             20  CF-PLAN-AGE-DATA.
  1809                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1810                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1811                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  33
* EL202.cbl
  1812             20  CF-PLAN-BENEFIT-DATA.
  1813                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1814                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1815                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1816                                            PIC S9(7)V99  COMP-3.
  1817         16  CF-PLAN-POLICY-FORMS.
  1818             20  CF-POLICY-FORM             PIC X(12).
  1819             20  CF-MASTER-APPLICATION      PIC X(12).
  1820             20  CF-MASTER-POLICY           PIC X(12).
  1821         16  CF-PLAN-RATING.
  1822             20  CF-RATE-CODE               PIC X(5).
  1823             20  CF-SEX-RATING              PIC X.
  1824                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1825                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1826             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1827             20  CF-SUB-STD-TYPE            PIC X.
  1828                 88  CF-PCT-OF-PREM            VALUE '1'.
  1829                 88  CF-PCT-OF-BENE            VALUE '2'.
  1830         16  CF-PLAN-PREM-TOLERANCES.
  1831             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1832             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1833         16  CF-PLAN-PYMT-TOLERANCES.
  1834             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1835             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1836         16  CF-PLAN-MISC-DATA.
  1837             20  FILLER                     PIC X.
  1838             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1839             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1840         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1841         16  CF-PLAN-IND-GRP                PIC X.
  1842             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1843                                                     '1'.
  1844             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1845                                                     '2'.
  1846         16  CF-MIB-SEARCH-SW               PIC X.
  1847             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1848             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1849             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1850             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1851         16  CF-ALPHA-SEARCH-SW             PIC X.
  1852             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1853             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1854             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1855             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1856             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1857             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1858             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1859             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1860             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1861             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1862                                                     'A' 'B' 'C'
  1863                                                     'X' 'Y' 'Z'.
  1864         16  CF-EFF-DT-RULE-SW              PIC X.
  1865             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1866             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1867             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1868             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1869             88  CF-EFF-DT-ANN                 VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  34
* EL202.cbl
  1870         16  FILLER                         PIC X(4).
  1871         16  CF-HEALTH-QUESTIONS            PIC X.
  1872             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1873         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1874         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1875         16  CF-PLAN-SNGL-JNT               PIC X.
  1876             88  CF-COMBINED-PLAN              VALUE 'C'.
  1877             88  CF-JNT-PLAN                   VALUE 'J'.
  1878             88  CF-SNGL-PLAN                  VALUE 'S'.
  1879         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1880         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1881         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1882         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1883         16  CF-RERATE-CNTL                 PIC  X.
  1884             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1885             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1886             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1887             88  CF-AUTO-RECALC                 VALUE '4'.
  1888         16  CF-BENEFIT-TYPE                PIC  X.
  1889             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1890             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1891         16  CF-POLICY-FEE                  PIC S999V99
  1892                                                    COMP-3.
  1893         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1894         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1895         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1896         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1897         16  FILLER                         PIC  X(32).
  1898         16  CF-TERMINATION-FORM            PIC  X(04).
  1899         16  FILLER                         PIC  X(08).
  1900         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1901                                                       COMP-3.
  1902         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1903         16  CF-ISSUE-LETTER                PIC  X(4).
  1904         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1905         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1906             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1907             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1908         16  CF-MP-REFUND-CALC              PIC X.
  1909             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1910             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1911             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1912             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1913             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1914             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1915             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1916             88  CF-MP-REFD-MEAN                VALUE '8'.
  1917         16  CF-ALT-RATE-CODE               PIC  X(5).
  1918
  1919
  1920         16  FILLER                         PIC X(498).
  1921****************************************************************
  1922*             MORTGAGE COMPANY MASTER RECORD                   *
  1923****************************************************************
  1924
  1925     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1926         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1927         16  CF-MORTG-ACCESS-CONTROL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  35
* EL202.cbl
  1928             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  1929             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1930             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1931             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1932             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1933
  1934         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1935         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1936         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1937         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1938         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1939
  1940         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1941             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1942         16  CF-MP-RECON-USE-IND            PIC X(1).
  1943             88  CF-MP-USE-RECON             VALUE 'Y'.
  1944         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1945             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1946         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1947             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1948             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1949         16  FILLER                         PIC X(1).
  1950         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1951             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1952         16  CF-MORTG-MIB-VERSION           PIC X.
  1953             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1954             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1955             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1956         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1957             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1958                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1959             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1960                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1961             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1962                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1963             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1964                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1965             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1966                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1967             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1968                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1969         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1970         16  FILLER                         PIC X(7).
  1971         16  CF-MORTG-DESTINATION-SYMBOL.
  1972             20  CF-MORTG-MIB-COMM          PIC X(5).
  1973             20  CF-MORTG-MIB-TERM          PIC X(5).
  1974         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1975             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1976         16  FILLER                         PIC X(03).
  1977         16  CF-MP-CHECK-NO-CONTROL.
  1978             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1979                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1980                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1981                                                ' ' LOW-VALUES.
  1982                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1983                                               VALUE '3'.
  1984         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1985         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  36
* EL202.cbl
  1986         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  1987             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1988                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1989             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1990                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1991             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1992                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1993             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1994                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1995             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1996                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1997             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1998                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1999         16  CF-MORTG-BILLING-AREA.
  2000             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2001                                            PIC X.
  2002         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2003         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2004         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2005         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2006             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2007             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2008         16  FILLER                         PIC X.
  2009         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2010             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2011             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2012         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2013         16  FILLER                         PIC X(8).
  2014         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2015         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2016         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2017         16  CF-ACH-COMPANY-ID.
  2018             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2019                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2020                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2021                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2022             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2023         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2024             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2025         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2026             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2027             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2028         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2029         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2030         16  FILLER                         PIC X(536).
  2031
  2032****************************************************************
  2033*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2034****************************************************************
  2035
  2036     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2037         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2038             20  CF-FEMALE-HEIGHT.
  2039                 24  CF-FEMALE-FT           PIC 99.
  2040                 24  CF-FEMALE-IN           PIC 99.
  2041             20  CF-FEMALE-MIN-WT           PIC 999.
  2042             20  CF-FEMALE-MAX-WT           PIC 999.
  2043         16  FILLER                         PIC X(428).
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  37
* EL202.cbl
  2044
  2045     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2046         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2047             20  CF-MALE-HEIGHT.
  2048                 24  CF-MALE-FT             PIC 99.
  2049                 24  CF-MALE-IN             PIC 99.
  2050             20  CF-MALE-MIN-WT             PIC 999.
  2051             20  CF-MALE-MAX-WT             PIC 999.
  2052         16  FILLER                         PIC X(428).
  2053******************************************************************
  2054*             AUTOMATIC ACTIVITY RECORD                          *
  2055******************************************************************
  2056     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2057         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2058             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2059             20  CF-SYS-LETTER-ID           PIC X(04).
  2060             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2061             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2062             20  CF-SYS-RESET-SW            PIC X(01).
  2063             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2064             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2065
  2066         16  FILLER                         PIC X(50).
  2067
  2068         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2069             20  CF-USER-ACTIVE-SW          PIC X(01).
  2070             20  CF-USER-LETTER-ID          PIC X(04).
  2071             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2072             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2073             20  CF-USER-RESET-SW           PIC X(01).
  2074             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2075             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2076             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2077
  2078         16  FILLER                         PIC X(246).
  2079*                                copy ERCPYAJ.
  2080******************************************************************
  2081*                                                                *
  2082*                            ERCPYAJ                             *
  2083*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2084*                            VMOD=2.015                          *
  2085*                                                                *
  2086*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2087*                                                                *
  2088*                                                                *
  2089*   FILE TYPE = VSAM,KSDS                                        *
  2090*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2091*                                                                *
  2092*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2093*       ALTERNATE PATHS = NONE                                   *
  2094*                                                                *
  2095*   LOG = YES                                                    *
  2096*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2097******************************************************************
  2098******************************************************************
  2099*                   C H A N G E   L O G
  2100*
  2101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  38
* EL202.cbl
  2102*-----------------------------------------------------------------
  2103*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2104* EFFECTIVE    NUMBER
  2105*-----------------------------------------------------------------
  2106* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2107* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2108******************************************************************
  2109
  2110 01  PENDING-PAY-ADJ.
  2111     12  PY-RECORD-ID                     PIC XX.
  2112         88  VALID-PY-ID                        VALUE 'PY'.
  2113
  2114     12  PY-CONTROL-PRIMARY.
  2115         16  PY-COMPANY-CD                PIC X.
  2116         16  PY-CARRIER                   PIC X.
  2117         16  PY-GROUPING                  PIC X(6).
  2118         16  PY-FIN-RESP                  PIC X(10).
  2119         16  PY-ACCOUNT                   PIC X(10).
  2120         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2121                                          PIC X(10).
  2122         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2123         16  PY-RECORD-TYPE               PIC X.
  2124             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2125             88  PY-DEPOSIT                   VALUE 'D'.
  2126             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2127             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2128             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2129             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2130             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2131             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2132             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2133             88  PY-FICA-ENTRY                VALUE 'F'.
  2134             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2135             88  PY-POLICY-FEE                VALUE 'W'.
  2136             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2137
  2138     12  PY-PYMT-TYPE                     PIC X.
  2139             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2140             88  PY-REINS-PYMT                VALUE 'R'.
  2141             88  PY-EXP-PYMT                  VALUE 'E'.
  2142
  2143     12  PY-BIL-INV                       PIC X(6).
  2144     12  PY-REF-NO                        PIC X(12).
  2145
  2146     12  PY-LAST-MAINT-DT                 PIC XX.
  2147     12  PY-LAST-MAINT-BY                 PIC X(4).
  2148     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2149
  2150     12  PY-PYADJ-RECORD.
  2151         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2152         16  PY-ENTRY-COMMENT             PIC X(30).
  2153         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2154             20  PY-GL-ACCOUNT            PIC X(10).
  2155             20  PY-GL-STATE              PIC X(02).
  2156             20  PY-GL-CANC-SW            PIC X(01).
  2157                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2158                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2159             20  PY-GL-COMMENT            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  39
* EL202.cbl
  2160             20  FILLER      REDEFINES PY-GL-COMMENT.
  2161                 24  PY-GL-CHECK-NO       PIC 9(06).
  2162                 24  FILLER               PIC X(04).
  2163             20  FILLER                   PIC X(07).
  2164         16  PY-SAVE-ACCOUNT              PIC X(10).
  2165         16  PY-SAVE-TYPE                 PIC X(01).
  2166
  2167         16  PY-LETTERS.
  2168             20  PY-LETTER OCCURS 3 TIMES
  2169                           INDEXED BY PY-LET-NDX
  2170                                          PIC X(04).
  2171
  2172         16  PY-ERCOMP-TYPE               PIC X.
  2173             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2174             88  PY-GA-TYPE                   VALUE 'G'.
  2175             88  PY-BANK-TYPE                 VALUE 'B'.
  2176         16  FILLER                       PIC X(05).
  2177
  2178     12  PY-RECORD-STATUS.
  2179         16  PY-CREDIT-SELECT-DT          PIC XX.
  2180         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2181         16  PY-BILLED-DATE               PIC XX.
  2182         16  PY-REPORTED-DT               PIC XX.
  2183         16  PY-PMT-APPLIED               PIC X.
  2184             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2185             88  PY-GA-PMT                    VALUE 'G'.
  2186             88  PY-OVWRITE-PMT               VALUE 'O'.
  2187             88  PY-NON-AR-PMT                VALUE 'N'.
  2188         16  FILLER                       PIC X(5).
  2189         16  PY-INPUT-DT                  PIC XX.
  2190         16  PY-CHECK-NUMBER              PIC X(6).
  2191         16  PY-VOID-SW                   PIC X.
  2192             88  PY-CHECK-VOIDED              VALUE 'V'.
  2193         16  PY-CHECK-ORIGIN-SW           PIC X.
  2194             88  PY-BILLING-CHECK             VALUE 'B'.
  2195             88  PY-REFUND-CHECK              VALUE 'R'.
  2196             88  PY-GA-CHECK                  VALUE 'G'.
  2197             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2198             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2199         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2200         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2201         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2202         16  PY-BILL-FLAG                 PIC X.
  2203             88  PY-BILLED                    VALUE 'B'.
  2204         16  PY-AR-FLAG                   PIC X.
  2205             88  PY-AR-CYCLE                  VALUE 'C'.
  2206             88  PY-AR-MONTH-END              VALUE 'M'.
  2207         16  PY-AR-DATE                   PIC XX.
  2208
  2209     12  PY-GL-CODES.
  2210         16  PY-GL-DB                     PIC X(14).
  2211         16  PY-GL-CR                     PIC X(14).
  2212         16  PY-GL-FLAG                   PIC X.
  2213         16  PY-GL-DATE                   PIC XX.
  2214
  2215     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2216     12  FILLER                           PIC X(3).
  2217******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  40
* EL202.cbl
  2218*                                copy ERCPNDB.
  2219******************************************************************
  2220*                                                                *
  2221*                                                                *
  2222*                            ERCPNDB.                            *
  2223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2224*                            VMOD=2.025                          *
  2225*                                                                *
  2226*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2227*                                                                *
  2228******************************************************************
  2229*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2230*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2231******************************************************************
  2232*                                                                *
  2233*                                                                *
  2234*   FILE TYPE = VSAM,KSDS                                        *
  2235*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2236*                                                                *
  2237*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2238*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2239*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2240*                                                 RKP=13,LEN=36  *
  2241*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2242*                                      AND CHG-SEQ.)             *
  2243*                                                RKP=49,LEN=11   *
  2244*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2245*                                      AND CHG-SEQ.)             *
  2246*                                                RKP=60,LEN=15   *
  2247*                                                                *
  2248*   LOG = NO                                                     *
  2249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2250******************************************************************
  2251******************************************************************
  2252*                   C H A N G E   L O G
  2253*
  2254* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2255*-----------------------------------------------------------------
  2256*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2257* EFFECTIVE    NUMBER
  2258*-----------------------------------------------------------------
  2259* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2260* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2261* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2262* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2263* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2264* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2265* 032306                   PEMA  ADD BOW LOAN NUMBER
  2266* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2267* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2268* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2269* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2270* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2271* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2272* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2273* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2274* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2275* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  41
* EL202.cbl
  2276******************************************************************
  2277
  2278 01  PENDING-BUSINESS.
  2279     12  PB-RECORD-ID                     PIC XX.
  2280         88  VALID-PB-ID                        VALUE 'PB'.
  2281
  2282     12  PB-CONTROL-PRIMARY.
  2283         16  PB-COMPANY-CD                PIC X.
  2284         16  PB-ENTRY-BATCH               PIC X(6).
  2285         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2286         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2287
  2288     12  PB-CONTROL-BY-ACCOUNT.
  2289         16  PB-COMPANY-CD-A1             PIC X.
  2290         16  PB-CARRIER                   PIC X.
  2291         16  PB-GROUPING.
  2292             20  PB-GROUPING-PREFIX       PIC XXX.
  2293             20  PB-GROUPING-PRIME        PIC XXX.
  2294         16  PB-STATE                     PIC XX.
  2295         16  PB-ACCOUNT.
  2296             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2297             20  PB-ACCOUNT-PRIME         PIC X(6).
  2298         16  PB-CERT-EFF-DT               PIC XX.
  2299         16  PB-CERT-NO.
  2300             20  PB-CERT-PRIME            PIC X(10).
  2301             20  PB-CERT-SFX              PIC X.
  2302         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2303
  2304         16  PB-RECORD-TYPE               PIC X.
  2305             88  PB-MAILING-DATA                VALUE '0'.
  2306             88  PB-ISSUE                       VALUE '1'.
  2307             88  PB-CANCELLATION                VALUE '2'.
  2308             88  PB-BATCH-TRAILER               VALUE '9'.
  2309
  2310     12  PB-CONTROL-BY-ORIG-BATCH.
  2311         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2312         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2313         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2314         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2315
  2316     12  PB-CONTROL-BY-CSR.
  2317         16  PB-CSR-COMPANY-CD            PIC X.
  2318         16  PB-CSR-ID                    PIC X(4).
  2319         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2320         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2321         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2322******************************************************************
  2323*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2324******************************************************************
  2325
  2326     12  PB-LAST-MAINT-DT                 PIC XX.
  2327     12  PB-LAST-MAINT-BY                 PIC X(4).
  2328     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2329
  2330     12  PB-RECORD-BODY                   PIC X(375).
  2331
  2332     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2333         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  42
* EL202.cbl
  2334             88  CLASIC-CREATED-CERT         VALUE '1'.
  2335         16  PB-I-NAME.
  2336             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2337             20  PB-I-INSURED-FIRST-NAME.
  2338                 24  PB-I-INSURED-1ST-INIT PIC X.
  2339                 24  FILLER                PIC X(9).
  2340             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2341         16  PB-I-AGE                     PIC S99   COMP-3.
  2342         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2343         16  PB-I-BIRTHDAY                PIC XX.
  2344         16  PB-I-INSURED-SEX             PIC X.
  2345             88  PB-SEX-MALE     VALUE 'M'.
  2346             88  PB-SEX-FEMALE   VALUE 'F'.
  2347
  2348         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2349         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2350         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2351         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2352         16  PB-I-SKIP-CODE               PIC X.
  2353             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2354             88  PB-SKIP-JULY              VALUE '1'.
  2355             88  PB-SKIP-AUGUST            VALUE '2'.
  2356             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2357             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2358             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2359             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2360             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2361             88  PB-SKIP-JUNE              VALUE '8'.
  2362             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2363             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2364             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2365         16  PB-I-TERM-TYPE               PIC X.
  2366             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2367             88  PB-PAID-WEEKLY            VALUE 'W'.
  2368             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2369             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2370             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2371         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2372         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2373         16  PB-I-DATA-ENTRY-SW           PIC X.
  2374             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2375             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2376             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2377             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2378         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2379         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2380*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2381         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2382         16  FILLER                       PIC X.
  2383
  2384         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2385             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2386             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2387                                                   '90' THRU '99'.
  2388         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2389                                          PIC XX.
  2390         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2391         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  43
* EL202.cbl
  2392                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2393         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2394         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2395                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2396         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2397         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2398         16  PB-I-CLP-AMOUNT REDEFINES
  2399                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2400         16  PB-I-LF-CALC-FLAG            PIC X.
  2401             88 PB-COMP-LF-PREM               VALUE '?'.
  2402         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2403         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2404         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2405         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2406         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2407         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2408         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2409         16  PB-I-LF-ABBR                 PIC XXX.
  2410         16  PB-I-LF-INPUT-CD             PIC XX.
  2411
  2412         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2413             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2414             88  PB-INVALID-AH               VALUE '  ' '00'
  2415                                                   '90' THRU '99'.
  2416         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2417         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2418         16  PB-I-AH-CALC-FLAG            PIC X.
  2419             88 PB-COMP-AH-PREM                  VALUE '?'.
  2420         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2421         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2422         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  2423         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2424         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2425         16  PB-I-AH-ABBR                 PIC XXX.
  2426         16  PB-I-AH-INPUT-CD             PIC XXX.
  2427
  2428         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2429         16  PB-I-REIN-TABLE              PIC XXX.
  2430         16  PB-I-BUSINESS-TYPE           PIC 99.
  2431         16  PB-I-INDV-GRP-CD             PIC X.
  2432         16  PB-I-MORT-CODE.
  2433             20  PB-I-TABLE               PIC X.
  2434             20  PB-I-INTEREST            PIC XX.
  2435             20  PB-I-MORT-TYP            PIC X.
  2436         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2437         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2438         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2439         16  PB-I-INDV-GRP-OVRD           PIC X.
  2440         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2441         16  PB-I-SIG-SW                  PIC X.
  2442             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2443         16  PB-I-RATE-CLASS              PIC XX.
  2444         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2445         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2446         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2447         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2448         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2449         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  44
* EL202.cbl
  2450         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2451         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2452         16  PB-I-OB-FLAG                 PIC X.
  2453             88  PB-I-OB                      VALUE 'B'.
  2454             88  PB-I-SUMMARY                 VALUE 'Z'.
  2455         16  PB-I-ENTRY-STATUS            PIC X.
  2456             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2457                                              'M' '5' '9' '2'.
  2458             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2459             88  PB-I-POLICY-PENDING          VALUE '2'.
  2460             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2461             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2462             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2463             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2464             88  PB-I-REIN-ONLY               VALUE '9'.
  2465             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2466             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2467             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2468             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2469         16  PB-I-INT-CODE                PIC X.
  2470             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2471             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2472         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2473         16  PB-I-SOC-SEC-NO              PIC X(11).
  2474         16  PB-I-MEMBER-NO               PIC X(12).
  2475         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2476*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2477         16  PB-I-OLD-LOF                 PIC XXX.
  2478         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2479         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2480         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2481         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2482         16  PB-I-LIFE-INDICATOR          PIC X.
  2483             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2484         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2485         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2486                                          PIC S9(5)V99    COMP-3.
  2487         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2488             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2489             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2490         16  PB-I-1ST-PMT-DT              PIC XX.
  2491         16  PB-I-JOINT-INSURED.
  2492             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2493             20 PB-I-JOINT-FIRST-NAME.
  2494                24  PB-I-JOINT-FIRST-INIT PIC X.
  2495                24  FILLER                PIC X(9).
  2496             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2497*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2498         16  PB-I-BENEFICIARY-NAME.
  2499             20  PB-I-BANK-NUMBER         PIC X(10).
  2500             20  FILLER                   PIC X(15).
  2501         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2502         16  PB-I-REFERENCE               PIC X(12).
  2503         16  FILLER REDEFINES PB-I-REFERENCE.
  2504             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2505             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2506             20  PB-I-CLP-STATE           PIC XX.
  2507         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  45
* EL202.cbl
  2508             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2509             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2510             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2511         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2512         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2513         16  PB-I-RESIDENT-STATE          PIC XX.
  2514         16  PB-I-RATE-CODE               PIC X(4).
  2515         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2516         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2517         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2518         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2519         16  PB-I-BANK-NOCHRGB            PIC 99.
  2520         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2521         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2522
  2523     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2524         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2525             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2526         16  PB-C-CANCEL-ORIGIN           PIC X.
  2527             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2528         16  PB-C-LF-CANCEL-DT            PIC XX.
  2529         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2530         16  PB-C-LF-CALC-REQ             PIC X.
  2531             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2532         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2533         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2534         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2535             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2536         16  PB-C-AH-CANCEL-DT            PIC XX.
  2537         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2538         16  PB-C-AH-CALC-REQ             PIC X.
  2539             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2540         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2541         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2542         16  PB-C-LAST-NAME               PIC X(15).
  2543         16  PB-C-REFUND-SW               PIC X.
  2544             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2545             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2546         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2547         16  PB-C-PAYEE-CODE              PIC X(6).
  2548         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2549         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2550         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2551         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2552         16  PB-C-REFERENCE               PIC X(12).
  2553         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2554         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2555         16  PB-C-POST-CARD-IND           PIC X.
  2556         16  PB-C-CANCEL-REASON           PIC X.
  2557         16  PB-C-REF-INTERFACE-SW        PIC X.
  2558         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2559         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2560         16  FILLER                       PIC X(01).
  2561*        16  FILLER                       PIC X(18).
  2562         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2563*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2564         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2565         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  46
* EL202.cbl
  2566             20  PB-CI-INSURED-NAME.
  2567                 24  PB-CI-LAST-NAME      PIC X(15).
  2568                 24  PB-CI-INITIALS       PIC XX.
  2569             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2570             20  PB-CI-INSURED-SEX        PIC X.
  2571             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2572             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2573             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2574             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2575             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2576             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2577             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2578             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2579             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2580             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2581             20  PB-CI-RATE-CLASS         PIC XX.
  2582             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2583             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2584             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2585             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2586             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2587             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2588             20  PB-CI-LF-ABBR            PIC X(3).
  2589             20  PB-CI-AH-ABBR            PIC X(3).
  2590             20  PB-CI-OB-FLAG            PIC X.
  2591                 88  PB-CI-OB                VALUE 'B'.
  2592             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2593                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2594                                           'M' '4' '5' '9' '2'.
  2595                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2596                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2597                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2598                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2599                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2600                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2601                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2602                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2603                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2604                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2605                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2606                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2607                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2608             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2609                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2610                                           'M' '4' '5' '9' '2'.
  2611                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2612                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2613                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2614                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2615                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2616                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2617                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2618                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2619                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2620                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2621                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2622                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2623                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  47
* EL202.cbl
  2624             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2625             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2626             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2627             20  PB-CI-MEMBER-NO          PIC X(12).
  2628             20  PB-CI-INT-CODE           PIC X.
  2629                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2630                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2631             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2632             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2633             20  PB-CI-COMP-EXCP-SW       PIC X.
  2634                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2635                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2636             20  PB-CI-ENTRY-STATUS       PIC X.
  2637             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2638             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2639             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2640             20  PB-CI-DEATH-DT           PIC XX.
  2641             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2642             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2643             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2644             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2645             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2646             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2647             20  PB-CI-ENTRY-DT              PIC XX.
  2648             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2649             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2650             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2651             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2652             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2653             20  PB-CI-OLD-LOF               PIC XXX.
  2654*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2655             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2656             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2657             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2658             20  PB-CI-INDV-GRP-CD           PIC X.
  2659             20  PB-CI-BENEFICIARY-NAME.
  2660                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2661                 24  FILLER                  PIC X(15).
  2662             20  PB-CI-NOTE-SW               PIC X.
  2663             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2664             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2665             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2666             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2667             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2668             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2669             20  PB-CI-FIRST-NAME            PIC X(10).
  2670             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2671
  2672         16  FILLER                       PIC X(13).
  2673*032306  16  FILLER                       PIC X(27).
  2674*        16  FILLER                       PIC X(46).
  2675
  2676     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2677         16  FILLER                       PIC X(10).
  2678         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2679         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2680         16  PB-M-INSURED-MID-INIT        PIC X.
  2681         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  48
* EL202.cbl
  2682         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2683         16  PB-M-INSURED-SEX             PIC X.
  2684         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2685         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2686         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2687         16  PB-M-INSURED-CITY-STATE.
  2688             20  PB-M-INSURED-CITY        PIC X(28).
  2689             20  PB-M-INSURED-STATE       PIC XX.
  2690         16  PB-M-INSURED-ZIP-CODE.
  2691             20  PB-M-INSURED-ZIP-PRIME.
  2692                 24  PB-M-INSURED-ZIP-1   PIC X.
  2693                     88  PB-M-CANADIAN-POST-CODE
  2694                                             VALUE 'A' THRU 'Z'.
  2695                 24  FILLER               PIC X(4).
  2696             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2697         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2698                                        PB-M-INSURED-ZIP-CODE.
  2699             20  PM-M-INS-CAN-POST1       PIC XXX.
  2700             20  PM-M-INS-CAN-POST2       PIC XXX.
  2701             20  FILLER                   PIC XXX.
  2702         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2703         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2704         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2705         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2706         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2707         16  PB-M-CRED-BENE-CITYST.
  2708             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2709             20  PB-M-CRED-BENE-STATE     PIC XX.
  2710         16  FILLER                       PIC X(92).
  2711
  2712     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2713         16  FILLER                       PIC X(10).
  2714         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2715         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2716         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2717         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2718         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2719         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2720         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2721         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2722         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2723         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2724         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2725         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2726         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2727         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2728         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2729         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2730         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2731         16  PB-ACCOUNT-NAME              PIC X(30).
  2732         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2733         16  PB-REFERENCE                 PIC X(12).
  2734         16  PB-B-RECEIVED-DT             PIC XX.
  2735         16  FILLER                       PIC X(234).
  2736
  2737     12  PB-RECORD-STATUS.
  2738         16  PB-CREDIT-SELECT-DT          PIC XX.
  2739         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  49
* EL202.cbl
  2740         16  PB-BILLED-DT                 PIC XX.
  2741         16  PB-BILLING-STATUS            PIC X.
  2742             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2743             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2744             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2745         16  PB-RECORD-BILL               PIC X.
  2746             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2747             88  PB-RECORD-RETURNED           VALUE 'R'.
  2748             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2749             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2750             88  PB-OVERRIDE-AH               VALUE 'A'.
  2751             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2752         16  PB-BATCH-ENTRY               PIC X.
  2753             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2754             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2755             88  PB-REISSUED-CERT             VALUE 'E'.
  2756             88  PB-CASH-CERT                 VALUE 'C'.
  2757             88  PB-MONTHLY-CERT              VALUE 'M'.
  2758             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2759             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2760             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2761         16  PB-FORCE-CODE                PIC X.
  2762             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2763             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2764             88  PB-CANCEL-FORCE              VALUE '8'.
  2765             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2766             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2767             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2768             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2769             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2770             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2771             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2772         16  PB-FATAL-FLAG                PIC X.
  2773             88  PB-FATAL-ERRORS              VALUE 'X'.
  2774         16  PB-FORCE-ER-CD               PIC X.
  2775             88  PB-FORCE-ERRORS              VALUE 'F'.
  2776             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2777         16  PB-WARN-ER-CD                PIC X.
  2778             88  PB-WARNING-ERRORS            VALUE 'W'.
  2779         16  FILLER                       PIC X.
  2780         16  PB-OUT-BAL-CD                PIC X.
  2781             88  PB-OUT-OF-BAL                VALUE 'O'.
  2782         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2783         16  PB-AH-OVERRIDE-L1            PIC X.
  2784         16  PB-INPUT-DT                  PIC XX.
  2785         16  PB-INPUT-BY                  PIC X(4).
  2786         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2787         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2788         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2789         16  PB-LF-EARNING-METHOD         PIC X.
  2790         16  PB-AH-EARNING-METHOD         PIC X.
  2791         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2792         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2793         16  PB-REIN-CD                   PIC XXX.
  2794         16  PB-LF-REFUND-TYPE            PIC X.
  2795         16  PB-AH-REFUND-TYPE            PIC X.
  2796         16  PB-ACCT-EFF-DT               PIC XX.
  2797         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  50
* EL202.cbl
  2798         16  PB-COMPANY-ID                PIC X(3).
  2799         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2800         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2801         16  PB-SV-CARRIER                PIC X.
  2802         16  PB-SV-GROUPING               PIC X(6).
  2803         16  PB-SV-STATE                  PIC XX.
  2804         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2805         16  PB-GA-BILLING-INFO.
  2806             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2807                                          PIC XX.
  2808         16  PB-SV-REMIT-TO  REDEFINES
  2809             PB-GA-BILLING-INFO           PIC X(10).
  2810         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2811         16  PB-I-LOAN-OFFICER            PIC X(5).
  2812         16  PB-I-VIN                     PIC X(17).
  2813
  2814         16  FILLER                       PIC X(04).
  2815         16  IMNET-BYPASS-SW              PIC X.
  2816
  2817******************************************************************
  2818*                COMMON EDIT ERRORS                              *
  2819******************************************************************
  2820
  2821     12  PB-COMMON-ERRORS.
  2822         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2823                                           PIC S9(4)     COMP.
  2824
  2825******************************************************************
  2826*                                copy ERCPNDM.
  2827******************************************************************
  2828*                                                                *
  2829*                                                                *
  2830*                            ERCPNDM                             *
  2831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2832*                            VMOD=2.003                          *
  2833*                                                                *
  2834*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2835*                                                                *
  2836*   FILE TYPE = VSAM,KSDS                                        *
  2837*   RECORD SIZE = 374   RECFORM = FIX                            *
  2838*                                                                *
  2839*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2840*   ALTERNATE PATH    = NOT USED                                 *
  2841*                                                                *
  2842*   LOG = YES                                                    *
  2843*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2844******************************************************************
  2845*                   C H A N G E   L O G
  2846*
  2847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2848*-----------------------------------------------------------------
  2849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2850* EFFECTIVE    NUMBER
  2851*-----------------------------------------------------------------
  2852* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2853* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2854* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2855******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  51
* EL202.cbl
  2856
  2857 01  PENDING-MAILING-DATA.
  2858     12  PM-RECORD-ID                      PIC XX.
  2859         88  VALID-MA-ID                       VALUE 'PM'.
  2860
  2861     12  PM-CONTROL-PRIMARY.
  2862         16  PM-COMPANY-CD                 PIC X.
  2863         16  PM-ENTRY-BATCH                PIC X(6).
  2864         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2865         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2866
  2867     12  FILLER                            PIC X(14).
  2868
  2869     12  PM-ACCESS-CONTROL.
  2870         16  PM-SOURCE-SYSTEM              PIC XX.
  2871             88  PM-FROM-CREDIT                VALUE 'CR'.
  2872             88  PM-FROM-VSI                   VALUE 'VS'.
  2873             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2874             88  PM-FROM-OTHER                 VALUE 'OT'.
  2875         16  PM-RECORD-ADD-DT              PIC XX.
  2876         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2877         16  PM-LAST-MAINT-DT              PIC XX.
  2878         16  PM-LAST-MAINT-BY              PIC XXXX.
  2879         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2880
  2881     12  PM-PROFILE-INFO.
  2882         16  PM-QUALIFY-CODE-1             PIC XX.
  2883         16  PM-QUALIFY-CODE-2             PIC XX.
  2884         16  PM-QUALIFY-CODE-3             PIC XX.
  2885         16  PM-QUALIFY-CODE-4             PIC XX.
  2886         16  PM-QUALIFY-CODE-5             PIC XX.
  2887
  2888         16  PM-INSURED-LAST-NAME          PIC X(15).
  2889         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2890         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2891         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2892         16  PM-INSURED-BIRTH-DT           PIC XX.
  2893         16  PM-INSURED-SEX                PIC X.
  2894             88  PM-SEX-MALE                   VALUE 'M'.
  2895             88  PM-SEX-FEMALE                 VALUE 'F'.
  2896         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2897
  2898         16  PM-ADDRESS-CORRECTED          PIC X.
  2899         16  PM-JOINT-BIRTH-DT             PIC XX.
  2900*        16  FILLER                        PIC X(12).
  2901
  2902         16  PM-ADDRESS-LINE-1             PIC X(30).
  2903         16  PM-ADDRESS-LINE-2             PIC X(30).
  2904         16  PM-CITY-STATE.
  2905             20  PM-CITY                   PIC X(28).
  2906             20  PM-STATE                  PIC XX.
  2907         16  PM-ZIP.
  2908             20  PM-ZIP-CODE.
  2909                 24  PM-ZIP-1              PIC X.
  2910                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2911                 24  FILLER                PIC X(4).
  2912             20  PM-ZIP-PLUS4              PIC X(4).
  2913         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  52
* EL202.cbl
  2914             20  PM-CAN-POST1              PIC XXX.
  2915             20  PM-CAN-POST2              PIC XXX.
  2916             20  FILLER                    PIC XXX.
  2917
  2918         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2919
  2920         16  FILLER                        PIC X(03).
  2921
  2922     12  PM-CRED-BENE-INFO.
  2923         16  PM-CRED-BENE-NAME             PIC X(25).
  2924         16  PM-CRED-BENE-ADDR             PIC X(30).
  2925         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2926         16  PM-CRED-BENE-CTYST.
  2927             20  PM-CRED-BENE-CITY         PIC X(28).
  2928             20  PM-CRED-BENE-STATE        PIC XX.
  2929         16  PM-CRED-BENE-ZIP.
  2930             20  PM-CB-ZIP-CODE.
  2931                 24  PM-CB-ZIP-1           PIC X.
  2932                     88  PM-CB-CANADIAN-POST-CODE
  2933                                  VALUE 'A' THRU 'Z'.
  2934                 24  FILLER                PIC X(4).
  2935             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2936         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2937             20  PM-CB-CAN-POST1           PIC XXX.
  2938             20  PM-CB-CAN-POST2           PIC XXX.
  2939             20  FILLER                    PIC XXX.
  2940     12  PM-POST-CARD-MAIL-DATA.
  2941         16  PM-MAIL-DATA OCCURS 7.
  2942             20  PM-MAIL-TYPE              PIC X.
  2943                 88  PM-12MO-MAILING           VALUE '1'.
  2944                 88  PM-EXP-MAILING            VALUE '2'.
  2945             20  PM-MAIL-STATUS            PIC X.
  2946                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2947                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2948                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2949             20  PM-MAIL-DATE              PIC XX.
  2950     12  FILLER                            PIC XX.
  2951     12  FILLER                            PIC X(12).
  2952*    12  FILLER                            PIC X(30).
  2953
  2954******************************************************************
  2955 01  w-doctoken                  pic x(16).
  2956 01  BATCH-TO-PROCESS.
  2957     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
  2958     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
  2959     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
  2960     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
  2961 01 output-data.
  2962    05  filler                   pic x(6) value "TITLE=".
  2963    05  output-title             pic x(26) value 'Check Posting'.
  2964    05  filler                   pic x(8) value "&COMPID=".
  2965    05  out-comp-id              pic xxx.
  2966    05  filler                   pic x(5) value "&MSG=".
  2967    05  output-msg               pic x(50).
  2968****************************************************************
  2969*
  2970* Copyright (c) 2007 by Clerity Solutions, Inc.
  2971* All rights reserved.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  53
* EL202.cbl
  2972*
  2973****************************************************************
  2974 01  DFHEIV.
  2975   02  DFHEIV0               PIC X(35).
  2976   02  DFHEIV1               PIC X(08).
  2977   02  DFHEIV2               PIC X(08).
  2978   02  DFHEIV3               PIC X(08).
  2979   02  DFHEIV4               PIC X(06).
  2980   02  DFHEIV5               PIC X(04).
  2981   02  DFHEIV6               PIC X(04).
  2982   02  DFHEIV7               PIC X(02).
  2983   02  DFHEIV8               PIC X(02).
  2984   02  DFHEIV9               PIC X(01).
  2985   02  DFHEIV10              PIC S9(7) COMP-3.
  2986   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2987   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2988   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2989   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2990   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2991   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2992   02  DFHEIV17              PIC X(04).
  2993   02  DFHEIV18              PIC X(04).
  2994   02  DFHEIV19              PIC X(04).
  2995   02  DFHEIV20              USAGE IS POINTER.
  2996   02  DFHEIV21              USAGE IS POINTER.
  2997   02  DFHEIV22              USAGE IS POINTER.
  2998   02  DFHEIV23              USAGE IS POINTER.
  2999   02  DFHEIV24              USAGE IS POINTER.
  3000   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3001   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3002   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3003   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3004   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3005   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3006   02  FILLER                PIC X(02).
  3007   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3008   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3009   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3010   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3011   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3012 LINKAGE  SECTION.
  3013*****************************************************************
  3014*                                                               *
  3015* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3016* All rights reserved.                                          *
  3017*                                                               *
  3018*****************************************************************
  3019 01  dfheiblk.
  3020     02  eibtime          pic s9(7) comp-3.
  3021     02  eibdate          pic s9(7) comp-3.
  3022     02  eibtrnid         pic x(4).
  3023     02  eibtaskn         pic s9(7) comp-3.
  3024     02  eibtrmid         pic x(4).
  3025     02  dfheigdi         pic s9(4) comp.
  3026     02  eibcposn         pic s9(4) comp.
  3027     02  eibcalen         pic s9(4) comp.
  3028     02  eibaid           pic x(1).
  3029     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  54
* EL202.cbl
  3030     02  eibfn            pic x(2).
  3031     02  eibfiller2       pic x(2).
  3032     02  eibrcode         pic x(6).
  3033     02  eibfiller3       pic x(2).
  3034     02  eibds            pic x(8).
  3035     02  eibreqid         pic x(8).
  3036     02  eibrsrce         pic x(8).
  3037     02  eibsync          pic x(1).
  3038     02  eibfree          pic x(1).
  3039     02  eibrecv          pic x(1).
  3040     02  eibsend          pic x(1).
  3041     02  eibatt           pic x(1).
  3042     02  eibeoc           pic x(1).
  3043     02  eibfmh           pic x(1).
  3044     02  eibcompl         pic x(1).
  3045     02  eibsig           pic x(1).
  3046     02  eibconf          pic x(1).
  3047     02  eiberr           pic x(1).
  3048     02  eibrldbk         pic x(1).
  3049     02  eiberrcd         pic x(4).
  3050     02  eibsynrb         pic x(1).
  3051     02  eibnodat         pic x(1).
  3052     02  eibfiller5       pic x(2).
  3053     02  eibresp          pic 9(09) comp.
  3054     02  eibresp2         pic 9(09) comp.
  3055     02  dfheigdj         pic s9(4) comp.
  3056     02  dfheigdk         pic s9(4) comp.
  3057 01  DFHCOMMAREA                     PIC X(1024).
  3058 01  var  pic x(30).
  3059 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3060 0000-DFHEXIT SECTION.
  3061     MOVE '9#                    $   ' TO DFHEIV0.
  3062     MOVE 'EL202' TO DFHEIV1.
  3063     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3064***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3065***                                                            ***
  3066***                                                We don't    ***
  3067***  have any form fields to browse through, we are getting    ***
  3068***  the information we need through the variables that are    ***
  3069***  included in the URL. These variables are retrieved by     ***
  3070***  the           exec cics web extract                       ***
  3071***                   querystring  (data-value)                ***
  3072***                   querystrlen  (data-value)                ***
  3073***                end-exec                                    ***
  3074***  BTW, you must provide the length, it isn't passed to you. ***
  3075***  Allow for extra on the length or you will get a length    ***
  3076***  error instead of just truncation.                         ***
  3077***                                                            ***
  3078***  This program is expecting                                 ***
  3079*** http://logictest:5002/cics/cwba/EL202?comp=DCC&remit=00001 ***
  3080***http://slunikix:7001/cics/cwba/EL202?comp=DCC&remit=0000000001*
  3081***                                                            ***
  3082***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3083     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3084     string ws-fn-hours ws-fn-minutes ws-fn-seconds
  3085        delimited by size into ws-work-time-a
  3086     end-string
  3087     string ws-fn-mo     '/'
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  55
* EL202.cbl
  3088            ws-fn-da     '/'
  3089            ws-fn-ccyr
  3090        delimited by size into ws-status-date
  3091     end-string
  3092     move ws-fn-cymd             to dc-greg-date-cymd
  3093     move 'L'                    to dc-option-code
  3094     perform 9700-date-convert   thru 9700-exit
  3095     if no-conversion-error
  3096        move dc-bin-date-1       to ws-bin-current-dt
  3097     else
  3098        display ' error current dt invalid ' dc-error-code
  3099     end-if
  3100     set P to address of KIXSYS
  3101     CALL "getenv" using by value P returning var-ptr
  3102     if var-ptr = null then
  3103        display ' kixsys not set '
  3104     else
  3105        set address of var to var-ptr
  3106        move 0 to env-var-len
  3107        inspect var tallying env-var-len
  3108          for characters before X'00'
  3109        unstring var (1:env-var-len) delimited by '/'
  3110           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3111              WS-KIX-SYS
  3112        end-unstring
  3113     end-if
  3114
  3115* exec cics web extract
  3116*       querystring  (ws-qry-string)
  3117*       querystrlen  (ws-qrystr-len)
  3118*    end-exec
  3119*    MOVE 'X0  QL                .   #00003017' TO DFHEIV0
  3120     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  3121     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  3122     MOVE X'2020233030303033303137' TO DFHEIV0(25:11)
  3123     CALL 'kxdfhei1' USING DFHEIV0,
  3124           DFHEIV99,
  3125           DFHEIV99,
  3126           ws-qry-string,
  3127           ws-qrystr-len,
  3128           DFHEIV99,
  3129           DFHEIV99,
  3130           DFHEIV99,
  3131           DFHEIV99,
  3132           DFHEIV99,
  3133           DFHEIV99,
  3134           DFHEIV99,
  3135           DFHEIV99,
  3136           DFHEIV99
  3137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3138     display ' qry string ' ws-qry-string
  3139     display ' gry len    ' ws-qrystr-len
  3140     move ws-qry-string (6:3)    to ws-comp-id
  3141     move ws-qry-string (16:10)  to ws-var-alpha
  3142     move zeros                  to ws-remit-id-a
  3143     move +10                    to o1
  3144     perform varying i1 from +10 by -1 until i1 < +1
  3145        if ws-var-alpha (i1:1) numeric
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  56
* EL202.cbl
  3146           move ws-var-alpha (i1:1) to ws-remit-id-a (o1:1)
  3147           subtract +1 from o1
  3148        end-if
  3149     end-perform
  3150     move 'Successful Run   '    to output-msg
  3151     move ws-comp-id             to elcntl-key
  3152     move '1'                    to elcntl-rec-type
  3153     move +0                     to elcntl-seq
  3154
  3155* exec cics read
  3156*       dataset  ('ELCNTL')
  3157*       into     (control-file)
  3158*       ridfld   (elcntl-key)
  3159*       resp     (ws-response)
  3160*    end-exec
  3161     MOVE LENGTH OF
  3162      control-file
  3163       TO DFHEIV11
  3164     MOVE 'ELCNTL' TO DFHEIV1
  3165*    MOVE '&"IL       E          (  N#00003037' TO DFHEIV0
  3166     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3167     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3168     MOVE X'204E233030303033303337' TO DFHEIV0(25:11)
  3169     CALL 'kxdfhei1' USING DFHEIV0,
  3170           DFHEIV1,
  3171           control-file,
  3172           DFHEIV11,
  3173           elcntl-key,
  3174           DFHEIV99,
  3175           DFHEIV99,
  3176           DFHEIV99
  3177     MOVE EIBRESP  TO ws-response
  3178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3179     if resp-normal
  3180        display ' good cntl read '
  3181        move cf-cr-month-end-dt  to ws-bin-eom-dt
  3182        move cf-company-cd       to ws-comp-cd
  3183     else
  3184        move 'Company Rec not found ' to output-msg
  3185        display ' error elcntl read ' ws-response ' '
  3186           elcntl-key (1:8)
  3187        go to 0000-return
  3188     end-if
  3189     perform 0010-connect-db     thru 0010-exit
  3190     perform 0020-process-remit  thru 0020-exit
  3191     perform 0050-open-cursor    thru 0050-exit
  3192     perform 0060-process-input  thru 0060-exit
  3193     perform 0130-start-edit     thru 0130-exit
  3194     perform 0226-update-remit-table
  3195                                 thru 0226-exit
  3196     perform 0225-commit-work    thru 0225-exit
  3197     .
  3198 0000-return.
  3199     if connected-to-db
  3200        perform 0230-disconnect  thru 0230-exit
  3201     end-if
  3202     perform 0220-send-form      thru 0220-exit
  3203     if rollback-needed
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  57
* EL202.cbl
  3204        display ' executing roll back '
  3205        perform 0005-rollback    thru 0005-exit
  3206*       CALL 'kixvsam' USING ROLL-BACK
  3207*       exec cics syncpoint
  3208*          rollback
  3209*          resp (ws-response)
  3210*       end-exec
  3211*       display ' rollback resp ' ws-response
  3212     end-if
  3213
  3214* exec cics
  3215*       return
  3216*    end-exec
  3217*    MOVE '.(                    ''   #00003077' TO DFHEIV0
  3218     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3219     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3220     MOVE X'2020233030303033303737' TO DFHEIV0(25:11)
  3221     CALL 'kxdfhei1' USING DFHEIV0,
  3222           DFHEIV99,
  3223           DFHEIV99,
  3224           DFHEIV99,
  3225           DFHEIV99,
  3226           DFHEIV99,
  3227           DFHEIV99
  3228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3229
  3230* goback
  3231
  3232     MOVE '9%                    "   ' TO DFHEIV0
  3233     MOVE 'EL202' TO DFHEIV1
  3234     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3235     goback
  3236     .
  3237 0005-rollback.
  3238     if ws-rb-erpyaj-key not = spaces
  3239        move ws-rb-erpyaj-key    to py-control-primary
  3240
  3241* EXEC CICS DELETE
  3242*          DATASET  ('ERPYAJ')
  3243*          RIDFLD   (PY-CONTROL-PRIMARY)
  3244*          resp     (ws-response)
  3245*       END-EXEC
  3246     MOVE 'ERPYAJ' TO DFHEIV1
  3247*    MOVE '&(  R                 &  N#00003085' TO DFHEIV0
  3248     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3249     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3250     MOVE X'204E233030303033303835' TO DFHEIV0(25:11)
  3251     CALL 'kxdfhei1' USING DFHEIV0,
  3252           DFHEIV1,
  3253           PY-CONTROL-PRIMARY,
  3254           DFHEIV99,
  3255           DFHEIV99,
  3256           DFHEIV99
  3257     MOVE EIBRESP  TO ws-response
  3258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3259        if resp-normal
  3260           display ' good delete on erpyaj '
  3261        else
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  58
* EL202.cbl
  3262           display ' bad delete on erpyaj ' ws-response
  3263        end-if
  3264     end-if
  3265     if ws-batch-no not = zeros
  3266        move ws-comp-cd          to pb-company-cd
  3267        move ws-batch-no         to pb-entry-batch
  3268        move +0                  to pb-batch-seq-no
  3269                                    pb-batch-chg-seq-no
  3270
  3271* exec cics delete
  3272*          dataset   ('ERPNDB')
  3273*          ridfld    (pb-control-primary)
  3274*          keylength (7)
  3275*          generic
  3276*          resp     (ws-response)
  3277*       end-exec
  3278     MOVE 'ERPNDB' TO DFHEIV1
  3279     MOVE 7
  3280       TO DFHEIV11
  3281*    MOVE '&(  RKG               &  N#00003101' TO DFHEIV0
  3282     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3283     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3284     MOVE X'204E233030303033313031' TO DFHEIV0(25:11)
  3285     CALL 'kxdfhei1' USING DFHEIV0,
  3286           DFHEIV1,
  3287           pb-control-primary,
  3288           DFHEIV11,
  3289           DFHEIV99,
  3290           DFHEIV99
  3291     MOVE EIBRESP  TO ws-response
  3292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3293        if resp-normal
  3294           display ' good delete on erpndb '
  3295        else
  3296           display ' bad delete on erpndp ' ws-response
  3297        end-if
  3298     end-if
  3299     if ws-batch-no not = zeros
  3300        move ws-comp-cd          to pm-company-cd
  3301        move ws-batch-no         to pm-entry-batch
  3302        move +0                  to pm-batch-seq-no
  3303                                    pm-batch-chg-seq-no
  3304
  3305* exec cics delete
  3306*          dataset   ('ERPNDM')
  3307*          ridfld    (pm-control-primary)
  3308*          keylength (7)
  3309*          generic
  3310*          resp     (ws-response)
  3311*       end-exec
  3312     MOVE 'ERPNDM' TO DFHEIV1
  3313     MOVE 7
  3314       TO DFHEIV11
  3315*    MOVE '&(  RKG               &  N#00003119' TO DFHEIV0
  3316     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3317     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3318     MOVE X'204E233030303033313139' TO DFHEIV0(25:11)
  3319     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  59
* EL202.cbl
  3320           DFHEIV1,
  3321           pm-control-primary,
  3322           DFHEIV11,
  3323           DFHEIV99,
  3324           DFHEIV99
  3325     MOVE EIBRESP  TO ws-response
  3326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3327        if resp-normal
  3328           display ' good delete on erpndm '
  3329        else
  3330           display ' bad delete on erpndm ' ws-response
  3331        end-if
  3332     end-if
  3333     .
  3334 0005-exit.
  3335     exit.
  3336 0010-CONNECT-DB.
  3337***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3338***                                                            ***
  3339***  Even though it's on ntcso2, CUConnect is the test DB      ***
  3340***  The production DB is ezLink_Prod.  The table names are    ***
  3341***  the same.                                                 ***
  3342***                                                            ***
  3343***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3344     move 'NTCSO2_CUConnect'     to svr
  3345     move 'sa'                   to usr
  3346     move 'ntcso2'               to pass
  3347     if ws-kix-myenv = 'cid1p'
  3348        move 'NTCSO2_ezLink_Prod' to svr
  3349        move 'sa'                to usr
  3350        move 'ntcso2'            to pass
  3351     end-if
  3352     string
  3353         usr delimited space
  3354         "." delimited size
  3355         pass delimited space into usr-pass
  3356     end-string
  3357     display ' About to connect to ' svr ' ' usr-pass
  3358     EXEC SQL
  3359        CONNECT TO :svr USER :usr-pass
  3360     END-EXEC
  3361     if sqlcode not = 0
  3362        display "Error: cannot connect to " svr
  3363        display sqlcode
  3364        display sqlerrmc
  3365        move 'Failed to connect to DB'
  3366                                 to output-msg
  3367        go to 0000-return
  3368     else
  3369        set connected-to-db to true
  3370        display ' Successful Connect ' sqlcode
  3371     end-if
  3372     .
  3373 0010-EXIT.
  3374     EXIT.
  3375 0020-process-remit.
  3376     perform 0030-get-tbl-row    thru 0030-exit
  3377     perform 0040-build-erpyaj   thru 0040-exit
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  60
* EL202.cbl
  3378     .
  3379 0020-exit.
  3380     exit.
  3381 0030-get-tbl-row.
  3382***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3383***                                                            ***
  3384***  I'm only expecting one row so no cursor is declared       ***
  3385***                                                            ***
  3386***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3387     display ' about to get table row ' ws-remit-id
  3388     move ' '                    to ws-remit-sw
  3389*    exec sql
  3390*       SELECT
  3391*          RemitId,
  3392*          Carrier,
  3393*          Group,
  3394*          State,
  3395*          AccountNumber,
  3396*          Name,
  3397*          Addr1,
  3398*          Addr2,
  3399*          AddrCity,
  3400*          AddrState,
  3401*          AddrZIP,
  3402*          ResponsibleCarrier,
  3403*          ResponsibleNumber,
  3404*          LogicStatus,
  3405*          LogicStatusDate,
  3406*          Company,
  3407*          TotalPremium
  3408*       INTO
  3409*          :sql-py-RemitId,
  3410*          :sql-py-Carrier,
  3411*          :sql-py-Group,
  3412*          :sql-py-State,
  3413*          :sql-py-AccountNumber,
  3414*          :sql-py-Name,
  3415*          :sql-py-Addr1,
  3416*          :sql-py-Addr2,
  3417*          :sql-py-AddrCity,
  3418*          :sql-py-AddrState,
  3419*          :sql-py-AddrZIP,
  3420*          :sql-py-ResponsibleCarrier,
  3421*          :sql-py-ResponsibleNumber,
  3422*          :sql-py-LogicStatus,
  3423*          :sql-py-LogicStatusDate,
  3424*          :sql-py-company,
  3425*          :sql-py-tot-prem
  3426*       FROM
  3427*          CUC_Logic_Remittance
  3428*       WHERE
  3429*          RemitId = :ws-remit-id
  3430*    end-exec
  3431     exec sql
  3432        SELECT
  3433           CUC_Logic_Remittance.RemitId,
  3434           Carrier,
  3435           [Group],
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  61
* EL202.cbl
  3436           [State],
  3437           AccountNumber,
  3438           Name,
  3439           Addr1,
  3440           Addr2,
  3441           AddrCity,
  3442           AddrState,
  3443           AddrZIP,
  3444           ResponsibleCarrier,
  3445           ResponsibleNumber,
  3446           LogicStatus,
  3447           Company,
  3448           TotalPremium,
  3449           CUC_Remittance.IsACH
  3450        INTO
  3451           :sql-py-RemitId,
  3452           :sql-py-Carrier,
  3453           :sql-py-Group,
  3454           :sql-py-State,
  3455           :sql-py-AccountNumber,
  3456           :sql-py-Name,
  3457           :sql-py-Addr1,
  3458           :sql-py-Addr2,
  3459           :sql-py-AddrCity,
  3460           :sql-py-AddrState,
  3461           :sql-py-AddrZIP,
  3462           :sql-py-ResponsibleCarrier,
  3463           :sql-py-ResponsibleNumber,
  3464           :sql-py-LogicStatus,
  3465           :sql-py-company,
  3466           :sql-py-tot-prem,
  3467           :sql-is-ach
  3468        FROM
  3469           CUC_Logic_Remittance inner join CUC_Remittance on
  3470              CUC_Logic_Remittance.RemitId =
  3471                 CUC_Remittance.RemitId
  3472        WHERE
  3473           CUC_Logic_Remittance.RemitId = :ws-remit-id
  3474     end-exec
  3475     if sqlcode not = 0
  3476        set ws-remit-not-found   to true
  3477        move sqlcode             to ws-sql-code
  3478        move ws-sql-code         to ws-dis-sql-code
  3479        display ' dis sql code ' ws-dis-sql-code
  3480        display "Error: cannot read row "
  3481        display ' sql return code ' sqlcode
  3482        display ' sql err mess    ' sqlerrmc
  3483        move ' Remittance Not Found '
  3484                                 to output-msg
  3485        go to 0000-return
  3486     end-if
  3487     display ' good get on table ' sqlcode
  3488     if sql-py-LogicStatus = 2
  3489        move 'Remit previously processed '
  3490                                 to output-msg
  3491        go to 0000-return
  3492     end-if
  3493     .
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  62
* EL202.cbl
  3494 0030-exit.
  3495     exit.
  3496 0040-build-erpyaj.
  3497     compute work-seq-no = ws-work-time * 3
  3498     MOVE 'PY'                   TO pending-pay-adj
  3499     move zeros                  to py-file-seq-no
  3500                                    py-last-maint-hhmmss
  3501                                    py-entry-amt
  3502                                    py-check-que-control
  3503                                    py-check-que-sequence
  3504     move low-values             to py-last-maint-dt
  3505                                    py-credit-select-dt
  3506                                    py-credit-accept-dt
  3507                                    py-billed-date
  3508                                    py-reported-dt
  3509                                    py-input-dt
  3510                                    py-check-written-dt
  3511                                    py-ar-date
  3512                                    py-gl-date
  3513     MOVE cf-COMPANY-CD          TO PY-COMPANY-CD
  3514     MOVE function upper-case(sql-py-responsiblecarrier)
  3515                                 TO PY-CARRIER
  3516     MOVE function upper-case(sql-py-group)
  3517                                 TO PY-GROUPING
  3518     MOVE function upper-case(sql-py-responsiblenumber)
  3519                                 TO PY-FIN-RESP
  3520     MOVE function upper-case(sql-py-accountnumber)
  3521                                 TO PY-ACCOUNT
  3522     ADD +1                      TO WORK-SEQ-NO.
  3523     MOVE WORK-SEQ-NO            TO PY-FILE-SEQ-NO.
  3524     move 'R'                    to py-record-type
  3525     move 'E202'                 to py-last-maint-by
  3526     move ws-bin-current-dt      to py-last-maint-dt
  3527                                    py-input-dt
  3528     move ws-work-time           to py-last-maint-hhmmss
  3529*    move +20.00                 to py-entry-amt
  3530     move ws-bin-eom-dt          to py-credit-select-dt
  3531     move 'A'                    to py-ercomp-type
  3532     move sql-is-ach             to ws-bit
  3533     display ' bit comp ' ws-bit-comp
  3534     evaluate true
  3535        when (ws-comp-id = 'DCC')
  3536           and (py-carrier = '9')
  3537           and (ws-bit-comp = zeros)      *> ACH FALSE
  3538           move '2725040310'     to py-gl-account
  3539        when (ws-comp-id = 'DCC')
  3540           and (py-carrier = '7')
  3541           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3542           move '1108121010'     to py-gl-account
  3543        when (ws-comp-id = 'DCC')
  3544           and (py-carrier = '9')
  3545           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3546           move '1108121250'     to py-gl-account
  3547        when (ws-comp-id = 'CID')
  3548           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3549           move '1108124700'     to py-gl-account
  3550        when (ws-comp-id = 'DCC')
  3551           move '1825013400'     to py-gl-account
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  63
* EL202.cbl
  3552        when other
  3553           move '1825099050'     to py-gl-account
  3554     end-evaluate
  3555     if ws-bit-comp not = zeros     *>  ACH TRUE
  3556        move 'ACH'               to py-gl-comment
  3557     end-if
  3558*    if ws-comp-id = 'CID'
  3559*       move '1825099050'        to py-gl-account
  3560*    else
  3561*       move '1825013400'        to py-gl-account
  3562*    end-if
  3563     move +11                    to s2
  3564     move zeros                  to ws-work-amt-alpha
  3565     perform varying s1 from +11 by -1 until s1 < +1
  3566        if sql-py-tot-prem (s1:1) numeric
  3567           move sql-py-tot-prem (s1:1)
  3568                                 to ws-work-amt-alpha (s2:1)
  3569           subtract +1 from s2
  3570        end-if
  3571     end-perform
  3572     display ' tot premium ' ws-work-amt-num
  3573     move ws-work-amt-num        to py-entry-amt
  3574     .
  3575 0040-write.
  3576     display ' about to write pyaj '
  3577
  3578* EXEC CICS WRITE
  3579*        DATASET  ('ERPYAJ')
  3580*        FROM     (PENDING-PAY-ADJ)
  3581*        RIDFLD   (PY-CONTROL-PRIMARY)
  3582*        resp     (ws-response)
  3583*    END-EXEC
  3584     MOVE LENGTH OF
  3585      PENDING-PAY-ADJ
  3586       TO DFHEIV11
  3587     MOVE 'ERPYAJ' TO DFHEIV1
  3588*    MOVE '&$ L                  ''  N#00003376' TO DFHEIV0
  3589     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3590     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3591     MOVE X'204E233030303033333736' TO DFHEIV0(25:11)
  3592     CALL 'kxdfhei1' USING DFHEIV0,
  3593           DFHEIV1,
  3594           PENDING-PAY-ADJ,
  3595           DFHEIV11,
  3596           PY-CONTROL-PRIMARY,
  3597           DFHEIV99,
  3598           DFHEIV99
  3599     MOVE EIBRESP  TO ws-response
  3600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3601     if resp-normal
  3602        move py-control-primary  to ws-rb-erpyaj-key
  3603        move 2                   to ws-status-code
  3604     else
  3605        if resp-duprec
  3606           add +1                to py-file-seq-no
  3607           go to 0040-write
  3608        else
  3609           move 3                to ws-status-code
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  64
* EL202.cbl
  3610           move ws-response      to ws-display-response
  3611           move spaces           to ws-error-message
  3612           string ' Bad write on ERPYAJ FILE ' ws-display-response
  3613              delimited by size into ws-error-message
  3614           end-string
  3615           perform 0226-update-remit-table
  3616                                 thru 0226-exit
  3617           perform 0225-commit-work
  3618                                 thru 0225-exit
  3619           go to 0000-return
  3620        end-if
  3621     end-if
  3622     .
  3623 0040-exit.
  3624     exit.
  3625 0050-open-cursor.
  3626*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  3627***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3628***                                                            ***
  3629***  The dates on the sql table have values in the time        ***
  3630***  so I convert it to a string and just use mm/dd/yyyy       ***
  3631***  to perform the comparison.                                ***
  3632***                                                            ***
  3633***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3634     EXEC SQL
  3635        DECLARE
  3636           remitcerts cursor for
  3637        SELECT
  3638           CertId,
  3639           RemitId,
  3640           CertNumber,
  3641           EffectiveDate,
  3642           FirstPaymentDate,
  3643           FirstName,
  3644           LastName,
  3645           CashIndicator,
  3646           LivesCovered,
  3647           LfBenCode,
  3648           LfTerm,
  3649           LfBenefit,
  3650           LfPremium,
  3651           AhBenCode,
  3652           AhTerm,
  3653           AhBenefit,
  3654           AhPremium,
  3655           ErrorMessage
  3656        FROM
  3657           CUC_Logic_Remittance_Cert
  3658        WHERE
  3659           RemitId = :ws-remit-id
  3660     end-exec
  3661     if sqlcode not = 0
  3662        display "Error: cannot declare cursor "
  3663        display ' sql retrun code ' sqlcode
  3664        display ' sql err mess    ' sqlerrmc
  3665        move ' Error declaring cursor '
  3666                                 to output-msg
  3667        move 3                   to ws-status-code
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  65
* EL202.cbl
  3668        move sqlcode             to ws-display-response
  3669        move spaces              to ws-error-message
  3670        string ' Error declaring cursor   ' ws-display-response
  3671           delimited by size into ws-error-message
  3672        end-string
  3673        perform 0226-update-remit-table
  3674                                 thru 0226-exit
  3675        perform 0225-commit-work thru 0225-exit
  3676        go to 0000-return
  3677     end-if
  3678     display ' good declare cursor ' ws-remit-id
  3679     EXEC SQL
  3680        open remitcerts
  3681     END-EXEC
  3682     if sqlcode not = 0
  3683        display "Error: cannot open cursor "
  3684        display ' sql retrun code ' sqlcode
  3685        display ' sql err mess    ' sqlerrmc
  3686        move ' Error opening cursor '
  3687                                 to output-msg
  3688        move 3                   to ws-status-code
  3689        move sqlcode             to ws-display-response
  3690        move spaces              to ws-error-message
  3691        string ' Error openning cursor    ' ws-display-response
  3692           delimited by size into ws-error-message
  3693        end-string
  3694        perform 0226-update-remit-table
  3695                                 thru 0226-exit
  3696        perform 0225-commit-work thru 0225-exit
  3697        go to 0000-return
  3698     end-if
  3699     display ' good open cursor ' ws-remit-id
  3700     .
  3701 0050-exit.
  3702     exit.
  3703 0060-process-input.
  3704     perform until sqlcode not = 0
  3705        EXEC SQL
  3706           fetch remitcerts into
  3707              :sql-pb-CertId,
  3708              :sql-pb-RemitId,
  3709              :sql-pb-CertNumber,
  3710              :sql-pb-EffectiveDate,
  3711              :sql-pb-FirstPaymentDate,
  3712              :sql-pb-FirstName,
  3713              :sql-pb-LastName,
  3714              :sql-pb-CashIndicator,
  3715              :sql-pb-LivesCovered,
  3716              :sql-pb-LfBenCode,
  3717              :sql-pb-LfTerm,
  3718              :sql-pb-LfBenefit,
  3719              :sql-pb-LfPremium,
  3720              :sql-pb-AhBenCode,
  3721              :sql-pb-AhTerm,
  3722              :sql-pb-AhBenefit,
  3723              :sql-pb-AhPremium,
  3724              :sql-pb-ErrorMessage
  3725        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  66
* EL202.cbl
  3726        if sqlcode = 0
  3727           perform 0070-bld-erpndb
  3728                                 thru 0070-exit
  3729           perform 0110-write-erpndb
  3730                                 thru 0110-exit
  3731           perform 0120-write-erpndm
  3732                                 thru 0120-exit
  3733        else
  3734           if sqlcode not = 0 and 100
  3735              display "Error: cannot fetch row "
  3736              display ' sql return code ' sqlcode
  3737              display ' sql err mess    ' sqlerrmc
  3738              move ' Error fetching cursor '
  3739                                 to output-msg
  3740              set rollback-needed to true
  3741              move 3             to ws-status-code
  3742              move sqlcode       to ws-display-response
  3743              move spaces        to ws-error-message
  3744              string ' Error during fetch cursor '
  3745                ws-display-response
  3746                 delimited by size into ws-error-message
  3747              end-string
  3748              perform 0226-update-remit-table
  3749                                 thru 0226-exit
  3750              perform 0225-commit-work
  3751                                 thru 0225-exit
  3752              go to 0000-return
  3753           end-if
  3754        end-if
  3755     end-perform
  3756     if sqlcode = 100
  3757        display ' Normal end of record set '
  3758        perform 0100-build-batch-hdr
  3759                                 thru 0100-exit
  3760        perform 0110-write-erpndb
  3761                                 thru 0110-exit
  3762     end-if
  3763     EXEC SQL
  3764         close remitcerts
  3765     END-EXEC
  3766     if sqlcode not = 0
  3767        display "Error: cannot close cursor "
  3768        display ' sql retrun code ' sqlcode
  3769        display ' sql err mess    ' sqlerrmc
  3770     end-if
  3771     .
  3772 0060-exit.
  3773     exit.
  3774 0070-bld-erpndb.
  3775     if ws-batch-no-n = zeros
  3776        perform 0080-get-batch-no thru 0080-exit
  3777     end-if
  3778     move ws-init-erpndb-rec     to pending-business
  3779     move ws-batch-no            to pb-entry-batch
  3780                                    pb-original-entry-batch
  3781                                    pb-csr-entry-batch
  3782     add +1 to ws-batch-seq-no
  3783     move ws-batch-seq-no        to pb-batch-seq-no
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  67
* EL202.cbl
  3784                                    pb-original-seq-no
  3785                                    pb-csr-batch-seq-no
  3786     move function upper-case(sql-pb-certnumber)
  3787                                 to pb-cert-no
  3788     string sql-pb-effectivedate (1:4)
  3789            sql-pb-effectivedate (6:2)
  3790            sql-pb-effectivedate (9:2)
  3791        delimited by size into dc-greg-date-cymd-r
  3792     end-string
  3793     move 'L'                    to dc-option-code
  3794     perform 9700-date-convert   thru 9700-exit
  3795     if no-conversion-error
  3796        move dc-bin-date-1       to pb-cert-eff-dt
  3797     else
  3798        display ' error cvtdte eff dt ' sql-pb-effectivedate
  3799           ' ' dc-error-code
  3800     end-if
  3801     move function upper-case(sql-pb-lastname)
  3802                                 to pb-i-insured-last-name
  3803     move function upper-case(sql-pb-firstname)
  3804                                 to pb-i-insured-first-name
  3805     if sql-pb-lfbencode = zeros
  3806        move spaces              to sql-pb-lfbencode
  3807     end-if
  3808     move function upper-case(sql-pb-lfbencode)
  3809                                 to pb-i-life-benefit-cd
  3810                                    pb-i-lf-input-cd
  3811     if pb-i-life-benefit-cd = spaces
  3812        move zeros               to pb-i-life-benefit-cd
  3813     end-if
  3814     move sql-pb-lfterm          to pb-i-lf-term
  3815     move 'L'                    to pb-ah-override-l1
  3816     move +11                    to s2
  3817     move zeros                  to ws-work-amt-alpha
  3818     perform varying s1 from +12 by -1 until s1 < +1
  3819        if sql-pb-lfbenefit (s1:1) numeric
  3820           move sql-pb-lfbenefit (s1:1)
  3821                                 to ws-work-amt-alpha (s2:1)
  3822           subtract +1 from s2
  3823        end-if
  3824     end-perform
  3825     display ' lf benefit  ' ws-work-amt-num
  3826     move ws-work-amt-num        to pb-i-lf-benefit-amt
  3827     move +11                    to s2
  3828     move zeros                  to ws-work-amt-alpha
  3829     perform varying s1 from +10 by -1 until s1 < +1
  3830        if sql-pb-lfpremium (s1:1) numeric
  3831           move sql-pb-lfpremium (s1:1)
  3832                                 to ws-work-amt-alpha (s2:1)
  3833           subtract +1 from s2
  3834        end-if
  3835     end-perform
  3836     display ' lf premium  ' ws-work-amt-num
  3837     move ws-work-amt-num        to pb-i-lf-premium-amt
  3838     if sql-pb-ahbencode = zeros
  3839        move spaces              to sql-pb-ahbencode
  3840     end-if
  3841     move function upper-case(sql-pb-ahbencode)
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  68
* EL202.cbl
  3842                                 to pb-i-ah-benefit-cd
  3843                                    pb-i-ah-input-cd
  3844     if pb-i-ah-benefit-cd = spaces
  3845        move zeros               to pb-i-ah-benefit-cd
  3846     end-if
  3847     move 'A'                    to pb-ah-override-l1
  3848     move sql-pb-ahterm          to pb-i-ah-term
  3849     move +11                    to s2
  3850     move zeros                  to ws-work-amt-alpha
  3851     perform varying s1 from +12 by -1 until s1 < +1
  3852        if sql-pb-ahbenefit (s1:1) numeric
  3853           move sql-pb-ahbenefit (s1:1)
  3854                                 to ws-work-amt-alpha (s2:1)
  3855           subtract +1 from s2
  3856        end-if
  3857     end-perform
  3858     display ' ah benefit  ' ws-work-amt-num
  3859     move ws-work-amt-num        to pb-i-ah-benefit-amt
  3860     move +11                    to s2
  3861     move zeros                  to ws-work-amt-alpha
  3862     perform varying s1 from +10 by -1 until s1 < +1
  3863        if sql-pb-ahpremium (s1:1) numeric
  3864           move sql-pb-ahpremium (s1:1)
  3865                                 to ws-work-amt-alpha (s2:1)
  3866           subtract +1 from s2
  3867        end-if
  3868     end-perform
  3869     display ' ah premium  ' ws-work-amt-num
  3870     move ws-bin-eom-dt          to pb-credit-select-dt
  3871     move ws-work-amt-num        to pb-i-ah-premium-amt
  3872     move sql-pb-LivesCovered    to pb-i-lives
  3873     move function upper-case(sql-pb-CashIndicator)
  3874                                 to pb-i-entry-status
  3875                                    pb-batch-entry
  3876     compute ws-lf-iss-premium =
  3877        ws-lf-iss-premium + pb-i-lf-premium-amt
  3878     compute ws-ah-iss-premium =
  3879        ws-ah-iss-premium + pb-i-ah-premium-amt
  3880     move 'A'                    to pb-force-code
  3881     compute ws-iss-cnt = ws-iss-cnt + +1
  3882     move pb-batch-seq-no           to ws-highest-seq-no
  3883*    display ' sql-pb-CertId           ' sql-pb-CertId
  3884*    display ' sql-pb-RemitId          ' sql-pb-RemitId
  3885*    display ' sql-pb-CertNumber       ' sql-pb-CertNumber
  3886*    display ' sql-pb-EffectiveDate    ' sql-pb-EffectiveDate
  3887*    display ' sql-pb-FirstPaymentDate ' sql-pb-FirstPaymentDate
  3888*    display ' sql-pb-FirstName        ' sql-pb-FirstName
  3889*    display ' sql-pb-LastName         ' sql-pb-LastName
  3890*    display ' sql-pb-CashIndicator    ' sql-pb-CashIndicator
  3891*    display ' sql-pb-LivesCovered     ' sql-pb-LivesCovered
  3892*    display ' sql-pb-LfBenCode        ' sql-pb-LfBenCode
  3893*    display ' sql-pb-LfTerm           ' sql-pb-LfTerm
  3894*    display ' sql-pb-LfBenefit        ' sql-pb-LfBenefit
  3895*    display ' sql-pb-LfPremium        ' sql-pb-LfPremium
  3896*    display ' sql-pb-AhBenCode        ' sql-pb-AhBenCode
  3897*    display ' sql-pb-AhTerm           ' sql-pb-AhTerm
  3898*    display ' sql-pb-AhBenefit        ' sql-pb-AhBenefit
  3899*    display ' sql-pb-AhPremium        ' sql-pb-AhPremium
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  69
* EL202.cbl
  3900*    display ' sql-pb-ErrorMessage     ' sql-pb-ErrorMessage
  3901     .
  3902 0070-exit.
  3903     exit.
  3904 0080-get-batch-no.
  3905     perform 0090-init-erpndb    thru 0090-exit
  3906     perform 0240-init-erpndm    thru 0240-exit
  3907     move ws-comp-id             to elcntl-key
  3908     move '1'                    to elcntl-rec-type
  3909     move +0                     to elcntl-seq
  3910
  3911* exec cics read update
  3912*       dataset  ('ELCNTL')
  3913*       into     (control-file)
  3914*       ridfld   (elcntl-key)
  3915*       resp     (ws-response)
  3916*    end-exec
  3917     MOVE LENGTH OF
  3918      control-file
  3919       TO DFHEIV11
  3920     MOVE 'ELCNTL' TO DFHEIV1
  3921*    MOVE '&"IL       EU         (  N#00003691' TO DFHEIV0
  3922     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3923     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3924     MOVE X'204E233030303033363931' TO DFHEIV0(25:11)
  3925     CALL 'kxdfhei1' USING DFHEIV0,
  3926           DFHEIV1,
  3927           control-file,
  3928           DFHEIV11,
  3929           elcntl-key,
  3930           DFHEIV99,
  3931           DFHEIV99,
  3932           DFHEIV99
  3933     MOVE EIBRESP  TO ws-response
  3934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3935     if resp-normal
  3936        add +1                   to cf-last-batch-no
  3937        move cf-last-batch-no    to ws-batch-no-n
  3938        move +0                  to ws-batch-seq-no
  3939
  3940* exec cics rewrite
  3941*          dataset  ('ELCNTL')
  3942*          from     (control-file)
  3943*          resp     (ws-response)
  3944*       end-exec
  3945     MOVE LENGTH OF
  3946      control-file
  3947       TO DFHEIV11
  3948     MOVE 'ELCNTL' TO DFHEIV1
  3949*    MOVE '&& L                  %  N#00003701' TO DFHEIV0
  3950     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3951     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3952     MOVE X'204E233030303033373031' TO DFHEIV0(25:11)
  3953     CALL 'kxdfhei1' USING DFHEIV0,
  3954           DFHEIV1,
  3955           control-file,
  3956           DFHEIV11,
  3957           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  70
* EL202.cbl
  3958     MOVE EIBRESP  TO ws-response
  3959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3960        if not resp-normal
  3961           display ' bad rewrite on cntl - batch no '
  3962              ws-batch-no-n
  3963           move ' Error rewrite ELCNTL '
  3964                                 to output-msg
  3965           set rollback-needed   to true
  3966           move ws-response         to ws-display-response
  3967           move spaces              to ws-error-message
  3968           string ' Bad rewrite  ELCNTL FILE '
  3969              ws-display-response
  3970              delimited by size into ws-error-message
  3971           end-string
  3972           move 3                to ws-status-code
  3973           perform 0226-update-remit-table
  3974                                 thru 0226-exit
  3975           perform 0225-commit-work
  3976                                 thru 0225-exit
  3977           go to 0000-return
  3978        end-if
  3979     else
  3980        display ' bad read upde on cntl - batch no '
  3981              elcntl-key (1:4)
  3982     end-if
  3983     .
  3984 0080-exit.
  3985     exit.
  3986 0090-init-erpndb.
  3987     move 'PB'                   to pending-business
  3988     INITIALIZE PB-issue-RECORD
  3989     initialize pb-record-status
  3990     move low-values             to pb-i-lf-expire-dt
  3991                                    pb-i-ah-expire-dt
  3992                                    pb-i-1st-pmt-dt
  3993                                    pb-i-last-add-on-dt
  3994                                    pb-i-birthday
  3995                                    pb-i-joint-birthday
  3996                                    pb-credit-select-dt
  3997                                    pb-credit-accept-dt
  3998                                    pb-billed-dt
  3999                                    pb-input-dt
  4000                                    pb-acct-eff-dt
  4001                                    pb-acct-exp-dt
  4002                                    pb-confirmation-rept-dt
  4003                                    pb-ga-bill-dt (1)
  4004                                    pb-ga-bill-dt (2)
  4005                                    pb-ga-bill-dt (3)
  4006                                    pb-ga-bill-dt (4)
  4007                                    pb-ga-bill-dt (5)
  4008     move ws-comp-id             to pb-company-id
  4009     move ws-comp-cd             to pb-company-cd
  4010                                    pb-company-cd-a1
  4011                                    pb-original-company-cd
  4012                                    pb-csr-company-cd
  4013     move zeros                  to pb-chg-count
  4014                                    pb-batch-chg-seq-no
  4015                                    pb-alt-chg-seq-no
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  71
* EL202.cbl
  4016                                    pb-original-chg-seq-no
  4017                                    pb-csr-batch-chg-seq-no
  4018                                    pb-i-rate-deviation-lf
  4019                                    pb-i-rate-deviation-ah
  4020                                    pb-no-of-errors
  4021                                    pb-lf-billed-amts
  4022                                    pb-ah-billed-amts
  4023     move function upper-case(sql-py-carrier)
  4024                                 to pb-carrier
  4025                                    pb-sv-carrier
  4026     move function upper-case(sql-py-group)
  4027                                 to pb-grouping
  4028                                    pb-sv-grouping
  4029     move function upper-case(sql-py-state)
  4030                                 to pb-state
  4031                                    pb-sv-state
  4032     move function upper-case(sql-py-accountnumber)
  4033                                 to pb-account
  4034     move '1'                    to pb-record-type
  4035     move 'E202'                 to pb-last-maint-by
  4036                                    pb-input-by
  4037     move ws-bin-current-dt      to pb-last-maint-dt
  4038                                    pb-input-dt
  4039     move ws-work-time           to pb-last-maint-hhmmss
  4040     perform varying s1 from +1 by +1 until s1 > +10
  4041        move +0                  to pb-common-error (s1)
  4042     end-perform
  4043     move pending-business       to ws-init-erpndb-rec
  4044     .
  4045 0090-exit.
  4046     exit.
  4047 0100-BUILD-BATCH-HDR.
  4048     display ' about to build batch hdr '
  4049     move ws-init-erpndb-rec     to pending-business
  4050     move ws-batch-no            to pb-entry-batch
  4051                                    pb-original-entry-batch
  4052                                    pb-csr-entry-batch
  4053                                    pb-cert-no
  4054     add +1 to ws-batch-seq-no
  4055     move 9999                   to pb-batch-seq-no
  4056                                    pb-original-seq-no
  4057                                    pb-csr-batch-seq-no
  4058     move high-values            to pb-cert-eff-dt
  4059     move zeros                  to PB-B-LF-ISS-PRM-REMITTED
  4060                                    PB-B-LF-ISS-PRM-ENTERED
  4061                                    PB-B-LF-ISS-PRM-COMPUTED
  4062                                    PB-B-LF-CAN-PRM-REMITTED
  4063                                    PB-B-LF-CAN-PRM-ENTERED
  4064                                    PB-B-LF-CAN-PRM-COMPUTED
  4065                                    PB-B-AH-ISS-PRM-REMITTED
  4066                                    PB-B-AH-ISS-PRM-ENTERED
  4067                                    PB-B-AH-ISS-PRM-COMPUTED
  4068                                    PB-B-AH-CAN-PRM-REMITTED
  4069                                    PB-B-AH-CAN-PRM-ENTERED
  4070                                    PB-B-AH-CAN-PRM-COMPUTED
  4071                                    PB-B-ISSUE-CNT-REMITTED
  4072                                    PB-B-ISSUE-CNT-ENTERED
  4073                                    PB-B-CANCEL-CNT-REMITTED
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  72
* EL202.cbl
  4074                                    PB-B-CANCEL-CNT-ENTERED
  4075                                    PB-B-HIGHEST-SEQ-NO
  4076                                    PB-LF-BILLED-AMTS
  4077                                    PB-AH-BILLED-AMTS
  4078                                    PB-CHG-COUNT
  4079                                    PB-CALC-TOLERANCE
  4080     move spaces                 to pb-account-name
  4081                                    pb-prem-ref-rpt-flag
  4082                                    pb-reference
  4083     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  4084                                    PB-BILLED-DT
  4085                                    PB-ACCT-EFF-DT
  4086                                    PB-ACCT-EXP-DT
  4087     MOVE '9'                    TO PB-RECORD-TYPE
  4088     move ws-iss-cnt             to pb-b-issue-cnt-remitted
  4089     move ws-lf-iss-premium      to pb-b-lf-iss-prm-remitted
  4090     move ws-ah-iss-premium      to pb-b-ah-iss-prm-remitted
  4091     move ws-highest-seq-no      to pb-b-highest-seq-no
  4092     move ws-bin-current-dt      to pb-b-received-dt
  4093     move ws-bin-eom-dt          to pb-credit-select-dt
  4094     move function upper-case(sql-py-Name)
  4095                                 to PB-ACCOUNT-NAME
  4096     .
  4097 0100-EXIT.
  4098     EXIT.
  4099 0110-write-erpndb.
  4100     display ' about to write pend bus ' pb-record-type
  4101
  4102* EXEC CICS WRITE
  4103*        DATASET  ('ERPNDB')
  4104*        FROM     (PENDING-BUSINESS)
  4105*        RIDFLD   (PB-CONTROL-PRIMARY)
  4106*        RESP     (WS-RESPONSE)
  4107*    END-EXEC
  4108     MOVE LENGTH OF
  4109      PENDING-BUSINESS
  4110       TO DFHEIV11
  4111     MOVE 'ERPNDB' TO DFHEIV1
  4112*    MOVE '&$ L                  ''  N#00003847' TO DFHEIV0
  4113     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4114     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4115     MOVE X'204E233030303033383437' TO DFHEIV0(25:11)
  4116     CALL 'kxdfhei1' USING DFHEIV0,
  4117           DFHEIV1,
  4118           PENDING-BUSINESS,
  4119           DFHEIV11,
  4120           PB-CONTROL-PRIMARY,
  4121           DFHEIV99,
  4122           DFHEIV99
  4123     MOVE EIBRESP  TO WS-RESPONSE
  4124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4125     IF NOT RESP-NORMAL
  4126        DISPLAY ' ERPNDB BTCH WRITE ERROR ' WS-RESPONSE
  4127        move ' Error writing erpndb  '
  4128                           to output-msg
  4129        set rollback-needed to true
  4130        move ws-response         to ws-display-response
  4131        move spaces              to ws-error-message
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  73
* EL202.cbl
  4132        string ' Bad write on ERPNDB FILE ' ws-display-response
  4133           delimited by size into ws-error-message
  4134        end-string
  4135        move 3             to ws-status-code
  4136        perform 0226-update-remit-table
  4137                           thru 0226-exit
  4138        perform 0225-commit-work
  4139                           thru 0225-exit
  4140        go to 0000-return
  4141     END-IF
  4142     .
  4143 0110-exit.
  4144     exit.
  4145 0120-write-erpndm.
  4146     display ' about to write pend mail '
  4147     move ws-init-erpndm         to pending-mailing-data
  4148     move pb-control-primary     to pm-control-primary
  4149     move function upper-case(sql-py-Name)
  4150                                 to PM-CRED-BENE-NAME
  4151     move function upper-case(sql-py-Addr1)
  4152                                 to PM-CRED-BENE-ADDR
  4153     move function upper-case(sql-py-Addr2)
  4154                                 to PM-CRED-BENE-ADDR2
  4155     move function upper-case(sql-py-AddrCity)
  4156                                 to PM-CRED-BENE-CITY
  4157     move function upper-case(sql-py-AddrState)
  4158                                 to pm-cred-bene-state
  4159     move sql-py-AddrZIP         to pm-cred-bene-zip
  4160
  4161* EXEC CICS WRITE
  4162*        DATASET  ('ERPNDM')
  4163*        FROM     (PENDING-MAILING-DATA)
  4164*        RIDFLD   (PM-CONTROL-PRIMARY)
  4165*        RESP     (WS-RESPONSE)
  4166*    END-EXEC
  4167     MOVE LENGTH OF
  4168      PENDING-MAILING-DATA
  4169       TO DFHEIV11
  4170     MOVE 'ERPNDM' TO DFHEIV1
  4171*    MOVE '&$ L                  ''  N#00003888' TO DFHEIV0
  4172     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4173     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4174     MOVE X'204E233030303033383838' TO DFHEIV0(25:11)
  4175     CALL 'kxdfhei1' USING DFHEIV0,
  4176           DFHEIV1,
  4177           PENDING-MAILING-DATA,
  4178           DFHEIV11,
  4179           PM-CONTROL-PRIMARY,
  4180           DFHEIV99,
  4181           DFHEIV99
  4182     MOVE EIBRESP  TO WS-RESPONSE
  4183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4184     IF NOT RESP-NORMAL
  4185        move ' Error writing erpndm  '
  4186                                 to output-msg
  4187        set rollback-needed to true
  4188        move ws-response         to ws-display-response
  4189        move spaces              to ws-error-message
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  74
* EL202.cbl
  4190        string ' Bad write on ERPNDM FILE ' ws-display-response
  4191           delimited by size into ws-error-message
  4192        end-string
  4193        move 3                   to ws-status-code
  4194        perform 0226-update-remit-table
  4195                                 thru 0226-exit
  4196        perform 0225-commit-work
  4197                                 thru 0225-exit
  4198        go to 0000-return
  4199        DISPLAY ' ERPNDM WRITE ERROR ' WS-RESPONSE
  4200     END-IF
  4201     .
  4202 0120-exit.
  4203     exit.
  4204 0130-start-edit.
  4205     display ' about to start edit '
  4206     MOVE ws-comp-cd             TO EDIT-COMPANY-CD
  4207     MOVE WS-BATCH-NO            TO EDIT-BATCH
  4208     MOVE ws-comp-id             TO EDIT-COMPANY-ID
  4209     MOVE SPACES                 TO EDIT-RESTART-BATCH
  4210
  4211* EXEC CICS START
  4212*         TRANSID       ('EXEB')
  4213*         FROM          (BATCH-TO-PROCESS)
  4214*    END-EXEC
  4215     MOVE LENGTH OF
  4216      BATCH-TO-PROCESS
  4217       TO DFHEIV11
  4218     MOVE 'EXEB' TO DFHEIV5
  4219*    MOVE '0( LF                 1   #00003920' TO DFHEIV0
  4220     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4221     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4222     MOVE X'2020233030303033393230' TO DFHEIV0(25:11)
  4223     CALL 'kxdfhei1' USING DFHEIV0,
  4224           DFHEIV99,
  4225           DFHEIV5,
  4226           DFHEIV99,
  4227           BATCH-TO-PROCESS,
  4228           DFHEIV11,
  4229           DFHEIV99,
  4230           DFHEIV99,
  4231           DFHEIV99,
  4232           DFHEIV99,
  4233           DFHEIV99,
  4234           DFHEIV99,
  4235           DFHEIV99,
  4236           DFHEIV99,
  4237           DFHEIV99,
  4238           DFHEIV99,
  4239           DFHEIV99
  4240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4241
  4242* EXEC CICS DELAY
  4243*       INTERVAL    (02)
  4244*    END-EXEC
  4245     MOVE 02 TO DFHEIV10
  4246*    MOVE '0$I                   &   #00003924' TO DFHEIV0
  4247     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  75
* EL202.cbl
  4248     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4249     MOVE X'2020233030303033393234' TO DFHEIV0(25:11)
  4250     CALL 'kxdfhei1' USING DFHEIV0,
  4251           DFHEIV10,
  4252           DFHEIV99,
  4253           DFHEIV99,
  4254           DFHEIV99,
  4255           DFHEIV99
  4256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4257     .
  4258 0130-exit.
  4259     exit.
  4260 0220-send-form.
  4261     move ws-comp-id             to out-comp-id
  4262     move 'CU CONNECT '          to output-title
  4263     display ' about to send form '
  4264
  4265* exec cics document create
  4266*       doctoken   (w-doctoken)
  4267*       template   ('WCHECKS')
  4268*       symbollist (output-data)
  4269*       listlength (length of output-data)
  4270*    end-exec
  4271     MOVE 'WCHECKS'
  4272      TO DFHEIVL0
  4273     MOVE LENGTH OF
  4274      output-data TO DFHEIV16
  4275*    MOVE '\"D tSL               )   #00003934' TO DFHEIV0
  4276     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  4277     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4278     MOVE X'2020233030303033393334' TO DFHEIV0(25:11)
  4279     CALL 'kxdfhei1' USING DFHEIV0,
  4280           w-doctoken,
  4281           DFHEIV99,
  4282           DFHEIVL0,
  4283           output-data,
  4284           DFHEIV16,
  4285           DFHEIV99,
  4286           DFHEIV99,
  4287           DFHEIV99
  4288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4289
  4290* exec cics web send
  4291*       doctoken(w-doctoken)
  4292*    end-exec
  4293*    MOVE 'X$D                   *   #00003940' TO DFHEIV0
  4294     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  4295     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  4296     MOVE X'2020233030303033393430' TO DFHEIV0(25:11)
  4297     CALL 'kxdfhei1' USING DFHEIV0,
  4298           w-doctoken,
  4299           DFHEIV99,
  4300           DFHEIV99,
  4301           DFHEIV99,
  4302           DFHEIV99,
  4303           DFHEIV99,
  4304           DFHEIV99,
  4305           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  76
* EL202.cbl
  4306           DFHEIV99
  4307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4308     .
  4309 0220-exit.
  4310     exit.
  4311 0225-commit-work.
  4312     display ' about to commit work   '
  4313     if connected-to-db
  4314        EXEC SQL
  4315            commit work
  4316        END-EXEC
  4317     end-if
  4318     .
  4319 0225-exit.
  4320     exit.
  4321 0226-update-remit-table.
  4322     if ws-batch-no = zeros
  4323        move -1                  to nu-batchno
  4324     else
  4325        move +0                  to nu-batchno
  4326     end-if
  4327     if ws-error-message = spaces
  4328        move -1                  to nu-error-message
  4329     else
  4330        move +0                  to nu-error-message
  4331     end-if
  4332     EXEC SQL
  4333        UPDATE
  4334           CUC_Logic_Remittance
  4335        SET
  4336           LogicStatus = :ws-status-code,
  4337           LogicStatusDate = :ws-status-date,
  4338           BatchNumber = :ws-batch-no :nu-batchno,
  4339           ErrorMessage = :ws-error-message :nu-error-message
  4340        WHERE
  4341           RemitId = :ws-remit-id
  4342     END-EXEC
  4343     .
  4344 0226-exit.
  4345     exit.
  4346 0230-disconnect.
  4347     display ' about to disconnect DB '
  4348     if connected-to-db
  4349        EXEC SQL
  4350            disconnect all
  4351        END-EXEC
  4352        move ' ' to ws-connect-sw
  4353     end-if
  4354     .
  4355 0230-exit.
  4356     exit.
  4357 0240-init-erpndm.
  4358     display ' made it to init pndm '
  4359     move spaces                 to pending-mailing-data
  4360     move 'PM'                   to pm-record-id
  4361     move zeros                  to pm-batch-seq-no
  4362                                    pm-batch-chg-seq-no
  4363                                    pm-last-maint-hhmmss
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  77
* EL202.cbl
  4364                                    pm-insured-issue-age
  4365                                    pm-phone-no
  4366     move low-values             to pm-record-add-dt
  4367                                    pm-last-maint-dt
  4368                                    pm-insured-birth-dt
  4369                                    pm-joint-birth-dt
  4370     perform varying s1 from +1 by +1 until s1 > +7
  4371        move low-values          to pm-mail-date (s1)
  4372     end-perform
  4373     move 'CR'                   to pm-source-system
  4374     move ws-bin-current-dt      to pm-record-add-dt
  4375                                    pm-last-maint-dt
  4376     move 'E202'                 to pm-last-maint-by
  4377                                    pm-record-added-by
  4378     move ws-work-time           to pm-last-maint-hhmmss
  4379     move pending-mailing-data   to ws-init-erpndm
  4380     .
  4381 0240-exit.
  4382     exit.
  4383 9700-DATE-CONVERT.
  4384
  4385* EXEC CICS LINK
  4386*         PROGRAM  ('ELDATCV')
  4387*         COMMAREA (DATE-CONVERSION-DATA)
  4388*         LENGTH   (DC-COMM-LENGTH)
  4389*    END-EXEC.
  4390     MOVE 'ELDATCV' TO DFHEIV1
  4391*    MOVE '."C                   (   #00004019' TO DFHEIV0
  4392     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4394     MOVE X'2020233030303034303139' TO DFHEIV0(25:11)
  4395     CALL 'kxdfhei1' USING DFHEIV0,
  4396           DFHEIV1,
  4397           DATE-CONVERSION-DATA,
  4398           DC-COMM-LENGTH,
  4399           DFHEIV99,
  4400           DFHEIV99,
  4401           DFHEIV99,
  4402           DFHEIV99
  4403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4404
  4405 9700-EXIT.
  4406      EXIT.
  4407
  4408 9999-DFHBACK SECTION.
  4409     MOVE '9%                    "   ' TO DFHEIV0
  4410     MOVE 'EL202' TO DFHEIV1
  4411     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4412     GOBACK.
  4413 9999-DFHEXIT.
  4414     IF DFHEIGDJ EQUAL 0001
  4415         NEXT SENTENCE.
  4416     MOVE '9%                    "   ' TO DFHEIV0
  4417     MOVE 'EL202' TO DFHEIV1
  4418     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4419     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 07-Sep-16 11:58 Page  78
* EL202.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      138620     Code:       17605
