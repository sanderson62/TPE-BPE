* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   1
* EL201.cbl
* Options: int("EL201.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL201.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL201.
    10*
    11*AUTHOR.    Pablo.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   2
* EL201.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  Post check number and check written date to refund checks ***
    17***                                                            ***
    18***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 011714  CR2013053000001  PEMA  NEW PROGRAM
    28* 022014  IR2014022000001  PEMA  chg process when file is empty
    29* 082014  IR2014081400001  PEMA  bypass manual request checks
    30* 082014  IR2015082100001  PEMA  bypass more manual request checks
    31* 092215  IR2015092200001  PEMA  modify determination of manual ch
    32* 091615  CR2015082000001  PEMA  Add Endorsement check processing
    33 environment division.
    34 INPUT-OUTPUT SECTION.
    35 FILE-CONTROL.
    36 SELECT CPS-WRITTEN-IN ASSIGN TO dynamic ws-written-in
    37    FILE STATUS IS WRITTEN-STATUS
    38                            ORGANIZATION IS LINE SEQUENTIAL.
    39 SELECT CPS-WRITTEN-RPT ASSIGN TO dynamic ws-written-rpt
    40    FILE STATUS IS WRITRPT-STATUS
    41                            ORGANIZATION IS LINE SEQUENTIAL.
    42 data division.
    43 FILE SECTION.
    44 FD  CPS-WRITTEN-IN
    45     BLOCK CONTAINS 0
    46     RECORDING MODE F.
    47 01  CPS-WRITTEN-IN-REC          pic x(200).
    48 FD  CPS-WRITTEN-RPT
    49     BLOCK CONTAINS 0
    50     RECORDING MODE F.
    51 01  CPS-WRITTEN-RPT-REC         pic x(132).
    52 working-storage section.
    53 01  DFH-START PIC X(04).
    54 77  ws-process-sw               pic x value ' '.
    55     88  process-cashed            value 'C'.
    56     88  process-written           value 'W'.
    57 77  ws-writ-cnt                 pic 9(5) value zeros.
    58 77  ws-tot-writ-amt             pic s9(9)v99 comp-3 value +0.
    59 77  s1                          pic s999 comp-3 value +0.
    60 77  s2                          pic s999 comp-3 value +0.
    61 77  i1                          pic s999 comp-3 value +0.
    62 77  o1                          pic s999 comp-3 value +0.
    63 77  ws-bin-cashed-dt            pic xx  value low-values.
    64 77  ws-bin-check-dt             pic xx  value low-values.
    65 77  ws-page-cntr                pic 999  value zeros.
    66 77  ws-line-cntr                pic 999  value 070.
    67 77  ws-max-lines                pic 999  value 060.
    68 77  ws-erchek-sw                pic x    value spaces.
    69     88  erchek-found              value 'Y'.
    70 77  ws-table-sw                 pic x    value spaces.
    71     88  table-found               value 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   3
* EL201.cbl
    72 77  ws-continue-sw              pic x  value 'Y'.
    73     88  ok-to-continue            value 'Y'.
    74     88  not-ok-to-continue        value 'N'.
    75 77  ws-in-recs                  pic 9(5) value zeros.
    76 77  ws-eof-sw                   pic x  value spaces.
    77     88  end-of-input                  value 'Y'.
    78 77  ws-sql-code                 pic s9(7) value zeros.
    79 77  ws-dis-sql-code             pic -9999999 value zeros.
    80 01  ws-work-dynamic.
    81     05  ws-work-dir             pic x(27) value spaces.
    82     05  ws-work-env             pic x(8)  value spaces.
    83     05  ws-work-comp-id         pic xxx   value spaces.
    84     05  ws-work-file-in         pic x(16) value spaces.
    85     05  ws-work-rpt-out         pic x(13) value spaces.
    86     05  ws-work-job-name        pic x(8)  value spaces.
    87 01  ws-written-in               pic x(58).
    88 01  ws-written-rpt              pic x(58).
    89 01  P pointer.
    90 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    91 01  var-ptr pointer.
    92 01  env-var-len                 pic 9(4)  binary.
    93 01  rc                          pic 9(9)  binary.
    94
    95 01  WS-KIXSYS.
    96     05  WS-KIX-FIL1             PIC X(10).
    97     05  WS-KIX-APPS             PIC X(10).
    98     05  WS-KIX-ENV              PIC X(10).
    99     05  WS-KIX-MYENV            PIC X(10).
   100     05  WS-KIX-SYS              PIC X(10).
*  101 EXEC SQL
*  102    INCLUDE SQLDA
*  103 END-EXEC
   104 01 SQLDA sync.
   105    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   106    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   107    05 SQLN                  PIC S9(4) COMP-5 value 0.
   108    05 SQLD                  PIC S9(4) COMP-5 value 0.
   109    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   110       10 SQLTYPE            PIC S9(4) COMP-5.
   111       10 SQLLEN             PIC S9(4) COMP-5.
   112$IF P64 SET
   113X      *> For 64-bit environments, ensure that SQLDATA is
   114X      *> aligned on an 8-byte boundary.
   115X      10 FILLER             PIC S9(9) COMP-5.
   116$END
   117       10 SQLDATA            USAGE POINTER.
   118       10 SQLIND             USAGE POINTER.
   119       10 SQLNAME.
   120          15 SQLNAMEL        PIC S9(4) COMP-5.
   121          15 SQLNAMEC        PIC X(30).
   122
   123* Values for SQLTYPE
   124
   125 78  ESQL-DATE-CHAR              VALUE 384.
   126 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   127 78  ESQL-DATE-REC               VALUE 386.
   128 78  ESQL-DATE-REC-NULL          VALUE 387.
   129 78  ESQL-TIME-CHAR              VALUE 388.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   4
* EL201.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   131 78  ESQL-TIME-REC               VALUE 390.
   132 78  ESQL-TIME-REC-NULL          VALUE 391.
   133 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   134 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   135 78  ESQL-TIMESTAMP-REC          VALUE 394.
   136 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   137 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   138 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   139 78  ESQL-TS-OFFSET-REC          VALUE 398.
   140 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   141 78  ESQL-LONGVARBINARY          VALUE 404.
   142 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   143 78  ESQL-LONGVARCHAR            VALUE 408.
   144 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   145 78  ESQL-BINARY                 VALUE 444.
   146 78  ESQL-BINARY-NULL            VALUE 445.
   147 78  ESQL-VARBINARY              VALUE 446.
   148 78  ESQL-VARBINARY-NULL         VALUE 447.
   149 78  ESQL-VARCHAR                VALUE 448.
   150 78  ESQL-VARCHAR-NULL           VALUE 449.
   151
   152 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   153 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   154
   155 78  ESQL-CHAR                   VALUE 452.
   156 78  ESQL-CHAR-NULL              VALUE 453.
   157
   158 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   159 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   160
   161 78  ESQL-DOUBLE                 VALUE 480.
   162 78  ESQL-DOUBLE-NULL            VALUE 481.
   163 78  ESQL-REAL                   VALUE 482.
   164 78  ESQL-REAL-NULL              VALUE 483.
   165 78  ESQL-DECIMAL                VALUE 484.
   166 78  ESQL-DECIMAL-NULL           VALUE 485.
   167 78  ESQL-INTEGER                VALUE 496.
   168 78  ESQL-INTEGER-NULL           VALUE 497.
   169 78  ESQL-SMALLINT               VALUE 500.
   170 78  ESQL-SMALLINT-NULL          VALUE 501.
   171 78  ESQL-TINYINT                VALUE 502.
   172 78  ESQL-TINYINT-NULL           VALUE 503.
*  173 EXEC SQL
*  174    INCLUDE SQLCA
*  175 END-EXEC
   176 01 SQLCA.
   177     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   178     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   179     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   180     05  SQLERRM.
   181         49  SQLERRML    PIC S9(4) COMP-5.
   182         49  SQLERRMC    PIC X(70).
   183     05  SQLERRP         PIC X(8).
   184     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   185     05  SQLWARN.
   186         10  SQLWARN0    PIC X.
   187         10  SQLWARN1    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   5
* EL201.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN2    PIC X.
   189         10  SQLWARN3    PIC X.
   190         10  SQLWARN4    PIC X.
   191         10  SQLWARN5    PIC X.
   192         10  SQLWARN6    PIC X.
   193         10  SQLWARN7    PIC X.
   194     05  SQLEXT.
   195         10  SQLWARN8    PIC X.
   196         10  SQLWARN9    PIC X.
   197         10  SQLWARN10   PIC X.
   198         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   199     05  SQLSTATE    PIC X(5).
   200 EXEC SQL
   201    BEGIN DECLARE SECTION
   202 END-EXEC
   203 01  ws-key-stuff.
   204     05  ws-check-key            pic 9(7).
   205     05  ws-check-no             pic x(7).
   206     05  ws-compid               pic xxx.
   207     05  ws-carrier              pic x.
   208     05  ws-grouping             pic x(6).
   209     05  ws-state                pic xx.
   210     05  ws-account              pic x(10).
   211     05  ws-eff-date             pic x(10).
   212     05  ws-certificate          pic x(10).
   213     05  ws-cert-sfx             pic x.
   214     05  ws-seq-no               pic 999.
   215     05  ws-type                 pic 999.
   216 01  sqlcmd                      pic x(1024).
   217 01  WS-MOE-DATE                 pic x(10).
   218 01  svr                         pic x(32).
   219 01  usr                         pic x(32).
   220 01  pass                        pic x(32).
   221 01  usr-pass                    pic x(64).
   222 01  ws-disp-code                pic s9(11).
   223***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   224***                                                            ***
   225***  These indicators are used to determine if a variable      ***
   226***  is passed nulls from sql. The indicator will be -1        ***
   227***  if the value on sql is nulls and +0 if the value is       ***
   228***  something other than nulls. Here is an example on how     ***
   229***  to use the indicator variables.                           ***
   230***                                                            ***
   231***     EXEC SQL                                               ***
   232***        fetch checkapp into                                 ***
   233***           :db-app-status :nu-app-status,                   ***
   234***           :db-app-by     :nu-app-by,                       ***
   235***           :db-app-date   :nu-app-date,                     ***
   236***           :db-app-batch  :nu-app-batch                     ***
   237***     END-EXEC                                               ***
   238***                                                            ***
   239***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   240 01  indicator-vaiables-for-nulls.
   241     05  nu-app-status           pic s9(4) comp value +0.
   242     05  nu-app-by               pic s9(4) comp value +0.
   243     05  nu-app-date             pic s9(4) comp value +0.
   244     05  nu-app-batch            pic s9(4) comp value +0.
   245     05  nu-fincar               pic s9(4) comp value +0.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   6
* EL201.cbl
   246     05  nu-checkno              pic s9(4) comp value +0.
   247 01  daily-check-request-rec.
   248     05  db-checkkey             pic x(7).
   249     05  db-compid               pic xxx.
   250     05  db-carrier              pic x.
   251     05  db-grouping             pic x(6).
   252     05  db-state                pic xx.
   253     05  db-account              pic x(10).
   254     05  db-effdate              pic x(24).
   255     05  db-certificate          pic x(10).
   256     05  db-cert-sfx             pic x.
   257     05  db-seq-no               pic x(7).
   258     05  db-type                 pic x(7).
   259     05  db-amount               pic x(10).
   260     05  db-amount-n redefines
   261         db-amount               pic 9(7).99.
   262     05  db-checkno              pic x(15).
   263     05  db-checkdate            pic x(10).
   264     05  db-checkstatus          pic 9(5).
   265     05  db-releasebatch         pic 9(5).
   266     05  db-releasedt            pic x(10).
   267     05  db-releaseby            pic x(4).
   268     05  db-payeename1           pic x(30).
   269     05  db-payeename2           pic x(30).
   270     05  db-payeeaddr1           pic x(30).
   271     05  db-payeeaddr2           pic x(30).
   272     05  db-payeecity            pic x(30).
   273     05  db-payeest              pic xx.
   274     05  db-payeezip             pic x(10).
   275     05  db-fincar               pic x.
   276     05  db-fingrp               pic x(6).
   277     05  db-finresp              pic x(10).
   278     05  db-finacct              pic x(10).
   279     05  db-preparer             pic x(4).
   280     05  db-app-status           pic x(9).
   281     05  dp-app-status-n redefines db-app-status
   282                                 pic 9(9).
   283     05  db-app-by               pic x(20).
   284     05  db-app-date             pic x(30).
   285     05  db-app-batch            pic x(10).
   286     05  db-return-to            pic x(30).
   287     05  db-check-sub-type       pic x.
   288 EXEC SQL
   289    END DECLARE SECTION
   290 END-EXEC
   291 01  FILE-KEYS.
   292     12  ELCNTL-KEY.
   293         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   294         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   295         16 ELCNTL-ACCESS.
   296             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   297             20  FILLER              PIC X       VALUE SPACES.
   298             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   299         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   300 01  f.
   301     05  ws-connect-sw               pic x  value ' '.
   302         88  connected-to-db             value 'Y'.
   303     05  written-status          pic xx.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   7
* EL201.cbl
   304     05  writrpt-status          pic xx.
   305     05  ws-comp-id              pic xxx.
   306     05  ws-comp-cd              pic x.
   307 01  ws-raw-record.
   308     05  raw-check-no            pic x(20).
   309     05  raw-check-dt            pic x(20).
   310     05  raw-check-amt           pic x(15).
   311     05  raw-vendor-id           pic x(20).
   312     05  raw-user-defined        pic x(30).
   313     05  raw-voucher-ref         pic x(35).
   314 01  ws-written-rec.
   315     05  wsw-check-no            pic x(20).
   316     05  wsw-check-dt            pic x(20).
   317     05  wsw-check-amt           pic x(15).
   318     05  wsw-vendor-id           pic x(20).
   319     05  wsw-user-defined        pic x(30).
   320     05  wsw-voucher-ref         pic x(35).
   321 01  filler.
   322     05  wsw-check-key           pic x(7).
   323     05  wsw-check-key-num redefines wsw-check-key
   324                                 pic 9(7).
   325 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   326     88  RESP-NORMAL                    VALUE +0.
   327     88  resp-file-notfnd               value +12.
   328     88  RESP-NOTFND                    VALUE +13.
   329     88  resp-duprec                    value +14.
   330     88  resp-dupkey                    value +15.
   331     88  resp-invreq                    value +16.
   332     88  RESP-NOTOPEN                   VALUE +19.
   333     88  RESP-ENDFILE                   VALUE +20.
   334     88  resp-lengtherr                 value +22.
   335 01  ws-work-amt-alpha           pic x(10).
   336 01  ws-work-amt-num redefines ws-work-amt-alpha
   337                                 pic 9(8)v99.
   338 01  ws-qry-string               pic x(80) value spaces.
   339 01  ws-qrystr-len               pic s9(8) comp value +60.
   340 01  ws-seq-alpha                pic x(5).
   341 01  ws-seq-no-num redefines ws-seq-alpha
   342                                 pic 9(5).
   343*                                copy ERCCHEK.
   344******************************************************************
   345*                                                                *
   346*                                                                *
   347*                            ERCCHEK                             *
   348*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   349*                            VMOD=2.008                          *
   350*                                                                *
   351*   FILE DESCRIPTION = CHECK RECORDS                             *
   352*                                                                *
   353*   FILE TYPE = VSAM,KSDS                                        *
   354*   RECORD SIZE = 600    RECFORM = FIXED                         *
   355*                                                                *
   356*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
   357*       ALTERNATE INDEX = NONE                                   *
   358*                                                                *
   359*   LOG = YES                                                    *
   360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   361******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   8
* EL201.cbl
   362*                   C H A N G E   L O G
   363*
   364* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   365*-----------------------------------------------------------------
   366*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   367* EFFECTIVE    NUMBER
   368*-----------------------------------------------------------------
   369* 021414    2003053000001  PEMA  changes for auto chk request
   370******************************************************************
   371 01  CHECK-RECORDS.
   372     12  CH-RECORD-ID                      PIC XX.
   373         88  VALID-CH-ID                      VALUE 'CH'.
   374
   375     12  CH-CONTROL-PRIMARY.
   376         16  CH-COMPANY-CD                 PIC X.
   377         16  CH-CARRIER                    PIC X.
   378         16  CH-GROUPING                   PIC X(6).
   379         16  CH-STATE                      PIC XX.
   380         16  CH-ACCOUNT                    PIC X(10).
   381         16  CH-CERT-EFF-DT                PIC XX.
   382         16  CH-CERT-NO.
   383             20  CH-CERT-PRIME             PIC X(10).
   384             20  CH-CERT-SFX               PIC X.
   385         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
   386
   387     12  CH-RECORDED-DT                    PIC XX.
   388     12  CH-RECORDED-BY                    PIC X(4).
   389     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
   390
   391     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
   392     12  CH-CHECK-NO                       PIC X(7).
   393     12  CH-REASON-FOR-CHECK               PIC X(25).
   394     12  CH-CHECK-WRITTEN-DT               PIC XX.
   395     12  FILLER                            PIC X.
   396
   397     12  CH-PAYEE-INFO.
   398         16  CH-PAYEE-NAME-1               PIC X(30).
   399         16  CH-PAYEE-NAME-2               PIC X(30).
   400         16  CH-PAYEE-ADDRESS-1            PIC X(30).
   401         16  CH-PAYEE-ADDRESS-2            PIC X(30).
   402         16  CH-PAYEE-CITY-ST.
   403             20  CH-PAYEE-CITY             PIC X(28).
   404             20  CH-PAYEE-STATE            PIC XX.
   405         16  CH-PAYEE-ZIP-CODE.
   406             20  CH-PAYEE-ZIP.
   407                 24  CH-ZIP-PRI-1ST        PIC X.
   408                     88  CH-CANADIAN-POST-CODE
   409                                           VALUES 'A' THRU 'Z'.
   410                 24  FILLER                PIC X(4).
   411             20  CH-PAYEE-ZIP-EXT          PIC X(4).
   412         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
   413             20  CH-CAN-POSTAL-1           PIC XXX.
   414             20  CH-CAN-POSTAL-2           PIC XXX.
   415             20  FILLER                    PIC XXX.
   416
   417     12  CH-CHECK-STUB-TEXT.
   418         16  CH-STUB-LINE-1                PIC X(30).
   419         16  CH-TEXT-LINE-1                PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   9
* EL201.cbl
   420         16  CH-TEXT-LINE-2                PIC X(50).
   421         16  CH-TEXT-LINE-3                PIC X(40).
   422     12  CH-RETURN-TO                      PIC X(30).
   423
   424     12  CH-COMPENSATION-CONTROL.
   425         16  CH-COMP-CARRIER               PIC X.
   426         16  CH-COMP-GROUPING              PIC X(6).
   427         16  CH-COMP-FIN-RESP              PIC X(10).
   428         16  CH-COMP-ACCOUNT               PIC X(10).
   429
   430     12  CH-CREDIT-SELECT-DT               PIC XX.
   431     12  CH-CREDIT-ACCEPT-DT               PIC XX.
   432     12  CH-PAYEE-CODE                     PIC X(6).
   433
   434     12  CH-VOID-DATA.
   435         20  CH-VOID-DT                    PIC XX.
   436         20  CH-VOID-BY                    PIC X(4).
   437         20  CH-VOID-REASON                PIC X(25).
   438
   439     12  CH-APPROVAL-DATA.
   440         20  CH-APPROVAL-DT                PIC XX.
   441         20  CH-APPROVAL-STATUS            PIC X.
   442             88  CH-IN-LIMBO                  VALUE ' '.
   443             88  CH-APPROV-PENDING            VALUE 'P' '2'.
   444             88  CH-APPROVED                  VALUE 'A'.
   445             88  CH-DENIED                    VALUE 'D'.
   446         20  CH-APPROVED-BY                PIC XXXX.
   447     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
   448             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
   449     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
   450
   451     12  ch-released-dt                    pic xx.
   452     12  ch-check-cashed-dt                pic xx.
   453     12  FILLER                            PIC X.
   454*    12  CH-CHECK-REFERENCE                PIC X(12).
   455     12  CH-CHECK-ORIGIN-SW                PIC X.
   456             88  CH-REFUND-CHECK              VALUE 'R'.
   457             88  CH-MAINT-CHECK               VALUE 'M'.
   458
   459     12  CH-CANC-DT                        PIC XX.
   460     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
   461     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
   462
   463     12  CH-INSURED-NAME                   PIC X(28).
   464
   465     12  ch-released-by                    pic x(4).
   466     12  ch-csr                            pic x(4).
   467     12  ch-deduct-commission              pic x.
   468         88  ch-deduct-comm                  value 'Y'.
   469         88  ch-do-not-deduct-comm           value 'N'.
   470
   471     12  FILLER                            PIC X(11).
   472*    12  CH-LETTER-TABLE.
   473*        16  CH-LETTERS OCCURS 3 TIMES
   474*                       INDEXED BY CH-LT-NDX
   475*                                          PIC X(04).
   476
   477     12  FILLER                            PIC X(07).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  10
* EL201.cbl
   478
   479*                                copy ELCFUNDT.
   480*****************************************************************
   481*                                                               *
   482*                            ELCFUNDT.                          *
   483*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   484*                            VMOD=2.001                         *
   485*                                                               *
   486*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   487*                                                               *
   488*****************************************************************
   489
   490
   491 01  FUNCTION-DATE.
   492     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   493     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   494         10  WS-FN-CCYR            PIC 9(4).
   495         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   496             15  WS-FN-CC          PIC 99.
   497             15  WS-FN-YR          PIC 99.
   498         10  WS-FN-MO              PIC 99.
   499         10  WS-FN-DA              PIC 99.
   500     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   501     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   502     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   503     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   504     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   505         88  WS-BEHIND-GMT                     VALUE '-'.
   506         88  WS-AFTER-GMT                      VALUE '+'.
   507         88  WS-NO-GMT                         VALUE ZERO.
   508     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   509     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   510*                                COPY ELCDATE.
   511******************************************************************
   512*                                                                *
   513*                                                                *
   514*                            ELCDATE.                            *
   515*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   516*                            VMOD=2.003
   517*                                                                *
   518*                                                                *
   519*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   520*                 LENGTH = 200                                   *
   521******************************************************************
   522
   523 01  DATE-CONVERSION-DATA.
   524     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   525     12  DC-OPTION-CODE                PIC X.
   526         88  BIN-TO-GREG                VALUE ' '.
   527         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   528         88  EDIT-GREG-TO-BIN           VALUE '2'.
   529         88  YMD-GREG-TO-BIN            VALUE '3'.
   530         88  MDY-GREG-TO-BIN            VALUE '4'.
   531         88  JULIAN-TO-BIN              VALUE '5'.
   532         88  BIN-PLUS-ELAPSED           VALUE '6'.
   533         88  FIND-CENTURY               VALUE '7'.
   534         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   535         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  11
* EL201.cbl
   536         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   537         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   538         88  JULIAN-TO-BIN-3            VALUE 'C'.
   539         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   540         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   541         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   542         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   543         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   544         88  CHECK-LEAP-YEAR            VALUE 'H'.
   545         88  BIN-3-TO-GREG              VALUE 'I'.
   546         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   547         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   548         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   549         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   550         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   551         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   552         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   553         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   554         88  THREE-CHARACTER-BIN
   555                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   556         88  GREGORIAN-TO-BIN
   557                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   558         88  BIN-TO-GREGORIAN
   559                  VALUES ' ' '1' 'I' '8' 'G'.
   560         88  JULIAN-TO-BINARY
   561                  VALUES '5' 'C' 'E' 'F'.
   562     12  DC-ERROR-CODE                 PIC X.
   563         88  NO-CONVERSION-ERROR        VALUE ' '.
   564         88  DATE-CONVERSION-ERROR
   565                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   566         88  DATE-IS-ZERO               VALUE '1'.
   567         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   568         88  DATE-IS-INVALID            VALUE '3'.
   569         88  DATE1-GREATER-DATE2        VALUE '4'.
   570         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   571         88  DATE-INVALID-OPTION        VALUE '9'.
   572         88  INVALID-CENTURY            VALUE 'A'.
   573         88  ONLY-CENTURY               VALUE 'B'.
   574         88  ONLY-LEAP-YEAR             VALUE 'C'.
   575         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   576     12  DC-END-OF-MONTH               PIC X.
   577         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   578     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   579         88  USE-NORMAL-PROCESS         VALUE ' '.
   580         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   581         88  ADJUST-UP-100-YRS          VALUE '2'.
   582     12  FILLER                        PIC X.
   583     12  DC-CONVERSION-DATES.
   584         16  DC-BIN-DATE-1             PIC XX.
   585         16  DC-BIN-DATE-2             PIC XX.
   586         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   587         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   588                       DC-GREG-DATE-1-EDIT.
   589             20  DC-EDIT1-MONTH        PIC 99.
   590             20  SLASH1-1              PIC X.
   591             20  DC-EDIT1-DAY          PIC 99.
   592             20  SLASH1-2              PIC X.
   593             20  DC-EDIT1-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  12
* EL201.cbl
   594         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   595         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   596                     DC-GREG-DATE-2-EDIT.
   597             20  DC-EDIT2-MONTH        PIC 99.
   598             20  SLASH2-1              PIC X.
   599             20  DC-EDIT2-DAY          PIC 99.
   600             20  SLASH2-2              PIC X.
   601             20  DC-EDIT2-YEAR         PIC 99.
   602         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   603         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   604                     DC-GREG-DATE-1-YMD.
   605             20  DC-YMD-YEAR           PIC 99.
   606             20  DC-YMD-MONTH          PIC 99.
   607             20  DC-YMD-DAY            PIC 99.
   608         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   609         16  DC-GREG-DATE-1-MDY-R REDEFINES
   610                      DC-GREG-DATE-1-MDY.
   611             20  DC-MDY-MONTH          PIC 99.
   612             20  DC-MDY-DAY            PIC 99.
   613             20  DC-MDY-YEAR           PIC 99.
   614         16  DC-GREG-DATE-1-ALPHA.
   615             20  DC-ALPHA-MONTH        PIC X(10).
   616             20  DC-ALPHA-DAY          PIC 99.
   617             20  FILLER                PIC XX.
   618             20  DC-ALPHA-CENTURY.
   619                 24 DC-ALPHA-CEN-N     PIC 99.
   620             20  DC-ALPHA-YEAR         PIC 99.
   621         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   622         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   623         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   624         16  DC-JULIAN-DATE            PIC 9(05).
   625         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   626                                       PIC 9(05).
   627         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   628             20  DC-JULIAN-YEAR        PIC 99.
   629             20  DC-JULIAN-DAYS        PIC 999.
   630         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   631         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   632         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   633     12  DATE-CONVERSION-VARIBLES.
   634         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   635         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   636             20  FILLER                PIC 9(3).
   637             20  HOLD-CEN-1-CCYY.
   638                 24  HOLD-CEN-1-CC     PIC 99.
   639                 24  HOLD-CEN-1-YY     PIC 99.
   640             20  HOLD-CEN-1-MO         PIC 99.
   641             20  HOLD-CEN-1-DA         PIC 99.
   642         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   643             20  HOLD-CEN-1-R-MO       PIC 99.
   644             20  HOLD-CEN-1-R-DA       PIC 99.
   645             20  HOLD-CEN-1-R-CCYY.
   646                 24  HOLD-CEN-1-R-CC   PIC 99.
   647                 24  HOLD-CEN-1-R-YY   PIC 99.
   648             20  FILLER                PIC 9(3).
   649         16  HOLD-CENTURY-1-X.
   650             20  FILLER                PIC X(3)  VALUE SPACES.
   651             20  HOLD-CEN-1-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  13
* EL201.cbl
   652                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   653                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   654             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   655             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   656         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   657             20  HOLD-CEN-1-R-X-MO     PIC XX.
   658             20  HOLD-CEN-1-R-X-DA     PIC XX.
   659             20  HOLD-CEN-1-R-X-CCYY.
   660                 24  HOLD-CEN-1-R-X-CC PIC XX.
   661                 24  HOLD-CEN-1-R-X-YY PIC XX.
   662             20  FILLER                PIC XXX.
   663         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   664         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   665         16  DC-JULIAN-DATE-1          PIC 9(07).
   666         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   667             20  DC-JULIAN-1-CCYY.
   668                 24  DC-JULIAN-1-CC    PIC 99.
   669                 24  DC-JULIAN-1-YR    PIC 99.
   670             20  DC-JULIAN-DA-1        PIC 999.
   671         16  DC-JULIAN-DATE-2          PIC 9(07).
   672         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   673             20  DC-JULIAN-2-CCYY.
   674                 24  DC-JULIAN-2-CC    PIC 99.
   675                 24  DC-JULIAN-2-YR    PIC 99.
   676             20  DC-JULIAN-DA-2        PIC 999.
   677         16  DC-GREG-DATE-A-EDIT.
   678             20  DC-EDITA-MONTH        PIC 99.
   679             20  SLASHA-1              PIC X VALUE '/'.
   680             20  DC-EDITA-DAY          PIC 99.
   681             20  SLASHA-2              PIC X VALUE '/'.
   682             20  DC-EDITA-CCYY.
   683                 24  DC-EDITA-CENT     PIC 99.
   684                 24  DC-EDITA-YEAR     PIC 99.
   685         16  DC-GREG-DATE-B-EDIT.
   686             20  DC-EDITB-MONTH        PIC 99.
   687             20  SLASHB-1              PIC X VALUE '/'.
   688             20  DC-EDITB-DAY          PIC 99.
   689             20  SLASHB-2              PIC X VALUE '/'.
   690             20  DC-EDITB-CCYY.
   691                 24  DC-EDITB-CENT     PIC 99.
   692                 24  DC-EDITB-YEAR     PIC 99.
   693         16  DC-GREG-DATE-CYMD         PIC 9(08).
   694         16  DC-GREG-DATE-CYMD-R REDEFINES
   695                              DC-GREG-DATE-CYMD.
   696             20  DC-CYMD-CEN           PIC 99.
   697             20  DC-CYMD-YEAR          PIC 99.
   698             20  DC-CYMD-MONTH         PIC 99.
   699             20  DC-CYMD-DAY           PIC 99.
   700         16  DC-GREG-DATE-MDCY         PIC 9(08).
   701         16  DC-GREG-DATE-MDCY-R REDEFINES
   702                              DC-GREG-DATE-MDCY.
   703             20  DC-MDCY-MONTH         PIC 99.
   704             20  DC-MDCY-DAY           PIC 99.
   705             20  DC-MDCY-CEN           PIC 99.
   706             20  DC-MDCY-YEAR          PIC 99.
   707    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   708        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   709    12  DC-EL310-DATE                  PIC X(21).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  14
* EL201.cbl
   710    12  FILLER                         PIC X(28).
   711*                                COPY ELCCNTL.
   712******************************************************************
   713*                                                                *
   714*                                                                *
   715*                            ELCCNTL.                            *
   716*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   717*                            VMOD=2.059                          *
   718*                                                                *
   719*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   720*                                                                *
   721*   FILE TYPE = VSAM,KSDS                                        *
   722*   RECORD SIZE = 750  RECFORM = FIXED                           *
   723*                                                                *
   724*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   725*       ALTERNATE INDEX = NONE                                   *
   726*                                                                *
   727*   LOG = YES                                                    *
   728*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   729******************************************************************
   730*                   C H A N G E   L O G
   731*
   732* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   733*-----------------------------------------------------------------
   734*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   735* EFFECTIVE    NUMBER
   736*-----------------------------------------------------------------
   737* 082503                   PEMA  ADD BENEFIT GROUP
   738* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   739* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   740* 092705    2005050300006  PEMA  ADD SPP LEASES
   741* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   742* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   743* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   744* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   745* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   746* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   747* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   748* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   749* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   750* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   751******************************************************************
   752*
   753 01  CONTROL-FILE.
   754     12  CF-RECORD-ID                       PIC XX.
   755         88  VALID-CF-ID                        VALUE 'CF'.
   756
   757     12  CF-CONTROL-PRIMARY.
   758         16  CF-COMPANY-ID                  PIC XXX.
   759         16  CF-RECORD-TYPE                 PIC X.
   760             88  CF-COMPANY-MASTER              VALUE '1'.
   761             88  CF-PROCESSOR-MASTER            VALUE '2'.
   762             88  CF-STATE-MASTER                VALUE '3'.
   763             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   764             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   765             88  CF-CARRIER-MASTER              VALUE '6'.
   766             88  CF-MORTALITY-MASTER            VALUE '7'.
   767             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  15
* EL201.cbl
   768             88  CF-TERMINAL-MASTER             VALUE '9'.
   769             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   770             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   771             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   772             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   773             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   774             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   775             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   776             88  CF-REMINDERS-MASTER            VALUE 'R'.
   777             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   778         16  CF-ACCESS-CD-GENL              PIC X(4).
   779         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   780             20  CF-PROCESSOR               PIC X(4).
   781         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   782             20  CF-STATE-CODE              PIC XX.
   783             20  FILLER                     PIC XX.
   784         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   785             20  FILLER                     PIC XX.
   786             20  CF-HI-BEN-IN-REC           PIC XX.
   787         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   788             20  FILLER                     PIC XXX.
   789             20  CF-CARRIER-CNTL            PIC X.
   790         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   791             20  FILLER                     PIC XX.
   792             20  CF-HI-TYPE-IN-REC          PIC 99.
   793         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   794             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   795                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   796             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   797             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   798         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   799             20  FILLER                     PIC X.
   800             20  CF-CUSTOM-REPORT-NO        PIC 999.
   801         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   802             20  FILLER                     PIC XX.
   803             20  CF-MORTGAGE-PLAN           PIC XX.
   804         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   805
   806     12  CF-LAST-MAINT-DT                   PIC XX.
   807     12  CF-LAST-MAINT-BY                   PIC X(4).
   808     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   809
   810     12  CF-RECORD-BODY                     PIC X(728).
   811
   812
   813****************************************************************
   814*             COMPANY MASTER RECORD                            *
   815****************************************************************
   816
   817     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   818         16  CF-COMPANY-ADDRESS.
   819             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   820             20  CF-CL-IN-CARE-OF           PIC X(30).
   821             20  CF-CL-ADDR-LINE-1          PIC X(30).
   822             20  CF-CL-ADDR-LINE-2          PIC X(30).
   823             20  CF-CL-CITY-STATE           PIC X(30).
   824             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   825             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  16
* EL201.cbl
   826         16  CF-COMPANY-CD                  PIC X.
   827         16  CF-COMPANY-PASSWORD            PIC X(8).
   828         16  CF-SECURITY-OPTION             PIC X.
   829             88  ALL-SECURITY                   VALUE '1'.
   830             88  COMPANY-VERIFY                 VALUE '2'.
   831             88  PROCESSOR-VERIFY               VALUE '3'.
   832             88  NO-SECURITY                    VALUE '4'.
   833             88  ALL-BUT-TERM                   VALUE '5'.
   834         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   835             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   836         16  CF-LGX-INTERFACE-CNTL          PIC X.
   837             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   838         16  CF-INFORCE-LOCATION            PIC X.
   839             88  CERTS-ARE-ONLINE               VALUE '1'.
   840             88  CERTS-ARE-OFFLINE              VALUE '2'.
   841             88  NO-CERTS-AVAILABLE             VALUE '3'.
   842         16  CF-LOWER-CASE-LETTERS          PIC X.
   843         16  CF-CERT-ACCESS-CONTROL         PIC X.
   844             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   845             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   846             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   847             88  CF-ACCNT-CNTL                  VALUE '3'.
   848             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   849
   850         16  CF-FORMS-PRINTER-ID            PIC X(4).
   851         16  CF-CHECK-PRINTER-ID            PIC X(4).
   852
   853         16  CF-LGX-CREDIT-USER             PIC X.
   854             88  CO-IS-NOT-USER                 VALUE 'N'.
   855             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   856
   857         16 CF-CREDIT-CALC-CODES.
   858             20  CF-CR-REM-TERM-CALC PIC X.
   859               88  CR-EARN-AFTER-15TH           VALUE '1'.
   860               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   861               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   862               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   863               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   864               88  CR-EARN-AFTER-14TH           VALUE '6'.
   865               88  CR-EARN-AFTER-16TH           VALUE '7'.
   866             20  CF-CR-R78-METHOD           PIC X.
   867               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   868               88  DONT-USE-PLUS-ONE            VALUE '1'.
   869
   870         16  CF-CLAIM-CONTROL-COUNTS.
   871             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   872                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   873
   874             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   875                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   876
   877             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   878                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   879
   880             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   881                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   882
   883         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  17
* EL201.cbl
   884
   885         16  CF-CO-CALC-QUOTE-TOLERANCE.
   886             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   887             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   888             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   889             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   890                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   891                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   892             20  CF-CO-PREM-REJECT-SW       PIC X.
   893                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   894                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   895             20  CF-CO-REF-REJECT-SW        PIC X.
   896                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   897                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   898
   899         16  CF-CO-REPORTING-DT             PIC XX.
   900         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   901         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   902           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   903           88  CF-CO-MONTH-END                  VALUE '1'.
   904
   905         16  CF-LGX-CLAIM-USER              PIC X.
   906             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   907             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   908
   909         16  CF-CREDIT-EDIT-CONTROLS.
   910             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   911             20  CF-MIN-AGE                 PIC 99.
   912             20  CF-DEFAULT-AGE             PIC 99.
   913             20  CF-MIN-TERM                PIC S999      COMP-3.
   914             20  CF-MAX-TERM                PIC S999      COMP-3.
   915             20  CF-DEFAULT-SEX             PIC X.
   916             20  CF-JOINT-AGE-INPUT         PIC X.
   917                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   918             20  CF-BIRTH-DATE-INPUT        PIC X.
   919                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   920             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   921                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   922                 88  CF-ZERO-CARRIER            VALUE '1'.
   923                 88  CF-ZERO-GROUPING           VALUE '2'.
   924                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   925             20  CF-EDIT-SW                 PIC X.
   926                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   927             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   928             20  CF-CR-PR-METHOD            PIC X.
   929               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   930               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   931             20  FILLER                     PIC X.
   932
   933         16  CF-CREDIT-MISC-CONTROLS.
   934             20  CF-REIN-TABLE-SW           PIC X.
   935                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   936             20  CF-COMP-TABLE-SW           PIC X.
   937                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   938             20  CF-EXPERIENCE-RETENTION-AGE
   939                                            PIC S9        COMP-3.
   940             20  CF-CONVERSION-DT           PIC XX.
   941             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  18
* EL201.cbl
   942             20  CF-RUN-FREQUENCY-SW        PIC X.
   943                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   944                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   945
   946             20  CF-CR-CHECK-NO-CONTROL.
   947                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   948                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   949                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   950                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   951                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   952                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   953
   954                 24  CF-CR-CHECK-COUNT       REDEFINES
   955                     CF-CR-CHECK-COUNTER      PIC X(4).
   956
   957                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
   958                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   959
   960                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   961                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   962                 24  CF-MAIL-PROCESSING       PIC X.
   963                     88  MAIL-PROCESSING          VALUE 'Y'.
   964
   965         16  CF-MISC-SYSTEM-CONTROL.
   966             20  CF-SYSTEM-C                 PIC X.
   967                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   968             20  CF-SYSTEM-D                 PIC X.
   969                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   970             20  CF-SOC-SEC-NO-SW            PIC X.
   971                 88  SOC-SEC-NO-USED             VALUE '1'.
   972             20  CF-MEMBER-NO-SW             PIC X.
   973                 88  MEMBER-NO-USED              VALUE '1'.
   974             20  CF-TAX-ID-NUMBER            PIC X(11).
   975             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   976             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   977                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   978                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   979                 88  CF-ALL-APPROVED             VALUE 'Y'.
   980                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   981             20  CF-SYSTEM-E                 PIC X.
   982                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   983
   984         16  CF-LGX-LIFE-USER               PIC X.
   985             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   986             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   987
   988         16  CF-CR-MONTH-END-DT             PIC XX.
   989
   990         16  CF-FILE-MAINT-DATES.
   991             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   992                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   993             20  CF-LAST-BATCH       REDEFINES
   994                 CF-LAST-BATCH-NO               PIC X(4).
   995             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   996             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   997             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   998             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   999             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  19
* EL201.cbl
  1000             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1001             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1002             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1003             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1004             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1005
  1006         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1007         16  FILLER                         PIC X.
  1008
  1009         16  CF-ALT-MORT-CODE               PIC X(4).
  1010         16  CF-MEMBER-CAPTION              PIC X(10).
  1011
  1012         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1013             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1014             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1015             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1016             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1017             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1018
  1019         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1020
  1021         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1022         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1023         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1024         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1025
  1026         16  CF-AH-OVERRIDE-L1              PIC X.
  1027         16  CF-AH-OVERRIDE-L2              PIC XX.
  1028         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1029         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1030
  1031         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1032         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1033
  1034         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1035         16  CF-AR-LAST-EL860-DT            PIC XX.
  1036         16  CF-MP-MONTH-END-DT             PIC XX.
  1037
  1038         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1039         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1040             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1041
  1042         16  CF-AR-MONTH-END-DT             PIC XX.
  1043
  1044         16  CF-CRDTCRD-USER                PIC X.
  1045             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1046             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1047
  1048         16  CF-CC-MONTH-END-DT             PIC XX.
  1049
  1050         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1051
  1052         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1053             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1054             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1055             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1056         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1057         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  20
* EL201.cbl
  1058         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1059         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1060             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1061             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1062         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1063         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1064         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1065             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1066         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1067
  1068         16  CF-CL-ZIP-CODE.
  1069             20  CF-CL-ZIP-PRIME.
  1070                 24  CF-CL-ZIP-1ST          PIC X.
  1071                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1072                 24  FILLER                 PIC X(4).
  1073             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1074         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1075             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1076             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1077             20  FILLER                     PIC XXX.
  1078
  1079         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1080         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1081         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1082         16  CF-CO-OPTION-START-DATE        PIC XX.
  1083         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1084           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1085                                                      '3' '4'.
  1086           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1087           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1088           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1089           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1090           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1091           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1092
  1093         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1094
  1095         16  CF-PAYMENT-APPROVAL-LEVELS.
  1096             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1097             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1098             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1099             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1100             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1101             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1102
  1103         16  CF-END-USER-REPORTING-USER     PIC X.
  1104             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1105             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1106
  1107         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1108             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1109             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1110
  1111         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1112
  1113         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1114         16  FILLER                         PIC X.
  1115
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  21
* EL201.cbl
  1116         16  CF-CREDIT-ARCHIVE-CNTL.
  1117             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1118             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1119             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1120
  1121         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1122
  1123         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1124             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1125             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1126
  1127         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1128             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1129             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1130
  1131         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1132
  1133         16  CF-CO-ACH-ID-CODE              PIC  X.
  1134             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1135             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1136             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1137         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1138         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1139         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1140         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1141         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1142         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1143         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1144         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1145         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1146                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1147         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1148                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1149
  1150         16  CF-CO-OVER-SHORT.
  1151             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1152             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1153
  1154*         16  FILLER                         PIC X(102).
  1155         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1156             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1157             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1158
  1159         16  CF-AH-APPROVAL-DAYS.
  1160             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1161             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1162             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1163             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1164
  1165         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1166
  1167         16  CF-APPROV-LEV-5.
  1168             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1169             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1170             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1171
  1172         16  FILLER                         PIC X(68).
  1173****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  22
* EL201.cbl
  1174*             PROCESSOR/USER RECORD                            *
  1175****************************************************************
  1176
  1177     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1178         16  CF-PROCESSOR-NAME              PIC X(30).
  1179         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1180         16  CF-PROCESSOR-TITLE             PIC X(26).
  1181         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1182                 88  MESSAGE-YES                VALUE 'Y'.
  1183                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1184
  1185*****************************************************
  1186****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1187****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1188****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1189****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1190*****************************************************
  1191
  1192         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1193             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1194             20  CF-APPLICATION-FORCE       PIC X.
  1195             20  CF-INDIVIDUAL-APP.
  1196                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1197                     28  CF-BROWSE-APP      PIC X.
  1198                     28  CF-UPDATE-APP      PIC X.
  1199
  1200         16  CF-CURRENT-TERM-ON             PIC X(4).
  1201         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1202             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1203             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1204             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1205             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1206             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1207             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1208             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1209         16  CF-PROCESSOR-CARRIER           PIC X.
  1210             88  NO-CARRIER-SECURITY            VALUE ' '.
  1211         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1212             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1213         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1214             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1215         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1216             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1217
  1218         16  CF-PROC-SYS-ACCESS-SW.
  1219             20  CF-PROC-CREDIT-CLAIMS-SW.
  1220                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1221                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1222                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1223                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1224             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1225                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1226                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1227             20  CF-PROC-LIFE-GNRLDGR-SW.
  1228                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1229                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1230                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1231                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  23
* EL201.cbl
  1232             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1233                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1234                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1235         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1236             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1237             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1238         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1239
  1240         16  CF-APPROVAL-LEVEL                  PIC X.
  1241             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1242             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1243             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1244             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1245             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1246
  1247         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1248
  1249         16  CF-LANGUAGE-TYPE                   PIC X.
  1250             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1251             88  CF-LANG-IS-FR                      VALUE 'F'.
  1252
  1253         16  CF-CSR-IND                         PIC X.
  1254         16  FILLER                             PIC X(239).
  1255
  1256****************************************************************
  1257*             PROCESSOR/REMINDERS RECORD                       *
  1258****************************************************************
  1259
  1260     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1261         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1262             20  CF-START-REMIND-DT         PIC XX.
  1263             20  CF-END-REMIND-DT           PIC XX.
  1264             20  CF-REMINDER-TEXT           PIC X(50).
  1265         16  FILLER                         PIC X(296).
  1266
  1267
  1268****************************************************************
  1269*             STATE MASTER RECORD                              *
  1270****************************************************************
  1271
  1272     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1273         16  CF-STATE-ABBREVIATION          PIC XX.
  1274         16  CF-STATE-NAME                  PIC X(25).
  1275         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1276         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1277             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1278             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1279             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1280             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1281                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1282                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1283             20  CF-ST-PREM-REJECT-SW       PIC X.
  1284                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1285                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1286             20  CF-ST-REF-REJECT-SW        PIC X.
  1287                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1288                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1289         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  24
* EL201.cbl
  1290         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1291         16  CF-ST-REFUND-RULES.
  1292             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1293             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1294             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1295         16  CF-ST-FST-PMT-EXTENSION.
  1296             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1297             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1298                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1299                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1300                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1301                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1302         16  CF-ST-STATE-CALL.
  1303             20  CF-ST-CALL-UNEARNED        PIC X.
  1304             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1305             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1306         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1307             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1308             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1309         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1310         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1311         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1312         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1313         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1314         16  FILLER                         PIC X.
  1315         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1316             20  CF-ST-BENEFIT-CD           PIC XX.
  1317             20  CF-ST-BENEFIT-KIND         PIC X.
  1318                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1319                 88  CF-ST-AH-KIND              VALUE 'A'.
  1320             20  CF-ST-REM-TERM-CALC        PIC X.
  1321                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1322                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1323                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1324                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1325                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1326                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1327                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1328                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1329
  1330             20  CF-ST-REFUND-CALC          PIC X.
  1331                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1332                 88  ST-REFD-BY-R78             VALUE '1'.
  1333                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1334                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1335                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1336                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1337                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1338                 88  ST-REFD-UTAH               VALUE '7'.
  1339                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1340                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1341                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1342
  1343             20  CF-ST-EARNING-CALC         PIC X.
  1344                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1345                 88  ST-EARN-BY-R78             VALUE '1'.
  1346                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1347                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  25
* EL201.cbl
  1348                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1349                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1350                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1351                 88  ST-EARN-MEAN               VALUE '8'.
  1352                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1353
  1354             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1355                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1356                 88  ST-OVRD-BY-R78             VALUE '1'.
  1357                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1358                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1359                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1360                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1361                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1362                 88  ST-OVRD-MEAN               VALUE '8'.
  1363                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1364             20  cf-st-extra-periods        pic 9.
  1365*            20  FILLER                     PIC X.
  1366
  1367         16  CF-ST-COMMISSION-CAPS.
  1368             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1369             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1370             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1371             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1372         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1373                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1374
  1375         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1376
  1377         16  CF-ST-STATUTORY-INTEREST.
  1378             20  CF-ST-STAT-DATE-FROM       PIC X.
  1379                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1380                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1381             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1382             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1383             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1384             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1385             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1386
  1387         16  CF-ST-OVER-SHORT.
  1388             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1389             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1390
  1391         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1392
  1393         16  CF-ST-RT-CALC                  PIC X.
  1394
  1395         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1396         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1397         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1398         16  CF-ST-RF-LR-CALC               PIC X.
  1399         16  CF-ST-RF-LL-CALC               PIC X.
  1400         16  CF-ST-RF-LN-CALC               PIC X.
  1401         16  CF-ST-RF-AH-CALC               PIC X.
  1402         16  CF-ST-RF-CP-CALC               PIC X.
  1403*        16  FILLER                         PIC X(206).
  1404*CIDMOD         16  FILLER                         PIC X(192).
  1405         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  26
* EL201.cbl
  1406             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1407         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1408         16  CF-ST-VFY-2ND-BENE             PIC X.
  1409         16  CF-ST-CAUSAL-STATE             PIC X.
  1410         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1411         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1412         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1413             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1414         16  CF-ST-NET-ONLY-STATE           PIC X.
  1415             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1416         16  FILLER                         PIC X(181).
  1417
  1418****************************************************************
  1419*             BENEFIT MASTER RECORD                            *
  1420****************************************************************
  1421
  1422     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1423         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1424             20  CF-BENEFIT-CODE            PIC XX.
  1425             20  CF-BENEFIT-NUMERIC  REDEFINES
  1426                 CF-BENEFIT-CODE            PIC XX.
  1427             20  CF-BENEFIT-ALPHA           PIC XXX.
  1428             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1429             20  CF-BENEFIT-COMMENT         PIC X(10).
  1430
  1431             20  CF-LF-COVERAGE-TYPE        PIC X.
  1432                 88  CF-REDUCING                VALUE 'R'.
  1433                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1434
  1435             20  CF-SPECIAL-CALC-CD         PIC X.
  1436                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1437                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1438                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1439                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1440                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1441                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1442                 88  CF-FARM-PLAN               VALUE 'F'.
  1443                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1444                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1445                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1446                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1447                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1448                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1449                 88  CF-PRUDENTIAL              VALUE 'P'.
  1450                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1451                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1452                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1453                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1454                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1455                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1456
  1457             20  CF-JOINT-INDICATOR         PIC X.
  1458                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1459
  1460*            20  FILLER                     PIC X(12).
  1461             20  cf-maximum-benefits        pic s999 comp-3.
  1462             20  FILLER                     PIC X(09).
  1463             20  CF-BENEFIT-CATEGORY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  27
* EL201.cbl
  1464             20  CF-LOAN-TYPE               PIC X(8).
  1465
  1466             20  CF-CO-REM-TERM-CALC        PIC X.
  1467                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1468                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1469                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1470                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1471                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1472
  1473             20  CF-CO-EARNINGS-CALC        PIC X.
  1474                 88  CO-EARN-BY-R78             VALUE '1'.
  1475                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1476                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1477                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1478                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1479                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1480                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1481                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1482
  1483             20  CF-CO-REFUND-CALC          PIC X.
  1484                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1485                 88  CO-REFD-BY-R78             VALUE '1'.
  1486                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1487                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1488                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1489                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1490                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1491                 88  CO-REFD-MEAN               VALUE '8'.
  1492                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1493                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1494                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1495
  1496             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1497                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1498                 88  CO-OVRD-BY-R78             VALUE '1'.
  1499                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1500                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1501                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1502                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1503                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1504                 88  CO-OVRD-MEAN               VALUE '8'.
  1505                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1506
  1507             20  CF-CO-BEN-I-G-CD           PIC X.
  1508                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1509                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1510                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1511
  1512         16  FILLER                         PIC X(304).
  1513
  1514
  1515****************************************************************
  1516*             CARRIER MASTER RECORD                            *
  1517****************************************************************
  1518
  1519     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1520         16  CF-ADDRESS-DATA.
  1521             20  CF-MAIL-TO-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  28
* EL201.cbl
  1522             20  CF-IN-CARE-OF              PIC X(30).
  1523             20  CF-ADDRESS-LINE-1          PIC X(30).
  1524             20  CF-ADDRESS-LINE-2          PIC X(30).
  1525             20  CF-CITY-STATE              PIC X(30).
  1526             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1527             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1528
  1529         16  CF-CLAIM-NO-CONTROL.
  1530             20  CF-CLAIM-NO-METHOD         PIC X.
  1531                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1532                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1533                 88  CLAIM-NO-SEQ               VALUE '3'.
  1534                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1535             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1536                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1537                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1538                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1539
  1540         16  CF-CHECK-NO-CONTROL.
  1541             20  CF-CHECK-NO-METHOD         PIC X.
  1542                 88  CHECK-NO-MANUAL            VALUE '1'.
  1543                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1544                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1545                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1546             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1547                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1548
  1549         16  CF-DOMICILE-STATE              PIC XX.
  1550
  1551         16  CF-EXPENSE-CONTROLS.
  1552             20  CF-EXPENSE-METHOD          PIC X.
  1553                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1554                 88  DOLLARS-PER-PMT            VALUE '2'.
  1555                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1556                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1557             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1558             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1559
  1560         16  CF-CORRESPONDENCE-CONTROL.
  1561             20  CF-LETTER-RESEND-OPT       PIC X.
  1562                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1563                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1564             20  FILLER                     PIC X(4).
  1565
  1566         16  CF-RESERVE-CONTROLS.
  1567             20  CF-MANUAL-SW               PIC X.
  1568                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1569             20  CF-FUTURE-SW               PIC X.
  1570                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1571             20  CF-PTC-SW                  PIC X.
  1572                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1573             20  CF-IBNR-SW                 PIC X.
  1574                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1575             20  CF-PTC-LF-SW               PIC X.
  1576                 88  CF-LF-PTC-USED             VALUE '1'.
  1577             20  CF-CDT-ACCESS-METHOD       PIC X.
  1578                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1579                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  29
* EL201.cbl
  1580                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1581             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1582
  1583         16  CF-CLAIM-CALC-METHOD           PIC X.
  1584             88  360-PLUS-MONTHS                VALUE '1'.
  1585             88  365-PLUS-MONTHS                VALUE '2'.
  1586             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1587             88  360-DAILY                      VALUE '4'.
  1588             88  365-DAILY                      VALUE '5'.
  1589
  1590         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1591         16  FILLER                         PIC X(11).
  1592
  1593         16  CF-LIMIT-AMOUNTS.
  1594             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1595             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1596             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1597             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1598             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1599             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1600             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1601             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1602             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1603             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1604
  1605         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1606         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1607         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1608
  1609         16  CF-ZIP-CODE.
  1610             20  CF-ZIP-PRIME.
  1611                 24  CF-ZIP-1ST             PIC X.
  1612                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1613                 24  FILLER                 PIC X(4).
  1614             20  CF-ZIP-PLUS4               PIC X(4).
  1615         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1616             20  CF-CAN-POSTAL-1            PIC XXX.
  1617             20  CF-CAN-POSTAL-2            PIC XXX.
  1618             20  FILLER                     PIC XXX.
  1619
  1620         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1621         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1622         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1623
  1624         16  CF-RATING-SWITCH               PIC X.
  1625             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1626             88  CF-NO-RATING                   VALUE 'N'.
  1627
  1628         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1629
  1630         16  CF-CARRIER-OVER-SHORT.
  1631             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1632             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1633
  1634         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1635         16  CF-SECPAY-SWITCH               PIC X.
  1636             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1637             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  30
* EL201.cbl
  1638         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1639         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1640         16  FILLER                         PIC X(444).
  1641*        16  FILLER                         PIC X(452).
  1642
  1643
  1644****************************************************************
  1645*             MORTALITY MASTER RECORD                          *
  1646****************************************************************
  1647
  1648     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1649         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1650                                INDEXED BY CF-MORT-NDX.
  1651             20  CF-MORT-TABLE              PIC X(5).
  1652             20  CF-MORT-TABLE-TYPE         PIC X.
  1653                 88  CF-MORT-JOINT              VALUE 'J'.
  1654                 88  CF-MORT-SINGLE             VALUE 'S'.
  1655                 88  CF-MORT-COMBINED           VALUE 'C'.
  1656                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1657                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1658             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1659             20  CF-MORT-AGE-METHOD         PIC XX.
  1660                 88  CF-AGE-LAST                VALUE 'AL'.
  1661                 88  CF-AGE-NEAR                VALUE 'AN'.
  1662             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1663             20  CF-MORT-ADJUSTMENT-DIRECTION
  1664                                            PIC X.
  1665                 88  CF-MINUS                   VALUE '-'.
  1666                 88  CF-PLUS                    VALUE '+'.
  1667             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1668             20  CF-MORT-JOINT-CODE         PIC X.
  1669                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1670             20  CF-MORT-PC-Q               PIC X.
  1671                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1672             20  CF-MORT-TABLE-CODE         PIC X(4).
  1673             20  CF-MORT-COMMENTS           PIC X(15).
  1674             20  FILLER                     PIC X(14).
  1675
  1676         16  FILLER                         PIC X(251).
  1677
  1678
  1679****************************************************************
  1680*             BUSSINESS TYPE MASTER RECORD                     *
  1681****************************************************************
  1682
  1683     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1684* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1685* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1686* AND RECORD 05 IS TYPES 81-99
  1687         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1688             20  CF-BUSINESS-TITLE          PIC  X(19).
  1689             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1690                                            PIC S9V9(4) COMP-3.
  1691             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1692             20  FILLER                     PIC  X.
  1693         16  FILLER                         PIC  X(248).
  1694
  1695
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  31
* EL201.cbl
  1696****************************************************************
  1697*             TERMINAL MASTER RECORD                           *
  1698****************************************************************
  1699
  1700     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1701
  1702         16  CF-COMPANY-TERMINALS.
  1703             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1704                                  PIC X(4).
  1705         16  FILLER               PIC X(248).
  1706
  1707
  1708****************************************************************
  1709*             LIFE EDIT MASTER RECORD                          *
  1710****************************************************************
  1711
  1712     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1713         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1714             20  CF-LIFE-CODE-IN            PIC XX.
  1715             20  CF-LIFE-CODE-OUT           PIC XX.
  1716         16  FILLER                         PIC X(248).
  1717
  1718
  1719****************************************************************
  1720*             AH EDIT MASTER RECORD                            *
  1721****************************************************************
  1722
  1723     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1724         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1725             20  CF-AH-CODE-IN              PIC XXX.
  1726             20  CF-AH-CODE-OUT             PIC XX.
  1727         16  FILLER                         PIC X(248).
  1728
  1729
  1730****************************************************************
  1731*             CREDIBILITY TABLES                               *
  1732****************************************************************
  1733
  1734     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1735         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1736                             INDEXED BY CF-CRDB-NDX.
  1737             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1738             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1739             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1740         16  FILLER                         PIC  X(332).
  1741
  1742
  1743****************************************************************
  1744*             REPORT CUSTOMIZATION RECORD                      *
  1745****************************************************************
  1746
  1747     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1748         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1749             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1750             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1751             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1752**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1753****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  32
* EL201.cbl
  1754             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1755
  1756         16  FILLER                         PIC XX.
  1757
  1758         16  CF-CARRIER-CNTL-OPT.
  1759             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1760                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1761                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1762             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1763                                            PIC X.
  1764         16  CF-GROUP-CNTL-OPT.
  1765             20  CF-GROUP-OPT-SEQ           PIC 9.
  1766                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1767                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1768             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1769                                            PIC X(6).
  1770         16  CF-STATE-CNTL-OPT.
  1771             20  CF-STATE-OPT-SEQ           PIC 9.
  1772                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1773                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1774             20  CF-STATE-SELECT OCCURS 3 TIMES
  1775                                            PIC XX.
  1776         16  CF-ACCOUNT-CNTL-OPT.
  1777             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1778                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1779                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1780             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1781                                            PIC X(10).
  1782         16  CF-BUS-TYP-CNTL-OPT.
  1783             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1784                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1785                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1786             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1787                                            PIC XX.
  1788         16  CF-LF-TYP-CNTL-OPT.
  1789             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1790                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1791                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1792             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1793                                            PIC XX.
  1794         16  CF-AH-TYP-CNTL-OPT.
  1795             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1796                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1797                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1798             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1799                                            PIC XX.
  1800         16  CF-REPTCD1-CNTL-OPT.
  1801             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1802                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1803                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1804             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1805                                            PIC X(10).
  1806         16  CF-REPTCD2-CNTL-OPT.
  1807             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1808                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1809                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1810             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1811                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  33
* EL201.cbl
  1812         16  CF-USER1-CNTL-OPT.
  1813             20  CF-USER1-OPT-SEQ           PIC 9.
  1814                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1815                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1816             20  CF-USER1-SELECT OCCURS 3 TIMES
  1817                                            PIC X(10).
  1818         16  CF-USER2-CNTL-OPT.
  1819             20  CF-USER2-OPT-SEQ           PIC 9.
  1820                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1821                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1822             20  CF-USER2-SELECT OCCURS 3 TIMES
  1823                                            PIC X(10).
  1824         16  CF-USER3-CNTL-OPT.
  1825             20  CF-USER3-OPT-SEQ           PIC 9.
  1826                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1827                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1828             20  CF-USER3-SELECT OCCURS 3 TIMES
  1829                                            PIC X(10).
  1830         16  CF-USER4-CNTL-OPT.
  1831             20  CF-USER4-OPT-SEQ           PIC 9.
  1832                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1833                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1834             20  CF-USER4-SELECT OCCURS 3 TIMES
  1835                                            PIC X(10).
  1836         16  CF-USER5-CNTL-OPT.
  1837             20  CF-USER5-OPT-SEQ           PIC 9.
  1838                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1839                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1840             20  CF-USER5-SELECT OCCURS 3 TIMES
  1841                                            PIC X(10).
  1842         16  CF-REINS-CNTL-OPT.
  1843             20  CF-REINS-OPT-SEQ           PIC 9.
  1844                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1845                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1846             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1847                 24  CF-REINS-PRIME         PIC XXX.
  1848                 24  CF-REINS-SUB           PIC XXX.
  1849
  1850         16  CF-AGENT-CNTL-OPT.
  1851             20  CF-AGENT-OPT-SEQ           PIC 9.
  1852                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1853                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1854             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1855                                            PIC X(10).
  1856
  1857         16  FILLER                         PIC X(43).
  1858
  1859         16  CF-LOSS-RATIO-SELECT.
  1860             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1861             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1862         16  CF-ENTRY-DATE-SELECT.
  1863             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1864             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1865         16  CF-EFFECTIVE-DATE-SELECT.
  1866             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1867             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1868
  1869         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  34
* EL201.cbl
  1870             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1871
  1872         16  FILLER                         PIC X(318).
  1873
  1874****************************************************************
  1875*                  EXCEPTION REPORTING RECORD                  *
  1876****************************************************************
  1877
  1878     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1879         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1880             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1881
  1882         16  CF-COMBINED-LIFE-AH-OPT.
  1883             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1884             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1885             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1886             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1887
  1888         16  CF-LIFE-OPT.
  1889             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1890             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1891             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1892             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1893             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1894             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1895             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1896             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1897             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1898             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1899
  1900         16  CF-AH-OPT.
  1901             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1902             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1903             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1904             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1905             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1906             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1907             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1908             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1909             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1910             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1911
  1912         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1913             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1914             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1915             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1916
  1917         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1918
  1919         16  FILLER                         PIC X(673).
  1920
  1921
  1922****************************************************************
  1923*             MORTGAGE SYSTEM PLAN RECORD                      *
  1924****************************************************************
  1925
  1926     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1927         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  35
* EL201.cbl
  1928             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1929             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1930             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1931         16  CF-PLAN-ABBREV                 PIC XXX.
  1932         16  CF-PLAN-DESCRIPT               PIC X(10).
  1933         16  CF-PLAN-NOTES                  PIC X(20).
  1934         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1935         16  CF-PLAN-UNDERWRITING.
  1936             20  CF-PLAN-TERM-DATA.
  1937                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1938                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1939             20  CF-PLAN-AGE-DATA.
  1940                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1941                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1942                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1943             20  CF-PLAN-BENEFIT-DATA.
  1944                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1945                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1946                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1947                                            PIC S9(7)V99  COMP-3.
  1948         16  CF-PLAN-POLICY-FORMS.
  1949             20  CF-POLICY-FORM             PIC X(12).
  1950             20  CF-MASTER-APPLICATION      PIC X(12).
  1951             20  CF-MASTER-POLICY           PIC X(12).
  1952         16  CF-PLAN-RATING.
  1953             20  CF-RATE-CODE               PIC X(5).
  1954             20  CF-SEX-RATING              PIC X.
  1955                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1956                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1957             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1958             20  CF-SUB-STD-TYPE            PIC X.
  1959                 88  CF-PCT-OF-PREM            VALUE '1'.
  1960                 88  CF-PCT-OF-BENE            VALUE '2'.
  1961         16  CF-PLAN-PREM-TOLERANCES.
  1962             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1963             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1964         16  CF-PLAN-PYMT-TOLERANCES.
  1965             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1966             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1967         16  CF-PLAN-MISC-DATA.
  1968             20  FILLER                     PIC X.
  1969             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1970             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1971         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1972         16  CF-PLAN-IND-GRP                PIC X.
  1973             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1974                                                     '1'.
  1975             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1976                                                     '2'.
  1977         16  CF-MIB-SEARCH-SW               PIC X.
  1978             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1979             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1980             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1981             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1982         16  CF-ALPHA-SEARCH-SW             PIC X.
  1983             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1984             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1985             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  36
* EL201.cbl
  1986             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1987             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1988             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1989             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1990             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1991             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1992             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1993                                                     'A' 'B' 'C'
  1994                                                     'X' 'Y' 'Z'.
  1995         16  CF-EFF-DT-RULE-SW              PIC X.
  1996             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1997             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1998             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1999             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2000             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2001         16  FILLER                         PIC X(4).
  2002         16  CF-HEALTH-QUESTIONS            PIC X.
  2003             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2004         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2005         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2006         16  CF-PLAN-SNGL-JNT               PIC X.
  2007             88  CF-COMBINED-PLAN              VALUE 'C'.
  2008             88  CF-JNT-PLAN                   VALUE 'J'.
  2009             88  CF-SNGL-PLAN                  VALUE 'S'.
  2010         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2011         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2012         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2013         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2014         16  CF-RERATE-CNTL                 PIC  X.
  2015             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2016             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2017             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2018             88  CF-AUTO-RECALC                 VALUE '4'.
  2019         16  CF-BENEFIT-TYPE                PIC  X.
  2020             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2021             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2022         16  CF-POLICY-FEE                  PIC S999V99
  2023                                                    COMP-3.
  2024         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2025         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2026         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2027         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2028         16  FILLER                         PIC  X(32).
  2029         16  CF-TERMINATION-FORM            PIC  X(04).
  2030         16  FILLER                         PIC  X(08).
  2031         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2032                                                       COMP-3.
  2033         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2034         16  CF-ISSUE-LETTER                PIC  X(4).
  2035         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2036         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2037             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2038             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2039         16  CF-MP-REFUND-CALC              PIC X.
  2040             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2041             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2042             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2043             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  37
* EL201.cbl
  2044             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2045             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2046             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2047             88  CF-MP-REFD-MEAN                VALUE '8'.
  2048         16  CF-ALT-RATE-CODE               PIC  X(5).
  2049
  2050
  2051         16  FILLER                         PIC X(498).
  2052****************************************************************
  2053*             MORTGAGE COMPANY MASTER RECORD                   *
  2054****************************************************************
  2055
  2056     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2057         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2058         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2059             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2060             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2061             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2062             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2063             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2064
  2065         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2066         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2067         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2068         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2069         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2070
  2071         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2072             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2073         16  CF-MP-RECON-USE-IND            PIC X(1).
  2074             88  CF-MP-USE-RECON             VALUE 'Y'.
  2075         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2076             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2077         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2078             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2079             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2080         16  FILLER                         PIC X(1).
  2081         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2082             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2083         16  CF-MORTG-MIB-VERSION           PIC X.
  2084             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2085             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2086             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2087         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2088             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2089                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2090             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2091                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2092             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2093                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2094             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2095                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2096             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2097                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2098             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2099                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2100         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2101         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  38
* EL201.cbl
  2102         16  CF-MORTG-DESTINATION-SYMBOL.
  2103             20  CF-MORTG-MIB-COMM          PIC X(5).
  2104             20  CF-MORTG-MIB-TERM          PIC X(5).
  2105         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2106             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2107         16  FILLER                         PIC X(03).
  2108         16  CF-MP-CHECK-NO-CONTROL.
  2109             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2110                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2111                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2112                                                ' ' LOW-VALUES.
  2113                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2114                                               VALUE '3'.
  2115         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2116         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2117         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2118             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2119                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2120             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2121                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2122             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2123                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2124             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2125                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2126             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2127                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2128             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2129                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2130         16  CF-MORTG-BILLING-AREA.
  2131             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2132                                            PIC X.
  2133         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2134         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2135         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2136         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2137             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2138             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2139         16  FILLER                         PIC X.
  2140         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2141             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2142             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2143         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2144         16  FILLER                         PIC X(8).
  2145         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2146         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2147         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2148         16  CF-ACH-COMPANY-ID.
  2149             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2150                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2151                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2152                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2153             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2154         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2155             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2156         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2157             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2158             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2159         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  39
* EL201.cbl
  2160         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2161         16  FILLER                         PIC X(536).
  2162
  2163****************************************************************
  2164*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2165****************************************************************
  2166
  2167     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2168         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2169             20  CF-FEMALE-HEIGHT.
  2170                 24  CF-FEMALE-FT           PIC 99.
  2171                 24  CF-FEMALE-IN           PIC 99.
  2172             20  CF-FEMALE-MIN-WT           PIC 999.
  2173             20  CF-FEMALE-MAX-WT           PIC 999.
  2174         16  FILLER                         PIC X(428).
  2175
  2176     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2177         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2178             20  CF-MALE-HEIGHT.
  2179                 24  CF-MALE-FT             PIC 99.
  2180                 24  CF-MALE-IN             PIC 99.
  2181             20  CF-MALE-MIN-WT             PIC 999.
  2182             20  CF-MALE-MAX-WT             PIC 999.
  2183         16  FILLER                         PIC X(428).
  2184******************************************************************
  2185*             AUTOMATIC ACTIVITY RECORD                          *
  2186******************************************************************
  2187     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2188         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2189             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2190             20  CF-SYS-LETTER-ID           PIC X(04).
  2191             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2192             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2193             20  CF-SYS-RESET-SW            PIC X(01).
  2194             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2195             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2196
  2197         16  FILLER                         PIC X(50).
  2198
  2199         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2200             20  CF-USER-ACTIVE-SW          PIC X(01).
  2201             20  CF-USER-LETTER-ID          PIC X(04).
  2202             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2203             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2204             20  CF-USER-RESET-SW           PIC X(01).
  2205             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2206             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2207             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2208
  2209         16  FILLER                         PIC X(246).
  2210 01  ws-heading1.
  2211     05  ws-head1                pic x(120)  value '
  2212-     '                                   DAILY CHECK RECONCILIATI
  2213-     'ON                                            '.
  2214     05  ws-h1-rpt-id            pic x(6)  value 'EL201A'.
  2215 01  ws-heading2.
  2216     05  filler                  pic x(51) value spaces.
  2217     05  WS-H2-CLIENT-NAME       PIC X(59) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  40
* EL201.cbl
  2218     05  WS-H2-DATE              PIC X(10).
  2219     05  ws-h2-time              pic x(8).
  2220 01  ws-heading3.
  2221     05  filler                  pic x(53) value spaces.
  2222     05  WS-H3-DATE              PIC X(67) VALUE SPACES.
  2223     05  FILLER                  PIC X(5)  VALUE 'PAGE '.
  2224     05  WS-H3-PAGE              PIC ZZ,ZZ9.
  2225 01  ws-heading4.
  2226     05  filler                  pic x(117)   value ' CAR  GROUP
  2227-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2228-        '  CHECK CASHED DT   PREPARER   AMOUNT    MESSAGE'.
  2229 01  ws-hd1-written.
  2230     05  filler                  pic x(120)  value '
  2231-     '                                   DAILY WRITTEN CHECKS REP
  2232-     'ORT                                           '.
  2233 01  ws-hd4-written.
  2234     05  filler                  pic x(117)   value ' CAR  GROUP
  2235-        'ST   ACCOUNT    EFF DTE       CERT NO    TYPE   CHECK NO
  2236-        '  CHECK WRITTEN DT  PREPARER   AMOUNT    MESSAGE'.
  2237 01  ws-detail1.
  2238     05  filler                  pic xx value '  '.
  2239     05  ws-d1-carr              pic x(4) value spaces.
  2240     05  ws-d1-grp               pic x(7) value spaces.
  2241     05  ws-d1-state             pic x(4) value spaces.
  2242     05  ws-d1-account           pic x(12) value spaces.
  2243     05  ws-d1-eff-dt            pic x(12) value spaces.
  2244     05  ws-d1-cert-no           pic x(14) value spaces.
  2245     05  ws-d1-chk-type          pic x(5) value spaces.
  2246     05  ws-d1-chk-no            pic x(12) value spaces.
  2247     05  f                       pic xx value spaces.
  2248     05  ws-d1-writ-cash-dt      pic x(16) value spaces.
  2249     05  ws-d1-preparer          pic x(8) value spaces.
  2250     05  ws-d1-chk-amt-a         pic x(10) value spaces.
  2251     05  ws-d1-chk-amt redefines
  2252         ws-d1-chk-amt-a         pic $$$,$$9.99.
  2253     05  filler                  pic xx value spaces.
  2254     05  ws-d1-message           pic x(20) value spaces.
  2255 01  ws-detail2.
  2256     05  filler                  pic x(12) value '    PAYEE - '.
  2257     05  ws-d2-addr-line         pic x(120) value spaces.
  2258 01  ws-total1.
  2259     05  filler                  pic x(5) value '     '.
  2260     05  ws-t1-cnt               pic zzzz9  value zeros.
  2261     05  ws-t1-chks              pic x(24)  value spaces.
  2262     05  ws-t1-amount            pic $$,$$$,$$9.99 value zeros.
  2263 01  w-doctoken                  pic x(16).
  2264 01 output-data.
  2265    05  filler                   pic x(6) value "TITLE=".
  2266    05  output-title             pic x(26) value 'Check Posting'.
  2267    05  filler                   pic x(8) value "&COMPID=".
  2268    05  out-comp-id              pic xxx.
  2269    05  filler                   pic x(5) value "&MSG=".
  2270    05  output-msg               pic x(50).
  2271 01  tran-data-line1             pic x(80) value spaces.
  2272 01  tran-data-line2             pic x(80) value spaces.
  2273* 01  TRAN-DATA-LINE1             PIC X(80)    VALUE
  2274**    'cd /apps/prod/cid1p/jcl'.
  2275*      'cd /apps/test/ahltst/jcl'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  41
* EL201.cbl
  2276* 01  TRAN-DATA-LINE2.
  2277*     05  filler                  pic x(10) value 'unikixjob '.
  2278*     05  tdl2-job                pic x(8) value 'cilg201b'.
  2279**    05  filler                  pic x(9) value ' -k cid1p'.
  2280*     05  filler                  pic x(10) value ' -k ahltst'.
  2281*     05  filler                  pic x(50) value spaces.
  2282****************************************************************
  2283*
  2284* Copyright (c) 2007 by Clerity Solutions, Inc.
  2285* All rights reserved.
  2286*
  2287****************************************************************
  2288 01  DFHEIV.
  2289   02  DFHEIV0               PIC X(35).
  2290   02  DFHEIV1               PIC X(08).
  2291   02  DFHEIV2               PIC X(08).
  2292   02  DFHEIV3               PIC X(08).
  2293   02  DFHEIV4               PIC X(06).
  2294   02  DFHEIV5               PIC X(04).
  2295   02  DFHEIV6               PIC X(04).
  2296   02  DFHEIV7               PIC X(02).
  2297   02  DFHEIV8               PIC X(02).
  2298   02  DFHEIV9               PIC X(01).
  2299   02  DFHEIV10              PIC S9(7) COMP-3.
  2300   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2301   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2302   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2303   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2304   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2305   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2306   02  DFHEIV17              PIC X(04).
  2307   02  DFHEIV18              PIC X(04).
  2308   02  DFHEIV19              PIC X(04).
  2309   02  DFHEIV20              USAGE IS POINTER.
  2310   02  DFHEIV21              USAGE IS POINTER.
  2311   02  DFHEIV22              USAGE IS POINTER.
  2312   02  DFHEIV23              USAGE IS POINTER.
  2313   02  DFHEIV24              USAGE IS POINTER.
  2314   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2315   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2316   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2317   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2318   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2319   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2320   02  FILLER                PIC X(02).
  2321   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2322   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2323   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2324   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2325   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2326 LINKAGE  SECTION.
  2327*****************************************************************
  2328*                                                               *
  2329* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2330* All rights reserved.                                          *
  2331*                                                               *
  2332*****************************************************************
  2333 01  dfheiblk.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  42
* EL201.cbl
  2334     02  eibtime          pic s9(7) comp-3.
  2335     02  eibdate          pic s9(7) comp-3.
  2336     02  eibtrnid         pic x(4).
  2337     02  eibtaskn         pic s9(7) comp-3.
  2338     02  eibtrmid         pic x(4).
  2339     02  dfheigdi         pic s9(4) comp.
  2340     02  eibcposn         pic s9(4) comp.
  2341     02  eibcalen         pic s9(4) comp.
  2342     02  eibaid           pic x(1).
  2343     02  eibfiller1       pic x(1).
  2344     02  eibfn            pic x(2).
  2345     02  eibfiller2       pic x(2).
  2346     02  eibrcode         pic x(6).
  2347     02  eibfiller3       pic x(2).
  2348     02  eibds            pic x(8).
  2349     02  eibreqid         pic x(8).
  2350     02  eibrsrce         pic x(8).
  2351     02  eibsync          pic x(1).
  2352     02  eibfree          pic x(1).
  2353     02  eibrecv          pic x(1).
  2354     02  eibsend          pic x(1).
  2355     02  eibatt           pic x(1).
  2356     02  eibeoc           pic x(1).
  2357     02  eibfmh           pic x(1).
  2358     02  eibcompl         pic x(1).
  2359     02  eibsig           pic x(1).
  2360     02  eibconf          pic x(1).
  2361     02  eiberr           pic x(1).
  2362     02  eibrldbk         pic x(1).
  2363     02  eiberrcd         pic x(4).
  2364     02  eibsynrb         pic x(1).
  2365     02  eibnodat         pic x(1).
  2366     02  eibfiller5       pic x(2).
  2367     02  eibresp          pic 9(09) comp.
  2368     02  eibresp2         pic 9(09) comp.
  2369     02  dfheigdj         pic s9(4) comp.
  2370     02  dfheigdk         pic s9(4) comp.
  2371 01  DFHCOMMAREA       PIC X(01).
  2372 01  VAR                         PIC X(30).
  2373 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  2374 0000-DFHEXIT SECTION.
  2375     MOVE '9#                    $   ' TO DFHEIV0.
  2376     MOVE 'EL201' TO DFHEIV1.
  2377     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2378***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2379***                                                            ***
  2380***  Even though this program is using WEB Servies we don't    ***
  2381***  have any form fields to browse through, we are getting    ***
  2382***  the information we need through the variables that are    ***
  2383***  included in the URL. These variables are retrieved by     ***
  2384***  the           exec cics web extract                       ***
  2385***                   querystring  (data-value)                ***
  2386***                   querystrlen  (data-value)                ***
  2387***                end-exec                                    ***
  2388***  BTW, you must provide the length it isn't passed to you.  ***
  2389***  Allow for extra on the length or you will get a length    ***
  2390***  error instead of just truncation.                         ***
  2391***                                                            ***
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  43
* EL201.cbl
  2392***  This program is expecting                                 ***
  2393*** http://slunikix:7001/cics/cwba/EL201?comp=CID&file=written***
  2394*** http://slunikix:7003/cics/cwba/EL201?comp=CID&file=written***
  2395*** http://logictest:6007/cics/cwba/EL201?comp=CID&file=written***
  2396***                                                            ***
  2397***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2398     set P to address of KIXSYS
  2399     CALL "getenv" using by value P returning var-ptr
  2400     if var-ptr = null then
  2401        display ' kixsys not set '
  2402     else
  2403        set address of var to var-ptr
  2404        move 0 to env-var-len
  2405        inspect var tallying env-var-len
  2406          for characters before X'00'
  2407        unstring var (1:env-var-len) delimited by '/'
  2408           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  2409              WS-KIX-SYS
  2410        end-unstring
  2411     end-if
  2412     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2413     move ws-fn-cymd             to dc-greg-date-cymd
  2414     move 'L'                    to dc-option-code
  2415     perform 9700-date-convert   thru 9700-exit
  2416     if no-conversion-error
  2417        move dc-greg-date-1-alpha to ws-h3-date
  2418        move dc-greg-date-1-edit to ws-h2-date
  2419     else
  2420        display ' error current dt invalid ' dc-error-code
  2421     end-if
  2422     string ws-fn-hours   ':'
  2423            ws-fn-minutes ':'
  2424            ws-fn-seconds
  2425        delimited by size into ws-h2-time
  2426     end-string
  2427
  2428* exec cics web extract
  2429*       querystring  (ws-qry-string)
  2430*       querystrlen  (ws-qrystr-len)
  2431*    end-exec
  2432*    MOVE 'X0  QL                .   #00002330' TO DFHEIV0
  2433     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  2434     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  2435     MOVE X'2020233030303032333330' TO DFHEIV0(25:11)
  2436     CALL 'kxdfhei1' USING DFHEIV0,
  2437           DFHEIV99,
  2438           DFHEIV99,
  2439           ws-qry-string,
  2440           ws-qrystr-len,
  2441           DFHEIV99,
  2442           DFHEIV99,
  2443           DFHEIV99,
  2444           DFHEIV99,
  2445           DFHEIV99,
  2446           DFHEIV99,
  2447           DFHEIV99,
  2448           DFHEIV99,
  2449           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  44
* EL201.cbl
  2450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2451     move ws-qry-string (6:3)    to ws-comp-id
  2452                                    out-comp-id
  2453     move 'Successful Run   '    to output-msg
  2454     move ws-comp-id             to elcntl-key
  2455     move '1'                    to elcntl-rec-type
  2456     move +0                     to elcntl-seq
  2457
  2458* exec cics read
  2459*       dataset  ('ELCNTL')
  2460*       into     (control-file)
  2461*       ridfld   (elcntl-key)
  2462*       resp     (ws-response)
  2463*    end-exec
  2464     MOVE LENGTH OF
  2465      control-file
  2466       TO DFHEIV11
  2467     MOVE 'ELCNTL' TO DFHEIV1
  2468*    MOVE '&"IL       E          (  N#00002340' TO DFHEIV0
  2469     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2470     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2471     MOVE X'204E233030303032333430' TO DFHEIV0(25:11)
  2472     CALL 'kxdfhei1' USING DFHEIV0,
  2473           DFHEIV1,
  2474           control-file,
  2475           DFHEIV11,
  2476           elcntl-key,
  2477           DFHEIV99,
  2478           DFHEIV99,
  2479           DFHEIV99
  2480     MOVE EIBRESP  TO ws-response
  2481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2482     if resp-normal
  2483        move cf-cl-mail-to-name  to ws-h2-client-name
  2484        move cf-company-cd       to ws-comp-cd
  2485     else
  2486        move 'Company Rec not found ' to ws-h2-client-name
  2487                                         output-msg
  2488        display ' error elcntl read ' ws-response ' '
  2489           elcntl-key (1:8)
  2490        go to 0000-return
  2491     end-if
  2492     evaluate true
  2493        when ws-qry-string (15:7) = 'written' or 'WRITTEN'
  2494           set process-written      to true
  2495           perform 2000-process-written
  2496                                 thru 2000-exit
  2497        when other
  2498           move 'Invalid File ' to output-msg
  2499     end-evaluate
  2500     if connected-to-db
  2501        EXEC SQL
  2502            commit work release
  2503        END-EXEC
  2504        if sqlcode not = 0
  2505           move ' Failed to Commit DB '
  2506                                 to output-msg
  2507           display "Error: commit release "
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  45
* EL201.cbl
  2508           display ' sql return code ' sqlcode
  2509           display ' sql err mess    ' sqlerrmc
  2510        end-if
  2511     end-if
  2512     .
  2513 0000-return.
  2514     perform 1030-send-form      thru 1030-exit
  2515
  2516* exec cics
  2517*       return
  2518*    end-exec
  2519*    MOVE '.(                    ''   #00002379' TO DFHEIV0
  2520     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2521     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2522     MOVE X'2020233030303032333739' TO DFHEIV0(25:11)
  2523     CALL 'kxdfhei1' USING DFHEIV0,
  2524           DFHEIV99,
  2525           DFHEIV99,
  2526           DFHEIV99,
  2527           DFHEIV99,
  2528           DFHEIV99,
  2529           DFHEIV99
  2530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2531     .
  2532 1000-CONNECT-DB.
  2533     string
  2534         usr delimited space
  2535         "." delimited size
  2536         pass delimited space into usr-pass
  2537     end-string
  2538     EXEC SQL
  2539        CONNECT TO :svr USER :usr-pass
  2540     END-EXEC
  2541     if sqlcode not = 0
  2542        display "Error: cannot connect "
  2543        display sqlcode
  2544        display sqlerrmc
  2545        move 'Failed to connect to DB'
  2546                                 to output-msg
  2547        go to 0000-return
  2548     else
  2549        set connected-to-db to true
  2550     end-if
  2551     .
  2552 1000-EXIT.
  2553     EXIT.
  2554 1020-read-erchek.
  2555     move ws-comp-cd             to ch-company-cd
  2556     move db-carrier             to ch-carrier
  2557     move db-grouping            to ch-grouping
  2558     move db-state               to ch-state
  2559     move db-account             to ch-account
  2560     move db-certificate         to ch-cert-prime
  2561     move db-cert-sfx            to ch-cert-sfx
  2562     string db-effdate (1:4)
  2563            db-effdate (6:2)
  2564            db-effdate (9:2)
  2565        delimited by size into dc-greg-date-cymd-r
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  46
* EL201.cbl
  2566     end-string
  2567     move 'L'                    to dc-option-code
  2568     perform 9700-date-convert   thru 9700-exit
  2569     if no-conversion-error
  2570        move dc-bin-date-1       to ch-cert-eff-dt
  2571     else
  2572        display ' error cvtdte eff dt ' db-effdate ' '
  2573           dc-error-code
  2574     end-if
  2575     move zeros                  to ws-seq-alpha
  2576     move +5                     to s2
  2577     perform varying s1 from +5 by -1 until s1 < +1
  2578        if db-seq-no (s1:1) numeric
  2579           move db-seq-no (s1:1) to ws-seq-alpha (s2:1)
  2580           subtract +1 from s2
  2581        end-if
  2582     end-perform
  2583     move ws-seq-no-num          to ch-sequence-no
  2584*    display ' dte   **' db-effdate '**'
  2585*    display ' carrier ' ch-carrier
  2586*    display ' group   ' ch-grouping
  2587*    display ' state   ' ch-state
  2588*    display ' acct    ' ch-account
  2589*    display ' cert  **' ch-cert-no '**'
  2590*    display ' seq     ' ch-sequence-no
  2591
  2592* exec cics read
  2593*       update
  2594*       dataset    ('ERCHEK')
  2595*       into       (check-records)
  2596*       ridfld     (ch-control-primary)
  2597*       resp       (ws-response)
  2598*    end-exec
  2599     MOVE LENGTH OF
  2600      check-records
  2601       TO DFHEIV11
  2602     MOVE 'ERCHEK' TO DFHEIV1
  2603*    MOVE '&"IL       EU         (  N#00002442' TO DFHEIV0
  2604     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2605     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2606     MOVE X'204E233030303032343432' TO DFHEIV0(25:11)
  2607     CALL 'kxdfhei1' USING DFHEIV0,
  2608           DFHEIV1,
  2609           check-records,
  2610           DFHEIV11,
  2611           ch-control-primary,
  2612           DFHEIV99,
  2613           DFHEIV99,
  2614           DFHEIV99
  2615     MOVE EIBRESP  TO ws-response
  2616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2617     .
  2618 1020-exit.
  2619     exit.
  2620 1030-send-form.
  2621
  2622* exec cics document create
  2623*       doctoken   (w-doctoken)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  47
* EL201.cbl
  2624*       template   ('WCHECKS')
  2625*       symbollist (output-data)
  2626*       listlength (length of output-data)
  2627*    end-exec
  2628     MOVE 'WCHECKS'
  2629      TO DFHEIVL0
  2630     MOVE LENGTH OF
  2631      output-data TO DFHEIV16
  2632*    MOVE '\"D tSL               )   #00002453' TO DFHEIV0
  2633     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  2634     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2635     MOVE X'2020233030303032343533' TO DFHEIV0(25:11)
  2636     CALL 'kxdfhei1' USING DFHEIV0,
  2637           w-doctoken,
  2638           DFHEIV99,
  2639           DFHEIVL0,
  2640           output-data,
  2641           DFHEIV16,
  2642           DFHEIV99,
  2643           DFHEIV99,
  2644           DFHEIV99
  2645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2646
  2647* exec cics web send
  2648*       doctoken(w-doctoken)
  2649*    end-exec
  2650*    MOVE 'X$D                   *   #00002459' TO DFHEIV0
  2651     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  2652     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  2653     MOVE X'2020233030303032343539' TO DFHEIV0(25:11)
  2654     CALL 'kxdfhei1' USING DFHEIV0,
  2655           w-doctoken,
  2656           DFHEIV99,
  2657           DFHEIV99,
  2658           DFHEIV99,
  2659           DFHEIV99,
  2660           DFHEIV99,
  2661           DFHEIV99,
  2662           DFHEIV99,
  2663           DFHEIV99
  2664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2665     .
  2666 1030-exit.
  2667     exit.
  2668 1050-disconnect.
  2669     if connected-to-db
  2670        EXEC SQL
  2671            disconnect all
  2672        END-EXEC
  2673        move ' ' to ws-connect-sw
  2674     end-if
  2675     .
  2676 1050-exit.
  2677     exit.
  2678 2000-process-written.
  2679     perform 2010-open-files     thru 2010-exit
  2680     perform 2020-init           thru 2020-exit
  2681     perform 2050-process-input  thru 2050-exit until
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  48
* EL201.cbl
  2682        end-of-input
  2683     if ws-writ-cnt > zeros
  2684        move ws-writ-cnt         to ws-t1-cnt
  2685        move ' Written '         to ws-t1-chks
  2686        move ws-tot-writ-amt     to ws-t1-amount
  2687     else
  2688        perform 4010-write-headings
  2689                                 thru 4010-exit
  2690        move spaces              to ws-total1
  2691        string ' No checks for '
  2692           ws-work-comp-id
  2693           ' today. ' delimited by size into ws-total1
  2694        end-string
  2695     end-if
  2696     move spaces                 to cps-written-rpt-rec
  2697     perform 4020-write-a-line   thru 4020-exit
  2698     move ws-total1              to cps-written-rpt-rec
  2699     perform 4020-write-a-line   thru 4020-exit
  2700     perform 2500-close-files    thru 2500-exit
  2701     perform 5000-submit-job     thru 5000-exit
  2702     .
  2703 2000-exit.
  2704     exit.
  2705 2010-open-files.
  2706     if ws-kix-myenv = 'cid1p'
  2707        move 'NTCSO2_ChkApprv'   to svr
  2708        move 'sa'                to usr
  2709        move 'ntcso2'            to pass
  2710        move '/data/seqfiles/'   to ws-work-dir
  2711        move 'cd /apps/prod/cid1p/jcl'
  2712                                 to tran-data-line1
  2713     else
  2714        move 'NTSQLTST2_Logic'   to svr
  2715        move 'sa'                to usr
  2716        move 'sql2008r2'         to pass
  2717        move ws-kix-myenv        to ws-work-env
  2718        string
  2719           '/data/test/' delimited by size
  2720           ws-work-env   delimited by space
  2721           '/seqfiles/'  delimited by size
  2722              into ws-work-dir
  2723        end-string
  2724        string
  2725           'cd /apps/test/' delimited by size
  2726           ws-work-env      delimited by space
  2727           '/jcl'           delimited by size
  2728              into tran-data-line1
  2729        end-string
  2730     end-if
  2731     move function upper-case(ws-comp-id)
  2732                                 to ws-work-comp-id
  2733     move 'miscpymts.csv'        to ws-work-file-in
  2734     move 'cilg201b'             to ws-work-job-name
  2735     if ws-work-comp-id = 'AHL'
  2736        move 'miscpymtsahl.csv'  to ws-work-file-in
  2737        move 'ahlg201b'          to ws-work-job-name
  2738     end-if
  2739     move spaces                 to ws-written-in
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  49
* EL201.cbl
  2740                                    ws-written-rpt
  2741     string
  2742        ws-work-dir delimited by space
  2743        ws-work-file-in delimited by space
  2744           into ws-written-in
  2745     end-string
  2746     move 'miscpymts.rpt'        to ws-work-rpt-out
  2747     string
  2748        ws-work-dir delimited by space
  2749        ws-work-comp-id delimited by size
  2750        ws-work-rpt-out delimited by size
  2751           into ws-written-rpt
  2752     end-string
  2753     string
  2754        'unikixjob '     delimited by size
  2755        ws-work-job-name delimited by size
  2756        ' -k '           delimited by size
  2757        ws-work-env      delimited by space
  2758           into tran-data-line2
  2759     end-string
  2760*     display ' svr    ' svr
  2761*     display ' user   ' usr
  2762*     display ' pw     ' pass
  2763*     display ' input  ' ws-written-in
  2764*     display ' output ' ws-written-rpt
  2765*     display '        '
  2766*     display ' line 1 ' tran-data-line1
  2767*     display ' line 2 ' tran-data-line2
  2768     open input CPS-WRITTEN-IN
  2769         output CPS-WRITTEN-RPT
  2770     if written-status not = '00'
  2771        display 'error written open ' written-status
  2772        move ' Invalid or missing file '
  2773                                 to output-msg
  2774        go to 0000-return
  2775     end-if
  2776     .
  2777 2010-exit.
  2778     exit.
  2779 2020-init.
  2780     move spaces                 to ws-detail1
  2781     move ws-hd1-written         to ws-head1
  2782     move 'EL201B'               to ws-h1-rpt-id
  2783     move ws-hd4-written         to ws-heading4
  2784     move 'Posting of Written Checks '
  2785                                 to output-title
  2786*    if ws-comp-id = 'AHL'
  2787*       move 'ahlg201b'          to tdl2-job
  2788*    else
  2789*       move 'cilg201b'          to tdl2-job
  2790*    end-if
  2791     if not connected-to-db
  2792        perform 1000-connect-db  thru 1000-exit
  2793     end-if
  2794***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2795***                                                            ***
  2796**     I do 2 reads to bypass the header record                ***
  2797***                                                            ***
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  50
* EL201.cbl
  2798***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2799     perform 2040-read-input     thru 2040-exit
  2800     perform 2040-read-input     thru 2040-exit
  2801     .
  2802 2020-exit.
  2803     exit.
  2804 2040-read-input.
  2805     read CPS-WRITTEN-IN at end
  2806        set end-of-input   to true
  2807     end-read
  2808     if not end-of-input
  2809        add 1 to ws-in-recs
  2810     end-if
  2811     .
  2812 2040-exit.
  2813     exit.
  2814 2050-process-input.
  2815     move spaces                 to ws-raw-record
  2816                                    ws-written-rec
  2817     unstring cps-written-in-rec
  2818        delimited by ',' into
  2819           raw-check-no
  2820           raw-check-dt
  2821           raw-check-amt
  2822           raw-vendor-id
  2823           raw-user-defined
  2824           raw-voucher-ref
  2825     end-unstring
  2826*    display ' chk no    **' wsw-check-no '**'
  2827*    display ' chk dt    **' wsw-check-dt '**'
  2828*    display ' chk amt   **' wsw-check-amt '**'
  2829*    display ' vend id   **' wsw-vendor-id '**'
  2830*    display ' user def  **' wsw-user-defined '**'
  2831*    display ' vouch ref **' wsw-voucher-ref '**'
  2832***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2833***                                                            ***
  2834***    Every now and then I get bogus records with quotes      ***
  2835***  so I am just going to remove them.  These are normally    ***
  2836***  a result of a manual process that should not be included  ***
  2837***  in this file.                                             ***
  2838***                                                            ***
  2839***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2840
  2841     move +1                     to o1
  2842     perform varying i1 from +1 by +1 until i1 > +20
  2843        if raw-check-no (i1:1) <> '"'
  2844           move raw-check-no (i1:1)
  2845                                 to wsw-check-no (o1:1)
  2846           add +1 to o1
  2847        end-if
  2848     end-perform
  2849
  2850     move +1                     to o1
  2851     perform varying i1 from +1 by +1 until i1 > +20
  2852        if raw-check-dt (i1:1) <> '"'
  2853           move raw-check-dt (i1:1)
  2854                                 to wsw-check-dt (o1:1)
  2855           add +1 to o1
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  51
* EL201.cbl
  2856        end-if
  2857     end-perform
  2858
  2859     move +1                     to o1
  2860     perform varying i1 from +1 by +1 until i1 > +15
  2861        if raw-check-amt (i1:1) <> '"'
  2862           move raw-check-amt (i1:1)
  2863                                 to wsw-check-amt (o1:1)
  2864           add +1 to o1
  2865        end-if
  2866     end-perform
  2867
  2868     move +1                     to o1
  2869     perform varying i1 from +1 by +1 until i1 > +20
  2870        if raw-vendor-id (i1:1) <> '"'
  2871           move raw-vendor-id (i1:1)
  2872                                 to wsw-vendor-id (o1:1)
  2873           add +1 to o1
  2874        end-if
  2875     end-perform
  2876
  2877     move +1                     to o1
  2878     perform varying i1 from +1 by +1 until i1 > +30
  2879        if raw-user-defined (i1:1) <> '"'
  2880           move raw-user-defined (i1:1)
  2881                                 to wsw-user-defined (o1:1)
  2882           add +1 to o1
  2883        end-if
  2884     end-perform
  2885
  2886     move +1                     to o1
  2887     perform varying i1 from +1 by +1 until i1 > +35
  2888        if raw-voucher-ref (i1:1) <> '"'
  2889           move raw-voucher-ref (i1:1)
  2890                                 to wsw-voucher-ref (o1:1)
  2891           add +1 to o1
  2892        end-if
  2893     end-perform
  2894     if (wsw-check-no = spaces)
  2895        and (wsw-check-dt = spaces)
  2896        and (wsw-check-amt = spaces)
  2897        display ' empty record ' cps-written-in-rec
  2898        go to 2050-read
  2899     end-if
  2900     string wsw-check-dt (1:4)
  2901            wsw-check-dt (6:2)
  2902            wsw-check-dt (9:2)
  2903        delimited by size into dc-greg-date-cymd-r
  2904     end-string
  2905     move 'L'                    to dc-option-code
  2906     perform 9700-date-convert   thru 9700-exit
  2907     if no-conversion-error
  2908        move dc-bin-date-1       to ws-bin-check-dt
  2909     else
  2910        display ' error cvtdte chek dt ' wsw-check-dt ' '
  2911           dc-error-code
  2912     end-if
  2913     perform varying s1 from +1 by +1 until
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  52
* EL201.cbl
  2914        (s1 > +28)
  2915        or (wsw-voucher-ref (s1:6) = 'REF DI' or 'REFUND' or
  2916          'CANCEL')
  2917     end-perform
  2918     if s1 < +29
  2919        move 'Bypass- Manual Entry'    to ws-d1-message
  2920        move ' '                 to ws-table-sw
  2921        go to 2050-continue
  2922     end-if
  2923*    if wsw-user-defined (1:3) not numeric
  2924*       move 'Bypass- Manual Entry'
  2925*                                to ws-d1-message
  2926*       move ' '                 to ws-table-sw
  2927*       go to 2050-continue
  2928*    end-if
  2929     perform varying s1 from +1 by +1 until
  2930        (s1 > +30)
  2931        or (wsw-user-defined (s1:1) = ' ')
  2932     end-perform
  2933     if (s1 < +12)
  2934        and (s1 > +8)
  2935        continue
  2936     else
  2937        move 'Bypass- Manual Entry'
  2938                                 to ws-d1-message
  2939        move ' '                 to ws-table-sw
  2940        go to 2050-continue
  2941     end-if
  2942     move spaces                 to wsw-check-key
  2943     perform varying s1 from +30 by -1 until
  2944        (s1 < +1)
  2945        or (wsw-user-defined (s1:1) numeric)
  2946     end-perform
  2947     if s1 > +7
  2948        move wsw-user-defined (s1 - 6:7)
  2949                                 to wsw-check-key
  2950     else
  2951        move 'Invalid Input CK-KEY'    to ws-d1-message
  2952        go to 2050-continue
  2953     end-if
  2954*    go to 2050-read
  2955     move ' '                    to ws-erchek-sw
  2956                                    ws-table-sw
  2957     perform 2200-get-tbl-row    thru 2200-exit
  2958     if sqlcode = 0
  2959        set table-found          to true
  2960        perform 1020-read-erchek thru 1020-exit
  2961        if resp-normal
  2962           set erchek-found to true
  2963           perform 2310-upd-erchek
  2964                                 thru 2310-exit
  2965           perform 2320-upd-table thru 2320-exit
  2966        else
  2967           display ' erchek not fnd ' ch-carrier ' ' ch-state ' '
  2968              ch-account ' ' db-effdate (1:10) ' ' db-certificate
  2969              ' ' ws-response
  2970           move ' chk rec not found ' to ws-d1-message
  2971        end-if
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  53
* EL201.cbl
  2972     else
  2973        move ' tbl row not found ' to ws-d1-message
  2974     end-if
  2975     .
  2976 2050-continue.
  2977     perform 2400-build-print-line thru 2400-exit
  2978     .
  2979 2050-read.
  2980     perform 2040-read-input     thru 2040-exit
  2981     .
  2982 2050-exit.
  2983     exit.
  2984 2200-get-tbl-row.
  2985***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  2986***                                                            ***
  2987***  I'm only expecting one row so no cursor is declared       ***
  2988***                                                            ***
  2989***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  2990     move ws-comp-id             to ws-compid
  2991     move wsw-check-key-num      to ws-check-key
  2992     move 1                      to ws-type
  2993     exec sql
  2994        SELECT
  2995           CheckKey,
  2996           Company,
  2997           CertCarrier,
  2998           CertGroup,
  2999           CertState,
  3000           CertAccount,
  3001           CertEffDate,
  3002           CertNumber,
  3003           CertNumberSuf,
  3004           CheckSeqNbr,
  3005           CheckType,
  3006           CheckAmount,
  3007           Preparer,
  3008           CheckSubType
  3009        INTO
  3010           :db-checkkey,
  3011           :db-compid,
  3012           :db-carrier,
  3013           :db-grouping,
  3014           :db-state,
  3015           :db-account,
  3016           :db-effdate,
  3017           :db-certificate,
  3018           :db-cert-sfx,
  3019           :db-seq-no,
  3020           :db-type,
  3021           :db-amount,
  3022           :db-preparer,
  3023           :db-check-sub-type
  3024        FROM
  3025           ChkApp_Check
  3026        WHERE
  3027           (CheckKey    = :ws-check-key)
  3028           and (Company = :ws-compid)
  3029     end-exec
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  54
* EL201.cbl
  3030     if sqlcode not = 0
  3031        move sqlcode to ws-sql-code
  3032        move ws-sql-code to ws-dis-sql-code
  3033        display ' dis sql code ' ws-dis-sql-code
  3034        display "Error: cannot read row "
  3035        display ' sql return code ' sqlcode
  3036        display ' sql err mess    ' sqlerrmc
  3037     end-if
  3038     .
  3039 2200-exit.
  3040     exit.
  3041 2310-upd-erchek.
  3042     move ws-bin-check-dt        to ch-check-written-dt
  3043     if wsw-check-no (1:1) = '"'
  3044        move wsw-check-no (5:7)  to ch-check-no
  3045     else
  3046        move wsw-check-no (4:7)  to ch-check-no
  3047     end-if
  3048*    move zeros                  to ws-response
  3049
  3050* exec cics rewrite
  3051*       dataset     ('ERCHEK')
  3052*       from        (check-records)
  3053*       resp        (ws-response)
  3054*    end-exec
  3055     MOVE LENGTH OF
  3056      check-records
  3057       TO DFHEIV11
  3058     MOVE 'ERCHEK' TO DFHEIV1
  3059*    MOVE '&& L                  %  N#00002846' TO DFHEIV0
  3060     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3061     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3062     MOVE X'204E233030303032383436' TO DFHEIV0(25:11)
  3063     CALL 'kxdfhei1' USING DFHEIV0,
  3064           DFHEIV1,
  3065           check-records,
  3066           DFHEIV11,
  3067           DFHEIV99
  3068     MOVE EIBRESP  TO ws-response
  3069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3070     if resp-normal
  3071        add 1 to ws-writ-cnt
  3072        compute ws-tot-writ-amt =
  3073           ws-tot-writ-amt + ch-amount-paid
  3074        move 'Successful Post '  to ws-d1-message
  3075     else
  3076        move '*** ERROR - NOT POSTED ***' TO ws-d1-message
  3077     end-if
  3078     .
  3079 2310-exit.
  3080     exit.
  3081 2320-upd-table.
  3082     string wsw-check-dt (6:2) '/'
  3083            wsw-check-dt (9:2) '/'
  3084            wsw-check-dt (1:4)
  3085        delimited by size into db-checkdate
  3086     move ch-check-no            to db-checkno
  3087*    move zeros to sqlcode
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  55
* EL201.cbl
  3088     EXEC SQL
  3089        UPDATE
  3090           ChkApp_Check
  3091        SET
  3092           CheckNumber = :db-checkno,
  3093           CheckDate = :db-checkdate
  3094        WHERE
  3095           CheckKey = :db-checkkey
  3096     END-EXEC
  3097     if sqlcode not = 0
  3098        move 'Table not updated ' to ws-d1-message
  3099        display "Error: cannot update table   "
  3100        display ' sql retrun code ' sqlcode
  3101        display ' sql err mess    ' sqlerrmc
  3102     end-if
  3103     .
  3104 2320-exit.
  3105     exit.
  3106 2400-build-print-line.
  3107     if table-found
  3108        move db-carrier          to ws-d1-carr
  3109        move db-grouping         to ws-d1-grp
  3110        move db-state            to ws-d1-state
  3111        move db-account          to ws-d1-account
  3112        string
  3113           db-effdate (6:2)   '/'
  3114           db-effdate (9:2)   '/'
  3115           db-effdate (1:4)
  3116           delimited by size into ws-d1-eff-dt
  3117        end-string
  3118        move db-certificate      to ws-d1-cert-no
  3119        move db-cert-sfx         to ws-d1-cert-no (11:1)
  3120        if db-check-sub-type = '2'
  3121           move 'COR'            to ws-d1-chk-type
  3122        else
  3123           move 'REF'            to ws-d1-chk-type
  3124        end-if
  3125        move +10                 to s2
  3126        move zeros               to ws-work-amt-alpha
  3127        perform varying s1 from +10 by -1 until s1 < +1
  3128           if db-amount (s1:1) numeric
  3129              move db-amount (s1:1)
  3130                                 to ws-work-amt-alpha (s2:1)
  3131              subtract +1 from s2
  3132           end-if
  3133        end-perform
  3134        move ws-work-amt-num     to ws-d1-chk-amt
  3135        move db-preparer         to ws-d1-preparer
  3136        move db-checkno          to ws-d1-chk-no
  3137        move db-checkdate        to ws-d1-writ-cash-dt
  3138     else
  3139        move wsw-check-no        to ws-d1-chk-no
  3140     end-if
  3141     perform 4000-write-report   thru 4000-exit
  3142     move spaces                 to ws-detail1
  3143     .
  3144 2400-exit.
  3145     exit.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  56
* EL201.cbl
  3146 2500-close-files.
  3147     close cps-written-in cps-written-rpt
  3148     .
  3149 2500-exit.
  3150     exit.
  3151 4000-write-report.
  3152     if ws-line-cntr > ws-max-lines
  3153        move zeros               to ws-line-cntr
  3154        perform 4010-write-headings thru 4010-exit
  3155     end-if
  3156     move ws-detail1             to cps-written-rpt-rec
  3157     perform 4020-write-a-line   thru 4020-exit
  3158     .
  3159 4000-exit.
  3160     exit.
  3161 4010-write-headings.
  3162     add 1 to ws-page-cntr
  3163     move ws-page-cntr           to ws-h3-page
  3164     move ws-heading1            to cps-written-rpt-rec
  3165     perform 4020-write-a-line   thru 4020-exit
  3166     move ws-heading2            to cps-written-rpt-rec
  3167     perform 4020-write-a-line   thru 4020-exit
  3168     move ws-heading3            to cps-written-rpt-rec
  3169     perform 4020-write-a-line   thru 4020-exit
  3170     move spaces                 to cps-written-rpt-rec
  3171     perform 4020-write-a-line   thru 4020-exit
  3172     move spaces                 to cps-written-rpt-rec
  3173     perform 4020-write-a-line   thru 4020-exit
  3174     move ws-heading4            to cps-written-rpt-rec
  3175     perform 4020-write-a-line   thru 4020-exit
  3176     move spaces                 to cps-written-rpt-rec
  3177     perform 4020-write-a-line   thru 4020-exit
  3178     .
  3179 4010-exit.
  3180     exit.
  3181 4020-write-a-line.
  3182     write cps-written-rpt-rec
  3183     add 1 to ws-line-cntr
  3184     .
  3185 4020-exit.
  3186     exit.
  3187 5000-submit-job.
  3188
  3189* EXEC CICS WRITEQ TD
  3190*       QUEUE ('BTCH')
  3191*       FROM (TRAN-DATA-LINE1)
  3192*       LENGTH (80)
  3193*    END-EXEC
  3194     MOVE 80
  3195       TO DFHEIV11
  3196     MOVE 'BTCH' TO DFHEIV5
  3197*    MOVE '(" L                  &   #00002969' TO DFHEIV0
  3198     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3199     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3200     MOVE X'2020233030303032393639' TO DFHEIV0(25:11)
  3201     CALL 'kxdfhei1' USING DFHEIV0,
  3202           DFHEIV5,
  3203           TRAN-DATA-LINE1,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  57
* EL201.cbl
  3204           DFHEIV11,
  3205           DFHEIV99,
  3206           DFHEIV99
  3207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3208
  3209* EXEC CICS WRITEQ TD
  3210*       QUEUE ('BTCH')
  3211*       FROM (TRAN-DATA-LINE2)
  3212*       LENGTH (80)
  3213*    END-EXEC
  3214     MOVE 80
  3215       TO DFHEIV11
  3216     MOVE 'BTCH' TO DFHEIV5
  3217*    MOVE '(" L                  &   #00002974' TO DFHEIV0
  3218     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
  3219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3220     MOVE X'2020233030303032393734' TO DFHEIV0(25:11)
  3221     CALL 'kxdfhei1' USING DFHEIV0,
  3222           DFHEIV5,
  3223           TRAN-DATA-LINE2,
  3224           DFHEIV11,
  3225           DFHEIV99,
  3226           DFHEIV99
  3227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3228     .
  3229 5000-exit.
  3230     exit.
  3231 9700-DATE-CONVERT.
  3232
  3233* EXEC CICS LINK
  3234*         PROGRAM  ('ELDATCV')
  3235*         COMMAREA (DATE-CONVERSION-DATA)
  3236*         LENGTH   (DC-COMM-LENGTH)
  3237*    END-EXEC.
  3238     MOVE 'ELDATCV' TO DFHEIV1
  3239*    MOVE '."C                   (   #00002983' TO DFHEIV0
  3240     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3242     MOVE X'2020233030303032393833' TO DFHEIV0(25:11)
  3243     CALL 'kxdfhei1' USING DFHEIV0,
  3244           DFHEIV1,
  3245           DATE-CONVERSION-DATA,
  3246           DC-COMM-LENGTH,
  3247           DFHEIV99,
  3248           DFHEIV99,
  3249           DFHEIV99,
  3250           DFHEIV99
  3251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3252
  3253 9700-EXIT.
  3254      EXIT.
  3255
  3256 9999-DFHBACK SECTION.
  3257     MOVE '9%                    "   ' TO DFHEIV0
  3258     MOVE 'EL201' TO DFHEIV1
  3259     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3260     GOBACK.
  3261 9999-DFHEXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  58
* EL201.cbl
  3262     IF DFHEIGDJ EQUAL 0001
  3263         NEXT SENTENCE.
  3264     MOVE '9%                    "   ' TO DFHEIV0
  3265     MOVE 'EL201' TO DFHEIV1
  3266     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3267     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      139676     Code:       10661
