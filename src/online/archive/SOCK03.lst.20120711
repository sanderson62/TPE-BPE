* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   1
* SOCK03.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"SOCK03.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   2
* SOCK03.cbl
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35 environment division.
    36 data division.
    37 working-storage section.
    38 01  DFH-START PIC X(04).
    39*
    40* program buffers
    41*
    42 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    43     88  ALREADY-SENT              VALUE 'Y'.
    44 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    45 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    46     88  ELCERT-FINISHED            VALUE 'Y'.
    47 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    48 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    49     88  ERACCT-FOUND               VALUE 'Y'.
    50 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    51 77 ws-send-msg-size           pic s9(8) comp value 4096.
    52 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    53 77 ws-recv-buf                pic x(4096).
    54 77 ws-send-buf                pic x(4096) VALUE SPACES.
    55 77 ws-recv-total              pic s9(8) comp value 0.
    56 77 ws-recv-left               pic s9(8) comp value 0.
    57 77 ws-seq-num                 pic s9(8) comp value 0.
    58 77 ws-flags                   pic s9(8) comp value 0.
    59 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    60 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    61 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    62 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    63 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    64 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    65 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    66 77 S1                           PIC S999 COMP-3 VALUE +0.
    67 77 S2                           PIC S999 COMP-3 VALUE +0.
    68 77 L1                           PIC S999 COMP-3 VALUE +0.
    69 77 L2                           PIC S999 COMP-3 VALUE +0.
    70 77 F1                           PIC S999 COMP-3 VALUE +0.
    71 77 WS-BUILD-SW                  PIC X.
    72    88  TIME-TO-BUILD               VALUE 'Y'.
    73 77 WS-SAVE-ERACCT               PIC X(2000).
    74 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   3
* SOCK03.cbl
    75 77 WS-STOP-SW                   PIC X  VALUE ' '.
    76    88  TOLD-TO-STOP               VALUE 'Y'.
    77 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    78    88  GET-RATES                    VALUE 'R'.
    79    88  GET-ACT-ACCTS                VALUE 'A'.
    80 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    81 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    82 77 ws-disp-rate                 pic z9.99999.
    83 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    84     88  END-OF-ERCTBL                 VALUE 'Y'.
    85 77  WS-STATUS                   PIC X.
    86 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
    87 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
    88 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
    89 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
    90 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
    91 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
    92 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
    93 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
    94 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
    95 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
    96 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
    97 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
    98     88  WS-ELCERT-FULL             VALUE '1'.
    99     88  WS-ELCERT-NAME             VALUE '2'.
   100     88  WS-ELCERT-CERT-NO          VALUE '3'.
   101     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   102 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   103 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   104     88  I-SAY-TO-STOP      VALUE 'Y'.
   105 77  WS-HEX-0A                   PIC X.
   106 77  WS-CALL-TYPE                PIC X(6).
   107 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   108 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   109 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   110 01  WS-STRING-DATA.
   111     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   112     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   113     05  WS-CARRIER              PIC X        VALUE SPACES.
   114     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   115     05  WS-STATE                PIC XX       VALUE SPACES.
   116     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   117     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   118     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   119     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
   120     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   121     05  WS-MID-INIT             PIC X        VALUE SPACES.
   122     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   123     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   124     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   125     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   126     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   127     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   128     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   129     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   130     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   131     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   132     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   4
* SOCK03.cbl
   133     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   134     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   135     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   136     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   137     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   138     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   139     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   140     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   141     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   142     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   143     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   144     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   145     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   146     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   147     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   148     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   149     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   150     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   151     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   152     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   153     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   154     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   155     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   156     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   157     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   158     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   159 01  ws-work-date.
   160     05  ws-work-ccyy            pic x(4).
   161     05  ws-work-mm              pic xx.
   162     05  ws-work-dd              pic xx.
   163 01  ws-work-date-num redefines ws-work-date
   164                                 pic 9(8).
   165 01  FILLER.
   166     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   167     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   168     12  WS-STATE-ABBREVIATION   PIC XX.
   169     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   170     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   171     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   172     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   173     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   174     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   175     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   176     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   177     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   178     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   179     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   180     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   181     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   182     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   183     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   184     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   185     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   186     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   187     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   188     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   189     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   190     12  WS-LF-OVERRIDE-L1       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   5
* SOCK03.cbl
   191     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   192     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   193     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   194     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   195         88  WS-REDUCING                         VALUE 'R'.
   196         88  WS-LEVEL                            VALUE 'L'  'P'.
   197 01  ELMSTR-KEY.
   198     12  ELMSTR-COMP-CD          PIC X.
   199     12  ELMSTR-CERT-NO          PIC X(11).
   200 01  WS-AM3-KEY.
   201     12  WS-AM3-ACCOUNT          PIC X(10).
   202     12  WS-AM3-EXP-DT           PIC XX.
   203 01  WS-AM-KEY.
   204     12  WS-AM-COMPANY-CD        PIC X.
   205     12  WS-AM-CARRIER           PIC X.
   206     12  WS-AM-GROUPING          PIC X(6).
   207     12  WS-AM-STATE             PIC XX.
   208     12  WS-AM-ACCOUNT           PIC X(10).
   209     12  WS-AM-EXPIRATION-DT     PIC XX.
   210     12  WS-AM-FILLER            PIC XXXX.
   211 01  WS-CO-DATA.
   212     05  WS-CO-NUM               PIC X(10).
   213     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   214     05  WS-CO-NAME              PIC X(30).
   215     05  WS-CO-MAIL-NAME         PIC X(30).
   216     05  WS-CO-ADDR1             PIC X(30).
   217     05  WS-CO-ADDR2             PIC X(30).
   218     05  WS-CO-ADDR3             PIC X(30).
   219     05  WS-CO-ZIP               PIC X(9).
   220     05  WS-CO-PHONE             PIC X(10).
   221 01  WS-CF-KEY.
   222     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   223     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   224*        88  COMPANY-MASTER                      VALUE '1'.
   225*        88  STATE-MASTER                        VALUE '3'.
   226*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   227*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   228     12  WS-CF-ACCESS.
   229         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   230         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   231             20  FILLER          PIC  X(01).
   232             20  WS-CF-CARRIER   PIC  X(01).
   233     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   234 01  WS-CM-KEY.
   235     05  WS-CM-COMPANY-CD        PIC X.
   236     05  WS-CM-CARRIER           PIC X.
   237     05  WS-CM-GROUP             PIC X(6).
   238     05  WS-CM-STATE             PIC XX.
   239     05  WS-CM-ACCOUNT           PIC X(10).
   240     05  WS-CM-EFF-DT            PIC XX.
   241     05  WS-CM-CERT-NO           PIC X(11).
   242 01  WS-CM-KEY-A1.
   243     05  WS-CM-COMPANY-CD-A1     PIC X.
   244     05  WS-CM-LAST-NAME         PIC X(15).
   245     05  WS-CM-INITIALS          PIC XX.
   246 01  WS-CM-KEY-A4.
   247     05  WS-CM-COMPANY-CD-A4     PIC X.
   248     05  WS-CM-CERT-NO-A4        PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   6
* SOCK03.cbl
   249 01  WS-CID-NO                   PIC X(8).
   250 01  WS-DISP-RESP                PIC 9(5).
   251 01  WS-RESPONSE                 PIC S9(8)   COMP.
   252     88  RESP-NORMAL                  VALUE +00.
   253     88  RESP-NOTFND                  VALUE +13.
   254     88  RESP-DUPKEY                  VALUE +15.
   255     88  RESP-NOTOPEN                 VALUE +19.
   256     88  RESP-ENDFILE                 VALUE +20.
   257*                                 COPY ELCCERT.
   258******************************************************************
   259*                                                                *
   260*                            ELCCERT.                            *
   261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   262*                            VMOD=2.013                          *
   263*                                                                *
   264*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   265*                                                                *
   266*   FILE TYPE = VSAM,KSDS                                        *
   267*   RECORD SIZE = 450  RECFORM = FIXED                           *
   268*                                                                *
   269*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   270*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   271*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   272*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   273*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   274*                                                                *
   275*   LOG = YES                                                    *
   276*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   277******************************************************************
   278*                   C H A N G E   L O G
   279*
   280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   281*-----------------------------------------------------------------
   282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   283* EFFECTIVE    NUMBER
   284*-----------------------------------------------------------------
   285* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   286* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   287* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   288* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   289* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   290* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   291* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   292******************************************************************
   293
   294 01  CERTIFICATE-MASTER.
   295     12  CM-RECORD-ID                      PIC XX.
   296         88  VALID-CM-ID                      VALUE 'CM'.
   297
   298     12  CM-CONTROL-PRIMARY.
   299         16  CM-COMPANY-CD                 PIC X.
   300         16  CM-CARRIER                    PIC X.
   301         16  CM-GROUPING.
   302             20  CM-GROUPING-PREFIX        PIC X(3).
   303             20  CM-GROUPING-PRIME         PIC X(3).
   304         16  CM-STATE                      PIC XX.
   305         16  CM-ACCOUNT.
   306             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   7
* SOCK03.cbl
   307             20  CM-ACCOUNT-PRIME          PIC X(6).
   308         16  CM-CERT-EFF-DT                PIC XX.
   309         16  CM-CERT-NO.
   310             20  CM-CERT-PRIME             PIC X(10).
   311             20  CM-CERT-SFX               PIC X.
   312
   313     12  CM-CONTROL-BY-NAME.
   314         16  CM-COMPANY-CD-A1              PIC X.
   315         16  CM-INSURED-LAST-NAME          PIC X(15).
   316         16  CM-INSURED-INITIALS.
   317             20  CM-INSURED-INITIAL1       PIC X.
   318             20  CM-INSURED-INITIAL2       PIC X.
   319
   320     12  CM-CONTROL-BY-SSN.
   321         16  CM-COMPANY-CD-A2              PIC X.
   322         16  CM-SOC-SEC-NO.
   323             20  CM-SSN-STATE              PIC XX.
   324             20  CM-SSN-ACCOUNT            PIC X(6).
   325             20  CM-SSN-LN3.
   326                 25  CM-INSURED-INITIALS-A2.
   327                     30 CM-INSURED-INITIAL1-A2   PIC X.
   328                     30 CM-INSURED-INITIAL2-A2   PIC X.
   329                 25 CM-PART-LAST-NAME-A2         PIC X.
   330
   331     12  CM-CONTROL-BY-CERT-NO.
   332         16  CM-COMPANY-CD-A4              PIC X.
   333         16  CM-CERT-NO-A4                 PIC X(11).
   334
   335     12  CM-CONTROL-BY-MEMB.
   336         16  CM-COMPANY-CD-A5              PIC X.
   337         16  CM-MEMBER-NO.
   338             20  CM-MEMB-STATE             PIC XX.
   339             20  CM-MEMB-ACCOUNT           PIC X(6).
   340             20  CM-MEMB-LN4.
   341                 25  CM-INSURED-INITIALS-A5.
   342                     30 CM-INSURED-INITIAL1-A5   PIC X.
   343                     30 CM-INSURED-INITIAL2-A5   PIC X.
   344                 25 CM-PART-LAST-NAME-A5         PIC XX.
   345
   346     12  CM-INSURED-PROFILE-DATA.
   347         16  CM-INSURED-FIRST-NAME.
   348             20  CM-INSURED-1ST-INIT       PIC X.
   349             20  FILLER                    PIC X(9).
   350         16  CM-INSURED-ISSUE-AGE          PIC 99.
   351         16  CM-INSURED-SEX                PIC X.
   352             88  CM-SEX-MALE                  VALUE 'M'.
   353             88  CM-SEX-FEMAL                 VALUE 'F'.
   354         16  CM-INSURED-JOINT-AGE          PIC 99.
   355         16  CM-JOINT-INSURED-NAME.
   356             20  CM-JT-LAST-NAME           PIC X(15).
   357             20  CM-JT-FIRST-NAME.
   358                 24  CM-JT-1ST-INIT        PIC X.
   359                 24  FILLER                PIC X(9).
   360             20  CM-JT-INITIAL             PIC X.
   361
   362     12  CM-LIFE-DATA.
   363         16  CM-LF-BENEFIT-CD              PIC XX.
   364         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   8
* SOCK03.cbl
   365         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   366         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   367         16  CM-LF-DEV-CODE                PIC XXX.
   368         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   369         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   370         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   371         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   372         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   373         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   374         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   375         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   376         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   377         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   378         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   379         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   380         16  FILLER                        PIC XX.
   381
   382     12  CM-AH-DATA.
   383         16  CM-AH-BENEFIT-CD              PIC XX.
   384         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   385         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   386         16  CM-AH-DEV-CODE                PIC XXX.
   387         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   388         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   389         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   390         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   391         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   392         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   393         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   394         16  CM-AH-PAID-THRU-DT            PIC XX.
   395             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   396         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   397         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   398         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   399         16  FILLER                        PIC X.
   400
   401     12  CM-LOAN-INFORMATION.
   402         16  CM-LIVES                      PIC S9(7)     COMP-3.
   403         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   404                                           PIC S9(5)V99  COMP-3.
   405         16  CM-BILLED                     PIC S9(7)     COMP-3.
   406         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   407         16  CM-PAY-FREQUENCY              PIC S99.
   408         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   409         16  CM-RATE-CLASS                 PIC XX.
   410         16  CM-BENEFICIARY                PIC X(25).
   411         16  CM-POLICY-FORM-NO             PIC X(12).
   412         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   413         16  CM-LAST-ADD-ON-DT             PIC XX.
   414         16  CM-DEDUCTIBLE-AMOUNTS.
   415             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   416             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   417         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   418             20  CM-RESIDENT-STATE         PIC XX.
   419             20  CM-RATE-CODE              PIC X(4).
   420             20  FILLER                    PIC XX.
   421         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   422             20  CM-LOAN-OFFICER           PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page   9
* SOCK03.cbl
   423             20  FILLER                    PIC XXX.
   424         16  CM-CSR-CODE                   PIC XXX.
   425         16  CM-UNDERWRITING-CODE          PIC X.
   426             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   427         16  CM-POST-CARD-IND              PIC X.
   428         16  CM-NH-INTERFACE-SW            PIC X.
   429         16  CM-PREMIUM-TYPE               PIC X.
   430             88  CM-SING-PRM                  VALUE '1'.
   431             88  CM-O-B-COVERAGE              VALUE '2'.
   432             88  CM-OPEN-END                  VALUE '3'.
   433         16  CM-IND-GRP-TYPE               PIC X.
   434             88  CM-INDIVIDUAL                VALUE 'I'.
   435             88  CM-GROUP                     VALUE 'G'.
   436         16  CM-SKIP-CODE                  PIC X.
   437             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   438             88  SKIP-JULY                    VALUE '1'.
   439             88  SKIP-AUGUST                  VALUE '2'.
   440             88  SKIP-SEPTEMBER               VALUE '3'.
   441             88  SKIP-JULY-AUG                VALUE '4'.
   442             88  SKIP-AUG-SEPT                VALUE '5'.
   443             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   444             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   445             88  SKIP-JUNE                    VALUE '8'.
   446             88  SKIP-JUNE-JULY               VALUE '9'.
   447             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   448             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   449         16  CM-PAYMENT-MODE               PIC X.
   450             88  PAY-MONTHLY                  VALUE SPACE.
   451             88  PAY-WEEKLY                   VALUE '1'.
   452             88  PAY-SEMI-MONTHLY             VALUE '2'.
   453             88  PAY-BI-WEEKLY                VALUE '3'.
   454             88  PAY-SEMI-ANUALLY             VALUE '4'.
   455         16  CM-LOAN-NUMBER                PIC X(8).
   456         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   457         16  CM-OLD-LOF                    PIC XXX.
   458*        16  CM-LOAN-OFFICER               PIC XXX.
   459         16  CM-REIN-TABLE                 PIC XXX.
   460         16  CM-SPECIAL-REIN-CODE          PIC X.
   461         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   462         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   463         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   464
   465     12  CM-STATUS-DATA.
   466         16  CM-ENTRY-STATUS               PIC X.
   467         16  CM-ENTRY-DT                   PIC XX.
   468
   469         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   470         16  CM-LF-CANCEL-DT               PIC XX.
   471         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   472
   473         16  CM-LF-STATUS-AT-DEATH         PIC X.
   474         16  CM-LF-DEATH-DT                PIC XX.
   475         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   476
   477         16  CM-LF-CURRENT-STATUS          PIC X.
   478             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   479                                                'M' '4' '5' '9'.
   480             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  10
* SOCK03.cbl
   481             88  CM-LF-POLICY-PENDING         VALUE '2'.
   482             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   483             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   484             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   485             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   486             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   487             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   488             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   489             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   490             88  CM-LF-DECLINED               VALUE 'D'.
   491             88  CM-LF-VOIDED                 VALUE 'V'.
   492
   493         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   494         16  CM-AH-CANCEL-DT               PIC XX.
   495         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   496
   497         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   498         16  CM-AH-SETTLEMENT-DT           PIC XX.
   499         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   500
   501         16  CM-AH-CURRENT-STATUS          PIC X.
   502             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   503                                                'M' '4' '5' '9'.
   504             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   505             88  CM-AH-POLICY-PENDING         VALUE '2'.
   506             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   507             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   508             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   509             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   510             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   511             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   512             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   513             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   514             88  CM-AH-DECLINED               VALUE 'D'.
   515             88  CM-AH-VOIDED                 VALUE 'V'.
   516
   517         16  CM-CLAIM-INTERFACE-SW         PIC X.
   518             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   519             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   520             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   521         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   522
   523         16  CM-ENTRY-BATCH                PIC X(6).
   524         16  CM-LF-EXIT-BATCH              PIC X(6).
   525         16  CM-AH-EXIT-BATCH              PIC X(6).
   526         16  CM-LAST-MONTH-END             PIC XX.
   527
   528     12  CM-NOTE-SW                        PIC X.
   529         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   530         88  CERT-NOTES-PRESENT               VALUE '1'.
   531         88  BILLING-NOTES-PRESENT            VALUE '2'.
   532         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   533         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   534         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   535         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   536         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   537     12  CM-COMP-EXCP-SW                   PIC X.
   538         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  11
* SOCK03.cbl
   539         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   540     12  CM-INSURED-ADDRESS-SW             PIC X.
   541         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   542         88  INSURED-ADDR-PRESENT             VALUE '1'.
   543
   544*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   545     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   546     12  FILLER                            PIC X.
   547
   548*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   549     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   550     12  FILLER                            PIC X.
   551*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   552     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   553
   554     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   555         88  CERT-ADDED-BATCH                 VALUE ' '.
   556         88  CERT-ADDED-ONLINE                VALUE '1'.
   557         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   558         88  CERT-PURGED-OFFLINE              VALUE '3'.
   559         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   560     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   561         88  CERT-AS-LOADED                   VALUE ' '.
   562         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   563         88  CERT-CLAIM-ONLINE                VALUE '2'.
   564         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   565         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   566         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   567         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   568         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   569
   570     12  CM-ACCOUNT-COMM-PCTS.
   571         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   572         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   573
   574     12  CM-USER-FIELD                     PIC X.
   575     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   576     12  CM-CLP-STATE                      PIC XX.
   577     12  CM-USER-RESERVED                  PIC XXX.
   578******************************************************************
   579*                                 COPY ELCMSTR.
   580******************************************************************
   581*                                                                *
   582*                            ELCMSTR.                            *
   583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   584*                            VMOD=2.012                          *
   585*                                                                *
   586*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   587*                                                                *
   588*   FILE TYPE = VSAM,KSDS                                        *
   589*   RECORD SIZE = 350  RECFORM = FIXED                           *
   590*                                                                *
   591*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   592*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   593*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   594*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   595*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   596*                                                 RKP=75,LEN=21  *
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  12
* SOCK03.cbl
   597*                                                                *
   598*   **** NOTE ****                                               *
   599*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   600*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   601*                                                                *
   602*   LOG = YES                                                    *
   603*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   604******************************************************************
   605*                   C H A N G E   L O G
   606*
   607* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   608*-----------------------------------------------------------------
   609*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   610* EFFECTIVE    NUMBER
   611*-----------------------------------------------------------------
   612* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   613* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   614******************************************************************
   615 01  CLAIM-MASTER.
   616     12  CL-RECORD-ID                PIC XX.
   617         88  VALID-CL-ID         VALUE 'CL'.
   618
   619     12  CL-CONTROL-PRIMARY.
   620         16  CL-COMPANY-CD           PIC X.
   621         16  CL-CARRIER              PIC X.
   622         16  CL-CLAIM-NO             PIC X(7).
   623         16  CL-CERT-NO.
   624             20  CL-CERT-PRIME       PIC X(10).
   625             20  CL-CERT-SFX         PIC X.
   626
   627     12  CL-CONTROL-BY-NAME.
   628         16  CL-COMPANY-CD-A1        PIC X.
   629         16  CL-INSURED-LAST-NAME    PIC X(15).
   630         16  CL-INSURED-NAME.
   631             20  CL-INSURED-1ST-NAME PIC X(12).
   632             20  CL-INSURED-MID-INIT PIC X.
   633
   634     12  CL-CONTROL-BY-SSN.
   635         16  CL-COMPANY-CD-A2        PIC X.
   636         16  CL-SOC-SEC-NO.
   637             20  CL-SSN-STATE        PIC XX.
   638             20  CL-SSN-ACCOUNT      PIC X(6).
   639             20  CL-SSN-LN3          PIC X(3).
   640
   641     12  CL-CONTROL-BY-CERT-NO.
   642         16  CL-COMPANY-CD-A4        PIC X.
   643         16  CL-CERT-NO-A4.
   644             20  CL-CERT-A4-PRIME    PIC X(10).
   645             20  CL-CERT-A4-SFX      PIC X.
   646
   647     12  CL-CONTROL-BY-CCN.
   648         16  CL-COMPANY-CD-A5        PIC X.
   649         16  CL-CCN-A5.
   650             20  CL-CCN.
   651                 24  CL-CCN-PREFIX-A5 PIC X(4).
   652                 24  CL-CCN-PRIME-A5 PIC X(12).
   653             20  CL-CCN-FILLER-A5    PIC X(4).
   654
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  13
* SOCK03.cbl
   655     12  CL-INSURED-PROFILE-DATA.
   656         16  CL-INSURED-BIRTH-DT     PIC XX.
   657         16  CL-INSURED-SEX-CD       PIC X.
   658             88  INSURED-IS-MALE        VALUE 'M'.
   659             88  INSURED-IS-FEMALE      VALUE 'F'.
   660             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   661         16  CL-INSURED-OCC-CD       PIC X(6).
   662         16  FILLER                  PIC X(5).
   663
   664     12  CL-PROCESSING-INFO.
   665         16  CL-PROCESSOR-ID         PIC X(4).
   666         16  CL-CLAIM-STATUS         PIC X.
   667             88  CLAIM-IS-OPEN          VALUE 'O'.
   668             88  CLAIM-IS-CLOSED        VALUE 'C'.
   669         16  CL-CLAIM-TYPE           PIC X.
   670*            88  AH-CLAIM               VALUE 'A'.
   671*            88  LIFE-CLAIM             VALUE 'L'.
   672*            88  PROPERTY-CLAIM         VALUE 'P'.
   673*            88  IUI-CLAIM              VALUE 'I'.
   674*            88  GAP-CLAIM              VALUE 'G'.
   675         16  CL-CLAIM-PREM-TYPE      PIC X.
   676             88  SINGLE-PREMIUM         VALUE '1'.
   677             88  O-B-COVERAGE           VALUE '2'.
   678             88  OPEN-END-COVERAGE      VALUE '3'.
   679         16  CL-INCURRED-DT          PIC XX.
   680         16  CL-REPORTED-DT          PIC XX.
   681         16  CL-FILE-ESTABLISH-DT    PIC XX.
   682         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   683         16  CL-LAST-PMT-DT          PIC XX.
   684         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   685         16  CL-PAID-THRU-DT         PIC XX.
   686         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   687         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   688         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   689         16  CL-PMT-CALC-METHOD      PIC X.
   690             88  CL-360-DAY-YR          VALUE '1'.
   691             88  CL-365-DAY-YR          VALUE '2'.
   692             88  CL-FULL-MONTHS         VALUE '3'.
   693         16  CL-CAUSE-CD             PIC X(6).
   694
   695         16  CL-PRIME-CERT-NO.
   696             20  CL-PRIME-CERT-PRIME PIC X(10).
   697             20  CL-PRIME-CERT-SFX   PIC X.
   698
   699         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   700             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   701             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   702
   703         16  CL-MICROFILM-NO         PIC X(10).
   704         16  CL-PROG-FORM-TYPE       PIC X.
   705         16  CL-LAST-ADD-ON-DT       PIC XX.
   706
   707         16  CL-LAST-REOPEN-DT       PIC XX.
   708         16  CL-LAST-CLOSE-DT        PIC XX.
   709         16  CL-LAST-CLOSE-REASON    PIC X(01).
   710             88  FINAL-PAID             VALUE '1'.
   711             88  CLAIM-DENIED           VALUE '2'.
   712             88  AUTO-CLOSE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  14
* SOCK03.cbl
   713             88  MANUAL-CLOSE           VALUE '4'.
   714             88  BENEFITS-CHANGED       VALUE 'C'.
   715             88  SETUP-ERRORS           VALUE 'E'.
   716         16  CL-ASSOC-CERT-SEQU      PIC S99.
   717         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   718         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   719             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   720         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   721         16  FILLER                  PIC X.
   722
   723     12  CL-CERTIFICATE-DATA.
   724         16  CL-CERT-ORIGIN          PIC X.
   725             88  CERT-WAS-ONLINE        VALUE '1'.
   726             88  CERT-WAS-CREATED       VALUE '2'.
   727             88  COVERAGE-WAS-ADDED     VALUE '3'.
   728         16  CL-CERT-KEY-DATA.
   729             20  CL-CERT-CARRIER     PIC X.
   730             20  CL-CERT-GROUPING    PIC X(6).
   731             20  CL-CERT-STATE       PIC XX.
   732             20  CL-CERT-ACCOUNT.
   733                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   734                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   735             20  CL-CERT-EFF-DT      PIC XX.
   736
   737     12  CL-STATUS-CONTROLS.
   738         16  CL-PRIORITY-CD          PIC X.
   739             88  CONFIDENTIAL-DATA      VALUE '8'.
   740             88  HIGHEST-PRIORITY       VALUE '9'.
   741         16  CL-SUPV-ATTN-CD         PIC X.
   742             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   743             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   744         16  CL-PURGED-DT            PIC XX.
   745         16  CL-RESTORED-DT          PIC XX.
   746         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   747         16  CL-NEXT-RESEND-DT       PIC XX.
   748         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   749         16  FILLER                  PIC XX.
   750         16  CL-LAST-MAINT-DT        PIC XX.
   751         16  CL-LAST-MAINT-USER      PIC X(4).
   752         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
   753         16  CL-LAST-MAINT-TYPE      PIC X.
   754             88  CLAIM-SET-UP           VALUE ' '.
   755             88  PAYMENT-MADE           VALUE '1'.
   756             88  LETTER-SENT            VALUE '2'.
   757             88  MASTER-WAS-ALTERED     VALUE '3'.
   758             88  MASTER-WAS-RESTORED    VALUE '4'.
   759             88  INCURRED-DATE-CHANGED  VALUE '5'.
   760             88  FILE-CONVERTED         VALUE '6'.
   761             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   762             88  ERROR-CORRECTION       VALUE 'E'.
   763         16  CL-RELATED-CLAIM-NO     PIC X(7).
   764         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   765         16  CL-BENEFICIARY          PIC X(10).
   766         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   767         16  CL-DENIAL-TYPE          PIC X.
   768             88  CL-TYPE-DENIAL          VALUE '1'.
   769             88  CL-TYPE-RESCISSION      VALUE '2'.
   770             88  CL-TYPE-REFORMATION     VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  15
* SOCK03.cbl
   771             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   772             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   773         16  FILLER                  PIC X(5).
   774
   775     12  CL-TRAILER-CONTROLS.
   776         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   777             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   778             88  CL-LAST-TRL-AVAIL      VALUE +100.
   779             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   780         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   781         16  FILLER                  PIC XX.
   782         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   783         16  CL-ADDRESS-TRAILER-CNT.
   784             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   785                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   786             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   787                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   788             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   789                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   790             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   791                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   792             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   793                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   794             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   795                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   796             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   797                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   798
   799     12  CL-CV-REFERENCE-NO.
   800         16  CL-CV-REFNO-PRIME       PIC X(18).
   801         16  CL-CV-REFNO-SFX         PIC XX.
   802
   803     12  CL-FILE-LOCATION            PIC X(4).
   804
   805     12  CL-PROCESS-ERRORS.
   806         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   807             88  NO-FATAL-ERRORS        VALUE ZERO.
   808         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   809             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   810
   811     12  CL-PRODUCT-CD               PIC X.
   812
   813     12  CL-CURRENT-KEY-DATA.
   814         16  CL-CURRENT-CARRIER      PIC X.
   815         16  CL-CURRENT-GROUPING     PIC X(6).
   816         16  CL-CURRENT-STATE        PIC XX.
   817         16  CL-CURRENT-ACCOUNT      PIC X(10).
   818
   819     12  CL-ASSOCIATES               PIC X.
   820         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   821         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   822         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   823         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   824
   825     12  CL-ACTIVITY-CODE            PIC 99.
   826     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   827     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   828
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  16
* SOCK03.cbl
   829     12  CL-LAPSE-REPORT-CODE        PIC 9.
   830     12  CL-LAG-REPORT-CODE          PIC 9.
   831     12  CL-LOAN-TYPE                PIC XX.
   832     12  CL-LEGAL-STATE              PIC XX.
   833
   834*    12  FILLER                      PIC X(5).
   835     12  CL-YESNOSW                  PIC X.
   836     12  FILLER                      PIC X(4).
   837*                                 COPY ELCCNTL.
   838******************************************************************
   839*                                                                *
   840*                                                                *
   841*                            ELCCNTL.                            *
   842*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   843*                            VMOD=2.059                          *
   844*                                                                *
   845*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   846*                                                                *
   847*   FILE TYPE = VSAM,KSDS                                        *
   848*   RECORD SIZE = 750  RECFORM = FIXED                           *
   849*                                                                *
   850*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   851*       ALTERNATE INDEX = NONE                                   *
   852*                                                                *
   853*   LOG = YES                                                    *
   854*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   855******************************************************************
   856*                   C H A N G E   L O G
   857*
   858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   859*-----------------------------------------------------------------
   860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   861* EFFECTIVE    NUMBER
   862*-----------------------------------------------------------------
   863* 082503                   PEMA  ADD BENEFIT GROUP
   864* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   865* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   866* 092705    2005050300006  PEMA  ADD SPP LEASES
   867* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   868* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   869* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   870* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   871* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   872******************************************************************
   873*
   874 01  CONTROL-FILE.
   875     12  CF-RECORD-ID                       PIC XX.
   876         88  VALID-CF-ID                        VALUE 'CF'.
   877
   878     12  CF-CONTROL-PRIMARY.
   879         16  CF-COMPANY-ID                  PIC XXX.
   880         16  CF-RECORD-TYPE                 PIC X.
   881             88  CF-COMPANY-MASTER              VALUE '1'.
   882             88  CF-PROCESSOR-MASTER            VALUE '2'.
   883             88  CF-STATE-MASTER                VALUE '3'.
   884             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   885             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   886             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  17
* SOCK03.cbl
   887             88  CF-MORTALITY-MASTER            VALUE '7'.
   888             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   889             88  CF-TERMINAL-MASTER             VALUE '9'.
   890             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   891             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   892             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   893             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   894             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   895             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   896             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   897             88  CF-REMINDERS-MASTER            VALUE 'R'.
   898             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   899         16  CF-ACCESS-CD-GENL              PIC X(4).
   900         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   901             20  CF-PROCESSOR               PIC X(4).
   902         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   903             20  CF-STATE-CODE              PIC XX.
   904             20  FILLER                     PIC XX.
   905         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   906             20  FILLER                     PIC XX.
   907             20  CF-HI-BEN-IN-REC           PIC XX.
   908         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   909             20  FILLER                     PIC XXX.
   910             20  CF-CARRIER-CNTL            PIC X.
   911         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   912             20  FILLER                     PIC XX.
   913             20  CF-HI-TYPE-IN-REC          PIC 99.
   914         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   915             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   916                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   917             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   918             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   919         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   920             20  FILLER                     PIC X.
   921             20  CF-CUSTOM-REPORT-NO        PIC 999.
   922         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   923             20  FILLER                     PIC XX.
   924             20  CF-MORTGAGE-PLAN           PIC XX.
   925         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   926
   927     12  CF-LAST-MAINT-DT                   PIC XX.
   928     12  CF-LAST-MAINT-BY                   PIC X(4).
   929     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   930
   931     12  CF-RECORD-BODY                     PIC X(728).
   932
   933
   934****************************************************************
   935*             COMPANY MASTER RECORD                            *
   936****************************************************************
   937
   938     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   939         16  CF-COMPANY-ADDRESS.
   940             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   941             20  CF-CL-IN-CARE-OF           PIC X(30).
   942             20  CF-CL-ADDR-LINE-1          PIC X(30).
   943             20  CF-CL-ADDR-LINE-2          PIC X(30).
   944             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  18
* SOCK03.cbl
   945             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   946             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   947         16  CF-COMPANY-CD                  PIC X.
   948         16  CF-COMPANY-PASSWORD            PIC X(8).
   949         16  CF-SECURITY-OPTION             PIC X.
   950             88  ALL-SECURITY                   VALUE '1'.
   951             88  COMPANY-VERIFY                 VALUE '2'.
   952             88  PROCESSOR-VERIFY               VALUE '3'.
   953             88  NO-SECURITY                    VALUE '4'.
   954             88  ALL-BUT-TERM                   VALUE '5'.
   955         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   956             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   957         16  CF-LGX-INTERFACE-CNTL          PIC X.
   958             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   959         16  CF-INFORCE-LOCATION            PIC X.
   960             88  CERTS-ARE-ONLINE               VALUE '1'.
   961             88  CERTS-ARE-OFFLINE              VALUE '2'.
   962             88  NO-CERTS-AVAILABLE             VALUE '3'.
   963         16  CF-LOWER-CASE-LETTERS          PIC X.
   964         16  CF-CERT-ACCESS-CONTROL         PIC X.
   965             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   966             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   967             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   968             88  CF-ACCNT-CNTL                  VALUE '3'.
   969             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   970
   971         16  CF-FORMS-PRINTER-ID            PIC X(4).
   972         16  CF-CHECK-PRINTER-ID            PIC X(4).
   973
   974         16  CF-LGX-CREDIT-USER             PIC X.
   975             88  CO-IS-NOT-USER                 VALUE 'N'.
   976             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   977
   978         16 CF-CREDIT-CALC-CODES.
   979             20  CF-CR-REM-TERM-CALC PIC X.
   980               88  CR-EARN-AFTER-15TH           VALUE '1'.
   981               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   982               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   983               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   984               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   985               88  CR-EARN-AFTER-14TH           VALUE '6'.
   986               88  CR-EARN-AFTER-16TH           VALUE '7'.
   987             20  CF-CR-R78-METHOD           PIC X.
   988               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   989               88  DONT-USE-PLUS-ONE            VALUE '1'.
   990
   991         16  CF-CLAIM-CONTROL-COUNTS.
   992             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   993                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   994
   995             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   996                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   997
   998             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   999                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1000
  1001             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1002                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  19
* SOCK03.cbl
  1003
  1004         16  CF-CURRENT-MONTH-END           PIC XX.
  1005
  1006         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1007             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1008             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1009             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1010             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1011                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1012                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1013             20  CF-CO-PREM-REJECT-SW       PIC X.
  1014                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1015                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1016             20  CF-CO-REF-REJECT-SW        PIC X.
  1017                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1018                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1019
  1020         16  CF-CO-REPORTING-DT             PIC XX.
  1021         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1022         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1023           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1024           88  CF-CO-MONTH-END                  VALUE '1'.
  1025
  1026         16  CF-LGX-CLAIM-USER              PIC X.
  1027             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1028             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1029
  1030         16  CF-CREDIT-EDIT-CONTROLS.
  1031             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1032             20  CF-MIN-AGE                 PIC 99.
  1033             20  CF-DEFAULT-AGE             PIC 99.
  1034             20  CF-MIN-TERM                PIC S999      COMP-3.
  1035             20  CF-MAX-TERM                PIC S999      COMP-3.
  1036             20  CF-DEFAULT-SEX             PIC X.
  1037             20  CF-JOINT-AGE-INPUT         PIC X.
  1038                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1039             20  CF-BIRTH-DATE-INPUT        PIC X.
  1040                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1041             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1042                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1043                 88  CF-ZERO-CARRIER            VALUE '1'.
  1044                 88  CF-ZERO-GROUPING           VALUE '2'.
  1045                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1046             20  CF-EDIT-SW                 PIC X.
  1047                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1048             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1049             20  CF-CR-PR-METHOD            PIC X.
  1050               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1051               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1052             20  FILLER                     PIC X.
  1053
  1054         16  CF-CREDIT-MISC-CONTROLS.
  1055             20  CF-REIN-TABLE-SW           PIC X.
  1056                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1057             20  CF-COMP-TABLE-SW           PIC X.
  1058                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1059             20  CF-EXPERIENCE-RETENTION-AGE
  1060                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  20
* SOCK03.cbl
  1061             20  CF-CONVERSION-DT           PIC XX.
  1062             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1063             20  CF-RUN-FREQUENCY-SW        PIC X.
  1064                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1065                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1066
  1067             20  CF-CR-CHECK-NO-CONTROL.
  1068                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1069                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1070                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1071                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1072                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1073                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1074
  1075                 24  CF-CR-CHECK-COUNT       REDEFINES
  1076                     CF-CR-CHECK-COUNTER      PIC X(4).
  1077
  1078                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1079                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1080
  1081                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1082                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1083                 24  CF-MAIL-PROCESSING       PIC X.
  1084                     88  MAIL-PROCESSING          VALUE 'Y'.
  1085
  1086         16  CF-MISC-SYSTEM-CONTROL.
  1087             20  CF-SYSTEM-C                 PIC X.
  1088                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1089             20  CF-SYSTEM-D                 PIC X.
  1090                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1091             20  CF-SOC-SEC-NO-SW            PIC X.
  1092                 88  SOC-SEC-NO-USED             VALUE '1'.
  1093             20  CF-MEMBER-NO-SW             PIC X.
  1094                 88  MEMBER-NO-USED              VALUE '1'.
  1095             20  CF-TAX-ID-NUMBER            PIC X(11).
  1096             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1097             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1098                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1099                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1100                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1101                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1102             20  CF-SYSTEM-E                 PIC X.
  1103                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1104
  1105         16  CF-LGX-LIFE-USER               PIC X.
  1106             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1107             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1108
  1109         16  CF-CR-MONTH-END-DT             PIC XX.
  1110
  1111         16  CF-FILE-MAINT-DATES.
  1112             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1113                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1114             20  CF-LAST-BATCH       REDEFINES
  1115                 CF-LAST-BATCH-NO               PIC X(4).
  1116             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1117             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1118             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  21
* SOCK03.cbl
  1119             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1120             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1121             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1122             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1123             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1124             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1125             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1126
  1127         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1128         16  FILLER                         PIC X.
  1129
  1130         16  CF-ALT-MORT-CODE               PIC X(4).
  1131         16  CF-MEMBER-CAPTION              PIC X(10).
  1132
  1133         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1134             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1135             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1136             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1137             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1138             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1139
  1140         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1141
  1142         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1143         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1144         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1145         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1146
  1147         16  CF-AH-OVERRIDE-L1              PIC X.
  1148         16  CF-AH-OVERRIDE-L2              PIC XX.
  1149         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1150         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1151
  1152         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1153         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1154
  1155         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1156         16  CF-AR-LAST-EL860-DT            PIC XX.
  1157         16  CF-MP-MONTH-END-DT             PIC XX.
  1158
  1159         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1160         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1161             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1162
  1163         16  CF-AR-MONTH-END-DT             PIC XX.
  1164
  1165         16  CF-CRDTCRD-USER                PIC X.
  1166             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1167             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1168
  1169         16  CF-CC-MONTH-END-DT             PIC XX.
  1170
  1171         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1172
  1173         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1174             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1175             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1176             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  22
* SOCK03.cbl
  1177         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1178         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1179         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1180         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1181             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1182             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1183         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1184         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1185         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1186             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1187         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1188
  1189         16  CF-CL-ZIP-CODE.
  1190             20  CF-CL-ZIP-PRIME.
  1191                 24  CF-CL-ZIP-1ST          PIC X.
  1192                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1193                 24  FILLER                 PIC X(4).
  1194             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1195         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1196             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1197             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1198             20  FILLER                     PIC XXX.
  1199
  1200         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1201         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1202         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1203         16  CF-CO-OPTION-START-DATE        PIC XX.
  1204         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1205           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1206                                                      '3' '4'.
  1207           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1208           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1209           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1210           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1211           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1212           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1213
  1214         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1215
  1216         16  CF-PAYMENT-APPROVAL-LEVELS.
  1217             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1218             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1219             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1220             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1221             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1222             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1223
  1224         16  CF-END-USER-REPORTING-USER     PIC X.
  1225             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1226             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1227
  1228         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1229             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1230             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1231
  1232         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1233
  1234         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  23
* SOCK03.cbl
  1235         16  FILLER                         PIC X.
  1236
  1237         16  CF-CREDIT-ARCHIVE-CNTL.
  1238             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1239             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1240             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1241
  1242         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1243
  1244         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1245             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1246             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1247
  1248         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1249             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1250             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1251
  1252         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1253
  1254         16  CF-CO-ACH-ID-CODE              PIC  X.
  1255             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1256             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1257             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1258         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1259         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1260         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1261         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1262         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1263         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1264         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1265         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1266         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1267                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1268         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1269                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1270
  1271         16  CF-CO-OVER-SHORT.
  1272             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1273             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1274
  1275*         16  FILLER                         PIC X(102).
  1276         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1277             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1278             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1279
  1280         16  CF-AH-APPROVAL-DAYS.
  1281             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1282             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1283             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1284             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1285
  1286         16  FILLER                         PIC X(82).
  1287****************************************************************
  1288*             PROCESSOR/USER RECORD                            *
  1289****************************************************************
  1290
  1291     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1292         16  CF-PROCESSOR-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  24
* SOCK03.cbl
  1293         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1294         16  CF-PROCESSOR-TITLE             PIC X(26).
  1295         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1296                 88  MESSAGE-YES                VALUE 'Y'.
  1297                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1298
  1299*****************************************************
  1300****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1301****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1302****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1303****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1304*****************************************************
  1305
  1306         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1307             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1308             20  CF-APPLICATION-FORCE       PIC X.
  1309             20  CF-INDIVIDUAL-APP.
  1310                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1311                     28  CF-BROWSE-APP      PIC X.
  1312                     28  CF-UPDATE-APP      PIC X.
  1313
  1314         16  CF-CURRENT-TERM-ON             PIC X(4).
  1315         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1316             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1317             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1318             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1319             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1320             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1321             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1322             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1323         16  CF-PROCESSOR-CARRIER           PIC X.
  1324             88  NO-CARRIER-SECURITY            VALUE ' '.
  1325         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1326             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1327         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1328             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1329         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1330             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1331
  1332         16  CF-PROC-SYS-ACCESS-SW.
  1333             20  CF-PROC-CREDIT-CLAIMS-SW.
  1334                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1335                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1336                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1337                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1338             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1339                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1340                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1341             20  CF-PROC-LIFE-GNRLDGR-SW.
  1342                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1343                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1344                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1345                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1346             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1347                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1348                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1349         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1350             CF-PROC-SYS-ACCESS-SW              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  25
* SOCK03.cbl
  1351             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1352         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1353
  1354         16  CF-APPROVAL-LEVEL                  PIC X.
  1355             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1356             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1357             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1358             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1359
  1360         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1361
  1362         16  CF-LANGUAGE-TYPE                   PIC X.
  1363             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1364             88  CF-LANG-IS-FR                      VALUE 'F'.
  1365         16  FILLER                             PIC  X(240).
  1366
  1367****************************************************************
  1368*             PROCESSOR/REMINDERS RECORD                       *
  1369****************************************************************
  1370
  1371     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1372         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1373             20  CF-START-REMIND-DT         PIC XX.
  1374             20  CF-END-REMIND-DT           PIC XX.
  1375             20  CF-REMINDER-TEXT           PIC X(50).
  1376         16  FILLER                         PIC X(296).
  1377
  1378
  1379****************************************************************
  1380*             STATE MASTER RECORD                              *
  1381****************************************************************
  1382
  1383     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1384         16  CF-STATE-ABBREVIATION          PIC XX.
  1385         16  CF-STATE-NAME                  PIC X(25).
  1386         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1387         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1388             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1389             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1390             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1391             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1392                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1393                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1394             20  CF-ST-PREM-REJECT-SW       PIC X.
  1395                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1396                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1397             20  CF-ST-REF-REJECT-SW        PIC X.
  1398                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1399                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1400         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1401         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1402         16  CF-ST-REFUND-RULES.
  1403             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1404             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1405             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1406         16  CF-ST-FST-PMT-EXTENSION.
  1407             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1408             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  26
* SOCK03.cbl
  1409                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1410                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1411                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1412                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1413         16  CF-ST-STATE-CALL.
  1414             20  CF-ST-CALL-UNEARNED        PIC X.
  1415             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1416             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1417         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1418             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1419             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1420         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1421         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1422         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1423         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1424         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1425         16  FILLER                         PIC X.
  1426         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1427             20  CF-ST-BENEFIT-CD           PIC XX.
  1428             20  CF-ST-BENEFIT-KIND         PIC X.
  1429                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1430                 88  CF-ST-AH-KIND              VALUE 'A'.
  1431             20  CF-ST-REM-TERM-CALC        PIC X.
  1432                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1433                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1434                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1435                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1436                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1437                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1438                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1439                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1440
  1441             20  CF-ST-REFUND-CALC          PIC X.
  1442                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1443                 88  ST-REFD-BY-R78             VALUE '1'.
  1444                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1445                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1446                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1447                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1448                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1449                 88  ST-REFD-UTAH               VALUE '7'.
  1450                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1451                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1452                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1453
  1454             20  CF-ST-EARNING-CALC         PIC X.
  1455                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1456                 88  ST-EARN-BY-R78             VALUE '1'.
  1457                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1458                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1459                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1460                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1461                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1462                 88  ST-EARN-MEAN               VALUE '8'.
  1463                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1464
  1465             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1466                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  27
* SOCK03.cbl
  1467                 88  ST-OVRD-BY-R78             VALUE '1'.
  1468                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1469                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1470                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1471                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1472                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1473                 88  ST-OVRD-MEAN               VALUE '8'.
  1474                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1475             20  FILLER                     PIC X.
  1476
  1477         16  CF-ST-COMMISSION-CAPS.
  1478             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1479             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1480             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1481             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1482         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1483                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1484
  1485         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1486
  1487         16  CF-ST-STATUTORY-INTEREST.
  1488             20  CF-ST-STAT-DATE-FROM       PIC X.
  1489                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1490                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1491             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1492             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1493             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1494             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1495             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1496
  1497         16  CF-ST-OVER-SHORT.
  1498             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1499             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1500
  1501         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1502
  1503         16  CF-ST-RT-CALC                  PIC X.
  1504
  1505         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1506         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1507         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1508         16  CF-ST-RF-LR-CALC               PIC X.
  1509         16  CF-ST-RF-LL-CALC               PIC X.
  1510         16  CF-ST-RF-LN-CALC               PIC X.
  1511         16  CF-ST-RF-AH-CALC               PIC X.
  1512         16  CF-ST-RF-CP-CALC               PIC X.
  1513*        16  FILLER                         PIC X(206).
  1514*CIDMOD         16  FILLER                         PIC X(192).
  1515         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1516             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1517         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1518         16  CF-ST-VFY-2ND-BENE             PIC X.
  1519         16  FILLER                         PIC X(186).
  1520
  1521****************************************************************
  1522*             BENEFIT MASTER RECORD                            *
  1523****************************************************************
  1524
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  28
* SOCK03.cbl
  1525     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1526         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1527             20  CF-BENEFIT-CODE            PIC XX.
  1528             20  CF-BENEFIT-NUMERIC  REDEFINES
  1529                 CF-BENEFIT-CODE            PIC XX.
  1530             20  CF-BENEFIT-ALPHA           PIC XXX.
  1531             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1532             20  CF-BENEFIT-COMMENT         PIC X(10).
  1533
  1534             20  CF-LF-COVERAGE-TYPE        PIC X.
  1535                 88  CF-REDUCING                VALUE 'R'.
  1536                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1537
  1538             20  CF-SPECIAL-CALC-CD         PIC X.
  1539                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1540                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1541                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1542                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1543                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1544                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1545                 88  CF-FARM-PLAN               VALUE 'F'.
  1546                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1547                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1548                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1549                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1550                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1551                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1552                 88  CF-PRUDENTIAL              VALUE 'P'.
  1553                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1554                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1555                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1556                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1557                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1558                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1559
  1560             20  CF-JOINT-INDICATOR         PIC X.
  1561                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1562
  1563*            20  FILLER                     PIC X(12).
  1564             20  FILLER                     PIC X(11).
  1565             20  CF-BENEFIT-CATEGORY        PIC X.
  1566             20  CF-LOAN-TYPE               PIC X(8).
  1567
  1568             20  CF-CO-REM-TERM-CALC        PIC X.
  1569                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1570                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1571                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1572                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1573                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1574
  1575             20  CF-CO-EARNINGS-CALC        PIC X.
  1576                 88  CO-EARN-BY-R78             VALUE '1'.
  1577                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1578                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1579                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1580                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1581                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1582                 88  CO-EARN-AS-MEAN            VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  29
* SOCK03.cbl
  1583                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1584
  1585             20  CF-CO-REFUND-CALC          PIC X.
  1586                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1587                 88  CO-REFD-BY-R78             VALUE '1'.
  1588                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1589                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1590                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1591                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1592                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1593                 88  CO-REFD-MEAN               VALUE '8'.
  1594                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1595                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1596                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1597
  1598             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1599                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1600                 88  CO-OVRD-BY-R78             VALUE '1'.
  1601                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1602                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1603                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1604                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1605                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1606                 88  CO-OVRD-MEAN               VALUE '8'.
  1607                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1608
  1609             20  CF-CO-BEN-I-G-CD           PIC X.
  1610                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1611                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1612                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1613
  1614         16  FILLER                         PIC X(304).
  1615
  1616
  1617****************************************************************
  1618*             CARRIER MASTER RECORD                            *
  1619****************************************************************
  1620
  1621     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1622         16  CF-ADDRESS-DATA.
  1623             20  CF-MAIL-TO-NAME            PIC X(30).
  1624             20  CF-IN-CARE-OF              PIC X(30).
  1625             20  CF-ADDRESS-LINE-1          PIC X(30).
  1626             20  CF-ADDRESS-LINE-2          PIC X(30).
  1627             20  CF-CITY-STATE              PIC X(30).
  1628             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1629             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1630
  1631         16  CF-CLAIM-NO-CONTROL.
  1632             20  CF-CLAIM-NO-METHOD         PIC X.
  1633                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1634                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1635                 88  CLAIM-NO-SEQ               VALUE '3'.
  1636                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1637             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1638                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1639                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1640                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  30
* SOCK03.cbl
  1641
  1642         16  CF-CHECK-NO-CONTROL.
  1643             20  CF-CHECK-NO-METHOD         PIC X.
  1644                 88  CHECK-NO-MANUAL            VALUE '1'.
  1645                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1646                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1647                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1648             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1649                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1650
  1651         16  CF-DOMICILE-STATE              PIC XX.
  1652
  1653         16  CF-EXPENSE-CONTROLS.
  1654             20  CF-EXPENSE-METHOD          PIC X.
  1655                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1656                 88  DOLLARS-PER-PMT            VALUE '2'.
  1657                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1658                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1659             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1660             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1661
  1662         16  CF-CORRESPONDENCE-CONTROL.
  1663             20  CF-LETTER-RESEND-OPT       PIC X.
  1664                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1665                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1666             20  FILLER                     PIC X(4).
  1667
  1668         16  CF-RESERVE-CONTROLS.
  1669             20  CF-MANUAL-SW               PIC X.
  1670                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1671             20  CF-FUTURE-SW               PIC X.
  1672                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1673             20  CF-PTC-SW                  PIC X.
  1674                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1675             20  CF-IBNR-SW                 PIC X.
  1676                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1677             20  CF-PTC-LF-SW               PIC X.
  1678                 88  CF-LF-PTC-USED             VALUE '1'.
  1679             20  CF-CDT-ACCESS-METHOD       PIC X.
  1680                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1681                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1682                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1683             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1684
  1685         16  CF-CLAIM-CALC-METHOD           PIC X.
  1686             88  360-PLUS-MONTHS                VALUE '1'.
  1687             88  365-PLUS-MONTHS                VALUE '2'.
  1688             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1689             88  360-DAILY                      VALUE '4'.
  1690             88  365-DAILY                      VALUE '5'.
  1691
  1692         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1693         16  FILLER                         PIC X(11).
  1694
  1695         16  CF-LIMIT-AMOUNTS.
  1696             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1697             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1698             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  31
* SOCK03.cbl
  1699             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1700             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1701             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1702             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1703             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1704             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1705             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1706
  1707         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1708         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1709         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1710
  1711         16  CF-ZIP-CODE.
  1712             20  CF-ZIP-PRIME.
  1713                 24  CF-ZIP-1ST             PIC X.
  1714                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1715                 24  FILLER                 PIC X(4).
  1716             20  CF-ZIP-PLUS4               PIC X(4).
  1717         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1718             20  CF-CAN-POSTAL-1            PIC XXX.
  1719             20  CF-CAN-POSTAL-2            PIC XXX.
  1720             20  FILLER                     PIC XXX.
  1721
  1722         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1723         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1724         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1725
  1726         16  CF-RATING-SWITCH               PIC X.
  1727             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1728             88  CF-NO-RATING                   VALUE 'N'.
  1729
  1730         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1731
  1732         16  CF-CARRIER-OVER-SHORT.
  1733             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1734             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1735
  1736         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1737         16  CF-SECPAY-SWITCH               PIC X.
  1738             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1739             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1740         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1741         16  FILLER                         PIC X(448).
  1742*        16  FILLER                         PIC X(452).
  1743
  1744
  1745****************************************************************
  1746*             MORTALITY MASTER RECORD                          *
  1747****************************************************************
  1748
  1749     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1750         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1751                                INDEXED BY CF-MORT-NDX.
  1752             20  CF-MORT-TABLE              PIC X(5).
  1753             20  CF-MORT-TABLE-TYPE         PIC X.
  1754                 88  CF-MORT-JOINT              VALUE 'J'.
  1755                 88  CF-MORT-SINGLE             VALUE 'S'.
  1756                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  32
* SOCK03.cbl
  1757                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1758                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1759             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1760             20  CF-MORT-AGE-METHOD         PIC XX.
  1761                 88  CF-AGE-LAST                VALUE 'AL'.
  1762                 88  CF-AGE-NEAR                VALUE 'AN'.
  1763             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1764             20  CF-MORT-ADJUSTMENT-DIRECTION
  1765                                            PIC X.
  1766                 88  CF-MINUS                   VALUE '-'.
  1767                 88  CF-PLUS                    VALUE '+'.
  1768             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1769             20  CF-MORT-JOINT-CODE         PIC X.
  1770                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1771             20  CF-MORT-PC-Q               PIC X.
  1772                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1773             20  CF-MORT-TABLE-CODE         PIC X(4).
  1774             20  CF-MORT-COMMENTS           PIC X(15).
  1775             20  FILLER                     PIC X(14).
  1776
  1777         16  FILLER                         PIC X(251).
  1778
  1779
  1780****************************************************************
  1781*             BUSSINESS TYPE MASTER RECORD                     *
  1782****************************************************************
  1783
  1784     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1785* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1786* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1787* AND RECORD 05 IS TYPES 81-99
  1788         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1789             20  CF-BUSINESS-TITLE          PIC  X(19).
  1790             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1791                                            PIC S9V9(4) COMP-3.
  1792             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1793             20  FILLER                     PIC  X.
  1794         16  FILLER                         PIC  X(248).
  1795
  1796
  1797****************************************************************
  1798*             TERMINAL MASTER RECORD                           *
  1799****************************************************************
  1800
  1801     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1802
  1803         16  CF-COMPANY-TERMINALS.
  1804             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1805                                  PIC X(4).
  1806         16  FILLER               PIC X(248).
  1807
  1808
  1809****************************************************************
  1810*             LIFE EDIT MASTER RECORD                          *
  1811****************************************************************
  1812
  1813     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1814         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  33
* SOCK03.cbl
  1815             20  CF-LIFE-CODE-IN            PIC XX.
  1816             20  CF-LIFE-CODE-OUT           PIC XX.
  1817         16  FILLER                         PIC X(248).
  1818
  1819
  1820****************************************************************
  1821*             AH EDIT MASTER RECORD                            *
  1822****************************************************************
  1823
  1824     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1825         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1826             20  CF-AH-CODE-IN              PIC XXX.
  1827             20  CF-AH-CODE-OUT             PIC XX.
  1828         16  FILLER                         PIC X(248).
  1829
  1830
  1831****************************************************************
  1832*             CREDIBILITY TABLES                               *
  1833****************************************************************
  1834
  1835     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1836         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1837                             INDEXED BY CF-CRDB-NDX.
  1838             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1839             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1840             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1841         16  FILLER                         PIC  X(332).
  1842
  1843
  1844****************************************************************
  1845*             REPORT CUSTOMIZATION RECORD                      *
  1846****************************************************************
  1847
  1848     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1849         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1850             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1851             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1852             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1853**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1854****       A T-TRANSFER.                                   ****
  1855             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1856
  1857         16  FILLER                         PIC XX.
  1858
  1859         16  CF-CARRIER-CNTL-OPT.
  1860             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1861                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1862                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1863             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1864                                            PIC X.
  1865         16  CF-GROUP-CNTL-OPT.
  1866             20  CF-GROUP-OPT-SEQ           PIC 9.
  1867                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1868                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1869             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1870                                            PIC X(6).
  1871         16  CF-STATE-CNTL-OPT.
  1872             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  34
* SOCK03.cbl
  1873                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1874                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1875             20  CF-STATE-SELECT OCCURS 3 TIMES
  1876                                            PIC XX.
  1877         16  CF-ACCOUNT-CNTL-OPT.
  1878             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1879                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1880                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1881             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1882                                            PIC X(10).
  1883         16  CF-BUS-TYP-CNTL-OPT.
  1884             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1885                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1886                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1887             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1888                                            PIC XX.
  1889         16  CF-LF-TYP-CNTL-OPT.
  1890             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1891                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1892                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1893             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1894                                            PIC XX.
  1895         16  CF-AH-TYP-CNTL-OPT.
  1896             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1897                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1898                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1899             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1900                                            PIC XX.
  1901         16  CF-REPTCD1-CNTL-OPT.
  1902             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1903                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1904                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1905             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1906                                            PIC X(10).
  1907         16  CF-REPTCD2-CNTL-OPT.
  1908             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1909                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1910                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1911             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1912                                            PIC X(10).
  1913         16  CF-USER1-CNTL-OPT.
  1914             20  CF-USER1-OPT-SEQ           PIC 9.
  1915                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1916                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1917             20  CF-USER1-SELECT OCCURS 3 TIMES
  1918                                            PIC X(10).
  1919         16  CF-USER2-CNTL-OPT.
  1920             20  CF-USER2-OPT-SEQ           PIC 9.
  1921                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1922                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1923             20  CF-USER2-SELECT OCCURS 3 TIMES
  1924                                            PIC X(10).
  1925         16  CF-USER3-CNTL-OPT.
  1926             20  CF-USER3-OPT-SEQ           PIC 9.
  1927                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1928                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1929             20  CF-USER3-SELECT OCCURS 3 TIMES
  1930                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  35
* SOCK03.cbl
  1931         16  CF-USER4-CNTL-OPT.
  1932             20  CF-USER4-OPT-SEQ           PIC 9.
  1933                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1934                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1935             20  CF-USER4-SELECT OCCURS 3 TIMES
  1936                                            PIC X(10).
  1937         16  CF-USER5-CNTL-OPT.
  1938             20  CF-USER5-OPT-SEQ           PIC 9.
  1939                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1940                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1941             20  CF-USER5-SELECT OCCURS 3 TIMES
  1942                                            PIC X(10).
  1943         16  CF-REINS-CNTL-OPT.
  1944             20  CF-REINS-OPT-SEQ           PIC 9.
  1945                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1946                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1947             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1948                 24  CF-REINS-PRIME         PIC XXX.
  1949                 24  CF-REINS-SUB           PIC XXX.
  1950
  1951         16  CF-AGENT-CNTL-OPT.
  1952             20  CF-AGENT-OPT-SEQ           PIC 9.
  1953                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1954                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1955             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1956                                            PIC X(10).
  1957
  1958         16  FILLER                         PIC X(43).
  1959
  1960         16  CF-LOSS-RATIO-SELECT.
  1961             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1962             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1963         16  CF-ENTRY-DATE-SELECT.
  1964             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1965             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1966         16  CF-EFFECTIVE-DATE-SELECT.
  1967             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1968             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1969
  1970         16  CF-EXCEPTION-LIST-IND          PIC X.
  1971             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1972
  1973         16  FILLER                         PIC X(318).
  1974
  1975****************************************************************
  1976*                  EXCEPTION REPORTING RECORD                  *
  1977****************************************************************
  1978
  1979     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1980         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1981             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1982
  1983         16  CF-COMBINED-LIFE-AH-OPT.
  1984             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1985             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1986             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  1987             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1988
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  36
* SOCK03.cbl
  1989         16  CF-LIFE-OPT.
  1990             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1991             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1992             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1993             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1994             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1995             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1996             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1997             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1998             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1999             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2000
  2001         16  CF-AH-OPT.
  2002             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2003             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2004             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2005             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2006             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2007             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2008             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2009             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2010             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2011             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2012
  2013         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2014             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2015             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2016             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2017
  2018         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2019
  2020         16  FILLER                         PIC X(673).
  2021
  2022
  2023****************************************************************
  2024*             MORTGAGE SYSTEM PLAN RECORD                      *
  2025****************************************************************
  2026
  2027     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2028         16  CF-PLAN-TYPE                   PIC X.
  2029             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2030             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2031             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2032         16  CF-PLAN-ABBREV                 PIC XXX.
  2033         16  CF-PLAN-DESCRIPT               PIC X(10).
  2034         16  CF-PLAN-NOTES                  PIC X(20).
  2035         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2036         16  CF-PLAN-UNDERWRITING.
  2037             20  CF-PLAN-TERM-DATA.
  2038                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2039                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2040             20  CF-PLAN-AGE-DATA.
  2041                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2042                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2043                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2044             20  CF-PLAN-BENEFIT-DATA.
  2045                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2046                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  37
* SOCK03.cbl
  2047                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2048                                            PIC S9(7)V99  COMP-3.
  2049         16  CF-PLAN-POLICY-FORMS.
  2050             20  CF-POLICY-FORM             PIC X(12).
  2051             20  CF-MASTER-APPLICATION      PIC X(12).
  2052             20  CF-MASTER-POLICY           PIC X(12).
  2053         16  CF-PLAN-RATING.
  2054             20  CF-RATE-CODE               PIC X(5).
  2055             20  CF-SEX-RATING              PIC X.
  2056                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2057                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2058             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2059             20  CF-SUB-STD-TYPE            PIC X.
  2060                 88  CF-PCT-OF-PREM            VALUE '1'.
  2061                 88  CF-PCT-OF-BENE            VALUE '2'.
  2062         16  CF-PLAN-PREM-TOLERANCES.
  2063             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2064             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2065         16  CF-PLAN-PYMT-TOLERANCES.
  2066             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2067             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2068         16  CF-PLAN-MISC-DATA.
  2069             20  FILLER                     PIC X.
  2070             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2071             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2072         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2073         16  CF-PLAN-IND-GRP                PIC X.
  2074             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2075                                                     '1'.
  2076             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2077                                                     '2'.
  2078         16  CF-MIB-SEARCH-SW               PIC X.
  2079             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2080             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2081             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2082             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2083         16  CF-ALPHA-SEARCH-SW             PIC X.
  2084             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2085             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2086             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2087             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2088             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2089             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2090             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2091             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2092             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2093             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2094                                                     'A' 'B' 'C'
  2095                                                     'X' 'Y' 'Z'.
  2096         16  CF-EFF-DT-RULE-SW              PIC X.
  2097             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2098             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2099             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2100             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2101             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2102         16  FILLER                         PIC X(4).
  2103         16  CF-HEALTH-QUESTIONS            PIC X.
  2104             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  38
* SOCK03.cbl
  2105         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2106         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2107         16  CF-PLAN-SNGL-JNT               PIC X.
  2108             88  CF-COMBINED-PLAN              VALUE 'C'.
  2109             88  CF-JNT-PLAN                   VALUE 'J'.
  2110             88  CF-SNGL-PLAN                  VALUE 'S'.
  2111         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2112         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2113         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2114         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2115         16  CF-RERATE-CNTL                 PIC  X.
  2116             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2117             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2118             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2119             88  CF-AUTO-RECALC                 VALUE '4'.
  2120         16  CF-BENEFIT-TYPE                PIC  X.
  2121             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2122             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2123         16  CF-POLICY-FEE                  PIC S999V99
  2124                                                    COMP-3.
  2125         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2126         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2127         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2128         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2129         16  FILLER                         PIC  X(32).
  2130         16  CF-TERMINATION-FORM            PIC  X(04).
  2131         16  FILLER                         PIC  X(08).
  2132         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2133                                                       COMP-3.
  2134         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2135         16  CF-ISSUE-LETTER                PIC  X(4).
  2136         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2137         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2138             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2139             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2140         16  CF-MP-REFUND-CALC              PIC X.
  2141             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2142             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2143             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2144             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2145             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2146             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2147             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2148             88  CF-MP-REFD-MEAN                VALUE '8'.
  2149         16  CF-ALT-RATE-CODE               PIC  X(5).
  2150
  2151
  2152         16  FILLER                         PIC X(498).
  2153****************************************************************
  2154*             MORTGAGE COMPANY MASTER RECORD                   *
  2155****************************************************************
  2156
  2157     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2158         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2159         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2160             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2161             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2162             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  39
* SOCK03.cbl
  2163             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2164             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2165
  2166         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2167         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2168         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2169         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2170         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2171
  2172         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2173             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2174         16  CF-MP-RECON-USE-IND            PIC X(1).
  2175             88  CF-MP-USE-RECON             VALUE 'Y'.
  2176         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2177             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2178         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2179             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2180             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2181         16  FILLER                         PIC X(1).
  2182         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2183             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2184         16  CF-MORTG-MIB-VERSION           PIC X.
  2185             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2186             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2187             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2188         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2189             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2190                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2191             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2192                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2193             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2194                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2195             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2196                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2197             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2198                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2199             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2200                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2201         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2202         16  FILLER                         PIC X(7).
  2203         16  CF-MORTG-DESTINATION-SYMBOL.
  2204             20  CF-MORTG-MIB-COMM          PIC X(5).
  2205             20  CF-MORTG-MIB-TERM          PIC X(5).
  2206         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2207             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2208         16  FILLER                         PIC X(03).
  2209         16  CF-MP-CHECK-NO-CONTROL.
  2210             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2211                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2212                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2213                                                ' ' LOW-VALUES.
  2214                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2215                                               VALUE '3'.
  2216         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2217         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2218         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2219             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2220                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  40
* SOCK03.cbl
  2221             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2222                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2223             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2224                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2225             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2226                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2227             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2228                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2229             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2230                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2231         16  CF-MORTG-BILLING-AREA.
  2232             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2233                                            PIC X.
  2234         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2235         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2236         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2237         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2238             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2239             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2240         16  FILLER                         PIC X.
  2241         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2242             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2243             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2244         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2245         16  FILLER                         PIC X(8).
  2246         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2247         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2248         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2249         16  CF-ACH-COMPANY-ID.
  2250             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2251                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2252                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2253                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2254             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2255         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2256             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2257         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2258             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2259             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2260         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2261         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2262         16  FILLER                         PIC X(536).
  2263
  2264****************************************************************
  2265*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2266****************************************************************
  2267
  2268     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2269         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2270             20  CF-FEMALE-HEIGHT.
  2271                 24  CF-FEMALE-FT           PIC 99.
  2272                 24  CF-FEMALE-IN           PIC 99.
  2273             20  CF-FEMALE-MIN-WT           PIC 999.
  2274             20  CF-FEMALE-MAX-WT           PIC 999.
  2275         16  FILLER                         PIC X(428).
  2276
  2277     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2278         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  41
* SOCK03.cbl
  2279             20  CF-MALE-HEIGHT.
  2280                 24  CF-MALE-FT             PIC 99.
  2281                 24  CF-MALE-IN             PIC 99.
  2282             20  CF-MALE-MIN-WT             PIC 999.
  2283             20  CF-MALE-MAX-WT             PIC 999.
  2284         16  FILLER                         PIC X(428).
  2285******************************************************************
  2286*             AUTOMATIC ACTIVITY RECORD                          *
  2287******************************************************************
  2288     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2289         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2290             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2291             20  CF-SYS-LETTER-ID           PIC X(04).
  2292             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2293             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2294             20  CF-SYS-RESET-SW            PIC X(01).
  2295             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2296             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2297
  2298         16  FILLER                         PIC X(50).
  2299
  2300         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2301             20  CF-USER-ACTIVE-SW          PIC X(01).
  2302             20  CF-USER-LETTER-ID          PIC X(04).
  2303             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2304             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2305             20  CF-USER-RESET-SW           PIC X(01).
  2306             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2307             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2308             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2309
  2310         16  FILLER                         PIC X(246).
  2311*                                 COPY ERCACCT.
  2312******************************************************************
  2313*                                                                *
  2314*                                                                *
  2315*                            ERCACCT                             *
  2316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2317*                            VMOD=2.031                          *
  2318*                                                                *
  2319*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2320*                                                                *
  2321*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2322*   VSAM ACCOUNT MASTER FILES.                                   *
  2323*                                                                *
  2324*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2325*                                                                *
  2326*   FILE TYPE = VSAM,KSDS                                        *
  2327*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2328*                                                                *
  2329*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2330*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2331*                                                                *
  2332*   LOG = NO                                                     *
  2333*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2334*                                                                *
  2335*                                                                *
  2336******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  42
* SOCK03.cbl
  2337*                   C H A N G E   L O G
  2338*
  2339* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2340*-----------------------------------------------------------------
  2341*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2342* EFFECTIVE    NUMBER
  2343*-----------------------------------------------------------------
  2344* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2345* 092705    2005050300006  PEMA  ADD SPP LEASES
  2346* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2347* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2348* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2349* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2350* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2351******************************************************************
  2352
  2353 01  ACCOUNT-MASTER.
  2354     12  AM-RECORD-ID                      PIC XX.
  2355         88  VALID-AM-ID                      VALUE 'AM'.
  2356
  2357     12  AM-CONTROL-PRIMARY.
  2358         16  AM-COMPANY-CD                 PIC X.
  2359         16  AM-MSTR-CNTRL.
  2360             20  AM-CONTROL-A.
  2361                 24  AM-CARRIER            PIC X.
  2362                 24  AM-GROUPING.
  2363                     28 AM-GROUPING-PREFIX PIC XXX.
  2364                     28 AM-GROUPING-PRIME  PIC XXX.
  2365                 24  AM-STATE              PIC XX.
  2366                 24  AM-ACCOUNT.
  2367                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2368                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2369             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2370                                           PIC X(19).
  2371             20  AM-CNTRL-B.
  2372                 24  AM-EXPIRATION-DT      PIC XX.
  2373                 24  FILLER                PIC X(4).
  2374             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2375                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2376
  2377     12  AM-CONTROL-BY-VAR-GRP.
  2378         16  AM-COMPANY-CD-A1              PIC X.
  2379         16  AM-VG-CARRIER                 PIC X.
  2380         16  AM-VG-GROUPING                PIC X(6).
  2381         16  AM-VG-STATE                   PIC XX.
  2382         16  AM-VG-ACCOUNT                 PIC X(10).
  2383         16  AM-VG-DATE.
  2384             20  AM-VG-EXPIRATION-DT       PIC XX.
  2385             20  FILLER                    PIC X(4).
  2386         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2387                                           PIC 9(11)      COMP-3.
  2388     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2389         16  FILLER                        PIC X(10).
  2390         16  AM-VG-KEY3.
  2391             20  AM-VG3-ACCOUNT            PIC X(10).
  2392             20  AM-VG3-EXP-DT             PIC XX.
  2393         16  FILLER                        PIC X(4).
  2394     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  43
* SOCK03.cbl
  2395         16  AM-LAST-MAINT-DT              PIC XX.
  2396         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2397         16  AM-LAST-MAINT-USER            PIC X(4).
  2398         16  FILLER                        PIC XX.
  2399
  2400     12  AM-EFFECTIVE-DT                   PIC XX.
  2401     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2402
  2403     12  AM-PREV-DATES  COMP-3.
  2404         16  AM-PREV-EXP-DT                PIC 9(11).
  2405         16  AM-PREV-EFF-DT                PIC 9(11).
  2406
  2407     12  AM-REPORT-CODE-1                  PIC X(10).
  2408     12  AM-REPORT-CODE-2                  PIC X(10).
  2409
  2410     12  AM-CITY-CODE                      PIC X(4).
  2411     12  AM-COUNTY-PARISH                  PIC X(6).
  2412
  2413     12  AM-NAME                           PIC X(30).
  2414     12  AM-PERSON                         PIC X(30).
  2415     12  AM-ADDRS                          PIC X(30).
  2416     12  AM-CITY.
  2417         16  AM-ADDR-CITY                  PIC X(28).
  2418         16  AM-ADDR-STATE                 PIC XX.
  2419     12  AM-ZIP.
  2420         16  AM-ZIP-PRIME.
  2421             20  AM-ZIP-PRI-1ST            PIC X.
  2422                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2423             20  FILLER                    PIC X(4).
  2424         16  AM-ZIP-PLUS4                  PIC X(4).
  2425     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2426         16  AM-CAN-POSTAL-1               PIC XXX.
  2427         16  AM-CAN-POSTAL-2               PIC XXX.
  2428         16  FILLER                        PIC XXX.
  2429     12  AM-TEL-NO.
  2430         16  AM-AREA-CODE                  PIC 999.
  2431         16  AM-TEL-PRE                    PIC 999.
  2432         16  AM-TEL-NBR                    PIC 9(4).
  2433     12  AM-TEL-LOC                        PIC X.
  2434         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2435         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2436
  2437     12  AM-COMM-STRUCTURE.
  2438         16  AM-DEFN-1.
  2439             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2440                 24  AM-AGT.
  2441                     28  AM-AGT-PREFIX     PIC X(4).
  2442                     28  AM-AGT-PRIME      PIC X(6).
  2443                 24  AM-COM-TYP            PIC X.
  2444                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2445                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2446                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2447                 24  AM-RECALC-LV-INDIC    PIC X.
  2448                 24  AM-RETRO-LV-INDIC     PIC X.
  2449                 24  AM-GL-CODES           PIC X.
  2450                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2451                 24  FILLER                PIC X(01).
  2452         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  44
* SOCK03.cbl
  2453             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2454                 24  FILLER                PIC X(11).
  2455                 24  AM-L-COMA             PIC XXX.
  2456                 24  AM-J-COMA             PIC XXX.
  2457                 24  AM-A-COMA             PIC XXX.
  2458                 24  FILLER                PIC X(6).
  2459
  2460     12  AM-COMM-CHANGE-STATUS             PIC X.
  2461         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2462
  2463     12  AM-CSR-CODE                       PIC X(4).
  2464
  2465     12  AM-BILLING-STATUS                 PIC X.
  2466         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2467         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2468     12  AM-AUTO-REFUND-SW                 PIC X.
  2469         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2470         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2471     12  AM-GPCD                           PIC 99.
  2472     12  AM-IG                             PIC X.
  2473         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2474         88  AM-HAS-GROUP                     VALUE '2'.
  2475     12  AM-STATUS                         PIC X.
  2476         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2477         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2478         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2479         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2480         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2481         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2482     12  AM-REMIT-TO                       PIC 99.
  2483     12  AM-ID-NO                          PIC X(11).
  2484
  2485     12  AM-CAL-TABLE                      PIC XX.
  2486     12  AM-LF-DEVIATION                   PIC XXX.
  2487     12  AM-AH-DEVIATION                   PIC XXX.
  2488     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2489     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2490     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2491     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2492     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2493     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2494
  2495     12  AM-USER-FIELDS.
  2496         16  AM-FLD-1                      PIC XX.
  2497         16  AM-FLD-2                      PIC XX.
  2498         16  AM-FLD-3                      PIC XX.
  2499         16  AM-FLD-4                      PIC XX.
  2500         16  AM-FLD-5                      PIC XX.
  2501
  2502     12  AM-1ST-PROD-DATE.
  2503         16  AM-1ST-PROD-YR                PIC XX.
  2504         16  AM-1ST-PROD-MO                PIC XX.
  2505         16  AM-1ST-PROD-DA                PIC XX.
  2506     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2507     12  AM-CERTS-PURGED-DATE.
  2508         16  AM-PUR-YR                     PIC XX.
  2509         16  AM-PUR-MO                     PIC XX.
  2510         16  AM-PUR-DA                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  45
* SOCK03.cbl
  2511     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2512     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2513     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2514     12  AM-INACTIVE-DATE.
  2515         16  AM-INA-MO                     PIC 99.
  2516         16  AM-INA-DA                     PIC 99.
  2517         16  AM-INA-YR                     PIC 99.
  2518     12  AM-AR-HI-CERT-DATE                PIC XX.
  2519
  2520     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2521     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2522
  2523     12  AM-OB-PAYMENT-MODE                PIC X.
  2524         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2525         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2526         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2527         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2528
  2529     12  AM-AH-ONLY-INDICATOR              PIC X.
  2530         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2531         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2532
  2533     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2534
  2535     12  AM-OVER-SHORT.
  2536         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2537         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2538
  2539     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2540     12  AM-DCC-CLP-STATE                  PIC XX.
  2541
  2542     12  AM-RECALC-COMM                    PIC X.
  2543     12  AM-RECALC-REIN                    PIC X.
  2544
  2545     12  AM-REI-TABLE                      PIC XXX.
  2546     12  AM-REI-ET-LF                      PIC X.
  2547     12  AM-REI-ET-AH                      PIC X.
  2548     12  AM-REI-PE-LF                      PIC X.
  2549     12  AM-REI-PE-AH                      PIC X.
  2550     12  AM-REI-PRT-ST                     PIC X.
  2551     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2552     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2553     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2554     12  AM-REI-GROUP-A                    PIC X(6).
  2555     12  AM-REI-MORT                       PIC X(4).
  2556     12  AM-REI-PRT-OW                     PIC X.
  2557     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2558     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2559     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2560     12  AM-REI-GROUP-B                    PIC X(6).
  2561
  2562     12  AM-TRUST-TYPE                     PIC X(2).
  2563
  2564     12  AM-EMPLOYER-STMT-USED             PIC X.
  2565     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2566
  2567     12  AM-STD-AH-TYPE                    PIC XX.
  2568     12  AM-EARN-METHODS.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  46
* SOCK03.cbl
  2569         16  AM-EARN-METHOD-R              PIC X.
  2570             88 AM-REF-RL-R78                 VALUE 'R'.
  2571             88 AM-REF-RL-PR                  VALUE 'P'.
  2572             88 AM-REF-RL-MEAN                VALUE 'M'.
  2573             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2574         16  AM-EARN-METHOD-L              PIC X.
  2575             88 AM-REF-LL-R78                 VALUE 'R'.
  2576             88 AM-REF-LL-PR                  VALUE 'P'.
  2577             88 AM-REF-LL-MEAN                VALUE 'M'.
  2578             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2579         16  AM-EARN-METHOD-A              PIC X.
  2580             88 AM-REF-AH-R78                 VALUE 'R'.
  2581             88 AM-REF-AH-PR                  VALUE 'P'.
  2582             88 AM-REF-AH-MEAN                VALUE 'M'.
  2583             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2584             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2585             88 AM-REF-AH-NET                 VALUE 'N'.
  2586
  2587     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2588     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2589     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2590
  2591     12  AM-RET-Y-N                        PIC X.
  2592     12  AM-RET-P-E                        PIC X.
  2593     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2594     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2595     12  AM-RET-GRP                        PIC X(6).
  2596     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2597         16  AM-POOL-PRIME                 PIC XXX.
  2598         16  AM-POOL-SUB                   PIC XXX.
  2599     12  AM-RETRO-EARNINGS.
  2600         16  AM-RET-EARN-R                 PIC X.
  2601         16  AM-RET-EARN-L                 PIC X.
  2602         16  AM-RET-EARN-A                 PIC X.
  2603     12  AM-RET-ST-TAX-USE                 PIC X.
  2604         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2605         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2606     12  AM-RETRO-BEG-EARNINGS.
  2607         16  AM-RET-BEG-EARN-R             PIC X.
  2608         16  AM-RET-BEG-EARN-L             PIC X.
  2609         16  AM-RET-BEG-EARN-A             PIC X.
  2610     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2611     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2612
  2613     12  AM-USER-SELECT-OPTIONS.
  2614         16  AM-USER-SELECT-1              PIC X(10).
  2615         16  AM-USER-SELECT-2              PIC X(10).
  2616         16  AM-USER-SELECT-3              PIC X(10).
  2617         16  AM-USER-SELECT-4              PIC X(10).
  2618         16  AM-USER-SELECT-5              PIC X(10).
  2619
  2620     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2621
  2622     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2623
  2624     12  AM-RPT045A-SWITCH                 PIC X.
  2625         88  RPT045A-OFF                   VALUE 'N'.
  2626
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  47
* SOCK03.cbl
  2627     12  AM-INSURANCE-LIMITS.
  2628         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2629         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2630
  2631     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2632         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2633
  2634     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2635         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2636         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2637
  2638     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2639
  2640     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2641     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2642     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2643     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2644     12  AM-DCC-UEF-STATE                  PIC XX.
  2645     12  FILLER                            PIC XXX.
  2646     12  AM-REPORT-CODE-3                  PIC X(10).
  2647*    12  FILLER                            PIC X(22).
  2648
  2649     12  AM-RESERVE-DATE.
  2650         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2651         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2652         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2653
  2654     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2655     12  AM-NOTIFICATION-TYPES.
  2656         16  AM-NOTIF-OF-LETTERS           PIC X.
  2657         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2658         16  AM-NOTIF-OF-REPORTS           PIC X.
  2659         16  AM-NOTIF-OF-STATUS            PIC X.
  2660
  2661     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2662         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2663         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2664         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2665         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2666
  2667     12  AM-BENEFIT-CONTROLS.
  2668         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2669             20  AM-BENEFIT-CODE           PIC XX.
  2670             20  AM-BENEFIT-TYPE           PIC X.
  2671             20  AM-BENEFIT-REVISION       PIC XXX.
  2672             20  AM-BENEFIT-REM-TERM       PIC X.
  2673             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2674             20  FILLER                    PIC XX.
  2675         16  FILLER                        PIC X(80).
  2676
  2677     12  AM-TRANSFER-DATA.
  2678         16  AM-TRANSFERRED-FROM.
  2679             20  AM-TRNFROM-CARRIER        PIC X.
  2680             20  AM-TRNFROM-GROUPING.
  2681                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2682                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2683             20  AM-TRNFROM-STATE          PIC XX.
  2684             20  AM-TRNFROM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  48
* SOCK03.cbl
  2685                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2686                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2687             20  AM-TRNFROM-DTE            PIC XX.
  2688         16  AM-TRANSFERRED-TO.
  2689             20  AM-TRNTO-CARRIER          PIC X.
  2690             20  AM-TRNTO-GROUPING.
  2691                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2692                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2693             20  AM-TRNTO-STATE            PIC XX.
  2694             20  AM-TRNTO-ACCOUNT.
  2695                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2696                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2697             20  AM-TRNTO-DTE              PIC XX.
  2698         16  FILLER                        PIC X(10).
  2699
  2700     12  AM-SAVED-REMIT-TO                 PIC 99.
  2701
  2702     12  AM-COMM-STRUCTURE-SAVED.
  2703         16  AM-DEFN-1-SAVED.
  2704             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2705                 24  AM-AGT-SV             PIC X(10).
  2706                 24  AM-COM-TYP-SV         PIC X.
  2707                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2708                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2709                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2710                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2711                 24  FILLER                PIC X.
  2712                 24  AM-GL-CODES-SV        PIC X.
  2713                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2714                 24  FILLER                PIC X.
  2715         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2716             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2717                 24  FILLER                PIC X(11).
  2718                 24  AM-L-COMA-SV          PIC XXX.
  2719                 24  AM-J-COMA-SV          PIC XXX.
  2720                 24  AM-A-COMA-SV          PIC XXX.
  2721                 24  FILLER                PIC X(6).
  2722
  2723     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2724         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2725            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2726            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2727            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2728
  2729     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2730     12  FILLER                            PIC X(120).
  2731
  2732     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2733         16  AM-CONTROL-NAME               PIC X(30).
  2734         16  AM-EXECUTIVE-ONE.
  2735             20  AM-EXEC1-NAME             PIC X(15).
  2736             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2737                                                          COMP-3.
  2738             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2739                                                          COMP-3.
  2740         16  AM-EXECUTIVE-TWO.
  2741             20  AM-EXEC2-NAME             PIC X(15).
  2742             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  49
* SOCK03.cbl
  2743                                                          COMP-3.
  2744             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2745                                                          COMP-3.
  2746
  2747     12  AM-RETRO-ADDITIONAL-DATA.
  2748         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2749         16  AM-RETRO-PREM-P-E             PIC X.
  2750         16  AM-RETRO-CLMS-P-I             PIC X.
  2751         16  AM-RETRO-RET-BRACKET-LF.
  2752             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2753                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2754                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2755             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2756                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2757                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2758             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2759                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2760                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2761         16  AM-RETRO-RET-BRACKET-AH.
  2762             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2763                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2764                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2765                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2766             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2767                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2768                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2769             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2770                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2771                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2772
  2773     12  AM-COMMENTS.
  2774         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2775
  2776     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2777         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2778         16  AM-FLI-BILLING-CODE           PIC X.
  2779         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2780         16  AM-FLI-UNITED-IDENT           PIC X.
  2781         16  AM-FLI-INTEREST-LOST-DATA.
  2782             20  AM-FLI-BANK-NO            PIC X(5).
  2783             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2784             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2785             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2786         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2787             20  AM-FLI-AGT                PIC X(9).
  2788             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2789             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2790         16  FILLER                        PIC X(102).
  2791
  2792     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2793         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2794             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2795             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2796             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2797             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2798             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2799         16  FILLER                          PIC X(10).
  2800******************************************************************
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  50
* SOCK03.cbl
  2801*                                 COPY ELCDATE.
  2802******************************************************************
  2803*                                                                *
  2804*                                                                *
  2805*                            ELCDATE.                            *
  2806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2807*                            VMOD=2.003
  2808*                                                                *
  2809*                                                                *
  2810*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2811*                 LENGTH = 200                                   *
  2812******************************************************************
  2813
  2814 01  DATE-CONVERSION-DATA.
  2815     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2816     12  DC-OPTION-CODE                PIC X.
  2817         88  BIN-TO-GREG                VALUE ' '.
  2818         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2819         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2820         88  YMD-GREG-TO-BIN            VALUE '3'.
  2821         88  MDY-GREG-TO-BIN            VALUE '4'.
  2822         88  JULIAN-TO-BIN              VALUE '5'.
  2823         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2824         88  FIND-CENTURY               VALUE '7'.
  2825         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2826         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2827         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2828         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2829         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2830         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2831         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2832         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2833         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2834         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2835         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2836         88  BIN-3-TO-GREG              VALUE 'I'.
  2837         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2838         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2839         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2840         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2841         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2842         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2843         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2844         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2845         88  THREE-CHARACTER-BIN
  2846                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2847         88  GREGORIAN-TO-BIN
  2848                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2849         88  BIN-TO-GREGORIAN
  2850                  VALUES ' ' '1' 'I' '8' 'G'.
  2851         88  JULIAN-TO-BINARY
  2852                  VALUES '5' 'C' 'E' 'F'.
  2853     12  DC-ERROR-CODE                 PIC X.
  2854         88  NO-CONVERSION-ERROR        VALUE ' '.
  2855         88  DATE-CONVERSION-ERROR
  2856                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2857         88  DATE-IS-ZERO               VALUE '1'.
  2858         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  51
* SOCK03.cbl
  2859         88  DATE-IS-INVALID            VALUE '3'.
  2860         88  DATE1-GREATER-DATE2        VALUE '4'.
  2861         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2862         88  DATE-INVALID-OPTION        VALUE '9'.
  2863         88  INVALID-CENTURY            VALUE 'A'.
  2864         88  ONLY-CENTURY               VALUE 'B'.
  2865         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2866         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2867     12  DC-END-OF-MONTH               PIC X.
  2868         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2869     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2870         88  USE-NORMAL-PROCESS         VALUE ' '.
  2871         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2872         88  ADJUST-UP-100-YRS          VALUE '2'.
  2873     12  FILLER                        PIC X.
  2874     12  DC-CONVERSION-DATES.
  2875         16  DC-BIN-DATE-1             PIC XX.
  2876         16  DC-BIN-DATE-2             PIC XX.
  2877         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2878         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2879                       DC-GREG-DATE-1-EDIT.
  2880             20  DC-EDIT1-MONTH        PIC 99.
  2881             20  SLASH1-1              PIC X.
  2882             20  DC-EDIT1-DAY          PIC 99.
  2883             20  SLASH1-2              PIC X.
  2884             20  DC-EDIT1-YEAR         PIC 99.
  2885         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2886         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2887                     DC-GREG-DATE-2-EDIT.
  2888             20  DC-EDIT2-MONTH        PIC 99.
  2889             20  SLASH2-1              PIC X.
  2890             20  DC-EDIT2-DAY          PIC 99.
  2891             20  SLASH2-2              PIC X.
  2892             20  DC-EDIT2-YEAR         PIC 99.
  2893         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2894         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2895                     DC-GREG-DATE-1-YMD.
  2896             20  DC-YMD-YEAR           PIC 99.
  2897             20  DC-YMD-MONTH          PIC 99.
  2898             20  DC-YMD-DAY            PIC 99.
  2899         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2900         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2901                      DC-GREG-DATE-1-MDY.
  2902             20  DC-MDY-MONTH          PIC 99.
  2903             20  DC-MDY-DAY            PIC 99.
  2904             20  DC-MDY-YEAR           PIC 99.
  2905         16  DC-GREG-DATE-1-ALPHA.
  2906             20  DC-ALPHA-MONTH        PIC X(10).
  2907             20  DC-ALPHA-DAY          PIC 99.
  2908             20  FILLER                PIC XX.
  2909             20  DC-ALPHA-CENTURY.
  2910                 24 DC-ALPHA-CEN-N     PIC 99.
  2911             20  DC-ALPHA-YEAR         PIC 99.
  2912         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2913         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2914         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2915         16  DC-JULIAN-DATE            PIC 9(05).
  2916         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  52
* SOCK03.cbl
  2917                                       PIC 9(05).
  2918         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2919             20  DC-JULIAN-YEAR        PIC 99.
  2920             20  DC-JULIAN-DAYS        PIC 999.
  2921         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2922         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2923         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2924     12  DATE-CONVERSION-VARIBLES.
  2925         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2926         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2927             20  FILLER                PIC 9(3).
  2928             20  HOLD-CEN-1-CCYY.
  2929                 24  HOLD-CEN-1-CC     PIC 99.
  2930                 24  HOLD-CEN-1-YY     PIC 99.
  2931             20  HOLD-CEN-1-MO         PIC 99.
  2932             20  HOLD-CEN-1-DA         PIC 99.
  2933         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2934             20  HOLD-CEN-1-R-MO       PIC 99.
  2935             20  HOLD-CEN-1-R-DA       PIC 99.
  2936             20  HOLD-CEN-1-R-CCYY.
  2937                 24  HOLD-CEN-1-R-CC   PIC 99.
  2938                 24  HOLD-CEN-1-R-YY   PIC 99.
  2939             20  FILLER                PIC 9(3).
  2940         16  HOLD-CENTURY-1-X.
  2941             20  FILLER                PIC X(3)  VALUE SPACES.
  2942             20  HOLD-CEN-1-X-CCYY.
  2943                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2944                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2945             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2946             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2947         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2948             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2949             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2950             20  HOLD-CEN-1-R-X-CCYY.
  2951                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2952                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2953             20  FILLER                PIC XXX.
  2954         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2955         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2956         16  DC-JULIAN-DATE-1          PIC 9(07).
  2957         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2958             20  DC-JULIAN-1-CCYY.
  2959                 24  DC-JULIAN-1-CC    PIC 99.
  2960                 24  DC-JULIAN-1-YR    PIC 99.
  2961             20  DC-JULIAN-DA-1        PIC 999.
  2962         16  DC-JULIAN-DATE-2          PIC 9(07).
  2963         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2964             20  DC-JULIAN-2-CCYY.
  2965                 24  DC-JULIAN-2-CC    PIC 99.
  2966                 24  DC-JULIAN-2-YR    PIC 99.
  2967             20  DC-JULIAN-DA-2        PIC 999.
  2968         16  DC-GREG-DATE-A-EDIT.
  2969             20  DC-EDITA-MONTH        PIC 99.
  2970             20  SLASHA-1              PIC X VALUE '/'.
  2971             20  DC-EDITA-DAY          PIC 99.
  2972             20  SLASHA-2              PIC X VALUE '/'.
  2973             20  DC-EDITA-CCYY.
  2974                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  53
* SOCK03.cbl
  2975                 24  DC-EDITA-YEAR     PIC 99.
  2976         16  DC-GREG-DATE-B-EDIT.
  2977             20  DC-EDITB-MONTH        PIC 99.
  2978             20  SLASHB-1              PIC X VALUE '/'.
  2979             20  DC-EDITB-DAY          PIC 99.
  2980             20  SLASHB-2              PIC X VALUE '/'.
  2981             20  DC-EDITB-CCYY.
  2982                 24  DC-EDITB-CENT     PIC 99.
  2983                 24  DC-EDITB-YEAR     PIC 99.
  2984         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2985         16  DC-GREG-DATE-CYMD-R REDEFINES
  2986                              DC-GREG-DATE-CYMD.
  2987             20  DC-CYMD-CEN           PIC 99.
  2988             20  DC-CYMD-YEAR          PIC 99.
  2989             20  DC-CYMD-MONTH         PIC 99.
  2990             20  DC-CYMD-DAY           PIC 99.
  2991         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2992         16  DC-GREG-DATE-MDCY-R REDEFINES
  2993                              DC-GREG-DATE-MDCY.
  2994             20  DC-MDCY-MONTH         PIC 99.
  2995             20  DC-MDCY-DAY           PIC 99.
  2996             20  DC-MDCY-CEN           PIC 99.
  2997             20  DC-MDCY-YEAR          PIC 99.
  2998    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2999        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3000    12  DC-EL310-DATE                  PIC X(21).
  3001    12  FILLER                         PIC X(28).
  3002*                                 COPY ELCCALC.
  3003******************************************************************
  3004*                                                                *
  3005*                           ELCCALC.                            *
  3006*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3007*                            VMOD=2.025                          *
  3008*                                                                *
  3009*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3010*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3011*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3012*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3013*                                                                *
  3014*  PASSED TO ELRTRM                                              *
  3015*  -----------------                                             *
  3016*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3017*  ORIGINAL TERM                                                 *
  3018*  BEGINNING DATE                                                *
  3019*  ENDING DATE                                                   *
  3020*  COMPANY I.D.                                                  *
  3021*  ACCOUNT MASTER USER FIELD                                     *
  3022*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3023*  FREE LOOK DAYS                                                *
  3024*                                                                *
  3025*  RETURNED FROM ELRTRM                                          *
  3026*  ---------------------                                         *
  3027*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3028*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3029*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3030*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3031*----------------------------------------------------------------*
  3032*  PASSED TO ELRAMT                                              *
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  54
* SOCK03.cbl
  3033*  ----------------                                              *
  3034*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3035*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3036*  ORIGINAL AMOUNT                                               *
  3037*  ALTERNATE BENEFIT (BALLON)                                    *
  3038*  A.P.R. - NET PAY ONLY                                         *
  3039*  METHOD
  3040*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3041*  COMPANY I.D.                                                  *
  3042*  BENEFIT TYPE                                                  *
  3043*                                                                *
  3044*  RETURNED FROM ELRAMT                                          *
  3045*  --------------------                                          *
  3046*  REMAINING AMOUNT 1 - CURRENT                                  *
  3047*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3048*  REMAINING AMOUNT FACTOR
  3049*----------------------------------------------------------------*
  3050*  PASSED TO ELRESV                                              *
  3051*  -----------------                                             *
  3052*  CERTIFICATE EFFECTIVE DATE                                    *
  3053*  VALUATION DATE                                                *
  3054*  PAID THRU DATE                                                *
  3055*  BENEFIT                                                       *
  3056*  INCURRED DATE                                                 *
  3057*  REPORTED DATE                                                 *
  3058*  ISSUE AGE                                                     *
  3059*  TERM                                                          *
  3060*  CDT PERCENT                                                   *
  3061*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3062* *CLAIM TYPE (LIFE, A/H)                                        *
  3063* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3064* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3065*                                                                *
  3066*  RETURNED FROM ELRESV                                          *
  3067*  --------------------                                          *
  3068*  CDT TABLE USED                                                *
  3069*  CDT FACTOR USED                                               *
  3070*  PAY TO CURRENT RESERVE                                        *
  3071*  I.B.N.R. - A/H ONLY                                           *
  3072*  FUTURE (ACCRUED) AH ONLY                                      *
  3073*----------------------------------------------------------------*
  3074*  PASSED TO ELRATE                                              *
  3075*  ----------------                                              *
  3076*  CERT ISSUE DATE                                               *
  3077*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3078*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3079*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3080*  STATE CODE (CLIENT DEFINED)                                   *
  3081*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3082*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3083*  DEVIATION CODE                                                *
  3084*  ISSUE AGE                                                     *
  3085*  ORIGINAL BENEFIT AMOUNT                                       *
  3086*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3087*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3088*  BENEFIT KIND (LIFE OR A/H)                                    *
  3089*  A.P.R.                                                        *
  3090*  METHOD
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  55
* SOCK03.cbl
  3091*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3092*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3093*  COMPANY I.D. (3 CHARACTER)                                    *
  3094*  BENEFIT CODE                                                  *
  3095*  BENEFIT OVERRIDE CODE                                         *
  3096*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3097*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3098*  JOINT INDICATOR (CSL ONLY)                                    *
  3099*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3100*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3101*                                                                *
  3102*  RETURNED FROM ELRATE                                          *
  3103*  --------------------                                          *
  3104*  CALCULATED PREMIUM                                            *
  3105*  PREMIUM RATE                                                  *
  3106*  MORTALITY CODE                                                *
  3107*  MAX ATTAINED AGE                                              *
  3108*  MAX AGE                                                       *
  3109*  MAX TERM                                                      *
  3110*  MAX MONTHLY BENEFIT                                           *
  3111*  MAX TOTAL BENIFIT                                             *
  3112*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3113*----------------------------------------------------------------*
  3114*  PASSED TO ELRFND                                              *
  3115*  ----------------                                              *
  3116*  CERT ISSUE DATE                                               *
  3117*  REFUND DATE                                                   *
  3118*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3119*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3120*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3121*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3122*  STATE CODE (CLIENT DEFINED)                                   *
  3123*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3124*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3125*  DEVIATION CODE                                                *
  3126*  ISSUE AGE                                                     *
  3127*  ORIGINAL BENEFIT AMOUNT                                       *
  3128*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3129*  PROCESS TYPE (CANCEL)                                         *
  3130*  BENEFIT KIND (LIFE OR A/H)                                    *
  3131*  A.P.R.                                                        *
  3132*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3133*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3134*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3135*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3136*  COMPANY I.D. (3 CHARACTER)                                    *
  3137*  BENEFIT CODE                                                  *
  3138*  BENEFIT OVERRIDE CODE                                         *
  3139*                                                                *
  3140*  RETURNED FROM ELRFND                                          *
  3141*  --------------------                                          *
  3142*  CALCULATED REFUND                                             *
  3143*----------------------------------------------------------------*
  3144*  PASSED TO ELEARN                                              *
  3145*  ----------------                                              *
  3146*  CERT ISSUE DATE                                               *
  3147*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3148*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  56
* SOCK03.cbl
  3149*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3150*  STATE CODE (CLIENT DEFINED)                                   *
  3151*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3152*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3153*  DEVIATION CODE                                                *
  3154*  ISSUE AGE                                                     *
  3155*  ORIGINAL BENEFIT AMOUNT                                       *
  3156*  BENEFIT KIND (LIFE OR A/H)                                    *
  3157*  A.P.R.                                                        *
  3158*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3159*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3160*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3161*  COMPANY I.D. (3 CHARACTER)                                    *
  3162*  BENEFIT CODE                                                  *
  3163*  BENEFIT OVERRIDE CODE                                         *
  3164*                                                                *
  3165*  RETURNED FROM ELEARN                                          *
  3166*  --------------------                                          *
  3167*  INDICATED  EARNINGS                                           *
  3168*----------------------------------------------------------------*
  3169*                 LENGTH = 450                                   *
  3170*                                                                *
  3171******************************************************************
  3172******************************************************************
  3173*                   C H A N G E   L O G
  3174*
  3175* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3176*-----------------------------------------------------------------
  3177*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3178* EFFECTIVE    NUMBER
  3179*-----------------------------------------------------------------
  3180* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3181* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3182* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3183* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3184* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3185* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3186* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3187* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3188* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3189******************************************************************
  3190
  3191 01  CALCULATION-PASS-AREA.
  3192     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3193                                     COMP.
  3194
  3195     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3196       88  NO-CP-ERROR                             VALUE ZERO.
  3197       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3198                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3199       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3200       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3201       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3202       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3203       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3204       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3205       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3206       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  57
* SOCK03.cbl
  3207       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3208       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3209       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3210       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3211       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3212       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3213       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3214       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3215       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3216
  3217     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3218       88  NO-CP-ERROR-2                           VALUE ZERO.
  3219***********************  INPUT AREAS ****************************
  3220
  3221     12  CP-CALCULATION-AREA.
  3222         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3223         16  CP-CERT-EFF-DT        PIC XX.
  3224         16  CP-VALUATION-DT       PIC XX.
  3225         16  CP-PAID-THRU-DT       PIC XX.
  3226         16  CP-BENEFIT-TYPE       PIC X.
  3227           88  CP-AH                               VALUE 'A' 'D'
  3228                                                   'I' 'U'.
  3229           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3230           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3231         16  CP-INCURRED-DT        PIC XX.
  3232         16  CP-REPORTED-DT        PIC XX.
  3233         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3234         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3235         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3236                                     COMP-3.
  3237         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3238                                     COMP-3.
  3239         16  CP-CDT-METHOD         PIC X.
  3240           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3241           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3242           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3243         16  CP-CLAIM-TYPE         PIC X.
  3244           88  CP-AH-CLAIM                         VALUE 'A'.
  3245           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3246         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3247                                     COMP-3.
  3248         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3249                                     COMP-3.
  3250         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3251                                     COMP-3.
  3252         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3253                                     COMP-3.
  3254         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3255                                     COMP-3.
  3256         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3257                                     COMP-3.
  3258         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3259                                     COMP-3.
  3260         16  CP-REM-TERM-METHOD    PIC X.
  3261           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3262           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3263           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3264           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  58
* SOCK03.cbl
  3265           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3266           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3267           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3268         16  CP-EARNING-METHOD     PIC X.
  3269           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3270           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3271           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3272           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3273           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3274           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3275           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3276           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3277           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3278           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3279           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3280           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3281           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3282           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3283         16  CP-PROCESS-TYPE       PIC X.
  3284           88  CP-CLAIM                            VALUE '1'.
  3285           88  CP-CANCEL                           VALUE '2'.
  3286           88  CP-ISSUE                            VALUE '3'.
  3287         16  CP-SPECIAL-CALC-CD    PIC X.
  3288           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3289           88  CP-1-MTH-INTEREST               VALUE ' '.
  3290           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3291           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3292           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3293           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3294           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3295           88  CP-FARM-PLAN                    VALUE 'F'.
  3296           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3297           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3298           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3299           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3300           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3301           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3302           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3303           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3304           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3305           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3306                                                     'W' 'X'.
  3307           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3308           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3309           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3310           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3311           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3312           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3313           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3314           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3315           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3316           88  CP-CSL-METH-1                   VALUE '5'.
  3317           88  CP-CSL-METH-2                   VALUE '6'.
  3318           88  CP-CSL-METH-3                   VALUE '7'.
  3319           88  CP-CSL-METH-4                   VALUE '8'.
  3320
  3321         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3322                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  59
* SOCK03.cbl
  3323         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3324         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3325         16  CP-STATE              PIC XX          VALUE SPACE.
  3326         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3327         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3328           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3329               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3330         16  CP-R78-OPTION         PIC X.
  3331           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3332           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3333
  3334         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3335         16  CP-IBNR-RESERVE-SW    PIC X.
  3336         16  CP-CLAIM-STATUS       PIC X.
  3337         16  CP-RATE-FILE          PIC X.
  3338         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3339                                     COMP-3.
  3340
  3341         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3342         16  CP-AH-OVERRIDE-CODE   PIC X.
  3343
  3344         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3345                                     COMP-3.
  3346         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3347                                   PIC S9(5)V99 COMP-3.
  3348         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3349                                     COMP-3.
  3350         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3351                                     COMP-3.
  3352         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3353                                     COMP-3.
  3354         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3355                                  PIC S9(7)V99 COMP-3.
  3356
  3357         16  CP-PAID-FROM-DATE     PIC X(02).
  3358         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3359         16  CP-EXT-DAYS-CALC      PIC X.
  3360           88  CP-EXT-NO-CHG                   VALUE ' '.
  3361           88  CP-EXT-CHG-LF                   VALUE '1'.
  3362           88  CP-EXT-CHG-AH                   VALUE '2'.
  3363           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3364         16  CP-DOMICILE-STATE     PIC XX.
  3365         16  CP-CARRIER            PIC X.
  3366         16  CP-REIN-FLAG          PIC X.
  3367         16  CP-REM-TRM-CALC-OPTION PIC X.
  3368           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3369                      '2' '3' '4' '5'.
  3370           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3371           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3372           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3373           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3374           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3375           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3376           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3377           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3378         16  CP-SIG-SWITCH         PIC X.
  3379         16  CP-RATING-METHOD      PIC X.
  3380           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  60
* SOCK03.cbl
  3381           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3382           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3383           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3384           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3385           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3386           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3387           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3388           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3389         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3390                                     COMP-3.
  3391         16  CP-BEN-CATEGORY       PIC X.
  3392         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3393         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3394                                   PIC S99V9(5) COMP-3.
  3395         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3396         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3397                                   PIC S99V9(5) COMP-3.
  3398         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3399         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3400         16  CP-EXPIRE-DT          PIC XX.
  3401         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3402         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3403         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3404         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3405         16  CP-DDF-SPEC-CALC      PIC X.
  3406             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3407             88  CP-CALC-CLP              VALUE 'C'.
  3408         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3409         16  CP-CANCEL-REASON      PIC X.
  3410         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3411         16  CP-PMT-MODE           PIC X.
  3412         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3413         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3414         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3415         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3416         16  FILLER                PIC X.
  3417
  3418***************    OUTPUT FROM ELRESV   ************************
  3419
  3420         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3421
  3422         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3423                                     COMP-3.
  3424         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3425                                     COMP-3.
  3426         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3427                                     COMP-3.
  3428         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3429                                     COMP-3.
  3430         16  FILLER                PIC X(09).
  3431***************    OUTPUT FROM ELRTRM   *************************
  3432
  3433         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3434                                     COMP-3.
  3435         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3436                                     COMP-3.
  3437         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3438                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  61
* SOCK03.cbl
  3439         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3440                                     COMP-3.
  3441         16  FILLER                PIC X(12).
  3442
  3443***************    OUTPUT FROM ELRAMT   *************************
  3444
  3445         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3446                                     COMP-3.
  3447         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3448                                     COMP-3.
  3449         16  FILLER                PIC X(12).
  3450
  3451***************    OUTPUT FROM ELRATE   *************************
  3452
  3453         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3454                                     COMP-3.
  3455         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3456                                     COMP-3.
  3457         16  CP-MORTALITY-CODE     PIC X(4).
  3458         16  CP-RATE-EDIT-FLAG     PIC X.
  3459             88  CP-RATES-NEED-APR                  VALUE '1'.
  3460         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3461                                     COMP-3.
  3462         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3463         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3464         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3465                                   PIC S9(7)V99 COMP-3.
  3466         16  FILLER                PIC X(07).
  3467
  3468***************    OUTPUT FROM ELRFND   *************************
  3469
  3470         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-REFUND-TYPE-USED   PIC X.
  3473           88  CP-R-AS-R78                         VALUE '1'.
  3474           88  CP-R-AS-PRORATA                     VALUE '2'.
  3475           88  CP-R-AS-CALIF                       VALUE '3'.
  3476           88  CP-R-AS-TEXAS                       VALUE '4'.
  3477           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3478           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3479           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3480           88  CP-R-AS-MEAN                        VALUE '8'.
  3481           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3482           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3483           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3484           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3485           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3486           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3487         16  FILLER                PIC X(12).
  3488
  3489***************    OUTPUT FROM ELEARN   *************************
  3490
  3491         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3492                                     COMP-3.
  3493         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3494                                     COMP-3.
  3495         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3496                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  62
* SOCK03.cbl
  3497         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3498                                     COMP-3.
  3499         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3500                                     COMP-3.
  3501         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3502                                     COMP-3.
  3503         16  CP-EARNING-TYPE-USED  PIC X.
  3504           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3505           88  CP-E-AS-R78                         VALUE '1'.
  3506           88  CP-E-AS-PRORATA                     VALUE '2'.
  3507           88  CP-E-AS-TEXAS                       VALUE '4'.
  3508           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3509           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3510           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3511           88  CP-E-AS-MEAN                        VALUE '8'.
  3512           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3513         16  FILLER                PIC X(12).
  3514
  3515***************    OUTPUT FROM ELPMNT   *************************
  3516
  3517         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3518                                     COMP-3.
  3519         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3520                                     COMP-3.
  3521         16  FILLER                PIC X(12).
  3522
  3523***************   MISC WORK AREAS    *****************************
  3524         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3525                                     COMP-3.
  3526         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3527                                     COMP-3.
  3528         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3529                                     COMP-3.
  3530         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3531                                     COMP-3.
  3532         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3533                                     COMP-3.
  3534         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3535                                     COMP-3.
  3536         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3537             88  OPEN-RATE-FILE                   VALUE 'O'.
  3538             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3539             88  IO-ERROR                         VALUE 'E'.
  3540
  3541         16  CP-FIRST-PAY-DATE     PIC XX.
  3542
  3543         16  CP-JOINT-INDICATOR    PIC X.
  3544
  3545         16  CP-RESERVE-REMAINING-TERM
  3546                                   PIC S9(4)V9    VALUE ZERO
  3547                                     COMP-3.
  3548
  3549         16  CP-INSURED-BIRTH-DT   PIC XX.
  3550
  3551         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3552                                     COMP-3.
  3553
  3554         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  63
* SOCK03.cbl
  3555                                     COMP-3.
  3556
  3557         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3558                                     COMP-3.
  3559
  3560         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3561                                     COMP-3.
  3562
  3563         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3564                                     COMP-3.
  3565
  3566         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3567                                     COMP-3.
  3568
  3569         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3570                                     COMP-3.
  3571
  3572         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3573             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3574
  3575         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3576                                     COMP-3.
  3577         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3580         16  FILLER                PIC X(15).
  3581******************************************************************
  3582****************************************************************
  3583*
  3584* Copyright (c) 2007 by Clerity Solutions, Inc.
  3585* All rights reserved.
  3586*
  3587****************************************************************
  3588 01  DFHEIV.
  3589   02  DFHEIV0               PIC X(35).
  3590   02  DFHEIV1               PIC X(08).
  3591   02  DFHEIV2               PIC X(08).
  3592   02  DFHEIV3               PIC X(08).
  3593   02  DFHEIV4               PIC X(06).
  3594   02  DFHEIV5               PIC X(04).
  3595   02  DFHEIV6               PIC X(04).
  3596   02  DFHEIV7               PIC X(02).
  3597   02  DFHEIV8               PIC X(02).
  3598   02  DFHEIV9               PIC X(01).
  3599   02  DFHEIV10              PIC S9(7) COMP-3.
  3600   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3601   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3602   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3603   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3604   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3605   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3606   02  DFHEIV17              PIC X(04).
  3607   02  DFHEIV18              PIC X(04).
  3608   02  DFHEIV19              PIC X(04).
  3609   02  DFHEIV20              USAGE IS POINTER.
  3610   02  DFHEIV21              USAGE IS POINTER.
  3611   02  DFHEIV22              USAGE IS POINTER.
  3612   02  DFHEIV23              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  64
* SOCK03.cbl
  3613   02  DFHEIV24              USAGE IS POINTER.
  3614   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3615   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3616   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3617   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3618   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3619   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3620   02  FILLER                PIC X(02).
  3621   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3622   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3623   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3624   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3625   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3626 LINKAGE  SECTION.
  3627*****************************************************************
  3628*                                                               *
  3629* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3630* All rights reserved.                                          *
  3631*                                                               *
  3632*****************************************************************
  3633 01  dfheiblk.
  3634     02  eibtime          pic s9(7) comp-3.
  3635     02  eibdate          pic s9(7) comp-3.
  3636     02  eibtrnid         pic x(4).
  3637     02  eibtaskn         pic s9(7) comp-3.
  3638     02  eibtrmid         pic x(4).
  3639     02  dfheigdi         pic s9(4) comp.
  3640     02  eibcposn         pic s9(4) comp.
  3641     02  eibcalen         pic s9(4) comp.
  3642     02  eibaid           pic x(1).
  3643     02  eibfiller1       pic x(1).
  3644     02  eibfn            pic x(2).
  3645     02  eibfiller2       pic x(2).
  3646     02  eibrcode         pic x(6).
  3647     02  eibfiller3       pic x(2).
  3648     02  eibds            pic x(8).
  3649     02  eibreqid         pic x(8).
  3650     02  eibrsrce         pic x(8).
  3651     02  eibsync          pic x(1).
  3652     02  eibfree          pic x(1).
  3653     02  eibrecv          pic x(1).
  3654     02  eibsend          pic x(1).
  3655     02  eibatt           pic x(1).
  3656     02  eibeoc           pic x(1).
  3657     02  eibfmh           pic x(1).
  3658     02  eibcompl         pic x(1).
  3659     02  eibsig           pic x(1).
  3660     02  eibconf          pic x(1).
  3661     02  eiberr           pic x(1).
  3662     02  eibrldbk         pic x(1).
  3663     02  eiberrcd         pic x(4).
  3664     02  eibsynrb         pic x(1).
  3665     02  eibnodat         pic x(1).
  3666     02  eibfiller5       pic x(2).
  3667     02  eibresp          pic 9(09) comp.
  3668     02  eibresp2         pic 9(09) comp.
  3669     02  dfheigdj         pic s9(4) comp.
  3670     02  dfheigdk         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  65
* SOCK03.cbl
  3671 01  DFHCOMMAREA.
  3672   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3673   05 LSTN-NAME                PIC X(8).
  3674   05 LSTN-SUBNAME             PIC X(8).
  3675   05 CLIENT-IN-DATA.
  3676      15  CLIENT-CAR           PIC X.
  3677      15  CLIENT-GRP           PIC X(6).
  3678      15  CLIENT-STATE         PIC XX.
  3679      15  CLIENT-ACCOUNT       PIC X(10).
  3680*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3681      15  CLIENT-EFF-DT        PIC X(8).
  3682      15  CLIENT-CERT-NO       PIC X(11).
  3683      15  CLIENT-LAST-NAME     PIC X(15).
  3684      15  CLIENT-FIRST-NAME    PIC X(10).
  3685      15  CLIENT-VAL-DT        PIC X(8).
  3686   05 SOCKADDR-IN-PARM.
  3687     15 SIN-FAMILY             PIC 9(4) COMP.
  3688     15 SIN-PORT               PIC 9(4) COMP.
  3689     15 SIN-ADDRESS            PIC 9(8) COMP.
  3690     15 SIN-ZERO               PIC X(8).
  3691 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3692 0000-DFHEXIT SECTION.
  3693     MOVE '9#                    $   ' TO DFHEIV0.
  3694     MOVE 'SOCK03' TO DFHEIV1.
  3695     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3696     display '  BEGIN SOCK03 '
  3697     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3698     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3699     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3700        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3701        IF CLIENT-IN-DATA (8:3) = 'DCC'
  3702           MOVE X'05'            TO WS-COMP-CD
  3703           MOVE 'DCC'            TO WS-SEND-BUF (5:3)
  3704                                    WS-COMP-ID
  3705        ELSE
  3706           MOVE X'04'            TO WS-COMP-CD
  3707           MOVE 'CID'            TO WS-SEND-BUF (5:3)
  3708                                    WS-COMP-ID
  3709        END-IF
  3710        move 'CSO'               to ws-send-buf (1:3)
  3711        move +25                 to ws-send-msg-size
  3712     END-IF
  3713     display 'SOCK03:sequence number  =', ws-seq-num.
  3714     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3715     call "send" using by value GIVE-TAKE-SOCKET,
  3716         by reference ws-send-buf,
  3717         by value ws-send-msg-size,
  3718         by value ws-flags.
  3719     if return-code <= zero
  3720         display 'SOCK03:send error ',
  3721         go to socket-error.
  3722     move low-values to ws-recv-buf.
  3723     set ws-recv-total to zero.
  3724     compute ws-recv-left = ws-recv-msg-size.
  3725     display 'SOCK03:About to recv '
  3726     call "recv" using by value GIVE-TAKE-SOCKET,
  3727         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3728         by value ws-recv-left,
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  66
* SOCK03.cbl
  3729         by value ws-flags.
  3730     if return-code < zero
  3731        display 'SOCK03:recv error ',
  3732        go to socket-error.
  3733     if return-code = zero
  3734        display 'SOCK03:client disconnected',
  3735        go to socket-error.
  3736*
  3737     display 'SOCK03:Good recv  '
  3738     display 'SOCK03:return code      = ', return-code
  3739     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3740     move +4096                  to ws-send-msg-size
  3741*    move +750                   to ws-send-msg-size
  3742     move ws-recv-buf (1:71)     to client-in-data
  3743     MOVE SPACES                 TO WS-ELCERT-SW
  3744     MOVE X'0A'                  TO WS-HEX-0A
  3745     EVALUATE TRUE
  3746        WHEN (CLIENT-CAR NOT = SPACES)
  3747           AND (CLIENT-STATE NOT = SPACES)
  3748           AND (CLIENT-ACCOUNT NOT = SPACES)
  3749           AND (CLIENT-EFF-DT NOT = SPACES)
  3750           AND (CLIENT-CERT-NO NOT = SPACES)
  3751           SET WS-ELCERT-FULL    TO TRUE
  3752           DISPLAY ' SETTING FULL '
  3753        WHEN (CLIENT-CERT-NO NOT = SPACES)
  3754           SET WS-ELCERT-CERT-NO TO TRUE
  3755           DISPLAY ' SETTING CERT NO '
  3756*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  3757*          AND (CLIENT-LAST-NAME NOT = SPACES)
  3758        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  3759           AND (CLIENT-LAST-NAME NOT = SPACES)
  3760           SET WS-ELCERT-ACT-NAME TO TRUE
  3761        WHEN CLIENT-LAST-NAME NOT = SPACES
  3762           SET WS-ELCERT-NAME    TO TRUE
  3763           DISPLAY ' SETTING NAME '
  3764        WHEN OTHER
  3765           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  3766           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  3767           MOVE ZEROS            TO WS-RESP
  3768           PERFORM 0030-BUILD-BUFFER
  3769                                 THRU 0030-EXIT
  3770           PERFORM 0020-SEND-BUFFER
  3771                                 THRU 0020-EXIT
  3772           PERFORM 0025-CLOSE-SOCKET
  3773                                 THRU 0025-EXIT
  3774           GO TO 0010-RETURN
  3775     END-EVALUATE
  3776     IF WS-ELCERT-KEY-SW NOT = SPACES
  3777        PERFORM 0050-BEGIN-REFUND-PROCESS
  3778                                 THRU 0050-EXIT
  3779     END-IF
  3780     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  3781     .
  3782 0010-RETURN.
  3783
  3784* exec cics return end-exec.
  3785*    MOVE '.(                    &   #00003779' TO DFHEIV0
  3786     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  67
* SOCK03.cbl
  3787     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3788     MOVE X'2020233030303033373739' TO DFHEIV0(25:11)
  3789     CALL 'kxdfhei1' USING DFHEIV0,
  3790           DFHEIV99,
  3791           DFHEIV99,
  3792           DFHEIV99,
  3793           DFHEIV99,
  3794           DFHEIV99
  3795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3796
  3797
  3798* goback.
  3799     MOVE '9%                    "   ' TO DFHEIV0
  3800     MOVE 'SOCK03' TO DFHEIV1
  3801     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3802     goback.
  3803*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3804     .
  3805 0020-SEND-BUFFER.
  3806     display 'SOCK03:About to send      '
  3807     display 'SOCK03:sequence number  =', ws-seq-num.
  3808     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  3809     call "send" using by value GIVE-TAKE-SOCKET,
  3810         by reference ws-send-buf,
  3811         by value ws-send-msg-size,
  3812         by value ws-flags.
  3813     if return-code <= zero
  3814         display 'SOCK03:send error ' return-code,
  3815         go to socket-error.
  3816 0020-EXIT.
  3817     EXIT.
  3818 0025-CLOSE-SOCKET.
  3819     display 'SOCK03:closing socket'.
  3820     call "close" using by value GIVE-TAKE-SOCKET .
  3821     display 'SOCK03:done'.
  3822     .
  3823 0025-EXIT.
  3824     EXIT.
  3825*
  3826* set up the receive buffer
  3827*
  3828     move low-values to ws-recv-buf.
  3829     set ws-recv-total to zero.
  3830     compute ws-recv-left = ws-recv-msg-size.
  3831*
  3832* receive data
  3833*
  3834 recv-1.
  3835     call "recv" using by value GIVE-TAKE-SOCKET,
  3836         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3837         by value ws-recv-left,
  3838         by value ws-flags.
  3839*
  3840* test what was received and decide what we should do
  3841*
  3842     if return-code < zero
  3843        display 'SOCK03:recv error ',
  3844        go to socket-error.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  68
* SOCK03.cbl
  3845     if return-code = zero
  3846        display 'SOCK03:client disconnected',
  3847        go to socket-error.
  3848*
  3849* have we received all the data yet?
  3850*
  3851     compute ws-recv-total = ws-recv-total + return-code.
  3852     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3853*
  3854* not yet
  3855*
  3856     if ws-recv-left > 0 go to recv-1.
  3857*
  3858* received all the data
  3859*
  3860     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  3861*
  3862* make sure what we received was what we sent
  3863*
  3864*    if ws-recv-buf <> ws-send-buf
  3865*        display "SOCK03:data doesn't match",
  3866*        go to socket-error.
  3867*
  3868* end of pass
  3869*
  3870*loop-end.
  3871*    if ws-seq-num = 5 go to socket-error.
  3872*    go to loop-1.
  3873*
  3874* program end
  3875*
  3876 socket-error.
  3877     if ws-seq-num <> 0
  3878         display "SOCK03:did not complete".
  3879*
  3880* flush the send buffer and deallocate
  3881*
  3882*    display 'SOCK03:closing socket'.
  3883*    call "close" using by value GIVE-TAKE-SOCKET .
  3884*
  3885* finised return to cics
  3886*
  3887 socket-fin.
  3888     display 'SOCK03:closing socket'.
  3889     call "close" using by value GIVE-TAKE-SOCKET .
  3890     display 'SOCK03:done'.
  3891
  3892* exec cics return end-exec.
  3893*    MOVE '.(                    &   #00003869' TO DFHEIV0
  3894     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3895     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3896     MOVE X'2020233030303033383639' TO DFHEIV0(25:11)
  3897     CALL 'kxdfhei1' USING DFHEIV0,
  3898           DFHEIV99,
  3899           DFHEIV99,
  3900           DFHEIV99,
  3901           DFHEIV99,
  3902           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  69
* SOCK03.cbl
  3903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3904
  3905
  3906* goback.
  3907     MOVE '9%                    "   ' TO DFHEIV0
  3908     MOVE 'SOCK03' TO DFHEIV1
  3909     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3910     goback.
  3911 0030-BUILD-BUFFER.
  3912     MOVE SPACES                 TO WS-SEND-BUF
  3913     IF WS-CALL-TYPE = 'NEWBUS'
  3914        STRING
  3915           WS-COMMENT            ';'
  3916           WS-RESP               ';'
  3917           WS-CARRIER            ';'
  3918           WS-GROUPING           ';'
  3919           WS-STATE              ';'
  3920           WS-ACCOUNT            ';'
  3921           WS-CERT-EFF-DATE      ';'
  3922           WS-CERT-NO            ';'
  3923           WS-LAST-NAME          ';'
  3924           WS-FIRST-NAME         ';'
  3925           WS-MID-INIT           ';'
  3926           WS-LAST-JNAME         ';'
  3927           WS-FIRST-JNAME        ';'
  3928           WS-MID-JINIT          ';'
  3929           WS-POST-CARD-SW       ';'
  3930           WS-LF-STATUS          ';'
  3931           WS-LF-BEN-CODE        ';'
  3932           WS-LF-BEN-CODE-DESC   ';'
  3933           WS-LF-TERM            ';'
  3934           WS-LF-REM-TERM        ';'
  3935           WS-LF-PREM            ';'
  3936           WS-LF-REFUND          ';'
  3937           WS-LF-METHOD          ';'
  3938           WS-LF-ORIG-BENEFIT    ';'
  3939           WS-LF-REM-BEN         ';'
  3940           WS-LF-EXPIRE-DATE     ';'
  3941           WS-LF-COMM            ';'
  3942           WS-LF-UEC             ';'
  3943           WS-AH-STATUS          ';'
  3944           WS-AH-BEN-CODE        ';'
  3945           WS-AH-BEN-CODE-DESC   ';'
  3946           WS-AH-TERM            ';'
  3947           WS-AH-REM-TERM        ';'
  3948           WS-AH-PREM            ';'
  3949           WS-AH-REFUND          ';'
  3950           WS-AH-METHOD          ';'
  3951           WS-AH-ORIG-BENEFIT    ';'
  3952           WS-AH-REM-BEN         ';'
  3953           WS-AH-EXPIRE-DATE     ';'
  3954           WS-AH-COMM            ';'
  3955           WS-AH-UEC             ';'
  3956           WS-ACCOUNT-NAME       ';'
  3957           WS-REPORT-CODE-1      ';'
  3958           WS-REPORT-CODE-2      ';'
  3959           WS-REPORT-CODE-3      ';'
  3960           WS-CLM-PAID-THRU-DT   ';'
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  70
* SOCK03.cbl
  3961           WS-HEX-0A
  3962            DELIMITED BY '  ' INTO WS-SEND-BUF
  3963        END-STRING
  3964     ELSE
  3965        STRING
  3966           WS-COMMENT            ';'
  3967           WS-RESP               ';'
  3968           WS-CARRIER            ';'
  3969           WS-GROUPING           ';'
  3970           WS-STATE              ';'
  3971           WS-ACCOUNT            ';'
  3972           WS-CERT-EFF-DATE      ';'
  3973           WS-CERT-NO            ';'
  3974           WS-LAST-NAME          ';'
  3975           WS-FIRST-NAME         ';'
  3976           WS-MID-INIT           ';'
  3977           WS-LAST-JNAME         ';'
  3978           WS-FIRST-JNAME        ';'
  3979           WS-MID-JINIT          ';'
  3980           WS-POST-CARD-SW       ';'
  3981           WS-LF-STATUS          ';'
  3982           WS-LF-BEN-CODE        ';'
  3983           WS-LF-BEN-CODE-DESC   ';'
  3984           WS-LF-TERM            ';'
  3985           WS-LF-REM-TERM        ';'
  3986           WS-LF-PREM            ';'
  3987           WS-LF-REFUND          ';'
  3988           WS-LF-METHOD          ';'
  3989           WS-LF-ORIG-BENEFIT    ';'
  3990           WS-LF-REM-BEN         ';'
  3991           WS-LF-EXPIRE-DATE     ';'
  3992           WS-LF-COMM            ';'
  3993           WS-LF-UEC             ';'
  3994           WS-AH-STATUS          ';'
  3995           WS-AH-BEN-CODE        ';'
  3996           WS-AH-BEN-CODE-DESC   ';'
  3997           WS-AH-TERM            ';'
  3998           WS-AH-REM-TERM        ';'
  3999           WS-AH-PREM            ';'
  4000           WS-AH-REFUND          ';'
  4001           WS-AH-METHOD          ';'
  4002           WS-AH-ORIG-BENEFIT    ';'
  4003           WS-AH-REM-BEN         ';'
  4004           WS-AH-EXPIRE-DATE     ';'
  4005           WS-AH-COMM            ';'
  4006           WS-AH-UEC             ';'
  4007           WS-ACCOUNT-NAME       ';'
  4008           WS-REPORT-CODE-1      ';'
  4009           WS-REPORT-CODE-2      ';'
  4010           WS-REPORT-CODE-3      ';'
  4011           WS-CLM-PAID-THRU-DT   ';'
  4012           'E'                   ';'
  4013            DELIMITED BY '  ' INTO WS-SEND-BUF
  4014        END-STRING
  4015     END-IF
  4016     .
  4017 0030-EXIT.
  4018     EXIT.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  71
* SOCK03.cbl
  4019 0050-BEGIN-REFUND-PROCESS.
  4020     IF WS-ELCERT-ACT-NAME
  4021        PERFORM 0060-FIND-FULL-KEY
  4022                                 THRU 0060-EXIT
  4023        MOVE AM-CARRIER          TO CLIENT-CAR
  4024        MOVE AM-GROUPING         TO CLIENT-GRP
  4025        MOVE AM-STATE            TO CLIENT-STATE
  4026     END-IF
  4027     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4028     IF NOT RESP-NORMAL
  4029        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4030        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4031        MOVE WS-RESPONSE         TO WS-RESP
  4032        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4033        PERFORM 0020-SEND-BUFFER
  4034                                 THRU 0020-EXIT
  4035        PERFORM 0025-CLOSE-SOCKET
  4036                                 THRU 0025-EXIT
  4037        GO TO 0010-RETURN
  4038     END-IF
  4039     PERFORM 0150-READ-NEXT-ELCERT
  4040                                 THRU 0150-EXIT
  4041*    display ' came back from 0150 ' ws-response
  4042     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4043        DISPLAY ' CERT NOT FOUND '
  4044        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4045        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4046        MOVE WS-RESPONSE         TO WS-RESP
  4047        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4048        PERFORM 0020-SEND-BUFFER
  4049                                 THRU 0020-EXIT
  4050        PERFORM 0025-CLOSE-SOCKET
  4051                                 THRU 0025-EXIT
  4052        GO TO 0010-RETURN
  4053     END-IF
  4054     PERFORM 0200-BEGIN-REFUND-PROCESS
  4055                                 THRU 0200-EXIT UNTIL
  4056        ELCERT-FINISHED
  4057     .
  4058 0050-EXIT.
  4059     EXIT.
  4060 0060-FIND-FULL-KEY.
  4061     MOVE ' ' TO WS-STOP-SW
  4062     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4063     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4064
  4065* EXEC CICS STARTBR
  4066*       DATASET  ('ERACCT3')
  4067*       RIDFLD   (WS-AM3-KEY)
  4068*       GTEQ
  4069*       RESP (WS-RESPONSE)
  4070*    END-EXEC
  4071     MOVE 'ERACCT3' TO DFHEIV1
  4072     MOVE 0
  4073       TO DFHEIV11
  4074*    MOVE '&,         G          &  N#00004024' TO DFHEIV0
  4075     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4076     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  72
* SOCK03.cbl
  4077     MOVE X'204E233030303034303234' TO DFHEIV0(25:11)
  4078     CALL 'kxdfhei1' USING DFHEIV0,
  4079           DFHEIV1,
  4080           WS-AM3-KEY,
  4081           DFHEIV99,
  4082           DFHEIV11,
  4083           DFHEIV99
  4084     MOVE EIBRESP  TO WS-RESPONSE
  4085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4086     IF RESP-NORMAL
  4087        PERFORM UNTIL TOLD-TO-STOP
  4088
  4089* EXEC CICS READNEXT
  4090*             DATASET  ('ERACCT3')
  4091*             INTO     (ACCOUNT-MASTER)
  4092*             RIDFLD   (WS-AM3-KEY)
  4093*          END-EXEC
  4094     MOVE LENGTH OF
  4095      ACCOUNT-MASTER
  4096       TO DFHEIV12
  4097     MOVE 'ERACCT3' TO DFHEIV1
  4098     MOVE 0
  4099       TO DFHEIV11
  4100*    MOVE '&.IL                  )   #00004032' TO DFHEIV0
  4101     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4102     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4103     MOVE X'2020233030303034303332' TO DFHEIV0(25:11)
  4104     CALL 'kxdfhei1' USING DFHEIV0,
  4105           DFHEIV1,
  4106           ACCOUNT-MASTER,
  4107           DFHEIV12,
  4108           WS-AM3-KEY,
  4109           DFHEIV99,
  4110           DFHEIV11,
  4111           DFHEIV99,
  4112           DFHEIV99
  4113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4114           EVALUATE TRUE
  4115              WHEN (RESP-NORMAL)
  4116                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4117                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4118                 SET TOLD-TO-STOP TO TRUE
  4119              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4120                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4121                 CONTINUE
  4122              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4123                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4124                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4125                 MOVE ZEROS      TO WS-RESP
  4126                 PERFORM 0030-BUILD-BUFFER
  4127                                 THRU 0030-EXIT
  4128                 PERFORM 0020-SEND-BUFFER
  4129                                 THRU 0020-EXIT
  4130                 PERFORM 0025-CLOSE-SOCKET
  4131                                 THRU 0025-EXIT
  4132                 GO TO 0010-RETURN
  4133           END-EVALUATE
  4134        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  73
* SOCK03.cbl
  4135
  4136* EXEC CICS ENDBR
  4137*          DATASET   ('ERACCT3')
  4138*       END-EXEC
  4139     MOVE 'ERACCT3' TO DFHEIV1
  4140     MOVE 0
  4141       TO DFHEIV11
  4142*    MOVE '&2                    $   #00004058' TO DFHEIV0
  4143     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4144     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4145     MOVE X'2020233030303034303538' TO DFHEIV0(25:11)
  4146     CALL 'kxdfhei1' USING DFHEIV0,
  4147           DFHEIV1,
  4148           DFHEIV11,
  4149           DFHEIV99
  4150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4151     ELSE
  4152        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4153        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4154        MOVE ZEROS      TO WS-RESP
  4155        PERFORM 0030-BUILD-BUFFER
  4156                                 THRU 0030-EXIT
  4157        PERFORM 0020-SEND-BUFFER
  4158                                 THRU 0020-EXIT
  4159        PERFORM 0025-CLOSE-SOCKET
  4160                                 THRU 0025-EXIT
  4161        GO TO 0010-RETURN
  4162     END-IF
  4163     .
  4164 0060-EXIT.
  4165     EXIT.
  4166 0100-START-ELCERT.
  4167*    DISPLAY ' MADE 0100 START '
  4168     MOVE SPACES                 TO WS-SEND-BUF
  4169     INITIALIZE WS-STRING-DATA
  4170     MOVE LOW-VALUES             TO WS-CM-KEY
  4171                                    WS-CM-KEY-A1
  4172                                    WS-CM-KEY-A4
  4173     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4174                                    WS-CM-COMPANY-CD-A1
  4175                                    WS-CM-COMPANY-CD-A4
  4176     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4177     MOVE 'L'                    TO DC-OPTION-CODE
  4178     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4179     IF NO-CONVERSION-ERROR
  4180        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4181     ELSE
  4182        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4183        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4184        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4185        PERFORM 0020-SEND-BUFFER
  4186                                 THRU 0020-EXIT
  4187        PERFORM 0025-CLOSE-SOCKET
  4188                                 THRU 0025-EXIT
  4189        GO TO 0010-RETURN
  4190     END-IF
  4191     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4192        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  74
* SOCK03.cbl
  4193        MOVE 'L'                 TO DC-OPTION-CODE
  4194        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4195        IF NO-CONVERSION-ERROR
  4196           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4197        ELSE
  4198           MOVE 'BAD EFF DT CONVERT '
  4199                                 TO WS-COMMENT
  4200           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4201           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4202           PERFORM 0020-SEND-BUFFER
  4203                                 THRU 0020-EXIT
  4204           PERFORM 0025-CLOSE-SOCKET
  4205                                 THRU 0025-EXIT
  4206           GO TO 0010-RETURN
  4207        END-IF
  4208     END-IF
  4209     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4210        (F1 > +10)
  4211        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4212     END-PERFORM
  4213     IF F1 > +1
  4214        SUBTRACT +1 FROM F1
  4215     END-IF
  4216     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4217        (L1 > +15)
  4218        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4219     END-PERFORM
  4220     IF L1 > +1
  4221        SUBTRACT +1 FROM L1
  4222     END-IF
  4223     EVALUATE TRUE
  4224        WHEN WS-ELCERT-FULL
  4225           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4226           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4227           MOVE CLIENT-STATE        TO WS-CM-STATE
  4228           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4229           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4230           MOVE CLIENT-CERT-NO (1:10)
  4231                                    TO WS-CM-CERT-NO
  4232
  4233* EXEC CICS READ
  4234*             INTO    (CERTIFICATE-MASTER)
  4235*             DATASET ('ELCERT')
  4236*             RIDFLD  (WS-CM-KEY)
  4237*             RESP    (WS-RESPONSE)
  4238*          END-EXEC
  4239     MOVE LENGTH OF
  4240      CERTIFICATE-MASTER
  4241       TO DFHEIV11
  4242     MOVE 'ELCERT' TO DFHEIV1
  4243*    MOVE '&"IL       E          (  N#00004142' TO DFHEIV0
  4244     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4245     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4246     MOVE X'204E233030303034313432' TO DFHEIV0(25:11)
  4247     CALL 'kxdfhei1' USING DFHEIV0,
  4248           DFHEIV1,
  4249           CERTIFICATE-MASTER,
  4250           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  75
* SOCK03.cbl
  4251           WS-CM-KEY,
  4252           DFHEIV99,
  4253           DFHEIV99,
  4254           DFHEIV99
  4255     MOVE EIBRESP  TO WS-RESPONSE
  4256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4257        WHEN WS-ELCERT-ACT-NAME
  4258           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4259           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4260           MOVE CLIENT-STATE        TO WS-CM-STATE
  4261           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4262           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4263           MOVE ZEROS               TO WS-CM-CERT-NO
  4264
  4265* EXEC CICS STARTBR
  4266*             DATASET ('ELCERT')
  4267*             RIDFLD  (WS-CM-KEY)
  4268*             RESP    (WS-RESPONSE)
  4269*          END-EXEC
  4270     MOVE 'ELCERT' TO DFHEIV1
  4271     MOVE 0
  4272       TO DFHEIV11
  4273*    MOVE '&,         G          &  N#00004155' TO DFHEIV0
  4274     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4275     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4276     MOVE X'204E233030303034313535' TO DFHEIV0(25:11)
  4277     CALL 'kxdfhei1' USING DFHEIV0,
  4278           DFHEIV1,
  4279           WS-CM-KEY,
  4280           DFHEIV99,
  4281           DFHEIV11,
  4282           DFHEIV99
  4283     MOVE EIBRESP  TO WS-RESPONSE
  4284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4285        WHEN WS-ELCERT-NAME
  4286           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4287           MOVE SPACES           TO WS-CM-INITIALS
  4288           COMPUTE WS-LENGTH = L1 + +1
  4289
  4290* EXEC CICS STARTBR
  4291*             DATASET   ('ELCERT2')
  4292*             RIDFLD    (WS-CM-KEY-A1)
  4293*             GENERIC
  4294*             KEYLENGTH (WS-LENGTH)
  4295*             GTEQ
  4296*             RESP      (WS-RESPONSE)
  4297*          END-EXEC
  4298     MOVE 'ELCERT2' TO DFHEIV1
  4299     MOVE 0
  4300       TO DFHEIV11
  4301*    MOVE '&,   KG    G          &  N#00004164' TO DFHEIV0
  4302     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4304     MOVE X'204E233030303034313634' TO DFHEIV0(25:11)
  4305     CALL 'kxdfhei1' USING DFHEIV0,
  4306           DFHEIV1,
  4307           WS-CM-KEY-A1,
  4308           WS-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  76
* SOCK03.cbl
  4309           DFHEIV11,
  4310           DFHEIV99
  4311     MOVE EIBRESP  TO WS-RESPONSE
  4312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4313*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4314*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4315        WHEN WS-ELCERT-CERT-NO
  4316* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4317           MOVE +11 TO WS-LENGTH
  4318           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4319
  4320* EXEC CICS STARTBR
  4321*             DATASET   ('ELCERT5')
  4322*             RIDFLD    (WS-CM-KEY-A4)
  4323*             GENERIC
  4324*             KEYLENGTH (WS-LENGTH)
  4325*             GTEQ
  4326*             RESP      (WS-RESPONSE)
  4327*          END-EXEC
  4328     MOVE 'ELCERT5' TO DFHEIV1
  4329     MOVE 0
  4330       TO DFHEIV11
  4331*    MOVE '&,   KG    G          &  N#00004178' TO DFHEIV0
  4332     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4333     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4334     MOVE X'204E233030303034313738' TO DFHEIV0(25:11)
  4335     CALL 'kxdfhei1' USING DFHEIV0,
  4336           DFHEIV1,
  4337           WS-CM-KEY-A4,
  4338           WS-LENGTH,
  4339           DFHEIV11,
  4340           DFHEIV99
  4341     MOVE EIBRESP  TO WS-RESPONSE
  4342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4343     END-EVALUATE
  4344     .
  4345 0100-EXIT.
  4346     EXIT.
  4347 0150-READ-NEXT-ELCERT.
  4348*    DISPLAY ' MADE 0150 NEXT '
  4349     EVALUATE TRUE
  4350        WHEN WS-ELCERT-ACT-NAME
  4351*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4352
  4353* EXEC CICS READNEXT
  4354*             DATASET   ('ELCERT')
  4355*             RIDFLD    (WS-CM-KEY)
  4356*             INTO      (CERTIFICATE-MASTER)
  4357*             RESP      (WS-RESPONSE)
  4358*          END-EXEC
  4359     MOVE LENGTH OF
  4360      CERTIFICATE-MASTER
  4361       TO DFHEIV12
  4362     MOVE 'ELCERT' TO DFHEIV1
  4363     MOVE 0
  4364       TO DFHEIV11
  4365*    MOVE '&.IL                  )  N#00004195' TO DFHEIV0
  4366     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  77
* SOCK03.cbl
  4367     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4368     MOVE X'204E233030303034313935' TO DFHEIV0(25:11)
  4369     CALL 'kxdfhei1' USING DFHEIV0,
  4370           DFHEIV1,
  4371           CERTIFICATE-MASTER,
  4372           DFHEIV12,
  4373           WS-CM-KEY,
  4374           DFHEIV99,
  4375           DFHEIV11,
  4376           DFHEIV99,
  4377           DFHEIV99
  4378     MOVE EIBRESP  TO WS-RESPONSE
  4379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4380        WHEN WS-ELCERT-NAME
  4381*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4382
  4383* EXEC CICS READNEXT
  4384*             DATASET   ('ELCERT2')
  4385*             RIDFLD    (WS-CM-KEY-A1)
  4386*             INTO      (CERTIFICATE-MASTER)
  4387*             RESP      (WS-RESPONSE)
  4388*          END-EXEC
  4389     MOVE LENGTH OF
  4390      CERTIFICATE-MASTER
  4391       TO DFHEIV12
  4392     MOVE 'ELCERT2' TO DFHEIV1
  4393     MOVE 0
  4394       TO DFHEIV11
  4395*    MOVE '&.IL                  )  N#00004203' TO DFHEIV0
  4396     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4397     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4398     MOVE X'204E233030303034323033' TO DFHEIV0(25:11)
  4399     CALL 'kxdfhei1' USING DFHEIV0,
  4400           DFHEIV1,
  4401           CERTIFICATE-MASTER,
  4402           DFHEIV12,
  4403           WS-CM-KEY-A1,
  4404           DFHEIV99,
  4405           DFHEIV11,
  4406           DFHEIV99,
  4407           DFHEIV99
  4408     MOVE EIBRESP  TO WS-RESPONSE
  4409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4410        WHEN WS-ELCERT-CERT-NO
  4411
  4412* EXEC CICS READNEXT
  4413*             DATASET   ('ELCERT5')
  4414*             RIDFLD    (WS-CM-KEY-A4)
  4415*             INTO      (CERTIFICATE-MASTER)
  4416*             RESP      (WS-RESPONSE)
  4417*          END-EXEC
  4418     MOVE LENGTH OF
  4419      CERTIFICATE-MASTER
  4420       TO DFHEIV12
  4421     MOVE 'ELCERT5' TO DFHEIV1
  4422     MOVE 0
  4423       TO DFHEIV11
  4424*    MOVE '&.IL                  )  N#00004210' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  78
* SOCK03.cbl
  4425     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4426     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4427     MOVE X'204E233030303034323130' TO DFHEIV0(25:11)
  4428     CALL 'kxdfhei1' USING DFHEIV0,
  4429           DFHEIV1,
  4430           CERTIFICATE-MASTER,
  4431           DFHEIV12,
  4432           WS-CM-KEY-A4,
  4433           DFHEIV99,
  4434           DFHEIV11,
  4435           DFHEIV99,
  4436           DFHEIV99
  4437     MOVE EIBRESP  TO WS-RESPONSE
  4438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4439     END-EVALUATE
  4440     .
  4441 0150-EXIT.
  4442     EXIT.
  4443 0200-BEGIN-REFUND-PROCESS.
  4444*    DISPLAY ' MADE 0200 BEGIN '
  4445     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4446                                    WS-ERACCT-SW
  4447     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4448                                    WS-NCB-DIFF-ODD-DAYS
  4449     INITIALIZE WS-STRING-DATA
  4450     IF RESP-NORMAL OR RESP-DUPKEY
  4451        EVALUATE TRUE
  4452           WHEN WS-ELCERT-ACT-NAME
  4453              EVALUATE TRUE
  4454                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4455                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4456                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4457                    OR (CM-STATE NOT = CLIENT-STATE)
  4458                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
  4459                    SET ELCERT-FINISHED TO TRUE
  4460                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4461                    CLIENT-LAST-NAME (1:L1))
  4462                    GO TO 0200-CONTINUE
  4463                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4464                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4465                    GO TO 0200-CONTINUE
  4466                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4467                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4468                     CLIENT-FIRST-NAME (1:F1)))
  4469                    GO TO 0200-CONTINUE
  4470                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4471                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4472                    GO TO 0200-CONTINUE
  4473              END-EVALUATE
  4474           WHEN WS-ELCERT-CERT-NO
  4475              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4476                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4477                 SET ELCERT-FINISHED TO TRUE
  4478              ELSE
  4479                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4480                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4481                              OR
  4482                    ((CLIENT-LAST-NAME NOT = SPACES)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  79
* SOCK03.cbl
  4483                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4484                        CLIENT-LAST-NAME (1:L1)))
  4485                              OR
  4486                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4487                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4488                        CLIENT-FIRST-NAME (1:F1)))
  4489                              OR
  4490                    ((CLIENT-ACCOUNT NOT = SPACES)
  4491                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4492                     GO TO 0200-CONTINUE
  4493                 END-IF
  4494              END-IF
  4495           WHEN WS-ELCERT-NAME
  4496              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4497                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4498                    CLIENT-LAST-NAME (1:L1))
  4499                  SET ELCERT-FINISHED TO TRUE
  4500              ELSE
  4501                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4502                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4503                           OR
  4504                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4505                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4506                     CLIENT-FIRST-NAME (1:F1)))
  4507                           OR
  4508                 ((CLIENT-ACCOUNT NOT = SPACES)
  4509                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4510                  GO TO 0200-CONTINUE
  4511                 END-IF
  4512              END-IF
  4513           WHEN OTHER
  4514              SET ELCERT-FINISHED   TO TRUE
  4515        END-EVALUATE
  4516     ELSE
  4517        SET ELCERT-FINISHED TO TRUE
  4518     END-IF
  4519*       IF WS-ELCERT-CERT-NO
  4520*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4521*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4522*                          OR
  4523*                ((CLIENT-EFF-DT NOT = SPACES)
  4524*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4525*                          OR
  4526*                ((CLIENT-LAST-NAME NOT = SPACES)
  4527*                 AND (CM-INSURED-LAST-NAME NOT =
  4528*                    CLIENT-LAST-NAME))
  4529*                 SET ELCERT-FINISHED TO TRUE
  4530*          END-IF
  4531*          IF WS-ELCERT-NAME
  4532*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4533*                OR (CM-INSURED-LAST-NAME NOT =
  4534*                   CLIENT-LAST-NAME)
  4535*                            OR
  4536*                ((CLIENT-EFF-DT NOT = SPACES)
  4537*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4538*                 SET ELCERT-FINISHED TO TRUE
  4539*             END-IF
  4540*          ELSE
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  80
* SOCK03.cbl
  4541*             SET ELCERT-FINISHED   TO TRUE
  4542*          END-IF
  4543     IF NOT WS-ELCERT-FULL
  4544        IF ELCERT-FINISHED
  4545           GO TO 0200-EXIT
  4546        END-IF
  4547     END-IF
  4548     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4549        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4550        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4551        PERFORM 0030-BUILD-BUFFER
  4552                                 THRU 0030-EXIT
  4553        PERFORM 0020-SEND-BUFFER
  4554                                 THRU 0020-EXIT
  4555        GO TO 0200-CONTINUE
  4556     END-IF
  4557     PERFORM 0300-GET-ELCNTL-RECORDS
  4558                                 THRU 0300-EXIT
  4559     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4560     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4561     MOVE +0                     TO DC-ELAPSED-MONTHS
  4562                                    DC-ELAPSED-DAYS
  4563     MOVE '1'                    TO DC-OPTION-CODE
  4564     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4565     IF NO-CONVERSION-ERROR
  4566        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4567        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4568     END-IF
  4569     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4570     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4571     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4572     IF NOT ALREADY-SENT
  4573        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4574     END-IF
  4575     .
  4576 0200-CONTINUE.
  4577     PERFORM 0150-READ-NEXT-ELCERT
  4578                                 THRU 0150-EXIT
  4579     .
  4580 0200-EXIT.
  4581     EXIT.
  4582 0300-GET-ELCNTL-RECORDS.
  4583     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4584     IF NOT RESP-NORMAL
  4585        MOVE ' COMPANY RECORD NOT FOUND '
  4586                                 TO WS-COMMENT
  4587        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4588        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4589        PERFORM 0020-SEND-BUFFER
  4590                                 THRU 0020-EXIT
  4591        PERFORM 0025-CLOSE-SOCKET
  4592                                 THRU 0025-EXIT
  4593        GO TO 0010-RETURN
  4594     END-IF
  4595     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4596        PERFORM 0320-GET-LIFE-RECORD
  4597                                 THRU 0320-EXIT
  4598        IF NOT RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  81
* SOCK03.cbl
  4599           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4600                                 TO WS-COMMENT
  4601           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4602           PERFORM 0030-BUILD-BUFFER
  4603                                 THRU 0030-EXIT
  4604           PERFORM 0020-SEND-BUFFER
  4605                                 THRU 0020-EXIT
  4606           PERFORM 0025-CLOSE-SOCKET
  4607                                 THRU 0025-EXIT
  4608           GO TO 0010-RETURN
  4609        END-IF
  4610     END-IF
  4611     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4612        PERFORM 0330-GET-AH-RECORD
  4613                                 THRU 0330-EXIT
  4614        IF NOT RESP-NORMAL
  4615           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4616                                 TO WS-COMMENT
  4617           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4618           PERFORM 0030-BUILD-BUFFER
  4619                                 THRU 0030-EXIT
  4620           PERFORM 0020-SEND-BUFFER
  4621                                 THRU 0020-EXIT
  4622           PERFORM 0025-CLOSE-SOCKET
  4623                                 THRU 0025-EXIT
  4624           GO TO 0010-RETURN
  4625        END-IF
  4626     END-IF
  4627     PERFORM 0340-GET-STATE-RECORD
  4628                                 THRU 0340-EXIT
  4629     IF NOT RESP-NORMAL
  4630        MOVE ' STATE RECORD NOT FOUND '
  4631                                 TO WS-COMMENT
  4632        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4633        PERFORM 0030-BUILD-BUFFER
  4634                                 THRU 0030-EXIT
  4635        PERFORM 0020-SEND-BUFFER
  4636                                 THRU 0020-EXIT
  4637        PERFORM 0025-CLOSE-SOCKET
  4638                                 THRU 0025-EXIT
  4639        GO TO 0010-RETURN
  4640     END-IF
  4641     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4642     IF NOT ERACCT-FOUND
  4643        MOVE ' ACCOUNT NOT FOUND '
  4644                                 TO WS-COMMENT
  4645        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4646        PERFORM 0030-BUILD-BUFFER
  4647                                 THRU 0030-EXIT
  4648        PERFORM 0020-SEND-BUFFER
  4649                                 THRU 0020-EXIT
  4650        PERFORM 0025-CLOSE-SOCKET
  4651                                 THRU 0025-EXIT
  4652        GO TO 0010-RETURN
  4653     ELSE
  4654        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4655        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4656        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  82
* SOCK03.cbl
  4657        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4658     END-IF
  4659     .
  4660 0300-EXIT.
  4661     EXIT.
  4662 0310-GET-COMPANY.
  4663     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4664     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4665     MOVE SPACES                 TO  WS-CF-ACCESS
  4666     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4667
  4668* EXEC CICS READ
  4669*       INTO    (CONTROL-FILE)
  4670*       DATASET ('ELCNTL')
  4671*       RIDFLD  (WS-CF-KEY)
  4672*       RESP    (WS-RESPONSE)
  4673*    END-EXEC
  4674     MOVE LENGTH OF
  4675      CONTROL-FILE
  4676       TO DFHEIV11
  4677     MOVE 'ELCNTL' TO DFHEIV1
  4678*    MOVE '&"IL       E          (  N#00004444' TO DFHEIV0
  4679     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4680     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4681     MOVE X'204E233030303034343434' TO DFHEIV0(25:11)
  4682     CALL 'kxdfhei1' USING DFHEIV0,
  4683           DFHEIV1,
  4684           CONTROL-FILE,
  4685           DFHEIV11,
  4686           WS-CF-KEY,
  4687           DFHEIV99,
  4688           DFHEIV99,
  4689           DFHEIV99
  4690     MOVE EIBRESP  TO WS-RESPONSE
  4691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4692     IF (RESP-NORMAL)
  4693        AND (CF-COMPANY-ID = WS-COMP-ID)
  4694        AND (CF-RECORD-TYPE = '1')
  4695        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4696        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4697        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4698        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4699        IF CF-DEFAULT-APR NUMERIC
  4700           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4701        ELSE
  4702           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4703        END-IF
  4704        IF CF-VALID-REM-TRM-OPTION
  4705           MOVE CF-REM-TRM-CALC-OPTION
  4706                                 TO WS-CF-REM-TRM-CALC-OPTION
  4707        ELSE
  4708           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4709        END-IF
  4710     END-IF
  4711     .
  4712 0310-EXIT.
  4713     EXIT.
  4714 0320-GET-LIFE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  83
* SOCK03.cbl
  4715     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4716     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4717                                    WS-LF-BEN-CODE
  4718     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4719
  4720* EXEC CICS READ
  4721*       INTO    (CONTROL-FILE)
  4722*       DATASET ('ELCNTL')
  4723*       RIDFLD  (WS-CF-KEY)
  4724*       GTEQ
  4725*       RESP    (WS-RESPONSE)
  4726*    END-EXEC
  4727     MOVE LENGTH OF
  4728      CONTROL-FILE
  4729       TO DFHEIV11
  4730     MOVE 'ELCNTL' TO DFHEIV1
  4731*    MOVE '&"IL       G          (  N#00004477' TO DFHEIV0
  4732     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4733     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4734     MOVE X'204E233030303034343737' TO DFHEIV0(25:11)
  4735     CALL 'kxdfhei1' USING DFHEIV0,
  4736           DFHEIV1,
  4737           CONTROL-FILE,
  4738           DFHEIV11,
  4739           WS-CF-KEY,
  4740           DFHEIV99,
  4741           DFHEIV99,
  4742           DFHEIV99
  4743     MOVE EIBRESP  TO WS-RESPONSE
  4744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4745     IF RESP-NORMAL
  4746        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4747        AND (CF-RECORD-TYPE = '4')
  4748        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4749           (S1 > +8)
  4750           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4751        END-PERFORM
  4752        IF S1 > +8
  4753           CONTINUE
  4754        ELSE
  4755           MOVE CF-BENEFIT-DESCRIP (S1)
  4756                                 TO WS-LF-BEN-CODE-DESC
  4757           MOVE CF-LF-COVERAGE-TYPE (S1)
  4758                                 TO WS-CF-LF-COVERAGE-TYPE
  4759           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4760               MOVE CF-CO-REM-TERM-CALC (S1)
  4761                                 TO WS-LF-CO-REM-TERM-CALC
  4762           END-IF
  4763           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  4764               MOVE CF-CO-EARNINGS-CALC (S1)
  4765                                 TO WS-LF-CO-EARNINGS-CALC
  4766                                    WS-LF-CO-REFUND-CALC
  4767           END-IF
  4768           IF CF-SPECIAL-CALC-CD (S1) > ' '
  4769               MOVE CF-SPECIAL-CALC-CD (S1)
  4770                                 TO WS-LF-SPECIAL-CALC-CD
  4771           END-IF
  4772           IF CF-CO-REFUND-CALC (S1) > '0'
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  84
* SOCK03.cbl
  4773               MOVE CF-CO-REFUND-CALC (S1)
  4774                                 TO WS-LF-CO-REFUND-CALC
  4775        END-IF
  4776     END-IF
  4777     .
  4778 0320-EXIT.
  4779     EXIT.
  4780 0330-GET-AH-RECORD.
  4781     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4782     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4783     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4784
  4785* EXEC CICS READ
  4786*       INTO    (CONTROL-FILE)
  4787*       DATASET ('ELCNTL')
  4788*       RIDFLD  (WS-CF-KEY)
  4789*       GTEQ
  4790*       RESP    (WS-RESPONSE)
  4791*    END-EXEC
  4792     MOVE LENGTH OF
  4793      CONTROL-FILE
  4794       TO DFHEIV11
  4795     MOVE 'ELCNTL' TO DFHEIV1
  4796*    MOVE '&"IL       G          (  N#00004523' TO DFHEIV0
  4797     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4798     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4799     MOVE X'204E233030303034353233' TO DFHEIV0(25:11)
  4800     CALL 'kxdfhei1' USING DFHEIV0,
  4801           DFHEIV1,
  4802           CONTROL-FILE,
  4803           DFHEIV11,
  4804           WS-CF-KEY,
  4805           DFHEIV99,
  4806           DFHEIV99,
  4807           DFHEIV99
  4808     MOVE EIBRESP  TO WS-RESPONSE
  4809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4810     IF RESP-NORMAL
  4811        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4812        AND (CF-RECORD-TYPE = '5')
  4813        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4814           (S1 > +8)
  4815           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4816        END-PERFORM
  4817        IF S1 > +8
  4818           CONTINUE
  4819        ELSE
  4820           MOVE CF-BENEFIT-DESCRIP (S1)
  4821                                 TO WS-AH-BEN-CODE-DESC
  4822           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4823              MOVE CF-CO-REM-TERM-CALC (S1)
  4824                                 TO WS-AH-CO-REM-TERM-CALC
  4825           END-IF
  4826           IF CF-CO-EARNINGS-CALC (S1) > ' '
  4827              MOVE CF-CO-EARNINGS-CALC (S1)
  4828                                 TO WS-AH-CO-EARNINGS-CALC
  4829                                    WS-AH-CO-REFUND-CALC
  4830           END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  85
* SOCK03.cbl
  4831           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  4832              MOVE CF-SPECIAL-CALC-CD (S1)
  4833                                 TO WS-AH-SPECIAL-CALC-CD
  4834           END-IF
  4835           IF CF-CO-REFUND-CALC (S1) > '0'
  4836              MOVE CF-CO-REFUND-CALC (S1)
  4837                                 TO WS-AH-CO-REFUND-CALC
  4838           END-IF
  4839           IF CF-BENEFIT-CATEGORY (S1) > ' '
  4840              MOVE CF-BENEFIT-CATEGORY (S1)
  4841                                 TO WS-AH-BEN-CATEGORY
  4842           END-IF
  4843        END-IF
  4844     END-IF
  4845     .
  4846 0330-EXIT.
  4847     EXIT.
  4848 0340-GET-STATE-RECORD.
  4849     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4850     MOVE '3'                    TO WS-CF-RECORD-TYPE
  4851     MOVE CM-STATE               TO WS-CF-ACCESS
  4852     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4853
  4854* EXEC CICS READ
  4855*       INTO    (CONTROL-FILE)
  4856*       DATASET ('ELCNTL')
  4857*       RIDFLD  (WS-CF-KEY)
  4858*       RESP    (WS-RESPONSE)
  4859*    END-EXEC
  4860     MOVE LENGTH OF
  4861      CONTROL-FILE
  4862       TO DFHEIV11
  4863     MOVE 'ELCNTL' TO DFHEIV1
  4864*    MOVE '&"IL       E          (  N#00004573' TO DFHEIV0
  4865     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4866     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4867     MOVE X'204E233030303034353733' TO DFHEIV0(25:11)
  4868     CALL 'kxdfhei1' USING DFHEIV0,
  4869           DFHEIV1,
  4870           CONTROL-FILE,
  4871           DFHEIV11,
  4872           WS-CF-KEY,
  4873           DFHEIV99,
  4874           DFHEIV99,
  4875           DFHEIV99
  4876     MOVE EIBRESP  TO WS-RESPONSE
  4877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4878     IF (RESP-NORMAL)
  4879        AND (CF-COMPANY-ID = WS-COMP-ID)
  4880        AND (CF-RECORD-TYPE = '3')
  4881        AND (CF-STATE-CODE = CM-STATE)
  4882        MOVE CF-ST-FREE-LOOK-PERIOD
  4883                                 TO WS-FREE-LOOK
  4884        MOVE CF-STATE-ABBREVIATION
  4885                                 TO WS-STATE-ABBREVIATION
  4886        MOVE CF-ST-FST-PMT-DAYS-CHG
  4887                                 TO  WS-STATE-EXT-DAYS-CHG
  4888        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  86
* SOCK03.cbl
  4889           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  4890           IF CF-ST-RT-CALC NOT = SPACES
  4891              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  4892           END-IF
  4893           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  4894              IF CF-ST-RF-LR-CALC > '0'
  4895                 MOVE CF-ST-RF-LR-CALC
  4896                                 TO WS-LF-ST-REFUND-CALC
  4897              END-IF
  4898              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  4899                 IF CF-ST-RF-LN-CALC > '0'
  4900                    MOVE CF-ST-RF-LN-CALC
  4901                                 TO WS-LF-ST-REFUND-CALC
  4902                 END-IF
  4903              END-IF
  4904           ELSE
  4905              IF CF-ST-RF-LL-CALC > '0'
  4906                 MOVE CF-ST-RF-LL-CALC
  4907                                 TO WS-LF-ST-REFUND-CALC
  4908              END-IF
  4909           END-IF
  4910           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4911              (S1 > 50)
  4912              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  4913                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  4914           END-PERFORM
  4915           IF S1 < +51
  4916              IF CF-ST-REM-TERM-CALC (S1) > '0'
  4917                 MOVE CF-ST-REM-TERM-CALC (S1)
  4918                                 TO WS-LF-ST-REM-TERM-CALC
  4919              END-IF
  4920              IF CF-ST-REFUND-CALC (S1) > '0'
  4921                 MOVE CF-ST-REFUND-CALC (S1)
  4922                                 TO WS-LF-ST-REFUND-CALC
  4923              END-IF
  4924           END-IF
  4925        END-IF
  4926        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  4927           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  4928           IF CF-ST-RT-CALC NOT = SPACES
  4929              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  4930           END-IF
  4931           IF CF-ST-RF-AH-CALC > '0'
  4932              MOVE CF-ST-RF-AH-CALC
  4933                                 TO WS-AH-ST-REFUND-CALC
  4934           END-IF
  4935           IF WS-AH-SPECIAL-CALC-CD = 'C'
  4936              IF CF-ST-RF-CP-CALC > '0'
  4937                 MOVE CF-ST-RF-CP-CALC
  4938                                 TO WS-AH-ST-REFUND-CALC
  4939              END-IF
  4940           END-IF
  4941           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4942              (S1 > 50)
  4943              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  4944                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  4945           END-PERFORM
  4946           IF S1 < +51
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  87
* SOCK03.cbl
  4947              IF CF-ST-REM-TERM-CALC (S1) > '0'
  4948                 MOVE CF-ST-REM-TERM-CALC (S1)
  4949                                 TO WS-AH-ST-REM-TERM-CALC
  4950              END-IF
  4951              IF CF-ST-REFUND-CALC (S1) > '0'
  4952                 MOVE CF-ST-REFUND-CALC (S1)
  4953                                 TO WS-AH-ST-REFUND-CALC
  4954              END-IF
  4955           END-IF
  4956        END-IF
  4957     END-IF
  4958     .
  4959 0340-EXIT.
  4960     EXIT.
  4961 0350-GET-ERACCT.
  4962     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  4963                                    WS-AM-EARN-METHOD-R
  4964                                    WS-AM-EARN-METHOD-A
  4965                                    WS-LF-AM-REM-TERM-CALC
  4966                                    WS-AH-AM-REM-TERM-CALC
  4967     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  4968     MOVE CM-CARRIER             TO WS-AM-CARRIER
  4969     MOVE CM-GROUPING            TO WS-AM-GROUPING
  4970     MOVE CM-STATE               TO WS-AM-STATE
  4971     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  4972     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  4973     MOVE LOW-VALUES             TO WS-AM-FILLER
  4974     MOVE ' '                    TO WS-STOP-SW
  4975
  4976* EXEC CICS STARTBR
  4977*       DATASET  ('ERACCT')
  4978*       RIDFLD   (WS-AM-KEY)
  4979*       GTEQ
  4980*       RESP (WS-RESPONSE)
  4981*    END-EXEC
  4982     MOVE 'ERACCT' TO DFHEIV1
  4983     MOVE 0
  4984       TO DFHEIV11
  4985*    MOVE '&,         G          &  N#00004676' TO DFHEIV0
  4986     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4988     MOVE X'204E233030303034363736' TO DFHEIV0(25:11)
  4989     CALL 'kxdfhei1' USING DFHEIV0,
  4990           DFHEIV1,
  4991           WS-AM-KEY,
  4992           DFHEIV99,
  4993           DFHEIV11,
  4994           DFHEIV99
  4995     MOVE EIBRESP  TO WS-RESPONSE
  4996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4997     IF RESP-NORMAL
  4998        PERFORM UNTIL TOLD-TO-STOP
  4999
  5000* EXEC CICS READNEXT
  5001*             DATASET  ('ERACCT')
  5002*             INTO     (ACCOUNT-MASTER)
  5003*             RIDFLD   (WS-AM-KEY)
  5004*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  88
* SOCK03.cbl
  5005     MOVE LENGTH OF
  5006      ACCOUNT-MASTER
  5007       TO DFHEIV12
  5008     MOVE 'ERACCT' TO DFHEIV1
  5009     MOVE 0
  5010       TO DFHEIV11
  5011*    MOVE '&.IL                  )   #00004684' TO DFHEIV0
  5012     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5013     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5014     MOVE X'2020233030303034363834' TO DFHEIV0(25:11)
  5015     CALL 'kxdfhei1' USING DFHEIV0,
  5016           DFHEIV1,
  5017           ACCOUNT-MASTER,
  5018           DFHEIV12,
  5019           WS-AM-KEY,
  5020           DFHEIV99,
  5021           DFHEIV11,
  5022           DFHEIV99,
  5023           DFHEIV99
  5024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5025           IF RESP-NORMAL
  5026              EVALUATE TRUE
  5027                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5028                    CM-CONTROL-PRIMARY (1:20)
  5029                    SET TOLD-TO-STOP TO TRUE
  5030                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5031                    CM-CONTROL-PRIMARY (1:20))
  5032                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5033                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5034                    SET ERACCT-FOUND      TO TRUE
  5035                    SET TOLD-TO-STOP TO TRUE
  5036              END-EVALUATE
  5037           ELSE
  5038              SET TOLD-TO-STOP TO TRUE
  5039           END-IF
  5040        END-PERFORM
  5041
  5042* EXEC CICS ENDBR
  5043*          DATASET   ('ERACCT')
  5044*       END-EXEC
  5045     MOVE 'ERACCT' TO DFHEIV1
  5046     MOVE 0
  5047       TO DFHEIV11
  5048*    MOVE '&2                    $   #00004705' TO DFHEIV0
  5049     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5050     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5051     MOVE X'2020233030303034373035' TO DFHEIV0(25:11)
  5052     CALL 'kxdfhei1' USING DFHEIV0,
  5053           DFHEIV1,
  5054           DFHEIV11,
  5055           DFHEIV99
  5056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5057     END-IF
  5058     .
  5059 0350-EXIT.
  5060     EXIT.
  5061 0400-PROCESS-LIFE.
  5062     MOVE SPACES                 TO WS-BUFF-SENT-SW
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  89
* SOCK03.cbl
  5063     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5064     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5065     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5066     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5067     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5068     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5069     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5070     MOVE CM-CARRIER             TO WS-CARRIER
  5071     MOVE CM-GROUPING            TO WS-GROUPING
  5072     MOVE CM-STATE               TO WS-STATE
  5073     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5074     MOVE CM-CERT-NO             TO WS-CERT-NO
  5075     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5076     MOVE ' '                    TO  DC-OPTION-CODE.
  5077     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5078     IF NO-CONVERSION-ERROR
  5079        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5080     ELSE
  5081        MOVE 99999999            TO WS-CERT-EFF-DATE
  5082     END-IF
  5083     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5084        GO TO 0400-EXIT
  5085     END-IF
  5086     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5087                                    WS-TOT-LF-PREM
  5088                                    WS-TOT-LF-COMM
  5089     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5090     MOVE ' '                    TO  DC-OPTION-CODE
  5091     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5092     IF NO-CONVERSION-ERROR
  5093        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5094     ELSE
  5095        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5096     END-IF
  5097     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5098     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5099     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5100     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5101     MOVE CM-STATE               TO CP-STATE
  5102     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5103     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5104     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5105     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5106     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5107     MOVE '2'                    TO CP-PROCESS-TYPE
  5108     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5109     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5110     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5111     MOVE WS-CF-REM-TRM-CALC-OPTION
  5112                                 TO CP-REM-TRM-CALC-OPTION
  5113     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5114     IF WS-LF-CO-REM-TERM-CALC > '0'
  5115        MOVE WS-LF-CO-REM-TERM-CALC
  5116                                 TO CP-REM-TERM-METHOD
  5117     END-IF
  5118     IF WS-LF-ST-REM-TERM-CALC > '0'
  5119         MOVE WS-LF-ST-REM-TERM-CALC
  5120                                 TO  CP-REM-TERM-METHOD.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  90
* SOCK03.cbl
  5121     IF WS-LF-AM-REM-TERM-CALC > '0'
  5122         MOVE WS-LF-AM-REM-TERM-CALC
  5123                                 TO  CP-REM-TERM-METHOD.
  5124     IF (WS-COMP-ID = 'CID')
  5125        AND (CP-STATE-STD-ABBRV = 'WI')
  5126        MOVE '7'                 TO CP-REM-TERM-METHOD
  5127        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5128     END-IF
  5129     IF (WS-COMP-ID = 'CID')
  5130        AND (CP-STATE-STD-ABBRV = 'MO')
  5131        AND (CM-CERT-EFF-DT >= X'9B41')
  5132        AND (CM-CERT-EFF-DT <= X'A2FB')
  5133        MOVE '7'                 TO CP-REM-TERM-METHOD
  5134        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5135     END-IF
  5136     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5137                                    CP-LOAN-TERM
  5138                                    WS-LF-TERM
  5139     IF CP-TRUNCATED-LIFE
  5140         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5141     IF CP-TERM-IS-DAYS
  5142        IF CM-LF-TERM-IN-DAYS NUMERIC
  5143           MOVE CM-LF-TERM-IN-DAYS
  5144                                 TO CP-TERM-OR-EXT-DAYS
  5145        ELSE
  5146           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5147        END-IF
  5148     ELSE
  5149        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5150           MOVE CM-PMT-EXTENSION-DAYS
  5151                                 TO CP-TERM-OR-EXT-DAYS
  5152        ELSE
  5153           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5154        END-IF
  5155     END-IF
  5156     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5157     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5158        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5159        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5160     END-IF
  5161     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5162     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5163     MOVE ' '                    TO WS-CLM-STOP-SW
  5164     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5165     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5166
  5167* EXEC CICS STARTBR
  5168*       DATASET     ('ELMSTR5')
  5169*       RIDFLD      (ELMSTR-KEY)
  5170*       RESP        (WS-RESPONSE)
  5171*    END-EXEC
  5172     MOVE 'ELMSTR5' TO DFHEIV1
  5173     MOVE 0
  5174       TO DFHEIV11
  5175*    MOVE '&,         G          &  N#00004817' TO DFHEIV0
  5176     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5177     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5178     MOVE X'204E233030303034383137' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  91
* SOCK03.cbl
  5179     CALL 'kxdfhei1' USING DFHEIV0,
  5180           DFHEIV1,
  5181           ELMSTR-KEY,
  5182           DFHEIV99,
  5183           DFHEIV11,
  5184           DFHEIV99
  5185     MOVE EIBRESP  TO WS-RESPONSE
  5186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5187     DISPLAY ' AFTER START ' WS-RESPONSE
  5188     IF RESP-NORMAL
  5189        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5190
  5191* EXEC CICS READNEXT
  5192*             DATASET   ('ELMSTR5')
  5193*             RIDFLD    (ELMSTR-KEY)
  5194*             INTO      (CLAIM-MASTER)
  5195*             RESP      (WS-RESPONSE)
  5196*          END-EXEC
  5197     MOVE LENGTH OF
  5198      CLAIM-MASTER
  5199       TO DFHEIV12
  5200     MOVE 'ELMSTR5' TO DFHEIV1
  5201     MOVE 0
  5202       TO DFHEIV11
  5203*    MOVE '&.IL                  )  N#00004825' TO DFHEIV0
  5204     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5205     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5206     MOVE X'204E233030303034383235' TO DFHEIV0(25:11)
  5207     CALL 'kxdfhei1' USING DFHEIV0,
  5208           DFHEIV1,
  5209           CLAIM-MASTER,
  5210           DFHEIV12,
  5211           ELMSTR-KEY,
  5212           DFHEIV99,
  5213           DFHEIV11,
  5214           DFHEIV99,
  5215           DFHEIV99
  5216     MOVE EIBRESP  TO WS-RESPONSE
  5217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5218        IF (RESP-NORMAL OR RESP-DUPKEY)
  5219           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5220           AND (CM-CERT-NO = CL-CERT-NO)
  5221           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5222              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5223              IF CL-CLAIM-TYPE = 'L'
  5224                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5225                    MOVE 'D'     TO WS-AH-STATUS
  5226                 END-IF
  5227                 IF CLAIM-IS-OPEN
  5228                    MOVE ' OPEN LIFE CLAIM '
  5229                                 TO WS-COMMENT
  5230                    MOVE 'L'     TO WS-LF-STATUS
  5231                    GO TO 0400-EXIT
  5232                 ELSE
  5233                    MOVE ' DEATH CLAIM APPLIED '
  5234                                 TO WS-COMMENT
  5235                    MOVE 'D'     TO WS-LF-STATUS
  5236*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  92
* SOCK03.cbl
  5237*                      MOVE CL-PAID-THRU-DT
  5238*                                TO WS-LF-BIN-PAID-THRU-DT
  5239*                   END-IF
  5240                 END-IF
  5241              END-IF
  5242           END-IF
  5243        ELSE
  5244           SET I-SAY-TO-STOP TO TRUE
  5245        END-IF
  5246        END-PERFORM
  5247
  5248* EXEC CICS ENDBR
  5249*          DATASET   ('ELMSTR5')
  5250*       END-EXEC
  5251     MOVE 'ELMSTR5' TO DFHEIV1
  5252     MOVE 0
  5253       TO DFHEIV11
  5254*    MOVE '&2                    $   #00004860' TO DFHEIV0
  5255     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5256     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5257     MOVE X'2020233030303034383630' TO DFHEIV0(25:11)
  5258     CALL 'kxdfhei1' USING DFHEIV0,
  5259           DFHEIV1,
  5260           DFHEIV11,
  5261           DFHEIV99
  5262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5263     END-IF
  5264     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5265*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5266        MOVE WS-LF-BIN-PAID-THRU-DT
  5267                                 TO DC-BIN-DATE-1
  5268        MOVE ' '                 TO DC-OPTION-CODE
  5269        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5270        IF NO-CONVERSION-ERROR
  5271           MOVE DC-GREG-DATE-CYMD
  5272                                 TO WS-CLM-PAID-THRU-DT
  5273        ELSE
  5274           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5275        END-IF
  5276*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5277*          MOVE 'CAN DT =< CLM PD THRU DT'
  5278*                                TO WS-COMMENT
  5279*          MOVE 'P'              TO WS-LF-STATUS
  5280*          GO TO 0400-EXIT
  5281*       END-IF
  5282        GO TO 0400-EXIT
  5283     END-IF
  5284     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5285     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5286        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5287        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5288        COMPUTE CP-REMAINING-TERM-1 =
  5289                CP-REMAINING-TERM-1 - +1
  5290        COMPUTE CP-REMAINING-TERM-2 =
  5291                CP-REMAINING-TERM-2 - +1
  5292     END-IF
  5293     IF CP-REMAINING-TERM-1 NEGATIVE
  5294        MOVE ZEROS               TO CP-REMAINING-TERM-1
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  93
* SOCK03.cbl
  5295     END-IF
  5296     IF CP-REMAINING-TERM-2 NEGATIVE
  5297        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5298     END-IF
  5299     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5300        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5301     END-IF
  5302     IF CM-LIFE-COMM-PCT > ZEROS
  5303        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5304           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5305     END-IF
  5306     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5307     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5308     IF CM-LF-CURRENT-STATUS = '8'
  5309        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5310           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5311                                 TO WS-COMMENT
  5312           MOVE 'C'              TO WS-LF-STATUS
  5313*          PERFORM 0030-BUILD-BUFFER
  5314*                                THRU 0030-EXIT
  5315*          PERFORM 0020-SEND-BUFFER
  5316*                                THRU 0020-EXIT
  5317*          SET ALREADY-SENT      TO TRUE
  5318*          MOVE SPACES           TO WS-COMMENT
  5319           GO TO 0400-EXIT
  5320*          PERFORM 0025-CLOSE-SOCKET
  5321*                                THRU 0025-EXIT
  5322*          GO TO 0010-RETURN
  5323        END-IF
  5324     END-IF
  5325     IF CM-LF-CURRENT-STATUS = '7'
  5326        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5327           MOVE ' DEATH CLAIM APPLIED '
  5328                                 TO WS-COMMENT
  5329           MOVE 'D'              TO WS-LF-STATUS
  5330*          PERFORM 0030-BUILD-BUFFER
  5331*                                THRU 0030-EXIT
  5332*          IF NOT ALREADY-SENT
  5333*             PERFORM 0020-SEND-BUFFER
  5334*                                THRU 0020-EXIT
  5335*             SET ALREADY-SENT   TO TRUE
  5336*          END-IF
  5337           GO TO 0400-EXIT
  5338*          PERFORM 0025-CLOSE-SOCKET
  5339*                                THRU 0025-EXIT
  5340*          GO TO 0010-RETURN
  5341        END-IF
  5342     END-IF
  5343     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5344        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5345        MOVE 'LF COVERAGE EXPIRED '
  5346                                 TO WS-COMMENT
  5347        MOVE 'E'                 TO WS-LF-STATUS
  5348        GO TO 0400-EXIT
  5349     END-IF
  5350     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5351        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5352        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  94
* SOCK03.cbl
  5353     ELSE
  5354        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5355     END-IF
  5356     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5357     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5358     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5359     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5360*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5361     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5362        CM-LF-ALT-BENEFIT-AMT
  5363*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5364     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5365                                    WS-LF-REM-BEN
  5366     COMPUTE WS-TOT-LF-PREM = CM-LF-PREMIUM-AMT
  5367                             + CM-LF-ALT-PREMIUM-AMT
  5368     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5369     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5370        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5371        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5372     ELSE
  5373        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5374     END-IF
  5375     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5376     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5377     IF WS-LF-ST-REFUND-CALC > ZERO
  5378         MOVE WS-LF-ST-REFUND-CALC
  5379                                 TO  CP-EARNING-METHOD.
  5380     IF WS-LF-FO-REFUND-CALC > ZERO
  5381         MOVE WS-LF-FO-REFUND-CALC
  5382                                 TO  CP-EARNING-METHOD.
  5383     IF CP-RATING-METHOD = '4'
  5384        MOVE '4'                 TO CP-EARNING-METHOD
  5385     END-IF
  5386     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5387     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5388     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5389                                     CP-RATING-BENEFIT-AMT.
  5390     IF CP-STATE-STD-ABBRV = 'OR'
  5391         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5392                                         CM-LF-ALT-BENEFIT-AMT.
  5393****   N O T E   ****
  5394*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5395*      THE OH HARD CODING IN ELCRFNDP
  5396     IF WS-COMP-ID = 'CID'
  5397        IF CP-STATE-STD-ABBRV = 'OH'
  5398           MOVE WS-LF-CO-EARNINGS-CALC
  5399                                 TO CP-EARNING-METHOD
  5400        END-IF
  5401     END-IF
  5402****   N O T E   ****
  5403     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5404     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5405     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5406     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5407     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5408     IF CP-EARN-AS-NET-PAY
  5409        IF CP-LOAN-APR <= ZEROS
  5410           IF WS-CF-DEFAULT-APR > ZEROS
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  95
* SOCK03.cbl
  5411              MOVE WS-CF-DEFAULT-APR
  5412                                 TO  CP-LOAN-APR
  5413           END-IF
  5414        END-IF
  5415     END-IF
  5416*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5417*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5418*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5419*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5420*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5421*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5422*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5423*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5424*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5425*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5426*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5427*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5428*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
  5429*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5430*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5431*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5432*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5433     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5434     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5435     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5436     DISPLAY ' MADE IT BACK FROM ELRFND '
  5437     IF (CP-ERROR-RATE-IS-ZERO)
  5438        OR (CP-ERROR-RATE-NOT-FOUND)
  5439        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5440        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5441          DELIMITED BY SIZE INTO WS-COMMENT
  5442        END-STRING
  5443        MOVE 'X'                 TO WS-LF-STATUS
  5444        GO TO 0400-EXIT
  5445*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5446*       IF NOT ALREADY-SENT
  5447*          PERFORM 0020-SEND-BUFFER
  5448*                                THRU 0020-EXIT
  5449*          SET ALREADY-SENT      TO TRUE
  5450*       END-IF
  5451*       PERFORM 0025-CLOSE-SOCKET
  5452*                                THRU 0025-EXIT
  5453*       GO TO 0010-RETURN
  5454     END-IF
  5455     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5456                                    WS-TOT-LF-RFND
  5457     IF (WS-LF-STATUS = SPACES)
  5458        OR (CP-CALC-REFUND > ZEROS)
  5459        MOVE 'A'                 TO WS-LF-STATUS
  5460     END-IF
  5461     EVALUATE TRUE
  5462        WHEN CP-R-AS-R78
  5463           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5464        WHEN  CP-R-AS-PRORATA
  5465           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5466        WHEN CP-R-AS-CALIF
  5467           MOVE 'CALIF'            TO  WS-LF-METHOD
  5468        WHEN CP-R-AS-TEXAS
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  96
* SOCK03.cbl
  5469           MOVE 'IRREG'            TO  WS-LF-METHOD
  5470        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5471           MOVE 'UTAH'             TO  WS-LF-METHOD
  5472        WHEN CP-R-AS-FARM-PLAN
  5473           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5474        WHEN CP-R-AS-NET-PAY
  5475           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5476        WHEN CP-R-AS-ANTICIPATION
  5477           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5478        WHEN CP-R-AS-MEAN
  5479           MOVE 'MEAN'             TO  WS-LF-METHOD
  5480        WHEN CP-R-AS-SUM-OF-DIGITS
  5481           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5482     END-EVALUATE
  5483     IF WS-TOT-LF-RFND > ZEROS
  5484        COMPUTE WS-WORK-FACTOR ROUNDED =
  5485           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5486        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
  5487           WS-TOT-LF-COMM
  5488     END-IF
  5489     IF ERACCT-FOUND
  5490        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5491           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5492        END-IF
  5493        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5494           IF (AM-COMM-CHARGEBACK (1) = 99)
  5495                     OR
  5496              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5497                     OR
  5498              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5499              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5500              MOVE ZEROS         TO WS-LF-UEC
  5501           END-IF
  5502        END-IF
  5503     END-IF
  5504     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5505        GO TO 0400-EXIT
  5506     END-IF
  5507     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5508     MOVE '2'                    TO  CP-EARNING-METHOD
  5509                                     CP-RATING-METHOD.
  5510     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5511                                     CP-REMAINING-BENEFIT
  5512                                     CP-RATING-BENEFIT-AMT.
  5513     IF CP-STATE-STD-ABBRV = 'OR'
  5514         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5515                                         CM-LF-ALT-BENEFIT-AMT.
  5516     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5517     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5518     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5519     IF (CP-ERROR-RATE-IS-ZERO)
  5520        OR (CP-ERROR-RATE-NOT-FOUND)
  5521        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5522        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5523          DELIMITED BY SIZE INTO WS-COMMENT
  5524        END-STRING
  5525        MOVE 'X'              TO WS-LF-STATUS
  5526        GO TO 0400-EXIT
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  97
* SOCK03.cbl
  5527*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5528*       IF NOT ALREADY-SENT
  5529*          PERFORM 0020-SEND-BUFFER
  5530*                                THRU 0020-EXIT
  5531*          SET ALREADY-SENT      TO TRUE
  5532*       END-IF
  5533*       PERFORM 0025-CLOSE-SOCKET
  5534*                                THRU 0025-EXIT
  5535*       GO TO 0010-RETURN
  5536     END-IF
  5537     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5538     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5539     IF WS-TOT-LF-RFND > ZEROS
  5540        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5541           WS-TOT-LF-COMM
  5542     END-IF
  5543     IF ERACCT-FOUND
  5544        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5545           IF (AM-COMM-CHARGEBACK (1) = 99)
  5546                     OR
  5547              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5548                     OR
  5549              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5550              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5551              MOVE ZEROS         TO WS-LF-UEC
  5552           END-IF
  5553        END-IF
  5554     END-IF
  5555     .
  5556 0400-EXIT.
  5557     EXIT.
  5558 0500-PROCESS-AH.
  5559     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5560        GO TO 0500-EXIT
  5561     END-IF
  5562     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5563                                    WS-TOT-AH-PREM
  5564                                    WS-TOT-AH-COMM
  5565     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5566     MOVE ' '                    TO  DC-OPTION-CODE
  5567     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5568     IF NO-CONVERSION-ERROR
  5569        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5570     ELSE
  5571        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5572     END-IF
  5573     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  5574     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5575     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5576     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5577     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5578     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5579     MOVE CM-STATE               TO  CP-STATE.
  5580     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5581     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5582     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5583     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5584     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  98
* SOCK03.cbl
  5585     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5586     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5587     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5588     MOVE WS-CF-CR-REM-TERM-CALC
  5589                                 TO  CP-REM-TERM-METHOD.
  5590     IF WS-AH-CO-REM-TERM-CALC > '0'
  5591         MOVE WS-AH-CO-REM-TERM-CALC
  5592                                 TO  CP-REM-TERM-METHOD.
  5593     IF WS-AH-ST-REM-TERM-CALC > '0'
  5594         MOVE WS-AH-ST-REM-TERM-CALC
  5595                                 TO  CP-REM-TERM-METHOD.
  5596     IF WS-AH-AM-REM-TERM-CALC > '0'
  5597         MOVE WS-AH-AM-REM-TERM-CALC
  5598                                 TO  CP-REM-TERM-METHOD.
  5599     IF (WS-COMP-ID = 'CID')
  5600        AND (CP-STATE-STD-ABBRV = 'WI')
  5601        MOVE '7'                 TO CP-REM-TERM-METHOD
  5602        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5603     END-IF
  5604     IF (WS-COMP-ID = 'CID')
  5605        AND (CP-STATE-STD-ABBRV = 'MO')
  5606        AND (CM-CERT-EFF-DT >= X'9B41')
  5607        AND (CM-CERT-EFF-DT <= X'A2FB')
  5608        MOVE '7'                 TO CP-REM-TERM-METHOD
  5609        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5610     END-IF
  5611     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5612                                     CP-LOAN-TERM.
  5613     IF  NOT  CP-TERM-IS-DAYS
  5614         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5615             MOVE CM-PMT-EXTENSION-DAYS
  5616                                 TO  CP-TERM-OR-EXT-DAYS
  5617         ELSE
  5618             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5619     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5620     IF CM-AH-COMM-PCT > ZEROS
  5621        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5622           CM-AH-PREMIUM-AMT
  5623     END-IF
  5624     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5625     IF WS-AH-STATUS = 'D'
  5626        GO TO 0500-EXIT
  5627     END-IF
  5628     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5629     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5630     MOVE ' '                    TO WS-CLM-STOP-SW
  5631     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5632     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5633
  5634* EXEC CICS STARTBR
  5635*       DATASET     ('ELMSTR5')
  5636*       RIDFLD      (ELMSTR-KEY)
  5637*       RESP        (WS-RESPONSE)
  5638*    END-EXEC
  5639     MOVE 'ELMSTR5' TO DFHEIV1
  5640     MOVE 0
  5641       TO DFHEIV11
  5642*    MOVE '&,         G          &  N#00005233' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page  99
* SOCK03.cbl
  5643     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5645     MOVE X'204E233030303035323333' TO DFHEIV0(25:11)
  5646     CALL 'kxdfhei1' USING DFHEIV0,
  5647           DFHEIV1,
  5648           ELMSTR-KEY,
  5649           DFHEIV99,
  5650           DFHEIV11,
  5651           DFHEIV99
  5652     MOVE EIBRESP  TO WS-RESPONSE
  5653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5654     DISPLAY ' AFTER START ' WS-RESPONSE
  5655     IF RESP-NORMAL
  5656        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5657           DISPLAY ' AH READNEXT '
  5658
  5659* EXEC CICS READNEXT
  5660*             DATASET   ('ELMSTR5')
  5661*             RIDFLD    (ELMSTR-KEY)
  5662*             INTO      (CLAIM-MASTER)
  5663*             RESP      (WS-RESPONSE)
  5664*          END-EXEC
  5665     MOVE LENGTH OF
  5666      CLAIM-MASTER
  5667       TO DFHEIV12
  5668     MOVE 'ELMSTR5' TO DFHEIV1
  5669     MOVE 0
  5670       TO DFHEIV11
  5671*    MOVE '&.IL                  )  N#00005242' TO DFHEIV0
  5672     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5673     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5674     MOVE X'204E233030303035323432' TO DFHEIV0(25:11)
  5675     CALL 'kxdfhei1' USING DFHEIV0,
  5676           DFHEIV1,
  5677           CLAIM-MASTER,
  5678           DFHEIV12,
  5679           ELMSTR-KEY,
  5680           DFHEIV99,
  5681           DFHEIV11,
  5682           DFHEIV99,
  5683           DFHEIV99
  5684     MOVE EIBRESP  TO WS-RESPONSE
  5685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5686        IF (RESP-NORMAL OR RESP-DUPKEY)
  5687           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5688           AND (CM-CERT-NO = CL-CERT-NO)
  5689           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5690              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5691              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G')
  5692                 IF CLAIM-IS-OPEN
  5693                    DISPLAY ' FOUND OPEN AH CLAIM '
  5694                    MOVE ' OPEN HEALTH CLAIM '
  5695                                 TO WS-COMMENT
  5696                    MOVE 'H'     TO WS-AH-STATUS
  5697                 ELSE
  5698                    DISPLAY ' FOUND CLOSED AH CLAIM '
  5699                    MOVE ' CLOSED HEALTH CLAIM '
  5700                                 TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page 100
* SOCK03.cbl
  5701                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  5702                       MOVE CL-PAID-THRU-DT
  5703                                 TO WS-AH-BIN-PAID-THRU-DT
  5704                    END-IF
  5705                 END-IF
  5706              END-IF
  5707           END-IF
  5708        ELSE
  5709           SET I-SAY-TO-STOP TO TRUE
  5710        END-IF
  5711        END-PERFORM
  5712
  5713* EXEC CICS ENDBR
  5714*          DATASET   ('ELMSTR5')
  5715*       END-EXEC
  5716     MOVE 'ELMSTR5' TO DFHEIV1
  5717     MOVE 0
  5718       TO DFHEIV11
  5719*    MOVE '&2                    $   #00005274' TO DFHEIV0
  5720     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5721     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5722     MOVE X'2020233030303035323734' TO DFHEIV0(25:11)
  5723     CALL 'kxdfhei1' USING DFHEIV0,
  5724           DFHEIV1,
  5725           DFHEIV11,
  5726           DFHEIV99
  5727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5728     END-IF
  5729     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5730*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  5731        MOVE WS-AH-BIN-PAID-THRU-DT
  5732                                 TO DC-BIN-DATE-1
  5733        MOVE ' '                 TO DC-OPTION-CODE
  5734        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5735        IF NO-CONVERSION-ERROR
  5736           MOVE DC-GREG-DATE-CYMD
  5737                                 TO WS-CLM-PAID-THRU-DT
  5738        ELSE
  5739           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5740        END-IF
  5741        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  5742           MOVE 'CAN DT NOT > CLM CLOSE DT '
  5743                                 TO WS-COMMENT
  5744           MOVE 'P'              TO WS-AH-STATUS
  5745           GO TO 0500-EXIT
  5746        END-IF
  5747     END-IF
  5748     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5749     IF CM-AH-CURRENT-STATUS = '8'
  5750        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  5751           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  5752                                 TO WS-COMMENT
  5753           MOVE 'C'              TO WS-AH-STATUS
  5754           GO TO 0500-EXIT
  5755        END-IF
  5756     END-IF
  5757     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  5758        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page 101
* SOCK03.cbl
  5759           MOVE ' SETTLEMENT CLAIM APPLIED '
  5760                                 TO WS-COMMENT
  5761           MOVE 'S'              TO WS-AH-STATUS
  5762*          PERFORM 0030-BUILD-BUFFER
  5763*                                THRU 0030-EXIT
  5764*          IF NOT ALREADY-SENT
  5765*             PERFORM 0020-SEND-BUFFER
  5766*                                THRU 0020-EXIT
  5767*             SET ALREADY-SENT   TO TRUE
  5768*          END-IF
  5769           GO TO 0500-EXIT
  5770*          PERFORM 0025-CLOSE-SOCKET
  5771*                                THRU 0025-EXIT
  5772*          GO TO 0010-RETURN
  5773        END-IF
  5774     END-IF
  5775     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5776        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
  5777        MOVE 'AH COVERAGE EXPIRED '
  5778                                 TO WS-COMMENT
  5779        MOVE 'E'                 TO WS-AH-STATUS
  5780        GO TO 0500-EXIT
  5781     END-IF
  5782     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  5783                                    WS-AH-PREM
  5784     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  5785     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  5786        * CP-REMAINING-TERM-1
  5787     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  5788                                     WS-AH-REM-TERM
  5789     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5790     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5791     IF WS-AH-ST-REFUND-CALC > ZERO
  5792         MOVE WS-AH-ST-REFUND-CALC
  5793                                 TO  CP-EARNING-METHOD.
  5794     IF WS-AH-FO-REFUND-CALC > ZERO
  5795         MOVE WS-AH-FO-REFUND-CALC
  5796                                 TO  CP-EARNING-METHOD.
  5797     MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5798     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5799     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5800                                     CP-RATING-BENEFIT-AMT.
  5801     IF CP-STATE-STD-ABBRV = 'OR'
  5802         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  5803                                         CM-AH-ORIG-TERM.
  5804     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5805     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  5806     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5807     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  5808     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5809     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  5810     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5811     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5812     MOVE ' '                    TO  DC-OPTION-CODE.
  5813     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5814     IF CP-STATE-STD-ABBRV = 'OH'
  5815        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  5816         IF (CP-ORIGINAL-TERM > 60)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page 102
* SOCK03.cbl
  5817           AND (DC-GREG-DATE-1-YMD > '831101')
  5818           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  5819             MOVE '6'            TO  CP-EARNING-METHOD
  5820         END-IF
  5821        END-IF
  5822        IF WS-COMP-ID = 'CID'
  5823           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  5824                           LOW-VALUES)
  5825              IF CP-CRITICAL-PERIOD
  5826                 MOVE '2'       TO CP-EARNING-METHOD
  5827              ELSE
  5828                 MOVE '6'       TO CP-EARNING-METHOD
  5829              END-IF
  5830           ELSE
  5831              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  5832                 MOVE '2'       TO CP-EARNING-METHOD
  5833              ELSE
  5834                 IF ((CM-LF-ORIG-TERM > 60) AND
  5835                    (CM-RATE-CLASS NOT = 'L '))
  5836                               OR
  5837                    (WS-LF-CO-EARNINGS-CALC = '5')
  5838                    IF CP-CRITICAL-PERIOD
  5839                       MOVE '2'  TO CP-EARNING-METHOD
  5840                    ELSE
  5841                       MOVE '6'  TO CP-EARNING-METHOD
  5842                    END-IF
  5843                 ELSE
  5844                    MOVE '1'     TO CP-EARNING-METHOD
  5845                 END-IF
  5846              END-IF
  5847           END-IF
  5848        END-IF
  5849     END-IF
  5850     IF CP-STATE-STD-ABBRV = 'VA'
  5851       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  5852         IF DC-GREG-DATE-1-YMD > '921231'
  5853            IF CP-ORIGINAL-TERM > 61
  5854                MOVE '6'            TO  CP-EARNING-METHOD
  5855            ELSE
  5856                MOVE '1'            TO  CP-EARNING-METHOD.
  5857     IF CP-EARN-AS-NET-PAY
  5858        IF CP-LOAN-APR <= ZEROS
  5859           IF WS-CF-DEFAULT-APR > ZEROS
  5860              MOVE WS-CF-DEFAULT-APR
  5861                                 TO  CP-LOAN-APR
  5862           END-IF
  5863        END-IF
  5864     END-IF
  5865     IF WS-COMP-ID = 'DCC'
  5866        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  5867           AND (CP-EARNING-METHOD NOT = 'G')
  5868           MOVE 'S'              TO CP-EARNING-METHOD
  5869        END-IF
  5870     END-IF
  5871     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5872     IF (CP-ERROR-RATE-IS-ZERO)
  5873        OR (CP-ERROR-RATE-NOT-FOUND)
  5874        OR (CP-ERROR-RATE-FILE-NOTOPEN)
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page 103
* SOCK03.cbl
  5875        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  5876          DELIMITED BY SIZE INTO WS-COMMENT
  5877        END-STRING
  5878        IF WS-AH-STATUS NOT = 'H'
  5879           MOVE 'X'                 TO WS-AH-STATUS
  5880        END-IF
  5881        GO TO 0500-EXIT
  5882*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5883*       IF NOT ALREADY-SENT
  5884*          PERFORM 0020-SEND-BUFFER
  5885*                                THRU 0020-EXIT
  5886*          SET ALREADY-SENT      TO TRUE
  5887*       END-IF
  5888*       PERFORM 0025-CLOSE-SOCKET
  5889*                                THRU 0025-EXIT
  5890*       GO TO 0010-RETURN
  5891     END-IF
  5892     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  5893                                    WS-TOT-AH-RFND
  5894     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  5895     IF ((WS-AH-STATUS = SPACES)
  5896        OR (CP-CALC-REFUND > ZEROS))
  5897                  AND
  5898          (WS-AH-STATUS NOT = 'H')
  5899        MOVE 'A'                 TO WS-AH-STATUS
  5900     END-IF
  5901     EVALUATE TRUE
  5902        WHEN CP-R-AS-R78
  5903           MOVE 'RULE 78'          TO  WS-AH-METHOD
  5904        WHEN CP-R-AS-PRORATA
  5905           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  5906        WHEN CP-REFUND-TYPE-USED = '3'
  5907           MOVE 'CALIF'            TO  WS-AH-METHOD
  5908        WHEN CP-R-AS-TEXAS
  5909           MOVE 'IRREG'            TO  WS-AH-METHOD
  5910        WHEN CP-R-AS-FARM-PLAN
  5911           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  5912        WHEN CP-R-AS-NET-PAY
  5913           MOVE 'NET PAY'          TO  WS-AH-METHOD
  5914        WHEN CP-R-AS-ANTICIPATION
  5915           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  5916        WHEN CP-R-AS-MEAN
  5917           MOVE 'MEAN'             TO  WS-AH-METHOD
  5918        WHEN CP-R-AS-SUM-OF-DIGITS
  5919           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  5920        WHEN CP-GAP-ACTUARIAL
  5921           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  5922     END-EVALUATE
  5923     IF WS-TOT-AH-RFND > ZEROS
  5924        COMPUTE WS-WORK-FACTOR ROUNDED =
  5925           WS-TOT-AH-RFND / WS-TOT-AH-PREM
  5926        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  5927           WS-TOT-AH-COMM
  5928     END-IF
  5929     IF ERACCT-FOUND
  5930        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5931           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5932        END-IF
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page 104
* SOCK03.cbl
  5933        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5934           IF (AM-COMM-CHARGEBACK (1) = 99)
  5935                     OR
  5936              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5937                     OR
  5938              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5939              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5940              MOVE ZEROS         TO WS-AH-UEC
  5941           END-IF
  5942        END-IF
  5943     END-IF
  5944     .
  5945 0500-EXIT.
  5946     EXIT.
  5947 0700-LINK-REM-TERM.
  5948
  5949* EXEC CICS LINK
  5950*        PROGRAM   ('ELRTRM')
  5951*        COMMAREA  (CALCULATION-PASS-AREA)
  5952*        LENGTH    (CP-COMM-LENGTH)
  5953*    END-EXEC.
  5954     MOVE 'ELRTRM' TO DFHEIV1
  5955*    MOVE '."C                   ''   #00005497' TO DFHEIV0
  5956     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5957     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5958     MOVE X'2020233030303035343937' TO DFHEIV0(25:11)
  5959     CALL 'kxdfhei1' USING DFHEIV0,
  5960           DFHEIV1,
  5961           CALCULATION-PASS-AREA,
  5962           CP-COMM-LENGTH,
  5963           DFHEIV99,
  5964           DFHEIV99,
  5965           DFHEIV99
  5966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5967
  5968 0700-EXIT.
  5969     EXIT.
  5970 0710-LINK-REM-AMOUNT.
  5971
  5972* EXEC CICS LINK
  5973*        PROGRAM   ('ELRAMT')
  5974*        COMMAREA  (CALCULATION-PASS-AREA)
  5975*        LENGTH    (CP-COMM-LENGTH)
  5976*    END-EXEC
  5977     MOVE 'ELRAMT' TO DFHEIV1
  5978*    MOVE '."C                   ''   #00005505' TO DFHEIV0
  5979     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5980     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5981     MOVE X'2020233030303035353035' TO DFHEIV0(25:11)
  5982     CALL 'kxdfhei1' USING DFHEIV0,
  5983           DFHEIV1,
  5984           CALCULATION-PASS-AREA,
  5985           CP-COMM-LENGTH,
  5986           DFHEIV99,
  5987           DFHEIV99,
  5988           DFHEIV99
  5989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5990     .
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page 105
* SOCK03.cbl
  5991 0710-EXIT.
  5992     EXIT.
  5993 0720-LINK-REFUND.
  5994
  5995* EXEC CICS LINK
  5996*        PROGRAM   ('ELRFND')
  5997*        COMMAREA  (CALCULATION-PASS-AREA)
  5998*        LENGTH    (CP-COMM-LENGTH)
  5999*    END-EXEC
  6000     MOVE 'ELRFND' TO DFHEIV1
  6001*    MOVE '."C                   ''   #00005514' TO DFHEIV0
  6002     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6004     MOVE X'2020233030303035353134' TO DFHEIV0(25:11)
  6005     CALL 'kxdfhei1' USING DFHEIV0,
  6006           DFHEIV1,
  6007           CALCULATION-PASS-AREA,
  6008           CP-COMM-LENGTH,
  6009           DFHEIV99,
  6010           DFHEIV99,
  6011           DFHEIV99
  6012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6013     .
  6014 0720-EXIT.
  6015     EXIT.
  6016 9700-DATE-LINK.
  6017
  6018* EXEC CICS LINK
  6019*         PROGRAM  ('ELDATCV')
  6020*         COMMAREA (DATE-CONVERSION-DATA)
  6021*         LENGTH   (DC-COMM-LENGTH)
  6022*    END-EXEC.
  6023     MOVE 'ELDATCV' TO DFHEIV1
  6024*    MOVE '."C                   ''   #00005523' TO DFHEIV0
  6025     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6026     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6027     MOVE X'2020233030303035353233' TO DFHEIV0(25:11)
  6028     CALL 'kxdfhei1' USING DFHEIV0,
  6029           DFHEIV1,
  6030           DATE-CONVERSION-DATA,
  6031           DC-COMM-LENGTH,
  6032           DFHEIV99,
  6033           DFHEIV99,
  6034           DFHEIV99
  6035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6036
  6037 9700-EXIT.
  6038      EXIT.
  6039
  6040 9999-DFHBACK SECTION.
  6041     MOVE '9%                    "   ' TO DFHEIV0
  6042     MOVE 'SOCK03' TO DFHEIV1
  6043     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6044     GOBACK.
  6045 9999-DFHEXIT.
  6046     IF DFHEIGDJ EQUAL 0001
  6047         NEXT SENTENCE.
  6048     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 24-Jan-12 14:35 Page 106
* SOCK03.cbl
  6049     MOVE 'SOCK03' TO DFHEIV1
  6050     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6051     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       16688     Code:       26182
