* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   1
* EL050.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL050.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   2
* EL050.cbl
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   3
* EL050.cbl
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46
    47 77  FILLER   PIC X(32) VALUE '********************************'.
    48 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    49 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    50
    51 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    52 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    53                                   USAGE POINTER.
    54 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    55 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    56 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    57                                   USAGE IS POINTER.
    58 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    59 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    60                                   USAGE IS POINTER.
    61 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    62 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    63                                   USAGE IS POINTER.
    64
    65 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    66 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    67                                   USAGE IS POINTER.
    68
    69*    COPY ELC50WS.
    70*****************************************************************
    71*                                                               *
    72*                            ELC50WS.                           *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.061.                        *
    75*                                                               *
    76*   THIS IS THE WORKING STORAGE FOR EL050                       *
    77*                                   EL517                       *
    78*****************************************************************
    79******************************************************************
    80*                   C H A N G E   L O G
    81*
    82* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    83*-----------------------------------------------------------------
    84*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    85* EFFECTIVE    NUMBER
    86*-----------------------------------------------------------------
    87* 123102                   PEMA  ADD DCC PROCESSING
    88* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
    89* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
    90* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
    91* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    92* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    93* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
    94* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
    95* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
    96* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
    97* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    98* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
    99* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   100* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   101* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   4
* EL050.cbl
   102* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   103* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   104* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   105* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   106* 030309  CR2009021700001  PEMA  ADD ER-2883
   107* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   108* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   109* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   110* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   111* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   112* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   113* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   114* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   115* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   116* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   117*-----------------------------------------------------------------
   118
   119 01  WORK-AREAS.
   120
   121*****************************************************************
   122*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   123*****************************************************************
   124
   125     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   126     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   127     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   128     12  WS-NAME-EDIT-WORK-AREA.
   129         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   130         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   131             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   132         16  WS-WORK-NAME.
   133             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   134             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   135             20  FILLER           PIC X(10)     VALUE SPACES.
   136         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   137             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   138
   139*****************************************************************
   140*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   141*****************************************************************
   142
   143     12  WS-ERRESC-KEY.
   144         16 WS-ERRESC-SEARCH-KEY.
   145             20  WS-ERRESC-COMPANY-CD PIC  X.
   146             20  WS-ERRESC-CARRIER    PIC  X.
   147             20  WS-ERRESC-GROUP      PIC X(6).
   148             20  WS-ERRESC-STATE      PIC XX.
   149             20  WS-ERRESC-ACCOUNT    PIC X(10).
   150         16 WS-ERRESC-RESIDUAL-KEY.
   151             20  WS-ERRESC-AGENT      PIC X(10).
   152             20  WS-ERRESC-RES-STATE  PIC XX.
   153             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   154*                                          YYYYMMDD
   155     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   156     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   157
   158*RESIDENT STATE TAX MASTER(ERRESS)
   159*
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   5
* EL050.cbl
   160     12  WS-ERRESS-KEY.
   161         16  WS-ERRESS-COMPANY-CD      PIC  X.
   162         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   163         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   164         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   165*                                          YYYYMMDD
   166
   167     12  WS-CONTRACT-DATE              PIC 9(8).
   168*                                          YYYYMMDD
   169     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   170     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   171         16 WS-YEAR-YY                 PIC   9999.
   172         16 FILLER                     PIC 9(4).
   173*                                          YYYYMMDD
   174     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   175     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   176     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   177     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   178
   179     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   180         88  DPRB-1ST-TIME                      VALUE ' '.
   181
   182*****************************************************************
   183*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   184*****************************************************************
   185
   186     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   187     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   188     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   189     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   190     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   191     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   192     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   193     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   194     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   195     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   196         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   197         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   198     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   199         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   200         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   201     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   202
   203     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   204     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   205
   206     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   207     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   208     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   209     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   210     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   211     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   212     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   213     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   214     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   215     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   216     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   217     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   6
* EL050.cbl
   218     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   219     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   220     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   221     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   222     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   223     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   224     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   225     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   226     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   227     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   228     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   229     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   230     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   231     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   232     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   233     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   234     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   235     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   236     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   238     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   239     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   240     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   241     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   242     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   243     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   244     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   245     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   246     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   247     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   248     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   249     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   250     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   251     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   252     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   253     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   254     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   255     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   256     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   257     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   258     12  WS-2671-SW               PIC X         VALUE SPACE.
   259     12  WS-2672-SW               PIC X         VALUE SPACE.
   260     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   261         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   262     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   263         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   264     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   265
   266     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   267         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   268         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   269         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   270         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   271
   272     12  WS-CREDIT-EDIT-CONTROLS.
   273         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   274         16  WS-MIN-AGE           PIC 99                VALUE  0.
   275         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   7
* EL050.cbl
   276         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   277         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   278         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   279
   280     12  WS-SAVE-ALLOWABLE-BENEFIT.
   281         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   282         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   283         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   284         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   285         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   286         16  FILLER                      PIC XX.
   287
   288     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   289     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   290     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   291     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   292     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   293     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   294     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   295     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   296     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   297     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   298
   299     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   300     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   301     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   302     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   303     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   304     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   305     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   306     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   307         88  WS-REDUCING              VALUE 'R'.
   308         88  WS-LEVEL                 VALUE 'L' 'P'.
   309     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   310
   311     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   312     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   313     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   314     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   315     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   316     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   317     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   318     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   319
   320     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   321     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   322     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   323     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   324     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   325     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   326     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   327     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   328     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   329     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   330     12  WS-ACCT-SIG-SW.
   331         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   332         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   333     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   8
* EL050.cbl
   334     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   335     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   336     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   337     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   338     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   339     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   340     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   341     12  WS-INITIALS.
   342         16  WS-INIT-1            PIC X         VALUE SPACES.
   343         16  WS-INIT-2            PIC X         VALUE SPACES.
   344
   345     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   346     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   347     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   348     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   349     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   350*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   351     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   352     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   353     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   354     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   355     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   356     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   357     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   358     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   359     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   360     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   361     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   362     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   363     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   364     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   365     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   366     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   367     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   368     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   369     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   370     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   371     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   372     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   373******** FLA
   374     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   375     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   376     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   377     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   378     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   379********
   380     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   381     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   382     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   383     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   384     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   385     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   386     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   387     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   388     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   389     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   390
   391     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page   9
* EL050.cbl
   392         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   393                                         '0' THRU '9'.
   394
   395     12  NUMBER-OF-MONTHS.
   396         16  SK-MO OCCURS 12 TIMES PIC X.
   397
   398     12  WS-WORK-DATE.
   399         16  WS-YEAR            PIC 99    VALUE 00.
   400         16  WS-MONTH           PIC 99    VALUE 00.
   401         16  WS-DAY             PIC 99    VALUE 00.
   402
   403     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   404     12  WS-WORK-CRIT-DEV       REDEFINES
   405         WS-WORK-LF-CRIT-PER    PIC X(03).
   406
   407     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   408     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   409
   410     12  WS-WORK-DATE-FROM.
   411         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   412         16  FILLER             PIC X  VALUE SPACE.
   413         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   414         16  FILLER             PIC X         VALUE SPACE.
   415         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   416
   417     12  WS-WORK-DATE-THRU.
   418         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   419         16  FILLER             PIC X         VALUE SPACE.
   420         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   421         16  FILLER             PIC X         VALUE SPACE.
   422         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   423
   424     12  WS-LF-INPUT-CD.
   425         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   426         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   427
   428     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   429     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   430         16  WS-AH-INPUT-CD-1   PIC X.
   431         16  WS-AH-INPUT-CD-2-3 PIC XX.
   432
   433     12  WS-SWITCHES.
   434         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   435         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   436             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   437         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   438             88  BANK-ACCT-FOUND          VALUE 'Y'.
   439         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   440             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   441         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   442             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   443         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   444             88  COMP-MASTER-FOUND        VALUE 'Y'.
   445         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   446             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   447         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   448             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   449         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  10
* EL050.cbl
   450             88  STAT-MASTER-FOUND        VALUE 'Y'.
   451         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   452             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   453         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   454             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   455         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   456             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   457         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   458             88  FORM-MASTER-FOUND        VALUE 'Y'.
   459         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   460             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   461         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   462             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   463         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   464             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   465         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   466             88  NO-BENEFIT-FOUND         VALUE 'N'.
   467         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   468             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   469         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   470             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   471         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   472             88  AH-BENEFIT-FOUND         VALUE ' '.
   473             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   474         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   475             88  LF-BENEFIT-FOUND         VALUE ' '.
   476             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   477         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   478             88  NO-STATE-RECORD          VALUE '1'.
   479         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   480             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   481         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   482             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   483         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   484             88  CERT-WAS-FOUND           VALUE ' '.
   485             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   486         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   487             88  BROWSE-STARTED           VALUE 'Y'.
   488         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   489             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   490         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   491             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   492         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   493             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   494         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   495             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   496         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   497             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   498         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   499             88  APP-CERT-USED            VALUE 'Y' 'A'.
   500         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   501             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   502             88  FIRST-TIME-THROUGH       VALUE '1'.
   503             88  CTBL-NOT-FOUND           VALUE '2'.
   504
   505         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   506             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   507
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  11
* EL050.cbl
   508         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   509             88  DLO-ERROR-FOUND          VALUE 'Y'.
   510
   511********FLA
   512     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   513     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   514********
   515     12  RC-SW-1                  PIC X           VALUE '0'.
   516     12  RC-SW-2                  PIC X           VALUE '0'.
   517     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   518     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   519     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   520     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   521     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   522     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   523     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   524     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   525     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   526     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   527     12  LIT-SPACES               PIC X           VALUE SPACES.
   528     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   529     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   530     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   531     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   532     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   533     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   534     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   535         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   536         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   537     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   538         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   539
   540 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   541     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   542     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   543 01  WS-CRI-SSN-WORK-AREA.
   544     05  WS-CRI-SOC-SEC-NO.
   545         10  WS-SS-REPT-CD       PIC X(5).
   546         10  WS-SS-LAST-NAME     PIC X(5).
   547         10  WS-SS-INITIAL       PIC X.
   548
   549     05  WS-CRI-REPORT-CODE.
   550         10  FILLER              PIC X(5).
   551         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   552
   553     05  WS-CRI-LAST-NAME.
   554         10  WS-CRI-NAME-MOVE    PIC X(5).
   555         10  FILLER              PIC X(10).
   556
   557 01  WS-NUM-TABLE                PIC X(26)  VALUE
   558     '12345678012345070923456789'.
   559 01  FILLER REDEFINES WS-NUM-TABLE.
   560     05  WS-NUM OCCURS 26        PIC 9.
   561 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   562 01  V1                          PIC S999 COMP-3.
   563 01  V2                          PIC S999 COMP-3.
   564 01  V3                          PIC S999 COMP-3.
   565 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  12
* EL050.cbl
   566 01  FILLER REDEFINES WS-WORK-VIN.
   567     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   568 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   569 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   570 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   571 01  WS-HEX-WORK.
   572     05  FILLER                  PIC X  VALUE LOW-VALUES.
   573     05  WS-HEX-BYTE             PIC X.
   574 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   575 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   576 01  WS-WORK-HIN-ROW-B.
   577     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   578
   579 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   580 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   581     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   582 01  WS-ROW-D-TABLE.
   583     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   584
   585 01  WS-HIN-TABLE-B.
   586     05  F                       PIC XX VALUE 'A2'.
   587     05  F                       PIC XX VALUE 'B3'.
   588     05  F                       PIC XX VALUE 'C4'.
   589     05  F                       PIC XX VALUE 'D5'.
   590     05  F                       PIC XX VALUE 'E6'.
   591     05  F                       PIC XX VALUE 'F7'.
   592     05  F                       PIC XX VALUE 'G8'.
   593     05  F                       PIC XX VALUE 'H9'.
   594     05  F                       PIC XX VALUE 'I1'.
   595     05  F                       PIC XX VALUE 'J2'.
   596     05  F                       PIC XX VALUE 'K3'.
   597     05  F                       PIC XX VALUE 'L4'.
   598     05  F                       PIC XX VALUE 'M5'.
   599     05  F                       PIC XX VALUE 'N6'.
   600     05  F                       PIC XX VALUE 'O0'.
   601     05  F                       PIC XX VALUE 'P7'.
   602     05  F                       PIC XX VALUE 'Q0'.
   603     05  F                       PIC XX VALUE 'R8'.
   604     05  F                       PIC XX VALUE 'S9'.
   605     05  F                       PIC XX VALUE 'T2'.
   606     05  F                       PIC XX VALUE 'U3'.
   607     05  F                       PIC XX VALUE 'V4'.
   608     05  F                       PIC XX VALUE 'W5'.
   609     05  F                       PIC XX VALUE 'X6'.
   610     05  F                       PIC XX VALUE 'Y7'.
   611     05  F                       PIC XX VALUE 'Z8'.
   612 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   613     05  WS-VAL-IN               PIC X.
   614     05  WS-VAL-OUT              PIC 9.
   615 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   616 01  WS-COMPARE-BINARY-DATES.
   617     05  WS-971231                PIC XX VALUE X'92FF'.
   618     05  WS-931231                PIC XX VALUE X'8CFF'.
   619     05  WS-791231                PIC XX VALUE X'77FF'.
   620     05  WS-771001                PIC XX VALUE X'74A1'.
   621     05  WS-820301                PIC XX VALUE X'7B41'.
   622     05  WS-831031                PIC XX VALUE X'7DBF'.
   623     05  WS-831231                PIC XX VALUE X'7DFF'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  13
* EL050.cbl
   624     05  WS-810831                PIC XX VALUE X'7A7F'.
   625     05  WS-830901                PIC XX VALUE X'7D81'.
   626
   627 01  FILE-ACCESS-IDS.
   628     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   629     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   630     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   631     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   632     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   633     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   634     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   635     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   636     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   637     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   638     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   639     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   640     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   641     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   642     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   643     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   644     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   645 01  DD-IU-SW                    PIC X   VALUE ' '.
   646     88  DD-IU-PRESENT                 VALUE 'Y'.
   647
   648 01  ACCESS-KEYS.
   649     12  ELMSTR-KEY.
   650         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   651         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   652     12  W-CLAIM-KEY.
   653         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   654         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   655
   656     12  ELCNTL-KEY.
   657         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   658         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   659         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   660         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   661
   662     12  ELCERT-KEY.
   663         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   664         16  CERT-CARRIER         PIC X       VALUE SPACE.
   665         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   666         16  CERT-STATE           PIC XX      VALUE SPACES.
   667         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   668         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   669         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   670
   671     12  ELCERT2-KEY.
   672         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   673         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   674
   675     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   676
   677     12  ELCERT-SAVE.
   678         16  FILLER                      PIC XX    VALUE SPACES.
   679
   680         16  WCS-CONTROL-PRIMARY.
   681             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  14
* EL050.cbl
   682             20  WCS-CARRIER             PIC X     VALUE SPACE.
   683             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   684             20  WCS-STATE               PIC XX    VALUE SPACES.
   685             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   686             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   687             20  WCS-CERT-NO.
   688                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   689                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   690
   691         16  CS-CONTROL-BY-NAME.
   692             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   693             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   694             20  CS-INSURED-INITIALS.
   695                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   696                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   697
   698         16  CS-CONTROL-BY-SSN.
   699             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   700             20  CS-SOC-SEC-NO.
   701                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   702                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   703                 24  CS-SSN-LN3.
   704                     28 CS-INSURED-INITIALS-A2   PIC XX
   705                                     VALUE SPACES.
   706                     28 CS-PART-LAST-NAME-A2     PIC X
   707                                     VALUE SPACE.
   708
   709         16  CS-CONTROL-BY-CERT-NO.
   710             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   711             20  CS-CERT-NO-A4           PIC X(11)
   712                                     VALUE SPACES.
   713
   714         16  CS-CONTROL-BY-MEMB.
   715             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   716             20  CS-MEMBER-NO.
   717                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   718                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   719                 24  CS-MEMB-LN4.
   720                     28 CS-INSURED-INITIALS-A5   PIC XX
   721                                      VALUE SPACES.
   722                     28 CS-PART-LAST-NAME-A5     PIC XX
   723                                      VALUE SPACES.
   724
   725         16  FILLER              PIC X(360) VALUE SPACES.
   726
   727     12  ERACCT-KEY.
   728         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   729         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   730         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   731         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   732         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   733         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   734
   735     12  ERCOMP-KEY.
   736         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   737         16  COMP-CARRIER         PIC X     VALUE SPACES.
   738         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   739         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  15
* EL050.cbl
   740         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   741         16  COMP-TYPE            PIC X     VALUE SPACES.
   742
   743     12  ERLOFC-KEY.
   744         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   745         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   746         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   747         16  LOFC-STATE           PIC XX    VALUE SPACES.
   748         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   749         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   750
   751     12  WS-ELCRTT-KEY.
   752         16  WS-ELCRTT-PRIMARY       PIC X(33).
   753         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   754
   755     12  ERBXRF-KEY.
   756         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   757         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   758         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   759         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   760
   761     12  ERAGTC-KEY.
   762         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   763         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   764         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   765         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   766         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   767         16  AGTC-TYPE            PIC X     VALUE SPACES.
   768
   769     12  ERPLAN-KEY.
   770         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   771         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   772         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   773         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   774         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   775         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   776         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   777         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   778
   779     12  ERFORM-KEY.
   780         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   781         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   782         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   783         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   784
   785     12  ERREIN-KEY.
   786         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   787         16  REIN-TYPE            PIC X     VALUE SPACES.
   788         16  REIN-TABLE-CO.
   789             20  REIN-CODE-1      PIC X     VALUE SPACE.
   790             20  REIN-CODE-2      PIC X     VALUE SPACE.
   791             20  REIN-CODE-3      PIC X     VALUE SPACE.
   792         16  FILLER               PIC X(3)  VALUE SPACES.
   793
   794     12  ERCTBL-KEY.
   795         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   796         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   797         16  CTBL-CNTRL-2.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  16
* EL050.cbl
   798             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   799             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   800
   801     12  WS-ACCESS.
   802         16  FILLER               PIC XX    VALUE SPACES.
   803         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   804
   805     12  WS-CARR-ACCESS.
   806         16  FILLER               PIC X(3)  VALUE SPACES.
   807         16  WS-CARR              PIC X     VALUE SPACE.
   808*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   809*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   810     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   811         88  WS-DMD-LF-RATING   VALUE 'Y'.
   812         88  WS-DMD-AH-RATING   VALUE 'Y'.
   813         88  WS-DMD-NO-RATING   VALUE 'N'.
   814
   815     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   816         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   817                                         'NJ' 'NL'
   818                                         'PJ' 'PL'
   819                                         'SJ' 'SL'.
   820     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   821         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   822                                         'NI' 'NJ' 'NL' 'NU'
   823                                         'PJ' 'PL' 'PI' 'PU'
   824                                         'SI' 'SJ' 'SL' 'SU'
   825                                         'MX' 'MY' 'MZ'.
   826 01  ERPDEF-KEY-SAVE             PIC X(18).
   827 01  ERPDEF-KEY.
   828     12  ERPDEF-COMPANY-CD       PIC X.
   829     12  ERPDEF-STATE            PIC XX.
   830     12  ERPDEF-PROD-CD          PIC XXX.
   831     12  F                       PIC X(7).
   832     12  ERPDEF-BEN-TYPE         PIC X.
   833     12  ERPDEF-BEN-CODE         PIC XX.
   834     12  ERPDEF-EXP-DT           PIC XX.
   835
   836 01  ELSTAT-KEY-SAVE             PIC X(20).
   837 01  ELSTAT-KEY.
   838     12  ELSTAT-COMPANY-ID       PIC XXX.
   839     12  ELSTAT-CARRIER          PIC X.
   840     12  ELSTAT-GROUP            PIC X(6).
   841     12  ELSTAT-STATE            PIC XX.
   842     12  ELSTAT-EXP-DT           PIC 9(8).
   843 01  WS-ERROR-VALUES.
   844     12  ER-1570                     PIC S9(4)   VALUE +1570.
   845     12  ER-1571                     PIC S9(4)   VALUE +1571.
   846     12  ER-1575                     PIC S9(4)   VALUE +1575.
   847     12  ER-1891                     PIC S9(4)   VALUE +1891.
   848     12  ER-1892                     PIC S9(4)   VALUE +1892.
   849     12  ER-1893                     PIC S9(4)   VALUE +1893.
   850     12  ER-1894                     PIC S9(4)   VALUE +1894.
   851     12  ER-1895                     PIC S9(4)   VALUE +1895.
   852     12  ER-1896                     PIC S9(4)   VALUE +1896.
   853     12  ER-1897                     PIC S9(4)   VALUE +1897.
   854     12  ER-1898                     PIC S9(4)   VALUE +1898.
   855     12  ER-1899                     PIC S9(4)   VALUE +1899.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  17
* EL050.cbl
   856     12  ER-1900                     PIC S9(4)   VALUE +1900.
   857     12  ER-1901                     PIC S9(4)   VALUE +1901.
   858     12  ER-1902                     PIC S9(4)   VALUE +1902.
   859     12  ER-1903                     PIC S9(4)   VALUE +1903.
   860     12  ER-1904                     PIC S9(4)   VALUE +1904.
   861     12  ER-1905                     PIC S9(4)   VALUE +1905.
   862     12  ER-1906                     PIC S9(4)   VALUE +1906.
   863     12  ER-1907                     PIC S9(4)   VALUE +1907.
   864     12  ER-1909                     PIC S9(4)   VALUE +1909.
   865     12  ER-1910                     PIC S9(4)   VALUE +1910.
   866     12  ER-1911                     PIC S9(4)   VALUE +1911.
   867     12  ER-1912                     PIC S9(4)   VALUE +1912.
   868     12  ER-1913                     PIC S9(4)   VALUE +1913.
   869     12  ER-1914                     PIC S9(4)   VALUE +1914.
   870     12  ER-1915                     PIC S9(4)   VALUE +1915.
   871     12  ER-1916                     PIC S9(4)   VALUE +1916.
   872     12  ER-1917                     PIC S9(4)   VALUE +1917.
   873     12  ER-1918                     PIC S9(4)   VALUE +1918.
   874     12  ER-1919                     PIC S9(4)   VALUE +1919.
   875     12  ER-1920                     PIC S9(4)   VALUE +1920.
   876     12  ER-1921                     PIC S9(4)   VALUE +1921.
   877     12  ER-1922                     PIC S9(4)   VALUE +1922.
   878     12  ER-1923                     PIC S9(4)   VALUE +1923.
   879     12  ER-1924                     PIC S9(4)   VALUE +1924.
   880     12  ER-1925                     PIC S9(4)   VALUE +1925.
   881     12  ER-1926                     PIC S9(4)   VALUE +1926.
   882     12  ER-1927                     PIC S9(4)   VALUE +1927.
   883     12  ER-2393                     PIC S9(4)   VALUE +2393.
   884     12  ER-2600                     PIC S9(4)   VALUE +2600.
   885     12  ER-2601                     PIC S9(4)   VALUE +2601.
   886     12  ER-2602                     PIC S9(4)   VALUE +2602.
   887     12  ER-2603                     PIC S9(4)   VALUE +2603.
   888     12  ER-2604                     PIC S9(4)   VALUE +2604.
   889     12  ER-2605                     PIC S9(4)   VALUE +2605.
   890     12  ER-2606                     PIC S9(4)   VALUE +2606.
   891     12  ER-2607                     PIC S9(4)   VALUE +2607.
   892     12  ER-2608                     PIC S9(4)   VALUE +2608.
   893     12  ER-2609                     PIC S9(4)   VALUE +2609.
   894     12  ER-2610                     PIC S9(4)   VALUE +2610.
   895     12  ER-2611                     PIC S9(4)   VALUE +2611.
   896     12  ER-2612                     PIC S9(4)   VALUE +2612.
   897     12  ER-2613                     PIC S9(4)   VALUE +2613.
   898     12  ER-2614                     PIC S9(4)   VALUE +2614.
   899     12  ER-2615                     PIC S9(4)   VALUE +2615.
   900     12  ER-2616                     PIC S9(4)   VALUE +2616.
   901     12  ER-2617                     PIC S9(4)   VALUE +2617.
   902     12  ER-2618                     PIC S9(4)   VALUE +2618.
   903     12  ER-2619                     PIC S9(4)   VALUE +2619.
   904     12  ER-2620                     PIC S9(4)   VALUE +2620.
   905     12  ER-2621                     PIC S9(4)   VALUE +2621.
   906     12  ER-2622                     PIC S9(4)   VALUE +2622.
   907     12  ER-2623                     PIC S9(4)   VALUE +2623.
   908     12  ER-2624                     PIC S9(4)   VALUE +2624.
   909     12  ER-2625                     PIC S9(4)   VALUE +2625.
   910     12  ER-2626                     PIC S9(4)   VALUE +2626.
   911     12  ER-2627                     PIC S9(4)   VALUE +2627.
   912     12  ER-2628                     PIC S9(4)   VALUE +2628.
   913     12  ER-2629                     PIC S9(4)   VALUE +2629.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  18
* EL050.cbl
   914     12  ER-2630                     PIC S9(4)   VALUE +2630.
   915     12  ER-2631                     PIC S9(4)   VALUE +2631.
   916     12  ER-2632                     PIC S9(4)   VALUE +2632.
   917     12  ER-2633                     PIC S9(4)   VALUE +2633.
   918     12  ER-2634                     PIC S9(4)   VALUE +2634.
   919     12  ER-2635                     PIC S9(4)   VALUE +2635.
   920     12  ER-2636                     PIC S9(4)   VALUE +2636.
   921     12  ER-2637                     PIC S9(4)   VALUE +2637.
   922     12  ER-2638                     PIC S9(4)   VALUE +2638.
   923     12  ER-2639                     PIC S9(4)   VALUE +2639.
   924     12  ER-2640                     PIC S9(4)   VALUE +2640.
   925     12  ER-2641                     PIC S9(4)   VALUE +2641.
   926     12  ER-2642                     PIC S9(4)   VALUE +2642.
   927     12  ER-2643                     PIC S9(4)   VALUE +2643.
   928     12  ER-2644                     PIC S9(4)   VALUE +2644.
   929     12  ER-2645                     PIC S9(4)   VALUE +2645.
   930     12  ER-2646                     PIC S9(4)   VALUE +2646.
   931     12  ER-2647                     PIC S9(4)   VALUE +2647.
   932     12  ER-2648                     PIC S9(4)   VALUE +2648.
   933     12  ER-2649                     PIC S9(4)   VALUE +2649.
   934     12  ER-2650                     PIC S9(4)   VALUE +2650.
   935     12  ER-2651                     PIC S9(4)   VALUE +2651.
   936     12  ER-2652                     PIC S9(4)   VALUE +2652.
   937     12  ER-2653                     PIC S9(4)   VALUE +2653.
   938     12  ER-2654                     PIC S9(4)   VALUE +2654.
   939     12  ER-2655                     PIC S9(4)   VALUE +2655.
   940     12  ER-2656                     PIC S9(4)   VALUE +2656.
   941     12  ER-2657                     PIC S9(4)   VALUE +2657.
   942     12  ER-2658                     PIC S9(4)   VALUE +2658.
   943     12  ER-2659                     PIC S9(4)   VALUE +2659.
   944     12  ER-2660                     PIC S9(4)   VALUE +2660.
   945     12  ER-2661                     PIC S9(4)   VALUE +2661.
   946     12  ER-2662                     PIC S9(4)   VALUE +2662.
   947     12  ER-2663                     PIC S9(4)   VALUE +2663.
   948     12  ER-2664                     PIC S9(4)   VALUE +2664.
   949     12  ER-2665                     PIC S9(4)   VALUE +2665.
   950     12  ER-2666                     PIC S9(4)   VALUE +2666.
   951     12  ER-2667                     PIC S9(4)   VALUE +2667.
   952     12  ER-2668                     PIC S9(4)   VALUE +2668.
   953     12  ER-2669                     PIC S9(4)   VALUE +2669.
   954     12  ER-2670                     PIC S9(4)   VALUE +2670.
   955     12  ER-2671                     PIC S9(4)   VALUE +2671.
   956     12  ER-2672                     PIC S9(4)   VALUE +2672.
   957     12  ER-2673                     PIC S9(4)   VALUE +2673.
   958     12  ER-2674                     PIC S9(4)   VALUE +2674.
   959     12  ER-2675                     PIC S9(4)   VALUE +2675.
   960     12  ER-2676                     PIC S9(4)   VALUE +2676.
   961     12  ER-2677                     PIC S9(4)   VALUE +2677.
   962     12  ER-2678                     PIC S9(4)   VALUE +2678.
   963     12  ER-2679                     PIC S9(4)   VALUE +2679.
   964     12  ER-2680                     PIC S9(4)   VALUE +2680.
   965     12  ER-2681                     PIC S9(4)   VALUE +2681.
   966     12  ER-2682                     PIC S9(4)   VALUE +2682.
   967     12  ER-2683                     PIC S9(4)   VALUE +2683.
   968     12  ER-2684                     PIC S9(4)   VALUE +2684.
   969     12  ER-2685                     PIC S9(4)   VALUE +2685.
   970     12  ER-2686                     PIC S9(4)   VALUE +2686.
   971     12  ER-2687                     PIC S9(4)   VALUE +2687.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  19
* EL050.cbl
   972     12  ER-2688                     PIC S9(4)   VALUE +2688.
   973     12  ER-2689                     PIC S9(4)   VALUE +2689.
   974     12  ER-2690                     PIC S9(4)   VALUE +2690.
   975     12  ER-2691                     PIC S9(4)   VALUE +2691.
   976     12  ER-2692                     PIC S9(4)   VALUE +2692.
   977     12  ER-2693                     PIC S9(4)   VALUE +2693.
   978     12  ER-2694                     PIC S9(4)   VALUE +2694.
   979     12  ER-2695                     PIC S9(4)   VALUE +2695.
   980     12  ER-2696                     PIC S9(4)   VALUE +2696.
   981     12  ER-2697                     PIC S9(4)   VALUE +2697.
   982     12  ER-2698                     PIC S9(4)   VALUE +2698.
   983     12  ER-2699                     PIC S9(4)   VALUE +2699.
   984     12  ER-2700                     PIC S9(4)   VALUE +2700.
   985     12  ER-2701                     PIC S9(4)   VALUE +2701.
   986     12  ER-2702                     PIC S9(4)   VALUE +2702.
   987     12  ER-2703                     PIC S9(4)   VALUE +2703.
   988     12  ER-2704                     PIC S9(4)   VALUE +2704.
   989     12  ER-2707                     PIC S9(4)   VALUE +2707.
   990     12  ER-2720                     PIC S9(4)   VALUE +2720.
   991     12  ER-2709                     PIC S9(4)   VALUE +2709.
   992     12  ER-2717                     PIC S9(4)   VALUE +2717.
   993     12  ER-2718                     PIC S9(4)   VALUE +2718.
   994     12  ER-2719                     PIC S9(4)   VALUE +2719.
   995     12  ER-2721                     PIC S9(4)   VALUE +2721.
   996     12  ER-2722                     PIC S9(4)   VALUE +2722.
   997     12  ER-2723                     PIC S9(4)   VALUE +2723.
   998     12  ER-2724                     PIC S9(4)   VALUE +2724.
   999     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1000     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1001     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1002     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1003     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1004     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1005     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1006     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1007     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1008     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1009     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1010     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1011     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1012     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1013     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1014     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1015     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1016     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1017     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1018     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1019     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1020     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1021     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1022     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1023     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1024     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1025     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1026     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1027     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1028     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1029     12  ER-2755                     PIC S9(4)   VALUE +2755.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  20
* EL050.cbl
  1030     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1031     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1032     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1033     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1034     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1035     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1036     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1037     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1038     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1039     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1040     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1041     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1042     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1043     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1044     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1045     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1046     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1047     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1048     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1049     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1050     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1051     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1052     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1053     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1054     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1055     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1056     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1057     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1058     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1059     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1060     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1061     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1062     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1063     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1064     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1065     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1066     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1067     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1068     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1069     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1070     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1071     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1072     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1073     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1074     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1075     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1076     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1077     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1078     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1079     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1080     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1081     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1082     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1083     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1084     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1085     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1086     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1087     12  ER-3006                     PIC S9(4)   VALUE +3006.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  21
* EL050.cbl
  1088     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1089     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1090     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1091     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1092     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1093     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1094     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1095     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1096     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1097     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1098     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1099     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1100     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1101     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1102     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1103     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1104     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1105     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1106     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1107     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1108     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1109     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1110     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1111     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1112     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1113     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1114     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1115     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1116     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1117     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1118     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1119     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1120     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1121     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1122     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1123     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1124     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1125     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1126     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1127     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1128     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1129     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1130     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1131     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1132     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1133     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1134     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1135     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1136     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1137     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1138     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1139     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1140     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1141     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1142     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1143     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1144     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1145     12  ER-8088                     PIC S9(4)   VALUE +8088.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  22
* EL050.cbl
  1146     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1147     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1148     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1149     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1150     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1151     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1152     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1153     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1154     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1155     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1156     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1157     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1158     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1159     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1160     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1161     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1162     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1163     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1164     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1165     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1166     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1167     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1168     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1169     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1170     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1171     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1172     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1173     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1174     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1175     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1176     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1177     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1178     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1179     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1180     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1181     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1182     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1183******************************************************************
  1184***************   END OF ELC50WS     ****************************
  1185******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  23
* EL050.cbl
  1188 01  WORKING-STORAGE-WORK-AREAS.
  1189     12  WS-RESPONSE             PIC S9(8)  COMP.
  1190         88  WS-RESP-NORMAL           VALUE +00.
  1191         88  WS-RESP-ERROR            VALUE +01.
  1192         88  WS-RESP-NOTFND           VALUE +13.
  1193         88  WS-RESP-DUPREC           VALUE +14.
  1194         88  WS-RESP-ENDFILE          VALUE +20.
  1195     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1196     12  WORK-AREAS.
  1197         16  WK-CONV-GREG.
  1198             24  WCG-CENT             PIC XX.
  1199             24  WCG-REST             PIC X(4).
  1200         16  WORK-GREGORIAN-DATE.
  1201             24  WK-GREG-CENT         PIC XX.
  1202             24  WK-GREG-DATE-YYMMDD.
  1203                 28  WK-GREG-YYMM     PIC X(4).
  1204                 28  WK-GREG-DD       PIC XX.
  1205
  1206         16  WORK-SELECT-DATE.
  1207             24  WK-SELECT-CENT            PIC XX.
  1208             24  WK-SELECT-DATE-YYMMDD.
  1209                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1210                 28  FILLER                PIC XX.
  1211
  1212         16  WK-FORM-NO.
  1213             24  WK-FORM-BANK-ID       PIC X(5).
  1214             24  WK-FORM-UNDRWRTR      PIC X(1).
  1215             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1216
  1217         16  WK-MEMBER-NO.
  1218             24  WK-MEMBER-1-6        PIC X(6).
  1219             24  WK-MEMBER-7-12       PIC X(6).
  1220
  1221         16  WK-FULL-CERT-NO.
  1222             24  WK-CERT-POS-1-2      PIC X(2).
  1223             24  WK-CERT-POS-3        PIC X(1).
  1224             24  WK-CERT-POS-4        PIC X(1).
  1225             24  WK-CERT-POS-5-6      PIC X(2).
  1226             24  WK-CERT-POS-7        PIC X(1).
  1227             24  WK-CERT-POS-8-11     PIC X(4).
  1228
  1229         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1230             88  VALID-RATE-CODE        VALUE 'Y'.
  1231             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1232
  1233         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1234         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1235         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1236         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1237         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1238         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1239         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1240         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1241         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1242         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1243
  1244* DLO001
  1245 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  24
* EL050.cbl
  1246     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1247     12  DMPF-RETURN-CODE          PIC XX.
  1248         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1249         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1250         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1251         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1252         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1253         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1254
  1255* DLO002
  1256 01  WS-DLO-INTERNAL-POLICY-FORM.
  1257     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1258     12  DIPF-RETURN-CODE          PIC XX.
  1259         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1260         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1261         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1262         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1263         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1264         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1265
  1266* DLO003
  1267 01  WS-DLO-VALID-BANK-ID.
  1268     12  DVBI-BANK-ID              PIC X(5).
  1269     12  DVBI-BANK-ID-TYPE         PIC X.
  1270         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1271         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1272         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1273         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1274         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1275     12  DVBI-RETURN-CODE          PIC XX.
  1276         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1277         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1278         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1279         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1280         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1281         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1282         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1283         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1284         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1285
  1286* DLO007
  1287 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1288     12  DCUA-RES-STATE            PIC XX.
  1289     12  DCUA-BEN-TYPE             PIC XX.
  1290     12  DCUA-SYS-IDENT            PIC X.
  1291         88  DCUA-CLAIM                        VALUE 'C'.
  1292         88  DCUA-PREMIUM                      VALUE 'P'.
  1293     12  DCUA-COVERAGE-RULE        PIC X.
  1294     12  DCUA-CLIENT-ID            PIC X(10).
  1295     12  DCUA-EFF-DATE             PIC X(8).
  1296     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1297     12  DCUA-RETURN-CODE          PIC XX.
  1298         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1299     12  DCUA-CERT-NUMBER          PIC X(11).
  1300     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1301     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1302
  1303* DLO011
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  25
* EL050.cbl
  1304 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1305     12  DPRB-RATE-CODE            PIC X(4).
  1306     12  DPRB-COVERAGE-CATEG       PIC X.
  1307     12  DPRB-RETURN-CODE          PIC XX.
  1308         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1309         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1310         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1311         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1312         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1313         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1314         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1315         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1316         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1317     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1318     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1319     12  DPRB-BEN-TYPE             PIC XX.
  1320
  1321* DLO017
  1322 01  WS-DLO-VALID-RATE-CODE.
  1323     12  DVRC-RATE-CODE            PIC X(4).
  1324     12  DVRC-RETURN-CODE          PIC XX.
  1325         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1326         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1327         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1328         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1329         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1330         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1331
  1332* DLO019
  1333 01  WS-DLO-ORIG-COV-CAT.
  1334     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1335     12  DOCC-RETURN-CODE          PIC XX.
  1336     12  DOCC-ORIG-COV-CAT         PIC X.
  1337     12  DOCC-UNDERWITER           PIC XX.
  1338     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1339     12  DOCC-FILLER               PIC X(6).
  1340
  1341* DLO021
  1342 01  WS-DLO-VALID-LOAN-OFFICER.
  1343     12  DVLO-LOAN-OFFICER.
  1344         16  DVLO-BILL-TYPE        PIC X.
  1345         16  DVLO-BILL-SOURCE      PIC X.
  1346         16  DVLO-BATCH-TYPE       PIC X.
  1347     12  DVLO-RETURN-CODE          PIC XX.
  1348         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1349         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1350         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1351         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1352         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1353         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1354
  1355* DLO022
  1356 01  WS-DLO-VALID-STATE-CODE.
  1357     12  DVSC-STATE-CODE           PIC XX.
  1358     12  DVSC-RETURN-CODE          PIC XX.
  1359         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1360
  1361* DLO023
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  26
* EL050.cbl
  1362 01  WS-DLO-VALID-CODE-VALUES.
  1363     12  DVCV-SYSTEM-ID            PIC XX.
  1364         88  DVCV-CLAIMS                       VALUE 'CL'.
  1365         88  DVCV-CREDIT                       VALUE 'CR'.
  1366     12  DVCV-RECORD-TYPE          PIC XX.
  1367         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1368         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1369         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1370         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1371         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1372         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1373         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1374         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1375     12  DVCV-RECORD-KEY           PIC X(6).
  1376     12  DVCV-RETURN-CODE          PIC XX.
  1377         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1378         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1379         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1380         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1381         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1382         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1383         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1384     12  DVCV-CODE-DESC            PIC X(60).
  1385     12  DVCV-GEN-DESC-1           PIC X(20).
  1386     12  DVCV-GEN-DESC-2           PIC X(20).
  1387     12  DVCV-GEN-DESC-3           PIC X(20).
  1388
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  27
* EL050.cbl
  1390*    COPY ERCBXRF.
  1391******************************************************************
  1392*                                                                *
  1393*                                                                *
  1394*                            ERCBXRF                             *
  1395*                                                                *
  1396*   ONLINE CREDIT SYSTEM                                         *
  1397*                                                                *
  1398*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1399*                                                                *
  1400*   FILE TYPE = VSAM,KSDS                                        *
  1401*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1402*                                                                *
  1403*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1404*       ALTERNATE PATH = NONE                                    *
  1405*                                                                *
  1406*   LOG = NO                                                     *
  1407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1408*                                                                *
  1409******************************************************************
  1410
  1411 01  BANK-CROSS-REFERENCE.
  1412     12  BK-RECORD-ID                PIC XX.
  1413         88  VALID-BK-ID             VALUE 'BK'.
  1414
  1415     12  BK-CONTROL-PRIMARY.
  1416         16  BK-COMPANY-CD           PIC X.
  1417         16  BK-CARRIER              PIC X.
  1418         16  BK-GROUPING             PIC X(6).
  1419         16  BK-BANK-NO              PIC X(10).
  1420
  1421     12  BK-MAINT-INFORMATION.
  1422         16  BK-LAST-MAINT-DT        PIC XX.
  1423         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1424         16  BK-LAST-MAINT-USER      PIC X(4).
  1425         16  FILLER                  PIC X(9).
  1426
  1427     12  FILLER                      PIC X(37).
  1428
  1429     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1430
  1431     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1432                            DEPENDING ON BK-BANK-POINTER-CNT.
  1433         16  BK-AM-ACCOUNT           PIC X(10).
  1434         16  BK-AM-EXP-DT            PIC XX.
  1435         16  BK-AM-EFF-DT            PIC XX.
  1436         16  BK-AM-STATE             PIC XX.
  1437         16  FILLER                  PIC X(20).
  1438
  1439******************************************************************
  1440
  1441*    COPY ERCCOMP.
  1442******************************************************************
  1443*                                                                *
  1444*                                                                *
  1445*                            ERCCOMP                             *
  1446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1447*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  28
* EL050.cbl
  1448*                                                                *
  1449*   ONLINE CREDIT SYSTEM                                         *
  1450*                                                                *
  1451*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1452*                                                                *
  1453*   FILE TYPE = VSAM,KSDS                                        *
  1454*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1455*                                                                *
  1456*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1457*       ALTERNATE PATH = NONE                                    *
  1458*                                                                *
  1459*   LOG = NO                                                     *
  1460*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1461*                                                                *
  1462******************************************************************
  1463*                   C H A N G E   L O G
  1464*
  1465* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1466*-----------------------------------------------------------------
  1467*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1468* EFFECTIVE    NUMBER
  1469*-----------------------------------------------------------------
  1470* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1471* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1472* 092205    2005050300006  PEMA  ADD LEASE FEE
  1473* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1474* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1475* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1476* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1477* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1478******************************************************************
  1479
  1480 01  COMPENSATION-MASTER.
  1481     12  CO-RECORD-ID                          PIC XX.
  1482         88  VALID-CO-ID                          VALUE 'CO'.
  1483
  1484     12  CO-CONTROL-PRIMARY.
  1485         16  CO-COMPANY-CD                     PIC X.
  1486         16  CO-CONTROL.
  1487             20  CO-CTL-1.
  1488                 24  CO-CARR-GROUP.
  1489                     28  CO-CARRIER            PIC X.
  1490                     28  CO-GROUPING.
  1491                         32  CO-GROUP-PREFIX   PIC XXX.
  1492                         32  CO-GROUP-PRIME    PIC XXX.
  1493                 24  CO-RESP-NO.
  1494                     28  CO-RESP-PREFIX        PIC X(4).
  1495                     28  CO-RESP-PRIME         PIC X(6).
  1496             20  CO-CTL-2.
  1497                 24  CO-ACCOUNT.
  1498                     28  CO-ACCT-PREFIX        PIC X(4).
  1499                     28  CO-ACCT-PRIME         PIC X(6).
  1500         16  CO-TYPE                           PIC X.
  1501             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1502             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1503             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1504
  1505     12  CO-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  29
* EL050.cbl
  1506         16  CO-LAST-MAINT-DT                  PIC XX.
  1507         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1508         16  CO-LAST-MAINT-USER                PIC X(4).
  1509     12  FILLER                                PIC XX.
  1510     12  CO-STMT-TYPE                          PIC XXX.
  1511     12  CO-COMP-TYPE                          PIC X.
  1512         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1513     12  CO-STMT-OWNER                         PIC X(4).
  1514     12  CO-BALANCE-CONTROL                    PIC X.
  1515         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1516         88  CO-NO-BALANCE                        VALUE 'N'.
  1517
  1518     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1519         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1520         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1521         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1522
  1523     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1524         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1525         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1526
  1527     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1528     12  CO-GA-DIRECT-DEP                      PIC X.
  1529     12  CO-FUTURE-SPACE                       PIC X.
  1530         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1531
  1532     12  CO-ACCT-NAME                          PIC X(30).
  1533     12  CO-MAIL-NAME                          PIC X(30).
  1534     12  CO-ADDR-1                             PIC X(30).
  1535     12  CO-ADDR-2                             PIC X(30).
  1536     12  CO-ADDR-3.
  1537         16  CO-ADDR-CITY                      PIC X(27).
  1538         16  CO-ADDR-STATE                     PIC XX.
  1539     12  CO-CSO-1099                           PIC X.
  1540     12  CO-ZIP.
  1541         16  CO-ZIP-PRIME.
  1542             20  CO-ZIP-PRI-1ST                PIC X.
  1543                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1544             20  FILLER                        PIC X(4).
  1545         16  CO-ZIP-PLUS4                      PIC X(4).
  1546     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1547         16  CO-CAN-POSTAL-1                   PIC XXX.
  1548         16  CO-CAN-POSTAL-2                   PIC XXX.
  1549         16  FILLER                            PIC XXX.
  1550     12  CO-SOC-SEC                            PIC X(13).
  1551     12  CO-TELEPHONE.
  1552         16  CO-AREA-CODE                      PIC XXX.
  1553         16  CO-PREFIX                         PIC XXX.
  1554         16  CO-PHONE                          PIC X(4).
  1555
  1556     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1557
  1558     12  CO-AR-BAL-LEVEL                       PIC X.
  1559         88  CO-AR-REF-LVL                        VALUE '1'.
  1560         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1561         88  CO-AR-BILL-LVL                       VALUE '2'.
  1562         88  CO-AR-AGT-LVL                        VALUE '3'.
  1563         88  CO-AR-FR-LVL                         VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  30
* EL050.cbl
  1564
  1565     12  CO-AR-NORMAL-PRINT                    PIC X.
  1566         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1567         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1568
  1569     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1570
  1571     12  CO-AR-REPORTING                       PIC X.
  1572         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1573         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1574
  1575     12  CO-AR-PULL-CHECK                      PIC X.
  1576         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1577         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1578
  1579     12  CO-AR-BALANCE-PRINT                   PIC X.
  1580         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1581
  1582     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1583         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1584         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1585         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1586
  1587     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1588
  1589     12  CO-USER-CODE                          PIC X.
  1590     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1591
  1592******************************************************************
  1593*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1594*    THE LAST MONTH END RUN.
  1595******************************************************************
  1596
  1597     12  CO-LAST-ACTIVITY-DATE.
  1598         16  CO-ACT-YEAR                       PIC 99.
  1599         16  CO-ACT-MONTH                      PIC 99.
  1600         16  CO-ACT-DAY                        PIC 99.
  1601
  1602     12  CO-LAST-STMT-DT.
  1603         16  CO-LAST-STMT-YEAR                 PIC 99.
  1604         16  CO-LAST-STMT-MONTH                PIC 99.
  1605         16  CO-LAST-STMT-DAY                  PIC 99.
  1606
  1607     12  CO-MO-END-TOTALS.
  1608         16  CO-MONTHLY-TOTALS.
  1609             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1610             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1611             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1612             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1613             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1614
  1615         16  CO-AGING-TOTALS.
  1616             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1617             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1618             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1619             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1620
  1621         16  CO-YTD-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  31
* EL050.cbl
  1622             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1623             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1624
  1625         16  CO-OVER-UNDER-TOTALS.
  1626             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1627             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1628
  1629     12  CO-MISCELLANEOUS-TOTALS.
  1630         16  CO-FICA-TOTALS.
  1631             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1632             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1633
  1634         16  CO-CLAIM-TOTALS.
  1635             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1636             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1637
  1638******************************************************************
  1639*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1640*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1641******************************************************************
  1642
  1643     12  CO-CURRENT-TOTALS.
  1644         16  CO-CURRENT-LAST-STMT-DT.
  1645             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1646             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1647             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1648
  1649         16  CO-CURRENT-MONTHLY-TOTALS.
  1650             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1651             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1652             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1653             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1654             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1655
  1656         16  CO-CURRENT-AGING-TOTALS.
  1657             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1658             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1659             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1660             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1661
  1662         16  CO-CURRENT-YTD-TOTALS.
  1663             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1664             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1665
  1666     12  CO-PAID-COMM-TOTALS.
  1667         16  CO-YTD-PAID-COMMS.
  1668             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1669             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1670
  1671     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1672         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1673         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1674
  1675     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1676         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1677         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1678         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1679         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  32
* EL050.cbl
  1680         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1681         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1682         88  CO-FINAL-LETTER                  VALUE 'F'.
  1683         88  CO-RECONCILING                   VALUE 'R'.
  1684         88  CO-PHONE-CALL                    VALUE 'P'.
  1685         88  CO-LEGAL                         VALUE 'L'.
  1686         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1687         88  CO-WRITE-OFF                     VALUE 'W'.
  1688         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1689
  1690     12  CO-CSR-CODE                       PIC X(4).
  1691
  1692     12  CO-GA-STATUS-INFO.
  1693         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1694         16  CO-GA-TERMINATION-DT          PIC XX.
  1695         16  CO-GA-STATUS-CODE             PIC X.
  1696             88  CO-GA-ACTIVE                 VALUE 'A'.
  1697             88  CO-GA-INACTIVE               VALUE 'I'.
  1698             88  CO-GA-PENDING                VALUE 'P'.
  1699         16  CO-GA-COMMENTS.
  1700             20  CO-GA-COMMENT-1           PIC X(40).
  1701             20  CO-GA-COMMENT-2           PIC X(40).
  1702             20  CO-GA-COMMENT-3           PIC X(40).
  1703             20  CO-GA-COMMENT-4           PIC X(40).
  1704
  1705     12  CO-RPTCD2                         PIC X(10).
  1706
  1707     12  CO-TYPE-AGENT                     PIC X(01).
  1708         88  CO-CORPORATION                   VALUE 'C'.
  1709         88  CO-PARTNERSHIP                   VALUE 'P'.
  1710         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1711         88  CO-TRUST                         VALUE 'T'.
  1712         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1713
  1714     12  CO-FAXNO.
  1715         16  CO-FAX-AREA-CODE                  PIC XXX.
  1716         16  CO-FAX-PREFIX                     PIC XXX.
  1717         16  CO-FAX-PHONE                      PIC X(4).
  1718
  1719     12  CO-BANK-INFORMATION.
  1720         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1721         16  CO-BANK-TRANSIT-NON REDEFINES
  1722             CO-BANK-TRANSIT-NO                PIC 9(8).
  1723
  1724         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1725     12  CO-MISC-DEDUCT-INFO REDEFINES
  1726                  CO-BANK-INFORMATION.
  1727         16  CO-MD-GL-ACCT                     PIC X(10).
  1728         16  CO-MD-DIV                         PIC XX.
  1729         16  CO-MD-CENTER                      PIC X(4).
  1730         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1731         16  CO-CREATE-AP-CHECK                PIC X.
  1732         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1733         16  FILLER                            PIC XXX.
  1734     12  CO-ACH-STATUS                         PIC X.
  1735         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1736         88  CO-ACH-PENDING                        VALUE 'P'.
  1737
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  33
* EL050.cbl
  1738     12  CO-BILL-SW                            PIC X.
  1739     12  CO-CONTROL-NAME                       PIC X(30).
  1740     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1741     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1742     12  CO-CLP-STATE                          PIC XX.
  1743     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1744     12  CO-SPP-REFUND-EDIT                    PIC X.
  1745
  1746******************************************************************
  1747
  1748*    COPY ERCAGTC.
  1749******************************************************************
  1750*                                                                *
  1751*                                                                *
  1752*                            ERCAGTC                             *
  1753*                            VMOD=2.001                          *
  1754*                                                                *
  1755*   ONLINE CREDIT SYSTEM                                         *
  1756*                                                                *
  1757*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1758*                                                                *
  1759*   FILE TYPE = VSAM,KSDS                                        *
  1760*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1761*                                                                *
  1762*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1763*       ALTERNATE PATH = NONE                                    *
  1764*                                                                *
  1765*   LOG = NO                                                     *
  1766*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1767*                                                                *
  1768******************************************************************
  1769*                   C H A N G E   L O G
  1770*
  1771* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1772*-----------------------------------------------------------------
  1773*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1774* EFFECTIVE    NUMBER
  1775*-----------------------------------------------------------------
  1776* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1777* 111004                         NEW FILE AND COPYBOOK
  1778* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1779******************************************************************
  1780 01  AGENT-COMMISSIONS.
  1781     12  AG-RECORD-ID                          PIC XX.
  1782         88  VALID-CO-ID                          VALUE 'AG'.
  1783     12  AG-CONTROL-PRIMARY.
  1784         16  AG-COMPANY-CD                     PIC X.
  1785         16  AG-CONTROL.
  1786             20  AG-CTL-1.
  1787                 24  AG-CARR-GROUP.
  1788                     28  AG-CARRIER            PIC X.
  1789                     28  AG-GROUPING           PIC X(6).
  1790                 24  AG-BANK                   PIC X(10).
  1791             20  AG-CTL-2.
  1792                 24  AG-EXP-DT                 PIC XX.
  1793         16  AG-TYPE                           PIC X.
  1794             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1795             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  34
* EL050.cbl
  1796     12  AG-MAINT-INFORMATION.
  1797         16  AG-LAST-MAINT-DT                  PIC XX.
  1798         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1799         16  AG-LAST-MAINT-USER                PIC X(4).
  1800         16  FILLER                            PIC X(10).
  1801     12  AG-EFF-DT                             PIC XX.
  1802     12  AG-COMM-STRUCTURE.
  1803         16  AG-AGT-COMMS OCCURS 10.
  1804             20  AG-AGT                PIC X(10).
  1805             20  AG-COM-TYP            PIC X.
  1806             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1807             20  AG-RECALC-LV-INDIC    PIC X.
  1808             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1809             20  AG-LRCALC-LV-INDIC    PIC X.
  1810             20  FILLER                PIC X(05).
  1811     12  FILLER                  PIC X(145).
  1812******************************************************************
  1813*    COPY ERCRESS.
  1814******************************************************************
  1815*                                                                *
  1816*                            ERCRESS                             *
  1817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1818*                            VMOD=2.002                          *
  1819*                                                                *
  1820*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1821*                                                                *
  1822*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1823*   VSAM RESIDENT STATE TAX MASTER                              *
  1824*                                                                *
  1825*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1826*                                                                *
  1827*   FILE TYPE = VSAM,KSDS                                        *
  1828*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1829*                                                                *
  1830*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1831*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1832*                                                                *
  1833*   LOG = NO                                                     *
  1834*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1835*                                                                *
  1836*                                                                *
  1837******************************************************************
  1838
  1839 01  RESIDENT-STATE-TAX-MASTER.
  1840
  1841     10  ERRESS-PRIMARY-KEY.
  1842         15  RES-COMPANY-CD        PIC X.
  1843         15  RES-RESIDENT-STATE    PIC XX.
  1844         15  RES-COVERAGE-CATEGORY PIC X.
  1845         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1846*                                      YYYYMMDD
  1847*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1848
  1849     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
  1850
  1851         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1852         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1853         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  35
* EL050.cbl
  1854         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1855
  1856     10 RES-RECALC-SW              PIC   X.
  1857         88 RECALC                VALUE 'Y'.
  1858         88 NO-RECALC             VALUE 'N'.
  1859     10  RES-MAINT-BY              PIC X(4).
  1860     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1861     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1862*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  36
* EL050.cbl
  1864*    COPY ERCRESC.
  1865******************************************************************
  1866*                                                                *
  1867*                            ERCRESC                             *
  1868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1869*                            VMOD=2.003                          *
  1870*                                                                *
  1871*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1872*                                                                *
  1873*   FILE TYPE = VSAM,KSDS                                        *
  1874*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1875*                                                                *
  1876*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1877*       ALTERNATE PATH1 = NONE                                   *
  1878*                                                                *
  1879*   LOG = NO                                                     *
  1880*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1881*                                                                *
  1882******************************************************************
  1883
  1884 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1885
  1886     10  ERRESC-RECORD-KEY.
  1887         15  RESC-COMPANY-CD           PIC   X.
  1888         15  RESC-CARRIER              PIC   X.
  1889         15  RESC-GROUP                PIC   X(6).
  1890         15  RESC-STATE                PIC   XX.
  1891         15  RESC-ACCOUNT              PIC   X(10).
  1892         15  RESC-AGENT                PIC   X(10).
  1893         15  RESC-RESIDENT-STATE       PIC   XX.
  1894         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1895*                                           YYYYMMDD
  1896     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1897
  1898     10  RESC-COMM-RECORD-DATA.
  1899         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1900             20 RESC-COVERAGE-CAT      PIC    X.
  1901             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1902             20 RESC-COMMISSION-TAB REDEFINES
  1903                RESC-COMMISSION-PER    PIC  XXX.
  1904
  1905     10  RESC-MAINT-BY                 PIC X(4).
  1906     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1907     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1908*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  37
* EL050.cbl
  1910*    COPY ERCPLAN.
  1911******************************************************************
  1912*                                                                *
  1913*                                                                *
  1914*                            ERCPLAN                             *
  1915*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1916*                            VMOD=2.003                          *
  1917*                                                                *
  1918*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1919*                                                                *
  1920*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1921*   PLAN MASTER                                                  *
  1922*                                                                *
  1923*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1924*                                                                *
  1925*   FILE TYPE = VSAM,KSDS                                        *
  1926*   RECORD SIZE = 420   RECFORM = FIX                            *
  1927*                                                                *
  1928*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1929*       ALTERNATE PATH1 = N/A                                    *
  1930*                                                                *
  1931*   LOG = NO                                                     *
  1932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1933*                                                                *
  1934*                                                                *
  1935******************************************************************
  1936
  1937 01  PLAN-MASTER.
  1938     12  PL-RECORD-ID                      PIC XX.
  1939         88  VALID-PL-ID                      VALUE 'PL'.
  1940
  1941     12  PL-CONTROL-PRIMARY.
  1942         16  PL-COMPANY-CD                 PIC X.
  1943         16  PL-MSTR-CNTRL.
  1944             20  PL-CONTROL-A.
  1945                 24  PL-CARRIER            PIC X.
  1946                 24  PL-GROUPING           PIC X(6).
  1947                 24  PL-STATE              PIC XX.
  1948                 24  PL-ACCOUNT            PIC X(10).
  1949             20  PL-BENEFIT-TYPE           PIC X.
  1950             20  PL-BENEFIT-CODE           PIC XX.
  1951             20  PL-REVISION-NO            PIC X(3).
  1952
  1953     12  PL-CONTROL-BY-VAR-GRP.
  1954         16  PL-COMPANY-CD-A1              PIC X.
  1955         16  PL-VG-CARRIER                 PIC X.
  1956         16  PL-VG-GROUPING                PIC X(6).
  1957         16  PL-VG-STATE                   PIC XX.
  1958         16  PL-VG-ACCOUNT                 PIC X(10).
  1959         16  PL-BENEFIT-TYPE-A1            PIC X.
  1960         16  PL-BENEFIT-CODE-A1            PIC XX.
  1961         16  PL-REVISION-NO-A1             PIC 999.
  1962
  1963     12  PL-MAINT-INFORMATION.
  1964         16  PL-LAST-MAINT-DT              PIC XX.
  1965         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1966         16  PL-LAST-MAINT-USER            PIC X(4).
  1967         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  38
* EL050.cbl
  1968
  1969     12  PL-LIABILITY-LIMITS.
  1970         16  PL-ATT-AGE                    PIC S99        COMP-3.
  1971         16  PL-L-LIMITS        OCCURS 8 TIMES.
  1972             20  PL-LM-AGE                 PIC S99        COMP-3.
  1973             20  PL-LM-DUR                 PIC S999       COMP-3.
  1974             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  1975             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  1976
  1977     12  FILLER                            PIC X(30).
  1978
  1979     12  PL-GL-ACCOUNT-NOS.
  1980         16  PL-PREMIUM-GL                 PIC X(8).
  1981         16  PL-COMM-GL                    PIC X(8).
  1982         16  PL-CLAIM-GL                   PIC X(8).
  1983     12  FILLER                            PIC X(24).
  1984     12  PL-TOLERANCES.
  1985         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  1986         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  1987         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  1988         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  1989         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  1990         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  1991     12  PL-OVER-SHORT.
  1992         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  1993         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  1994     12  FILLER                            PIC X(24).
  1995     12  PLAN-MISC.
  1996         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  1997         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  1998         16  PL-IG                         PIC X.
  1999         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2000         16  PL-POLICY-FORM                PIC X(12).
  2001         16  PL-EDIT-FOR-FORM              PIC X(01).
  2002         16  PL-DEV-CODE                   PIC XXX.
  2003         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2004         16  PL-CALC-METHOD                PIC X.
  2005         16  PL-BENEFIT-GROUP              PIC X(05).
  2006         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2007
  2008         16  FILLER                        PIC X(99).
  2009******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  39
* EL050.cbl
  2011*    COPY ELCCERT.
  2012******************************************************************
  2013*                                                                *
  2014*                            ELCCERT.                            *
  2015*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2016*                            VMOD=2.013                          *
  2017*                                                                *
  2018*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2019*                                                                *
  2020*   FILE TYPE = VSAM,KSDS                                        *
  2021*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2022*                                                                *
  2023*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2024*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2025*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2026*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2027*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2028*                                                                *
  2029*   LOG = YES                                                    *
  2030*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2031******************************************************************
  2032*                   C H A N G E   L O G
  2033*
  2034* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2035*-----------------------------------------------------------------
  2036*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2037* EFFECTIVE    NUMBER
  2038*-----------------------------------------------------------------
  2039* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2040* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2041* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2042* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2043* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2044* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2045* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2046******************************************************************
  2047
  2048 01  CERTIFICATE-MASTER.
  2049     12  CM-RECORD-ID                      PIC XX.
  2050         88  VALID-CM-ID                      VALUE 'CM'.
  2051
  2052     12  CM-CONTROL-PRIMARY.
  2053         16  CM-COMPANY-CD                 PIC X.
  2054         16  CM-CARRIER                    PIC X.
  2055         16  CM-GROUPING.
  2056             20  CM-GROUPING-PREFIX        PIC X(3).
  2057             20  CM-GROUPING-PRIME         PIC X(3).
  2058         16  CM-STATE                      PIC XX.
  2059         16  CM-ACCOUNT.
  2060             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2061             20  CM-ACCOUNT-PRIME          PIC X(6).
  2062         16  CM-CERT-EFF-DT                PIC XX.
  2063         16  CM-CERT-NO.
  2064             20  CM-CERT-PRIME             PIC X(10).
  2065             20  CM-CERT-SFX               PIC X.
  2066
  2067     12  CM-CONTROL-BY-NAME.
  2068         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  40
* EL050.cbl
  2069         16  CM-INSURED-LAST-NAME          PIC X(15).
  2070         16  CM-INSURED-INITIALS.
  2071             20  CM-INSURED-INITIAL1       PIC X.
  2072             20  CM-INSURED-INITIAL2       PIC X.
  2073
  2074     12  CM-CONTROL-BY-SSN.
  2075         16  CM-COMPANY-CD-A2              PIC X.
  2076         16  CM-SOC-SEC-NO.
  2077             20  CM-SSN-STATE              PIC XX.
  2078             20  CM-SSN-ACCOUNT            PIC X(6).
  2079             20  CM-SSN-LN3.
  2080                 25  CM-INSURED-INITIALS-A2.
  2081                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2082                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2083                 25 CM-PART-LAST-NAME-A2         PIC X.
  2084
  2085     12  CM-CONTROL-BY-CERT-NO.
  2086         16  CM-COMPANY-CD-A4              PIC X.
  2087         16  CM-CERT-NO-A4                 PIC X(11).
  2088
  2089     12  CM-CONTROL-BY-MEMB.
  2090         16  CM-COMPANY-CD-A5              PIC X.
  2091         16  CM-MEMBER-NO.
  2092             20  CM-MEMB-STATE             PIC XX.
  2093             20  CM-MEMB-ACCOUNT           PIC X(6).
  2094             20  CM-MEMB-LN4.
  2095                 25  CM-INSURED-INITIALS-A5.
  2096                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2097                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2098                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2099
  2100     12  CM-INSURED-PROFILE-DATA.
  2101         16  CM-INSURED-FIRST-NAME.
  2102             20  CM-INSURED-1ST-INIT       PIC X.
  2103             20  FILLER                    PIC X(9).
  2104         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2105         16  CM-INSURED-SEX                PIC X.
  2106             88  CM-SEX-MALE                  VALUE 'M'.
  2107             88  CM-SEX-FEMAL                 VALUE 'F'.
  2108         16  CM-INSURED-JOINT-AGE          PIC 99.
  2109         16  CM-JOINT-INSURED-NAME.
  2110             20  CM-JT-LAST-NAME           PIC X(15).
  2111             20  CM-JT-FIRST-NAME.
  2112                 24  CM-JT-1ST-INIT        PIC X.
  2113                 24  FILLER                PIC X(9).
  2114             20  CM-JT-INITIAL             PIC X.
  2115
  2116     12  CM-LIFE-DATA.
  2117         16  CM-LF-BENEFIT-CD              PIC XX.
  2118         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2119         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2120         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2121         16  CM-LF-DEV-CODE                PIC XXX.
  2122         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2123         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2124         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2125         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2126         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  41
* EL050.cbl
  2127         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2128         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2129         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2130         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2131         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2132         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2133         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2134         16  FILLER                        PIC XX.
  2135
  2136     12  CM-AH-DATA.
  2137         16  CM-AH-BENEFIT-CD              PIC XX.
  2138         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2139         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2140         16  CM-AH-DEV-CODE                PIC XXX.
  2141         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2142         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2143         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2144         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2145         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2146         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2147         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2148         16  CM-AH-PAID-THRU-DT            PIC XX.
  2149             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2150         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2151         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2152         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2153         16  FILLER                        PIC X.
  2154
  2155     12  CM-LOAN-INFORMATION.
  2156         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2157         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2158                                           PIC S9(5)V99  COMP-3.
  2159         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2160         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2161         16  CM-PAY-FREQUENCY              PIC S99.
  2162         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2163         16  CM-RATE-CLASS                 PIC XX.
  2164         16  CM-BENEFICIARY                PIC X(25).
  2165         16  CM-POLICY-FORM-NO             PIC X(12).
  2166         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2167         16  CM-LAST-ADD-ON-DT             PIC XX.
  2168         16  CM-DEDUCTIBLE-AMOUNTS.
  2169             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2170             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2171         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2172             20  CM-RESIDENT-STATE         PIC XX.
  2173             20  CM-RATE-CODE              PIC X(4).
  2174             20  FILLER                    PIC XX.
  2175         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2176             20  CM-LOAN-OFFICER           PIC X(5).
  2177             20  FILLER                    PIC XXX.
  2178         16  CM-CSR-CODE                   PIC XXX.
  2179         16  CM-UNDERWRITING-CODE          PIC X.
  2180             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2181         16  CM-POST-CARD-IND              PIC X.
  2182         16  CM-NH-INTERFACE-SW            PIC X.
  2183         16  CM-PREMIUM-TYPE               PIC X.
  2184             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  42
* EL050.cbl
  2185             88  CM-O-B-COVERAGE              VALUE '2'.
  2186             88  CM-OPEN-END                  VALUE '3'.
  2187         16  CM-IND-GRP-TYPE               PIC X.
  2188             88  CM-INDIVIDUAL                VALUE 'I'.
  2189             88  CM-GROUP                     VALUE 'G'.
  2190         16  CM-SKIP-CODE                  PIC X.
  2191             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2192             88  SKIP-JULY                    VALUE '1'.
  2193             88  SKIP-AUGUST                  VALUE '2'.
  2194             88  SKIP-SEPTEMBER               VALUE '3'.
  2195             88  SKIP-JULY-AUG                VALUE '4'.
  2196             88  SKIP-AUG-SEPT                VALUE '5'.
  2197             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2198             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2199             88  SKIP-JUNE                    VALUE '8'.
  2200             88  SKIP-JUNE-JULY               VALUE '9'.
  2201             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2202             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2203         16  CM-PAYMENT-MODE               PIC X.
  2204             88  PAY-MONTHLY                  VALUE SPACE.
  2205             88  PAY-WEEKLY                   VALUE '1'.
  2206             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2207             88  PAY-BI-WEEKLY                VALUE '3'.
  2208             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2209         16  CM-LOAN-NUMBER                PIC X(8).
  2210         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2211         16  CM-OLD-LOF                    PIC XXX.
  2212*        16  CM-LOAN-OFFICER               PIC XXX.
  2213         16  CM-REIN-TABLE                 PIC XXX.
  2214         16  CM-SPECIAL-REIN-CODE          PIC X.
  2215         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2216         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2217         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2218
  2219     12  CM-STATUS-DATA.
  2220         16  CM-ENTRY-STATUS               PIC X.
  2221         16  CM-ENTRY-DT                   PIC XX.
  2222
  2223         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2224         16  CM-LF-CANCEL-DT               PIC XX.
  2225         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2226
  2227         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2228         16  CM-LF-DEATH-DT                PIC XX.
  2229         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2230
  2231         16  CM-LF-CURRENT-STATUS          PIC X.
  2232             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2233                                                'M' '4' '5' '9'.
  2234             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2235             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2236             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2237             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2238             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2239             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2240             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2241             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2242             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  43
* EL050.cbl
  2243             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2244             88  CM-LF-DECLINED               VALUE 'D'.
  2245             88  CM-LF-VOIDED                 VALUE 'V'.
  2246
  2247         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2248         16  CM-AH-CANCEL-DT               PIC XX.
  2249         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2250
  2251         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2252         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2253         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2254
  2255         16  CM-AH-CURRENT-STATUS          PIC X.
  2256             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2257                                                'M' '4' '5' '9'.
  2258             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2259             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2260             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2261             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2262             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2263             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2264             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2265             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2266             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2267             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2268             88  CM-AH-DECLINED               VALUE 'D'.
  2269             88  CM-AH-VOIDED                 VALUE 'V'.
  2270
  2271         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2272             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2273             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2274             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2275         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2276
  2277         16  CM-ENTRY-BATCH                PIC X(6).
  2278         16  CM-LF-EXIT-BATCH              PIC X(6).
  2279         16  CM-AH-EXIT-BATCH              PIC X(6).
  2280         16  CM-LAST-MONTH-END             PIC XX.
  2281
  2282     12  CM-NOTE-SW                        PIC X.
  2283         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2284         88  CERT-NOTES-PRESENT               VALUE '1'.
  2285         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2286         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2287         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2288         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2289         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2290         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2291     12  CM-COMP-EXCP-SW                   PIC X.
  2292         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2293         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2294     12  CM-INSURED-ADDRESS-SW             PIC X.
  2295         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2296         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2297
  2298*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2299     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2300     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  44
* EL050.cbl
  2301
  2302*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2303     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2304     12  FILLER                            PIC X.
  2305*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2306     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2307
  2308     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2309         88  CERT-ADDED-BATCH                 VALUE ' '.
  2310         88  CERT-ADDED-ONLINE                VALUE '1'.
  2311         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2312         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2313         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2314     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2315         88  CERT-AS-LOADED                   VALUE ' '.
  2316         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2317         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2318         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2319         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2320         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2321         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2322         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2323
  2324     12  CM-ACCOUNT-COMM-PCTS.
  2325         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2326         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2327
  2328     12  CM-USER-FIELD                     PIC X.
  2329     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2330     12  CM-CLP-STATE                      PIC XX.
  2331     12  CM-USER-RESERVED                  PIC XXX.
  2332******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  45
* EL050.cbl
  2334*    COPY ERCMAIL.
  2335******************************************************************
  2336*                                                                *
  2337*                                                                *
  2338*                            ERCMAIL                             *
  2339*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2340*                            VMOD=2.003                          *
  2341*                                                                *
  2342*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2343*                                                                *
  2344*   FILE TYPE = VSAM,KSDS                                        *
  2345*   RECORD SIZE = 374   RECFORM = FIX                            *
  2346*                                                                *
  2347*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2348*   ALTERNATE PATH    = NOT USED                                 *
  2349*                                                                *
  2350*   LOG = YES                                                    *
  2351*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2352******************************************************************
  2353*                   C H A N G E   L O G
  2354*
  2355* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2356*-----------------------------------------------------------------
  2357*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2358* EFFECTIVE    NUMBER
  2359*-----------------------------------------------------------------
  2360* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2361* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2362* 111108                   PEMA  ADD CRED BENE ADDR2
  2363******************************************************************
  2364
  2365 01  MAILING-DATA.
  2366     12  MA-RECORD-ID                      PIC XX.
  2367         88  VALID-MA-ID                       VALUE 'MA'.
  2368
  2369     12  MA-CONTROL-PRIMARY.
  2370         16  MA-COMPANY-CD                 PIC X.
  2371         16  MA-CARRIER                    PIC X.
  2372         16  MA-GROUPING.
  2373             20  MA-GROUPING-PREFIX        PIC XXX.
  2374             20  MA-GROUPING-PRIME         PIC XXX.
  2375         16  MA-STATE                      PIC XX.
  2376         16  MA-ACCOUNT.
  2377             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2378             20  MA-ACCOUNT-PRIME          PIC X(6).
  2379         16  MA-CERT-EFF-DT                PIC XX.
  2380         16  MA-CERT-NO.
  2381             20  MA-CERT-PRIME             PIC X(10).
  2382             20  MA-CERT-SFX               PIC X.
  2383
  2384     12  FILLER                            PIC XX.
  2385
  2386     12  MA-ACCESS-CONTROL.
  2387         16  MA-SOURCE-SYSTEM              PIC XX.
  2388             88  MA-FROM-CREDIT                VALUE 'CR'.
  2389             88  MA-FROM-VSI                   VALUE 'VS'.
  2390             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2391             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  46
* EL050.cbl
  2392         16  MA-RECORD-ADD-DT              PIC XX.
  2393         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2394         16  MA-LAST-MAINT-DT              PIC XX.
  2395         16  MA-LAST-MAINT-BY              PIC XXXX.
  2396         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2397
  2398     12  MA-PROFILE-INFO.
  2399         16  MA-QUALIFY-CODE-1             PIC XX.
  2400         16  MA-QUALIFY-CODE-2             PIC XX.
  2401         16  MA-QUALIFY-CODE-3             PIC XX.
  2402         16  MA-QUALIFY-CODE-4             PIC XX.
  2403         16  MA-QUALIFY-CODE-5             PIC XX.
  2404
  2405         16  MA-INSURED-LAST-NAME          PIC X(15).
  2406         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2407         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2408         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2409         16  MA-INSURED-BIRTH-DT           PIC XX.
  2410         16  MA-INSURED-SEX                PIC X.
  2411             88  MA-SEX-MALE                   VALUE 'M'.
  2412             88  MA-SEX-FEMALE                 VALUE 'F'.
  2413         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2414
  2415         16  MA-ADDRESS-CORRECTED          PIC X.
  2416         16  MA-JOINT-BIRTH-DT             PIC XX.
  2417*        16  FILLER                        PIC X(12).
  2418
  2419         16  MA-ADDRESS-LINE-1             PIC X(30).
  2420         16  MA-ADDRESS-LINE-2             PIC X(30).
  2421         16  MA-CITY-STATE.
  2422             20  MA-CITY                   PIC X(28).
  2423             20  MA-ADDR-STATE             PIC XX.
  2424         16  MA-ZIP.
  2425             20  MA-ZIP-CODE.
  2426                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2427                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2428                 24  FILLER                PIC X(4).
  2429             20  MA-ZIP-PLUS4              PIC X(4).
  2430         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2431             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2432             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2433             20  FILLER                    PIC X(3).
  2434
  2435         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2436
  2437         16  FILLER                        PIC XXX.
  2438*        16  FILLER                        PIC X(10).
  2439
  2440     12  MA-CRED-BENE-INFO.
  2441         16  MA-CRED-BENE-NAME                 PIC X(25).
  2442         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2443         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2444         16  MA-CRED-BENE-CTYST.
  2445             20  MA-CRED-BENE-CITY             PIC X(28).
  2446             20  MA-CRED-BENE-STATE            PIC XX.
  2447         16  MA-CRED-BENE-ZIP.
  2448             20  MA-CB-ZIP-CODE.
  2449                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  47
* EL050.cbl
  2450                     88  MA-CB-CANADIAN-POST-CODE
  2451                                           VALUE 'A' THRU 'Z'.
  2452                 24  FILLER                    PIC X(4).
  2453             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2454         16  MA-CB-CANADIAN-POSTAL-CODE
  2455                            REDEFINES MA-CRED-BENE-ZIP.
  2456             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2457             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2458             20  FILLER                        PIC X(3).
  2459     12  MA-POST-CARD-MAIL-DATA.
  2460         16  MA-MAIL-DATA OCCURS 7.
  2461             20  MA-MAIL-TYPE              PIC X.
  2462                 88  MA-12MO-MAILING           VALUE '1'.
  2463                 88  MA-EXP-MAILING            VALUE '2'.
  2464             20  MA-MAIL-STATUS            PIC X.
  2465                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2466                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2467                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2468             20  MA-MAIL-DATE              PIC XX.
  2469     12  FILLER                            PIC XX.
  2470     12  FILLER                            PIC XX.
  2471*    12  FILLER                            PIC X(30).
  2472******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  48
* EL050.cbl
  2474*    COPY ERCPNDM.
  2475******************************************************************
  2476*                                                                *
  2477*                                                                *
  2478*                            ERCPNDM                             *
  2479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2480*                            VMOD=2.003                          *
  2481*                                                                *
  2482*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2483*                                                                *
  2484*   FILE TYPE = VSAM,KSDS                                        *
  2485*   RECORD SIZE = 374   RECFORM = FIX                            *
  2486*                                                                *
  2487*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2488*   ALTERNATE PATH    = NOT USED                                 *
  2489*                                                                *
  2490*   LOG = YES                                                    *
  2491*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2492******************************************************************
  2493*                   C H A N G E   L O G
  2494*
  2495* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2496*-----------------------------------------------------------------
  2497*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2498* EFFECTIVE    NUMBER
  2499*-----------------------------------------------------------------
  2500* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2501* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2502* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2503******************************************************************
  2504
  2505 01  PENDING-MAILING-DATA.
  2506     12  PM-RECORD-ID                      PIC XX.
  2507         88  VALID-MA-ID                       VALUE 'PM'.
  2508
  2509     12  PM-CONTROL-PRIMARY.
  2510         16  PM-COMPANY-CD                 PIC X.
  2511         16  PM-ENTRY-BATCH                PIC X(6).
  2512         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2513         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2514
  2515     12  FILLER                            PIC X(14).
  2516
  2517     12  PM-ACCESS-CONTROL.
  2518         16  PM-SOURCE-SYSTEM              PIC XX.
  2519             88  PM-FROM-CREDIT                VALUE 'CR'.
  2520             88  PM-FROM-VSI                   VALUE 'VS'.
  2521             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2522             88  PM-FROM-OTHER                 VALUE 'OT'.
  2523         16  PM-RECORD-ADD-DT              PIC XX.
  2524         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2525         16  PM-LAST-MAINT-DT              PIC XX.
  2526         16  PM-LAST-MAINT-BY              PIC XXXX.
  2527         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2528
  2529     12  PM-PROFILE-INFO.
  2530         16  PM-QUALIFY-CODE-1             PIC XX.
  2531         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  49
* EL050.cbl
  2532         16  PM-QUALIFY-CODE-3             PIC XX.
  2533         16  PM-QUALIFY-CODE-4             PIC XX.
  2534         16  PM-QUALIFY-CODE-5             PIC XX.
  2535
  2536         16  PM-INSURED-LAST-NAME          PIC X(15).
  2537         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2538         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2539         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2540         16  PM-INSURED-BIRTH-DT           PIC XX.
  2541         16  PM-INSURED-SEX                PIC X.
  2542             88  PM-SEX-MALE                   VALUE 'M'.
  2543             88  PM-SEX-FEMALE                 VALUE 'F'.
  2544         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2545
  2546         16  PM-ADDRESS-CORRECTED          PIC X.
  2547         16  PM-JOINT-BIRTH-DT             PIC XX.
  2548*        16  FILLER                        PIC X(12).
  2549
  2550         16  PM-ADDRESS-LINE-1             PIC X(30).
  2551         16  PM-ADDRESS-LINE-2             PIC X(30).
  2552         16  PM-CITY-STATE.
  2553             20  PM-CITY                   PIC X(28).
  2554             20  PM-STATE                  PIC XX.
  2555         16  PM-ZIP.
  2556             20  PM-ZIP-CODE.
  2557                 24  PM-ZIP-1              PIC X.
  2558                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2559                 24  FILLER                PIC X(4).
  2560             20  PM-ZIP-PLUS4              PIC X(4).
  2561         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2562             20  PM-CAN-POST1              PIC XXX.
  2563             20  PM-CAN-POST2              PIC XXX.
  2564             20  FILLER                    PIC XXX.
  2565
  2566         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2567
  2568         16  FILLER                        PIC X(03).
  2569
  2570     12  PM-CRED-BENE-INFO.
  2571         16  PM-CRED-BENE-NAME             PIC X(25).
  2572         16  PM-CRED-BENE-ADDR             PIC X(30).
  2573         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2574         16  PM-CRED-BENE-CTYST.
  2575             20  PM-CRED-BENE-CITY         PIC X(28).
  2576             20  PM-CRED-BENE-STATE        PIC XX.
  2577         16  PM-CRED-BENE-ZIP.
  2578             20  PM-CB-ZIP-CODE.
  2579                 24  PM-CB-ZIP-1           PIC X.
  2580                     88  PM-CB-CANADIAN-POST-CODE
  2581                                  VALUE 'A' THRU 'Z'.
  2582                 24  FILLER                PIC X(4).
  2583             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2584         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2585             20  PM-CB-CAN-POST1           PIC XXX.
  2586             20  PM-CB-CAN-POST2           PIC XXX.
  2587             20  FILLER                    PIC XXX.
  2588     12  PM-POST-CARD-MAIL-DATA.
  2589         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  50
* EL050.cbl
  2590             20  PM-MAIL-TYPE              PIC X.
  2591                 88  PM-12MO-MAILING           VALUE '1'.
  2592                 88  PM-EXP-MAILING            VALUE '2'.
  2593             20  PM-MAIL-STATUS            PIC X.
  2594                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2595                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2596                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2597             20  PM-MAIL-DATE              PIC XX.
  2598     12  FILLER                            PIC XX.
  2599     12  FILLER                            PIC X(12).
  2600*    12  FILLER                            PIC X(30).
  2601
  2602******************************************************************
  2603*                                COPY ERCLOFC.
  2604******************************************************************
  2605*                                                                *
  2606*                                                                *
  2607*                            ERCLOFC                             *
  2608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2609*                            VMOD=2.003                          *
  2610*                                                                *
  2611*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2612*                                                                *
  2613*   FILE TYPE = VSAM,KSDS                                        *
  2614*   RECORD SIZE = 670   RECFORM = FIX                            *
  2615*                                                                *
  2616*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2617*                                                                *
  2618*   LOG = YES                                                    *
  2619*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2620*                                                                *
  2621******************************************************************
  2622
  2623 01  LOAN-OFFICER-MASTER.
  2624     12  LO-RECORD-ID                PIC XX.
  2625         88  VALID-LO-ID                VALUE 'LO'.
  2626
  2627     12  LO-CONTROL-PRIMARY.
  2628         16  LO-COMPANY-CD           PIC X.
  2629         16  LO-CARRIER              PIC X.
  2630         16  LO-GROUPING.
  2631             20  LO-GROUPING-PREFIX  PIC XXX.
  2632             20  LO-GROUPING-PRIME   PIC XXX.
  2633         16  LO-STATE                PIC XX.
  2634         16  LO-ACCOUNT.
  2635             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2636             20  LO-ACCOUNT-PRIME    PIC X(6).
  2637         16  LO-OFFICER-CODE         PIC X(5).
  2638
  2639     12  LO-OFFICER-NAME             PIC X(30).
  2640
  2641     12  LO-LAST-MAINT-DT            PIC XX.
  2642     12  LO-LAST-USER                PIC X(4).
  2643     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2644
  2645     12  LO-COMP-CONTROL             PIC X.
  2646             88  LO-SHOW-COMP           VALUE 'Y'.
  2647             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  51
* EL050.cbl
  2648     12  LO-DETAIL-CONTROL           PIC X.
  2649             88  LO-PRINT-DETAIL        VALUE 'D'.
  2650             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2651
  2652     12  LO-SV-CARRIER               PIC X.
  2653     12  LO-SV-GROUPING              PIC X(6).
  2654     12  LO-SV-STATE                 PIC XX.
  2655
  2656     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2657     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2658
  2659     12  LO-OFFICER-INFO.
  2660         16  FILLER OCCURS 12 TIMES.
  2661             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2662             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2663             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2664             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2665             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2666             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2667             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2668             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2669     12  FILLER                      PIC X(198).
  2670******************************************************************
  2671*                                COPY ERCPDEF.
  2672******************************************************************
  2673*                                                                *
  2674*                                                                *
  2675*                            ERCPDEF.                            *
  2676*                                                                *
  2677*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2678*                                                                *
  2679*    FILE TYPE = VSAM,KSDS                                       *
  2680*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2681*                                                                *
  2682*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2683*                                                                *
  2684*    LOG = YES                                                   *
  2685*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2686******************************************************************
  2687 01  PRODUCT-MASTER.
  2688    12  PD-RECORD-ID                 PIC X(02).
  2689        88  VALID-PD-ID                  VALUE 'PD'.
  2690    12  PD-CONTROL-PRIMARY.
  2691        16  PD-COMPANY-CD            PIC X.
  2692        16  PD-STATE                 PIC XX.
  2693        16  PD-PRODUCT-CD            PIC XXX.
  2694        16  PD-FILLER                PIC X(7).
  2695        16  PD-BEN-TYPE              PIC X.
  2696        16  PD-BEN-CODE              PIC XX.
  2697        16  PD-PROD-EXP-DT           PIC XX.
  2698    12  FILLER                       PIC X(50).
  2699    12  PD-PRODUCT-DATA OCCURS 8.
  2700        16  PD-PROD-CODE             PIC X.
  2701            88  PD-PROD-LIFE           VALUE 'L'.
  2702            88  PD-PROD-PROP           VALUE 'P'.
  2703            88  PD-PROD-AH             VALUE 'A'.
  2704            88  PD-PROD-IU             VALUE 'I'.
  2705            88  PD-PROD-GAP            VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  52
* EL050.cbl
  2706        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2707        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2708        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2709        16  PD-MAX-TERM              PIC S999        COMP-3.
  2710        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2711        16  FILLER                   PIC X.
  2712        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2713        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2714        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2715        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2716        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2717        16  PD-REC-CRIT-PERIOD       PIC X.
  2718        16  PD-RTW-MOS               PIC 99.
  2719        16  FILLER                   PIC X(5).
  2720    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2721    12  PD-TERM-LIMITS OCCURS 15.
  2722        16  PD-LOW-TERM              PIC S999        COMP-3.
  2723        16  PD-HI-TERM               PIC S999        COMP-3.
  2724*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2725    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2726        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2727        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2728    12  PD-EARN-FACTORS.
  2729        16  FILLER OCCURS 15.
  2730            20  FILLER OCCURS 15.
  2731                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2732    12  PD-PRODUCT-DESC              PIC X(80).
  2733    12  FILLER                       PIC X(60).
  2734    12  PD-MAINT-INFORMATION.
  2735        16  PD-LAST-MAINT-DT         PIC X(02).
  2736        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2737        16  PD-LAST-MAINT-BY         PIC X(04).
  2738*                                COPY ELCSTATE.
  2739******************************************************************
  2740*                                                                *
  2741*                                                                *
  2742*                            ELCSTATE.                           *
  2743*                                                                *
  2744*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2745*                                                                *
  2746*   FILE TYPE = VSAM,KSDS                                        *
  2747*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2748*                                                                *
  2749*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2750*       ALTERNATE INDEX = NONE                                   *
  2751*                                                                *
  2752*   LOG = YES                                                    *
  2753*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2754******************************************************************
  2755*                   C H A N G E   L O G
  2756*
  2757* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2758*-----------------------------------------------------------------
  2759*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2760* EFFECTIVE    NUMBER
  2761*-----------------------------------------------------------------
  2762* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2763******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  53
* EL050.cbl
  2764*
  2765 01  STATE-FILE.
  2766     12  SF-RECORD-ID                       PIC XX.
  2767         88  VALID-CF-ID                        VALUE 'SF'.
  2768     12  SF-CONTROL-PRIMARY.
  2769         16  SF-COMPANY-ID                  PIC XXX.
  2770         16  SF-CARRIER-CODE                PIC X.
  2771         16  SF-GROUPING                    PIC X(6).
  2772         16  SF-STATE-CODE                  PIC XX.
  2773         16  SF-EXPIRE-DATE                 PIC 9(8).
  2774****************************************************************
  2775*             STATE CONTROLS
  2776****************************************************************
  2777     12  SF-LAST-MAINT-DT                   PIC XX.
  2778     12  SF-LAST-MAINT-BY                   PIC X(4).
  2779     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2780     12  SF-STATE-RT-CONTROLS.
  2781         16  SF-ST-RT-CALC                  PIC X.
  2782     12  SF-ST-TAX-CONTROLS.
  2783         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2784         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2785         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2786     12  SF-ST-REFUND-OPTIONS.
  2787         16  SF-ST-RF-LR-CALC               PIC X.
  2788         16  SF-ST-RF-LL-CALC               PIC X.
  2789         16  SF-ST-RF-LN-CALC               PIC X.
  2790         16  SF-ST-RF-AH-CALC               PIC X.
  2791         16  SF-ST-RF-CP-CALC               PIC X.
  2792     12  SF-ST-UNEARN-PREM-OPTIONS.
  2793         16  SF-ST-LUEP-R78                 PIC X.
  2794         16  SF-ST-LUEP-PRO                 PIC X.
  2795         16  SF-ST-LUEP-ST                  PIC X.
  2796         16  SF-ST-LUEP-DOM                 PIC X.
  2797         16  SF-ST-AUEP-R78                 PIC X.
  2798         16  SF-ST-AUEP-PRO                 PIC X.
  2799         16  SF-ST-AUEP-ST                  PIC X.
  2800         16  SF-ST-AUEP-DOM                 PIC X.
  2801         16  SF-ST-CUEP-R78                 PIC X.
  2802         16  SF-ST-CUEP-PRO                 PIC X.
  2803         16  SF-ST-CUEP-ST                  PIC X.
  2804         16  SF-ST-CUEP-DOM                 PIC X.
  2805     12  SF-ST-EARN-PREM-OPTIONS.
  2806         16  SF-ST-LEP-R78                  PIC X.
  2807         16  SF-ST-LEP-PRO                  PIC X.
  2808         16  SF-ST-LEP-ST                   PIC X.
  2809         16  SF-ST-LEP-DOM                  PIC X.
  2810         16  SF-ST-AEP-R78                  PIC X.
  2811         16  SF-ST-AEP-PRO                  PIC X.
  2812         16  SF-ST-AEP-ST                   PIC X.
  2813         16  SF-ST-AEP-DOM                  PIC X.
  2814         16  SF-ST-CEP-R78                  PIC X.
  2815         16  SF-ST-CEP-PRO                  PIC X.
  2816         16  SF-ST-CEP-ST                   PIC X.
  2817         16  SF-ST-CEP-DOM                  PIC X.
  2818     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  54
* EL050.cbl
  2820*    COPY ELCCRTT.
  2821******************************************************************
  2822*                                                                *
  2823*                            ELCCRTT.                            *
  2824*                                                                *
  2825*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2826*                                                                *
  2827*   FILE TYPE = VSAM,KSDS                                        *
  2828*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2829*                                                                *
  2830*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2831*                                                                *
  2832*   LOG = YES                                                    *
  2833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2834******************************************************************
  2835*                   C H A N G E   L O G
  2836*
  2837* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2838*-----------------------------------------------------------------
  2839*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2840* EFFECTIVE    NUMBER
  2841*-----------------------------------------------------------------
  2842* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2843* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2844* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2845******************************************************************
  2846
  2847 01  CERTIFICATE-TRAILERS.
  2848     12  CS-RECORD-ID                      PIC XX.
  2849         88  VALID-CS-ID                      VALUE 'CS'.
  2850
  2851     12  CS-CONTROL-PRIMARY.
  2852         16  CS-COMPANY-CD                 PIC X.
  2853         16  CS-CARRIER                    PIC X.
  2854         16  CS-GROUPING                   PIC X(6).
  2855         16  CS-STATE                      PIC XX.
  2856         16  CS-ACCOUNT                    PIC X(10).
  2857         16  CS-CERT-EFF-DT                PIC XX.
  2858         16  CS-CERT-NO.
  2859             20  CS-CERT-PRIME             PIC X(10).
  2860             20  CS-CERT-SFX               PIC X.
  2861         16  CS-TRAILER-TYPE               PIC X.
  2862             88  COMM-TRLR           VALUE 'A'.
  2863             88  FUTURE-TRLR         VALUE 'B'.
  2864             88  CERT-DATA-TRLR      VALUE 'C'.
  2865
  2866     12  CS-DATA-AREA                      PIC X(516).
  2867
  2868     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2869         16  CS-BANK-COMMISSION-AREA.
  2870             20  CS-BANK-COMMS       OCCURS 10.
  2871                 24  CS-AGT                PIC X(10).
  2872                 24  CS-COM-TYP            PIC X.
  2873                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2874                 24  CS-RECALC-LV-INDIC    PIC X.
  2875                 24  FILLER                PIC X(10).
  2876         16  FILLER                        PIC X(256).
  2877
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  55
* EL050.cbl
  2878     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2879         16  CS-VIN-NUMBER                 PIC X(17).
  2880         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2881         16  FILLER                        PIC X(498).
  2882******************************************************************
  2883
  2884*    COPY ELCDATE.
  2885******************************************************************
  2886*                                                                *
  2887*                                                                *
  2888*                            ELCDATE.                            *
  2889*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2890*                            VMOD=2.003
  2891*                                                                *
  2892*                                                                *
  2893*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2894*                 LENGTH = 200                                   *
  2895******************************************************************
  2896
  2897 01  DATE-CONVERSION-DATA.
  2898     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2899     12  DC-OPTION-CODE                PIC X.
  2900         88  BIN-TO-GREG                VALUE ' '.
  2901         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2902         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2903         88  YMD-GREG-TO-BIN            VALUE '3'.
  2904         88  MDY-GREG-TO-BIN            VALUE '4'.
  2905         88  JULIAN-TO-BIN              VALUE '5'.
  2906         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2907         88  FIND-CENTURY               VALUE '7'.
  2908         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2909         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2910         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2911         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2912         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2913         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2914         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2915         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2916         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2917         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2918         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2919         88  BIN-3-TO-GREG              VALUE 'I'.
  2920         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2921         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2922         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2923         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2924         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2925         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2926         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2927         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2928         88  THREE-CHARACTER-BIN
  2929                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2930         88  GREGORIAN-TO-BIN
  2931                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2932         88  BIN-TO-GREGORIAN
  2933                  VALUES ' ' '1' 'I' '8' 'G'.
  2934         88  JULIAN-TO-BINARY
  2935                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  56
* EL050.cbl
  2936     12  DC-ERROR-CODE                 PIC X.
  2937         88  NO-CONVERSION-ERROR        VALUE ' '.
  2938         88  DATE-CONVERSION-ERROR
  2939                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2940         88  DATE-IS-ZERO               VALUE '1'.
  2941         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2942         88  DATE-IS-INVALID            VALUE '3'.
  2943         88  DATE1-GREATER-DATE2        VALUE '4'.
  2944         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2945         88  DATE-INVALID-OPTION        VALUE '9'.
  2946         88  INVALID-CENTURY            VALUE 'A'.
  2947         88  ONLY-CENTURY               VALUE 'B'.
  2948         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2949         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2950     12  DC-END-OF-MONTH               PIC X.
  2951         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2952     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2953         88  USE-NORMAL-PROCESS         VALUE ' '.
  2954         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2955         88  ADJUST-UP-100-YRS          VALUE '2'.
  2956     12  FILLER                        PIC X.
  2957     12  DC-CONVERSION-DATES.
  2958         16  DC-BIN-DATE-1             PIC XX.
  2959         16  DC-BIN-DATE-2             PIC XX.
  2960         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2961         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2962                       DC-GREG-DATE-1-EDIT.
  2963             20  DC-EDIT1-MONTH        PIC 99.
  2964             20  SLASH1-1              PIC X.
  2965             20  DC-EDIT1-DAY          PIC 99.
  2966             20  SLASH1-2              PIC X.
  2967             20  DC-EDIT1-YEAR         PIC 99.
  2968         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2969         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2970                     DC-GREG-DATE-2-EDIT.
  2971             20  DC-EDIT2-MONTH        PIC 99.
  2972             20  SLASH2-1              PIC X.
  2973             20  DC-EDIT2-DAY          PIC 99.
  2974             20  SLASH2-2              PIC X.
  2975             20  DC-EDIT2-YEAR         PIC 99.
  2976         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2977         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2978                     DC-GREG-DATE-1-YMD.
  2979             20  DC-YMD-YEAR           PIC 99.
  2980             20  DC-YMD-MONTH          PIC 99.
  2981             20  DC-YMD-DAY            PIC 99.
  2982         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2983         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2984                      DC-GREG-DATE-1-MDY.
  2985             20  DC-MDY-MONTH          PIC 99.
  2986             20  DC-MDY-DAY            PIC 99.
  2987             20  DC-MDY-YEAR           PIC 99.
  2988         16  DC-GREG-DATE-1-ALPHA.
  2989             20  DC-ALPHA-MONTH        PIC X(10).
  2990             20  DC-ALPHA-DAY          PIC 99.
  2991             20  FILLER                PIC XX.
  2992             20  DC-ALPHA-CENTURY.
  2993                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  57
* EL050.cbl
  2994             20  DC-ALPHA-YEAR         PIC 99.
  2995         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2996         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2997         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2998         16  DC-JULIAN-DATE            PIC 9(05).
  2999         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3000                                       PIC 9(05).
  3001         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3002             20  DC-JULIAN-YEAR        PIC 99.
  3003             20  DC-JULIAN-DAYS        PIC 999.
  3004         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3005         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3006         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3007     12  DATE-CONVERSION-VARIBLES.
  3008         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3009         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3010             20  FILLER                PIC 9(3).
  3011             20  HOLD-CEN-1-CCYY.
  3012                 24  HOLD-CEN-1-CC     PIC 99.
  3013                 24  HOLD-CEN-1-YY     PIC 99.
  3014             20  HOLD-CEN-1-MO         PIC 99.
  3015             20  HOLD-CEN-1-DA         PIC 99.
  3016         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3017             20  HOLD-CEN-1-R-MO       PIC 99.
  3018             20  HOLD-CEN-1-R-DA       PIC 99.
  3019             20  HOLD-CEN-1-R-CCYY.
  3020                 24  HOLD-CEN-1-R-CC   PIC 99.
  3021                 24  HOLD-CEN-1-R-YY   PIC 99.
  3022             20  FILLER                PIC 9(3).
  3023         16  HOLD-CENTURY-1-X.
  3024             20  FILLER                PIC X(3)  VALUE SPACES.
  3025             20  HOLD-CEN-1-X-CCYY.
  3026                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3027                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3028             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3029             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3030         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3031             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3032             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3033             20  HOLD-CEN-1-R-X-CCYY.
  3034                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3035                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3036             20  FILLER                PIC XXX.
  3037         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3038         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3039         16  DC-JULIAN-DATE-1          PIC 9(07).
  3040         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3041             20  DC-JULIAN-1-CCYY.
  3042                 24  DC-JULIAN-1-CC    PIC 99.
  3043                 24  DC-JULIAN-1-YR    PIC 99.
  3044             20  DC-JULIAN-DA-1        PIC 999.
  3045         16  DC-JULIAN-DATE-2          PIC 9(07).
  3046         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3047             20  DC-JULIAN-2-CCYY.
  3048                 24  DC-JULIAN-2-CC    PIC 99.
  3049                 24  DC-JULIAN-2-YR    PIC 99.
  3050             20  DC-JULIAN-DA-2        PIC 999.
  3051         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  58
* EL050.cbl
  3052             20  DC-EDITA-MONTH        PIC 99.
  3053             20  SLASHA-1              PIC X VALUE '/'.
  3054             20  DC-EDITA-DAY          PIC 99.
  3055             20  SLASHA-2              PIC X VALUE '/'.
  3056             20  DC-EDITA-CCYY.
  3057                 24  DC-EDITA-CENT     PIC 99.
  3058                 24  DC-EDITA-YEAR     PIC 99.
  3059         16  DC-GREG-DATE-B-EDIT.
  3060             20  DC-EDITB-MONTH        PIC 99.
  3061             20  SLASHB-1              PIC X VALUE '/'.
  3062             20  DC-EDITB-DAY          PIC 99.
  3063             20  SLASHB-2              PIC X VALUE '/'.
  3064             20  DC-EDITB-CCYY.
  3065                 24  DC-EDITB-CENT     PIC 99.
  3066                 24  DC-EDITB-YEAR     PIC 99.
  3067         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3068         16  DC-GREG-DATE-CYMD-R REDEFINES
  3069                              DC-GREG-DATE-CYMD.
  3070             20  DC-CYMD-CEN           PIC 99.
  3071             20  DC-CYMD-YEAR          PIC 99.
  3072             20  DC-CYMD-MONTH         PIC 99.
  3073             20  DC-CYMD-DAY           PIC 99.
  3074         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3075         16  DC-GREG-DATE-MDCY-R REDEFINES
  3076                              DC-GREG-DATE-MDCY.
  3077             20  DC-MDCY-MONTH         PIC 99.
  3078             20  DC-MDCY-DAY           PIC 99.
  3079             20  DC-MDCY-CEN           PIC 99.
  3080             20  DC-MDCY-YEAR          PIC 99.
  3081    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3082        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3083    12  DC-EL310-DATE                  PIC X(21).
  3084    12  FILLER                         PIC X(28).
  3085
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  59
* EL050.cbl
  3087*    COPY ELCCALC.
  3088******************************************************************
  3089*                                                                *
  3090*                           ELCCALC.                            *
  3091*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3092*                            VMOD=2.025                          *
  3093*                                                                *
  3094*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3095*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3096*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3097*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3098*                                                                *
  3099*  PASSED TO ELRTRM                                              *
  3100*  -----------------                                             *
  3101*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3102*  ORIGINAL TERM                                                 *
  3103*  BEGINNING DATE                                                *
  3104*  ENDING DATE                                                   *
  3105*  COMPANY I.D.                                                  *
  3106*  ACCOUNT MASTER USER FIELD                                     *
  3107*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3108*  FREE LOOK DAYS                                                *
  3109*                                                                *
  3110*  RETURNED FROM ELRTRM                                          *
  3111*  ---------------------                                         *
  3112*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3113*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3114*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3115*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3116*----------------------------------------------------------------*
  3117*  PASSED TO ELRAMT                                              *
  3118*  ----------------                                              *
  3119*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3120*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3121*  ORIGINAL AMOUNT                                               *
  3122*  ALTERNATE BENEFIT (BALLON)                                    *
  3123*  A.P.R. - NET PAY ONLY                                         *
  3124*  METHOD
  3125*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3126*  COMPANY I.D.                                                  *
  3127*  BENEFIT TYPE                                                  *
  3128*                                                                *
  3129*  RETURNED FROM ELRAMT                                          *
  3130*  --------------------                                          *
  3131*  REMAINING AMOUNT 1 - CURRENT                                  *
  3132*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3133*  REMAINING AMOUNT FACTOR
  3134*----------------------------------------------------------------*
  3135*  PASSED TO ELRESV                                              *
  3136*  -----------------                                             *
  3137*  CERTIFICATE EFFECTIVE DATE                                    *
  3138*  VALUATION DATE                                                *
  3139*  PAID THRU DATE                                                *
  3140*  BENEFIT                                                       *
  3141*  INCURRED DATE                                                 *
  3142*  REPORTED DATE                                                 *
  3143*  ISSUE AGE                                                     *
  3144*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  60
* EL050.cbl
  3145*  CDT PERCENT                                                   *
  3146*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3147* *CLAIM TYPE (LIFE, A/H)                                        *
  3148* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3149* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3150*                                                                *
  3151*  RETURNED FROM ELRESV                                          *
  3152*  --------------------                                          *
  3153*  CDT TABLE USED                                                *
  3154*  CDT FACTOR USED                                               *
  3155*  PAY TO CURRENT RESERVE                                        *
  3156*  I.B.N.R. - A/H ONLY                                           *
  3157*  FUTURE (ACCRUED) AH ONLY                                      *
  3158*----------------------------------------------------------------*
  3159*  PASSED TO ELRATE                                              *
  3160*  ----------------                                              *
  3161*  CERT ISSUE DATE                                               *
  3162*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3163*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3164*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3165*  STATE CODE (CLIENT DEFINED)                                   *
  3166*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3167*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3168*  DEVIATION CODE                                                *
  3169*  ISSUE AGE                                                     *
  3170*  ORIGINAL BENEFIT AMOUNT                                       *
  3171*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3172*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3173*  BENEFIT KIND (LIFE OR A/H)                                    *
  3174*  A.P.R.                                                        *
  3175*  METHOD
  3176*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3177*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3178*  COMPANY I.D. (3 CHARACTER)                                    *
  3179*  BENEFIT CODE                                                  *
  3180*  BENEFIT OVERRIDE CODE                                         *
  3181*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3182*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3183*  JOINT INDICATOR (CSL ONLY)                                    *
  3184*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3185*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3186*                                                                *
  3187*  RETURNED FROM ELRATE                                          *
  3188*  --------------------                                          *
  3189*  CALCULATED PREMIUM                                            *
  3190*  PREMIUM RATE                                                  *
  3191*  MORTALITY CODE                                                *
  3192*  MAX ATTAINED AGE                                              *
  3193*  MAX AGE                                                       *
  3194*  MAX TERM                                                      *
  3195*  MAX MONTHLY BENEFIT                                           *
  3196*  MAX TOTAL BENIFIT                                             *
  3197*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3198*----------------------------------------------------------------*
  3199*  PASSED TO ELRFND                                              *
  3200*  ----------------                                              *
  3201*  CERT ISSUE DATE                                               *
  3202*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  61
* EL050.cbl
  3203*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3204*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3205*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3206*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3207*  STATE CODE (CLIENT DEFINED)                                   *
  3208*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3209*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3210*  DEVIATION CODE                                                *
  3211*  ISSUE AGE                                                     *
  3212*  ORIGINAL BENEFIT AMOUNT                                       *
  3213*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3214*  PROCESS TYPE (CANCEL)                                         *
  3215*  BENEFIT KIND (LIFE OR A/H)                                    *
  3216*  A.P.R.                                                        *
  3217*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3218*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3219*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3220*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3221*  COMPANY I.D. (3 CHARACTER)                                    *
  3222*  BENEFIT CODE                                                  *
  3223*  BENEFIT OVERRIDE CODE                                         *
  3224*                                                                *
  3225*  RETURNED FROM ELRFND                                          *
  3226*  --------------------                                          *
  3227*  CALCULATED REFUND                                             *
  3228*----------------------------------------------------------------*
  3229*  PASSED TO ELEARN                                              *
  3230*  ----------------                                              *
  3231*  CERT ISSUE DATE                                               *
  3232*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3233*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3234*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3235*  STATE CODE (CLIENT DEFINED)                                   *
  3236*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3237*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3238*  DEVIATION CODE                                                *
  3239*  ISSUE AGE                                                     *
  3240*  ORIGINAL BENEFIT AMOUNT                                       *
  3241*  BENEFIT KIND (LIFE OR A/H)                                    *
  3242*  A.P.R.                                                        *
  3243*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3244*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3245*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3246*  COMPANY I.D. (3 CHARACTER)                                    *
  3247*  BENEFIT CODE                                                  *
  3248*  BENEFIT OVERRIDE CODE                                         *
  3249*                                                                *
  3250*  RETURNED FROM ELEARN                                          *
  3251*  --------------------                                          *
  3252*  INDICATED  EARNINGS                                           *
  3253*----------------------------------------------------------------*
  3254*                 LENGTH = 450                                   *
  3255*                                                                *
  3256******************************************************************
  3257******************************************************************
  3258*                   C H A N G E   L O G
  3259*
  3260* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  62
* EL050.cbl
  3261*-----------------------------------------------------------------
  3262*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3263* EFFECTIVE    NUMBER
  3264*-----------------------------------------------------------------
  3265* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3266* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3267* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3268* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3269* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3270* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3271* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3272* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3273* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3274******************************************************************
  3275
  3276 01  CALCULATION-PASS-AREA.
  3277     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3278                                     COMP.
  3279
  3280     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3281       88  NO-CP-ERROR                             VALUE ZERO.
  3282       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3283                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3284       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3285       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3286       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3287       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3288       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3289       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3290       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3291       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3292       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3293       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3294       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3295       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3296       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3297       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3298       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3299       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3300       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3301
  3302     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3303       88  NO-CP-ERROR-2                           VALUE ZERO.
  3304***********************  INPUT AREAS ****************************
  3305
  3306     12  CP-CALCULATION-AREA.
  3307         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3308         16  CP-CERT-EFF-DT        PIC XX.
  3309         16  CP-VALUATION-DT       PIC XX.
  3310         16  CP-PAID-THRU-DT       PIC XX.
  3311         16  CP-BENEFIT-TYPE       PIC X.
  3312           88  CP-AH                               VALUE 'A' 'D'
  3313                                                   'I' 'U'.
  3314           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3315           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3316         16  CP-INCURRED-DT        PIC XX.
  3317         16  CP-REPORTED-DT        PIC XX.
  3318         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  63
* EL050.cbl
  3319         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3320         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3321                                     COMP-3.
  3322         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3323                                     COMP-3.
  3324         16  CP-CDT-METHOD         PIC X.
  3325           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3326           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3327           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3328         16  CP-CLAIM-TYPE         PIC X.
  3329           88  CP-AH-CLAIM                         VALUE 'A'.
  3330           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3331         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3332                                     COMP-3.
  3333         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3334                                     COMP-3.
  3335         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3336                                     COMP-3.
  3337         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3338                                     COMP-3.
  3339         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3340                                     COMP-3.
  3341         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3342                                     COMP-3.
  3343         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3344                                     COMP-3.
  3345         16  CP-REM-TERM-METHOD    PIC X.
  3346           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3347           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3348           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3349           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3350           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3351           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3352           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3353         16  CP-EARNING-METHOD     PIC X.
  3354           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3355           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3356           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3357           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3358           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3359           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3360           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3361           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3362           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3363           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3364           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3365           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3366           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3367           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3368         16  CP-PROCESS-TYPE       PIC X.
  3369           88  CP-CLAIM                            VALUE '1'.
  3370           88  CP-CANCEL                           VALUE '2'.
  3371           88  CP-ISSUE                            VALUE '3'.
  3372         16  CP-SPECIAL-CALC-CD    PIC X.
  3373           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3374           88  CP-1-MTH-INTEREST               VALUE ' '.
  3375           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3376           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  64
* EL050.cbl
  3377           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3378           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3379           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3380           88  CP-FARM-PLAN                    VALUE 'F'.
  3381           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3382           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3383           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3384           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3385           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3386           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3387           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3388           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3389           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3390           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3391                                                     'W' 'X'.
  3392           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3393           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3394           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3395           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3396           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3397           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3398           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3399           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3400           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3401           88  CP-CSL-METH-1                   VALUE '5'.
  3402           88  CP-CSL-METH-2                   VALUE '6'.
  3403           88  CP-CSL-METH-3                   VALUE '7'.
  3404           88  CP-CSL-METH-4                   VALUE '8'.
  3405
  3406         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3407                                     COMP-3.
  3408         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3409         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3410         16  CP-STATE              PIC XX          VALUE SPACE.
  3411         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3412         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3413           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3414               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3415         16  CP-R78-OPTION         PIC X.
  3416           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3417           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3418
  3419         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3420         16  CP-IBNR-RESERVE-SW    PIC X.
  3421         16  CP-CLAIM-STATUS       PIC X.
  3422         16  CP-RATE-FILE          PIC X.
  3423         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3424                                     COMP-3.
  3425
  3426         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3427         16  CP-AH-OVERRIDE-CODE   PIC X.
  3428
  3429         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3430                                     COMP-3.
  3431         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3432                                   PIC S9(5)V99 COMP-3.
  3433         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3434                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  65
* EL050.cbl
  3435         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3436                                     COMP-3.
  3437         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3438                                     COMP-3.
  3439         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3440                                  PIC S9(7)V99 COMP-3.
  3441
  3442         16  CP-PAID-FROM-DATE     PIC X(02).
  3443         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3444         16  CP-EXT-DAYS-CALC      PIC X.
  3445           88  CP-EXT-NO-CHG                   VALUE ' '.
  3446           88  CP-EXT-CHG-LF                   VALUE '1'.
  3447           88  CP-EXT-CHG-AH                   VALUE '2'.
  3448           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3449         16  CP-DOMICILE-STATE     PIC XX.
  3450         16  CP-CARRIER            PIC X.
  3451         16  CP-REIN-FLAG          PIC X.
  3452         16  CP-REM-TRM-CALC-OPTION PIC X.
  3453           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3454                      '2' '3' '4' '5'.
  3455           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3456           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3457           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3458           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3459           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3460           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3461           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3462           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3463         16  CP-SIG-SWITCH         PIC X.
  3464         16  CP-RATING-METHOD      PIC X.
  3465           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3466           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3467           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3468           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3469           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3470           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3471           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3472           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3473           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3474         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3475                                     COMP-3.
  3476         16  CP-BEN-CATEGORY       PIC X.
  3477         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3478         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3479                                   PIC S99V9(5) COMP-3.
  3480         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3481         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3482                                   PIC S99V9(5) COMP-3.
  3483         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3484         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3485         16  CP-EXPIRE-DT          PIC XX.
  3486         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3487         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3488         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3489         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3490         16  CP-DDF-SPEC-CALC      PIC X.
  3491             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3492             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  66
* EL050.cbl
  3493         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3494         16  CP-CANCEL-REASON      PIC X.
  3495         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3496         16  CP-PMT-MODE           PIC X.
  3497         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3498         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3499         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3500         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3501         16  FILLER                PIC X.
  3502
  3503***************    OUTPUT FROM ELRESV   ************************
  3504
  3505         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3506
  3507         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3508                                     COMP-3.
  3509         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3510                                     COMP-3.
  3511         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3512                                     COMP-3.
  3513         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3514                                     COMP-3.
  3515         16  FILLER                PIC X(09).
  3516***************    OUTPUT FROM ELRTRM   *************************
  3517
  3518         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3519                                     COMP-3.
  3520         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3521                                     COMP-3.
  3522         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3523                                     COMP-3.
  3524         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3525                                     COMP-3.
  3526         16  FILLER                PIC X(12).
  3527
  3528***************    OUTPUT FROM ELRAMT   *************************
  3529
  3530         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3531                                     COMP-3.
  3532         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3533                                     COMP-3.
  3534         16  FILLER                PIC X(12).
  3535
  3536***************    OUTPUT FROM ELRATE   *************************
  3537
  3538         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3539                                     COMP-3.
  3540         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3541                                     COMP-3.
  3542         16  CP-MORTALITY-CODE     PIC X(4).
  3543         16  CP-RATE-EDIT-FLAG     PIC X.
  3544             88  CP-RATES-NEED-APR                  VALUE '1'.
  3545         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3546                                     COMP-3.
  3547         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3548         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3549         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3550                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  67
* EL050.cbl
  3551         16  FILLER                PIC X(07).
  3552
  3553***************    OUTPUT FROM ELRFND   *************************
  3554
  3555         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3556                                     COMP-3.
  3557         16  CP-REFUND-TYPE-USED   PIC X.
  3558           88  CP-R-AS-R78                         VALUE '1'.
  3559           88  CP-R-AS-PRORATA                     VALUE '2'.
  3560           88  CP-R-AS-CALIF                       VALUE '3'.
  3561           88  CP-R-AS-TEXAS                       VALUE '4'.
  3562           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3563           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3564           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3565           88  CP-R-AS-MEAN                        VALUE '8'.
  3566           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3567           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3568           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3569           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3570           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3571           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3572         16  FILLER                PIC X(12).
  3573
  3574***************    OUTPUT FROM ELEARN   *************************
  3575
  3576         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3577                                     COMP-3.
  3578         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3583                                     COMP-3.
  3584         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3585                                     COMP-3.
  3586         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3587                                     COMP-3.
  3588         16  CP-EARNING-TYPE-USED  PIC X.
  3589           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3590           88  CP-E-AS-R78                         VALUE '1'.
  3591           88  CP-E-AS-PRORATA                     VALUE '2'.
  3592           88  CP-E-AS-TEXAS                       VALUE '4'.
  3593           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3594           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3595           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3596           88  CP-E-AS-MEAN                        VALUE '8'.
  3597           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3598         16  FILLER                PIC X(12).
  3599
  3600***************    OUTPUT FROM ELPMNT   *************************
  3601
  3602         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3603                                     COMP-3.
  3604         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3605                                     COMP-3.
  3606         16  FILLER                PIC X(12).
  3607
  3608***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  68
* EL050.cbl
  3609         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3610                                     COMP-3.
  3611         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3612                                     COMP-3.
  3613         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3614                                     COMP-3.
  3615         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3616                                     COMP-3.
  3617         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3618                                     COMP-3.
  3619         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3620                                     COMP-3.
  3621         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3622             88  OPEN-RATE-FILE                   VALUE 'O'.
  3623             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3624             88  IO-ERROR                         VALUE 'E'.
  3625
  3626         16  CP-FIRST-PAY-DATE     PIC XX.
  3627
  3628         16  CP-JOINT-INDICATOR    PIC X.
  3629
  3630         16  CP-RESERVE-REMAINING-TERM
  3631                                   PIC S9(4)V9    VALUE ZERO
  3632                                     COMP-3.
  3633
  3634         16  CP-INSURED-BIRTH-DT   PIC XX.
  3635
  3636         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3637                                     COMP-3.
  3638
  3639         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3640                                     COMP-3.
  3641
  3642         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3643                                     COMP-3.
  3644
  3645         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3646                                     COMP-3.
  3647
  3648         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3649                                     COMP-3.
  3650
  3651         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3652                                     COMP-3.
  3653
  3654         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3655                                     COMP-3.
  3656
  3657         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3658             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3659
  3660         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3661                                     COMP-3.
  3662         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3663                                     COMP-3.
  3664         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3665         16  FILLER                PIC X(15).
  3666******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  69
* EL050.cbl
  3668******************************************************************
  3669*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3670*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3671*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3672*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3673*** MODIFICATION.                                              ***
  3674*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3675*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3676******************************************************************
  3677*    COPY ERCPNDB.
  3678******************************************************************
  3679*                                                                *
  3680*                                                                *
  3681*                            ERCPNDB.                            *
  3682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3683*                            VMOD=2.025                          *
  3684*                                                                *
  3685*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3686*                                                                *
  3687******************************************************************
  3688*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3689*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3690******************************************************************
  3691*                                                                *
  3692*                                                                *
  3693*   FILE TYPE = VSAM,KSDS                                        *
  3694*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3695*                                                                *
  3696*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3697*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3698*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3699*                                                 RKP=13,LEN=36  *
  3700*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3701*                                      AND CHG-SEQ.)             *
  3702*                                                RKP=49,LEN=11   *
  3703*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3704*                                      AND CHG-SEQ.)             *
  3705*                                                RKP=60,LEN=15   *
  3706*                                                                *
  3707*   LOG = NO                                                     *
  3708*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3709******************************************************************
  3710******************************************************************
  3711*                   C H A N G E   L O G
  3712*
  3713* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3714*-----------------------------------------------------------------
  3715*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3716* EFFECTIVE    NUMBER
  3717*-----------------------------------------------------------------
  3718* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3719* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3720* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3721* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3722* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3723* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3724* 032306                   PEMA  ADD BOW LOAN NUMBER
  3725* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  70
* EL050.cbl
  3726* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3727* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3728* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3729* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3730* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3731* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3732* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3733******************************************************************
  3734
  3735 01  PENDING-BUSINESS.
  3736     12  PB-RECORD-ID                     PIC XX.
  3737         88  VALID-PB-ID                        VALUE 'PB'.
  3738
  3739     12  PB-CONTROL-PRIMARY.
  3740         16  PB-COMPANY-CD                PIC X.
  3741         16  PB-ENTRY-BATCH               PIC X(6).
  3742         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3743         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3744
  3745     12  PB-CONTROL-BY-ACCOUNT.
  3746         16  PB-COMPANY-CD-A1             PIC X.
  3747         16  PB-CARRIER                   PIC X.
  3748         16  PB-GROUPING.
  3749             20  PB-GROUPING-PREFIX       PIC XXX.
  3750             20  PB-GROUPING-PRIME        PIC XXX.
  3751         16  PB-STATE                     PIC XX.
  3752         16  PB-ACCOUNT.
  3753             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3754             20  PB-ACCOUNT-PRIME         PIC X(6).
  3755         16  PB-CERT-EFF-DT               PIC XX.
  3756         16  PB-CERT-NO.
  3757             20  PB-CERT-PRIME            PIC X(10).
  3758             20  PB-CERT-SFX              PIC X.
  3759         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3760
  3761         16  PB-RECORD-TYPE               PIC X.
  3762             88  PB-MAILING-DATA                VALUE '0'.
  3763             88  PB-ISSUE                       VALUE '1'.
  3764             88  PB-CANCELLATION                VALUE '2'.
  3765             88  PB-BATCH-TRAILER               VALUE '9'.
  3766
  3767     12  PB-CONTROL-BY-ORIG-BATCH.
  3768         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3769         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3770         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3771         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3772
  3773     12  PB-CONTROL-BY-CSR.
  3774         16  PB-CSR-COMPANY-CD            PIC X.
  3775         16  PB-CSR-ID                    PIC X(4).
  3776         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3777         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3778         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3779******************************************************************
  3780*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3781******************************************************************
  3782
  3783     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  71
* EL050.cbl
  3784     12  PB-LAST-MAINT-BY                 PIC X(4).
  3785     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3786
  3787     12  PB-RECORD-BODY                   PIC X(375).
  3788
  3789     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3790         16  PB-CERT-ORIGIN               PIC X.
  3791             88  CLASIC-CREATED-CERT         VALUE '1'.
  3792         16  PB-I-NAME.
  3793             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3794             20  PB-I-INSURED-FIRST-NAME.
  3795                 24  PB-I-INSURED-1ST-INIT PIC X.
  3796                 24  FILLER                PIC X(9).
  3797             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3798         16  PB-I-AGE                     PIC S99   COMP-3.
  3799         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3800         16  PB-I-BIRTHDAY                PIC XX.
  3801         16  PB-I-INSURED-SEX             PIC X.
  3802             88  PB-SEX-MALE     VALUE 'M'.
  3803             88  PB-SEX-FEMALE   VALUE 'F'.
  3804
  3805         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3806         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3807         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3808         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3809         16  PB-I-SKIP-CODE               PIC X.
  3810             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3811             88  PB-SKIP-JULY              VALUE '1'.
  3812             88  PB-SKIP-AUGUST            VALUE '2'.
  3813             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3814             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3815             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3816             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3817             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3818             88  PB-SKIP-JUNE              VALUE '8'.
  3819             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3820             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3821             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3822         16  PB-I-TERM-TYPE               PIC X.
  3823             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3824             88  PB-PAID-WEEKLY            VALUE 'W'.
  3825             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3826             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3827             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3828         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3829         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3830         16  PB-I-DATA-ENTRY-SW           PIC X.
  3831             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3832             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3833             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3834             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3835         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3836         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3837*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3838         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3839         16  FILLER                       PIC X.
  3840
  3841         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  72
* EL050.cbl
  3842             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3843             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3844                                                   '90' THRU '99'.
  3845         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3846                                          PIC XX.
  3847         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3848         16  PB-I-AMOUNT-FINANCED REDEFINES
  3849                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3850         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3851         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3852                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3853         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3854         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3855         16  PB-I-CLP-AMOUNT REDEFINES
  3856                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3857         16  PB-I-LF-CALC-FLAG            PIC X.
  3858             88 PB-COMP-LF-PREM               VALUE '?'.
  3859         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3860         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3861         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3862         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3863         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3864         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3865         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3866         16  PB-I-LF-ABBR                 PIC XXX.
  3867         16  PB-I-LF-INPUT-CD             PIC XX.
  3868
  3869         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3870             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3871             88  PB-INVALID-AH               VALUE '  ' '00'
  3872                                                   '90' THRU '99'.
  3873         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3874         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3875         16  PB-I-AH-CALC-FLAG            PIC X.
  3876             88 PB-COMP-AH-PREM                  VALUE '?'.
  3877         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3878         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3879         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3880         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3881         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3882         16  PB-I-AH-ABBR                 PIC XXX.
  3883         16  PB-I-AH-INPUT-CD             PIC XXX.
  3884
  3885         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3886         16  PB-I-REIN-TABLE              PIC XXX.
  3887         16  PB-I-BUSINESS-TYPE           PIC 99.
  3888         16  PB-I-INDV-GRP-CD             PIC X.
  3889         16  PB-I-MORT-CODE.
  3890             20  PB-I-TABLE               PIC X.
  3891             20  PB-I-INTEREST            PIC XX.
  3892             20  PB-I-MORT-TYP            PIC X.
  3893         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3894         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3895         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3896         16  PB-I-INDV-GRP-OVRD           PIC X.
  3897         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3898         16  PB-I-SIG-SW                  PIC X.
  3899             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  73
* EL050.cbl
  3900         16  PB-I-RATE-CLASS              PIC XX.
  3901         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3902         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3903         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3904         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3905         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3906         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3907         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3908         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3909         16  PB-I-OB-FLAG                 PIC X.
  3910             88  PB-I-OB                      VALUE 'B'.
  3911             88  PB-I-SUMMARY                 VALUE 'Z'.
  3912         16  PB-I-ENTRY-STATUS            PIC X.
  3913             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3914                                              'M' '5' '9' '2'.
  3915             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3916             88  PB-I-POLICY-PENDING          VALUE '2'.
  3917             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3918             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3919             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3920             88  PB-I-REIN-ONLY               VALUE '9'.
  3921             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3922             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3923             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3924             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3925         16  PB-I-INT-CODE                PIC X.
  3926             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3927             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3928         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3929         16  PB-I-SOC-SEC-NO              PIC X(11).
  3930         16  PB-I-MEMBER-NO               PIC X(12).
  3931         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3932*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3933         16  PB-I-OLD-LOF                 PIC XXX.
  3934         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3935         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3936         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3937         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3938         16  PB-I-LIFE-INDICATOR          PIC X.
  3939             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3940         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3941         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3942                                          PIC S9(5)V99    COMP-3.
  3943         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3944             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3945             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3946         16  PB-I-1ST-PMT-DT              PIC XX.
  3947         16  PB-I-JOINT-INSURED.
  3948             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3949             20 PB-I-JOINT-FIRST-NAME.
  3950                24  PB-I-JOINT-FIRST-INIT PIC X.
  3951                24  FILLER                PIC X(9).
  3952             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3953*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3954         16  PB-I-BENEFICIARY-NAME.
  3955             20  PB-I-BANK-NUMBER         PIC X(10).
  3956             20  FILLER                   PIC X(15).
  3957         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  74
* EL050.cbl
  3958         16  PB-I-REFERENCE               PIC X(12).
  3959         16  FILLER REDEFINES PB-I-REFERENCE.
  3960             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3961             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3962             20  PB-I-CLP-STATE           PIC XX.
  3963         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3964             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3965             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3966             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3967         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3968         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3969         16  PB-I-RESIDENT-STATE          PIC XX.
  3970         16  PB-I-RATE-CODE               PIC X(4).
  3971         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3972         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3973         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3974         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3975         16  PB-I-BANK-NOCHRGB            PIC 99.
  3976         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3977         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3978
  3979     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3980         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3981             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3982         16  PB-C-CANCEL-ORIGIN           PIC X.
  3983             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3984         16  PB-C-LF-CANCEL-DT            PIC XX.
  3985         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3986         16  PB-C-LF-CALC-REQ             PIC X.
  3987             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3988         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3989         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3990         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3991             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3992         16  PB-C-AH-CANCEL-DT            PIC XX.
  3993         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3994         16  PB-C-AH-CALC-REQ             PIC X.
  3995             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3996         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3997         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3998         16  PB-C-LAST-NAME               PIC X(15).
  3999         16  PB-C-REFUND-SW               PIC X.
  4000             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4001             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4002         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4003         16  PB-C-PAYEE-CODE              PIC X(6).
  4004         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4005         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4006         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4007         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4008         16  PB-C-REFERENCE               PIC X(12).
  4009         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4010         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4011         16  PB-C-POST-CARD-IND           PIC X.
  4012         16  PB-C-CANCEL-REASON           PIC X.
  4013         16  PB-C-REF-INTERFACE-SW        PIC X.
  4014         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4015         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  75
* EL050.cbl
  4016         16  FILLER                       PIC X(01).
  4017*        16  FILLER                       PIC X(18).
  4018         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4019*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4020         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4021         16  PB-CANCELED-CERT-DATA.
  4022             20  PB-CI-INSURED-NAME.
  4023                 24  PB-CI-LAST-NAME      PIC X(15).
  4024                 24  PB-CI-INITIALS       PIC XX.
  4025             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4026             20  PB-CI-INSURED-SEX        PIC X.
  4027             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4028             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4029             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4030             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4031             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4032             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4033             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4034             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4035             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4036             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4037             20  PB-CI-RATE-CLASS         PIC XX.
  4038             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4039             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4040             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4041             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4042             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4043             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4044             20  PB-CI-LF-ABBR            PIC X(3).
  4045             20  PB-CI-AH-ABBR            PIC X(3).
  4046             20  PB-CI-OB-FLAG            PIC X.
  4047                 88  PB-CI-OB                VALUE 'B'.
  4048             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4049                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4050                                           'M' '4' '5' '9' '2'.
  4051                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4052                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4053                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4054                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4055                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4056                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4057                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4058                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4059                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4060                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4061                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4062                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4063             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4064                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4065                                           'M' '4' '5' '9' '2'.
  4066                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4067                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4068                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4069                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4070                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4071                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4072                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4073                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  76
* EL050.cbl
  4074                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4075                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4076                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4077                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4078             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4079             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4080             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4081             20  PB-CI-MEMBER-NO          PIC X(12).
  4082             20  PB-CI-INT-CODE           PIC X.
  4083                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4084                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4085             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4086             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4087             20  PB-CI-COMP-EXCP-SW       PIC X.
  4088                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4089                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4090             20  PB-CI-ENTRY-STATUS       PIC X.
  4091             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4092             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4093             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4094             20  PB-CI-DEATH-DT           PIC XX.
  4095             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4096             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4097             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4098             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4099             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4100             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4101             20  PB-CI-ENTRY-DT              PIC XX.
  4102             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4103             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4104             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4105             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4106             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4107             20  PB-CI-OLD-LOF               PIC XXX.
  4108*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4109             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4110             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4111             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4112             20  PB-CI-INDV-GRP-CD           PIC X.
  4113             20  PB-CI-BENEFICIARY-NAME.
  4114                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4115                 24  FILLER                  PIC X(15).
  4116             20  PB-CI-NOTE-SW               PIC X.
  4117             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4118             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4119             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4120             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4121             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4122             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4123             20  PB-CI-FIRST-NAME            PIC X(10).
  4124             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4125
  4126         16  FILLER                       PIC X(13).
  4127*032306  16  FILLER                       PIC X(27).
  4128*        16  FILLER                       PIC X(46).
  4129
  4130     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4131         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  77
* EL050.cbl
  4132         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4133         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4134         16  PB-M-INSURED-MID-INIT        PIC X.
  4135         16  PB-M-INSURED-AGE             PIC 99.
  4136         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4137         16  PB-M-INSURED-SEX             PIC X.
  4138         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4139         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4140         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4141         16  PB-M-INSURED-CITY-STATE.
  4142             20  PB-M-INSURED-CITY        PIC X(28).
  4143             20  PB-M-INSURED-STATE       PIC XX.
  4144         16  PB-M-INSURED-ZIP-CODE.
  4145             20  PB-M-INSURED-ZIP-PRIME.
  4146                 24  PB-M-INSURED-ZIP-1   PIC X.
  4147                     88  PB-M-CANADIAN-POST-CODE
  4148                                             VALUE 'A' THRU 'Z'.
  4149                 24  FILLER               PIC X(4).
  4150             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4151         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4152                                        PB-M-INSURED-ZIP-CODE.
  4153             20  PM-M-INS-CAN-POST1       PIC XXX.
  4154             20  PM-M-INS-CAN-POST2       PIC XXX.
  4155             20  FILLER                   PIC XXX.
  4156         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4157         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4158         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4159         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4160         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4161         16  PB-M-CRED-BENE-CITYST.
  4162             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4163             20  PB-M-CRED-BENE-STATE     PIC XX.
  4164         16  FILLER                       PIC X(92).
  4165
  4166     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4167         16  FILLER                       PIC X(10).
  4168         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4169         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4170         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4171         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4172         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4173         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4174         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4175         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4176         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4177         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4178         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4179         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4180         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4181         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4182         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4183         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4184         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4185         16  PB-ACCOUNT-NAME              PIC X(30).
  4186         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4187         16  PB-REFERENCE                 PIC X(12).
  4188         16  PB-B-RECEIVED-DT             PIC XX.
  4189         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  78
* EL050.cbl
  4190
  4191     12  PB-RECORD-STATUS.
  4192         16  PB-CREDIT-SELECT-DT          PIC XX.
  4193         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4194         16  PB-BILLED-DT                 PIC XX.
  4195         16  PB-BILLING-STATUS            PIC X.
  4196             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4197             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4198             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4199         16  PB-RECORD-BILL               PIC X.
  4200             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4201             88  PB-RECORD-RETURNED           VALUE 'R'.
  4202             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4203             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4204             88  PB-OVERRIDE-AH               VALUE 'A'.
  4205             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4206         16  PB-BATCH-ENTRY               PIC X.
  4207             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4208             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4209             88  PB-REISSUED-CERT             VALUE 'E'.
  4210             88  PB-MONTHLY-CERT              VALUE 'M'.
  4211             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4212             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4213             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4214         16  PB-FORCE-CODE                PIC X.
  4215             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4216             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4217             88  PB-CANCEL-FORCE              VALUE '8'.
  4218             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4219             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4220             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4221             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4222             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4223             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4224             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4225         16  PB-FATAL-FLAG                PIC X.
  4226             88  PB-FATAL-ERRORS              VALUE 'X'.
  4227         16  PB-FORCE-ER-CD               PIC X.
  4228             88  PB-FORCE-ERRORS              VALUE 'F'.
  4229             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4230         16  PB-WARN-ER-CD                PIC X.
  4231             88  PB-WARNING-ERRORS            VALUE 'W'.
  4232         16  FILLER                       PIC X.
  4233         16  PB-OUT-BAL-CD                PIC X.
  4234             88  PB-OUT-OF-BAL                VALUE 'O'.
  4235         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4236         16  PB-AH-OVERRIDE-L1            PIC X.
  4237         16  PB-INPUT-DT                  PIC XX.
  4238         16  PB-INPUT-BY                  PIC X(4).
  4239         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4240         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4241         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4242         16  PB-LF-EARNING-METHOD         PIC X.
  4243         16  PB-AH-EARNING-METHOD         PIC X.
  4244         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4245         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4246         16  PB-REIN-CD                   PIC XXX.
  4247         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  79
* EL050.cbl
  4248         16  PB-AH-REFUND-TYPE            PIC X.
  4249         16  PB-ACCT-EFF-DT               PIC XX.
  4250         16  PB-ACCT-EXP-DT               PIC XX.
  4251         16  PB-COMPANY-ID                PIC X(3).
  4252         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4253         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4254         16  PB-SV-CARRIER                PIC X.
  4255         16  PB-SV-GROUPING               PIC X(6).
  4256         16  PB-SV-STATE                  PIC XX.
  4257         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4258         16  PB-GA-BILLING-INFO.
  4259             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4260                                          PIC XX.
  4261         16  PB-SV-REMIT-TO  REDEFINES
  4262             PB-GA-BILLING-INFO           PIC X(10).
  4263         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4264         16  PB-I-LOAN-OFFICER            PIC X(5).
  4265         16  PB-I-VIN                     PIC X(17).
  4266
  4267         16  FILLER                       PIC X(04).
  4268         16  IMNET-BYPASS-SW              PIC X.
  4269
  4270******************************************************************
  4271*                COMMON EDIT ERRORS                              *
  4272******************************************************************
  4273
  4274     12  PB-COMMON-ERRORS.
  4275         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4276                                           PIC S9(4)     COMP.
  4277
  4278******************************************************************
  4279
  4280* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4281*    COPY ELC50W1.
  4282******************************************************************
  4283*                                                                *
  4284*                                                                *
  4285*                             ELC50W1                            *
  4286*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4287*                            VMOD=2.004                          *
  4288*                                                                *
  4289*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4290*                                                                *
  4291*                                                                *
  4292******************************************************************
  4293
  4294     12  WK-WORK-AREA.
  4295         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4296         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4297         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4298         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4299         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4300         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4301         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4302         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4303         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4304         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4305         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  80
* EL050.cbl
  4306         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4307         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4308         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4309         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4310         16  WK-CREDIT-EDIT-CONTROLS.
  4311             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4312             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4313             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4314             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4315             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4316             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4317         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4318         16  WK-SAVE-REIN-DATA.
  4319             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4320             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4321             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4322         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4323             88  ENTRY-FROM-EL6311       VALUE '6'.
  4324         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4325         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4326     12  WK-RECORD-ADDRESSES.
  4327         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4328         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4329         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4330         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4331         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4332         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4333         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4334         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4335     12  WK-OVER-SHORT-AREA.
  4336         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4337         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4338         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4339             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4340         16  FILLER                   PIC X(5) VALUE SPACES.
  4341
  4342*    COPY ELCEDITC.
  4343******************************************************************
  4344*                                                                *
  4345*                                                                *
  4346*                            ELCEDITC                            *
  4347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4348*                            VMOD=2.012                          *
  4349*                                                                *
  4350*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4351*                     EL6313, EL050 AND EL517.                   *
  4352*                                                                *
  4353******************************************************************
  4354******************************************************************
  4355*                   C H A N G E   L O G
  4356*
  4357* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4358*-----------------------------------------------------------------
  4359*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4360* EFFECTIVE    NUMBER
  4361*-----------------------------------------------------------------
  4362* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4363******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  81
* EL050.cbl
  4364
  4365     12  EDIT-CRITERIA-DATA.
  4366         16  EC-CO-MONTH-END-DT       PIC XX.
  4367         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4368         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4369         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4370         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4371         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4372         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4373         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4374         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4375         16  EC-CO-REM-TERM-CALC      PIC X.
  4376               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4377               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4378               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4379               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4380
  4381         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4382               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4383               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4384               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4385               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4386               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4387               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4388               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4389               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4390               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4391               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4392
  4393         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4394               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4395               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4396               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4397               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4398               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4399               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4400               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4401               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4402
  4403         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4404                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4405                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4406
  4407         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4408                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4409                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4410                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4411                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4412                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4413                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4414                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4415                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4416
  4417         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4418               88  EC-BR-REDUCING                   VALUE 'R'.
  4419               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4420
  4421         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  82
* EL050.cbl
  4422         16  EC-BR-LF-DESC             PIC X(10).
  4423         16  EC-BR-AH-DESC             PIC X(10).
  4424         16  EC-BR-LF-COMMENT          PIC X(10).
  4425         16  EC-BR-AH-COMMENT          PIC X(10).
  4426
  4427         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4428               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4429               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4430               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4431               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4432
  4433         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4434               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4435               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4436               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4437               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4438
  4439         16  EC-BR-LF-REFUND-CALC      PIC X.
  4440                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4441                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4442                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4443                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4444                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4445                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4446                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4447
  4448         16  EC-BR-AH-REFUND-CALC      PIC X.
  4449                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4450                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4451                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4452                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4453                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4454                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4455                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4456                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4457
  4458         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4459                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4460                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4461                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4462
  4463         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4464                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4465                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4466                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4467
  4468         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4469         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4470         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4471         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4472
  4473         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4474         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4475                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4476                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4477                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4478                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4479
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  83
* EL050.cbl
  4480         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4481               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4482               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4483               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4484               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4485               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4486
  4487         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4488               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4489               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4490               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4491               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4492               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4493
  4494         16  EC-ST-LF-REFUND-CALC      PIC X.
  4495                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4496                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4497                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4498                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4499                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4500                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4501                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4502                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4503
  4504         16  EC-ST-AH-REFUND-CALC      PIC X.
  4505                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4506                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4507                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4508                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4509                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4510                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4511                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4512                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4513
  4514         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4515         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4516         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4517         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4518         16  EC-AM-EXPIRATION-DT       PIC XX.
  4519         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4520         16  EC-AM-CLASS-CD            PIC XX.
  4521         16  EC-AM-LF-DEVIATION        PIC XXX.
  4522         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4523         16  EC-AM-AH-DEVIATION        PIC XXX.
  4524         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4525         16  EC-AM-PHONE-NO            PIC X(10).
  4526
  4527         16  EC-AM-LF-REFUND-CALC      PIC X.
  4528                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4529                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4530                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4531                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4532                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4533                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4534                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4535
  4536         16  EC-AM-AH-REFUND-CALC      PIC X.
  4537                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  84
* EL050.cbl
  4538                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4539                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4540                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4541                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4542                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4543                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4544
  4545         16  EC-AM-BEN-I-G-CD          PIC X.
  4546                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4547                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4548                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4549
  4550         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4551         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4552         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4553         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4554         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4555         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4556         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4557         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4558         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4559
  4560         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4561         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4562         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4563         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4564         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4565         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4566         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4567         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4568         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4569         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4570         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4571         16  EC-RT-LF-NSP-ST           PIC XX.
  4572         16  EC-RT-AH-NSP-ST           PIC XX.
  4573         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4574         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4575
  4576         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4577             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4578                                             'M' '5' '9' '2'.
  4579             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4580             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4581             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4582             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4583             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4584             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4585             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4586             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4587             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4588             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4589
  4590         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4591             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4592                                             'M' '5' '9' '2'.
  4593             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4594             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4595             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  85
* EL050.cbl
  4596             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4597             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4598             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4599             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4600             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4601             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4602             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4603
  4604         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4605         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4606         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4607         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4608         16  EC-CM-DEATH-DT            PIC XX.
  4609
  4610*DMD CUSTOM CODING FIELDS BELOW
  4611*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4612         16  EC-BR-DMD-RATING-SW       PIC X.
  4613                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4614                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4615                 88  NO-DMD-RATING               VALUE 'N'.
  4616
  4617         16  EC-NEW-CERT               PIC X(11).
  4618         16  EC-NEW-STATE              PIC XX.
  4619         16  FILLER                    PIC X.
  4620*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4621         16  OVER-SHORT-EDIT-FIELDS.
  4622             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4623             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4624             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4625             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4626             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4627             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4628             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4629             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4630             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4631         16  FILLER                    PIC X(71).
  4632******************************************************************
  4633
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  86
* EL050.cbl
  4635*    COPY ELCDIFRD.
  4636******************************************************************
  4637*                                                                *
  4638*                                                                *
  4639*                            ELCDIFRD.                           *
  4640*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4641*                            VMOD=2.004                          *
  4642*                                                                *
  4643*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4644*                                                                *
  4645******************************************************************
  4646*
  4647  01  WS-DIFFERENCE-CALCULATION.
  4648        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4649        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4650        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4651        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4652        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4653        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4654        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4655        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4656        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4657        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4658        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4659
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  87
* EL050.cbl
  4661****************************************************************
  4662*
  4663* Copyright (c) 2007 by Clerity Solutions, Inc.
  4664* All rights reserved.
  4665*
  4666****************************************************************
  4667 01  DFHEIV.
  4668   02  DFHEIV0               PIC X(35).
  4669   02  DFHEIV1               PIC X(08).
  4670   02  DFHEIV2               PIC X(08).
  4671   02  DFHEIV3               PIC X(08).
  4672   02  DFHEIV4               PIC X(06).
  4673   02  DFHEIV5               PIC X(04).
  4674   02  DFHEIV6               PIC X(04).
  4675   02  DFHEIV7               PIC X(02).
  4676   02  DFHEIV8               PIC X(02).
  4677   02  DFHEIV9               PIC X(01).
  4678   02  DFHEIV10              PIC S9(7) COMP-3.
  4679   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4680   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4681   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4682   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4683   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4684   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4685   02  DFHEIV17              PIC X(04).
  4686   02  DFHEIV18              PIC X(04).
  4687   02  DFHEIV19              PIC X(04).
  4688   02  DFHEIV20              USAGE IS POINTER.
  4689   02  DFHEIV21              USAGE IS POINTER.
  4690   02  DFHEIV22              USAGE IS POINTER.
  4691   02  DFHEIV23              USAGE IS POINTER.
  4692   02  DFHEIV24              USAGE IS POINTER.
  4693   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4694   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4695   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4696   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4697   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4698   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4699   02  FILLER                PIC X(02).
  4700   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4701   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4702   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4703   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4704   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4705 LINKAGE  SECTION.
  4706*****************************************************************
  4707*                                                               *
  4708* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4709* All rights reserved.                                          *
  4710*                                                               *
  4711*****************************************************************
  4712 01  dfheiblk.
  4713     02  eibtime          pic s9(7) comp-3.
  4714     02  eibdate          pic s9(7) comp-3.
  4715     02  eibtrnid         pic x(4).
  4716     02  eibtaskn         pic s9(7) comp-3.
  4717     02  eibtrmid         pic x(4).
  4718     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  88
* EL050.cbl
  4719     02  eibcposn         pic s9(4) comp.
  4720     02  eibcalen         pic s9(4) comp.
  4721     02  eibaid           pic x(1).
  4722     02  eibfiller1       pic x(1).
  4723     02  eibfn            pic x(2).
  4724     02  eibfiller2       pic x(2).
  4725     02  eibrcode         pic x(6).
  4726     02  eibfiller3       pic x(2).
  4727     02  eibds            pic x(8).
  4728     02  eibreqid         pic x(8).
  4729     02  eibrsrce         pic x(8).
  4730     02  eibsync          pic x(1).
  4731     02  eibfree          pic x(1).
  4732     02  eibrecv          pic x(1).
  4733     02  eibsend          pic x(1).
  4734     02  eibatt           pic x(1).
  4735     02  eibeoc           pic x(1).
  4736     02  eibfmh           pic x(1).
  4737     02  eibcompl         pic x(1).
  4738     02  eibsig           pic x(1).
  4739     02  eibconf          pic x(1).
  4740     02  eiberr           pic x(1).
  4741     02  eibrldbk         pic x(1).
  4742     02  eiberrcd         pic x(4).
  4743     02  eibsynrb         pic x(1).
  4744     02  eibnodat         pic x(1).
  4745     02  eibfiller5       pic x(2).
  4746     02  eibresp          pic 9(09) comp.
  4747     02  eibresp2         pic 9(09) comp.
  4748     02  dfheigdj         pic s9(4) comp.
  4749     02  dfheigdk         pic s9(4) comp.
  4750
  4751 01  DFHCOMMAREA                   PIC X(1036).
  4752
  4753*01 PARMLIST .
  4754*    02  FILLER                    PIC S9(8)   COMP.
  4755*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4756*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4757*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4758*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4759*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4760*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4761*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4762
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  89
* EL050.cbl
  4764*    COPY ELCCNTL.
  4765******************************************************************
  4766*                                                                *
  4767*                                                                *
  4768*                            ELCCNTL.                            *
  4769*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4770*                            VMOD=2.059                          *
  4771*                                                                *
  4772*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4773*                                                                *
  4774*   FILE TYPE = VSAM,KSDS                                        *
  4775*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4776*                                                                *
  4777*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4778*       ALTERNATE INDEX = NONE                                   *
  4779*                                                                *
  4780*   LOG = YES                                                    *
  4781*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4782******************************************************************
  4783*                   C H A N G E   L O G
  4784*
  4785* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4786*-----------------------------------------------------------------
  4787*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4788* EFFECTIVE    NUMBER
  4789*-----------------------------------------------------------------
  4790* 082503                   PEMA  ADD BENEFIT GROUP
  4791* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4792* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4793* 092705    2005050300006  PEMA  ADD SPP LEASES
  4794* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4795* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4796* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4797* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4798* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4799******************************************************************
  4800*
  4801 01  CONTROL-FILE.
  4802     12  CF-RECORD-ID                       PIC XX.
  4803         88  VALID-CF-ID                        VALUE 'CF'.
  4804
  4805     12  CF-CONTROL-PRIMARY.
  4806         16  CF-COMPANY-ID                  PIC XXX.
  4807         16  CF-RECORD-TYPE                 PIC X.
  4808             88  CF-COMPANY-MASTER              VALUE '1'.
  4809             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4810             88  CF-STATE-MASTER                VALUE '3'.
  4811             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4812             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4813             88  CF-CARRIER-MASTER              VALUE '6'.
  4814             88  CF-MORTALITY-MASTER            VALUE '7'.
  4815             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4816             88  CF-TERMINAL-MASTER             VALUE '9'.
  4817             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4818             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4819             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4820             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4821             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  90
* EL050.cbl
  4822             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4823             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4824             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4825             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4826         16  CF-ACCESS-CD-GENL              PIC X(4).
  4827         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4828             20  CF-PROCESSOR               PIC X(4).
  4829         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4830             20  CF-STATE-CODE              PIC XX.
  4831             20  FILLER                     PIC XX.
  4832         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4833             20  FILLER                     PIC XX.
  4834             20  CF-HI-BEN-IN-REC           PIC XX.
  4835         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4836             20  FILLER                     PIC XXX.
  4837             20  CF-CARRIER-CNTL            PIC X.
  4838         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4839             20  FILLER                     PIC XX.
  4840             20  CF-HI-TYPE-IN-REC          PIC 99.
  4841         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4842             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4843                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4844             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4845             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4846         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4847             20  FILLER                     PIC X.
  4848             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4849         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4850             20  FILLER                     PIC XX.
  4851             20  CF-MORTGAGE-PLAN           PIC XX.
  4852         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4853
  4854     12  CF-LAST-MAINT-DT                   PIC XX.
  4855     12  CF-LAST-MAINT-BY                   PIC X(4).
  4856     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4857
  4858     12  CF-RECORD-BODY                     PIC X(728).
  4859
  4860
  4861****************************************************************
  4862*             COMPANY MASTER RECORD                            *
  4863****************************************************************
  4864
  4865     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4866         16  CF-COMPANY-ADDRESS.
  4867             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4868             20  CF-CL-IN-CARE-OF           PIC X(30).
  4869             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4870             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4871             20  CF-CL-CITY-STATE           PIC X(30).
  4872             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4873             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4874         16  CF-COMPANY-CD                  PIC X.
  4875         16  CF-COMPANY-PASSWORD            PIC X(8).
  4876         16  CF-SECURITY-OPTION             PIC X.
  4877             88  ALL-SECURITY                   VALUE '1'.
  4878             88  COMPANY-VERIFY                 VALUE '2'.
  4879             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  91
* EL050.cbl
  4880             88  NO-SECURITY                    VALUE '4'.
  4881             88  ALL-BUT-TERM                   VALUE '5'.
  4882         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4883             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4884         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4885             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4886         16  CF-INFORCE-LOCATION            PIC X.
  4887             88  CERTS-ARE-ONLINE               VALUE '1'.
  4888             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4889             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4890         16  CF-LOWER-CASE-LETTERS          PIC X.
  4891         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4892             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4893             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4894             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4895             88  CF-ACCNT-CNTL                  VALUE '3'.
  4896             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4897
  4898         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4899         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4900
  4901         16  CF-LGX-CREDIT-USER             PIC X.
  4902             88  CO-IS-NOT-USER                 VALUE 'N'.
  4903             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4904
  4905         16 CF-CREDIT-CALC-CODES.
  4906             20  CF-CR-REM-TERM-CALC PIC X.
  4907               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4908               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4909               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4910               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4911               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4912               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4913               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4914             20  CF-CR-R78-METHOD           PIC X.
  4915               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4916               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4917
  4918         16  CF-CLAIM-CONTROL-COUNTS.
  4919             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4920                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4921
  4922             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4923                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4924
  4925             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4926                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4927
  4928             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4929                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4930
  4931         16  CF-CURRENT-MONTH-END           PIC XX.
  4932
  4933         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4934             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4935             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4936             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4937             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  92
* EL050.cbl
  4938                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4939                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4940             20  CF-CO-PREM-REJECT-SW       PIC X.
  4941                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4942                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4943             20  CF-CO-REF-REJECT-SW        PIC X.
  4944                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4945                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4946
  4947         16  CF-CO-REPORTING-DT             PIC XX.
  4948         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4949         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4950           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4951           88  CF-CO-MONTH-END                  VALUE '1'.
  4952
  4953         16  CF-LGX-CLAIM-USER              PIC X.
  4954             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4955             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4956
  4957         16  CF-CREDIT-EDIT-CONTROLS.
  4958             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4959             20  CF-MIN-AGE                 PIC 99.
  4960             20  CF-DEFAULT-AGE             PIC 99.
  4961             20  CF-MIN-TERM                PIC S999      COMP-3.
  4962             20  CF-MAX-TERM                PIC S999      COMP-3.
  4963             20  CF-DEFAULT-SEX             PIC X.
  4964             20  CF-JOINT-AGE-INPUT         PIC X.
  4965                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4966             20  CF-BIRTH-DATE-INPUT        PIC X.
  4967                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4968             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4969                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4970                 88  CF-ZERO-CARRIER            VALUE '1'.
  4971                 88  CF-ZERO-GROUPING           VALUE '2'.
  4972                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4973             20  CF-EDIT-SW                 PIC X.
  4974                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4975             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4976             20  CF-CR-PR-METHOD            PIC X.
  4977               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4978               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4979             20  FILLER                     PIC X.
  4980
  4981         16  CF-CREDIT-MISC-CONTROLS.
  4982             20  CF-REIN-TABLE-SW           PIC X.
  4983                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4984             20  CF-COMP-TABLE-SW           PIC X.
  4985                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4986             20  CF-EXPERIENCE-RETENTION-AGE
  4987                                            PIC S9        COMP-3.
  4988             20  CF-CONVERSION-DT           PIC XX.
  4989             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4990             20  CF-RUN-FREQUENCY-SW        PIC X.
  4991                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4992                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4993
  4994             20  CF-CR-CHECK-NO-CONTROL.
  4995                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  93
* EL050.cbl
  4996                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4997                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4998                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4999                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5000                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5001
  5002                 24  CF-CR-CHECK-COUNT       REDEFINES
  5003                     CF-CR-CHECK-COUNTER      PIC X(4).
  5004
  5005                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5006                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5007
  5008                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5009                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5010                 24  CF-MAIL-PROCESSING       PIC X.
  5011                     88  MAIL-PROCESSING          VALUE 'Y'.
  5012
  5013         16  CF-MISC-SYSTEM-CONTROL.
  5014             20  CF-SYSTEM-C                 PIC X.
  5015                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5016             20  CF-SYSTEM-D                 PIC X.
  5017                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5018             20  CF-SOC-SEC-NO-SW            PIC X.
  5019                 88  SOC-SEC-NO-USED             VALUE '1'.
  5020             20  CF-MEMBER-NO-SW             PIC X.
  5021                 88  MEMBER-NO-USED              VALUE '1'.
  5022             20  CF-TAX-ID-NUMBER            PIC X(11).
  5023             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5024             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5025                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5026                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5027                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5028                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5029             20  CF-SYSTEM-E                 PIC X.
  5030                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5031
  5032         16  CF-LGX-LIFE-USER               PIC X.
  5033             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5034             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5035
  5036         16  CF-CR-MONTH-END-DT             PIC XX.
  5037
  5038         16  CF-FILE-MAINT-DATES.
  5039             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5040                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5041             20  CF-LAST-BATCH       REDEFINES
  5042                 CF-LAST-BATCH-NO               PIC X(4).
  5043             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5044             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5045             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5046             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5047             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5048             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5049             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5050             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5051             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5052             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5053
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  94
* EL050.cbl
  5054         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5055         16  FILLER                         PIC X.
  5056
  5057         16  CF-ALT-MORT-CODE               PIC X(4).
  5058         16  CF-MEMBER-CAPTION              PIC X(10).
  5059
  5060         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5061             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5062             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5063             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5064             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5065             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5066
  5067         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5068
  5069         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5070         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5071         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5072         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5073
  5074         16  CF-AH-OVERRIDE-L1              PIC X.
  5075         16  CF-AH-OVERRIDE-L2              PIC XX.
  5076         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5077         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5078
  5079         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5080         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5081
  5082         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5083         16  CF-AR-LAST-EL860-DT            PIC XX.
  5084         16  CF-MP-MONTH-END-DT             PIC XX.
  5085
  5086         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5087         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5088             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5089
  5090         16  CF-AR-MONTH-END-DT             PIC XX.
  5091
  5092         16  CF-CRDTCRD-USER                PIC X.
  5093             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5094             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5095
  5096         16  CF-CC-MONTH-END-DT             PIC XX.
  5097
  5098         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5099
  5100         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5101             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5102             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5103             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5104         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5105         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5106         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5107         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5108             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5109             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5110         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5111         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  95
* EL050.cbl
  5112         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5113             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5114         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5115
  5116         16  CF-CL-ZIP-CODE.
  5117             20  CF-CL-ZIP-PRIME.
  5118                 24  CF-CL-ZIP-1ST          PIC X.
  5119                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5120                 24  FILLER                 PIC X(4).
  5121             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5122         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5123             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5124             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5125             20  FILLER                     PIC XXX.
  5126
  5127         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5128         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5129         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5130         16  CF-CO-OPTION-START-DATE        PIC XX.
  5131         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5132           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5133                                                      '3' '4'.
  5134           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5135           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5136           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5137           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5138           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5139           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5140
  5141         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5142
  5143         16  CF-PAYMENT-APPROVAL-LEVELS.
  5144             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5145             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5146             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5147             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5148             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5149             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5150
  5151         16  CF-END-USER-REPORTING-USER     PIC X.
  5152             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5153             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5154
  5155         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5156             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5157             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5158
  5159         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5160
  5161         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5162         16  FILLER                         PIC X.
  5163
  5164         16  CF-CREDIT-ARCHIVE-CNTL.
  5165             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5166             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5167             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5168
  5169         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  96
* EL050.cbl
  5170
  5171         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5172             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5173             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5174
  5175         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5176             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5177             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5178
  5179         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5180
  5181         16  CF-CO-ACH-ID-CODE              PIC  X.
  5182             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5183             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5184             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5185         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5186         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5187         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5188         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5189         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5190         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5191         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5192         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5193         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5194                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5195         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5196                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5197
  5198         16  CF-CO-OVER-SHORT.
  5199             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5200             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5201
  5202*         16  FILLER                         PIC X(102).
  5203         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5204             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5205             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5206
  5207         16  CF-AH-APPROVAL-DAYS.
  5208             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5209             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5210             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5211             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5212
  5213         16  FILLER                         PIC X(82).
  5214****************************************************************
  5215*             PROCESSOR/USER RECORD                            *
  5216****************************************************************
  5217
  5218     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5219         16  CF-PROCESSOR-NAME              PIC X(30).
  5220         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5221         16  CF-PROCESSOR-TITLE             PIC X(26).
  5222         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5223                 88  MESSAGE-YES                VALUE 'Y'.
  5224                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5225
  5226*****************************************************
  5227****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  97
* EL050.cbl
  5228****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5229****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5230****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5231*****************************************************
  5232
  5233         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5234             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5235             20  CF-APPLICATION-FORCE       PIC X.
  5236             20  CF-INDIVIDUAL-APP.
  5237                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5238                     28  CF-BROWSE-APP      PIC X.
  5239                     28  CF-UPDATE-APP      PIC X.
  5240
  5241         16  CF-CURRENT-TERM-ON             PIC X(4).
  5242         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5243             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5244             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5245             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5246             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5247             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5248             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5249             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5250         16  CF-PROCESSOR-CARRIER           PIC X.
  5251             88  NO-CARRIER-SECURITY            VALUE ' '.
  5252         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5253             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5254         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5255             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5256         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5257             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5258
  5259         16  CF-PROC-SYS-ACCESS-SW.
  5260             20  CF-PROC-CREDIT-CLAIMS-SW.
  5261                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5262                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5263                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5264                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5265             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5266                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5267                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5268             20  CF-PROC-LIFE-GNRLDGR-SW.
  5269                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5270                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5271                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5272                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5273             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5274                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5275                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5276         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5277             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5278             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5279         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5280
  5281         16  CF-APPROVAL-LEVEL                  PIC X.
  5282             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5283             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5284             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5285             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  98
* EL050.cbl
  5286
  5287         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5288
  5289         16  CF-LANGUAGE-TYPE                   PIC X.
  5290             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5291             88  CF-LANG-IS-FR                      VALUE 'F'.
  5292         16  FILLER                             PIC  X(240).
  5293
  5294****************************************************************
  5295*             PROCESSOR/REMINDERS RECORD                       *
  5296****************************************************************
  5297
  5298     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5299         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5300             20  CF-START-REMIND-DT         PIC XX.
  5301             20  CF-END-REMIND-DT           PIC XX.
  5302             20  CF-REMINDER-TEXT           PIC X(50).
  5303         16  FILLER                         PIC X(296).
  5304
  5305
  5306****************************************************************
  5307*             STATE MASTER RECORD                              *
  5308****************************************************************
  5309
  5310     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5311         16  CF-STATE-ABBREVIATION          PIC XX.
  5312         16  CF-STATE-NAME                  PIC X(25).
  5313         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5314         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5315             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5316             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5317             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5318             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5319                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5320                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5321             20  CF-ST-PREM-REJECT-SW       PIC X.
  5322                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5323                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5324             20  CF-ST-REF-REJECT-SW        PIC X.
  5325                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5326                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5327         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5328         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5329         16  CF-ST-REFUND-RULES.
  5330             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5331             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5332             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5333         16  CF-ST-FST-PMT-EXTENSION.
  5334             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5335             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5336                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5337                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5338                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5339                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5340         16  CF-ST-STATE-CALL.
  5341             20  CF-ST-CALL-UNEARNED        PIC X.
  5342             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5343             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page  99
* EL050.cbl
  5344         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5345             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5346             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5347         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5348         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5349         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5350         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5351         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5352         16  FILLER                         PIC X.
  5353         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5354             20  CF-ST-BENEFIT-CD           PIC XX.
  5355             20  CF-ST-BENEFIT-KIND         PIC X.
  5356                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5357                 88  CF-ST-AH-KIND              VALUE 'A'.
  5358             20  CF-ST-REM-TERM-CALC        PIC X.
  5359                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5360                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5361                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5362                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5363                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5364                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5365                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5366                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5367
  5368             20  CF-ST-REFUND-CALC          PIC X.
  5369                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5370                 88  ST-REFD-BY-R78             VALUE '1'.
  5371                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5372                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5373                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5374                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5375                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5376                 88  ST-REFD-UTAH               VALUE '7'.
  5377                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5378                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5379                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5380
  5381             20  CF-ST-EARNING-CALC         PIC X.
  5382                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5383                 88  ST-EARN-BY-R78             VALUE '1'.
  5384                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5385                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5386                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5387                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5388                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5389                 88  ST-EARN-MEAN               VALUE '8'.
  5390                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5391
  5392             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5393                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5394                 88  ST-OVRD-BY-R78             VALUE '1'.
  5395                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5396                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5397                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5398                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5399                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5400                 88  ST-OVRD-MEAN               VALUE '8'.
  5401                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 100
* EL050.cbl
  5402             20  FILLER                     PIC X.
  5403
  5404         16  CF-ST-COMMISSION-CAPS.
  5405             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5406             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5407             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5408             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5409         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5410                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5411
  5412         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5413
  5414         16  CF-ST-STATUTORY-INTEREST.
  5415             20  CF-ST-STAT-DATE-FROM       PIC X.
  5416                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5417                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5418             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5419             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5420             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5421             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5422             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5423
  5424         16  CF-ST-OVER-SHORT.
  5425             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5426             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5427
  5428         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5429
  5430         16  CF-ST-RT-CALC                  PIC X.
  5431
  5432         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5433         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5434         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5435         16  CF-ST-RF-LR-CALC               PIC X.
  5436         16  CF-ST-RF-LL-CALC               PIC X.
  5437         16  CF-ST-RF-LN-CALC               PIC X.
  5438         16  CF-ST-RF-AH-CALC               PIC X.
  5439         16  CF-ST-RF-CP-CALC               PIC X.
  5440*        16  FILLER                         PIC X(206).
  5441*CIDMOD         16  FILLER                         PIC X(192).
  5442         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5443             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5444         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5445         16  CF-ST-VFY-2ND-BENE             PIC X.
  5446         16  FILLER                         PIC X(186).
  5447
  5448****************************************************************
  5449*             BENEFIT MASTER RECORD                            *
  5450****************************************************************
  5451
  5452     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5453         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5454             20  CF-BENEFIT-CODE            PIC XX.
  5455             20  CF-BENEFIT-NUMERIC  REDEFINES
  5456                 CF-BENEFIT-CODE            PIC XX.
  5457             20  CF-BENEFIT-ALPHA           PIC XXX.
  5458             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5459             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 101
* EL050.cbl
  5460
  5461             20  CF-LF-COVERAGE-TYPE        PIC X.
  5462                 88  CF-REDUCING                VALUE 'R'.
  5463                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5464
  5465             20  CF-SPECIAL-CALC-CD         PIC X.
  5466                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5467                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5468                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5469                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5470                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5471                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5472                 88  CF-FARM-PLAN               VALUE 'F'.
  5473                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5474                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5475                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5476                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5477                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5478                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5479                 88  CF-PRUDENTIAL              VALUE 'P'.
  5480                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5481                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5482                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5483                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5484                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5485                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5486
  5487             20  CF-JOINT-INDICATOR         PIC X.
  5488                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5489
  5490*            20  FILLER                     PIC X(12).
  5491             20  FILLER                     PIC X(11).
  5492             20  CF-BENEFIT-CATEGORY        PIC X.
  5493             20  CF-LOAN-TYPE               PIC X(8).
  5494
  5495             20  CF-CO-REM-TERM-CALC        PIC X.
  5496                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5497                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5498                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5499                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5500                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5501
  5502             20  CF-CO-EARNINGS-CALC        PIC X.
  5503                 88  CO-EARN-BY-R78             VALUE '1'.
  5504                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5505                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5506                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5507                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5508                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5509                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5510                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5511
  5512             20  CF-CO-REFUND-CALC          PIC X.
  5513                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5514                 88  CO-REFD-BY-R78             VALUE '1'.
  5515                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5516                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5517                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 102
* EL050.cbl
  5518                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5519                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5520                 88  CO-REFD-MEAN               VALUE '8'.
  5521                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5522                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5523                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5524
  5525             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5526                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5527                 88  CO-OVRD-BY-R78             VALUE '1'.
  5528                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5529                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5530                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5531                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5532                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5533                 88  CO-OVRD-MEAN               VALUE '8'.
  5534                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5535
  5536             20  CF-CO-BEN-I-G-CD           PIC X.
  5537                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5538                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5539                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5540
  5541         16  FILLER                         PIC X(304).
  5542
  5543
  5544****************************************************************
  5545*             CARRIER MASTER RECORD                            *
  5546****************************************************************
  5547
  5548     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5549         16  CF-ADDRESS-DATA.
  5550             20  CF-MAIL-TO-NAME            PIC X(30).
  5551             20  CF-IN-CARE-OF              PIC X(30).
  5552             20  CF-ADDRESS-LINE-1          PIC X(30).
  5553             20  CF-ADDRESS-LINE-2          PIC X(30).
  5554             20  CF-CITY-STATE              PIC X(30).
  5555             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5556             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5557
  5558         16  CF-CLAIM-NO-CONTROL.
  5559             20  CF-CLAIM-NO-METHOD         PIC X.
  5560                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5561                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5562                 88  CLAIM-NO-SEQ               VALUE '3'.
  5563                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5564             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5565                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5566                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5567                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5568
  5569         16  CF-CHECK-NO-CONTROL.
  5570             20  CF-CHECK-NO-METHOD         PIC X.
  5571                 88  CHECK-NO-MANUAL            VALUE '1'.
  5572                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5573                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5574                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5575             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 103
* EL050.cbl
  5576                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5577
  5578         16  CF-DOMICILE-STATE              PIC XX.
  5579
  5580         16  CF-EXPENSE-CONTROLS.
  5581             20  CF-EXPENSE-METHOD          PIC X.
  5582                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5583                 88  DOLLARS-PER-PMT            VALUE '2'.
  5584                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5585                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5586             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5587             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5588
  5589         16  CF-CORRESPONDENCE-CONTROL.
  5590             20  CF-LETTER-RESEND-OPT       PIC X.
  5591                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5592                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5593             20  FILLER                     PIC X(4).
  5594
  5595         16  CF-RESERVE-CONTROLS.
  5596             20  CF-MANUAL-SW               PIC X.
  5597                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5598             20  CF-FUTURE-SW               PIC X.
  5599                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5600             20  CF-PTC-SW                  PIC X.
  5601                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5602             20  CF-IBNR-SW                 PIC X.
  5603                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5604             20  CF-PTC-LF-SW               PIC X.
  5605                 88  CF-LF-PTC-USED             VALUE '1'.
  5606             20  CF-CDT-ACCESS-METHOD       PIC X.
  5607                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5608                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5609                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5610             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5611
  5612         16  CF-CLAIM-CALC-METHOD           PIC X.
  5613             88  360-PLUS-MONTHS                VALUE '1'.
  5614             88  365-PLUS-MONTHS                VALUE '2'.
  5615             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5616             88  360-DAILY                      VALUE '4'.
  5617             88  365-DAILY                      VALUE '5'.
  5618
  5619         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5620         16  FILLER                         PIC X(11).
  5621
  5622         16  CF-LIMIT-AMOUNTS.
  5623             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5624             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5625             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5626             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5627             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5628             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5629             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5630             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5631             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5632             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5633
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 104
* EL050.cbl
  5634         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5635         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5636         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5637
  5638         16  CF-ZIP-CODE.
  5639             20  CF-ZIP-PRIME.
  5640                 24  CF-ZIP-1ST             PIC X.
  5641                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5642                 24  FILLER                 PIC X(4).
  5643             20  CF-ZIP-PLUS4               PIC X(4).
  5644         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5645             20  CF-CAN-POSTAL-1            PIC XXX.
  5646             20  CF-CAN-POSTAL-2            PIC XXX.
  5647             20  FILLER                     PIC XXX.
  5648
  5649         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5650         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5651         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5652
  5653         16  CF-RATING-SWITCH               PIC X.
  5654             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5655             88  CF-NO-RATING                   VALUE 'N'.
  5656
  5657         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5658
  5659         16  CF-CARRIER-OVER-SHORT.
  5660             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5661             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5662
  5663         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5664         16  CF-SECPAY-SWITCH               PIC X.
  5665             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5666             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5667         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5668         16  FILLER                         PIC X(448).
  5669*        16  FILLER                         PIC X(452).
  5670
  5671
  5672****************************************************************
  5673*             MORTALITY MASTER RECORD                          *
  5674****************************************************************
  5675
  5676     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5677         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5678                                INDEXED BY CF-MORT-NDX.
  5679             20  CF-MORT-TABLE              PIC X(5).
  5680             20  CF-MORT-TABLE-TYPE         PIC X.
  5681                 88  CF-MORT-JOINT              VALUE 'J'.
  5682                 88  CF-MORT-SINGLE             VALUE 'S'.
  5683                 88  CF-MORT-COMBINED           VALUE 'C'.
  5684                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5685                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5686             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5687             20  CF-MORT-AGE-METHOD         PIC XX.
  5688                 88  CF-AGE-LAST                VALUE 'AL'.
  5689                 88  CF-AGE-NEAR                VALUE 'AN'.
  5690             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5691             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 105
* EL050.cbl
  5692                                            PIC X.
  5693                 88  CF-MINUS                   VALUE '-'.
  5694                 88  CF-PLUS                    VALUE '+'.
  5695             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5696             20  CF-MORT-JOINT-CODE         PIC X.
  5697                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5698             20  CF-MORT-PC-Q               PIC X.
  5699                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5700             20  CF-MORT-TABLE-CODE         PIC X(4).
  5701             20  CF-MORT-COMMENTS           PIC X(15).
  5702             20  FILLER                     PIC X(14).
  5703
  5704         16  FILLER                         PIC X(251).
  5705
  5706
  5707****************************************************************
  5708*             BUSSINESS TYPE MASTER RECORD                     *
  5709****************************************************************
  5710
  5711     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5712* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5713* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5714* AND RECORD 05 IS TYPES 81-99
  5715         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5716             20  CF-BUSINESS-TITLE          PIC  X(19).
  5717             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5718                                            PIC S9V9(4) COMP-3.
  5719             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5720             20  FILLER                     PIC  X.
  5721         16  FILLER                         PIC  X(248).
  5722
  5723
  5724****************************************************************
  5725*             TERMINAL MASTER RECORD                           *
  5726****************************************************************
  5727
  5728     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5729
  5730         16  CF-COMPANY-TERMINALS.
  5731             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5732                                  PIC X(4).
  5733         16  FILLER               PIC X(248).
  5734
  5735
  5736****************************************************************
  5737*             LIFE EDIT MASTER RECORD                          *
  5738****************************************************************
  5739
  5740     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5741         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5742             20  CF-LIFE-CODE-IN            PIC XX.
  5743             20  CF-LIFE-CODE-OUT           PIC XX.
  5744         16  FILLER                         PIC X(248).
  5745
  5746
  5747****************************************************************
  5748*             AH EDIT MASTER RECORD                            *
  5749****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 106
* EL050.cbl
  5750
  5751     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5752         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5753             20  CF-AH-CODE-IN              PIC XXX.
  5754             20  CF-AH-CODE-OUT             PIC XX.
  5755         16  FILLER                         PIC X(248).
  5756
  5757
  5758****************************************************************
  5759*             CREDIBILITY TABLES                               *
  5760****************************************************************
  5761
  5762     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5763         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5764                             INDEXED BY CF-CRDB-NDX.
  5765             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5766             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5767             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5768         16  FILLER                         PIC  X(332).
  5769
  5770
  5771****************************************************************
  5772*             REPORT CUSTOMIZATION RECORD                      *
  5773****************************************************************
  5774
  5775     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5776         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5777             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5778             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5779             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5780**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5781****       A T-TRANSFER.                                   ****
  5782             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5783
  5784         16  FILLER                         PIC XX.
  5785
  5786         16  CF-CARRIER-CNTL-OPT.
  5787             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5788                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5789                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5790             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5791                                            PIC X.
  5792         16  CF-GROUP-CNTL-OPT.
  5793             20  CF-GROUP-OPT-SEQ           PIC 9.
  5794                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5795                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5796             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5797                                            PIC X(6).
  5798         16  CF-STATE-CNTL-OPT.
  5799             20  CF-STATE-OPT-SEQ           PIC 9.
  5800                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5801                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5802             20  CF-STATE-SELECT OCCURS 3 TIMES
  5803                                            PIC XX.
  5804         16  CF-ACCOUNT-CNTL-OPT.
  5805             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5806                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5807                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 107
* EL050.cbl
  5808             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5809                                            PIC X(10).
  5810         16  CF-BUS-TYP-CNTL-OPT.
  5811             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5812                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5813                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5814             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5815                                            PIC XX.
  5816         16  CF-LF-TYP-CNTL-OPT.
  5817             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5818                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5819                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5820             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5821                                            PIC XX.
  5822         16  CF-AH-TYP-CNTL-OPT.
  5823             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5824                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5825                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5826             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5827                                            PIC XX.
  5828         16  CF-REPTCD1-CNTL-OPT.
  5829             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5830                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5831                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5832             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5833                                            PIC X(10).
  5834         16  CF-REPTCD2-CNTL-OPT.
  5835             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5836                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5837                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5838             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5839                                            PIC X(10).
  5840         16  CF-USER1-CNTL-OPT.
  5841             20  CF-USER1-OPT-SEQ           PIC 9.
  5842                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5843                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5844             20  CF-USER1-SELECT OCCURS 3 TIMES
  5845                                            PIC X(10).
  5846         16  CF-USER2-CNTL-OPT.
  5847             20  CF-USER2-OPT-SEQ           PIC 9.
  5848                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5849                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5850             20  CF-USER2-SELECT OCCURS 3 TIMES
  5851                                            PIC X(10).
  5852         16  CF-USER3-CNTL-OPT.
  5853             20  CF-USER3-OPT-SEQ           PIC 9.
  5854                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5855                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5856             20  CF-USER3-SELECT OCCURS 3 TIMES
  5857                                            PIC X(10).
  5858         16  CF-USER4-CNTL-OPT.
  5859             20  CF-USER4-OPT-SEQ           PIC 9.
  5860                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5861                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5862             20  CF-USER4-SELECT OCCURS 3 TIMES
  5863                                            PIC X(10).
  5864         16  CF-USER5-CNTL-OPT.
  5865             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 108
* EL050.cbl
  5866                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5867                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5868             20  CF-USER5-SELECT OCCURS 3 TIMES
  5869                                            PIC X(10).
  5870         16  CF-REINS-CNTL-OPT.
  5871             20  CF-REINS-OPT-SEQ           PIC 9.
  5872                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5873                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5874             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5875                 24  CF-REINS-PRIME         PIC XXX.
  5876                 24  CF-REINS-SUB           PIC XXX.
  5877
  5878         16  CF-AGENT-CNTL-OPT.
  5879             20  CF-AGENT-OPT-SEQ           PIC 9.
  5880                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5881                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5882             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5883                                            PIC X(10).
  5884
  5885         16  FILLER                         PIC X(43).
  5886
  5887         16  CF-LOSS-RATIO-SELECT.
  5888             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5889             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5890         16  CF-ENTRY-DATE-SELECT.
  5891             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5892             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5893         16  CF-EFFECTIVE-DATE-SELECT.
  5894             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5895             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5896
  5897         16  CF-EXCEPTION-LIST-IND          PIC X.
  5898             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5899
  5900         16  FILLER                         PIC X(318).
  5901
  5902****************************************************************
  5903*                  EXCEPTION REPORTING RECORD                  *
  5904****************************************************************
  5905
  5906     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5907         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5908             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5909
  5910         16  CF-COMBINED-LIFE-AH-OPT.
  5911             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5912             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5913             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5914             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5915
  5916         16  CF-LIFE-OPT.
  5917             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5918             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5919             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5920             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5921             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5922             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5923             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 109
* EL050.cbl
  5924             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5925             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5926             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5927
  5928         16  CF-AH-OPT.
  5929             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5930             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5931             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5932             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5933             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5934             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5935             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5936             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5937             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5938             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5939
  5940         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5941             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5942             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5943             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5944
  5945         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5946
  5947         16  FILLER                         PIC X(673).
  5948
  5949
  5950****************************************************************
  5951*             MORTGAGE SYSTEM PLAN RECORD                      *
  5952****************************************************************
  5953
  5954     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5955         16  CF-PLAN-TYPE                   PIC X.
  5956             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5957             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5958             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5959         16  CF-PLAN-ABBREV                 PIC XXX.
  5960         16  CF-PLAN-DESCRIPT               PIC X(10).
  5961         16  CF-PLAN-NOTES                  PIC X(20).
  5962         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5963         16  CF-PLAN-UNDERWRITING.
  5964             20  CF-PLAN-TERM-DATA.
  5965                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5966                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5967             20  CF-PLAN-AGE-DATA.
  5968                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5969                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5970                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5971             20  CF-PLAN-BENEFIT-DATA.
  5972                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5973                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5974                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5975                                            PIC S9(7)V99  COMP-3.
  5976         16  CF-PLAN-POLICY-FORMS.
  5977             20  CF-POLICY-FORM             PIC X(12).
  5978             20  CF-MASTER-APPLICATION      PIC X(12).
  5979             20  CF-MASTER-POLICY           PIC X(12).
  5980         16  CF-PLAN-RATING.
  5981             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 110
* EL050.cbl
  5982             20  CF-SEX-RATING              PIC X.
  5983                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5984                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5985             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5986             20  CF-SUB-STD-TYPE            PIC X.
  5987                 88  CF-PCT-OF-PREM            VALUE '1'.
  5988                 88  CF-PCT-OF-BENE            VALUE '2'.
  5989         16  CF-PLAN-PREM-TOLERANCES.
  5990             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5991             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5992         16  CF-PLAN-PYMT-TOLERANCES.
  5993             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5994             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5995         16  CF-PLAN-MISC-DATA.
  5996             20  FILLER                     PIC X.
  5997             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5998             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5999         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6000         16  CF-PLAN-IND-GRP                PIC X.
  6001             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6002                                                     '1'.
  6003             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6004                                                     '2'.
  6005         16  CF-MIB-SEARCH-SW               PIC X.
  6006             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6007             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6008             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6009             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6010         16  CF-ALPHA-SEARCH-SW             PIC X.
  6011             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6012             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6013             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6014             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6015             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6016             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6017             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6018             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6019             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6020             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6021                                                     'A' 'B' 'C'
  6022                                                     'X' 'Y' 'Z'.
  6023         16  CF-EFF-DT-RULE-SW              PIC X.
  6024             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6025             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6026             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6027             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6028             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6029         16  FILLER                         PIC X(4).
  6030         16  CF-HEALTH-QUESTIONS            PIC X.
  6031             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6032         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6033         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6034         16  CF-PLAN-SNGL-JNT               PIC X.
  6035             88  CF-COMBINED-PLAN              VALUE 'C'.
  6036             88  CF-JNT-PLAN                   VALUE 'J'.
  6037             88  CF-SNGL-PLAN                  VALUE 'S'.
  6038         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6039         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 111
* EL050.cbl
  6040         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6041         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6042         16  CF-RERATE-CNTL                 PIC  X.
  6043             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6044             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6045             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6046             88  CF-AUTO-RECALC                 VALUE '4'.
  6047         16  CF-BENEFIT-TYPE                PIC  X.
  6048             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6049             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6050         16  CF-POLICY-FEE                  PIC S999V99
  6051                                                    COMP-3.
  6052         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6053         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6054         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6055         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6056         16  FILLER                         PIC  X(32).
  6057         16  CF-TERMINATION-FORM            PIC  X(04).
  6058         16  FILLER                         PIC  X(08).
  6059         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6060                                                       COMP-3.
  6061         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6062         16  CF-ISSUE-LETTER                PIC  X(4).
  6063         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6064         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6065             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6066             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6067         16  CF-MP-REFUND-CALC              PIC X.
  6068             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6069             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6070             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6071             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6072             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6073             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6074             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6075             88  CF-MP-REFD-MEAN                VALUE '8'.
  6076         16  CF-ALT-RATE-CODE               PIC  X(5).
  6077
  6078
  6079         16  FILLER                         PIC X(498).
  6080****************************************************************
  6081*             MORTGAGE COMPANY MASTER RECORD                   *
  6082****************************************************************
  6083
  6084     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6085         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6086         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6087             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6088             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6089             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6090             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6091             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6092
  6093         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6094         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6095         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6096         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6097         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 112
* EL050.cbl
  6098
  6099         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6100             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6101         16  CF-MP-RECON-USE-IND            PIC X(1).
  6102             88  CF-MP-USE-RECON             VALUE 'Y'.
  6103         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6104             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6105         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6106             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6107             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6108         16  FILLER                         PIC X(1).
  6109         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6110             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6111         16  CF-MORTG-MIB-VERSION           PIC X.
  6112             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6113             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6114             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6115         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6116             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6117                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6118             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6119                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6120             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6121                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6122             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6123                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6124             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6125                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6126             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6127                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6128         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6129         16  FILLER                         PIC X(7).
  6130         16  CF-MORTG-DESTINATION-SYMBOL.
  6131             20  CF-MORTG-MIB-COMM          PIC X(5).
  6132             20  CF-MORTG-MIB-TERM          PIC X(5).
  6133         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6134             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6135         16  FILLER                         PIC X(03).
  6136         16  CF-MP-CHECK-NO-CONTROL.
  6137             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6138                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6139                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6140                                                ' ' LOW-VALUES.
  6141                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6142                                               VALUE '3'.
  6143         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6144         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6145         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6146             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6147                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6148             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6149                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6150             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6151                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6152             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6153                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6154             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6155                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 113
* EL050.cbl
  6156             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6157                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6158         16  CF-MORTG-BILLING-AREA.
  6159             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6160                                            PIC X.
  6161         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6162         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6163         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6164         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6165             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6166             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6167         16  FILLER                         PIC X.
  6168         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6169             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6170             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6171         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6172         16  FILLER                         PIC X(8).
  6173         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6174         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6175         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6176         16  CF-ACH-COMPANY-ID.
  6177             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6178                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6179                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6180                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6181             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6182         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6183             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6184         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6185             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6186             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6187         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6188         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6189         16  FILLER                         PIC X(536).
  6190
  6191****************************************************************
  6192*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6193****************************************************************
  6194
  6195     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6196         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6197             20  CF-FEMALE-HEIGHT.
  6198                 24  CF-FEMALE-FT           PIC 99.
  6199                 24  CF-FEMALE-IN           PIC 99.
  6200             20  CF-FEMALE-MIN-WT           PIC 999.
  6201             20  CF-FEMALE-MAX-WT           PIC 999.
  6202         16  FILLER                         PIC X(428).
  6203
  6204     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6205         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6206             20  CF-MALE-HEIGHT.
  6207                 24  CF-MALE-FT             PIC 99.
  6208                 24  CF-MALE-IN             PIC 99.
  6209             20  CF-MALE-MIN-WT             PIC 999.
  6210             20  CF-MALE-MAX-WT             PIC 999.
  6211         16  FILLER                         PIC X(428).
  6212******************************************************************
  6213*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 114
* EL050.cbl
  6214******************************************************************
  6215     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6216         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6217             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6218             20  CF-SYS-LETTER-ID           PIC X(04).
  6219             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6220             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6221             20  CF-SYS-RESET-SW            PIC X(01).
  6222             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6223             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6224
  6225         16  FILLER                         PIC X(50).
  6226
  6227         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6228             20  CF-USER-ACTIVE-SW          PIC X(01).
  6229             20  CF-USER-LETTER-ID          PIC X(04).
  6230             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6231             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6232             20  CF-USER-RESET-SW           PIC X(01).
  6233             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6234             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6235             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6236
  6237         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 115
* EL050.cbl
  6239*    COPY ERCACCT.
  6240******************************************************************
  6241*                                                                *
  6242*                                                                *
  6243*                            ERCACCT                             *
  6244*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6245*                            VMOD=2.031                          *
  6246*                                                                *
  6247*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6248*                                                                *
  6249*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6250*   VSAM ACCOUNT MASTER FILES.                                   *
  6251*                                                                *
  6252*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6253*                                                                *
  6254*   FILE TYPE = VSAM,KSDS                                        *
  6255*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6256*                                                                *
  6257*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6258*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6259*                                                                *
  6260*   LOG = NO                                                     *
  6261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6262*                                                                *
  6263*                                                                *
  6264******************************************************************
  6265*                   C H A N G E   L O G
  6266*
  6267* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6268*-----------------------------------------------------------------
  6269*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6270* EFFECTIVE    NUMBER
  6271*-----------------------------------------------------------------
  6272* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6273* 092705    2005050300006  PEMA  ADD SPP LEASES
  6274* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6275* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6276* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6277* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6278******************************************************************
  6279
  6280 01  ACCOUNT-MASTER.
  6281     12  AM-RECORD-ID                      PIC XX.
  6282         88  VALID-AM-ID                      VALUE 'AM'.
  6283
  6284     12  AM-CONTROL-PRIMARY.
  6285         16  AM-COMPANY-CD                 PIC X.
  6286         16  AM-MSTR-CNTRL.
  6287             20  AM-CONTROL-A.
  6288                 24  AM-CARRIER            PIC X.
  6289                 24  AM-GROUPING.
  6290                     28 AM-GROUPING-PREFIX PIC XXX.
  6291                     28 AM-GROUPING-PRIME  PIC XXX.
  6292                 24  AM-STATE              PIC XX.
  6293                 24  AM-ACCOUNT.
  6294                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6295                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6296             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 116
* EL050.cbl
  6297                                           PIC X(19).
  6298             20  AM-CNTRL-B.
  6299                 24  AM-EXPIRATION-DT      PIC XX.
  6300                 24  FILLER                PIC X(4).
  6301             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6302                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6303
  6304     12  AM-CONTROL-BY-VAR-GRP.
  6305         16  AM-COMPANY-CD-A1              PIC X.
  6306         16  AM-VG-CARRIER                 PIC X.
  6307         16  AM-VG-GROUPING                PIC X(6).
  6308         16  AM-VG-STATE                   PIC XX.
  6309         16  AM-VG-ACCOUNT                 PIC X(10).
  6310         16  AM-VG-DATE.
  6311             20  AM-VG-EXPIRATION-DT       PIC XX.
  6312             20  FILLER                    PIC X(4).
  6313         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6314                                           PIC 9(11)      COMP-3.
  6315     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6316         16  FILLER                        PIC X(10).
  6317         16  AM-VG-KEY3.
  6318             20  AM-VG3-ACCOUNT            PIC X(10).
  6319             20  AM-VG3-EXP-DT             PIC XX.
  6320         16  FILLER                        PIC X(4).
  6321     12  AM-MAINT-INFORMATION.
  6322         16  AM-LAST-MAINT-DT              PIC XX.
  6323         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6324         16  AM-LAST-MAINT-USER            PIC X(4).
  6325         16  FILLER                        PIC XX.
  6326
  6327     12  AM-EFFECTIVE-DT                   PIC XX.
  6328     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6329
  6330     12  AM-PREV-DATES  COMP-3.
  6331         16  AM-PREV-EXP-DT                PIC 9(11).
  6332         16  AM-PREV-EFF-DT                PIC 9(11).
  6333
  6334     12  AM-REPORT-CODE-1                  PIC X(10).
  6335     12  AM-REPORT-CODE-2                  PIC X(10).
  6336
  6337     12  AM-CITY-CODE                      PIC X(4).
  6338     12  AM-COUNTY-PARISH                  PIC X(6).
  6339
  6340     12  AM-NAME                           PIC X(30).
  6341     12  AM-PERSON                         PIC X(30).
  6342     12  AM-ADDRS                          PIC X(30).
  6343     12  AM-CITY.
  6344         16  AM-ADDR-CITY                  PIC X(28).
  6345         16  AM-ADDR-STATE                 PIC XX.
  6346     12  AM-ZIP.
  6347         16  AM-ZIP-PRIME.
  6348             20  AM-ZIP-PRI-1ST            PIC X.
  6349                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6350             20  FILLER                    PIC X(4).
  6351         16  AM-ZIP-PLUS4                  PIC X(4).
  6352     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6353         16  AM-CAN-POSTAL-1               PIC XXX.
  6354         16  AM-CAN-POSTAL-2               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 117
* EL050.cbl
  6355         16  FILLER                        PIC XXX.
  6356     12  AM-TEL-NO.
  6357         16  AM-AREA-CODE                  PIC 999.
  6358         16  AM-TEL-PRE                    PIC 999.
  6359         16  AM-TEL-NBR                    PIC 9(4).
  6360     12  AM-TEL-LOC                        PIC X.
  6361         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6362         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6363
  6364     12  AM-COMM-STRUCTURE.
  6365         16  AM-DEFN-1.
  6366             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6367                 24  AM-AGT.
  6368                     28  AM-AGT-PREFIX     PIC X(4).
  6369                     28  AM-AGT-PRIME      PIC X(6).
  6370                 24  AM-COM-TYP            PIC X.
  6371                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6372                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6373                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6374                 24  AM-RECALC-LV-INDIC    PIC X.
  6375                 24  AM-RETRO-LV-INDIC     PIC X.
  6376                 24  AM-GL-CODES           PIC X.
  6377                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6378                 24  FILLER                PIC X(01).
  6379         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6380             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6381                 24  FILLER                PIC X(11).
  6382                 24  AM-L-COMA             PIC XXX.
  6383                 24  AM-J-COMA             PIC XXX.
  6384                 24  AM-A-COMA             PIC XXX.
  6385                 24  FILLER                PIC X(6).
  6386
  6387     12  AM-COMM-CHANGE-STATUS             PIC X.
  6388         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6389
  6390     12  AM-CSR-CODE                       PIC X(4).
  6391
  6392     12  AM-BILLING-STATUS                 PIC X.
  6393         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6394         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6395     12  AM-AUTO-REFUND-SW                 PIC X.
  6396         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6397         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6398     12  AM-GPCD                           PIC 99.
  6399     12  AM-IG                             PIC X.
  6400         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6401         88  AM-HAS-GROUP                     VALUE '2'.
  6402     12  AM-STATUS                         PIC X.
  6403         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6404         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6405         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6406         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6407         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6408         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6409     12  AM-REMIT-TO                       PIC 99.
  6410     12  AM-ID-NO                          PIC X(11).
  6411
  6412     12  AM-CAL-TABLE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 118
* EL050.cbl
  6413     12  AM-LF-DEVIATION                   PIC XXX.
  6414     12  AM-AH-DEVIATION                   PIC XXX.
  6415     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6416     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6417     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6418     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6419     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6420     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6421
  6422     12  AM-USER-FIELDS.
  6423         16  AM-FLD-1                      PIC XX.
  6424         16  AM-FLD-2                      PIC XX.
  6425         16  AM-FLD-3                      PIC XX.
  6426         16  AM-FLD-4                      PIC XX.
  6427         16  AM-FLD-5                      PIC XX.
  6428
  6429     12  AM-1ST-PROD-DATE.
  6430         16  AM-1ST-PROD-YR                PIC XX.
  6431         16  AM-1ST-PROD-MO                PIC XX.
  6432         16  AM-1ST-PROD-DA                PIC XX.
  6433     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6434     12  AM-CERTS-PURGED-DATE.
  6435         16  AM-PUR-YR                     PIC XX.
  6436         16  AM-PUR-MO                     PIC XX.
  6437         16  AM-PUR-DA                     PIC XX.
  6438     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6439     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6440     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6441     12  AM-INACTIVE-DATE.
  6442         16  AM-INA-MO                     PIC 99.
  6443         16  AM-INA-DA                     PIC 99.
  6444         16  AM-INA-YR                     PIC 99.
  6445     12  AM-AR-HI-CERT-DATE                PIC XX.
  6446
  6447     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6448     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6449
  6450     12  AM-OB-PAYMENT-MODE                PIC X.
  6451         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6452         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6453         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6454         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6455
  6456     12  AM-AH-ONLY-INDICATOR              PIC X.
  6457         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6458         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6459
  6460     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6461
  6462     12  AM-OVER-SHORT.
  6463         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6464         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6465
  6466     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6467     12  AM-DCC-CLP-STATE                  PIC XX.
  6468
  6469     12  AM-RECALC-COMM                    PIC X.
  6470     12  AM-RECALC-REIN                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 119
* EL050.cbl
  6471
  6472     12  AM-REI-TABLE                      PIC XXX.
  6473     12  AM-REI-ET-LF                      PIC X.
  6474     12  AM-REI-ET-AH                      PIC X.
  6475     12  AM-REI-PE-LF                      PIC X.
  6476     12  AM-REI-PE-AH                      PIC X.
  6477     12  AM-REI-PRT-ST                     PIC X.
  6478     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6479     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6480     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6481     12  AM-REI-GROUP-A                    PIC X(6).
  6482     12  AM-REI-MORT                       PIC X(4).
  6483     12  AM-REI-PRT-OW                     PIC X.
  6484     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6485     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6486     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6487     12  AM-REI-GROUP-B                    PIC X(6).
  6488
  6489     12  AM-TRUST-TYPE                     PIC X(2).
  6490
  6491     12  AM-EMPLOYER-STMT-USED             PIC X.
  6492     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6493
  6494     12  AM-STD-AH-TYPE                    PIC XX.
  6495     12  AM-EARN-METHODS.
  6496         16  AM-EARN-METHOD-R              PIC X.
  6497             88 AM-REF-RL-R78                 VALUE 'R'.
  6498             88 AM-REF-RL-PR                  VALUE 'P'.
  6499             88 AM-REF-RL-MEAN                VALUE 'M'.
  6500             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6501         16  AM-EARN-METHOD-L              PIC X.
  6502             88 AM-REF-LL-R78                 VALUE 'R'.
  6503             88 AM-REF-LL-PR                  VALUE 'P'.
  6504             88 AM-REF-LL-MEAN                VALUE 'M'.
  6505             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6506         16  AM-EARN-METHOD-A              PIC X.
  6507             88 AM-REF-AH-R78                 VALUE 'R'.
  6508             88 AM-REF-AH-PR                  VALUE 'P'.
  6509             88 AM-REF-AH-MEAN                VALUE 'M'.
  6510             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6511             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6512             88 AM-REF-AH-NET                 VALUE 'N'.
  6513
  6514     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6515     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6516     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6517
  6518     12  AM-RET-Y-N                        PIC X.
  6519     12  AM-RET-P-E                        PIC X.
  6520     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6521     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6522     12  AM-RET-GRP                        PIC X(6).
  6523     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6524         16  AM-POOL-PRIME                 PIC XXX.
  6525         16  AM-POOL-SUB                   PIC XXX.
  6526     12  AM-RETRO-EARNINGS.
  6527         16  AM-RET-EARN-R                 PIC X.
  6528         16  AM-RET-EARN-L                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 120
* EL050.cbl
  6529         16  AM-RET-EARN-A                 PIC X.
  6530     12  AM-RET-ST-TAX-USE                 PIC X.
  6531         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6532         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6533     12  AM-RETRO-BEG-EARNINGS.
  6534         16  AM-RET-BEG-EARN-R             PIC X.
  6535         16  AM-RET-BEG-EARN-L             PIC X.
  6536         16  AM-RET-BEG-EARN-A             PIC X.
  6537     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6538     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6539
  6540     12  AM-USER-SELECT-OPTIONS.
  6541         16  AM-USER-SELECT-1              PIC X(10).
  6542         16  AM-USER-SELECT-2              PIC X(10).
  6543         16  AM-USER-SELECT-3              PIC X(10).
  6544         16  AM-USER-SELECT-4              PIC X(10).
  6545         16  AM-USER-SELECT-5              PIC X(10).
  6546
  6547     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6548
  6549     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6550
  6551     12  AM-RPT045A-SWITCH                 PIC X.
  6552         88  RPT045A-OFF                   VALUE 'N'.
  6553
  6554     12  AM-INSURANCE-LIMITS.
  6555         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6556         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6557
  6558     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6559         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6560
  6561     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6562         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6563         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6564
  6565     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6566
  6567     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6568     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6569     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6570     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6571     12  FILLER                            PIC X(5).
  6572     12  AM-REPORT-CODE-3                  PIC X(10).
  6573*    12  FILLER                            PIC X(22).
  6574
  6575     12  AM-RESERVE-DATE.
  6576         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6577         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6578         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6579
  6580     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6581     12  AM-NOTIFICATION-TYPES.
  6582         16  AM-NOTIF-OF-LETTERS           PIC X.
  6583         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6584         16  AM-NOTIF-OF-REPORTS           PIC X.
  6585         16  AM-NOTIF-OF-STATUS            PIC X.
  6586
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 121
* EL050.cbl
  6587     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6588         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6589         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6590         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6591         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6592
  6593     12  AM-BENEFIT-CONTROLS.
  6594         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6595             20  AM-BENEFIT-CODE           PIC XX.
  6596             20  AM-BENEFIT-TYPE           PIC X.
  6597             20  AM-BENEFIT-REVISION       PIC XXX.
  6598             20  AM-BENEFIT-REM-TERM       PIC X.
  6599             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6600             20  FILLER                    PIC XX.
  6601         16  FILLER                        PIC X(80).
  6602
  6603     12  AM-TRANSFER-DATA.
  6604         16  AM-TRANSFERRED-FROM.
  6605             20  AM-TRNFROM-CARRIER        PIC X.
  6606             20  AM-TRNFROM-GROUPING.
  6607                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6608                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6609             20  AM-TRNFROM-STATE          PIC XX.
  6610             20  AM-TRNFROM-ACCOUNT.
  6611                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6612                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6613             20  AM-TRNFROM-DTE            PIC XX.
  6614         16  AM-TRANSFERRED-TO.
  6615             20  AM-TRNTO-CARRIER          PIC X.
  6616             20  AM-TRNTO-GROUPING.
  6617                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6618                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6619             20  AM-TRNTO-STATE            PIC XX.
  6620             20  AM-TRNTO-ACCOUNT.
  6621                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6622                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6623             20  AM-TRNTO-DTE              PIC XX.
  6624         16  FILLER                        PIC X(10).
  6625
  6626     12  AM-SAVED-REMIT-TO                 PIC 99.
  6627
  6628     12  AM-COMM-STRUCTURE-SAVED.
  6629         16  AM-DEFN-1-SAVED.
  6630             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6631                 24  AM-AGT-SV             PIC X(10).
  6632                 24  AM-COM-TYP-SV         PIC X.
  6633                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6634                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6635                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6636                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6637                 24  FILLER                PIC X.
  6638                 24  AM-GL-CODES-SV        PIC X.
  6639                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6640                 24  FILLER                PIC X.
  6641         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6642             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6643                 24  FILLER                PIC X(11).
  6644                 24  AM-L-COMA-SV          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 122
* EL050.cbl
  6645                 24  AM-J-COMA-SV          PIC XXX.
  6646                 24  AM-A-COMA-SV          PIC XXX.
  6647                 24  FILLER                PIC X(6).
  6648
  6649     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6650         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6651            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6652            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6653            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6654
  6655     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6656     12  FILLER                            PIC X(120).
  6657
  6658     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6659         16  AM-CONTROL-NAME               PIC X(30).
  6660         16  AM-EXECUTIVE-ONE.
  6661             20  AM-EXEC1-NAME             PIC X(15).
  6662             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6663                                                          COMP-3.
  6664             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6665                                                          COMP-3.
  6666         16  AM-EXECUTIVE-TWO.
  6667             20  AM-EXEC2-NAME             PIC X(15).
  6668             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6669                                                          COMP-3.
  6670             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6671                                                          COMP-3.
  6672
  6673     12  AM-RETRO-ADDITIONAL-DATA.
  6674         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6675         16  AM-RETRO-PREM-P-E             PIC X.
  6676         16  AM-RETRO-CLMS-P-I             PIC X.
  6677         16  AM-RETRO-RET-BRACKET-LF.
  6678             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6679                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6680                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6681             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6682                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6683                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6684             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6685                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6686                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6687         16  AM-RETRO-RET-BRACKET-AH.
  6688             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6689                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6690                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6691                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6692             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6693                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6694                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6695             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6696                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6697                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6698
  6699     12  AM-COMMENTS.
  6700         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6701
  6702     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 123
* EL050.cbl
  6703         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6704         16  AM-FLI-BILLING-CODE           PIC X.
  6705         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6706         16  AM-FLI-UNITED-IDENT           PIC X.
  6707         16  AM-FLI-INTEREST-LOST-DATA.
  6708             20  AM-FLI-BANK-NO            PIC X(5).
  6709             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6710             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6711             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6712         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6713             20  AM-FLI-AGT                PIC X(9).
  6714             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6715             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6716         16  FILLER                        PIC X(102).
  6717
  6718     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6719         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6720             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6721             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6722             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6723             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6724             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6725         16  FILLER                          PIC X(10).
  6726******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 124
* EL050.cbl
  6728*    COPY ERCREIN.
  6729******************************************************************
  6730*                                                                *
  6731*                            ERCREIN                             *
  6732*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6733*                            VMOD=2.010                          *
  6734*                                                                *
  6735*   ONLINE CREDIT SYSTEM                                         *
  6736*                                                                *
  6737*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6738*                                                                *
  6739*   FILE TYPE = VSAM,KSDS                                        *
  6740*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6741*                                                                *
  6742*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6743*       ALTERNATE PATH = NONE                                    *
  6744*                                                                *
  6745*   LOG = NO                                                     *
  6746*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6747*                                                                *
  6748******************************************************************
  6749*                   C H A N G E   L O G
  6750*
  6751* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6752*-----------------------------------------------------------------
  6753*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6754* EFFECTIVE    NUMBER
  6755*-----------------------------------------------------------------
  6756* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6757* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6758******************************************************************
  6759 01  REINSURANCE-RECORD.
  6760     12  RE-RECORD-ID                      PIC XX.
  6761         88  VALID-RE-ID                      VALUE 'RE'.
  6762
  6763     12  RE-CONTROL-PRIMARY.
  6764         16  RE-COMPANY-CD                 PIC X.
  6765         16  RE-KEY.
  6766             20  RE-CODE                   PIC X.
  6767                 88  RE-TABLE-RECORD          VALUE 'A'.
  6768                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6769             20  RE-TABLE                  PIC XXX.
  6770             20  FILLER                    PIC XXX.
  6771         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6772             20  FILLER                    PIC X.
  6773             20  RE-COMPANY.
  6774                 24  RE-COMP-PRIME         PIC XXX.
  6775                 24  RE-COMP-SUB           PIC XXX.
  6776
  6777     12  RE-MAINT-INFORMATION.
  6778         16  RE-LAST-MAINT-DT              PIC XX.
  6779         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6780         16  RE-LAST-MAINT-USER            PIC X(4).
  6781         16  FILLER                        PIC X(10).
  6782
  6783     12  RE-TABLE-DATA.
  6784         16  RE-100-COMP                   PIC 99.
  6785
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 125
* EL050.cbl
  6786         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6787             20  RE-REI-COMP-NO.
  6788                 24  RE-REI-COMP           PIC XXX.
  6789                 24  RE-REI-COMP-SUB       PIC XXX.
  6790             20  RE-LF-QC                  PIC X.
  6791             20  RE-AH-QC                  PIC X.
  6792             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6793             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6794             20  RE-LFAGE-LO               PIC 99.
  6795             20  RE-LFAGE-HI               PIC 99.
  6796             20  RE-AHAGE-LO               PIC 99.
  6797             20  RE-AHAGE-HI               PIC 99.
  6798             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6799             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6800             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6801             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6802             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6803             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6804             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6805             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6806             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6807             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6808             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6809             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6810             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6811             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6812             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6813             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6814             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6815             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6816             20  RE-LF-BEN-CODE            PIC X.
  6817             20  RE-AH-BEN-CODE            PIC X.
  6818             20  RE-INTERACTIVE            PIC X.
  6819             20  RE-REMAINING              PIC X.
  6820             20  RE-LF-RUNOFF-SW           PIC X.
  6821             20  RE-AH-RUNOFF-SW           PIC X.
  6822             20  FILLER                    PIC X(19).
  6823
  6824         16  RE-COMP-INFO-END              PIC X(6).
  6825         16  RE-NSP-ST-CD-LF               PIC XX.
  6826         16  RE-NSP-ST-CD-AH               PIC XX.
  6827         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6828             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6829
  6830         16  FILLER                        PIC X(27).
  6831
  6832     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6833         16  RE-NAME                       PIC X(30).
  6834         16  RE-LF-PE                      PIC X.
  6835         16  RE-AH-PE                      PIC X.
  6836         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6837         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6838         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6839         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6840         16  RE-PRT-ST                     PIC X.
  6841         16  RE-PRT-OW                     PIC X.
  6842         16  RE-MORT-CODE                  PIC X(4).
  6843         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 126
* EL050.cbl
  6844         16  RE-ZERO-LF-FEE                PIC X.
  6845         16  RE-ZERO-AH-FEE                PIC X.
  6846         16  RE-CEDE-NAME                  PIC X(30).
  6847         16  RE-LF-COMM                    PIC X.
  6848         16  RE-AH-COMM                    PIC X.
  6849         16  RE-LF-TAX                     PIC X.
  6850         16  RE-AH-TAX                     PIC X.
  6851         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6852         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6853         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6854
  6855         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6856             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6857
  6858         16  RE-LF-CEDING-FEE-BRACKETS.
  6859             20  RE-LF-FEE-METHOD          PIC X.
  6860                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6861                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6862                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6863                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6864             20  RE-LF-FEE-BASIS           PIC X.
  6865                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6866                 88  RE-LF-NET-CEDED               VALUE '2'.
  6867                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6868                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6869                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6870                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6871                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6872                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6873             20  FILLER                    PIC XXX.
  6874             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6875                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6876                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6877
  6878         16  RE-AH-CEDING-FEE-BRACKETS.
  6879             20  RE-AH-FEE-METHOD          PIC X.
  6880                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6881                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6882                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6883                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6884             20  RE-AH-FEE-BASIS           PIC X.
  6885                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6886                 88  RE-AH-NET-CEDED               VALUE '2'.
  6887                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6888                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6889                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6890                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6891                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6892                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6893             20  FILLER                    PIC XXX.
  6894             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6895                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6896                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6897
  6898         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6899
  6900         16  RE-OLD-CEDING-STMT            PIC X.
  6901
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 127
* EL050.cbl
  6902         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6903         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6904         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6905         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6906         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6907         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6908         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6909         16  RE-MORT-SW                    PIC X.
  6910         16  RE-CEDING-TYPE-FLAG           PIC X.
  6911             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6912             88  RE-CEDED                          VALUE 'C'.
  6913             88  RE-ASSUMED                        VALUE 'A'.
  6914             88  RE-PHANTOM                        VALUE 'P'.
  6915
  6916         16  RE-CEDING-STMT-OPT-A          PIC X.
  6917             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6918         16  RE-CEDING-STMT-OPT-B          PIC X.
  6919             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6920         16  RE-CEDING-STMT-OPT-C          PIC X.
  6921             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6922         16  RE-CEDING-STMT-OPT-D          PIC X.
  6923             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6924         16  RE-CEDING-STMT-OPT-E          PIC X.
  6925             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6926
  6927         16  RE-PRT-CRSV                   PIC X.
  6928
  6929         16  RE-GL-CENTER                  PIC X(4).
  6930
  6931         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6932
  6933         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6934
  6935         16  RE-EARN-STOP-CODE             PIC X.
  6936             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6937             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6938
  6939         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6940             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6941
  6942         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6943         16  FILLER                        PIC X(2281).
  6944
  6945         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6946
  6947******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 128
* EL050.cbl
  6949*    COPY ERCCTBL.
  6950******************************************************************
  6951*                                                                *
  6952*                                                                *
  6953*                            ERCCTBL                             *
  6954*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6955*                            VMOD=2.003
  6956*                                                                *
  6957*   ONLINE CREDIT SYSTEM                                         *
  6958*                                                                *
  6959*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  6960*                                                                *
  6961*   FILE TYPE = VSAM,KSDS                                        *
  6962*   RECORD SIZE = 200   RECFORM = FIXED                          *
  6963*                                                                *
  6964*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  6965*       ALTERNATE PATH = NONE                                    *
  6966*                                                                *
  6967*   LOG = NO                                                     *
  6968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6969*                                                                *
  6970*                                                                *
  6971******************************************************************
  6972
  6973 01  COMM-TABLE-RECORD.
  6974     12  CT-RECORD-ID                      PIC XX.
  6975         88  VALID-CT-ID                      VALUE 'CT'.
  6976
  6977     12  CT-CONTROL-PRIMARY.
  6978         16  CT-COMPANY-CD                 PIC X.
  6979         16  CT-TABLE                      PIC XXX.
  6980         16  CT-CNTRL-2.
  6981             20  CT-BEN-TYPE               PIC X.
  6982             20  CT-BEN-CODE               PIC XX.
  6983
  6984     12  CT-MAINT-INFORMATION.
  6985         16  CT-LAST-MAINT-DT              PIC XX.
  6986         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6987         16  CT-LAST-MAINT-USER            PIC X(4).
  6988         16  FILLER                        PIC X(31).
  6989
  6990     12  CT-LIMITS.
  6991         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  6992
  6993         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  6994
  6995         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  6996
  6997     12  CT-RATES.
  6998         16  CT-RTX          OCCURS 27 TIMES.
  6999             20  CT-RT                     PIC SV9(5)     COMP-3.
  7000             20  CT-RT-R   REDEFINES
  7001                 CT-RT                     PIC XXX.
  7002
  7003     12  FILLER                            PIC  X(42).
  7004
  7005******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 129
* EL050.cbl
  7007*    COPY ERCFORM.
  7008******************************************************************
  7009*                                                                *
  7010*                                                                *
  7011*                            ERCFORM.                            *
  7012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7013*                            VMOD=2.003                          *
  7014*                                                                *
  7015*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7016*                                                                *
  7017*    FILE TYPE = VSAM,KSDS                                       *
  7018*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7019*                                                                *
  7020*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7021*                                                                *
  7022*    LOG = YES                                                   *
  7023*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7024******************************************************************
  7025 01  FORM-MASTER.
  7026    12  FO-RECORD-ID                 PIC X(02).
  7027        88  VALID-FO-ID                  VALUE 'FO'.
  7028
  7029    12  FO-CONTROL-PRIMARY.
  7030        16  FO-COMPANY-CD            PIC X(01).
  7031        16  FO-STATE                 PIC X(02).
  7032        16  FO-FORM-ID               PIC X(12).
  7033        16  FO-FORM-EXP-DT           PIC X(02).
  7034
  7035    12  FO-POLICY-FORM-DATA.
  7036        16  FO-IND-GRP-CD            PIC X(01).
  7037        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7038        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7039        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7040        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7041        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7042        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7043        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7044        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7045        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7046        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7047        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7048        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7049        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7050        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7051        16  FO-APP-CERT-USE-CD       PIC X(01).
  7052
  7053    12  FILLER                       PIC X(29).
  7054
  7055    12  FO-FORM-PLAN-TABLE.
  7056        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7057            20  FO-PLAN-TYPE         PIC X(01).
  7058            20  FO-PLAN-ID           PIC X(02).
  7059            20  FO-PLAN-TERM         PIC 9(03).
  7060            20  FO-PLAN-REFUND-METHOD
  7061                                     PIC X.
  7062
  7063    12  FILLER                       PIC X(30).
  7064
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 130
* EL050.cbl
  7065    12  FO-COMMENTS-AREA.
  7066        16  FO-COMMENT-LINE-1        PIC X(78).
  7067
  7068    12  FILLER                       PIC X(20).
  7069
  7070    12  FO-MAINT-INFORMATION.
  7071        16  FO-LAST-MAINT-DT         PIC X(02).
  7072        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7073        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 131
* EL050.cbl
  7075*    COPY ELCMSTR.
  7076******************************************************************
  7077*                                                                *
  7078*                            ELCMSTR.                            *
  7079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7080*                            VMOD=2.012                          *
  7081*                                                                *
  7082*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7083*                                                                *
  7084*   FILE TYPE = VSAM,KSDS                                        *
  7085*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7086*                                                                *
  7087*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7088*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7089*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7090*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7091*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7092*                                                 RKP=75,LEN=21  *
  7093*                                                                *
  7094*   **** NOTE ****                                               *
  7095*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7096*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7097*                                                                *
  7098*   LOG = YES                                                    *
  7099*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7100******************************************************************
  7101*                   C H A N G E   L O G
  7102*
  7103* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7104*-----------------------------------------------------------------
  7105*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7106* EFFECTIVE    NUMBER
  7107*-----------------------------------------------------------------
  7108* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7109* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7110******************************************************************
  7111 01  CLAIM-MASTER.
  7112     12  CL-RECORD-ID                PIC XX.
  7113         88  VALID-CL-ID         VALUE 'CL'.
  7114
  7115     12  CL-CONTROL-PRIMARY.
  7116         16  CL-COMPANY-CD           PIC X.
  7117         16  CL-CARRIER              PIC X.
  7118         16  CL-CLAIM-NO             PIC X(7).
  7119         16  CL-CERT-NO.
  7120             20  CL-CERT-PRIME       PIC X(10).
  7121             20  CL-CERT-SFX         PIC X.
  7122
  7123     12  CL-CONTROL-BY-NAME.
  7124         16  CL-COMPANY-CD-A1        PIC X.
  7125         16  CL-INSURED-LAST-NAME    PIC X(15).
  7126         16  CL-INSURED-NAME.
  7127             20  CL-INSURED-1ST-NAME PIC X(12).
  7128             20  CL-INSURED-MID-INIT PIC X.
  7129
  7130     12  CL-CONTROL-BY-SSN.
  7131         16  CL-COMPANY-CD-A2        PIC X.
  7132         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 132
* EL050.cbl
  7133             20  CL-SSN-STATE        PIC XX.
  7134             20  CL-SSN-ACCOUNT      PIC X(6).
  7135             20  CL-SSN-LN3          PIC X(3).
  7136
  7137     12  CL-CONTROL-BY-CERT-NO.
  7138         16  CL-COMPANY-CD-A4        PIC X.
  7139         16  CL-CERT-NO-A4.
  7140             20  CL-CERT-A4-PRIME    PIC X(10).
  7141             20  CL-CERT-A4-SFX      PIC X.
  7142
  7143     12  CL-CONTROL-BY-CCN.
  7144         16  CL-COMPANY-CD-A5        PIC X.
  7145         16  CL-CCN-A5.
  7146             20  CL-CCN.
  7147                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7148                 24  CL-CCN-PRIME-A5 PIC X(12).
  7149             20  CL-CCN-FILLER-A5    PIC X(4).
  7150
  7151     12  CL-INSURED-PROFILE-DATA.
  7152         16  CL-INSURED-BIRTH-DT     PIC XX.
  7153         16  CL-INSURED-SEX-CD       PIC X.
  7154             88  INSURED-IS-MALE        VALUE 'M'.
  7155             88  INSURED-IS-FEMALE      VALUE 'F'.
  7156             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7157         16  CL-INSURED-OCC-CD       PIC X(6).
  7158         16  FILLER                  PIC X(5).
  7159
  7160     12  CL-PROCESSING-INFO.
  7161         16  CL-PROCESSOR-ID         PIC X(4).
  7162         16  CL-CLAIM-STATUS         PIC X.
  7163             88  CLAIM-IS-OPEN          VALUE 'O'.
  7164             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7165         16  CL-CLAIM-TYPE           PIC X.
  7166*            88  AH-CLAIM               VALUE 'A'.
  7167*            88  LIFE-CLAIM             VALUE 'L'.
  7168*            88  PROPERTY-CLAIM         VALUE 'P'.
  7169*            88  IUI-CLAIM              VALUE 'I'.
  7170*            88  GAP-CLAIM              VALUE 'G'.
  7171         16  CL-CLAIM-PREM-TYPE      PIC X.
  7172             88  SINGLE-PREMIUM         VALUE '1'.
  7173             88  O-B-COVERAGE           VALUE '2'.
  7174             88  OPEN-END-COVERAGE      VALUE '3'.
  7175         16  CL-INCURRED-DT          PIC XX.
  7176         16  CL-REPORTED-DT          PIC XX.
  7177         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7178         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7179         16  CL-LAST-PMT-DT          PIC XX.
  7180         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7181         16  CL-PAID-THRU-DT         PIC XX.
  7182         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7183         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7184         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7185         16  CL-PMT-CALC-METHOD      PIC X.
  7186             88  CL-360-DAY-YR          VALUE '1'.
  7187             88  CL-365-DAY-YR          VALUE '2'.
  7188             88  CL-FULL-MONTHS         VALUE '3'.
  7189         16  CL-CAUSE-CD             PIC X(6).
  7190
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 133
* EL050.cbl
  7191         16  CL-PRIME-CERT-NO.
  7192             20  CL-PRIME-CERT-PRIME PIC X(10).
  7193             20  CL-PRIME-CERT-SFX   PIC X.
  7194
  7195         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7196             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7197             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7198
  7199         16  CL-MICROFILM-NO         PIC X(10).
  7200         16  CL-PROG-FORM-TYPE       PIC X.
  7201         16  CL-LAST-ADD-ON-DT       PIC XX.
  7202
  7203         16  CL-LAST-REOPEN-DT       PIC XX.
  7204         16  CL-LAST-CLOSE-DT        PIC XX.
  7205         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7206             88  FINAL-PAID             VALUE '1'.
  7207             88  CLAIM-DENIED           VALUE '2'.
  7208             88  AUTO-CLOSE             VALUE '3'.
  7209             88  MANUAL-CLOSE           VALUE '4'.
  7210             88  BENEFITS-CHANGED       VALUE 'C'.
  7211             88  SETUP-ERRORS           VALUE 'E'.
  7212         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7213         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7214         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7215             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7216         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7217         16  FILLER                  PIC X.
  7218
  7219     12  CL-CERTIFICATE-DATA.
  7220         16  CL-CERT-ORIGIN          PIC X.
  7221             88  CERT-WAS-ONLINE        VALUE '1'.
  7222             88  CERT-WAS-CREATED       VALUE '2'.
  7223             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7224         16  CL-CERT-KEY-DATA.
  7225             20  CL-CERT-CARRIER     PIC X.
  7226             20  CL-CERT-GROUPING    PIC X(6).
  7227             20  CL-CERT-STATE       PIC XX.
  7228             20  CL-CERT-ACCOUNT.
  7229                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7230                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7231             20  CL-CERT-EFF-DT      PIC XX.
  7232
  7233     12  CL-STATUS-CONTROLS.
  7234         16  CL-PRIORITY-CD          PIC X.
  7235             88  CONFIDENTIAL-DATA      VALUE '8'.
  7236             88  HIGHEST-PRIORITY       VALUE '9'.
  7237         16  CL-SUPV-ATTN-CD         PIC X.
  7238             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7239             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7240         16  CL-PURGED-DT            PIC XX.
  7241         16  CL-RESTORED-DT          PIC XX.
  7242         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7243         16  CL-NEXT-RESEND-DT       PIC XX.
  7244         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7245         16  FILLER                  PIC XX.
  7246         16  CL-LAST-MAINT-DT        PIC XX.
  7247         16  CL-LAST-MAINT-USER      PIC X(4).
  7248         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 134
* EL050.cbl
  7249         16  CL-LAST-MAINT-TYPE      PIC X.
  7250             88  CLAIM-SET-UP           VALUE ' '.
  7251             88  PAYMENT-MADE           VALUE '1'.
  7252             88  LETTER-SENT            VALUE '2'.
  7253             88  MASTER-WAS-ALTERED     VALUE '3'.
  7254             88  MASTER-WAS-RESTORED    VALUE '4'.
  7255             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7256             88  FILE-CONVERTED         VALUE '6'.
  7257             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7258             88  ERROR-CORRECTION       VALUE 'E'.
  7259         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7260         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7261         16  CL-BENEFICIARY          PIC X(10).
  7262         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7263         16  CL-DENIAL-TYPE          PIC X.
  7264             88  CL-TYPE-DENIAL          VALUE '1'.
  7265             88  CL-TYPE-RESCISSION      VALUE '2'.
  7266             88  CL-TYPE-REFORMATION     VALUE '3'.
  7267             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7268             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7269         16  FILLER                  PIC X(5).
  7270
  7271     12  CL-TRAILER-CONTROLS.
  7272         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7273             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7274             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7275             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7276         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7277         16  FILLER                  PIC XX.
  7278         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7279         16  CL-ADDRESS-TRAILER-CNT.
  7280             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7281                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7282             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7283                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7284             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7285                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7286             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7287                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7288             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7289                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7290             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7291                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7292             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7293                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7294
  7295     12  CL-CV-REFERENCE-NO.
  7296         16  CL-CV-REFNO-PRIME       PIC X(18).
  7297         16  CL-CV-REFNO-SFX         PIC XX.
  7298
  7299     12  CL-FILE-LOCATION            PIC X(4).
  7300
  7301     12  CL-PROCESS-ERRORS.
  7302         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7303             88  NO-FATAL-ERRORS        VALUE ZERO.
  7304         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7305             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7306
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 135
* EL050.cbl
  7307     12  CL-PRODUCT-CD               PIC X.
  7308
  7309     12  CL-CURRENT-KEY-DATA.
  7310         16  CL-CURRENT-CARRIER      PIC X.
  7311         16  CL-CURRENT-GROUPING     PIC X(6).
  7312         16  CL-CURRENT-STATE        PIC XX.
  7313         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7314
  7315     12  CL-ASSOCIATES               PIC X.
  7316         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7317         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7318         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7319         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7320
  7321     12  CL-ACTIVITY-CODE            PIC 99.
  7322     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7323     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7324
  7325     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7326     12  CL-LAG-REPORT-CODE          PIC 9.
  7327     12  CL-LOAN-TYPE                PIC XX.
  7328     12  CL-LEGAL-STATE              PIC XX.
  7329
  7330*    12  FILLER                      PIC X(5).
  7331     12  CL-YESNOSW                  PIC X.
  7332     12  FILLER                      PIC X(4).
  7333
  7334 01  PLAN-RECORDS.
  7335     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7336     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7337
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 136
* EL050.cbl
  7339 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7340                          ACCOUNT-MASTER REINSURANCE-RECORD
  7341                          COMM-TABLE-RECORD FORM-MASTER
  7342                          CLAIM-MASTER PLAN-RECORDS.
  7343 0000-DFHEXIT SECTION.
  7344     MOVE '9#                    $   ' TO DFHEIV0.
  7345     MOVE 'EL050' TO DFHEIV1.
  7346     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7347
  7348     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7349
  7350
  7351* EXEC CICS  HANDLE CONDITION
  7352*           ERROR    (9300-ABEND)
  7353*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7354*    END-EXEC.
  7355*    MOVE '"$.J                  ! " #00007346' TO DFHEIV0
  7356     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7358     MOVE X'2220233030303037333436' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0
  7360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7361
  7362
  7363 0000-COPY-PROCEDURE-DIV.
  7364*                          COPY ELC50PD.
  7365******************************************************************
  7366*                                                                *
  7367*                            ELC50PD                             *
  7368*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7369*                            VMOD=2.188                          *
  7370*                                                                *
  7371******************************************************************
  7372*                   C H A N G E   L O G
  7373*
  7374* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7375*-----------------------------------------------------------------
  7376*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7377* EFFECTIVE    NUMBER
  7378*-----------------------------------------------------------------
  7379* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7380* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7381* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7382*                             2709 AND 2718
  7383* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7384* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7385* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7386* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7387* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7388*                                IS OPEN OR CNC DT < PD THRU
  7389* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7390* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7391* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7392* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7393* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7394* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7395* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7396* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 137
* EL050.cbl
  7397* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7398* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7399* 020906                   PEMA  EXPAND LOAN OFFICER
  7400* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7401* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7402* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7403* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7404* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7405* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7406* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7407* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7408* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7409* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7410* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7411* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7412* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7413* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7414* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7415* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7416* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7417* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7418* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7419* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7420* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7421* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7422* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7423* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7424* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7425*                                UPDATE VIN ON CERT TRAILER
  7426* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7427* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7428* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7429* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7430* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7431* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7432* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7433* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7434* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7435* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7436* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7437* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7438* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7439* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7440* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7441* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7442* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7443* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7444* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7445* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7446* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7447* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7448* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7449* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7450* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7451* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7452* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7453* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7454******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 138
* EL050.cbl
  7455************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7456******************************************************************
  7457
  7458     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7459
  7460     MOVE SPACES                 TO PB-FATAL-FLAG
  7461                                    PB-FORCE-ER-CD
  7462                                    PB-WARN-ER-CD
  7463                                    PB-OUT-BAL-CD.
  7464
  7465     MOVE SPACE                  TO WS-IG-OVRD-AH
  7466                                    WS-IG-OVRD-LF
  7467                                    WS-IG-OVRD-AM
  7468                                    WS-IG-OVRD
  7469                                    WS-IG-OVRD-AH-PL
  7470                                    WS-IG-OVRD-LF-PL
  7471                                    WS-IG-OVRD-AH-BEN
  7472                                    WS-IG-OVRD-LF-BEN.
  7473
  7474******************************************************************
  7475*************       INITIALIZE COMMON ERRORS       ***************
  7476******************************************************************
  7477
  7478     MOVE +0                     TO PB-NO-OF-ERRORS.
  7479     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7480
  7481******************************************************************
  7482
  7483     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7484     SET JULIAN-TO-BIN           TO TRUE.
  7485*    MOVE 5                      TO DC-OPTION-CODE.
  7486     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7487     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7488
  7489     MOVE ZERO                   TO  SUB4.
  7490
  7491 0040-INITIALIZE-GA-BILL-DT.
  7492
  7493     ADD +1                      TO  SUB4.
  7494
  7495     IF  SUB4 GREATER THAN +5
  7496         GO TO 0050-CHECK-CNTL-FOUND.
  7497
  7498     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7499         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7500
  7501     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7502
  7503 0050-CHECK-CNTL-FOUND.
  7504
  7505     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7506        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7507                                         WS-AH-REM-TERM-CALC
  7508                                         EC-CO-REM-TERM-CALC
  7509        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7510        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7511        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7512                                         WS-TOL-AH-CLAIM
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 139
* EL050.cbl
  7513        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7514                                         WS-TOL-AH-PREM
  7515                                         EC-CO-TOL-PREM
  7516        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7517                                         WS-TOL-AH-REFUND
  7518                                         EC-CO-TOL-REFUND
  7519        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7520                                         WS-AH-REFUND-OVS-AMT
  7521                                         EC-CO-OVR-SHT-AMT
  7522        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7523                                         WS-TOL-AH-PREM-PCT
  7524                                         EC-CO-TOL-PREM-PCT
  7525        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7526                                         WS-TOL-AH-REFUND-PCT
  7527                                         EC-CO-TOL-REFUND-PCT
  7528        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7529                                         WS-AH-REFUND-OVS-PCT
  7530                                         EC-CO-OVR-SHT-PCT
  7531        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7532        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7533        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7534        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7535        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7536        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7537        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7538        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7539        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7540        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7541        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7542        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7543                                         EC-CO-MONTH-END-DT
  7544        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7545          GO TO 0100-READ-ACCT.
  7546
  7547     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7548     MOVE SPACES                 TO CNTL-ACCESS.
  7549     MOVE '1'                    TO CNTL-REC-TYPE.
  7550     MOVE +0                     TO CNTL-SEQ-NO.
  7551
  7552     MOVE '1' TO RC-SW-1.
  7553     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7554     IF NOT CF-COMPANY-MASTER
  7555         MOVE ZEROS             TO WK-CO-TOL-PREM
  7556                                   WK-CO-TOL-CLAIM
  7557                                   WK-CO-TOL-REFUND
  7558                                   WK-REFUND-OVS-AMT
  7559                                   WK-REFUND-OVS-PCT
  7560                                   WK-CO-TOL-PREM-PCT
  7561                                   WK-CO-TOL-REFUND-PCT
  7562                                   WK-DEFAULT-APR
  7563                                   WK-CO-MAX-CAP
  7564        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7565                                   WK-CR-R78-METHOD
  7566                                   WK-CO-REF-REJECT-SW
  7567                                   WK-CO-PREM-REJECT-SW
  7568                                   WK-REM-TRM-CALC-OPTION
  7569                                   WK-BIRTH-DATE-INPUT
  7570                                   WK-JOINT-AGE-INPUT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 140
* EL050.cbl
  7571        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7572        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7573        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7574        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7575          GO TO 0099-COMPANY-NOT-FOUND.
  7576
  7577     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7578        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7579     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7580        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7581     IF CF-CO-TOL-CAP NOT NUMERIC
  7582        MOVE +0                    TO CF-CO-TOL-CAP.
  7583     IF CF-DEFAULT-APR NOT NUMERIC
  7584        MOVE +0                    TO CF-DEFAULT-APR.
  7585
  7586     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7587     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7588     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7589     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7590     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7591     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7592     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7593     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7594     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7595     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7596     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7597     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7598
  7599     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7600          CF-CO-OVR-SHT-AMT > +0
  7601        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7602
  7603     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7604          CF-CO-OVR-SHT-PCT > +0
  7605        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7606
  7607     IF CF-VALID-REM-TRM-OPTION
  7608         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7609     ELSE
  7610         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7611
  7612     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7613     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7614     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7615     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7616
  7617     GO TO 0050-CHECK-CNTL-FOUND.
  7618
  7619 0099-COMPANY-NOT-FOUND.
  7620
  7621     MOVE ER-2616                TO WS-ERROR.
  7622     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7623
  7624 0100-READ-ACCT.
  7625
  7626     MOVE SPACES                 TO DATE-RANGE-SW.
  7627
  7628     IF WK-ACCT-ADDR = ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 141
* EL050.cbl
  7629        GO TO 0102-ACCT-GETMAIN.
  7630
  7631     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7632     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7633     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7634
  7635     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7636        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7637        GO TO 0105-READ-ACCT
  7638     END-IF
  7639
  7640     IF PB-CARRIER NOT = SPACES
  7641        IF PB-CARRIER NOT = AM-VG-CARRIER
  7642           GO TO 0105-READ-ACCT.
  7643
  7644     IF PB-STATE NOT = SPACES
  7645        IF PB-STATE NOT = AM-VG-STATE
  7646           GO TO 0105-READ-ACCT.
  7647
  7648     IF PB-GROUPING NOT = SPACES
  7649        IF PB-GROUPING NOT = AM-VG-GROUPING
  7650           GO TO 0105-READ-ACCT.
  7651
  7652     MOVE 'X'                 TO DATE-RANGE-SW.
  7653
  7654     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7655        MOVE 'X'                 TO DATE-RANGE-SW
  7656        GO TO 0105-READ-ACCT.
  7657
  7658     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7659        GO TO 0105-READ-ACCT.
  7660
  7661     GO TO 0180-ACCOUNT-FOUND.
  7662
  7663 0102-ACCT-GETMAIN.
  7664     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7665     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7666
  7667 0105-READ-ACCT.
  7668     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7669     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7670     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7671     MOVE PB-STATE               TO ACCT-STATE.
  7672     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7673     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7674
  7675     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7676
  7677     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7678
  7679 0110-FIND-ACCT-TOLERANCES-LOOP.
  7680     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7681
  7682     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7683        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7684        GO TO 0199-ACCT-NOT-FOUND
  7685     END-IF
  7686     IF PB-CARRIER NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 142
* EL050.cbl
  7687        IF PB-CARRIER NOT = AM-VG-CARRIER
  7688           GO TO 0199-ACCT-NOT-FOUND.
  7689
  7690     IF PB-STATE NOT = SPACES
  7691        IF PB-STATE NOT = AM-VG-STATE
  7692           GO TO 0199-ACCT-NOT-FOUND.
  7693
  7694     IF PB-GROUPING NOT = SPACES
  7695        IF PB-GROUPING NOT = AM-VG-GROUPING
  7696           GO TO 0199-ACCT-NOT-FOUND.
  7697
  7698     MOVE 'X'                    TO DATE-RANGE-SW.
  7699
  7700     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7701        MOVE 'X'                 TO DATE-RANGE-SW
  7702        GO TO 0199-ACCT-NOT-FOUND.
  7703
  7704     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7705        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7706
  7707 0180-ACCOUNT-FOUND.
  7708     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7709     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7710     MOVE AM-STATE               TO PB-SV-STATE.
  7711     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7712
  7713     IF AM-CANCEL-FEE  NOT NUMERIC
  7714        MOVE ZEROS TO AM-CANCEL-FEE.
  7715
  7716     IF AM-MAX-MON-BEN NOT NUMERIC
  7717        MOVE ZEROS TO AM-MAX-MON-BEN.
  7718
  7719     IF AM-MAX-TOT-BEN NOT NUMERIC
  7720        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7721
  7722     IF AM-CLP-TOL-PCT NOT NUMERIC
  7723        MOVE +0                  TO AM-CLP-TOL-PCT
  7724     END-IF
  7725     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7726        MOVE +0                  TO AM-SPP-LEASE-COMM
  7727     END-IF
  7728     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7729        MOVE ER-2611             TO   WS-ERROR
  7730        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7731
  7732     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7733        MOVE ER-2621             TO   WS-ERROR
  7734        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7735
  7736     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7737        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7738        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7739        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7740         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7741
  7742     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  7743     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  7744     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 143
* EL050.cbl
  7745     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  7746     IF AM-CLP-TOL-PCT NOT = ZEROS
  7747        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  7748     END-IF
  7749     IF AM-SPP-LEASE-COMM NOT = ZEROS
  7750        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  7751     END-IF
  7752*    IF PB-COMPANY-ID = 'DCC'
  7753*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  7754*                                   WS-ADMIN-FEES
  7755*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  7756*          (SUB5 > +10)
  7757*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7758*             AND (AM-A-COM (SUB5) NUMERIC)
  7759*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7760*                + (AM-A-COM (SUB5) * 1000)
  7761*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  7762*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  7763*                + (AM-A-COM (SUB5) * 1000)
  7764*             END-IF
  7765*             IF AM-COM-TYP (SUB5) = 'N'
  7766*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  7767*                + (AM-A-COM (SUB5) * 1000)
  7768*             END-IF
  7769*          END-IF
  7770*       END-PERFORM
  7771*    END-IF
  7772     IF (PB-COMPANY-ID = 'DCC')
  7773        AND (PB-ISSUE)
  7774        MOVE +0                  TO WS-ACCT-ADDL-CLP
  7775        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  7776           (SUB5 > +10)
  7777           MOVE +0 TO WS-WK-RATE
  7778           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  7779              IF (AM-A-COM (SUB5) NUMERIC)
  7780                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  7781                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  7782              ELSE
  7783                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  7784                 IF PB-ISSUE
  7785                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7786                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  7787                 ELSE
  7788                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  7789                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  7790                 END-IF
  7791                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  7792                 MOVE ZEROS             TO WS-SUB1
  7793                                           WS-COMMISSION
  7794                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  7795                 MOVE '0530'               TO CTBL-SW
  7796                 MOVE ' '                  TO WS-CTBL-READ-SW
  7797                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7798                 IF FIRST-TIME-THROUGH
  7799                    MOVE 'AA'              TO CTBL-BEN-CODE
  7800                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  7801                 END-IF
  7802                 IF CTBL-TABLE-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 144
* EL050.cbl
  7803                    IF PB-ISSUE
  7804                       COMPUTE WS-COMM-CK-AMT =
  7805                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  7806                    ELSE
  7807                       COMPUTE WS-COMM-CK-AMT =
  7808                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  7809                    END-IF
  7810                    PERFORM 8800-GET-COMP-RATE
  7811                              THRU 8800-EXIT
  7812                 END-IF
  7813              END-IF
  7814              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  7815                + (WS-WK-RATE * 1000)
  7816           END-IF
  7817        END-PERFORM
  7818     END-IF
  7819     IF PB-COMPANY-ID EQUAL 'CRI'
  7820         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  7821
  7822     IF PB-COMPANY-ID EQUAL 'NCL'
  7823         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  7824     END-IF
  7825
  7826     GO TO 0200-READ-CERT.
  7827
  7828 0199-ACCT-NOT-FOUND.
  7829
  7830     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  7831
  7832     IF DATE-RANGE-SW NOT = SPACES
  7833        MOVE ER-2601             TO WS-ERROR
  7834        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7835     ELSE
  7836        MOVE ER-2619             TO WS-ERROR
  7837        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7838
  7839     GO TO 9990-RETURN.
  7840
  7841 0200-READ-CERT.
  7842
  7843     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  7844     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  7845     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  7846     MOVE PB-SV-STATE            TO CERT-STATE.
  7847     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  7848     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  7849     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  7850
  7851     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  7852
  7853     IF CERT-WAS-NOT-FOUND
  7854        GO TO 0299-CERT-NOT-FOUND.
  7855
  7856     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  7857        MOVE ER-2759             TO WS-ERROR
  7858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7859        GO TO 0298-UNLOCK-RETURN.
  7860
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 145
* EL050.cbl
  7861     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  7862         MOVE ER-2758            TO WS-ERROR
  7863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7864         GO TO 0298-UNLOCK-RETURN.
  7865
  7866     IF PB-ISSUE
  7867        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  7868           IF CERT-WAS-CREATED-FOR-CLAIM
  7869              NEXT SENTENCE
  7870            ELSE
  7871              MOVE ER-2626       TO WS-ERROR
  7872              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7873              GO TO 0298-UNLOCK-RETURN.
  7874
  7875     IF NOT PB-CANCELLATION
  7876        GO TO 0300-CONTINUE-EDIT.
  7877
  7878     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  7879     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  7880     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  7881     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  7882     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  7883     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  7884
  7885     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  7886     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  7887     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  7888     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  7889     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  7890     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  7891     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  7892     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  7893     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  7894
  7895     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  7896     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  7897     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  7898     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  7899     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  7900     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  7901     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  7902
  7903     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  7904     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  7905
  7906     MOVE CM-CREDIT-INTERFACE-SW-1
  7907                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  7908     MOVE CM-CREDIT-INTERFACE-SW-2
  7909                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  7910
  7911     IF CM-O-B-COVERAGE
  7912         MOVE 'B'                 TO PB-CI-OB-FLAG.
  7913
  7914     IF CM-LIVES NOT NUMERIC
  7915         MOVE ZERO                TO CM-LIVES.
  7916
  7917     IF CM-BILLED NOT NUMERIC
  7918         MOVE ZERO                TO CM-BILLED.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 146
* EL050.cbl
  7919
  7920     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  7921         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  7922         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  7923         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  7924         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  7925         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  7926         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  7927         MOVE CM-LIVES             TO PB-CI-LIVES
  7928*The next line causes a problem with my change  I dont think it is
  7929*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  7930
  7931     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  7932     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  7933     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  7934     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  7935     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  7936     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  7937
  7938     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  7939     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  7940     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  7941     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  7942
  7943     IF CM-LIFE-COMM-PCT NUMERIC
  7944         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  7945     ELSE
  7946         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  7947
  7948     IF CM-AH-COMM-PCT NUMERIC
  7949         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  7950     ELSE
  7951         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  7952
  7953     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  7954
  7955     IF CM-LOAN-APR       NOT NUMERIC
  7956           MOVE ZERO               TO CM-LOAN-APR.
  7957
  7958     IF CM-PAY-FREQUENCY  NOT NUMERIC
  7959           MOVE ZERO               TO CM-PAY-FREQUENCY.
  7960
  7961     IF CM-LOAN-TERM      NOT NUMERIC
  7962           MOVE ZERO               TO CM-LOAN-TERM.
  7963
  7964     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  7965           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  7966
  7967     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  7968           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  7969
  7970     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  7971     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  7972     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  7973     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  7974     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  7975     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  7976     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 147
* EL050.cbl
  7977     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  7978     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  7979     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  7980     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  7981     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  7982
  7983     IF CM-STATE = CM-SSN-STATE
  7984         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  7985
  7986     IF CM-STATE NOT = CM-MEMB-STATE
  7987         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  7988
  7989     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  7990
  7991     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  7992        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  7993        IF CM-ADDL-CLP NOT NUMERIC
  7994           MOVE +0               TO CM-ADDL-CLP
  7995        END-IF
  7996        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  7997        IF AM-DCC-PRODUCT-CODE = 'DDF'
  7998           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  7999        END-IF
  8000     END-IF
  8001     IF PB-COMPANY-ID = 'DCC'
  8002        MOVE +0                  TO WS-ADMIN-FEES
  8003                                    WS-CSO-ADMIN-FEE
  8004                                    WS-COMM-AND-MFEE
  8005                                    WS-1ST-YR-ALLOW
  8006        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8007           (SUB5 > +10)
  8008           MOVE +0 TO WS-WK-RATE
  8009           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8010              IF (AM-A-COM (SUB5) NUMERIC)
  8011                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8012                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8013              ELSE
  8014                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8015                 IF PB-ISSUE
  8016                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8017                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8018                 ELSE
  8019                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8020                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8021                 END-IF
  8022                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8023                 MOVE ZEROS             TO WS-SUB1
  8024                                           WS-COMMISSION
  8025                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8026                 MOVE '0530'               TO CTBL-SW
  8027                 MOVE ' '                  TO WS-CTBL-READ-SW
  8028                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8029                 IF FIRST-TIME-THROUGH
  8030                    MOVE 'AA'              TO CTBL-BEN-CODE
  8031                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8032                 END-IF
  8033                 IF CTBL-TABLE-FOUND
  8034                    IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 148
* EL050.cbl
  8035                       COMPUTE WS-COMM-CK-AMT =
  8036                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8037                    ELSE
  8038                       COMPUTE WS-COMM-CK-AMT =
  8039                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8040                    END-IF
  8041                    PERFORM 8800-GET-COMP-RATE
  8042                              THRU 8800-EXIT
  8043                 END-IF
  8044              END-IF
  8045              IF AM-COM-TYP (SUB5) = 'I'
  8046                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8047                   + (WS-WK-RATE * 1000)
  8048              END-IF
  8049              IF AM-COM-TYP (SUB5) = 'N'
  8050                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8051                   + (WS-WK-RATE * 1000)
  8052              END-IF
  8053              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8054                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8055                   + (WS-WK-RATE * 1000)
  8056              END-IF
  8057              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8058                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8059                   + (WS-WK-RATE * 1000)
  8060              END-IF
  8061           END-IF
  8062        END-PERFORM
  8063     END-IF
  8064     GO TO 0300-CONTINUE-EDIT.
  8065
  8066 0298-UNLOCK-RETURN.
  8067      PERFORM 9250-UNLOCK-RETURN
  8068      GO TO 9990-RETURN.
  8069
  8070 0299-CERT-NOT-FOUND.
  8071
  8072     MOVE '1'                     TO CERT-STATUS-SW.
  8073
  8074     IF PB-COMPANY-ID = 'UCL'
  8075         IF WS-ERROR = ER-2799
  8076             GO TO 3000-CONTINUE-EDIT.
  8077
  8078     IF NOT PB-CANCELLATION
  8079         GO TO 0300-CONTINUE-EDIT.
  8080
  8081     MOVE ER-2726                  TO  WS-ERROR.
  8082     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8083     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8084     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8085                                    PB-CI-LF-TERM
  8086                                    PB-C-LF-REM-TERM
  8087                                    PB-CI-AH-TERM
  8088                                    PB-C-AH-REM-TERM
  8089                                    PB-CI-LF-BENEFIT-CD
  8090                                    PB-CI-LF-BENEFIT-AMT
  8091                                    PB-CI-LF-ALT-BENEFIT-AMT
  8092                                    PB-CI-LF-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 149
* EL050.cbl
  8093                                    PB-CI-LF-ALT-PREMIUM-AMT
  8094                                    PB-CI-AH-BENEFIT-CD
  8095                                    PB-CI-AH-BENEFIT-AMT
  8096                                    PB-CI-AH-PREMIUM-AMT
  8097                                    PB-CI-PAY-FREQUENCY
  8098                                    PB-CI-LOAN-APR
  8099                                    PB-CI-LOAN-TERM
  8100                                    PB-CI-LIFE-COMMISSION
  8101                                    PB-CI-AH-COMMISSION
  8102                                    PB-CI-CURR-SEQ
  8103                                    PB-CI-AH-CANCEL-AMT
  8104                                    PB-CI-LF-CANCEL-AMT
  8105                                    PB-CI-RATE-DEV-PCT-LF
  8106                                    PB-CI-RATE-DEV-PCT-AH
  8107                                    PB-CI-EXTENTION-DAYS
  8108                                    PB-CI-TERM-IN-DAYS
  8109                                    PB-CI-LIVES
  8110                                    PB-CI-LF-CRIT-PER
  8111                                    PB-CI-AH-CRIT-PER
  8112                                    PB-CI-ADDL-CLP
  8113                                    PB-CI-DDF-IU-RATE-UP.
  8114
  8115     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8116                                    PB-CI-AH-SETTLEMENT-DT
  8117                                    PB-CI-DEATH-DT
  8118                                    PB-CI-LF-PRIOR-CANCEL-DT
  8119                                    PB-CI-AH-PRIOR-CANCEL-DT
  8120                                    PB-CI-ENTRY-DT
  8121                                    PB-CI-LF-EXPIRE-DT
  8122                                    PB-CI-AH-EXPIRE-DT
  8123                                    PB-CI-LOAN-1ST-PMT-DT.
  8124
  8125     IF ACCOUNT-MAST-FOUND
  8126        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8127        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8128
  8129     GO TO 3000-CONTINUE-EDIT.
  8130
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 150
* EL050.cbl
  8132
  8133 0300-CONTINUE-EDIT.
  8134
  8135     IF PB-ISSUE
  8136        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8137            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8138
  8139     IF PB-ISSUE
  8140        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8141            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8142
  8143     IF PB-ISSUE
  8144       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8145          (AM-NO-AH-ONLY)
  8146           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8147               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8148                   MOVE ER-2679 TO WS-ERROR
  8149                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8150
  8151     IF PB-ISSUE
  8152        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8153        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8154        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8155     ELSE
  8156        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8157        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8158        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8159
  8160     MOVE 'N'                    TO PLAN-MASTER-SW
  8161                                    PLAN-MASTER-LIFE-SW
  8162                                    FORM-MASTER-SW
  8163                                    WS-APP-CERT-SW.
  8164
  8165     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8166                                    WS-PL-TOL-LF-REFUND
  8167                                    WS-PL-REF-OVS-AMT
  8168                                    WS-PL-TOL-LF-PREM-PCT
  8169                                    WS-PL-TOL-LF-REFUND-PCT
  8170                                    WS-PL-REF-OVS-PCT
  8171                                    WS-PL-TOL-LF-CLAIM.
  8172
  8173     IF PB-COMPANY-ID = 'NCL'
  8174       IF PB-ISSUE
  8175         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8176             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8177             IF FORM-MASTER-FOUND
  8178                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8179
  8180     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8181        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8182
  8183********************** MON CODE **********************
  8184     IF PB-COMPANY-ID = 'MON'
  8185     IF PB-ISSUE
  8186     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8187        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8188             PB-I-LOAN-APR = ZERO)
  8189               MOVE 14.0         TO PB-I-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 151
* EL050.cbl
  8190******************************************************
  8191
  8192     IF PB-COMPANY-ID = 'NCL'
  8193       IF PB-ISSUE
  8194           IF FORM-MASTER-FOUND
  8195             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8196                AM-DISMBR-COVERAGE
  8197                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8198                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8199                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8200                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8201                                           PB-I-LIFE-BENEFIT-CD.
  8202
  8203     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8204
  8205     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8206         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8207         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8208         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8209         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8210         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8211           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8212             GO TO 0301-LIFE-BENEFIT-SEARCH
  8213         ELSE
  8214             NEXT SENTENCE
  8215     ELSE
  8216         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8217
  8218     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8219     MOVE '4'                    TO CNTL-REC-TYPE.
  8220     MOVE +0                     TO CNTL-SEQ-NO.
  8221     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8222
  8223     MOVE '1' TO RC-SW-2.
  8224     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8225
  8226     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8227        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8228         GO TO 0305-BENEFIT-NOT-FOUND.
  8229
  8230     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8231
  8232 0301-LIFE-BENEFIT-SEARCH.
  8233
  8234     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8235
  8236     IF NO-BENEFIT-FOUND
  8237        GO TO 0305-BENEFIT-NOT-FOUND.
  8238
  8239     IF WS-BEN-CD = '99'
  8240        GO TO 0305-BENEFIT-NOT-FOUND.
  8241
  8242     IF PB-COMPANY-ID = 'NCL'
  8243         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8244             GO TO 0304-LIFE-BENEFIT-FOUND.
  8245
  8246     MOVE +1                     TO SUB5.
  8247     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 152
* EL050.cbl
  8248
  8249* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8250* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8251     IF PB-COMPANY-ID = 'DMD'
  8252         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8253
  8254 0302-EDIT-ACCT-LF-BENEFITS.
  8255
  8256     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8257        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8258           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8259                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8260           GO TO 03XX-GET-LIFE-ERPLAN.
  8261
  8262     IF SUB5 LESS THAN +20
  8263        ADD +1                   TO SUB5
  8264        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8265
  8266     MOVE +1                     TO SUB5.
  8267
  8268     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8269        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8270
  8271 0303-EDIT-DMD-EXTRA-BENEFITS.
  8272
  8273     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8274        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8275           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8276                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8277           GO TO 03XX-GET-LIFE-ERPLAN.
  8278
  8279     IF SUB5 LESS THAN +30
  8280        ADD +1                   TO SUB5
  8281        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8282
  8283     MOVE +1                     TO SUB5.
  8284
  8285 03XX-EDIT-FOR-NINETY-LF.
  8286
  8287***************************************************************
  8288*                                                             *
  8289*    NINETY BENEFIT PLAN TYPES:                               *
  8290*                                                             *
  8291*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8292*      92 = ALL GROUP REDUCING BENEFITS                       *
  8293*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8294*      94 = ALL GROUP LEVEL BENEFITS                          *
  8295*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8296*           BENEFIT CONTROLS.                                 *
  8297*      99 = ALL BENEFITS                                      *
  8298*                                                             *
  8299***************************************************************
  8300
  8301     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8302                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8303
  8304     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8305       AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 153
* EL050.cbl
  8306        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8307        GO TO 03XX-GET-LIFE-ERPLAN.
  8308
  8309     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8310       AND
  8311        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8312        IF CF-REDUCING (SUB3)
  8313           IF (PB-I-INDV-GRP-OVRD = 'I')
  8314              OR
  8315           ((AM-IG = '1') AND
  8316           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8317              OR
  8318           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8319           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8320           (AM-IG NOT = '2'))
  8321              GO TO 03XX-GET-LIFE-ERPLAN.
  8322
  8323     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8324       AND
  8325        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8326        IF CF-REDUCING (SUB3)
  8327           IF (PB-I-INDV-GRP-OVRD = 'G')
  8328              OR
  8329           ((AM-IG = '2') AND
  8330           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8331              OR
  8332           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8333           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8334           (AM-IG NOT = '1'))
  8335              GO TO 03XX-GET-LIFE-ERPLAN.
  8336
  8337     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8338       AND
  8339        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8340        IF CF-LEVEL    (SUB3)
  8341           IF (PB-I-INDV-GRP-OVRD = 'I')
  8342              OR
  8343           ((AM-IG = '1') AND
  8344           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8345              OR
  8346           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8347           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8348            (AM-IG NOT = '2'))
  8349              GO TO 03XX-GET-LIFE-ERPLAN.
  8350
  8351     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8352       AND
  8353        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8354        IF CF-LEVEL    (SUB3)
  8355           IF (PB-I-INDV-GRP-OVRD = 'G')
  8356              OR
  8357           ((AM-IG = '2') AND
  8358           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8359              OR
  8360           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8361           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8362           (AM-IG NOT = '1'))
  8363              GO TO 03XX-GET-LIFE-ERPLAN.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 154
* EL050.cbl
  8364
  8365     IF SUB5 LESS THAN +20
  8366        ADD +1                   TO SUB5
  8367        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8368
  8369     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8370
  8371     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8372        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8373
  8374     MOVE +1                     TO SUB5.
  8375
  8376 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8377
  8378     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8379                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8380
  8381     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8382       AND
  8383        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8384        GO TO 03XX-GET-LIFE-ERPLAN.
  8385
  8386     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8387       AND
  8388        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8389        IF CF-REDUCING (SUB3)
  8390           IF (PB-I-INDV-GRP-OVRD = 'I')
  8391              OR
  8392           ((AM-IG = '1') AND
  8393           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8394              OR
  8395           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8396           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8397           (AM-IG NOT = '2'))
  8398              GO TO 03XX-GET-LIFE-ERPLAN.
  8399
  8400     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8401       AND
  8402        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8403        IF CF-REDUCING (SUB3)
  8404           IF (PB-I-INDV-GRP-OVRD = 'G')
  8405              OR
  8406           ((AM-IG = '2') AND
  8407           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8408              OR
  8409           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8410           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8411           (AM-IG NOT = '1'))
  8412              GO TO 03XX-GET-LIFE-ERPLAN.
  8413
  8414     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8415       AND
  8416        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8417        IF CF-LEVEL    (SUB3)
  8418           IF (PB-I-INDV-GRP-OVRD = 'I')
  8419              OR
  8420           ((AM-IG = '1') AND
  8421           (PB-I-INDV-GRP-OVRD NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 155
* EL050.cbl
  8422              OR
  8423           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8424           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8425            (AM-IG NOT = '2'))
  8426              GO TO 03XX-GET-LIFE-ERPLAN.
  8427
  8428     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8429       AND
  8430        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8431        IF CF-LEVEL    (SUB3)
  8432           IF (PB-I-INDV-GRP-OVRD = 'G')
  8433              OR
  8434           ((AM-IG = '2') AND
  8435           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8436              OR
  8437           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8438           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8439           (AM-IG NOT = '1'))
  8440              GO TO 03XX-GET-LIFE-ERPLAN.
  8441
  8442     IF SUB5 LESS THAN +30
  8443        ADD +1                   TO SUB5
  8444        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8445
  8446     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8447
  8448 03XX-EDIT-FOR-NINETY-LF-CONT.
  8449
  8450     MOVE +99                    TO SUB5.
  8451
  8452     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8453        IF PB-ISSUE
  8454           MOVE ER-1924          TO  WS-ERROR
  8455           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8456
  8457     GO TO 0304-LIFE-BENEFIT-FOUND.
  8458
  8459 03XX-GET-LIFE-ERPLAN.
  8460
  8461     IF WK-PLAN-ADDR EQUAL +0
  8462        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8463
  8464     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8465     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8466     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8467     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8468     MOVE 'Y'                    TO PLAN-MASTER-SW
  8469                                    PLAN-MASTER-LIFE-SW.
  8470     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8471
  8472 03XX-ERPLAN-LIFE-GETMAIN.
  8473
  8474     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8475     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8476
  8477 03XX-ERPLAN-LIFE-READ.
  8478
  8479     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 156
* EL050.cbl
  8480     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8481     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8482     MOVE PB-SV-STATE            TO PLAN-STATE.
  8483     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8484     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8485     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8486     MOVE WS-SAVE-BENEFIT-REVISION
  8487                                 TO PLAN-REVISION-NO.
  8488
  8489     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8490     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8491
  8492     IF PB-COMPANY-ID = 'NCL'
  8493       IF NOT LF-PLAN-MASTER-FOUND
  8494         IF NOT PB-POLICY-IS-DECLINED  AND
  8495            NOT PB-POLICY-IS-VOIDED
  8496             MOVE  ER-1921         TO  WS-ERROR
  8497             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8498             GO TO 0304-LIFE-BENEFIT-FOUND.
  8499
  8500     IF NOT LF-PLAN-MASTER-FOUND
  8501        GO TO 0304-LIFE-BENEFIT-FOUND.
  8502
  8503 XXXX-CHECK-LF-PLAN-KEY.
  8504
  8505     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8506        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8507        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8508        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8509        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8510        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8511        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8512        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8513        MOVE 'N'                 TO PLAN-MASTER-SW
  8514          GO TO 03XX-ERPLAN-LIFE-READ.
  8515
  8516     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8517
  8518     IF  PB-CANCELLATION
  8519         GO TO  0303-LF-ACCT-BEN-FOUND.
  8520
  8521     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8522        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8523           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8524           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8525              MOVE ER-2644             TO WS-ERROR
  8526              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8527           ELSE
  8528              NEXT SENTENCE
  8529        ELSE
  8530           IF PB-COMPANY-ID NOT = 'NCL'
  8531              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8532                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8533
  8534 0303-LF-ACCT-BEN-FOUND.
  8535
  8536     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8537
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 157
* EL050.cbl
  8538     IF PL-DEV-CODE NOT = SPACES
  8539        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8540
  8541     IF PL-DEV-PCT NUMERIC AND
  8542        PL-DEV-PCT NOT = ZEROS
  8543        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8544
  8545     IF PL-TOL-PREM-AMT GREATER THAN +0
  8546        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8547
  8548     IF PL-TOL-REF-AMT GREATER THAN +0
  8549        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8550
  8551     IF PL-TOL-PREM-PCT GREATER THAN +0
  8552        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8553
  8554     IF PL-TOL-REF-PCT GREATER THAN +0
  8555        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8556
  8557     IF PL-TOL-CLM-AMT GREATER THAN +0
  8558        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8559
  8560     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8561                          PL-OVER-SHORT-AMT > +0
  8562        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8563
  8564     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8565                          PL-OVER-SHORT-PCT > +0
  8566        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8567
  8568     IF PL-SALES-TAX NUMERIC AND
  8569                          PL-SALES-TAX > +0
  8570         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8571
  8572     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8573        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8574                                    WS-IG-OVRD-AM.
  8575
  8576 0304-LIFE-BENEFIT-FOUND.
  8577
  8578     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8579
  8580     IF PB-ISSUE
  8581        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8582     ELSE
  8583        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8584
  8585     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8586     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8587     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8588     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8589     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8590                                         WS-LF-REFUND-CALC.
  8591
  8592     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8593        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8594
  8595     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 158
* EL050.cbl
  8596        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8597     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8598
  8599     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8600     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8601     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8602     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8603     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8604     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8605
  8606     IF PB-COMPANY-ID = 'NCL'  AND
  8607        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8608         NEXT SENTENCE
  8609     ELSE
  8610         IF SUB5 NOT GREATER THAN +20
  8611            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8612               MOVE WS-SAVE-BENEFIT-REM-TERM
  8613                                      TO WS-AM-LF-BENE-REM-TERM
  8614                                         EC-BR-LF-REM-TERM-CALC.
  8615
  8616     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8617     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8618
  8619     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8620
  8621 0305-BENEFIT-NOT-FOUND.
  8622
  8623     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8624     MOVE ER-2604                TO WS-ERROR.
  8625     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8626
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 159
* EL050.cbl
  8628
  8629 0310-FIND-AH-BENEFIT-RECORD.
  8630
  8631     MOVE 'N'                    TO PLAN-MASTER-SW
  8632                                    PLAN-MASTER-AH-SW.
  8633
  8634     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8635                                    WS-PL-TOL-AH-REFUND
  8636                                    WS-AH-PL-REF-OVS-AMT
  8637                                    WS-PL-TOL-AH-PREM-PCT
  8638                                    WS-PL-TOL-AH-REFUND-PCT
  8639                                    WS-AH-PL-REF-OVS-PCT
  8640                                    WS-PL-TOL-AH-CLAIM.
  8641
  8642
  8643     IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8644        MOVE SPACES              TO PB-I-AH-INPUT-CD.
  8645
  8646     IF PB-I-AH-INPUT-CD NOT EQUAL SPACES AND
  8647       (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8648          GO TO 0399-BENEFIT-NOT-FOUND.
  8649
  8650     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8651        GO TO 0400-FIND-CARRIER.
  8652
  8653     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8654
  8655     IF WK-AH-BEN-ADDR NOT = ZEROS
  8656         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8657         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8658         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8659         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8660           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8661             GO TO 0311-AH-BENEFIT-SEARCH
  8662         ELSE
  8663             NEXT SENTENCE
  8664     ELSE
  8665         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8666
  8667     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8668     MOVE '5'                    TO CNTL-REC-TYPE.
  8669     MOVE +0                     TO CNTL-SEQ-NO.
  8670     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8671
  8672     MOVE '2' TO RC-SW-2.
  8673     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8674
  8675     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8676        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8677          GO TO 0399-BENEFIT-NOT-FOUND.
  8678
  8679     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8680
  8681 0311-AH-BENEFIT-SEARCH.
  8682
  8683     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8684
  8685     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 160
* EL050.cbl
  8686         GO TO 0399-BENEFIT-NOT-FOUND.
  8687
  8688     IF WS-BEN-CD = '99'
  8689        GO TO 0399-BENEFIT-NOT-FOUND.
  8690
  8691     IF PB-COMPANY-ID  =  'NCL'
  8692         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8693             GO TO 0314-A-H-BENEFIT-FOUND.
  8694
  8695     MOVE +1                     TO SUB5.
  8696     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8697
  8698* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8699* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8700     IF PB-COMPANY-ID = 'DMD'
  8701         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8702
  8703 0312-EDIT-ACCT-AH-BENEFITS.
  8704
  8705     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8706        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8707           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8708                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8709           GO TO 03XX-GET-AH-ERPLAN.
  8710
  8711     IF SUB5 LESS THAN +20
  8712        ADD +1                   TO SUB5
  8713        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8714
  8715     MOVE +1                     TO SUB5.
  8716
  8717     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8718        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8719
  8720 0313-EDIT-DMD-EXTRA-BENEFITS.
  8721
  8722     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8723        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8724           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8725                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8726           GO TO 03XX-GET-AH-ERPLAN.
  8727
  8728     IF SUB5 LESS THAN +30
  8729        ADD +1                   TO SUB5
  8730        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8731
  8732     MOVE +1                     TO SUB5.
  8733
  8734 03XX-EDIT-FOR-NINETY-AH.
  8735
  8736***************************************************************
  8737*                                                             *
  8738*    NINETY BENEFIT PLAN TYPES:                               *
  8739*                                                             *
  8740*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8741*      92 = ALL GROUP REDUCING BENEFITS.                      *
  8742*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8743*           BENEFIT CONTROLS.                                 *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 161
* EL050.cbl
  8744*      99 = ALL BENEFITS.                                     *
  8745*                                                             *
  8746***************************************************************
  8747
  8748     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8749                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8750
  8751     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8752       AND
  8753        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8754        GO TO 03XX-GET-AH-ERPLAN.
  8755
  8756     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  8757       AND
  8758        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8759           IF (PB-I-INDV-GRP-OVRD = 'I')
  8760              OR
  8761           ((AM-IG = '1') AND
  8762           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8763              OR
  8764           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8765           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8766           (AM-IG NOT = '2'))
  8767              GO TO 03XX-GET-AH-ERPLAN.
  8768
  8769     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  8770       AND
  8771        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8772           IF (PB-I-INDV-GRP-OVRD = 'G')
  8773              OR
  8774           ((AM-IG = '2') AND
  8775           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8776              OR
  8777           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8778           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8779           (AM-IG NOT = '1'))
  8780              GO TO 03XX-GET-AH-ERPLAN.
  8781
  8782     IF SUB5 LESS THAN +20
  8783        ADD +1                   TO SUB5
  8784        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8785
  8786     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8787        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  8788
  8789     MOVE +1                    TO SUB5.
  8790
  8791 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8792
  8793     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8794                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  8795
  8796     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8797       AND
  8798        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8799        GO TO 03XX-GET-AH-ERPLAN.
  8800
  8801     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 162
* EL050.cbl
  8802       AND
  8803        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8804           IF (PB-I-INDV-GRP-OVRD = 'I')
  8805              OR
  8806           ((AM-IG = '1') AND
  8807           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8808              OR
  8809           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8810           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8811           (AM-IG NOT = '2'))
  8812              GO TO 03XX-GET-AH-ERPLAN.
  8813
  8814     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  8815       AND
  8816        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  8817           IF (PB-I-INDV-GRP-OVRD = 'G')
  8818              OR
  8819           ((AM-IG = '2') AND
  8820           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8821              OR
  8822           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8823           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8824           (AM-IG NOT = '1'))
  8825              GO TO 03XX-GET-AH-ERPLAN.
  8826
  8827     IF SUB5 LESS THAN +30
  8828        ADD +1                   TO SUB5
  8829        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  8830
  8831 03XX-EDIT-FOR-NINETY-AH-CONT.
  8832
  8833     MOVE +99                    TO SUB5.
  8834
  8835     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8836
  8837     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8838        IF PB-ISSUE
  8839           MOVE ER-1925          TO  WS-ERROR
  8840           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8841
  8842     GO TO 0314-A-H-BENEFIT-FOUND.
  8843
  8844 03XX-GET-AH-ERPLAN.
  8845
  8846     IF WK-PLAN-ADDR EQUAL +0
  8847         GO TO 03XX-ERPLAN-AH-GETMAIN.
  8848
  8849     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8850     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8851     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8852     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  8853     MOVE 'Y'                    TO PLAN-MASTER-SW
  8854                                    PLAN-MASTER-AH-SW.
  8855*****GO TO XXXX-CHECK-AH-PLAN-KEY.
  8856     GO TO 03XX-ERPLAN-AH-READ.
  8857
  8858 03XX-ERPLAN-AH-GETMAIN.
  8859
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 163
* EL050.cbl
  8860     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8861     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8862
  8863 03XX-ERPLAN-AH-READ.
  8864
  8865     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8866     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8867     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8868     MOVE PB-SV-STATE            TO PLAN-STATE.
  8869     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8870     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  8871     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8872     MOVE WS-SAVE-BENEFIT-REVISION
  8873                                 TO PLAN-REVISION-NO.
  8874
  8875     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8876     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  8877
  8878     IF PB-COMPANY-ID = 'NCL'
  8879       IF NOT AH-PLAN-MASTER-FOUND
  8880         IF NOT PB-POLICY-IS-DECLINED  AND
  8881            NOT PB-POLICY-IS-VOIDED
  8882             MOVE  ER-1922         TO  WS-ERROR
  8883             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8884             GO TO 0314-A-H-BENEFIT-FOUND.
  8885
  8886     IF NOT AH-PLAN-MASTER-FOUND
  8887        GO TO 0314-A-H-BENEFIT-FOUND.
  8888
  8889 XXXX-CHECK-AH-PLAN-KEY.
  8890
  8891     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8892        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8893        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8894        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8895        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8896        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8897        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8898        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8899        MOVE 'N'                 TO PLAN-MASTER-SW
  8900          GO TO 03XX-ERPLAN-AH-READ.
  8901
  8902     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  8903
  8904     IF  PB-CANCELLATION
  8905         GO TO  0313-AH-ACCT-BEN-FOUND.
  8906
  8907     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8908       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8909          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8910          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8911             MOVE ER-2644             TO WS-ERROR
  8912             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8913          ELSE
  8914             NEXT SENTENCE
  8915       ELSE
  8916          IF PB-COMPANY-ID NOT = 'NCL'
  8917             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 164
* EL050.cbl
  8918                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8919
  8920 0313-AH-ACCT-BEN-FOUND.
  8921
  8922     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  8923
  8924     IF PL-DEV-CODE NOT = SPACES
  8925        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  8926
  8927     IF PL-DEV-PCT NUMERIC AND
  8928        PL-DEV-PCT NOT = ZEROS
  8929        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  8930
  8931     IF PL-TOL-PREM-AMT NOT EQUAL +0
  8932        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  8933
  8934     IF PL-TOL-REF-AMT NOT EQUAL +0
  8935        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  8936
  8937     IF PL-TOL-PREM-PCT GREATER THAN +0
  8938        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  8939
  8940     IF PL-TOL-REF-PCT GREATER THAN +0
  8941        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  8942
  8943     IF PL-TOL-CLM-AMT NOT EQUAL +0
  8944        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  8945
  8946     IF PL-OVER-SHORT-AMT NUMERIC AND
  8947                          PL-OVER-SHORT-AMT > +0
  8948        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  8949
  8950     IF PL-OVER-SHORT-PCT NUMERIC AND
  8951                          PL-OVER-SHORT-PCT > +0
  8952        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  8953
  8954     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8955        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  8956        IF WS-IG-OVRD-AM EQUAL SPACES
  8957            MOVE PL-IG           TO WS-IG-OVRD-AM.
  8958
  8959 0314-A-H-BENEFIT-FOUND.
  8960
  8961     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  8962
  8963     IF PB-ISSUE
  8964        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  8965       ELSE
  8966        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  8967
  8968     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  8969     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  8970     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  8971     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  8972                                         WS-AH-REFUND-CALC.
  8973
  8974     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8975        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 165
* EL050.cbl
  8976
  8977     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8978        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  8979     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  8980
  8981     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  8982     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  8983     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  8984     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  8985     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  8986     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  8987
  8988     IF PB-COMPANY-ID = 'NCL'  AND
  8989        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8990         NEXT SENTENCE
  8991     ELSE
  8992         IF SUB5 NOT GREATER THAN +20
  8993            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  8994                MOVE WS-SAVE-BENEFIT-REM-TERM
  8995                                      TO WS-AM-AH-BENE-REM-TERM
  8996                                         EC-BR-AH-REM-TERM-CALC.
  8997
  8998     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  8999     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9000
  9001     GO TO 0400-FIND-CARRIER.
  9002
  9003 0399-BENEFIT-NOT-FOUND.
  9004
  9005     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9006     MOVE ER-2605                TO WS-ERROR.
  9007     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9008
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 166
* EL050.cbl
  9010
  9011 0400-FIND-CARRIER.
  9012
  9013     MOVE PB-SV-CARRIER          TO WS-CARR.
  9014
  9015     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9016     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9017     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9018     MOVE '6'                    TO CNTL-REC-TYPE.
  9019
  9020*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9021     MOVE SPACE                  TO WS-DMD-RATING-SW
  9022                                    EC-BR-DMD-RATING-SW.
  9023
  9024     MOVE '2'                    TO RC-SW-1.
  9025     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9026
  9027     IF NOT CF-CARRIER-MASTER
  9028        GO TO 0400-CARRIER-NOT-FOUND.
  9029
  9030 0400-BUILD-CARR-TOL.
  9031
  9032     IF CF-CR-TOL-PREM NUMERIC AND
  9033        CF-CR-TOL-PREM GREATER THAN +0
  9034        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9035                                    WS-TOL-AH-PREM.
  9036
  9037     IF CF-CR-TOL-REFUND NUMERIC AND
  9038        CF-CR-TOL-REFUND GREATER THAN +0
  9039        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9040                                    WS-TOL-AH-REFUND.
  9041
  9042     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9043        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9044        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9045                                    WS-AH-REFUND-OVS-AMT.
  9046
  9047     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9048        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9049        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9050                                    WS-AH-REFUND-OVS-PCT.
  9051
  9052     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9053        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9054        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9055                                    WS-TOL-AH-PREM-PCT.
  9056
  9057     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9058        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9059        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9060                                     WS-TOL-AH-REFUND-PCT.
  9061
  9062     IF CF-COMPANY-ID EQUAL 'DMD'
  9063         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9064                                    EC-BR-DMD-RATING-SW.
  9065
  9066     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9067     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 167
* EL050.cbl
  9068        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9069     END-IF
  9070     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9071        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9072     END-IF
  9073     IF WS-TOL-CLP-PCT = ZEROS
  9074        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9075     END-IF
  9076
  9077     IF WS-SPP-LEASE-COMM = ZEROS
  9078        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9079     END-IF
  9080     GO TO 0400-FIND-ERCOMP.
  9081
  9082 0400-CARRIER-NOT-FOUND.
  9083
  9084     MOVE ER-2602                TO WS-ERROR.
  9085     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9086
  9087 0400-FIND-ERCOMP.
  9088     IF PB-COMPANY-ID = 'DCC'
  9089        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9090           (WS-SUB1 > +10)
  9091           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9092                 OR 'A' OR 'N'
  9093              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9094              MOVE PB-CARRIER    TO COMP-CARRIER
  9095              MOVE PB-GROUPING   TO COMP-GROUPING
  9096              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9097              MOVE AM-AGT (WS-SUB1)
  9098                                 TO COMP-FIN-RESP
  9099              MOVE 'G'           TO COMP-TYPE
  9100              PERFORM 8582-READ-COMPENSATION-MASTER
  9101                                 THRU 8582-EXIT
  9102              IF COMP-MASTER-FOUND
  9103                 IF CO-GA-INACTIVE
  9104                    MOVE ER-2763 TO WS-ERROR
  9105                    PERFORM 9900-ERROR-FORMAT
  9106                                 THRU 9900-EXIT
  9107                    MOVE +11     TO WS-SUB1
  9108                 END-IF
  9109                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9110                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9111                    MOVE ER-2788 TO WS-ERROR
  9112                    PERFORM 9900-ERROR-FORMAT
  9113                                 THRU 9900-EXIT
  9114                    MOVE +11     TO WS-SUB1
  9115                 END-IF
  9116              END-IF
  9117           END-IF
  9118        END-PERFORM
  9119     END-IF
  9120     IF (PB-COMPANY-ID = 'DCC')
  9121               AND
  9122        ((WS-LF-BEN-CATEGORY = 'D')
  9123        OR (WS-AH-BEN-CATEGORY = 'D')
  9124        OR (AM-DCC-PRODUCT-CODE = 'DDF'))
  9125        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 168
* EL050.cbl
  9126           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9127                                    WS-CLP-STATE
  9128        ELSE
  9129           MOVE SPACES           TO PB-I-CLP-STATE
  9130                                    WS-CLP-STATE
  9131        END-IF
  9132     END-IF
  9133
  9134     IF (PB-COMPANY-ID = 'DCC')
  9135        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9136        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9137        CONTINUE
  9138     ELSE
  9139        GO TO 0400-FIND-STATE-RECORD
  9140     END-IF
  9141     MOVE SPACES                 TO WS-CLP-STATE
  9142     MOVE +0                     TO WS-BANK-FEE
  9143                                    WS-BANK-LFEE
  9144                                    WS-BANK-NOCHRGB
  9145
  9146     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9147     IF (PB-ISSUE)
  9148        AND (PB-I-BANK-NUMBER NOT =
  9149            SPACES AND ZEROS AND LOW-VALUES)
  9150        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9151     ELSE
  9152        IF (PB-CANCELLATION)
  9153           AND (PB-CI-BANK-NUMBER NOT =
  9154                SPACES AND ZEROS AND LOW-VALUES)
  9155           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9156        END-IF
  9157     END-IF
  9158     IF COMP-FIN-RESP NOT = LOW-VALUES
  9159        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9160        MOVE PB-CARRIER          TO COMP-CARRIER
  9161        MOVE PB-GROUPING         TO COMP-GROUPING
  9162        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9163        MOVE 'B'                 TO COMP-TYPE
  9164        PERFORM 8582-READ-COMPENSATION-MASTER
  9165                                 THRU 8582-EXIT
  9166        IF COMP-MASTER-FOUND
  9167           IF CO-MAX-BANK-FEE NOT NUMERIC
  9168              MOVE +0            TO CO-MAX-BANK-FEE
  9169           END-IF
  9170           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9171              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9172           END-IF
  9173           IF CO-GA-INACTIVE
  9174              MOVE ER-2763       TO WS-ERROR
  9175              PERFORM 9900-ERROR-FORMAT
  9176                                 THRU 9900-EXIT
  9177           END-IF
  9178           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9179              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9180              MOVE ER-2788 TO WS-ERROR
  9181              PERFORM 9900-ERROR-FORMAT
  9182                                 THRU 9900-EXIT
  9183              MOVE +11     TO WS-SUB1
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 169
* EL050.cbl
  9184           END-IF
  9185           IF WS-AH-BEN-CATEGORY = 'G'
  9186              MOVE CO-MAX-BANK-FEE
  9187                                 TO WS-BANK-FEE
  9188                                    PB-I-BANK-FEE
  9189           ELSE
  9190              MOVE CO-MAX-BANK-FEE-LEASE
  9191                                 TO WS-BANK-LFEE
  9192                                    PB-I-BANK-FEE
  9193           END-IF
  9194           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9195              AND (WS-AH-REFUND-CALC = 'G'))
  9196                        OR
  9197              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9198              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9199              CONTINUE
  9200           ELSE
  9201              MOVE ER-2789 TO WS-ERROR
  9202              PERFORM 9900-ERROR-FORMAT
  9203                                 THRU 9900-EXIT
  9204           END-IF
  9205           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9206                                    PB-I-CLP-STATE
  9207           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9208           MOVE CO-CARRIER       TO BXRF-CARRIER
  9209           MOVE CO-GROUPING      TO BXRF-GROUPING
  9210           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9211           MOVE BXRF-MAX-REC-LENGTH
  9212                                 TO BXRF-REC-LENGTH
  9213           PERFORM 8584-READ-BANK-CROSS-REF
  9214                                 THRU 8584-EXIT
  9215           IF BXRF-MASTER-FOUND
  9216              MOVE ' '           TO BANK-ACCT-SW
  9217              MOVE BK-BANK-POINTER-CNT
  9218                                 TO BK-BANK-POINTER-CNT
  9219              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9220                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9221                 OR (BANK-ACCT-FOUND)
  9222                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9223                    AND (BK-AM-EXP-DT (WS-SUB1)
  9224                                 > PB-CERT-EFF-DT)
  9225                    AND (BK-AM-EFF-DT (WS-SUB1)
  9226                                 NOT > PB-CERT-EFF-DT)
  9227                    SET BANK-ACCT-FOUND TO TRUE
  9228                 END-IF
  9229              END-PERFORM
  9230              IF NOT BANK-ACCT-FOUND
  9231                 MOVE ZEROS      TO WS-BANK-FEE
  9232                                    WS-BANK-LFEE
  9233                 MOVE ER-2869    TO WS-ERROR
  9234                 PERFORM 9900-ERROR-FORMAT
  9235                                 THRU 9900-EXIT
  9236              ELSE
  9237                 PERFORM 5000-PROCESS-REPS
  9238                                 THRU 5000-EXIT
  9239                 IF AGENT-MASTER-FOUND
  9240                    MOVE +0      TO WS-BANK-FEE
  9241                                    WS-BANK-LFEE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 170
* EL050.cbl
  9242*                   MOVE AG-SPP-FEES (1)
  9243*                                TO PB-I-BANK-FEE
  9244*                                   WS-BANK-FEE
  9245                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9246                       (WS-SUB1 > +10)
  9247                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9248                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9249                       END-IF
  9250                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9251                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9252                       END-IF
  9253                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9254                          AG-SPP-FEES (WS-SUB1)
  9255                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9256                          AG-SPP-LFEES (WS-SUB1)
  9257                    END-PERFORM
  9258                    IF WS-AH-BEN-CATEGORY = 'G'
  9259                       MOVE WS-BANK-FEE
  9260                                 TO PB-I-BANK-FEE
  9261                    ELSE
  9262                       MOVE WS-BANK-LFEE
  9263                                 TO PB-I-BANK-FEE
  9264                    END-IF
  9265                 END-IF
  9266              END-IF
  9267           END-IF
  9268        ELSE
  9269           MOVE ER-2879          TO WS-ERROR
  9270           PERFORM 9900-ERROR-FORMAT
  9271                                 THRU 9900-EXIT
  9272        END-IF
  9273     ELSE
  9274        MOVE ER-2879             TO WS-ERROR
  9275        PERFORM 9900-ERROR-FORMAT
  9276                                 THRU 9900-EXIT
  9277     END-IF
  9278     IF WS-AH-BEN-CATEGORY = 'G'
  9279        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9280        + WS-BANK-FEE
  9281     ELSE
  9282        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9283        + WS-BANK-LFEE
  9284     END-IF
  9285     .
  9286 0400-FIND-STATE-RECORD.
  9287
  9288     IF WK-STATE-ADDR NOT = ZEROS
  9289         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9290         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9291         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9292         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9293         IF PB-SV-STATE = CF-STATE-CODE
  9294             GO TO 0405-CONTINUE-EDIT
  9295         ELSE
  9296             NEXT SENTENCE
  9297     ELSE
  9298         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9299
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 171
* EL050.cbl
  9300     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9301     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9302     MOVE '3'                    TO CNTL-REC-TYPE.
  9303     MOVE +0                     TO CNTL-SEQ-NO.
  9304
  9305     MOVE '3'                    TO RC-SW-2.
  9306     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9307
  9308     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9309        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9310        PB-SV-STATE   NOT = CF-STATE-CODE)
  9311        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9312                                    WS-TOL-AH-CLAIM
  9313                                    WS-MINIMUM-REFUND
  9314                                    WS-TOL-LF-PREM
  9315                                    WS-TOL-AH-PREM
  9316                                    WS-TOL-LF-REFUND
  9317                                    WS-TOL-AH-REFUND
  9318                                    EC-ST-TOL-PREM-PCT
  9319                                    WS-TOL-LF-PREM-PCT
  9320                                    WS-TOL-AH-PREM-PCT
  9321                                    EC-ST-TOL-REFUND-PCT
  9322                                    WS-TOL-LF-REFUND-PCT
  9323                                    WS-TOL-AH-REFUND-PCT
  9324                                    EC-ST-TOL-PREM
  9325                                    EC-ST-TOL-REFUND
  9326                                    EC-ST-FST-PMT-DAYS-MAX
  9327                                    WS-FREE-LOOK-PERIOD
  9328                                    WS-ST-LF-PREM-TAX
  9329                                    WS-ST-AH-PREM-TAX-I
  9330                                    WS-ST-AH-PREM-TAX-G
  9331                                    WS-BANK-FEE
  9332                                    WS-BANK-LFEE
  9333                                    WS-TOL-CLP-PCT
  9334                                    WS-SPP-LEASE-COMM
  9335        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9336                                    EC-ST-FST-PMT-DAYS-CHG
  9337                                    WS-LF-REM-TERM-CALC
  9338                                    WS-LF-REFUND-CALC
  9339                                    EC-ST-LF-REM-TERM-CALC
  9340                                    EC-ST-LF-REFUND-CALC
  9341                                    WS-AH-REM-TERM-CALC
  9342                                    WS-AH-REFUND-CALC
  9343                                    WS-LF-BEN-CATEGORY
  9344                                    WS-AH-BEN-CATEGORY
  9345                                    WS-CLP-STATE
  9346                                    WS-ST-REFUND-CLAIM-FLAG
  9347                                    EC-ST-AH-REM-TERM-CALC
  9348                                    EC-ST-AH-REFUND-CALC
  9349          GO TO 0499-STATE-NOT-FOUND.
  9350
  9351     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9352
  9353 0405-CONTINUE-EDIT.
  9354
  9355     IF PB-CERT-PRIME NOT NUMERIC
  9356        MOVE ER-2722             TO WS-ERROR
  9357        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 172
* EL050.cbl
  9358                                 THRU 9900-EXIT
  9359     END-IF
  9360*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9361*       MOVE +0                  TO SUB3
  9362*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9363*       IF SUB3 > +0
  9364*          MOVE ER-2722          TO WS-ERROR
  9365*          PERFORM 9900-ERROR-FORMAT
  9366*                                THRU 9900-EXIT
  9367*       END-IF
  9368*    END-IF
  9369*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9370*       IF PB-CERT-PRIME NOT NUMERIC
  9371*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9372*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9373*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9374*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9375*
  9376*          MOVE ER-2722          TO WS-ERROR
  9377*          PERFORM 9900-ERROR-FORMAT
  9378*                                THRU 9900-EXIT
  9379*       END-IF
  9380*    END-IF
  9381
  9382     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9383
  9384     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9385        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9386                                    WS-TOL-AH-CLAIM.
  9387
  9388     IF CF-ST-REFUND-MIN NOT NUMERIC
  9389        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9390
  9391     IF CF-ST-REFUND-MIN NOT = ZEROS
  9392        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9393
  9394     IF CF-ST-TOL-PREM  NOT = ZEROS
  9395        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9396                                    WS-TOL-AH-PREM
  9397        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9398
  9399     IF CF-ST-TOL-REFUND NOT = ZEROS
  9400        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9401                                    WS-TOL-AH-REFUND
  9402        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9403
  9404     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9405        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9406        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9407                                    WS-AH-REFUND-OVS-AMT
  9408                                    EC-ST-OVR-SHT-AMT.
  9409
  9410     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9411        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9412        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9413                                    WS-TOL-LF-PREM-PCT
  9414                                    WS-TOL-AH-PREM-PCT.
  9415
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 173
* EL050.cbl
  9416     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9417        CF-ST-TOL-REF-PCT GREATER THAN +0
  9418        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9419                                    WS-TOL-LF-REFUND-PCT
  9420                                    WS-TOL-AH-REFUND-PCT.
  9421
  9422     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9423        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9424        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9425                                    WS-AH-REFUND-OVS-PCT
  9426                                    EC-ST-OVR-SHT-PCT.
  9427
  9428     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9429     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9430
  9431     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9432          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9433
  9434     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9435     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9436     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9437
  9438     IF CF-ST-LF-PREM-TAX NUMERIC
  9439        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9440     END-IF
  9441     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9442        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9443     END-IF
  9444     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9445        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9446     END-IF
  9447
  9448     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9449         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9450     END-IF.
  9451
  9452     IF WS-LF-BENEFIT-CD = ZEROS
  9453        GO TO 0410-CHECK-AH.
  9454
  9455     IF CF-ST-RT-CALC NOT = SPACES
  9456        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9457                                    EC-ST-LF-REM-TERM-CALC
  9458     END-IF
  9459
  9460     IF WS-LF-COVERAGE-TYPE = 'R'
  9461        IF WS-LF-EARNINGS-CALC = '5'
  9462           IF CF-ST-RF-LN-CALC > '0'
  9463              MOVE CF-ST-RF-LN-CALC
  9464                                 TO WS-LF-REFUND-CALC
  9465                                    EC-ST-LF-REFUND-CALC
  9466           END-IF
  9467        ELSE
  9468           IF CF-ST-RF-LR-CALC > '0'
  9469              MOVE CF-ST-RF-LR-CALC
  9470                                 TO WS-LF-REFUND-CALC
  9471                                    EC-ST-LF-REFUND-CALC
  9472           END-IF
  9473        END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 174
* EL050.cbl
  9474     ELSE
  9475        IF CF-ST-RF-LL-CALC > '0'
  9476           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9477                                    EC-ST-LF-REFUND-CALC
  9478        END-IF
  9479     END-IF
  9480
  9481     IF CF-ST-RT-CALC NOT = SPACES
  9482        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9483                                    EC-ST-LF-REM-TERM-CALC
  9484     END-IF
  9485
  9486     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9487     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9488
  9489     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9490
  9491     IF NO-BENEFIT-FOUND
  9492        GO TO 0410-CHECK-AH.
  9493
  9494     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9495        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9496                                 TO EC-ST-LF-REM-TERM-CALC
  9497                                    WS-LF-REM-TERM-CALC
  9498     END-IF
  9499
  9500     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9501        MOVE CF-ST-REFUND-CALC (SUB3)
  9502                                 TO WS-LF-REFUND-CALC
  9503                                    EC-ST-LF-REFUND-CALC
  9504     END-IF
  9505*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9506
  9507     .
  9508 0410-CHECK-AH.
  9509
  9510     IF WS-AH-BENEFIT-CD = ZEROS
  9511        GO TO 0500-SET-ACCOUNT.
  9512
  9513     IF CF-ST-RT-CALC NOT = SPACES
  9514        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9515                                    EC-ST-AH-REM-TERM-CALC
  9516     END-IF
  9517
  9518     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9519        IF CF-ST-RF-CP-CALC > '0'
  9520           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9521                                    EC-ST-AH-REFUND-CALC
  9522        END-IF
  9523     ELSE
  9524        IF CF-ST-RF-AH-CALC > '0'
  9525           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9526                                    EC-ST-AH-REFUND-CALC
  9527        END-IF
  9528     END-IF
  9529     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9530     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9531
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 175
* EL050.cbl
  9532     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9533
  9534     IF NO-BENEFIT-FOUND
  9535        GO TO 0500-SET-ACCOUNT.
  9536
  9537     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9538        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9539                                 TO WS-AH-REM-TERM-CALC
  9540                                    EC-ST-AH-REM-TERM-CALC
  9541     END-IF
  9542
  9543     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9544        MOVE CF-ST-REFUND-CALC (SUB3)
  9545                                 TO WS-AH-REFUND-CALC
  9546                                    EC-ST-AH-REFUND-CALC
  9547     END-IF
  9548
  9549*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9550
  9551     GO TO 0500-SET-ACCOUNT.
  9552
  9553 0499-STATE-NOT-FOUND.
  9554
  9555     MOVE ER-2603                TO WS-ERROR.
  9556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9557
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 176
* EL050.cbl
  9559
  9560 0500-SET-ACCOUNT.
  9561*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9562     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9563        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9564        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9565        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9566        MOVE '3'                 TO CNTL-REC-TYPE
  9567        MOVE +0                  TO CNTL-SEQ-NO
  9568
  9569        MOVE '3'                 TO RC-SW-2
  9570        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9571
  9572        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9573           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9574           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9575           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9576                                    WS-ST-AH-PREM-TAX-I
  9577                                    WS-ST-AH-PREM-TAX-G
  9578        ELSE
  9579           IF CF-ST-LF-PREM-TAX NUMERIC
  9580              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9581           END-IF
  9582           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9583              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9584           END-IF
  9585           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9586              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9587           END-IF
  9588        END-IF
  9589        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9590     END-IF
  9591*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9592*  FOR DCC ONLY
  9593     IF PB-COMPANY-ID = 'DCC'
  9594
  9595     MOVE ' '                    TO STAT-MASTER-SW
  9596     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9597     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9598     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9599     MOVE PB-STATE               TO ELSTAT-STATE
  9600     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9601        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9602     END-IF
  9603
  9604     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9605     SET BIN-TO-GREG             TO TRUE
  9606     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9607     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9608     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9609
  9610     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9611     IF STAT-MASTER-FOUND
  9612        MOVE 'N'                 TO STAT-MASTER-SW
  9613        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9614        IF STAT-MASTER-FOUND
  9615           IF (ELSTAT-KEY-SAVE (1:12) =
  9616                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 177
* EL050.cbl
  9617              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9618                 MOVE 'F'        TO STAT-MASTER-SW
  9619              ELSE
  9620                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9621                 IF (STAT-MASTER-FOUND)
  9622                    AND (ELSTAT-KEY-SAVE (1:12) =
  9623                        SF-CONTROL-PRIMARY (1:12))
  9624                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9625                    MOVE 'F'     TO STAT-MASTER-SW
  9626                 END-IF
  9627              END-IF
  9628           END-IF
  9629        END-IF
  9630     END-IF
  9631
  9632     IF STAT-MASTER-SW = 'F'
  9633        IF SF-ST-LF-PREM-TAX NUMERIC
  9634           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9635        END-IF
  9636        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9637           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9638        END-IF
  9639        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9640           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9641        END-IF
  9642     END-IF
  9643
  9644     END-IF
  9645     IF (PB-COMPANY-ID = 'DCC')
  9646        AND (PB-ISSUE)
  9647        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9648        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9649        AND (AM-GPCD = 06)
  9650        MOVE 'Y'                 TO WS-GOOD-HIN
  9651        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9652           MOVE PB-I-VIN         TO WS-WORK-VIN
  9653           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9654              (V1 > 16)
  9655              IF WS-WORK-VIN (V1:1) NUMERIC
  9656                 MOVE WS-WORK-VIN-N (V1)
  9657                                 TO WS-ROW-B-VAL (V1)
  9658              ELSE
  9659                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9660                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9661                    OR (V2 > 26)
  9662                 END-PERFORM
  9663                 IF V2 < 27
  9664                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9665                 ELSE
  9666                    MOVE 'N'     TO WS-GOOD-HIN
  9667                 END-IF
  9668              END-IF
  9669              COMPUTE WS-ROW-D-VAL (V1) =
  9670                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9671              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9672                 WS-ROW-D-VAL (V1)
  9673           END-PERFORM
  9674           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 178
* EL050.cbl
  9675           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9676             REMAINDER WS-VIN-REMAINDER
  9677           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9678              CONTINUE
  9679           ELSE
  9680              MOVE 'N'           TO WS-GOOD-HIN
  9681           END-IF
  9682        ELSE
  9683           MOVE 'N'              TO WS-GOOD-HIN
  9684        END-IF
  9685        IF WS-GOOD-HIN NOT = 'Y'
  9686           MOVE ER-3826           TO WS-ERROR
  9687           PERFORM 9900-ERROR-FORMAT
  9688                                 THRU 9900-EXIT
  9689        END-IF
  9690     END-IF
  9691     IF (PB-COMPANY-ID = 'DCC')
  9692        AND (PB-ISSUE)
  9693        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9694        AND (AM-GPCD NOT = 06)
  9695        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9696          MOVE PB-I-VIN          TO WS-WORK-VIN
  9697          MOVE +8                TO V2
  9698          MOVE ZEROS             TO WS-VIN-TOTAL
  9699          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9700           (V1 > 17)
  9701             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
  9702                MOVE ER-3825     TO WS-ERROR
  9703                PERFORM 9900-ERROR-FORMAT
  9704                                 THRU 9900-EXIT
  9705             ELSE
  9706                IF V1 = 8
  9707                   MOVE 10       TO V2
  9708                END-IF
  9709                IF V1 = 9
  9710                   MOVE 0        TO V2
  9711                END-IF
  9712                IF V1 = 10
  9713                   MOVE 9        TO V2
  9714                END-IF
  9715                IF WS-WORK-VIN (V1:1) NUMERIC
  9716                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9717                    + (WS-WORK-VIN-N (V1) * V2)
  9718                ELSE
  9719                   MOVE WS-WORK-VIN (V1:1)
  9720                                 TO WS-HEX-BYTE
  9721                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
  9722                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
  9723                    + (WS-NUM (V3) * V2)
  9724                END-IF
  9725                COMPUTE V2 = V2 - 1
  9726             END-IF
  9727          END-PERFORM
  9728          MOVE ZEROS TO WS-VIN-REMAINDER
  9729          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
  9730             REMAINDER WS-VIN-REMAINDER
  9731          IF ((WS-WORK-VIN (9:1) = 'X')
  9732             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 179
* EL050.cbl
  9733                     OR
  9734             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
  9735             CONTINUE
  9736          ELSE
  9737             MOVE ER-3826        TO WS-ERROR
  9738             PERFORM 9900-ERROR-FORMAT
  9739                                 THRU 9900-EXIT
  9740          END-IF
  9741        ELSE
  9742          MOVE ER-3826           TO WS-ERROR
  9743          PERFORM 9900-ERROR-FORMAT
  9744                                 THRU 9900-EXIT
  9745        END-IF
  9746     END-IF
  9747******************************************************************
  9748******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
  9749******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
  9750******* METHODS.
  9751******************************************************************
  9752     IF PB-COMPANY-ID EQUAL TO 'NCL'
  9753        IF PB-CANCELLATION
  9754           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
  9755              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
  9756                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
  9757                IF FORM-MASTER-FOUND
  9758                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
  9759******************************************************************
  9760
  9761     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
  9762     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
  9763
  9764     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
  9765     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
  9766     MOVE AM-STATUS              TO WS-ACCT-STATUS.
  9767     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
  9768
  9769
  9770     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
  9771     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
  9772     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
  9773
  9774     IF AM-LF-OB-RATE NOT NUMERIC
  9775         MOVE ZERO               TO AM-LF-OB-RATE.
  9776
  9777     IF AM-LF-OB-RATE-JNT NOT NUMERIC
  9778         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
  9779
  9780     IF AM-AH-OB-RATE NOT NUMERIC
  9781         MOVE ZERO               TO AM-AH-OB-RATE.
  9782
  9783     IF WS-LF-JOINT-INDICATOR = 'J'
  9784         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
  9785     ELSE
  9786         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
  9787
  9788     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
  9789
  9790     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 180
* EL050.cbl
  9791         MOVE AM-IG              TO WS-IG-OVRD-AM.
  9792
  9793     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
  9794         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
  9795                                       WS-IG-OVRD
  9796     ELSE
  9797         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
  9798             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
  9799                                       WS-IG-OVRD
  9800         ELSE
  9801             MOVE AM-IG             TO WS-IG-OVRD-AH
  9802                                       WS-IG-OVRD.
  9803
  9804     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
  9805         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
  9806                                       WS-IG-OVRD
  9807     ELSE
  9808         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
  9809             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
  9810                                       WS-IG-OVRD
  9811         ELSE
  9812             MOVE AM-IG             TO WS-IG-OVRD-LF
  9813                                       WS-IG-OVRD.
  9814
  9815     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
  9816     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
  9817     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
  9818     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
  9819     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
  9820
  9821     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
  9822     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
  9823     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
  9824     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
  9825
  9826     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
  9827     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
  9828     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
  9829     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
  9830     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
  9831     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
  9832     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
  9833
  9834     IF WS-ACCT-AH-DEV-PCT > +0
  9835        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
  9836     ELSE
  9837        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
  9838
  9839     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
  9840        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
  9841     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
  9842        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
  9843
  9844        IF AM-EARN-METHOD-L = 'S'
  9845            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9846                                        WS-LF-REFUND-CALC.
  9847
  9848        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 181
* EL050.cbl
  9849            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
  9850                                        WS-LF-REFUND-CALC.
  9851
  9852     IF WS-LF-COVERAGE-TYPE = 'R'
  9853         IF AM-EARN-METHOD-R = 'R'
  9854            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9855                                    WS-LF-REFUND-CALC.
  9856     IF WS-LF-COVERAGE-TYPE = 'R'
  9857         IF AM-EARN-METHOD-R = 'P'
  9858            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9859                                    WS-LF-REFUND-CALC.
  9860     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9861         IF AM-EARN-METHOD-L = 'R'
  9862            MOVE '1'             TO EC-AM-LF-REFUND-CALC
  9863                                    WS-LF-REFUND-CALC.
  9864     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9865         IF AM-EARN-METHOD-L = 'P'
  9866            MOVE '2'             TO EC-AM-LF-REFUND-CALC
  9867                                    WS-LF-REFUND-CALC.
  9868     IF WS-LF-COVERAGE-TYPE = 'R'
  9869         IF AM-EARN-METHOD-R = 'A'
  9870            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9871                                    WS-LF-REFUND-CALC.
  9872     IF WS-LF-COVERAGE-TYPE = 'R'
  9873         IF AM-EARN-METHOD-R = 'M'
  9874            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9875                                    WS-LF-REFUND-CALC.
  9876     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9877         IF AM-EARN-METHOD-L = 'A'
  9878            MOVE '6'             TO EC-AM-LF-REFUND-CALC
  9879                                    WS-LF-REFUND-CALC.
  9880     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
  9881         IF AM-EARN-METHOD-L = 'M'
  9882            MOVE '8'             TO EC-AM-LF-REFUND-CALC
  9883                                    WS-LF-REFUND-CALC.
  9884
  9885     IF AM-EARN-METHOD-A = 'R'
  9886        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
  9887                                    WS-AH-REFUND-CALC.
  9888     IF AM-EARN-METHOD-A = 'P'
  9889        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
  9890                                    WS-AH-REFUND-CALC.
  9891     IF AM-EARN-METHOD-A = 'C'
  9892        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
  9893                                    WS-AH-REFUND-CALC.
  9894     IF AM-EARN-METHOD-A = 'A'
  9895        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
  9896                                    WS-AH-REFUND-CALC.
  9897     IF AM-EARN-METHOD-A = 'M'
  9898        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
  9899                                    WS-AH-REFUND-CALC.
  9900     IF AM-EARN-METHOD-A = 'N'
  9901        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
  9902                                    WS-AH-REFUND-CALC.
  9903     IF AM-EARN-METHOD-A = 'S'
  9904        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
  9905                                    WS-AH-REFUND-CALC.
  9906
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 182
* EL050.cbl
  9907     IF AM-TOL-PREM NOT = ZEROS
  9908        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
  9909                                    WS-TOL-AH-PREM.
  9910
  9911     IF AM-OVR-SHT-AMT NUMERIC AND
  9912                  AM-OVR-SHT-AMT > 0
  9913        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
  9914                                    EC-AM-LF-OVR-SHT-AMT
  9915                                    WS-AH-REFUND-OVS-AMT
  9916                                    EC-AM-AH-OVR-SHT-AMT.
  9917
  9918     IF AM-OVR-SHT-PCT NUMERIC AND
  9919                    AM-OVR-SHT-PCT > 0
  9920        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
  9921                                    EC-AM-LF-OVR-SHT-PCT
  9922                                    WS-AH-REFUND-OVS-PCT
  9923                                    EC-AM-AH-OVR-SHT-PCT.
  9924
  9925     IF AM-TOL-REF-PCT NUMERIC AND
  9926                  AM-TOL-REF-PCT > 0
  9927        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
  9928                                    WS-TOL-AH-REFUND-PCT.
  9929
  9930     IF AM-TOL-REF  NOT = ZEROS  AND
  9931                  AM-TOL-REF NUMERIC
  9932        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
  9933                                    EC-AM-LF-TOL-REFUND
  9934                                    WS-TOL-AH-REFUND
  9935                                    EC-AM-AH-TOL-REFUND.
  9936
  9937     IF AM-TOL-CLM  NOT = ZEROS
  9938        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
  9939                                    WS-TOL-AH-CLAIM.
  9940
  9941     IF AM-CLP-TOL-PCT NOT NUMERIC
  9942        MOVE +0                  TO AM-CLP-TOL-PCT
  9943     END-IF
  9944
  9945     IF AM-SPP-LEASE-COMM NOT NUMERIC
  9946        MOVE +0                  TO AM-SPP-LEASE-COMM
  9947     END-IF
  9948     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
  9949        MOVE WS-PL-TOL-LF-PREM-PCT
  9950                                 TO WS-TOL-LF-PREM-PCT.
  9951
  9952     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
  9953        MOVE WS-PL-TOL-AH-PREM-PCT
  9954                                 TO WS-TOL-AH-PREM-PCT.
  9955
  9956     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
  9957        MOVE WS-PL-TOL-LF-REFUND-PCT
  9958                                 TO WS-TOL-LF-REFUND-PCT.
  9959
  9960     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
  9961        MOVE WS-PL-TOL-AH-REFUND-PCT
  9962                                 TO WS-TOL-AH-REFUND-PCT.
  9963
  9964     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 183
* EL050.cbl
  9965        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
  9966
  9967     IF WS-PL-REF-OVS-PCT > +0
  9968        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
  9969
  9970     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
  9971        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
  9972     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
  9973        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
  9974     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
  9975        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
  9976     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
  9977        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
  9978     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
  9979        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
  9980     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
  9981        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
  9982
  9983     IF WS-AH-PL-REF-OVS-AMT > +0
  9984        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
  9985
  9986     IF WS-AH-PL-REF-OVS-PCT > +0
  9987        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
  9988
  9989     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
  9990     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
  9991
  9992     IF PB-CANCELLATION
  9993        GO TO 3000-CONTINUE-EDIT.
  9994
  9995     MOVE +1 TO SUB1.
  9996     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
  9997     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
  9998
  9999     IF CF-COMPANY-ID = 'DMD'
 10000       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10001         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10002        ELSE
 10003         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10004
 10005  0525-FIND-ACCT-COMM.
 10006     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10007        NEXT SENTENCE
 10008      ELSE
 10009         ADD +1 TO SUB1
 10010         IF SUB1 LESS +11
 10011            GO TO 0525-FIND-ACCT-COMM
 10012          ELSE
 10013             GO TO 0560-EDIT-CONTINUE.
 10014
 10015     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10016     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10017                                    PB-I-LIFE-COMMISSION.
 10018***  IF PB-COMPANY-ID = 'CRI'
 10019     IF PB-PREM-ACCTNG-ONLY
 10020         GO TO 0560-EDIT-CONTINUE.
 10021
 10022     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 184
* EL050.cbl
 10023     MOVE ' '    TO WS-CTBL-READ-SW.
 10024
 10025
 10026 0530-GET-AH-COMP.
 10027     IF NO-AH-COVERAGE  OR
 10028        NO-AH-BENEFIT-MATCH
 10029           GO TO 0540-NEXT-READ-STEP.
 10030
 10031     IF AM-A-COM (SUB1) NUMERIC
 10032        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10033         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10034         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10035         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10036         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10037     ELSE
 10038          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10039          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10040          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10041          MOVE ZEROS             TO WS-SUB1
 10042                                    WS-COMMISSION
 10043          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10044          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10045          IF WS-COMMISSION > ZEROS
 10046             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10047             GO TO 0540-NEXT-READ-STEP
 10048          END-IF
 10049          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10050          IF CTBL-TABLE-FOUND
 10051             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10052                                        PB-I-AH-TERM
 10053             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10054             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10055             GO TO 0540-NEXT-READ-STEP
 10056          ELSE
 10057             IF FIRST-TIME-THROUGH
 10058                 GO TO 0530-GET-AH-COMP
 10059             ELSE
 10060                 MOVE ER-2609                TO WS-ERROR
 10061                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10062
 10063 0540-NEXT-READ-STEP.
 10064     MOVE '0540' TO CTBL-SW.
 10065     MOVE ' '    TO WS-CTBL-READ-SW.
 10066
 10067 0540-GET-LF-COMP.
 10068     IF NO-LIFE-COVERAGE  OR
 10069        NO-LF-BENEFIT-MATCH
 10070           GO TO 0560-EDIT-CONTINUE.
 10071
 10072     IF WS-LF-JOINT-INDICATOR = 'J'
 10073        IF AM-J-COM (SUB1) NUMERIC
 10074           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10075           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10076           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10077           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10078           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10079        ELSE
 10080           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 185
* EL050.cbl
 10081           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10082           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10083           MOVE ZEROS                TO WS-SUB1
 10084                                        WS-COMMISSION
 10085           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10086           IF WS-COMMISSION > ZEROS
 10087              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10088              GO TO 0560-EDIT-CONTINUE
 10089           END-IF
 10090           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10091           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10092           IF CTBL-TABLE-FOUND
 10093              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10094              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10095              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10096              GO TO 0560-EDIT-CONTINUE
 10097           ELSE
 10098              IF FIRST-TIME-THROUGH
 10099                  GO TO 0540-GET-LF-COMP
 10100              ELSE
 10101                  MOVE ER-2609                TO WS-ERROR
 10102                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10103                  GO TO 0560-EDIT-CONTINUE.
 10104
 10105     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10106        IF AM-L-COM (SUB1) NUMERIC
 10107           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10108           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10109           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10110           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10111           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10112        ELSE
 10113           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10114           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10115           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10116           MOVE ZEROS                TO WS-SUB1
 10117                                        WS-COMMISSION
 10118           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10119           IF WS-COMMISSION IS GREATER THAN ZEROS
 10120              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10121              GO TO 0560-EDIT-CONTINUE
 10122           END-IF
 10123           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10124           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10125           IF CTBL-TABLE-FOUND
 10126              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10127              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10128              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10129              GO TO 0560-EDIT-CONTINUE
 10130           ELSE
 10131              IF FIRST-TIME-THROUGH
 10132                  GO TO 0540-GET-LF-COMP
 10133              ELSE
 10134                  MOVE ER-2609                TO WS-ERROR
 10135                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10136
 10137*    GO TO 0560-EDIT-CONTINUE.
 10138
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 186
* EL050.cbl
 10139 0560-EDIT-CONTINUE.
 10140     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10141                                    WS-AH-PMF-COMM
 10142*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10143*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10144     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10145        (SUB1 > +10)
 10146        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10147           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10148           MOVE '0530'           TO CTBL-SW
 10149           MOVE ' '              TO WS-CTBL-READ-SW
 10150           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10151           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10152           MOVE '0540'           TO CTBL-SW
 10153           MOVE ' '              TO WS-CTBL-READ-SW
 10154           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10155        END-IF
 10156     END-PERFORM
 10157     GO TO 0564-EDIT-CONTINUE
 10158     .
 10159 0561-CHECK-AH.
 10160     IF (NO-AH-COVERAGE)
 10161        OR (NO-AH-BENEFIT-MATCH)
 10162        CONTINUE
 10163     ELSE
 10164        IF (AM-A-COM (SUB1) NUMERIC)
 10165           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10166           IF (AM-COM-TYP (SUB1) = 'A')
 10167              AND (WS-AH-PMF-COMM = ZEROS)
 10168              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10169           END-IF
 10170           CONTINUE
 10171        ELSE
 10172           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10173           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10174           MOVE PB-AH-OVERRIDE-L1
 10175                                 TO CTBL-BEN-TYPE
 10176           MOVE ZEROS            TO WS-SUB1
 10177                                    WS-COMMISSION
 10178           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10179           PERFORM 8300-READ-CTBL-TABLE
 10180                                 THRU 8300-EXIT
 10181           IF CTBL-TABLE-FOUND
 10182              IF (AM-COM-TYP (SUB1) = 'A')
 10183                 AND (WS-AH-PMF-COMM = ZEROS)
 10184                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10185                                        PB-I-AH-TERM
 10186                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10187                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10188              END-IF
 10189              CONTINUE
 10190           ELSE
 10191              IF FIRST-TIME-THROUGH
 10192                 GO TO 0561-CHECK-AH
 10193              ELSE
 10194                 MOVE ER-2609    TO WS-ERROR
 10195                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10196              END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 187
* EL050.cbl
 10197           END-IF
 10198        END-IF
 10199     END-IF
 10200     .
 10201 0561-EXIT.
 10202     EXIT.
 10203 0563-CHECK-LF.
 10204     IF (NO-LIFE-COVERAGE)
 10205        OR (NO-LF-BENEFIT-MATCH)
 10206        CONTINUE
 10207     ELSE
 10208        IF WS-LF-JOINT-INDICATOR = 'J'
 10209           IF AM-J-COM (SUB1) NUMERIC
 10210              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10211              IF (AM-COM-TYP (SUB1) = 'A')
 10212                 AND (WS-LF-PMF-COMM = ZEROS)
 10213                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10214              END-IF
 10215              CONTINUE
 10216           ELSE
 10217              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10218              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10219              MOVE PB-LIFE-OVERRIDE-L1
 10220                                 TO CTBL-BEN-TYPE
 10221              MOVE ZEROS         TO WS-SUB1
 10222                                    WS-COMMISSION
 10223              MOVE AM-J-COMA (SUB1)
 10224                                 TO CTBL-TABLE
 10225              PERFORM 8300-READ-CTBL-TABLE
 10226                                 THRU 8300-EXIT
 10227              IF CTBL-TABLE-FOUND
 10228                 IF (AM-COM-TYP (SUB1) = 'A')
 10229                    AND (WS-LF-PMF-COMM = ZEROS)
 10230                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10231                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10232                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10233                 END-IF
 10234                 CONTINUE
 10235              ELSE
 10236                 IF FIRST-TIME-THROUGH
 10237                    GO TO 0563-CHECK-LF
 10238                 ELSE
 10239                    MOVE ER-2609 TO WS-ERROR
 10240                    PERFORM 9900-ERROR-FORMAT
 10241                                 THRU 9900-EXIT
 10242*                   GO TO 0560-EDIT-CONTINUE
 10243                 END-IF
 10244              END-IF
 10245           END-IF
 10246        ELSE
 10247           IF AM-L-COM (SUB1) NUMERIC
 10248              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10249              IF (AM-COM-TYP (SUB1) = 'A')
 10250                 AND (WS-LF-PMF-COMM = ZEROS)
 10251                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10252              END-IF
 10253              CONTINUE
 10254           ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 188
* EL050.cbl
 10255              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10256              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10257              MOVE PB-LIFE-OVERRIDE-L1
 10258                                 TO CTBL-BEN-TYPE
 10259              MOVE ZEROS         TO WS-SUB1
 10260                                    WS-COMMISSION
 10261              MOVE AM-L-COMA (SUB1)
 10262                                 TO CTBL-TABLE
 10263              PERFORM 8300-READ-CTBL-TABLE
 10264                                 THRU 8300-EXIT
 10265              IF CTBL-TABLE-FOUND
 10266                 CONTINUE
 10267              ELSE
 10268                 IF FIRST-TIME-THROUGH
 10269                    GO TO 0563-CHECK-LF
 10270                 ELSE
 10271                    MOVE ER-2609 TO WS-ERROR
 10272                    PERFORM 9900-ERROR-FORMAT
 10273                                 THRU 9900-EXIT
 10274                 END-IF
 10275              END-IF
 10276           END-IF
 10277        END-IF
 10278     END-IF
 10279     .
 10280 0563-EXIT.
 10281     EXIT.
 10282 0564-EDIT-CONTINUE.
 10283
 10284     IF  PB-COMPANY-ID EQUAL 'DMD'
 10285         IF PB-I-NUM-BILLED EQUAL ZEROS
 10286            MOVE ER-8148       TO WS-ERROR
 10287            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10288
 10289*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10290*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10291*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10292*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10293*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10294*         IF NO-CONVERSION-ERROR
 10295*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10296*         ELSE
 10297*             IF PB-COMPANY-ID EQUAL 'HAN'
 10298*                 MOVE ZEROS     TO PB-I-AGE.
 10299     IF PB-I-BIRTHDAY > LOW-VALUES
 10300        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10301        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10302        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10303        PERFORM 8500-DATE-CONVERT
 10304                                 THRU 8500-EXIT
 10305        IF NO-CONVERSION-ERROR
 10306           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10307           IF PB-I-AGE > ZEROS
 10308              IF WS-WORK-AGE NOT = PB-I-AGE
 10309                 MOVE ER-9501    TO WS-ERROR
 10310                 PERFORM 9900-ERROR-FORMAT
 10311                                 THRU 9900-EXIT
 10312              END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 189
* EL050.cbl
 10313           ELSE
 10314              MOVE WS-WORK-AGE   TO PB-I-AGE
 10315           END-IF
 10316        END-IF
 10317     END-IF
 10318     IF PB-I-AGE = ZEROS
 10319        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10320           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10321
 10322     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10323                                   WS-AH-EDIT-AGE.
 10324
 10325     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10326        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10327        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10328        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10329        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10330        IF NO-CONVERSION-ERROR
 10331           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10332           IF PB-I-JOINT-AGE > 0
 10333              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10334                 MOVE ER-9503    TO WS-ERROR
 10335                 PERFORM 9900-ERROR-FORMAT
 10336                                 THRU 9900-EXIT
 10337              END-IF
 10338           ELSE
 10339              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10340           END-IF
 10341        ELSE
 10342           MOVE ZEROS            TO PB-I-JOINT-AGE
 10343        END-IF
 10344     END-IF
 10345     IF PB-I-JOINT-AGE NOT NUMERIC
 10346        MOVE ZERO               TO PB-I-JOINT-AGE.
 10347
 10348     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC'
 10349        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10350           (WS-AH-JOINT-INDICATOR = 'J')
 10351           IF PB-I-JOINT-AGE = ZEROS
 10352               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10353           END-IF
 10354        END-IF
 10355     END-IF
 10356
 10357     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10358     IF WS-LF-JOINT-INDICATOR = 'J'
 10359        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10360        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10361            IF  PB-I-JOINT-AGE = ZERO
 10362                MOVE ER-2686       TO WS-ERROR
 10363                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10364            ELSE
 10365                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10366                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10367                    IF PB-COMPANY-ID NOT = 'LBL'
 10368                        MOVE ER-2685    TO WS-ERROR
 10369                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10370
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 190
* EL050.cbl
 10371     IF WS-AH-JOINT-INDICATOR = 'J'
 10372        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10373            IF  PB-I-JOINT-AGE = ZERO
 10374                MOVE ER-2686       TO WS-ERROR
 10375                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10376            ELSE
 10377                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10378                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10379                                           WS-EDIT-AGE
 10380                    IF PB-COMPANY-ID NOT = 'LBL'
 10381                        MOVE ER-2685    TO WS-ERROR
 10382                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10383
 10384******************************************************************
 10385*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10386******************************************************************
 10387
 10388     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10389        (WS-AH-SPECIAL-CALC-CD = 'O')
 10390        NEXT SENTENCE
 10391     ELSE
 10392        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10393          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10394           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10395            WS-AH-JOINT-INDICATOR = 'J')  AND
 10396           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10397            MOVE ER-2627             TO WS-ERROR
 10398            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10399
 10400     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10401        (WS-AH-SPECIAL-CALC-CD = 'O')
 10402         NEXT SENTENCE
 10403     ELSE
 10404         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10405            WS-AH-JOINT-INDICATOR = 'J'
 10406             IF PB-I-JOINT-INSURED = SPACES
 10407                 IF PB-COMPANY-ID NOT = 'JAL'
 10408                     MOVE ER-2696    TO WS-ERROR
 10409                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10410
 10411     IF PB-COMPANY-ID NOT = 'BOA'
 10412        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10413           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10414           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10415               PB-I-JOINT-INSURED NOT = SPACES)
 10416                MOVE ER-2691         TO WS-ERROR
 10417                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10418
 10419     IF PB-COMPANY-ID = 'BOA'
 10420        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10421           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10422            IF PB-I-JOINT-AGE NOT = ZEROS
 10423                MOVE ER-2691         TO WS-ERROR
 10424                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10425
 10426     IF PB-COMPANY-ID = 'CRI'
 10427        IF PB-I-SIG-SW = 'J'
 10428           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 191
* EL050.cbl
 10429              WS-AH-JOINT-INDICATOR NOT = 'J'
 10430              MOVE ER-2675       TO WS-ERROR
 10431              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10432
 10433     IF PB-COMPANY-ID = 'CRI'
 10434        IF PB-I-SIG-SW = 'S'
 10435           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10436              WS-AH-JOINT-INDICATOR = 'J'
 10437              MOVE ER-2676       TO WS-ERROR
 10438              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10439
 10440     IF PB-COMPANY-ID = 'CVL'
 10441         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10442            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10443              MOVE ER-2783           TO WS-ERROR
 10444              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10445     IF (WS-LF-JOINT-INDICATOR = 'J')
 10446        AND (WS-AH-JOINT-INDICATOR = 'J')
 10447        AND (PB-I-LF-TERM > 120)
 10448        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10449        MOVE ER-2783             TO WS-ERROR
 10450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10451     END-IF
 10452     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10453
 10454     IF PB-I-INDV-GRP-OVRD = 'I'
 10455        MOVE ER-2666             TO WS-ERROR
 10456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10457        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10458
 10459     IF PB-I-INDV-GRP-OVRD = 'G'
 10460        MOVE ER-2666             TO WS-ERROR
 10461        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10462        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10463
 10464     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10465        NEXT SENTENCE
 10466     ELSE
 10467        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10468
 10469     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10470        IF WS-ERROR = ER-2666
 10471           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10472           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10473
 10474     IF PB-COMPANY-ID = 'CID'
 10475        IF PB-STATE = 'UT' OR 'MO'
 10476           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10477                 OR '76' OR '77')
 10478                      OR
 10479               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10480                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10481                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10482                   OR '2K' OR '2L'))
 10483              AND PB-I-INDV-GRP-CD = 'I'
 10484              MOVE ER-2721             TO WS-ERROR
 10485              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10486           END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 192
* EL050.cbl
 10487        END-IF
 10488     END-IF
 10489
 10490     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10491     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10492        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10493     ELSE
 10494        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10495     END-IF
 10496
 10497*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10498*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10499     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10500                                    ACCOUNT-AH-CK-SW.
 10501
 10502     IF PB-REISSUED-CERT       OR
 10503        PB-REIN-ONLY-CERT      OR
 10504        PB-POLICY-IS-DECLINED  OR
 10505        PB-POLICY-IS-VOIDED
 10506*       OR PB-MONTHLY-CERT
 10507         GO TO 3000-CONTINUE-EDIT.
 10508
 10509     IF PB-COMPANY-ID = 'CID'
 10510        IF WS-EDIT-AGE           > +65
 10511           MOVE ER-2709          TO WS-ERROR
 10512           PERFORM 9900-ERROR-FORMAT
 10513                                 THRU 9900-EXIT
 10514        ELSE
 10515           IF WS-EDIT-AGE        > +55
 10516              MOVE ER-2718       TO WS-ERROR
 10517              PERFORM 9900-ERROR-FORMAT
 10518                                 THRU 9900-EXIT
 10519           END-IF
 10520        END-IF
 10521     IF PB-COMPANY-ID = 'DCC'
 10522        IF WS-EDIT-AGE           > +65
 10523           MOVE ER-2709          TO WS-ERROR
 10524           PERFORM 9900-ERROR-FORMAT
 10525                                 THRU 9900-EXIT
 10526        END-IF
 10527     END-IF
 10528     .
 10529
 10530 0565-LIFE-PLAN-LIMIT-EDITS.
 10531
 10532     IF NOT LF-PLAN-MASTER-FOUND
 10533        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10534                                    EC-AM-LF-MAX-TOT-BEN
 10535        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10536
 10537     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10538
 10539     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10540         IF PL-LM-AGE (1) = ZEROS
 10541             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10542
 10543     IF NO-LF-BENEFIT-MATCH          OR
 10544        WS-LF-BENEFIT-CD = ZEROS     OR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 193
* EL050.cbl
 10545        WS-LF-SPECIAL-CALC-CD = 'M'
 10546        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10547
 10548     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10549     MOVE +1                     TO SUB2.
 10550
 10551     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10552        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10553           MOVE +5   TO SUB2
 10554           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10555              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10556              (PL-LM-AGE (SUB2) EQUAL +0)
 10557              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10558              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10559
 10560     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10561
 10562     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10563                               + PB-I-LF-ALT-BENEFIT-AMT.
 10564
 10565 0568-CHECK-LIFE-ATT-AGE.
 10566
 10567     IF PL-ATT-AGE NUMERIC AND
 10568        PL-ATT-AGE > +0
 10569        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10570     END-IF
 10571*    IF PL-ATT-AGE NUMERIC AND
 10572*       PL-ATT-AGE > +0
 10573*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10574*       IF PB-I-BIRTHDAY > LOW-VALUES
 10575*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10576*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10577*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10578*          SET BIN-PLUS-ELAPSED  TO TRUE
 10579*          PERFORM 8500-DATE-CONVERT
 10580*                                THRU 8500-EXIT
 10581*          IF NO-CONVERSION-ERROR
 10582*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10583*             MOVE ER-2669       TO WS-ERROR
 10584*             PERFORM 9900-ERROR-FORMAT
 10585*                                THRU 9900-EXIT
 10586*          END-IF
 10587*       ELSE
 10588*          IF WS-ATT-AGE >= PL-ATT-AGE
 10589*             MOVE ER-2669       TO WS-ERROR
 10590*             PERFORM 9900-ERROR-FORMAT
 10591*                                THRU 9900-EXIT
 10592*          END-IF
 10593*       END-IF
 10594*    END-IF
 10595     .
 10596 0570-CHECK-LIFE-LIMITS.
 10597
 10598     IF PB-COMPANY-ID EQUAL 'CRI'
 10599        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10600           IF SUB2 GREATER THAN +4
 10601              MOVE ER-2637 TO WS-ERROR
 10602              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 194
* EL050.cbl
 10603              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10604
 10605     IF PB-COMPANY-ID  =  'NCL'
 10606        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10607            SUB2 GREATER THAN +8
 10608             MOVE 'U'         TO PB-BATCH-ENTRY
 10609             MOVE ER-2637     TO WS-ERROR
 10610             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10611             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10612
 10613     IF SUB2 > +8
 10614        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10615           AND (PB-I-SIG-SW = 'Y')
 10616           CONTINUE
 10617        ELSE
 10618           MOVE ER-2637          TO WS-ERROR
 10619           PERFORM 9900-ERROR-FORMAT
 10620                                 THRU 9900-EXIT
 10621        END-IF
 10622        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10623     END-IF
 10624     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10625     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10626     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10627
 10628     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10629        ADD +1  TO SUB2
 10630        GO TO 0570-CHECK-LIFE-LIMITS.
 10631
 10632     IF PB-COMPANY-ID = 'NCL'
 10633         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10634
 10635     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10636        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10637        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10638           AND (PB-I-SIG-SW = 'Y')
 10639           CONTINUE
 10640        ELSE
 10641           MOVE ER-2637          TO WS-ERROR
 10642           PERFORM 9900-ERROR-FORMAT
 10643                                 THRU 9900-EXIT
 10644        END-IF
 10645     END-IF
 10646     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10647
 10648
 10649 0570-CHECK-NCL-LIFE-LIMITS.
 10650
 10651     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10652        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 10653         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10654
 10655     IF APP-CERT-USED
 10656         IF SUB2  LESS THAN  +5
 10657             MOVE +5          TO SUB2
 10658             GO TO 0570-CHECK-LIFE-LIMITS.
 10659
 10660     MOVE ER-2637             TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 195
* EL050.cbl
 10661     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10662
 10663     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10664
 10665 0575-CHECK-NCL-SIG-SWITCH.
 10666
 10667     IF NOT APP-CERT-USED
 10668         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10669
 10670     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10671        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10672        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10673        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10674         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10675
 10676     IF SUB2 GREATER THAN +4
 10677         IF PL-LM-AGE (5) = ZEROS  AND
 10678            PL-LM-AGE (6) = ZEROS  AND
 10679            PL-LM-AGE (7) = ZEROS  AND
 10680            PL-LM-AGE (8) = ZEROS
 10681             MOVE  ER-1927        TO WS-ERROR
 10682             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10683             GO TO 0580-AH-PLAN-LIMIT-EDITS
 10684         ELSE
 10685             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10686                 MOVE  ER-1920    TO WS-ERROR
 10687                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10688
 10689     IF PB-I-SIG-SW  = 'Y'
 10690       IF NOT PB-I-POLICY-ACCEPTED  AND
 10691          NOT PB-I-POLICY-DECLINED
 10692           MOVE 'U'               TO PB-BATCH-ENTRY
 10693           MOVE  ER-1926          TO WS-ERROR
 10694           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10695
 10696
 10697 0580-AH-PLAN-LIMIT-EDITS.
 10698
 10699     IF PB-COMPANY-ID = 'CID'
 10700        IF PB-I-AH-BENEFIT-AMT > +1250
 10701           MOVE ER-2702          TO WS-ERROR
 10702           PERFORM 9900-ERROR-FORMAT
 10703                                 THRU 9900-EXIT
 10704        END-IF
 10705     END-IF
 10706
 10707     IF (PB-COMPANY-ID = 'DCC')
 10708        AND (PB-MONTHLY-CERT)
 10709        IF PB-I-AH-BENEFIT-AMT > +1000
 10710           MOVE ER-2881          TO WS-ERROR
 10711           PERFORM 9900-ERROR-FORMAT
 10712                                 THRU 9900-EXIT
 10713        END-IF
 10714     END-IF
 10715     IF NOT AH-PLAN-MASTER-FOUND
 10716        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 10717        GO TO 3000-CONTINUE-EDIT.
 10718
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 196
* EL050.cbl
 10719     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 10720
 10721     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10722         IF PL-LM-AGE (1) = ZEROS
 10723             GO TO 3000-CONTINUE-EDIT.
 10724
 10725     IF NO-AH-BENEFIT-MATCH          OR
 10726        WS-AH-BENEFIT-CD = ZEROS     OR
 10727        WS-AH-SPECIAL-CALC-CD = 'M'
 10728        GO TO 3000-CONTINUE-EDIT.
 10729
 10730     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 10731     MOVE +1                     TO SUB2.
 10732
 10733     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10734        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10735           MOVE +5 TO SUB2
 10736           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10737              (PL-LM-MOA (SUB2) EQUAL +0) AND
 10738              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10739              (PL-LM-AGE (SUB2) EQUAL +0)
 10740              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 10741              GO TO 3000-CONTINUE-EDIT.
 10742
 10743     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 10744
 10745 0590-CHECK-AH-ATT-AGE.
 10746
 10747     IF PL-ATT-AGE NUMERIC AND
 10748        PL-ATT-AGE GREATER THAN +0
 10749        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 10750     END-IF
 10751*       IF WS-ATT-AGE >= PL-ATT-AGE
 10752*          MOVE ER-3054          TO WS-ERROR
 10753*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10754     .
 10755 0597-CHECK-AH-LIMITS.
 10756
 10757     IF PB-COMPANY-ID EQUAL 'CRI'
 10758        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10759           IF SUB2 GREATER THAN +4
 10760              MOVE ER-2638       TO WS-ERROR
 10761              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10762              GO TO 3000-CONTINUE-EDIT.
 10763
 10764     IF PB-COMPANY-ID  =  'NCL'
 10765        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10766            SUB2 GREATER THAN +8
 10767             MOVE 'U'            TO PB-BATCH-ENTRY
 10768             MOVE ER-2638        TO WS-ERROR
 10769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10770             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10771
 10772     IF SUB2 > +8
 10773        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10774           AND (PB-I-SIG-SW = 'Y')
 10775           CONTINUE
 10776        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 197
* EL050.cbl
 10777           MOVE ER-2638          TO WS-ERROR
 10778           PERFORM 9900-ERROR-FORMAT
 10779                                 THRU 9900-EXIT
 10780        END-IF
 10781        GO TO 3000-CONTINUE-EDIT
 10782     END-IF
 10783
 10784     IF PB-COMPANY-ID = 'CRI'
 10785        IF WS-ERROR = ER-2638
 10786           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 10787
 10788     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 10789     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 10790     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 10791     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 10792
 10793     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10794        ADD +1                   TO SUB2
 10795        GO TO 0597-CHECK-AH-LIMITS.
 10796
 10797     IF PB-COMPANY-ID = 'NCL'
 10798         GO TO 0597-CHECK-NCL-AH-LIMITS.
 10799
 10800     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 10801        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 10802        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10803                                 > PL-LM-AMT (SUB2))
 10804        IF (PB-COMPANY-ID = 'CID' OR 'DCC')
 10805           AND (PB-I-SIG-SW = 'Y')
 10806           CONTINUE
 10807        ELSE
 10808           MOVE ER-2638          TO WS-ERROR
 10809           PERFORM 9900-ERROR-FORMAT
 10810                                 THRU 9900-EXIT
 10811        END-IF
 10812     END-IF
 10813
 10814     IF  PB-COMPANY-ID   EQUAL    'CRI'
 10815         IF  WS-ERROR    EQUAL    ER-2638
 10816             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 10817                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 10818                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10819                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10820                MOVE  ER-1910    TO  WS-ERROR
 10821                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 10822
 10823     IF PB-COMPANY-ID = 'CRI'
 10824        IF WS-ERROR = ER-2638
 10825            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10826            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 10827            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 10828
 10829     GO TO 3000-CONTINUE-EDIT.
 10830
 10831 0597-CHECK-NCL-AH-LIMITS.
 10832
 10833     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 10834        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 198
* EL050.cbl
 10835        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 10836                            NOT GREATER THAN PL-LM-AMT (SUB2))
 10837         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 10838
 10839     IF APP-CERT-USED
 10840         IF SUB2  LESS THAN  +5
 10841             MOVE +5             TO SUB2
 10842             GO TO 0597-CHECK-AH-LIMITS.
 10843
 10844     MOVE ER-2638                TO WS-ERROR.
 10845     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10846
 10847     MOVE 'U'                    TO PB-BATCH-ENTRY.
 10848
 10849 0599-CHECK-NCL-SIG-SWITCH.
 10850
 10851     IF NOT APP-CERT-USED
 10852         GO TO 3000-CONTINUE-EDIT.
 10853
 10854     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10855        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10856        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10857        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10858         GO TO 3000-CONTINUE-EDIT.
 10859
 10860     IF SUB2 GREATER THAN +4
 10861         IF PL-LM-AGE (5) = ZEROS  AND
 10862            PL-LM-AGE (6) = ZEROS  AND
 10863            PL-LM-AGE (7) = ZEROS  AND
 10864            PL-LM-AGE (8) = ZEROS
 10865             MOVE  ER-1927        TO WS-ERROR
 10866             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 10867             GO TO 3000-CONTINUE-EDIT
 10868         ELSE
 10869             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 10870                 MOVE  ER-1920    TO WS-ERROR
 10871                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10872
 10873     IF PB-I-SIG-SW  = 'Y'
 10874       IF NOT PB-I-POLICY-ACCEPTED  AND
 10875          NOT PB-I-POLICY-DECLINED
 10876           MOVE 'U'               TO PB-BATCH-ENTRY
 10877           MOVE  ER-1926          TO WS-ERROR
 10878           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 10879
 10880******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 199
* EL050.cbl
 10882
 10883 3000-CONTINUE-EDIT.
 10884
 10885     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10886     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 10887     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10888     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10889     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10890
 10891     IF BROWSE-STARTED
 10892        PERFORM 9990-RETURN THRU 9990-EXIT
 10893        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 10894
 10895     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 10896        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10897        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10898        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10899*       MOVE 1                   TO DC-OPTION-CODE
 10900        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10901        IF DATE-CONVERSION-ERROR
 10902           MOVE ER-2622          TO WS-ERROR
 10903           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10904        ELSE
 10905           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 10906              MOVE ER-2623       TO WS-ERROR
 10907              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10908           ELSE
 10909              MOVE ER-2622       TO WS-ERROR
 10910              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10911
 10912     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 10913     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 10914     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 10915*    MOVE 1                      TO DC-OPTION-CODE.
 10916     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10917     IF DATE-CONVERSION-ERROR
 10918        GO TO 3005-EDIT-CONTINUE
 10919     ELSE
 10920        IF DC-ELAPSED-DAYS GREATER +180
 10921           MOVE ER-2613          TO WS-ERROR
 10922           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10923        ELSE
 10924           IF DC-ELAPSED-DAYS GREATER +90
 10925              MOVE ER-2612       TO WS-ERROR
 10926              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10927           ELSE
 10928             IF DC-ELAPSED-DAYS GREATER +60
 10929                MOVE ER-2614     TO WS-ERROR
 10930                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10931
 10932 3005-EDIT-CONTINUE.
 10933
 10934     IF PB-CANCELLATION
 10935         GO TO 3700-EDIT-CANCEL.
 10936
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 200
* EL050.cbl
 10938******************************************************************
 10939*                  E D I T   I S S U E                           *
 10940******************************************************************
 10941
 10942 3020-EDIT-ISSUE.
 10943
 10944      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 10945      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 10946      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 10947      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 10948      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 10949
 10950     IF PB-ISSUE-FORCE
 10951        OR PB-ISSUE-DATE-FORCED
 10952        OR PB-FORCE-OFF
 10953        OR PB-OVERCHARGE-FORCE
 10954        CONTINUE
 10955     ELSE
 10956        MOVE ER-2670             TO WS-ERROR
 10957        PERFORM 9900-ERROR-FORMAT
 10958                                 THRU 9900-EXIT
 10959     END-IF
 10960     .
 10961 3022-SET-POLICY-STATUS.
 10962
 10963     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 10964
 10965     IF (PB-REISSUED-CERT)
 10966             OR
 10967        ((PB-COMPANY-ID NOT = 'DCC')
 10968         AND (PB-MONTHLY-CERT))
 10969         MOVE '5'                TO PB-I-ENTRY-STATUS
 10970         MOVE 'E'                TO PB-BATCH-ENTRY
 10971     END-IF
 10972
 10973     IF PB-COMPANY-ID = 'DCC'
 10974        IF PB-MONTHLY-CERT
 10975           MOVE 'M'              TO PB-I-ENTRY-STATUS
 10976        END-IF
 10977     END-IF
 10978     IF PB-POLICY-IS-DECLINED
 10979         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 10980     IF PB-POLICY-IS-VOIDED
 10981         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 10982     IF PB-NEEDS-UNDERWRITING
 10983         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 10984     IF PB-REIN-ONLY-CERT
 10985         MOVE '9'                TO PB-I-ENTRY-STATUS.
 10986     IF PB-PREM-ACCTNG-ONLY
 10987         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 10988
 10989     MOVE SPACE                  TO PB-I-OB-FLAG.
 10990
 10991     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 10992         MOVE ER-2665            TO WS-ERROR
 10993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10994         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 10995
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 201
* EL050.cbl
 10996     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 10997        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 10998           MOVE 'Z'             TO PB-I-OB-FLAG.
 10999
 11000     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11001        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11002           MOVE 'Z'             TO PB-I-OB-FLAG.
 11003
 11004     IF ACCOUNT-MAST-FOUND
 11005         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11006         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11007         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11008         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11009         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11010         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11011         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11012     END-IF
 11013
 11014     IF ACCOUNT-MAST-FOUND
 11015        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11016         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11017
 11018     IF (ACCOUNT-MAST-FOUND)
 11019        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11020        IF PB-REISSUED-CERT
 11021           CONTINUE
 11022        ELSE
 11023           MOVE ER-2608          TO WS-ERROR
 11024           PERFORM 9900-ERROR-FORMAT
 11025                                 THRU 9900-EXIT
 11026         END-IF
 11027     END-IF
 11028
 11029     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11030        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11031        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11032
 11033**********   DMD CUSTOM CODE FOLLOWS  **********
 11034 3024-EDIT-DMD-FIELDS.
 11035     IF PB-COMPANY-ID NOT = 'DMD'
 11036        GO TO 3025-EDIT-REINSURANCE.
 11037
 11038*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11039*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11040*** ERROR IF THEY ARE NOT EQUAL.
 11041
 11042     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11043     SET BIN-TO-GREG               TO TRUE.
 11044     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11045     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11046**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11047
 11048     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11049     SET BIN-TO-GREG               TO TRUE.
 11050     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11051     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11052**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11053
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 202
* EL050.cbl
 11054     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11055        MOVE ER-8116               TO WS-ERROR
 11056        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11057
 11058     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11059
 11060     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11061                                      WK-FULL-CERT-NO.
 11062     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11063
 11064     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11065
 11066     IF PB-VALID-LIFE
 11067        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11068     ELSE
 11069        IF PB-VALID-AH
 11070          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11071
 11072
 11073     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11074     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11075     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11076                                      DCUA-UNDRWRTR-CODE
 11077                                      DCUA-UNDRWRTR-GROUP-CODE
 11078                                      DCUA-RETURN-CODE.
 11079
 11080****************************************************************
 11081*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11082***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11083***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11084***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11085***   TO THIS RECORD.                                        ***
 11086****************************************************************
 11087     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11088     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11089     IF DCUA-SUCCESSFUL-PROCESS
 11090        GO TO 3024-EDIT-DL7-CONT.
 11091
 11092     IF DCUA-RETURN-CODE EQUAL '01'
 11093        MOVE ER-8110               TO WS-ERROR
 11094        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11095        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11096        GO TO 3024-EDIT-DL7-CONT.
 11097
 11098     IF DCUA-RETURN-CODE EQUAL '02'
 11099        MOVE ER-8111               TO WS-ERROR
 11100        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11102        GO TO 3024-EDIT-DL7-CONT.
 11103
 11104     IF DCUA-RETURN-CODE EQUAL '03'
 11105        MOVE ER-8074               TO WS-ERROR
 11106        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11107        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11108        GO TO 3024-EDIT-DL7-CONT.
 11109
 11110     IF DCUA-RETURN-CODE EQUAL '04'
 11111        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 203
* EL050.cbl
 11112        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11113        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11114        GO TO 3024-EDIT-DL7-CONT.
 11115
 11116     IF DCUA-RETURN-CODE EQUAL '05'
 11117        MOVE ER-8076               TO WS-ERROR
 11118        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11120        GO TO 3024-EDIT-DL7-CONT.
 11121
 11122     IF DCUA-RETURN-CODE EQUAL '06'
 11123        MOVE ER-8077               TO WS-ERROR
 11124        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11125        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11126        GO TO 3024-EDIT-DL7-CONT.
 11127
 11128     IF DCUA-RETURN-CODE EQUAL '07'
 11129        MOVE ER-8078               TO WS-ERROR
 11130        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11131        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11132        GO TO 3024-EDIT-DL7-CONT.
 11133
 11134     IF DCUA-RETURN-CODE EQUAL 'E1'
 11135        MOVE ER-8079               TO WS-ERROR
 11136        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11137        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11138        GO TO 3024-EDIT-DL7-CONT.
 11139
 11140     IF DCUA-RETURN-CODE EQUAL 'E2'
 11141        MOVE ER-8080               TO WS-ERROR
 11142        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11143        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11144        GO TO 3024-EDIT-DL7-CONT.
 11145
 11146     IF DCUA-RETURN-CODE EQUAL 'E3'
 11147        MOVE ER-8098               TO WS-ERROR
 11148        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11150        GO TO 3024-EDIT-DL7-CONT.
 11151
 11152     IF DCUA-RETURN-CODE EQUAL 'C1'
 11153        MOVE ER-8099               TO WS-ERROR
 11154        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11155        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11156        GO TO 3024-EDIT-DL7-CONT.
 11157
 11158     IF DCUA-RETURN-CODE EQUAL 'U1'
 11159        MOVE ER-8109               TO WS-ERROR
 11160        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11161        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11162        GO TO 3024-EDIT-DL7-CONT.
 11163
 11164     IF DCUA-RETURN-CODE EQUAL 'N1'
 11165        MOVE ER-8112               TO WS-ERROR
 11166        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11167        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11168        GO TO 3024-EDIT-DL7-CONT.
 11169
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 204
* EL050.cbl
 11170     IF DCUA-RETURN-CODE EQUAL 'N2'
 11171        MOVE ER-8113               TO WS-ERROR
 11172        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11174        GO TO 3024-EDIT-DL7-CONT.
 11175
 11176     IF DCUA-RETURN-CODE EQUAL 'N3'
 11177        MOVE ER-8114               TO WS-ERROR
 11178        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11179        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11180        GO TO 3024-EDIT-DL7-CONT.
 11181
 11182     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11183     MOVE ER-8097                  TO WS-ERROR.
 11184     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11185     GO TO 3024-EDIT-DL7-CONT.
 11186
 11187 3024-EDIT-DL7-CONT.
 11188
 11189     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11190     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11191     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11192        NEXT SENTENCE
 11193     ELSE
 11194        MOVE ER-9263               TO WS-ERROR
 11195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11196
 11197******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11198******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11199     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11200        NEXT SENTENCE
 11201     ELSE
 11202        MOVE ER-8039               TO WS-ERROR
 11203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11204
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 205
* EL050.cbl
 11206****************************************************************
 11207*** VALIDATE STATE  : DLO022                                 ***
 11208****************************************************************
 11209     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11210     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11211
 11212     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11213     IF DVSC-SUCCESSFUL-EDIT
 11214        GO TO 3024-EDIT-DL22-CONT.
 11215
 11216     IF DVSC-RETURN-CODE EQUAL '01'
 11217        MOVE ER-8300               TO WS-ERROR
 11218        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11219        GO TO 3024-EDIT-DL22-CONT.
 11220
 11221     IF DVSC-RETURN-CODE EQUAL '02'
 11222        MOVE ER-8301               TO WS-ERROR
 11223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11224        GO TO 3024-EDIT-DL22-CONT.
 11225
 11226     IF DVSC-RETURN-CODE EQUAL '03'
 11227        MOVE ER-8302               TO WS-ERROR
 11228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11229        GO TO 3024-EDIT-DL22-CONT.
 11230
 11231     IF DVSC-RETURN-CODE EQUAL 'N1'
 11232        MOVE ER-8304               TO WS-ERROR
 11233        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11234        GO TO 3024-EDIT-DL22-CONT.
 11235
 11236     MOVE ER-8303                  TO WS-ERROR
 11237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11238
 11239 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 206
* EL050.cbl
 11241****************************************************************
 11242*** VALIDATE LOAN OFFICER : DLO021                           ***
 11243****************************************************************
 11244
 11245     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11246     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11247     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11248     IF DVLO-SUCCESSFUL-EDIT
 11249        GO TO 3024-EDIT-DL21-CONT.
 11250
 11251     IF DVLO-RETURN-CODE EQUAL '01'
 11252        MOVE ER-8081               TO WS-ERROR
 11253        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11254        GO TO 3024-EDIT-DL21-CONT.
 11255
 11256     IF DVLO-RETURN-CODE EQUAL '02'
 11257        MOVE ER-8082               TO WS-ERROR
 11258        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11259        GO TO 3024-EDIT-DL21-CONT.
 11260
 11261     IF DVLO-RETURN-CODE EQUAL '03'
 11262        MOVE ER-8083               TO WS-ERROR
 11263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11264        GO TO 3024-EDIT-DL21-CONT.
 11265
 11266     IF DVLO-RETURN-CODE EQUAL '04'
 11267        MOVE ER-8084               TO WS-ERROR
 11268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11269        GO TO 3024-EDIT-DL21-CONT.
 11270
 11271     IF DVLO-RETURN-CODE EQUAL '05'
 11272        MOVE ER-8085               TO WS-ERROR
 11273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11274        GO TO 3024-EDIT-DL21-CONT.
 11275
 11276     MOVE ER-7825                  TO WS-ERROR
 11277     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11278     GO TO 3024-EDIT-DL21-CONT.
 11279
 11280 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 207
* EL050.cbl
 11282
 11283****************************************************************
 11284*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11285****************************************************************
 11286
 11287     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11288     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11289     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11290     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11291     IF DIPF-SUCCESSFUL-EDIT
 11292        GO TO 3024-EDIT-DL02-CONT.
 11293
 11294     IF DIPF-RETURN-CODE EQUAL '01'
 11295        MOVE ER-8086               TO WS-ERROR
 11296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11297        GO TO 3024-EDIT-DL02-CONT.
 11298
 11299     IF DIPF-RETURN-CODE EQUAL '02'
 11300        MOVE ER-8087               TO WS-ERROR
 11301        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11302        GO TO 3024-EDIT-DL02-CONT.
 11303
 11304     IF DIPF-RETURN-CODE EQUAL '03'
 11305        MOVE ER-8088               TO WS-ERROR
 11306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11307        GO TO 3024-EDIT-DL02-CONT.
 11308
 11309     MOVE ER-8095                  TO WS-ERROR
 11310     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11311     GO TO 3024-EDIT-DL02-CONT.
 11312
 11313 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 208
* EL050.cbl
 11315
 11316****************************************************************
 11317*** VALIDATE BANK ID : DLO003                                ***
 11318****************************************************************
 11319
 11320     MOVE WK-GREG-CENT           TO WCG-CENT.
 11321     MOVE WK-GREG-YYMM           TO WCG-REST.
 11322     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11323        MOVE ER-8040               TO WS-ERROR
 11324        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11325
 11326     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11327     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11328     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11329     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11330     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11331     IF DVBI-SUCCESSFUL-EDIT
 11332        GO TO 3024-EDIT-DL03-CONT.
 11333
 11334     IF DVBI-RETURN-CODE EQUAL '01'
 11335        MOVE ER-8089               TO WS-ERROR
 11336        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11337        GO TO 3024-EDIT-DL03-CONT.
 11338
 11339     IF DVBI-RETURN-CODE EQUAL '02'
 11340        MOVE ER-8090               TO WS-ERROR
 11341        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11342        GO TO 3024-EDIT-DL03-CONT.
 11343
 11344     IF DVBI-RETURN-CODE EQUAL '03'
 11345        MOVE ER-8091               TO WS-ERROR
 11346        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11347        GO TO 3024-EDIT-DL03-CONT.
 11348
 11349     IF DVBI-RETURN-CODE EQUAL '04'
 11350        MOVE ER-8092               TO WS-ERROR
 11351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11352        GO TO 3024-EDIT-DL03-CONT.
 11353
 11354     IF DVBI-RETURN-CODE EQUAL '05'
 11355        MOVE ER-8093               TO WS-ERROR
 11356        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357        GO TO 3024-EDIT-DL03-CONT.
 11358
 11359     IF DVBI-RETURN-CODE EQUAL '06'
 11360        MOVE ER-8094               TO WS-ERROR
 11361        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11362        GO TO 3024-EDIT-DL03-CONT.
 11363
 11364     MOVE ER-8096                  TO WS-ERROR
 11365     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11366     GO TO 3024-EDIT-DL03-CONT.
 11367
 11368 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 209
* EL050.cbl
 11370
 11371     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11372        NEXT SENTENCE
 11373     ELSE
 11374        MOVE ER-8042               TO WS-ERROR
 11375        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11376
 11377     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11378     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11379     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11380
 11381     IF DMPF-RETURN-CODE = '01'
 11382        MOVE ER-8067               TO WS-ERROR
 11383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11384        GO TO 3024-EDIT-DL01-CONT.
 11385
 11386     IF DMPF-RETURN-CODE = '02'
 11387        MOVE ER-8068               TO WS-ERROR
 11388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11389        GO TO 3024-EDIT-DL01-CONT.
 11390
 11391     IF DMPF-RETURN-CODE = '03'
 11392        MOVE ER-8069               TO WS-ERROR
 11393        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11394        GO TO 3024-EDIT-DL01-CONT.
 11395
 11396     IF DMPF-RETURN-CODE = 'E1'
 11397        MOVE ER-8070               TO WS-ERROR
 11398        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11399        GO TO 3024-EDIT-DL01-CONT.
 11400
 11401     IF DMPF-RETURN-CODE = 'N1'
 11402        MOVE ER-8071               TO WS-ERROR
 11403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11404        GO TO 3024-EDIT-DL01-CONT.
 11405
 11406     IF DMPF-RETURN-CODE NOT = 'OK'
 11407        MOVE ER-8072               TO WS-ERROR
 11408        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11409
 11410 3024-EDIT-DL01-CONT.
 11411******************************************************************
 11412***  VALIDATES RATE CODES : DLO017                             ***
 11413******************************************************************
 11414
 11415      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11416      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11417      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11418      IF DVRC-SUCCESSFUL-EDIT
 11419        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11420        GO TO 3024-CHECK-VALID-RATE.
 11421
 11422      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11423
 11424      IF DVRC-RETURN-CODE EQUAL '01'
 11425         MOVE ER-7817                   TO WS-ERROR
 11426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11427         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 210
* EL050.cbl
 11428
 11429      IF DVRC-RETURN-CODE EQUAL '02'
 11430         MOVE ER-7818                   TO WS-ERROR
 11431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11432         GO TO 3025-EDIT-REINSURANCE.
 11433
 11434      IF DVRC-RETURN-CODE EQUAL '03'
 11435         MOVE ER-7819                   TO WS-ERROR
 11436         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11437         GO TO 3025-EDIT-REINSURANCE.
 11438
 11439       MOVE ER-7820                     TO WS-ERROR.
 11440       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11441       GO TO 3025-EDIT-REINSURANCE.
 11442
 11443******************************************************************
 11444***  GET PREMIUM RATES : DLO011                                ***
 11445******************************************************************
 11446
 11447 3024-CHECK-VALID-RATE.
 11448
 11449     IF VALID-RATE-CODE
 11450        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11451        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11452        MOVE SPACES                TO DPRB-RETURN-CODE
 11453        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11454     ELSE
 11455         GO TO 3025-EDIT-REINSURANCE.
 11456
 11457      IF DPRB-SUCCESSFUL-PROCESS
 11458         IF PB-VALID-LIFE
 11459             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11460             GO TO 3025-EDIT-REINSURANCE
 11461         ELSE
 11462             IF PB-VALID-AH
 11463                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11464                 GO TO 3025-EDIT-REINSURANCE.
 11465
 11466      IF DPRB-RETURN-CODE EQUAL '01'
 11467         MOVE ER-7812                   TO WS-ERROR
 11468         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11469         GO TO 3025-EDIT-REINSURANCE.
 11470
 11471      IF DPRB-RETURN-CODE EQUAL '02'
 11472         MOVE ER-7813                   TO WS-ERROR
 11473         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11474         GO TO 3025-EDIT-REINSURANCE.
 11475
 11476      IF DPRB-RETURN-CODE EQUAL '03'
 11477         MOVE ER-7814                   TO WS-ERROR
 11478         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479         GO TO 3025-EDIT-REINSURANCE.
 11480
 11481      IF DPRB-RETURN-CODE EQUAL '04'
 11482         IF NOT DPRB-1ST-TIME
 11483            MOVE ER-7815                   TO WS-ERROR
 11484            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11485            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 211
* EL050.cbl
 11486          ELSE
 11487         IF PB-VALID-LIFE
 11488            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11489          ELSE
 11490            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11491         END-IF
 11492         MOVE SPACES                TO DOCC-RETURN-CODE
 11493         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11494         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11495         IF DOCC-RETURN-CODE = 'OK'
 11496             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11497             GO TO 3024-CHECK-VALID-RATE
 11498           ELSE
 11499             MOVE ER-7823               TO WS-ERROR
 11500             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11501             GO TO 3025-EDIT-REINSURANCE.
 11502
 11503       MOVE ER-7816                     TO WS-ERROR.
 11504       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11505       GO TO 3025-EDIT-REINSURANCE.
 11506
 11507**********   DMD CUSTOM CODE ABOVE    **********
 11508
 11509 3025-EDIT-REINSURANCE.
 11510     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11511         GO TO 3027-EDIT-CONTINUE.
 11512
 11513     MOVE LOW-VALUES               TO ERREIN-KEY.
 11514     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11515     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11516                                      REIN-CODE-2
 11517                                      REIN-CODE-3.
 11518     MOVE 'A'                      TO REIN-TYPE.
 11519
 11520     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11521
 11522     MOVE '3026' TO REIN-SW.
 11523     MOVE ' '                   TO WS-REIN-READ-SW.
 11524
 11525     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11526     IF REIN-TABLE-NOT-FOUND
 11527         GO TO 3026-NO-SPEC-TABLE.
 11528
 11529     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11530     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11531                                   WS-NSP-ST-CD-LF.
 11532     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11533                                   WS-NSP-ST-CD-AH.
 11534
 11535     GO TO 3040-EDIT-CONTINUE.
 11536
 11537 3026-NO-SPEC-TABLE.
 11538
 11539     MOVE ER-2664                TO WS-ERROR.
 11540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11541     GO TO 3040-EDIT-CONTINUE.
 11542
 11543 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 212
* EL050.cbl
 11544
 11545     IF PB-I-REIN-TABLE = SPACES
 11546       GO TO 3040-EDIT-CONTINUE.
 11547
 11548     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11549          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11550          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11551           GO TO 3040-EDIT-CONTINUE.
 11552
 11553     MOVE LOW-VALUES            TO ERREIN-KEY.
 11554     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11555     MOVE 'A'                   TO REIN-TYPE.
 11556     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11557
 11558     MOVE '3028'                TO REIN-SW.
 11559     MOVE ' '                   TO WS-REIN-READ-SW.
 11560
 11561     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11562     IF REIN-TABLE-NOT-FOUND
 11563         GO TO 3028-NO-REIN-TABLE.
 11564
 11565     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11566     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11567                                   WS-NSP-ST-CD-LF.
 11568     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11569                                   WS-NSP-ST-CD-AH.
 11570
 11571     GO TO 3040-EDIT-CONTINUE.
 11572
 11573 3028-NO-REIN-TABLE.
 11574
 11575     MOVE ER-2615                TO WS-ERROR.
 11576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11577     GO TO 3040-EDIT-CONTINUE.
 11578
 11579 3040-EDIT-CONTINUE.
 11580
 11581     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11582         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11583
 11584     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11585         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11586
 11587     IF (NOT PB-REISSUED-CERT)
 11588        AND (NOT PB-MONTHLY-CERT)
 11589        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11590            MOVE '001'           TO PB-I-LF-TERM
 11591            MOVE 'M'             TO PB-I-INSURED-SEX.
 11592
 11593     IF (NOT PB-REISSUED-CERT)
 11594        AND (NOT PB-MONTHLY-CERT)
 11595        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11596            MOVE '001'           TO PB-I-AH-TERM
 11597            MOVE 'M'             TO PB-I-INSURED-SEX.
 11598
 11599 3040-EDIT-1ST-PMT-DT.
 11600     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11601     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 213
* EL050.cbl
 11602         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11603
 11604******************************************************************
 11605*                                                                *
 11606*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11607*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11608*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11609*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11610*                                                                *
 11611******************************************************************
 11612
 11613     IF PB-EFF-DT-PROCESSING
 11614        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11615                                    PB-I-LF-EXPIRE-DT
 11616                                    PB-I-AH-EXPIRE-DT
 11617        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11618        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11619        MOVE ZERO                TO DC-ELAPSED-DAYS
 11620        MOVE +1                  TO DC-ELAPSED-MONTHS
 11621        SET BIN-PLUS-ELAPSED     TO TRUE
 11622*       MOVE 6                   TO DC-OPTION-CODE
 11623        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11624        IF NO-CONVERSION-ERROR
 11625           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11626
 11627******************************************************************
 11628*                                                                *
 11629*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11630*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11631*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11632*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11633*                                                                *
 11634******************************************************************
 11635
 11636     IF PB-EXT-DAYS-PROCESSING
 11637          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11638                                         PB-I-LF-EXPIRE-DT
 11639                                         PB-I-AH-EXPIRE-DT
 11640          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11641          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11642          MOVE +1                     TO DC-ELAPSED-MONTHS
 11643          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11644          SET BIN-PLUS-ELAPSED        TO TRUE
 11645*         MOVE 6                      TO DC-OPTION-CODE
 11646          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11647          IF NO-CONVERSION-ERROR
 11648             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11649
 11650******************************************************************
 11651*                                                                *
 11652*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11653*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11654*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11655*        (EXPIRE DATE - (TERM -1))  *  -1.
 11656*                                                                *
 11657******************************************************************
 11658
 11659     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 214
* EL050.cbl
 11660        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11661           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11662              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11663              MOVE PB-I-AH-TERM      TO WS-TERM
 11664           ELSE
 11665              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11666              MOVE PB-I-LF-TERM      TO WS-TERM
 11667        ELSE
 11668           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11669              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11670              MOVE PB-I-LF-TERM      TO WS-TERM
 11671           ELSE
 11672              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11673              MOVE PB-I-AH-TERM      TO WS-TERM.
 11674
 11675     IF PB-EXPIRE-DT-PROCESSING
 11676        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11677        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11678        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 11679        MOVE ZERO                TO DC-ELAPSED-DAYS
 11680                                    DC-ODD-DAYS-OVER
 11681          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 11682          SET BIN-PLUS-ELAPSED    TO TRUE
 11683*         MOVE 6                  TO DC-OPTION-CODE
 11684          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11685          IF NO-CONVERSION-ERROR
 11686             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11687
 11688******************************************************************
 11689*                                                                *
 11690*            1ST PAYMENT DATE PROCESSING                         *
 11691*                                                                *
 11692******************************************************************
 11693
 11694     IF PB-1ST-PMT-DT-PROCESSING
 11695        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 11696                                    PB-I-AH-EXPIRE-DT
 11697        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 11698
 11699     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 11700         NEXT SENTENCE
 11701     ELSE
 11702         MOVE ER-2680                 TO WS-ERROR
 11703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11704         GO TO 3060-ORIG-TERM-CHECK.
 11705
 11706     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 11707     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 11708     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11709*    MOVE 1                      TO DC-OPTION-CODE.
 11710     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11711                                    DC-ELAPSED-DAYS
 11712                                    DC-ODD-DAYS-OVER.
 11713
 11714     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11715
 11716     IF DATE-CONVERSION-ERROR
 11717        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 215
* EL050.cbl
 11718
 11719     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 11720     IF (PB-COMPANY-ID = 'CID')
 11721        AND (WS-LF-COVERAGE-TYPE = 'L')
 11722        IF (DC-ELAPSED-MONTHS > 1)
 11723                      OR
 11724           ((DC-ELAPSED-MONTHS = 1)
 11725           AND (DC-ODD-DAYS-OVER > 0))
 11726           MOVE ER-2882          TO WS-ERROR
 11727           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11728        END-IF
 11729     END-IF
 11730     IF PB-EXT-DAYS-PROCESSING
 11731        CONTINUE
 11732     ELSE
 11733        IF DC-ELAPSED-MONTHS = +0
 11734           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 11735        ELSE
 11736           IF (WS-LF-EARNINGS-CALC = '4')
 11737              AND (DC-ELAPSED-MONTHS > ZERO)
 11738              AND (DC-ELAPSED-DAYS > ZERO)
 11739              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 11740           ELSE
 11741              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 11742                                 THRU 6499-EXIT
 11743              MOVE WS-ODD-DAYS-OVER
 11744                                 TO PB-I-EXTENTION-DAYS
 11745           END-IF
 11746        END-IF
 11747     END-IF
 11748******************************************************************
 11749*                                                                *
 11750*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 11751*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 11752*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 11753*            AND ANY ODD DAYS.                                   *
 11754*                                                                *
 11755******************************************************************
 11756
 11757     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 11758                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 11759     IF WS-LF-EARNINGS-CALC NOT = '4'
 11760        IF DC-ELAPSED-DAYS > ZEROS
 11761           MOVE ER-2681          TO WS-ERROR
 11762           PERFORM 9900-ERROR-FORMAT
 11763                                 THRU 9900-EXIT
 11764        END-IF
 11765     END-IF
 11766
 11767     IF WS-LF-EARNINGS-CALC NOT = '4'
 11768        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 11769           MOVE ER-2681          TO WS-ERROR
 11770           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11771
 11772     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 11773        (PB-I-LF-TERM NOT = ZERO) AND
 11774         NOT NO-LIFE-COVERAGE
 11775          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 216
* EL050.cbl
 11776          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 11777          IF WS-LF-EARNINGS-CALC = '4'
 11778             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 11779             PB-I-PAY-FREQUENCY
 11780          END-IF
 11781          MOVE ZERO              TO DC-ELAPSED-DAYS
 11782                                    DC-ODD-DAYS-OVER
 11783          MOVE 1                 TO DC-END-OF-MONTH
 11784          SET BIN-PLUS-ELAPSED        TO TRUE
 11785*         MOVE 6                 TO DC-OPTION-CODE
 11786          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11787          IF NO-CONVERSION-ERROR
 11788             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 11789             IF (WS-LF-EARNINGS-CALC = 'B') AND
 11790                (WS-LF-SPECIAL-CALC-CD = 'L')
 11791                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 11792                  MOVE ZERO           TO DC-ELAPSED-DAYS
 11793                  MOVE +1             TO DC-ELAPSED-MONTHS
 11794                  SET BIN-PLUS-ELAPSED  TO TRUE
 11795*                 MOVE 6              TO DC-OPTION-CODE
 11796                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11797                  IF NO-CONVERSION-ERROR
 11798                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 11799
 11800* okay, i had to move the new att age edit down here because the
 11801* expiration date could get recalculated and i need the exp date
 11802     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 11803        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 11804        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 11805        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11806           AND ZEROS
 11807           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11808           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11809           SET ELAPSED-BETWEEN-BIN TO TRUE
 11810           PERFORM 8500-DATE-CONVERT
 11811                                 THRU 8500-EXIT
 11812           IF NO-CONVERSION-ERROR
 11813              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11814                 MOVE ER-2669       TO WS-ERROR
 11815*                PERFORM 9900-ERROR-FORMAT
 11816*                                THRU 9900-EXIT
 11817              END-IF
 11818           END-IF
 11819        ELSE
 11820           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 11821           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11822              MOVE ER-2669       TO WS-ERROR
 11823*             PERFORM 9900-ERROR-FORMAT
 11824*                                THRU 9900-EXIT
 11825           ELSE
 11826              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11827                 MOVE ER-1570    TO WS-ERROR
 11828                 PERFORM 9900-ERROR-FORMAT
 11829                                 THRU 9900-EXIT
 11830              END-IF
 11831           END-IF
 11832        END-IF
 11833        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 217
* EL050.cbl
 11834           AND ZEROS
 11835           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11836           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 11837           SET ELAPSED-BETWEEN-BIN TO TRUE
 11838           PERFORM 8500-DATE-CONVERT
 11839                                 THRU 8500-EXIT
 11840           IF NO-CONVERSION-ERROR
 11841              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 11842                 MOVE ER-2669       TO WS-ERROR
 11843*                PERFORM 9900-ERROR-FORMAT
 11844*                                THRU 9900-EXIT
 11845              END-IF
 11846           END-IF
 11847        ELSE
 11848           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11849             (PB-I-LF-TERM / 12)
 11850           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 11851              MOVE ER-2669       TO WS-ERROR
 11852*             PERFORM 9900-ERROR-FORMAT
 11853*                                THRU 9900-EXIT
 11854           ELSE
 11855              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 11856                 MOVE ER-1571    TO WS-ERROR
 11857                 PERFORM 9900-ERROR-FORMAT
 11858                                 THRU 9900-EXIT
 11859              END-IF
 11860           END-IF
 11861        END-IF
 11862        IF WS-ERROR = ER-2669
 11863           PERFORM 9900-ERROR-FORMAT
 11864                                 THRU 9900-EXIT
 11865        END-IF
 11866     END-IF
 11867     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 11868        (PB-I-AH-TERM NOT = ZERO) AND
 11869         NOT NO-AH-COVERAGE
 11870          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 11871             AND (PB-COMPANY-ID = 'DCC')
 11872             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11873             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 11874          ELSE
 11875             IF WS-LF-EARNINGS-CALC = '4'
 11876                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 11877                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 11878                PB-I-PAY-FREQUENCY
 11879             ELSE
 11880                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 11881                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 11882             END-IF
 11883          END-IF
 11884          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11885                                         DC-ODD-DAYS-OVER
 11886          MOVE 1                      TO DC-END-OF-MONTH
 11887          SET BIN-PLUS-ELAPSED        TO TRUE
 11888*         MOVE 6                      TO DC-OPTION-CODE
 11889          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11890          IF NO-CONVERSION-ERROR
 11891             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 218
* EL050.cbl
 11892     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 11893        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 11894        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 11895        IF PB-I-BIRTHDAY > LOW-VALUES
 11896           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 11897           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11898           SET ELAPSED-BETWEEN-BIN TO TRUE
 11899           PERFORM 8500-DATE-CONVERT
 11900                                 THRU 8500-EXIT
 11901           IF NO-CONVERSION-ERROR
 11902              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11903                 MOVE ER-3054       TO WS-ERROR
 11904*                PERFORM 9900-ERROR-FORMAT
 11905*                                THRU 9900-EXIT
 11906              END-IF
 11907           END-IF
 11908        ELSE
 11909           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 11910           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11911              MOVE ER-3054       TO WS-ERROR
 11912*             PERFORM 9900-ERROR-FORMAT
 11913*                                THRU 9900-EXIT
 11914           END-IF
 11915        END-IF
 11916        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 11917           AND ZEROS
 11918           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 11919           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 11920           SET ELAPSED-BETWEEN-BIN TO TRUE
 11921           PERFORM 8500-DATE-CONVERT
 11922                                 THRU 8500-EXIT
 11923           IF NO-CONVERSION-ERROR
 11924              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 11925                 MOVE ER-3054       TO WS-ERROR
 11926*                PERFORM 9900-ERROR-FORMAT
 11927*                                THRU 9900-EXIT
 11928              END-IF
 11929           END-IF
 11930        ELSE
 11931           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 11932             (PB-I-AH-TERM / 12)
 11933           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 11934              MOVE ER-3054       TO WS-ERROR
 11935*             PERFORM 9900-ERROR-FORMAT
 11936*                                THRU 9900-EXIT
 11937           END-IF
 11938        END-IF
 11939        IF WS-ERROR = ER-3054
 11940           PERFORM 9900-ERROR-FORMAT
 11941                                 THRU 9900-EXIT
 11942        END-IF
 11943     END-IF
 11944     MOVE SPACE                       TO DC-END-OF-MONTH.
 11945
 11946     IF PB-COMPANY-ID = 'NCB'
 11947        GO TO 3040-EDIT-EXTENSION-DAYS.
 11948
 11949     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 219
* EL050.cbl
 11950       AND
 11951        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 11952        NEXT SENTENCE
 11953     ELSE
 11954        GO TO 3040-EDIT-EXTENSION-DAYS.
 11955
 11956     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 11957        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 11958        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 11959     ELSE
 11960        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 11961        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 11962
 11963     SET ELAPSED-BETWEEN-BIN TO TRUE.
 11964*    MOVE '1'      TO DC-OPTION-CODE
 11965     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11966     IF (NO-CONVERSION-ERROR)
 11967        AND (DC-ELAPSED-MONTHS > +1)
 11968        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 11969        MOVE ER-2668   TO WS-ERROR
 11970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11971
 11972 3040-EDIT-EXTENSION-DAYS.
 11973
 11974     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 11975        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 11976         GO TO 3050-EDIT-TERM-IN-DAYS
 11977     ELSE
 11978         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 11979
 11980     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 11981         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 11982     ELSE
 11983        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 11984           AND (WS-LF-EARNINGS-CALC NOT = '4')
 11985           MOVE ER-2681         TO WS-ERROR
 11986           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11987
 11988     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 11989        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 11990        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 11991         GO TO 3060-ORIG-TERM-CHECK.
 11992
 11993     GO TO 3060-ORIG-TERM-CHECK.
 11994
 11995 3050-EDIT-TERM-IN-DAYS.
 11996
 11997     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 11998
 11999     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12000         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12001     ELSE
 12002         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12003            MOVE ER-2682         TO WS-ERROR
 12004            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12005
 12006     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12007                                       REMAINDER WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 220
* EL050.cbl
 12008     IF WS-WORK-TERM GREATER THAN ZERO
 12009         ADD +1 TO PB-I-LF-TERM.
 12010
 12011     IF NOT NO-AH-COVERAGE
 12012         MOVE ER-2684            TO WS-ERROR
 12013         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12014
 12015
 12016 3060-ORIG-TERM-CHECK.
 12017
 12018******************************************************************
 12019*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12020******************************************************************
 12021
 12022     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12023        NEXT SENTENCE
 12024     ELSE
 12025        IF NOT NO-LIFE-COVERAGE
 12026           IF PB-I-LF-TERM NUMERIC
 12027              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12028              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12029              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12030                  NEXT SENTENCE
 12031           ELSE
 12032              MOVE ER-2647       TO WS-ERROR
 12033              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12034
 12035     IF NOT NO-AH-COVERAGE
 12036         IF PB-I-AH-TERM NUMERIC
 12037            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12038            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12039            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12040             NEXT SENTENCE
 12041          ELSE
 12042              MOVE ER-2658       TO WS-ERROR
 12043              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12044
 12045     IF PB-COMPANY-ID = 'NCB'
 12046        GO TO 3070-LOAN-TERM-CHECK.
 12047
 12048     IF POLICY-HAS-AH
 12049       AND
 12050        POLICY-HAS-LIFE
 12051       AND
 12052        PB-I-LF-TERM NUMERIC
 12053       AND
 12054        PB-I-AH-TERM NUMERIC
 12055        NEXT SENTENCE
 12056     ELSE
 12057        GO TO 3070-LOAN-TERM-CHECK.
 12058
 12059     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12060     IF WS-TEX-FACT-2 LESS THAN +0
 12061        MULTIPLY +1 BY WS-TEX-FACT-2.
 12062
 12063     IF WS-TEX-FACT-2 GREATER THAN +1
 12064        MOVE ER-2668             TO WS-ERROR
 12065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 221
* EL050.cbl
 12066
 12067 3070-LOAN-TERM-CHECK.
 12068
 12069     IF (WS-LF-BENEFIT-CD = ZERO)
 12070         OR (NO-LF-BENEFIT-MATCH)
 12071            GO TO 3125-EDIT-PMT-FREQ.
 12072
 12073     IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U' AND 'V' AND
 12074                                     'W' AND 'X'
 12075         GO TO 3125-EDIT-PMT-FREQ.
 12076
 12077     IF PB-I-LOAN-TERM NOT NUMERIC
 12078         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12079
 12080     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12081        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12082        PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12083        PB-I-LOAN-TERM NOT GREATER THAN +360
 12084         NEXT SENTENCE
 12085     ELSE
 12086         MOVE ER-2648            TO WS-ERROR
 12087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12088
 12089     IF WS-STATE-ABBREVIATION = 'NC'
 12090        IF PB-I-LOAN-TERM > +59
 12091           CONTINUE
 12092        ELSE
 12093           MOVE ER-2792          TO WS-ERROR
 12094           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12095        END-IF
 12096     END-IF
 12097
 12098     .
 12099 3125-EDIT-PMT-FREQ.
 12100     IF (WS-LF-BENEFIT-CD = ZERO)
 12101         OR (NO-LF-BENEFIT-MATCH)
 12102            GO TO 3127-EDIT-LOAN-OFFICER.
 12103     IF WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 12104        CONTINUE
 12105     ELSE
 12106        IF (PB-I-LOAN-TERM > ZEROS)
 12107           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12108           MOVE ER-1575          TO WS-ERROR
 12109           PERFORM 9900-ERROR-FORMAT
 12110                                 THRU 9900-EXIT
 12111        END-IF
 12112     END-IF
 12113     IF WS-LF-EARNINGS-CALC NOT = '4'
 12114         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12115            MOVE ER-2653         TO WS-ERROR
 12116            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12117            GO TO 3127-EDIT-LOAN-OFFICER
 12118         ELSE
 12119            GO TO 3127-EDIT-LOAN-OFFICER.
 12120
 12121     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12122         MOVE ER-2655            TO WS-ERROR
 12123         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 222
* EL050.cbl
 12124         GO TO 3127-EDIT-LOAN-OFFICER.
 12125
 12126     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12127         MOVE ER-2654            TO WS-ERROR
 12128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12129         GO TO 3127-EDIT-LOAN-OFFICER.
 12130
 12131     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12132         GIVING WS-TEX-FACT-2
 12133             REMAINDER WS-TEX-FACT-3.
 12134
 12135*    IF WS-TEX-FACT-3 NOT = ZERO
 12136*       MOVE ER-2654             TO WS-ERROR
 12137*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12138
 12139
 12140 3127-EDIT-LOAN-OFFICER.
 12141
 12142     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12143        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12144           MOVE ER-2690          TO WS-ERROR
 12145           PERFORM 9900-ERROR-FORMAT
 12146                                 THRU 9900-EXIT
 12147        ELSE
 12148           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12149           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12150           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12151           MOVE PB-SV-STATE      TO LOFC-STATE
 12152           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
 12153           MOVE PB-I-LOAN-OFFICER
 12154                                 TO LOFC-CODE
 12155           PERFORM 8586-READ-LOAN-OFFICER
 12156                                 THRU 8586-EXIT
 12157           IF (NOT LOFC-MASTER-FOUND)
 12158              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12159              MOVE ER-3006       TO WS-ERROR
 12160              PERFORM 9900-ERROR-FORMAT
 12161                                 THRU 9900-EXIT
 12162           END-IF
 12163        END-IF
 12164     END-IF
 12165     .
 12166 3129-EDIT-APR.
 12167
 12168     IF (WS-LF-BENEFIT-CD = ZERO)
 12169        OR (NO-LF-BENEFIT-MATCH)
 12170        IF PB-COMPANY-ID NOT = 'DCC'
 12171           GO TO 3130-EDIT-AGE
 12172*       ELSE
 12173*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12174*             GO TO 3130-EDIT-AGE
 12175*          END-IF
 12176        END-IF
 12177     END-IF
 12178
 12179     IF (WS-STATE-ABBREVIATION = 'OH')
 12180         AND (PB-I-RATE-CLASS NOT = 'L ')
 12181         AND (PB-I-LF-TERM GREATER THAN 60)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 223
* EL050.cbl
 12182         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12183         GO TO 3129-APR-CONT.
 12184
 12185     IF (WS-STATE-ABBREVIATION = 'RI')
 12186         AND (PB-I-LF-TERM GREATER THAN 60)
 12187         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12188         GO TO 3129-APR-CONT.
 12189
 12190     IF (WS-STATE-ABBREVIATION = 'UT')
 12191         AND (PB-I-LF-TERM GREATER THAN 62)
 12192         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12193         AND (PB-CERT-EFF-DT LESS WS-830901)
 12194         GO TO 3129-APR-CONT.
 12195
 12196     IF PB-COMPANY-ID = 'LAP'
 12197        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12198           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12199              MOVE ER-2656         TO WS-ERROR
 12200              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12201              GO TO 3130-EDIT-AGE.
 12202
 12203     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12204        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12205        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12206        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12207         GO TO 3130-EDIT-AGE.
 12208
 12209 3129-APR-CONT.
 12210     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12211         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12212         GO TO 3130-EDIT-AGE.
 12213
 12214     IF (WS-LF-BENEFIT-CD (1:1) = 'S')
 12215        AND (PB-COMPANY-ID = 'DCC')
 12216        AND (PB-I-LOAN-APR = ZERO)
 12217        MOVE ER-2657             TO WS-ERROR
 12218        PERFORM 9900-ERROR-FORMAT
 12219                                 THRU 9900-EXIT
 12220        GO TO 3130-EDIT-AGE
 12221     END-IF
 12222     IF PB-I-LOAN-APR = ZERO
 12223        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12224     END-IF
 12225
 12226     IF PB-I-LOAN-APR = ZERO
 12227        MOVE ER-2656             TO WS-ERROR
 12228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12229        GO TO 3130-EDIT-AGE.
 12230
 12231*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12232     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
 12233        MOVE ER-2657             TO WS-ERROR
 12234        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12235
 12236 3130-EDIT-AGE.
 12237
 12238******************************************************************
 12239*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 224
* EL050.cbl
 12240******************************************************************
 12241
 12242     IF NOT NO-LIFE-COVERAGE
 12243        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12244           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12245               MOVE ER-2628             TO WS-ERROR
 12246               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12247
 12248     IF NOT NO-AH-COVERAGE
 12249        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12250           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12251               MOVE ER-2628         TO WS-ERROR
 12252               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12253
 12254 3133-SEX-CODE.
 12255     IF PB-I-INSURED-SEX = SPACE OR ZERO
 12256         IF WS-DEFAULT-SEX = 'M'
 12257             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12258          ELSE
 12259             IF WS-DEFAULT-SEX = 'F'
 12260             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12261
 12262     IF PB-I-INSURED-SEX = '1'
 12263         MOVE 'M' TO PB-I-INSURED-SEX.
 12264
 12265     IF PB-I-INSURED-SEX = '2'
 12266         MOVE 'F' TO PB-I-INSURED-SEX.
 12267
 12268 3134-SIG-SW-EDIT.
 12269     IF PB-I-SIG-SW = SPACE
 12270         MOVE 'N'                TO  PB-I-SIG-SW.
 12271
 12272     IF PB-COMPANY-ID = 'NCL'
 12273         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12274             NEXT SENTENCE
 12275         ELSE
 12276             MOVE ER-1923        TO  WS-ERROR
 12277             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12278     ELSE
 12279     IF PB-COMPANY-ID = 'CRI'
 12280         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12281             NEXT SENTENCE
 12282         ELSE
 12283             MOVE ER-2606        TO  WS-ERROR
 12284             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12285     ELSE
 12286     IF PB-COMPANY-ID = 'TMS'
 12287         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12288             NEXT SENTENCE
 12289         ELSE
 12290             MOVE ER-2689        TO  WS-ERROR
 12291             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12292     ELSE
 12293         IF PB-I-SIG-SW = 'Y' OR 'N'
 12294             NEXT SENTENCE
 12295         ELSE
 12296             MOVE ER-2651        TO  WS-ERROR
 12297             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 225
* EL050.cbl
 12298
 12299     IF PB-COMPANY-ID = 'FLA'
 12300         IF (WS-EDIT-AGE GREATER 54  OR
 12301             WS-AH-EDIT-AGE GREATER 54)  AND
 12302            PB-I-SIG-SW = 'N'
 12303            MOVE ER-2651         TO  WS-ERROR
 12304            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12305
 12306 3135-NAME-EDIT.
 12307
 12308     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12309        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12310        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12311           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12312                                 TO PB-I-JOINT-FIRST-NAME
 12313        END-PERFORM
 12314     END-IF
 12315     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12316        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12317        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12318           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12319                                 TO PB-I-JOINT-LAST-NAME
 12320        END-PERFORM
 12321     END-IF
 12322     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12323        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12324        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12325           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12326                                 TO PB-I-INSURED-FIRST-NAME
 12327        END-PERFORM
 12328     END-IF
 12329     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12330        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12331        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12332           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12333                                 TO PB-I-INSURED-LAST-NAME
 12334        END-PERFORM
 12335     END-IF
 12336     IF PB-I-INSURED-LAST-NAME = SPACES
 12337       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12338       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12339           MOVE ER-2660    TO WS-ERROR
 12340           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12341
 12342 3136-EDIT-SEX.
 12343
 12344******************************************************************
 12345*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12346******************************************************************
 12347
 12348     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12349        (WS-AH-SPECIAL-CALC-CD = 'O')
 12350        NEXT SENTENCE
 12351     ELSE
 12352        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12353           NEXT SENTENCE
 12354        ELSE
 12355           MOVE ER-2629            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 226
* EL050.cbl
 12356           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12357
 12358 3137-EDIT-EFF-DATE.
 12359
 12360     IF PB-REISSUED-CERT       OR
 12361        PB-POLICY-IS-DECLINED  OR
 12362        PB-POLICY-IS-VOIDED
 12363         GO TO 3139-EDIT-COVERAGE-CODES.
 12364
 12365     MOVE SPACE                  TO WS-2671-SW
 12366                                    WS-2672-SW.
 12367
 12368     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12369         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12370             MOVE ER-2703        TO WS-ERROR
 12371             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12372             GO TO 3139-EDIT-COVERAGE-CODES.
 12373
 12374     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12375         GO TO 3139-EDIT-COVERAGE-CODES.
 12376
 12377     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12378     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12379*    MOVE '1'                    TO DC-OPTION-CODE.
 12380     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12381     MOVE +0                     TO DC-ELAPSED-MONTHS
 12382                                    DC-ELAPSED-DAYS.
 12383     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12384
 12385     IF DATE-CONVERSION-ERROR
 12386         GO TO 3139-EDIT-COVERAGE-CODES.
 12387
 12388     IF DC-ELAPSED-DAYS GREATER +180
 12389         MOVE ER-2672            TO WS-ERROR
 12390         MOVE 'Y'                TO WS-2672-SW
 12391         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12392     END-IF
 12393
 12394     IF WS-ERROR = ER-2671  AND
 12395        PB-COMPANY-ID  = 'LBL'
 12396        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12397        MOVE SPACE               TO WS-2671-SW
 12398        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12399
 12400     IF PB-ISSUE-DATE-FORCED  AND
 12401      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12402         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12403         MOVE ER-2673            TO WS-ERROR
 12404         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12405         MOVE SPACE              TO WS-2671-SW
 12406                                    WS-2672-SW.
 12407
 12408     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12409         IF PB-ISSUE-DATE-FORCED
 12410             MOVE ER-2600          TO  WS-ERROR
 12411             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12412         ELSE
 12413             MOVE ER-2692          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 227
* EL050.cbl
 12414             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12415
 12416
 12417 3139-EDIT-COVERAGE-CODES.
 12418
 12419     IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12420        PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12421        MOVE ER-2787             TO WS-ERROR
 12422        PERFORM 9900-ERROR-FORMAT
 12423                                 THRU 9900-EXIT
 12424     END-IF
 12425     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12426        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12427                                 > 250000.00
 12428           MOVE ER-2719          TO WS-ERROR
 12429           PERFORM 9900-ERROR-FORMAT
 12430                                 THRU 9900-EXIT
 12431        END-IF
 12432     END-IF
 12433
 12434     IF PB-POLICY-IS-DECLINED  OR
 12435        PB-POLICY-IS-VOIDED
 12436         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12437
 12438     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12439        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12440         MOVE ER-2630                TO WS-ERROR
 12441         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12442
 12443     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12444        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12445        PB-I-LF-PREMIUM-AMT = ZERO
 12446         GO TO 3140-CHECK-AH-FOR-ZERO.
 12447
 12448     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12449        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12450        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12451         GO TO 3140-CHECK-AH-FOR-ZERO.
 12452
 12453     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12454        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12455        MOVE ER-2631             TO WS-ERROR
 12456        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12457     END-IF
 12458
 12459
 12460******************************************************************
 12461*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12462******************************************************************
 12463
 12464     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12465        NEXT SENTENCE
 12466     ELSE
 12467        IF PB-I-LF-BENEFIT-AMT = ZERO
 12468           MOVE ER-2632             TO WS-ERROR
 12469           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12470
 12471
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 228
* EL050.cbl
 12472******************************************************************
 12473*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12474******************************************************************
 12475
 12476     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12477        CONTINUE
 12478     ELSE
 12479        IF PB-I-LF-PREMIUM-AMT = ZERO
 12480           IF (NOT PB-COMP-LF-PREM)
 12481              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12482              MOVE ER-2633       TO WS-ERROR
 12483              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12484           END-IF
 12485        END-IF
 12486     END-IF
 12487     .
 12488 3140-CHECK-AH-FOR-ZERO.
 12489
 12490     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12491        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12492        PB-I-AH-PREMIUM-AMT = ZERO
 12493         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12494
 12495     IF PB-COMPANY-ID = 'CSL'  AND
 12496        PB-I-AH-BENEFIT-CD = ZERO  AND
 12497        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12498        PB-I-AH-PREMIUM-AMT = ZERO
 12499         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12500
 12501     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12502        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12503        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12504         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12505
 12506     IF PB-I-AH-BENEFIT-CD = ZERO
 12507         MOVE ER-2634            TO WS-ERROR
 12508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12509
 12510******************************************************************
 12511*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12512******************************************************************
 12513
 12514     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12515        NEXT SENTENCE
 12516     ELSE
 12517        IF PB-I-AH-BENEFIT-AMT = ZERO
 12518           MOVE ER-2635             TO WS-ERROR
 12519           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12520
 12521******************************************************************
 12522*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12523******************************************************************
 12524
 12525     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12526        NEXT SENTENCE
 12527     ELSE
 12528        IF PB-I-AH-PREMIUM-AMT = ZERO
 12529            IF NOT PB-COMP-AH-PREM
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 229
* EL050.cbl
 12530                MOVE ER-2636    TO WS-ERROR
 12531                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12532
 12533
 12534 3140-EDIT-MAX-AMT-SIZES.
 12535* CUSTOM CODE FOR CLIENT    'DMD'
 12536     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12537                                     WS-RES-MUNI-TAX
 12538                                     PB-I-STATE-TAX
 12539                                     PB-I-MUNI-TAX.
 12540
 12541     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12542
 12543     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12544        GO TO 3150-RATE-OUTSTAND-BAL.
 12545
 12546     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12547        GO TO 3150-RATE-OUTSTAND-BAL.
 12548
 12549     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12550        GO TO 3150-RATE-OUTSTAND-BAL.
 12551
 12552     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12553                             OR 'RIC')
 12554        GO TO 3150-RATE-OUTSTAND-BAL.
 12555
 12556     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12557        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12558            GO TO 3150-RATE-OUTSTAND-BAL
 12559        ELSE
 12560           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12561               GO TO 3150-RATE-OUTSTAND-BAL.
 12562
 12563     IF NOT PB-NO-MONTHS-SKIPPED
 12564        GO TO 3150-RATE-OUTSTAND-BAL.
 12565
 12566     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12567        GO TO 3150-RATE-OUTSTAND-BAL.
 12568
 12569     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12570        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12571           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12572             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12573           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12574           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12575              MOVE ER-2693     TO WS-ERROR
 12576              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12577              GO TO 3150-RATE-OUTSTAND-BAL
 12578           ELSE
 12579              GO TO 3150-RATE-OUTSTAND-BAL.
 12580
 12581 3150-RATE-OUTSTAND-BAL.
 12582
 12583* DMD RATING TEST
 12584     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12585         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12586         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12587         MOVE ER-2687                 TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 230
* EL050.cbl
 12588         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12589         MOVE 'B'                     TO PB-I-OB-FLAG
 12590         GO TO 3260-EDIT-CONTINUE.
 12591
 12592     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12593         IF  WS-ERROR    EQUAL    ER-2693
 12594             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12595                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12596                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12597                 MOVE  +0            TO  WS-ERROR.
 12598
 12599     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12600         IF  WS-ERROR    EQUAL    ER-2693
 12601             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 12602                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12603                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12604                 MOVE  +0            TO  WS-ERROR.
 12605
 12606     IF PLAN-MASTER-AH-SW = 'Y'
 12607        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12608            IF  WS-ERROR    EQUAL    ER-2693
 12609              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12610                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12611                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12612                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12613                 MOVE  ER-1910           TO  WS-ERROR
 12614                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12615
 12616     IF PLAN-MASTER-AH-SW = 'Y'
 12617        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12618            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12619               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12620               MOVE  ER-1910           TO  WS-ERROR
 12621               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12622
 12623     IF PLAN-MASTER-AH-SW = 'Y'
 12624        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12625            IF  WS-ERROR    EQUAL    ER-2693
 12626                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12627                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12628                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12629                 MOVE  +0       TO  WS-ERROR.
 12630
 12631     IF WS-ERROR = ER-2693
 12632        IF PB-COMPANY-ID = 'JAL' AND
 12633           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 12634           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12635           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12636
 12637     IF WS-ERROR = ER-2693
 12638        IF PB-COMPANY-ID = 'NCL'  AND
 12639           PB-I-AH-BENEFIT-CD = 'OA'
 12640           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12641           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12642
 12643     IF WS-ERROR = ER-2693
 12644        IF PB-COMPANY-ID = 'CNL' AND
 12645           PB-I-LF-BENEFIT-CD = '71' OR '72'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 231
* EL050.cbl
 12646           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12647           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12648
 12649     IF WS-ERROR = ER-2693
 12650        IF PB-COMPANY-ID = 'HER'
 12651           IF WS-LEVEL
 12652              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12653              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 12654
 12655     IF ((LF-BENEFIT-FOUND) AND
 12656         (NOT NO-LIFE-COVERAGE)  AND
 12657         (WS-LF-SPECIAL-CALC-CD = 'O'))
 12658       OR   ((AH-BENEFIT-FOUND) AND
 12659             (NOT NO-AH-COVERAGE)    AND
 12660             (WS-AH-SPECIAL-CALC-CD = 'O'))
 12661         NEXT SENTENCE
 12662     ELSE
 12663         GO TO 3215-EDIT-RATES.
 12664
 12665     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12666        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12667           MOVE ER-2674          TO WS-ERROR
 12668           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12669           GO TO 3215-EDIT-RATES.
 12670
 12671     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12672        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12673           MOVE ER-2674          TO WS-ERROR
 12674           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12675           GO TO 3215-EDIT-RATES.
 12676
 12677     MOVE 'B'                    TO PB-I-OB-FLAG.
 12678
 12679     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12680         NEXT SENTENCE
 12681     ELSE
 12682         IF NOT NO-LIFE-COVERAGE
 12683             IF WS-ACCT-LF-OB-RT = ZERO
 12684                MOVE ER-2641    TO WS-ERROR
 12685                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12686
 12687     IF PB-COMPANY-ID = 'CRI'
 12688       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 12689         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12690         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12691         IF WS-ERROR = ER-2675
 12692            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12693            MOVE ER-2687              TO WS-ERROR
 12694            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12695         ELSE
 12696            MOVE ER-2687              TO WS-ERROR
 12697            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12698
 12699
 12700     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 12701         NEXT SENTENCE
 12702     ELSE
 12703         IF NOT NO-AH-COVERAGE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 232
* EL050.cbl
 12704             IF WS-ACCT-AH-OB-RT = ZERO
 12705                MOVE ER-2642    TO WS-ERROR
 12706                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12707
 12708     IF PB-COMPANY-ID = 'CRI'
 12709       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 12710         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 12711         IF WS-ERROR = ER-2676
 12712            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 12713            MOVE ER-2687              TO WS-ERROR
 12714            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12715         ELSE
 12716            MOVE ER-2687              TO WS-ERROR
 12717            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12718
 12719     IF PB-COMPANY-ID NOT = 'GIC'
 12720         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12721            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 12722     ELSE
 12723         IF PB-I-LF-PREM-CALC = ZEROS
 12724             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 12725                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 12726
 12727     IF PB-COMPANY-ID NOT = 'GIC'
 12728         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12729            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 12730     ELSE
 12731         IF PB-I-AH-PREM-CALC = ZEROS
 12732             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 12733                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 12734
 12735     MOVE ZEROS TO PB-I-MORT-CODE.
 12736
 12737     GO TO 3260-EDIT-CONTINUE.
 12738
 12739
 12740 3215-EDIT-RATES.
 12741     IF ACCOUNT-MAST-FOUND
 12742         NEXT SENTENCE
 12743     ELSE
 12744         GO TO 3999-END-EDIT.
 12745
 12746 3220-CHECK-LF-RATES.
 12747
 12748     IF PB-COMPANY-ID = 'DCC'
 12749        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 12750        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 12751        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12752           AND (NOT WS-LF-CASH))
 12753                           OR
 12754           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 12755           AND (NOT WS-AH-CASH)))
 12756                       AND
 12757           (PB-I-ENTRY-STATUS NOT = '5')
 12758           MOVE 'M'              TO PB-BATCH-ENTRY
 12759                                    PB-I-ENTRY-STATUS
 12760        END-IF
 12761     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 233
* EL050.cbl
 12762     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 12763                                    PB-I-AH-PREM-CALC
 12764                                    PB-I-LF-ALT-PREM-CALC
 12765                                    PB-I-LF-ALT-RATE
 12766                                    PB-I-LF-REI-RATE
 12767                                    PB-I-LF-ALT-REI-RATE
 12768                                    PB-I-AH-REI-RATE
 12769                                    PB-I-TOT-FEES-CALC.
 12770
 12771     IF PB-COMPANY-ID EQUAL 'DMD'
 12772        NEXT SENTENCE
 12773     ELSE
 12774        MOVE ZEROS               TO PB-I-LF-RATE
 12775                                    PB-I-AH-RATE.
 12776
 12777     IF PB-I-TOT-FEES NOT NUMERIC
 12778        MOVE ZEROS               TO PB-I-TOT-FEES
 12779     END-IF
 12780     IF PB-I-LIVES NOT NUMERIC
 12781         MOVE ZERO               TO PB-I-LIVES.
 12782
 12783     IF PB-I-NUM-BILLED NOT NUMERIC
 12784         MOVE ZERO               TO PB-I-NUM-BILLED.
 12785
 12786     IF PB-I-LF-PREM-TAX NOT NUMERIC
 12787        MOVE +0                  TO PB-I-LF-PREM-TAX
 12788     END-IF
 12789
 12790     IF PB-I-AH-PREM-TAX NOT NUMERIC
 12791        MOVE +0                  TO PB-I-AH-PREM-TAX
 12792     END-IF
 12793
 12794     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 12795        PB-I-PAY-FREQUENCY = ZEROS
 12796            MOVE 12 TO CP-PAY-FREQUENCY
 12797     ELSE
 12798            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 12799
 12800     IF PB-I-STATE-TAX NOT NUMERIC
 12801         MOVE ZEROS               TO PB-I-STATE-TAX.
 12802
 12803     IF PB-I-MUNI-TAX NOT NUMERIC
 12804         MOVE ZEROS               TO PB-I-MUNI-TAX.
 12805
 12806     MOVE SPACES                 TO CP-BEN-CATEGORY
 12807     IF PB-COMPANY-ID  = 'CSL'  AND
 12808        PB-I-LF-TERM NOT = ZERO
 12809        COMPUTE WS-PAYMENT-AMT =
 12810             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 12811        COMPUTE WS-CSL-AMT1 =
 12812             PB-I-LF-TERM * AM-MAX-MON-BEN
 12813        COMPUTE WS-CSL-AMT2 =
 12814             WS-PAYMENT-AMT * PB-I-LF-TERM
 12815        IF CP-PAY-FREQUENCY NOT = 12
 12816           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 12817           MOVE '8' TO WS-CSL-CALC-CD
 12818        ELSE
 12819           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 234
* EL050.cbl
 12820              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 12821               AM-MAX-TOT-BEN
 12822               MOVE '6' TO WS-CSL-CALC-CD
 12823           ELSE
 12824              IF (WS-CSL-AMT1  GREATER THAN
 12825                 AM-MAX-TOT-BEN) AND
 12826                 (WS-CSL-AMT2  GREATER THAN
 12827                 AM-MAX-TOT-BEN)
 12828                 MOVE '7' TO WS-CSL-CALC-CD
 12829              ELSE
 12830                 MOVE '5' TO WS-CSL-CALC-CD.
 12831
 12832     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 12833         NEXT SENTENCE
 12834     ELSE
 12835         GO TO 3300-CHECK-AH-RATES.
 12836
 12837*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 12838
 12839     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12840        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 12841              OR
 12842           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 12843           MOVE ER-2618          TO WS-ERROR
 12844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12845           GO TO 3300-CHECK-AH-RATES.
 12846
 12847     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 12848           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 12849                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 12850
 12851     IF WS-LF-SPECIAL-CALC-CD = 'M'
 12852         MOVE ER-2687             TO WS-ERROR
 12853         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12854         MOVE 'Z000'              TO PB-I-MORT-CODE
 12855         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 12856         GO TO 3300-CHECK-AH-RATES.
 12857
 12858     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 12859        IF PB-I-LIVES = ZERO
 12860           MOVE ER-2688          TO WS-ERROR
 12861           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12862
 12863     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 12864
 12865     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 12866     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 12867     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 12868     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 12869     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 12870     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 12871     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12872     MOVE '3'                    TO CP-PROCESS-TYPE.
 12873     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 12874     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 12875
 12876******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 12877     IF PB-COMPANY-ID EQUAL 'CDL'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 235
* EL050.cbl
 12878         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12879            CP-EARN-AS-NET-PAY)
 12880             IF PB-CERT-EFF-DT GREATER  WS-931231
 12881                 MOVE '1'        TO CP-EARNING-METHOD.
 12882*******
 12883
 12884     MOVE PB-SV-STATE            TO CP-STATE.
 12885     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 12886     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 12887     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 12888     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 12889     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 12890                                    CP-RATING-BENEFIT-AMT.
 12891     IF CP-STATE-STD-ABBRV = 'OR'
 12892         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 12893                                         PB-I-LF-ALT-BENEFIT-AMT.
 12894     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 12895     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 12896     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 12897     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12898     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 12899     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 12900     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 12901     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 12902     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 12903                                    CP-REMAINING-TERM
 12904                                    CP-LOAN-TERM.
 12905
 12906     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 12907         NEXT SENTENCE
 12908     ELSE
 12909         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 12910             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12911                                           PB-I-LF-PREMIUM-AMT.
 12912
 12913     IF PB-COMPANY-ID EQUAL 'CSL'
 12914        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 12915           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12916                                         PB-I-LF-PREMIUM-AMT.
 12917
 12918     IF PB-COMPANY-ID EQUAL 'NCB'
 12919         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 12920            CP-EARN-AS-NET-PAY
 12921             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 12922                 PB-I-LF-PREMIUM-AMT.
 12923
 12924     IF CP-TRUNCATED-LIFE
 12925        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 12926
 12927     IF PB-COMPANY-ID EQUAL 'CRI'
 12928        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 12929
 12930     IF CP-TERM-IS-DAYS
 12931         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 12932     ELSE
 12933         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12934     IF PB-COMPANY-ID = 'DCC'
 12935        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 236
* EL050.cbl
 12936        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 12937        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 12938        IF WS-LF-BEN-CATEGORY = 'D'
 12939           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 12940           MOVE PB-I-LIFE-COMMISSION
 12941                                 TO CP-DCC-ACT-COMM
 12942           MOVE WS-LF-BEN-CATEGORY
 12943                                 TO CP-BEN-CATEGORY
 12944        END-IF
 12945        IF (CP-BENEFIT-CD (1:1) = 'P')
 12946           AND (PB-I-LOAN-TERM NOT = ZEROS)
 12947           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 12948        END-IF
 12949     END-IF
 12950     IF PB-COMPANY-ID = 'CSL'
 12951         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 12952         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 12953         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 12954
 12955     IF PB-COMPANY-ID = 'CSL'
 12956        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 12957
 12958     IF (CP-SPECIAL-CALC-CD = 'H')
 12959        OR (PB-COMPANY-ID = 'DCC')
 12960         MOVE PB-I-LF-ALT-BENEFIT-AMT
 12961                                    TO CP-ALTERNATE-BENEFIT
 12962         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 12963
 12964     IF (PB-COMPANY-ID = 'CID')
 12965        AND (WS-LF-EARNINGS-CALC = 'B')
 12966        AND (CP-STATE-STD-ABBRV = 'MN')
 12967        MOVE PB-I-LF-ALT-BENEFIT-AMT
 12968                                 TO CP-ALTERNATE-BENEFIT
 12969        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 12970     END-IF
 12971     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 12972     MOVE 'R'                   TO CP-RATE-FILE.
 12973     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 12974
 12975     IF CP-ERROR-RATE-NOT-FOUND
 12976        MOVE ER-2641            TO WS-ERROR
 12977        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12978        GO TO 3300-CHECK-AH-RATES.
 12979
 12980     IF PB-COMPANY-ID EQUAL 'CRI'
 12981        IF CP-ERROR-NO-LIMITS-CRI
 12982           IF NOT ACCOUNT-LIFE-CHECKED
 12983              MOVE ER-2607      TO WS-ERROR
 12984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12985
 12986******************************************************************
 12987*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 12988*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 12989******************************************************************
 12990
 12991* CALC LIFE AGE AT EXPIRATION.
 12992
 12993     COMPUTE WS-AGE-AT-EXPIRE =
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 237
* EL050.cbl
 12994          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 12995
 12996*    IF PB-STATE = 'CO' OR 'UT'
 12997*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 12998*        MOVE 'F'            TO PB-FATAL-FLAG
 12999*        MOVE ER-2709        TO WS-ERROR
 13000*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13001*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13002
 13003*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13004*        MOVE 'X'            TO PB-FATAL-FLAG
 13005*        MOVE ER-2718        TO WS-ERROR
 13006*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13007*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13008
 13009* CALC A & H AGE AT EXPIRATION.
 13010
 13011     COMPUTE WS-AGE-AT-EXPIRE =
 13012          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13013
 13014*    IF PB-STATE = 'CO' OR 'UT'
 13015*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13016*        MOVE 'F'            TO PB-FATAL-FLAG
 13017*        MOVE ER-2709        TO WS-ERROR
 13018*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13019*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13020
 13021*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13022*        MOVE 'X'            TO PB-FATAL-FLAG
 13023*        MOVE ER-2718        TO WS-ERROR
 13024*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13025*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13026
 13027     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13028        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13029
 13030     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13031        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13032
 13033     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13034        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13035
 13036     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13037         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13038         MOVE ER-2639        TO WS-ERROR
 13039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13040
 13041
 13042******************************************************************
 13043*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13044******************************************************************
 13045
 13046 PREMIUM-EDITING-IS-BYPASSED.
 13047     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13048        AND (CP-R-MAX-ATT-AGE > +0)
 13049        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13050        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13051           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 238
* EL050.cbl
 13052           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13053           MOVE '1'              TO DC-OPTION-CODE
 13054           PERFORM 8500-DATE-CONVERT
 13055                                 THRU 8500-EXIT
 13056           IF NO-CONVERSION-ERROR
 13057              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13058                 MOVE ER-2661       TO WS-ERROR
 13059*                PERFORM 9900-ERROR-FORMAT
 13060*                                THRU 9900-EXIT
 13061              END-IF
 13062           END-IF
 13063        ELSE
 13064           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13065           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13066              MOVE ER-2661       TO WS-ERROR
 13067*             PERFORM 9900-ERROR-FORMAT
 13068*                                THRU 9900-EXIT
 13069           ELSE
 13070              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13071                 MOVE ER-1570    TO WS-ERROR
 13072                 PERFORM 9900-ERROR-FORMAT
 13073                                 THRU 9900-EXIT
 13074              END-IF
 13075           END-IF
 13076        END-IF
 13077        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13078           MOVE PB-I-JOINT-BIRTHDAY
 13079                                 TO DC-BIN-DATE-1
 13080           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13081           MOVE '1'              TO DC-OPTION-CODE
 13082           PERFORM 8500-DATE-CONVERT
 13083                                 THRU 8500-EXIT
 13084           IF NO-CONVERSION-ERROR
 13085              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13086                 MOVE ER-2661       TO WS-ERROR
 13087*                PERFORM 9900-ERROR-FORMAT
 13088*                                THRU 9900-EXIT
 13089              END-IF
 13090           ELSE
 13091              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13092           END-IF
 13093        ELSE
 13094           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13095             (PB-I-LF-TERM / 12)
 13096           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13097              MOVE ER-2661       TO WS-ERROR
 13098*             PERFORM 9900-ERROR-FORMAT
 13099*                                THRU 9900-EXIT
 13100           ELSE
 13101              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13102                 MOVE ER-1571    TO WS-ERROR
 13103                 PERFORM 9900-ERROR-FORMAT
 13104                                 THRU 9900-EXIT
 13105              END-IF
 13106           END-IF
 13107        END-IF
 13108        IF WS-ERROR = ER-2661
 13109           PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 239
* EL050.cbl
 13110                                 THRU 9900-EXIT
 13111        END-IF
 13112     END-IF
 13113*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13114*       MOVE ER-2661             TO WS-ERROR
 13115*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13116
 13117     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13118        MOVE ER-2662             TO WS-ERROR
 13119        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13120
 13121     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13122        MOVE ER-2677             TO WS-ERROR
 13123        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13124
 13125     IF CP-ERROR-LOAN-TERM
 13126        MOVE ER-2648             TO WS-ERROR
 13127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13128
 13129 3221-CHECK-ERROR-RATE-OPEN.
 13130
 13131     IF CP-ERROR-RATE-FILE-NOTOPEN
 13132         GO TO 3990-FILES-NOT-OPEN.
 13133
 13134     IF PB-COMPANY-ID NOT = 'DMD'
 13135        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13136     END-IF
 13137     .
 13138 3221-CONTINUE.
 13139     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13140                                    WS-DCC-AH-RATE
 13141     IF PB-COMPANY-ID = 'DCC'
 13142        IF WS-LF-BEN-CATEGORY = 'D'
 13143           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13144              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13145        END-IF
 13146     END-IF
 13147     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13148*   X'A4FF' = 12/31/2009
 13149     IF (PB-COMPANY-ID = 'CID')
 13150        AND (WS-LF-EARNINGS-CALC = 'B')
 13151        AND (CP-STATE-STD-ABBRV = 'MN')
 13152        AND (PB-CERT-EFF-DT > X'A4FF')
 13153        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13154     END-IF
 13155     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13156
 13157     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13158     IF (PB-COMPANY-ID = 'DCC')
 13159        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13160        AND (PB-I-POLICY-IS-MONTHLY)
 13161        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13162        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13163     END-IF
 13164     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13165     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13166     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13167     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 240
* EL050.cbl
 13168     IF (PB-COMPANY-ID = 'DCC')
 13169        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13170        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13171        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13172        MOVE ER-2786             TO WS-ERROR
 13173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13174     END-IF
 13175
 13176     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13177
 13178******************************************************************
 13179*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13180******************************************************************
 13181     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13182        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13183
 13184     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13185        GO TO 3225-CHECK-ALT-LIFE-RATE
 13186     ELSE
 13187       IF PB-I-LF-RATE = ZERO
 13188          MOVE ER-2641          TO WS-ERROR
 13189          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13190
 13191 3225-CHECK-ALT-LIFE-RATE.
 13192
 13193     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13194        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13195        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13196         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13197
 13198     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13199         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13200             AND PB-COMPANY-ID NOT = 'DCC')
 13201                   OR
 13202              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13203              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13204              AND PB-COMPANY-ID NOT = 'DCC')
 13205             MOVE ER-2720        TO  WS-ERROR
 13206             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13207             GO TO 3225-RATING-CONT
 13208         ELSE
 13209             GO TO 3225-RATING-CONT.
 13210     IF (PB-COMPANY-ID = 'CID')
 13211        AND (AM-GPCD = 01 OR 06 OR 15)
 13212        MOVE ER-2798             TO WS-ERROR
 13213        PERFORM 9900-ERROR-FORMAT
 13214                                 THRU 9900-EXIT
 13215*       GO TO 3225-RATING-CONT
 13216     END-IF
 13217     IF (PB-COMPANY-ID = 'CID')
 13218        AND (WS-LF-EARNINGS-CALC = 'B')
 13219        AND (CP-STATE-STD-ABBRV = 'MN')
 13220        AND (PB-CERT-EFF-DT > X'A4FF')
 13221        GO TO 3225-RATING-CONT
 13222     END-IF
 13223     IF PB-COMPANY-ID = 'DCC'
 13224        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13225           AND (PB-I-POLICY-IS-MONTHLY)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 241
* EL050.cbl
 13226           GO TO 3225-RATING-CONT
 13227        END-IF
 13228     END-IF
 13229
 13230     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13231        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13232        CP-EARN-AS-REG-BALLOON
 13233        NEXT SENTENCE
 13234     ELSE
 13235        MOVE '2'                 TO CP-EARNING-METHOD.
 13236
 13237 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13238
 13239     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13240
 13241     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13242        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13243        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13244         NEXT SENTENCE
 13245     ELSE
 13246         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13247
 13248     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13249     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13250     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13251                                     CP-RATING-BENEFIT-AMT.
 13252     IF CP-STATE-STD-ABBRV = 'OR'
 13253         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13254                                         PB-I-LF-ALT-BENEFIT-AMT.
 13255     IF PB-COMPANY-ID = 'DCC'
 13256        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13257     END-IF
 13258     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13259     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13260     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13261                                    CP-REMAINING-TERM
 13262                                    CP-LOAN-TERM.
 13263     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13264        ADD +1                   TO CP-ORIGINAL-TERM
 13265                                    CP-REMAINING-TERM
 13266                                    CP-LOAN-TERM.
 13267
 13268     MOVE 'R'                   TO CP-RATE-FILE.
 13269     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13270
 13271     IF CP-ERROR-RATE-NOT-FOUND
 13272         MOVE ER-2641            TO WS-ERROR
 13273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13274         GO TO 3300-CHECK-AH-RATES.
 13275
 13276     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13277     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13278
 13279     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13280         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13281
 13282     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13283                               + PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 242
* EL050.cbl
 13284
 13285     IF ACCOUNT-LIFE-CHECKED  OR
 13286        PB-POLICY-IS-VOIDED   OR
 13287        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13288        GO TO 3225-CONTINUE.
 13289
 13290     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13291        GO TO 3225-CONTINUE.
 13292
 13293     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13294                             EC-RT-LF-MAX-TOT-BEN
 13295        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13296        MOVE ER-2639       TO WS-ERROR
 13297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13298
 13299 3225-CONTINUE.
 13300     IF PB-I-LF-ALT-RATE = ZERO
 13301         MOVE ER-2659            TO WS-ERROR
 13302         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13303
 13304     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13305        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13306        MOVE ER-2698             TO WS-ERROR
 13307        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13308
 13309 3225-RATING-CONT.
 13310
 13311     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13312         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13313         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13314         MOVE ER-2687             TO WS-ERROR
 13315         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13316         GO TO 3290-EDIT-LF-REIN-RATE.
 13317
 13318* DMD RATING TEST
 13319     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13320         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13321         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13322         MOVE ER-2687                 TO WS-ERROR
 13323         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13324         GO TO 3290-EDIT-LF-REIN-RATE.
 13325
 13326 3230-CLIENT-MORT-CD-SPECIALS.
 13327
 13328     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13329     SET BIN-TO-GREG          TO TRUE.
 13330*    MOVE ' '                 TO DC-OPTION-CODE.
 13331     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13332     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13333
 13334 C-POS-3230-MORT-CD.
 13335     IF PB-COMPANY-ID = 'POS' AND
 13336        PB-SV-CARRIER = '2'
 13337         NEXT SENTENCE
 13338     ELSE
 13339         GO TO C-POS-3240-MORT-CD.
 13340
 13341     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 243
* EL050.cbl
 13342        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13343         MOVE '2350' TO PB-I-MORT-CODE
 13344      ELSE
 13345         MOVE '3300' TO PB-I-MORT-CODE.
 13346
 13347
 13348 C-POS-3240-MORT-CD.
 13349     IF PB-COMPANY-ID = 'POS' AND
 13350        PB-SV-CARRIER = '1'
 13351         NEXT SENTENCE
 13352     ELSE
 13353         GO TO 3230-CONTINUE.
 13354
 13355     IF PB-SV-STATE = '45' OR '47'
 13356        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13357         MOVE '5200' TO PB-I-MORT-CODE
 13358     ELSE
 13359         MOVE '8300' TO PB-I-MORT-CODE.
 13360
 13361 3230-CONTINUE.
 13362
 13363     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13364        GO TO 3240-CONTINUE
 13365     END-IF
 13366
 13367     IF PB-CERT-EFF-DT > WS-971231
 13368        GO TO 3240-CONTINUE
 13369     END-IF
 13370
 13371     IF LF-BENEFIT-FOUND AND
 13372        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13373         MOVE 'F250'       TO PB-I-MORT-CODE
 13374     ELSE
 13375         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13376             MOVE '7250'   TO PB-I-MORT-CODE
 13377         ELSE
 13378             MOVE '4251'   TO PB-I-MORT-CODE
 13379         END-IF
 13380     END-IF
 13381
 13382     .
 13383 3240-CONTINUE.
 13384
 13385     IF PB-COMPANY-ID NOT = 'GNL'
 13386         GO TO 3256-CONTINUE.
 13387
 13388     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13389         MOVE 'A300' TO PB-I-MORT-CODE
 13390     ELSE
 13391         MOVE '8350' TO PB-I-MORT-CODE.
 13392
 13393 3256-CONTINUE.
 13394     IF PB-COMPANY-ID NOT = 'ABL'
 13395         GO TO 3260-EDIT-CONTINUE.
 13396
 13397     IF PB-I-LF-TERM GREATER THAN 59
 13398         MOVE 'F550' TO PB-I-MORT-CODE
 13399     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 244
* EL050.cbl
 13400         MOVE 'E550' TO PB-I-MORT-CODE.
 13401
 13402 3260-EDIT-CONTINUE.
 13403     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13404
 13405 3290-EDIT-LF-REIN-RATE.
 13406     IF LF-REIN-NSP-NOT-USED
 13407         GO TO 3290-RATING-CONT.
 13408
 13409     IF PB-COMPANY-ID = 'DCC'
 13410        GO TO 3290-RATING-CONT.
 13411     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13412     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13413     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13414     MOVE '3'                   TO CP-PROCESS-TYPE.
 13415     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13416
 13417******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13418     IF PB-COMPANY-ID EQUAL 'CDL'
 13419         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13420            CP-EARN-AS-NET-PAY)
 13421             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13422*            MOVE SPACE          TO DC-OPTION-CODE
 13423             SET BIN-TO-GREG     TO TRUE
 13424             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13425***  Y2K PROJ 7744
 13426             IF DC-GREG-DATE-CYMD GREATER 19931231
 13427                 MOVE '1'        TO CP-EARNING-METHOD.
 13428***  Y2K PROJ 7744
 13429*******
 13430
 13431     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13432     MOVE PB-SV-STATE           TO CP-STATE.
 13433     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13434     MOVE ZERO                  TO CP-DEVIATION-CODE
 13435                                   CP-RATE-DEV-PCT.
 13436     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13437     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13438                                   CP-RATING-BENEFIT-AMT.
 13439
 13440************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13441     IF PB-COMPANY-ID EQUAL 'NCB'
 13442         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13443            CP-EARN-AS-NET-PAY
 13444             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13445                 PB-I-LF-PREMIUM-AMT.
 13446************
 13447
 13448     IF CP-STATE-STD-ABBRV = 'OR'
 13449         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13450                                         PB-I-LF-ALT-BENEFIT-AMT.
 13451     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13452     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13453     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13454     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13455     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13456     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13457     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 245
* EL050.cbl
 13458     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13459                                   CP-REMAINING-TERM
 13460                                   CP-LOAN-TERM.
 13461     IF CP-TRUNCATED-LIFE
 13462        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13463
 13464     IF CP-TERM-IS-DAYS
 13465         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13466     ELSE
 13467         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13468
 13469     IF PB-COMPANY-ID = 'DCC'
 13470        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13471     END-IF
 13472     IF PB-COMPANY-ID NOT = 'TIC'
 13473          MOVE ZERO          TO CP-CLASS-CODE.
 13474
 13475     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13476
 13477     MOVE 'R'                   TO CP-RATE-FILE.
 13478     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13479
 13480     IF CP-ERROR-RATE-NOT-FOUND
 13481        IF PB-I-OB
 13482           MOVE ER-2625      TO WS-ERROR
 13483           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13484           GO TO 3299-EDIT-CONTINUE
 13485        ELSE
 13486           MOVE ER-2643      TO WS-ERROR
 13487           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13488           GO TO 3299-EDIT-CONTINUE.
 13489
 13490     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13491
 13492     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13493     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13494
 13495     IF PB-I-LF-REI-RATE = ZERO
 13496         MOVE ER-2643        TO WS-ERROR
 13497         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13498
 13499 3290-CHECK-ALT-REIN-RATE.
 13500
 13501     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13502        GO TO 3290-RATING-CONT.
 13503
 13504     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13505     MOVE '2'                    TO CP-EARNING-METHOD.
 13506     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13507     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13508     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13509     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13510                                     CP-RATING-BENEFIT-AMT.
 13511     IF CP-STATE-STD-ABBRV = 'OR'
 13512         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13513                                         PB-I-LF-ALT-BENEFIT-AMT.
 13514     IF PB-COMPANY-ID = 'DCC'
 13515        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 246
* EL050.cbl
 13516     END-IF
 13517     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13518     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13519     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13520                                    CP-REMAINING-TERM
 13521                                    CP-LOAN-TERM.
 13522     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13523        ADD +1                   TO CP-ORIGINAL-TERM
 13524                                    CP-REMAINING-TERM
 13525                                    CP-LOAN-TERM.
 13526
 13527     MOVE 'R'                   TO CP-RATE-FILE.
 13528     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13529
 13530     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13531
 13532     IF PB-I-LF-ALT-REI-RATE = ZERO
 13533         MOVE ER-2643            TO WS-ERROR
 13534         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13535
 13536 3290-RATING-CONT.
 13537
 13538     IF PB-I-OB
 13539*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13540        GO TO 3300-CHECK-AH-RATES.
 13541
 13542 3299-EDIT-CONTINUE.
 13543
 13544     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13545         NEXT SENTENCE
 13546     ELSE
 13547         MOVE ER-2620           TO WS-ERROR
 13548         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13549
 13550 3300-CHECK-AH-RATES.
 13551     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13552         NEXT SENTENCE
 13553     ELSE
 13554         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13555
 13556     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13557        ((CF-COMPANY-ID = 'DMD') AND
 13558                (NO-DMD-RATING))
 13559         MOVE ER-2687             TO WS-ERROR
 13560         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13561         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13562         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13563
 13564     IF PB-I-OB
 13565        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13566
 13567     IF WS-AH-SPECIAL-CALC-CD = 'M'
 13568         MOVE ER-2687             TO WS-ERROR
 13569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13570         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13571         GO TO 3999-END-EDIT.
 13572
 13573*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 247
* EL050.cbl
 13574
 13575     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13576        IF PB-I-AH-CRIT-PER = ZERO
 13577           IF PB-COMPANY-ID = 'DCC'
 13578              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13579              CONTINUE
 13580           ELSE
 13581              MOVE ER-2618       TO WS-ERROR
 13582              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13583              GO TO 3999-END-EDIT
 13584           END-IF
 13585        END-IF
 13586     END-IF
 13587     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13588     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13589     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13590     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13591     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13592     MOVE PB-SV-STATE            TO CP-STATE.
 13593     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13594     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13595     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13596*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13597     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13598     MOVE '3'                    TO CP-PROCESS-TYPE.
 13599     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13600     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13601                                    CP-RATING-BENEFIT-AMT.
 13602     IF PB-COMPANY-ID = 'CID'
 13603               OR
 13604        CP-STATE-STD-ABBRV = 'OR'
 13605         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13606                                         PB-I-AH-TERM.
 13607     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13608        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13609           AND (PB-I-POLICY-IS-MONTHLY)
 13610           MOVE PB-I-LF-BENEFIT-AMT
 13611                                 TO CP-NET-BENEFIT-AMT
 13612           move pb-i-ah-premium-amt to cp-original-premium
 13613        END-IF
 13614     END-IF
 13615     MOVE SPACES                 TO CP-BEN-CATEGORY
 13616     IF PB-COMPANY-ID = 'DCC'
 13617        IF WS-AH-BEN-CATEGORY = 'G'
 13618           MOVE WS-AH-BEN-CATEGORY
 13619                                 TO CP-BEN-CATEGORY
 13620           MOVE PB-I-UNPAID-CASH-PRICE
 13621                                 TO CP-RATING-BENEFIT-AMT
 13622        ELSE
 13623           IF WS-AH-BEN-CATEGORY = 'L'
 13624              MOVE WS-AH-BEN-CATEGORY
 13625                                 TO CP-BEN-CATEGORY
 13626           ELSE
 13627              IF WS-AH-BEN-CATEGORY = 'D'
 13628                 MOVE WS-AH-BEN-CATEGORY
 13629                                 TO CP-BEN-CATEGORY
 13630                 MOVE WS-AH-PMF-COMM
 13631                                 TO CP-DCC-PMF-COMM
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 248
* EL050.cbl
 13632                 MOVE PB-I-AH-COMMISSION
 13633                                 TO CP-DCC-ACT-COMM
 13634              END-IF
 13635           END-IF
 13636        END-IF
 13637     END-IF
 13638     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 13639     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13640     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13641     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13642     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13643     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 13644     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 13645                                    CP-REMAINING-TERM
 13646                                    WS-WORK-TERM.
 13647     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 13648
 13649     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13650     SET BIN-TO-GREG             TO TRUE.
 13651*    MOVE ' '                    TO DC-OPTION-CODE.
 13652     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13653     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 13654
 13655     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 13656     IF NOT VALID-SKIP-CODE
 13657         MOVE ER-2683            TO WS-ERROR
 13658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13659         GO TO 3320-RATE-CONTINUE.
 13660
 13661     IF PB-NO-MONTHS-SKIPPED
 13662         GO TO 3320-RATE-CONTINUE.
 13663
 13664     MOVE SPACE TO NUMBER-OF-MONTHS.
 13665
 13666     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 13667         MOVE 'S'                TO SK-MO (6).
 13668     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 13669         MOVE 'S'                TO SK-MO (7).
 13670     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 13671         MOVE 'S'                TO SK-MO (8).
 13672     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 13673         MOVE 'S'                TO SK-MO (9).
 13674     IF PB-I-SKIP-CODE = 'A'
 13675         MOVE 'S'                TO SK-MO (10).
 13676
 13677     MOVE 1                      TO SUB2.
 13678     MOVE PB-I-AH-TERM           TO SUB3.
 13679     MOVE WS-MONTH               TO SUB1.
 13680     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 13681     GO TO 3320-RATE-CONTINUE.
 13682
 13683 3310-GET-SKIP-MO.
 13684     IF SUB1 = 13
 13685         MOVE 1                  TO SUB1.
 13686
 13687     IF SK-MO (SUB1) = 'S'
 13688         SUBTRACT 1 FROM WS-WORK-TERM.
 13689
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 249
* EL050.cbl
 13690     ADD 1 TO SUB2
 13691              SUB1.
 13692
 13693 3320-RATE-CONTINUE.
 13694
 13695     IF WS-WORK-TERM = ZERO
 13696         MOVE 1                  TO WS-WORK-TERM.
 13697
 13698     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 13699                                    CP-LOAN-TERM.
 13700
 13701     IF PB-COMPANY-ID EQUAL 'DMD'
 13702         NEXT SENTENCE
 13703     ELSE
 13704         MOVE ZERO               TO PB-I-AH-RATE
 13705                                    PB-I-AH-REI-RATE.
 13706
 13707
 13708     IF PB-COMPANY-ID EQUAL 'CRI'
 13709        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13710
 13711     IF PB-COMPANY-ID = 'CSL'
 13712         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 13713         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 13714         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13715         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13716
 13717     IF PB-COMPANY-ID = 'DCC'
 13718        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 13719           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 13720              PB-I-RATE-DEV-PCT-LF
 13721        END-IF
 13722        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13723                                 TO CP-ALTERNATE-BENEFIT
 13724        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13725        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13726        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13727     END-IF
 13728     IF (PB-COMPANY-ID = 'CID')
 13729        AND (WS-LF-EARNINGS-CALC = 'B')
 13730        AND (CP-STATE-STD-ABBRV = 'MN')
 13731        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 13732     ELSE
 13733        MOVE ' '                 TO CP-AH-BALLOON-SW
 13734     END-IF
 13735     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 13736     MOVE 'R'                   TO CP-RATE-FILE.
 13737     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13738
 13739     IF CP-ERROR-RATE-NOT-FOUND
 13740        IF PB-I-OB
 13741           MOVE ER-2624          TO WS-ERROR
 13742           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13743           GO TO 3340-CALCULATE-PREMIUM-AMT
 13744        ELSE
 13745           MOVE ER-2642          TO WS-ERROR
 13746           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13747           GO TO 3340-CALCULATE-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 250
* EL050.cbl
 13748
 13749     IF PB-COMPANY-ID EQUAL 'CSL' AND
 13750        CP-ERROR-DIV-BY-ZERO
 13751           MOVE ER-3782          TO WS-ERROR
 13752           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13753
 13754     IF PB-COMPANY-ID EQUAL 'CRI'
 13755        IF CP-ERROR-NO-LIMITS-CRI
 13756           IF NOT ACCOUNT-AH-CHECKED
 13757              MOVE ER-2607          TO WS-ERROR
 13758              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13759
 13760     IF ACCOUNT-AH-CHECKED
 13761        NEXT SENTENCE
 13762     ELSE
 13763       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13764          MOVE ER-2640           TO WS-ERROR
 13765          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13766
 13767     IF PB-COMPANY-ID = 'CRI'
 13768         IF WS-ERROR = ER-2640
 13769             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13770     IF ACCOUNT-AH-CHECKED
 13771        CONTINUE
 13772     ELSE
 13773        IF (CP-R-MAX-ATT-AGE NUMERIC)
 13774           AND (CP-R-MAX-ATT-AGE > +0)
 13775           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 13776           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 13777              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 13778              MOVE PB-I-AH-EXPIRE-DT
 13779                                 TO DC-BIN-DATE-2
 13780              MOVE '1'           TO DC-OPTION-CODE
 13781              PERFORM 8500-DATE-CONVERT
 13782                                 THRU 8500-EXIT
 13783              IF NO-CONVERSION-ERROR
 13784                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13785                    MOVE ER-2661       TO WS-ERROR
 13786*                   PERFORM 9900-ERROR-FORMAT
 13787*                                THRU 9900-EXIT
 13788                 END-IF
 13789              END-IF
 13790           ELSE
 13791              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 13792              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13793                 MOVE ER-2661    TO WS-ERROR
 13794*                PERFORM 9900-ERROR-FORMAT
 13795*                                THRU 9900-EXIT
 13796              ELSE
 13797                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13798                    MOVE ER-1570 TO WS-ERROR
 13799                    PERFORM 9900-ERROR-FORMAT
 13800                                 THRU 9900-EXIT
 13801                 END-IF
 13802              END-IF
 13803           END-IF
 13804           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13805              MOVE PB-I-JOINT-BIRTHDAY
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 251
* EL050.cbl
 13806                                    TO DC-BIN-DATE-1
 13807              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 13808              MOVE '1'              TO DC-OPTION-CODE
 13809              PERFORM 8500-DATE-CONVERT
 13810                                    THRU 8500-EXIT
 13811              IF NO-CONVERSION-ERROR
 13812                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13813                    MOVE ER-2661       TO WS-ERROR
 13814*                   PERFORM 9900-ERROR-FORMAT
 13815*                                   THRU 9900-EXIT
 13816                 END-IF
 13817              END-IF
 13818           ELSE
 13819              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13820                (PB-I-AH-TERM / 12)
 13821              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13822                 MOVE ER-2661       TO WS-ERROR
 13823*                PERFORM 9900-ERROR-FORMAT
 13824*                                   THRU 9900-EXIT
 13825              ELSE
 13826                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13827                    MOVE ER-1571 TO WS-ERROR
 13828                    PERFORM 9900-ERROR-FORMAT
 13829                                 THRU 9900-EXIT
 13830                 END-IF
 13831              END-IF
 13832           END-IF
 13833           IF WS-ERROR = ER-2661
 13834              PERFORM 9900-ERROR-FORMAT
 13835                                    THRU 9900-EXIT
 13836           END-IF
 13837        END-IF
 13838     END-IF
 13839*    IF ACCOUNT-AH-CHECKED
 13840*       NEXT SENTENCE
 13841*    ELSE
 13842*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13843*          MOVE ER-2661          TO WS-ERROR
 13844*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13845
 13846     IF ACCOUNT-AH-CHECKED
 13847        NEXT SENTENCE
 13848     ELSE
 13849        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13850           MOVE ER-2663          TO WS-ERROR
 13851           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13852
 13853     IF ACCOUNT-AH-CHECKED OR
 13854        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 13855         PB-POLICY-IS-VOIDED
 13856        NEXT SENTENCE
 13857     ELSE
 13858        IF CP-ERROR-TOT-OUTSIDE-LIMIT
 13859           MOVE ER-2667            TO WS-ERROR
 13860           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13861
 13862     IF PB-COMPANY-ID = 'CRI'
 13863         IF WS-ERROR = ER-2667
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 252
* EL050.cbl
 13864             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 13865
 13866     IF ACCOUNT-AH-CHECKED
 13867        NEXT SENTENCE
 13868     ELSE
 13869        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13870           MOVE ER-2678            TO WS-ERROR
 13871           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13872
 13873     IF CP-ERROR-RATE-FILE-NOTOPEN
 13874         GO TO 3990-FILES-NOT-OPEN.
 13875
 13876 3321-CONTINUE.
 13877     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 13878     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 13879     IF (PB-COMPANY-ID = 'DCC')
 13880        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 13881        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 13882                                    PB-I-LF-ALT-PREM-CALC
 13883        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13884        IF WS-AH-BEN-CATEGORY = 'G'
 13885           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13886           + PB-I-ADDL-CLP)
 13887           * (1 + WS-TOL-CLP-PCT)
 13888*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 13889        ELSE
 13890           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 13891           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 13892*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 13893        END-IF
 13894        MOVE WS-TOL-LF-HIGH-PREM-AMT
 13895                                 TO PB-I-AH-PREM-CALC
 13896        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 13897           MOVE ER-8148          TO WS-ERROR
 13898           PERFORM 9900-ERROR-FORMAT
 13899                                 THRU 9900-EXIT
 13900        ELSE
 13901           IF PB-I-AH-PREMIUM-AMT < PB-I-CLP-AMOUNT
 13902              MOVE ER-8148       TO WS-ERROR
 13903              PERFORM 9900-ERROR-FORMAT
 13904                                 THRU 9900-EXIT
 13905           END-IF
 13906        END-IF
 13907     END-IF
 13908     IF (PB-COMPANY-ID = 'DCC')
 13909        AND (PB-I-POLICY-IS-MONTHLY)
 13910        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 13911        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 13912        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 13913           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 13914        END-IF
 13915     END-IF
 13916     IF (PB-COMPANY-ID = 'DCC')
 13917        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 13918        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13919        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 13920        MOVE ER-2786             TO WS-ERROR
 13921        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 253
* EL050.cbl
 13922     END-IF
 13923     MOVE +0                     TO PB-I-AH-CLP
 13924     IF PB-COMPANY-ID = 'DCC'
 13925        IF WS-AH-BEN-CATEGORY = 'D'
 13926           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 13927              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13928        ELSE
 13929           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 13930              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 13931           END-IF
 13932        END-IF
 13933     END-IF
 13934     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 13935
 13936     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 13937         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 13938
 13939     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 13940         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 13941
 13942     IF PB-COMPANY-ID = 'CRI'
 13943         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 13944            PB-I-PAYMENT-AMOUNT = ZERO
 13945             NEXT SENTENCE
 13946         ELSE
 13947             COMPUTE PB-I-AH-PREM-CALC =
 13948                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 13949                 (CP-PREMIUM-RATE / 100)
 13950             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 13951                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 13952                                             PB-I-RATE-DEV-PCT-AH.
 13953
 13954     IF PB-I-AH-RATE  = ZERO
 13955         MOVE ER-2642            TO WS-ERROR
 13956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13957
 13958     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 13959     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 13960     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 13961     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 13962     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 13963     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 13964
 13965     IF (PB-COMPANY-ID = 'DCC')
 13966        AND (WS-AH-BEN-CATEGORY = 'G')
 13967        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13968        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 13969        IF CP-DEVIATION-CODE NOT = '000'
 13970           MOVE '000'            TO CP-DEVIATION-CODE
 13971           PERFORM 7000-GET-RATE THRU 7000-EXIT
 13972           IF NO-CP-ERROR
 13973              COMPUTE PB-I-DDF-IU-RATE-UP =
 13974              PB-I-AH-CLP - CP-CALC-PREMIUM
 13975           ELSE
 13976              MOVE ER-3057        TO WS-ERROR
 13977              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13978           END-IF
 13979        END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 254
* EL050.cbl
 13980     END-IF
 13981     .
 13982 3335-EDIT-AH-REIN-NSP-RATE.
 13983     IF AH-REIN-NSP-NOT-USED
 13984         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13985
 13986     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 13987     IF PB-COMPANY-ID = 'DCC'
 13988         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13989     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13990     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13991     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13992     MOVE PB-SV-STATE            TO CP-STATE.
 13993     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13994     MOVE ZERO                   TO CP-DEVIATION-CODE
 13995                                    CP-RATE-DEV-PCT.
 13996*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13997     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13998     MOVE '3'                    TO CP-PROCESS-TYPE.
 13999     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14000     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14001                                    CP-RATING-BENEFIT-AMT.
 14002     IF CP-STATE-STD-ABBRV = 'OR'
 14003         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14004                                         PB-I-AH-TERM.
 14005     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14006     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14007     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14008     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14009     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14010     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14011                                    CP-REMAINING-TERM
 14012                                    WS-WORK-TERM.
 14013     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14014     IF PB-COMPANY-ID = 'DCC'
 14015        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14016     END-IF
 14017     IF  PB-COMPANY-ID = 'TIC'
 14018         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14019            MOVE ZERO TO CP-CLASS-CODE.
 14020
 14021     IF PB-COMPANY-ID NOT = 'TIC'
 14022          MOVE ZERO          TO CP-CLASS-CODE.
 14023
 14024     MOVE ZERO               TO CP-DEVIATION-CODE.
 14025
 14026     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14027
 14028     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14029
 14030     MOVE 'R'                   TO CP-RATE-FILE.
 14031     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14032
 14033     IF CP-ERROR-RATE-NOT-FOUND
 14034         MOVE ER-2645        TO WS-ERROR
 14035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14036         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14037
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 255
* EL050.cbl
 14038     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14039
 14040     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14041     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14042
 14043     IF PB-I-AH-REI-RATE = ZERO
 14044         MOVE ER-2645        TO WS-ERROR
 14045         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14046
 14047
 14048 3340-CALCULATE-PREMIUM-AMT.
 14049
 14050     IF PB-COMPANY-ID = 'NCL'
 14051         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14052             WS-AH-SPECIAL-CALC-CD = 'O')
 14053             GO TO 3999-END-EDIT.
 14054
 14055     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14056                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14057                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14058         NEXT SENTENCE
 14059     ELSE
 14060         IF WS-STATE-ABBREVIATION = 'CT'
 14061             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14062                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14063                 COMPUTE PB-I-LF-PREM-CALC =
 14064                                     PB-I-LF-PREM-CALC * .90
 14065                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14066                                     PB-I-LF-ALT-PREM-CALC * .90
 14067                 COMPUTE PB-I-AH-PREM-CALC =
 14068                                     PB-I-AH-PREM-CALC * .90.
 14069
 14070     IF PB-COMP-LF-PREM
 14071        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14072        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14073
 14074     IF PB-COMP-AH-PREM
 14075        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14076
 14077 3340-CHECK-DCC-TOT-FEES.
 14078     IF (PB-COMPANY-ID = 'DCC')
 14079        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14080        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14081        AND (PB-I-POLICY-IS-MONTHLY)
 14082        CONTINUE
 14083     ELSE
 14084        GO TO 3340-EDIT-LF-AH-TOL
 14085     END-IF
 14086     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14087     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14088     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14089        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14090           PB-I-RATE-DEV-PCT-LF
 14091     END-IF
 14092     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14093        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14094           PB-I-RATE-DEV-PCT-AH
 14095     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 256
* EL050.cbl
 14096     MOVE 'N'                    TO CP-BEN-CATEGORY
 14097     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14098
 14099     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14100     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14101     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14102     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14103     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14104     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14105     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14106     MOVE '3'                    TO CP-PROCESS-TYPE.
 14107     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14108     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14109
 14110     MOVE PB-SV-STATE            TO CP-STATE.
 14111     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14112     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14113     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14114     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14115     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14116                                    CP-RATING-BENEFIT-AMT.
 14117     IF CP-STATE-STD-ABBRV = 'OR'
 14118         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14119                                         PB-I-LF-ALT-BENEFIT-AMT.
 14120     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14121     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14122     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14123     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14124     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14125     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14126     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14127     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14128     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14129                                    CP-REMAINING-TERM
 14130                                    CP-LOAN-TERM.
 14131
 14132     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 14133         NEXT SENTENCE
 14134     ELSE
 14135         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14136             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14137                                           PB-I-LF-PREMIUM-AMT.
 14138
 14139     IF CP-TRUNCATED-LIFE
 14140        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14141
 14142     IF CP-TERM-IS-DAYS
 14143         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14144     ELSE
 14145         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14146
 14147     IF PB-COMPANY-ID = 'DCC'
 14148        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14149     END-IF
 14150     IF CP-SPECIAL-CALC-CD = 'H'
 14151         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14152                                    TO CP-ALTERNATE-BENEFIT
 14153         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 257
* EL050.cbl
 14154     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14155     MOVE 'R'                    TO CP-RATE-FILE
 14156     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14157     IF NOT CP-ERROR-RATE-NOT-FOUND
 14158        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14159        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14160           AND (CP-BENEFIT-CD (1:1) = 'S')
 14161           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14162                                    PB-I-LF-PREMIUM-AMT
 14163        END-IF
 14164     ELSE
 14165        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14166     END-IF
 14167     .
 14168 3340-EDIT-LF-AH-TOL.
 14169
 14170***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14171***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14172***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14173***
 14174     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14175         PB-I-AH-PREMIUM-AMT
 14176          GIVING WS-CALC-WORK.
 14177
 14178     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14179        AND WS-CALC-WORK NOT = ZERO
 14180         MOVE ER-2649            TO WS-ERROR
 14181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14182
 14183     SUBTRACT PB-I-LF-PREM-CALC
 14184             FROM PB-I-LF-PREMIUM-AMT
 14185                 GIVING WS-UNSIGN-WRK1.
 14186
 14187     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14188             FROM PB-I-LF-ALT-PREMIUM-AMT
 14189                 GIVING WS-UNSIGN-WRK4.
 14190
 14191     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14192                                + WS-UNSIGN-WRK4.
 14193
 14194     SUBTRACT PB-I-AH-PREM-CALC
 14195             FROM PB-I-AH-PREMIUM-AMT
 14196                 GIVING WS-UNSIGN-WRK2.
 14197
 14198******************************************************************
 14199*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14200******************************************************************
 14201
 14202     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14203         MOVE ZERO TO WS-UNSIGN-WRK1.
 14204
 14205     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14206         MOVE ZERO TO WS-UNSIGN-WRK2.
 14207
 14208     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14209             GIVING WS-UNSIGN-WRK3.
 14210
 14211 3342-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 258
* EL050.cbl
 14212
 14213     IF (PB-I-LF-RATE = ZERO  AND
 14214         PB-I-AH-RATE = ZERO)
 14215         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14216            WS-AH-SPECIAL-CALC-CD = 'O'
 14217              NEXT SENTENCE
 14218         ELSE
 14219             GO TO 3345-EDIT-CONTINUE.
 14220
 14221     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14222         NEXT SENTENCE
 14223     ELSE
 14224     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14225        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14226           IF (PB-REISSUED-CERT         OR
 14227               PB-POLICY-IS-DECLINED    OR
 14228               PB-POLICY-IS-VOIDED)
 14229              NEXT SENTENCE
 14230           ELSE
 14231              IF WS-PREM-REJECT-SW = SPACE
 14232                 MOVE ER-2652    TO WS-ERROR
 14233                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14234                 GO TO 3344-CHECK-AH
 14235              ELSE
 14236                 MOVE ER-2650    TO WS-ERROR
 14237                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14238                 GO TO 3344-CHECK-AH.
 14239
 14240***
 14241***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14242***
 14243
 14244     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14245         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14246            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14247             (1 + WS-TOL-LF-PREM-PCT)
 14248         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14249            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14250             (1 - WS-TOL-LF-PREM-PCT)
 14251     ELSE
 14252         MOVE +0                 TO  WS-TOL-LF-HIGH-PREM-PCT
 14253         MOVE +9999999.99        TO  WS-TOL-LF-LOW-PREM-PCT.
 14254
 14255***
 14256***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14257***
 14258
 14259     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14260         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14261          WS-TOL-LF-PREM.
 14262
 14263     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14264         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14265          WS-TOL-LF-PREM.
 14266
 14267     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14268        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14269
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 259
* EL050.cbl
 14270     IF (PB-REISSUED-CERT        OR
 14271         PB-POLICY-IS-DECLINED   OR
 14272         PB-POLICY-IS-VOIDED)
 14273        NEXT SENTENCE
 14274     ELSE
 14275     IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14276           GREATER THAN  WS-TOL-LF-HIGH-PREM-AMT)
 14277       OR
 14278        ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14279           LESS THAN WS-TOL-LF-LOW-PREM-AMT))
 14280       AND
 14281        (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14282           GREATER WS-TOL-LF-HIGH-PREM-PCT)
 14283         OR
 14284          ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14285           LESS WS-TOL-LF-LOW-PREM-PCT))
 14286              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14287                  MOVE ER-2652   TO  WS-ERROR
 14288                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14289              ELSE
 14290                  MOVE ER-2650   TO  WS-ERROR
 14291                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14292
 14293*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14294*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14295*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14296*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14297
 14298     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14299        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14300                      OR
 14301           ((PB-COMPANY-ID = 'DCC')
 14302           AND (PB-I-LF-BENEFIT-CD = '00' OR '  '))
 14303           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14304           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14305        END-IF
 14306     END-IF
 14307
 14308     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14309        IF WS-COMP-MAX-CAP GREATER THAN +0
 14310           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14311              IF (PB-REISSUED-CERT         OR
 14312                  PB-POLICY-IS-DECLINED    OR
 14313                  PB-POLICY-IS-VOIDED)
 14314                 NEXT SENTENCE
 14315              ELSE
 14316                  MOVE ER-2646   TO  WS-ERROR
 14317                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14318
 14319 3344-CVL-TOLERANCE-CHECK.
 14320
 14321      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14322          GO TO 3344-CHECK-AH.
 14323
 14324      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14325          GO TO 3344-CHECK-AH.
 14326
 14327      MOVE ZERO                  TO  WS-UNSIGN-WRK5
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 260
* EL050.cbl
 14328                                     WS-UNSIGN-WRK6.
 14329
 14330      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14331          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14332                                 + PB-I-LF-PREMIUM-AMT
 14333                                 - PB-I-LF-PREM-CALC.
 14334
 14335      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14336          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14337                                 + PB-I-LF-ALT-PREMIUM-AMT
 14338                                 - PB-I-LF-ALT-PREM-CALC.
 14339
 14340      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14341          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14342              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14343                 MOVE ER-2652    TO  WS-ERROR
 14344                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14345              ELSE
 14346                 MOVE ER-2650    TO  WS-ERROR
 14347                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14348
 14349      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14350          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14351              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14352                 MOVE ER-2652    TO  WS-ERROR
 14353                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14354              ELSE
 14355                 MOVE ER-2650    TO  WS-ERROR
 14356                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14357
 14358 3344-CHECK-AH.
 14359
 14360****************************************************************
 14361***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14362***
 14363
 14364     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14365         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14366             (1 + WS-TOL-AH-PREM-PCT)
 14367         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14368             (1 - WS-TOL-AH-PREM-PCT)
 14369     ELSE
 14370         MOVE +0                 TO  WS-TOL-AH-HIGH-PREM-PCT
 14371         MOVE +9999999.99        TO  WS-TOL-AH-LOW-PREM-PCT.
 14372
 14373***
 14374***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14375***
 14376
 14377     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14378         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14379
 14380     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14381         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14382
 14383     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14384        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14385
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 261
* EL050.cbl
 14386     IF (PB-REISSUED-CERT         OR
 14387         PB-POLICY-IS-DECLINED    OR
 14388         PB-POLICY-IS-VOIDED)
 14389        NEXT SENTENCE
 14390     ELSE
 14391     IF ((PB-I-AH-PREMIUM-AMT GREATER THAN
 14392                             WS-TOL-AH-HIGH-PREM-AMT)
 14393       OR
 14394        (PB-I-AH-PREMIUM-AMT LESS THAN WS-TOL-AH-LOW-PREM-AMT))
 14395       AND
 14396        ((PB-I-AH-PREMIUM-AMT GREATER WS-TOL-AH-HIGH-PREM-PCT)
 14397         OR
 14398          (PB-I-AH-PREMIUM-AMT LESS WS-TOL-AH-LOW-PREM-PCT))
 14399              IF WS-PREM-REJECT-SW IS EQUAL TO SPACE
 14400                 MOVE ER-3052   TO  WS-ERROR
 14401                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14402              ELSE
 14403                 MOVE ER-3050    TO  WS-ERROR
 14404                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14405
 14406     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14407         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14408             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14409             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14410
 14411     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14412        IF WS-COMP-MAX-CAP GREATER THAN +0
 14413           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14414              IF (PB-REISSUED-CERT         OR
 14415                  PB-POLICY-IS-DECLINED    OR
 14416                  PB-POLICY-IS-VOIDED)
 14417                 NEXT SENTENCE
 14418              ELSE
 14419                  MOVE ER-2646   TO  WS-ERROR
 14420                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14421
 14422     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14423        (WS-COMP-MAX-CAP EQUAL +0)
 14424           GO TO 3345-EDIT-CONTINUE.
 14425
 14426     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14427        GREATER THAN WS-COMP-MAX-CAP
 14428           MOVE ER-2646          TO  WS-ERROR
 14429           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14430
 14431 3345-EDIT-CONTINUE.
 14432
 14433*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14434*       IF PB-ENTRY-BATCH   NUMERIC
 14435*          IF PB-ISSUE
 14436*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14437*          ELSE
 14438*              IF PB-CANCELLATION
 14439*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14440
 14441*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14442*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14443*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 262
* EL050.cbl
 14444*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14445*        ELSE
 14446*            MOVE  ER-1909            TO  WS-ERROR
 14447*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14448
 14449     IF PB-I-POLICY-ACCEPTED
 14450        IF PB-POLICY-IS-DECLINED  OR
 14451           PB-REISSUED-CERT  OR
 14452           PB-REIN-ONLY-CERT  OR
 14453           PB-POLICY-IS-VOIDED
 14454            MOVE  ER-1891         TO  WS-ERROR
 14455            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14456        ELSE
 14457            MOVE SPACE            TO  PB-BATCH-ENTRY
 14458            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14459
 14460     IF PB-I-POLICY-DECLINED
 14461        IF PB-REISSUED-CERT  OR
 14462           PB-REIN-ONLY-CERT  OR
 14463           PB-POLICY-IS-VOIDED
 14464            MOVE  ER-1906         TO  WS-ERROR
 14465            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14466        ELSE
 14467            MOVE  'D'             TO  PB-BATCH-ENTRY
 14468                                      PB-I-ENTRY-STATUS.
 14469
 14470     IF PB-I-NEEDS-UNDERWRITING
 14471        IF PB-POLICY-IS-DECLINED OR
 14472           PB-REISSUED-CERT  OR
 14473           PB-REIN-ONLY-CERT  OR
 14474           PB-POLICY-IS-VOIDED
 14475            MOVE  ER-1907         TO  WS-ERROR
 14476            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14477        ELSE
 14478            MOVE 'U'              TO  PB-BATCH-ENTRY
 14479                                      PB-I-ENTRY-STATUS.
 14480
 14481     IF PB-NEEDS-UNDERWRITING
 14482        MOVE  ER-1901             TO  WS-ERROR
 14483        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14484     IF PB-COMPANY-ID = 'DCC'
 14485        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14486        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14487        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14488           AND (NOT WS-LF-CASH))
 14489                           OR
 14490           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14491           AND (NOT WS-AH-CASH)))
 14492                       AND
 14493           (PB-I-ENTRY-STATUS NOT = '5')
 14494           MOVE 'M'              TO PB-BATCH-ENTRY
 14495                                    PB-I-ENTRY-STATUS
 14496        END-IF
 14497     END-IF
 14498     IF  PB-COMPANY-ID NOT = 'NCL'
 14499         GO TO 3999-END-EDIT.
 14500
 14501     IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 263
* EL050.cbl
 14502        PB-POLICY-IS-DECLINED  OR
 14503        PB-POLICY-IS-VOIDED  OR
 14504        PB-I-OB
 14505         GO TO 3999-END-EDIT.
 14506
 14507     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14508         MOVE  ER-2644            TO  WS-ERROR
 14509         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14510         GO TO 3999-END-EDIT.
 14511
 14512     MOVE 'N'                     TO  FORM-MASTER-SW.
 14513     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14514
 14515     IF NOT FORM-MASTER-FOUND
 14516         GO TO 3999-END-EDIT.
 14517
 14518     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14519                                      FORM-MASTER-AH-SW.
 14520
 14521     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14522         MOVE  +1                 TO SUB6
 14523         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14524
 14525     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14526         MOVE  +1                 TO SUB6
 14527         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14528
 14529     IF LF-FORM-MASTER-FOUND  OR
 14530        AH-FORM-MASTER-FOUND
 14531         GO TO 3360-CHECK-FORM-LIMITS
 14532     ELSE
 14533         GO TO 3999-END-EDIT.
 14534
 14535******************************************************************
 14536*                  3350-GET-ERFORM                               *
 14537*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14538*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14539******************************************************************
 14540
 14541 3350-GET-ERFORM.
 14542
 14543     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14544         GO TO  3350-ERFORM-GETMAIN.
 14545
 14546     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14547     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14548     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14549     MOVE 'Y'                     TO FORM-MASTER-SW.
 14550
 14551     IF PB-CANCELLATION
 14552         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14553            PB-SV-STATE          EQUAL   FO-STATE       AND
 14554            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14555              GO TO 3350-EXIT
 14556         ELSE
 14557             NEXT SENTENCE
 14558     ELSE
 14559         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 264
* EL050.cbl
 14560            PB-SV-STATE          EQUAL   FO-STATE       AND
 14561            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14562              GO TO 3350-EXIT.
 14563
 14564 3350-ERFORM-GETMAIN.
 14565
 14566     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14567     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14568
 14569 3350-ERFORM-READ.
 14570
 14571     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14572     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14573     IF PB-CANCELLATION
 14574         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14575     ELSE
 14576         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14577     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 14578
 14579     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 14580
 14581     IF FORM-MASTER-FOUND
 14582       IF PB-CANCELLATION
 14583          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14584             PB-SV-STATE          EQUAL   FO-STATE       AND
 14585             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14586              GO  TO 3350-EXIT
 14587          ELSE
 14588              NEXT SENTENCE
 14589       ELSE
 14590          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14591             PB-SV-STATE          EQUAL   FO-STATE       AND
 14592             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14593              GO  TO 3350-EXIT.
 14594
 14595     MOVE  'N'                    TO  FORM-MASTER-SW.
 14596     MOVE  ER-1895                TO  WS-ERROR.
 14597     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14598
 14599 3350-EXIT.
 14600      EXIT.
 14601
 14602******************************************************************
 14603*                  3355-EDIT-FORM-LF-BENEFITS                    *
 14604*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 14605*   VALID FOR THE POLICY FORM USED.                              *
 14606******************************************************************
 14607
 14608 3355-EDIT-FORM-LF-BENEFITS.
 14609
 14610     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14611        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14612         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 14613         GO TO   3355-EXIT.
 14614
 14615     IF  SUB6    LESS THAN   +40
 14616         ADD  +1      TO  SUB6
 14617         GO TO  3355-EDIT-FORM-LF-BENEFITS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 265
* EL050.cbl
 14618
 14619     MOVE  ER-1896         TO  WS-ERROR.
 14620     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14621
 14622 3355-EXIT.
 14623      EXIT.
 14624
 14625******************************************************************
 14626*                  3356-EDIT-FORM-AH-BENEFITS                    *
 14627*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 14628*   VALID FOR THE POLICY FORM USED.                              *
 14629******************************************************************
 14630
 14631 3356-EDIT-FORM-AH-BENEFITS.
 14632
 14633     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 14634        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 14635         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 14636         GO TO  3356-EXIT.
 14637
 14638      IF  SUB6    LESS THAN     +40
 14639          ADD  +1      TO  SUB6
 14640          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 14641
 14642     MOVE  ER-1897         TO  WS-ERROR.
 14643     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14644
 14645 3356-EXIT.
 14646      EXIT.
 14647
 14648******************************************************************
 14649*                  3357-BENEFIT-SEARCH                           *
 14650*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 14651*   CANCELLATIONS ONLY.                                          *
 14652******************************************************************
 14653 3357-BENEFIT-SEARCH.
 14654     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 14655         MOVE +1                          TO SUB6
 14656         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 14657
 14658     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 14659         MOVE +1                          TO SUB6
 14660         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 14661
 14662 3357-EXIT.
 14663     EXIT.
 14664
 14665******************************************************************
 14666*                  3358-BENEFIT-LIFE-SEARCH                      *
 14667*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 14668*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14669*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14670******************************************************************
 14671 3358-BENEFIT-LIFE-SEARCH.
 14672     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 14673       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 14674         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14675           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 266
* EL050.cbl
 14676              IF FO-PLAN-REFUND-METHOD (SUB6)
 14677                     IS GREATER THAN SPACES
 14678                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14679                                          WS-LF-REFUND-CALC
 14680                 GO TO 3358-EXIT.
 14681
 14682     IF SUB6 LESS THAN +40
 14683         ADD +1                 TO SUB6
 14684         GO TO 3358-BENEFIT-LIFE-SEARCH.
 14685
 14686 3358-EXIT.
 14687     EXIT.
 14688******************************************************************
 14689*                  3359-BENEFIT-AH-SEARCH                        *
 14690*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 14691*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 14692*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 14693******************************************************************
 14694 3359-BENEFIT-AH-SEARCH.
 14695     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 14696       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 14697         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 14698           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 14699              IF FO-PLAN-REFUND-METHOD (SUB6)
 14700                      IS GREATER THAN SPACES
 14701                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 14702                                          WS-AH-REFUND-CALC
 14703                 GO TO 3359-EXIT.
 14704
 14705     IF SUB6 LESS THAN +40
 14706         ADD +1                 TO SUB6
 14707         GO TO 3359-BENEFIT-AH-SEARCH.
 14708
 14709 3359-EXIT.
 14710     EXIT.
 14711
 14712******************************************************************
 14713*                  3360-CHECK-FORM-LIMITS                        *
 14714*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14715*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14716******************************************************************
 14717
 14718 3360-CHECK-FORM-LIMITS.
 14719
 14720     IF FO-IND-GRP-CD = 'I'  OR  'G'
 14721         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 14722
 14723     IF NOT LF-FORM-MASTER-FOUND
 14724         GO TO 3360-CHECK-FORM-AH-LIMITS.
 14725
 14726 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 14727
 14728     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 14729       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 14730        WS-LF-JOINT-INDICATOR = 'J'  AND
 14731        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14732         IF PB-COMPANY-ID = 'NCL'
 14733            MOVE  ER-1911          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 267
* EL050.cbl
 14734            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14735         ELSE
 14736            MOVE  ER-1892          TO  WS-ERROR
 14737            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14738
 14739 3360-CHECK-FORM-LF-ATT-AGE.
 14740
 14741     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 14742
 14743     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 14744         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14745         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 14746            IF PB-COMPANY-ID = 'NCL'
 14747                MOVE  ER-1913      TO  WS-ERROR
 14748                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14749            ELSE
 14750                MOVE  ER-1894      TO  WS-ERROR
 14751                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14752
 14753 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 14754
 14755     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 14756         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 14757         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 14758            IF PB-COMPANY-ID = 'NCL'
 14759                MOVE  ER-1914      TO  WS-ERROR
 14760                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14761            ELSE
 14762                MOVE  ER-1899      TO  WS-ERROR
 14763                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14764
 14765 3360-CHECK-FORM-LF-TERM-BAMT.
 14766
 14767     IF  FO-LF-MAX-TERM   NUMERIC   AND
 14768         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 14769         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 14770           IF  PB-COMPANY-ID = 'NCL'
 14771               MOVE  ER-1916       TO  WS-ERROR
 14772               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14773           ELSE
 14774               MOVE  ER-1902       TO  WS-ERROR
 14775               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14776
 14777     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 14778                                    PB-I-LF-ALT-BENEFIT-AMT.
 14779
 14780     IF  FO-MAX-LF-AMT   NUMERIC   AND
 14781         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 14782         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 14783             IF  PB-COMPANY-ID = 'NCL'
 14784                 MOVE  ER-1918     TO  WS-ERROR
 14785                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14786             ELSE
 14787                 MOVE  ER-1904     TO  WS-ERROR
 14788                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14789
 14790******************************************************************
 14791*                  3360-CHECK-FORM-AH-LIMITS                     *
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 268
* EL050.cbl
 14792*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 14793*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 14794******************************************************************
 14795
 14796 3360-CHECK-FORM-AH-LIMITS.
 14797
 14798     IF NOT AH-FORM-MASTER-FOUND
 14799         GO TO 3999-END-EDIT.
 14800
 14801 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 14802
 14803     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 14804       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 14805        WS-AH-JOINT-INDICATOR = 'J'  AND
 14806        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 14807         IF PB-COMPANY-ID = 'NCL'
 14808            MOVE  ER-1912          TO  WS-ERROR
 14809            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14810         ELSE
 14811            MOVE  ER-1893          TO  WS-ERROR
 14812            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14813
 14814 3360-CHECK-FORM-AH-ATT-AGE.
 14815
 14816     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 14817
 14818     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 14819         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 14820         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 14821            IF PB-COMPANY-ID = 'NCL'
 14822                MOVE  ER-1913      TO  WS-ERROR
 14823                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14824            ELSE
 14825                MOVE  ER-1894      TO  WS-ERROR
 14826                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14827
 14828 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 14829
 14830     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 14831         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 14832         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 14833            IF PB-COMPANY-ID = 'NCL'
 14834                MOVE  ER-1915      TO  WS-ERROR
 14835                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14836            ELSE
 14837                MOVE  ER-1900      TO  WS-ERROR
 14838                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14839
 14840 3360-CHECK-FORM-AH-TERM-BAMT.
 14841
 14842     IF  FO-AH-MAX-TERM    NUMERIC   AND
 14843         FO-AH-MAX-TERM    GREATER THAN  +0
 14844         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 14845             IF  PB-COMPANY-ID = 'NCL'
 14846                 MOVE  ER-1917     TO  WS-ERROR
 14847                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 14848             ELSE
 14849                  MOVE  ER-1903    TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 269
* EL050.cbl
 14850                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 14851
 14852     IF  FO-MAX-AH-AMT    NUMERIC   AND
 14853         FO-MAX-AH-AMT    GREATER THAN  +0
 14854         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 14855             IF  PB-COMPANY-ID = 'NCL'
 14856                 MOVE  ER-1919     TO  WS-ERROR
 14857                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14858             ELSE
 14859                 MOVE  ER-1905     TO  WS-ERROR
 14860                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14861
 14862     GO TO 3999-END-EDIT.
 14863
 14864******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 270
* EL050.cbl
 14866******************************************************************
 14867*                  E D I T   C A N C E L                         *
 14868******************************************************************
 14869
 14870 3700-EDIT-CANCEL.
 14871     IF PB-COMPANY-ID = 'DMD'
 14872         MOVE ZEROS                   TO WS-RES-STATE-TAX
 14873                                         WS-RES-MUNI-TAX
 14874                                         PB-CI-STATE-TAX
 14875                                         PB-CI-MUNI-TAX
 14876         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 14877
 14878*    IF PB-COMPANY-ID  EQUAL  'NCL'
 14879*       IF PB-ENTRY-BATCH  NUMERIC
 14880*          IF PB-CANCELLATION
 14881*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 14882*          ELSE
 14883*             IF PB-ISSUE
 14884*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 14885
 14886     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 14887        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 14888     END-IF
 14889*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 14890*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 14891
 14892     IF CM-ENTRY-STATUS = 'V'
 14893        MOVE ER-2780             TO WS-ERROR
 14894        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14895        GO TO 3999-END-EDIT.
 14896
 14897     IF CM-ENTRY-STATUS = 'D'
 14898        MOVE ER-2781             TO WS-ERROR
 14899        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14900        GO TO 3999-END-EDIT.
 14901
 14902     IF CM-ENTRY-STATUS = 'U'
 14903        MOVE ER-2782             TO WS-ERROR
 14904        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14905
 14906***************************************************************
 14907*                                                             *
 14908*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 14909*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 14910*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 14911*   OF ANOTHER COVERAGE.                                      *
 14912*                                                             *
 14913***************************************************************
 14914
 14915     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 14916                                    PB-C-AH-CANCEL-VOID-SW.
 14917
 14918     IF PB-C-LF-CANCEL-AMT = ZERO
 14919        NEXT SENTENCE
 14920     ELSE
 14921        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 14922           AND
 14923           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 271
* EL050.cbl
 14924               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 14925               MOVE ER-2745           TO WS-ERROR
 14926               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14927
 14928     IF PB-C-AH-CANCEL-AMT = ZERO
 14929        NEXT SENTENCE
 14930     ELSE
 14931        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 14932           AND
 14933           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 14934               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 14935               MOVE ER-2745           TO WS-ERROR
 14936               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14937
 14938     IF WS-LF-EARNINGS-CALC = '4'
 14939        MOVE '4'                   TO WS-LF-REFUND-CALC.
 14940
 14941     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 14942     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 14943     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 14944     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 14945     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 14946     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 14947
 14948     MOVE ZERO                     TO PB-C-LF-REF-CALC
 14949                                      PB-C-AH-REF-CALC.
 14950     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 14951
 14952******************************************************************
 14953*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 14954*             TO VALIDATE COVERAGE.                              *
 14955******************************************************************
 14956
 14957     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 14958        PB-C-LF-CANCEL-AMT = ZEROS
 14959          MOVE 'N'                 TO WS-LF-CANCEL-SW
 14960      ELSE
 14961          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 14962
 14963     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 14964        PB-C-AH-CANCEL-AMT = ZEROS
 14965          MOVE 'N'                 TO WS-AH-CANCEL-SW
 14966      ELSE
 14967          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 14968
 14969     EVALUATE TRUE
 14970         WHEN PB-CANCEL-FORCE             OR
 14971              PB-CANCEL-DATE-FORCED       OR
 14972              PB-FORCE-OFF
 14973                  IF PB-COMPANY-ID = 'ACE'
 14974                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 14975                  END-IF
 14976         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 14977               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 14978              (PB-COMPANY-ID = 'ACE' )
 14979                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 14980         WHEN OTHER
 14981              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 272
* EL050.cbl
 14982                 MOVE ER-2794              TO WS-ERROR
 14983              ELSE
 14984                 MOVE ER-2749              TO WS-ERROR
 14985              END-IF
 14986              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14987     END-EVALUATE.
 14988
 14989
 14990*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14991*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 14992*            MOVE  ER-1909            TO  WS-ERROR
 14993*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14994*        ELSE
 14995*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 14996
 14997     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 14998     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 14999        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15000     ELSE
 15001        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15002     END-IF
 15003     .
 15004 3705-EDIT-CANCEL-DT.
 15005
 15006     IF LF-COVERAGE-CANCELLED
 15007        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15008         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15009         MOVE WS-CURRENT-MONTH-END
 15010                                 TO DC-BIN-DATE-2
 15011         SET ELAPSED-BETWEEN-BIN TO TRUE
 15012*        MOVE 1                  TO DC-OPTION-CODE
 15013         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15014         IF DATE-CONVERSION-ERROR
 15015            NEXT SENTENCE
 15016          ELSE
 15017             IF DC-ELAPSED-DAYS GREATER +180
 15018                IF PB-CANCEL-DATE-FORCED  OR
 15019                   PB-CANCEL-DATE-FORCED-NO-FEE
 15020                      MOVE ER-2751  TO WS-ERROR
 15021                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15022                 ELSE
 15023                   MOVE ER-2752  TO WS-ERROR
 15024                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15025
 15026     IF AH-COVERAGE-CANCELLED
 15027        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15028         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15029         MOVE WS-CURRENT-MONTH-END
 15030                                 TO DC-BIN-DATE-2
 15031         SET ELAPSED-BETWEEN-BIN TO TRUE
 15032*        MOVE 1                  TO DC-OPTION-CODE
 15033         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15034         IF DATE-CONVERSION-ERROR
 15035            NEXT SENTENCE
 15036          ELSE
 15037             IF DC-ELAPSED-DAYS GREATER +180
 15038                IF PB-CANCEL-DATE-FORCED OR
 15039                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 273
* EL050.cbl
 15040                      MOVE ER-2751  TO WS-ERROR
 15041                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15042                 ELSE
 15043                   MOVE ER-2752  TO WS-ERROR
 15044                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15045
 15046     IF WS-ERROR = ER-2752
 15047        AND (PB-COMPANY-ID = 'ABL'
 15048         OR  PB-COMPANY-ID = 'FGL'
 15049         OR  PB-COMPANY-ID = 'IST'
 15050         OR  PB-COMPANY-ID = 'JHL'
 15051         OR  PB-COMPANY-ID = 'LAP'
 15052         OR  PB-COMPANY-ID = 'LBL'
 15053         OR  PB-COMPANY-ID = 'NCB'
 15054         OR  PB-COMPANY-ID = 'NLI'
 15055         OR  PB-COMPANY-ID = 'OFI'
 15056         OR  PB-COMPANY-ID = 'PLI'
 15057         OR  PB-COMPANY-ID = 'TAO'
 15058         OR  PB-COMPANY-ID = 'TIC'
 15059         OR  PB-COMPANY-ID = 'HER'
 15060         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15061         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15062            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15063            MOVE ER-2762     TO WS-ERROR
 15064            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15065
 15066     IF LF-COVERAGE-CANCELLED
 15067        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15068        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15069             MOVE ER-2733         TO WS-ERROR
 15070             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15071
 15072     IF AH-COVERAGE-CANCELLED
 15073        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15074        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15075              MOVE ER-2733        TO WS-ERROR
 15076              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15077
 15078     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15079        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15080        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15081           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15082            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15083              IF PB-COMPANY-ID NOT = 'LAP'
 15084               MOVE ER-2704            TO WS-ERROR
 15085               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15086
 15087     IF CERT-WAS-NOT-FOUND
 15088         GO TO 3999-END-EDIT.
 15089
 15090     IF PB-COMPANY-ID EQUAL 'CDC'
 15091        IF LF-COVERAGE-CANCELLED
 15092           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15093            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15094            MOVE PB-C-LF-CANCEL-DT
 15095                                 TO DC-BIN-DATE-2
 15096            SET ELAPSED-BETWEEN-BIN TO TRUE
 15097*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 274
* EL050.cbl
 15098            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15099            IF DATE-CONVERSION-ERROR
 15100               NEXT SENTENCE
 15101             ELSE
 15102                IF DC-ELAPSED-DAYS GREATER +60
 15103                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15104
 15105     IF PB-COMPANY-ID EQUAL 'CDC'
 15106        IF AH-COVERAGE-CANCELLED
 15107           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15108            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15109            MOVE PB-C-AH-CANCEL-DT
 15110                                 TO DC-BIN-DATE-2
 15111            MOVE +0              TO DC-ELAPSED-DAYS
 15112                                    DC-ELAPSED-MONTHS
 15113            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15114*           MOVE 1               TO DC-OPTION-CODE
 15115            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15116            IF DATE-CONVERSION-ERROR
 15117               NEXT SENTENCE
 15118             ELSE
 15119                IF DC-ELAPSED-DAYS GREATER +60
 15120                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15121
 15122     MOVE +0                     TO DC-ELAPSED-DAYS
 15123                                    DC-ELAPSED-MONTHS.
 15124
 15125     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15126        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15127          MOVE 'Z'                TO PB-CI-OB-FLAG
 15128          MOVE ER-2767            TO WS-ERROR
 15129          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15130          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15131          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15132          GO TO 3775-OVER-REF-CHK
 15133        ELSE
 15134          MOVE ZEROS              TO PB-CI-LIVES
 15135                                     PB-C-LIVES
 15136          IF PB-CI-OB-FLAG NOT = 'B'
 15137             MOVE SPACE           TO PB-CI-OB-FLAG.
 15138
 15139     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15140         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15141     ELSE
 15142         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15143
 15144     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15145        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15146            MOVE ER-2760         TO WS-ERROR
 15147            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15148
 15149     IF LF-COVERAGE-CANCELLED
 15150        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15151         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15152            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15153               MOVE ER-2774       TO WS-ERROR
 15154               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15155
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 275
* EL050.cbl
 15156     IF AH-COVERAGE-CANCELLED
 15157        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15158         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15159            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15160               MOVE ER-2775       TO WS-ERROR
 15161               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15162
 15163     IF LF-COVERAGE-CANCELLED
 15164        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15165         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15166            MOVE ER-2776         TO WS-ERROR
 15167            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15168
 15169     IF AH-COVERAGE-CANCELLED
 15170        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15171         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15172            MOVE ER-2777         TO WS-ERROR
 15173            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15174
 15175     IF LF-COVERAGE-CANCELLED
 15176        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15177         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15178         MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15179         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15180*        MOVE 6                    TO DC-OPTION-CODE
 15181         SET BIN-PLUS-ELAPSED      TO TRUE
 15182         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15183         IF DATE-CONVERSION-ERROR
 15184            NEXT SENTENCE
 15185          ELSE
 15186            IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15187              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15188                             OR  'FIA'
 15189                 MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15190               ELSE
 15191                MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15192                MOVE ER-2731       TO WS-ERROR
 15193                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15194
 15195 3705-EDIT-AH-CANCEL-DT.
 15196
 15197     IF AH-COVERAGE-CANCELLED
 15198        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15199         MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15200         MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15201         MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15202*        MOVE 6                    TO DC-OPTION-CODE
 15203         SET BIN-PLUS-ELAPSED      TO TRUE
 15204         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15205         IF DATE-CONVERSION-ERROR
 15206            NEXT SENTENCE
 15207          ELSE
 15208            IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15209              IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15210                              OR 'FIA'
 15211                MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15212              ELSE
 15213               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 276
* EL050.cbl
 15214               MOVE ER-2771       TO WS-ERROR
 15215               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15216
 15217 3705-EDIT-CONTINUED.
 15218
 15219*    IF LF-COVERAGE-CANCELLED
 15220*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15221*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15222*            MOVE ER-2727         TO WS-ERROR
 15223*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15224*
 15225*    IF AH-COVERAGE-CANCELLED
 15226*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15227*        IF PB-COMPANY-ID = 'ACE'
 15228*           MOVE ER-2727        TO WS-ERROR
 15229*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15230*        ELSE
 15231*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15232*              MOVE ER-2727     TO WS-ERROR
 15233*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15234
 15235     IF PB-COMPANY-ID = 'ACE'
 15236       IF AH-COVERAGE-CANCELLED
 15237         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15238           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15239              MOVE ER-2732      TO WS-ERROR
 15240              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15241
 15242     IF PB-COMPANY-ID      EQUAL   'HER'
 15243        IF WS-ERROR        EQUAL   ER-2727
 15244            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15245            MOVE  ER-2725          TO  WS-ERROR
 15246            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15247
 15248     IF PB-C-CLAIM-CREATED-CANCEL
 15249            MOVE ER-2748         TO WS-ERROR
 15250            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15251
 15252     IF PB-C-LAST-NAME NOT = SPACES
 15253         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15254            MOVE ER-2747         TO WS-ERROR
 15255            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15256
 15257 3710-EDIT-LUMP-SUM-PRIOR.
 15258
 15259     IF AH-COVERAGE-CANCELLED
 15260         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15261             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15262                MOVE ER-2735    TO WS-ERROR
 15263                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15264
 15265     IF LF-COVERAGE-CANCELLED
 15266         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15267             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15268                MOVE ER-2735    TO WS-ERROR
 15269                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15270
 15271 3710-EDIT-PRIOR-DEATH.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 277
* EL050.cbl
 15272
 15273*    IF LF-COVERAGE-CANCELLED
 15274*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15275*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15276*           (NOT PB-CI-OB)
 15277*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15278*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15279*                   MOVE ER-2732  TO WS-ERROR
 15280*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15281*
 15282*    IF AH-COVERAGE-CANCELLED
 15283*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15284*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15285*           (NOT PB-CI-OB)
 15286*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15287*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15288*                   MOVE ER-2732  TO WS-ERROR
 15289*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15290
 15291     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15292         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15293            (NOT PB-COMP-LF-CANCEL)
 15294             NEXT SENTENCE
 15295         ELSE
 15296           IF PB-C-LF-CANCEL-VOIDED
 15297              NEXT SENTENCE
 15298           ELSE
 15299              MOVE ER-2753      TO WS-ERROR
 15300              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15301
 15302     IF CANCEL-FUTURE-DT
 15303         GO TO 3999-END-EDIT.
 15304
 15305 3715-GET-REMAIN-TERM-LF.
 15306
 15307     IF NO-LF-BENEFIT-MATCH  OR
 15308        WS-LF-BENEFIT-CD = ZEROS
 15309        GO TO 3730-GET-AH-REMAIN-TERM.
 15310
 15311     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15312     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15313     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15314     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15315     MOVE PB-SV-STATE            TO CP-STATE.
 15316     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15317     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15318     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15319     MOVE '2'                    TO CP-PROCESS-TYPE.
 15320     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15321     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15322     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15323     IF (PB-COMPANY-ID = 'CID')
 15324        AND (CP-STATE-STD-ABBRV = 'WI')
 15325        MOVE '7'                 TO CP-REM-TERM-METHOD
 15326        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15327     ELSE
 15328        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15329        MOVE WS-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 278
* EL050.cbl
 15330                                 TO CP-REM-TRM-CALC-OPTION
 15331     END-IF
 15332**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15333     IF (PB-COMPANY-ID = 'CID')
 15334        AND (CP-STATE-STD-ABBRV = 'MO')
 15335        AND (PB-CERT-EFF-DT >= X'9B41')
 15336        AND (PB-CERT-EFF-DT <= X'A2FB')
 15337        MOVE '7'                 TO CP-REM-TERM-METHOD
 15338        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15339     END-IF
 15340     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15341                                    CP-LOAN-TERM.
 15342     IF CP-TRUNCATED-LIFE
 15343        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15344
 15345     IF CP-TERM-IS-DAYS
 15346         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15347     ELSE
 15348         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15349
 15350     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15351
 15352     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15353
 15354     IF LF-COVERAGE-CANCELLED
 15355        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15356        NEXT SENTENCE
 15357      ELSE
 15358          GO TO 3730-GET-AH-REMAIN-TERM.
 15359
 15360 3720-GET-LF-REFUND.
 15361
 15362     IF PB-C-LF-CANCEL-VOIDED OR
 15363        PB-C-AH-CANCEL-VOIDED
 15364        GO TO 3780-UPDATE-CANCEL-CERT.
 15365
 15366     IF PB-COMPANY-ID EQUAL 'BOA'
 15367         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15368         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15369         GO TO 3730-GET-AH-REMAIN-TERM.
 15370
 15371     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15372        (WS-AH-SPECIAL-CALC-CD = 'M')
 15373         MOVE ER-2767            TO WS-ERROR
 15374         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15375         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15376         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15377         GO TO 3780-UPDATE-CANCEL-CERT.
 15378
 15379     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15380
 15381     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15382     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15383     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15384     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15385     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 15386     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15387     IF (PB-COMPANY-ID = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 279
* EL050.cbl
 15388        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15389        MOVE ' '                 TO PDEF-MASTER-SW
 15390        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15391        MOVE PB-STATE            TO ERPDEF-STATE
 15392        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15393        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15394        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15395        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15396        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15397        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15398        IF PDEF-MASTER-FOUND
 15399           MOVE 'N'              TO PDEF-MASTER-SW
 15400           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15401           IF PDEF-MASTER-FOUND
 15402              IF (ERPDEF-KEY-SAVE (1:16) =
 15403                           PD-CONTROL-PRIMARY (1:16))
 15404                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15405                 CONTINUE
 15406              ELSE
 15407                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15408                 IF (ERPDEF-KEY-SAVE (1:16) =
 15409                           PD-CONTROL-PRIMARY (1:16))
 15410                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15411                    CONTINUE
 15412                 ELSE
 15413                    MOVE 'N'     TO PDEF-MASTER-SW
 15414                 END-IF
 15415              END-IF
 15416              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
 15417
 15418              IF PDEF-MASTER-FOUND
 15419                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15420                    (V1 > +8)
 15421                    OR (PD-PROD-CODE (V1) = 'L')
 15422                 END-PERFORM
 15423                 IF V1 < +9
 15424                    MOVE PD-MAX-AMT (V1)
 15425                                 TO CP-R-MAX-TOT-BEN
 15426                                    EC-AM-LF-MAX-TOT-BEN
 15427                 END-IF
 15428              END-IF
 15429           END-IF
 15430           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15431        END-IF
 15432     END-IF
 15433     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15434
 15435     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15436
 15437     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15438                                    PB-C-LF-REM-TERM.
 15439
 15440     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15441     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15442
 15443     IF PB-COMPANY-ID EQUAL 'FLC'
 15444        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15445           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 280
* EL050.cbl
 15446           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15447                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15448                    - CM-LF-ITD-DEATH-AMT
 15449           IF PB-C-LF-REF-CALC LESS THAN +0
 15450              MOVE +0            TO PB-C-LF-REF-CALC
 15451              GO TO 3730-GET-AH-REMAIN-TERM
 15452           ELSE
 15453              GO TO 3730-GET-AH-REMAIN-TERM.
 15454
 15455     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15456                            OR '4' OR '5' OR '6' OR '8'
 15457                            OR '9' OR 'G'
 15458        MOVE PB-C-LF-REFUND-OVERRIDE
 15459                                 TO CP-EARNING-METHOD.
 15460
 15461     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15462     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15463     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15464                                    CP-RATING-BENEFIT-AMT.
 15465     IF CP-STATE-STD-ABBRV = 'OR'
 15466         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15467                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15468     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15469     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15470     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15471     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15472     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15473     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15474     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15475     IF WS-DEFAULT-APR NOT NUMERIC
 15476         MOVE ZEROS TO WS-DEFAULT-APR.
 15477****   N O T E   ****
 15478*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15479*      THE OH HARD CODING IN ELCRFNDP
 15480
 15481     IF PB-COMPANY-ID = 'CID'
 15482        IF CP-STATE-STD-ABBRV = 'OH'
 15483           MOVE WS-LF-EARNINGS-CALC
 15484                                 TO CP-EARNING-METHOD
 15485        END-IF
 15486     END-IF
 15487
 15488****   N O T E   ****
 15489
 15490     IF CP-EARN-AS-NET-PAY
 15491         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15492            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15493                MOVE WS-DEFAULT-APR
 15494                                 TO  CP-LOAN-APR
 15495                MOVE ER-3780     TO  WS-ERROR
 15496                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15497            ELSE
 15498                MOVE ER-3781     TO  WS-ERROR
 15499                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15500     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 15501     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15502
 15503     IF CP-REFUND-TYPE-USED NOT = SPACE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 281
* EL050.cbl
 15504         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 15505
 15506     IF CP-ERROR-RATE-IS-ZERO OR
 15507        CP-ERROR-RATE-NOT-FOUND
 15508        MOVE ER-2740             TO WS-ERROR
 15509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15510
 15511     IF CP-ERROR-RATE-FILE-NOTOPEN
 15512        MOVE ER-2617             TO WS-ERROR
 15513        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15514
 15515     IF PB-COMPANY-ID = 'DCC'
 15516        AND PB-CI-ENTRY-STATUS = 'M'
 15517        MOVE +0                  TO PB-C-LF-REF-CALC
 15518     ELSE
 15519        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 15520     END-IF
 15521
 15522     IF WS-LF-EARNINGS-CALC NOT = 'B'
 15523         GO TO 3730-GET-AH-REMAIN-TERM.
 15524
 15525*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 15526*       ADD +1                   TO PB-C-LF-REM-TERM
 15527*                                   CP-REMAINING-TERM
 15528*                                   CP-ORIGINAL-TERM.
 15529
 15530     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 15531     MOVE '2'                    TO CP-EARNING-METHOD
 15532                                    CP-RATING-METHOD.
 15533     IF PB-COMPANY-ID = 'CID'
 15534        IF (CP-STATE-STD-ABBRV = 'MN')
 15535           AND (PB-CERT-EFF-DT > X'A4FF')
 15536           AND (WS-LF-EARNINGS-CALC = 'B')
 15537           MOVE '5'              TO CP-EARNING-METHOD
 15538           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 15539        END-IF
 15540     END-IF
 15541     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15542                                        CP-REMAINING-BENEFIT
 15543                                        CP-RATING-BENEFIT-AMT.
 15544     IF CP-STATE-STD-ABBRV = 'OR'
 15545         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15546                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15547     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15548     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 15549
 15550     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15551
 15552     IF CP-ERROR-RATE-IS-ZERO OR
 15553        CP-ERROR-RATE-NOT-FOUND
 15554        MOVE ER-2740             TO WS-ERROR
 15555        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15556
 15557     IF CP-ERROR-RATE-FILE-NOTOPEN
 15558        MOVE ER-2617             TO WS-ERROR
 15559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15560
 15561     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 282
* EL050.cbl
 15562
 15563******************************************************************
 15564
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 283
* EL050.cbl
 15566 3730-GET-AH-REMAIN-TERM.
 15567     IF NO-AH-BENEFIT-MATCH  OR
 15568        WS-AH-BENEFIT-CD = ZEROS
 15569         GO TO 3770-CHECK-REFUNDS.
 15570
 15571     IF PB-CI-AH-LUMP-SUM-DISAB
 15572         IF  PB-C-AH-CANCEL-AMT = ZERO
 15573            IF NOT PB-COMP-AH-CANCEL
 15574             GO TO 3770-CHECK-REFUNDS.
 15575
 15576     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 15577     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15578     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15579     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 15580     MOVE PB-SV-STATE            TO CP-STATE.
 15581     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15582     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 15583     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15584     MOVE '2'                    TO CP-PROCESS-TYPE.
 15585     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15586     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15587     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15588     IF (PB-COMPANY-ID = 'CID')
 15589        AND (CP-STATE-STD-ABBRV = 'WI')
 15590        MOVE '7'                 TO CP-REM-TERM-METHOD
 15591        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15592     ELSE
 15593        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15594        MOVE WS-REM-TRM-CALC-OPTION
 15595                                 TO CP-REM-TRM-CALC-OPTION
 15596     END-IF
 15597     IF (PB-COMPANY-ID = 'CID')
 15598        AND (CP-STATE-STD-ABBRV = 'MO')
 15599        AND (PB-CERT-EFF-DT >= X'9B41')
 15600        AND (PB-CERT-EFF-DT <= X'A2FB')
 15601        MOVE '7'                 TO CP-REM-TERM-METHOD
 15602        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15603     END-IF
 15604     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 15605                                    CP-LOAN-TERM.
 15606     IF NOT CP-TERM-IS-DAYS
 15607         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15608
 15609     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 15610
 15611     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15612
 15613     IF AH-COVERAGE-CANCELLED
 15614        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 15615        NEXT SENTENCE
 15616      ELSE
 15617         GO TO 3770-CHECK-REFUNDS.
 15618
 15619 3740-GET-AH-REFUND.
 15620
 15621     IF PB-C-LF-CANCEL-VOIDED OR
 15622        PB-C-AH-CANCEL-VOIDED
 15623        GO TO 3780-UPDATE-CANCEL-CERT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 284
* EL050.cbl
 15624
 15625     IF PB-COMPANY-ID = 'BOA'
 15626         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15627         GO TO 3770-CHECK-REFUNDS.
 15628
 15629     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 15630*    MOVE ' '                    TO DC-OPTION-CODE
 15631     SET BIN-TO-GREG             TO TRUE
 15632     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 15633     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15634                                    PB-C-AH-REM-TERM.
 15635     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 15636     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 15637
 15638     IF PB-COMPANY-ID EQUAL 'FLC'
 15639        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 15640           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 15641           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 15642                    - CM-AH-ITD-AH-PMT)
 15643           IF PB-C-AH-REF-CALC LESS THAN +0
 15644              MOVE +0            TO PB-C-AH-REF-CALC
 15645              GO TO 3770-CHECK-REFUNDS
 15646           ELSE
 15647              GO TO 3770-CHECK-REFUNDS.
 15648
 15649     IF PB-COMPANY-ID = 'DCC'
 15650        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15651            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 15652           MOVE 'S'              TO CP-EARNING-METHOD
 15653        END-IF
 15654     END-IF
 15655     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15656                            OR '4' OR '5' OR '6' OR '8'
 15657                            OR '9' OR 'G' OR 'S'
 15658        MOVE PB-C-AH-REFUND-OVERRIDE
 15659                                 TO CP-EARNING-METHOD.
 15660
 15661     MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15662     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 15663     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15664                                    CP-RATING-BENEFIT-AMT.
 15665     IF CP-STATE-STD-ABBRV = 'OR'
 15666         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 15667                                         PB-CI-AH-TERM.
 15668     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15669     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15670     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15671     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 15672     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 15673     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15674
 15675     IF CP-STATE-STD-ABBRV = 'OH'
 15676        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 15677                                AND 'CID' AND 'DCC')
 15678           IF (CP-ORIGINAL-TERM GREATER 60) AND
 15679              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 15680              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15681              MOVE '6' TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 285
* EL050.cbl
 15682           END-IF
 15683        END-IF
 15684        IF PB-COMPANY-ID = 'CID'
 15685           IF NO-LIFE-COVERAGE
 15686              IF CP-CRITICAL-PERIOD
 15687                 MOVE '2'       TO CP-EARNING-METHOD
 15688              ELSE
 15689                 MOVE '6'       TO CP-EARNING-METHOD
 15690              END-IF
 15691           ELSE
 15692              IF WS-LF-COVERAGE-TYPE = 'L'
 15693                 MOVE '2'       TO CP-EARNING-METHOD
 15694              ELSE
 15695                 IF (PB-CI-LF-TERM > +60) OR
 15696                    (WS-LF-EARNINGS-CALC = '5')
 15697                    IF CP-CRITICAL-PERIOD
 15698                       MOVE '2'  TO CP-EARNING-METHOD
 15699                    ELSE
 15700                       MOVE '6'  TO CP-EARNING-METHOD
 15701                    END-IF
 15702                 ELSE
 15703                    MOVE '1'     TO CP-EARNING-METHOD
 15704                 END-IF
 15705              END-IF
 15706           END-IF
 15707        END-IF
 15708     END-IF
 15709
 15710*    IF CP-STATE-STD-ABBRV = 'VA'
 15711*       IF DC-GREG-DATE-CYMD GREATER 19921231
 15712*          IF CP-ORIGINAL-TERM GREATER 61
 15713*             MOVE '6' TO CP-EARNING-METHOD
 15714*          ELSE
 15715*             MOVE '1' TO CP-EARNING-METHOD.
 15716
 15717     IF WS-DEFAULT-APR NOT NUMERIC
 15718         MOVE ZEROS TO WS-DEFAULT-APR.
 15719     IF CP-EARN-AS-NET-PAY
 15720         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15721            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15722                MOVE WS-DEFAULT-APR
 15723                                 TO  CP-LOAN-APR
 15724                MOVE ER-3780     TO  WS-ERROR
 15725                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15726            ELSE
 15727                MOVE ER-3781     TO  WS-ERROR
 15728                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15729     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15730     IF PB-COMPANY-ID = 'DCC'
 15731        AND CP-CANCEL-REASON = 'R'
 15732        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15733        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 15734     END-IF
 15735     IF PB-COMPANY-ID = 'DCC'
 15736        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15737        AND (CP-EARNING-METHOD = 'D')
 15738        AND (CP-CANCEL-REASON NOT = 'R')
 15739        MOVE ' '                 TO DD-IU-SW
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 286
* EL050.cbl
 15740        MOVE ' '                 TO PDEF-MASTER-SW
 15741        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15742        MOVE PB-STATE            TO ERPDEF-STATE
 15743        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15744        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15745        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15746        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15747        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15748        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15749        IF PDEF-MASTER-FOUND
 15750           MOVE 'N'              TO PDEF-MASTER-SW
 15751           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15752           IF PDEF-MASTER-FOUND
 15753              IF (ERPDEF-KEY-SAVE (1:16) =
 15754                           PD-CONTROL-PRIMARY (1:16))
 15755                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15756                 CONTINUE
 15757              ELSE
 15758                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15759                 IF (ERPDEF-KEY-SAVE (1:16) =
 15760                           PD-CONTROL-PRIMARY (1:16))
 15761                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15762                    CONTINUE
 15763                 ELSE
 15764                    MOVE ER-2740 TO WS-ERROR
 15765                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15766                    GO TO 3770-CHECK-REFUNDS
 15767                 END-IF
 15768              END-IF
 15769
 15770              PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15771                 (V1 > +8)
 15772                 OR (PD-PROD-CODE (V1) = 'I')
 15773              END-PERFORM
 15774              IF V1 < +9
 15775                 SET DD-IU-PRESENT        TO TRUE
 15776              END-IF
 15777
 15778              EVALUATE TRUE
 15779                 WHEN CP-ORIGINAL-TERM > +168
 15780                    MOVE 15               TO V1
 15781                 WHEN CP-ORIGINAL-TERM > +156
 15782                    MOVE 14               TO V1
 15783                 WHEN CP-ORIGINAL-TERM > +144
 15784                    MOVE 13               TO V1
 15785                 WHEN CP-ORIGINAL-TERM > +132
 15786                    MOVE 12               TO V1
 15787                 WHEN CP-ORIGINAL-TERM > +120
 15788                    MOVE 11               TO V1
 15789                 WHEN CP-ORIGINAL-TERM > +108
 15790                    MOVE 10               TO V1
 15791                 WHEN CP-ORIGINAL-TERM > +96
 15792                    MOVE 9                TO V1
 15793                 WHEN CP-ORIGINAL-TERM > +84
 15794                    MOVE 8                TO V1
 15795                 WHEN CP-ORIGINAL-TERM > +72
 15796                    MOVE 7                TO V1
 15797                 WHEN CP-ORIGINAL-TERM > +60
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 287
* EL050.cbl
 15798                    MOVE 6                TO V1
 15799                 WHEN CP-ORIGINAL-TERM > +48
 15800                    MOVE 5                TO V1
 15801                 WHEN CP-ORIGINAL-TERM > +36
 15802                    MOVE 4                TO V1
 15803                 WHEN CP-ORIGINAL-TERM > +24
 15804                    MOVE 3                TO V1
 15805                 WHEN CP-ORIGINAL-TERM > +12
 15806                    MOVE 2                TO V1
 15807                 WHEN OTHER
 15808                    MOVE 1                TO V1
 15809              END-EVALUATE
 15810
 15811              EVALUATE TRUE
 15812*                WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 15813*                   < +13)
 15814*                   AND (DD-IU-PRESENT)
 15815*                   MOVE 2                TO V2
 15816*                WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15817*                   MOVE 1                TO V2
 15818                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 15819                    MOVE 2                TO V2
 15820                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 15821                    MOVE 3                TO V2
 15822                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 15823                    MOVE 4                TO V2
 15824                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 15825                    MOVE 5                TO V2
 15826                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 15827                    MOVE 6                TO V2
 15828                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 15829                    MOVE 7                TO V2
 15830                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 15831                    MOVE 8                TO V2
 15832                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +10
 15833                    MOVE 9                TO V2
 15834                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +12
 15835                    MOVE 10               TO V2
 15836                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 15837                    MOVE 11               TO V2
 15838                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +14
 15839                    MOVE 12               TO V2
 15840                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +15
 15841                    MOVE 13               TO V2
 15842                 WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +16
 15843                    MOVE 14               TO V2
 15844                 WHEN OTHER
 15845                    MOVE 15               TO V2
 15846              END-EVALUATE
 15847
 15848              MOVE PD-UEP-FACTOR (V1 V2 + 1)
 15849                                       TO CP-DDF-LO-FACT
 15850              MOVE PD-UEP-FACTOR (V1 V2)
 15851                                       TO CP-DDF-HI-FACT
 15852
 15853              MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 15854              MOVE CM-AH-CLP     TO CP-DDF-CLP
 15855              COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 288
* EL050.cbl
 15856                 (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 15857              MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 15858              MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 15859              COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 15860                 + PD-1ST-YR-ADMIN-ALLOW
 15861
 15862              MOVE 'G'                 TO CP-DDF-SPEC-CALC
 15863*             IF PI-CLP-YN = 'Y'
 15864*                MOVE 'C'              TO CP-DDF-SPEC-CALC
 15865*                MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 15866*                MOVE ZEROS            TO CP-DDF-ADDL-CLP
 15867*             END-IF
 15868
 15869              IF DD-IU-PRESENT
 15870                 MOVE 'I'              TO CP-EARNING-METHOD
 15871              END-IF
 15872              MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15873                                           CP-CLP-RATE-UP
 15874              IF CP-IU-RATE-UP NOT = ZEROS
 15875                 COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 15876                    + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 15877                 COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 15878                    / (1 - WS-WORK-FACT)
 15879              END-IF
 15880           END-IF
 15881           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15882        END-IF
 15883     END-IF
 15884     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 15885
 15886     IF CP-REFUND-TYPE-USED NOT = SPACE
 15887         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 15888
 15889     IF CP-ERROR-RATE-IS-ZERO OR
 15890        CP-ERROR-RATE-NOT-FOUND
 15891        MOVE ER-2740             TO WS-ERROR
 15892        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15893
 15894     IF CP-ERROR-RATE-FILE-NOTOPEN
 15895        MOVE ER-2617             TO WS-ERROR
 15896        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15897     IF PB-COMPANY-ID = 'DCC'
 15898        AND PB-CI-ENTRY-STATUS = 'M'
 15899        MOVE +0                  TO PB-C-AH-REF-CALC
 15900     ELSE
 15901        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 15902     END-IF
 15903     IF PB-COMPANY-ID = 'DCC'
 15904        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 15905        AND (CP-EARNING-METHOD = 'D' OR 'I')
 15906        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 15907        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 15908        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 15909        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 15910        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 15911        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 15912        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 15913     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 289
* EL050.cbl
 15914     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 290
* EL050.cbl
 15916
 15917 3770-CHECK-REFUNDS.
 15918
 15919     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 15920        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 15921           MOVE ER-2766          TO WS-ERROR
 15922           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15923           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 15924           IF PB-C-LF-REF-CALC LESS THAN ZERO
 15925              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 15926
 15927     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 15928        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 15929           MOVE ER-2766          TO WS-ERROR
 15930           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15931           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 15932           IF PB-C-AH-REF-CALC LESS THAN ZERO
 15933              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 15934
 15935     IF PB-COMP-LF-CANCEL
 15936        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 15937        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15938           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 15939              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 15940
 15941     IF PB-COMP-AH-CANCEL
 15942        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 15943        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 15944           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 15945              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 15946
 15947     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 15948             GIVING WS-UNSIGN-WRK1
 15949     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 15950             GIVING WS-UNSIGN-WRK2.
 15951
 15952     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 15953         MOVE ZERO TO WS-UNSIGN-WRK1.
 15954
 15955     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 15956         MOVE ZERO TO WS-UNSIGN-WRK2.
 15957
 15958     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 15959
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 291
* EL050.cbl
 15961
 15962 3772-CONTINUE.
 15963
 15964**********************************
 15965*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 15966*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 15967*** DOUBLES THE TOLERANCE AMOUNT.
 15968***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 15969**********************************
 15970     IF PB-COMPANY-ID = 'MON'
 15971     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 15972         IF WS-REF-REJECT-SW = SPACE
 15973             MOVE ER-2754        TO WS-ERROR
 15974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15975           ELSE
 15976             MOVE ER-2736        TO WS-ERROR
 15977             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15978**********************************
 15979
 15980 3773-CONTINUE.
 15981
 15982     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 15983        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15984           MOVE ER-2723          TO WS-ERROR
 15985           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15986
 15987     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 15988        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 15989           MOVE ER-2724          TO WS-ERROR
 15990           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15991
 15992     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 15993         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 15994             (1 + WS-LF-REFUND-OVS-PCT)
 15995     ELSE
 15996         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 15997
 15998     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 15999         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16000             (1 - WS-TOL-LF-REFUND-PCT)
 16001     ELSE
 16002         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16003
 16004     IF (PB-COMPANY-ID = 'DCC')
 16005        AND (PB-CI-ENTRY-STATUS = 'M')
 16006        AND (PB-C-LF-CANCEL-AMT > +0)
 16007        MOVE ER-3843             TO WS-ERROR
 16008        PERFORM 9900-ERROR-FORMAT
 16009                                 THRU 9900-EXIT
 16010     END-IF
 16011     EVALUATE TRUE
 16012        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16013           CONTINUE
 16014        WHEN PB-C-LF-CANCEL-AMT = +0
 16015                 AND PB-C-LF-REF-CALC > +0
 16016           CONTINUE
 16017        WHEN WS-LF-REFUND-OVS-AMT = 0
 16018                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 292
* EL050.cbl
 16019           CONTINUE
 16020        WHEN OTHER
 16021           IF WS-TOL-LF-REFUND  = +0
 16022              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16023           END-IF
 16024           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16025                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16026                          (PB-C-LF-CANCEL-AMT))
 16027              CONTINUE
 16028           ELSE
 16029              IF WS-LF-REFUND-OVS-AMT = +0
 16030                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16031              END-IF
 16032              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16033                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16034                                       PB-C-LF-CANCEL-AMT)
 16035                 CONTINUE
 16036              ELSE
 16037                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16038                   MOVE ER-2754   TO  WS-ERROR
 16039                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16040                 ELSE
 16041                    MOVE ER-2736   TO  WS-ERROR
 16042                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16043                 END-IF
 16044              END-IF
 16045           END-IF
 16046     END-EVALUATE.
 16047
 16048     EVALUATE TRUE
 16049        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16050           CONTINUE
 16051        WHEN PB-C-LF-CANCEL-AMT = +0
 16052                 AND PB-C-LF-REF-CALC > +0
 16053           CONTINUE
 16054        WHEN OTHER
 16055           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16056               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16057              CONTINUE
 16058           ELSE
 16059              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16060               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16061                CONTINUE
 16062              ELSE
 16063                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16064                     MOVE ER-2754   TO  WS-ERROR
 16065                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16066                 ELSE
 16067                     MOVE ER-2736   TO  WS-ERROR
 16068                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16069                 END-IF
 16070              END-IF
 16071           END-IF
 16072     END-EVALUATE.
 16073
 16074     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16075         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16076             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 293
* EL050.cbl
 16077     ELSE
 16078         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16079
 16080     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16081         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16082             (1 - WS-TOL-AH-REFUND-PCT)
 16083     ELSE
 16084         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16085
 16086     IF (PB-COMPANY-ID = 'DCC')
 16087        AND (PB-CI-ENTRY-STATUS = 'M')
 16088        AND (PB-C-AH-CANCEL-AMT > +0)
 16089        MOVE ER-3843             TO WS-ERROR
 16090        PERFORM 9900-ERROR-FORMAT
 16091                                 THRU 9900-EXIT
 16092     END-IF
 16093     EVALUATE TRUE
 16094        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16095           CONTINUE
 16096*       WHEN PB-C-AH-REF-CALC = +0 AND
 16097*                  PB-C-AH-CANCEL-AMT > +0
 16098        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16099                   PB-C-AH-REF-CALC > +0
 16100           CONTINUE
 16101        WHEN WS-AH-REFUND-OVS-AMT = +0
 16102                AND WS-TOL-AH-REFUND = +0
 16103           CONTINUE
 16104        WHEN OTHER
 16105           IF WS-TOL-AH-REFUND = +0
 16106              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16107           END-IF
 16108           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16109               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16110                                         PB-C-AH-CANCEL-AMT)
 16111              CONTINUE
 16112           ELSE
 16113              IF WS-AH-REFUND-OVS-AMT = +0
 16114                 MOVE +9999999.99 TO
 16115                         WS-AH-REFUND-OVS-AMT
 16116              END-IF
 16117              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16118                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16119                                         PB-C-AH-CANCEL-AMT)
 16120                 CONTINUE
 16121              ELSE
 16122                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16123                    MOVE ER-2754   TO  WS-ERROR
 16124                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16125                 ELSE
 16126                    MOVE ER-2736   TO  WS-ERROR
 16127                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16128                 END-IF
 16129              END-IF
 16130           END-IF
 16131     END-EVALUATE.
 16132
 16133     EVALUATE TRUE
 16134        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 294
* EL050.cbl
 16135           CONTINUE
 16136*       WHEN PB-C-AH-REF-CALC > +0 AND
 16137*                  PB-C-AH-CANCEL-AMT = +0
 16138        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16139                   PB-C-AH-REF-CALC = +0
 16140           CONTINUE
 16141        WHEN OTHER
 16142           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16143               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16144              CONTINUE
 16145           ELSE
 16146              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16147                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16148                 CONTINUE
 16149              ELSE
 16150                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16151                     MOVE ER-2754   TO  WS-ERROR
 16152                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16153                 ELSE
 16154                     MOVE ER-2736   TO  WS-ERROR
 16155                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16156                 END-IF
 16157              END-IF
 16158           END-IF
 16159     END-EVALUATE.
 16160
 16161     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16162        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16163        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16164           AND  PB-C-LF-REF-CALC < +1.00
 16165           AND  PB-C-AH-REF-CALC < +1.00
 16166           CONTINUE
 16167        ELSE
 16168           IF (PB-COMPANY-ID = 'DCC')
 16169              AND (PB-CI-ENTRY-STATUS = 'M')
 16170              CONTINUE
 16171           ELSE
 16172              MOVE ER-2741       TO WS-ERROR
 16173              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16174           END-IF
 16175        END-IF
 16176     END-IF
 16177
 16178     IF (PB-C-LF-CANCEL-AMT = ZERO
 16179        AND WS-LF-BENEFIT-CD NOT = ZERO
 16180        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16181        AND PB-C-LF-REF-CALC NOT = ZERO)
 16182        OR
 16183        (PB-C-LF-CANCEL-AMT = ZERO
 16184        AND WS-LF-BENEFIT-CD NOT = ZERO
 16185        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16186             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16187                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16188                NEXT SENTENCE
 16189             ELSE
 16190                MOVE ER-2739        TO WS-ERROR
 16191                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16192
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 295
* EL050.cbl
 16193     IF (PB-C-AH-CANCEL-AMT = ZERO
 16194        AND WS-AH-BENEFIT-CD NOT = ZERO
 16195        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16196        AND PB-C-AH-REF-CALC NOT = ZERO)
 16197        OR
 16198        (PB-C-AH-CANCEL-AMT = ZERO
 16199        AND WS-AH-BENEFIT-CD NOT = ZERO
 16200        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16201             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16202                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16203                NEXT SENTENCE
 16204             ELSE
 16205                MOVE ER-2738        TO WS-ERROR
 16206                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16207
 16208 3775-OVER-REF-CHK.
 16209
 16210     IF PB-CI-ENTRY-STATUS = '5'
 16211        GO TO 3780-UPDATE-CANCEL-CERT.
 16212
 16213     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16214                              PB-CI-LF-ALT-PREMIUM-AMT.
 16215
 16216     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16217        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16218                                 PB-C-LF-REF-CALC
 16219      ELSE
 16220        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16221                                 PB-C-LF-CANCEL-AMT.
 16222
 16223     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16224        MOVE ER-2755             TO WS-ERROR
 16225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16226
 16227     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16228
 16229     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16230        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16231                                 PB-C-AH-REF-CALC
 16232      ELSE
 16233        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16234                                 PB-C-AH-CANCEL-AMT.
 16235
 16236     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16237        MOVE ER-2778             TO WS-ERROR
 16238        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16239
 16240     IF PB-CI-OB-FLAG NOT = 'Z'
 16241        NEXT SENTENCE
 16242       ELSE
 16243         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16244            MOVE ER-2757           TO WS-ERROR
 16245            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16246
 16247 3780-UPDATE-CANCEL-CERT.
 16248
 16249     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16250        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 296
* EL050.cbl
 16251        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16252
 16253     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16254         MOVE ER-2729              TO WS-ERROR
 16255         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16256
 16257     IF PB-CI-LF-BENEFIT-CD = ZERO
 16258         GO TO 3780-UPDATE-CONT-1.
 16259
 16260     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16261         GO TO 3780-UPDATE-CONT-1.
 16262
 16263     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16264       AND
 16265        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16266       AND
 16267        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16268       AND
 16269        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16270            NEXT SENTENCE
 16271       ELSE
 16272        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16273          AND
 16274***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16275***       AND
 16276           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16277            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16278               MOVE ER-2730      TO WS-ERROR
 16279               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16280               GO TO 3999-END-EDIT
 16281            ELSE
 16282               GO TO 3999-END-EDIT
 16283        ELSE
 16284            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16285               MOVE ER-2765           TO WS-ERROR
 16286               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16287               GO TO 3785-CHECK-NH.
 16288*              GO TO 3999-END-EDIT.
 16289
 16290 3780-UPDATE-CONT-1.
 16291     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16292
 16293     IF PB-CI-AH-BENEFIT-CD = ZERO
 16294         GO TO 3780-UPDATE-CONT-2.
 16295
 16296     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16297         GO TO 3780-UPDATE-CONT-2.
 16298
 16299     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16300
 16301     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16302       AND
 16303        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16304       AND
 16305        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16306       AND
 16307        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16308            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 297
* EL050.cbl
 16309       ELSE
 16310        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16311          AND
 16312***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16313***       AND
 16314           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16315           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16316            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16317               MOVE ER-2773      TO WS-ERROR
 16318               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16319               GO TO 3999-END-EDIT
 16320            ELSE
 16321               GO TO 3999-END-EDIT
 16322            END-IF
 16323           ELSE
 16324             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16325                MOVE ER-2890 TO WS-ERROR
 16326                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16327                GO TO 3999-END-EDIT
 16328             ELSE
 16329                GO TO 3785-CHECK-NH
 16330             END-IF
 16331           END-IF
 16332          ELSE
 16333            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16334              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16335                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16336                   MOVE ER-2890 TO WS-ERROR
 16337                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16338                   GO TO 3999-END-EDIT
 16339                ELSE
 16340                   MOVE ER-2765 TO WS-ERROR
 16341                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16342                   GO TO 3785-CHECK-NH
 16343                END-IF
 16344              ELSE
 16345               MOVE ER-2765      TO WS-ERROR
 16346               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16347               GO TO 3785-CHECK-NH.
 16348*              GO TO 3999-END-EDIT.
 16349
 16350 3780-UPDATE-CONT-2.
 16351
 16352     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16353        AND WS-LF-BENEFIT-CD = ZERO
 16354           MOVE ER-2743           TO WS-ERROR
 16355           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16356
 16357     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16358        AND WS-AH-BENEFIT-CD = ZERO
 16359           MOVE ER-2744           TO WS-ERROR
 16360           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16361
 16362     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16363        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16364        AND
 16365        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16366         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 298
* EL050.cbl
 16367           MOVE ER-2746           TO WS-ERROR
 16368           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16369
 16370     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16371       AND
 16372        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16373             MOVE ER-2737        TO WS-ERROR
 16374             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16375
 16376     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16377       AND
 16378        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16379             MOVE ER-2737        TO WS-ERROR
 16380             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16381
 16382     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16383         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16384             OR 'CID' OR 'DCC'
 16385             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16386         ELSE
 16387             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16388                 MOVE ER-2768    TO WS-ERROR
 16389                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16390             ELSE
 16391                 MOVE ER-2756    TO WS-ERROR
 16392                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16393
 16394     IF CERT-PEND-ISSUE-RETURNED
 16395        MOVE ER-2772             TO WS-ERROR
 16396        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16397 3785-CHECK-NH.
 16398     IF PB-STATE NOT = 'NH'
 16399        GO TO 3999-END-EDIT
 16400     END-IF
 16401
 16402     MOVE ER-2796                TO WS-ERROR
 16403     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16404     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16405        OR (CM-NH-INTERFACE-SW = 'Y')
 16406        MOVE ER-2793             TO WS-ERROR
 16407        PERFORM 9900-ERROR-FORMAT
 16408                                 THRU 9900-EXIT
 16409     END-IF
 16410     MOVE +0                     TO WS-PAYMENT-AMT
 16411     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16412        GO TO 3999-END-EDIT
 16413     END-IF
 16414     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16415        GO TO 3999-END-EDIT
 16416     END-IF
 16417     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16418     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16419     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16420        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16421     END-IF
 16422     MOVE '1'                    TO DC-OPTION-CODE
 16423     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16424     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 299
* EL050.cbl
 16425        IF DC-ELAPSED-DAYS < +16
 16426           GO TO 3999-END-EDIT
 16427        END-IF
 16428     END-IF
 16429     MOVE +0                     TO DC-ELAPSED-DAYS
 16430     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16431     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16432     MOVE '1'                    TO DC-OPTION-CODE
 16433     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16434     IF NO-CONVERSION-ERROR
 16435        IF DC-ELAPSED-DAYS > +30
 16436           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16437        ELSE
 16438           GO TO 3999-END-EDIT
 16439        END-IF
 16440     ELSE
 16441        GO TO 3999-END-EDIT
 16442     END-IF
 16443     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16444        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16445           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16446     IF WS-PAYMENT-AMT < 600.00
 16447        GO TO 3999-END-EDIT
 16448     END-IF
 16449     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16450
 16451     IF (ERMAIL-FOUND = ' ')
 16452         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16453         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16454        GO TO 3999-END-EDIT
 16455     END-IF
 16456     MOVE ER-2795                TO WS-ERROR
 16457     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16458
 16459     GO TO 3999-END-EDIT.
 16460******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 300
* EL050.cbl
 16462 3990-FILES-NOT-OPEN.
 16463
 16464     MOVE ER-2617                TO WS-ERROR.
 16465     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16466     GO TO 9990-RETURN.
 16467
 16468 3999-END-EDIT.
 16469
 16470     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16471
 16472     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16473         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16474         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16475             PERFORM 9250-UNLOCK-RETURN
 16476             GO TO 9990-RETURN
 16477          ELSE
 16478             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16479             GO TO 9990-RETURN.
 16480
 16481     IF PB-CANCELLATION
 16482          GO TO 9990-RETURN.
 16483
 16484     IF CERT-WAS-NOT-FOUND
 16485        MOVE SPACES              TO CERTIFICATE-MASTER.
 16486
 16487     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 16488
 16489     IF CERT-WAS-FOUND
 16490         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16491             PERFORM 9250-UNLOCK-RETURN
 16492          ELSE
 16493            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16494      ELSE
 16495         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 16496
 16497     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 16498        IF PB-COMPANY-ID = 'DCC' AND
 16499           (PB-CARRIER = '2' OR '4' OR '6')
 16500              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 16501        END-IF
 16502     END-IF.
 16503
 16504     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 16505     IF ((PB-COMPANY-ID = 'DCC')
 16506        AND (WS-NO-SECURE-PAY))
 16507                  OR
 16508        (WS-LF-SPECIAL-CALC-CD = 'O'
 16509        OR WS-AH-SPECIAL-CALC-CD = 'O')
 16510        SET SKIP-ADDR-EDIT       TO TRUE
 16511     END-IF
 16512     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 16513        AND (NOT SKIP-ADDR-EDIT)
 16514        MOVE ER-2963             TO WS-ERROR
 16515        PERFORM 9900-ERROR-FORMAT
 16516                                 THRU 9900-EXIT
 16517        GO TO 9990-RETURN
 16518     END-IF
 16519     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 301
* EL050.cbl
 16520     IF ERPNDM-FOUND NOT = 'X'
 16521        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 16522           OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
 16523           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 16524           AND (NOT SKIP-ADDR-EDIT)
 16525           MOVE ER-2694          TO WS-ERROR
 16526           PERFORM 9900-ERROR-FORMAT
 16527                                 THRU 9900-EXIT
 16528        END-IF
 16529        MOVE ' '                 TO STATE-RECORD-ERROR
 16530        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16531        MOVE PM-STATE            TO CNTL-ACCESS
 16532        MOVE '3'                 TO CNTL-REC-TYPE
 16533        MOVE +0                  TO CNTL-SEQ-NO
 16534        MOVE '0'                 TO RC-SW-2
 16535        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16536        IF (NO-STATE-RECORD)
 16537           OR (CF-RECORD-TYPE NOT = '3')
 16538           OR (PM-STATE NOT = CF-STATE-CODE)
 16539           IF (PM-STATE = SPACES)
 16540              AND (SKIP-ADDR-EDIT)
 16541              CONTINUE
 16542           ELSE
 16543              MOVE ER-2963       TO WS-ERROR
 16544              PERFORM 9900-ERROR-FORMAT
 16545                                 THRU 9900-EXIT
 16546           END-IF
 16547        END-IF
 16548        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 16549           MOVE ER-2883          TO WS-ERROR
 16550           PERFORM 9900-ERROR-FORMAT
 16551                                 THRU 9900-EXIT
 16552        END-IF
 16553        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 16554           MOVE ' '                 TO STATE-RECORD-ERROR
 16555           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 16556           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 16557           MOVE '3'                 TO CNTL-REC-TYPE
 16558           MOVE +0                  TO CNTL-SEQ-NO
 16559           MOVE '0'                 TO RC-SW-2
 16560           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 16561           IF NO-STATE-RECORD
 16562              OR (CF-RECORD-TYPE NOT = '3')
 16563              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 16564              MOVE ER-2964          TO WS-ERROR
 16565              PERFORM 9900-ERROR-FORMAT
 16566                                    THRU 9900-EXIT
 16567           END-IF
 16568        END-IF
 16569     ELSE
 16570        IF NOT SKIP-ADDR-EDIT
 16571           MOVE ER-2393          TO WS-ERROR
 16572           PERFORM 9900-ERROR-FORMAT
 16573                                 THRU 9900-EXIT
 16574        END-IF
 16575     END-IF
 16576
 16577     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 302
* EL050.cbl
 16578
 16579     IF (ERMAIL-FOUND = ' ' AND
 16580        ERPNDM-FOUND = ' ')
 16581        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 16582           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 16583           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 16584          OR
 16585           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 16586          OR
 16587           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 16588           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 16589           GO TO 3999-UNLOCK-ERMAIL.
 16590
 16591     IF ERPNDM-FOUND = 'X'
 16592        GO TO 3999-UNLOCK-ERMAIL.
 16593
 16594     IF PM-INSURED-LAST-NAME      = SPACES
 16595        AND PM-INSURED-FIRST-NAME = SPACES
 16596        AND PM-ADDRESS-LINE-1     = SPACES
 16597        AND PM-ADDRESS-LINE-2     = SPACES
 16598        AND PM-CITY-STATE         = SPACES
 16599        AND PM-CRED-BENE-NAME     = SPACES
 16600        AND PM-CRED-BENE-ADDR     = SPACES
 16601        AND PM-CRED-BENE-CTYST    = SPACES
 16602        GO TO 3999-UNLOCK-ERMAIL
 16603     END-IF
 16604
 16605     MOVE SPACES                 TO MAILING-DATA.
 16606
 16607     MOVE 'MA'                   TO MA-RECORD-ID.
 16608     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 16609     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 16610     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 16611     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 16612     MOVE PB-SV-STATE            TO MA-STATE.
 16613     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 16614     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 16615
 16616     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 16617     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 16618
 16619     IF ERMAIL-FOUND = ' '
 16620        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 16621     ELSE
 16622        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 16623        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 16624        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 16625
 16626     GO TO 9990-RETURN.
 16627
 16628 3999-UNLOCK-ERMAIL.
 16629     IF ERMAIL-FOUND = ' '
 16630        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 16631
 16632     GO TO 9990-RETURN.
 16633******************************************************************
 16634
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 303
* EL050.cbl
 16636 4000-UPDATE-CANCELLED-CERT.
 16637     IF CERT-WAS-NOT-FOUND
 16638        GO TO 4299-EXIT.
 16639
 16640*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 16641     IF PB-C-NH-INT-ON-REFS > ZEROS
 16642        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 16643     END-IF
 16644     IF PB-C-REF-INTERFACE-SW = 'Y'
 16645        MOVE PB-C-REF-INTERFACE-SW
 16646                                 TO CM-NH-INTERFACE-SW
 16647     END-IF
 16648     IF PB-C-POST-CARD-IND = 'Y'
 16649        MOVE +8                  TO SUB
 16650        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 16651        IF ERMAIL-FOUND = ' '
 16652           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 16653              (SUB > +7)
 16654              OR (MA-MAIL-STATUS (SUB) = '1')
 16655           END-PERFORM
 16656        END-IF
 16657        IF (SUB > +7)
 16658           OR (ERMAIL-FOUND = 'X')
 16659           MOVE ER-3789          TO WS-ERROR
 16660           PERFORM 9900-ERROR-FORMAT
 16661                                 THRU 9900-EXIT
 16662        END-IF
 16663     ELSE
 16664        MOVE 'N'                 TO PB-C-POST-CARD-IND
 16665     END-IF
 16666     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 16667
 16668     IF PB-CI-OB-FLAG = 'Z'
 16669        GO TO 4150-SUMMARY-CERT-CANCEL.
 16670
 16671     IF PB-C-LF-CANCEL-VOIDED
 16672         PERFORM 4200-REVERSE-LF-CANCEL.
 16673     IF PB-C-AH-CANCEL-VOIDED
 16674         PERFORM 4200-REVERSE-AH-CANCEL.
 16675
 16676 4100-APPLY-LF-CANCEL.
 16677
 16678     MOVE +0                     TO WS-SUB.
 16679
 16680 4100-CHECK-LF-ERRORS.
 16681
 16682     ADD +1                       TO WS-SUB.
 16683
 16684     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16685        IF LF-COVERAGE-CANCELLED
 16686           GO TO 4100-LF-CANCEL-CONT
 16687        ELSE
 16688           GO TO 4100-UPDATE-LF-COVERAGE.
 16689
 16690     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16691                                   ER-2729 OR
 16692                                   ER-2730 OR
 16693                                   ER-2731 OR
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 304
* EL050.cbl
 16694                                   ER-2732 OR
 16695                                   ER-2737 OR
 16696                                   ER-2740 OR
 16697                                   ER-2743 OR
 16698                                   ER-2749 OR
 16699                                   ER-2750 OR
 16700                                   ER-2755 OR
 16701                                   ER-2757 OR
 16702                                   ER-2760 OR
 16703                                   ER-2772 OR
 16704                                   ER-2774 OR
 16705                                   ER-2776 OR
 16706                                   ER-2794
 16707        GO TO 4100-UPDATE-LF-COVERAGE.
 16708
 16709     GO TO 4100-CHECK-LF-ERRORS.
 16710
 16711 4100-UPDATE-LF-COVERAGE.
 16712
 16713     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 16714     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 16715     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 16716        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 16717     END-IF
 16718     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16719                                      TO CM-CREDIT-INTERFACE-SW-2.
 16720     IF CM-LF-CANCEL-DT = LOW-VALUE
 16721         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 16722
 16723     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 16724         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 16725                                         CM-LF-STATUS-AT-CANCEL.
 16726
 16727     GO TO 4100-APPLY-AH-CANCEL.
 16728
 16729 4100-LF-CANCEL-CONT.
 16730     IF PB-C-LF-CANCEL-VOIDED
 16731         GO TO 4100-APPLY-AH-CANCEL.
 16732
 16733     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16734         GO TO 4100-APPLY-AH-CANCEL.
 16735
 16736     IF PB-C-LF-CANCEL-AMT GREATER ZERO
 16737        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16738           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 16739        ELSE
 16740           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 16741
 16742     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 16743     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 16744
 16745     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 16746         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 16747
 16748     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 16749        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 16750         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 16751         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 305
* EL050.cbl
 16752
 16753     IF PB-RECORD-RETURNED
 16754        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16755      ELSE
 16756        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 16757
 16758 4100-APPLY-AH-CANCEL.
 16759
 16760     MOVE +0                      TO WS-SUB.
 16761
 16762 4100-CHECK-AH-ERRORS.
 16763
 16764     ADD +1                       TO WS-SUB.
 16765
 16766     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 16767        IF AH-COVERAGE-CANCELLED
 16768           GO TO 4100-AH-CANCEL-CONT
 16769        ELSE
 16770           GO TO 4100-UPDATE-AH-COVERAGE.
 16771
 16772     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 16773                                   ER-2729 OR
 16774                                   ER-2732 OR
 16775                                   ER-2737 OR
 16776                                   ER-2740 OR
 16777                                   ER-2744 OR
 16778                                   ER-2749 OR
 16779                                   ER-2750 OR
 16780                                   ER-2755 OR
 16781                                   ER-2757 OR
 16782                                   ER-2760 OR
 16783                                   ER-2771 OR
 16784                                   ER-2772 OR
 16785                                   ER-2773 OR
 16786                                   ER-2775 OR
 16787                                   ER-2777 OR
 16788                                   ER-2794
 16789        GO TO 4100-UPDATE-AH-COVERAGE.
 16790
 16791     GO TO 4100-CHECK-AH-ERRORS.
 16792
 16793 4100-UPDATE-AH-COVERAGE.
 16794
 16795     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 16796     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 16797     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 16798     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 16799                                      TO CM-CREDIT-INTERFACE-SW-2.
 16800     IF CM-AH-CANCEL-DT = LOW-VALUE
 16801         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 16802
 16803     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 16804         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 16805                                         CM-AH-STATUS-AT-CANCEL.
 16806
 16807     IF LF-COVERAGE-CANCELLED
 16808         IF PB-RECORD-RETURNED
 16809              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 306
* EL050.cbl
 16810          ELSE
 16811              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 16812
 16813     GO TO 4299-EXIT.
 16814
 16815 4100-AH-CANCEL-CONT.
 16816     IF PB-C-AH-CANCEL-VOIDED
 16817         GO TO 4299-EXIT.
 16818
 16819     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 16820         GO TO 4299-EXIT.
 16821
 16822     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 16823        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16824           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 16825        ELSE
 16826           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 16827
 16828     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 16829     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 16830
 16831     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 16832         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 16833
 16834     IF CM-AH-STATUS-AT-CANCEL = SPACE
 16835         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 16836         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 16837
 16838     IF PB-RECORD-RETURNED
 16839        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 16840      ELSE
 16841        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 16842
 16843     GO TO 4299-EXIT.
 16844
 16845 4150-SUMMARY-CERT-CANCEL.
 16846     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 16847
 16848     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16849        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16850                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 16851     ELSE
 16852        COMPUTE CM-LF-ITD-CANCEL-AMT =
 16853                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 16854
 16855     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16856        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16857                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 16858     ELSE
 16859        COMPUTE CM-AH-ITD-CANCEL-AMT =
 16860                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 16861
 16862     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16863        NEXT SENTENCE
 16864     ELSE
 16865        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 16866
 16867     GO TO 4299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 307
* EL050.cbl
 16868
 16869 4200-REVERSE-LF-CANCEL.
 16870     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 16871
 16872     IF CM-LF-CANCEL-APPLIED
 16873        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 16874        MOVE SPACES                TO CM-LF-EXIT-BATCH
 16875        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 16876
 16877     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 16878
 16879     IF PB-RECORD-RETURNED
 16880        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16881       ELSE
 16882        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16883
 16884 4200-REVERSE-LF-EXIT.
 16885       EXIT.
 16886
 16887 4200-REVERSE-AH-CANCEL.
 16888     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 16889
 16890     IF CM-AH-CANCEL-APPLIED
 16891        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 16892        MOVE SPACES                TO CM-AH-EXIT-BATCH
 16893        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 16894
 16895     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 16896
 16897     IF PB-RECORD-RETURNED
 16898        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 16899       ELSE
 16900        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 16901
 16902 4200-REVERSE-AH-EXIT.
 16903       EXIT.
 16904
 16905 4299-EXIT.
 16906       EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 308
* EL050.cbl
 16908
 16909 4500-UPDATE-NEW-CERT.
 16910     IF CERT-WAS-FOUND
 16911         NEXT SENTENCE
 16912       ELSE
 16913         GO TO 4520-BUILD-NEW-KEY.
 16914
 16915     IF  CLASIC-CREATED-CERT
 16916         GO TO 4999-EXIT.
 16917
 16918     IF  CERT-WAS-CREATED-FOR-CLAIM
 16919         GO TO 4520-BUILD-NEW-KEY.
 16920
 16921     IF CERT-ADDED-BATCH
 16922        IF CM-RECORD-ID = 'CM'
 16923            GO TO 4999-EXIT.
 16924
 16925 4520-BUILD-NEW-KEY.
 16926* BUILD CONTROL PRIMARY
 16927
 16928     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 16929                                       CM-COMPANY-CD-A1
 16930                                       CM-COMPANY-CD-A2
 16931                                       CM-COMPANY-CD-A4
 16932                                       CM-COMPANY-CD-A5.
 16933
 16934     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 16935     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 16936     MOVE PB-SV-STATE               TO CM-STATE.
 16937     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 16938     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 16939     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 16940     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 16941
 16942     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 16943
 16944     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 16945     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 16946     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 16947     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 16948
 16949     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 16950        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 16951
 16952     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 16953         MOVE PB-SV-STATE            TO CM-SSN-STATE
 16954         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 16955         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 16956         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 16957     ELSE
 16958         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 16959
 16960     IF PB-COMPANY-ID   EQUAL  'CRI'
 16961         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 16962         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 16963         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 16964         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 16965         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 309
* EL050.cbl
 16966
 16967     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 16968        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 16969         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 16970
 16971     IF PB-COMPANY-ID  = 'LBL'
 16972        IF PB-I-JOINT-COVERAGE
 16973            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 16974                                           PB-I-MEMBER-NO
 16975            GO TO 4550-CONT-CERT-PROCESS.
 16976
 16977     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 16978        NEXT SENTENCE
 16979     ELSE
 16980        GO TO 4540-BUILD-MEMBER-NO.
 16981
 16982******************************************************************
 16983*                                                                *
 16984*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 16985*    FOR 'MON'.                                                  *
 16986*                                                                *
 16987******************************************************************
 16988
 16989     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 16990     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 16991     MOVE +1                     TO WS-SUB1
 16992                                    WS-SUB2.
 16993
 16994 4530-EDIT-MEMB-NAME.
 16995
 16996     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 16997        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 16998        ADD +1                       TO WS-SUB2.
 16999
 17000     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17001        ADD +1                       TO WS-SUB1
 17002        GO TO 4530-EDIT-MEMB-NAME.
 17003
 17004     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17005     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17006     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17007*    MOVE SPACE                      TO DC-OPTION-CODE.
 17008     SET  BIN-TO-GREG                TO TRUE.
 17009     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17010     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17011
 17012     GO TO 4550-CONT-CERT-PROCESS.
 17013
 17014******************************************************************
 17015*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17016******************************************************************
 17017
 17018 4540-BUILD-MEMBER-NO.
 17019
 17020     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17021         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17022         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17023         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 310
* EL050.cbl
 17024         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17025     ELSE
 17026         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17027
 17028     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17029        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17030         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17031
 17032 4550-CONT-CERT-PROCESS.
 17033
 17034*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17035*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17036*    ELSE
 17037*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17038
 17039     IF CERT-WAS-CREATED-FOR-CLAIM
 17040        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17041        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17042
 17043     IF CERT-AND-CLAIM-ONLINE
 17044        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17045        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17046
 17047     MOVE 'CM'                     TO CM-RECORD-ID.
 17048     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17049
 17050     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17051        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17052        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17053     ELSE
 17054        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17055        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17056
 17057     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17058     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17059     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17060     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17061     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17062     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17063     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17064                                      CM-LF-ITD-CANCEL-AMT
 17065                                      CM-LF-ITD-DEATH-AMT
 17066                                      CM-AH-ITD-AH-PMT
 17067                                      CM-AH-ITD-LUMP-PMT
 17068                                      CM-AH-ITD-CANCEL-AMT
 17069                                      CM-LF-NSP-PREMIUM-AMT
 17070                                      CM-AH-NSP-PREMIUM-AMT.
 17071*                                     CM-CLAIM-DEDUCT-WITHHELD
 17072*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17073     MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
 17074     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17075     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17076     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17077     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
 17078     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17079     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17080     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17081     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 311
* EL050.cbl
 17082     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17083     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17084     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17085
 17086     IF PB-I-LIVES NOT NUMERIC
 17087         MOVE ZERO                 TO PB-I-LIVES.
 17088
 17089     IF PB-I-NUM-BILLED NOT NUMERIC
 17090         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17091
 17092     MOVE PB-I-LIVES               TO CM-LIVES.
 17093     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17094
 17095     IF PB-COMPANY-ID EQUAL  'DMD'
 17096         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17097         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17098
 17099     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17100     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17101     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17102     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17103     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17104     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17105
 17106     IF PB-I-LF-POLICY-FEE NUMERIC
 17107        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17108     ELSE
 17109        MOVE +0                    TO CM-LF-POLICY-FEE.
 17110
 17111     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17112        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17113        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17114     ELSE
 17115        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17116
 17117     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17118     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17119     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17120     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17121     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17122     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17123     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17124     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17125     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17126
 17127     IF PB-I-AH-POLICY-FEE NUMERIC
 17128        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17129     ELSE
 17130        MOVE +0                    TO CM-AH-POLICY-FEE.
 17131
 17132     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17133        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17134     ELSE
 17135        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 17136
 17137     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17138     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17139
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 312
* EL050.cbl
 17140     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17141                                      CM-LF-DEATH-EXIT-DT
 17142                                      CM-AH-SETTLEMENT-EXIT-DT.
 17143
 17144*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17145*                       'TIH' OR 'OFL' OR 'FLA' OR
 17146*                       'TII' OR 'TMS' OR 'CRI' OR
 17147*                       'NCL'
 17148     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17149
 17150     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17151         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17152            MOVE '2'                TO CM-PREMIUM-TYPE.
 17153
 17154     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17155         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17156            MOVE '2'                TO CM-PREMIUM-TYPE.
 17157
 17158     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17159         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17160     ELSE
 17161         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17162         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17163
 17164     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17165     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17166     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17167     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17168     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17169     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17170     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17171     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17172
 17173     IF PB-NO-MONTHS-SKIPPED
 17174         MOVE SPACE                 TO CM-SKIP-CODE
 17175     ELSE
 17176         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17177
 17178     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17179     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17180                                       CM-LF-STATUS-AT-CANCEL.
 17181
 17182     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17183     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17184                                       CM-AH-STATUS-AT-CANCEL.
 17185
 17186     MOVE '1'                       TO CM-ENTRY-STATUS.
 17187
 17188     IF PB-REISSUED-CERT
 17189        MOVE '5'                    TO CM-ENTRY-STATUS.
 17190
 17191     IF PB-MONTHLY-CERT
 17192        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17193
 17194     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17195     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17196     IF PB-POLICY-IS-DECLINED
 17197        MOVE 'D'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 313
* EL050.cbl
 17198
 17199     IF PB-POLICY-IS-VOIDED
 17200        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17201
 17202     IF PB-NEEDS-UNDERWRITING
 17203        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17204
 17205     IF PB-REIN-ONLY-CERT
 17206        MOVE '9'                    TO CM-ENTRY-STATUS.
 17207
 17208     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17209         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17210     ELSE
 17211         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17212
 17213     IF PB-RECORD-RETURNED
 17214        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17215      ELSE
 17216        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17217
 17218     IF PB-I-MAIL-ADDRS-PRESENT
 17219        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17220
 17221     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17222                                       CM-ENTRY-DT.
 17223
 17224 4999-EXIT.
 17225     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 314
* EL050.cbl
 17227
 17228 5000-PROCESS-REPS.
 17229     MOVE ' '                    TO AGTC-MASTER-SW
 17230     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17231     MOVE CO-TYPE                TO AGTC-TYPE
 17232     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17233     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17234     IF (AGTC-MASTER-SW NOT = 'N')
 17235        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17236        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17237        PERFORM 8583-READ-ERAGTC-NEXT
 17238                                 THRU 8583-EXIT
 17239     END-IF
 17240     IF AGTC-MASTER-SW = 'N'
 17241        CONTINUE
 17242     ELSE
 17243        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17244           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17245              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17246              MOVE 'Y'           TO AGTC-MASTER-SW
 17247           END-IF
 17248        END-IF
 17249     END-IF
 17250     .
 17251 5000-EXIT.
 17252     EXIT.
 17253 6370-EDIT-INPUT-LF-CODE.
 17254     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17255        MOVE +1                  TO SUB
 17256        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17257        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17258        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17259        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17260        GO TO 6370-SEARCH-LOOP.
 17261
 17262     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17263
 17264     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17265     MOVE SPACES                 TO CNTL-ACCESS.
 17266*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17267     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17268     MOVE +0                     TO CNTL-SEQ-NO.
 17269     MOVE '4' TO RC-SW-2.
 17270     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17271
 17272     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17273        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17274        GO TO 6370-NO-LF-FOUND.
 17275
 17276     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17277     MOVE +1                     TO SUB.
 17278
 17279 6370-SEARCH-LOOP.
 17280     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17281         GO TO 6370-NO-LF-FOUND.
 17282
 17283     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
 17284         MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 315
* EL050.cbl
 17285         GO TO 6370-HER-NET-PAY-CHECK.
 17286
 17287     ADD 1   TO SUB.
 17288*    IF SUB GREATER 120
 17289     IF SUB GREATER 200
 17290         GO TO 6370-NO-LF-FOUND.
 17291
 17292     GO TO 6370-SEARCH-LOOP.
 17293
 17294 6370-NO-LF-FOUND.
 17295
 17296     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17297
 17298 6370-HER-NET-PAY-CHECK.
 17299
 17300     IF PB-COMPANY-ID = 'CID'
 17301        IF PB-SV-STATE = 'CA' OR 'MN'
 17302           IF PB-I-LF-BENEFIT-CD = '02'
 17303              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17304           ELSE
 17305              IF PB-I-LF-BENEFIT-CD = '04'
 17306                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17307              END-IF
 17308           END-IF
 17309        END-IF
 17310     END-IF
 17311
 17312     IF PB-COMPANY-ID NOT = 'HER'
 17313         GO TO 6370-EXIT.
 17314
 17315     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17316         GO TO 6370-EXIT.
 17317
 17318     IF PB-I-LF-TERM NOT NUMERIC
 17319         MOVE ZEROS              TO PB-I-LF-TERM.
 17320
 17321     IF PB-I-LOAN-TERM NOT NUMERIC
 17322         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17323
 17324     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17325         GO TO 6370-EXIT.
 17326
 17327     IF PB-I-LF-BENEFIT-CD = '33'
 17328         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17329
 17330     IF PB-I-LF-BENEFIT-CD = '34'
 17331         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17332
 17333 6370-EXIT.
 17334     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 316
* EL050.cbl
 17336
 17337 6380-EDIT-INPUT-AH-CODE.
 17338     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17339        MOVE +1                  TO SUB
 17340        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17341        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17342        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17343        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17344        GO TO 6380-SEARCH-LOOP.
 17345
 17346     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17347
 17348     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17349     MOVE SPACES                 TO CNTL-ACCESS.
 17350     MOVE 'A'                    TO CNTL-REC-TYPE.
 17351*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17352     MOVE +0                     TO CNTL-SEQ-NO.
 17353     MOVE '5' TO RC-SW-2.
 17354     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17355
 17356     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17357        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17358        GO TO 6380-NO-AH-FOUND.
 17359
 17360     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17361     MOVE +1 TO SUB.
 17362
 17363 6380-SEARCH-LOOP.
 17364     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17365         GO TO 6380-NO-AH-FOUND.
 17366
 17367     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17368         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17369         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17370
 17371     ADD 1   TO SUB.
 17372     IF SUB GREATER THAN 96
 17373*    IF SUB GREATER THAN 300
 17374         GO TO 6380-NO-AH-FOUND.
 17375
 17376     GO TO 6380-SEARCH-LOOP.
 17377
 17378 6380-NO-AH-FOUND.
 17379
 17380     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17381
 17382     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17383         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17384     ELSE
 17385         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17386
 17387 6380-CSO-AH-ONLY-CHECKS.
 17388
 17389     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17390        NEXT SENTENCE
 17391      ELSE
 17392        GO TO 6380-EXIT.
 17393
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 317
* EL050.cbl
 17394     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17395         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17396
 17397
 17398     GO TO 6380-EXIT
 17399     .
 17400 6380-CSO-LIFE-WITH-AH-CHECKS.
 17401
 17402
 17403     .
 17404 6380-EXIT.
 17405     EXIT.
 17406
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 318
* EL050.cbl
 17408
 17409 6400-COMPUTE-EXTENSION-DAYS.
 17410
 17411******************************************************************
 17412*                                                                *
 17413*                   COMPUTE EXTENSION DAYS                       *
 17414*                                                                *
 17415*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17416*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17417*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17418*    THE EXTENSION DAYS.                                         *
 17419*                                                                *
 17420******************************************************************
 17421
 17422     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17423     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17424
 17425******************************************************************
 17426*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17427*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17428******************************************************************
 17429
 17430     IF DC-ELAPSED-MONTHS GREATER THAN +0
 17431        COMPUTE WS-ODD-DAYS-OVER =
 17432               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 17433     ELSE
 17434        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 17435
 17436     IF WS-ODD-DAYS-OVER = ZEROS
 17437           GO TO 6499-EXIT
 17438     ELSE
 17439        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 17440           IF WS-WDF-MONTH = 02
 17441              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 17442              ADD 2       TO  WS-ODD-DAYS-OVER
 17443              GO TO 6499-EXIT
 17444           ELSE
 17445              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 17446                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 17447                 GO TO 6499-EXIT
 17448               ELSE
 17449                 GO TO 6499-EXIT
 17450        ELSE
 17451           GO TO 6499-EXIT.
 17452
 17453 6412-CHECK-TO-DAY.
 17454
 17455        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 17456           IF WS-WDT-DAY = 28
 17457              ADD 2              TO WS-ODD-DAYS-OVER
 17458           ELSE
 17459              IF WS-WDT-DAY = 29
 17460                 ADD 1           TO WS-ODD-DAYS-OVER
 17461              ELSE
 17462                 NEXT SENTENCE
 17463        ELSE
 17464           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 17465              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 319
* EL050.cbl
 17466
 17467     GO TO 6499-EXIT.
 17468
 17469
 17470 6415-CHECK-LEAP-YEAR.
 17471
 17472     IF DC-DAYS-IN-MONTH = 29
 17473        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 17474
 17475 6415-EXIT.
 17476     EXIT.
 17477
 17478 6499-EXIT.
 17479      EXIT.
 17480
 17481 6500-END.
 17482     EXIT.
 17483
 17484
 17485******************************************************************
 17486************* PROCEDURE DIVISION FOR EL050 ***********************
 17487********************** ELC50PD END *******************************
 17488
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 320
* EL050.cbl
 17490
 17491**START***********************************************************
 17492*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 17493*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 17494******************************************************************
 17495*
 17496 6600-GET-STATE-MUNICIPAL-TAX.
 17497
 17498     IF PB-COMPANY-ID NOT = 'DMD'
 17499         GO TO 6640-EXIT.
 17500
 17501     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 17502     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 17503     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 17504*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 17505*
 17506***  Y2K PROJ 7744
 17507     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17508     SET BIN-TO-GREG          TO TRUE.
 17509     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17510
 17511     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17512
 17513     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 17514     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 17515
 17516
 17517* EXEC CICS HANDLE CONDITION
 17518*        INVREQ    (6610-START-BROWSE)
 17519*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17520*        NOTFND    (6630-END-OF-FILE)
 17521*    END-EXEC.
 17522*    MOVE '"$8JI                 ! # #00017504' TO DFHEIV0
 17523     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 17524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17525     MOVE X'2320233030303137353034' TO DFHEIV0(25:11)
 17526     CALL 'kxdfhei1' USING DFHEIV0
 17527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17528
 17529
 17530 6610-START-BROWSE.
 17531
 17532
 17533* EXEC CICS HANDLE CONDITION
 17534*        NOTFND    (6630-END-OF-FILE)
 17535*        DISABLED  (6630-ERRESS-PROBLEM)
 17536*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17537*        ENDFILE   (6630-END-OF-FILE)
 17538*    END-EXEC.
 17539*    MOVE '"$IcJ''                ! $ #00017512' TO DFHEIV0
 17540     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17542     MOVE X'2420233030303137353132' TO DFHEIV0(25:11)
 17543     CALL 'kxdfhei1' USING DFHEIV0
 17544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17545
 17546
 17547
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 321
* EL050.cbl
 17548* EXEC CICS STARTBR
 17549*        DATASET (FILE-ID-ERRESS)
 17550*        RIDFLD  (WS-ERRESS-KEY)
 17551*        GTEQ
 17552*    END-EXEC.
 17553     MOVE 0
 17554       TO DFHEIV11
 17555*    MOVE '&,         G          &   #00017519' TO DFHEIV0
 17556     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17557     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17558     MOVE X'2020233030303137353139' TO DFHEIV0(25:11)
 17559     CALL 'kxdfhei1' USING DFHEIV0,
 17560           FILE-ID-ERRESS,
 17561           WS-ERRESS-KEY,
 17562           DFHEIV99,
 17563           DFHEIV11,
 17564           DFHEIV99
 17565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17566
 17567
 17568 6620-READ-NEXT-ERRESS-MASTER.
 17569
 17570
 17571* EXEC CICS HANDLE CONDITION
 17572*        NOTFND    (6630-END-OF-FILE)
 17573*        ENDFILE   (6630-END-OF-FILE)
 17574*        DISABLED  (6630-ERRESS-PROBLEM)
 17575*        NOTOPEN   (6630-ERRESS-PROBLEM)
 17576*    END-EXEC.
 17577*    MOVE '"$I''cJ                ! % #00017527' TO DFHEIV0
 17578     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 17579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17580     MOVE X'2520233030303137353237' TO DFHEIV0(25:11)
 17581     CALL 'kxdfhei1' USING DFHEIV0
 17582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17583
 17584
 17585
 17586* EXEC CICS READNEXT
 17587*        DATASET (FILE-ID-ERRESS)
 17588*        INTO    (RESIDENT-STATE-TAX-MASTER)
 17589*        RIDFLD  (WS-ERRESS-KEY)
 17590*    END-EXEC.
 17591     MOVE LENGTH OF
 17592      RESIDENT-STATE-TAX-MASTER
 17593       TO DFHEIV12
 17594     MOVE 0
 17595       TO DFHEIV11
 17596*    MOVE '&.IL                  )   #00017534' TO DFHEIV0
 17597     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17598     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17599     MOVE X'2020233030303137353334' TO DFHEIV0(25:11)
 17600     CALL 'kxdfhei1' USING DFHEIV0,
 17601           FILE-ID-ERRESS,
 17602           RESIDENT-STATE-TAX-MASTER,
 17603           DFHEIV12,
 17604           WS-ERRESS-KEY,
 17605           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 322
* EL050.cbl
 17606           DFHEIV11,
 17607           DFHEIV99,
 17608           DFHEIV99
 17609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17610
 17611
 17612     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 17613
 17614* EXEC CICS ENDBR
 17615*            DATASET (FILE-ID-ERRESS)
 17616*       END-EXEC
 17617     MOVE 0
 17618       TO DFHEIV11
 17619*    MOVE '&2                    $   #00017541' TO DFHEIV0
 17620     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17621     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17622     MOVE X'2020233030303137353431' TO DFHEIV0(25:11)
 17623     CALL 'kxdfhei1' USING DFHEIV0,
 17624           FILE-ID-ERRESS,
 17625           DFHEIV11,
 17626           DFHEIV99
 17627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17628        GO TO 6630-END-OF-FILE.
 17629
 17630     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 17631        NEXT SENTENCE
 17632      ELSE
 17633        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 17634
 17635*IS IT LIFE(1) OR IS IT P&C(2) ?????
 17636*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 17637*
 17638     MOVE +2                     TO WS-SUB1.
 17639
 17640     IF PB-ISSUE
 17641     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 17642        MOVE +1                  TO WS-SUB1.
 17643
 17644     IF PB-CANCELLATION
 17645     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 17646        MOVE +1                  TO WS-SUB1.
 17647*
 17648*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 17649*
 17650***  Y2K PROJ 7744
 17651     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 17652***  Y2K PROJ 7744
 17653
 17654*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 17655* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 17656* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 17657
 17658     ADD 1                    TO WS-YEAR-YY.
 17659
 17660     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 17661         MOVE RES-REN-STATE-TAX (WS-SUB1)
 17662                              TO WS-RES-STATE-TAX
 17663         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 323
* EL050.cbl
 17664                              TO WS-RES-MUNI-TAX
 17665     ELSE
 17666         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 17667                              TO WS-RES-STATE-TAX
 17668         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 17669                              TO WS-RES-MUNI-TAX.
 17670
 17671*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 17672
 17673     IF PB-CANCELLATION
 17674         GO TO 6640-CANCEL-TAX.
 17675
 17676     IF PB-I-LF-PREMIUM-AMT > ZEROS
 17677         COMPUTE PB-I-STATE-TAX ROUNDED =
 17678                                   PB-I-LF-PREMIUM-AMT
 17679                                 * WS-RES-STATE-TAX
 17680         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17681                                   PB-I-LF-PREMIUM-AMT
 17682                                 * WS-RES-MUNI-TAX
 17683     ELSE
 17684     IF PB-I-AH-PREMIUM-AMT > ZEROS
 17685         COMPUTE PB-I-STATE-TAX ROUNDED =
 17686                                   PB-I-AH-PREMIUM-AMT
 17687                                 * WS-RES-STATE-TAX
 17688         COMPUTE PB-I-MUNI-TAX ROUNDED =
 17689                                   PB-I-AH-PREMIUM-AMT
 17690                                 * WS-RES-MUNI-TAX.
 17691
 17692
 17693* EXEC CICS ENDBR
 17694*         DATASET (FILE-ID-ERRESS)
 17695*    END-EXEC.
 17696     MOVE 0
 17697       TO DFHEIV11
 17698*    MOVE '&2                    $   #00017608' TO DFHEIV0
 17699     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17700     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17701     MOVE X'2020233030303137363038' TO DFHEIV0(25:11)
 17702     CALL 'kxdfhei1' USING DFHEIV0,
 17703           FILE-ID-ERRESS,
 17704           DFHEIV11,
 17705           DFHEIV99
 17706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17707
 17708
 17709     GO TO 6640-EXIT.
 17710
 17711 6640-CANCEL-TAX.
 17712     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 17713
 17714     IF PB-C-LF-CANCEL-AMT > ZEROS
 17715         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17716                                   PB-C-LF-CANCEL-AMT
 17717                                 * WS-RES-STATE-TAX
 17718         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17719                                   PB-C-LF-CANCEL-AMT
 17720                                *  WS-RES-MUNI-TAX
 17721     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 324
* EL050.cbl
 17722     IF PB-C-AH-CANCEL-AMT > ZEROS
 17723         COMPUTE PB-CI-STATE-TAX ROUNDED =
 17724                                   PB-C-AH-CANCEL-AMT
 17725                                 * WS-RES-STATE-TAX
 17726         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 17727                                   PB-C-AH-CANCEL-AMT
 17728                                *  WS-RES-MUNI-TAX.
 17729
 17730
 17731* EXEC CICS ENDBR
 17732*         DATASET (FILE-ID-ERRESS)
 17733*    END-EXEC.
 17734     MOVE 0
 17735       TO DFHEIV11
 17736*    MOVE '&2                    $   #00017633' TO DFHEIV0
 17737     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17738     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17739     MOVE X'2020233030303137363333' TO DFHEIV0(25:11)
 17740     CALL 'kxdfhei1' USING DFHEIV0,
 17741           FILE-ID-ERRESS,
 17742           DFHEIV11,
 17743           DFHEIV99
 17744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17745
 17746
 17747     GO TO 6640-EXIT.
 17748
 17749 6630-END-OF-FILE.
 17750     MOVE ER-8002              TO WS-ERROR.
 17751     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17752
 17753     GO TO 6640-EXIT.
 17754
 17755 6630-ERRESS-PROBLEM.
 17756     MOVE ER-8044              TO WS-ERROR.
 17757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17758
 17759 6640-EXIT.
 17760     EXIT.
 17761
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 325
* EL050.cbl
 17763 6650-GET-RES-STATE-COMM.
 17764
 17765     IF PB-COMPANY-ID NOT = 'DMD'
 17766         GO TO 6700-COMM-EXIT.
 17767
 17768     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 17769     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 17770     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 17771     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 17772     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 17773     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 17774     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 17775
 17776*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 17777*
 17778***  Y2K PROJ 7744
 17779     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 17780     SET BIN-TO-GREG          TO TRUE.
 17781     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17782
 17783     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 17784***  Y2K PROJ 7744
 17785
 17786     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 17787
 17788
 17789* EXEC CICS HANDLE CONDITION
 17790*        INVREQ    (6660-START-BROWSE)
 17791*        DISABLED  (6690-ERRESC-PROBLEM)
 17792*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17793*        NOTFND    (6690-END-OF-FILE)
 17794*    END-EXEC.
 17795*    MOVE '"$8cJI                ! & #00017678' TO DFHEIV0
 17796     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 17797     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17798     MOVE X'2620233030303137363738' TO DFHEIV0(25:11)
 17799     CALL 'kxdfhei1' USING DFHEIV0
 17800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17801
 17802
 17803
 17804* EXEC CICS RESETBR
 17805*        DATASET (FILE-ID-ERRESC)
 17806*        RIDFLD  (WS-ERRESC-KEY)
 17807*    END-EXEC.
 17808     MOVE 0
 17809       TO DFHEIV11
 17810*    MOVE '&4         G          &   #00017685' TO DFHEIV0
 17811     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 17812     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17813     MOVE X'2020233030303137363835' TO DFHEIV0(25:11)
 17814     CALL 'kxdfhei1' USING DFHEIV0,
 17815           FILE-ID-ERRESC,
 17816           WS-ERRESC-KEY,
 17817           DFHEIV99,
 17818           DFHEIV11,
 17819           DFHEIV99
 17820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 326
* EL050.cbl
 17821
 17822
 17823 6660-START-BROWSE.
 17824
 17825
 17826* EXEC CICS HANDLE CONDITION
 17827*        NOTFND    (6690-END-OF-FILE)
 17828*        DISABLED  (6690-ERRESC-PROBLEM)
 17829*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17830*        ENDFILE   (6690-END-OF-FILE)
 17831*    END-EXEC.
 17832*    MOVE '"$IcJ''                ! '' #00017692' TO DFHEIV0
 17833     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17834     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17835     MOVE X'2720233030303137363932' TO DFHEIV0(25:11)
 17836     CALL 'kxdfhei1' USING DFHEIV0
 17837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17838
 17839
 17840
 17841* EXEC CICS STARTBR
 17842*        DATASET (FILE-ID-ERRESC)
 17843*        RIDFLD  (WS-ERRESC-KEY)
 17844*        GTEQ
 17845*    END-EXEC.
 17846     MOVE 0
 17847       TO DFHEIV11
 17848*    MOVE '&,         G          &   #00017699' TO DFHEIV0
 17849     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17850     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17851     MOVE X'2020233030303137363939' TO DFHEIV0(25:11)
 17852     CALL 'kxdfhei1' USING DFHEIV0,
 17853           FILE-ID-ERRESC,
 17854           WS-ERRESC-KEY,
 17855           DFHEIV99,
 17856           DFHEIV11,
 17857           DFHEIV99
 17858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17859
 17860
 17861     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 17862
 17863 6670-READ-NEXT-ERRESC-MASTER.
 17864
 17865
 17866* EXEC CICS HANDLE CONDITION
 17867*        NOTFND    (6690-END-OF-FILE)
 17868*        DISABLED  (6690-ERRESC-PROBLEM)
 17869*        NOTOPEN   (6690-ERRESC-PROBLEM)
 17870*        ENDFILE   (6690-END-OF-FILE)
 17871*    END-EXEC.
 17872*    MOVE '"$IcJ''                ! ( #00017709' TO DFHEIV0
 17873     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 17874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17875     MOVE X'2820233030303137373039' TO DFHEIV0(25:11)
 17876     CALL 'kxdfhei1' USING DFHEIV0
 17877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17878
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 327
* EL050.cbl
 17879
 17880
 17881* EXEC CICS READNEXT
 17882*        DATASET (FILE-ID-ERRESC)
 17883*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 17884*        RIDFLD  (ERRESC-RECORD-KEY)
 17885*    END-EXEC.
 17886     MOVE LENGTH OF
 17887      ACCOUNT-RESIDENT-ST-COMMISSION
 17888       TO DFHEIV12
 17889     MOVE 0
 17890       TO DFHEIV11
 17891*    MOVE '&.IL                  )   #00017716' TO DFHEIV0
 17892     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 17893     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17894     MOVE X'2020233030303137373136' TO DFHEIV0(25:11)
 17895     CALL 'kxdfhei1' USING DFHEIV0,
 17896           FILE-ID-ERRESC,
 17897           ACCOUNT-RESIDENT-ST-COMMISSION,
 17898           DFHEIV12,
 17899           ERRESC-RECORD-KEY,
 17900           DFHEIV99,
 17901           DFHEIV11,
 17902           DFHEIV99,
 17903           DFHEIV99
 17904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17905
 17906
 17907     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 17908        NEXT SENTENCE
 17909     ELSE
 17910
 17911* EXEC CICS ENDBR
 17912*            DATASET (FILE-ID-ERRESC)
 17913*       END-EXEC
 17914     MOVE 0
 17915       TO DFHEIV11
 17916*    MOVE '&2                    $   #00017725' TO DFHEIV0
 17917     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17918     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17919     MOVE X'2020233030303137373235' TO DFHEIV0(25:11)
 17920     CALL 'kxdfhei1' USING DFHEIV0,
 17921           FILE-ID-ERRESC,
 17922           DFHEIV11,
 17923           DFHEIV99
 17924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17925        GO TO 6690-END-OF-FILE.
 17926
 17927     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 17928
 17929* EXEC CICS ENDBR
 17930*            DATASET (FILE-ID-ERRESC)
 17931*       END-EXEC
 17932     MOVE 0
 17933       TO DFHEIV11
 17934*    MOVE '&2                    $   #00017731' TO DFHEIV0
 17935     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17936     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 328
* EL050.cbl
 17937     MOVE X'2020233030303137373331' TO DFHEIV0(25:11)
 17938     CALL 'kxdfhei1' USING DFHEIV0,
 17939           FILE-ID-ERRESC,
 17940           DFHEIV11,
 17941           DFHEIV99
 17942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17943        GO TO 6690-END-OF-FILE.
 17944
 17945     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 17946        NEXT SENTENCE
 17947      ELSE
 17948        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 17949
 17950* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 17951*
 17952     MOVE ZEROS               TO WS-SUB WS-SUB1.
 17953
 17954     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 17955
 17956     IF WS-SUB1 > ZERO
 17957         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 17958             PERFORM 6680-SET-COMMISSION
 17959         ELSE
 17960             PERFORM 6680-SET-TABLE-CODE.
 17961
 17962
 17963* EXEC CICS ENDBR
 17964*         DATASET (FILE-ID-ERRESC)
 17965*    END-EXEC.
 17966     MOVE 0
 17967       TO DFHEIV11
 17968*    MOVE '&2                    $   #00017753' TO DFHEIV0
 17969     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17970     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17971     MOVE X'2020233030303137373533' TO DFHEIV0(25:11)
 17972     CALL 'kxdfhei1' USING DFHEIV0,
 17973           FILE-ID-ERRESC,
 17974           DFHEIV11,
 17975           DFHEIV99
 17976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17977
 17978
 17979     GO TO 6700-COMM-EXIT.
 17980
 17981 6680-SET-TABLE-CODE.
 17982     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 17983        MOVE ZEROS             TO WS-SUB1
 17984     ELSE
 17985* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 17986* TO COMPUTE AH COMMISSION.
 17987        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 17988        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 17989        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 17990        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 17991        PERFORM 6680-READ-CTBL-TABLE
 17992        IF WS-CTBL-READ-SW NOT = 'Y'
 17993           MOVE ZEROS          TO WS-SUB1.
 17994
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 329
* EL050.cbl
 17995 6680-READ-CTBL-TABLE.
 17996*
 17997* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 17998* TO COMPUTE LIFE COMMISSION
 17999
 18000     IF CTBL-SW = '0540'
 18001        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18002        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18003        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18004
 18005     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18006
 18007     IF CTBL-TABLE-FOUND
 18008        IF CTBL-SW = '0530'
 18009             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18010                                    * PB-I-AH-TERM
 18011             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18012             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18013        ELSE
 18014             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18015             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18016             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18017     ELSE
 18018        IF FIRST-TIME-THROUGH
 18019            GO TO 6680-READ-CTBL-TABLE
 18020        ELSE
 18021            MOVE ZEROS         TO WS-SUB1.
 18022
 18023 6680-SET-COMMISSION.
 18024     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18025           MOVE ZEROS          TO WS-SUB1
 18026       ELSE
 18027           MOVE RESC-COMMISSION-PER (WS-SUB)
 18028                               TO WS-COMMISSION
 18029           IF CTBL-SW = '0530'
 18030               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18031           ELSE
 18032               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18033
 18034 6680-SEARCH-CATEGORY.
 18035     ADD +1                   TO WS-SUB.
 18036     IF WS-SUB > +12
 18037         GO TO 6680-EXIT.
 18038
 18039     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18040          MOVE WS-SUB         TO WS-SUB1
 18041          GO TO 6680-EXIT.
 18042
 18043     GO TO 6680-SEARCH-CATEGORY.
 18044
 18045 6680-EXIT.
 18046     EXIT.
 18047
 18048 6690-END-OF-FILE.
 18049     GO TO 6700-COMM-EXIT.
 18050
 18051 6690-ERRESC-PROBLEM.
 18052      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 330
* EL050.cbl
 18053      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18054
 18055      GO TO 6700-COMM-EXIT.
 18056
 18057 6700-COMM-EXIT.
 18058     EXIT.
 18059
 18060 7000-GET-RATE.
 18061
 18062* EXEC CICS LINK
 18063*        PROGRAM    ('ELRATE')
 18064*        COMMAREA   (CALCULATION-PASS-AREA)
 18065*        LENGTH     (CP-COMM-LENGTH)
 18066*    END-EXEC.
 18067     MOVE 'ELRATE' TO DFHEIV1
 18068*    MOVE '."C                   ''   #00017839' TO DFHEIV0
 18069     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18070     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18071     MOVE X'2020233030303137383339' TO DFHEIV0(25:11)
 18072     CALL 'kxdfhei1' USING DFHEIV0,
 18073           DFHEIV1,
 18074           CALCULATION-PASS-AREA,
 18075           CP-COMM-LENGTH,
 18076           DFHEIV99,
 18077           DFHEIV99,
 18078           DFHEIV99
 18079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18080
 18081
 18082 7000-EXIT.
 18083     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 331
* EL050.cbl
 18085 7100-FIND-BENEFIT-IN-STATE.
 18086     MOVE 'N'                    TO BEN-SEARCH-SW.
 18087
 18088     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18089         VARYING SUB3 FROM 1 BY 1 UNTIL
 18090            ((SUB3 GREATER 50) OR
 18091              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18092               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18093
 18094     IF SUB3 NOT = 51
 18095         MOVE 'Y'                TO BEN-SEARCH-SW.
 18096
 18097     GO TO 7199-EXIT.
 18098
 18099 7100-BENEFIT-DUMMY.
 18100
 18101 7100-DUMMY-EXIT.
 18102     EXIT.
 18103
 18104 7199-EXIT.
 18105     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 332
* EL050.cbl
 18107 7200-FIND-BENEFIT.
 18108     MOVE 'N'                    TO BEN-SEARCH-SW.
 18109
 18110     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18111         VARYING SUB3 FROM 1 BY 1 UNTIL
 18112            ((SUB3 GREATER 8) OR
 18113            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18114
 18115     IF SUB3 NOT = 9
 18116         MOVE 'Y'                TO BEN-SEARCH-SW.
 18117
 18118     GO TO 7200-EXIT.
 18119
 18120 7200-BENEFIT-DUMMY.
 18121
 18122 7200-DUMMY-EXIT.
 18123     EXIT.
 18124
 18125 7200-EXIT.
 18126     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 333
* EL050.cbl
 18128 7250-LOOK-FOR-RESCINDED-CLAIM.
 18129     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18130                                    W-CL-COMP-CD.
 18131     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18132                                    W-CL-CERT-NO.
 18133
 18134
 18135* EXEC CICS HANDLE CONDITION
 18136*        NOTFND  (7250-CONTINUE)
 18137*        ENDFILE (7250-CONTINUE)
 18138*    END-EXEC.
 18139*    MOVE '"$I''                  ! ) #00017897' TO DFHEIV0
 18140     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18142     MOVE X'2920233030303137383937' TO DFHEIV0(25:11)
 18143     CALL 'kxdfhei1' USING DFHEIV0
 18144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18145
 18146
 18147
 18148* EXEC CICS IGNORE CONDITION
 18149*        DUPKEY
 18150*    END-EXEC.
 18151*    MOVE '"*$                   !   #00017902' TO DFHEIV0
 18152     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18154     MOVE X'2020233030303137393032' TO DFHEIV0(25:11)
 18155     CALL 'kxdfhei1' USING DFHEIV0
 18156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18157
 18158
 18159
 18160* EXEC CICS STARTBR
 18161*        DATASET   (CLMS-ID)
 18162*        RIDFLD    (ELMSTR-KEY)
 18163*        GENERIC   EQUAL
 18164*        KEYLENGTH (ELMSTR-LENGTH)
 18165*    END-EXEC.
 18166     MOVE 0
 18167       TO DFHEIV11
 18168*    MOVE '&,   KG    E          &   #00017906' TO DFHEIV0
 18169     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18170     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18171     MOVE X'2020233030303137393036' TO DFHEIV0(25:11)
 18172     CALL 'kxdfhei1' USING DFHEIV0,
 18173           CLMS-ID,
 18174           ELMSTR-KEY,
 18175           ELMSTR-LENGTH,
 18176           DFHEIV11,
 18177           DFHEIV99
 18178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18179
 18180
 18181     MOVE 'Y'                    TO W-BROWSE-SW.
 18182
 18183 7250-NEXT-CLAIM.
 18184
 18185
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 334
* EL050.cbl
 18186* EXEC CICS READNEXT
 18187*        DATASET   (CLMS-ID)
 18188*        RIDFLD    (ELMSTR-KEY)
 18189*        SET       (ADDRESS OF CLAIM-MASTER)
 18190*    END-EXEC.
 18191     MOVE 0
 18192       TO DFHEIV11
 18193*    MOVE '&.S                   )   #00017917' TO DFHEIV0
 18194     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18195     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18196     MOVE X'2020233030303137393137' TO DFHEIV0(25:11)
 18197     CALL 'kxdfhei1' USING DFHEIV0,
 18198           CLMS-ID,
 18199           DFHEIV20,
 18200           DFHEIV99,
 18201           ELMSTR-KEY,
 18202           DFHEIV99,
 18203           DFHEIV11,
 18204           DFHEIV99,
 18205           DFHEIV99
 18206     SET ADDRESS OF CLAIM-MASTER TO
 18207         DFHEIV20
 18208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18209
 18210
 18211     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18212        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18213         GO TO 7250-CONTINUE
 18214     END-IF.
 18215
 18216     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18217        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18218        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18219        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18220        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18221         GO TO 7250-NEXT-CLAIM
 18222     END-IF.
 18223
 18224     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18225        OR (CL-CLAIM-TYPE = 'I')
 18226        OR (CL-CLAIM-TYPE = 'G')
 18227          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18228              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18229              GO TO 7250-CONTINUE
 18230          END-IF
 18231     END-IF.
 18232
 18233     GO TO 7250-NEXT-CLAIM.
 18234
 18235 7250-CONTINUE.
 18236
 18237     IF W-BROWSE-SW = 'Y'
 18238
 18239* EXEC CICS ENDBR
 18240*            DATASET   (CLMS-ID)
 18241*        END-EXEC
 18242     MOVE 0
 18243       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 335
* EL050.cbl
 18244*    MOVE '&2                    $   #00017950' TO DFHEIV0
 18245     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18246     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18247     MOVE X'2020233030303137393530' TO DFHEIV0(25:11)
 18248     CALL 'kxdfhei1' USING DFHEIV0,
 18249           CLMS-ID,
 18250           DFHEIV11,
 18251           DFHEIV99
 18252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18253         MOVE 'N' TO W-BROWSE-SW
 18254     END-IF.
 18255
 18256 7250-EXIT.
 18257     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 336
* EL050.cbl
 18259 7300-CHECK-FOR-OPEN-CLMS.
 18260
 18261*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18262*    MOVE SPACES                 TO CNTL-ACCESS.
 18263*    MOVE '1'                    TO CNTL-REC-TYPE.
 18264*    MOVE +0                     TO CNTL-SEQ-NO.
 18265
 18266*    MOVE '3'                    TO RC-SW-1.
 18267*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18268
 18269*    IF NOT CF-COMPANY-MASTER
 18270*         PERFORM 0099-COMPANY-NOT-FOUND
 18271*         GO TO 7300-EXIT.
 18272
 18273     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18274                                    W-CL-COMP-CD.
 18275     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18276                                    W-CL-CERT-NO.
 18277
 18278
 18279* EXEC CICS HANDLE CONDITION
 18280*        NOTFND  (7300-CONTINUE)
 18281*        ENDFILE (7300-CONTINUE)
 18282*    END-EXEC.
 18283*    MOVE '"$I''                  ! * #00017978' TO DFHEIV0
 18284     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18286     MOVE X'2A20233030303137393738' TO DFHEIV0(25:11)
 18287     CALL 'kxdfhei1' USING DFHEIV0
 18288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18289
 18290
 18291
 18292* EXEC CICS IGNORE CONDITION
 18293*        DUPKEY
 18294*    END-EXEC.
 18295*    MOVE '"*$                   !   #00017983' TO DFHEIV0
 18296     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18297     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18298     MOVE X'2020233030303137393833' TO DFHEIV0(25:11)
 18299     CALL 'kxdfhei1' USING DFHEIV0
 18300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18301
 18302
 18303
 18304* EXEC CICS STARTBR
 18305*        DATASET   (CLMS-ID)
 18306*        RIDFLD    (ELMSTR-KEY)
 18307*        GENERIC   EQUAL
 18308*        KEYLENGTH (ELMSTR-LENGTH)
 18309*    END-EXEC.
 18310     MOVE 0
 18311       TO DFHEIV11
 18312*    MOVE '&,   KG    E          &   #00017987' TO DFHEIV0
 18313     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18314     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18315     MOVE X'2020233030303137393837' TO DFHEIV0(25:11)
 18316     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 337
* EL050.cbl
 18317           CLMS-ID,
 18318           ELMSTR-KEY,
 18319           ELMSTR-LENGTH,
 18320           DFHEIV11,
 18321           DFHEIV99
 18322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18323
 18324
 18325     MOVE 'Y'                    TO W-BROWSE-SW.
 18326
 18327 7300-NEXT-CLAIM.
 18328
 18329
 18330* EXEC CICS READNEXT
 18331*        DATASET   (CLMS-ID)
 18332*        RIDFLD    (ELMSTR-KEY)
 18333*        SET       (ADDRESS OF CLAIM-MASTER)
 18334*    END-EXEC.
 18335     MOVE 0
 18336       TO DFHEIV11
 18337*    MOVE '&.S                   )   #00017998' TO DFHEIV0
 18338     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18339     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18340     MOVE X'2020233030303137393938' TO DFHEIV0(25:11)
 18341     CALL 'kxdfhei1' USING DFHEIV0,
 18342           CLMS-ID,
 18343           DFHEIV20,
 18344           DFHEIV99,
 18345           ELMSTR-KEY,
 18346           DFHEIV99,
 18347           DFHEIV11,
 18348           DFHEIV99,
 18349           DFHEIV99
 18350     SET ADDRESS OF CLAIM-MASTER TO
 18351         DFHEIV20
 18352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18353
 18354
 18355     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18356        MSTR-CERT-NO NOT = W-CL-CERT-NO
 18357         GO TO 7300-CONTINUE.
 18358
 18359     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18360        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18361        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18362        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18363        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18364         GO TO 7300-NEXT-CLAIM.
 18365
 18366*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18367     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18368        OR (CL-CLAIM-TYPE = 'I')
 18369        OR (CL-CLAIM-TYPE = 'G')
 18370        IF CLAIM-IS-OPEN
 18371           EVALUATE TRUE
 18372             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18373                 MOVE ER-2884      TO WS-ERROR
 18374             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 338
* EL050.cbl
 18375                 MOVE ER-2887      TO WS-ERROR
 18376             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18377                 MOVE ER-2886      TO WS-ERROR
 18378             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18379                 MOVE ER-2888      TO WS-ERROR
 18380             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18381                 MOVE ER-2885      TO WS-ERROR
 18382             WHEN OTHER
 18383                 MOVE ER-2768      TO WS-ERROR
 18384           END-EVALUATE
 18385           IF PB-C-AH-CANCEL-VOIDED OR
 18386              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18387                NOT AH-COVERAGE-CANCELLED)
 18388               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18389               MOVE ER-2768      TO WS-ERROR
 18390           END-IF
 18391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18392           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18393              PB-FORCE-CODE NOT EQUAL '8'
 18394               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18395           END-IF
 18396           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18397           GO TO 7300-CONTINUE
 18398        ELSE
 18399           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18400*****THIS IS A RESCISSION OR REFORMATION
 18401              IF (AH-COVERAGE-CANCELLED AND
 18402                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
 18403                    MOVE ER-2890 TO WS-ERROR
 18404                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18405                    GO TO 7300-CONTINUE
 18406              END-IF
 18407           ELSE
 18408              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18409                 MOVE ER-2756        TO WS-ERROR
 18410                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18411                 GO TO 7300-CONTINUE
 18412              END-IF
 18413           END-IF
 18414        END-IF
 18415     ELSE
 18416*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 18417        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 18418           IF CLAIM-IS-OPEN
 18419              MOVE ER-2889      TO WS-ERROR
 18420              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18421              GO TO 7300-CONTINUE
 18422           ELSE
 18423              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18424*****THIS IS A RESCISSION OR REFORMATION
 18425                 IF (LF-COVERAGE-CANCELLED AND
 18426                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 18427                       MOVE ER-2890 TO WS-ERROR
 18428                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18429                       GO TO 7300-CONTINUE
 18430                 END-IF
 18431              ELSE
 18432                 IF (AH-COVERAGE-CANCELLED AND
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 339
* EL050.cbl
 18433                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 18434                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 18435                    (LF-COVERAGE-CANCELLED AND
 18436                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 18437                     WS-ST-REFUND-CLAIM-FLAG = '4')
 18438                       MOVE ER-2965 TO WS-ERROR
 18439                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18440                       GO TO 7300-CONTINUE
 18441                 END-IF
 18442                 IF LF-COVERAGE-CANCELLED
 18443                  IF CL-TOTAL-PAID-AMT > 0
 18444                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 18445                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 18446                        MOVE ER-2891 TO WS-ERROR
 18447                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18448                        GO TO 7300-CONTINUE
 18449                      END-IF
 18450                    ELSE
 18451                      MOVE ER-2892 TO WS-ERROR
 18452                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18453                      GO TO 7300-CONTINUE
 18454                    END-IF
 18455                  END-IF
 18456                 END-IF
 18457              END-IF
 18458           END-IF
 18459        END-IF
 18460     END-IF
 18461
 18462     GO TO 7300-NEXT-CLAIM.
 18463
 18464 7300-CONTINUE.
 18465
 18466     IF W-BROWSE-SW = 'Y'
 18467
 18468* EXEC CICS ENDBR
 18469*            DATASET   (CLMS-ID)
 18470*        END-EXEC.
 18471     MOVE 0
 18472       TO DFHEIV11
 18473*    MOVE '&2                    $   #00018116' TO DFHEIV0
 18474     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18475     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18476     MOVE X'2020233030303138313136' TO DFHEIV0(25:11)
 18477     CALL 'kxdfhei1' USING DFHEIV0,
 18478           CLMS-ID,
 18479           DFHEIV11,
 18480           DFHEIV99
 18481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18482
 18483
 18484 7300-EXIT.
 18485     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 340
* EL050.cbl
 18487
 18488 7400-GET-REMAIN-TERM.
 18489
 18490* EXEC CICS LINK
 18491*        PROGRAM    ('ELRTRM')
 18492*        COMMAREA   (CALCULATION-PASS-AREA)
 18493*        LENGTH     (CP-COMM-LENGTH)
 18494*    END-EXEC.
 18495     MOVE 'ELRTRM' TO DFHEIV1
 18496*    MOVE '."C                   ''   #00018125' TO DFHEIV0
 18497     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18499     MOVE X'2020233030303138313235' TO DFHEIV0(25:11)
 18500     CALL 'kxdfhei1' USING DFHEIV0,
 18501           DFHEIV1,
 18502           CALCULATION-PASS-AREA,
 18503           CP-COMM-LENGTH,
 18504           DFHEIV99,
 18505           DFHEIV99,
 18506           DFHEIV99
 18507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18508
 18509
 18510 7400-EXIT.
 18511     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 341
* EL050.cbl
 18513
 18514 7500-GET-REMAIN-AMOUNT.
 18515
 18516* EXEC CICS LINK
 18517*        PROGRAM    ('ELRAMT')
 18518*        COMMAREA   (CALCULATION-PASS-AREA)
 18519*        LENGTH     (CP-COMM-LENGTH)
 18520*    END-EXEC.
 18521     MOVE 'ELRAMT' TO DFHEIV1
 18522*    MOVE '."C                   ''   #00018136' TO DFHEIV0
 18523     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18524     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18525     MOVE X'2020233030303138313336' TO DFHEIV0(25:11)
 18526     CALL 'kxdfhei1' USING DFHEIV0,
 18527           DFHEIV1,
 18528           CALCULATION-PASS-AREA,
 18529           CP-COMM-LENGTH,
 18530           DFHEIV99,
 18531           DFHEIV99,
 18532           DFHEIV99
 18533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18534
 18535
 18536 7500-EXIT.
 18537     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 342
* EL050.cbl
 18539
 18540 7600-GET-REFUND.
 18541
 18542* EXEC CICS LINK
 18543*        PROGRAM    ('ELRFND')
 18544*        COMMAREA   (CALCULATION-PASS-AREA)
 18545*        LENGTH     (CP-COMM-LENGTH)
 18546*    END-EXEC.
 18547     MOVE 'ELRFND' TO DFHEIV1
 18548*    MOVE '."C                   ''   #00018147' TO DFHEIV0
 18549     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18551     MOVE X'2020233030303138313437' TO DFHEIV0(25:11)
 18552     CALL 'kxdfhei1' USING DFHEIV0,
 18553           DFHEIV1,
 18554           CALCULATION-PASS-AREA,
 18555           CP-COMM-LENGTH,
 18556           DFHEIV99,
 18557           DFHEIV99,
 18558           DFHEIV99
 18559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18560
 18561
 18562 7600-EXIT.
 18563     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 343
* EL050.cbl
 18565 7700-CALL-DL1.
 18566
 18567* EXEC CICS LINK
 18568*        PROGRAM    ('DLO001')
 18569*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 18570*        LENGTH     (DLO001-COMM-LENGTH)
 18571*    END-EXEC.
 18572     MOVE 'DLO001' TO DFHEIV1
 18573*    MOVE '."C                   ''   #00018157' TO DFHEIV0
 18574     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18575     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18576     MOVE X'2020233030303138313537' TO DFHEIV0(25:11)
 18577     CALL 'kxdfhei1' USING DFHEIV0,
 18578           DFHEIV1,
 18579           WS-DLO-MASTER-POLICY-FORM,
 18580           DLO001-COMM-LENGTH,
 18581           DFHEIV99,
 18582           DFHEIV99,
 18583           DFHEIV99
 18584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18585
 18586
 18587 7700-EXIT.
 18588     EXIT.
 18589
 18590 7710-CALL-DL2.
 18591
 18592* EXEC CICS LINK
 18593*        PROGRAM    ('DLO002')
 18594*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 18595*        LENGTH     (DLO002-COMM-LENGTH)
 18596*    END-EXEC.
 18597     MOVE 'DLO002' TO DFHEIV1
 18598*    MOVE '."C                   ''   #00018167' TO DFHEIV0
 18599     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18600     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18601     MOVE X'2020233030303138313637' TO DFHEIV0(25:11)
 18602     CALL 'kxdfhei1' USING DFHEIV0,
 18603           DFHEIV1,
 18604           WS-DLO-INTERNAL-POLICY-FORM,
 18605           DLO002-COMM-LENGTH,
 18606           DFHEIV99,
 18607           DFHEIV99,
 18608           DFHEIV99
 18609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18610
 18611
 18612 7710-EXIT.
 18613     EXIT.
 18614
 18615 7720-CALL-DL3.
 18616
 18617* EXEC CICS LINK
 18618*        PROGRAM    ('DLO003')
 18619*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 18620*        LENGTH     (DLO003-COMM-LENGTH)
 18621*    END-EXEC.
 18622     MOVE 'DLO003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 344
* EL050.cbl
 18623*    MOVE '."C                   ''   #00018177' TO DFHEIV0
 18624     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18625     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18626     MOVE X'2020233030303138313737' TO DFHEIV0(25:11)
 18627     CALL 'kxdfhei1' USING DFHEIV0,
 18628           DFHEIV1,
 18629           WS-DLO-VALID-BANK-ID,
 18630           DLO003-COMM-LENGTH,
 18631           DFHEIV99,
 18632           DFHEIV99,
 18633           DFHEIV99
 18634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18635
 18636
 18637 7720-EXIT.
 18638     EXIT.
 18639
 18640 7730-CALL-DL7.
 18641
 18642* EXEC CICS LINK
 18643*        PROGRAM    ('DLO007')
 18644*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 18645*        LENGTH     (DLO007-COMM-LENGTH)
 18646*    END-EXEC.
 18647     MOVE 'DLO007' TO DFHEIV1
 18648*    MOVE '."C                   ''   #00018187' TO DFHEIV0
 18649     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18650     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18651     MOVE X'2020233030303138313837' TO DFHEIV0(25:11)
 18652     CALL 'kxdfhei1' USING DFHEIV0,
 18653           DFHEIV1,
 18654           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 18655           DLO007-COMM-LENGTH,
 18656           DFHEIV99,
 18657           DFHEIV99,
 18658           DFHEIV99
 18659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18660
 18661
 18662 7730-EXIT.
 18663     EXIT.
 18664
 18665 7740-CALL-DL11.
 18666
 18667* EXEC CICS LINK
 18668*        PROGRAM    ('DLO011')
 18669*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 18670*        LENGTH     (DLO011-COMM-LENGTH)
 18671*    END-EXEC.
 18672     MOVE 'DLO011' TO DFHEIV1
 18673*    MOVE '."C                   ''   #00018197' TO DFHEIV0
 18674     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18675     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18676     MOVE X'2020233030303138313937' TO DFHEIV0(25:11)
 18677     CALL 'kxdfhei1' USING DFHEIV0,
 18678           DFHEIV1,
 18679           WS-DLO-PREM-RATES-BEN-TYPE,
 18680           DLO011-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 345
* EL050.cbl
 18681           DFHEIV99,
 18682           DFHEIV99,
 18683           DFHEIV99
 18684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18685
 18686
 18687 7740-EXIT.
 18688     EXIT.
 18689
 18690 7750-CALL-DL17.
 18691
 18692* EXEC CICS LINK
 18693*        PROGRAM    ('DLO017')
 18694*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 18695*        LENGTH     (DLO017-COMM-LENGTH)
 18696*    END-EXEC.
 18697     MOVE 'DLO017' TO DFHEIV1
 18698*    MOVE '."C                   ''   #00018207' TO DFHEIV0
 18699     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18700     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18701     MOVE X'2020233030303138323037' TO DFHEIV0(25:11)
 18702     CALL 'kxdfhei1' USING DFHEIV0,
 18703           DFHEIV1,
 18704           WS-DLO-VALID-RATE-CODE,
 18705           DLO017-COMM-LENGTH,
 18706           DFHEIV99,
 18707           DFHEIV99,
 18708           DFHEIV99
 18709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18710
 18711
 18712 7750-EXIT.
 18713     EXIT.
 18714
 18715 7755-CALL-DL19.
 18716
 18717* EXEC CICS LINK
 18718*        PROGRAM    ('DLO019')
 18719*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 18720*        LENGTH     (DLO019-COMM-LENGTH)
 18721*    END-EXEC.
 18722     MOVE 'DLO019' TO DFHEIV1
 18723*    MOVE '."C                   ''   #00018217' TO DFHEIV0
 18724     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18726     MOVE X'2020233030303138323137' TO DFHEIV0(25:11)
 18727     CALL 'kxdfhei1' USING DFHEIV0,
 18728           DFHEIV1,
 18729           WS-DLO-ORIG-COV-CAT,
 18730           DLO019-COMM-LENGTH,
 18731           DFHEIV99,
 18732           DFHEIV99,
 18733           DFHEIV99
 18734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18735
 18736
 18737 7755-EXIT.
 18738     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 346
* EL050.cbl
 18739
 18740 7760-CALL-DL21.
 18741
 18742* EXEC CICS LINK
 18743*        PROGRAM    ('DLO021')
 18744*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 18745*        LENGTH     (DLO021-COMM-LENGTH)
 18746*    END-EXEC.
 18747     MOVE 'DLO021' TO DFHEIV1
 18748*    MOVE '."C                   ''   #00018227' TO DFHEIV0
 18749     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18751     MOVE X'2020233030303138323237' TO DFHEIV0(25:11)
 18752     CALL 'kxdfhei1' USING DFHEIV0,
 18753           DFHEIV1,
 18754           WS-DLO-VALID-LOAN-OFFICER,
 18755           DLO021-COMM-LENGTH,
 18756           DFHEIV99,
 18757           DFHEIV99,
 18758           DFHEIV99
 18759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18760
 18761
 18762 7760-EXIT.
 18763     EXIT.
 18764
 18765 7770-CALL-DL22.
 18766
 18767* EXEC CICS LINK
 18768*        PROGRAM    ('DLO022')
 18769*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 18770*        LENGTH     (DLO022-COMM-LENGTH)
 18771*    END-EXEC.
 18772     MOVE 'DLO022' TO DFHEIV1
 18773*    MOVE '."C                   ''   #00018237' TO DFHEIV0
 18774     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18775     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18776     MOVE X'2020233030303138323337' TO DFHEIV0(25:11)
 18777     CALL 'kxdfhei1' USING DFHEIV0,
 18778           DFHEIV1,
 18779           WS-DLO-VALID-STATE-CODE,
 18780           DLO022-COMM-LENGTH,
 18781           DFHEIV99,
 18782           DFHEIV99,
 18783           DFHEIV99
 18784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18785
 18786
 18787 7770-EXIT.
 18788     EXIT.
 18789
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 347
* EL050.cbl
 18791
 18792 7800-REWRITE-CERT.
 18793******************************************************************
 18794*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 18795*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 18796******************************************************************
 18797
 18798     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 18799        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 18800        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 18801        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 18802
 18803* EXEC CICS REWRITE
 18804*                  DATASET (CERT-ID)
 18805*                  FROM    (CERTIFICATE-MASTER)
 18806*              END-EXEC
 18807     MOVE LENGTH OF
 18808      CERTIFICATE-MASTER
 18809       TO DFHEIV11
 18810*    MOVE '&& L                  %   #00018258' TO DFHEIV0
 18811     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18812     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18813     MOVE X'2020233030303138323538' TO DFHEIV0(25:11)
 18814     CALL 'kxdfhei1' USING DFHEIV0,
 18815           CERT-ID,
 18816           CERTIFICATE-MASTER,
 18817           DFHEIV11,
 18818           DFHEIV99
 18819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18820        GO TO 7800-EXIT.
 18821
 18822       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 18823       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 18824
 18825 7800-EXIT.
 18826      EXIT.
 18827
 18828 7900-DELETE-CERT.
 18829
 18830* EXEC CICS DELETE
 18831*        DATASET (CERT-ID)
 18832*    END-EXEC.
 18833*    MOVE '&(                    &   #00018271' TO DFHEIV0
 18834     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 18835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18836     MOVE X'2020233030303138323731' TO DFHEIV0(25:11)
 18837     CALL 'kxdfhei1' USING DFHEIV0,
 18838           CERT-ID,
 18839           DFHEIV99,
 18840           DFHEIV99,
 18841           DFHEIV99,
 18842           DFHEIV99
 18843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18844
 18845
 18846 7900-EXIT.
 18847     EXIT.
 18848
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 348
* EL050.cbl
 18849 8000-WRITE-CERT.
 18850
 18851* EXEC CICS HANDLE CONDITION
 18852*        DUPKEY    (8000-FREE-MAIN)
 18853*    END-EXEC.
 18854*    MOVE '"$$                   ! + #00018279' TO DFHEIV0
 18855     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 18856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18857     MOVE X'2B20233030303138323739' TO DFHEIV0(25:11)
 18858     CALL 'kxdfhei1' USING DFHEIV0
 18859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18860
 18861
 18862
 18863* EXEC CICS WRITE
 18864*        DATASET     (CERT-ID)
 18865*        FROM        (CERTIFICATE-MASTER)
 18866*        RIDFLD      (ELCERT-KEY)
 18867*    END-EXEC.
 18868     MOVE LENGTH OF
 18869      CERTIFICATE-MASTER
 18870       TO DFHEIV11
 18871*    MOVE '&$ L                  ''   #00018283' TO DFHEIV0
 18872     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18873     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18874     MOVE X'2020233030303138323833' TO DFHEIV0(25:11)
 18875     CALL 'kxdfhei1' USING DFHEIV0,
 18876           CERT-ID,
 18877           CERTIFICATE-MASTER,
 18878           DFHEIV11,
 18879           ELCERT-KEY,
 18880           DFHEIV99,
 18881           DFHEIV99
 18882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18883
 18884
 18885 8000-FREE-MAIN.
 18886
 18887 8000-EXIT.
 18888      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 349
* EL050.cbl
 18890
 18891 8100-READ-ERPNDM.
 18892
 18893* EXEC CICS HANDLE CONDITION
 18894*         NOTFND     (8100-NOTFND)
 18895*         ENDFILE    (8100-NOTFND)
 18896*    END-EXEC.
 18897*    MOVE '"$I''                  ! , #00018296' TO DFHEIV0
 18898     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18900     MOVE X'2C20233030303138323936' TO DFHEIV0(25:11)
 18901     CALL 'kxdfhei1' USING DFHEIV0
 18902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18903
 18904
 18905     MOVE SPACES                 TO ERPNDM-FOUND.
 18906     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 18907
 18908
 18909* EXEC CICS READ
 18910*         DATASET   (FILE-ERPNDM)
 18911*         RIDFLD    (PM-CONTROL-PRIMARY)
 18912*         INTO      (PENDING-MAILING-DATA)
 18913*    END-EXEC.
 18914     MOVE LENGTH OF
 18915      PENDING-MAILING-DATA
 18916       TO DFHEIV11
 18917*    MOVE '&"IL       E          (   #00018304' TO DFHEIV0
 18918     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18920     MOVE X'2020233030303138333034' TO DFHEIV0(25:11)
 18921     CALL 'kxdfhei1' USING DFHEIV0,
 18922           FILE-ERPNDM,
 18923           PENDING-MAILING-DATA,
 18924           DFHEIV11,
 18925           PM-CONTROL-PRIMARY,
 18926           DFHEIV99,
 18927           DFHEIV99,
 18928           DFHEIV99
 18929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18930
 18931
 18932     GO TO 8100-EXIT.
 18933
 18934 8100-NOTFND.
 18935
 18936     MOVE 'X'                    TO ERPNDM-FOUND.
 18937     MOVE ER-2694                TO WS-ERROR.
 18938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18939     MOVE ER-2883                TO WS-ERROR
 18940     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 18941     .
 18942 8100-EXIT.
 18943     EXIT.
 18944
 18945 8110-READ-ERMAIL.
 18946
 18947* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 350
* EL050.cbl
 18948*         NOTFND     (8110-NOTFND)
 18949*         ENDFILE    (8110-NOTFND)
 18950*    END-EXEC.
 18951*    MOVE '"$I''                  ! - #00018324' TO DFHEIV0
 18952     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18954     MOVE X'2D20233030303138333234' TO DFHEIV0(25:11)
 18955     CALL 'kxdfhei1' USING DFHEIV0
 18956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18957
 18958
 18959     MOVE SPACES                 TO ERMAIL-FOUND.
 18960     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 18961     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 18962     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 18963     MOVE PB-SV-STATE            TO MA-STATE.
 18964
 18965
 18966* EXEC CICS READ
 18967*         UPDATE
 18968*         DATASET   (FILE-ERMAIL)
 18969*         RIDFLD    (MA-CONTROL-PRIMARY)
 18970*         INTO      (MAILING-DATA)
 18971*    END-EXEC.
 18972     MOVE LENGTH OF
 18973      MAILING-DATA
 18974       TO DFHEIV11
 18975*    MOVE '&"IL       EU         (   #00018335' TO DFHEIV0
 18976     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 18977     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18978     MOVE X'2020233030303138333335' TO DFHEIV0(25:11)
 18979     CALL 'kxdfhei1' USING DFHEIV0,
 18980           FILE-ERMAIL,
 18981           MAILING-DATA,
 18982           DFHEIV11,
 18983           MA-CONTROL-PRIMARY,
 18984           DFHEIV99,
 18985           DFHEIV99,
 18986           DFHEIV99
 18987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18988
 18989
 18990     GO TO 8110-EXIT.
 18991
 18992 8110-NOTFND.
 18993     MOVE 'X'                    TO ERMAIL-FOUND.
 18994
 18995 8110-EXIT.
 18996     EXIT.
 18997
 18998 8120-REWRITE-ERMAIL.
 18999
 19000* EXEC CICS REWRITE
 19001*         DATASET    (FILE-ERMAIL)
 19002*         FROM       (MAILING-DATA)
 19003*    END-EXEC.
 19004     MOVE LENGTH OF
 19005      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 351
* EL050.cbl
 19006       TO DFHEIV11
 19007*    MOVE '&& L                  %   #00018351' TO DFHEIV0
 19008     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19009     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19010     MOVE X'2020233030303138333531' TO DFHEIV0(25:11)
 19011     CALL 'kxdfhei1' USING DFHEIV0,
 19012           FILE-ERMAIL,
 19013           MAILING-DATA,
 19014           DFHEIV11,
 19015           DFHEIV99
 19016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19017
 19018
 19019 8120-EXIT.
 19020     EXIT.
 19021
 19022 8130-WRITE-ERMAIL.
 19023
 19024* EXEC CICS HANDLE CONDITION
 19025*         DUPKEY   (8130-EXIT)
 19026*    END-EXEC.
 19027*    MOVE '"$$                   ! . #00018360' TO DFHEIV0
 19028     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19030     MOVE X'2E20233030303138333630' TO DFHEIV0(25:11)
 19031     CALL 'kxdfhei1' USING DFHEIV0
 19032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19033
 19034
 19035
 19036* EXEC CICS WRITE
 19037*         DATASET     (FILE-ERMAIL)
 19038*         RIDFLD      (MA-CONTROL-PRIMARY)
 19039*         FROM        (MAILING-DATA)
 19040*    END-EXEC.
 19041     MOVE LENGTH OF
 19042      MAILING-DATA
 19043       TO DFHEIV11
 19044*    MOVE '&$ L                  ''   #00018364' TO DFHEIV0
 19045     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19046     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19047     MOVE X'2020233030303138333634' TO DFHEIV0(25:11)
 19048     CALL 'kxdfhei1' USING DFHEIV0,
 19049           FILE-ERMAIL,
 19050           MAILING-DATA,
 19051           DFHEIV11,
 19052           MA-CONTROL-PRIMARY,
 19053           DFHEIV99,
 19054           DFHEIV99
 19055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19056
 19057
 19058 8130-EXIT.
 19059     EXIT.
 19060
 19061 8140-UNLOCK-ERMAIL.
 19062
 19063* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 352
* EL050.cbl
 19064*         DATASET   (FILE-ERMAIL)
 19065*    END-EXEC.
 19066*    MOVE '&*                    #   #00018374' TO DFHEIV0
 19067     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19068     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19069     MOVE X'2020233030303138333734' TO DFHEIV0(25:11)
 19070     CALL 'kxdfhei1' USING DFHEIV0,
 19071           FILE-ERMAIL,
 19072           DFHEIV99
 19073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19074
 19075
 19076 8140-EXIT.
 19077     EXIT.
 19078
 19079 8180-UPDATE-VIN-NUMBER.
 19080
 19081* EXEC CICS HANDLE CONDITION
 19082*        NOTFND   (8180-NOTFND)
 19083*    END-EXEC.
 19084*    MOVE '"$I                   ! / #00018382' TO DFHEIV0
 19085     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19087     MOVE X'2F20233030303138333832' TO DFHEIV0(25:11)
 19088     CALL 'kxdfhei1' USING DFHEIV0
 19089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19090
 19091
 19092     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19093     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19094
 19095
 19096* EXEC CICS READ
 19097*        UPDATE
 19098*        DATASET  (CRTT-ID)
 19099*        RIDFLD   (WS-ELCRTT-KEY)
 19100*        INTO     (CERTIFICATE-TRAILERS)
 19101*    END-EXEC.
 19102     MOVE LENGTH OF
 19103      CERTIFICATE-TRAILERS
 19104       TO DFHEIV11
 19105*    MOVE '&"IL       EU         (   #00018389' TO DFHEIV0
 19106     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19107     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19108     MOVE X'2020233030303138333839' TO DFHEIV0(25:11)
 19109     CALL 'kxdfhei1' USING DFHEIV0,
 19110           CRTT-ID,
 19111           CERTIFICATE-TRAILERS,
 19112           DFHEIV11,
 19113           WS-ELCRTT-KEY,
 19114           DFHEIV99,
 19115           DFHEIV99,
 19116           DFHEIV99
 19117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19118
 19119
 19120     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19121         MOVE PB-I-VIN TO CS-VIN-NUMBER
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 353
* EL050.cbl
 19122
 19123* EXEC CICS REWRITE
 19124*           DATASET  (CRTT-ID)
 19125*           FROM     (CERTIFICATE-TRAILERS)
 19126*        END-EXEC
 19127     MOVE LENGTH OF
 19128      CERTIFICATE-TRAILERS
 19129       TO DFHEIV11
 19130*    MOVE '&& L                  %   #00018398' TO DFHEIV0
 19131     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19132     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19133     MOVE X'2020233030303138333938' TO DFHEIV0(25:11)
 19134     CALL 'kxdfhei1' USING DFHEIV0,
 19135           CRTT-ID,
 19136           CERTIFICATE-TRAILERS,
 19137           DFHEIV11,
 19138           DFHEIV99
 19139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19140     ELSE
 19141
 19142* EXEC CICS UNLOCK
 19143*          DATASET  (CRTT-ID)
 19144*       END-EXEC
 19145*    MOVE '&*                    #   #00018403' TO DFHEIV0
 19146     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19147     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19148     MOVE X'2020233030303138343033' TO DFHEIV0(25:11)
 19149     CALL 'kxdfhei1' USING DFHEIV0,
 19150           CRTT-ID,
 19151           DFHEIV99
 19152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19153     END-IF.
 19154
 19155     GO TO 8180-EXIT.
 19156
 19157 8180-NOTFND.
 19158
 19159     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19160     MOVE 'CS'         TO CS-RECORD-ID.
 19161     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19162     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19163     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19164     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19165
 19166* EXEC CICS WRITE
 19167*       DATASET  (CRTT-ID)
 19168*       RIDFLD   (WS-ELCRTT-KEY)
 19169*       FROM     (CERTIFICATE-TRAILERS)
 19170*    END-EXEC.
 19171     MOVE LENGTH OF
 19172      CERTIFICATE-TRAILERS
 19173       TO DFHEIV11
 19174*    MOVE '&$ L                  ''   #00018418' TO DFHEIV0
 19175     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19177     MOVE X'2020233030303138343138' TO DFHEIV0(25:11)
 19178     CALL 'kxdfhei1' USING DFHEIV0,
 19179           CRTT-ID,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 354
* EL050.cbl
 19180           CERTIFICATE-TRAILERS,
 19181           DFHEIV11,
 19182           WS-ELCRTT-KEY,
 19183           DFHEIV99,
 19184           DFHEIV99
 19185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19186
 19187
 19188 8180-EXIT.
 19189     EXIT.
 19190
 19191 8190-UPDATE-REFUND-CLAIM-FLAG.
 19192
 19193* EXEC CICS HANDLE CONDITION
 19194*        NOTFND   (8190-NOTFND)
 19195*    END-EXEC.
 19196*    MOVE '"$I                   ! 0 #00018428' TO DFHEIV0
 19197     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19199     MOVE X'3020233030303138343238' TO DFHEIV0(25:11)
 19200     CALL 'kxdfhei1' USING DFHEIV0
 19201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19202
 19203
 19204     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19205     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19206
 19207
 19208* EXEC CICS READ
 19209*        UPDATE
 19210*        DATASET  (CRTT-ID)
 19211*        RIDFLD   (WS-ELCRTT-KEY)
 19212*        INTO     (CERTIFICATE-TRAILERS)
 19213*    END-EXEC.
 19214     MOVE LENGTH OF
 19215      CERTIFICATE-TRAILERS
 19216       TO DFHEIV11
 19217*    MOVE '&"IL       EU         (   #00018435' TO DFHEIV0
 19218     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19219     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19220     MOVE X'2020233030303138343335' TO DFHEIV0(25:11)
 19221     CALL 'kxdfhei1' USING DFHEIV0,
 19222           CRTT-ID,
 19223           CERTIFICATE-TRAILERS,
 19224           DFHEIV11,
 19225           WS-ELCRTT-KEY,
 19226           DFHEIV99,
 19227           DFHEIV99,
 19228           DFHEIV99
 19229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19230
 19231
 19232     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19233
 19234* EXEC CICS REWRITE
 19235*       DATASET  (CRTT-ID)
 19236*       FROM     (CERTIFICATE-TRAILERS)
 19237*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 355
* EL050.cbl
 19238     MOVE LENGTH OF
 19239      CERTIFICATE-TRAILERS
 19240       TO DFHEIV11
 19241*    MOVE '&& L                  %   #00018443' TO DFHEIV0
 19242     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19244     MOVE X'2020233030303138343433' TO DFHEIV0(25:11)
 19245     CALL 'kxdfhei1' USING DFHEIV0,
 19246           CRTT-ID,
 19247           CERTIFICATE-TRAILERS,
 19248           DFHEIV11,
 19249           DFHEIV99
 19250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19251
 19252
 19253     GO TO 8190-EXIT.
 19254
 19255 8190-NOTFND.
 19256
 19257     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19258     MOVE 'CS'         TO CS-RECORD-ID.
 19259     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19260     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19261     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19262     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19263
 19264* EXEC CICS WRITE
 19265*       DATASET  (CRTT-ID)
 19266*       RIDFLD   (WS-ELCRTT-KEY)
 19267*       FROM     (CERTIFICATE-TRAILERS)
 19268*    END-EXEC.
 19269     MOVE LENGTH OF
 19270      CERTIFICATE-TRAILERS
 19271       TO DFHEIV11
 19272*    MOVE '&$ L                  ''   #00018458' TO DFHEIV0
 19273     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19275     MOVE X'2020233030303138343538' TO DFHEIV0(25:11)
 19276     CALL 'kxdfhei1' USING DFHEIV0,
 19277           CRTT-ID,
 19278           CERTIFICATE-TRAILERS,
 19279           DFHEIV11,
 19280           WS-ELCRTT-KEY,
 19281           DFHEIV99,
 19282           DFHEIV99
 19283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19284
 19285
 19286 8190-EXIT.
 19287     EXIT.
 19288
 19289 8200-READ-REIN-TABLE.
 19290
 19291* EXEC CICS HANDLE CONDITION
 19292*         NOTFND   (8200-NOTFND)
 19293*    END-EXEC.
 19294*    MOVE '"$I                   ! 1 #00018468' TO DFHEIV0
 19295     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 356
* EL050.cbl
 19296     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19297     MOVE X'3120233030303138343638' TO DFHEIV0(25:11)
 19298     CALL 'kxdfhei1' USING DFHEIV0
 19299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19300
 19301
 19302
 19303* EXEC CICS READ
 19304*        DATASET     (REIN-ID)
 19305*        SET         (ADDRESS OF REINSURANCE-RECORD)
 19306*        RIDFLD      (ERREIN-KEY)
 19307*    END-EXEC.
 19308*    MOVE '&"S        E          (   #00018472' TO DFHEIV0
 19309     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19311     MOVE X'2020233030303138343732' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0,
 19313           REIN-ID,
 19314           DFHEIV20,
 19315           DFHEIV99,
 19316           ERREIN-KEY,
 19317           DFHEIV99,
 19318           DFHEIV99,
 19319           DFHEIV99
 19320     SET ADDRESS OF REINSURANCE-RECORD TO
 19321         DFHEIV20
 19322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19323
 19324
 19325     GO TO 8200-EXIT.
 19326
 19327 8200-NOTFND.
 19328     MOVE 'N'             TO WS-REIN-READ-SW.
 19329
 19330 8200-EXIT.
 19331      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 357
* EL050.cbl
 19333
 19334 8300-READ-CTBL-TABLE.
 19335
 19336* EXEC CICS HANDLE CONDITION
 19337*        NOTFND    (8300-NOTFND)
 19338*        DISABLED  (8300-ERRESS-PROBLEM)
 19339*        NOTOPEN   (8300-ERRESS-PROBLEM)
 19340*        ENDFILE   (8300-NOTFND)
 19341*    END-EXEC.
 19342*    MOVE '"$IcJ''                ! 2 #00018488' TO DFHEIV0
 19343     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 19344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19345     MOVE X'3220233030303138343838' TO DFHEIV0(25:11)
 19346     CALL 'kxdfhei1' USING DFHEIV0
 19347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19348
 19349
 19350
 19351* EXEC CICS READ
 19352*        DATASET     (CTBL-ID)
 19353*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 19354*        RIDFLD      (ERCTBL-KEY)
 19355*    END-EXEC.
 19356*    MOVE '&"S        E          (   #00018495' TO DFHEIV0
 19357     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19358     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19359     MOVE X'2020233030303138343935' TO DFHEIV0(25:11)
 19360     CALL 'kxdfhei1' USING DFHEIV0,
 19361           CTBL-ID,
 19362           DFHEIV20,
 19363           DFHEIV99,
 19364           ERCTBL-KEY,
 19365           DFHEIV99,
 19366           DFHEIV99,
 19367           DFHEIV99
 19368     SET ADDRESS OF COMM-TABLE-RECORD TO
 19369         DFHEIV20
 19370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19371
 19372
 19373     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 19374
 19375     GO TO 8300-EXIT.
 19376
 19377 8300-NOTFND.
 19378
 19379     IF CTBL-SW = '0530'
 19380         MOVE 'AA'                     TO WS-AH-COMP-CD
 19381         MOVE '0550'                   TO CTBL-SW
 19382         MOVE '1'                      TO WS-CTBL-READ-SW
 19383         GO TO 8300-EXIT.
 19384
 19385     IF CTBL-SW = '0540'
 19386         MOVE 'AA'                     TO WS-LF-COMP-CD
 19387         MOVE '0550'                   TO CTBL-SW
 19388         MOVE '1'                      TO WS-CTBL-READ-SW
 19389         GO TO 8300-EXIT.
 19390
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 358
* EL050.cbl
 19391     IF CTBL-SW = '0550'
 19392         MOVE '2'                      TO WS-CTBL-READ-SW
 19393         GO TO 8300-EXIT.
 19394
 19395     GO TO 8300-EXIT.
 19396
 19397 8300-ERRESS-PROBLEM.
 19398
 19399      MOVE ER-8050              TO WS-ERROR.
 19400      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19401
 19402     GO TO 8300-EXIT.
 19403
 19404 8300-EXIT.
 19405      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 359
* EL050.cbl
 19407
 19408
 19409 8400-GETMAIN-ERFORM.
 19410
 19411
 19412* EXEC CICS   GETMAIN
 19413*        LENGTH  (500)
 19414*        SET     (ADDRESS OF FORM-MASTER)
 19415*    END-EXEC.
 19416     MOVE 500
 19417       TO DFHEIV11
 19418*    MOVE '," L                  $   #00018539' TO DFHEIV0
 19419     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19420     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19421     MOVE X'2020233030303138353339' TO DFHEIV0(25:11)
 19422     CALL 'kxdfhei1' USING DFHEIV0,
 19423           DFHEIV20,
 19424           DFHEIV11,
 19425           DFHEIV99
 19426     SET ADDRESS OF FORM-MASTER TO
 19427         DFHEIV20
 19428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19429
 19430
 19431     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 19432
 19433 8400-EXIT.
 19434      EXIT.
 19435
 19436 8450-READ-FORM-MASTER.
 19437
 19438
 19439* EXEC CICS  HANDLE CONDITION
 19440*        NOTFND   (8450-FORM-NOT-FOUND)
 19441*        ENDFILE  (8450-FORM-NOT-FOUND)
 19442*    END-EXEC.
 19443*    MOVE '"$I''                  ! 3 #00018551' TO DFHEIV0
 19444     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19446     MOVE X'3320233030303138353531' TO DFHEIV0(25:11)
 19447     CALL 'kxdfhei1' USING DFHEIV0
 19448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19449
 19450
 19451
 19452* EXEC CICS   READ
 19453*        DATASET   (FORM-ID)
 19454*        RIDFLD    (ERFORM-KEY)
 19455*        INTO      (FORM-MASTER)
 19456*        GTEQ
 19457*    END-EXEC.
 19458     MOVE LENGTH OF
 19459      FORM-MASTER
 19460       TO DFHEIV11
 19461*    MOVE '&"IL       G          (   #00018556' TO DFHEIV0
 19462     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 19463     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19464     MOVE X'2020233030303138353536' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 360
* EL050.cbl
 19465     CALL 'kxdfhei1' USING DFHEIV0,
 19466           FORM-ID,
 19467           FORM-MASTER,
 19468           DFHEIV11,
 19469           ERFORM-KEY,
 19470           DFHEIV99,
 19471           DFHEIV99,
 19472           DFHEIV99
 19473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19474
 19475
 19476     MOVE  'Y'           TO  FORM-MASTER-SW.
 19477
 19478     GO TO  8450-EXIT.
 19479
 19480 8450-FORM-NOT-FOUND.
 19481
 19482     MOVE  'N'           TO  FORM-MASTER-SW.
 19483
 19484 8450-EXIT.
 19485      EXIT.
 19486
 19487 8500-DATE-CONVERT.
 19488
 19489* EXEC CICS LINK
 19490*        PROGRAM    ('ELDATCV')
 19491*        COMMAREA   (DATE-CONVERSION-DATA)
 19492*        LENGTH     (DC-COMM-LENGTH)
 19493*    END-EXEC.
 19494     MOVE 'ELDATCV' TO DFHEIV1
 19495*    MOVE '."C                   ''   #00018575' TO DFHEIV0
 19496     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19497     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19498     MOVE X'2020233030303138353735' TO DFHEIV0(25:11)
 19499     CALL 'kxdfhei1' USING DFHEIV0,
 19500           DFHEIV1,
 19501           DATE-CONVERSION-DATA,
 19502           DC-COMM-LENGTH,
 19503           DFHEIV99,
 19504           DFHEIV99,
 19505           DFHEIV99
 19506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19507
 19508
 19509 8500-EXIT.
 19510     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 361
* EL050.cbl
 19512
 19513 8555-RELOAD-CONTROL-FILE.
 19514     CONTINUE.
 19515
 19516 8555-EXIT.
 19517     EXIT.
 19518
 19519 8557-GETMAIN-ERPLAN.
 19520
 19521
 19522* EXEC CICS GETMAIN
 19523*        LENGTH    (840)
 19524*        SET       (ADDRESS OF PLAN-RECORDS)
 19525*    END-EXEC.
 19526     MOVE 840
 19527       TO DFHEIV11
 19528*    MOVE '," L                  $   #00018593' TO DFHEIV0
 19529     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19530     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19531     MOVE X'2020233030303138353933' TO DFHEIV0(25:11)
 19532     CALL 'kxdfhei1' USING DFHEIV0,
 19533           DFHEIV20,
 19534           DFHEIV11,
 19535           DFHEIV99
 19536     SET ADDRESS OF PLAN-RECORDS TO
 19537         DFHEIV20
 19538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19539
 19540
 19541     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 19542
 19543 8557-EXIT.
 19544     EXIT.
 19545
 19546 8560-GETMAIN.
 19547
 19548* EXEC CICS GETMAIN
 19549*        LENGTH    (2000)
 19550*        SET       (ADDRESS OF ACCOUNT-MASTER)
 19551*    END-EXEC.
 19552     MOVE 2000
 19553       TO DFHEIV11
 19554*    MOVE '," L                  $   #00018604' TO DFHEIV0
 19555     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 19556     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19557     MOVE X'2020233030303138363034' TO DFHEIV0(25:11)
 19558     CALL 'kxdfhei1' USING DFHEIV0,
 19559           DFHEIV20,
 19560           DFHEIV11,
 19561           DFHEIV99
 19562     SET ADDRESS OF ACCOUNT-MASTER TO
 19563         DFHEIV20
 19564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19565
 19566
 19567     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 19568
 19569 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 362
* EL050.cbl
 19570     EXIT.
 19571
 19572 8570-START-ACCOUNT-MASTER.
 19573
 19574* EXEC CICS HANDLE CONDITION
 19575*        NOTFND    (0199-ACCT-NOT-FOUND)
 19576*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19577*    END-EXEC.
 19578*    MOVE '"$I''                  ! 4 #00018615' TO DFHEIV0
 19579     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19581     MOVE X'3420233030303138363135' TO DFHEIV0(25:11)
 19582     CALL 'kxdfhei1' USING DFHEIV0
 19583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19584
 19585
 19586
 19587* EXEC CICS STARTBR
 19588*        DATASET    (ACCT-ID)
 19589*        RIDFLD     (ERACCT-KEY)
 19590*        GTEQ
 19591*    END-EXEC.
 19592     MOVE 0
 19593       TO DFHEIV11
 19594*    MOVE '&,         G          &   #00018620' TO DFHEIV0
 19595     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19596     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19597     MOVE X'2020233030303138363230' TO DFHEIV0(25:11)
 19598     CALL 'kxdfhei1' USING DFHEIV0,
 19599           ACCT-ID,
 19600           ERACCT-KEY,
 19601           DFHEIV99,
 19602           DFHEIV11,
 19603           DFHEIV99
 19604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19605
 19606
 19607 8570-EXIT.
 19608     EXIT.
 19609
 19610 8580-READ-ACCOUNT-MASTER.
 19611
 19612* EXEC CICS HANDLE CONDITION
 19613*        NOTFND    (0199-ACCT-NOT-FOUND)
 19614*        ENDFILE   (0199-ACCT-NOT-FOUND)
 19615*    END-EXEC.
 19616*    MOVE '"$I''                  ! 5 #00018630' TO DFHEIV0
 19617     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19619     MOVE X'3520233030303138363330' TO DFHEIV0(25:11)
 19620     CALL 'kxdfhei1' USING DFHEIV0
 19621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19622
 19623
 19624
 19625* EXEC CICS READNEXT
 19626*        DATASET     (ACCT-ID)
 19627*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 363
* EL050.cbl
 19628*        RIDFLD      (ERACCT-KEY)
 19629*    END-EXEC.
 19630     MOVE LENGTH OF
 19631      ACCOUNT-MASTER
 19632       TO DFHEIV12
 19633     MOVE 0
 19634       TO DFHEIV11
 19635*    MOVE '&.IL                  )   #00018635' TO DFHEIV0
 19636     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19637     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19638     MOVE X'2020233030303138363335' TO DFHEIV0(25:11)
 19639     CALL 'kxdfhei1' USING DFHEIV0,
 19640           ACCT-ID,
 19641           ACCOUNT-MASTER,
 19642           DFHEIV12,
 19643           ERACCT-KEY,
 19644           DFHEIV99,
 19645           DFHEIV11,
 19646           DFHEIV99,
 19647           DFHEIV99
 19648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19649
 19650
 19651 8580-EXIT.
 19652     EXIT.
 19653
 19654 8582-READ-COMPENSATION-MASTER.
 19655
 19656* EXEC CICS HANDLE CONDITION
 19657*        NOTFND    (8582-COMP-NOT-FOUND)
 19658*        ENDFILE   (8582-COMP-NOT-FOUND)
 19659*    END-EXEC.
 19660*    MOVE '"$I''                  ! 6 #00018645' TO DFHEIV0
 19661     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19663     MOVE X'3620233030303138363435' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0
 19665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19666
 19667
 19668
 19669* EXEC CICS READ
 19670*        DATASET     (COMP-ID)
 19671*        INTO        (COMPENSATION-MASTER)
 19672*        RIDFLD      (ERCOMP-KEY)
 19673*    END-EXEC.
 19674     MOVE LENGTH OF
 19675      COMPENSATION-MASTER
 19676       TO DFHEIV11
 19677*    MOVE '&"IL       E          (   #00018650' TO DFHEIV0
 19678     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19680     MOVE X'2020233030303138363530' TO DFHEIV0(25:11)
 19681     CALL 'kxdfhei1' USING DFHEIV0,
 19682           COMP-ID,
 19683           COMPENSATION-MASTER,
 19684           DFHEIV11,
 19685           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 364
* EL050.cbl
 19686           DFHEIV99,
 19687           DFHEIV99,
 19688           DFHEIV99
 19689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19690
 19691
 19692     MOVE 'Y'                    TO COMP-MASTER-SW
 19693
 19694     GO TO 8582-EXIT
 19695     .
 19696 8582-COMP-NOT-FOUND.
 19697
 19698     MOVE 'N'                    TO COMP-MASTER-SW.
 19699
 19700 8582-EXIT.
 19701     EXIT.
 19702
 19703 8583-READ-ERAGTC.
 19704
 19705* EXEC CICS HANDLE CONDITION
 19706*        NOTFND    (8583-AGTC-NOT-FOUND)
 19707*        ENDFILE   (8583-AGTC-NOT-FOUND)
 19708*    END-EXEC.
 19709*    MOVE '"$I''                  ! 7 #00018668' TO DFHEIV0
 19710     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19712     MOVE X'3720233030303138363638' TO DFHEIV0(25:11)
 19713     CALL 'kxdfhei1' USING DFHEIV0
 19714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19715
 19716
 19717
 19718* EXEC CICS STARTBR
 19719*        DATASET    (AGTC-ID)
 19720*        RIDFLD     (ERAGTC-KEY)
 19721*        GTEQ
 19722*    END-EXEC.
 19723     MOVE 0
 19724       TO DFHEIV11
 19725*    MOVE '&,         G          &   #00018673' TO DFHEIV0
 19726     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19727     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19728     MOVE X'2020233030303138363733' TO DFHEIV0(25:11)
 19729     CALL 'kxdfhei1' USING DFHEIV0,
 19730           AGTC-ID,
 19731           ERAGTC-KEY,
 19732           DFHEIV99,
 19733           DFHEIV11,
 19734           DFHEIV99
 19735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19736
 19737
 19738 8583-READ-ERAGTC-NEXT.
 19739
 19740* EXEC CICS READNEXT
 19741*        DATASET     (AGTC-ID)
 19742*        INTO        (AGENT-COMMISSIONS)
 19743*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 365
* EL050.cbl
 19744*    END-EXEC.
 19745     MOVE LENGTH OF
 19746      AGENT-COMMISSIONS
 19747       TO DFHEIV12
 19748     MOVE 0
 19749       TO DFHEIV11
 19750*    MOVE '&.IL                  )   #00018680' TO DFHEIV0
 19751     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19752     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19753     MOVE X'2020233030303138363830' TO DFHEIV0(25:11)
 19754     CALL 'kxdfhei1' USING DFHEIV0,
 19755           AGTC-ID,
 19756           AGENT-COMMISSIONS,
 19757           DFHEIV12,
 19758           ERAGTC-KEY,
 19759           DFHEIV99,
 19760           DFHEIV11,
 19761           DFHEIV99,
 19762           DFHEIV99
 19763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19764
 19765
 19766*    MOVE 'Y'                    TO AGTC-MASTER-SW
 19767
 19768     GO TO 8583-EXIT
 19769     .
 19770 8583-AGTC-NOT-FOUND.
 19771
 19772     MOVE 'N'                    TO AGTC-MASTER-SW.
 19773
 19774 8583-EXIT.
 19775     EXIT.
 19776
 19777 8584-READ-BANK-CROSS-REF.
 19778
 19779* EXEC CICS HANDLE CONDITION
 19780*        NOTFND    (8584-BXRF-NOT-FOUND)
 19781*        ENDFILE   (8584-BXRF-NOT-FOUND)
 19782*    END-EXEC.
 19783*    MOVE '"$I''                  ! 8 #00018698' TO DFHEIV0
 19784     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19786     MOVE X'3820233030303138363938' TO DFHEIV0(25:11)
 19787     CALL 'kxdfhei1' USING DFHEIV0
 19788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19789
 19790
 19791
 19792* EXEC CICS READ
 19793*        DATASET     (BXRF-ID)
 19794*        INTO        (BANK-CROSS-REFERENCE)
 19795*        RIDFLD      (ERBXRF-KEY)
 19796*        LENGTH      (BXRF-REC-LENGTH)
 19797*    END-EXEC.
 19798*    MOVE '&"IL       E          (   #00018703' TO DFHEIV0
 19799     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19801     MOVE X'2020233030303138373033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 366
* EL050.cbl
 19802     CALL 'kxdfhei1' USING DFHEIV0,
 19803           BXRF-ID,
 19804           BANK-CROSS-REFERENCE,
 19805           BXRF-REC-LENGTH,
 19806           ERBXRF-KEY,
 19807           DFHEIV99,
 19808           DFHEIV99,
 19809           DFHEIV99
 19810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19811
 19812
 19813     MOVE 'Y'                    TO BXRF-MASTER-SW
 19814
 19815     GO TO 8584-EXIT
 19816     .
 19817 8584-BXRF-NOT-FOUND.
 19818
 19819     MOVE 'N'                    TO BXRF-MASTER-SW.
 19820
 19821 8584-EXIT.
 19822     EXIT.
 19823
 19824 8585-READ-PLAN-MASTER.
 19825
 19826
 19827* EXEC CICS HANDLE CONDITION
 19828*        NOTFND    (8585-PLAN-NOT-FOUND)
 19829*        ENDFILE   (8585-PLAN-NOT-FOUND)
 19830*    END-EXEC.
 19831*    MOVE '"$I''                  ! 9 #00018723' TO DFHEIV0
 19832     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19833     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19834     MOVE X'3920233030303138373233' TO DFHEIV0(25:11)
 19835     CALL 'kxdfhei1' USING DFHEIV0
 19836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19837
 19838
 19839
 19840* EXEC CICS READ
 19841*        DATASET     (PLAN-ID)
 19842*        INTO        (PLAN-MASTER)
 19843*        RIDFLD      (ERPLAN-KEY)
 19844*    END-EXEC.
 19845     MOVE LENGTH OF
 19846      PLAN-MASTER
 19847       TO DFHEIV11
 19848*    MOVE '&"IL       E          (   #00018728' TO DFHEIV0
 19849     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19850     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19851     MOVE X'2020233030303138373238' TO DFHEIV0(25:11)
 19852     CALL 'kxdfhei1' USING DFHEIV0,
 19853           PLAN-ID,
 19854           PLAN-MASTER,
 19855           DFHEIV11,
 19856           ERPLAN-KEY,
 19857           DFHEIV99,
 19858           DFHEIV99,
 19859           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 367
* EL050.cbl
 19860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19861
 19862
 19863     MOVE 'Y'                    TO PLAN-MASTER-SW.
 19864
 19865     GO TO 8585-EXIT.
 19866
 19867 8585-PLAN-NOT-FOUND.
 19868
 19869     MOVE 'N'                    TO PLAN-MASTER-SW.
 19870
 19871 8585-EXIT.
 19872     EXIT.
 19873
 19874 8586-READ-LOAN-OFFICER.
 19875
 19876* EXEC CICS READ
 19877*        DATASET     (LOFC-ID)
 19878*        INTO        (LOAN-OFFICER-MASTER)
 19879*        RIDFLD      (ERLOFC-KEY)
 19880*        RESP        (WS-RESPONSE)
 19881*    END-EXEC
 19882     MOVE LENGTH OF
 19883      LOAN-OFFICER-MASTER
 19884       TO DFHEIV11
 19885*    MOVE '&"IL       E          (  N#00018746' TO DFHEIV0
 19886     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19888     MOVE X'204E233030303138373436' TO DFHEIV0(25:11)
 19889     CALL 'kxdfhei1' USING DFHEIV0,
 19890           LOFC-ID,
 19891           LOAN-OFFICER-MASTER,
 19892           DFHEIV11,
 19893           ERLOFC-KEY,
 19894           DFHEIV99,
 19895           DFHEIV99,
 19896           DFHEIV99
 19897     MOVE EIBRESP  TO WS-RESPONSE
 19898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19899
 19900     IF WS-RESP-NORMAL
 19901        MOVE 'Y'                 TO LOFC-MASTER-SW
 19902     ELSE
 19903        MOVE 'N'                 TO LOFC-MASTER-SW
 19904     END-IF
 19905     .
 19906 8586-EXIT.
 19907     EXIT.
 19908 8587-START-ERPDEF.
 19909
 19910* EXEC CICS STARTBR
 19911*       DATASET   (PDEF-ID)
 19912*       RIDFLD    (ERPDEF-KEY)
 19913*       GTEQ
 19914*       RESP      (WS-RESPONSE)
 19915*    END-EXEC
 19916     MOVE 0
 19917       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 368
* EL050.cbl
 19918*    MOVE '&,         G          &  N#00018762' TO DFHEIV0
 19919     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19920     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19921     MOVE X'204E233030303138373632' TO DFHEIV0(25:11)
 19922     CALL 'kxdfhei1' USING DFHEIV0,
 19923           PDEF-ID,
 19924           ERPDEF-KEY,
 19925           DFHEIV99,
 19926           DFHEIV11,
 19927           DFHEIV99
 19928     MOVE EIBRESP  TO WS-RESPONSE
 19929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19930     IF WS-RESP-NORMAL
 19931        MOVE 'Y'                 TO PDEF-MASTER-SW
 19932     ELSE
 19933        MOVE 'N'                 TO PDEF-MASTER-SW
 19934     END-IF
 19935     .
 19936 8587-EXIT.
 19937     EXIT.
 19938 8588-READ-ERPDEF.
 19939
 19940* EXEC CICS READNEXT
 19941*       DATASET   (PDEF-ID)
 19942*       RIDFLD    (ERPDEF-KEY)
 19943*       INTO      (PRODUCT-MASTER)
 19944*       RESP      (WS-RESPONSE)
 19945*    END-EXEC
 19946     MOVE LENGTH OF
 19947      PRODUCT-MASTER
 19948       TO DFHEIV12
 19949     MOVE 0
 19950       TO DFHEIV11
 19951*    MOVE '&.IL                  )  N#00018777' TO DFHEIV0
 19952     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 19953     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19954     MOVE X'204E233030303138373737' TO DFHEIV0(25:11)
 19955     CALL 'kxdfhei1' USING DFHEIV0,
 19956           PDEF-ID,
 19957           PRODUCT-MASTER,
 19958           DFHEIV12,
 19959           ERPDEF-KEY,
 19960           DFHEIV99,
 19961           DFHEIV11,
 19962           DFHEIV99,
 19963           DFHEIV99
 19964     MOVE EIBRESP  TO WS-RESPONSE
 19965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19966     IF WS-RESP-NORMAL
 19967        MOVE 'Y'                 TO PDEF-MASTER-SW
 19968     ELSE
 19969        MOVE 'N'                 TO PDEF-MASTER-SW
 19970     END-IF
 19971     .
 19972 8588-EXIT.
 19973     EXIT.
 19974 8589-ENDBR-ERPDEF.
 19975
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 369
* EL050.cbl
 19976* EXEC CICS ENDBR
 19977*       DATASET   (PDEF-ID)
 19978*    END-EXEC
 19979     MOVE 0
 19980       TO DFHEIV11
 19981*    MOVE '&2                    $   #00018792' TO DFHEIV0
 19982     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19983     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19984     MOVE X'2020233030303138373932' TO DFHEIV0(25:11)
 19985     CALL 'kxdfhei1' USING DFHEIV0,
 19986           PDEF-ID,
 19987           DFHEIV11,
 19988           DFHEIV99
 19989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19990     .
 19991 8589-EXIT.
 19992     EXIT.
 19993 8590-READ-CERT-MASTER.
 19994     IF PB-COMPANY-ID = 'UCL'
 19995         GO TO 8690-READ-CERT-MASTER-UCL.
 19996
 19997
 19998* EXEC CICS HANDLE CONDITION
 19999*         NOTFND    (0299-CERT-NOT-FOUND)
 20000*    END-EXEC.
 20001*    MOVE '"$I                   ! : #00018802' TO DFHEIV0
 20002     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20003     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20004     MOVE X'3A20233030303138383032' TO DFHEIV0(25:11)
 20005     CALL 'kxdfhei1' USING DFHEIV0
 20006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20007
 20008
 20009
 20010* EXEC CICS READ
 20011*        DATASET     (CERT-ID)
 20012*        INTO        (CERTIFICATE-MASTER)
 20013*        RIDFLD      (ELCERT-KEY)
 20014*        UPDATE
 20015*    END-EXEC.
 20016     MOVE LENGTH OF
 20017      CERTIFICATE-MASTER
 20018       TO DFHEIV11
 20019*    MOVE '&"IL       EU         (   #00018806' TO DFHEIV0
 20020     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20021     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20022     MOVE X'2020233030303138383036' TO DFHEIV0(25:11)
 20023     CALL 'kxdfhei1' USING DFHEIV0,
 20024           CERT-ID,
 20025           CERTIFICATE-MASTER,
 20026           DFHEIV11,
 20027           ELCERT-KEY,
 20028           DFHEIV99,
 20029           DFHEIV99,
 20030           DFHEIV99
 20031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20032
 20033
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 370
* EL050.cbl
 20034 8590-EXIT.
 20035     EXIT.
 20036
 20037 8690-READ-CERT-MASTER-UCL.
 20038
 20039* EXEC CICS HANDLE CONDITION
 20040*         NOTFND    (8700-READ-CERT-MASTER)
 20041*    END-EXEC.
 20042*    MOVE '"$I                   ! ; #00018817' TO DFHEIV0
 20043     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20045     MOVE X'3B20233030303138383137' TO DFHEIV0(25:11)
 20046     CALL 'kxdfhei1' USING DFHEIV0
 20047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20048
 20049
 20050 8690-READ-CERT-CONT.
 20051
 20052* EXEC CICS READ
 20053*        DATASET     (CERT-ID)
 20054*        INTO        (CERTIFICATE-MASTER)
 20055*        RIDFLD      (ELCERT-KEY)
 20056*        UPDATE
 20057*    END-EXEC.
 20058     MOVE LENGTH OF
 20059      CERTIFICATE-MASTER
 20060       TO DFHEIV11
 20061*    MOVE '&"IL       EU         (   #00018822' TO DFHEIV0
 20062     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20063     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20064     MOVE X'2020233030303138383232' TO DFHEIV0(25:11)
 20065     CALL 'kxdfhei1' USING DFHEIV0,
 20066           CERT-ID,
 20067           CERTIFICATE-MASTER,
 20068           DFHEIV11,
 20069           ELCERT-KEY,
 20070           DFHEIV99,
 20071           DFHEIV99,
 20072           DFHEIV99
 20073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20074
 20075
 20076     GO TO 8590-EXIT.
 20077
 20078 8700-READ-CERT-MASTER.
 20079     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20080     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20081
 20082* EXEC CICS HANDLE CONDITION
 20083*         DUPKEY    (8720-COMP-ACCOUNTS)
 20084*         ENDFILE   (8730-END-BROWSE)
 20085*         NOTFND    (8740-NOT-FOUND)
 20086*    END-EXEC.
 20087*    MOVE '"$$''I                 ! < #00018834' TO DFHEIV0
 20088     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20090     MOVE X'3C20233030303138383334' TO DFHEIV0(25:11)
 20091     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 371
* EL050.cbl
 20092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20093
 20094
 20095
 20096* EXEC CICS STARTBR
 20097*        DATASET     ('ELCERT5')
 20098*        RIDFLD      (ELCERT2-KEY)
 20099*        EQUAL
 20100*    END-EXEC.
 20101     MOVE 'ELCERT5' TO DFHEIV1
 20102     MOVE 0
 20103       TO DFHEIV11
 20104*    MOVE '&,         E          &   #00018840' TO DFHEIV0
 20105     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20106     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20107     MOVE X'2020233030303138383430' TO DFHEIV0(25:11)
 20108     CALL 'kxdfhei1' USING DFHEIV0,
 20109           DFHEIV1,
 20110           ELCERT2-KEY,
 20111           DFHEIV99,
 20112           DFHEIV11,
 20113           DFHEIV99
 20114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20115
 20116
 20117 8710-READ-NEXT.
 20118
 20119* EXEC CICS READNEXT
 20120*        DATASET     ('ELCERT5')
 20121*        INTO        (CERTIFICATE-MASTER)
 20122*        RIDFLD      (ELCERT2-KEY)
 20123*    END-EXEC.
 20124     MOVE LENGTH OF
 20125      CERTIFICATE-MASTER
 20126       TO DFHEIV12
 20127     MOVE 'ELCERT5' TO DFHEIV1
 20128     MOVE 0
 20129       TO DFHEIV11
 20130*    MOVE '&.IL                  )   #00018847' TO DFHEIV0
 20131     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20132     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20133     MOVE X'2020233030303138383437' TO DFHEIV0(25:11)
 20134     CALL 'kxdfhei1' USING DFHEIV0,
 20135           DFHEIV1,
 20136           CERTIFICATE-MASTER,
 20137           DFHEIV12,
 20138           ELCERT2-KEY,
 20139           DFHEIV99,
 20140           DFHEIV11,
 20141           DFHEIV99,
 20142           DFHEIV99
 20143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20144
 20145
 20146 8720-COMP-ACCOUNTS.
 20147
 20148* EXEC CICS ENTER
 20149*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 372
* EL050.cbl
 20150*         FROM (PB-C-LAST-NAME)
 20151*    END-EXEC.
 20152     MOVE 001
 20153       TO DFHEIV11
 20154*    MOVE ':$F                   %   #00018854' TO DFHEIV0
 20155     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20156     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20157     MOVE X'2020233030303138383534' TO DFHEIV0(25:11)
 20158     CALL 'kxdfhei1' USING DFHEIV0,
 20159           DFHEIV11,
 20160           PB-C-LAST-NAME,
 20161           DFHEIV99,
 20162           DFHEIV99
 20163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20164
 20165
 20166
 20167* EXEC CICS ENTER
 20168*         TRACEID (002)
 20169*         FROM (CM-INSURED-LAST-NAME)
 20170*    END-EXEC.
 20171     MOVE 002
 20172       TO DFHEIV11
 20173*    MOVE ':$F                   %   #00018859' TO DFHEIV0
 20174     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20175     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20176     MOVE X'2020233030303138383539' TO DFHEIV0(25:11)
 20177     CALL 'kxdfhei1' USING DFHEIV0,
 20178           DFHEIV11,
 20179           CM-INSURED-LAST-NAME,
 20180           DFHEIV99,
 20181           DFHEIV99
 20182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20183
 20184
 20185     IF PB-CERT-NO NOT = CM-CERT-NO
 20186         GO TO 8730-END-BROWSE.
 20187
 20188     IF PB-ACCOUNT = CM-ACCOUNT
 20189         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20190             MOVE ER-2799        TO WS-ERROR
 20191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20192             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20193             GO TO 8730-END-BROWSE.
 20194
 20195     GO TO 8710-READ-NEXT.
 20196
 20197 8730-END-BROWSE.
 20198
 20199* EXEC CICS ENDBR
 20200*         DATASET    ('ELCERT5')
 20201*    END-EXEC.
 20202     MOVE 'ELCERT5' TO DFHEIV1
 20203     MOVE 0
 20204       TO DFHEIV11
 20205*    MOVE '&2                    $   #00018877' TO DFHEIV0
 20206     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20207     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 373
* EL050.cbl
 20208     MOVE X'2020233030303138383737' TO DFHEIV0(25:11)
 20209     CALL 'kxdfhei1' USING DFHEIV0,
 20210           DFHEIV1,
 20211           DFHEIV11,
 20212           DFHEIV99
 20213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20214
 20215
 20216 8740-NOT-FOUND.
 20217     GO TO 0299-CERT-NOT-FOUND.
 20218
 20219 8750-START-ELSTAT.
 20220
 20221* EXEC CICS STARTBR
 20222*       DATASET   (STAT-ID)
 20223*       RIDFLD    (ELSTAT-KEY)
 20224*       GTEQ
 20225*       RESP      (WS-RESPONSE)
 20226*    END-EXEC
 20227     MOVE 0
 20228       TO DFHEIV11
 20229*    MOVE '&,         G          &  N#00018885' TO DFHEIV0
 20230     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20231     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20232     MOVE X'204E233030303138383835' TO DFHEIV0(25:11)
 20233     CALL 'kxdfhei1' USING DFHEIV0,
 20234           STAT-ID,
 20235           ELSTAT-KEY,
 20236           DFHEIV99,
 20237           DFHEIV11,
 20238           DFHEIV99
 20239     MOVE EIBRESP  TO WS-RESPONSE
 20240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20241     IF WS-RESP-NORMAL
 20242        MOVE 'Y'                 TO STAT-MASTER-SW
 20243     ELSE
 20244        MOVE 'N'                 TO STAT-MASTER-SW
 20245     END-IF
 20246     .
 20247 8750-EXIT.
 20248     EXIT.
 20249 8752-READ-ELSTAT.
 20250
 20251* EXEC CICS READNEXT
 20252*       DATASET   (STAT-ID)
 20253*       RIDFLD    (ELSTAT-KEY)
 20254*       INTO      (STATE-FILE)
 20255*       RESP      (WS-RESPONSE)
 20256*    END-EXEC
 20257     MOVE LENGTH OF
 20258      STATE-FILE
 20259       TO DFHEIV12
 20260     MOVE 0
 20261       TO DFHEIV11
 20262*    MOVE '&.IL                  )  N#00018900' TO DFHEIV0
 20263     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20264     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20265     MOVE X'204E233030303138393030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 374
* EL050.cbl
 20266     CALL 'kxdfhei1' USING DFHEIV0,
 20267           STAT-ID,
 20268           STATE-FILE,
 20269           DFHEIV12,
 20270           ELSTAT-KEY,
 20271           DFHEIV99,
 20272           DFHEIV11,
 20273           DFHEIV99,
 20274           DFHEIV99
 20275     MOVE EIBRESP  TO WS-RESPONSE
 20276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20277     IF WS-RESP-NORMAL
 20278        MOVE 'Y'                 TO STAT-MASTER-SW
 20279     ELSE
 20280        MOVE 'N'                 TO STAT-MASTER-SW
 20281     END-IF
 20282     .
 20283 8752-EXIT.
 20284     EXIT.
 20285 8800-GET-COMP-RATE.
 20286     MOVE +1 TO IB.
 20287     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 20288         ADD +9 TO IB
 20289         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 20290             ADD +9 TO IB
 20291             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 20292                MOVE ZEROS       TO WS-WK-RATE
 20293                GO TO 8800-EXIT.
 20294
 20295     IF PB-I-AGE GREATER CT-AGE (1)
 20296         ADD +3 TO IB
 20297         IF PB-I-AGE GREATER CT-AGE (2)
 20298             ADD +3 TO IB
 20299             IF PB-I-AGE GREATER CT-AGE (3)
 20300                MOVE ZEROS       TO WS-WK-RATE
 20301                GO TO 8800-EXIT.
 20302
 20303     IF WS-WORK-TERM GREATER CT-TRM (1)
 20304         ADD +1 TO IB
 20305         IF WS-WORK-TERM GREATER CT-TRM (2)
 20306             ADD +1 TO IB
 20307             IF WS-WORK-TERM GREATER CT-TRM (3)
 20308                MOVE ZEROS       TO WS-WK-RATE
 20309                GO TO 8800-EXIT.
 20310
 20311     IF CT-RT (IB) NOT NUMERIC
 20312         MOVE CT-RT-R (IB) TO CTBL-TABLE
 20313         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 20314         GO TO 8800-GET-COMP-RATE.
 20315
 20316     MOVE CT-RT (IB) TO WS-WK-RATE.
 20317
 20318 8800-EXIT.
 20319     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 375
* EL050.cbl
 20321 8900-ADDRESS-FILE.
 20322     IF ERACCT-FILE-ADDRESSED
 20323         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 20324         GO TO 8900-ADDRESS-EXIT.
 20325
 20326     IF ELCNTL-FILE-ADDRESSED
 20327         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 20328         GO TO 8900-ADDRESS-EXIT.
 20329
 20330     IF ERPLAN-FILE-ADDRESSED
 20331         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 20332         GO TO 8900-ADDRESS-EXIT.
 20333
 20334     IF ERFORM-FILE-ADDRESSED
 20335         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 20336         GO TO 8900-ADDRESS-EXIT.
 20337
 20338 8900-ADDRESS-EXIT.
 20339     EXIT.
 20340
 20341 9000-READ-CONTROL.
 20342
 20343* EXEC CICS HANDLE CONDITION
 20344*        NOTFND    (9000-NOTFND)
 20345*    END-EXEC.
 20346*    MOVE '"$I                   ! = #00018971' TO DFHEIV0
 20347     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20349     MOVE X'3D20233030303138393731' TO DFHEIV0(25:11)
 20350     CALL 'kxdfhei1' USING DFHEIV0
 20351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20352
 20353
 20354
 20355* EXEC CICS READ
 20356*        DATASET     (CNTL-ID)
 20357*        SET         (ADDRESS OF CONTROL-FILE)
 20358*        RIDFLD      (ELCNTL-KEY)
 20359*        GTEQ
 20360*    END-EXEC.
 20361*    MOVE '&"S        G          (   #00018975' TO DFHEIV0
 20362     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20364     MOVE X'2020233030303138393735' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0,
 20366           CNTL-ID,
 20367           DFHEIV20,
 20368           DFHEIV99,
 20369           ELCNTL-KEY,
 20370           DFHEIV99,
 20371           DFHEIV99,
 20372           DFHEIV99
 20373     SET ADDRESS OF CONTROL-FILE TO
 20374         DFHEIV20
 20375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20376
 20377
 20378     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 376
* EL050.cbl
 20379
 20380 9000-NOTFND.
 20381     IF RC-SW-1 = '1'
 20382        MOVE ER-2616              TO WS-ERROR
 20383        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20384        GO TO 9000-EXIT.
 20385
 20386     IF RC-SW-1 = '2'
 20387        MOVE ER-2602              TO WS-ERROR
 20388        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20389
 20390 9000-EXIT.
 20391      EXIT.
 20392
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 377
* EL050.cbl
 20394 9100-READ-CONTROL.
 20395
 20396* EXEC CICS HANDLE CONDITION
 20397*        NOTFND  (9100-NOTFND)
 20398*        ENDFILE (9100-NOTFND)
 20399*    END-EXEC.
 20400*    MOVE '"$I''                  ! > #00018999' TO DFHEIV0
 20401     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20403     MOVE X'3E20233030303138393939' TO DFHEIV0(25:11)
 20404     CALL 'kxdfhei1' USING DFHEIV0
 20405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20406
 20407
 20408
 20409* EXEC CICS READ
 20410*        DATASET     (CNTL-ID)
 20411*        INTO        (CONTROL-FILE)
 20412*        RIDFLD      (ELCNTL-KEY)
 20413*        GTEQ
 20414*    END-EXEC.
 20415     MOVE LENGTH OF
 20416      CONTROL-FILE
 20417       TO DFHEIV11
 20418*    MOVE '&"IL       G          (   #00019004' TO DFHEIV0
 20419     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20420     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20421     MOVE X'2020233030303139303034' TO DFHEIV0(25:11)
 20422     CALL 'kxdfhei1' USING DFHEIV0,
 20423           CNTL-ID,
 20424           CONTROL-FILE,
 20425           DFHEIV11,
 20426           ELCNTL-KEY,
 20427           DFHEIV99,
 20428           DFHEIV99,
 20429           DFHEIV99
 20430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20431
 20432
 20433     GO TO 9100-EXIT.
 20434
 20435 9100-NOTFND.
 20436     IF RC-SW-2 = '0'
 20437        MOVE '1'                  TO STATE-RECORD-ERROR
 20438        GO TO 9100-EXIT
 20439     END-IF
 20440     IF RC-SW-2 = '1'
 20441        MOVE '1'                  TO LF-BENEFIT-ERROR
 20442        MOVE ER-2604              TO WS-ERROR
 20443        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20444        GO TO 9100-EXIT.
 20445
 20446     IF RC-SW-2 = '2'
 20447        MOVE '1'                  TO AH-BENEFIT-ERROR
 20448        MOVE ER-2605              TO WS-ERROR
 20449        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20450        GO TO 9100-EXIT.
 20451
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 378
* EL050.cbl
 20452     IF RC-SW-2 = '3'
 20453         MOVE ER-2603           TO WS-ERROR
 20454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20455         GO TO 9100-EXIT.
 20456
 20457     IF RC-SW-2 = '4'
 20458         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 20459         GO TO 9100-EXIT.
 20460
 20461     IF RC-SW-2 = '5'
 20462         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 20463         IF WS-AH-INPUT-CD-1 = SPACE
 20464             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 20465         ELSE
 20466             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 20467
 20468 9100-EXIT.
 20469      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 379
* EL050.cbl
 20471 9200-CONTROL-GETMAIN.
 20472
 20473* EXEC CICS GETMAIN
 20474*         LENGTH   (750)
 20475*         SET      (ADDRESS OF CONTROL-FILE)
 20476*    END-EXEC.
 20477     MOVE 750
 20478       TO DFHEIV11
 20479*    MOVE '," L                  $   #00019050' TO DFHEIV0
 20480     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20481     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20482     MOVE X'2020233030303139303530' TO DFHEIV0(25:11)
 20483     CALL 'kxdfhei1' USING DFHEIV0,
 20484           DFHEIV20,
 20485           DFHEIV11,
 20486           DFHEIV99
 20487     SET ADDRESS OF CONTROL-FILE TO
 20488         DFHEIV20
 20489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20490
 20491
 20492     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 20493
 20494 9200-EXIT.
 20495     EXIT.
 20496
 20497 9250-UNLOCK-RETURN.
 20498
 20499* EXEC CICS UNLOCK
 20500*        DATASET   (CERT-ID)
 20501*    END-EXEC.
 20502*    MOVE '&*                    #   #00019061' TO DFHEIV0
 20503     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20504     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20505     MOVE X'2020233030303139303631' TO DFHEIV0(25:11)
 20506     CALL 'kxdfhei1' USING DFHEIV0,
 20507           CERT-ID,
 20508           DFHEIV99
 20509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20510
 20511
 20512 9300-ABEND.
 20513     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 20514
 20515
 20516* EXEC CICS LINK
 20517*        PROGRAM   ('EL004')
 20518*        COMMAREA  (WS-ERROR-LINE)
 20519*        LENGTH    (72)
 20520*    END-EXEC.
 20521     MOVE 'EL004' TO DFHEIV1
 20522     MOVE 72
 20523       TO DFHEIV11
 20524*    MOVE '."C                   ''   #00019068' TO DFHEIV0
 20525     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20526     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20527     MOVE X'2020233030303139303638' TO DFHEIV0(25:11)
 20528     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 380
* EL050.cbl
 20529           DFHEIV1,
 20530           WS-ERROR-LINE,
 20531           DFHEIV11,
 20532           DFHEIV99,
 20533           DFHEIV99,
 20534           DFHEIV99
 20535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20536
 20537
 20538     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 20539
 20540
 20541* EXEC CICS ABEND
 20542*        ABCODE ('EL50')
 20543*    END-EXEC.
 20544     MOVE 'EL50' TO DFHEIV5
 20545*    MOVE '.,A                   "   #00019076' TO DFHEIV0
 20546     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 20547     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 20548     MOVE X'2020233030303139303736' TO DFHEIV0(25:11)
 20549     CALL 'kxdfhei1' USING DFHEIV0,
 20550           DFHEIV5
 20551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20552
 20553
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 381
* EL050.cbl
 20555
 20556******************************************************************
 20557*                                                                *
 20558*            E R R O R   F O R M A T   R O U T I N E             *
 20559*                                                                *
 20560******************************************************************
 20561
 20562 9900-ERROR-FORMAT.
 20563
 20564     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 20565                    PB-COMMON-ERROR (2) OR
 20566                    PB-COMMON-ERROR (3) OR
 20567                    PB-COMMON-ERROR (4) OR
 20568                    PB-COMMON-ERROR (5) OR
 20569                    PB-COMMON-ERROR (6) OR
 20570                    PB-COMMON-ERROR (7) OR
 20571                    PB-COMMON-ERROR (8) OR
 20572                    PB-COMMON-ERROR (9) OR
 20573                    PB-COMMON-ERROR (10)
 20574        GO TO 9900-EXIT.
 20575
 20576     IF PB-NO-OF-ERRORS = +10
 20577        GO TO 9900-EXIT.
 20578
 20579     ADD +1  TO PB-NO-OF-ERRORS.
 20580     MOVE WS-ERROR               TO PB-COMMON-ERROR
 20581                                       (PB-NO-OF-ERRORS).
 20582 9900-EXIT.
 20583     EXIT.
 20584
 20585 9990-RETURN.
 20586     IF BROWSE-STARTED
 20587
 20588* EXEC CICS ENDBR
 20589*            DATASET  (ACCT-ID)
 20590*       END-EXEC.
 20591     MOVE 0
 20592       TO DFHEIV11
 20593*    MOVE '&2                    $   #00019113' TO DFHEIV0
 20594     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20595     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20596     MOVE X'2020233030303139313133' TO DFHEIV0(25:11)
 20597     CALL 'kxdfhei1' USING DFHEIV0,
 20598           ACCT-ID,
 20599           DFHEIV11,
 20600           DFHEIV99
 20601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20602
 20603
 20604 9990-EXIT.
 20605     EXIT.
 20606
 20607 9999-RETURN.
 20608     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 20609
 20610
 20611* EXEC CICS RETURN
 20612*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 382
* EL050.cbl
 20613*    MOVE '.(                    &   #00019123' TO DFHEIV0
 20614     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20615     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20616     MOVE X'2020233030303139313233' TO DFHEIV0(25:11)
 20617     CALL 'kxdfhei1' USING DFHEIV0,
 20618           DFHEIV99,
 20619           DFHEIV99,
 20620           DFHEIV99,
 20621           DFHEIV99,
 20622           DFHEIV99
 20623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20624
 20625
 20626
 20627* GOBACK.
 20628     MOVE '9%                    "   ' TO DFHEIV0
 20629     MOVE 'EL050' TO DFHEIV1
 20630     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20631     GOBACK.
 20632
 20633 9999-DFHBACK SECTION.
 20634     MOVE '9%                    "   ' TO DFHEIV0
 20635     MOVE 'EL050' TO DFHEIV1
 20636     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20637     GOBACK.
 20638 9999-DFHEXIT.
 20639     IF DFHEIGDJ EQUAL 0001
 20640         NEXT SENTENCE
 20641     ELSE IF DFHEIGDJ EQUAL 2
 20642         GO TO 9300-ABEND,
 20643               3990-FILES-NOT-OPEN
 20644         DEPENDING ON DFHEIGDI
 20645     ELSE IF DFHEIGDJ EQUAL 3
 20646         GO TO 6610-START-BROWSE,
 20647               6630-ERRESS-PROBLEM,
 20648               6630-END-OF-FILE
 20649         DEPENDING ON DFHEIGDI
 20650     ELSE IF DFHEIGDJ EQUAL 4
 20651         GO TO 6630-END-OF-FILE,
 20652               6630-ERRESS-PROBLEM,
 20653               6630-ERRESS-PROBLEM,
 20654               6630-END-OF-FILE
 20655         DEPENDING ON DFHEIGDI
 20656     ELSE IF DFHEIGDJ EQUAL 5
 20657         GO TO 6630-END-OF-FILE,
 20658               6630-END-OF-FILE,
 20659               6630-ERRESS-PROBLEM,
 20660               6630-ERRESS-PROBLEM
 20661         DEPENDING ON DFHEIGDI
 20662     ELSE IF DFHEIGDJ EQUAL 6
 20663         GO TO 6660-START-BROWSE,
 20664               6690-ERRESC-PROBLEM,
 20665               6690-ERRESC-PROBLEM,
 20666               6690-END-OF-FILE
 20667         DEPENDING ON DFHEIGDI
 20668     ELSE IF DFHEIGDJ EQUAL 7
 20669         GO TO 6690-END-OF-FILE,
 20670               6690-ERRESC-PROBLEM,
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 383
* EL050.cbl
 20671               6690-ERRESC-PROBLEM,
 20672               6690-END-OF-FILE
 20673         DEPENDING ON DFHEIGDI
 20674     ELSE IF DFHEIGDJ EQUAL 8
 20675         GO TO 6690-END-OF-FILE,
 20676               6690-ERRESC-PROBLEM,
 20677               6690-ERRESC-PROBLEM,
 20678               6690-END-OF-FILE
 20679         DEPENDING ON DFHEIGDI
 20680     ELSE IF DFHEIGDJ EQUAL 9
 20681         GO TO 7250-CONTINUE,
 20682               7250-CONTINUE
 20683         DEPENDING ON DFHEIGDI
 20684     ELSE IF DFHEIGDJ EQUAL 10
 20685         GO TO 7300-CONTINUE,
 20686               7300-CONTINUE
 20687         DEPENDING ON DFHEIGDI
 20688     ELSE IF DFHEIGDJ EQUAL 11
 20689         GO TO 8000-FREE-MAIN
 20690         DEPENDING ON DFHEIGDI
 20691     ELSE IF DFHEIGDJ EQUAL 12
 20692         GO TO 8100-NOTFND,
 20693               8100-NOTFND
 20694         DEPENDING ON DFHEIGDI
 20695     ELSE IF DFHEIGDJ EQUAL 13
 20696         GO TO 8110-NOTFND,
 20697               8110-NOTFND
 20698         DEPENDING ON DFHEIGDI
 20699     ELSE IF DFHEIGDJ EQUAL 14
 20700         GO TO 8130-EXIT
 20701         DEPENDING ON DFHEIGDI
 20702     ELSE IF DFHEIGDJ EQUAL 15
 20703         GO TO 8180-NOTFND
 20704         DEPENDING ON DFHEIGDI
 20705     ELSE IF DFHEIGDJ EQUAL 16
 20706         GO TO 8190-NOTFND
 20707         DEPENDING ON DFHEIGDI
 20708     ELSE IF DFHEIGDJ EQUAL 17
 20709         GO TO 8200-NOTFND
 20710         DEPENDING ON DFHEIGDI
 20711     ELSE IF DFHEIGDJ EQUAL 18
 20712         GO TO 8300-NOTFND,
 20713               8300-ERRESS-PROBLEM,
 20714               8300-ERRESS-PROBLEM,
 20715               8300-NOTFND
 20716         DEPENDING ON DFHEIGDI
 20717     ELSE IF DFHEIGDJ EQUAL 19
 20718         GO TO 8450-FORM-NOT-FOUND,
 20719               8450-FORM-NOT-FOUND
 20720         DEPENDING ON DFHEIGDI
 20721     ELSE IF DFHEIGDJ EQUAL 20
 20722         GO TO 0199-ACCT-NOT-FOUND,
 20723               0199-ACCT-NOT-FOUND
 20724         DEPENDING ON DFHEIGDI
 20725     ELSE IF DFHEIGDJ EQUAL 21
 20726         GO TO 0199-ACCT-NOT-FOUND,
 20727               0199-ACCT-NOT-FOUND
 20728         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 12-Oct-11 08:34 Page 384
* EL050.cbl
 20729     ELSE IF DFHEIGDJ EQUAL 22
 20730         GO TO 8582-COMP-NOT-FOUND,
 20731               8582-COMP-NOT-FOUND
 20732         DEPENDING ON DFHEIGDI
 20733     ELSE IF DFHEIGDJ EQUAL 23
 20734         GO TO 8583-AGTC-NOT-FOUND,
 20735               8583-AGTC-NOT-FOUND
 20736         DEPENDING ON DFHEIGDI
 20737     ELSE IF DFHEIGDJ EQUAL 24
 20738         GO TO 8584-BXRF-NOT-FOUND,
 20739               8584-BXRF-NOT-FOUND
 20740         DEPENDING ON DFHEIGDI
 20741     ELSE IF DFHEIGDJ EQUAL 25
 20742         GO TO 8585-PLAN-NOT-FOUND,
 20743               8585-PLAN-NOT-FOUND
 20744         DEPENDING ON DFHEIGDI
 20745     ELSE IF DFHEIGDJ EQUAL 26
 20746         GO TO 0299-CERT-NOT-FOUND
 20747         DEPENDING ON DFHEIGDI
 20748     ELSE IF DFHEIGDJ EQUAL 27
 20749         GO TO 8700-READ-CERT-MASTER
 20750         DEPENDING ON DFHEIGDI
 20751     ELSE IF DFHEIGDJ EQUAL 28
 20752         GO TO 8720-COMP-ACCOUNTS,
 20753               8730-END-BROWSE,
 20754               8740-NOT-FOUND
 20755         DEPENDING ON DFHEIGDI
 20756     ELSE IF DFHEIGDJ EQUAL 29
 20757         GO TO 9000-NOTFND
 20758         DEPENDING ON DFHEIGDI
 20759     ELSE IF DFHEIGDJ EQUAL 30
 20760         GO TO 9100-NOTFND,
 20761               9100-NOTFND
 20762         DEPENDING ON DFHEIGDI.
 20763     MOVE '9%                    "   ' TO DFHEIV0
 20764     MOVE 'EL050' TO DFHEIV1
 20765     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20766     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       39412     Code:       83824
