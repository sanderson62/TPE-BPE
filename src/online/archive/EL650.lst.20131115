* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL650.cbl
* Options: int("EL650.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL650.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL650.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL650.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL650 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 14:53:46.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.048.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL650.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC4 - ACCOUNT MASTER MAINTENANCE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL650AI FILLER
    38* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    39* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    40*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    41* 121207  CR2007121100001  PEMA  SPACE OUT ORIG DLR NO ON COPY
    42* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    43* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    44******************************************************************
    45
    46 ENVIRONMENT DIVISION.
    47 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL650.cbl
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC  X(32) VALUE '********************************'.
    52 77  FILLER  PIC  X(32) VALUE '*    EL650 WORKING STORAGE     *'.
    53 77  FILLER  PIC  X(32) VALUE '********* VMOD=2.048 ***********'.
    54
    55 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1500.
    56
    57 01  WS-DATE-AREA.
    58     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    59     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    60
    61 01  STANDARD-AREAS.
    62     12  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    63     12  MAP-NAME                PIC  X(8)   VALUE 'EL650A'.
    64     12  MAPSET-NAME             PIC  X(8)   VALUE 'EL650S'.
    65     12  SCREEN-NUMBER           PIC  X(4)   VALUE '650A'.
    66     12  TRANS-ID                PIC  X(4)   VALUE 'EXC4'.
    67     12  EL6311-TRANS-ID         PIC  X(4)   VALUE 'EXB1'.
    68     12  EL1273-TRANS-ID         PIC  X(4)   VALUE 'EXX3'.
    69     12  EL652-TRANS-ID          PIC  X(4)   VALUE 'EXD4'.
    70     12  EL6523-TRANS-ID         PIC  X(4)   VALUE 'EXDD'.
    71     12  EL6311NC-TRANS-ID       PIC  X(4)   VALUE 'NXB1'.
    72     12  EL640-TRANS-ID          PIC  X(4)   VALUE 'EXC1'.
    73     12  EL658-TRANS-ID          PIC  X(4)   VALUE 'EXJ3'.
    74     12  EL130-TRANS-ID          PIC  X(4)   VALUE 'EX19'.
    75     12  EL6503-TRANS-ID         PIC  X(4)   VALUE 'EXC7'.
    76     12  EL6509-TRANS-ID         PIC  X(4)   VALUE 'EXDA'.
    77     12  EL6592-TRANS-ID         PIC  X(4)   VALUE 'EX66'.
    78     12  EL608-TRANS-ID          PIC  X(4)   VALUE 'EX1E'.
    79     12  THIS-PGM                PIC  X(8)   VALUE 'EL650'.
    80     12  PGM-NAME                PIC  X(8).
    81     12  RETURNED-FROM           PIC  X(8)   VALUE SPACES.
    82     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
    83     12  TIME-OUT-R  REDEFINES  TIME-IN.
    84         16  FILLER              PIC  X.
    85         16  TIME-OUT            PIC  99V99.
    86         16  FILLER              PIC  XX.
    87     12  XCTL-005                PIC  X(8)   VALUE 'EL005'.
    88     12  XCTL-010                PIC  X(8)   VALUE 'EL010'.
    89     12  XCTL-126                PIC  X(8)   VALUE 'EL126'.
    90     12  XCTL-EL601              PIC  X(8)   VALUE 'EL601 '.
    91     12  XCTL-6501               PIC  X(8)   VALUE 'EL6501'.
    92     12  XCTL-6502               PIC  X(8)   VALUE 'EL6502'.
    93     12  XCTL-6503               PIC  X(8)   VALUE 'EL6503'.
    94     12  XCTL-6504               PIC  X(8)   VALUE 'EL6504'.
    95     12  XCTL-6505               PIC  X(8)   VALUE 'EL6505'.
    96     12  XCTL-6506               PIC  X(8)   VALUE 'EL6506'.
    97     12  XCTL-6508               PIC  X(8)   VALUE 'EL6508'.
    98     12  XCTL-6509               PIC  X(8)   VALUE 'EL6509'.
    99     12  LINK-001                PIC  X(8)   VALUE 'EL001'.
   100     12  LINK-004                PIC  X(8)   VALUE 'EL004'.
   101     12  LINK-ELDATCV            PIC  X(8)   VALUE 'ELDATCV'.
   102     12  FILE-ID                 PIC  X(8)   VALUE SPACES.
   103     12  CNTL-FILE-ID            PIC  X(8)   VALUE 'ELCNTL'.
   104     12  ACCT-FILE-ID            PIC  X(8)   VALUE 'ERACCT'.
   105     12  COMP-FILE-ID            PIC  X(8)   VALUE 'ERCOMP'.
   106     12  NAME-FILE-ID            PIC  X(8)   VALUE 'ERNAME'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL650.cbl
   107     12  PEND2-FILE-ID           PIC  X(8)   VALUE 'ERPNDB2'.
   108     12  PLAN-FILE-ID            PIC  X(8)   VALUE 'ERPLAN'.
   109     12  ACCT2-FILE-ID           PIC  X(8)   VALUE 'ERACCT2'.
   110     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   111     12  PLAN-REC-LEN            PIC S9(4)   VALUE +420   COMP.
   112     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   113     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   114     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   115     12  ERGXRF-FILE-ID          PIC  X(8)   VALUE 'ERGXRF'.
   116     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   117     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   118     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   119     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   120     12  BIN-MIN-DATE            PIC  XX     VALUE LOW-VALUES.
   121     12  BIN-MAX-DATE            PIC  XX     VALUE LOW-VALUES.
   122     12  B4-ACCT-KEY.
   123         16  B4-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   124         16  B4-ACCT-CARRIER     PIC  X      VALUE SPACES.
   125         16  B4-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   126         16  B4-ACCT-STATE       PIC  XX     VALUE SPACES.
   127         16  B4-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   128         16  B4-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   129         16  B4-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   130     12  AF-ACCT-KEY.
   131         16  AF-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   132         16  AF-ACCT-CARRIER     PIC  X      VALUE SPACES.
   133         16  AF-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   134         16  AF-ACCT-STATE       PIC  XX     VALUE SPACES.
   135         16  AF-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   136         16  AF-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   137         16  AF-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   138     12  GX-AM-CONTROL-PRIMARY.
   139         16  GX-AM-COMPANY-CD    PIC  X      VALUE LOW-VALUES.
   140         16  GX-REST-OF-KEY      PIC  X(21)  VALUE SPACES.
   141         16  GX-AM-CNTL-FILLER   PIC  X(4)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL650.cbl
   143*                                copy ERCGXRF.
   144******************************************************************
   145*                                                                *
   146*                                                                *
   147*                            ERCGXRF                             *
   148*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   149*                            VMOD=2.002                          *
   150*                                                                *
   151*   ONLINE CREDIT SYSTEM                                         *
   152*                                                                *
   153*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   154*                                                                *
   155*   FILE TYPE = VSAM,KSDS                                        *
   156*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   157*                                                                *
   158*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   159*       ALTERNATE PATH = NONE                                    *
   160*                                                                *
   161*   LOG = NO                                                     *
   162*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   163*                                                                *
   164******************************************************************
   165
   166 01  AGENT-CROSS-REFERENCE.
   167     12  GX-RECORD-ID                PIC XX.
   168         88  VALID-GX-ID             VALUE 'GX'.
   169
   170     12  GX-CONTROL-PRIMARY.
   171         16  GX-COMPANY-CD           PIC X.
   172         16  GX-CARRIER              PIC X.
   173         16  GX-GROUPING             PIC X(6).
   174         16  GX-AGENT-NO             PIC X(10).
   175
   176     12  GX-MAINT-INFORMATION.
   177         16  GX-LAST-MAINT-DT        PIC XX.
   178         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   179         16  GX-LAST-MAINT-USER      PIC X(4).
   180         16  FILLER                  PIC X(9).
   181
   182     12  FILLER                      PIC X(37).
   183
   184     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   185
   186     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   187                            DEPENDING ON GX-AGENT-POINTER-CNT.
   188         16  GX-AM-CARRIER           PIC X.
   189         16  GX-AM-GROUPING          PIC X(6).
   190         16  GX-AM-STATE             PIC XX.
   191         16  GX-AM-ACCOUNT           PIC X(10).
   192         16  GX-AM-EXPIRATION-DT     PIC XX.
   193         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   194         16  GX-LAST-BILL-DT         PIC XX.
   195         16  GX-AM-EFF-DT            PIC XX.
   196         16  FILLER                  PIC X(4).
   197
   198******************************************************************
   199 01  WORK-AREAS-AND-SWITCHES.
   200     12  WS-PAGE-LINES               PIC  S99    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL650.cbl
   201     12  WS-ACCT2-FOUND              PIC  X      VALUE 'N'.
   202     12  GETMAIN-SW                  PIC  X      VALUE SPACES.
   203     12  NEW-KEY-SAVE.
   204         16  NEW-KEY-COMPANY-CD      PIC  X      VALUE LOW-VALUES.
   205         16  NEW-KEY-CNTRL           PIC  X(19)  VALUE SPACES.
   206     12  WS-PLAN-KEY.
   207         16  EK-CCGSA-KEY.
   208           18  EK-COMPANY-CD         PIC  X     VALUE LOW-VALUES.
   209           18  EK-CARRIER            PIC  X     VALUE SPACES.
   210           18  EK-GROUPING           PIC  X(6)  VALUE SPACES.
   211           18  EK-STATE              PIC  XX    VALUE SPACES.
   212           18  EK-ACCOUNT            PIC  X(10) VALUE SPACES.
   213         16  EK-BTYPE                PIC  X     VALUE SPACES.
   214         16  EK-BCODE                PIC  XX    VALUE SPACES.
   215         16  EK-REVISION             PIC  XXX   VALUE SPACES.
   216     12  WS-EXP-SAVE                 PIC  XX    VALUE LOW-VALUES.
   217     12  CURRENT-SAVE                PIC  X(6)  VALUE SPACES.
   218     12  SAVE-ACCT-KEY               PIC  X(26).
   219     12  SAVE-CURR-EXP-DT            PIC  XX    VALUE LOW-VALUES.
   220     12  SAVE-CURR-EFF-DT            PIC  XX    VALUE LOW-VALUES.
   221     12  WS-EFFCHG-SAVE              PIC  9(11) VALUE ZEROS.
   222     12  WS-EXPCHG-SAVE              PIC  9(11) VALUE ZEROS.
   223     12  BIN-CURRENT-SAVE            PIC  XX    VALUE LOW-VALUES.
   224     12  WS-VERIFY-AREA.
   225         16  FILLER      OCCURS  33  TIMES
   226                             INDEXED  BY  WS-INDEX.
   227             20  WS-ACCT-KEY         PIC  X(20).
   228             20  WS-ACCT-EXP-DT      PIC  XX.
   229             20  WS-ACCT-EFF-DT      PIC  XX.
   230             20  WS-ACCT-HI-CERT     PIC  XX.
   231             20  WS-ACCT-LO-CERT     PIC  XX.
   232     12  WS-TEST-KEY                 PIC  X(20)  VALUE SPACES.
   233     12  WS-SAVE-VERIFY-KEY          PIC  X(20)  VALUE SPACES.
   234     12  WS-ACCT-VERIFY-KEY.
   235         16  WS-ACCT-VER-COMP-CD     PIC  X      VALUE LOW-VALUES.
   236         16  WS-ACCT-VER-CARR        PIC  X      VALUE SPACES.
   237         16  WS-ACCT-VER-GROUP       PIC  X(6)   VALUE SPACES.
   238         16  WS-ACCT-VER-STATE       PIC  XX     VALUE SPACES.
   239         16  WS-ACCT-VER-ACCOUNT     PIC  X(10)  VALUE SPACES.
   240         16  WS-ACCT-VER-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   241     12  filler                      pic x(10)   value spaces.
   242     12  KEY-SAVE.
   243         16  SV-CO                   PIC  X      VALUE LOW-VALUES.
   244         16  SV-CARRIER              PIC  X      VALUE SPACES.
   245         16  SV-GROUPING             PIC  X(6)   VALUE SPACES.
   246         16  SV-STATE                PIC  XX     VALUE SPACES.
   247         16  SV-ACCOUNT              PIC  X(10)  VALUE SPACES.
   248
   249     12  WS-DEEDIT-FIELD              PIC X(10)  VALUE SPACES.
   250     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   251                                      PIC X(10).
   252     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   253         16  FILLER                   PIC X(4).
   254         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   255
   256     12  WS-AXRF-KEY.
   257         16  WS-AXRF-COMPANY-CD      PIC  X     VALUE LOW-VALUES.
   258         16  WS-AXRF-CARRIER         PIC  X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL650.cbl
   259         16  WS-AXRF-GROUPING        PIC  X(6)  VALUE SPACES.
   260         16  WS-AXRF-AGENT-NO        PIC  X(10) VALUE SPACES.
   261     12  AXRF-SUB                    PIC S9(4) COMP VALUE +0.
   262     12  GX-AGENT-SUB                PIC S9(4) COMP VALUE +0.
   263     12  COMM-WORK-SUB               PIC S9(4) COMP VALUE +0.
   264     12  COMM-WORK-SUB2              PIC S9(4) COMP VALUE +0.
   265     12  ELCNTL-KEY.
   266         16  CNTL-COMP-ID            PIC  X(3) VALUE SPACES.
   267         16  CNTL-REC-TYPE           PIC  X    VALUE SPACES.
   268         16  CNTL-ACCESS.
   269             20  CNTL-STATE          PIC  XX   VALUE SPACES.
   270             20  FILLER              PIC  X    VALUE SPACES.
   271             20  CNTL-CARRIER        PIC  X    VALUE SPACES.
   272         16  CNTL-SEQ-NO             PIC S9(4) COMP VALUE +0.
   273     12  ERPNDB-KEY.
   274         16  PNDB-COMPANY-CD-A1      PIC  X  VALUE LOW-VALUES.
   275         16  PNDB-CARRIER            PIC  X    VALUE SPACES.
   276         16  PNDB-GROUPING           PIC  X(6) VALUE SPACES.
   277         16  PNDB-STATE              PIC  XX   VALUE SPACES.
   278         16  PNDB-ACCOUNT            PIC  X(10) VALUE SPACES.
   279         16  PNDB-CERT-EFF-DT        PIC  XX    VALUE LOW-VALUES.
   280         16  PNDB-CERT-NO            PIC  X(11) VALUE SPACES.
   281         16  PNDB-ALT-CHG-SEQ-NO     PIC S9(4)   COMP VALUE +0.
   282         16  PNDB-RECORD-TYPE        PIC  X   VALUE SPACES.
   283     12  REC-SW                      PIC  9          VALUE 0.
   284         88  REC-FOUND                               VALUE 1.
   285     12  K-WITH-LINE-USED            PIC  9          VALUE 0.
   286         88  K-WITH-LINE-NO                          VALUE 1.
   287     12  RETURN-FROM-SW              PIC  9          VALUE 0.
   288         88  RETURNING-FROM-6501                     VALUE 1.
   289     12  BROWSE-STARTED-SW           PIC  X          VALUE ' '.
   290         88  BROWSE-STARTED                          VALUE 'Y'.
   291     12  FIRST-TIME-SW               PIC  X          VALUE ' '.
   292         88  FIRST-TIME                              VALUE 'Y'.
   293     12  FROM-WHERE-SW               PIC  X          VALUE ' '.
   294         88  FROM-DELETE                             VALUE '1'.
   295         88  FROM-CHANGE                             VALUE '2'.
   296     12  FROM-EL608-SW               PIC  X          VALUE 'N'.
   297     12  PENDING-BUSINESS-SW         PIC  X          VALUE 'N'.
   298         88  THERE-IS-PENDING-BUSINESS               VALUE 'Y'.
   299     12  PENDING-BROWSE-SW           PIC  X          VALUE 'N'.
   300         88  PENDING-BROWSE-STARTED                  VALUE 'Y'.
   301     12  TS-QUEUE.
   302         16  TS-SCREEN               PIC  X(4)   VALUE SPACES.
   303         16  TS-TERM                 PIC  X(4)   VALUE SPACES.
   304     12  TS-LENGTH                   PIC S9(4) COMP VALUE +640.
   305     12  TS-ITEM                     PIC S9(4) COMP VALUE +0.
   306     12  AGT-SUB                     PIC 99      VALUE ZEROS.
   307     12  VALID-AGT-SW                PIC X       VALUE 'N'.
   308
   309 01  ERROR-MESSAGES.
   310     12  ER-0000             PIC  X(4)       VALUE '0000'.
   311     12  ER-0004             PIC  X(4)       VALUE '0004'.
   312     12  ER-0008             PIC  X(4)       VALUE '0008'.
   313     12  ER-0022             PIC  X(4)       VALUE '0022'.
   314     12  ER-0023             PIC  X(4)       VALUE '0023'.
   315     12  ER-0029             PIC  X(4)       VALUE '0029'.
   316     12  ER-0042             PIC  X(4)       VALUE '0042'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL650.cbl
   317     12  ER-0050             PIC  X(4)       VALUE '0050'.
   318     12  ER-0052             PIC  X(4)       VALUE '0052'.
   319     12  ER-0066             PIC  X(4)       VALUE '0066'.
   320     12  ER-0067             PIC  X(4)       VALUE '0067'.
   321     12  ER-0070             PIC  X(4)       VALUE '0070'.
   322     12  ER-0144             PIC  X(4)       VALUE '0144'.
   323     12  ER-0168             PIC  X(4)       VALUE '0168'.
   324     12  ER-0193             PIC  X(4)       VALUE '0193'.
   325     12  ER-0195             PIC  X(4)       VALUE '0195'.
   326     12  ER-0216             PIC  X(4)       VALUE '0216'.
   327     12  ER-0226             PIC  X(4)       VALUE '0226'.
   328     12  ER-0348             PIC  X(4)       VALUE '0348'.
   329     12  ER-0453             PIC  X(4)       VALUE '0453'.
   330     12  ER-0454             PIC  X(4)       VALUE '0454'.
   331     12  ER-0455             PIC  X(4)       VALUE '0455'.
   332     12  ER-0456             PIC  X(4)       VALUE '0456'.
   333     12  ER-0457             PIC  X(4)       VALUE '0457'.
   334     12  ER-0470             PIC  X(4)       VALUE '0470'.
   335     12  ER-0471             PIC  X(4)       VALUE '0471'.
   336     12  ER-0472             PIC  X(4)       VALUE '0472'.
   337     12  ER-0482             PIC  X(4)       VALUE '0482'.
   338     12  ER-0561             PIC  X(4)       VALUE '0561'.
   339     12  ER-0619             PIC  X(4)       VALUE '0619'.
   340     12  ER-0630             PIC  X(4)       VALUE '0630'.
   341     12  ER-0668             PIC  X(4)       VALUE '0668'.
   342     12  ER-0899             PIC  X(4)       VALUE '0899'.
   343     12  ER-1220             PIC  X(4)       VALUE '1220'.
   344     12  ER-1228             PIC  X(4)       VALUE '1228'.
   345     12  ER-1238             PIC  X(4)       VALUE '1238'.
   346     12  ER-1299             PIC  X(4)       VALUE '1299'.
   347     12  ER-1612             PIC  X(4)       VALUE '1612'.
   348     12  ER-2051             PIC  X(4)       VALUE '2051'.
   349     12  ER-2052             PIC  X(4)       VALUE '2052'.
   350     12  ER-2053             PIC  X(4)       VALUE '2053'.
   351     12  ER-2054             PIC  X(4)       VALUE '2054'.
   352     12  ER-2058             PIC  X(4)       VALUE '2058'.
   353     12  ER-2059             PIC  X(4)       VALUE '2059'.
   354     12  ER-2060             PIC  X(4)       VALUE '2060'.
   355     12  ER-2061             PIC  X(4)       VALUE '2061'.
   356     12  ER-2062             PIC  X(4)       VALUE '2062'.
   357     12  ER-2063             PIC  X(4)       VALUE '2063'.
   358     12  ER-2064             PIC  X(4)       VALUE '2064'.
   359     12  ER-2065             PIC  X(4)       VALUE '2065'.
   360     12  ER-2066             PIC  X(4)       VALUE '2066'.
   361     12  ER-2068             PIC  X(4)       VALUE '2068'.
   362     12  ER-2069             PIC  X(4)       VALUE '2069'.
   363     12  ER-2070             PIC  X(4)       VALUE '2070'.
   364     12  ER-2072             PIC  X(4)       VALUE '2072'.
   365     12  ER-2073             PIC  X(4)       VALUE '2073'.
   366     12  ER-2074             PIC  X(4)       VALUE '2074'.
   367     12  ER-2075             PIC  X(4)       VALUE '2075'.
   368     12  ER-2087             PIC  X(4)       VALUE '2087'.
   369     12  ER-2113             PIC  X(4)       VALUE '2113'.
   370     12  ER-2151             PIC  X(4)       VALUE '2151'.
   371     12  ER-2370             PIC  X(4)       VALUE '2370'.
   372     12  ER-2572             PIC  X(4)       VALUE '2572'.
   373     12  ER-3155             PIC  X(4)       VALUE '3155'.
   374     12  ER-3785             PIC  X(4)       VALUE '3785'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL650.cbl
   375     12  ER-9638             PIC  X(4)       VALUE '9638'.
   376     12  ER-9999             PIC  X(4)       VALUE '9999'.
   377
   378 01  TEMP-STORAGE-RECORD.
   379     12  TS-ACCT-KEY     OCCURS  32  TIMES
   380                             INDEXED  BY  TS-INDEX
   381                                 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL650.cbl
   383*    COPY ELCSCTM.
   384******************************************************************
   385*                                                                *
   386*                                                                *
   387*                            ELCSCTM                             *
   388*                            VMOD=2.001                          *
   389*                                                                *
   390*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   391*                                                                *
   392******************************************************************
   393 01  SECURITY-MESSAGE.
   394     12  FILLER                          PIC X(30)
   395            VALUE '** LOGIC SECURITY VIOLATION -'.
   396     12  SM-READ                         PIC X(6).
   397     12  FILLER                          PIC X(5)
   398            VALUE ' PGM='.
   399     12  SM-PGM                          PIC X(6).
   400     12  FILLER                          PIC X(5)
   401            VALUE ' OPR='.
   402     12  SM-PROCESSOR-ID                 PIC X(4).
   403     12  FILLER                          PIC X(6)
   404            VALUE ' TERM='.
   405     12  SM-TERMID                       PIC X(4).
   406     12  FILLER                          PIC XX   VALUE SPACE.
   407     12  SM-JUL-DATE                     PIC 9(5).
   408     12  FILLER                          PIC X    VALUE SPACE.
   409     12  SM-TIME                         PIC 99.99.
   410
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL650.cbl
   412*    COPY ELCSCRTY.
   413******************************************************************
   414*                                                                *
   415*                                                                *
   416*                            ELCSCRTY                            *
   417*                            VMOD=2.001                          *
   418*                                                                *
   419*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   420*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   421*        SAVED IN PI-SECURITY-ADDRESS.                           *
   422*                                                                *
   423******************************************************************
   424 01  SECURITY-CONTROL.
   425     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   426     12  FILLER                       PIC XX    VALUE 'SC'.
   427     12  SC-CREDIT-CODES.
   428         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   429             20  SC-CREDIT-DISPLAY    PIC X.
   430             20  SC-CREDIT-UPDATE     PIC X.
   431     12  SC-CLAIMS-CODES.
   432         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   433             20  SC-CLAIMS-DISPLAY    PIC X.
   434             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL650.cbl
   436*    COPY ELCLOGOF.
   437******************************************************************
   438*                                                                *
   439*                                                                *
   440*                            ELCLOGOF.                           *
   441*                            VMOD=2.001                          *
   442*                                                                *
   443*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   444*                                                                *
   445******************************************************************
   446 01  CLASIC-LOGOFF.
   447     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   448     12  LOGOFF-TEXT.
   449         16  FILLER          PIC X(5)    VALUE SPACES.
   450         16  LOGOFF-MSG.
   451             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   452             20  FILLER      PIC X       VALUE SPACES.
   453             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   454         16  FILLER          PIC X(80)
   455           VALUE '* YOU ARE NOW LOGGED OFF'.
   456         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   457         16  FILLER          PIC X       VALUE QUOTE.
   458         16  LOGOFF-SYS-MSG  PIC X(17)
   459           VALUE 'S CLAS-IC SYSTEM '.
   460     12  TEXT-MESSAGES.
   461         16  UNACCESS-MSG    PIC X(29)
   462             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   463         16  PGMIDERR-MSG    PIC X(17)
   464             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL650.cbl
   466*    COPY ELCDATE.
   467******************************************************************
   468*                                                                *
   469*                                                                *
   470*                            ELCDATE.                            *
   471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   472*                            VMOD=2.003
   473*                                                                *
   474*                                                                *
   475*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   476*                 LENGTH = 200                                   *
   477******************************************************************
   478
   479 01  DATE-CONVERSION-DATA.
   480     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   481     12  DC-OPTION-CODE                PIC X.
   482         88  BIN-TO-GREG                VALUE ' '.
   483         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   484         88  EDIT-GREG-TO-BIN           VALUE '2'.
   485         88  YMD-GREG-TO-BIN            VALUE '3'.
   486         88  MDY-GREG-TO-BIN            VALUE '4'.
   487         88  JULIAN-TO-BIN              VALUE '5'.
   488         88  BIN-PLUS-ELAPSED           VALUE '6'.
   489         88  FIND-CENTURY               VALUE '7'.
   490         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   491         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   492         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   493         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   494         88  JULIAN-TO-BIN-3            VALUE 'C'.
   495         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   496         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   497         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   498         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   499         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   500         88  CHECK-LEAP-YEAR            VALUE 'H'.
   501         88  BIN-3-TO-GREG              VALUE 'I'.
   502         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   503         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   504         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   505         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   506         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   507         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   508         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   509         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   510         88  THREE-CHARACTER-BIN
   511                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   512         88  GREGORIAN-TO-BIN
   513                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   514         88  BIN-TO-GREGORIAN
   515                  VALUES ' ' '1' 'I' '8' 'G'.
   516         88  JULIAN-TO-BINARY
   517                  VALUES '5' 'C' 'E' 'F'.
   518     12  DC-ERROR-CODE                 PIC X.
   519         88  NO-CONVERSION-ERROR        VALUE ' '.
   520         88  DATE-CONVERSION-ERROR
   521                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   522         88  DATE-IS-ZERO               VALUE '1'.
   523         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL650.cbl
   524         88  DATE-IS-INVALID            VALUE '3'.
   525         88  DATE1-GREATER-DATE2        VALUE '4'.
   526         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   527         88  DATE-INVALID-OPTION        VALUE '9'.
   528         88  INVALID-CENTURY            VALUE 'A'.
   529         88  ONLY-CENTURY               VALUE 'B'.
   530         88  ONLY-LEAP-YEAR             VALUE 'C'.
   531         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   532     12  DC-END-OF-MONTH               PIC X.
   533         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   534     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   535         88  USE-NORMAL-PROCESS         VALUE ' '.
   536         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   537         88  ADJUST-UP-100-YRS          VALUE '2'.
   538     12  FILLER                        PIC X.
   539     12  DC-CONVERSION-DATES.
   540         16  DC-BIN-DATE-1             PIC XX.
   541         16  DC-BIN-DATE-2             PIC XX.
   542         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   543         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   544                       DC-GREG-DATE-1-EDIT.
   545             20  DC-EDIT1-MONTH        PIC 99.
   546             20  SLASH1-1              PIC X.
   547             20  DC-EDIT1-DAY          PIC 99.
   548             20  SLASH1-2              PIC X.
   549             20  DC-EDIT1-YEAR         PIC 99.
   550         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   551         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   552                     DC-GREG-DATE-2-EDIT.
   553             20  DC-EDIT2-MONTH        PIC 99.
   554             20  SLASH2-1              PIC X.
   555             20  DC-EDIT2-DAY          PIC 99.
   556             20  SLASH2-2              PIC X.
   557             20  DC-EDIT2-YEAR         PIC 99.
   558         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   559         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   560                     DC-GREG-DATE-1-YMD.
   561             20  DC-YMD-YEAR           PIC 99.
   562             20  DC-YMD-MONTH          PIC 99.
   563             20  DC-YMD-DAY            PIC 99.
   564         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   565         16  DC-GREG-DATE-1-MDY-R REDEFINES
   566                      DC-GREG-DATE-1-MDY.
   567             20  DC-MDY-MONTH          PIC 99.
   568             20  DC-MDY-DAY            PIC 99.
   569             20  DC-MDY-YEAR           PIC 99.
   570         16  DC-GREG-DATE-1-ALPHA.
   571             20  DC-ALPHA-MONTH        PIC X(10).
   572             20  DC-ALPHA-DAY          PIC 99.
   573             20  FILLER                PIC XX.
   574             20  DC-ALPHA-CENTURY.
   575                 24 DC-ALPHA-CEN-N     PIC 99.
   576             20  DC-ALPHA-YEAR         PIC 99.
   577         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   578         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   579         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   580         16  DC-JULIAN-DATE            PIC 9(05).
   581         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL650.cbl
   582                                       PIC 9(05).
   583         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   584             20  DC-JULIAN-YEAR        PIC 99.
   585             20  DC-JULIAN-DAYS        PIC 999.
   586         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   587         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   588         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   589     12  DATE-CONVERSION-VARIBLES.
   590         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   591         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   592             20  FILLER                PIC 9(3).
   593             20  HOLD-CEN-1-CCYY.
   594                 24  HOLD-CEN-1-CC     PIC 99.
   595                 24  HOLD-CEN-1-YY     PIC 99.
   596             20  HOLD-CEN-1-MO         PIC 99.
   597             20  HOLD-CEN-1-DA         PIC 99.
   598         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   599             20  HOLD-CEN-1-R-MO       PIC 99.
   600             20  HOLD-CEN-1-R-DA       PIC 99.
   601             20  HOLD-CEN-1-R-CCYY.
   602                 24  HOLD-CEN-1-R-CC   PIC 99.
   603                 24  HOLD-CEN-1-R-YY   PIC 99.
   604             20  FILLER                PIC 9(3).
   605         16  HOLD-CENTURY-1-X.
   606             20  FILLER                PIC X(3)  VALUE SPACES.
   607             20  HOLD-CEN-1-X-CCYY.
   608                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   609                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   610             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   611             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   612         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   613             20  HOLD-CEN-1-R-X-MO     PIC XX.
   614             20  HOLD-CEN-1-R-X-DA     PIC XX.
   615             20  HOLD-CEN-1-R-X-CCYY.
   616                 24  HOLD-CEN-1-R-X-CC PIC XX.
   617                 24  HOLD-CEN-1-R-X-YY PIC XX.
   618             20  FILLER                PIC XXX.
   619         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   620         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   621         16  DC-JULIAN-DATE-1          PIC 9(07).
   622         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   623             20  DC-JULIAN-1-CCYY.
   624                 24  DC-JULIAN-1-CC    PIC 99.
   625                 24  DC-JULIAN-1-YR    PIC 99.
   626             20  DC-JULIAN-DA-1        PIC 999.
   627         16  DC-JULIAN-DATE-2          PIC 9(07).
   628         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   629             20  DC-JULIAN-2-CCYY.
   630                 24  DC-JULIAN-2-CC    PIC 99.
   631                 24  DC-JULIAN-2-YR    PIC 99.
   632             20  DC-JULIAN-DA-2        PIC 999.
   633         16  DC-GREG-DATE-A-EDIT.
   634             20  DC-EDITA-MONTH        PIC 99.
   635             20  SLASHA-1              PIC X VALUE '/'.
   636             20  DC-EDITA-DAY          PIC 99.
   637             20  SLASHA-2              PIC X VALUE '/'.
   638             20  DC-EDITA-CCYY.
   639                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL650.cbl
   640                 24  DC-EDITA-YEAR     PIC 99.
   641         16  DC-GREG-DATE-B-EDIT.
   642             20  DC-EDITB-MONTH        PIC 99.
   643             20  SLASHB-1              PIC X VALUE '/'.
   644             20  DC-EDITB-DAY          PIC 99.
   645             20  SLASHB-2              PIC X VALUE '/'.
   646             20  DC-EDITB-CCYY.
   647                 24  DC-EDITB-CENT     PIC 99.
   648                 24  DC-EDITB-YEAR     PIC 99.
   649         16  DC-GREG-DATE-CYMD         PIC 9(08).
   650         16  DC-GREG-DATE-CYMD-R REDEFINES
   651                              DC-GREG-DATE-CYMD.
   652             20  DC-CYMD-CEN           PIC 99.
   653             20  DC-CYMD-YEAR          PIC 99.
   654             20  DC-CYMD-MONTH         PIC 99.
   655             20  DC-CYMD-DAY           PIC 99.
   656         16  DC-GREG-DATE-MDCY         PIC 9(08).
   657         16  DC-GREG-DATE-MDCY-R REDEFINES
   658                              DC-GREG-DATE-MDCY.
   659             20  DC-MDCY-MONTH         PIC 99.
   660             20  DC-MDCY-DAY           PIC 99.
   661             20  DC-MDCY-CEN           PIC 99.
   662             20  DC-MDCY-YEAR          PIC 99.
   663    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   664        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   665    12  DC-EL310-DATE                  PIC X(21).
   666    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL650.cbl
   668*    COPY ELCATTR.
   669******************************************************************
   670*                                                                *
   671*                            ELCATTR.                            *
   672*                            VMOD=2.001                          *
   673*                                                                *
   674*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   675*                                                                *
   676*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   677*                                                                *
   678*                   POS 1   P=PROTECTED                          *
   679*                           U=UNPROTECTED                        *
   680*                           S=ASKIP                              *
   681*                   POS 2   A=ALPHA/NUMERIC                      *
   682*                           N=NUMERIC                            *
   683*                   POS 3   N=NORMAL                             *
   684*                           B=BRIGHT                             *
   685*                           D=DARK                               *
   686*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   687*                           OF=MODIFIED DATA TAG OFF             *
   688*                                                                *
   689*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   690******************************************************************
   691 01  ATTRIBUTE-LIST.
   692     12  AL-PABOF            PIC X       VALUE 'Y'.
   693     12  AL-PABON            PIC X       VALUE 'Z'.
   694     12  AL-PADOF            PIC X       VALUE '%'.
   695     12  AL-PADON            PIC X       VALUE '_'.
   696     12  AL-PANOF            PIC X       VALUE '-'.
   697     12  AL-PANON            PIC X       VALUE '/'.
   698     12  AL-SABOF            PIC X       VALUE '8'.
   699     12  AL-SABON            PIC X       VALUE '9'.
   700     12  AL-SADOF            PIC X       VALUE '@'.
   701     12  AL-SADON            PIC X       VALUE QUOTE.
   702     12  AL-SANOF            PIC X       VALUE '0'.
   703     12  AL-SANON            PIC X       VALUE '1'.
   704     12  AL-UABOF            PIC X       VALUE 'H'.
   705     12  AL-UABON            PIC X       VALUE 'I'.
   706     12  AL-UADOF            PIC X       VALUE '<'.
   707     12  AL-UADON            PIC X       VALUE '('.
   708     12  AL-UANOF            PIC X       VALUE ' '.
   709     12  AL-UANON            PIC X       VALUE 'A'.
   710     12  AL-UNBOF            PIC X       VALUE 'Q'.
   711     12  AL-UNBON            PIC X       VALUE 'R'.
   712     12  AL-UNDOF            PIC X       VALUE '*'.
   713     12  AL-UNDON            PIC X       VALUE ')'.
   714     12  AL-UNNOF            PIC X       VALUE '&'.
   715     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL650.cbl
   717*    COPY ELCEMIB.
   718******************************************************************
   719*                                                                *
   720*                                                                *
   721*                            ELCEMIB.                            *
   722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   723*                            VMOD=2.005                          *
   724*                                                                *
   725*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   726*                                                                *
   727******************************************************************
   728 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   729     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   730     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   731     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   732     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   733     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   734     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   735     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   736     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   737     12  EMI-SWITCH1             PIC X        VALUE '1'.
   738         88  EMI-NO-ERRORS                    VALUE '1'.
   739         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   740         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   741     12  EMI-SWITCH2             PIC X        VALUE '1'.
   742         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   743     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   744         88  EMI-AREA1-EMPTY                  VALUE '1'.
   745         88  EMI-AREA1-FULL                   VALUE '2'.
   746     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   747         88  EMI-AREA2-EMPTY                  VALUE '1'.
   748         88  EMI-AREA2-FULL                   VALUE '2'.
   749     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   750         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   751         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   752         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   753         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   754         88  EMI-BYPASS-FATALS                VALUE 'X'.
   755     12  EMI-ERROR-LINES.
   756         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   757         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   758         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   759         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   760             20  EMI-ERR-CODES OCCURS 10 TIMES.
   761                 24  EMI-ERR-NUM         PIC X(4).
   762                 24  EMI-FILLER          PIC X.
   763                 24  EMI-SEV             PIC X.
   764                 24  FILLER              PIC X.
   765             20  FILLER                  PIC X(02).
   766     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   767         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   768             20  EMI-ERROR-NUMBER    PIC X(4).
   769             20  EMI-FILL            PIC X.
   770             20  EMI-SEVERITY        PIC X.
   771             20  FILLER              PIC X.
   772             20  EMI-ERROR-TEXT.
   773                 24  EMI-TEXT-VARIABLE   PIC X(10).
   774                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL650.cbl
   775     12  EMI-SEVERITY-SAVE           PIC X.
   776         88  EMI-NOTE                    VALUE 'N'.
   777         88  EMI-WARNING                 VALUE 'W'.
   778         88  EMI-FORCABLE                VALUE 'F'.
   779         88  EMI-FATAL                   VALUE 'X'.
   780     12  EMI-MESSAGE-FLAG            PIC X.
   781         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   782         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   783     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   784     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   785         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   786         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   787         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   788     12  FILLER                      PIC X(137)  VALUE SPACES.
   789     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   790     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   791     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   792     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL650.cbl
   794*    COPY ELCINTF.
   795******************************************************************
   796*                                                                *
   797*                                                                *
   798*                            ELCINTF.                            *
   799*                            VMOD=2.017                          *
   800*                                                                *
   801*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   802*                                                                *
   803*       LENGTH = 1024                                            *
   804*                                                                *
   805******************************************************************
   806 01  PROGRAM-INTERFACE-BLOCK.
   807     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   808     12  PI-CALLING-PROGRAM              PIC X(8).
   809     12  PI-SAVED-PROGRAM-1              PIC X(8).
   810     12  PI-SAVED-PROGRAM-2              PIC X(8).
   811     12  PI-SAVED-PROGRAM-3              PIC X(8).
   812     12  PI-SAVED-PROGRAM-4              PIC X(8).
   813     12  PI-SAVED-PROGRAM-5              PIC X(8).
   814     12  PI-SAVED-PROGRAM-6              PIC X(8).
   815     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   816     12  PI-COMPANY-ID                   PIC XXX.
   817     12  PI-COMPANY-CD                   PIC X.
   818
   819     12  PI-COMPANY-PASSWORD             PIC X(8).
   820
   821     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   822
   823     12  PI-CONTROL-IN-PROGRESS.
   824         16  PI-CARRIER                  PIC X.
   825         16  PI-GROUPING                 PIC X(6).
   826         16  PI-STATE                    PIC XX.
   827         16  PI-ACCOUNT                  PIC X(10).
   828         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   829                                         PIC X(10).
   830         16  PI-CLAIM-CERT-GRP.
   831             20  PI-CLAIM-NO             PIC X(7).
   832             20  PI-CERT-NO.
   833                 25  PI-CERT-PRIME       PIC X(10).
   834                 25  PI-CERT-SFX         PIC X.
   835             20  PI-CERT-EFF-DT          PIC XX.
   836         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   837             20  PI-PLAN-CODE            PIC X(2).
   838             20  PI-REVISION-NUMBER      PIC X(3).
   839             20  PI-PLAN-EFF-DT          PIC X(2).
   840             20  PI-PLAN-EXP-DT          PIC X(2).
   841             20  FILLER                  PIC X(11).
   842         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   843             20  PI-OE-REFERENCE-1.
   844                 25  PI-OE-REF-1-PRIME   PIC X(18).
   845                 25  PI-OE-REF-1-SUFF    PIC XX.
   846
   847     12  PI-SESSION-IN-PROGRESS          PIC X.
   848         88  CLAIM-SESSION                   VALUE '1'.
   849         88  CREDIT-SESSION                  VALUE '2'.
   850         88  WARRANTY-SESSION                VALUE '3'.
   851         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL650.cbl
   852         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   853
   854
   855*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   856
   857     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   858     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   859
   860     12  PI-CREDIT-USER                  PIC X.
   861         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   862         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   863
   864     12  PI-CLAIM-USER                   PIC X.
   865         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   866         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   867
   868     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   869         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   870         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   871         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   872         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   873         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   874
   875     12  PI-PROCESSOR-ID                 PIC X(4).
   876
   877     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   878
   879     12  PI-MEMBER-CAPTION               PIC X(10).
   880
   881     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   882         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   883
   884     12  PI-LIFE-OVERRIDE-L1             PIC X.
   885     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   886     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   887     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   888
   889     12  PI-AH-OVERRIDE-L1               PIC X.
   890     12  PI-AH-OVERRIDE-L2               PIC XX.
   891     12  PI-AH-OVERRIDE-L6               PIC X(6).
   892     12  PI-AH-OVERRIDE-L12              PIC X(12).
   893
   894     12  PI-NEW-SYSTEM                   PIC X(2).
   895
   896     12  PI-PRIMARY-CERT-NO              PIC X(11).
   897     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   898         88  PI-USES-PAID-TO                 VALUE '1'.
   899     12  PI-CRDTCRD-SYSTEM.
   900         16  PI-CRDTCRD-USER             PIC X.
   901             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   902             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   903         16  PI-CC-MONTH-END-DT          PIC XX.
   904     12  PI-PROCESSOR-PRINTER            PIC X(4).
   905
   906     12  PI-OE-REFERENCE-2.
   907         16  PI-OE-REF-2-PRIME           PIC X(10).
   908         16  PI-OE-REF-2-SUFF            PIC X.
   909
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL650.cbl
   910     12  PI-REM-TRM-CALC-OPTION          PIC X.
   911
   912     12  PI-LANGUAGE-TYPE                PIC X.
   913             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   914             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   915             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   916
   917     12  PI-POLICY-LINKAGE-IND           PIC X.
   918         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   919         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   920                                                   LOW-VALUES.
   921
   922     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   923     12  PI-CLAIM-PW-SESSION             PIC X(1).
   924         88  PI-CLAIM-CREDIT                 VALUE '1'.
   925         88  PI-CLAIM-CONVEN                 VALUE '2'.
   926     12  FILLER                          PIC X(4).
   927
   928     12  PI-SYSTEM-LEVEL                 PIC X(145).
   929
   930     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   931         PI-SYSTEM-LEVEL.
   932
   933         16  PI-ENTRY-CODES.
   934             20  PI-ENTRY-CD-1           PIC X.
   935             20  PI-ENTRY-CD-2           PIC X.
   936
   937         16  PI-RETURN-CODES.
   938             20  PI-RETURN-CD-1          PIC X.
   939             20  PI-RETURN-CD-2          PIC X.
   940
   941         16  PI-UPDATE-STATUS-SAVE.
   942             20  PI-UPDATE-BY            PIC X(4).
   943             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   944
   945         16  PI-LOWER-CASE-LETTERS       PIC X.
   946             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   947
   948*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   949*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   950*            88  CARRIER-CLM-CNTL            VALUE '2'.
   951
   952         16  PI-CERT-ACCESS-CONTROL      PIC X.
   953             88  ST-ACCNT-CNTL               VALUE ' '.
   954             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   955             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   956             88  ACCNT-CNTL                  VALUE '3'.
   957             88  CARR-ACCNT-CNTL             VALUE '4'.
   958
   959         16  PI-PROCESSOR-CAP-LIST.
   960             20  PI-SYSTEM-CONTROLS.
   961                24 PI-SYSTEM-DISPLAY     PIC X.
   962                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   963                24 PI-SYSTEM-MODIFY      PIC X.
   964                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   965             20  FILLER                  PIC XX.
   966             20  PI-DISPLAY-CAP          PIC X.
   967                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL650.cbl
   968             20  PI-MODIFY-CAP           PIC X.
   969                 88  MODIFY-CAP              VALUE 'Y'.
   970             20  PI-MSG-AT-LOGON-CAP     PIC X.
   971                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   972             20  PI-FORCE-CAP            PIC X.
   973                 88  FORCE-CAP               VALUE 'Y'.
   974
   975         16  PI-PROGRAM-CONTROLS.
   976             20  PI-PGM-PRINT-OPT        PIC X.
   977             20  PI-PGM-FORMAT-OPT       PIC X.
   978             20  PI-PGM-PROCESS-OPT      PIC X.
   979             20  PI-PGM-TOTALS-OPT       PIC X.
   980
   981         16  PI-HELP-INTERFACE.
   982             20  PI-LAST-ERROR-NO        PIC X(4).
   983             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   984
   985         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   986             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   987
   988         16  PI-CR-CONTROL-IN-PROGRESS.
   989             20  PI-CR-CARRIER           PIC X.
   990             20  PI-CR-GROUPING          PIC X(6).
   991             20  PI-CR-STATE             PIC XX.
   992             20  PI-CR-ACCOUNT           PIC X(10).
   993             20  PI-CR-FIN-RESP          PIC X(10).
   994             20  PI-CR-TYPE              PIC X.
   995
   996         16  PI-CR-BATCH-NUMBER          PIC X(6).
   997
   998         16  PI-CR-MONTH-END-DT          PIC XX.
   999
  1000         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1001             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1002             88  PI-ZERO-CARRIER             VALUE '1'.
  1003             88  PI-ZERO-GROUPING            VALUE '2'.
  1004             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1005
  1006         16  PI-CARRIER-SECURITY         PIC X.
  1007             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1008
  1009         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1010             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1011             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1012
  1013         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1014             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1015                                         INDEXED BY PI-ACCESS-NDX
  1016                                         PIC X.
  1017
  1018         16  PI-GA-BILLING-CONTROL       PIC X.
  1019             88  PI-GA-BILLING               VALUE '1'.
  1020
  1021         16  PI-MAIL-PROCESSING          PIC X.
  1022             88  PI-MAIL-YES                 VALUE 'Y'.
  1023
  1024         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1025
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL650.cbl
  1026         16  PI-AR-SYSTEM.
  1027             20  PI-AR-PROCESSING-CNTL   PIC X.
  1028                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1029             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1030             20  PI-AR-MONTH-END-DT      PIC XX.
  1031
  1032         16  PI-MP-SYSTEM.
  1033             20  PI-MORTGAGE-USER            PIC X.
  1034                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1035                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1036             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1037                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1038                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1039                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1040                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1041                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1042             20  PI-MP-MONTH-END-DT          PIC XX.
  1043             20  PI-MP-REFERENCE-NO.
  1044                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1045                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1046
  1047         16  PI-LABEL-CONTROL            PIC X(01).
  1048             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1049             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1050
  1051         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1052             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1053
  1054         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1055             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1056             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1057
  1058         16  FILLER                      PIC X(14).
  1059
  1060     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1061******************************************************************
  1062*    COPY ELC650PI.
  1063******************************************************************
  1064*
  1065*                            ELC650PI.
  1066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1067*                            VMOD=2.007
  1068*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1069*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
  1070* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1071*
  1072******************************************************************
  1073
  1074     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1075         16  PI-MAINT                   PIC X.
  1076         16  PI-PREV-ACCOUNT            PIC X(20).
  1077         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1078         16  PI-ACCT-KEY.
  1079             20  PI-ACCT-CCGSA-KEY.
  1080                 24  PI-ACCT-CO             PIC X.
  1081                 24  PI-ACCT-CARRIER        PIC X.
  1082                 24  PI-ACCT-GROUPING       PIC X(6).
  1083                 24  PI-ACCT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL650.cbl
  1084                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1085             20  PI-ACCT-EXP-DT           PIC XX.
  1086             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1087         16  PI-ACCT-ID                 PIC X(8).
  1088         16  PI-PLAN-KEY.
  1089             20  PI-PLAN-ACCT-KEY.
  1090                 24  PI-PLAN-COMPANY-CD PIC X.
  1091                 24  PI-PLAN-CARRIER    PIC X.
  1092                 24  PI-PLAN-GROUP      PIC X(6).
  1093                 24  PI-PLAN-STATE      PIC X(2).
  1094                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1095             20  PI-PLAN-BEN-TYPE       PIC X.
  1096             20  PI-PLAN-BEN            PIC XX.
  1097             20  PI-PLAN-REVISION       PIC X(3).
  1098         16  PI-WS-STATE                PIC XX.
  1099         16  PI-WS-CLASS                PIC XX.
  1100         16  PI-WS-DEV                  PIC X(3).
  1101         16  PI-WS-TYPE                 PIC X.
  1102         16  PI-WS-PLAN                 PIC XX.
  1103
  1104         16  PI-ERPNDB-ALT-KEY.
  1105             20  PI-PB-COMPANY-CD-A1    PIC X.
  1106             20  PI-PB-CARRIER          PIC X.
  1107             20  PI-PB-GROUPING         PIC X(6).
  1108             20  PI-PB-STATE            PIC XX.
  1109             20  PI-PB-ACCOUNT          PIC X(10).
  1110             20  PI-PB-CERT-EFF-DT      PIC XX.
  1111             20  PI-PB-CERT-NO          PIC X(10).
  1112             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1113             20  PI-PB-RECORD-TYPE      PIC X.
  1114
  1115         16  PI-DATE-RANGE-TABLE.
  1116             20  PI-TABLE-ENT OCCURS 32 TIMES
  1117                            INDEXED BY T-INDEX.
  1118                 24  PI-BIN-EFF-DT          PIC XX.
  1119                 24  PI-BIN-EXP-DT          PIC XX.
  1120                 24  PI-BIN-MAINT-DT        PIC XX.
  1121                 24  PI-BIN-LO-CERT         PIC XX.
  1122                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1123                 24  PI-BIN-HI-CERT         PIC XX.
  1124         16  PI-PAGE-NUMBER             PIC S9.
  1125             88  PI-FST-PAGE               VALUE +1.
  1126             88  PI-2ND-PAGE               VALUE +2.
  1127             88  PI-3RD-PAGE               VALUE +3.
  1128             88  PI-LST-PAGE               VALUE +4.
  1129         16  PI-TOTAL-LINES             PIC S99.
  1130         16  PI-LINE-SELECTED    PIC S9.
  1131***  Y2K PROJ 7744
  1132         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1133         16  BIN-EFFCHG-SAVE     PIC XX.
  1134         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1135***  Y2K PROJ 7744
  1136         16  BIN-EXPCHG-SAVE     PIC XX.
  1137         16  PI-RECORD-ADDED-SW  PIC X.
  1138             88  PI-RECORD-ADDED            VALUE '1'.
  1139             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1140         16  PI-ACCNAME          PIC X(30).
  1141         16  PI-COMM-POINTER     PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL650.cbl
  1142         16  PI-SV-MAINT         PIC X.
  1143         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1144         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1145         16  PI-UPDATE-SW        PIC X.
  1146             88  PI-CHANGES-MADE             VALUE '1'.
  1147         16  PI-NOTE-TYPE        PIC X.
  1148             88  PI-ACCT-NOTE                VALUE '1'.
  1149         16  PI-DMD-FILE-SW      PIC X.
  1150             88  END-OF-FILE                 VALUE 'E'.
  1151             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1152             88  FIRST-OCCURS                VALUE 'F'.
  1153         16  PI-DMD-OCCURS       PIC S999.
  1154         16  PI-DMD-SCREEN       PIC X.
  1155             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1156             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1157             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1158         16  PI-NAMEFLG          PIC X.
  1159         16  PI-EL650-DEL-SW     PIC X.
  1160         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1161         16  PI-DCC-PROD-CODE    PIC XXX.
  1162         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL650.cbl
  1164*          16  PI-NAMEFLG       PIC X.
  1165
  1166*    COPY ELCJPFX.
  1167******************************************************************
  1168*                                                                *
  1169*                                                                *
  1170*                            ELCJPFX.                            *
  1171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1172*                            VMOD=2.002                          *
  1173*                                                                *
  1174*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1175*                                                                *
  1176*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1177*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1178*        ELCNTL - CONTROL FILE                                   *
  1179*        ELMSTR - CLAIM MASTERS                                  *
  1180*        ELTRLR - ACTIVITY TRAILERS                              *
  1181*        ELCHKQ - CHECK QUE                                      *
  1182******************************************************************
  1183 01  JOURNAL-RECORD.
  1184     12  JP-USER-ID                  PIC X(4).
  1185     12  JP-FILE-ID                  PIC X(8).
  1186     12  JP-PROGRAM-ID               PIC X(8).
  1187     12  JP-RECORD-TYPE              PIC X.
  1188         88 JP-ADD              VALUE 'A'.
  1189         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1190         88 JP-AFTER-CHANGE     VALUE 'C'.
  1191         88 JP-DELETE           VALUE 'D'.
  1192         88 JP-GENERIC-DELETE   VALUE 'G'.
  1193         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1194         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1195     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1196     12  JP-RECORD-AREA
  1197
  1198
  1199                                 PIC  X(2000).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL650.cbl
  1201*    COPY ELCAID.
  1202******************************************************************
  1203*                                                                *
  1204*                            ELCAID.                             *
  1205*                            VMOD=2.001                          *
  1206*                                                                *
  1207*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1208*                                                                *
  1209*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1210*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1211******************************************************************
  1212
  1213 01  DFHAID.
  1214   02  DFHNULL   PIC  X  VALUE  ' '.
  1215   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1216   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1217   02  DFHPEN    PIC  X  VALUE  '='.
  1218   02  DFHOPID   PIC  X  VALUE  'W'.
  1219   02  DFHPA1    PIC  X  VALUE  '%'.
  1220   02  DFHPA2    PIC  X  VALUE  '>'.
  1221   02  DFHPA3    PIC  X  VALUE  ','.
  1222   02  DFHPF1    PIC  X  VALUE  '1'.
  1223   02  DFHPF2    PIC  X  VALUE  '2'.
  1224   02  DFHPF3    PIC  X  VALUE  '3'.
  1225   02  DFHPF4    PIC  X  VALUE  '4'.
  1226   02  DFHPF5    PIC  X  VALUE  '5'.
  1227   02  DFHPF6    PIC  X  VALUE  '6'.
  1228   02  DFHPF7    PIC  X  VALUE  '7'.
  1229   02  DFHPF8    PIC  X  VALUE  '8'.
  1230   02  DFHPF9    PIC  X  VALUE  '9'.
  1231   02  DFHPF10   PIC  X  VALUE  ':'.
  1232   02  DFHPF11   PIC  X  VALUE  '#'.
  1233   02  DFHPF12   PIC  X  VALUE  '@'.
  1234   02  DFHPF13   PIC  X  VALUE  'A'.
  1235   02  DFHPF14   PIC  X  VALUE  'B'.
  1236   02  DFHPF15   PIC  X  VALUE  'C'.
  1237   02  DFHPF16   PIC  X  VALUE  'D'.
  1238   02  DFHPF17   PIC  X  VALUE  'E'.
  1239   02  DFHPF18   PIC  X  VALUE  'F'.
  1240   02  DFHPF19   PIC  X  VALUE  'G'.
  1241   02  DFHPF20   PIC  X  VALUE  'H'.
  1242   02  DFHPF21   PIC  X  VALUE  'I'.
  1243*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1244   02  DFHPF22   PIC  X  VALUE  '['.
  1245   02  DFHPF23   PIC  X  VALUE  '.'.
  1246   02  DFHPF24   PIC  X  VALUE  '<'.
  1247   02  DFHMSRE   PIC  X  VALUE  'X'.
  1248   02  DFHSTRF   PIC  X  VALUE  'h'.
  1249   02  DFHTRIG   PIC  X  VALUE  '"'.
  1250
  1251 01  FILLER  REDEFINES  DFHAID.
  1252     12  FILLER              PIC  X(8).
  1253     12  PF-VALUES           PIC  X      OCCURS  24  TIMES.
  1254     12  FILLER              PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL650.cbl
  1256*    COPY EL650S.
  1257 01  EL650AI.
  1258     05  FILLER            PIC  X(0012).
  1259*    -------------------------------
  1260     05  DATEL PIC S9(0004) COMP.
  1261     05  DATEF PIC  X(0001).
  1262     05  FILLER REDEFINES DATEF.
  1263         10  DATEA PIC  X(0001).
  1264     05  DATEI PIC  X(0008).
  1265*    -------------------------------
  1266     05  TIMEL PIC S9(0004) COMP.
  1267     05  TIMEF PIC  X(0001).
  1268     05  FILLER REDEFINES TIMEF.
  1269         10  TIMEA PIC  X(0001).
  1270     05  TIMEI PIC  X(0005).
  1271*    -------------------------------
  1272     05  CMPNYIDL PIC S9(0004) COMP.
  1273     05  CMPNYIDF PIC  X(0001).
  1274     05  FILLER REDEFINES CMPNYIDF.
  1275         10  CMPNYIDA PIC  X(0001).
  1276     05  CMPNYIDI PIC  X(0003).
  1277*    -------------------------------
  1278     05  USERIDL PIC S9(0004) COMP.
  1279     05  USERIDF PIC  X(0001).
  1280     05  FILLER REDEFINES USERIDF.
  1281         10  USERIDA PIC  X(0001).
  1282     05  USERIDI PIC  X(0004).
  1283*    -------------------------------
  1284     05  MAINTL PIC S9(0004) COMP.
  1285     05  MAINTF PIC  X(0001).
  1286     05  FILLER REDEFINES MAINTF.
  1287         10  MAINTA PIC  X(0001).
  1288     05  MAINTI PIC  X(0001).
  1289*    -------------------------------
  1290     05  TRNMSG1L PIC S9(0004) COMP.
  1291     05  TRNMSG1F PIC  X(0001).
  1292     05  FILLER REDEFINES TRNMSG1F.
  1293         10  TRNMSG1A PIC  X(0001).
  1294     05  TRNMSG1I PIC  X(0017).
  1295*    -------------------------------
  1296     05  LINEL PIC S9(0004) COMP.
  1297     05  LINEF PIC  X(0001).
  1298     05  FILLER REDEFINES LINEF.
  1299         10  LINEA PIC  X(0001).
  1300     05  LINEI PIC  9.
  1301*    -------------------------------
  1302     05  ACARIERL PIC S9(0004) COMP.
  1303     05  ACARIERF PIC  X(0001).
  1304     05  FILLER REDEFINES ACARIERF.
  1305         10  ACARIERA PIC  X(0001).
  1306     05  ACARIERI PIC  X(0001).
  1307*    -------------------------------
  1308     05  AGROUPL PIC S9(0004) COMP.
  1309     05  AGROUPF PIC  X(0001).
  1310     05  FILLER REDEFINES AGROUPF.
  1311         10  AGROUPA PIC  X(0001).
  1312     05  AGROUPI PIC  X(0006).
  1313*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL650.cbl
  1314     05  ASTATEL PIC S9(0004) COMP.
  1315     05  ASTATEF PIC  X(0001).
  1316     05  FILLER REDEFINES ASTATEF.
  1317         10  ASTATEA PIC  X(0001).
  1318     05  ASTATEI PIC  X(0002).
  1319*    -------------------------------
  1320     05  AACCTL PIC S9(0004) COMP.
  1321     05  AACCTF PIC  X(0001).
  1322     05  FILLER REDEFINES AACCTF.
  1323         10  AACCTA PIC  X(0001).
  1324     05  AACCTI PIC  X(0010).
  1325*    -------------------------------
  1326     05  NAMEFLGL PIC S9(0004) COMP.
  1327     05  NAMEFLGF PIC  X(0001).
  1328     05  FILLER REDEFINES NAMEFLGF.
  1329         10  NAMEFLGA PIC  X(0001).
  1330     05  NAMEFLGI PIC  X(0001).
  1331*    -------------------------------
  1332     05  NAMEL PIC S9(0004) COMP.
  1333     05  NAMEF PIC  X(0001).
  1334     05  FILLER REDEFINES NAMEF.
  1335         10  NAMEA PIC  X(0001).
  1336     05  NAMEI PIC  X(0030).
  1337*    -------------------------------
  1338     05  ARHDGL PIC S9(0004) COMP.
  1339     05  ARHDGF PIC  X(0001).
  1340     05  FILLER REDEFINES ARHDGF.
  1341         10  ARHDGA PIC  X(0001).
  1342     05  ARHDGI PIC  X(0010).
  1343*    -------------------------------
  1344     05  DET1L PIC S9(0004) COMP.
  1345     05  DET1F PIC  X(0001).
  1346     05  FILLER REDEFINES DET1F.
  1347         10  DET1A PIC  X(0001).
  1348     05  DET1I PIC  X(0070).
  1349*    -------------------------------
  1350     05  DET2L PIC S9(0004) COMP.
  1351     05  DET2F PIC  X(0001).
  1352     05  FILLER REDEFINES DET2F.
  1353         10  DET2A PIC  X(0001).
  1354     05  DET2I PIC  X(0070).
  1355*    -------------------------------
  1356     05  DET3L PIC S9(0004) COMP.
  1357     05  DET3F PIC  X(0001).
  1358     05  FILLER REDEFINES DET3F.
  1359         10  DET3A PIC  X(0001).
  1360     05  DET3I PIC  X(0070).
  1361*    -------------------------------
  1362     05  DET4L PIC S9(0004) COMP.
  1363     05  DET4F PIC  X(0001).
  1364     05  FILLER REDEFINES DET4F.
  1365         10  DET4A PIC  X(0001).
  1366     05  DET4I PIC  X(0070).
  1367*    -------------------------------
  1368     05  DET5L PIC S9(0004) COMP.
  1369     05  DET5F PIC  X(0001).
  1370     05  FILLER REDEFINES DET5F.
  1371         10  DET5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL650.cbl
  1372     05  DET5I PIC  X(0070).
  1373*    -------------------------------
  1374     05  DET6L PIC S9(0004) COMP.
  1375     05  DET6F PIC  X(0001).
  1376     05  FILLER REDEFINES DET6F.
  1377         10  DET6A PIC  X(0001).
  1378     05  DET6I PIC  X(0070).
  1379*    -------------------------------
  1380     05  DET7L PIC S9(0004) COMP.
  1381     05  DET7F PIC  X(0001).
  1382     05  FILLER REDEFINES DET7F.
  1383         10  DET7A PIC  X(0001).
  1384     05  DET7I PIC  X(0070).
  1385*    -------------------------------
  1386     05  DET8L PIC S9(0004) COMP.
  1387     05  DET8F PIC  X(0001).
  1388     05  FILLER REDEFINES DET8F.
  1389         10  DET8A PIC  X(0001).
  1390     05  DET8I PIC  X(0070).
  1391*    -------------------------------
  1392     05  TRNMSG2L PIC S9(0004) COMP.
  1393     05  TRNMSG2F PIC  X(0001).
  1394     05  FILLER REDEFINES TRNMSG2F.
  1395         10  TRNMSG2A PIC  X(0001).
  1396     05  TRNMSG2I PIC  X(0020).
  1397*    -------------------------------
  1398     05  EFFCHGL PIC S9(0004) COMP.
  1399     05  EFFCHGF PIC  X(0001).
  1400     05  FILLER REDEFINES EFFCHGF.
  1401         10  EFFCHGA PIC  X(0001).
  1402     05  EFFCHGI PIC  X(0008).
  1403*    -------------------------------
  1404     05  EXPCHGL PIC S9(0004) COMP.
  1405     05  EXPCHGF PIC  X(0001).
  1406     05  FILLER REDEFINES EXPCHGF.
  1407         10  EXPCHGA PIC  X(0001).
  1408     05  EXPCHGI PIC  X(0008).
  1409*    -------------------------------
  1410     05  TRNMSG3L PIC S9(0004) COMP.
  1411     05  TRNMSG3F PIC  X(0001).
  1412     05  FILLER REDEFINES TRNMSG3F.
  1413         10  TRNMSG3A PIC  X(0001).
  1414     05  TRNMSG3I PIC  X(0003).
  1415*    -------------------------------
  1416     05  TRNTOL PIC S9(0004) COMP.
  1417     05  TRNTOF PIC  X(0001).
  1418     05  FILLER REDEFINES TRNTOF.
  1419         10  TRNTOA PIC  X(0001).
  1420     05  TRNTOI PIC  X(0019).
  1421*    -------------------------------
  1422     05  TRNTODTL PIC S9(0004) COMP.
  1423     05  TRNTODTF PIC  X(0001).
  1424     05  FILLER REDEFINES TRNTODTF.
  1425         10  TRNTODTA PIC  X(0001).
  1426     05  TRNTODTI PIC  X(0008).
  1427*    -------------------------------
  1428     05  TRNMSG4L PIC S9(0004) COMP.
  1429     05  TRNMSG4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL650.cbl
  1430     05  FILLER REDEFINES TRNMSG4F.
  1431         10  TRNMSG4A PIC  X(0001).
  1432     05  TRNMSG4I PIC  X(0005).
  1433*    -------------------------------
  1434     05  TRNFROML PIC S9(0004) COMP.
  1435     05  TRNFROMF PIC  X(0001).
  1436     05  FILLER REDEFINES TRNFROMF.
  1437         10  TRNFROMA PIC  X(0001).
  1438     05  TRNFROMI PIC  X(0019).
  1439*    -------------------------------
  1440     05  TRNFRDTL PIC S9(0004) COMP.
  1441     05  TRNFRDTF PIC  X(0001).
  1442     05  FILLER REDEFINES TRNFRDTF.
  1443         10  TRNFRDTA PIC  X(0001).
  1444     05  TRNFRDTI PIC  X(0008).
  1445*    -------------------------------
  1446     05  ERRMSG1L PIC S9(0004) COMP.
  1447     05  ERRMSG1F PIC  X(0001).
  1448     05  FILLER REDEFINES ERRMSG1F.
  1449         10  ERRMSG1A PIC  X(0001).
  1450     05  ERRMSG1I PIC  X(0075).
  1451*    -------------------------------
  1452     05  ERRMSG2L PIC S9(0004) COMP.
  1453     05  ERRMSG2F PIC  X(0001).
  1454     05  FILLER REDEFINES ERRMSG2F.
  1455         10  ERRMSG2A PIC  X(0001).
  1456     05  ERRMSG2I PIC  X(0075).
  1457*    -------------------------------
  1458     05  PFENTERL PIC S9(0004) COMP.
  1459     05  PFENTERF PIC  X(0001).
  1460     05  FILLER REDEFINES PFENTERF.
  1461         10  PFENTERA PIC  X(0001).
  1462     05  PFENTERI PIC  9(2).
  1463 01  EL650AO REDEFINES EL650AI.
  1464     05  FILLER            PIC  X(0012).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  DATEO PIC  X(0008).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  TIMEO PIC  99.99.
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  CMPNYIDO PIC  X(0003).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  USERIDO PIC  X(0004).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  MAINTO PIC  X(0001).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  TRNMSG1O PIC  X(0017).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  LINEO PIC  X(0001).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL650.cbl
  1488     05  ACARIERO PIC  X(0001).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  AGROUPO PIC  X(0006).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  ASTATEO PIC  X(0002).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  AACCTO PIC  X(0010).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  NAMEFLGO PIC  X(0001).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  NAMEO PIC  X(0030).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  ARHDGO PIC  X(0010).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  DET1O PIC  X(0070).
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  DET2O PIC  X(0070).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  DET3O PIC  X(0070).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  DET4O PIC  X(0070).
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  DET5O PIC  X(0070).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  DET6O PIC  X(0070).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  DET7O PIC  X(0070).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  DET8O PIC  X(0070).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  TRNMSG2O PIC  X(0020).
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  EFFCHGO PIC  X(0008).
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  EXPCHGO PIC  99B99B99.
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  TRNMSG3O PIC  X(0003).
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  TRNTOO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL650.cbl
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  TRNTODTO PIC  X(0008).
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  TRNMSG4O PIC  X(0005).
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  TRNFROMO PIC  X(0019).
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  TRNFRDTO PIC  X(0008).
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  ERRMSG1O PIC  X(0075).
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  ERRMSG2O PIC  X(0075).
  1564*    -------------------------------
  1565     05  FILLER            PIC  X(0003).
  1566     05  PFENTERO PIC  X(0002).
  1567*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL650.cbl
  1569 01  EL650R  REDEFINES  EL650AI.
  1570     12  FILLER                      PIC  X(153).
  1571     12  MAP-RECORD-AREA.
  1572         16  DATE-RANGES     OCCURS  8  TIMES
  1573                                 INDEXED  BY  M-INDEX.
  1574             20  FILLER              PIC  X(3).
  1575             20  MAP-EFF-DT          PIC  X(8).
  1576             20  FILLER              PIC  X(6).
  1577             20  MAP-EXP-DT          PIC  X(8).
  1578             20  MAP-EXP-DT-ED  REDEFINES
  1579                 MAP-EXP-DT          PIC 99B99B99.
  1580             20  FILLER              PIC  X(4).
  1581             20  MAP-LST-MAINT-DT    PIC  X(8).
  1582             20  FILLER              PIC  X(3).
  1583             20  MAP-LOW-CERT        PIC  X(8).
  1584             20  FILLER              PIC  X(3).
  1585             20  MAP-HIGH-CERT       PIC  X(8).
  1586             20  FILLER              PIC  X(4).
  1587             20  MAP-AR-DATE         PIC  X(8).
  1588             20  FILLER              PIC  XX.
  1589     12  FILLER                      PIC  X(286).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL650.cbl
  1591****************************************************************
  1592*
  1593* Copyright (c) 2007 by Clerity Solutions, Inc.
  1594* All rights reserved.
  1595*
  1596****************************************************************
  1597 01  DFHEIV.
  1598   02  DFHEIV0               PIC X(35).
  1599   02  DFHEIV1               PIC X(08).
  1600   02  DFHEIV2               PIC X(08).
  1601   02  DFHEIV3               PIC X(08).
  1602   02  DFHEIV4               PIC X(06).
  1603   02  DFHEIV5               PIC X(04).
  1604   02  DFHEIV6               PIC X(04).
  1605   02  DFHEIV7               PIC X(02).
  1606   02  DFHEIV8               PIC X(02).
  1607   02  DFHEIV9               PIC X(01).
  1608   02  DFHEIV10              PIC S9(7) COMP-3.
  1609   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1610   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1611   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1612   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1613   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1614   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1615   02  DFHEIV17              PIC X(04).
  1616   02  DFHEIV18              PIC X(04).
  1617   02  DFHEIV19              PIC X(04).
  1618   02  DFHEIV20              USAGE IS POINTER.
  1619   02  DFHEIV21              USAGE IS POINTER.
  1620   02  DFHEIV22              USAGE IS POINTER.
  1621   02  DFHEIV23              USAGE IS POINTER.
  1622   02  DFHEIV24              USAGE IS POINTER.
  1623   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1624   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1625   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1626   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1627   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1628   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1629   02  FILLER                PIC X(02).
  1630   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1631   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1632   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1633   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1634   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1635 LINKAGE  SECTION.
  1636*****************************************************************
  1637*                                                               *
  1638* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1639* All rights reserved.                                          *
  1640*                                                               *
  1641*****************************************************************
  1642 01  dfheiblk.
  1643     02  eibtime          pic s9(7) comp-3.
  1644     02  eibdate          pic s9(7) comp-3.
  1645     02  eibtrnid         pic x(4).
  1646     02  eibtaskn         pic s9(7) comp-3.
  1647     02  eibtrmid         pic x(4).
  1648     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL650.cbl
  1649     02  eibcposn         pic s9(4) comp.
  1650     02  eibcalen         pic s9(4) comp.
  1651     02  eibaid           pic x(1).
  1652     02  eibfiller1       pic x(1).
  1653     02  eibfn            pic x(2).
  1654     02  eibfiller2       pic x(2).
  1655     02  eibrcode         pic x(6).
  1656     02  eibfiller3       pic x(2).
  1657     02  eibds            pic x(8).
  1658     02  eibreqid         pic x(8).
  1659     02  eibrsrce         pic x(8).
  1660     02  eibsync          pic x(1).
  1661     02  eibfree          pic x(1).
  1662     02  eibrecv          pic x(1).
  1663     02  eibsend          pic x(1).
  1664     02  eibatt           pic x(1).
  1665     02  eibeoc           pic x(1).
  1666     02  eibfmh           pic x(1).
  1667     02  eibcompl         pic x(1).
  1668     02  eibsig           pic x(1).
  1669     02  eibconf          pic x(1).
  1670     02  eiberr           pic x(1).
  1671     02  eibrldbk         pic x(1).
  1672     02  eiberrcd         pic x(4).
  1673     02  eibsynrb         pic x(1).
  1674     02  eibnodat         pic x(1).
  1675     02  eibfiller5       pic x(2).
  1676     02  eibresp          pic 9(09) comp.
  1677     02  eibresp2         pic 9(09) comp.
  1678     02  dfheigdj         pic s9(4) comp.
  1679     02  dfheigdk         pic s9(4) comp.
  1680 01  DFHCOMMAREA             PIC  X(1500).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL650.cbl
  1682*01 PARMLIST .
  1683*    12  FILLER              PIC S9(8)   COMP.
  1684*    12  ERACCT-POINTER      PIC S9(8)   COMP.
  1685*    12  ERCOMP-POINTER      PIC S9(8)   COMP.
  1686*    12  ERNAME-POINTER      PIC S9(8)   COMP.
  1687*    12  ERPLAN-POINTER      PIC S9(8)   COMP.
  1688*    12  ELCNTL-POINTER      PIC S9(8)   COMP.
  1689*    12  ERPNDB-POINTER      PIC S9(8)   COMP.
  1690*    12  AXRF-POINTER        PIC S9(8)   COMP.
  1691*    12  AXRF2-POINTER       PIC S9(8)   COMP.
  1692*    12  AXRF3-POINTER       PIC S9(8)   COMP.
  1693*    12  AXRF4-POINTER       PIC S9(8)   COMP.
  1694*    12  AXRF5-POINTER       PIC S9(8)   COMP.
  1695*    12  AXRF6-POINTER       PIC S9(8)   COMP.
  1696*    12  AXRF7-POINTER       PIC S9(8)   COMP.
  1697*    12  AXRF8-POINTER       PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL650.cbl
  1699*    COPY ERCACCT.
  1700******************************************************************
  1701*                                                                *
  1702*                                                                *
  1703*                            ERCACCT                             *
  1704*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1705*                            VMOD=2.031                          *
  1706*                                                                *
  1707*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1708*                                                                *
  1709*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1710*   VSAM ACCOUNT MASTER FILES.                                   *
  1711*                                                                *
  1712*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1713*                                                                *
  1714*   FILE TYPE = VSAM,KSDS                                        *
  1715*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1716*                                                                *
  1717*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1718*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1719*                                                                *
  1720*   LOG = NO                                                     *
  1721*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1722*                                                                *
  1723*                                                                *
  1724******************************************************************
  1725*                   C H A N G E   L O G
  1726*
  1727* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1728*-----------------------------------------------------------------
  1729*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1730* EFFECTIVE    NUMBER
  1731*-----------------------------------------------------------------
  1732* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1733* 092705    2005050300006  PEMA  ADD SPP LEASES
  1734* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1735* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1736* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1737* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1738* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1739******************************************************************
  1740
  1741 01  ACCOUNT-MASTER.
  1742     12  AM-RECORD-ID                      PIC XX.
  1743         88  VALID-AM-ID                      VALUE 'AM'.
  1744
  1745     12  AM-CONTROL-PRIMARY.
  1746         16  AM-COMPANY-CD                 PIC X.
  1747         16  AM-MSTR-CNTRL.
  1748             20  AM-CONTROL-A.
  1749                 24  AM-CARRIER            PIC X.
  1750                 24  AM-GROUPING.
  1751                     28 AM-GROUPING-PREFIX PIC XXX.
  1752                     28 AM-GROUPING-PRIME  PIC XXX.
  1753                 24  AM-STATE              PIC XX.
  1754                 24  AM-ACCOUNT.
  1755                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1756                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL650.cbl
  1757             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1758                                           PIC X(19).
  1759             20  AM-CNTRL-B.
  1760                 24  AM-EXPIRATION-DT      PIC XX.
  1761                 24  FILLER                PIC X(4).
  1762             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1763                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1764
  1765     12  AM-CONTROL-BY-VAR-GRP.
  1766         16  AM-COMPANY-CD-A1              PIC X.
  1767         16  AM-VG-CARRIER                 PIC X.
  1768         16  AM-VG-GROUPING                PIC X(6).
  1769         16  AM-VG-STATE                   PIC XX.
  1770         16  AM-VG-ACCOUNT                 PIC X(10).
  1771         16  AM-VG-DATE.
  1772             20  AM-VG-EXPIRATION-DT       PIC XX.
  1773             20  FILLER                    PIC X(4).
  1774         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1775                                           PIC 9(11)      COMP-3.
  1776     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1777         16  FILLER                        PIC X(10).
  1778         16  AM-VG-KEY3.
  1779             20  AM-VG3-ACCOUNT            PIC X(10).
  1780             20  AM-VG3-EXP-DT             PIC XX.
  1781         16  FILLER                        PIC X(4).
  1782     12  AM-MAINT-INFORMATION.
  1783         16  AM-LAST-MAINT-DT              PIC XX.
  1784         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1785         16  AM-LAST-MAINT-USER            PIC X(4).
  1786         16  FILLER                        PIC XX.
  1787
  1788     12  AM-EFFECTIVE-DT                   PIC XX.
  1789     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1790
  1791     12  AM-PREV-DATES  COMP-3.
  1792         16  AM-PREV-EXP-DT                PIC 9(11).
  1793         16  AM-PREV-EFF-DT                PIC 9(11).
  1794
  1795     12  AM-REPORT-CODE-1                  PIC X(10).
  1796     12  AM-REPORT-CODE-2                  PIC X(10).
  1797
  1798     12  AM-CITY-CODE                      PIC X(4).
  1799     12  AM-COUNTY-PARISH                  PIC X(6).
  1800
  1801     12  AM-NAME                           PIC X(30).
  1802     12  AM-PERSON                         PIC X(30).
  1803     12  AM-ADDRS                          PIC X(30).
  1804     12  AM-CITY.
  1805         16  AM-ADDR-CITY                  PIC X(28).
  1806         16  AM-ADDR-STATE                 PIC XX.
  1807     12  AM-ZIP.
  1808         16  AM-ZIP-PRIME.
  1809             20  AM-ZIP-PRI-1ST            PIC X.
  1810                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1811             20  FILLER                    PIC X(4).
  1812         16  AM-ZIP-PLUS4                  PIC X(4).
  1813     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1814         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL650.cbl
  1815         16  AM-CAN-POSTAL-2               PIC XXX.
  1816         16  FILLER                        PIC XXX.
  1817     12  AM-TEL-NO.
  1818         16  AM-AREA-CODE                  PIC 999.
  1819         16  AM-TEL-PRE                    PIC 999.
  1820         16  AM-TEL-NBR                    PIC 9(4).
  1821     12  AM-TEL-LOC                        PIC X.
  1822         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1823         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1824
  1825     12  AM-COMM-STRUCTURE.
  1826         16  AM-DEFN-1.
  1827             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1828                 24  AM-AGT.
  1829                     28  AM-AGT-PREFIX     PIC X(4).
  1830                     28  AM-AGT-PRIME      PIC X(6).
  1831                 24  AM-COM-TYP            PIC X.
  1832                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1833                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1834                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1835                 24  AM-RECALC-LV-INDIC    PIC X.
  1836                 24  AM-RETRO-LV-INDIC     PIC X.
  1837                 24  AM-GL-CODES           PIC X.
  1838                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1839                 24  FILLER                PIC X(01).
  1840         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1841             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1842                 24  FILLER                PIC X(11).
  1843                 24  AM-L-COMA             PIC XXX.
  1844                 24  AM-J-COMA             PIC XXX.
  1845                 24  AM-A-COMA             PIC XXX.
  1846                 24  FILLER                PIC X(6).
  1847
  1848     12  AM-COMM-CHANGE-STATUS             PIC X.
  1849         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1850
  1851     12  AM-CSR-CODE                       PIC X(4).
  1852
  1853     12  AM-BILLING-STATUS                 PIC X.
  1854         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1855         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1856     12  AM-AUTO-REFUND-SW                 PIC X.
  1857         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1858         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1859     12  AM-GPCD                           PIC 99.
  1860     12  AM-IG                             PIC X.
  1861         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1862         88  AM-HAS-GROUP                     VALUE '2'.
  1863     12  AM-STATUS                         PIC X.
  1864         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1865         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1866         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1867         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1868         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1869         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1870     12  AM-REMIT-TO                       PIC 99.
  1871     12  AM-ID-NO                          PIC X(11).
  1872
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL650.cbl
  1873     12  AM-CAL-TABLE                      PIC XX.
  1874     12  AM-LF-DEVIATION                   PIC XXX.
  1875     12  AM-AH-DEVIATION                   PIC XXX.
  1876     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1877     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1878     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1879     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1880     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1881     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1882
  1883     12  AM-USER-FIELDS.
  1884         16  AM-FLD-1                      PIC XX.
  1885         16  AM-FLD-2                      PIC XX.
  1886         16  AM-FLD-3                      PIC XX.
  1887         16  AM-FLD-4                      PIC XX.
  1888         16  AM-FLD-5                      PIC XX.
  1889
  1890     12  AM-1ST-PROD-DATE.
  1891         16  AM-1ST-PROD-YR                PIC XX.
  1892         16  AM-1ST-PROD-MO                PIC XX.
  1893         16  AM-1ST-PROD-DA                PIC XX.
  1894     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1895     12  AM-CERTS-PURGED-DATE.
  1896         16  AM-PUR-YR                     PIC XX.
  1897         16  AM-PUR-MO                     PIC XX.
  1898         16  AM-PUR-DA                     PIC XX.
  1899     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1900     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1901     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1902     12  AM-INACTIVE-DATE.
  1903         16  AM-INA-MO                     PIC 99.
  1904         16  AM-INA-DA                     PIC 99.
  1905         16  AM-INA-YR                     PIC 99.
  1906     12  AM-AR-HI-CERT-DATE                PIC XX.
  1907
  1908     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1909     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1910
  1911     12  AM-OB-PAYMENT-MODE                PIC X.
  1912         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1913         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1914         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1915         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1916
  1917     12  AM-AH-ONLY-INDICATOR              PIC X.
  1918         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1919         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1920
  1921     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1922
  1923     12  AM-OVER-SHORT.
  1924         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1925         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1926
  1927     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1928     12  AM-DCC-CLP-STATE                  PIC XX.
  1929
  1930     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL650.cbl
  1931     12  AM-RECALC-REIN                    PIC X.
  1932
  1933     12  AM-REI-TABLE                      PIC XXX.
  1934     12  AM-REI-ET-LF                      PIC X.
  1935     12  AM-REI-ET-AH                      PIC X.
  1936     12  AM-REI-PE-LF                      PIC X.
  1937     12  AM-REI-PE-AH                      PIC X.
  1938     12  AM-REI-PRT-ST                     PIC X.
  1939     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1940     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1941     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1942     12  AM-REI-GROUP-A                    PIC X(6).
  1943     12  AM-REI-MORT                       PIC X(4).
  1944     12  AM-REI-PRT-OW                     PIC X.
  1945     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1946     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1947     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1948     12  AM-REI-GROUP-B                    PIC X(6).
  1949
  1950     12  AM-TRUST-TYPE                     PIC X(2).
  1951
  1952     12  AM-EMPLOYER-STMT-USED             PIC X.
  1953     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1954
  1955     12  AM-STD-AH-TYPE                    PIC XX.
  1956     12  AM-EARN-METHODS.
  1957         16  AM-EARN-METHOD-R              PIC X.
  1958             88 AM-REF-RL-R78                 VALUE 'R'.
  1959             88 AM-REF-RL-PR                  VALUE 'P'.
  1960             88 AM-REF-RL-MEAN                VALUE 'M'.
  1961             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1962         16  AM-EARN-METHOD-L              PIC X.
  1963             88 AM-REF-LL-R78                 VALUE 'R'.
  1964             88 AM-REF-LL-PR                  VALUE 'P'.
  1965             88 AM-REF-LL-MEAN                VALUE 'M'.
  1966             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1967         16  AM-EARN-METHOD-A              PIC X.
  1968             88 AM-REF-AH-R78                 VALUE 'R'.
  1969             88 AM-REF-AH-PR                  VALUE 'P'.
  1970             88 AM-REF-AH-MEAN                VALUE 'M'.
  1971             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1972             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1973             88 AM-REF-AH-NET                 VALUE 'N'.
  1974
  1975     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1976     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1977     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1978
  1979     12  AM-RET-Y-N                        PIC X.
  1980     12  AM-RET-P-E                        PIC X.
  1981     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1982     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1983     12  AM-RET-GRP                        PIC X(6).
  1984     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1985         16  AM-POOL-PRIME                 PIC XXX.
  1986         16  AM-POOL-SUB                   PIC XXX.
  1987     12  AM-RETRO-EARNINGS.
  1988         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL650.cbl
  1989         16  AM-RET-EARN-L                 PIC X.
  1990         16  AM-RET-EARN-A                 PIC X.
  1991     12  AM-RET-ST-TAX-USE                 PIC X.
  1992         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1993         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1994     12  AM-RETRO-BEG-EARNINGS.
  1995         16  AM-RET-BEG-EARN-R             PIC X.
  1996         16  AM-RET-BEG-EARN-L             PIC X.
  1997         16  AM-RET-BEG-EARN-A             PIC X.
  1998     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1999     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2000
  2001     12  AM-USER-SELECT-OPTIONS.
  2002         16  AM-USER-SELECT-1              PIC X(10).
  2003         16  AM-USER-SELECT-2              PIC X(10).
  2004         16  AM-USER-SELECT-3              PIC X(10).
  2005         16  AM-USER-SELECT-4              PIC X(10).
  2006         16  AM-USER-SELECT-5              PIC X(10).
  2007
  2008     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2009
  2010     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2011
  2012     12  AM-RPT045A-SWITCH                 PIC X.
  2013         88  RPT045A-OFF                   VALUE 'N'.
  2014
  2015     12  AM-INSURANCE-LIMITS.
  2016         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2017         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2018
  2019     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2020         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2021
  2022     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2023         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2024         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2025
  2026     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2027
  2028     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2029     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2030     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2031     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2032     12  AM-DCC-UEF-STATE                  PIC XX.
  2033     12  FILLER                            PIC XXX.
  2034     12  AM-REPORT-CODE-3                  PIC X(10).
  2035*    12  FILLER                            PIC X(22).
  2036
  2037     12  AM-RESERVE-DATE.
  2038         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2039         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2040         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2041
  2042     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2043     12  AM-NOTIFICATION-TYPES.
  2044         16  AM-NOTIF-OF-LETTERS           PIC X.
  2045         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2046         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL650.cbl
  2047         16  AM-NOTIF-OF-STATUS            PIC X.
  2048
  2049     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2050         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2051         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2052         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2053         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2054
  2055     12  AM-BENEFIT-CONTROLS.
  2056         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2057             20  AM-BENEFIT-CODE           PIC XX.
  2058             20  AM-BENEFIT-TYPE           PIC X.
  2059             20  AM-BENEFIT-REVISION       PIC XXX.
  2060             20  AM-BENEFIT-REM-TERM       PIC X.
  2061             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2062             20  FILLER                    PIC XX.
  2063         16  FILLER                        PIC X(80).
  2064
  2065     12  AM-TRANSFER-DATA.
  2066         16  AM-TRANSFERRED-FROM.
  2067             20  AM-TRNFROM-CARRIER        PIC X.
  2068             20  AM-TRNFROM-GROUPING.
  2069                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2070                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2071             20  AM-TRNFROM-STATE          PIC XX.
  2072             20  AM-TRNFROM-ACCOUNT.
  2073                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2074                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2075             20  AM-TRNFROM-DTE            PIC XX.
  2076         16  AM-TRANSFERRED-TO.
  2077             20  AM-TRNTO-CARRIER          PIC X.
  2078             20  AM-TRNTO-GROUPING.
  2079                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2080                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2081             20  AM-TRNTO-STATE            PIC XX.
  2082             20  AM-TRNTO-ACCOUNT.
  2083                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2084                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2085             20  AM-TRNTO-DTE              PIC XX.
  2086         16  FILLER                        PIC X(10).
  2087
  2088     12  AM-SAVED-REMIT-TO                 PIC 99.
  2089
  2090     12  AM-COMM-STRUCTURE-SAVED.
  2091         16  AM-DEFN-1-SAVED.
  2092             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2093                 24  AM-AGT-SV             PIC X(10).
  2094                 24  AM-COM-TYP-SV         PIC X.
  2095                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2096                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2097                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2098                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2099                 24  FILLER                PIC X.
  2100                 24  AM-GL-CODES-SV        PIC X.
  2101                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2102                 24  FILLER                PIC X.
  2103         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2104             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL650.cbl
  2105                 24  FILLER                PIC X(11).
  2106                 24  AM-L-COMA-SV          PIC XXX.
  2107                 24  AM-J-COMA-SV          PIC XXX.
  2108                 24  AM-A-COMA-SV          PIC XXX.
  2109                 24  FILLER                PIC X(6).
  2110
  2111     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2112         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2113            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2114            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2115            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2116
  2117     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2118     12  FILLER                            PIC X(120).
  2119
  2120     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2121         16  AM-CONTROL-NAME               PIC X(30).
  2122         16  AM-EXECUTIVE-ONE.
  2123             20  AM-EXEC1-NAME             PIC X(15).
  2124             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2125                                                          COMP-3.
  2126             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2127                                                          COMP-3.
  2128         16  AM-EXECUTIVE-TWO.
  2129             20  AM-EXEC2-NAME             PIC X(15).
  2130             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2131                                                          COMP-3.
  2132             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2133                                                          COMP-3.
  2134
  2135     12  AM-RETRO-ADDITIONAL-DATA.
  2136         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2137         16  AM-RETRO-PREM-P-E             PIC X.
  2138         16  AM-RETRO-CLMS-P-I             PIC X.
  2139         16  AM-RETRO-RET-BRACKET-LF.
  2140             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2141                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2142                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2143             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2144                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2145                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2146             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2147                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2148                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2149         16  AM-RETRO-RET-BRACKET-AH.
  2150             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2151                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2152                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2153                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2154             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2155                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2156                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2157             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2158                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2159                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2160
  2161     12  AM-COMMENTS.
  2162         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL650.cbl
  2163
  2164     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2165         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2166         16  AM-FLI-BILLING-CODE           PIC X.
  2167         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2168         16  AM-FLI-UNITED-IDENT           PIC X.
  2169         16  AM-FLI-INTEREST-LOST-DATA.
  2170             20  AM-FLI-BANK-NO            PIC X(5).
  2171             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2172             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2173             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2174         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2175             20  AM-FLI-AGT                PIC X(9).
  2176             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2177             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2178         16  FILLER                        PIC X(102).
  2179
  2180     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2181         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2182             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2183             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2184             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2185             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2186             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2187         16  FILLER                          PIC X(10).
  2188******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL650.cbl
  2190*    COPY ERCCOMP.
  2191******************************************************************
  2192*                                                                *
  2193*                                                                *
  2194*                            ERCCOMP                             *
  2195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2196*                            VMOD=2.019                          *
  2197*                                                                *
  2198*   ONLINE CREDIT SYSTEM                                         *
  2199*                                                                *
  2200*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2201*                                                                *
  2202*   FILE TYPE = VSAM,KSDS                                        *
  2203*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2204*                                                                *
  2205*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2206*       ALTERNATE PATH = NONE                                    *
  2207*                                                                *
  2208*   LOG = NO                                                     *
  2209*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2210*                                                                *
  2211******************************************************************
  2212*                   C H A N G E   L O G
  2213*
  2214* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2215*-----------------------------------------------------------------
  2216*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2217* EFFECTIVE    NUMBER
  2218*-----------------------------------------------------------------
  2219* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2220* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2221* 092205    2005050300006  PEMA  ADD LEASE FEE
  2222* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2223* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2224* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2225* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2226* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2227* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2228******************************************************************
  2229
  2230 01  COMPENSATION-MASTER.
  2231     12  CO-RECORD-ID                          PIC XX.
  2232         88  VALID-CO-ID                          VALUE 'CO'.
  2233
  2234     12  CO-CONTROL-PRIMARY.
  2235         16  CO-COMPANY-CD                     PIC X.
  2236         16  CO-CONTROL.
  2237             20  CO-CTL-1.
  2238                 24  CO-CARR-GROUP.
  2239                     28  CO-CARRIER            PIC X.
  2240                     28  CO-GROUPING.
  2241                         32  CO-GROUP-PREFIX   PIC XXX.
  2242                         32  CO-GROUP-PRIME    PIC XXX.
  2243                 24  CO-RESP-NO.
  2244                     28  CO-RESP-PREFIX        PIC X(4).
  2245                     28  CO-RESP-PRIME         PIC X(6).
  2246             20  CO-CTL-2.
  2247                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL650.cbl
  2248                     28  CO-ACCT-PREFIX        PIC X(4).
  2249                     28  CO-ACCT-PRIME         PIC X(6).
  2250         16  CO-TYPE                           PIC X.
  2251             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2252             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2253             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2254
  2255     12  CO-MAINT-INFORMATION.
  2256         16  CO-LAST-MAINT-DT                  PIC XX.
  2257         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2258         16  CO-LAST-MAINT-USER                PIC X(4).
  2259     12  FILLER                                PIC XX.
  2260     12  CO-STMT-TYPE                          PIC XXX.
  2261     12  CO-COMP-TYPE                          PIC X.
  2262         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2263     12  CO-STMT-OWNER                         PIC X(4).
  2264     12  CO-BALANCE-CONTROL                    PIC X.
  2265         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2266         88  CO-NO-BALANCE                        VALUE 'N'.
  2267
  2268     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2269         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2270         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2271         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2272
  2273     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2274         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2275         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2276
  2277     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2278     12  CO-GA-DIRECT-DEP                      PIC X.
  2279     12  CO-FUTURE-SPACE                       PIC X.
  2280         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2281
  2282     12  CO-ACCT-NAME                          PIC X(30).
  2283     12  CO-MAIL-NAME                          PIC X(30).
  2284     12  CO-ADDR-1                             PIC X(30).
  2285     12  CO-ADDR-2                             PIC X(30).
  2286     12  CO-ADDR-3.
  2287         16  CO-ADDR-CITY                      PIC X(27).
  2288         16  CO-ADDR-STATE                     PIC XX.
  2289     12  CO-CSO-1099                           PIC X.
  2290     12  CO-ZIP.
  2291         16  CO-ZIP-PRIME.
  2292             20  CO-ZIP-PRI-1ST                PIC X.
  2293                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2294             20  FILLER                        PIC X(4).
  2295         16  CO-ZIP-PLUS4                      PIC X(4).
  2296     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2297         16  CO-CAN-POSTAL-1                   PIC XXX.
  2298         16  CO-CAN-POSTAL-2                   PIC XXX.
  2299         16  FILLER                            PIC XXX.
  2300     12  CO-SOC-SEC                            PIC X(13).
  2301     12  CO-TELEPHONE.
  2302         16  CO-AREA-CODE                      PIC XXX.
  2303         16  CO-PREFIX                         PIC XXX.
  2304         16  CO-PHONE                          PIC X(4).
  2305
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL650.cbl
  2306     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2307
  2308     12  CO-AR-BAL-LEVEL                       PIC X.
  2309         88  CO-AR-REF-LVL                        VALUE '1'.
  2310         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2311         88  CO-AR-BILL-LVL                       VALUE '2'.
  2312         88  CO-AR-AGT-LVL                        VALUE '3'.
  2313         88  CO-AR-FR-LVL                         VALUE '4'.
  2314
  2315     12  CO-AR-NORMAL-PRINT                    PIC X.
  2316         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2317         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2318
  2319     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2320
  2321     12  CO-AR-REPORTING                       PIC X.
  2322         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2323         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2324
  2325     12  CO-AR-PULL-CHECK                      PIC X.
  2326         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2327         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2328
  2329     12  CO-AR-BALANCE-PRINT                   PIC X.
  2330         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2331
  2332     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2333         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2334         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2335         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2336
  2337     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2338
  2339     12  CO-USER-CODE                          PIC X.
  2340     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2341
  2342******************************************************************
  2343*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2344*    THE LAST MONTH END RUN.
  2345******************************************************************
  2346
  2347     12  CO-LAST-ACTIVITY-DATE.
  2348         16  CO-ACT-YEAR                       PIC 99.
  2349         16  CO-ACT-MONTH                      PIC 99.
  2350         16  CO-ACT-DAY                        PIC 99.
  2351
  2352     12  CO-LAST-STMT-DT.
  2353         16  CO-LAST-STMT-YEAR                 PIC 99.
  2354         16  CO-LAST-STMT-MONTH                PIC 99.
  2355         16  CO-LAST-STMT-DAY                  PIC 99.
  2356
  2357     12  CO-MO-END-TOTALS.
  2358         16  CO-MONTHLY-TOTALS.
  2359             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2360             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2361             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2362             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2363             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL650.cbl
  2364
  2365         16  CO-AGING-TOTALS.
  2366             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2367             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2368             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2369             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2370
  2371         16  CO-YTD-TOTALS.
  2372             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2373             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2374
  2375         16  CO-OVER-UNDER-TOTALS.
  2376             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2377             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2378
  2379     12  CO-MISCELLANEOUS-TOTALS.
  2380         16  CO-FICA-TOTALS.
  2381             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2382             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2383
  2384         16  CO-CLAIM-TOTALS.
  2385             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2386             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2387
  2388******************************************************************
  2389*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2390*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2391******************************************************************
  2392
  2393     12  CO-CURRENT-TOTALS.
  2394         16  CO-CURRENT-LAST-STMT-DT.
  2395             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2396             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2397             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2398
  2399         16  CO-CURRENT-MONTHLY-TOTALS.
  2400             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2401             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2402             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2403             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2404             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2405
  2406         16  CO-CURRENT-AGING-TOTALS.
  2407             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2408             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2409             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2410             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2411
  2412         16  CO-CURRENT-YTD-TOTALS.
  2413             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2414             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2415
  2416     12  CO-PAID-COMM-TOTALS.
  2417         16  CO-YTD-PAID-COMMS.
  2418             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2419             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2420
  2421     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL650.cbl
  2422         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2423         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2424
  2425     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2426         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2427         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2428         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2429         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2430         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2431         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2432         88  CO-FINAL-LETTER                  VALUE 'F'.
  2433         88  CO-RECONCILING                   VALUE 'R'.
  2434         88  CO-PHONE-CALL                    VALUE 'P'.
  2435         88  CO-LEGAL                         VALUE 'L'.
  2436         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2437         88  CO-WRITE-OFF                     VALUE 'W'.
  2438         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2439
  2440     12  CO-CSR-CODE                       PIC X(4).
  2441
  2442     12  CO-GA-STATUS-INFO.
  2443         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2444         16  CO-GA-TERMINATION-DT          PIC XX.
  2445         16  CO-GA-STATUS-CODE             PIC X.
  2446             88  CO-GA-ACTIVE                 VALUE 'A'.
  2447             88  CO-GA-INACTIVE               VALUE 'I'.
  2448             88  CO-GA-PENDING                VALUE 'P'.
  2449         16  CO-GA-COMMENTS.
  2450             20  CO-GA-COMMENT-1           PIC X(40).
  2451             20  CO-GA-COMMENT-2           PIC X(40).
  2452             20  CO-GA-COMMENT-3           PIC X(40).
  2453             20  CO-GA-COMMENT-4           PIC X(40).
  2454
  2455     12  CO-RPTCD2                         PIC X(10).
  2456     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2457         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2458         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2459
  2460     12  CO-TYPE-AGENT                     PIC X(01).
  2461         88  CO-CORPORATION                   VALUE 'C'.
  2462         88  CO-PARTNERSHIP                   VALUE 'P'.
  2463         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2464         88  CO-TRUST                         VALUE 'T'.
  2465         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2466
  2467     12  CO-FAXNO.
  2468         16  CO-FAX-AREA-CODE                  PIC XXX.
  2469         16  CO-FAX-PREFIX                     PIC XXX.
  2470         16  CO-FAX-PHONE                      PIC X(4).
  2471
  2472     12  CO-BANK-INFORMATION.
  2473         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2474         16  CO-BANK-TRANSIT-NON REDEFINES
  2475             CO-BANK-TRANSIT-NO                PIC 9(8).
  2476
  2477         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2478     12  CO-MISC-DEDUCT-INFO REDEFINES
  2479                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL650.cbl
  2480         16  CO-MD-GL-ACCT                     PIC X(10).
  2481         16  CO-MD-DIV                         PIC XX.
  2482         16  CO-MD-CENTER                      PIC X(4).
  2483         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2484         16  CO-CREATE-AP-CHECK                PIC X.
  2485         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2486         16  FILLER                            PIC XXX.
  2487     12  CO-ACH-STATUS                         PIC X.
  2488         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2489         88  CO-ACH-PENDING                        VALUE 'P'.
  2490
  2491     12  CO-BILL-SW                            PIC X.
  2492     12  CO-CONTROL-NAME                       PIC X(30).
  2493     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2494     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2495     12  CO-CLP-STATE                          PIC XX.
  2496     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2497     12  CO-SPP-REFUND-EDIT                    PIC X.
  2498
  2499******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL650.cbl
  2501*    COPY ERCNAME.
  2502******************************************************************
  2503*                                                                *
  2504*                                                                *
  2505*                            ERCNAME                             *
  2506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2507*                            VMOD=2.003                          *
  2508*                                                                *
  2509*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2510*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2511*                                                                *
  2512*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2513*                                                                *
  2514*   FILE TYPE = VSAM,KSDS                                        *
  2515*   RECORD SIZE = 160   RECFORM = FIX                            *
  2516*                                                                *
  2517*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2518*                                                                *
  2519*   LOG = NO                                                     *
  2520*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2521*                                                                *
  2522*                                                                *
  2523******************************************************************
  2524
  2525 01  NAME-LOOKUP-MASTER.
  2526     12  NL-RECORD-ID                PIC  X(02).
  2527         88  VALID-NL-ID                         VALUE 'NL'.
  2528
  2529     12  NL-RECORD-KEY.
  2530         16  NL-CONTROL-PRIMARY.
  2531             20  NL-COMPANY-CD       PIC  X(01).
  2532             20  NL-NAME             PIC  X(30).
  2533             20  NL-RECORD-TYPE      PIC  X(01).
  2534                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2535                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2536                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2537
  2538         16  NL-ACCOUNT-MASTER.
  2539             20  NL-AM-COMPANY-CD    PIC  X(01).
  2540             20  NL-AM-CARRIER       PIC  X(01).
  2541             20  NL-AM-GROUPING      PIC  X(06).
  2542             20  NL-AM-STATE         PIC  X(02).
  2543             20  NL-AM-ACCOUNT       PIC  X(10).
  2544             20  FILLER              PIC  X(09).
  2545
  2546         16  NL-COMPENSATION-MASTER
  2547                                 REDEFINES  NL-ACCOUNT-MASTER.
  2548             20  NL-CO-COMPANY-CD    PIC  X(01).
  2549             20  NL-CO-CARRIER       PIC  X(01).
  2550             20  NL-CO-GROUPING      PIC  X(06).
  2551             20  NL-CO-RESP-NO       PIC  X(10).
  2552             20  NL-CO-ACCOUNT       PIC  X(10).
  2553             20  NL-CO-TYPE          PIC  X(01).
  2554
  2555         16  NL-REINSURANCE-RECORD
  2556                                 REDEFINES  NL-ACCOUNT-MASTER.
  2557             20  NL-RE-COMPANY-CD    PIC  X(01).
  2558             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL650.cbl
  2559             20  NL-RE-COMPANY.
  2560                 24  NL-RE-COMP      PIC  X(03).
  2561                 24  NL-RE-CO-SUB    PIC  X(03).
  2562             20  NL-RE-TABLE         PIC  X(03).
  2563             20  FILLER              PIC  X(18).
  2564
  2565     12  NL-MAINT-INFORMATION.
  2566         16  NL-LAST-MAINT-DT        PIC  X(02).
  2567         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2568         16  NL-LAST-MAINT-USER      PIC  X(04).
  2569         16  FILLER                  PIC  X(10).
  2570
  2571     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2572         16  NL-RE-LEVEL             PIC  9(02).
  2573
  2574     12  NL-CITY                     PIC  X(15).
  2575     12  NL-ST                       PIC  XX.
  2576
  2577******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL650.cbl
  2579*    COPY ERCPLAN.
  2580******************************************************************
  2581*                                                                *
  2582*                                                                *
  2583*                            ERCPLAN                             *
  2584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2585*                            VMOD=2.003                          *
  2586*                                                                *
  2587*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2588*                                                                *
  2589*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2590*   PLAN MASTER                                                  *
  2591*                                                                *
  2592*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2593*                                                                *
  2594*   FILE TYPE = VSAM,KSDS                                        *
  2595*   RECORD SIZE = 420   RECFORM = FIX                            *
  2596*                                                                *
  2597*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2598*       ALTERNATE PATH1 = N/A                                    *
  2599*                                                                *
  2600*   LOG = NO                                                     *
  2601*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2602*                                                                *
  2603*                                                                *
  2604******************************************************************
  2605
  2606 01  PLAN-MASTER.
  2607     12  PL-RECORD-ID                      PIC XX.
  2608         88  VALID-PL-ID                      VALUE 'PL'.
  2609
  2610     12  PL-CONTROL-PRIMARY.
  2611         16  PL-COMPANY-CD                 PIC X.
  2612         16  PL-MSTR-CNTRL.
  2613             20  PL-CONTROL-A.
  2614                 24  PL-CARRIER            PIC X.
  2615                 24  PL-GROUPING           PIC X(6).
  2616                 24  PL-STATE              PIC XX.
  2617                 24  PL-ACCOUNT            PIC X(10).
  2618             20  PL-BENEFIT-TYPE           PIC X.
  2619             20  PL-BENEFIT-CODE           PIC XX.
  2620             20  PL-REVISION-NO            PIC X(3).
  2621
  2622     12  PL-CONTROL-BY-VAR-GRP.
  2623         16  PL-COMPANY-CD-A1              PIC X.
  2624         16  PL-VG-CARRIER                 PIC X.
  2625         16  PL-VG-GROUPING                PIC X(6).
  2626         16  PL-VG-STATE                   PIC XX.
  2627         16  PL-VG-ACCOUNT                 PIC X(10).
  2628         16  PL-BENEFIT-TYPE-A1            PIC X.
  2629         16  PL-BENEFIT-CODE-A1            PIC XX.
  2630         16  PL-REVISION-NO-A1             PIC 999.
  2631
  2632     12  PL-MAINT-INFORMATION.
  2633         16  PL-LAST-MAINT-DT              PIC XX.
  2634         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2635         16  PL-LAST-MAINT-USER            PIC X(4).
  2636         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL650.cbl
  2637
  2638     12  PL-LIABILITY-LIMITS.
  2639         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2640         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2641             20  PL-LM-AGE                 PIC S99        COMP-3.
  2642             20  PL-LM-DUR                 PIC S999       COMP-3.
  2643             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2644             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2645
  2646     12  FILLER                            PIC X(30).
  2647
  2648     12  PL-GL-ACCOUNT-NOS.
  2649         16  PL-PREMIUM-GL                 PIC X(8).
  2650         16  PL-COMM-GL                    PIC X(8).
  2651         16  PL-CLAIM-GL                   PIC X(8).
  2652     12  FILLER                            PIC X(24).
  2653     12  PL-TOLERANCES.
  2654         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2655         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2656         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2657         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2658         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2659         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2660     12  PL-OVER-SHORT.
  2661         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2662         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2663     12  FILLER                            PIC X(24).
  2664     12  PLAN-MISC.
  2665         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2666         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2667         16  PL-IG                         PIC X.
  2668         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2669         16  PL-POLICY-FORM                PIC X(12).
  2670         16  PL-EDIT-FOR-FORM              PIC X(01).
  2671         16  PL-DEV-CODE                   PIC XXX.
  2672         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2673         16  PL-CALC-METHOD                PIC X.
  2674         16  PL-BENEFIT-GROUP              PIC X(05).
  2675         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2676
  2677         16  FILLER                        PIC X(99).
  2678******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL650.cbl
  2680*    COPY ELCCNTL.
  2681******************************************************************
  2682*                                                                *
  2683*                                                                *
  2684*                            ELCCNTL.                            *
  2685*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2686*                            VMOD=2.059                          *
  2687*                                                                *
  2688*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2689*                                                                *
  2690*   FILE TYPE = VSAM,KSDS                                        *
  2691*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2692*                                                                *
  2693*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2694*       ALTERNATE INDEX = NONE                                   *
  2695*                                                                *
  2696*   LOG = YES                                                    *
  2697*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2698******************************************************************
  2699*                   C H A N G E   L O G
  2700*
  2701* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2702*-----------------------------------------------------------------
  2703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2704* EFFECTIVE    NUMBER
  2705*-----------------------------------------------------------------
  2706* 082503                   PEMA  ADD BENEFIT GROUP
  2707* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2708* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2709* 092705    2005050300006  PEMA  ADD SPP LEASES
  2710* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2711* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2712* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2713* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2714* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2715******************************************************************
  2716*
  2717 01  CONTROL-FILE.
  2718     12  CF-RECORD-ID                       PIC XX.
  2719         88  VALID-CF-ID                        VALUE 'CF'.
  2720
  2721     12  CF-CONTROL-PRIMARY.
  2722         16  CF-COMPANY-ID                  PIC XXX.
  2723         16  CF-RECORD-TYPE                 PIC X.
  2724             88  CF-COMPANY-MASTER              VALUE '1'.
  2725             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2726             88  CF-STATE-MASTER                VALUE '3'.
  2727             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2728             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2729             88  CF-CARRIER-MASTER              VALUE '6'.
  2730             88  CF-MORTALITY-MASTER            VALUE '7'.
  2731             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2732             88  CF-TERMINAL-MASTER             VALUE '9'.
  2733             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2734             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2735             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2736             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2737             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL650.cbl
  2738             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2739             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2740             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2741             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2742         16  CF-ACCESS-CD-GENL              PIC X(4).
  2743         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2744             20  CF-PROCESSOR               PIC X(4).
  2745         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2746             20  CF-STATE-CODE              PIC XX.
  2747             20  FILLER                     PIC XX.
  2748         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2749             20  FILLER                     PIC XX.
  2750             20  CF-HI-BEN-IN-REC           PIC XX.
  2751         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2752             20  FILLER                     PIC XXX.
  2753             20  CF-CARRIER-CNTL            PIC X.
  2754         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2755             20  FILLER                     PIC XX.
  2756             20  CF-HI-TYPE-IN-REC          PIC 99.
  2757         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2758             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2759                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2760             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2761             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2762         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2763             20  FILLER                     PIC X.
  2764             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2765         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2766             20  FILLER                     PIC XX.
  2767             20  CF-MORTGAGE-PLAN           PIC XX.
  2768         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2769
  2770     12  CF-LAST-MAINT-DT                   PIC XX.
  2771     12  CF-LAST-MAINT-BY                   PIC X(4).
  2772     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2773
  2774     12  CF-RECORD-BODY                     PIC X(728).
  2775
  2776
  2777****************************************************************
  2778*             COMPANY MASTER RECORD                            *
  2779****************************************************************
  2780
  2781     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2782         16  CF-COMPANY-ADDRESS.
  2783             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2784             20  CF-CL-IN-CARE-OF           PIC X(30).
  2785             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2786             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2787             20  CF-CL-CITY-STATE           PIC X(30).
  2788             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2789             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2790         16  CF-COMPANY-CD                  PIC X.
  2791         16  CF-COMPANY-PASSWORD            PIC X(8).
  2792         16  CF-SECURITY-OPTION             PIC X.
  2793             88  ALL-SECURITY                   VALUE '1'.
  2794             88  COMPANY-VERIFY                 VALUE '2'.
  2795             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL650.cbl
  2796             88  NO-SECURITY                    VALUE '4'.
  2797             88  ALL-BUT-TERM                   VALUE '5'.
  2798         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2799             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2800         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2801             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2802         16  CF-INFORCE-LOCATION            PIC X.
  2803             88  CERTS-ARE-ONLINE               VALUE '1'.
  2804             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2805             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2806         16  CF-LOWER-CASE-LETTERS          PIC X.
  2807         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2808             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2809             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2810             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2811             88  CF-ACCNT-CNTL                  VALUE '3'.
  2812             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2813
  2814         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2815         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2816
  2817         16  CF-LGX-CREDIT-USER             PIC X.
  2818             88  CO-IS-NOT-USER                 VALUE 'N'.
  2819             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2820
  2821         16 CF-CREDIT-CALC-CODES.
  2822             20  CF-CR-REM-TERM-CALC PIC X.
  2823               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2824               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2825               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2826               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2827               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2828               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2829               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2830             20  CF-CR-R78-METHOD           PIC X.
  2831               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2832               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2833
  2834         16  CF-CLAIM-CONTROL-COUNTS.
  2835             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2836                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2837
  2838             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2839                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2840
  2841             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2842                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2843
  2844             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2845                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2846
  2847         16  CF-CURRENT-MONTH-END           PIC XX.
  2848
  2849         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2850             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2851             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2852             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2853             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL650.cbl
  2854                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2855                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2856             20  CF-CO-PREM-REJECT-SW       PIC X.
  2857                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2858                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2859             20  CF-CO-REF-REJECT-SW        PIC X.
  2860                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2861                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2862
  2863         16  CF-CO-REPORTING-DT             PIC XX.
  2864         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2865         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2866           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2867           88  CF-CO-MONTH-END                  VALUE '1'.
  2868
  2869         16  CF-LGX-CLAIM-USER              PIC X.
  2870             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2871             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2872
  2873         16  CF-CREDIT-EDIT-CONTROLS.
  2874             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2875             20  CF-MIN-AGE                 PIC 99.
  2876             20  CF-DEFAULT-AGE             PIC 99.
  2877             20  CF-MIN-TERM                PIC S999      COMP-3.
  2878             20  CF-MAX-TERM                PIC S999      COMP-3.
  2879             20  CF-DEFAULT-SEX             PIC X.
  2880             20  CF-JOINT-AGE-INPUT         PIC X.
  2881                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2882             20  CF-BIRTH-DATE-INPUT        PIC X.
  2883                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2884             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2885                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2886                 88  CF-ZERO-CARRIER            VALUE '1'.
  2887                 88  CF-ZERO-GROUPING           VALUE '2'.
  2888                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2889             20  CF-EDIT-SW                 PIC X.
  2890                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2891             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2892             20  CF-CR-PR-METHOD            PIC X.
  2893               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2894               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2895             20  FILLER                     PIC X.
  2896
  2897         16  CF-CREDIT-MISC-CONTROLS.
  2898             20  CF-REIN-TABLE-SW           PIC X.
  2899                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2900             20  CF-COMP-TABLE-SW           PIC X.
  2901                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2902             20  CF-EXPERIENCE-RETENTION-AGE
  2903                                            PIC S9        COMP-3.
  2904             20  CF-CONVERSION-DT           PIC XX.
  2905             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2906             20  CF-RUN-FREQUENCY-SW        PIC X.
  2907                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2908                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2909
  2910             20  CF-CR-CHECK-NO-CONTROL.
  2911                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL650.cbl
  2912                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2913                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2914                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2915                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2916                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2917
  2918                 24  CF-CR-CHECK-COUNT       REDEFINES
  2919                     CF-CR-CHECK-COUNTER      PIC X(4).
  2920
  2921                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2922                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2923
  2924                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2925                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2926                 24  CF-MAIL-PROCESSING       PIC X.
  2927                     88  MAIL-PROCESSING          VALUE 'Y'.
  2928
  2929         16  CF-MISC-SYSTEM-CONTROL.
  2930             20  CF-SYSTEM-C                 PIC X.
  2931                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2932             20  CF-SYSTEM-D                 PIC X.
  2933                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2934             20  CF-SOC-SEC-NO-SW            PIC X.
  2935                 88  SOC-SEC-NO-USED             VALUE '1'.
  2936             20  CF-MEMBER-NO-SW             PIC X.
  2937                 88  MEMBER-NO-USED              VALUE '1'.
  2938             20  CF-TAX-ID-NUMBER            PIC X(11).
  2939             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2940             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2941                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2942                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2943                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2944                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2945             20  CF-SYSTEM-E                 PIC X.
  2946                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2947
  2948         16  CF-LGX-LIFE-USER               PIC X.
  2949             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2950             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2951
  2952         16  CF-CR-MONTH-END-DT             PIC XX.
  2953
  2954         16  CF-FILE-MAINT-DATES.
  2955             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2956                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2957             20  CF-LAST-BATCH       REDEFINES
  2958                 CF-LAST-BATCH-NO               PIC X(4).
  2959             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2960             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2961             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2962             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2963             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2964             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2965             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2966             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2967             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2968             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2969
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL650.cbl
  2970         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2971         16  FILLER                         PIC X.
  2972
  2973         16  CF-ALT-MORT-CODE               PIC X(4).
  2974         16  CF-MEMBER-CAPTION              PIC X(10).
  2975
  2976         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2977             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2978             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2979             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2980             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2981             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2982
  2983         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2984
  2985         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2986         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2987         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2988         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2989
  2990         16  CF-AH-OVERRIDE-L1              PIC X.
  2991         16  CF-AH-OVERRIDE-L2              PIC XX.
  2992         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2993         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2994
  2995         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2996         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2997
  2998         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2999         16  CF-AR-LAST-EL860-DT            PIC XX.
  3000         16  CF-MP-MONTH-END-DT             PIC XX.
  3001
  3002         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3003         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3004             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3005
  3006         16  CF-AR-MONTH-END-DT             PIC XX.
  3007
  3008         16  CF-CRDTCRD-USER                PIC X.
  3009             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3010             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3011
  3012         16  CF-CC-MONTH-END-DT             PIC XX.
  3013
  3014         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3015
  3016         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3017             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3018             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3019             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3020         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3021         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3022         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3023         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3024             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3025             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3026         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3027         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL650.cbl
  3028         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3029             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3030         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3031
  3032         16  CF-CL-ZIP-CODE.
  3033             20  CF-CL-ZIP-PRIME.
  3034                 24  CF-CL-ZIP-1ST          PIC X.
  3035                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3036                 24  FILLER                 PIC X(4).
  3037             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3038         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3039             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3040             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3041             20  FILLER                     PIC XXX.
  3042
  3043         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3044         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3045         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3046         16  CF-CO-OPTION-START-DATE        PIC XX.
  3047         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3048           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3049                                                      '3' '4'.
  3050           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3051           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3052           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3053           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3054           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3055           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3056
  3057         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3058
  3059         16  CF-PAYMENT-APPROVAL-LEVELS.
  3060             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3061             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3062             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3063             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3064             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3065             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3066
  3067         16  CF-END-USER-REPORTING-USER     PIC X.
  3068             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3069             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3070
  3071         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3072             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3073             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3074
  3075         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3076
  3077         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3078         16  FILLER                         PIC X.
  3079
  3080         16  CF-CREDIT-ARCHIVE-CNTL.
  3081             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3082             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3083             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3084
  3085         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL650.cbl
  3086
  3087         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3088             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3089             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3090
  3091         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3092             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3093             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3094
  3095         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3096
  3097         16  CF-CO-ACH-ID-CODE              PIC  X.
  3098             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3099             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3100             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3101         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3102         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3103         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3104         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3105         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3106         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3107         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3108         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3109         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3110                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3111         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3112                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3113
  3114         16  CF-CO-OVER-SHORT.
  3115             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3116             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3117
  3118*         16  FILLER                         PIC X(102).
  3119         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3120             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3121             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3122
  3123         16  CF-AH-APPROVAL-DAYS.
  3124             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3125             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3126             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3127             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3128
  3129         16  FILLER                         PIC X(82).
  3130****************************************************************
  3131*             PROCESSOR/USER RECORD                            *
  3132****************************************************************
  3133
  3134     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3135         16  CF-PROCESSOR-NAME              PIC X(30).
  3136         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3137         16  CF-PROCESSOR-TITLE             PIC X(26).
  3138         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3139                 88  MESSAGE-YES                VALUE 'Y'.
  3140                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3141
  3142*****************************************************
  3143****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL650.cbl
  3144****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3145****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3146****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3147*****************************************************
  3148
  3149         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3150             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3151             20  CF-APPLICATION-FORCE       PIC X.
  3152             20  CF-INDIVIDUAL-APP.
  3153                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3154                     28  CF-BROWSE-APP      PIC X.
  3155                     28  CF-UPDATE-APP      PIC X.
  3156
  3157         16  CF-CURRENT-TERM-ON             PIC X(4).
  3158         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3159             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3160             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3161             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3162             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3163             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3164             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3165             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3166         16  CF-PROCESSOR-CARRIER           PIC X.
  3167             88  NO-CARRIER-SECURITY            VALUE ' '.
  3168         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3169             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3170         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3171             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3172         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3173             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3174
  3175         16  CF-PROC-SYS-ACCESS-SW.
  3176             20  CF-PROC-CREDIT-CLAIMS-SW.
  3177                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3178                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3179                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3180                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3181             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3182                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3183                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3184             20  CF-PROC-LIFE-GNRLDGR-SW.
  3185                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3186                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3187                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3188                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3189             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3190                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3191                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3192         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3193             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3194             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3195         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3196
  3197         16  CF-APPROVAL-LEVEL                  PIC X.
  3198             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3199             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3200             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3201             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL650.cbl
  3202
  3203         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3204
  3205         16  CF-LANGUAGE-TYPE                   PIC X.
  3206             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3207             88  CF-LANG-IS-FR                      VALUE 'F'.
  3208         16  FILLER                             PIC  X(240).
  3209
  3210****************************************************************
  3211*             PROCESSOR/REMINDERS RECORD                       *
  3212****************************************************************
  3213
  3214     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3215         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3216             20  CF-START-REMIND-DT         PIC XX.
  3217             20  CF-END-REMIND-DT           PIC XX.
  3218             20  CF-REMINDER-TEXT           PIC X(50).
  3219         16  FILLER                         PIC X(296).
  3220
  3221
  3222****************************************************************
  3223*             STATE MASTER RECORD                              *
  3224****************************************************************
  3225
  3226     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3227         16  CF-STATE-ABBREVIATION          PIC XX.
  3228         16  CF-STATE-NAME                  PIC X(25).
  3229         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3230         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3231             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3232             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3233             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3234             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3235                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3236                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3237             20  CF-ST-PREM-REJECT-SW       PIC X.
  3238                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3239                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3240             20  CF-ST-REF-REJECT-SW        PIC X.
  3241                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3242                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3243         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3244         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3245         16  CF-ST-REFUND-RULES.
  3246             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3247             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3248             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3249         16  CF-ST-FST-PMT-EXTENSION.
  3250             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3251             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3252                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3253                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3254                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3255                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3256         16  CF-ST-STATE-CALL.
  3257             20  CF-ST-CALL-UNEARNED        PIC X.
  3258             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3259             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL650.cbl
  3260         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3261             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3262             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3263         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3264         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3265         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3266         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3267         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3268         16  FILLER                         PIC X.
  3269         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3270             20  CF-ST-BENEFIT-CD           PIC XX.
  3271             20  CF-ST-BENEFIT-KIND         PIC X.
  3272                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3273                 88  CF-ST-AH-KIND              VALUE 'A'.
  3274             20  CF-ST-REM-TERM-CALC        PIC X.
  3275                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3276                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3277                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3278                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3279                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3280                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3281                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3282                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3283
  3284             20  CF-ST-REFUND-CALC          PIC X.
  3285                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3286                 88  ST-REFD-BY-R78             VALUE '1'.
  3287                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3288                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3289                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3290                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3291                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3292                 88  ST-REFD-UTAH               VALUE '7'.
  3293                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3294                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3295                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3296
  3297             20  CF-ST-EARNING-CALC         PIC X.
  3298                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3299                 88  ST-EARN-BY-R78             VALUE '1'.
  3300                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3301                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3302                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3303                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3304                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3305                 88  ST-EARN-MEAN               VALUE '8'.
  3306                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3307
  3308             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3309                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3310                 88  ST-OVRD-BY-R78             VALUE '1'.
  3311                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3312                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3313                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3314                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3315                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3316                 88  ST-OVRD-MEAN               VALUE '8'.
  3317                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL650.cbl
  3318             20  FILLER                     PIC X.
  3319
  3320         16  CF-ST-COMMISSION-CAPS.
  3321             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3322             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3323             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3324             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3325         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3326                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3327
  3328         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3329
  3330         16  CF-ST-STATUTORY-INTEREST.
  3331             20  CF-ST-STAT-DATE-FROM       PIC X.
  3332                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3333                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3334             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3335             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3336             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3337             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3338             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3339
  3340         16  CF-ST-OVER-SHORT.
  3341             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3342             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3343
  3344         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3345
  3346         16  CF-ST-RT-CALC                  PIC X.
  3347
  3348         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3349         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3350         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3351         16  CF-ST-RF-LR-CALC               PIC X.
  3352         16  CF-ST-RF-LL-CALC               PIC X.
  3353         16  CF-ST-RF-LN-CALC               PIC X.
  3354         16  CF-ST-RF-AH-CALC               PIC X.
  3355         16  CF-ST-RF-CP-CALC               PIC X.
  3356*        16  FILLER                         PIC X(206).
  3357*CIDMOD         16  FILLER                         PIC X(192).
  3358         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3359             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3360         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3361         16  CF-ST-VFY-2ND-BENE             PIC X.
  3362         16  FILLER                         PIC X(186).
  3363
  3364****************************************************************
  3365*             BENEFIT MASTER RECORD                            *
  3366****************************************************************
  3367
  3368     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3369         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3370             20  CF-BENEFIT-CODE            PIC XX.
  3371             20  CF-BENEFIT-NUMERIC  REDEFINES
  3372                 CF-BENEFIT-CODE            PIC XX.
  3373             20  CF-BENEFIT-ALPHA           PIC XXX.
  3374             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3375             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL650.cbl
  3376
  3377             20  CF-LF-COVERAGE-TYPE        PIC X.
  3378                 88  CF-REDUCING                VALUE 'R'.
  3379                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3380
  3381             20  CF-SPECIAL-CALC-CD         PIC X.
  3382                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3383                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3384                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3385                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3386                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3387                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3388                 88  CF-FARM-PLAN               VALUE 'F'.
  3389                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3390                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3391                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3392                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3393                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3394                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3395                 88  CF-PRUDENTIAL              VALUE 'P'.
  3396                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3397                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3398                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3399                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3400                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3401                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3402
  3403             20  CF-JOINT-INDICATOR         PIC X.
  3404                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3405
  3406*            20  FILLER                     PIC X(12).
  3407             20  FILLER                     PIC X(11).
  3408             20  CF-BENEFIT-CATEGORY        PIC X.
  3409             20  CF-LOAN-TYPE               PIC X(8).
  3410
  3411             20  CF-CO-REM-TERM-CALC        PIC X.
  3412                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3413                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3414                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3415                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3416                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3417
  3418             20  CF-CO-EARNINGS-CALC        PIC X.
  3419                 88  CO-EARN-BY-R78             VALUE '1'.
  3420                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3421                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3422                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3423                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3424                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3425                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3426                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3427
  3428             20  CF-CO-REFUND-CALC          PIC X.
  3429                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3430                 88  CO-REFD-BY-R78             VALUE '1'.
  3431                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3432                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3433                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL650.cbl
  3434                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3435                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3436                 88  CO-REFD-MEAN               VALUE '8'.
  3437                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3438                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3439                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3440
  3441             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3442                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3443                 88  CO-OVRD-BY-R78             VALUE '1'.
  3444                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3445                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3446                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3447                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3448                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3449                 88  CO-OVRD-MEAN               VALUE '8'.
  3450                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3451
  3452             20  CF-CO-BEN-I-G-CD           PIC X.
  3453                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3454                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3455                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3456
  3457         16  FILLER                         PIC X(304).
  3458
  3459
  3460****************************************************************
  3461*             CARRIER MASTER RECORD                            *
  3462****************************************************************
  3463
  3464     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3465         16  CF-ADDRESS-DATA.
  3466             20  CF-MAIL-TO-NAME            PIC X(30).
  3467             20  CF-IN-CARE-OF              PIC X(30).
  3468             20  CF-ADDRESS-LINE-1          PIC X(30).
  3469             20  CF-ADDRESS-LINE-2          PIC X(30).
  3470             20  CF-CITY-STATE              PIC X(30).
  3471             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3472             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3473
  3474         16  CF-CLAIM-NO-CONTROL.
  3475             20  CF-CLAIM-NO-METHOD         PIC X.
  3476                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3477                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3478                 88  CLAIM-NO-SEQ               VALUE '3'.
  3479                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3480             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3481                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3482                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3483                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3484
  3485         16  CF-CHECK-NO-CONTROL.
  3486             20  CF-CHECK-NO-METHOD         PIC X.
  3487                 88  CHECK-NO-MANUAL            VALUE '1'.
  3488                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3489                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3490                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3491             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL650.cbl
  3492                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3493
  3494         16  CF-DOMICILE-STATE              PIC XX.
  3495
  3496         16  CF-EXPENSE-CONTROLS.
  3497             20  CF-EXPENSE-METHOD          PIC X.
  3498                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3499                 88  DOLLARS-PER-PMT            VALUE '2'.
  3500                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3501                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3502             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3503             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3504
  3505         16  CF-CORRESPONDENCE-CONTROL.
  3506             20  CF-LETTER-RESEND-OPT       PIC X.
  3507                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3508                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3509             20  FILLER                     PIC X(4).
  3510
  3511         16  CF-RESERVE-CONTROLS.
  3512             20  CF-MANUAL-SW               PIC X.
  3513                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3514             20  CF-FUTURE-SW               PIC X.
  3515                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3516             20  CF-PTC-SW                  PIC X.
  3517                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3518             20  CF-IBNR-SW                 PIC X.
  3519                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3520             20  CF-PTC-LF-SW               PIC X.
  3521                 88  CF-LF-PTC-USED             VALUE '1'.
  3522             20  CF-CDT-ACCESS-METHOD       PIC X.
  3523                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3524                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3525                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3526             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3527
  3528         16  CF-CLAIM-CALC-METHOD           PIC X.
  3529             88  360-PLUS-MONTHS                VALUE '1'.
  3530             88  365-PLUS-MONTHS                VALUE '2'.
  3531             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3532             88  360-DAILY                      VALUE '4'.
  3533             88  365-DAILY                      VALUE '5'.
  3534
  3535         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3536         16  FILLER                         PIC X(11).
  3537
  3538         16  CF-LIMIT-AMOUNTS.
  3539             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3540             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3541             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3542             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3543             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3544             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3545             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3546             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3547             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3548             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL650.cbl
  3550         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3551         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3552         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3553
  3554         16  CF-ZIP-CODE.
  3555             20  CF-ZIP-PRIME.
  3556                 24  CF-ZIP-1ST             PIC X.
  3557                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3558                 24  FILLER                 PIC X(4).
  3559             20  CF-ZIP-PLUS4               PIC X(4).
  3560         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3561             20  CF-CAN-POSTAL-1            PIC XXX.
  3562             20  CF-CAN-POSTAL-2            PIC XXX.
  3563             20  FILLER                     PIC XXX.
  3564
  3565         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3566         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3567         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3568
  3569         16  CF-RATING-SWITCH               PIC X.
  3570             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3571             88  CF-NO-RATING                   VALUE 'N'.
  3572
  3573         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3574
  3575         16  CF-CARRIER-OVER-SHORT.
  3576             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3577             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3578
  3579         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3580         16  CF-SECPAY-SWITCH               PIC X.
  3581             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3582             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3583         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3584         16  FILLER                         PIC X(448).
  3585*        16  FILLER                         PIC X(452).
  3586
  3587
  3588****************************************************************
  3589*             MORTALITY MASTER RECORD                          *
  3590****************************************************************
  3591
  3592     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3593         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3594                                INDEXED BY CF-MORT-NDX.
  3595             20  CF-MORT-TABLE              PIC X(5).
  3596             20  CF-MORT-TABLE-TYPE         PIC X.
  3597                 88  CF-MORT-JOINT              VALUE 'J'.
  3598                 88  CF-MORT-SINGLE             VALUE 'S'.
  3599                 88  CF-MORT-COMBINED           VALUE 'C'.
  3600                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3601                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3602             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3603             20  CF-MORT-AGE-METHOD         PIC XX.
  3604                 88  CF-AGE-LAST                VALUE 'AL'.
  3605                 88  CF-AGE-NEAR                VALUE 'AN'.
  3606             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3607             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL650.cbl
  3608                                            PIC X.
  3609                 88  CF-MINUS                   VALUE '-'.
  3610                 88  CF-PLUS                    VALUE '+'.
  3611             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3612             20  CF-MORT-JOINT-CODE         PIC X.
  3613                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3614             20  CF-MORT-PC-Q               PIC X.
  3615                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3616             20  CF-MORT-TABLE-CODE         PIC X(4).
  3617             20  CF-MORT-COMMENTS           PIC X(15).
  3618             20  FILLER                     PIC X(14).
  3619
  3620         16  FILLER                         PIC X(251).
  3621
  3622
  3623****************************************************************
  3624*             BUSSINESS TYPE MASTER RECORD                     *
  3625****************************************************************
  3626
  3627     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3628* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3629* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3630* AND RECORD 05 IS TYPES 81-99
  3631         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3632             20  CF-BUSINESS-TITLE          PIC  X(19).
  3633             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3634                                            PIC S9V9(4) COMP-3.
  3635             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3636             20  FILLER                     PIC  X.
  3637         16  FILLER                         PIC  X(248).
  3638
  3639
  3640****************************************************************
  3641*             TERMINAL MASTER RECORD                           *
  3642****************************************************************
  3643
  3644     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3645
  3646         16  CF-COMPANY-TERMINALS.
  3647             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3648                                  PIC X(4).
  3649         16  FILLER               PIC X(248).
  3650
  3651
  3652****************************************************************
  3653*             LIFE EDIT MASTER RECORD                          *
  3654****************************************************************
  3655
  3656     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3657         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3658             20  CF-LIFE-CODE-IN            PIC XX.
  3659             20  CF-LIFE-CODE-OUT           PIC XX.
  3660         16  FILLER                         PIC X(248).
  3661
  3662
  3663****************************************************************
  3664*             AH EDIT MASTER RECORD                            *
  3665****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL650.cbl
  3666
  3667     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3668         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3669             20  CF-AH-CODE-IN              PIC XXX.
  3670             20  CF-AH-CODE-OUT             PIC XX.
  3671         16  FILLER                         PIC X(248).
  3672
  3673
  3674****************************************************************
  3675*             CREDIBILITY TABLES                               *
  3676****************************************************************
  3677
  3678     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3679         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3680                             INDEXED BY CF-CRDB-NDX.
  3681             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3682             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3683             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3684         16  FILLER                         PIC  X(332).
  3685
  3686
  3687****************************************************************
  3688*             REPORT CUSTOMIZATION RECORD                      *
  3689****************************************************************
  3690
  3691     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3692         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3693             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3694             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3695             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3696**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3697****       A T-TRANSFER.                                   ****
  3698             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3699
  3700         16  FILLER                         PIC XX.
  3701
  3702         16  CF-CARRIER-CNTL-OPT.
  3703             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3704                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3705                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3706             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3707                                            PIC X.
  3708         16  CF-GROUP-CNTL-OPT.
  3709             20  CF-GROUP-OPT-SEQ           PIC 9.
  3710                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3711                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3712             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3713                                            PIC X(6).
  3714         16  CF-STATE-CNTL-OPT.
  3715             20  CF-STATE-OPT-SEQ           PIC 9.
  3716                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3717                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3718             20  CF-STATE-SELECT OCCURS 3 TIMES
  3719                                            PIC XX.
  3720         16  CF-ACCOUNT-CNTL-OPT.
  3721             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3722                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3723                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL650.cbl
  3724             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3725                                            PIC X(10).
  3726         16  CF-BUS-TYP-CNTL-OPT.
  3727             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3728                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3729                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3730             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3731                                            PIC XX.
  3732         16  CF-LF-TYP-CNTL-OPT.
  3733             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3734                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3735                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3736             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3737                                            PIC XX.
  3738         16  CF-AH-TYP-CNTL-OPT.
  3739             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3740                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3741                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3742             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3743                                            PIC XX.
  3744         16  CF-REPTCD1-CNTL-OPT.
  3745             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3746                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3747                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3748             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3749                                            PIC X(10).
  3750         16  CF-REPTCD2-CNTL-OPT.
  3751             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3752                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3753                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3754             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3755                                            PIC X(10).
  3756         16  CF-USER1-CNTL-OPT.
  3757             20  CF-USER1-OPT-SEQ           PIC 9.
  3758                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3759                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3760             20  CF-USER1-SELECT OCCURS 3 TIMES
  3761                                            PIC X(10).
  3762         16  CF-USER2-CNTL-OPT.
  3763             20  CF-USER2-OPT-SEQ           PIC 9.
  3764                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3765                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3766             20  CF-USER2-SELECT OCCURS 3 TIMES
  3767                                            PIC X(10).
  3768         16  CF-USER3-CNTL-OPT.
  3769             20  CF-USER3-OPT-SEQ           PIC 9.
  3770                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3771                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3772             20  CF-USER3-SELECT OCCURS 3 TIMES
  3773                                            PIC X(10).
  3774         16  CF-USER4-CNTL-OPT.
  3775             20  CF-USER4-OPT-SEQ           PIC 9.
  3776                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3777                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3778             20  CF-USER4-SELECT OCCURS 3 TIMES
  3779                                            PIC X(10).
  3780         16  CF-USER5-CNTL-OPT.
  3781             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL650.cbl
  3782                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3783                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3784             20  CF-USER5-SELECT OCCURS 3 TIMES
  3785                                            PIC X(10).
  3786         16  CF-REINS-CNTL-OPT.
  3787             20  CF-REINS-OPT-SEQ           PIC 9.
  3788                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3789                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3790             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3791                 24  CF-REINS-PRIME         PIC XXX.
  3792                 24  CF-REINS-SUB           PIC XXX.
  3793
  3794         16  CF-AGENT-CNTL-OPT.
  3795             20  CF-AGENT-OPT-SEQ           PIC 9.
  3796                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3797                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3798             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3799                                            PIC X(10).
  3800
  3801         16  FILLER                         PIC X(43).
  3802
  3803         16  CF-LOSS-RATIO-SELECT.
  3804             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3805             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3806         16  CF-ENTRY-DATE-SELECT.
  3807             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3808             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3809         16  CF-EFFECTIVE-DATE-SELECT.
  3810             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3811             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3812
  3813         16  CF-EXCEPTION-LIST-IND          PIC X.
  3814             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3815
  3816         16  FILLER                         PIC X(318).
  3817
  3818****************************************************************
  3819*                  EXCEPTION REPORTING RECORD                  *
  3820****************************************************************
  3821
  3822     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3823         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3824             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3825
  3826         16  CF-COMBINED-LIFE-AH-OPT.
  3827             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3828             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3829             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3830             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3831
  3832         16  CF-LIFE-OPT.
  3833             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3834             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3835             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3836             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3837             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3838             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3839             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL650.cbl
  3840             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3841             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3842             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3843
  3844         16  CF-AH-OPT.
  3845             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3846             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3847             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3848             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3849             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3850             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3851             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3852             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3853             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3854             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3855
  3856         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3857             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3858             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3859             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3860
  3861         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3862
  3863         16  FILLER                         PIC X(673).
  3864
  3865
  3866****************************************************************
  3867*             MORTGAGE SYSTEM PLAN RECORD                      *
  3868****************************************************************
  3869
  3870     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3871         16  CF-PLAN-TYPE                   PIC X.
  3872             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3873             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3874             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3875         16  CF-PLAN-ABBREV                 PIC XXX.
  3876         16  CF-PLAN-DESCRIPT               PIC X(10).
  3877         16  CF-PLAN-NOTES                  PIC X(20).
  3878         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3879         16  CF-PLAN-UNDERWRITING.
  3880             20  CF-PLAN-TERM-DATA.
  3881                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3882                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3883             20  CF-PLAN-AGE-DATA.
  3884                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3885                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3886                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3887             20  CF-PLAN-BENEFIT-DATA.
  3888                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3889                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3890                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3891                                            PIC S9(7)V99  COMP-3.
  3892         16  CF-PLAN-POLICY-FORMS.
  3893             20  CF-POLICY-FORM             PIC X(12).
  3894             20  CF-MASTER-APPLICATION      PIC X(12).
  3895             20  CF-MASTER-POLICY           PIC X(12).
  3896         16  CF-PLAN-RATING.
  3897             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL650.cbl
  3898             20  CF-SEX-RATING              PIC X.
  3899                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3900                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3901             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3902             20  CF-SUB-STD-TYPE            PIC X.
  3903                 88  CF-PCT-OF-PREM            VALUE '1'.
  3904                 88  CF-PCT-OF-BENE            VALUE '2'.
  3905         16  CF-PLAN-PREM-TOLERANCES.
  3906             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3907             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3908         16  CF-PLAN-PYMT-TOLERANCES.
  3909             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3910             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3911         16  CF-PLAN-MISC-DATA.
  3912             20  FILLER                     PIC X.
  3913             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3914             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3915         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3916         16  CF-PLAN-IND-GRP                PIC X.
  3917             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3918                                                     '1'.
  3919             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3920                                                     '2'.
  3921         16  CF-MIB-SEARCH-SW               PIC X.
  3922             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3923             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3924             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3925             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3926         16  CF-ALPHA-SEARCH-SW             PIC X.
  3927             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3928             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3929             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3930             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3931             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3932             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3933             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3934             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3935             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3936             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3937                                                     'A' 'B' 'C'
  3938                                                     'X' 'Y' 'Z'.
  3939         16  CF-EFF-DT-RULE-SW              PIC X.
  3940             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3941             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3942             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3943             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3944             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3945         16  FILLER                         PIC X(4).
  3946         16  CF-HEALTH-QUESTIONS            PIC X.
  3947             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3948         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3949         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3950         16  CF-PLAN-SNGL-JNT               PIC X.
  3951             88  CF-COMBINED-PLAN              VALUE 'C'.
  3952             88  CF-JNT-PLAN                   VALUE 'J'.
  3953             88  CF-SNGL-PLAN                  VALUE 'S'.
  3954         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3955         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL650.cbl
  3956         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3957         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3958         16  CF-RERATE-CNTL                 PIC  X.
  3959             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3960             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3961             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3962             88  CF-AUTO-RECALC                 VALUE '4'.
  3963         16  CF-BENEFIT-TYPE                PIC  X.
  3964             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3965             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3966         16  CF-POLICY-FEE                  PIC S999V99
  3967                                                    COMP-3.
  3968         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3969         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3970         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3971         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3972         16  FILLER                         PIC  X(32).
  3973         16  CF-TERMINATION-FORM            PIC  X(04).
  3974         16  FILLER                         PIC  X(08).
  3975         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3976                                                       COMP-3.
  3977         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3978         16  CF-ISSUE-LETTER                PIC  X(4).
  3979         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3980         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3981             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3982             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3983         16  CF-MP-REFUND-CALC              PIC X.
  3984             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3985             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3986             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3987             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3988             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3989             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3990             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3991             88  CF-MP-REFD-MEAN                VALUE '8'.
  3992         16  CF-ALT-RATE-CODE               PIC  X(5).
  3993
  3994
  3995         16  FILLER                         PIC X(498).
  3996****************************************************************
  3997*             MORTGAGE COMPANY MASTER RECORD                   *
  3998****************************************************************
  3999
  4000     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4001         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4002         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4003             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4004             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4005             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4006             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4007             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4008
  4009         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4010         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4011         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4012         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4013         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL650.cbl
  4014
  4015         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4016             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4017         16  CF-MP-RECON-USE-IND            PIC X(1).
  4018             88  CF-MP-USE-RECON             VALUE 'Y'.
  4019         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4020             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4021         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4022             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4023             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4024         16  FILLER                         PIC X(1).
  4025         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4026             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4027         16  CF-MORTG-MIB-VERSION           PIC X.
  4028             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4029             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4030             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4031         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4032             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4033                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4034             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4035                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4036             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4037                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4038             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4039                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4040             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4041                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4042             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4043                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4044         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4045         16  FILLER                         PIC X(7).
  4046         16  CF-MORTG-DESTINATION-SYMBOL.
  4047             20  CF-MORTG-MIB-COMM          PIC X(5).
  4048             20  CF-MORTG-MIB-TERM          PIC X(5).
  4049         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4050             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4051         16  FILLER                         PIC X(03).
  4052         16  CF-MP-CHECK-NO-CONTROL.
  4053             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4054                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4055                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4056                                                ' ' LOW-VALUES.
  4057                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4058                                               VALUE '3'.
  4059         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4060         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4061         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4062             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4063                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4064             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4065                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4066             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4067                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4068             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4069                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4070             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4071                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL650.cbl
  4072             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4073                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4074         16  CF-MORTG-BILLING-AREA.
  4075             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4076                                            PIC X.
  4077         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4078         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4079         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4080         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4081             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4082             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4083         16  FILLER                         PIC X.
  4084         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4085             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4086             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4087         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4088         16  FILLER                         PIC X(8).
  4089         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4090         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4091         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4092         16  CF-ACH-COMPANY-ID.
  4093             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4094                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4095                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4096                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4097             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4098         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4099             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4100         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4101             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4102             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4103         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4104         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4105         16  FILLER                         PIC X(536).
  4106
  4107****************************************************************
  4108*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4109****************************************************************
  4110
  4111     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4112         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4113             20  CF-FEMALE-HEIGHT.
  4114                 24  CF-FEMALE-FT           PIC 99.
  4115                 24  CF-FEMALE-IN           PIC 99.
  4116             20  CF-FEMALE-MIN-WT           PIC 999.
  4117             20  CF-FEMALE-MAX-WT           PIC 999.
  4118         16  FILLER                         PIC X(428).
  4119
  4120     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4121         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4122             20  CF-MALE-HEIGHT.
  4123                 24  CF-MALE-FT             PIC 99.
  4124                 24  CF-MALE-IN             PIC 99.
  4125             20  CF-MALE-MIN-WT             PIC 999.
  4126             20  CF-MALE-MAX-WT             PIC 999.
  4127         16  FILLER                         PIC X(428).
  4128******************************************************************
  4129*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL650.cbl
  4130******************************************************************
  4131     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4132         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4133             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4134             20  CF-SYS-LETTER-ID           PIC X(04).
  4135             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4136             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4137             20  CF-SYS-RESET-SW            PIC X(01).
  4138             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4139             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4140
  4141         16  FILLER                         PIC X(50).
  4142
  4143         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4144             20  CF-USER-ACTIVE-SW          PIC X(01).
  4145             20  CF-USER-LETTER-ID          PIC X(04).
  4146             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4147             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4148             20  CF-USER-RESET-SW           PIC X(01).
  4149             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4150             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4151             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4152
  4153         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL650.cbl
  4155*    COPY ERCPNDB.
  4156******************************************************************
  4157*                                                                *
  4158*                                                                *
  4159*                            ERCPNDB.                            *
  4160*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4161*                            VMOD=2.025                          *
  4162*                                                                *
  4163*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4164*                                                                *
  4165******************************************************************
  4166*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4167*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4168******************************************************************
  4169*                                                                *
  4170*                                                                *
  4171*   FILE TYPE = VSAM,KSDS                                        *
  4172*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4173*                                                                *
  4174*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4175*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4176*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4177*                                                 RKP=13,LEN=36  *
  4178*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4179*                                      AND CHG-SEQ.)             *
  4180*                                                RKP=49,LEN=11   *
  4181*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4182*                                      AND CHG-SEQ.)             *
  4183*                                                RKP=60,LEN=15   *
  4184*                                                                *
  4185*   LOG = NO                                                     *
  4186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4187******************************************************************
  4188******************************************************************
  4189*                   C H A N G E   L O G
  4190*
  4191* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4192*-----------------------------------------------------------------
  4193*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4194* EFFECTIVE    NUMBER
  4195*-----------------------------------------------------------------
  4196* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4197* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4198* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4199* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4200* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4201* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4202* 032306                   PEMA  ADD BOW LOAN NUMBER
  4203* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4204* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4205* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4206* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4207* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4208* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4209* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4210* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4211******************************************************************
  4212
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL650.cbl
  4213 01  PENDING-BUSINESS.
  4214     12  PB-RECORD-ID                     PIC XX.
  4215         88  VALID-PB-ID                        VALUE 'PB'.
  4216
  4217     12  PB-CONTROL-PRIMARY.
  4218         16  PB-COMPANY-CD                PIC X.
  4219         16  PB-ENTRY-BATCH               PIC X(6).
  4220         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4221         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4222
  4223     12  PB-CONTROL-BY-ACCOUNT.
  4224         16  PB-COMPANY-CD-A1             PIC X.
  4225         16  PB-CARRIER                   PIC X.
  4226         16  PB-GROUPING.
  4227             20  PB-GROUPING-PREFIX       PIC XXX.
  4228             20  PB-GROUPING-PRIME        PIC XXX.
  4229         16  PB-STATE                     PIC XX.
  4230         16  PB-ACCOUNT.
  4231             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4232             20  PB-ACCOUNT-PRIME         PIC X(6).
  4233         16  PB-CERT-EFF-DT               PIC XX.
  4234         16  PB-CERT-NO.
  4235             20  PB-CERT-PRIME            PIC X(10).
  4236             20  PB-CERT-SFX              PIC X.
  4237         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4238
  4239         16  PB-RECORD-TYPE               PIC X.
  4240             88  PB-MAILING-DATA                VALUE '0'.
  4241             88  PB-ISSUE                       VALUE '1'.
  4242             88  PB-CANCELLATION                VALUE '2'.
  4243             88  PB-BATCH-TRAILER               VALUE '9'.
  4244
  4245     12  PB-CONTROL-BY-ORIG-BATCH.
  4246         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4247         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4248         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4249         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4250
  4251     12  PB-CONTROL-BY-CSR.
  4252         16  PB-CSR-COMPANY-CD            PIC X.
  4253         16  PB-CSR-ID                    PIC X(4).
  4254         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4255         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4256         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4257******************************************************************
  4258*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4259******************************************************************
  4260
  4261     12  PB-LAST-MAINT-DT                 PIC XX.
  4262     12  PB-LAST-MAINT-BY                 PIC X(4).
  4263     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4264
  4265     12  PB-RECORD-BODY                   PIC X(375).
  4266
  4267     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4268         16  PB-CERT-ORIGIN               PIC X.
  4269             88  CLASIC-CREATED-CERT         VALUE '1'.
  4270         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL650.cbl
  4271             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4272             20  PB-I-INSURED-FIRST-NAME.
  4273                 24  PB-I-INSURED-1ST-INIT PIC X.
  4274                 24  FILLER                PIC X(9).
  4275             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4276         16  PB-I-AGE                     PIC S99   COMP-3.
  4277         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4278         16  PB-I-BIRTHDAY                PIC XX.
  4279         16  PB-I-INSURED-SEX             PIC X.
  4280             88  PB-SEX-MALE     VALUE 'M'.
  4281             88  PB-SEX-FEMALE   VALUE 'F'.
  4282
  4283         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4284         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4285         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4286         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4287         16  PB-I-SKIP-CODE               PIC X.
  4288             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4289             88  PB-SKIP-JULY              VALUE '1'.
  4290             88  PB-SKIP-AUGUST            VALUE '2'.
  4291             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4292             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4293             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4294             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4295             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4296             88  PB-SKIP-JUNE              VALUE '8'.
  4297             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4298             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4299             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4300         16  PB-I-TERM-TYPE               PIC X.
  4301             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4302             88  PB-PAID-WEEKLY            VALUE 'W'.
  4303             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4304             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4305             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4306         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4307         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4308         16  PB-I-DATA-ENTRY-SW           PIC X.
  4309             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4310             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4311             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4312             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4313         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4314         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4315*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4316         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4317         16  FILLER                       PIC X.
  4318
  4319         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4320             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4321             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4322                                                   '90' THRU '99'.
  4323         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4324                                          PIC XX.
  4325         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4326         16  PB-I-AMOUNT-FINANCED REDEFINES
  4327                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4328         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL650.cbl
  4329         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4330                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4331         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4332         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4333         16  PB-I-CLP-AMOUNT REDEFINES
  4334                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4335         16  PB-I-LF-CALC-FLAG            PIC X.
  4336             88 PB-COMP-LF-PREM               VALUE '?'.
  4337         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4338         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4339         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4340         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4341         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4342         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4343         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4344         16  PB-I-LF-ABBR                 PIC XXX.
  4345         16  PB-I-LF-INPUT-CD             PIC XX.
  4346
  4347         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4348             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4349             88  PB-INVALID-AH               VALUE '  ' '00'
  4350                                                   '90' THRU '99'.
  4351         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4352         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4353         16  PB-I-AH-CALC-FLAG            PIC X.
  4354             88 PB-COMP-AH-PREM                  VALUE '?'.
  4355         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4356         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4357         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4358         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4359         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4360         16  PB-I-AH-ABBR                 PIC XXX.
  4361         16  PB-I-AH-INPUT-CD             PIC XXX.
  4362
  4363         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4364         16  PB-I-REIN-TABLE              PIC XXX.
  4365         16  PB-I-BUSINESS-TYPE           PIC 99.
  4366         16  PB-I-INDV-GRP-CD             PIC X.
  4367         16  PB-I-MORT-CODE.
  4368             20  PB-I-TABLE               PIC X.
  4369             20  PB-I-INTEREST            PIC XX.
  4370             20  PB-I-MORT-TYP            PIC X.
  4371         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4372         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4373         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4374         16  PB-I-INDV-GRP-OVRD           PIC X.
  4375         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4376         16  PB-I-SIG-SW                  PIC X.
  4377             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4378         16  PB-I-RATE-CLASS              PIC XX.
  4379         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4380         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4381         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4382         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4383         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4384         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4385         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4386         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL650.cbl
  4387         16  PB-I-OB-FLAG                 PIC X.
  4388             88  PB-I-OB                      VALUE 'B'.
  4389             88  PB-I-SUMMARY                 VALUE 'Z'.
  4390         16  PB-I-ENTRY-STATUS            PIC X.
  4391             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4392                                              'M' '5' '9' '2'.
  4393             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4394             88  PB-I-POLICY-PENDING          VALUE '2'.
  4395             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4396             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4397             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4398             88  PB-I-REIN-ONLY               VALUE '9'.
  4399             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4400             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4401             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4402             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4403         16  PB-I-INT-CODE                PIC X.
  4404             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4405             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4406         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4407         16  PB-I-SOC-SEC-NO              PIC X(11).
  4408         16  PB-I-MEMBER-NO               PIC X(12).
  4409         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4410*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4411         16  PB-I-OLD-LOF                 PIC XXX.
  4412         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4413         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4414         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4415         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4416         16  PB-I-LIFE-INDICATOR          PIC X.
  4417             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4418         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4419         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4420                                          PIC S9(5)V99    COMP-3.
  4421         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4422             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4423             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4424         16  PB-I-1ST-PMT-DT              PIC XX.
  4425         16  PB-I-JOINT-INSURED.
  4426             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4427             20 PB-I-JOINT-FIRST-NAME.
  4428                24  PB-I-JOINT-FIRST-INIT PIC X.
  4429                24  FILLER                PIC X(9).
  4430             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4431*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4432         16  PB-I-BENEFICIARY-NAME.
  4433             20  PB-I-BANK-NUMBER         PIC X(10).
  4434             20  FILLER                   PIC X(15).
  4435         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4436         16  PB-I-REFERENCE               PIC X(12).
  4437         16  FILLER REDEFINES PB-I-REFERENCE.
  4438             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4439             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4440             20  PB-I-CLP-STATE           PIC XX.
  4441         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4442             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4443             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4444             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL650.cbl
  4445         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4446         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4447         16  PB-I-RESIDENT-STATE          PIC XX.
  4448         16  PB-I-RATE-CODE               PIC X(4).
  4449         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4450         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4451         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4452         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4453         16  PB-I-BANK-NOCHRGB            PIC 99.
  4454         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4455         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4456
  4457     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4458         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4459             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4460         16  PB-C-CANCEL-ORIGIN           PIC X.
  4461             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4462         16  PB-C-LF-CANCEL-DT            PIC XX.
  4463         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4464         16  PB-C-LF-CALC-REQ             PIC X.
  4465             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4466         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4467         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4468         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4469             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4470         16  PB-C-AH-CANCEL-DT            PIC XX.
  4471         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4472         16  PB-C-AH-CALC-REQ             PIC X.
  4473             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4474         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4475         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4476         16  PB-C-LAST-NAME               PIC X(15).
  4477         16  PB-C-REFUND-SW               PIC X.
  4478             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4479             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4480         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4481         16  PB-C-PAYEE-CODE              PIC X(6).
  4482         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4483         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4484         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4485         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4486         16  PB-C-REFERENCE               PIC X(12).
  4487         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4488         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4489         16  PB-C-POST-CARD-IND           PIC X.
  4490         16  PB-C-CANCEL-REASON           PIC X.
  4491         16  PB-C-REF-INTERFACE-SW        PIC X.
  4492         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4493         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4494         16  FILLER                       PIC X(01).
  4495*        16  FILLER                       PIC X(18).
  4496         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4497*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4498         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4499         16  PB-CANCELED-CERT-DATA.
  4500             20  PB-CI-INSURED-NAME.
  4501                 24  PB-CI-LAST-NAME      PIC X(15).
  4502                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL650.cbl
  4503             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4504             20  PB-CI-INSURED-SEX        PIC X.
  4505             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4506             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4507             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4508             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4509             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4510             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4511             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4512             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4513             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4514             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4515             20  PB-CI-RATE-CLASS         PIC XX.
  4516             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4517             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4518             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4519             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4520             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4521             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4522             20  PB-CI-LF-ABBR            PIC X(3).
  4523             20  PB-CI-AH-ABBR            PIC X(3).
  4524             20  PB-CI-OB-FLAG            PIC X.
  4525                 88  PB-CI-OB                VALUE 'B'.
  4526             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4527                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4528                                           'M' '4' '5' '9' '2'.
  4529                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4530                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4531                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4532                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4533                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4534                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4535                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4536                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4537                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4538                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4539                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4540                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4541             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4542                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4543                                           'M' '4' '5' '9' '2'.
  4544                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4545                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4546                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4547                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4548                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4549                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4550                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4551                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4552                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4553                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4554                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4555                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4556             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4557             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4558             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4559             20  PB-CI-MEMBER-NO          PIC X(12).
  4560             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL650.cbl
  4561                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4562                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4563             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4564             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4565             20  PB-CI-COMP-EXCP-SW       PIC X.
  4566                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4567                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4568             20  PB-CI-ENTRY-STATUS       PIC X.
  4569             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4570             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4571             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4572             20  PB-CI-DEATH-DT           PIC XX.
  4573             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4574             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4575             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4576             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4577             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4578             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4579             20  PB-CI-ENTRY-DT              PIC XX.
  4580             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4581             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4582             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4583             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4584             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4585             20  PB-CI-OLD-LOF               PIC XXX.
  4586*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4587             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4588             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4589             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4590             20  PB-CI-INDV-GRP-CD           PIC X.
  4591             20  PB-CI-BENEFICIARY-NAME.
  4592                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4593                 24  FILLER                  PIC X(15).
  4594             20  PB-CI-NOTE-SW               PIC X.
  4595             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4596             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4597             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4598             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4599             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4600             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4601             20  PB-CI-FIRST-NAME            PIC X(10).
  4602             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4603
  4604         16  FILLER                       PIC X(13).
  4605*032306  16  FILLER                       PIC X(27).
  4606*        16  FILLER                       PIC X(46).
  4607
  4608     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4609         16  FILLER                       PIC X(10).
  4610         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4611         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4612         16  PB-M-INSURED-MID-INIT        PIC X.
  4613         16  PB-M-INSURED-AGE             PIC 99.
  4614         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4615         16  PB-M-INSURED-SEX             PIC X.
  4616         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4617         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4618         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL650.cbl
  4619         16  PB-M-INSURED-CITY-STATE.
  4620             20  PB-M-INSURED-CITY        PIC X(28).
  4621             20  PB-M-INSURED-STATE       PIC XX.
  4622         16  PB-M-INSURED-ZIP-CODE.
  4623             20  PB-M-INSURED-ZIP-PRIME.
  4624                 24  PB-M-INSURED-ZIP-1   PIC X.
  4625                     88  PB-M-CANADIAN-POST-CODE
  4626                                             VALUE 'A' THRU 'Z'.
  4627                 24  FILLER               PIC X(4).
  4628             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4629         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4630                                        PB-M-INSURED-ZIP-CODE.
  4631             20  PM-M-INS-CAN-POST1       PIC XXX.
  4632             20  PM-M-INS-CAN-POST2       PIC XXX.
  4633             20  FILLER                   PIC XXX.
  4634         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4635         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4636         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4637         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4638         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4639         16  PB-M-CRED-BENE-CITYST.
  4640             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4641             20  PB-M-CRED-BENE-STATE     PIC XX.
  4642         16  FILLER                       PIC X(92).
  4643
  4644     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4645         16  FILLER                       PIC X(10).
  4646         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4647         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4648         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4649         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4650         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4651         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4652         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4653         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4654         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4655         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4656         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4657         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4658         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4659         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4660         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4661         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4662         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4663         16  PB-ACCOUNT-NAME              PIC X(30).
  4664         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4665         16  PB-REFERENCE                 PIC X(12).
  4666         16  PB-B-RECEIVED-DT             PIC XX.
  4667         16  FILLER                       PIC X(234).
  4668
  4669     12  PB-RECORD-STATUS.
  4670         16  PB-CREDIT-SELECT-DT          PIC XX.
  4671         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4672         16  PB-BILLED-DT                 PIC XX.
  4673         16  PB-BILLING-STATUS            PIC X.
  4674             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4675             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4676             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL650.cbl
  4677         16  PB-RECORD-BILL               PIC X.
  4678             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4679             88  PB-RECORD-RETURNED           VALUE 'R'.
  4680             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4681             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4682             88  PB-OVERRIDE-AH               VALUE 'A'.
  4683             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4684         16  PB-BATCH-ENTRY               PIC X.
  4685             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4686             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4687             88  PB-REISSUED-CERT             VALUE 'E'.
  4688             88  PB-MONTHLY-CERT              VALUE 'M'.
  4689             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4690             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4691             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4692         16  PB-FORCE-CODE                PIC X.
  4693             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4694             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4695             88  PB-CANCEL-FORCE              VALUE '8'.
  4696             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4697             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4698             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4699             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4700             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4701             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4702             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4703         16  PB-FATAL-FLAG                PIC X.
  4704             88  PB-FATAL-ERRORS              VALUE 'X'.
  4705         16  PB-FORCE-ER-CD               PIC X.
  4706             88  PB-FORCE-ERRORS              VALUE 'F'.
  4707             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4708         16  PB-WARN-ER-CD                PIC X.
  4709             88  PB-WARNING-ERRORS            VALUE 'W'.
  4710         16  FILLER                       PIC X.
  4711         16  PB-OUT-BAL-CD                PIC X.
  4712             88  PB-OUT-OF-BAL                VALUE 'O'.
  4713         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4714         16  PB-AH-OVERRIDE-L1            PIC X.
  4715         16  PB-INPUT-DT                  PIC XX.
  4716         16  PB-INPUT-BY                  PIC X(4).
  4717         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4718         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4719         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4720         16  PB-LF-EARNING-METHOD         PIC X.
  4721         16  PB-AH-EARNING-METHOD         PIC X.
  4722         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4723         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4724         16  PB-REIN-CD                   PIC XXX.
  4725         16  PB-LF-REFUND-TYPE            PIC X.
  4726         16  PB-AH-REFUND-TYPE            PIC X.
  4727         16  PB-ACCT-EFF-DT               PIC XX.
  4728         16  PB-ACCT-EXP-DT               PIC XX.
  4729         16  PB-COMPANY-ID                PIC X(3).
  4730         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4731         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4732         16  PB-SV-CARRIER                PIC X.
  4733         16  PB-SV-GROUPING               PIC X(6).
  4734         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL650.cbl
  4735         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4736         16  PB-GA-BILLING-INFO.
  4737             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4738                                          PIC XX.
  4739         16  PB-SV-REMIT-TO  REDEFINES
  4740             PB-GA-BILLING-INFO           PIC X(10).
  4741         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4742         16  PB-I-LOAN-OFFICER            PIC X(5).
  4743         16  PB-I-VIN                     PIC X(17).
  4744
  4745         16  FILLER                       PIC X(04).
  4746         16  IMNET-BYPASS-SW              PIC X.
  4747
  4748******************************************************************
  4749*                COMMON EDIT ERRORS                              *
  4750******************************************************************
  4751
  4752     12  PB-COMMON-ERRORS.
  4753         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4754                                           PIC S9(4)     COMP.
  4755
  4756******************************************************************
  4757*EJECT
  4758*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL650.cbl
  4760 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  4761                          COMPENSATION-MASTER
  4762                          NAME-LOOKUP-MASTER PLAN-MASTER
  4763                          CONTROL-FILE PENDING-BUSINESS.
  4764 0000-DFHEXIT SECTION.
  4765     MOVE '9#                    $   ' TO DFHEIV0.
  4766     MOVE 'EL650' TO DFHEIV1.
  4767     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4768
  4769     MOVE LOW-VALUES             TO  WS-VERIFY-AREA.
  4770     INITIALIZE  TEMP-STORAGE-RECORD.
  4771
  4772     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4773     MOVE '5'                    TO  DC-OPTION-CODE.
  4774
  4775     PERFORM 9700-DATE-CONVERSION.
  4776
  4777     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4778     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4779     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4780     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4781*    display ' beginning of program el650   '
  4782
  4783     IF EIBCALEN  =  0
  4784         GO TO 8800-UNAUTHORIZED-ACCESS.
  4785
  4786     MOVE SCREEN-NUMBER          TO  TS-SCREEN.
  4787     MOVE EIBTRMID               TO  TS-TERM.
  4788     MOVE LOW-VALUES             TO  EL650AI.
  4789
  4790     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4791         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4792
  4793     IF PI-CALLING-PROGRAM  NOT = THIS-PGM
  4794         IF PI-RETURN-TO-PROGRAM  NOT = THIS-PGM
  4795             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4796             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4797             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4798             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4799             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4800             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4801             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4802             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4803             MOVE LOW-VALUES            TO  PI-PROGRAM-WORK-AREA
  4804             MOVE ZEROS                 TO  PI-TOTAL-LINES
  4805                                            PI-LINE-SELECTED
  4806             MOVE SPACE                 TO  PI-RECORD-ADDED-SW
  4807             MOVE 1                     TO  PI-PAGE-NUMBER
  4808         ELSE
  4809             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4810             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4811             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4812             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4813             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4814             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4815             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4816             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4817
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL650.cbl
  4818**************************************************************
  4819*               CLIENT "DMD" CUSTOM CODE
  4820* CHECK IF CONTROL PASSED FROM EL608 PROGRAM
  4821* START BROWSE BEGINNING WITH KEY PASSED BY EL608
  4822*              CSO CR# 6475
  4823     IF EIBTRNID  =  EL608-TRANS-ID
  4824         MOVE 1                     TO RETURN-FROM-SW
  4825         MOVE 'Y'                   TO FROM-EL608-SW
  4826         MOVE TRANS-ID              TO EIBTRNID
  4827         MOVE XCTL-EL601            TO PI-RETURN-TO-PROGRAM
  4828         MOVE PI-PREV-VG-ACCOUNT    TO PI-ACCT-CCGSA-KEY
  4829                                       KEY-SAVE
  4830         MOVE LOW-VALUES            TO PI-ACCT-EXP-DT
  4831                                       PI-ACCT-REST-OF-EXP
  4832                                       PI-DATE-RANGE-TABLE
  4833
  4834* EXEC CICS  HANDLE CONDITION
  4835*            NOTFND   (5340-END)
  4836*            ENDFILE  (5330-NOT-FOUND)
  4837*        END-EXEC
  4838*    MOVE '"$I''                  ! " #00004829' TO DFHEIV0
  4839     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4840     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4841     MOVE X'2220233030303034383239' TO DFHEIV0(25:11)
  4842     CALL 'kxdfhei1' USING DFHEIV0
  4843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4844         MOVE 'Y'                   TO FIRST-TIME-SW
  4845         MOVE ZEROS                 TO PI-TOTAL-LINES
  4846         SET T-INDEX
  4847             TS-INDEX  TO  +1
  4848         MOVE ACCT-FILE-ID          TO PI-ACCT-ID
  4849         MOVE 1                     TO PI-PAGE-NUMBER
  4850         MOVE 'S'                   TO PI-MAINT
  4851         MOVE DFHPF1                TO EIBAID
  4852         GO TO 1002-SHOW-NEW-RECORDS.
  4853*    END OF CLIENT "DMD" CUSTOM CODE
  4854**************************************************************
  4855
  4856     IF RETURNED-FROM = XCTL-6501 OR XCTL-6502 OR XCTL-6503 OR
  4857                        XCTL-6504 OR XCTL-6505 OR XCTL-6506 OR
  4858                        XCTL-6508
  4859         MOVE 1                     TO  RETURN-FROM-SW
  4860         MOVE PI-PREV-VG-ACCOUNT    TO  PI-ACCT-CCGSA-KEY
  4861         MOVE PI-ACCT-CCGSA-KEY     TO  KEY-SAVE
  4862         MOVE LOW-VALUES            TO  PI-ACCT-EXP-DT
  4863         GO TO 1002-SHOW-NEW-RECORDS.
  4864
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL650.cbl
  4866     IF EIBTRNID  NOT =  TRANS-ID
  4867         IF EIBTRNID  NOT = EL640-TRANS-ID  AND
  4868            EIBTRNID  NOT = EL658-TRANS-ID  AND
  4869            EIBTRNID  NOT = EL6311-TRANS-ID AND
  4870            EIBTRNID  NOT = EL1273-TRANS-ID AND
  4871            EIBTRNID  NOT = EL652-TRANS-ID  AND
  4872            EIBTRNID  NOT = EL6523-TRANS-ID AND
  4873            EIBTRNID  NOT = EL6311NC-TRANS-ID AND
  4874            EIBTRNID  NOT = EL130-TRANS-ID  AND
  4875            EIBTRNID  NOT = EL6592-TRANS-ID AND
  4876            EIBTRNID  NOT = EL6509-TRANS-ID
  4877            AND EIBTRNID NOT = EL6503-TRANS-ID
  4878             GO TO 8100-SEND-INITIAL-MAP
  4879         ELSE
  4880             IF PI-CR-CONTROL-IN-PROGRESS  = SPACES
  4881                 GO TO 8100-SEND-INITIAL-MAP
  4882             ELSE
  4883                 MOVE 'S'             TO  MAINTI
  4884                 MOVE PI-CR-CARRIER   TO  ACARIERI
  4885                 MOVE PI-CR-GROUPING  TO  AGROUPI
  4886                 MOVE PI-CR-STATE     TO  ASTATEI
  4887                 MOVE PI-CR-ACCOUNT   TO  AACCTI
  4888                 MOVE +1              TO  ACARIERL
  4889                                          MAINTL
  4890                 MOVE +6              TO  AGROUPL
  4891                 MOVE +2              TO  ASTATEL
  4892                 MOVE +10             TO  AACCTL
  4893                 GO TO 0330-EDIT-DATA.
  4894
  4895
  4896* EXEC CICS  HANDLE CONDITION
  4897*        PGMIDERR  (9600-PGMID-ERROR)
  4898*        ERROR     (9990-ABEND)
  4899*    END-EXEC.
  4900*    MOVE '"$L.                  ! # #00004884' TO DFHEIV0
  4901     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4903     MOVE X'2320233030303034383834' TO DFHEIV0(25:11)
  4904     CALL 'kxdfhei1' USING DFHEIV0
  4905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4906
  4907
  4908     IF EIBAID  = DFHCLEAR
  4909         GO TO 9400-CLEAR.
  4910
  4911     IF PI-PROCESSOR-ID  =  'LGXX'
  4912         GO TO 0200-RECEIVE.
  4913
  4914
  4915* EXEC CICS  READQ TS
  4916*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4917*        INTO    (SECURITY-CONTROL)
  4918*        LENGTH  (SC-COMM-LENGTH)
  4919*        ITEM    (SC-ITEM)
  4920*    END-EXEC.
  4921*    MOVE '*$II   L              ''   #00004895' TO DFHEIV0
  4922     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4923     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL650.cbl
  4924     MOVE X'2020233030303034383935' TO DFHEIV0(25:11)
  4925     CALL 'kxdfhei1' USING DFHEIV0,
  4926           PI-SECURITY-TEMP-STORE-ID,
  4927           SECURITY-CONTROL,
  4928           SC-COMM-LENGTH,
  4929           SC-ITEM,
  4930           DFHEIV99,
  4931           DFHEIV99
  4932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4933
  4934
  4935     MOVE SC-CREDIT-DISPLAY (04)  TO  PI-DISPLAY-CAP.
  4936     MOVE SC-CREDIT-UPDATE  (04)  TO  PI-MODIFY-CAP.
  4937
  4938     IF NOT DISPLAY-CAP
  4939         MOVE 'READ'             TO  SM-READ
  4940         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  4941         MOVE ER-0070            TO  EMI-ERROR
  4942         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4943         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL650.cbl
  4945 0200-RECEIVE.
  4946     IF EIBAID  = DFHPA1  OR  DFHPA2  OR  DFHPA3
  4947         MOVE ER-0008            TO  EMI-ERROR
  4948         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4949         MOVE -1                 TO  MAINTL
  4950         GO TO 8200-SEND-DATAONLY.
  4951
  4952
  4953* EXEC CICS  RECEIVE
  4954*        MAP     (MAP-NAME)
  4955*        MAPSET  (MAPSET-NAME)
  4956*        INTO    (EL650AI)
  4957*    END-EXEC.
  4958     MOVE LENGTH OF
  4959      EL650AI
  4960       TO DFHEIV11
  4961*    MOVE '8"T I  L              ''   #00004919' TO DFHEIV0
  4962     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4963     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4964     MOVE X'2020233030303034393139' TO DFHEIV0(25:11)
  4965     CALL 'kxdfhei1' USING DFHEIV0,
  4966           MAP-NAME,
  4967           EL650AI,
  4968           DFHEIV11,
  4969           MAPSET-NAME,
  4970           DFHEIV99,
  4971           DFHEIV99
  4972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4973
  4974
  4975     IF PFENTERL  = ZERO
  4976         GO TO 0300-CHECK-PFKEYS.
  4977
  4978     IF EIBAID  NOT = DFHENTER
  4979         MOVE ER-0004            TO  EMI-ERROR
  4980         GO TO 0320-INPUT-ERROR.
  4981
  4982     IF (PFENTERI NUMERIC)
  4983       AND  (PFENTERI GREATER ZERO AND LESS 25)
  4984         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  4985     ELSE
  4986         MOVE ER-0029               TO  EMI-ERROR
  4987         GO TO 0320-INPUT-ERROR.
  4988
  4989 0300-CHECK-PFKEYS.
  4990     IF EIBAID  = DFHPF23
  4991         GO TO 8810-PF23.
  4992
  4993     IF EIBAID  = DFHPF24
  4994         GO TO 9200-RETURN-MAIN-MENU.
  4995
  4996     IF EIBAID  = DFHPF12
  4997         GO TO 9500-PF12.
  4998
  4999     IF MAINTL  NOT = ZERO   AND
  5000        MAINTI  NOT = SPACE  AND
  5001        EIBAID  NOT = DFHENTER
  5002          MOVE ER-0050            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL650.cbl
  5003          GO TO 0320-INPUT-ERROR.
  5004
  5005     if (maintl not = zeros)
  5006        and (mainti not = 'D')
  5007        move spaces              to pi-el650-del-sw
  5008     end-if
  5009     IF EIBAID  = DFHPF1
  5010         GO TO 5300-FIND-NEXT-ACCOUNT.
  5011
  5012     IF EIBAID  = DFHPF2
  5013         GO TO 5400-FIND-PREV-ACCOUNT.
  5014
  5015     IF EIBAID  = DFHPF3
  5016         GO TO 5100-FIND-NEXT-RANGE.
  5017
  5018     IF EIBAID  = DFHPF4
  5019         GO TO 5200-FIND-PREV-RANGE.
  5020
  5021     IF EIBAID  = DFHPF5
  5022         GO TO 8900-PF5.
  5023
  5024     IF EIBAID  = DFHPF6
  5025        GO TO 8910-PF6
  5026     END-IF
  5027     IF EIBAID  = DFHENTER
  5028         GO TO 0330-EDIT-DATA.
  5029
  5030     MOVE ER-0029                TO  EMI-ERROR.
  5031
  5032 0320-INPUT-ERROR.
  5033     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5034
  5035     MOVE AL-UNBON               TO  PFENTERA.
  5036
  5037     IF PFENTERL  = ZERO
  5038         MOVE -1                 TO  MAINTL
  5039     ELSE
  5040         MOVE -1                 TO  PFENTERL.
  5041
  5042     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL650.cbl
  5044 0330-EDIT-DATA.
  5045     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5046     MOVE '5'                    TO  DC-OPTION-CODE.
  5047
  5048     PERFORM 9700-DATE-CONVERSION.
  5049
  5050     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  5051     MOVE DC-GREG-DATE-1-YMD     TO  CURRENT-SAVE.
  5052
  5053     IF ACARIERL GREATER ZEROS
  5054         IF PI-CARRIER-SECURITY GREATER SPACES
  5055             IF ACARIERI = PI-CARRIER-SECURITY
  5056                 NEXT SENTENCE
  5057             ELSE
  5058                 MOVE -1         TO  ACARIERL
  5059                 MOVE ER-2370    TO  EMI-ERROR
  5060                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5061                 MOVE AL-UABON   TO  ACARIERA
  5062                 GO TO 8200-SEND-DATAONLY.
  5063
  5064     IF MAINTI  = 'S'
  5065       IF LINEL = ZEROS
  5066           MOVE 1 TO PI-PAGE-NUMBER
  5067           GO TO 1000-SHOW-ACCOUNT
  5068       ELSE
  5069           GO TO 1000-SHOW-ACCOUNT.
  5070
  5071     PERFORM 6800-COMPANY-REC-READ  THRU  6899-EXIT.
  5072
  5073     IF EMI-ERROR  NOT = ZEROS
  5074         MOVE -1                 TO  MAINTL
  5075         GO TO 8200-SEND-DATAONLY.
  5076
  5077     IF NOT  MODIFY-CAP
  5078         MOVE 'UPDATE'           TO  SM-READ
  5079         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5080         MOVE ER-0070            TO  EMI-ERROR
  5081         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5082         MOVE AL-UANON           TO  ACARIERA  AGROUPA
  5083                                     ASTATEA   AACCTA
  5084         GO TO 8100-SEND-INITIAL-MAP.
  5085
  5086     IF MAINTI  = 'A'
  5087         GO TO 1500-ADD-ACCOUNT.
  5088
  5089     IF MAINTI  = 'C'
  5090         IF PI-SV-MAINT IS EQUAL TO 'L'
  5091            MOVE -1              TO  MAINTL
  5092            MOVE AL-UABON        TO  MAINTA
  5093            MOVE ER-0899         TO  EMI-ERROR
  5094            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5095            GO TO 8200-SEND-DATAONLY
  5096         ELSE
  5097            GO TO 2000-CHANGE-ACCOUNT.
  5098
  5099     IF MAINTI  = 'D'
  5100         GO TO 2500-DELETE-ACCOUNT.
  5101
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL650.cbl
  5102     IF MAINTI  = 'X'
  5103         GO TO 3000-CHANGE-EXPIRATION.
  5104
  5105     IF MAINTI  = 'E'
  5106         GO TO 3500-CHANGE-EFFECTIVE.
  5107
  5108     IF MAINTI  = 'L'
  5109         MOVE 'L'             TO  PI-SV-MAINT
  5110         GO TO 4000-CHANGE-ALL.
  5111
  5112     IF MAINTI  = 'K'
  5113       IF LINEL GREATER ZERO
  5114           GO TO 4900-CREATE-NEW-ACCOUNT
  5115        ELSE
  5116           GO TO 4500-CREATE-NEW-ACCOUNT.
  5117
  5118     IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5119         IF MAINTI  = 'T'
  5120             GO TO 4500-CREATE-NEW-ACCOUNT.
  5121
  5122     IF MAINTI  = 'N'
  5123         GO TO 5000-CREATE-NEW-RANGE.
  5124
  5125     MOVE ER-0023                TO  EMI-ERROR.
  5126
  5127     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5128
  5129     MOVE -1                     TO  MAINTL.
  5130     MOVE AL-UABON               TO  MAINTA.
  5131
  5132     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL650.cbl
  5134 1000-SHOW-ACCOUNT.
  5135     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5136
  5137     IF LINEL GREATER ZEROS   AND
  5138        PI-TOTAL-LINES  NOT =  ZEROS
  5139         NEXT SENTENCE
  5140     ELSE
  5141         GO TO 1002-SHOW-NEW-RECORDS.
  5142
  5143     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5144
  5145     IF EMI-ERROR  NOT = ZEROS
  5146         GO TO 8200-SEND-DATAONLY.
  5147
  5148     SET T-INDEX                 TO  LINEI.
  5149
  5150     IF PI-2ND-PAGE
  5151         SET T-INDEX  UP  BY  8
  5152     ELSE
  5153     IF PI-3RD-PAGE
  5154         SET T-INDEX  UP  BY  16
  5155     ELSE
  5156     IF PI-LST-PAGE
  5157         SET T-INDEX  UP  BY  24.
  5158
  5159     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5160     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5161
  5162     IF PI-PREV-ACCOUNT  =  PI-ACCT-CCGSA-KEY
  5163         MOVE MAINTI             TO  PI-MAINT
  5164         MOVE XCTL-6501          TO  PGM-NAME
  5165         GO TO 9300-XCTL
  5166     ELSE
  5167         IF PI-PREV-VG-ACCOUNT = PI-ACCT-CCGSA-KEY
  5168             MOVE MAINTI         TO  PI-MAINT
  5169             MOVE XCTL-6501      TO  PGM-NAME
  5170             PERFORM 7400-READ-TEMP-STORAGE  THRU  7400-EXIT
  5171             SET TS-INDEX        TO  T-INDEX
  5172             MOVE TS-ACCT-KEY (TS-INDEX)
  5173                                 TO  PI-ACCT-CCGSA-KEY
  5174             GO TO 9300-XCTL.
  5175
  5176 1002-SHOW-NEW-RECORDS.
  5177
  5178* EXEC CICS  HANDLE CONDITION
  5179*         NOTFND   (1010-NOT-FOUND)
  5180*         ENDFILE  (1010-NOT-FOUND)
  5181*    END-EXEC.
  5182*    MOVE '"$I''                  ! $ #00005127' TO DFHEIV0
  5183     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5184     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5185     MOVE X'2420233030303035313237' TO DFHEIV0(25:11)
  5186     CALL 'kxdfhei1' USING DFHEIV0
  5187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5188
  5189
  5190     SET T-INDEX
  5191        TS-INDEX  TO  +1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL650.cbl
  5192
  5193     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  5194
  5195     MOVE LOW-VALUES             TO  TEMP-STORAGE-RECORD.
  5196
  5197     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  5198
  5199     PERFORM 7100-START-BROWSE  THRU  7100-EXIT.
  5200
  5201     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  5202
  5203 1005-READ-ACCT.
  5204     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  5205
  5206     IF K-WITH-LINE-NO
  5207       IF SV-CARRIER   NOT = AM-CARRIER  OR
  5208          SV-GROUPING  NOT = AM-GROUPING OR
  5209          SV-STATE     NOT = AM-STATE    OR
  5210          SV-ACCOUNT   NOT = AM-ACCOUNT
  5211            GO TO 1010-NOT-FOUND.
  5212
  5213     IF SV-CO  NOT = AM-COMPANY-CD
  5214         GO TO 1010-NOT-FOUND.
  5215
  5216     IF SV-ACCOUNT  NOT =  AM-ACCOUNT
  5217         GO TO 1010-NOT-FOUND.
  5218
  5219     IF SV-STATE  NOT = AM-STATE
  5220       AND  (ST-ACCNT-CNTL
  5221       OR  CARR-ST-ACCNT-CNTL
  5222       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5223         GO TO 1010-NOT-FOUND.
  5224
  5225     IF SV-CARRIER  NOT =  AM-CARRIER
  5226       AND  (CARR-ACCNT-CNTL
  5227       OR  CARR-ST-ACCNT-CNTL
  5228       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5229         GO TO 1010-NOT-FOUND.
  5230
  5231     IF SV-GROUPING  NOT = AM-GROUPING
  5232       AND  CARR-GROUP-ST-ACCNT-CNTL
  5233         GO TO 1010-NOT-FOUND.
  5234
  5235     IF AM-TRNTO-DTE  =  SPACES
  5236         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  5237
  5238     IF AM-TRNFROM-DTE  = SPACES
  5239         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  5240
  5241     IF T-INDEX  = 1
  5242         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5243             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  5244             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  5245             MOVE SPACE              TO  DC-OPTION-CODE
  5246             PERFORM 9700-DATE-CONVERSION
  5247             IF DATE-CONVERSION-ERROR
  5248                 MOVE SPACES         TO  TRNTODTO
  5249             ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL650.cbl
  5250                 MOVE DC-GREG-DATE-1-EDIT
  5251                                     TO  TRNTODTO.
  5252
  5253     IF T-INDEX  =  1
  5254         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5255             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  5256             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  5257             MOVE SPACE                TO  DC-OPTION-CODE
  5258             PERFORM 9700-DATE-CONVERSION
  5259             IF DATE-CONVERSION-ERROR
  5260                 MOVE SPACES           TO  TRNFRDTO
  5261             ELSE
  5262                 MOVE DC-GREG-DATE-1-EDIT
  5263                                       TO  TRNFRDTO.
  5264
  5265     IF T-INDEX  = 1
  5266         MOVE AM-CONTROL-PRIMARY  TO  PI-PREV-ACCOUNT
  5267         MOVE PI-ACCT-CCGSA-KEY   TO  PI-PREV-VG-ACCOUNT
  5268         MOVE AM-NAME             TO  NAMEO
  5269                                      PI-ACCNAME
  5270         MOVE SPACE               TO  NAMEFLGO
  5271                                      PI-NAMEFLG.
  5272
  5273     IF AM-NAME  NOT = NAMEO
  5274         MOVE '*'                TO  NAMEFLGO
  5275                                     PI-NAMEFLG.
  5276
  5277     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  5278
  5279     GO TO 1005-READ-ACCT.
  5280
  5281 1010-NOT-FOUND.
  5282     IF BROWSE-STARTED
  5283
  5284* EXEC CICS  ENDBR
  5285*            DATASET  (PI-ACCT-ID)
  5286*        END-EXEC.
  5287     MOVE 0
  5288       TO DFHEIV11
  5289*    MOVE '&2                    $   #00005225' TO DFHEIV0
  5290     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5291     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5292     MOVE X'2020233030303035323235' TO DFHEIV0(25:11)
  5293     CALL 'kxdfhei1' USING DFHEIV0,
  5294           PI-ACCT-ID,
  5295           DFHEIV11,
  5296           DFHEIV99
  5297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5298
  5299
  5300     IF T-INDEX  NOT = 1
  5301         PERFORM 7200-WRITE-TEMP-STORAGE  THRU  7200-EXIT
  5302         GO TO 7000-BUILD-OUTPUT-MAP.
  5303
  5304     MOVE ER-0226                TO  EMI-ERROR.
  5305
  5306     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5307
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL650.cbl
  5308     MOVE -1                     TO  ACARIERL.
  5309     MOVE AL-UABON               TO  ACARIERA
  5310                                     AGROUPA
  5311                                     ASTATEA
  5312                                     AACCTA.
  5313
  5314     IF FROM-EL608-SW = 'Y'
  5315         MOVE SV-CARRIER     TO  ACARIERO
  5316         MOVE SV-GROUPING    TO  AGROUPO
  5317         MOVE SV-STATE       TO  ASTATEO
  5318         MOVE SV-ACCOUNT     TO  AACCTO
  5319         MOVE 'N'            TO  FROM-EL608-SW.
  5320
  5321     IF PI-MAINT = 'A'
  5322         IF PI-RECORD-NOT-CREATED
  5323             MOVE SV-CARRIER     TO  ACARIERO
  5324             MOVE SV-GROUPING    TO  AGROUPO
  5325             MOVE SV-STATE       TO  ASTATEO
  5326             MOVE SV-ACCOUNT     TO  AACCTO
  5327             MOVE ER-2151        TO  EMI-ERROR
  5328             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5329             MOVE 'S'            TO  PI-MAINT.
  5330
  5331     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL650.cbl
  5333 1020-MOVE-TO-TABLE.
  5334     MOVE AM-EXPIRATION-DT       TO  PI-BIN-EXP-DT   (T-INDEX).
  5335     MOVE AM-EFFECTIVE-DT        TO  PI-BIN-EFF-DT   (T-INDEX).
  5336     MOVE AM-LAST-MAINT-DT       TO  PI-BIN-MAINT-DT (T-INDEX).
  5337     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5338     MOVE '3'                    TO  DC-OPTION-CODE.
  5339
  5340     PERFORM 9700-DATE-CONVERSION.
  5341
  5342     IF DATE-CONVERSION-ERROR
  5343         MOVE LOW-VALUES         TO  PI-BIN-HI-CERT (T-INDEX)
  5344     ELSE
  5345         MOVE DC-BIN-DATE-1      TO  PI-BIN-HI-CERT (T-INDEX).
  5346
  5347     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5348     MOVE '3'                    TO  DC-OPTION-CODE.
  5349
  5350     PERFORM 9700-DATE-CONVERSION.
  5351
  5352     IF DATE-CONVERSION-ERROR
  5353         MOVE LOW-VALUES         TO  PI-BIN-LO-CERT (T-INDEX)
  5354     ELSE
  5355         MOVE DC-BIN-DATE-1      TO  PI-BIN-LO-CERT (T-INDEX).
  5356
  5357     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
  5358     MOVE AM-CONTROL-PRIMARY     TO  TS-ACCT-KEY (TS-INDEX).
  5359
  5360     ADD 1                       TO  PI-TOTAL-LINES.
  5361
  5362     SET T-INDEX
  5363        TS-INDEX  UP  BY  +1.
  5364
  5365     IF T-INDEX  = +33
  5366         GO TO 7000-BUILD-OUTPUT-MAP.
  5367
  5368
  5369 1020-EXIT.
  5370     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL650.cbl
  5372 1500-ADD-ACCOUNT.
  5373     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5374
  5375     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5376
  5377     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5378                                     PI-ACCT-REST-OF-EXP.
  5379
  5380     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  5381
  5382     IF REC-FOUND
  5383         MOVE -1                 TO  ACARIERL
  5384         MOVE ER-0561            TO  EMI-ERROR
  5385         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5386         GO TO 8200-SEND-DATAONLY.
  5387
  5388     MOVE NEW-KEY-SAVE           TO PI-ACCT-CCGSA-KEY.
  5389
  5390     PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT.
  5391
  5392     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5393
  5394     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  5395
  5396     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  5397         MOVE -1                 TO  EXPCHGL
  5398         MOVE ER-1228            TO  EMI-ERROR
  5399         MOVE AL-UABON           TO  EXPCHGA
  5400         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5401
  5402     IF NOT EMI-NO-ERRORS
  5403         GO TO 8200-SEND-DATAONLY.
  5404
  5405     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5406
  5407     IF WS-ACCT2-FOUND  = 'Y'
  5408         PERFORM 4200-CHECK-VALIDITY  THRU  4299-EXIT
  5409             VARYING  WS-INDEX  FROM  +1  BY  +1
  5410                UNTIL WS-INDEX GREATER +32.
  5411
  5412     IF NOT EMI-NO-ERRORS
  5413         GO TO 8200-SEND-DATAONLY.
  5414
  5415     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5416
  5417     MOVE NEW-KEY-SAVE           TO  PI-ACCT-CCGSA-KEY
  5418                                     PI-PREV-ACCOUNT
  5419                                     PI-PREV-VG-ACCOUNT.
  5420     MOVE LOW-VALUES             TO  PI-DATE-RANGE-TABLE
  5421                                     PI-ACCT-REST-OF-EXP.
  5422     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  5423                                     PI-BIN-EXP-DT (1)
  5424     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT (1).
  5425     MOVE 1                      TO  PI-TOTAL-LINES
  5426                                     PI-PAGE-NUMBER
  5427                                     PI-LINE-SELECTED.
  5428     MOVE SPACE                  TO  PI-RECORD-ADDED-SW.
  5429     MOVE MAINTI                 TO  PI-MAINT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL650.cbl
  5430     MOVE XCTL-6501              TO  PGM-NAME.
  5431
  5432     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL650.cbl
  5434 2000-CHANGE-ACCOUNT.
  5435     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5436
  5437     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5438
  5439     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5440
  5441     IF NOT EMI-NO-ERRORS
  5442         GO TO 8200-SEND-DATAONLY.
  5443
  5444     SET T-INDEX TO LINEI.
  5445
  5446     IF PI-2ND-PAGE
  5447         SET T-INDEX  UP  BY  8
  5448     ELSE
  5449     IF PI-3RD-PAGE
  5450         SET T-INDEX  UP  BY  16
  5451     ELSE
  5452     IF PI-LST-PAGE
  5453         SET T-INDEX  UP  BY  24.
  5454
  5455     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5456     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5457     MOVE MAINTI                   TO  PI-MAINT.
  5458     MOVE XCTL-6501                TO  PGM-NAME.
  5459
  5460     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL650.cbl
  5462 2500-DELETE-ACCOUNT.
  5463     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5464
  5465     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5466
  5467     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5468
  5469     IF NOT EMI-NO-ERRORS
  5470         GO TO 8200-SEND-DATAONLY.
  5471
  5472     SET T-INDEX                 TO  LINEI.
  5473
  5474     IF PI-2ND-PAGE
  5475         SET T-INDEX  UP  BY  8
  5476     ELSE
  5477     IF PI-3RD-PAGE
  5478         SET T-INDEX  UP  BY  16
  5479     ELSE
  5480     IF PI-LST-PAGE
  5481         SET T-INDEX  UP  BY  24.
  5482
  5483     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  5484                                       BIN-MAX-DATE.
  5485     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5486     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-MIN-DATE.
  5487     MOVE '1'                      TO  FROM-WHERE-SW.
  5488
  5489     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5490       VARYING  T-INDEX  FROM  +1  BY  +1
  5491         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5492
  5493     MOVE SPACE                  TO  FROM-WHERE-SW.
  5494
  5495     IF NOT EMI-NO-ERRORS
  5496         GO TO 8200-SEND-DATAONLY.
  5497
  5498     SET T-INDEX TO LINEI.
  5499
  5500     IF PI-2ND-PAGE
  5501         SET T-INDEX  UP  BY  8
  5502     ELSE
  5503     IF PI-3RD-PAGE
  5504         SET T-INDEX  UP  BY  16
  5505     ELSE
  5506     IF PI-LST-PAGE
  5507         SET T-INDEX  UP  BY  24.
  5508
  5509
  5510* EXEC CICS  READ
  5511*        UPDATE
  5512*        DATASET  (PI-ACCT-ID)
  5513*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5514*        RIDFLD   (PI-ACCT-KEY)
  5515*    END-EXEC.
  5516*    MOVE '&"S        EU         (   #00005438' TO DFHEIV0
  5517     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5518     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5519     MOVE X'2020233030303035343338' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL650.cbl
  5520     CALL 'kxdfhei1' USING DFHEIV0,
  5521           PI-ACCT-ID,
  5522           DFHEIV20,
  5523           DFHEIV99,
  5524           PI-ACCT-KEY,
  5525           DFHEIV99,
  5526           DFHEIV99,
  5527           DFHEIV99
  5528     SET ADDRESS OF ACCOUNT-MASTER TO
  5529         DFHEIV20
  5530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5531
  5532
  5533     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES  OR
  5534        PI-BIN-HI-CERT (T-INDEX)  NOT =  LOW-VALUES
  5535         MOVE ER-2070            TO  EMI-ERROR
  5536         MOVE -1                 TO  MAINTL
  5537         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5538         GO TO 8200-SEND-DATAONLY.
  5539
  5540     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5541         MOVE 'N'                TO  PENDING-BUSINESS-SW
  5542     ELSE
  5543         PERFORM 2560-CHECK-PENDING-BUSINESS  THRU  2569-EXIT.
  5544
  5545     IF THERE-IS-PENDING-BUSINESS
  5546         MOVE ER-1612            TO  EMI-ERROR
  5547         MOVE -1                 TO  MAINTL
  5548         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5549         GO TO 8200-SEND-DATAONLY.
  5550
  5551     MOVE AM-CONTROL-PRIMARY     TO  B4-ACCT-KEY.
  5552     MOVE AM-EFFECTIVE-DT        TO  B4-ACCT-EFF-DT.
  5553
  5554     if pi-el650-del-sw = 'Y'
  5555        continue
  5556     else
  5557        move 'Y'                 to pi-el650-del-sw
  5558        move er-1299             to emi-error
  5559        perform 9900-error-format thru 9900-exit
  5560        MOVE 1 TO PI-PAGE-NUMBER
  5561        move spaces              to mainto
  5562        MOVE -1                  TO MAINTL
  5563        GO TO 1000-SHOW-ACCOUNT
  5564     end-if
  5565     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  5566
  5567****** DO NOT DELETE PLAN MASTER RECORDS IF MORE ACCT DATE RANGES
  5568     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5569         NEXT SENTENCE
  5570     ELSE
  5571         IF PI-TOTAL-LINES  = 1
  5572             PERFORM 4800-DELETE-PLAN-REC   THRU  4899-EXIT
  5573         end-if
  5574     end-if
  5575
  5576     MOVE 'D'                    TO  JP-RECORD-TYPE
  5577     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL650.cbl
  5578
  5579
  5580* EXEC CICS  DELETE
  5581*        DATASET  (PI-ACCT-ID)
  5582*    END-EXEC
  5583*    MOVE '&(                    &   #00005491' TO DFHEIV0
  5584     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5585     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5586     MOVE X'2020233030303035343931' TO DFHEIV0(25:11)
  5587     CALL 'kxdfhei1' USING DFHEIV0,
  5588           PI-ACCT-ID,
  5589           DFHEIV99,
  5590           DFHEIV99,
  5591           DFHEIV99,
  5592           DFHEIV99
  5593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5594
  5595     PERFORM 8400-LOG-JOURNAL-RECORD
  5596
  5597     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT
  5598
  5599     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5600                                     PI-ACCT-REST-OF-EXP
  5601                                     LINEO
  5602     MOVE ER-0000                TO  EMI-ERROR
  5603
  5604     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5605
  5606     IF PI-TOTAL-LINES  = 1
  5607         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  5608         MOVE ZEROS              TO  PI-TOTAL-LINES
  5609         MOVE 1                  TO  PI-PAGE-NUMBER
  5610         GO TO 7000-BUILD-OUTPUT-MAP
  5611     end-if
  5612     GO TO 1002-SHOW-NEW-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL650.cbl
  5614 2550-CHECK-HI-LO-DATES.
  5615     IF FROM-CHANGE
  5616         GO TO 2550-CHECK-CHANGE.
  5617
  5618     IF PI-BIN-LO-CERT (T-INDEX)  =  LOW-VALUES  AND
  5619        PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  5620         GO TO 2550-CHECK-AR-DELETE.
  5621
  5622     IF ((PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5623          PI-BIN-HI-CERT (T-INDEX) LESS BIN-MAX-DATE)
  5624       OR
  5625         (PI-BIN-LO-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5626          PI-BIN-LO-CERT (T-INDEX) LESS BIN-MAX-DATE))
  5627       AND
  5628            (PI-PROCESSOR-ID  NOT =  'LGXX')
  5629         MOVE ER-2087            TO  EMI-ERROR
  5630         MOVE -1                 TO  MAINTL
  5631         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5632
  5633 2550-CHECK-AR-DELETE.
  5634     IF NOT PI-AR-PROCESSING
  5635         GO TO 2550-EXIT.
  5636
  5637     IF T-INDEX NOT = LINEI
  5638         GO TO 2550-EXIT.
  5639
  5640     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  5641        GO TO 2550-EXIT.
  5642
  5643     MOVE ER-3155                TO  EMI-ERROR
  5644     MOVE -1                     TO  MAINTL
  5645     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5646
  5647 2550-CHECK-CHANGE.
  5648     IF PI-BIN-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  5649         GO TO 2550-CHECK-AR-CHANGE.
  5650
  5651     IF PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5652         MOVE ER-2113            TO  EMI-ERROR
  5653         MOVE -1                 TO  MAINTL
  5654         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5655
  5656 2550-CHECK-AR-CHANGE.
  5657      IF NOT PI-AR-PROCESSING
  5658          GO TO 2550-EXIT.
  5659
  5660      IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES
  5661          GO TO 2550-EXIT.
  5662
  5663      IF PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5664         MOVE ER-3155            TO  EMI-ERROR
  5665         MOVE -1                 TO  MAINTL
  5666         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5667
  5668 2550-EXIT.
  5669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL650.cbl
  5671 2560-CHECK-PENDING-BUSINESS.
  5672     MOVE 'N'                    TO  PENDING-BUSINESS-SW.
  5673     MOVE LOW-VALUES             TO  ERPNDB-KEY
  5674                                     PI-ERPNDB-ALT-KEY.
  5675     MOVE AM-COMPANY-CD-A1       TO  PNDB-COMPANY-CD-A1
  5676                                     PI-PB-COMPANY-CD-A1.
  5677     MOVE AM-VG-CARRIER          TO  PNDB-CARRIER
  5678                                     PI-PB-CARRIER.
  5679     MOVE AM-VG-GROUPING         TO  PNDB-GROUPING
  5680                                     PI-PB-GROUPING.
  5681     MOVE AM-VG-STATE            TO  PNDB-STATE
  5682                                     PI-PB-STATE.
  5683     MOVE AM-VG-ACCOUNT          TO  PNDB-ACCOUNT
  5684                                     PI-PB-ACCOUNT.
  5685
  5686
  5687* EXEC CICS  HANDLE CONDITION
  5688*         NOTFND   (2568-NO-RECORDS)
  5689*         ENDFILE  (2568-NO-RECORDS)
  5690*    END-EXEC.
  5691*    MOVE '"$I''                  ! % #00005586' TO DFHEIV0
  5692     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5694     MOVE X'2520233030303035353836' TO DFHEIV0(25:11)
  5695     CALL 'kxdfhei1' USING DFHEIV0
  5696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5697
  5698
  5699
  5700* EXEC CICS  STARTBR
  5701*        DATASET  (PEND2-FILE-ID)
  5702*        RIDFLD   (ERPNDB-KEY)
  5703*    END-EXEC.
  5704     MOVE 0
  5705       TO DFHEIV11
  5706*    MOVE '&,         G          &   #00005591' TO DFHEIV0
  5707     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5708     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5709     MOVE X'2020233030303035353931' TO DFHEIV0(25:11)
  5710     CALL 'kxdfhei1' USING DFHEIV0,
  5711           PEND2-FILE-ID,
  5712           ERPNDB-KEY,
  5713           DFHEIV99,
  5714           DFHEIV11,
  5715           DFHEIV99
  5716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5717
  5718
  5719     MOVE 'Y'                    TO  PENDING-BROWSE-SW.
  5720
  5721 2562-READ-NEXT-PENDING.
  5722
  5723* EXEC CICS  READNEXT
  5724*        DATASET  (PEND2-FILE-ID)
  5725*        RIDFLD   (ERPNDB-KEY)
  5726*        SET      (ADDRESS OF PENDING-BUSINESS)
  5727*    END-EXEC.
  5728     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL650.cbl
  5729       TO DFHEIV11
  5730*    MOVE '&.S                   )   #00005599' TO DFHEIV0
  5731     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5732     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5733     MOVE X'2020233030303035353939' TO DFHEIV0(25:11)
  5734     CALL 'kxdfhei1' USING DFHEIV0,
  5735           PEND2-FILE-ID,
  5736           DFHEIV20,
  5737           DFHEIV99,
  5738           ERPNDB-KEY,
  5739           DFHEIV99,
  5740           DFHEIV11,
  5741           DFHEIV99,
  5742           DFHEIV99
  5743     SET ADDRESS OF PENDING-BUSINESS TO
  5744         DFHEIV20
  5745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5746
  5747
  5748     IF PB-COMPANY-CD-A1 = PI-PB-COMPANY-CD-A1 AND
  5749        PB-CARRIER       = PI-PB-CARRIER       AND
  5750        PB-GROUPING      = PI-PB-GROUPING      AND
  5751        PB-STATE         = PI-PB-STATE         AND
  5752        PB-ACCOUNT       = PI-PB-ACCOUNT
  5753            NEXT SENTENCE
  5754          ELSE
  5755            GO TO 2568-NO-RECORDS.
  5756
  5757     IF PB-ISSUE
  5758       OR  PB-CANCELLATION
  5759         NEXT SENTENCE
  5760     ELSE
  5761         GO TO 2562-READ-NEXT-PENDING.
  5762
  5763     IF PB-CERT-EFF-DT  IS EQUAL TO  AM-EFFECTIVE-DT
  5764         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5765         GO TO 2568-NO-RECORDS.
  5766
  5767     IF PB-CERT-EFF-DT  IS GREATER THAN  AM-EFFECTIVE-DT
  5768       AND PB-CERT-EFF-DT  IS LESS THAN  AM-EXPIRATION-DT
  5769         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5770         GO TO 2568-NO-RECORDS.
  5771
  5772     GO TO 2562-READ-NEXT-PENDING.
  5773
  5774 2568-NO-RECORDS.
  5775     IF PENDING-BROWSE-STARTED
  5776         MOVE ' '                TO  PENDING-BROWSE-SW
  5777
  5778* EXEC CICS ENDBR
  5779*           DATASET  (PEND2-FILE-ID)
  5780*       END-EXEC.
  5781     MOVE 0
  5782       TO DFHEIV11
  5783*    MOVE '&2                    $   #00005634' TO DFHEIV0
  5784     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5786     MOVE X'2020233030303035363334' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL650.cbl
  5787     CALL 'kxdfhei1' USING DFHEIV0,
  5788           PEND2-FILE-ID,
  5789           DFHEIV11,
  5790           DFHEIV99
  5791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5792
  5793
  5794 2569-EXIT.
  5795     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL650.cbl
  5797 3000-CHANGE-EXPIRATION.
  5798     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5799     PERFORM 6200-CHECK-KEY             THRU  6200-EXIT.
  5800     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5801     PERFORM 4100-BUILD-VERIFICATION    THRU  4199-EXIT.
  5802
  5803     SET T-INDEX  TO  PI-TOTAL-LINES.
  5804
  5805     PERFORM VARYING WS-INDEX FROM +1 BY +1
  5806             UNTIL  PI-BIN-EXP-DT (T-INDEX)
  5807                        =  WS-ACCT-EXP-DT (WS-INDEX)
  5808                 OR  WS-INDEX GREATER +32
  5809     END-PERFORM.
  5810
  5811     IF PI-BIN-EXP-DT (T-INDEX) = WS-ACCT-EXP-DT (WS-INDEX)
  5812         MOVE BIN-EXPCHG-SAVE    TO  WS-ACCT-EXP-DT (WS-INDEX)
  5813         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  5814             VARYING  WS-INDEX  FROM  +1  BY  +1
  5815               UNTIL  WS-INDEX GREATER +32
  5816     ELSE
  5817         MOVE ER-0453            TO  EMI-ERROR
  5818         MOVE -1                 TO  MAINTL
  5819         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5820
  5821     IF NOT EMI-NO-ERRORS
  5822         GO TO 8200-SEND-DATAONLY.
  5823
  5824     MOVE BIN-EXPCHG-SAVE        TO  BIN-MAX-DATE.
  5825     MOVE '2'                    TO  FROM-WHERE-SW.
  5826
  5827     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5828       VARYING  T-INDEX  FROM  +1  BY  +1
  5829         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5830
  5831     MOVE SPACE                  TO  FROM-WHERE-SW.
  5832
  5833     IF NOT EMI-NO-ERRORS
  5834         GO TO 8200-SEND-DATAONLY.
  5835
  5836     SET T-INDEX  TO  PI-TOTAL-LINES.
  5837     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  5838
  5839     IF NOT EMI-NO-ERRORS
  5840         GO TO 8200-SEND-DATAONLY.
  5841
  5842     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5843     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5844     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  5845     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  5846
  5847     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  5848
  5849     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  5850                                     AM-VG-EXPIRATION-DT
  5851                                     PI-BIN-EXP-DT (T-INDEX).
  5852     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  5853                                     PI-BIN-MAINT-DT (T-INDEX).
  5854     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL650.cbl
  5855     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  5856
  5857     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  5858
  5859     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  5860
  5861     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  5862
  5863     MOVE SPACES                 TO  EXPCHGI.
  5864     MOVE AL-UANOF               TO  EXPCHGA.
  5865     MOVE ER-0000                TO  EMI-ERROR.
  5866
  5867     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5868
  5869     GO TO 7000-BUILD-OUTPUT-MAP.
  5870
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL650.cbl
  5872 3100-DELETE-DATE-RANGE.
  5873
  5874* EXEC CICS GETMAIN
  5875*        LENGTH   (ACCT-REC-LEN)
  5876*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5877*        INITIMG  (GETMAIN-SPACE)
  5878*    END-EXEC.
  5879*    MOVE ',"IL                  $   #00005717' TO DFHEIV0
  5880     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5881     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5882     MOVE X'2020233030303035373137' TO DFHEIV0(25:11)
  5883     CALL 'kxdfhei1' USING DFHEIV0,
  5884           DFHEIV20,
  5885           ACCT-REC-LEN,
  5886           GETMAIN-SPACE
  5887     SET ADDRESS OF ACCOUNT-MASTER TO
  5888         DFHEIV20
  5889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5890
  5891
  5892
  5893* EXEC CICS  HANDLE CONDITION
  5894*        NOTFND   (3175-CONTINUE)
  5895*        ENDFILE  (3175-CONTINUE)
  5896*    END-EXEC.
  5897*    MOVE '"$I''                  ! & #00005723' TO DFHEIV0
  5898     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5900     MOVE X'2620233030303035373233' TO DFHEIV0(25:11)
  5901     CALL 'kxdfhei1' USING DFHEIV0
  5902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5903
  5904
  5905
  5906
  5907* EXEC CICS  READ
  5908*        UPDATE
  5909*        DATASET  (PI-ACCT-ID)
  5910*        INTO     (ACCOUNT-MASTER)
  5911*        RIDFLD   (PI-ACCT-KEY)
  5912*    END-EXEC.
  5913     MOVE LENGTH OF
  5914      ACCOUNT-MASTER
  5915       TO DFHEIV11
  5916*    MOVE '&"IL       EU         (   #00005729' TO DFHEIV0
  5917     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5918     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5919     MOVE X'2020233030303035373239' TO DFHEIV0(25:11)
  5920     CALL 'kxdfhei1' USING DFHEIV0,
  5921           PI-ACCT-ID,
  5922           ACCOUNT-MASTER,
  5923           DFHEIV11,
  5924           PI-ACCT-KEY,
  5925           DFHEIV99,
  5926           DFHEIV99,
  5927           DFHEIV99
  5928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5929
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL650.cbl
  5930
  5931     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5932     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5933     MOVE ACCT-FILE-ID           TO  FILE-ID.
  5934
  5935
  5936* EXEC CICS  DELETE
  5937*        DATASET  (PI-ACCT-ID)
  5938*    END-EXEC.
  5939*    MOVE '&(                    &   #00005740' TO DFHEIV0
  5940     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5941     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5942     MOVE X'2020233030303035373430' TO DFHEIV0(25:11)
  5943     CALL 'kxdfhei1' USING DFHEIV0,
  5944           PI-ACCT-ID,
  5945           DFHEIV99,
  5946           DFHEIV99,
  5947           DFHEIV99,
  5948           DFHEIV99
  5949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5950
  5951
  5952     PERFORM 8400-LOG-JOURNAL-RECORD.
  5953
  5954     GO TO 3199-EXIT.
  5955
  5956 3175-CONTINUE.
  5957     IF BROWSE-STARTED
  5958         PERFORM 6320-ENDBR THRU 6320-EXIT.
  5959
  5960     MOVE ER-0226                TO  EMI-ERROR.
  5961
  5962     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5963
  5964     MOVE -1                     TO  MAINTL.
  5965
  5966     GO TO 8200-SEND-DATAONLY.
  5967
  5968 3199-EXIT.
  5969     EXIT.
  5970
  5971 3200-ADD-DATE-RANGE.
  5972     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5973     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  5974
  5975
  5976* EXEC CICS  WRITE
  5977*        FROM     (ACCOUNT-MASTER)
  5978*        RIDFLD   (AM-CONTROL-PRIMARY)
  5979*        DATASET  (PI-ACCT-ID)
  5980*    END-EXEC.
  5981     MOVE LENGTH OF
  5982      ACCOUNT-MASTER
  5983       TO DFHEIV11
  5984*    MOVE '&$ L                  ''   #00005767' TO DFHEIV0
  5985     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5986     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5987     MOVE X'2020233030303035373637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL650.cbl
  5988     CALL 'kxdfhei1' USING DFHEIV0,
  5989           PI-ACCT-ID,
  5990           ACCOUNT-MASTER,
  5991           DFHEIV11,
  5992           AM-CONTROL-PRIMARY,
  5993           DFHEIV99,
  5994           DFHEIV99
  5995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5996
  5997
  5998     PERFORM 8400-LOG-JOURNAL-RECORD.
  5999
  6000 3299-EXIT.
  6001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL650.cbl
  6003 3500-CHANGE-EFFECTIVE.
  6004     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6005
  6006     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6007
  6008     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU  6000-EFF-EXIT.
  6009
  6010     IF NOT EMI-NO-ERRORS
  6011         GO TO 8200-SEND-DATAONLY.
  6012
  6013     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6014
  6015     SET T-INDEX                 TO  +1.
  6016
  6017     PERFORM VARYING  WS-INDEX  FROM  +1  BY  +1
  6018             UNTIL  PI-BIN-EFF-DT (T-INDEX)
  6019                        =  WS-ACCT-EFF-DT (WS-INDEX)
  6020                 OR  WS-INDEX GREATER +32
  6021     END-PERFORM.
  6022
  6023     IF PI-BIN-EFF-DT (T-INDEX)
  6024                 = WS-ACCT-EFF-DT (WS-INDEX)
  6025         MOVE BIN-EFFCHG-SAVE    TO  WS-ACCT-EFF-DT (WS-INDEX)
  6026         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  6027             VARYING  WS-INDEX  FROM  +1  BY  +1
  6028               UNTIL  WS-INDEX GREATER +32
  6029     ELSE
  6030         MOVE ER-0453            TO  EMI-ERROR
  6031         MOVE -1                 TO  MAINTL
  6032         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6033
  6034     IF NOT EMI-NO-ERRORS
  6035         GO TO 8200-SEND-DATAONLY.
  6036
  6037     SET T-INDEX TO  1.
  6038
  6039     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  6040
  6041     IF NOT EMI-NO-ERRORS
  6042         GO TO 8200-SEND-DATAONLY.
  6043
  6044     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6045     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6046     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  6047     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  6048
  6049
  6050* EXEC CICS  READ
  6051*        UPDATE
  6052*        DATASET  (PI-ACCT-ID)
  6053*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6054*        RIDFLD   (PI-ACCT-KEY)
  6055*    END-EXEC.
  6056*    MOVE '&"S        EU         (   #00005824' TO DFHEIV0
  6057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6059     MOVE X'2020233030303035383234' TO DFHEIV0(25:11)
  6060     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL650.cbl
  6061           PI-ACCT-ID,
  6062           DFHEIV20,
  6063           DFHEIV99,
  6064           PI-ACCT-KEY,
  6065           DFHEIV99,
  6066           DFHEIV99,
  6067           DFHEIV99
  6068     SET ADDRESS OF ACCOUNT-MASTER TO
  6069         DFHEIV20
  6070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6071
  6072
  6073     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6074     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6075     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6076
  6077     PERFORM 8400-LOG-JOURNAL-RECORD.
  6078
  6079     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT
  6080                                     PI-BIN-EFF-DT (T-INDEX).
  6081     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  6082     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  6083                                     PI-BIN-MAINT-DT (T-INDEX).
  6084     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  6085     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  6086     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6087     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6088
  6089     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  6090
  6091
  6092* EXEC CICS  REWRITE
  6093*        FROM     (ACCOUNT-MASTER)
  6094*        DATASET  (PI-ACCT-ID)
  6095*    END-EXEC.
  6096     MOVE LENGTH OF
  6097      ACCOUNT-MASTER
  6098       TO DFHEIV11
  6099*    MOVE '&& L                  %   #00005849' TO DFHEIV0
  6100     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6101     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6102     MOVE X'2020233030303035383439' TO DFHEIV0(25:11)
  6103     CALL 'kxdfhei1' USING DFHEIV0,
  6104           PI-ACCT-ID,
  6105           ACCOUNT-MASTER,
  6106           DFHEIV11,
  6107           DFHEIV99
  6108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6109
  6110
  6111     PERFORM 8400-LOG-JOURNAL-RECORD.
  6112
  6113     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6114
  6115     MOVE SPACES                 TO  EFFCHGO.
  6116
  6117     MOVE ZERO                   TO  EFFCHGL
  6118                                     EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL650.cbl
  6119
  6120     MOVE AL-UANOF               TO  EFFCHGA.
  6121
  6122     MOVE ER-0000                TO  EMI-ERROR.
  6123
  6124     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6125
  6126     GO TO 7000-BUILD-OUTPUT-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL650.cbl
  6128 4000-CHANGE-ALL.
  6129     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6130
  6131     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6132
  6133     IF NOT EMI-NO-ERRORS
  6134         GO TO 8200-SEND-DATAONLY.
  6135
  6136     MOVE 1                      TO  PI-LINE-SELECTED.
  6137     MOVE MAINTI                 TO  PI-MAINT.
  6138     MOVE XCTL-6501              TO  PGM-NAME.
  6139
  6140     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL650.cbl
  6142 4100-BUILD-VERIFICATION.
  6143     MOVE SPACES                 TO  BROWSE-STARTED-SW.
  6144
  6145     SET WS-INDEX  TO  +1.
  6146
  6147     MOVE 'N'                    TO  WS-ACCT2-FOUND.
  6148     MOVE PI-ACCT-KEY            TO  WS-ACCT-VERIFY-KEY.
  6149     MOVE LOW-VALUES             TO  WS-ACCT-VER-EXP-DT
  6150                                     WS-VERIFY-AREA.
  6151
  6152     IF ST-ACCNT-CNTL  OR
  6153        ACCNT-CNTL
  6154          MOVE SPACES             TO  WS-ACCT-VER-CARR.
  6155
  6156     IF ST-ACCNT-CNTL      OR
  6157        CARR-ST-ACCNT-CNTL OR
  6158        ACCNT-CNTL         OR
  6159        CARR-ACCNT-CNTL
  6160          MOVE SPACES             TO  WS-ACCT-VER-GROUP.
  6161
  6162     IF ACCNT-CNTL OR
  6163        CARR-ACCNT-CNTL
  6164          MOVE SPACES             TO  WS-ACCT-VER-STATE.
  6165
  6166     MOVE WS-ACCT-VERIFY-KEY     TO  WS-SAVE-VERIFY-KEY.
  6167
  6168
  6169* EXEC CICS  HANDLE CONDITION
  6170*        NOTFND   (4175-CONTINUE)
  6171*        ENDFILE  (4175-CONTINUE)
  6172*    END-EXEC.
  6173*    MOVE '"$I''                  ! '' #00005911' TO DFHEIV0
  6174     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6175     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6176     MOVE X'2720233030303035393131' TO DFHEIV0(25:11)
  6177     CALL 'kxdfhei1' USING DFHEIV0
  6178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6179
  6180
  6181
  6182* EXEC CICS  STARTBR
  6183*        DATASET  (ACCT2-FILE-ID)
  6184*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6185*        GTEQ
  6186*    END-EXEC.
  6187     MOVE 0
  6188       TO DFHEIV11
  6189*    MOVE '&,         G          &   #00005916' TO DFHEIV0
  6190     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6191     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6192     MOVE X'2020233030303035393136' TO DFHEIV0(25:11)
  6193     CALL 'kxdfhei1' USING DFHEIV0,
  6194           ACCT2-FILE-ID,
  6195           WS-ACCT-VERIFY-KEY,
  6196           DFHEIV99,
  6197           DFHEIV11,
  6198           DFHEIV99
  6199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL650.cbl
  6200
  6201
  6202     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  6203
  6204 4150-READ-NEXT.
  6205
  6206* EXEC CICS  READNEXT
  6207*        DATASET  (ACCT2-FILE-ID)
  6208*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6209*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6210*    END-EXEC.
  6211     MOVE 0
  6212       TO DFHEIV11
  6213*    MOVE '&.S                   )   #00005925' TO DFHEIV0
  6214     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6215     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6216     MOVE X'2020233030303035393235' TO DFHEIV0(25:11)
  6217     CALL 'kxdfhei1' USING DFHEIV0,
  6218           ACCT2-FILE-ID,
  6219           DFHEIV20,
  6220           DFHEIV99,
  6221           WS-ACCT-VERIFY-KEY,
  6222           DFHEIV99,
  6223           DFHEIV11,
  6224           DFHEIV99,
  6225           DFHEIV99
  6226     SET ADDRESS OF ACCOUNT-MASTER TO
  6227         DFHEIV20
  6228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6229
  6230
  6231     MOVE AM-CONTROL-BY-VAR-GRP  TO  WS-TEST-KEY.
  6232
  6233     IF WS-TEST-KEY  NOT = WS-SAVE-VERIFY-KEY
  6234         GO TO 4175-CONTINUE.
  6235
  6236     MOVE 'Y'                    TO  WS-ACCT2-FOUND.
  6237     MOVE AM-CONTROL-PRIMARY     TO  WS-ACCT-KEY (WS-INDEX).
  6238     MOVE AM-VG-EXPIRATION-DT    TO  WS-ACCT-EXP-DT (WS-INDEX).
  6239     MOVE AM-EFFECTIVE-DT        TO  WS-ACCT-EFF-DT (WS-INDEX).
  6240     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6241     MOVE '3'                    TO  DC-OPTION-CODE.
  6242
  6243     PERFORM 9700-DATE-CONVERSION.
  6244
  6245     IF DATE-CONVERSION-ERROR
  6246         MOVE LOW-VALUES         TO  WS-ACCT-HI-CERT (WS-INDEX)
  6247     ELSE
  6248         MOVE DC-BIN-DATE-1      TO  WS-ACCT-HI-CERT (WS-INDEX).
  6249
  6250     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6251     MOVE '3'                    TO  DC-OPTION-CODE.
  6252
  6253     PERFORM 9700-DATE-CONVERSION.
  6254
  6255     IF DATE-CONVERSION-ERROR
  6256         MOVE LOW-VALUES         TO  WS-ACCT-LO-CERT (WS-INDEX)
  6257     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL650.cbl
  6258         MOVE DC-BIN-DATE-1      TO  WS-ACCT-LO-CERT (WS-INDEX).
  6259
  6260     SET WS-INDEX  UP  BY  +1.
  6261
  6262     GO TO 4150-READ-NEXT.
  6263
  6264 4175-CONTINUE.
  6265     IF BROWSE-STARTED
  6266
  6267* EXEC CICS  ENDBR
  6268*            DATASET  (ACCT2-FILE-ID)
  6269*        END-EXEC
  6270     MOVE 0
  6271       TO DFHEIV11
  6272*    MOVE '&2                    $   #00005966' TO DFHEIV0
  6273     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6274     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6275     MOVE X'2020233030303035393636' TO DFHEIV0(25:11)
  6276     CALL 'kxdfhei1' USING DFHEIV0,
  6277           ACCT2-FILE-ID,
  6278           DFHEIV11,
  6279           DFHEIV99
  6280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6281         MOVE SPACES             TO  BROWSE-STARTED-SW.
  6282
  6283 4199-EXIT.
  6284     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL650.cbl
  6286 4200-CHECK-VALIDITY.
  6287     IF (BIN-EXPCHG-SAVE GREATER
  6288                    WS-ACCT-EFF-DT (WS-INDEX))
  6289       AND  (BIN-EXPCHG-SAVE NOT GREATER
  6290                    WS-ACCT-EXP-DT (WS-INDEX))
  6291         MOVE ER-2051            TO  EMI-ERROR
  6292         MOVE -1                 TO  EXPCHGL
  6293         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6294
  6295     IF BIN-EFFCHG-SAVE NOT LESS WS-ACCT-EFF-DT (WS-INDEX) AND
  6296        BIN-EFFCHG-SAVE LESS     WS-ACCT-EXP-DT (WS-INDEX)
  6297          MOVE ER-2051            TO  EMI-ERROR
  6298          MOVE -1                 TO  EFFCHGL
  6299          PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6300
  6301 4299-EXIT.
  6302     EXIT.
  6303
  6304 4300-VERIFY-INTEGRITY.
  6305     IF WS-ACCT-EFF-DT (WS-INDEX + 1)  = LOW-VALUES
  6306         SET WS-INDEX  TO  +32
  6307         GO TO 4399-EXIT.
  6308
  6309     IF (WS-ACCT-EXP-DT (WS-INDEX)  =  BIN-EXPCHG-SAVE)  OR
  6310        (WS-ACCT-EFF-DT (WS-INDEX + 1)  =  BIN-EFFCHG-SAVE)
  6311         SET WS-INDEX  TO  +33
  6312         GO TO 4399-EXIT.
  6313
  6314     IF (WS-ACCT-EXP-DT (WS-INDEX) NOT GREATER
  6315                    WS-ACCT-EFF-DT (WS-INDEX + 1))
  6316       AND  (WS-ACCT-EXP-DT (WS-INDEX) GREATER
  6317                    WS-ACCT-EFF-DT (WS-INDEX))
  6318         GO TO 4399-EXIT.
  6319
  6320     MOVE ER-2051                TO  EMI-ERROR.
  6321     MOVE -1                     TO  EXPCHGL.
  6322
  6323     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6324
  6325 4399-EXIT.
  6326     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL650.cbl
  6328 4500-CREATE-NEW-ACCOUNT.
  6329     PERFORM 6100-BUILD-KEY            THRU 6199-EXIT.
  6330
  6331     PERFORM 6700-VERIFY-STATE-CARRIER THRU 6799-EXIT.
  6332
  6333     IF MAINTI = 'T'
  6334         PERFORM 6000-EDIT-EFFECTIVE-DATE THRU 6000-EFF-EXIT.
  6335
  6336     PERFORM 4100-BUILD-VERIFICATION THRU 4199-EXIT.
  6337
  6338     IF WS-ACCT2-FOUND = 'Y'
  6339         MOVE ER-0561            TO  EMI-ERROR
  6340         MOVE -1                 TO  MAINTL
  6341         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6342
  6343     MOVE SPACES                 TO  GETMAIN-SW.
  6344
  6345     IF NOT EMI-NO-ERRORS
  6346         GO TO 8200-SEND-DATAONLY.
  6347
  6348     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6349         MOVE ER-0453            TO  EMI-ERROR
  6350         MOVE -1                 TO  MAINTL
  6351         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6352         GO TO 8200-SEND-DATAONLY.
  6353
  6354     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6355
  6356     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6357                                     PI-ACCT-REST-OF-EXP.
  6358
  6359     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  6360
  6361     IF REC-FOUND
  6362         MOVE -1                 TO  ACARIERL
  6363         MOVE ER-0561            TO  EMI-ERROR
  6364         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6365         GO TO 8200-SEND-DATAONLY.
  6366
  6367     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6368     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6369                                     PI-ACCT-REST-OF-EXP.
  6370
  6371
  6372* EXEC CICS  HANDLE CONDITION
  6373*        NOTFND   (4530-NOT-FOUND)
  6374*        ENDFILE  (4530-NOT-FOUND)
  6375*    END-EXEC.
  6376*    MOVE '"$I''                  ! ( #00006059' TO DFHEIV0
  6377     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6379     MOVE X'2820233030303036303539' TO DFHEIV0(25:11)
  6380     CALL 'kxdfhei1' USING DFHEIV0
  6381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6382
  6383
  6384     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6385
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL650.cbl
  6386 4510-READ-NEXT.
  6387     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6388
  6389     IF PI-ACCT-CCGSA-KEY  NOT = PI-PREV-ACCOUNT
  6390         GO TO 4540-END-COPY.
  6391
  6392     MOVE AM-EXPIRATION-DT       TO  WS-EXP-SAVE.
  6393     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6394     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6395     MOVE WS-EXP-SAVE            TO  AM-EXPIRATION-DT.
  6396
  6397     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6398
  6399     IF MAINTI  = 'T'
  6400         MOVE '2'                TO  AM-STATUS
  6401         MOVE AM-ACCOUNT         TO  AM-AGT (1)
  6402         MOVE PI-ACCT-CARRIER    TO  AM-TRNFROM-CARRIER
  6403         MOVE PI-ACCT-GROUPING   TO  AM-TRNFROM-GROUPING
  6404         MOVE PI-ACCT-STATE      TO  AM-TRNFROM-STATE
  6405         MOVE PI-ACCT-ACCOUNT    TO  AM-TRNFROM-ACCOUNT
  6406         MOVE BIN-EFFCHG-SAVE    TO  AM-TRNFROM-DTE
  6407     ELSE
  6408         MOVE LOW-VALUES         TO  AM-AR-HI-CERT-DATE
  6409         MOVE ZEROS              TO  AM-HI-CERT-DATE
  6410                                     AM-LO-CERT-DATE
  6411         MOVE SPACES             TO  AM-1ST-PROD-DATE
  6412                                     AM-PREV-DATES
  6413                                     AM-ORIG-DEALER-NO
  6414     END-IF
  6415
  6416     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6417     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6418     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6419     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6420
  6421     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6422
  6423     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6424     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6425
  6426     PERFORM 6320-ENDBR THRU 6320-EXIT.
  6427
  6428
  6429* EXEC CICS GETMAIN
  6430*        LENGTH   (ACCT-REC-LEN)
  6431*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6432*        INITIMG  (GETMAIN-SPACE)
  6433*    END-EXEC.
  6434*    MOVE ',"IL                  $   #00006108' TO DFHEIV0
  6435     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6436     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6437     MOVE X'2020233030303036313038' TO DFHEIV0(25:11)
  6438     CALL 'kxdfhei1' USING DFHEIV0,
  6439           DFHEIV20,
  6440           ACCT-REC-LEN,
  6441           GETMAIN-SPACE
  6442     SET ADDRESS OF ACCOUNT-MASTER TO
  6443         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL650.cbl
  6444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6445
  6446
  6447     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6448
  6449
  6450* EXEC CICS  WRITE
  6451*        DATASET  (PI-ACCT-ID)
  6452*        RIDFLD   (AM-CONTROL-PRIMARY)
  6453*        FROM     (ACCOUNT-MASTER)
  6454*    END-EXEC.
  6455     MOVE LENGTH OF
  6456      ACCOUNT-MASTER
  6457       TO DFHEIV11
  6458*    MOVE '&$ L                  ''   #00006116' TO DFHEIV0
  6459     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6461     MOVE X'2020233030303036313136' TO DFHEIV0(25:11)
  6462     CALL 'kxdfhei1' USING DFHEIV0,
  6463           PI-ACCT-ID,
  6464           ACCOUNT-MASTER,
  6465           DFHEIV11,
  6466           AM-CONTROL-PRIMARY,
  6467           DFHEIV99,
  6468           DFHEIV99
  6469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6470
  6471
  6472     MOVE PI-ACCT-ID             TO  FILE-ID.
  6473
  6474     PERFORM 8400-LOG-JOURNAL-RECORD.
  6475
  6476     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  6477     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6478
  6479     GO TO 4510-READ-NEXT.
  6480
  6481 4530-NOT-FOUND.
  6482     IF BROWSE-STARTED
  6483         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6484
  6485     MOVE ER-0226                TO  EMI-ERROR.
  6486
  6487     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6488
  6489     MOVE -1                     TO  MAINTL.
  6490
  6491     GO TO 8200-SEND-DATAONLY.
  6492
  6493 4540-END-COPY.
  6494     IF MAINTI = 'K'
  6495         IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  6496             NEXT SENTENCE
  6497         ELSE
  6498             PERFORM 4600-ADD-ERPLAN-RECORD THRU 4699-EXIT.
  6499
  6500     IF BROWSE-STARTED
  6501         PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL650.cbl
  6502
  6503     IF MAINTI  NOT = 'T'
  6504         GO TO 4590-SHOW-NEW-ACCOUNT.
  6505
  6506     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6507     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6508                                     PI-ACCT-REST-OF-EXP.
  6509
  6510     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6511
  6512 4550-READ-NEXT.
  6513     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6514
  6515     IF PI-ACCT-CCGSA-KEY  NOT =  PI-PREV-ACCOUNT
  6516         GO TO 4570-END-REWRITE.
  6517
  6518
  6519* EXEC CICS  READ
  6520*        UPDATE
  6521*        DATASET  (PI-ACCT-ID)
  6522*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6523*        RIDFLD   (PI-ACCT-KEY)
  6524*    END-EXEC.
  6525*    MOVE '&"S        EU         (   #00006168' TO DFHEIV0
  6526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6527     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6528     MOVE X'2020233030303036313638' TO DFHEIV0(25:11)
  6529     CALL 'kxdfhei1' USING DFHEIV0,
  6530           PI-ACCT-ID,
  6531           DFHEIV20,
  6532           DFHEIV99,
  6533           PI-ACCT-KEY,
  6534           DFHEIV99,
  6535           DFHEIV99,
  6536           DFHEIV99
  6537     SET ADDRESS OF ACCOUNT-MASTER TO
  6538         DFHEIV20
  6539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6540
  6541
  6542     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6543     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6544     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6545
  6546     PERFORM 8400-LOG-JOURNAL-RECORD.
  6547
  6548     MOVE NEW-KEY-CNTRL          TO  AM-TRANSFERRED-TO.
  6549     MOVE BIN-EFFCHG-SAVE        TO  AM-TRNTO-DTE.
  6550     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6551     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6552     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6553     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6554     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6555
  6556
  6557* EXEC CICS  REWRITE
  6558*        DATASET  (PI-ACCT-ID)
  6559*        FROM     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL650.cbl
  6560*    END-EXEC.
  6561     MOVE LENGTH OF
  6562      ACCOUNT-MASTER
  6563       TO DFHEIV11
  6564*    MOVE '&& L                  %   #00006189' TO DFHEIV0
  6565     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6566     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6567     MOVE X'2020233030303036313839' TO DFHEIV0(25:11)
  6568     CALL 'kxdfhei1' USING DFHEIV0,
  6569           PI-ACCT-ID,
  6570           ACCOUNT-MASTER,
  6571           DFHEIV11,
  6572           DFHEIV99
  6573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6574
  6575
  6576     MOVE PI-ACCT-ID             TO  FILE-ID.
  6577
  6578     PERFORM 8400-LOG-JOURNAL-RECORD.
  6579
  6580     GO TO 4550-READ-NEXT.
  6581
  6582 4570-END-REWRITE.
  6583     IF BROWSE-STARTED
  6584         PERFORM 6320-ENDBR  THRU  6320-EXIT.
  6585
  6586     MOVE SPACES                 TO  MAINTI
  6587                                     EFFCHGI.
  6588     MOVE AL-UANOF               TO  EFFCHGA.
  6589
  6590 4590-SHOW-NEW-ACCOUNT.
  6591     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6592
  6593     MOVE NEW-KEY-SAVE           TO  PI-PREV-ACCOUNT
  6594                                     PI-ACCT-CCGSA-KEY.
  6595
  6596     MOVE -1                     TO  MAINTL.
  6597     MOVE ER-0000                TO  EMI-ERROR.
  6598
  6599     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6600
  6601     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT.
  6602
  6603     GO TO 1002-SHOW-NEW-RECORDS.
  6604
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL650.cbl
  6606 4600-ADD-ERPLAN-RECORD.
  6607
  6608* EXEC CICS  HANDLE CONDITION
  6609*        NOTFND   (4699-EXIT)
  6610*        ENDFILE  (4689-EOF)
  6611*    END-EXEC.
  6612*    MOVE '"$I''                  ! ) #00006225' TO DFHEIV0
  6613     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6615     MOVE X'2920233030303036323235' TO DFHEIV0(25:11)
  6616     CALL 'kxdfhei1' USING DFHEIV0
  6617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6618
  6619
  6620     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6621     MOVE PI-PREV-ACCOUNT       TO EK-CCGSA-KEY.
  6622
  6623     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6624
  6625 4610-READ-NEXT.
  6626     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6627
  6628     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6629         GO TO 4689-EOF.
  6630
  6631     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  6632
  6633     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  6634     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  6635     MOVE EK-REVISION            TO  PL-REVISION-NO.
  6636
  6637     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  6638
  6639     MOVE PLAN-MASTER            TO  JP-RECORD-AREA.
  6640
  6641
  6642* EXEC CICS  ENDBR
  6643*        DATASET  (PLAN-FILE-ID)
  6644*    END-EXEC.
  6645     MOVE 0
  6646       TO DFHEIV11
  6647*    MOVE '&2                    $   #00006251' TO DFHEIV0
  6648     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6649     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6650     MOVE X'2020233030303036323531' TO DFHEIV0(25:11)
  6651     CALL 'kxdfhei1' USING DFHEIV0,
  6652           PLAN-FILE-ID,
  6653           DFHEIV11,
  6654           DFHEIV99
  6655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6656
  6657
  6658
  6659* EXEC CICS GETMAIN
  6660*        LENGTH   (PLAN-REC-LEN)
  6661*        SET      (ADDRESS OF PLAN-MASTER)
  6662*        INITIMG  (GETMAIN-SPACE)
  6663*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL650.cbl
  6664*    MOVE ',"IL                  $   #00006255' TO DFHEIV0
  6665     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6666     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6667     MOVE X'2020233030303036323535' TO DFHEIV0(25:11)
  6668     CALL 'kxdfhei1' USING DFHEIV0,
  6669           DFHEIV20,
  6670           PLAN-REC-LEN,
  6671           GETMAIN-SPACE
  6672     SET ADDRESS OF PLAN-MASTER TO
  6673         DFHEIV20
  6674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6675
  6676
  6677     MOVE JP-RECORD-AREA         TO PLAN-MASTER.
  6678
  6679
  6680* EXEC CICS  WRITE
  6681*        DATASET  (PLAN-FILE-ID)
  6682*        RIDFLD   (PL-CONTROL-PRIMARY)
  6683*        FROM     (PLAN-MASTER)
  6684*    END-EXEC.
  6685     MOVE LENGTH OF
  6686      PLAN-MASTER
  6687       TO DFHEIV11
  6688*    MOVE '&$ L                  ''   #00006263' TO DFHEIV0
  6689     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6690     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6691     MOVE X'2020233030303036323633' TO DFHEIV0(25:11)
  6692     CALL 'kxdfhei1' USING DFHEIV0,
  6693           PLAN-FILE-ID,
  6694           PLAN-MASTER,
  6695           DFHEIV11,
  6696           PL-CONTROL-PRIMARY,
  6697           DFHEIV99,
  6698           DFHEIV99
  6699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6700
  6701
  6702     PERFORM 4700-STARTBR-PLAN  THRU 4700-EXIT.
  6703     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6704
  6705     GO TO 4610-READ-NEXT.
  6706
  6707 4689-EOF.
  6708
  6709* EXEC CICS  ENDBR
  6710*        DATASET  (PLAN-FILE-ID)
  6711*    END-EXEC.
  6712     MOVE 0
  6713       TO DFHEIV11
  6714*    MOVE '&2                    $   #00006275' TO DFHEIV0
  6715     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6716     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6717     MOVE X'2020233030303036323735' TO DFHEIV0(25:11)
  6718     CALL 'kxdfhei1' USING DFHEIV0,
  6719           PLAN-FILE-ID,
  6720           DFHEIV11,
  6721           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL650.cbl
  6722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6723
  6724
  6725 4699-EXIT.
  6726      EXIT.
  6727
  6728 4700-STARTBR-PLAN.
  6729
  6730* EXEC CICS  STARTBR
  6731*        DATASET  (PLAN-FILE-ID)
  6732*        RIDFLD   (WS-PLAN-KEY)
  6733*    END-EXEC.
  6734     MOVE 0
  6735       TO DFHEIV11
  6736*    MOVE '&,         G          &   #00006283' TO DFHEIV0
  6737     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6738     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6739     MOVE X'2020233030303036323833' TO DFHEIV0(25:11)
  6740     CALL 'kxdfhei1' USING DFHEIV0,
  6741           PLAN-FILE-ID,
  6742           WS-PLAN-KEY,
  6743           DFHEIV99,
  6744           DFHEIV11,
  6745           DFHEIV99
  6746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6747
  6748
  6749 4700-EXIT.
  6750      EXIT.
  6751
  6752 4710-READNEXT-PLAN.
  6753
  6754* EXEC CICS  READNEXT
  6755*        DATASET  (PLAN-FILE-ID)
  6756*        SET      (ADDRESS OF PLAN-MASTER)
  6757*        RIDFLD   (WS-PLAN-KEY)
  6758*    END-EXEC.
  6759     MOVE 0
  6760       TO DFHEIV11
  6761*    MOVE '&.S                   )   #00006292' TO DFHEIV0
  6762     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6763     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6764     MOVE X'2020233030303036323932' TO DFHEIV0(25:11)
  6765     CALL 'kxdfhei1' USING DFHEIV0,
  6766           PLAN-FILE-ID,
  6767           DFHEIV20,
  6768           DFHEIV99,
  6769           WS-PLAN-KEY,
  6770           DFHEIV99,
  6771           DFHEIV11,
  6772           DFHEIV99,
  6773           DFHEIV99
  6774     SET ADDRESS OF PLAN-MASTER TO
  6775         DFHEIV20
  6776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6777
  6778
  6779 4710-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL650.cbl
  6780      EXIT.
  6781
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL650.cbl
  6783 4800-DELETE-PLAN-REC.
  6784
  6785* EXEC CICS  HANDLE CONDITION
  6786*        NOTFND   (4899-EXIT)
  6787*        ENDFILE  (4889-EOF)
  6788*    END-EXEC.
  6789*    MOVE '"$I''                  ! * #00006303' TO DFHEIV0
  6790     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6792     MOVE X'2A20233030303036333033' TO DFHEIV0(25:11)
  6793     CALL 'kxdfhei1' USING DFHEIV0
  6794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6795
  6796
  6797     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6798     MOVE AM-CONTROL-PRIMARY    TO EK-CCGSA-KEY
  6799                                   PI-PREV-ACCOUNT.
  6800
  6801 4805-STARTBR.
  6802     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6803
  6804 4810-READ-NEXT.
  6805     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6806
  6807     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6808         GO TO 4889-EOF.
  6809
  6810
  6811* EXEC CICS  ENDBR
  6812*        DATASET  (PLAN-FILE-ID)
  6813*    END-EXEC.
  6814     MOVE 0
  6815       TO DFHEIV11
  6816*    MOVE '&2                    $   #00006321' TO DFHEIV0
  6817     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6818     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6819     MOVE X'2020233030303036333231' TO DFHEIV0(25:11)
  6820     CALL 'kxdfhei1' USING DFHEIV0,
  6821           PLAN-FILE-ID,
  6822           DFHEIV11,
  6823           DFHEIV99
  6824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6825
  6826
  6827
  6828* EXEC CICS  READ
  6829*        UPDATE
  6830*        DATASET  (PLAN-FILE-ID)
  6831*        SET      (ADDRESS OF PLAN-MASTER)
  6832*        RIDFLD   (WS-PLAN-KEY)
  6833*    END-EXEC.
  6834*    MOVE '&"S        EU         (   #00006325' TO DFHEIV0
  6835     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6836     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6837     MOVE X'2020233030303036333235' TO DFHEIV0(25:11)
  6838     CALL 'kxdfhei1' USING DFHEIV0,
  6839           PLAN-FILE-ID,
  6840           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL650.cbl
  6841           DFHEIV99,
  6842           WS-PLAN-KEY,
  6843           DFHEIV99,
  6844           DFHEIV99,
  6845           DFHEIV99
  6846     SET ADDRESS OF PLAN-MASTER TO
  6847         DFHEIV20
  6848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6849
  6850
  6851
  6852* EXEC CICS  DELETE
  6853*        DATASET  (PLAN-FILE-ID)
  6854*    END-EXEC.
  6855*    MOVE '&(                    &   #00006332' TO DFHEIV0
  6856     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6857     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6858     MOVE X'2020233030303036333332' TO DFHEIV0(25:11)
  6859     CALL 'kxdfhei1' USING DFHEIV0,
  6860           PLAN-FILE-ID,
  6861           DFHEIV99,
  6862           DFHEIV99,
  6863           DFHEIV99,
  6864           DFHEIV99
  6865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6866
  6867
  6868     GO TO 4805-STARTBR.
  6869
  6870 4889-EOF.
  6871
  6872* EXEC CICS  ENDBR
  6873*        DATASET  (PLAN-FILE-ID)
  6874*    END-EXEC.
  6875     MOVE 0
  6876       TO DFHEIV11
  6877*    MOVE '&2                    $   #00006339' TO DFHEIV0
  6878     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6880     MOVE X'2020233030303036333339' TO DFHEIV0(25:11)
  6881     CALL 'kxdfhei1' USING DFHEIV0,
  6882           PLAN-FILE-ID,
  6883           DFHEIV11,
  6884           DFHEIV99
  6885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6886
  6887
  6888 4899-EXIT.
  6889      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL650.cbl
  6891 4900-CREATE-NEW-ACCOUNT.
  6892     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  6893
  6894     SET T-INDEX                 TO  LINEI.
  6895
  6896     IF PI-2ND-PAGE
  6897         SET T-INDEX  UP  BY  8
  6898     ELSE
  6899     IF PI-3RD-PAGE
  6900         SET T-INDEX  UP  BY  16
  6901     ELSE
  6902     IF PI-LST-PAGE
  6903         SET T-INDEX  UP  BY  24.
  6904
  6905     IF EFFCHGL NOT =  ZERO
  6906         PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT
  6907       ELSE
  6908         MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-EFFCHG-SAVE.
  6909
  6910     IF EXPCHGL NOT =  ZERO
  6911         PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT
  6912       ELSE
  6913         MOVE PI-BIN-EXP-DT (T-INDEX)  TO  BIN-EXPCHG-SAVE.
  6914
  6915     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  6916
  6917     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  6918         MOVE -1                 TO  EXPCHGL
  6919         MOVE ER-1228            TO  EMI-ERROR
  6920         MOVE AL-UABON           TO  EXPCHGA
  6921         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6922
  6923     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  6924
  6925     IF EMI-ERROR  NOT = ZEROS
  6926         GO TO 8200-SEND-DATAONLY.
  6927
  6928     MOVE SPACES                 TO  GETMAIN-SW.
  6929
  6930     IF NOT EMI-NO-ERRORS
  6931         GO TO 8200-SEND-DATAONLY.
  6932
  6933     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6934         MOVE ER-0453            TO  EMI-ERROR
  6935         MOVE -1                 TO  MAINTL
  6936         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6937         GO TO 8200-SEND-DATAONLY.
  6938
  6939     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6940
  6941     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6942
  6943     PERFORM 4200-CHECK-VALIDITY  THRU  4299-EXIT
  6944         VARYING  WS-INDEX  FROM  +1  BY  +1
  6945            UNTIL WS-INDEX GREATER +32.
  6946
  6947     IF NOT EMI-NO-ERRORS
  6948         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL650.cbl
  6949
  6950     MOVE PI-PREV-ACCOUNT          TO  PI-ACCT-CCGSA-KEY.
  6951     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6952     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6953
  6954     PERFORM 6500-READ-ACCT     THRU  6599-EXIT.
  6955
  6956     MOVE LOW-VALUES             TO  AM-AR-HI-CERT-DATE
  6957     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  6958                                     AM-LO-CERT-DATE
  6959     MOVE ZEROS                  TO  AM-DCC-MAX-MARKETING-FEE
  6960     MOVE SPACES                 TO  AM-1ST-PROD-DATE
  6961                                     AM-PREV-DATES
  6962                                     AM-ORIG-DEALER-NO
  6963
  6964     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6965     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6966     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6967     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6968
  6969     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6970
  6971     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6972     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6973
  6974
  6975* EXEC CICS GETMAIN
  6976*        LENGTH   (ACCT-REC-LEN)
  6977*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6978*        INITIMG  (GETMAIN-SPACE)
  6979*    END-EXEC.
  6980*    MOVE ',"IL                  $   #00006429' TO DFHEIV0
  6981     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6982     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6983     MOVE X'2020233030303036343239' TO DFHEIV0(25:11)
  6984     CALL 'kxdfhei1' USING DFHEIV0,
  6985           DFHEIV20,
  6986           ACCT-REC-LEN,
  6987           GETMAIN-SPACE
  6988     SET ADDRESS OF ACCOUNT-MASTER TO
  6989         DFHEIV20
  6990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6991
  6992
  6993     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6994     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6995     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6996     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  6997     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  6998                                     AM-VG-EXPIRATION-DT.
  6999
  7000     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  7001
  7002
  7003* EXEC CICS  HANDLE CONDITION
  7004*        DUPREC   (4580-DUPREC)
  7005*        DUPKEY   (4580-DUPREC)
  7006*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL650.cbl
  7007*    MOVE '"$%$                  ! + #00006444' TO DFHEIV0
  7008     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7009     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7010     MOVE X'2B20233030303036343434' TO DFHEIV0(25:11)
  7011     CALL 'kxdfhei1' USING DFHEIV0
  7012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7013
  7014
  7015
  7016* EXEC CICS  WRITE
  7017*        DATASET  (PI-ACCT-ID)
  7018*        RIDFLD   (AM-CONTROL-PRIMARY)
  7019*        FROM     (ACCOUNT-MASTER)
  7020*    END-EXEC.
  7021     MOVE LENGTH OF
  7022      ACCOUNT-MASTER
  7023       TO DFHEIV11
  7024*    MOVE '&$ L                  ''   #00006449' TO DFHEIV0
  7025     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7026     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7027     MOVE X'2020233030303036343439' TO DFHEIV0(25:11)
  7028     CALL 'kxdfhei1' USING DFHEIV0,
  7029           PI-ACCT-ID,
  7030           ACCOUNT-MASTER,
  7031           DFHEIV11,
  7032           AM-CONTROL-PRIMARY,
  7033           DFHEIV99,
  7034           DFHEIV99
  7035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7036
  7037
  7038     MOVE PI-ACCT-ID             TO  FILE-ID.
  7039
  7040     PERFORM 8400-LOG-JOURNAL-RECORD.
  7041
  7042     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7043         NEXT SENTENCE
  7044     ELSE
  7045         PERFORM 4950-ADD-ERPLAN-RECORD THRU 4959-EXIT
  7046         PERFORM 4960-ADD-ERCOMP-RECORD THRU 4969-EXIT.
  7047
  7048 4580-DUPREC.
  7049     MOVE 1                  TO K-WITH-LINE-USED.
  7050     MOVE LOW-VALUES         TO EL650AI.
  7051
  7052     GO TO 4590-SHOW-NEW-ACCOUNT.
  7053
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL650.cbl
  7055 4950-ADD-ERPLAN-RECORD.
  7056
  7057* EXEC CICS GETMAIN
  7058*        LENGTH   (PLAN-REC-LEN)
  7059*        SET      (ADDRESS OF PLAN-MASTER)
  7060*        INITIMG  (GETMAIN-SPACE)
  7061*    END-EXEC.
  7062*    MOVE ',"IL                  $   #00006473' TO DFHEIV0
  7063     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7064     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7065     MOVE X'2020233030303036343733' TO DFHEIV0(25:11)
  7066     CALL 'kxdfhei1' USING DFHEIV0,
  7067           DFHEIV20,
  7068           PLAN-REC-LEN,
  7069           GETMAIN-SPACE
  7070     SET ADDRESS OF PLAN-MASTER TO
  7071         DFHEIV20
  7072     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7073
  7074
  7075
  7076* EXEC CICS  HANDLE CONDITION
  7077*        DUPREC   (4959-EXIT)
  7078*        DUPKEY   (4959-EXIT)
  7079*    END-EXEC.
  7080*    MOVE '"$%$                  ! , #00006479' TO DFHEIV0
  7081     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7082     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7083     MOVE X'2C20233030303036343739' TO DFHEIV0(25:11)
  7084     CALL 'kxdfhei1' USING DFHEIV0
  7085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7086
  7087
  7088     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  7089
  7090     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  7091     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  7092     MOVE EK-REVISION            TO  PL-REVISION-NO.
  7093
  7094     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  7095
  7096
  7097* EXEC CICS  WRITE
  7098*        DATASET  (PLAN-FILE-ID)
  7099*        RIDFLD   (PL-CONTROL-PRIMARY)
  7100*        FROM     (PLAN-MASTER)
  7101*    END-EXEC.
  7102     MOVE LENGTH OF
  7103      PLAN-MASTER
  7104       TO DFHEIV11
  7105*    MOVE '&$ L                  ''   #00006492' TO DFHEIV0
  7106     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7107     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7108     MOVE X'2020233030303036343932' TO DFHEIV0(25:11)
  7109     CALL 'kxdfhei1' USING DFHEIV0,
  7110           PLAN-FILE-ID,
  7111           PLAN-MASTER,
  7112           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL650.cbl
  7113           PL-CONTROL-PRIMARY,
  7114           DFHEIV99,
  7115           DFHEIV99
  7116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7117
  7118
  7119 4959-EXIT.
  7120     EXIT.
  7121
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL650.cbl
  7123 4960-ADD-ERCOMP-RECORD.
  7124
  7125* EXEC CICS GETMAIN
  7126*         LENGTH   (COMP-REC-LEN)
  7127*         SET      (ADDRESS OF COMPENSATION-MASTER)
  7128*         INITIMG  (GETMAIN-SPACE)
  7129*    END-EXEC.
  7130*    MOVE ',"IL                  $   #00006503' TO DFHEIV0
  7131     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7132     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7133     MOVE X'2020233030303036353033' TO DFHEIV0(25:11)
  7134     CALL 'kxdfhei1' USING DFHEIV0,
  7135           DFHEIV20,
  7136           COMP-REC-LEN,
  7137           GETMAIN-SPACE
  7138     SET ADDRESS OF COMPENSATION-MASTER TO
  7139         DFHEIV20
  7140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7141
  7142
  7143     MOVE SPACES                 TO COMPENSATION-MASTER.
  7144     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  7145                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  7146                   CO-OV30         CO-OV60      CO-OV90
  7147                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  7148                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  7149                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  7150                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  7151                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  7152                   CO-CURRENT-CUR     CO-CURRENT-OV30
  7153                   CO-CURRENT-OV60    CO-CURRENT-OV90
  7154                   CO-CURRENT-CUR-PMT
  7155                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  7156                   CO-ACT-YEAR        CO-ACT-MONTH
  7157                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  7158                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  7159                   CO-CURRENT-LAST-STMT-YEAR
  7160                   CO-CURRENT-LAST-STMT-MONTH
  7161                   CO-CURRENT-LAST-STMT-DAY
  7162                   CO-YTD-PAID-COM
  7163                   CO-YTD-PAID-OV co-ov120 co-current-ov120
  7164     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  7165     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  7166     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  7167     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  7168     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  7169
  7170     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  7171         MOVE ZEROS              TO CO-CARRIER
  7172     ELSE
  7173         MOVE AM-CARRIER         TO CO-CARRIER.
  7174
  7175     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  7176         MOVE ZEROS              TO CO-GROUPING
  7177     ELSE
  7178         MOVE AM-GROUPING        TO CO-GROUPING.
  7179
  7180     MOVE 'A'                    TO CO-TYPE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL650.cbl
  7181     MOVE AM-NAME                TO CO-ACCT-NAME.
  7182     MOVE AM-PERSON              TO CO-MAIL-NAME.
  7183     MOVE AM-ADDRS               TO CO-ADDR-1.
  7184*    MOVE AM-CITY                TO CO-ADDR-3.
  7185     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  7186     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  7187     MOVE AM-ZIP                 TO CO-ZIP.
  7188     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  7189     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  7190     MOVE AM-ID-NO               TO CO-SOC-SEC.
  7191
  7192     IF AM-REMIT-TO NOT = ZERO
  7193         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  7194       ELSE
  7195         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  7196
  7197     MOVE +0                      TO AGT-SUB.
  7198
  7199     PERFORM 4970-FIND-C-AGT THRU 4970-EXIT.
  7200
  7201     IF VALID-AGT-SW = 'Y'
  7202         NEXT SENTENCE
  7203     ELSE
  7204         GO TO 4969-EXIT.
  7205
  7206     IF CO-RESP-NO = CO-ACCOUNT
  7207         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  7208     ELSE
  7209         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  7210
  7211     IF PI-AR-PROCESSING
  7212        MOVE 'G'                   TO CO-AR-REPORTING
  7213        MOVE '1'                   TO CO-AR-BAL-LEVEL
  7214        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  7215        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  7216
  7217     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  7218        MOVE 'N'                   TO CO-AR-REPORTING.
  7219
  7220     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  7221        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  7222
  7223     PERFORM 4980-ADD-COMPENSATION-NAME THRU 4980-EXIT.
  7224
  7225
  7226* EXEC CICS HANDLE CONDITION
  7227*         DUPREC   (4969-EXIT)
  7228*         DUPKEY   (4969-EXIT)
  7229*    END-EXEC.
  7230*    MOVE '"$%$                  ! - #00006591' TO DFHEIV0
  7231     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7233     MOVE X'2D20233030303036353931' TO DFHEIV0(25:11)
  7234     CALL 'kxdfhei1' USING DFHEIV0
  7235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7236
  7237
  7238
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL650.cbl
  7239* EXEC CICS WRITE
  7240*        FROM      (COMPENSATION-MASTER)
  7241*        RIDFLD    (CO-CONTROL-PRIMARY)
  7242*        DATASET   (COMP-FILE-ID)
  7243*    END-EXEC.
  7244     MOVE LENGTH OF
  7245      COMPENSATION-MASTER
  7246       TO DFHEIV11
  7247*    MOVE '&$ L                  ''   #00006596' TO DFHEIV0
  7248     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7249     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7250     MOVE X'2020233030303036353936' TO DFHEIV0(25:11)
  7251     CALL 'kxdfhei1' USING DFHEIV0,
  7252           COMP-FILE-ID,
  7253           COMPENSATION-MASTER,
  7254           DFHEIV11,
  7255           CO-CONTROL-PRIMARY,
  7256           DFHEIV99,
  7257           DFHEIV99
  7258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7259
  7260
  7261 4969-EXIT.
  7262     EXIT.
  7263
  7264 4970-FIND-C-AGT.
  7265     ADD 1 TO  AGT-SUB.
  7266     IF AGT-SUB GREATER 10
  7267         MOVE 'N'                TO  VALID-AGT-SW
  7268         GO TO 4970-EXIT.
  7269
  7270     IF (AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F' OR 'S')
  7271         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  7272         MOVE 'Y'                TO  VALID-AGT-SW
  7273         GO TO 4970-EXIT
  7274     ELSE
  7275         GO TO 4970-FIND-C-AGT.
  7276
  7277 4970-EXIT.
  7278     EXIT.
  7279
  7280 4980-ADD-COMPENSATION-NAME.
  7281
  7282* EXEC CICS HANDLE CONDITION
  7283*         DUPREC   (4980-EXIT)
  7284*    END-EXEC.
  7285*    MOVE '"$%                   ! . #00006622' TO DFHEIV0
  7286     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7287     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7288     MOVE X'2E20233030303036363232' TO DFHEIV0(25:11)
  7289     CALL 'kxdfhei1' USING DFHEIV0
  7290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7291
  7292
  7293
  7294* EXEC CICS GETMAIN
  7295*         LENGTH   (NAME-REC-LEN)
  7296*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL650.cbl
  7297*         INITIMG  (GETMAIN-SPACE)
  7298*    END-EXEC.
  7299*    MOVE ',"IL                  $   #00006626' TO DFHEIV0
  7300     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7301     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7302     MOVE X'2020233030303036363236' TO DFHEIV0(25:11)
  7303     CALL 'kxdfhei1' USING DFHEIV0,
  7304           DFHEIV20,
  7305           NAME-REC-LEN,
  7306           GETMAIN-SPACE
  7307     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7308         DFHEIV20
  7309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7310
  7311
  7312     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7313     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7314     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7315     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7316     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7317     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7318     MOVE CO-ADDR-CITY           TO  NL-CITY
  7319     MOVE CO-ADDR-STATE          TO  NL-ST
  7320     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7321     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7322     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7323     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7324     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7325     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7326     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7327
  7328
  7329* EXEC CICS WRITE
  7330*        FROM      (NAME-LOOKUP-MASTER)
  7331*        RIDFLD    (NL-CONTROL-PRIMARY)
  7332*        DATASET   (NAME-FILE-ID)
  7333*    END-EXEC.
  7334     MOVE LENGTH OF
  7335      NAME-LOOKUP-MASTER
  7336       TO DFHEIV11
  7337*    MOVE '&$ L                  ''   #00006648' TO DFHEIV0
  7338     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7339     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7340     MOVE X'2020233030303036363438' TO DFHEIV0(25:11)
  7341     CALL 'kxdfhei1' USING DFHEIV0,
  7342           NAME-FILE-ID,
  7343           NAME-LOOKUP-MASTER,
  7344           DFHEIV11,
  7345           NL-CONTROL-PRIMARY,
  7346           DFHEIV99,
  7347           DFHEIV99
  7348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7349
  7350
  7351 4980-EXIT.
  7352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL650.cbl
  7354 5000-CREATE-NEW-RANGE.
  7355
  7356     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  7357     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  7358
  7359     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU 6000-EFF-EXIT.
  7360     PERFORM 6000-EDIT-EXPIRATION-DATE THRU 6000-EXP-EXIT.
  7361
  7362     SET T-INDEX TO PI-TOTAL-LINES.
  7363
  7364     PERFORM 600A-CHECK-HI-LO-DATES    THRU 600A-EXIT
  7365        VARYING T-INDEX FROM T-INDEX BY +1
  7366         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  7367
  7368     IF NOT EMI-NO-ERRORS
  7369         GO TO 8200-SEND-DATAONLY.
  7370
  7371     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7372     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7373
  7374     IF BIN-EFFCHG-SAVE NOT LESS BIN-EXPCHG-SAVE
  7375         MOVE -1                 TO  EFFCHGL EXPCHGL
  7376         MOVE AL-UANON           TO  EFFCHGA EXPCHGA
  7377         MOVE ER-2053            TO  EMI-ERROR
  7378         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7379
  7380     IF NOT EMI-NO-ERRORS
  7381         GO TO 8200-SEND-DATAONLY.
  7382
  7383***************************************************************
  7384*    NO EFFECTIVE DATE ENTERED, WILL USE CURRENT EXPIRATION   *
  7385*    DATE IF WITHIN LIMITS                                    *
  7386***************************************************************
  7387
  7388     IF EFFCHGL = ZERO
  7389         SET T-INDEX             TO  PI-TOTAL-LINES
  7390         IF PI-BIN-EXP-DT (T-INDEX)  =  HIGH-VALUES
  7391             MOVE ER-2060        TO  EMI-ERROR
  7392             MOVE -1             TO  EFFCHGL
  7393             MOVE AL-UABON       TO  EFFCHGA
  7394             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7395             GO TO 8200-SEND-DATAONLY
  7396         ELSE
  7397             IF PI-BIN-EXP-DT (T-INDEX) NOT LESS
  7398                    BIN-EXPCHG-SAVE
  7399                 MOVE ER-2061    TO  EMI-ERROR
  7400                 MOVE -1         TO  EXPCHGL
  7401                 MOVE AL-UABON   TO  EXPCHGA
  7402                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7403                 GO TO 8200-SEND-DATAONLY.
  7404
  7405     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7406
  7407     IF EFFCHGL = ZERO
  7408         MOVE PI-BIN-EXP-DT (T-INDEX)
  7409                                 TO WS-ACCT-EFF-DT (WS-INDEX)
  7410         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX)
  7411     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL650.cbl
  7412         MOVE BIN-EFFCHG-SAVE    TO WS-ACCT-EFF-DT (WS-INDEX)
  7413                                    WS-ACCT-EXP-DT (WS-INDEX - 1)
  7414         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX).
  7415
  7416     PERFORM 4300-VERIFY-INTEGRITY  THRU  4399-EXIT
  7417         VARYING  WS-INDEX  FROM  +1  BY  +1
  7418           UNTIL  WS-INDEX  GREATER +32.
  7419
  7420     IF NOT EMI-NO-ERRORS
  7421         GO TO 8200-SEND-DATAONLY.
  7422
  7423     IF EFFCHGL  =  ZEROS
  7424         MOVE PI-BIN-EXP-DT (T-INDEX)
  7425                                  TO  PI-ACCT-EXP-DT
  7426                                      BIN-EFFCHG-SAVE
  7427                                      DC-BIN-DATE-1
  7428         MOVE SPACE               TO  DC-OPTION-CODE
  7429         PERFORM 9700-DATE-CONVERSION
  7430***  Y2K PROJ 7744
  7431         MOVE DC-GREG-DATE-1-YMD  TO  WS-EFFCHG-SAVE
  7432         MOVE DC-ALPHA-CENTURY    TO  WS-EFFCHG-SAVE(4:2)
  7433         MOVE WS-EFFCHG-SAVE      TO  EFFCHG-SAVE
  7434
  7435         PERFORM 5020-READ-PREV-REC
  7436         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT
  7437         GO TO 5005-EXIT
  7438     END-IF.
  7439***  Y2K PROJ 7744
  7440
  7441     IF NOT EMI-NO-ERRORS
  7442         GO TO 8200-SEND-DATAONLY.
  7443
  7444     SET T-INDEX  TO  PI-TOTAL-LINES.
  7445
  7446*    IF (EFFCHGL GREATER THAN +0) AND
  7447*       (EXPCHGL GREATER THAN +0)
  7448*       IF (PI-BIN-EXP-DT (T-INDEX) EQUAL HIGH-VALUES) AND
  7449*          (BIN-EXPCHG-SAVE EQUAL HIGH-VALUES)
  7450*          NEXT SENTENCE
  7451*       ELSE
  7452*          GO TO 5006-FIND-EXP-DATE.
  7453*
  7454
  7455
  7456***************************************************************
  7457*    EFFECTIVE DATE ENTERED, WILL REPLACE CURRENT EXPIRATION  *
  7458*    DATE IF ALL NINES AND CREATE NEW RANGE                   *
  7459***************************************************************
  7460     SET T-INDEX  TO  PI-TOTAL-LINES.
  7461
  7462     IF BROWSE-STARTED-SW EQUAL 'Y'
  7463        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7464
  7465     IF PI-BIN-EXP-DT (T-INDEX)  = HIGH-VALUES
  7466         IF PI-BIN-EFF-DT (T-INDEX) NOT LESS BIN-EFFCHG-SAVE
  7467             MOVE ER-2063             TO  EMI-ERROR
  7468             MOVE -1                  TO  EFFCHGL
  7469             MOVE AL-UABON            TO  EFFCHGA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL650.cbl
  7470             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7471             GO TO 8200-SEND-DATAONLY
  7472         ELSE
  7473             MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  7474             MOVE LOW-VALUES              TO  PI-ACCT-REST-OF-EXP
  7475             MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7476             MOVE PI-BIN-EFF-DT (T-INDEX)
  7477                                      TO  B4-ACCT-EFF-DT
  7478             PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7479             MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7480                                          AM-VG-EXPIRATION-DT
  7481                                          PI-BIN-EXP-DT
  7482                                                    (T-INDEX)
  7483             MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7484             MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7485             PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7486             PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7487             PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7488             GO TO 5005-EXIT.
  7489
  7490***************************************************************
  7491*    EFFECTIVE DATE ENTERED, CHECK TO ENSURE EFFECTIVE        *
  7492*    DATE GREATER PREVIOUS EXPIRATION DATE                    *
  7493***************************************************************
  7494     SET T-INDEX  TO  PI-TOTAL-LINES.
  7495
  7496     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7497     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7498
  7499     IF BIN-EFFCHG-SAVE LESS PI-BIN-EXP-DT (T-INDEX)
  7500         PERFORM 5010-CHECK-VALID-NEW-RANGE  THRU  5010-EXIT
  7501     ELSE
  7502         PERFORM 5020-READ-PREV-REC
  7503         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT.
  7504
  7505 5005-EXIT.
  7506     MOVE SPACES                 TO  EFFCHGO
  7507                                     EXPCHGI.
  7508     MOVE AL-UANOF               TO  EFFCHGA
  7509                                     EXPCHGA.
  7510     MOVE ER-0000                TO  EMI-ERROR.
  7511
  7512     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7513
  7514     GO TO 7000-BUILD-OUTPUT-MAP.
  7515
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL650.cbl
  7517 5006-FIND-EXP-DATE.
  7518     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  7519                                     PI-ACCT-REST-OF-EXP.
  7520     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7521
  7522     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7523         VARYING  T-INDEX  FROM  +1  BY  +1
  7524           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EFFCHG-SAVE.
  7525
  7526     IF BIN-EFFCHG-SAVE > PI-BIN-EXP-DT (T-INDEX)
  7527        MOVE ER-1220             TO  EMI-ERROR
  7528        MOVE -1                  TO  EFFCHGL
  7529        MOVE AL-UABON            TO  EFFCHGA
  7530        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7531        GO TO         8200-SEND-DATAONLY.
  7532
  7533     IF (BIN-EFFCHG-SAVE > PI-BIN-EFF-DT (T-INDEX)) AND
  7534        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7535        PERFORM 5007-CREATE-SUB-DATE-RANGES THRU 5007-EXIT
  7536        MOVE 1 TO PI-PAGE-NUMBER
  7537        GO TO 1000-SHOW-ACCOUNT
  7538     ELSE
  7539     IF (BIN-EFFCHG-SAVE = PI-BIN-EFF-DT (T-INDEX)) AND
  7540        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7541        PERFORM 5008-CREATE-SUB-DATE-RANGES THRU 5008-EXIT
  7542        MOVE 1 TO PI-PAGE-NUMBER
  7543        GO TO 1000-SHOW-ACCOUNT
  7544     ELSE
  7545        MOVE ER-2051             TO  EMI-ERROR
  7546        MOVE -1                  TO  EFFCHGL
  7547        MOVE AL-UABON            TO  EFFCHGA
  7548        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7549        GO TO 8200-SEND-DATAONLY.
  7550
  7551 5006-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL650.cbl
  7553 5007-CREATE-SUB-DATE-RANGES.
  7554
  7555     IF BROWSE-STARTED-SW EQUAL 'Y'
  7556        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7557
  7558     IF NOT SYSTEM-MODIFY-CAP
  7559         MOVE 'UPDATE'           TO  SM-READ
  7560         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7561         MOVE ER-0070            TO  EMI-ERROR
  7562         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7563         GO TO 8100-SEND-INITIAL-MAP.
  7564
  7565
  7566* EXEC CICS GETMAIN
  7567*        LENGTH   (ACCT-REC-LEN)
  7568*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7569*        INITIMG  (GETMAIN-SPACE)
  7570*    END-EXEC.
  7571*    MOVE ',"IL                  $   #00006868' TO DFHEIV0
  7572     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7573     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7574     MOVE X'2020233030303036383638' TO DFHEIV0(25:11)
  7575     CALL 'kxdfhei1' USING DFHEIV0,
  7576           DFHEIV20,
  7577           ACCT-REC-LEN,
  7578           GETMAIN-SPACE
  7579     SET ADDRESS OF ACCOUNT-MASTER TO
  7580         DFHEIV20
  7581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7582
  7583
  7584
  7585* EXEC CICS  HANDLE CONDITION
  7586*        ENDFILE  (5007-EXIT)
  7587*        NOTFND   (5007-EXIT)
  7588*    END-EXEC.
  7589*    MOVE '"$''I                  ! / #00006874' TO DFHEIV0
  7590     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7592     MOVE X'2F20233030303036383734' TO DFHEIV0(25:11)
  7593     CALL 'kxdfhei1' USING DFHEIV0
  7594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7595
  7596
  7597     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7598     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7599
  7600
  7601* EXEC CICS  READ
  7602*        UPDATE
  7603*        DATASET  (PI-ACCT-ID)
  7604*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7605*        RIDFLD   (PI-ACCT-KEY)
  7606*    END-EXEC.
  7607*    MOVE '&"S        EU         (   #00006882' TO DFHEIV0
  7608     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7609     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7610     MOVE X'2020233030303036383832' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL650.cbl
  7611     CALL 'kxdfhei1' USING DFHEIV0,
  7612           PI-ACCT-ID,
  7613           DFHEIV20,
  7614           DFHEIV99,
  7615           PI-ACCT-KEY,
  7616           DFHEIV99,
  7617           DFHEIV99,
  7618           DFHEIV99
  7619     SET ADDRESS OF ACCOUNT-MASTER TO
  7620         DFHEIV20
  7621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7622
  7623
  7624     MOVE AM-CONTROL-PRIMARY     TO  SAVE-ACCT-KEY.
  7625     MOVE AM-EXPIRATION-DT       TO  SAVE-CURR-EXP-DT.
  7626     MOVE AM-EFFECTIVE-DT        TO  SAVE-CURR-EFF-DT.
  7627     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7628     MOVE AM-EXPIRATION-DT       TO  AF-ACCT-EFF-DT.
  7629     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7630     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7631     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7632     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7633
  7634     MOVE BIN-EXPCHG-SAVE     TO  AM-EFFECTIVE-DT
  7635                                  PI-BIN-EFF-DT (T-INDEX).
  7636
  7637* EXEC CICS  REWRITE
  7638*        FROM     (ACCOUNT-MASTER)
  7639*        DATASET  (PI-ACCT-ID)
  7640*    END-EXEC.
  7641     MOVE LENGTH OF
  7642      ACCOUNT-MASTER
  7643       TO DFHEIV11
  7644*    MOVE '&& L                  %   #00006901' TO DFHEIV0
  7645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7647     MOVE X'2020233030303036393031' TO DFHEIV0(25:11)
  7648     CALL 'kxdfhei1' USING DFHEIV0,
  7649           PI-ACCT-ID,
  7650           ACCOUNT-MASTER,
  7651           DFHEIV11,
  7652           DFHEIV99
  7653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7654
  7655
  7656
  7657* EXEC CICS SYNCPOINT
  7658*    END-EXEC.
  7659*    MOVE '6"                    !   #00006906' TO DFHEIV0
  7660     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7661     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7662     MOVE X'2020233030303036393036' TO DFHEIV0(25:11)
  7663     CALL 'kxdfhei1' USING DFHEIV0
  7664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7665
  7666
  7667     PERFORM 8400-LOG-JOURNAL-RECORD.
  7668     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL650.cbl
  7669     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7670     MOVE LOW-VALUES          TO  AM-CNTRL-B.
  7671     MOVE SAVE-CURR-EFF-DT    TO  PI-BIN-EFF-DT (T-INDEX)
  7672                                  AM-EFFECTIVE-DT.
  7673     MOVE BIN-EFFCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7674                                  AM-EXPIRATION-DT
  7675                                  AM-VG-EXPIRATION-DT.
  7676     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7677                                  PI-BIN-MAINT-DT (T-INDEX).
  7678     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7679     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7680     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7681     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7682                                  AM-PREV-DATES.
  7683     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7684
  7685
  7686* EXEC CICS  HANDLE CONDITION
  7687*        ENDFILE  (5007-EXIT)
  7688*        NOTFND   (5007-EXIT)
  7689*        DUPREC   (5007-EXIT)
  7690*        ILLOGIC  (5007-EXIT)
  7691*        INVREQ   (5007-EXIT)
  7692*    END-EXEC.
  7693*    MOVE '"$''I%38               ! 0 #00006927' TO DFHEIV0
  7694     MOVE X'222427492533382020202020' TO DFHEIV0(1:12)
  7695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7696     MOVE X'3020233030303036393237' TO DFHEIV0(25:11)
  7697     CALL 'kxdfhei1' USING DFHEIV0
  7698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7699
  7700
  7701     MOVE 'AM'                TO AM-RECORD-ID.
  7702
  7703     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7704     PERFORM 8400-LOG-JOURNAL-RECORD.
  7705     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7706
  7707     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7708     MOVE BIN-EFFCHG-SAVE     TO  AM-EFFECTIVE-DT
  7709                                  PI-BIN-EFF-DT (T-INDEX).
  7710     MOVE BIN-EXPCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7711                                  AM-EXPIRATION-DT
  7712                                  AM-VG-EXPIRATION-DT.
  7713     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7714                                  PI-BIN-MAINT-DT (T-INDEX).
  7715     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7716     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7717                                  AM-PREV-DATES.
  7718     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7719     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7720     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7721     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7722     PERFORM 8400-LOG-JOURNAL-RECORD.
  7723     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7724
  7725     MOVE ZERO                TO EFFCHGL
  7726                                 EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL650.cbl
  7727
  7728
  7729* EXEC CICS  HANDLE CONDITION
  7730*         NOTFND   (5015-NOT-FOUND)
  7731*         ENDFILE  (5015-NOT-FOUND)
  7732*    END-EXEC.
  7733*    MOVE '"$I''                  ! 1 #00006962' TO DFHEIV0
  7734     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7736     MOVE X'3120233030303036393632' TO DFHEIV0(25:11)
  7737     CALL 'kxdfhei1' USING DFHEIV0
  7738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7739
  7740
  7741 5007-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL650.cbl
  7743 5008-CREATE-SUB-DATE-RANGES.
  7744
  7745     IF BROWSE-STARTED-SW EQUAL 'Y'
  7746        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7747
  7748     IF NOT SYSTEM-MODIFY-CAP
  7749         MOVE 'UPDATE'           TO  SM-READ
  7750         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7751         MOVE ER-0070            TO  EMI-ERROR
  7752         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7753         GO TO 8100-SEND-INITIAL-MAP.
  7754
  7755     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7756     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7757     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  7758     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  7759
  7760     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  7761
  7762     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7763                                     AM-VG-EXPIRATION-DT
  7764                                     PI-BIN-EXP-DT (T-INDEX).
  7765     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7766                                     PI-BIN-MAINT-DT (T-INDEX).
  7767     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7768     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7769
  7770     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7771
  7772     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7773
  7774     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7775
  7776     IF T-INDEX = PI-TOTAL-LINES
  7777        MOVE ZERO             TO EFFCHGL
  7778                                 EXPCHGL
  7779        GO TO 5008-EXIT.
  7780
  7781     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  7782     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  7783     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7784
  7785     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  7786
  7787     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7788         VARYING  T-INDEX  FROM T-INDEX  BY  +1
  7789           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EXPCHG-SAVE.
  7790
  7791     IF BROWSE-STARTED-SW EQUAL 'Y'
  7792        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7793
  7794
  7795* EXEC CICS  READ
  7796*        UPDATE
  7797*        DATASET  (PI-ACCT-ID)
  7798*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7799*        RIDFLD   (PI-ACCT-KEY)
  7800*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL650.cbl
  7801*    MOVE '&"S        EU         (   #00007020' TO DFHEIV0
  7802     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7803     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7804     MOVE X'2020233030303037303230' TO DFHEIV0(25:11)
  7805     CALL 'kxdfhei1' USING DFHEIV0,
  7806           PI-ACCT-ID,
  7807           DFHEIV20,
  7808           DFHEIV99,
  7809           PI-ACCT-KEY,
  7810           DFHEIV99,
  7811           DFHEIV99,
  7812           DFHEIV99
  7813     SET ADDRESS OF ACCOUNT-MASTER TO
  7814         DFHEIV20
  7815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7816
  7817
  7818     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7819     MOVE ACCT-FILE-ID           TO  FILE-ID.
  7820     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7821
  7822     PERFORM 8400-LOG-JOURNAL-RECORD.
  7823
  7824     MOVE BIN-EXPCHG-SAVE        TO  AM-EFFECTIVE-DT
  7825                                     PI-BIN-EFF-DT (T-INDEX).
  7826     MOVE EXPCHG-SAVE            TO  AM-EFFECT-DT.
  7827     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7828                                     PI-BIN-MAINT-DT (T-INDEX).
  7829     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7830     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7831     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7832     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7833
  7834     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7835
  7836
  7837* EXEC CICS  REWRITE
  7838*        FROM     (ACCOUNT-MASTER)
  7839*        DATASET  (PI-ACCT-ID)
  7840*    END-EXEC.
  7841     MOVE LENGTH OF
  7842      ACCOUNT-MASTER
  7843       TO DFHEIV11
  7844*    MOVE '&& L                  %   #00007045' TO DFHEIV0
  7845     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7846     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7847     MOVE X'2020233030303037303435' TO DFHEIV0(25:11)
  7848     CALL 'kxdfhei1' USING DFHEIV0,
  7849           PI-ACCT-ID,
  7850           ACCOUNT-MASTER,
  7851           DFHEIV11,
  7852           DFHEIV99
  7853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7854
  7855
  7856     PERFORM 8400-LOG-JOURNAL-RECORD.
  7857
  7858     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL650.cbl
  7859
  7860
  7861
  7862     MOVE ZERO                TO EFFCHGL
  7863                                 EXPCHGL.
  7864
  7865
  7866* EXEC CICS  HANDLE CONDITION
  7867*         NOTFND   (5015-NOT-FOUND)
  7868*         ENDFILE  (5015-NOT-FOUND)
  7869*    END-EXEC.
  7870*    MOVE '"$I''                  ! 2 #00007059' TO DFHEIV0
  7871     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7873     MOVE X'3220233030303037303539' TO DFHEIV0(25:11)
  7874     CALL 'kxdfhei1' USING DFHEIV0
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7876
  7877
  7878 5008-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL650.cbl
  7880 5010-CHECK-VALID-NEW-RANGE.
  7881
  7882***************************************************************
  7883*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7884*    CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED        *
  7885***************************************************************
  7886
  7887     IF PI-AR-PROCESSING
  7888        GO TO 5010-CHECK-AR-VALID-NEW-RANGE.
  7889
  7890     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7891                        GREATER BIN-EFFCHG-SAVE          AND
  7892                        GREATER PI-BIN-HI-CERT (T-INDEX)
  7893         MOVE PI-BIN-EXP-DT (T-INDEX)
  7894                                  TO  PI-ACCT-EXP-DT
  7895         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7896         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7897         MOVE PI-BIN-EFF-DT (T-INDEX)
  7898                                  TO  B4-ACCT-EFF-DT
  7899         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7900         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7901                                      AM-VG-EXPIRATION-DT
  7902                                      PI-BIN-EXP-DT (T-INDEX)
  7903         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7904         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7905         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7906         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7907         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7908         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7909     ELSE
  7910         MOVE ER-2051             TO  EMI-ERROR
  7911         MOVE -1                  TO  EFFCHGL
  7912         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  7913         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7914         GO TO 8200-SEND-DATAONLY.
  7915
  7916     GO TO 5010-EXIT.
  7917
  7918 5010-CHECK-AR-VALID-NEW-RANGE.
  7919
  7920***************************************************************
  7921*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7922*    A/R CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED    *
  7923***************************************************************
  7924
  7925     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7926                        GREATER BIN-EFFCHG-SAVE          AND
  7927                        GREATER PI-BIN-AR-HI-CERT (T-INDEX)
  7928         MOVE PI-BIN-EXP-DT (T-INDEX)
  7929                                  TO  PI-ACCT-EXP-DT
  7930         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7931         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7932         MOVE PI-BIN-EFF-DT (T-INDEX)
  7933                                  TO  B4-ACCT-EFF-DT
  7934         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7935         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7936                                      AM-VG-EXPIRATION-DT
  7937                                      PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL650.cbl
  7938         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  7939         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7940         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7941         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7942         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7943         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7944     ELSE
  7945         MOVE ER-2051             TO  EMI-ERROR
  7946         MOVE -1                  TO  EFFCHGL
  7947         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  7948         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7949         GO TO 8200-SEND-DATAONLY.
  7950
  7951 5010-EXIT.
  7952     EXIT.
  7953
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL650.cbl
  7955 5015-NOT-FOUND.
  7956     MOVE ER-0226                TO  EMI-ERROR.
  7957     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7958     MOVE -1                 TO  MAINTL.
  7959     GO TO 8200-SEND-DATAONLY.
  7960
  7961 5015-EXIT.
  7962     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL650.cbl
  7964 5020-READ-PREV-REC.
  7965
  7966* EXEC CICS  READ
  7967*        DATASET  (PI-ACCT-ID)
  7968*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7969*        RIDFLD   (PI-ACCT-KEY)
  7970*    END-EXEC.
  7971*    MOVE '&"S        E          (   #00007151' TO DFHEIV0
  7972     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7973     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7974     MOVE X'2020233030303037313531' TO DFHEIV0(25:11)
  7975     CALL 'kxdfhei1' USING DFHEIV0,
  7976           PI-ACCT-ID,
  7977           DFHEIV20,
  7978           DFHEIV99,
  7979           PI-ACCT-KEY,
  7980           DFHEIV99,
  7981           DFHEIV99,
  7982           DFHEIV99
  7983     SET ADDRESS OF ACCOUNT-MASTER TO
  7984         DFHEIV20
  7985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7986
  7987
  7988 5050-CREATE-NEW-REC.
  7989     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  7990     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7991                                     AM-VG-EXPIRATION-DT.
  7992     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  7993     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE
  7994                                     AM-1ST-PROD-DATE
  7995                                     AM-PREV-DATES
  7996                                     AM-BILLING-STATUS.
  7997     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  7998                                     AM-LO-CERT-DATE.
  7999
  8000     IF AM-AR-HI-CERT-DATE NOT LESS THAN AM-EFFECTIVE-DT
  8001        NEXT SENTENCE
  8002     ELSE
  8003        MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE.
  8004
  8005     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  8006     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  8007     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  8008
  8009     SET T-INDEX  UP  BY  1.
  8010     IF T-INDEX  GREATER 32
  8011         MOVE ER-2062            TO  EMI-ERROR
  8012         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8013         MOVE -1                 TO  MAINTL
  8014         GO TO 8200-SEND-DATAONLY.
  8015
  8016     ADD 1                       TO  PI-TOTAL-LINES.
  8017
  8018     MOVE LOW-VALUES             TO  PI-TABLE-ENT    (T-INDEX).
  8019     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT   (T-INDEX).
  8020     MOVE BIN-EXPCHG-SAVE        TO  PI-BIN-EXP-DT   (T-INDEX).
  8021     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL650.cbl
  8022     MOVE BIN-CURRENT-SAVE       TO  PI-BIN-MAINT-DT (T-INDEX).
  8023
  8024     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  8025
  8026     MOVE 'A'                    TO  JP-RECORD-TYPE.
  8027     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  8028     MOVE ACCT-FILE-ID           TO  FILE-ID.
  8029
  8030
  8031* EXEC CICS  WRITE
  8032*        RIDFLD   (AM-CONTROL-PRIMARY)
  8033*        FROM     (ACCOUNT-MASTER)
  8034*        DATASET  (PI-ACCT-ID)
  8035*    END-EXEC.
  8036     MOVE LENGTH OF
  8037      ACCOUNT-MASTER
  8038       TO DFHEIV11
  8039*    MOVE '&$ L                  ''   #00007199' TO DFHEIV0
  8040     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8041     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8042     MOVE X'2020233030303037313939' TO DFHEIV0(25:11)
  8043     CALL 'kxdfhei1' USING DFHEIV0,
  8044           PI-ACCT-ID,
  8045           ACCOUNT-MASTER,
  8046           DFHEIV11,
  8047           AM-CONTROL-PRIMARY,
  8048           DFHEIV99,
  8049           DFHEIV99
  8050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8051
  8052
  8053     PERFORM 8400-LOG-JOURNAL-RECORD.
  8054
  8055     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  8056
  8057 5050-EXIT.
  8058     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL650.cbl
  8060 5100-FIND-NEXT-RANGE.
  8061     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8062
  8063     IF PI-TOTAL-LINES  = ZERO
  8064         GO TO 5210-NO-DATA.
  8065
  8066     IF PI-LST-PAGE
  8067       OR (PI-FST-PAGE AND PI-TOTAL-LINES NOT GREATER 8)
  8068       OR (PI-2ND-PAGE AND PI-TOTAL-LINES NOT GREATER 16)
  8069       OR (PI-3RD-PAGE AND PI-TOTAL-LINES NOT GREATER 24)
  8070         MOVE ER-2065            TO  EMI-ERROR
  8071         MOVE -1                 TO  MAINTL
  8072         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8073         GO TO 8200-SEND-DATAONLY.
  8074
  8075     IF PI-FST-PAGE
  8076         MOVE 2                  TO  PI-PAGE-NUMBER
  8077     ELSE
  8078     IF PI-2ND-PAGE
  8079         MOVE 3                  TO  PI-PAGE-NUMBER
  8080     ELSE
  8081     IF PI-3RD-PAGE
  8082         MOVE 4                  TO  PI-PAGE-NUMBER.
  8083
  8084     GO TO 7000-BUILD-OUTPUT-MAP.
  8085
  8086 5200-FIND-PREV-RANGE.
  8087     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8088
  8089     IF PI-TOTAL-LINES  =  ZERO
  8090         GO TO 5210-NO-DATA.
  8091
  8092     IF PI-FST-PAGE
  8093         MOVE ER-2066            TO  EMI-ERROR
  8094         MOVE -1                 TO  MAINTL
  8095         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8096         GO TO 8200-SEND-DATAONLY.
  8097
  8098     IF PI-2ND-PAGE
  8099         MOVE 1                  TO  PI-PAGE-NUMBER
  8100     ELSE
  8101     IF PI-3RD-PAGE
  8102         MOVE 2                  TO  PI-PAGE-NUMBER
  8103     ELSE
  8104     IF PI-LST-PAGE
  8105         MOVE 3                  TO  PI-PAGE-NUMBER.
  8106
  8107     GO TO 7000-BUILD-OUTPUT-MAP.
  8108
  8109 5210-NO-DATA.
  8110     MOVE ER-2069                TO  EMI-ERROR.
  8111     MOVE -1                     TO  MAINTL.
  8112
  8113     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8114
  8115     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL650.cbl
  8117 5300-FIND-NEXT-ACCOUNT.
  8118     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8119     MOVE 'Y'                    TO  FIRST-TIME-SW.
  8120
  8121     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8122         MOVE PI-COMPANY-CD      TO  PI-ACCT-CO
  8123     ELSE
  8124         PERFORM 6100-BUILD-KEY  THRU  6199-EXIT
  8125         MOVE HIGH-VALUES        TO  PI-ACCT-EXP-DT
  8126         MOVE LOW-VALUES         TO  PI-ACCT-REST-OF-EXP.
  8127
  8128     IF NOT EMI-NO-ERRORS
  8129         GO TO 8200-SEND-DATAONLY.
  8130
  8131
  8132* EXEC CICS  HANDLE CONDITION
  8133*        NOTFND   (5340-END)
  8134*        ENDFILE  (5330-NOT-FOUND)
  8135*    END-EXEC.
  8136*    MOVE '"$I''                  ! 3 #00007283' TO DFHEIV0
  8137     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8139     MOVE X'3320233030303037323833' TO DFHEIV0(25:11)
  8140     CALL 'kxdfhei1' USING DFHEIV0
  8141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8142
  8143
  8144 5305-START-BR.
  8145     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  8146
  8147     SET T-INDEX
  8148        TS-INDEX  TO  +1.
  8149
  8150     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  8151
  8152 5310-READ-NEXT.
  8153     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  8154
  8155     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8156         GO TO 5330-NOT-FOUND.
  8157
  8158     IF PI-CARRIER-SECURITY GREATER SPACES
  8159         IF PI-ACCT-CARRIER  =  PI-CARRIER-SECURITY
  8160             NEXT SENTENCE
  8161         ELSE
  8162             GO TO 5310-READ-NEXT.
  8163
  8164     IF FIRST-TIME
  8165         IF PI-ACCT-CCGSA-KEY  NOT = KEY-SAVE
  8166             MOVE SPACES             TO  FIRST-TIME-SW
  8167             MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE
  8168                                         PI-PREV-VG-ACCOUNT
  8169         ELSE
  8170             GO TO 5310-READ-NEXT.
  8171
  8172     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  8173         IF PI-COMPANY-CD  = PI-ACCT-CO
  8174             GO TO 5320-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL650.cbl
  8175         ELSE
  8176             MOVE ER-0066        TO  EMI-ERROR
  8177             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8178             MOVE -1             TO  MAINTL
  8179             GO TO 8200-SEND-DATAONLY.
  8180
  8181     IF PI-ACCT-CCGSA-KEY  = KEY-SAVE
  8182         GO TO 5320-DISPLAY-RECORD
  8183     ELSE
  8184         MOVE 1                  TO  PI-PAGE-NUMBER
  8185         GO TO 7000-BUILD-OUTPUT-MAP.
  8186
  8187 5320-DISPLAY-RECORD.
  8188     IF T-INDEX  = 1
  8189         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  8190         MOVE SPACE              TO  NAMEFLGO
  8191                                     PI-NAMEFLG.
  8192
  8193     IF AM-TRNTO-DTE  =  SPACES
  8194         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  8195
  8196     IF AM-TRNFROM-DTE  = SPACES
  8197         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  8198
  8199     IF T-INDEX  = 1
  8200         IF PI-COMPANY-ID  = 'LGX'  OR
  8201                             'MIC'  OR  'MCC'
  8202             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  8203             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  8204             MOVE SPACE              TO  DC-OPTION-CODE
  8205             PERFORM 9700-DATE-CONVERSION
  8206             IF DATE-CONVERSION-ERROR
  8207                 MOVE SPACES         TO  TRNTODTO
  8208             ELSE
  8209                 MOVE DC-GREG-DATE-1-EDIT
  8210                                     TO  TRNTODTO.
  8211
  8212     IF T-INDEX  = 1
  8213         IF PI-COMPANY-ID  =  'LGX'  OR
  8214                              'MIC'  OR  'MCC'
  8215             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  8216             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  8217             MOVE SPACE                TO  DC-OPTION-CODE
  8218             PERFORM 9700-DATE-CONVERSION
  8219             IF DATE-CONVERSION-ERROR
  8220                 MOVE SPACES           TO  TRNFRDTO
  8221             ELSE
  8222                 MOVE DC-GREG-DATE-1-EDIT
  8223                                       TO  TRNFRDTO.
  8224
  8225     IF NAMEO  NOT = LOW-VALUES
  8226         IF AM-NAME  NOT = NAMEO
  8227             MOVE '*'            TO  NAMEFLGO
  8228                                     PI-NAMEFLG.
  8229
  8230     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8231
  8232     IF T-INDEX  = 1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL650.cbl
  8233         MOVE AM-NAME                TO  NAMEO
  8234                                         PI-ACCNAME
  8235        ELSE
  8236         MOVE PI-ACCNAME             TO  NAMEO.
  8237
  8238     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  8239
  8240     GO TO 5310-READ-NEXT.
  8241
  8242 5330-NOT-FOUND.
  8243     IF BROWSE-STARTED
  8244         PERFORM 6320-ENDBR  THRU  6320-EXIT
  8245     ELSE
  8246         GO TO 5340-END.
  8247
  8248     IF PI-ACCT-ACCOUNT  = LOW-VALUE
  8249         MOVE ER-0472            TO  EMI-ERROR
  8250         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8251         MOVE -1                 TO  MAINTL
  8252         GO TO 8200-SEND-DATAONLY.
  8253
  8254     IF PI-ACCT-CCGSA-KEY  =  PI-PREV-ACCOUNT
  8255       AND  T-INDEX  NOT = 1
  8256         MOVE 1                  TO  PI-PAGE-NUMBER
  8257         GO TO 7000-BUILD-OUTPUT-MAP
  8258     ELSE
  8259         IF T-INDEX  NOT = 1
  8260             MOVE ER-0066        TO  EMI-ERROR
  8261             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8262             MOVE 1              TO  PI-PAGE-NUMBER
  8263             GO TO 7000-BUILD-OUTPUT-MAP.
  8264
  8265 5340-END.
  8266     MOVE ER-0066                TO  EMI-ERROR.
  8267
  8268     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8269
  8270     MOVE -1                     TO  MAINTL.
  8271
  8272     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL650.cbl
  8274 5400-FIND-PREV-ACCOUNT.
  8275     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8276         GO TO 5430-NOT-FOUND.
  8277
  8278     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8279     MOVE PI-BIN-EXP-DT (1)      TO  PI-ACCT-EXP-DT.
  8280     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  8281
  8282
  8283* EXEC CICS  HANDLE CONDITION
  8284*        NOTFND   (5440-NOT-FOUND)
  8285*        ENDFILE  (5430-NOT-FOUND)
  8286*    END-EXEC.
  8287*    MOVE '"$I''                  ! 4 #00007426' TO DFHEIV0
  8288     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8290     MOVE X'3420233030303037343236' TO DFHEIV0(25:11)
  8291     CALL 'kxdfhei1' USING DFHEIV0
  8292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8293
  8294
  8295
  8296* EXEC CICS  STARTBR
  8297*        DATASET  (PI-ACCT-ID)
  8298*        RIDFLD   (PI-ACCT-KEY)
  8299*    END-EXEC.
  8300     MOVE 0
  8301       TO DFHEIV11
  8302*    MOVE '&,         G          &   #00007431' TO DFHEIV0
  8303     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8304     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8305     MOVE X'2020233030303037343331' TO DFHEIV0(25:11)
  8306     CALL 'kxdfhei1' USING DFHEIV0,
  8307           PI-ACCT-ID,
  8308           PI-ACCT-KEY,
  8309           DFHEIV99,
  8310           DFHEIV11,
  8311           DFHEIV99
  8312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8313
  8314
  8315     MOVE 'Y'                    TO  BROWSE-STARTED-SW
  8316                                     FIRST-TIME-SW.
  8317 5410-READ-PREV.
  8318
  8319* EXEC CICS  READPREV
  8320*        DATASET  (PI-ACCT-ID)
  8321*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8322*        RIDFLD   (PI-ACCT-KEY)
  8323*    END-EXEC.
  8324     MOVE 0
  8325       TO DFHEIV11
  8326*    MOVE '&0S                   )   #00007439' TO DFHEIV0
  8327     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8329     MOVE X'2020233030303037343339' TO DFHEIV0(25:11)
  8330     CALL 'kxdfhei1' USING DFHEIV0,
  8331           PI-ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL650.cbl
  8332           DFHEIV20,
  8333           DFHEIV99,
  8334           PI-ACCT-KEY,
  8335           DFHEIV99,
  8336           DFHEIV11,
  8337           DFHEIV99,
  8338           DFHEIV99
  8339     SET ADDRESS OF ACCOUNT-MASTER TO
  8340         DFHEIV20
  8341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8342
  8343
  8344     IF FIRST-TIME
  8345         MOVE SPACE              TO  FIRST-TIME-SW
  8346         GO TO 5410-READ-PREV.
  8347
  8348     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8349         GO TO 5430-NOT-FOUND.
  8350
  8351     IF PI-CARRIER-SECURITY GREATER SPACES
  8352         IF PI-ACCT-CARRIER  = PI-CARRIER-SECURITY
  8353             NEXT SENTENCE
  8354         ELSE
  8355             GO TO 5410-READ-PREV.
  8356
  8357     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8358     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE
  8359                                     PI-PREV-VG-ACCOUNT.
  8360     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  8361                                     PI-ACCT-REST-OF-EXP
  8362                                     PI-DATE-RANGE-TABLE.
  8363
  8364     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  8365
  8366
  8367* EXEC CICS  ENDBR
  8368*        DATASET  (PI-ACCT-ID)
  8369*    END-EXEC.
  8370     MOVE 0
  8371       TO DFHEIV11
  8372*    MOVE '&2                    $   #00007467' TO DFHEIV0
  8373     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8375     MOVE X'2020233030303037343637' TO DFHEIV0(25:11)
  8376     CALL 'kxdfhei1' USING DFHEIV0,
  8377           PI-ACCT-ID,
  8378           DFHEIV11,
  8379           DFHEIV99
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8381
  8382
  8383     GO TO 5305-START-BR.
  8384
  8385 5430-NOT-FOUND.
  8386     IF BROWSE-STARTED
  8387         MOVE SPACE              TO  BROWSE-STARTED-SW
  8388
  8389* EXEC CICS  ENDBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL650.cbl
  8390*            DATASET  (PI-ACCT-ID)
  8391*        END-EXEC.
  8392     MOVE 0
  8393       TO DFHEIV11
  8394*    MOVE '&2                    $   #00007476' TO DFHEIV0
  8395     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303037343736' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           PI-ACCT-ID,
  8400           DFHEIV11,
  8401           DFHEIV99
  8402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8403
  8404
  8405     MOVE ER-0067                TO  EMI-ERROR.
  8406
  8407     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8408
  8409     MOVE -1                     TO  MAINTL.
  8410
  8411     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8412         GO TO 5300-FIND-NEXT-ACCOUNT.
  8413
  8414     GO TO 8200-SEND-DATAONLY.
  8415
  8416 5440-NOT-FOUND.
  8417     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8418
  8419     PERFORM 6310-READNEXT THRU 6310-EXIT.
  8420
  8421     GO TO 5410-READ-PREV.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL650.cbl
  8423 5500-ADD-NEW-AXRF-RECORD.
  8424     IF NOT PI-GA-BILLING
  8425         GO TO 5599-EXIT.
  8426
  8427     MOVE +1                     TO  AXRF-SUB.
  8428
  8429*    IF MAINTI  = 'K'
  8430*        IF GETMAIN-SW  = 'X'
  8431*            GO TO 5510-BUILD-AXRF-KEY.
  8432
  8433     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8434
  8435*    EXEC CICS  GETMAIN
  8436*        LENGTH   (ERGXRF-REC-LEN)
  8437*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8438*        INITIMG  (GETMAIN-SPACE)
  8439*    END-EXEC.
  8440*    display ' beginning of CP displays  '
  8441*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8442*    display ' address         ==   '
  8443*              address of agent-cross-reference
  8444*    display ' contents        ==   '  agent-cross-reference (1:1)
  8445*    display ' end       of CP displays  '
  8446
  8447*    MOVE 'X'                    TO  GETMAIN-SW.
  8448
  8449 5510-BUILD-AXRF-KEY.
  8450     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8451
  8452     IF AXRF-SUB  =  +11
  8453         GO TO 5599-EXIT.
  8454
  8455     IF AM-AGT (AXRF-SUB)  =  SPACES  OR ZEROS OR LOW-VALUES
  8456         ADD +1 TO AXRF-SUB
  8457         GO TO 5510-BUILD-AXRF-KEY.
  8458
  8459     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O' AND 'P'
  8460         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8461         ADD +1 TO AXRF-SUB
  8462         GO TO 5510-BUILD-AXRF-KEY.
  8463
  8464     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8465
  8466     IF PI-ZERO-CARRIER  OR
  8467        PI-ZERO-CAR-GROUP
  8468         MOVE ZERO               TO  WS-AXRF-CARRIER
  8469     ELSE
  8470         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8471
  8472     IF PI-ZERO-GROUPING  OR
  8473        PI-ZERO-CAR-GROUP
  8474         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8475     ELSE
  8476         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8477
  8478     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8479
  8480
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL650.cbl
  8481* EXEC CICS  HANDLE CONDITION
  8482*        ENDFILE  (5525-SKIP-REWRITE)
  8483*        NOTFND   (5525-SKIP-REWRITE)
  8484*    END-EXEC.
  8485*    MOVE '"$''I                  ! 5 #00007555' TO DFHEIV0
  8486     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8488     MOVE X'3520233030303037353535' TO DFHEIV0(25:11)
  8489     CALL 'kxdfhei1' USING DFHEIV0
  8490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8491
  8492
  8493
  8494* EXEC CICS  READ
  8495*        DATASET  (ERGXRF-FILE-ID)
  8496*        LENGTH   (ERGXRF-REC-LEN)
  8497*        INTO     (AGENT-CROSS-REFERENCE)
  8498*        RIDFLD   (WS-AXRF-KEY)
  8499*        EQUAL
  8500*        UPDATE
  8501*    END-EXEC.
  8502*    MOVE '&"IL       EU         (   #00007560' TO DFHEIV0
  8503     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8504     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8505     MOVE X'2020233030303037353630' TO DFHEIV0(25:11)
  8506     CALL 'kxdfhei1' USING DFHEIV0,
  8507           ERGXRF-FILE-ID,
  8508           AGENT-CROSS-REFERENCE,
  8509           ERGXRF-REC-LEN,
  8510           WS-AXRF-KEY,
  8511           DFHEIV99,
  8512           DFHEIV99,
  8513           DFHEIV99
  8514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8515
  8516
  8517     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8518     MOVE +1                     TO  GX-AGENT-SUB.
  8519
  8520     IF GX-AGENT-POINTER-CNT = +1006
  8521         GO TO 5525-SKIP-REWRITE.
  8522
  8523
  8524 5520-FIND-REC-LOCATION.
  8525     MOVE AM-COMPANY-CD          TO  GX-AM-COMPANY-CD.
  8526     MOVE GX-AGENT-POINTER (GX-AGENT-SUB)
  8527                                 TO  GX-REST-OF-KEY.
  8528     MOVE LOW-VALUES             TO  GX-AM-CNTL-FILLER.
  8529
  8530     IF GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY  OR
  8531        GX-AGENT-SUB          GREATER GX-AGENT-POINTER-CNT
  8532         NEXT SENTENCE
  8533     ELSE
  8534         ADD +1 TO GX-AGENT-SUB
  8535         GO TO 5520-FIND-REC-LOCATION.
  8536
  8537     MOVE GX-AGENT-POINTER-CNT   TO  COMM-WORK-SUB
  8538                                     COMM-WORK-SUB2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL650.cbl
  8539
  8540     ADD +1 TO COMM-WORK-SUB2.
  8541
  8542     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  8543         NEXT SENTENCE
  8544      ELSE
  8545         PERFORM 5530-BUMP-AXRF-REC
  8546             VARYING  COMM-WORK-SUB  FROM  COMM-WORK-SUB  BY  -1
  8547               UNTIL  COMM-WORK-SUB2 = GX-AGENT-SUB.
  8548
  8549     ADD ERGXRF-INC-LEN TO  ERGXRF-REC-LEN.
  8550     ADD  +1 TO  GX-AGENT-POINTER-CNT.
  8551
  8552     MOVE AM-CARRIER        TO  GX-AM-CARRIER   (COMM-WORK-SUB2).
  8553     MOVE AM-GROUPING       TO  GX-AM-GROUPING  (COMM-WORK-SUB2).
  8554     MOVE AM-STATE          TO  GX-AM-STATE     (COMM-WORK-SUB2).
  8555     MOVE AM-ACCOUNT        TO  GX-AM-ACCOUNT   (COMM-WORK-SUB2).
  8556     MOVE AM-EXPIRATION-DT  TO  GX-AM-EXPIRATION-DT
  8557                                                (COMM-WORK-SUB2).
  8558     MOVE AM-EFFECTIVE-DT   TO  GX-AM-EFF-DT    (COMM-WORK-SUB2).
  8559     MOVE AXRF-SUB          TO  GX-AM-LEVEL-NO  (COMM-WORK-SUB2).
  8560     MOVE LOW-VALUES        TO  GX-LAST-BILL-DT (COMM-WORK-SUB2).
  8561     MOVE BIN-CURRENT-SAVE  TO  GX-LAST-MAINT-DT.
  8562     MOVE EIBTIME           TO  GX-LAST-MAINT-HHMMSS.
  8563     MOVE PI-PROCESSOR-ID   TO  GX-LAST-MAINT-USER.
  8564     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  8565     if ergxrf-rec-len > +31264
  8566        move +31264          to ergxrf-rec-len
  8567        move +1006           to gx-agent-pointer-cnt
  8568     end-if
  8569
  8570
  8571* EXEC CICS  REWRITE
  8572*        FROM     (AGENT-CROSS-REFERENCE)
  8573*        LENGTH   (ERGXRF-REC-LEN)
  8574*        DATASET  (ERGXRF-FILE-ID)
  8575*    END-EXEC.
  8576*    MOVE '&& L                  %   #00007622' TO DFHEIV0
  8577     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8578     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8579     MOVE X'2020233030303037363232' TO DFHEIV0(25:11)
  8580     CALL 'kxdfhei1' USING DFHEIV0,
  8581           ERGXRF-FILE-ID,
  8582           AGENT-CROSS-REFERENCE,
  8583           ERGXRF-REC-LEN,
  8584           DFHEIV99
  8585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8586
  8587
  8588 5525-SKIP-REWRITE.
  8589
  8590     ADD +1 TO AXRF-SUB.
  8591
  8592     GO TO 5510-BUILD-AXRF-KEY.
  8593
  8594 5530-BUMP-AXRF-REC.
  8595     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8596                          TO  GX-AGENT-POINTER (COMM-WORK-SUB2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL650.cbl
  8597
  8598     SUBTRACT +1  FROM  COMM-WORK-SUB2.
  8599
  8600 5599-EXIT.
  8601     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL650.cbl
  8603 5600-CHG-AXRF-RECORDS.
  8604     IF NOT PI-GA-BILLING
  8605         GO TO 5699-EXIT.
  8606
  8607     MOVE +1                     TO  AXRF-SUB.
  8608     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8609
  8610*    IF GETMAIN-SW  = 'X'
  8611*        GO TO 5610-BUILD-AXRF-KEY.
  8612
  8613*    EXEC CICS  GETMAIN
  8614*        LENGTH   (ERGXRF-REC-LEN)
  8615*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8616*        INITIMG  (GETMAIN-SPACE)
  8617*    END-EXEC.
  8618*
  8619*    display ' beginning of CP displays  '
  8620*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8621*    display ' address         ==   '
  8622*              address of agent-cross-reference
  8623*    display ' contents        ==   '  agent-cross-reference (1:1)
  8624*    display ' end       of CP displays  '
  8625
  8626*    MOVE 'X'                    TO  GETMAIN-SW.
  8627
  8628 5610-BUILD-AXRF-KEY.
  8629     IF AXRF-SUB  = +11
  8630         GO TO 5699-EXIT.
  8631
  8632     IF AM-AGT (AXRF-SUB)  = SPACES OR ZEROS OR LOW-VALUES
  8633         ADD +1 TO AXRF-SUB
  8634         GO TO 5610-BUILD-AXRF-KEY.
  8635
  8636     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O'  AND  'P'
  8637         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8638         ADD +1 TO AXRF-SUB
  8639         GO TO 5610-BUILD-AXRF-KEY.
  8640
  8641     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8642     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8643
  8644     IF PI-ZERO-CARRIER OR
  8645        PI-ZERO-CAR-GROUP
  8646         MOVE ZERO               TO  WS-AXRF-CARRIER
  8647     ELSE
  8648         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8649
  8650     IF PI-ZERO-GROUPING  OR
  8651        PI-ZERO-CAR-GROUP
  8652         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8653     ELSE
  8654         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8655
  8656     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8657
  8658
  8659* EXEC CICS  HANDLE CONDITION
  8660*        ENDFILE  (5615-SKIP-REWRITE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL650.cbl
  8661*        NOTFND   (5615-SKIP-REWRITE)
  8662*    END-EXEC.
  8663*    MOVE '"$''I                  ! 6 #00007698' TO DFHEIV0
  8664     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8666     MOVE X'3620233030303037363938' TO DFHEIV0(25:11)
  8667     CALL 'kxdfhei1' USING DFHEIV0
  8668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8669
  8670
  8671
  8672* EXEC CICS  READ
  8673*        DATASET  (ERGXRF-FILE-ID)
  8674*        LENGTH   (ERGXRF-REC-LEN)
  8675*        INTO     (AGENT-CROSS-REFERENCE)
  8676*        RIDFLD   (WS-AXRF-KEY)
  8677*        EQUAL
  8678*        UPDATE
  8679*    END-EXEC.
  8680*    MOVE '&"IL       EU         (   #00007703' TO DFHEIV0
  8681     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8682     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8683     MOVE X'2020233030303037373033' TO DFHEIV0(25:11)
  8684     CALL 'kxdfhei1' USING DFHEIV0,
  8685           ERGXRF-FILE-ID,
  8686           AGENT-CROSS-REFERENCE,
  8687           ERGXRF-REC-LEN,
  8688           WS-AXRF-KEY,
  8689           DFHEIV99,
  8690           DFHEIV99,
  8691           DFHEIV99
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8693
  8694
  8695     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8696
  8697     PERFORM VARYING GX-AGENT-SUB FROM +1 BY +1
  8698             UNTIL
  8699       (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT)
  8700            OR
  8701       (GX-AM-ACCOUNT       (GX-AGENT-SUB) = B4-ACCT-ACCOUNT  AND
  8702        GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = B4-ACCT-EXP-DT   AND
  8703        GX-AM-EFF-DT        (GX-AGENT-SUB) = B4-ACCT-EFF-DT   AND
  8704        GX-AM-CARRIER       (GX-AGENT-SUB) = B4-ACCT-CARRIER  AND
  8705        GX-AM-GROUPING      (GX-AGENT-SUB) = B4-ACCT-GROUPING AND
  8706        GX-AM-STATE         (GX-AGENT-SUB) = B4-ACCT-STATE)
  8707     END-PERFORM.
  8708
  8709     IF MAINTI  = 'D'
  8710        IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8711            MOVE GX-AGENT-SUB    TO  COMM-WORK-SUB
  8712            PERFORM 5630-BUMP-RECORDS
  8713                VARYING  GX-AGENT-SUB  FROM  GX-AGENT-SUB  BY  +1
  8714                  UNTIL  GX-AGENT-SUB  = GX-AGENT-POINTER-CNT
  8715            SUBTRACT ERGXRF-INC-LEN  FROM  ERGXRF-REC-LEN
  8716            SUBTRACT +1              FROM  GX-AGENT-POINTER-CNT
  8717            GO TO 5615-REWRITE-AXRF-RECORD.
  8718
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL650.cbl
  8719     IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8720        MOVE AF-ACCT-EFF-DT  TO GX-AM-EFF-DT        (GX-AGENT-SUB)
  8721        MOVE AF-ACCT-EXP-DT  TO GX-AM-EXPIRATION-DT (GX-AGENT-SUB)
  8722        MOVE AXRF-SUB        TO GX-AM-LEVEL-NO      (GX-AGENT-SUB)
  8723        GO TO 5615-REWRITE-AXRF-RECORD.
  8724
  8725
  8726* EXEC CICS  UNLOCK
  8727*        DATASET  (ERGXRF-FILE-ID)
  8728*    END-EXEC.
  8729*    MOVE '&*                    #   #00007742' TO DFHEIV0
  8730     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8731     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8732     MOVE X'2020233030303037373432' TO DFHEIV0(25:11)
  8733     CALL 'kxdfhei1' USING DFHEIV0,
  8734           ERGXRF-FILE-ID,
  8735           DFHEIV99
  8736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8737
  8738
  8739     GO TO 5615-SKIP-REWRITE.
  8740
  8741 5615-REWRITE-AXRF-RECORD.
  8742     IF MAINTI  = 'D'
  8743       AND  GX-AGENT-POINTER-CNT  =  +0
  8744
  8745* EXEC CICS  DELETE
  8746*            DATASET  (ERGXRF-FILE-ID)
  8747*        END-EXEC
  8748*    MOVE '&(                    &   #00007751' TO DFHEIV0
  8749     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8750     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8751     MOVE X'2020233030303037373531' TO DFHEIV0(25:11)
  8752     CALL 'kxdfhei1' USING DFHEIV0,
  8753           ERGXRF-FILE-ID,
  8754           DFHEIV99,
  8755           DFHEIV99,
  8756           DFHEIV99,
  8757           DFHEIV99
  8758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8759     ELSE
  8760         MOVE BIN-CURRENT-SAVE   TO  GX-LAST-MAINT-DT
  8761         MOVE EIBTIME            TO  GX-LAST-MAINT-HHMMSS
  8762         MOVE PI-PROCESSOR-ID    TO  GX-LAST-MAINT-USER
  8763         compute ergxrf-rec-len =
  8764              (gx-agent-pointer-cnt * +31) + +78
  8765         if ergxrf-rec-len > +31264
  8766            move +31264          to ergxrf-rec-len
  8767            move +1006           to gx-agent-pointer-cnt
  8768         end-if
  8769
  8770* EXEC CICS  REWRITE
  8771*            FROM     (AGENT-CROSS-REFERENCE)
  8772*            LENGTH   (ERGXRF-REC-LEN)
  8773*            DATASET  (ERGXRF-FILE-ID)
  8774*        END-EXEC.
  8775*    MOVE '&& L                  %   #00007764' TO DFHEIV0
  8776     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL650.cbl
  8777     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8778     MOVE X'2020233030303037373634' TO DFHEIV0(25:11)
  8779     CALL 'kxdfhei1' USING DFHEIV0,
  8780           ERGXRF-FILE-ID,
  8781           AGENT-CROSS-REFERENCE,
  8782           ERGXRF-REC-LEN,
  8783           DFHEIV99
  8784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8785
  8786
  8787 5615-SKIP-REWRITE.
  8788     ADD +1  TO  AXRF-SUB.
  8789
  8790     GO TO 5610-BUILD-AXRF-KEY.
  8791
  8792 5630-BUMP-RECORDS.
  8793     ADD +1  TO  COMM-WORK-SUB.
  8794
  8795     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8796                            TO  GX-AGENT-POINTER (GX-AGENT-SUB).
  8797
  8798 5699-EXIT.
  8799     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL650.cbl
  8801 6000-EDIT-EFFECTIVE-DATE.
  8802     IF EFFCHGL  NOT =  ZEROS
  8803         MOVE EFFCHGI                  TO  WS-DT-DEEDIT-FIELD
  8804         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8805         MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8806         MOVE '4'                      TO  DC-OPTION-CODE
  8807         PERFORM 9700-DATE-CONVERSION
  8808         IF DATE-CONVERSION-ERROR
  8809             MOVE ER-0348              TO  EMI-ERROR
  8810             MOVE -1                   TO  EFFCHGL
  8811             MOVE AL-UABON             TO  EFFCHGA
  8812             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8813         ELSE
  8814             MOVE DC-GREG-DATE-1-EDIT  TO  EFFCHGI
  8815             MOVE AL-UANON             TO  EFFCHGA
  8816***  Y2K PROJ 7744
  8817             MOVE DC-GREG-DATE-1-YMD   TO  WS-EFFCHG-SAVE
  8818             MOVE DC-ALPHA-CENTURY     TO  WS-EFFCHG-SAVE(4:2)
  8819             MOVE WS-EFFCHG-SAVE       TO  EFFCHG-SAVE
  8820             MOVE DC-BIN-DATE-1        TO  BIN-EFFCHG-SAVE
  8821         END-IF
  8822***  Y2K PROJ 7744
  8823     ELSE
  8824         IF MAINTI  NOT = 'N'
  8825             MOVE ER-0216              TO  EMI-ERROR
  8826             MOVE -1                   TO  EFFCHGL
  8827             MOVE AL-UABON             TO  EFFCHGA
  8828             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8829
  8830 6000-EFF-EXIT.
  8831     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL650.cbl
  8833 6000-EDIT-EXPIRATION-DATE.
  8834***  Y2K PROJ 7744
  8835     IF EXPCHGL  NOT = ZEROS
  8836         MOVE EXPCHGI                  TO  WS-DT-DEEDIT-FIELD
  8837         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8838         IF WS-DEEDIT-FIELD-DATE-OUT NOT LESS 999999
  8839             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EXPCHGO
  8840             INSPECT EXPCHGI CONVERTING SPACES TO '/'
  8841             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8842             MOVE 99999999999              TO  EXPCHG-SAVE
  8843         ELSE
  8844             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8845             MOVE '4'                      TO  DC-OPTION-CODE
  8846             PERFORM 9700-DATE-CONVERSION
  8847             IF DATE-CONVERSION-ERROR
  8848                 MOVE ER-0454              TO  EMI-ERROR
  8849                 MOVE -1                   TO  EXPCHGL
  8850                 MOVE AL-UABON             TO  EXPCHGA
  8851                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8852             ELSE
  8853                 MOVE DC-GREG-DATE-1-EDIT  TO  EXPCHGI
  8854                 MOVE AL-UANON             TO  EXPCHGA
  8855                 MOVE DC-GREG-DATE-1-YMD   TO  WS-EXPCHG-SAVE
  8856                 MOVE DC-ALPHA-CENTURY     TO  WS-EXPCHG-SAVE(4:2)
  8857                 MOVE WS-EXPCHG-SAVE       TO  EXPCHG-SAVE
  8858                 MOVE DC-BIN-DATE-1        TO  BIN-EXPCHG-SAVE
  8859             END-IF
  8860         END-IF
  8861     ELSE
  8862         IF MAINTI  NOT =  'N'
  8863             MOVE ER-2058                  TO  EMI-ERROR
  8864             MOVE -1                       TO  EXPCHGL
  8865             MOVE AL-UABON                 TO  EXPCHGA
  8866             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8867         ELSE
  8868             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8869             MOVE 99999999999              TO  EXPCHG-SAVE
  8870         END-IF
  8871     END-IF.
  8872***  Y2K PROJ 7744
  8873
  8874 6000-EXP-EXIT.
  8875     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL650.cbl
  8877 6000-EDIT-LINE.
  8878     IF LINEL  = ZEROS
  8879         GO TO 6000-NO-LINE.
  8880
  8881     MOVE AL-UNNON               TO  LINEA.
  8882
  8883     IF LINEI NOT NUMERIC
  8884         GO TO 6000-LINE-ERROR.
  8885
  8886     IF LINEI LESS 1 OR GREATER 8 OR GREATER PI-TOTAL-LINES
  8887         GO TO 6000-LINE-ERROR.
  8888
  8889     MOVE PI-TOTAL-LINES         TO WS-PAGE-LINES.
  8890
  8891     IF PI-2ND-PAGE
  8892         SUBTRACT 8 FROM WS-PAGE-LINES
  8893     ELSE
  8894     IF PI-3RD-PAGE
  8895         SUBTRACT 16 FROM WS-PAGE-LINES
  8896     ELSE
  8897     IF PI-LST-PAGE
  8898         SUBTRACT 24 FROM WS-PAGE-LINES.
  8899
  8900     IF LINEI GREATER WS-PAGE-LINES
  8901         GO TO 6000-LINE-ERROR.
  8902
  8903     MOVE LINEI                  TO  PI-LINE-SELECTED.
  8904
  8905     GO TO 6000-LIN-EXIT.
  8906
  8907 6000-NO-LINE.
  8908     IF PI-TOTAL-LINES  = 1
  8909         MOVE 1                  TO  PI-LINE-SELECTED
  8910                                     LINEI
  8911         MOVE AL-UNNON           TO  LINEA
  8912         GO TO 6000-LIN-EXIT.
  8913
  8914 6000-LINE-ERROR.
  8915     MOVE ER-2064                TO  EMI-ERROR.
  8916     MOVE -1                     TO  LINEL.
  8917     MOVE AL-UABON               TO  LINEA.
  8918
  8919     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8920
  8921 6000-LIN-EXIT.
  8922     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL650.cbl
  8924 600A-CHECK-HI-LO-DATES.
  8925
  8926     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  8927         GO TO 600A-CHECK-AR-DATES.
  8928
  8929     IF BIN-EFFCHG-SAVE GREATER THAN PI-BIN-EFF-DT (T-INDEX)
  8930     IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  8931         MOVE ER-2113            TO  EMI-ERROR
  8932         MOVE -1                 TO  MAINTL
  8933         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8934
  8935*    IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  8936*        MOVE ER-2113            TO  EMI-ERROR
  8937*        MOVE -1                 TO  MAINTL
  8938*        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8939
  8940 600A-CHECK-AR-DATES.
  8941     IF NOT PI-AR-PROCESSING
  8942         GO TO 600A-EXIT.
  8943
  8944     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  8945        GO TO 600A-EXIT.
  8946
  8947     IF (PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  8948         MOVE ER-2113            TO  EMI-ERROR
  8949         MOVE -1                 TO  MAINTL
  8950         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8951
  8952 600A-EXIT.
  8953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL650.cbl
  8955 6010-DATE-CHECK.
  8956     IF MAINTI  = 'E'
  8957         GO TO 6010-CHECK-EFF.
  8958
  8959     IF PI-BIN-HI-CERT (T-INDEX)  NOT = LOW-VALUES
  8960         IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-HI-CERT (T-INDEX)
  8961             MOVE ER-2072        TO  EMI-ERROR
  8962             MOVE -1             TO  EXPCHGL
  8963             MOVE AL-UABON       TO  EXPCHGA
  8964             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8965
  8966     IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-EFF-DT (T-INDEX)
  8967         MOVE ER-2074            TO  EMI-ERROR
  8968         MOVE -1                 TO  EXPCHGL
  8969         MOVE AL-UABON           TO  EXPCHGA
  8970         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8971
  8972     GO TO 6010-EXIT.
  8973
  8974 6010-CHECK-EFF.
  8975     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES
  8976        IF (BIN-EFFCHG-SAVE >= PI-BIN-LO-CERT (T-INDEX))
  8977           AND (PI-PROCESSOR-ID NOT = 'PEMA')
  8978           MOVE ER-2073          TO EMI-ERROR
  8979           MOVE -1               TO EFFCHGL
  8980           MOVE AL-UABON         TO EFFCHGA
  8981           PERFORM 9900-ERROR-FORMAT
  8982                                 THRU 9900-EXIT
  8983        END-IF
  8984     END-IF
  8985
  8986     IF BIN-EFFCHG-SAVE NOT LESS PI-BIN-EXP-DT (T-INDEX)
  8987         MOVE ER-2075            TO  EMI-ERROR
  8988         MOVE -1                 TO  EFFCHGL
  8989         MOVE AL-UABON           TO  EFFCHGA
  8990         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8991
  8992 6010-EXIT.
  8993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL650.cbl
  8995 6100-BUILD-KEY.
  8996     MOVE LOW-VALUES             TO  PI-ACCT-KEY.
  8997     MOVE PI-COMPANY-CD          TO  PI-ACCT-CO.
  8998
  8999     IF ACARIERI  =  SPACES  OR  LOW-VALUES
  9000         IF MAINTI  = 'S'
  9001           OR  FIRST-TIME
  9002             MOVE SPACES         TO  PI-ACCT-CARRIER
  9003         ELSE
  9004             MOVE -1             TO  ACARIERL
  9005             MOVE ER-2059        TO  EMI-ERROR
  9006             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9007     ELSE
  9008         MOVE AL-UANON           TO  ACARIERA
  9009         MOVE ACARIERI           TO  PI-ACCT-CARRIER.
  9010
  9011     IF AGROUPI  =  SPACES  OR  LOW-VALUES
  9012         IF MAINTI  = 'S'
  9013           OR  FIRST-TIME
  9014             MOVE SPACES         TO  PI-ACCT-GROUPING
  9015         ELSE
  9016             MOVE -1             TO  AGROUPL
  9017             MOVE ER-2059        TO  EMI-ERROR
  9018             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9019     ELSE
  9020         IF AGROUPI  =  '0     '
  9021             MOVE -1             TO  AGROUPL
  9022             MOVE ER-0195        TO  EMI-ERROR
  9023             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9024         ELSE
  9025             MOVE AL-UANON       TO  AGROUPA
  9026             MOVE AGROUPI        TO  PI-ACCT-GROUPING.
  9027
  9028     IF ASTATEI  = SPACES  OR  LOW-VALUES
  9029         IF MAINTI  =  'S'
  9030           OR  FIRST-TIME
  9031             MOVE SPACES         TO  PI-ACCT-STATE
  9032         ELSE
  9033             MOVE -1             TO  ASTATEL
  9034             MOVE ER-2059        TO  EMI-ERROR
  9035             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9036     ELSE
  9037         MOVE AL-UANON           TO  ASTATEA
  9038         MOVE ASTATEI            TO  PI-ACCT-STATE.
  9039
  9040     IF AACCTI  = SPACES  OR  LOW-VALUES
  9041        IF MAINTI  = 'S'
  9042          OR  FIRST-TIME
  9043            MOVE SPACES          TO  PI-ACCT-ACCOUNT
  9044        ELSE
  9045            MOVE -1              TO  AACCTL
  9046            MOVE ER-2059         TO  EMI-ERROR
  9047            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9048     ELSE
  9049         MOVE AL-UANON           TO  AACCTA
  9050         MOVE AACCTI             TO  PI-ACCT-ACCOUNT.
  9051
  9052     IF PI-ACCT-CARRIER  = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL650.cbl
  9053       AND  (CARR-ACCNT-CNTL
  9054       OR   CARR-ST-ACCNT-CNTL
  9055       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9056         MOVE ER-0193            TO  EMI-ERROR
  9057         MOVE -1                 TO  ACARIERL
  9058         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9059
  9060     IF PI-ACCT-GROUPING  =  SPACES
  9061       AND  CARR-GROUP-ST-ACCNT-CNTL
  9062         MOVE ER-0195            TO  EMI-ERROR
  9063         MOVE -1                 TO  AGROUPL
  9064         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9065
  9066     IF PI-ACCT-STATE  = SPACES
  9067       AND  (ST-ACCNT-CNTL
  9068       OR   CARR-ST-ACCNT-CNTL
  9069       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9070         MOVE ER-0144            TO  EMI-ERROR
  9071         MOVE -1                 TO  ASTATEL
  9072         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9073
  9074     IF MAINTI  =  'S'
  9075       OR  FIRST-TIME
  9076         NEXT SENTENCE
  9077     ELSE
  9078         MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE.
  9079
  9080     IF NOT EMI-NO-ERRORS
  9081         IF EIBTRNID = EL6311-TRANS-ID
  9082             GO TO 8100-SEND-INITIAL-MAP
  9083           ELSE
  9084             GO TO 8200-SEND-DATAONLY.
  9085
  9086     IF PI-ACCT-CARRIER   = SPACES  OR
  9087        PI-ACCT-STATE     = SPACES  OR
  9088        PI-ACCT-GROUPING  = SPACES
  9089         MOVE ACCT2-FILE-ID      TO  PI-ACCT-ID
  9090     ELSE
  9091         MOVE ACCT-FILE-ID       TO  PI-ACCT-ID.
  9092
  9093     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  9094                                     PI-ACCT-REST-OF-EXP.
  9095
  9096 6199-EXIT.
  9097     EXIT.
  9098
  9099 6200-CHECK-KEY.
  9100     IF PI-PREV-ACCOUNT  NOT = PI-ACCT-CCGSA-KEY
  9101         MOVE ER-0453            TO  EMI-ERROR
  9102         MOVE -1                 TO  MAINTL
  9103         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9104
  9105 6200-EXIT.
  9106     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL650.cbl
  9108 6300-STARTBR.
  9109     MOVE ACCT-FILE-ID           TO  PI-ACCT-ID.
  9110
  9111
  9112* EXEC CICS  STARTBR
  9113*        DATASET  (PI-ACCT-ID)
  9114*        RIDFLD   (PI-ACCT-KEY)
  9115*    END-EXEC.
  9116     MOVE 0
  9117       TO DFHEIV11
  9118*    MOVE '&,         G          &   #00008094' TO DFHEIV0
  9119     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9120     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9121     MOVE X'2020233030303038303934' TO DFHEIV0(25:11)
  9122     CALL 'kxdfhei1' USING DFHEIV0,
  9123           PI-ACCT-ID,
  9124           PI-ACCT-KEY,
  9125           DFHEIV99,
  9126           DFHEIV11,
  9127           DFHEIV99
  9128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9129
  9130
  9131     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  9132     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  9133
  9134 6300-EXIT.
  9135     EXIT.
  9136
  9137 6310-READNEXT.
  9138
  9139* EXEC CICS  READNEXT
  9140*        DATASET  (PI-ACCT-ID)
  9141*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9142*        RIDFLD   (PI-ACCT-KEY)
  9143*    END-EXEC.
  9144     MOVE 0
  9145       TO DFHEIV11
  9146*    MOVE '&.S                   )   #00008106' TO DFHEIV0
  9147     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9148     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9149     MOVE X'2020233030303038313036' TO DFHEIV0(25:11)
  9150     CALL 'kxdfhei1' USING DFHEIV0,
  9151           PI-ACCT-ID,
  9152           DFHEIV20,
  9153           DFHEIV99,
  9154           PI-ACCT-KEY,
  9155           DFHEIV99,
  9156           DFHEIV11,
  9157           DFHEIV99,
  9158           DFHEIV99
  9159     SET ADDRESS OF ACCOUNT-MASTER TO
  9160         DFHEIV20
  9161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9162
  9163
  9164 6310-EXIT.
  9165     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL650.cbl
  9166
  9167 6320-ENDBR.
  9168     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  9169
  9170
  9171* EXEC CICS  ENDBR
  9172*        DATASET  (PI-ACCT-ID)
  9173*    END-EXEC.
  9174     MOVE 0
  9175       TO DFHEIV11
  9176*    MOVE '&2                    $   #00008118' TO DFHEIV0
  9177     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9178     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9179     MOVE X'2020233030303038313138' TO DFHEIV0(25:11)
  9180     CALL 'kxdfhei1' USING DFHEIV0,
  9181           PI-ACCT-ID,
  9182           DFHEIV11,
  9183           DFHEIV99
  9184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9185
  9186
  9187 6320-EXIT.
  9188     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL650.cbl
  9190 6400-BUILD-VG-KEY.
  9191     MOVE AM-CONTROL-PRIMARY     TO  AM-CONTROL-BY-VAR-GRP.
  9192
  9193     IF ST-ACCNT-CNTL
  9194         MOVE SPACES             TO  AM-VG-CARRIER
  9195                                     AM-VG-GROUPING.
  9196
  9197     IF CARR-ST-ACCNT-CNTL
  9198         MOVE SPACES             TO  AM-VG-GROUPING.
  9199
  9200     IF ACCNT-CNTL
  9201         MOVE SPACES             TO  AM-VG-CARRIER
  9202                                     AM-VG-STATE
  9203                                     AM-VG-GROUPING.
  9204
  9205     IF CARR-ACCNT-CNTL
  9206         MOVE SPACES             TO  AM-VG-STATE
  9207                                     AM-VG-GROUPING.
  9208
  9209 6499-EXIT.
  9210     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL650.cbl
  9212 6500-READ-ACCT.
  9213
  9214* EXEC CICS  HANDLE CONDITION
  9215*        NOTFND  (6599-EXIT)
  9216*    END-EXEC.
  9217*    MOVE '"$I                   ! 7 #00008148' TO DFHEIV0
  9218     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9220     MOVE X'3720233030303038313438' TO DFHEIV0(25:11)
  9221     CALL 'kxdfhei1' USING DFHEIV0
  9222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9223
  9224
  9225     MOVE ZERO                   TO  REC-SW.
  9226
  9227
  9228* EXEC CICS  READ
  9229*        GTEQ
  9230*        DATASET  (ACCT-FILE-ID)
  9231*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9232*        RIDFLD   (PI-ACCT-KEY)
  9233*    END-EXEC.
  9234*    MOVE '&"S        G          (   #00008154' TO DFHEIV0
  9235     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9236     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9237     MOVE X'2020233030303038313534' TO DFHEIV0(25:11)
  9238     CALL 'kxdfhei1' USING DFHEIV0,
  9239           ACCT-FILE-ID,
  9240           DFHEIV20,
  9241           DFHEIV99,
  9242           PI-ACCT-KEY,
  9243           DFHEIV99,
  9244           DFHEIV99,
  9245           DFHEIV99
  9246     SET ADDRESS OF ACCOUNT-MASTER TO
  9247         DFHEIV20
  9248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9249
  9250
  9251     MOVE AM-CONTROL-PRIMARY     TO  PI-ACCT-KEY.
  9252     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  9253
  9254     IF PI-ACCT-CCGSA-KEY  = NEW-KEY-SAVE
  9255         MOVE 1                  TO  REC-SW.
  9256
  9257 6599-EXIT.
  9258     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL650.cbl
  9260 6600-UPDATE-MAINT-DT.
  9261     MOVE SPACES                 TO  ELCNTL-KEY.
  9262     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9263     MOVE '1'                    TO  CNTL-REC-TYPE.
  9264     MOVE +0                     TO  CNTL-SEQ-NO.
  9265
  9266
  9267* EXEC CICS  HANDLE CONDITION
  9268*        NOTFND  (6699-EXIT)
  9269*    END-EXEC.
  9270*    MOVE '"$I                   ! 8 #00008176' TO DFHEIV0
  9271     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9272     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9273     MOVE X'3820233030303038313736' TO DFHEIV0(25:11)
  9274     CALL 'kxdfhei1' USING DFHEIV0
  9275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9276
  9277
  9278
  9279* EXEC CICS  READ
  9280*        UPDATE
  9281*        DATASET  (CNTL-FILE-ID)
  9282*        SET      (ADDRESS OF CONTROL-FILE)
  9283*        RIDFLD   (ELCNTL-KEY)
  9284*    END-EXEC.
  9285*    MOVE '&"S        EU         (   #00008180' TO DFHEIV0
  9286     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9287     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9288     MOVE X'2020233030303038313830' TO DFHEIV0(25:11)
  9289     CALL 'kxdfhei1' USING DFHEIV0,
  9290           CNTL-FILE-ID,
  9291           DFHEIV20,
  9292           DFHEIV99,
  9293           ELCNTL-KEY,
  9294           DFHEIV99,
  9295           DFHEIV99,
  9296           DFHEIV99
  9297     SET ADDRESS OF CONTROL-FILE TO
  9298         DFHEIV20
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9300
  9301
  9302     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9303     MOVE 'B'                    TO  JP-RECORD-TYPE.
  9304     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9305
  9306     PERFORM 8400-LOG-JOURNAL-RECORD.
  9307
  9308     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  9309     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9310     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9311     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9312
  9313
  9314* EXEC CICS  REWRITE
  9315*        DATASET  (CNTL-FILE-ID)
  9316*        FROM     (CONTROL-FILE)
  9317*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL650.cbl
  9318     MOVE LENGTH OF
  9319      CONTROL-FILE
  9320       TO DFHEIV11
  9321*    MOVE '&& L                  %   #00008198' TO DFHEIV0
  9322     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9323     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9324     MOVE X'2020233030303038313938' TO DFHEIV0(25:11)
  9325     CALL 'kxdfhei1' USING DFHEIV0,
  9326           CNTL-FILE-ID,
  9327           CONTROL-FILE,
  9328           DFHEIV11,
  9329           DFHEIV99
  9330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9331
  9332
  9333     PERFORM 8400-LOG-JOURNAL-RECORD.
  9334
  9335 6699-EXIT.
  9336     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL650.cbl
  9338 6700-VERIFY-STATE-CARRIER.
  9339     IF PI-ACCT-CARRIER  = SPACES
  9340         GO TO 6750-CHECK-STATE.
  9341
  9342     MOVE SPACES                 TO  ELCNTL-KEY.
  9343     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9344     MOVE '6'                    TO  CNTL-REC-TYPE.
  9345     MOVE PI-ACCT-CARRIER        TO  CNTL-CARRIER
  9346     MOVE +0                     TO  CNTL-SEQ-NO.
  9347
  9348
  9349* EXEC CICS  HANDLE CONDITION
  9350*        NOTFND  (6720-NO-CARRIER)
  9351*    END-EXEC.
  9352*    MOVE '"$I                   ! 9 #00008218' TO DFHEIV0
  9353     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9355     MOVE X'3920233030303038323138' TO DFHEIV0(25:11)
  9356     CALL 'kxdfhei1' USING DFHEIV0
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9358
  9359
  9360
  9361* EXEC CICS  READ
  9362*        DATASET  (CNTL-FILE-ID)
  9363*        SET      (ADDRESS OF CONTROL-FILE)
  9364*        RIDFLD   (ELCNTL-KEY)
  9365*    END-EXEC.
  9366*    MOVE '&"S        E          (   #00008222' TO DFHEIV0
  9367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9369     MOVE X'2020233030303038323232' TO DFHEIV0(25:11)
  9370     CALL 'kxdfhei1' USING DFHEIV0,
  9371           CNTL-FILE-ID,
  9372           DFHEIV20,
  9373           DFHEIV99,
  9374           ELCNTL-KEY,
  9375           DFHEIV99,
  9376           DFHEIV99,
  9377           DFHEIV99
  9378     SET ADDRESS OF CONTROL-FILE TO
  9379         DFHEIV20
  9380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9381
  9382
  9383     GO TO 6750-CHECK-STATE.
  9384
  9385 6720-NO-CARRIER.
  9386     MOVE ER-0193                TO  EMI-ERROR.
  9387     MOVE -1                     TO  ACARIERL.
  9388     MOVE AL-UABON               TO  ACARIERA.
  9389
  9390     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9391
  9392 6750-CHECK-STATE.
  9393     IF PI-ACCT-STATE  =  SPACES
  9394         GO TO 6799-EXIT.
  9395
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL650.cbl
  9396     MOVE SPACES                 TO  ELCNTL-KEY.
  9397     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9398     MOVE '3'                    TO  CNTL-REC-TYPE.
  9399     MOVE PI-ACCT-STATE          TO  CNTL-STATE.
  9400     MOVE +0                     TO  CNTL-SEQ-NO.
  9401
  9402
  9403* EXEC CICS  HANDLE CONDITION
  9404*        NOTFND  (6780-NO-STATE)
  9405*    END-EXEC.
  9406*    MOVE '"$I                   ! : #00008247' TO DFHEIV0
  9407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9409     MOVE X'3A20233030303038323437' TO DFHEIV0(25:11)
  9410     CALL 'kxdfhei1' USING DFHEIV0
  9411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9412
  9413
  9414
  9415* EXEC CICS  READ
  9416*        DATASET  (CNTL-FILE-ID)
  9417*        SET      (ADDRESS OF CONTROL-FILE)
  9418*        RIDFLD   (ELCNTL-KEY)
  9419*    END-EXEC.
  9420*    MOVE '&"S        E          (   #00008251' TO DFHEIV0
  9421     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9422     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9423     MOVE X'2020233030303038323531' TO DFHEIV0(25:11)
  9424     CALL 'kxdfhei1' USING DFHEIV0,
  9425           CNTL-FILE-ID,
  9426           DFHEIV20,
  9427           DFHEIV99,
  9428           ELCNTL-KEY,
  9429           DFHEIV99,
  9430           DFHEIV99,
  9431           DFHEIV99
  9432     SET ADDRESS OF CONTROL-FILE TO
  9433         DFHEIV20
  9434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9435
  9436
  9437     GO TO 6799-EXIT.
  9438
  9439 6780-NO-STATE.
  9440     MOVE ER-0144                TO  EMI-ERROR.
  9441     MOVE -1                     TO  ASTATEL.
  9442     MOVE AL-UABON               TO  ASTATEA.
  9443
  9444     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9445
  9446 6799-EXIT.
  9447     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL650.cbl
  9449 6800-COMPANY-REC-READ.
  9450     MOVE SPACES                 TO  ELCNTL-KEY.
  9451     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9452     MOVE '1'                    TO  CNTL-REC-TYPE.
  9453     MOVE +0                     TO  CNTL-SEQ-NO.
  9454
  9455
  9456* EXEC CICS  HANDLE CONDITION
  9457*        NOTFND  (6880-NO-COMP)
  9458*    END-EXEC.
  9459*    MOVE '"$I                   ! ; #00008275' TO DFHEIV0
  9460     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9462     MOVE X'3B20233030303038323735' TO DFHEIV0(25:11)
  9463     CALL 'kxdfhei1' USING DFHEIV0
  9464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9465
  9466
  9467
  9468* EXEC CICS  READ
  9469*        DATASET  (CNTL-FILE-ID)
  9470*        SET      (ADDRESS OF CONTROL-FILE)
  9471*        RIDFLD   (ELCNTL-KEY)
  9472*    END-EXEC.
  9473*    MOVE '&"S        E          (   #00008279' TO DFHEIV0
  9474     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9476     MOVE X'2020233030303038323739' TO DFHEIV0(25:11)
  9477     CALL 'kxdfhei1' USING DFHEIV0,
  9478           CNTL-FILE-ID,
  9479           DFHEIV20,
  9480           DFHEIV99,
  9481           ELCNTL-KEY,
  9482           DFHEIV99,
  9483           DFHEIV99,
  9484           DFHEIV99
  9485     SET ADDRESS OF CONTROL-FILE TO
  9486         DFHEIV20
  9487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9488
  9489
  9490     IF CF-ACCOUNT-MSTR-MAINT-DT  = LOW-VALUES
  9491         MOVE ER-2572            TO  EMI-ERROR
  9492         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9493
  9494     GO TO 6899-EXIT.
  9495
  9496 6880-NO-COMP.
  9497     MOVE ER-0022                TO  EMI-ERROR.
  9498
  9499     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9500
  9501 6899-EXIT.
  9502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL650.cbl
  9504 7000-BUILD-OUTPUT-MAP.
  9505     IF RETURNING-FROM-6501
  9506         MOVE PI-PREV-VG-ACCOUNT  TO  KEY-SAVE.
  9507
  9508     IF PI-COMPANY-ID  = 'LGX'  OR  'MIC'  OR  'MCC'
  9509         MOVE AL-SANOF           TO  TRNMSG1A
  9510                                     TRNMSG2A
  9511                                     TRNMSG3A
  9512                                     TRNMSG4A.
  9513
  9514     MOVE AL-UANON               TO  ACARIERA
  9515                                     AGROUPA
  9516                                     ASTATEA
  9517                                     AACCTA.
  9518     MOVE SV-CARRIER             TO  ACARIERO.
  9519     MOVE SV-GROUPING            TO  AGROUPO.
  9520     MOVE SV-STATE               TO  ASTATEO.
  9521     MOVE SV-ACCOUNT             TO  AACCTO.
  9522
  9523     SET M-INDEX  TO  1.
  9524
  9525     MOVE LOW-VALUES             TO  MAP-RECORD-AREA.
  9526
  9527     IF PI-MAINT  = 'A'
  9528       AND  PI-RECORD-NOT-CREATED
  9529         MOVE ER-2151            TO  EMI-ERROR
  9530         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9531         GO TO 7000-END.
  9532
  9533     IF PI-FST-PAGE
  9534         SET T-INDEX   TO  1
  9535     ELSE
  9536     IF PI-2ND-PAGE
  9537         SET T-INDEX   TO  9
  9538     ELSE
  9539     IF PI-3RD-PAGE
  9540         SET T-INDEX   TO  17
  9541     ELSE
  9542         SET T-INDEX   TO  25.
  9543
  9544 7000-LOOP.
  9545     IF PI-BIN-EXP-DT (T-INDEX)  NOT = HIGH-VALUES
  9546         MOVE PI-BIN-EXP-DT (T-INDEX)
  9547                                 TO  DC-BIN-DATE-1
  9548         MOVE SPACE              TO  DC-OPTION-CODE
  9549         PERFORM 9700-DATE-CONVERSION
  9550         IF DATE-CONVERSION-ERROR
  9551             MOVE SPACES         TO  MAP-EXP-DT (M-INDEX)
  9552         ELSE
  9553             MOVE DC-GREG-DATE-1-EDIT
  9554                                 TO  MAP-EXP-DT (M-INDEX)
  9555     ELSE
  9556         MOVE 999999             TO  MAP-EXP-DT-ED (M-INDEX)
  9557         INSPECT MAP-EXP-DT-ED (M-INDEX) CONVERTING SPACES TO '/'.
  9558
  9559     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  DC-BIN-DATE-1.
  9560     MOVE SPACE                    TO  DC-OPTION-CODE.
  9561
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL650.cbl
  9562     PERFORM 9700-DATE-CONVERSION.
  9563
  9564     IF DATE-CONVERSION-ERROR
  9565         MOVE SPACES               TO  MAP-EFF-DT (M-INDEX)
  9566     ELSE
  9567         MOVE DC-GREG-DATE-1-EDIT  TO  MAP-EFF-DT (M-INDEX).
  9568
  9569     IF PI-BIN-MAINT-DT (T-INDEX)  = LOW-VALUES
  9570         MOVE SPACES             TO  MAP-LST-MAINT-DT (M-INDEX)
  9571     ELSE
  9572         MOVE PI-BIN-MAINT-DT (T-INDEX)
  9573                                 TO  DC-BIN-DATE-1
  9574         MOVE SPACE              TO  DC-OPTION-CODE
  9575         PERFORM 9700-DATE-CONVERSION
  9576         IF DATE-CONVERSION-ERROR
  9577             MOVE SPACES         TO  MAP-LST-MAINT-DT (M-INDEX)
  9578         ELSE
  9579             MOVE DC-GREG-DATE-1-EDIT
  9580                                 TO  MAP-LST-MAINT-DT (M-INDEX).
  9581
  9582     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9583         MOVE SPACES             TO  MAP-HIGH-CERT (M-INDEX)
  9584     ELSE
  9585         MOVE PI-BIN-HI-CERT (T-INDEX)
  9586                                 TO  DC-BIN-DATE-1
  9587         MOVE SPACE              TO  DC-OPTION-CODE
  9588         PERFORM 9700-DATE-CONVERSION
  9589         IF DATE-CONVERSION-ERROR
  9590             MOVE SPACES         TO  MAP-HIGH-CERT (M-INDEX)
  9591         ELSE
  9592             MOVE DC-GREG-DATE-1-EDIT
  9593                                 TO  MAP-HIGH-CERT (M-INDEX).
  9594
  9595     IF PI-BIN-LO-CERT (T-INDEX)  = LOW-VALUES
  9596         MOVE SPACES             TO  MAP-LOW-CERT (M-INDEX)
  9597     ELSE
  9598         MOVE PI-BIN-LO-CERT (T-INDEX)
  9599                                 TO  DC-BIN-DATE-1
  9600         MOVE SPACE              TO  DC-OPTION-CODE
  9601         PERFORM 9700-DATE-CONVERSION
  9602         IF DATE-CONVERSION-ERROR
  9603             MOVE SPACES         TO  MAP-LOW-CERT (M-INDEX)
  9604         ELSE
  9605             MOVE DC-GREG-DATE-1-EDIT
  9606                                 TO  MAP-LOW-CERT (M-INDEX).
  9607
  9608     IF PI-BIN-AR-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  9609         MOVE SPACES             TO  MAP-AR-DATE (M-INDEX)
  9610     ELSE
  9611         MOVE PI-BIN-AR-HI-CERT (T-INDEX)
  9612                                 TO  DC-BIN-DATE-1
  9613         MOVE SPACE              TO  DC-OPTION-CODE
  9614         PERFORM 9700-DATE-CONVERSION
  9615         IF DATE-CONVERSION-ERROR
  9616             MOVE SPACES         TO  MAP-AR-DATE (M-INDEX)
  9617         ELSE
  9618             MOVE DC-GREG-DATE-1-EDIT
  9619                                 TO  MAP-AR-DATE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL650.cbl
  9620
  9621     IF M-INDEX  =  8  OR
  9622        T-INDEX  =  PI-TOTAL-LINES
  9623         NEXT SENTENCE
  9624     ELSE
  9625         SET M-INDEX
  9626             T-INDEX  UP  BY  1
  9627         GO TO 7000-LOOP.
  9628
  9629     IF M-INDEX  =  8
  9630       AND  T-INDEX  LESS THAN  PI-TOTAL-LINES
  9631         MOVE ER-0668            TO  EMI-ERROR
  9632         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9633
  9634     IF T-INDEX  =  PI-TOTAL-LINES
  9635         MOVE ER-0630            TO  EMI-ERROR
  9636         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9637
  9638 7000-END.
  9639     MOVE -1                     TO  MAINTL.
  9640     MOVE MAINTI                 TO  PI-MAINT.
  9641
  9642     IF MAINTI  = 'S'  OR  'D'
  9643       OR  RETURNING-FROM-6501
  9644         MOVE LOW-VALUES         TO  MAINTI
  9645         MOVE PI-ACCNAME         TO  NAMEO
  9646         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9647         GO TO 8100-SEND-INITIAL-MAP.
  9648
  9649     IF EIBAID  =  DFHPF1  OR  DFHPF2  OR
  9650                   DFHPF3  OR  DFHPF4
  9651         MOVE 'S'                TO  PI-MAINT
  9652         MOVE PI-ACCNAME         TO  NAMEO
  9653         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9654         GO TO 8100-SEND-INITIAL-MAP.
  9655
  9656     IF MAINTI  = 'N' OR 'E' OR 'X'
  9657        MOVE SPACES                 TO  BIN-EXPCHG-SAVE
  9658                                        BIN-EFFCHG-SAVE
  9659        MOVE SPACES                 TO  EFFCHGI
  9660                                        EXPCHGI
  9661        MOVE AL-UANOF               TO  EFFCHGA
  9662                                        EXPCHGA
  9663        MOVE SPACES                 TO  PI-MAINT
  9664        MOVE SPACES                 TO  MAINTI
  9665                                        MAINTO
  9666        MOVE AL-UANOF               TO  MAINTA.
  9667
  9668     IF K-WITH-LINE-NO
  9669         MOVE ZERO         TO K-WITH-LINE-USED
  9670         GO TO 8100-SEND-INITIAL-MAP.
  9671
  9672     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL650.cbl
  9674 7100-START-BROWSE.
  9675
  9676* EXEC CICS  STARTBR
  9677*        DATASET  (PI-ACCT-ID)
  9678*        RIDFLD   (PI-ACCT-KEY)
  9679*    END-EXEC.
  9680     MOVE 0
  9681       TO DFHEIV11
  9682*    MOVE '&,         G          &   #00008470' TO DFHEIV0
  9683     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9685     MOVE X'2020233030303038343730' TO DFHEIV0(25:11)
  9686     CALL 'kxdfhei1' USING DFHEIV0,
  9687           PI-ACCT-ID,
  9688           PI-ACCT-KEY,
  9689           DFHEIV99,
  9690           DFHEIV11,
  9691           DFHEIV99
  9692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9693
  9694
  9695 7100-EXIT.
  9696     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL650.cbl
  9698 7200-WRITE-TEMP-STORAGE.
  9699     PERFORM 7300-DELETE-TEMP-STORAGE  THRU  7300-EXIT.
  9700
  9701
  9702* EXEC CICS  HANDLE CONDITION
  9703*        ITEMERR  (7200-EXIT)
  9704*        QIDERR   (7200-EXIT)
  9705*    END-EXEC.
  9706*    MOVE '"$<N                  ! < #00008481' TO DFHEIV0
  9707     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9708     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9709     MOVE X'3C20233030303038343831' TO DFHEIV0(25:11)
  9710     CALL 'kxdfhei1' USING DFHEIV0
  9711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9712
  9713
  9714     MOVE +0                     TO  TS-ITEM.
  9715
  9716
  9717* EXEC CICS  WRITEQ TS
  9718*        QUEUE   (TS-QUEUE)
  9719*        FROM    (TEMP-STORAGE-RECORD)
  9720*        LENGTH  (TS-LENGTH)
  9721*        ITEM    (TS-ITEM)
  9722*    END-EXEC.
  9723*    MOVE '*" I                  ''   #00008488' TO DFHEIV0
  9724     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  9725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9726     MOVE X'2020233030303038343838' TO DFHEIV0(25:11)
  9727     CALL 'kxdfhei1' USING DFHEIV0,
  9728           TS-QUEUE,
  9729           TEMP-STORAGE-RECORD,
  9730           TS-LENGTH,
  9731           TS-ITEM,
  9732           DFHEIV99,
  9733           DFHEIV99
  9734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9735
  9736
  9737 7200-EXIT.
  9738     EXIT.
  9739
  9740 7300-DELETE-TEMP-STORAGE.
  9741
  9742* EXEC CICS  HANDLE CONDITION
  9743*        ITEMERR  (7300-EXIT)
  9744*        QIDERR   (7300-EXIT)
  9745*    END-EXEC.
  9746*    MOVE '"$<N                  ! = #00008499' TO DFHEIV0
  9747     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9748     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9749     MOVE X'3D20233030303038343939' TO DFHEIV0(25:11)
  9750     CALL 'kxdfhei1' USING DFHEIV0
  9751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9752
  9753
  9754
  9755* EXEC CICS  DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL650.cbl
  9756*        QUEUE  (TS-QUEUE)
  9757*    END-EXEC.
  9758*    MOVE '*&                    #   #00008504' TO DFHEIV0
  9759     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9760     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9761     MOVE X'2020233030303038353034' TO DFHEIV0(25:11)
  9762     CALL 'kxdfhei1' USING DFHEIV0,
  9763           TS-QUEUE,
  9764           DFHEIV99
  9765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9766
  9767
  9768 7300-EXIT.
  9769     EXIT.
  9770
  9771 7400-READ-TEMP-STORAGE.
  9772
  9773* EXEC CICS  HANDLE CONDITION
  9774*        ITEMERR  (7400-EXIT)
  9775*        QIDERR   (7400-EXIT)
  9776*    END-EXEC.
  9777*    MOVE '"$<N                  ! > #00008512' TO DFHEIV0
  9778     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9779     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9780     MOVE X'3E20233030303038353132' TO DFHEIV0(25:11)
  9781     CALL 'kxdfhei1' USING DFHEIV0
  9782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9783
  9784
  9785     MOVE +1                     TO  TS-ITEM.
  9786
  9787
  9788* EXEC CICS  READQ TS
  9789*        QUEUE   (TS-QUEUE)
  9790*        INTO    (TEMP-STORAGE-RECORD)
  9791*        LENGTH  (TS-LENGTH)
  9792*        ITEM    (TS-ITEM)
  9793*    END-EXEC.
  9794*    MOVE '*$II   L              ''   #00008519' TO DFHEIV0
  9795     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9796     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9797     MOVE X'2020233030303038353139' TO DFHEIV0(25:11)
  9798     CALL 'kxdfhei1' USING DFHEIV0,
  9799           TS-QUEUE,
  9800           TEMP-STORAGE-RECORD,
  9801           TS-LENGTH,
  9802           TS-ITEM,
  9803           DFHEIV99,
  9804           DFHEIV99
  9805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9806
  9807
  9808 7400-EXIT.
  9809     EXIT.
  9810
  9811 8100-SEND-INITIAL-MAP.
  9812     MOVE SAVE-DATE              TO  DATEO.
  9813     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL650.cbl
  9814     MOVE TIME-OUT               TO  TIMEO.
  9815     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9816     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9817     MOVE -1                     TO  MAINTL.
  9818     MOVE AL-UABON               TO  MAINTA.
  9819     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9820     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9821
  9822     IF PI-AR-PROCESSING
  9823        MOVE AL-PANOF            TO  ARHDGA.
  9824
  9825
  9826* EXEC CICS  SEND
  9827*        MAP     (MAP-NAME)
  9828*        MAPSET  (MAPSET-NAME)
  9829*        FROM    (EL650AO)
  9830*        ERASE
  9831*        CURSOR
  9832*    END-EXEC.
  9833     MOVE LENGTH OF
  9834      EL650AO
  9835       TO DFHEIV12
  9836     MOVE -1
  9837       TO DFHEIV11
  9838*    MOVE '8$     CT  E    H L F ,   #00008543' TO DFHEIV0
  9839     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9840     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9841     MOVE X'2020233030303038353433' TO DFHEIV0(25:11)
  9842     CALL 'kxdfhei1' USING DFHEIV0,
  9843           MAP-NAME,
  9844           EL650AO,
  9845           DFHEIV12,
  9846           MAPSET-NAME,
  9847           DFHEIV99,
  9848           DFHEIV99,
  9849           DFHEIV99,
  9850           DFHEIV11,
  9851           DFHEIV99,
  9852           DFHEIV99,
  9853           DFHEIV99
  9854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9855
  9856
  9857     GO TO 9100-RETURN-TRAN.
  9858
  9859 8200-SEND-DATAONLY.
  9860     MOVE SAVE-DATE              TO  DATEO.
  9861     MOVE EIBTIME                TO  TIME-IN.
  9862     MOVE TIME-OUT               TO  TIMEO.
  9863     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9864     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9865     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9866     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9867
  9868
  9869* EXEC CICS  SEND
  9870*        MAP     (MAP-NAME)
  9871*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL650.cbl
  9872*        FROM    (EL650AO)
  9873*        DATAONLY
  9874*        CURSOR
  9875*    END-EXEC.
  9876     MOVE LENGTH OF
  9877      EL650AO
  9878       TO DFHEIV12
  9879     MOVE -1
  9880       TO DFHEIV11
  9881*    MOVE '8$D    CT       H L F ,   #00008562' TO DFHEIV0
  9882     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9883     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9884     MOVE X'2020233030303038353632' TO DFHEIV0(25:11)
  9885     CALL 'kxdfhei1' USING DFHEIV0,
  9886           MAP-NAME,
  9887           EL650AO,
  9888           DFHEIV12,
  9889           MAPSET-NAME,
  9890           DFHEIV99,
  9891           DFHEIV99,
  9892           DFHEIV99,
  9893           DFHEIV11,
  9894           DFHEIV99,
  9895           DFHEIV99,
  9896           DFHEIV99
  9897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9898
  9899
  9900     GO TO 9100-RETURN-TRAN.
  9901
  9902 8300-SEND-TEXT.
  9903
  9904* EXEC CICS  SEND TEXT
  9905*        FROM    (LOGOFF-TEXT)
  9906*        LENGTH  (LOGOFF-LENGTH)
  9907*        ERASE
  9908*        FREEKB
  9909*    END-EXEC.
  9910*    MOVE '8&      T  E F  H   F -   #00008573' TO DFHEIV0
  9911     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9912     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9913     MOVE X'2020233030303038353733' TO DFHEIV0(25:11)
  9914     CALL 'kxdfhei1' USING DFHEIV0,
  9915           LOGOFF-TEXT,
  9916           LOGOFF-LENGTH,
  9917           DFHEIV99,
  9918           DFHEIV99,
  9919           DFHEIV99,
  9920           DFHEIV99,
  9921           DFHEIV99,
  9922           DFHEIV99,
  9923           DFHEIV99,
  9924           DFHEIV99,
  9925           DFHEIV99,
  9926           DFHEIV99
  9927     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9928
  9929
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL650.cbl
  9930
  9931* EXEC CICS  RETURN
  9932*    END-EXEC.
  9933*    MOVE '.(                    &   #00008580' TO DFHEIV0
  9934     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9935     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9936     MOVE X'2020233030303038353830' TO DFHEIV0(25:11)
  9937     CALL 'kxdfhei1' USING DFHEIV0,
  9938           DFHEIV99,
  9939           DFHEIV99,
  9940           DFHEIV99,
  9941           DFHEIV99,
  9942           DFHEIV99
  9943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9944
  9945
  9946 8400-LOG-JOURNAL-RECORD.
  9947*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  9948*    MOVE FILE-ID                TO  JP-FILE-ID.
  9949*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  9950*
  9951*    IF PI-JOURNAL-FILE-ID  NOT =  ZERO
  9952*        EXEC CICS  JOURNAL
  9953*            JFILEID  (PI-JOURNAL-FILE-ID)
  9954*            JTYPEID  ('ER')
  9955*            FROM     (JOURNAL-RECORD)
  9956*            LENGTH   (2023)
  9957*        END-EXEC.
  9958
  9959 8600-DEEDIT.
  9960
  9961* EXEC CICS  BIF DEEDIT
  9962*        FIELD   (WS-DEEDIT-FIELD)
  9963*        LENGTH  (10)
  9964*    END-EXEC.
  9965     MOVE 10
  9966       TO DFHEIV11
  9967*    MOVE '@"L                   #   #00008597' TO DFHEIV0
  9968     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9969     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9970     MOVE X'2020233030303038353937' TO DFHEIV0(25:11)
  9971     CALL 'kxdfhei1' USING DFHEIV0,
  9972           WS-DEEDIT-FIELD,
  9973           DFHEIV11
  9974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9975
  9976 8600-EXIT.
  9977      EXIT.
  9978 8800-UNAUTHORIZED-ACCESS.
  9979     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  9980
  9981     GO TO 8300-SEND-TEXT.
  9982
  9983 8810-PF23.
  9984     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  9985     MOVE XCTL-005               TO  PGM-NAME.
  9986
  9987     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL650.cbl
  9988
  9989 8900-PF5.
  9990     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
  9991         MOVE ER-3785            TO  EMI-ERROR
  9992         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9993         MOVE -1                 TO  MAINTL
  9994         GO TO 8200-SEND-DATAONLY.
  9995
  9996     MOVE PI-PREV-VG-ACCOUNT     TO  PI-ACCT-CCGSA-KEY.
  9997
  9998     MOVE XCTL-6509              TO  PGM-NAME.
  9999
 10000     GO TO 9300-XCTL.
 10001
 10002 8910-PF6.
 10003     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10004        MOVE ER-3785             TO EMI-ERROR
 10005        PERFORM 9900-ERROR-FORMAT
 10006                                 THRU 9900-EXIT
 10007        MOVE -1                  TO MAINTL
 10008        GO TO 8200-SEND-DATAONLY
 10009     END-IF
 10010     MOVE PI-PREV-VG-ACCOUNT     TO PI-ACCT-CCGSA-KEY
 10011     MOVE XCTL-6503              TO PGM-NAME
 10012     GO TO 9300-XCTL
 10013     .
 10014 9100-RETURN-TRAN.
 10015     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10016     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10017
 10018* EXEC CICS  RETURN
 10019*        TRANSID   (TRANS-ID)
 10020*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10021*        LENGTH    (WS-COMM-LENGTH)
 10022*    END-EXEC.
 10023*    MOVE '.(CT                  &   #00008642' TO DFHEIV0
 10024     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10026     MOVE X'2020233030303038363432' TO DFHEIV0(25:11)
 10027     CALL 'kxdfhei1' USING DFHEIV0,
 10028           TRANS-ID,
 10029           PROGRAM-INTERFACE-BLOCK,
 10030           WS-COMM-LENGTH,
 10031           DFHEIV99,
 10032           DFHEIV99
 10033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10034
 10035
 10036 9200-RETURN-MAIN-MENU.
 10037     MOVE XCTL-126               TO  PGM-NAME.
 10038
 10039     GO TO 9300-XCTL.
 10040
 10041 9300-XCTL.
 10042
 10043* EXEC CICS  XCTL
 10044*        PROGRAM   (PGM-NAME)
 10045*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL650.cbl
 10046*        LENGTH    (WS-COMM-LENGTH)
 10047*    END-EXEC.
 10048*    MOVE '.$C                   $   #00008654' TO DFHEIV0
 10049     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10050     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10051     MOVE X'2020233030303038363534' TO DFHEIV0(25:11)
 10052     CALL 'kxdfhei1' USING DFHEIV0,
 10053           PGM-NAME,
 10054           PROGRAM-INTERFACE-BLOCK,
 10055           WS-COMM-LENGTH
 10056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10057
 10058
 10059 9400-CLEAR.
 10060     MOVE SPACES                 TO  PI-SV-MAINT.
 10061     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10062
 10063     GO TO 9300-XCTL.
 10064
 10065 9500-PF12.
 10066     MOVE XCTL-010               TO  PGM-NAME.
 10067
 10068     GO TO 9300-XCTL.
 10069
 10070 9600-PGMID-ERROR.
 10071
 10072* EXEC CICS  HANDLE CONDITION
 10073*        PGMIDERR  (8300-SEND-TEXT)
 10074*    END-EXEC.
 10075*    MOVE '"$L                   ! ? #00008672' TO DFHEIV0
 10076     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10078     MOVE X'3F20233030303038363732' TO DFHEIV0(25:11)
 10079     CALL 'kxdfhei1' USING DFHEIV0
 10080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10081
 10082
 10083     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10084     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10085     MOVE XCTL-005               TO  PGM-NAME.
 10086     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10087     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10088
 10089     GO TO 9300-XCTL.
 10090
 10091 9700-DATE-CONVERSION.
 10092     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10093
 10094
 10095* EXEC CICS  LINK
 10096*        PROGRAM   (PGM-NAME)
 10097*        COMMAREA  (DATE-CONVERSION-DATA)
 10098*        LENGTH    (DC-COMM-LENGTH)
 10099*    END-EXEC.
 10100*    MOVE '."C                   ''   #00008687' TO DFHEIV0
 10101     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10103     MOVE X'2020233030303038363837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL650.cbl
 10104     CALL 'kxdfhei1' USING DFHEIV0,
 10105           PGM-NAME,
 10106           DATE-CONVERSION-DATA,
 10107           DC-COMM-LENGTH,
 10108           DFHEIV99,
 10109           DFHEIV99,
 10110           DFHEIV99
 10111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10112
 10113
 10114 9900-ERROR-FORMAT.
 10115     IF NOT EMI-ERRORS-COMPLETE
 10116         MOVE LINK-001           TO  PGM-NAME
 10117
 10118* EXEC CICS  LINK
 10119*            PROGRAM   (PGM-NAME)
 10120*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10121*            LENGTH    (EMI-COMM-LENGTH)
 10122*        END-EXEC.
 10123*    MOVE '."C                   ''   #00008696' TO DFHEIV0
 10124     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10125     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10126     MOVE X'2020233030303038363936' TO DFHEIV0(25:11)
 10127     CALL 'kxdfhei1' USING DFHEIV0,
 10128           PGM-NAME,
 10129           ERROR-MESSAGE-INTERFACE-BLOCK,
 10130           EMI-COMM-LENGTH,
 10131           DFHEIV99,
 10132           DFHEIV99,
 10133           DFHEIV99
 10134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10135
 10136
 10137 9900-EXIT.
 10138     EXIT.
 10139
 10140 9990-ABEND.
 10141     MOVE LINK-004               TO  PGM-NAME.
 10142     MOVE DFHEIBLK               TO  EMI-LINE1.
 10143
 10144
 10145* EXEC CICS  LINK
 10146*        PROGRAM   (PGM-NAME)
 10147*        COMMAREA  (EMI-LINE1)
 10148*        LENGTH    (72)
 10149*    END-EXEC.
 10150     MOVE 72
 10151       TO DFHEIV11
 10152*    MOVE '."C                   ''   #00008709' TO DFHEIV0
 10153     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10154     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10155     MOVE X'2020233030303038373039' TO DFHEIV0(25:11)
 10156     CALL 'kxdfhei1' USING DFHEIV0,
 10157           PGM-NAME,
 10158           EMI-LINE1,
 10159           DFHEIV11,
 10160           DFHEIV99,
 10161           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL650.cbl
 10162           DFHEIV99
 10163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10164
 10165
 10166     MOVE -1                     TO  MAINTL.
 10167
 10168     GO TO 8200-SEND-DATAONLY.
 10169
 10170 9995-SECURITY-VIOLATION.
 10171*                            COPY ELCSCTP.
 10172******************************************************************
 10173*                                                                *
 10174*                            ELCSCTP                             *
 10175*                            VMOD=2.001                          *
 10176*                                                                *
 10177*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10178******************************************************************
 10179
 10180
 10181     MOVE EIBDATE          TO SM-JUL-DATE.
 10182     MOVE EIBTRMID         TO SM-TERMID.
 10183     MOVE THIS-PGM         TO SM-PGM.
 10184     MOVE EIBTIME          TO TIME-IN.
 10185     MOVE TIME-OUT         TO SM-TIME.
 10186     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10187
 10188
 10189* EXEC CICS LINK
 10190*         PROGRAM  ('EL003')
 10191*         COMMAREA (SECURITY-MESSAGE)
 10192*         LENGTH   (80)
 10193*    END-EXEC.
 10194     MOVE 'EL003' TO DFHEIV1
 10195     MOVE 80
 10196       TO DFHEIV11
 10197*    MOVE '."C                   ''   #00008737' TO DFHEIV0
 10198     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10199     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10200     MOVE X'2020233030303038373337' TO DFHEIV0(25:11)
 10201     CALL 'kxdfhei1' USING DFHEIV0,
 10202           DFHEIV1,
 10203           SECURITY-MESSAGE,
 10204           DFHEIV11,
 10205           DFHEIV99,
 10206           DFHEIV99,
 10207           DFHEIV99
 10208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10209
 10210
 10211******************************************************************
 10212
 10213
 10214 9995-EXIT.
 10215     EXIT.
 10216
 10217 9999-DFHBACK SECTION.
 10218     MOVE '9%                    "   ' TO DFHEIV0
 10219     MOVE 'EL650' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL650.cbl
 10220     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10221     GOBACK.
 10222 9999-DFHEXIT.
 10223     IF DFHEIGDJ EQUAL 0001
 10224         NEXT SENTENCE
 10225     ELSE IF DFHEIGDJ EQUAL 2
 10226         GO TO 5340-END,
 10227               5330-NOT-FOUND
 10228         DEPENDING ON DFHEIGDI
 10229     ELSE IF DFHEIGDJ EQUAL 3
 10230         GO TO 9600-PGMID-ERROR,
 10231               9990-ABEND
 10232         DEPENDING ON DFHEIGDI
 10233     ELSE IF DFHEIGDJ EQUAL 4
 10234         GO TO 1010-NOT-FOUND,
 10235               1010-NOT-FOUND
 10236         DEPENDING ON DFHEIGDI
 10237     ELSE IF DFHEIGDJ EQUAL 5
 10238         GO TO 2568-NO-RECORDS,
 10239               2568-NO-RECORDS
 10240         DEPENDING ON DFHEIGDI
 10241     ELSE IF DFHEIGDJ EQUAL 6
 10242         GO TO 3175-CONTINUE,
 10243               3175-CONTINUE
 10244         DEPENDING ON DFHEIGDI
 10245     ELSE IF DFHEIGDJ EQUAL 7
 10246         GO TO 4175-CONTINUE,
 10247               4175-CONTINUE
 10248         DEPENDING ON DFHEIGDI
 10249     ELSE IF DFHEIGDJ EQUAL 8
 10250         GO TO 4530-NOT-FOUND,
 10251               4530-NOT-FOUND
 10252         DEPENDING ON DFHEIGDI
 10253     ELSE IF DFHEIGDJ EQUAL 9
 10254         GO TO 4699-EXIT,
 10255               4689-EOF
 10256         DEPENDING ON DFHEIGDI
 10257     ELSE IF DFHEIGDJ EQUAL 10
 10258         GO TO 4899-EXIT,
 10259               4889-EOF
 10260         DEPENDING ON DFHEIGDI
 10261     ELSE IF DFHEIGDJ EQUAL 11
 10262         GO TO 4580-DUPREC,
 10263               4580-DUPREC
 10264         DEPENDING ON DFHEIGDI
 10265     ELSE IF DFHEIGDJ EQUAL 12
 10266         GO TO 4959-EXIT,
 10267               4959-EXIT
 10268         DEPENDING ON DFHEIGDI
 10269     ELSE IF DFHEIGDJ EQUAL 13
 10270         GO TO 4969-EXIT,
 10271               4969-EXIT
 10272         DEPENDING ON DFHEIGDI
 10273     ELSE IF DFHEIGDJ EQUAL 14
 10274         GO TO 4980-EXIT
 10275         DEPENDING ON DFHEIGDI
 10276     ELSE IF DFHEIGDJ EQUAL 15
 10277         GO TO 5007-EXIT,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL650.cbl
 10278               5007-EXIT
 10279         DEPENDING ON DFHEIGDI
 10280     ELSE IF DFHEIGDJ EQUAL 16
 10281         GO TO 5007-EXIT,
 10282               5007-EXIT,
 10283               5007-EXIT,
 10284               5007-EXIT,
 10285               5007-EXIT
 10286         DEPENDING ON DFHEIGDI
 10287     ELSE IF DFHEIGDJ EQUAL 17
 10288         GO TO 5015-NOT-FOUND,
 10289               5015-NOT-FOUND
 10290         DEPENDING ON DFHEIGDI
 10291     ELSE IF DFHEIGDJ EQUAL 18
 10292         GO TO 5015-NOT-FOUND,
 10293               5015-NOT-FOUND
 10294         DEPENDING ON DFHEIGDI
 10295     ELSE IF DFHEIGDJ EQUAL 19
 10296         GO TO 5340-END,
 10297               5330-NOT-FOUND
 10298         DEPENDING ON DFHEIGDI
 10299     ELSE IF DFHEIGDJ EQUAL 20
 10300         GO TO 5440-NOT-FOUND,
 10301               5430-NOT-FOUND
 10302         DEPENDING ON DFHEIGDI
 10303     ELSE IF DFHEIGDJ EQUAL 21
 10304         GO TO 5525-SKIP-REWRITE,
 10305               5525-SKIP-REWRITE
 10306         DEPENDING ON DFHEIGDI
 10307     ELSE IF DFHEIGDJ EQUAL 22
 10308         GO TO 5615-SKIP-REWRITE,
 10309               5615-SKIP-REWRITE
 10310         DEPENDING ON DFHEIGDI
 10311     ELSE IF DFHEIGDJ EQUAL 23
 10312         GO TO 6599-EXIT
 10313         DEPENDING ON DFHEIGDI
 10314     ELSE IF DFHEIGDJ EQUAL 24
 10315         GO TO 6699-EXIT
 10316         DEPENDING ON DFHEIGDI
 10317     ELSE IF DFHEIGDJ EQUAL 25
 10318         GO TO 6720-NO-CARRIER
 10319         DEPENDING ON DFHEIGDI
 10320     ELSE IF DFHEIGDJ EQUAL 26
 10321         GO TO 6780-NO-STATE
 10322         DEPENDING ON DFHEIGDI
 10323     ELSE IF DFHEIGDJ EQUAL 27
 10324         GO TO 6880-NO-COMP
 10325         DEPENDING ON DFHEIGDI
 10326     ELSE IF DFHEIGDJ EQUAL 28
 10327         GO TO 7200-EXIT,
 10328               7200-EXIT
 10329         DEPENDING ON DFHEIGDI
 10330     ELSE IF DFHEIGDJ EQUAL 29
 10331         GO TO 7300-EXIT,
 10332               7300-EXIT
 10333         DEPENDING ON DFHEIGDI
 10334     ELSE IF DFHEIGDJ EQUAL 30
 10335         GO TO 7400-EXIT,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL650.cbl
 10336               7400-EXIT
 10337         DEPENDING ON DFHEIGDI
 10338     ELSE IF DFHEIGDJ EQUAL 31
 10339         GO TO 8300-SEND-TEXT
 10340         DEPENDING ON DFHEIGDI.
 10341     MOVE '9%                    "   ' TO DFHEIV0
 10342     MOVE 'EL650' TO DFHEIV1
 10343     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10344     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40180     Code:       34068
