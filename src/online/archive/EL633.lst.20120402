* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   1
* EL633.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL633.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL633.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL633.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/28/94 10:04:35.
     7*                            VMOD=2.021
     8*
     9*AUTHOR.        LOGIC,INC.
    10*               DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   2
* EL633.cbl
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXB7 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL633AI FILLER
    38* 010803                   PEMA  ADD 1825013200 FOR DCC
    39* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
    40* 022504                   PEMA ADD GL CODE FOR DCC
    41* 093004                   PEMA ADD NEW GL CODE FOR DCC
    42* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
    43* 061605    2005051300001  PEMA ADD GL NUM EDIT FOR DCC
    44* 122105    2005033100001  PEMA ADD GL NUM EDIT FOR CSI
    45* 032806                   PEMA ADD MORE GL NUMBERS FOR CSI
    46* 071806    2006012600002  PEMA CHANGE DCC GL NUMBERS
    47* 080206    2006012600002  PEMA ADD GL NUMBER FOR CID & DCC
    48* 092506                   PEMA ADD NEW GL CODE FOR DCC
    49* 031909    2009030300001  AJRA ADD NEW GL CODE FOR CID
    50* 040109    2008050500001  AJRA ADD GL NUMBERS FOR CCC
    51* 031710  CR2009100700001  PEMA CORRECT MATH ON TYPE 'U'
    52* 120711  CR2011120100004  PEMA ADD GL NUMBER FOR CCC
    53******************************************************************
    54
    55 ENVIRONMENT DIVISION.
    56 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   3
* EL633.cbl
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60 77  FILLER  PIC X(32)  VALUE '********************************'.
    61 77  FILLER  PIC X(32)  VALUE '*    EL633 WORKING STORAGE     *'.
    62 77  FILLER  PIC X(32)  VALUE '************ V/M 2.021 *********'.
    63
    64*77  FILLER  PIC X(32)  VALUE '/////// SAVE COFA MASTER /////'.
    65*77  SV-COFA PIC X(42)  VALUE SPACES.
    66*77  K-SPACE PIC X(11)  VALUE SPACES.
    67
    68 01  DATE-WORK-AREAS.
    69     05  WS-GREG-STORE.
    70         10  WS-GS-MM  PIC XX.
    71         10  FILLER    PIC X.
    72         10  WS-GS-DD  PIC XX.
    73         10  FILLER    PIC X.
    74         10  WS-GS-YY  PIC XX.
    75     05  WS-SDTE-STORE.
    76         10  WS-SS-MM  PIC XX.
    77         10  WS-SS-DD  PIC XX.
    78         10  WS-SS-YY  PIC XX.
    79*                            COPY ELCSCTM.
    80******************************************************************
    81*                                                                *
    82*                                                                *
    83*                            ELCSCTM                             *
    84*                            VMOD=2.001                          *
    85*                                                                *
    86*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-MESSAGE.
    90     12  FILLER                          PIC X(30)
    91            VALUE '** LOGIC SECURITY VIOLATION -'.
    92     12  SM-READ                         PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' PGM='.
    95     12  SM-PGM                          PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' OPR='.
    98     12  SM-PROCESSOR-ID                 PIC X(4).
    99     12  FILLER                          PIC X(6)
   100            VALUE ' TERM='.
   101     12  SM-TERMID                       PIC X(4).
   102     12  FILLER                          PIC XX   VALUE SPACE.
   103     12  SM-JUL-DATE                     PIC 9(5).
   104     12  FILLER                          PIC X    VALUE SPACE.
   105     12  SM-TIME                         PIC 99.99.
   106
   107*                            COPY ELCSCRTY.
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*                            ELCSCRTY                            *
   112*                            VMOD=2.001                          *
   113*                                                                *
   114*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   115*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   4
* EL633.cbl
   116*        SAVED IN PI-SECURITY-ADDRESS.                           *
   117*                                                                *
   118******************************************************************
   119 01  SECURITY-CONTROL.
   120     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   121     12  FILLER                       PIC XX    VALUE 'SC'.
   122     12  SC-CREDIT-CODES.
   123         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   124             20  SC-CREDIT-DISPLAY    PIC X.
   125             20  SC-CREDIT-UPDATE     PIC X.
   126     12  SC-CLAIMS-CODES.
   127         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   128             20  SC-CLAIMS-DISPLAY    PIC X.
   129             20  SC-CLAIMS-UPDATE     PIC X.
   130
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   5
* EL633.cbl
   132
   133 01  STANDARD-AREAS.
   134     12  SC-ITEM             PIC  S9(4) COMP VALUE +1.
   135     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   136     12  MAP-NAME            PIC  X(8)       VALUE 'EL633A'.
   137     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL633S'.
   138     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633A'.
   139     12  TRANS-ID            PIC  X(4)       VALUE 'EXB7'.
   140     12  EL6331-TRANS-ID     PIC  X(4)       VALUE 'EXB8'.
   141     12  EL640-TRANS-ID      PIC  X(4)       VALUE 'EXC1'.
   142     12  EL642-TRANS-ID      PIC  X(4)       VALUE 'EXH7'.
   143     12  EL652-TRANS-ID      PIC  X(4)       VALUE 'EXD4'.
   144     12  THIS-PGM            PIC  X(8)       VALUE 'EL633'.
   145     12  PGM-NAME            PIC  X(8).
   146     12  TIME-IN             PIC S9(7).
   147     12  TIME-OUT-R  REDEFINES  TIME-IN.
   148         16  FILLER          PIC  X.
   149         16  TIME-OUT        PIC  99V99.
   150         16  FILLER          PIC  X(2).
   151     12  EL640               PIC  X(8)       VALUE 'EL640'.
   152     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   153     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   154     12  XCTL-626            PIC  X(8)       VALUE 'EL626'.
   155     12  XCTL-6331           PIC  X(8)       VALUE 'EL6331'.
   156     12  XCTL-640            PIC  X(8)       VALUE 'EL640'.
   157     12  XCTL-642            PIC  X(8)       VALUE 'EL642'.
   158     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   159     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   160     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   161     12  RETURNED-FROM       PIC  X(8)       VALUE SPACES.
   162     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   163     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   164     12  CHKQ-FILE-ID        PIC  X(8)       VALUE 'ERCHKQ'.
   165     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   166     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   167     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   168     12  PYAJ-READ-SW        PIC  X          VALUE 'Y'.
   169         88  PYAJ-1ST-READ                   VALUE 'Y'.
   170     12  FIRST-ADD-SW        PIC  X          VALUE 'Y'.
   171         88  FIRST-ADD                       VALUE 'Y'.
   172     12  ZERO-NDX            PIC  9          VALUE ZERO.
   173     12  WORK-SEQ-NO         PIC S9(8)       COMP-3 VALUE ZEROS.
   174     12  WORK-SEQ-TIME       PIC  9(6).
   175     12  WORK-SEQ-HHMMSS  REDEFINES  WORK-SEQ-TIME.
   176         16  WORK-SEQ-HHMMS  PIC  9(5).
   177         16  FILLER          PIC  9.
   178     12  WORK-DATE-JULIAN.
   179         16  WORK-JULIAN-YR  PIC  99         VALUE ZEROS.
   180         16  WORK-JULIAN-DD  PIC  999        VALUE ZEROS.
   181     12  JULIAN-YY-DD        PIC  9(4)       COMP-3 VALUE ZEROS.
   182     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   183         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   184                                                    'S' 'T' 'U'
   185                                                    'X' 'Y' 'Z'
   186                                                    'F'.
   187     12  CHECK-CANC-TYPE     PIC  X          VALUE SPACE.
   188         88  VALID-CANC-TYPE                 VALUE 'N' 'Y' ' '.
   189     12  FORCE-SHOW-SW       PIC  X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   6
* EL633.cbl
   190         88  FORCE-SHOW                      VALUE  'Y'.
   191
   192     12  WS-EOM-DTS OCCURS 13  TIMES
   193                              INDEXED BY PINDEX.
   194         16  WS-EOM-DT               PIC XX.
   195*    12  COFA-FILE-ID        PIC  X(8)       VALUE 'COFAXXX '.
   196
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   7
* EL633.cbl
   198     12  WS-ERROR-CODES.
   199         16  ER-0000         PIC  X(4)       VALUE '0000'.
   200         16  ER-0008         PIC  X(4)       VALUE '0008'.
   201         16  ER-0023         PIC  X(4)       VALUE '0023'.
   202         16  ER-0029         PIC  X(4)       VALUE '0029'.
   203         16  ER-0070         PIC  X(4)       VALUE '0070'.
   204         16  ER-0587         PIC  X(4)       VALUE '0587'.
   205         16  ER-2056         PIC  X(4)       VALUE '2056'.
   206         16  ER-2230         PIC  X(4)       VALUE '2230'.
   207         16  ER-2231         PIC  X(4)       VALUE '2231'.
   208         16  ER-2232         PIC  X(4)       VALUE '2232'.
   209         16  ER-2233         PIC  X(4)       VALUE '2233'.
   210         16  ER-2234         PIC  X(4)       VALUE '2234'.
   211         16  ER-2235         PIC  X(4)       VALUE '2235'.
   212         16  ER-2236         PIC  X(4)       VALUE '2236'.
   213         16  ER-2237         PIC  X(4)       VALUE '2237'.
   214         16  ER-2238         PIC  X(4)       VALUE '2238'.
   215         16  ER-2239         PIC  X(4)       VALUE '2239'.
   216         16  ER-2244         PIC  X(4)       VALUE '2244'.
   217         16  ER-2245         PIC  X(4)       VALUE '2245'.
   218         16  ER-2246         PIC  X(4)       VALUE '2246'.
   219         16  ER-2370         PIC  X(4)       VALUE '2370'.
   220         16  ER-2432         PIC  X(4)       VALUE '2432'.
   221         16  ER-2449         PIC  X(4)       VALUE '2449'.
   222         16  ER-2587         PIC  X(4)       VALUE '2587'.
   223         16  ER-2588         PIC  X(4)       VALUE '2588'.
   224         16  ER-2595         PIC  X(4)       VALUE '2595'.
   225         16  ER-2596         PIC  X(4)       VALUE '2596'.
   226         16  ER-2763         PIC  X(4)       VALUE '2763'.
   227         16  ER-2929         PIC  X(4)       VALUE '2929'.
   228         16  ER-2957         PIC  X(4)       VALUE '2957'.
   229         16  ER-2958         PIC  X(4)       VALUE '2958'.
   230*        16  ER-2959         PIC  X(4)       VALUE '2958'.
   231         16  ER-2960         PIC  X(4)       VALUE '2960'.
   232         16  ER-3020         PIC  X(4)       VALUE '3020'.
   233
   234*************************************************************
   235*                      TABLE OF STATE NAMES
   236*************************************************************
   237
   238 01  CHECK-STATE-CODE            PIC XX      VALUE SPACE.
   239     88  VALID-STATE-CODE    VALUE 'AK' 'AL' 'AR' 'AZ' 'CA'
   240                                   'CD' 'CO' 'CT' 'DC' 'DE'
   241                                   'FL' 'GA' 'GM' 'HI' 'IA'
   242                                   'ID' 'IL' 'IN' 'KS' 'KY'
   243                                   'LA' 'MA' 'MD' 'ME' 'MI'
   244                                   'MN' 'MO' 'MS' 'MT' 'MX'
   245                                   'NC' 'ND' 'NE' 'NH' 'NJ'
   246                                   'NM' 'NV' 'NY' 'OF' 'OH'
   247                                   'OK' 'OR' 'PA' 'PI' 'PR'
   248                                   'RI' 'SC' 'SD' 'TN' 'TX'
   249                                   'UT' 'VA' 'VI' 'VT' 'WA'
   250                                   'WI' 'WV' 'WY'.
   251
   252 01  CHECK-GL-ACCT         PIC X(10)  VALUE SPACE.
   253     88  VALID-GL-ACCOUNT  VALUE '1108121010'
   254                                 '1108125100'
   255                                 '1721211400'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   8
* EL633.cbl
   256                                 '1825011200'
   257                                 '1825011300'
   258                                 '1825099050'
   259                                 '8505700033'
   260                                 '8506400030'
   261                                 '8507200020'
   262                                 '8507200010'.
   263     88  VALID-DCC-GL-ACCOUNT  VALUE '2725040300'
   264                                     '2725040320'
   265                                     '2725040330'
   266                                     '2725040310'
   267                                     '8506400030'
   268                                     '8507200010'
   269                                     '1108121250'.
   270     88  VALID-CSI-GL-ACCOUNT  VALUE '2725040100'
   271                                     '2725040110'
   272                                     '2725040120'
   273                                     '2725040130'
   274                                     '2725020400'.
   275
   276     88  VALID-CCC-GL-ACCOUNT  VALUE '1825013100'
   277                                     '1825013200'
   278                                     '1825013300'
   279                                     '1825013400'
   280                                     '8506400030'
   281                                     '8507200010'
   282                                     '8507200020'
   283                                     '1108121010'.
   284
   285*01  WS-ACCT-BREAK.
   286*    05  WS-ACCT-1               PIC X.
   287*    05  FILLER                  PIC X(6).
   288*
   289 01  WORK-AREA.
   290     12  WS-SAVE-ERPYAJ      PIC X(200)      VALUE SPACES.
   291     12  QID.
   292         16  QID-TERM        PIC X(04).
   293         16  FILLER          PIC X(04)       VALUE '633A'.
   294     12  DEEDIT-FIELD        PIC X(11).
   295     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   296     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(9)V99.
   297     12  DATE-TEST-AREA      PIC  9(6).
   298     12  DATE-TEST-AREA-R  REDEFINES  DATE-TEST-AREA.
   299         16  DATE-TEST-MM    PIC  99.
   300         16  DATE-TEST-DD    PIC  99.
   301         16  DATE-TEST-YY    PIC  99.
   302     12  DIVIDE-RESULT       PIC  99.
   303     12  DIVIDE-REMAINDER    PIC  9.
   304     12  PREV-BIN-MAINT-DT   PIC  XX           VALUE SPACES.
   305     12  PREV-MAINT-DT       PIC  X(8)         VALUE SPACES.
   306     12  PREV-BIN-BL-DT      PIC  XX           VALUE SPACES.
   307     12  PREV-BL-DT          PIC  X(8)         VALUE SPACES.
   308     12  TOTAL-ACCT-AMT      PIC S9(7)V99      VALUE ZEROS.
   309     12  TOTAL-ACCT-NET      PIC S9(7)V99      VALUE ZEROS.
   310     12  WS-SAVE-INDEX-VALUE PIC S9(4) COMP    VALUE ZEROS.
   311     12  WS-SAVE-NDX-VALUE   PIC S9(4) COMP    VALUE ZEROS.
   312
   313 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page   9
* EL633.cbl
   314     12  ERPYAJ-KEY.
   315         16  PYAJ-COMP-CD            PIC  X      VALUE SPACE.
   316         16  PYAJ-CARRIER            PIC  X      VALUE SPACES.
   317         16  PYAJ-GROUPING           PIC  X(6)   VALUE SPACES.
   318         16  PYAJ-FIN-RESP           PIC  X(10)  VALUE SPACES.
   319         16  PYAJ-ACCOUNT            PIC  X(10)  VALUE SPACES.
   320         16  PYAJ-FILE-SEQ-NO        PIC S9(8)   VALUE +0  COMP.
   321         16  PYAJ-RECORD-TYPE        PIC  X      VALUE SPACES.
   322
   323     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   324     12  ERPYAJ-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   325
   326     12  ERCHKQ-KEY.
   327         16  CHKQ-COMPANY-CD         PIC  X      VALUE SPACE.
   328         16  CHKQ-CONTROL-NUMBER     PIC S9(8)   VALUE +0  COMP.
   329         16  CHKQ-SEQUENCE-NUMBER    PIC S9(4)   VALUE +0  COMP.
   330     12  ERCOMP-KEY.
   331         16  COMP-COMP-CD            PIC  X      VALUE SPACE.
   332         16  COMP-CARRIER            PIC  X      VALUE SPACES.
   333         16  COMP-GROUPING           PIC  X(6)   VALUE SPACES.
   334         16  COMP-FIN-RESP           PIC  X(10)  VALUE SPACES.
   335         16  COMP-ACCOUNT            PIC  X(10)  VALUE SPACES.
   336         16  COMP-RECORD-TYPE        PIC  X      VALUE SPACES.
   337*    12  COFA-KEY-X.
   338*        16  COFA-COMPANY-X          PIC  X(4)   VALUE SPACES.
   339*        16  COFA-ACCOUNT.
   340*            20  COFA-FILLER         PIC  X(11)  VALUE SPACES.
   341*            20  COFA-MSA-ACCT       PIC  X(07)  VALUE SPACES.
   342*
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  10
* EL633.cbl
   344*                                    COPY ELCDATE.
   345******************************************************************
   346*                                                                *
   347*                                                                *
   348*                            ELCDATE.                            *
   349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   350*                            VMOD=2.003
   351*                                                                *
   352*                                                                *
   353*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   354*                 LENGTH = 200                                   *
   355******************************************************************
   356
   357 01  DATE-CONVERSION-DATA.
   358     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   359     12  DC-OPTION-CODE                PIC X.
   360         88  BIN-TO-GREG                VALUE ' '.
   361         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   362         88  EDIT-GREG-TO-BIN           VALUE '2'.
   363         88  YMD-GREG-TO-BIN            VALUE '3'.
   364         88  MDY-GREG-TO-BIN            VALUE '4'.
   365         88  JULIAN-TO-BIN              VALUE '5'.
   366         88  BIN-PLUS-ELAPSED           VALUE '6'.
   367         88  FIND-CENTURY               VALUE '7'.
   368         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   369         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   370         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   371         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   372         88  JULIAN-TO-BIN-3            VALUE 'C'.
   373         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   374         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   375         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   376         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   377         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   378         88  CHECK-LEAP-YEAR            VALUE 'H'.
   379         88  BIN-3-TO-GREG              VALUE 'I'.
   380         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   381         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   382         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   383         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   384         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   385         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   386         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   387         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   388         88  THREE-CHARACTER-BIN
   389                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   390         88  GREGORIAN-TO-BIN
   391                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   392         88  BIN-TO-GREGORIAN
   393                  VALUES ' ' '1' 'I' '8' 'G'.
   394         88  JULIAN-TO-BINARY
   395                  VALUES '5' 'C' 'E' 'F'.
   396     12  DC-ERROR-CODE                 PIC X.
   397         88  NO-CONVERSION-ERROR        VALUE ' '.
   398         88  DATE-CONVERSION-ERROR
   399                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   400         88  DATE-IS-ZERO               VALUE '1'.
   401         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  11
* EL633.cbl
   402         88  DATE-IS-INVALID            VALUE '3'.
   403         88  DATE1-GREATER-DATE2        VALUE '4'.
   404         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   405         88  DATE-INVALID-OPTION        VALUE '9'.
   406         88  INVALID-CENTURY            VALUE 'A'.
   407         88  ONLY-CENTURY               VALUE 'B'.
   408         88  ONLY-LEAP-YEAR             VALUE 'C'.
   409         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   410     12  DC-END-OF-MONTH               PIC X.
   411         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   412     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   413         88  USE-NORMAL-PROCESS         VALUE ' '.
   414         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   415         88  ADJUST-UP-100-YRS          VALUE '2'.
   416     12  FILLER                        PIC X.
   417     12  DC-CONVERSION-DATES.
   418         16  DC-BIN-DATE-1             PIC XX.
   419         16  DC-BIN-DATE-2             PIC XX.
   420         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   421         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   422                       DC-GREG-DATE-1-EDIT.
   423             20  DC-EDIT1-MONTH        PIC 99.
   424             20  SLASH1-1              PIC X.
   425             20  DC-EDIT1-DAY          PIC 99.
   426             20  SLASH1-2              PIC X.
   427             20  DC-EDIT1-YEAR         PIC 99.
   428         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   429         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   430                     DC-GREG-DATE-2-EDIT.
   431             20  DC-EDIT2-MONTH        PIC 99.
   432             20  SLASH2-1              PIC X.
   433             20  DC-EDIT2-DAY          PIC 99.
   434             20  SLASH2-2              PIC X.
   435             20  DC-EDIT2-YEAR         PIC 99.
   436         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   437         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   438                     DC-GREG-DATE-1-YMD.
   439             20  DC-YMD-YEAR           PIC 99.
   440             20  DC-YMD-MONTH          PIC 99.
   441             20  DC-YMD-DAY            PIC 99.
   442         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   443         16  DC-GREG-DATE-1-MDY-R REDEFINES
   444                      DC-GREG-DATE-1-MDY.
   445             20  DC-MDY-MONTH          PIC 99.
   446             20  DC-MDY-DAY            PIC 99.
   447             20  DC-MDY-YEAR           PIC 99.
   448         16  DC-GREG-DATE-1-ALPHA.
   449             20  DC-ALPHA-MONTH        PIC X(10).
   450             20  DC-ALPHA-DAY          PIC 99.
   451             20  FILLER                PIC XX.
   452             20  DC-ALPHA-CENTURY.
   453                 24 DC-ALPHA-CEN-N     PIC 99.
   454             20  DC-ALPHA-YEAR         PIC 99.
   455         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   456         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   457         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   458         16  DC-JULIAN-DATE            PIC 9(05).
   459         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  12
* EL633.cbl
   460                                       PIC 9(05).
   461         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   462             20  DC-JULIAN-YEAR        PIC 99.
   463             20  DC-JULIAN-DAYS        PIC 999.
   464         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   465         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   466         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   467     12  DATE-CONVERSION-VARIBLES.
   468         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   469         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   470             20  FILLER                PIC 9(3).
   471             20  HOLD-CEN-1-CCYY.
   472                 24  HOLD-CEN-1-CC     PIC 99.
   473                 24  HOLD-CEN-1-YY     PIC 99.
   474             20  HOLD-CEN-1-MO         PIC 99.
   475             20  HOLD-CEN-1-DA         PIC 99.
   476         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   477             20  HOLD-CEN-1-R-MO       PIC 99.
   478             20  HOLD-CEN-1-R-DA       PIC 99.
   479             20  HOLD-CEN-1-R-CCYY.
   480                 24  HOLD-CEN-1-R-CC   PIC 99.
   481                 24  HOLD-CEN-1-R-YY   PIC 99.
   482             20  FILLER                PIC 9(3).
   483         16  HOLD-CENTURY-1-X.
   484             20  FILLER                PIC X(3)  VALUE SPACES.
   485             20  HOLD-CEN-1-X-CCYY.
   486                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   487                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   488             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   489             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   490         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   491             20  HOLD-CEN-1-R-X-MO     PIC XX.
   492             20  HOLD-CEN-1-R-X-DA     PIC XX.
   493             20  HOLD-CEN-1-R-X-CCYY.
   494                 24  HOLD-CEN-1-R-X-CC PIC XX.
   495                 24  HOLD-CEN-1-R-X-YY PIC XX.
   496             20  FILLER                PIC XXX.
   497         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   498         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   499         16  DC-JULIAN-DATE-1          PIC 9(07).
   500         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   501             20  DC-JULIAN-1-CCYY.
   502                 24  DC-JULIAN-1-CC    PIC 99.
   503                 24  DC-JULIAN-1-YR    PIC 99.
   504             20  DC-JULIAN-DA-1        PIC 999.
   505         16  DC-JULIAN-DATE-2          PIC 9(07).
   506         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   507             20  DC-JULIAN-2-CCYY.
   508                 24  DC-JULIAN-2-CC    PIC 99.
   509                 24  DC-JULIAN-2-YR    PIC 99.
   510             20  DC-JULIAN-DA-2        PIC 999.
   511         16  DC-GREG-DATE-A-EDIT.
   512             20  DC-EDITA-MONTH        PIC 99.
   513             20  SLASHA-1              PIC X VALUE '/'.
   514             20  DC-EDITA-DAY          PIC 99.
   515             20  SLASHA-2              PIC X VALUE '/'.
   516             20  DC-EDITA-CCYY.
   517                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  13
* EL633.cbl
   518                 24  DC-EDITA-YEAR     PIC 99.
   519         16  DC-GREG-DATE-B-EDIT.
   520             20  DC-EDITB-MONTH        PIC 99.
   521             20  SLASHB-1              PIC X VALUE '/'.
   522             20  DC-EDITB-DAY          PIC 99.
   523             20  SLASHB-2              PIC X VALUE '/'.
   524             20  DC-EDITB-CCYY.
   525                 24  DC-EDITB-CENT     PIC 99.
   526                 24  DC-EDITB-YEAR     PIC 99.
   527         16  DC-GREG-DATE-CYMD         PIC 9(08).
   528         16  DC-GREG-DATE-CYMD-R REDEFINES
   529                              DC-GREG-DATE-CYMD.
   530             20  DC-CYMD-CEN           PIC 99.
   531             20  DC-CYMD-YEAR          PIC 99.
   532             20  DC-CYMD-MONTH         PIC 99.
   533             20  DC-CYMD-DAY           PIC 99.
   534         16  DC-GREG-DATE-MDCY         PIC 9(08).
   535         16  DC-GREG-DATE-MDCY-R REDEFINES
   536                              DC-GREG-DATE-MDCY.
   537             20  DC-MDCY-MONTH         PIC 99.
   538             20  DC-MDCY-DAY           PIC 99.
   539             20  DC-MDCY-CEN           PIC 99.
   540             20  DC-MDCY-YEAR          PIC 99.
   541    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   542        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   543    12  DC-EL310-DATE                  PIC X(21).
   544    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  14
* EL633.cbl
   546*                                    COPY ELCLOGOF.
   547******************************************************************
   548*                                                                *
   549*                                                                *
   550*                            ELCLOGOF.                           *
   551*                            VMOD=2.001                          *
   552*                                                                *
   553*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   554*                                                                *
   555******************************************************************
   556 01  CLASIC-LOGOFF.
   557     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   558     12  LOGOFF-TEXT.
   559         16  FILLER          PIC X(5)    VALUE SPACES.
   560         16  LOGOFF-MSG.
   561             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   562             20  FILLER      PIC X       VALUE SPACES.
   563             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   564         16  FILLER          PIC X(80)
   565           VALUE '* YOU ARE NOW LOGGED OFF'.
   566         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   567         16  FILLER          PIC X       VALUE QUOTE.
   568         16  LOGOFF-SYS-MSG  PIC X(17)
   569           VALUE 'S CLAS-IC SYSTEM '.
   570     12  TEXT-MESSAGES.
   571         16  UNACCESS-MSG    PIC X(29)
   572             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   573         16  PGMIDERR-MSG    PIC X(17)
   574             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  15
* EL633.cbl
   576*                                    COPY ELCATTR.
   577******************************************************************
   578*                                                                *
   579*                            ELCATTR.                            *
   580*                            VMOD=2.001                          *
   581*                                                                *
   582*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   583*                                                                *
   584*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   585*                                                                *
   586*                   POS 1   P=PROTECTED                          *
   587*                           U=UNPROTECTED                        *
   588*                           S=ASKIP                              *
   589*                   POS 2   A=ALPHA/NUMERIC                      *
   590*                           N=NUMERIC                            *
   591*                   POS 3   N=NORMAL                             *
   592*                           B=BRIGHT                             *
   593*                           D=DARK                               *
   594*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   595*                           OF=MODIFIED DATA TAG OFF             *
   596*                                                                *
   597*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   598******************************************************************
   599 01  ATTRIBUTE-LIST.
   600     12  AL-PABOF            PIC X       VALUE 'Y'.
   601     12  AL-PABON            PIC X       VALUE 'Z'.
   602     12  AL-PADOF            PIC X       VALUE '%'.
   603     12  AL-PADON            PIC X       VALUE '_'.
   604     12  AL-PANOF            PIC X       VALUE '-'.
   605     12  AL-PANON            PIC X       VALUE '/'.
   606     12  AL-SABOF            PIC X       VALUE '8'.
   607     12  AL-SABON            PIC X       VALUE '9'.
   608     12  AL-SADOF            PIC X       VALUE '@'.
   609     12  AL-SADON            PIC X       VALUE QUOTE.
   610     12  AL-SANOF            PIC X       VALUE '0'.
   611     12  AL-SANON            PIC X       VALUE '1'.
   612     12  AL-UABOF            PIC X       VALUE 'H'.
   613     12  AL-UABON            PIC X       VALUE 'I'.
   614     12  AL-UADOF            PIC X       VALUE '<'.
   615     12  AL-UADON            PIC X       VALUE '('.
   616     12  AL-UANOF            PIC X       VALUE ' '.
   617     12  AL-UANON            PIC X       VALUE 'A'.
   618     12  AL-UNBOF            PIC X       VALUE 'Q'.
   619     12  AL-UNBON            PIC X       VALUE 'R'.
   620     12  AL-UNDOF            PIC X       VALUE '*'.
   621     12  AL-UNDON            PIC X       VALUE ')'.
   622     12  AL-UNNOF            PIC X       VALUE '&'.
   623     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  16
* EL633.cbl
   625*                                    COPY ELCEMIB.
   626******************************************************************
   627*                                                                *
   628*                                                                *
   629*                            ELCEMIB.                            *
   630*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   631*                            VMOD=2.005                          *
   632*                                                                *
   633*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   634*                                                                *
   635******************************************************************
   636 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   637     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   638     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   639     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   640     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   641     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   642     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   643     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   644     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   645     12  EMI-SWITCH1             PIC X        VALUE '1'.
   646         88  EMI-NO-ERRORS                    VALUE '1'.
   647         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   648         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   649     12  EMI-SWITCH2             PIC X        VALUE '1'.
   650         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   651     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   652         88  EMI-AREA1-EMPTY                  VALUE '1'.
   653         88  EMI-AREA1-FULL                   VALUE '2'.
   654     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   655         88  EMI-AREA2-EMPTY                  VALUE '1'.
   656         88  EMI-AREA2-FULL                   VALUE '2'.
   657     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   658         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   659         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   660         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   661         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   662         88  EMI-BYPASS-FATALS                VALUE 'X'.
   663     12  EMI-ERROR-LINES.
   664         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   665         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   666         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   667         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   668             20  EMI-ERR-CODES OCCURS 10 TIMES.
   669                 24  EMI-ERR-NUM         PIC X(4).
   670                 24  EMI-FILLER          PIC X.
   671                 24  EMI-SEV             PIC X.
   672                 24  FILLER              PIC X.
   673             20  FILLER                  PIC X(02).
   674     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   675         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   676             20  EMI-ERROR-NUMBER    PIC X(4).
   677             20  EMI-FILL            PIC X.
   678             20  EMI-SEVERITY        PIC X.
   679             20  FILLER              PIC X.
   680             20  EMI-ERROR-TEXT.
   681                 24  EMI-TEXT-VARIABLE   PIC X(10).
   682                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  17
* EL633.cbl
   683     12  EMI-SEVERITY-SAVE           PIC X.
   684         88  EMI-NOTE                    VALUE 'N'.
   685         88  EMI-WARNING                 VALUE 'W'.
   686         88  EMI-FORCABLE                VALUE 'F'.
   687         88  EMI-FATAL                   VALUE 'X'.
   688     12  EMI-MESSAGE-FLAG            PIC X.
   689         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   690         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   691     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   692     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   693         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   694         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   695         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   696     12  FILLER                      PIC X(137)  VALUE SPACES.
   697     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   698     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   699     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   700     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  18
* EL633.cbl
   702*                                    COPY ELCINTF.
   703******************************************************************
   704*                                                                *
   705*                                                                *
   706*                            ELCINTF.                            *
   707*                            VMOD=2.017                          *
   708*                                                                *
   709*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   710*                                                                *
   711*       LENGTH = 1024                                            *
   712*                                                                *
   713******************************************************************
   714 01  PROGRAM-INTERFACE-BLOCK.
   715     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   716     12  PI-CALLING-PROGRAM              PIC X(8).
   717     12  PI-SAVED-PROGRAM-1              PIC X(8).
   718     12  PI-SAVED-PROGRAM-2              PIC X(8).
   719     12  PI-SAVED-PROGRAM-3              PIC X(8).
   720     12  PI-SAVED-PROGRAM-4              PIC X(8).
   721     12  PI-SAVED-PROGRAM-5              PIC X(8).
   722     12  PI-SAVED-PROGRAM-6              PIC X(8).
   723     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   724     12  PI-COMPANY-ID                   PIC XXX.
   725     12  PI-COMPANY-CD                   PIC X.
   726
   727     12  PI-COMPANY-PASSWORD             PIC X(8).
   728
   729     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   730
   731     12  PI-CONTROL-IN-PROGRESS.
   732         16  PI-CARRIER                  PIC X.
   733         16  PI-GROUPING                 PIC X(6).
   734         16  PI-STATE                    PIC XX.
   735         16  PI-ACCOUNT                  PIC X(10).
   736         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   737                                         PIC X(10).
   738         16  PI-CLAIM-CERT-GRP.
   739             20  PI-CLAIM-NO             PIC X(7).
   740             20  PI-CERT-NO.
   741                 25  PI-CERT-PRIME       PIC X(10).
   742                 25  PI-CERT-SFX         PIC X.
   743             20  PI-CERT-EFF-DT          PIC XX.
   744         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   745             20  PI-PLAN-CODE            PIC X(2).
   746             20  PI-REVISION-NUMBER      PIC X(3).
   747             20  PI-PLAN-EFF-DT          PIC X(2).
   748             20  PI-PLAN-EXP-DT          PIC X(2).
   749             20  FILLER                  PIC X(11).
   750         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   751             20  PI-OE-REFERENCE-1.
   752                 25  PI-OE-REF-1-PRIME   PIC X(18).
   753                 25  PI-OE-REF-1-SUFF    PIC XX.
   754
   755     12  PI-SESSION-IN-PROGRESS          PIC X.
   756         88  CLAIM-SESSION                   VALUE '1'.
   757         88  CREDIT-SESSION                  VALUE '2'.
   758         88  WARRANTY-SESSION                VALUE '3'.
   759         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  19
* EL633.cbl
   760         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   761
   762
   763*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   764
   765     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   766     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   767
   768     12  PI-CREDIT-USER                  PIC X.
   769         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   770         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   771
   772     12  PI-CLAIM-USER                   PIC X.
   773         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   774         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   775
   776     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   777         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   778         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   779         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   780         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   781         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   782
   783     12  PI-PROCESSOR-ID                 PIC X(4).
   784
   785     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   786
   787     12  PI-MEMBER-CAPTION               PIC X(10).
   788
   789     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   790         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   791
   792     12  PI-LIFE-OVERRIDE-L1             PIC X.
   793     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   794     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   795     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   796
   797     12  PI-AH-OVERRIDE-L1               PIC X.
   798     12  PI-AH-OVERRIDE-L2               PIC XX.
   799     12  PI-AH-OVERRIDE-L6               PIC X(6).
   800     12  PI-AH-OVERRIDE-L12              PIC X(12).
   801
   802     12  PI-NEW-SYSTEM                   PIC X(2).
   803
   804     12  PI-PRIMARY-CERT-NO              PIC X(11).
   805     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   806         88  PI-USES-PAID-TO                 VALUE '1'.
   807     12  PI-CRDTCRD-SYSTEM.
   808         16  PI-CRDTCRD-USER             PIC X.
   809             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   810             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   811         16  PI-CC-MONTH-END-DT          PIC XX.
   812     12  PI-PROCESSOR-PRINTER            PIC X(4).
   813
   814     12  PI-OE-REFERENCE-2.
   815         16  PI-OE-REF-2-PRIME           PIC X(10).
   816         16  PI-OE-REF-2-SUFF            PIC X.
   817
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  20
* EL633.cbl
   818     12  PI-REM-TRM-CALC-OPTION          PIC X.
   819
   820     12  PI-LANGUAGE-TYPE                PIC X.
   821             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   822             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   823             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   824
   825     12  PI-POLICY-LINKAGE-IND           PIC X.
   826         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   827         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   828                                                   LOW-VALUES.
   829
   830     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   831     12  PI-CLAIM-PW-SESSION             PIC X(1).
   832         88  PI-CLAIM-CREDIT                 VALUE '1'.
   833         88  PI-CLAIM-CONVEN                 VALUE '2'.
   834     12  FILLER                          PIC X(4).
   835
   836     12  PI-SYSTEM-LEVEL                 PIC X(145).
   837
   838     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   839         PI-SYSTEM-LEVEL.
   840
   841         16  PI-ENTRY-CODES.
   842             20  PI-ENTRY-CD-1           PIC X.
   843             20  PI-ENTRY-CD-2           PIC X.
   844
   845         16  PI-RETURN-CODES.
   846             20  PI-RETURN-CD-1          PIC X.
   847             20  PI-RETURN-CD-2          PIC X.
   848
   849         16  PI-UPDATE-STATUS-SAVE.
   850             20  PI-UPDATE-BY            PIC X(4).
   851             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   852
   853         16  PI-LOWER-CASE-LETTERS       PIC X.
   854             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   855
   856*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   857*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   858*            88  CARRIER-CLM-CNTL            VALUE '2'.
   859
   860         16  PI-CERT-ACCESS-CONTROL      PIC X.
   861             88  ST-ACCNT-CNTL               VALUE ' '.
   862             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   863             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   864             88  ACCNT-CNTL                  VALUE '3'.
   865             88  CARR-ACCNT-CNTL             VALUE '4'.
   866
   867         16  PI-PROCESSOR-CAP-LIST.
   868             20  PI-SYSTEM-CONTROLS.
   869                24 PI-SYSTEM-DISPLAY     PIC X.
   870                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   871                24 PI-SYSTEM-MODIFY      PIC X.
   872                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   873             20  FILLER                  PIC XX.
   874             20  PI-DISPLAY-CAP          PIC X.
   875                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  21
* EL633.cbl
   876             20  PI-MODIFY-CAP           PIC X.
   877                 88  MODIFY-CAP              VALUE 'Y'.
   878             20  PI-MSG-AT-LOGON-CAP     PIC X.
   879                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   880             20  PI-FORCE-CAP            PIC X.
   881                 88  FORCE-CAP               VALUE 'Y'.
   882
   883         16  PI-PROGRAM-CONTROLS.
   884             20  PI-PGM-PRINT-OPT        PIC X.
   885             20  PI-PGM-FORMAT-OPT       PIC X.
   886             20  PI-PGM-PROCESS-OPT      PIC X.
   887             20  PI-PGM-TOTALS-OPT       PIC X.
   888
   889         16  PI-HELP-INTERFACE.
   890             20  PI-LAST-ERROR-NO        PIC X(4).
   891             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   892
   893         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   894             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   895
   896         16  PI-CR-CONTROL-IN-PROGRESS.
   897             20  PI-CR-CARRIER           PIC X.
   898             20  PI-CR-GROUPING          PIC X(6).
   899             20  PI-CR-STATE             PIC XX.
   900             20  PI-CR-ACCOUNT           PIC X(10).
   901             20  PI-CR-FIN-RESP          PIC X(10).
   902             20  PI-CR-TYPE              PIC X.
   903
   904         16  PI-CR-BATCH-NUMBER          PIC X(6).
   905
   906         16  PI-CR-MONTH-END-DT          PIC XX.
   907
   908         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   909             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   910             88  PI-ZERO-CARRIER             VALUE '1'.
   911             88  PI-ZERO-GROUPING            VALUE '2'.
   912             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   913
   914         16  PI-CARRIER-SECURITY         PIC X.
   915             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   916
   917         16  PI-ACCOUNT-SECURITY         PIC X(10).
   918             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   919             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   920
   921         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   922             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   923                                         INDEXED BY PI-ACCESS-NDX
   924                                         PIC X.
   925
   926         16  PI-GA-BILLING-CONTROL       PIC X.
   927             88  PI-GA-BILLING               VALUE '1'.
   928
   929         16  PI-MAIL-PROCESSING          PIC X.
   930             88  PI-MAIL-YES                 VALUE 'Y'.
   931
   932         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   933
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  22
* EL633.cbl
   934         16  PI-AR-SYSTEM.
   935             20  PI-AR-PROCESSING-CNTL   PIC X.
   936                 88  PI-AR-PROCESSING        VALUE 'Y'.
   937             20  PI-AR-SUMMARY-CODE      PIC X(6).
   938             20  PI-AR-MONTH-END-DT      PIC XX.
   939
   940         16  PI-MP-SYSTEM.
   941             20  PI-MORTGAGE-USER            PIC X.
   942                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   943                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   944             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   945                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   946                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   947                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   948                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   949                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   950             20  PI-MP-MONTH-END-DT          PIC XX.
   951             20  PI-MP-REFERENCE-NO.
   952                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   953                 24  PI-MP-REFERENCE-SFX     PIC XX.
   954
   955         16  PI-LABEL-CONTROL            PIC X(01).
   956             88  PI-CREATE-LABELS                    VALUE 'Y'.
   957             88  PI-BYPASS-LABELS                    VALUE 'N'.
   958
   959         16  PI-BILL-GROUPING-CODE       PIC X(01).
   960             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   961
   962         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   963             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   964             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   965
   966         16  FILLER                      PIC X(14).
   967
   968     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   969******************************************************************
   970     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   971         16  PI-PYAJ-FILE-SW             PIC  X.
   972             88  END-OF-ACCT                 VALUE 'A'.
   973             88  END-OF-ACCT-FULL-PAGE       VALUE 'B'.
   974             88  END-OF-FILE                 VALUE 'X'.
   975             88  TOP-OF-FILE                 VALUE 'T'.
   976             88  PAGE-FULL                   VALUE 'F'.
   977             88  NO-RECORDS                  VALUE 'Y'.
   978             88  NOT-OPEN                    VALUE 'Z'.
   979         16  PI-PREV-FUNCTION            PIC  X.
   980         16  PI-SAV-FUNCTION             PIC  X.
   981         16  PI-PREV-PFKEY               PIC  X.
   982         16  PI-SEQ-NOS.
   983             20  FILLER  OCCURS 13 TIMES
   984                             INDEXED BY NDX.
   985                 24  PI-REC-TYPE         PIC  X.
   986                 24  PI-FILE-SEQ-NO      PIC  S9(8)       COMP.
   987         16  PI-SAV-ENDING-PYAJ-KEY.
   988             20  PI-SAV-COMP-CD          PIC  X.
   989             20  PI-SAV-COMP-CONTROL.
   990                 24  PI-SAV-CARRIER      PIC  X.
   991                 24  PI-SAV-GROUPING     PIC  X(6).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  23
* EL633.cbl
   992                 24  PI-SAV-FIN-RESP     PIC  X(10).
   993                 24  PI-SAV-ACCOUNT      PIC  X(10).
   994                 24  PI-SAV-FILE-SEQ-NO  PIC  S9(8)          COMP.
   995                 24  PI-SAV-RECORD-TYPE  PIC  X.
   996         16  PI-START-PYAJ-KEY           PIC  X(33).
   997         16  PI-SAV-ACCT-AMT             PIC  S9(7)V99.
   998         16  PI-SAV-ACCT-NET             PIC  S9(7)V99.
   999         16  PI-SAV-PREV-AMT             PIC  S9(7)V99.
  1000         16  PI-SAV-PREV-NET             PIC  S9(7)V99.
  1001         16  PI-TOTAL-DISPLAYED-SW       PIC  X.
  1002             88  PI-TOTAL-DISPLAYED               VALUE 'Y'.
  1003         16  PI-FULL-INDX                PIC  S9(4)      COMP.
  1004         16  PI-FRST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1005         16  PI-FRST-RECORD-TYPE         PIC  X.
  1006         16  PI-PREV-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1007         16  PI-PREV-RECORD-TYPE         PIC  X.
  1008         16  PI-LAST-FILE-SEQ-NO         PIC  S9(8)          COMP.
  1009         16  PI-LAST-RECORD-TYPE         PIC  X.
  1010         16  PI-PAGE-SW                  PIC  X.
  1011             88  FIRST-PAGE                          VALUE 'Y'.
  1012         16  FILLER                      PIC  X(450).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  24
* EL633.cbl
  1014*                            COPY ELCJPFX.
  1015******************************************************************
  1016*                                                                *
  1017*                                                                *
  1018*                            ELCJPFX.                            *
  1019*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1020*                            VMOD=2.002                          *
  1021*                                                                *
  1022*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1023*                                                                *
  1024*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1025*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1026*        ELCNTL - CONTROL FILE                                   *
  1027*        ELMSTR - CLAIM MASTERS                                  *
  1028*        ELTRLR - ACTIVITY TRAILERS                              *
  1029*        ELCHKQ - CHECK QUE                                      *
  1030******************************************************************
  1031 01  JOURNAL-RECORD.
  1032     12  JP-USER-ID                  PIC X(4).
  1033     12  JP-FILE-ID                  PIC X(8).
  1034     12  JP-PROGRAM-ID               PIC X(8).
  1035     12  JP-RECORD-TYPE              PIC X.
  1036         88 JP-ADD              VALUE 'A'.
  1037         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1038         88 JP-AFTER-CHANGE     VALUE 'C'.
  1039         88 JP-DELETE           VALUE 'D'.
  1040         88 JP-GENERIC-DELETE   VALUE 'G'.
  1041         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1042         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1043     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1044     12  JP-RECORD-AREA
  1045
  1046
  1047                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  25
* EL633.cbl
  1049*                            COPY ELCAID.
  1050******************************************************************
  1051*                                                                *
  1052*                            ELCAID.                             *
  1053*                            VMOD=2.001                          *
  1054*                                                                *
  1055*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1056*                                                                *
  1057*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1058*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1059******************************************************************
  1060
  1061 01  DFHAID.
  1062   02  DFHNULL   PIC  X  VALUE  ' '.
  1063   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1064   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1065   02  DFHPEN    PIC  X  VALUE  '='.
  1066   02  DFHOPID   PIC  X  VALUE  'W'.
  1067   02  DFHPA1    PIC  X  VALUE  '%'.
  1068   02  DFHPA2    PIC  X  VALUE  '>'.
  1069   02  DFHPA3    PIC  X  VALUE  ','.
  1070   02  DFHPF1    PIC  X  VALUE  '1'.
  1071   02  DFHPF2    PIC  X  VALUE  '2'.
  1072   02  DFHPF3    PIC  X  VALUE  '3'.
  1073   02  DFHPF4    PIC  X  VALUE  '4'.
  1074   02  DFHPF5    PIC  X  VALUE  '5'.
  1075   02  DFHPF6    PIC  X  VALUE  '6'.
  1076   02  DFHPF7    PIC  X  VALUE  '7'.
  1077   02  DFHPF8    PIC  X  VALUE  '8'.
  1078   02  DFHPF9    PIC  X  VALUE  '9'.
  1079   02  DFHPF10   PIC  X  VALUE  ':'.
  1080   02  DFHPF11   PIC  X  VALUE  '#'.
  1081   02  DFHPF12   PIC  X  VALUE  '@'.
  1082   02  DFHPF13   PIC  X  VALUE  'A'.
  1083   02  DFHPF14   PIC  X  VALUE  'B'.
  1084   02  DFHPF15   PIC  X  VALUE  'C'.
  1085   02  DFHPF16   PIC  X  VALUE  'D'.
  1086   02  DFHPF17   PIC  X  VALUE  'E'.
  1087   02  DFHPF18   PIC  X  VALUE  'F'.
  1088   02  DFHPF19   PIC  X  VALUE  'G'.
  1089   02  DFHPF20   PIC  X  VALUE  'H'.
  1090   02  DFHPF21   PIC  X  VALUE  'I'.
  1091*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1092   02  DFHPF22   PIC  X  VALUE  '['.
  1093   02  DFHPF23   PIC  X  VALUE  '.'.
  1094   02  DFHPF24   PIC  X  VALUE  '<'.
  1095   02  DFHMSRE   PIC  X  VALUE  'X'.
  1096   02  DFHSTRF   PIC  X  VALUE  'h'.
  1097   02  DFHTRIG   PIC  X  VALUE  '"'.
  1098
  1099 01  FILLER  REDEFINES  DFHAID.
  1100     12  FILLER              PIC  X(8).
  1101     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  26
* EL633.cbl
  1103*                            COPY EL633S.
  1104 01  EL633AI.
  1105     05  FILLER            PIC  X(0012).
  1106*    -------------------------------
  1107     05  DATEL PIC S9(0004) COMP.
  1108     05  DATEF PIC  X(0001).
  1109     05  FILLER REDEFINES DATEF.
  1110         10  DATEA PIC  X(0001).
  1111     05  DATEI PIC  X(0008).
  1112*    -------------------------------
  1113     05  TIMEL PIC S9(0004) COMP.
  1114     05  TIMEF PIC  X(0001).
  1115     05  FILLER REDEFINES TIMEF.
  1116         10  TIMEA PIC  X(0001).
  1117     05  TIMEI PIC  X(0005).
  1118*    -------------------------------
  1119     05  CMPNYIDL PIC S9(0004) COMP.
  1120     05  CMPNYIDF PIC  X(0001).
  1121     05  FILLER REDEFINES CMPNYIDF.
  1122         10  CMPNYIDA PIC  X(0001).
  1123     05  CMPNYIDI PIC  X(0003).
  1124*    -------------------------------
  1125     05  USERIDL PIC S9(0004) COMP.
  1126     05  USERIDF PIC  X(0001).
  1127     05  FILLER REDEFINES USERIDF.
  1128         10  USERIDA PIC  X(0001).
  1129     05  USERIDI PIC  X(0004).
  1130*    -------------------------------
  1131     05  MAINTL PIC S9(0004) COMP.
  1132     05  MAINTF PIC  X(0001).
  1133     05  FILLER REDEFINES MAINTF.
  1134         10  MAINTA PIC  X(0001).
  1135     05  MAINTI PIC  X(0001).
  1136*    -------------------------------
  1137     05  CARRIERL PIC S9(0004) COMP.
  1138     05  CARRIERF PIC  X(0001).
  1139     05  FILLER REDEFINES CARRIERF.
  1140         10  CARRIERA PIC  X(0001).
  1141     05  CARRIERI PIC  X(0001).
  1142*    -------------------------------
  1143     05  GROUPL PIC S9(0004) COMP.
  1144     05  GROUPF PIC  X(0001).
  1145     05  FILLER REDEFINES GROUPF.
  1146         10  GROUPA PIC  X(0001).
  1147     05  GROUPI PIC  X(0006).
  1148*    -------------------------------
  1149     05  FINRESPL PIC S9(0004) COMP.
  1150     05  FINRESPF PIC  X(0001).
  1151     05  FILLER REDEFINES FINRESPF.
  1152         10  FINRESPA PIC  X(0001).
  1153     05  FINRESPI PIC  X(0010).
  1154*    -------------------------------
  1155     05  ACCTL PIC S9(0004) COMP.
  1156     05  ACCTF PIC  X(0001).
  1157     05  FILLER REDEFINES ACCTF.
  1158         10  ACCTA PIC  X(0001).
  1159     05  ACCTI PIC  X(0010).
  1160*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  27
* EL633.cbl
  1161     05  MSAAC1L PIC S9(0004) COMP.
  1162     05  MSAAC1F PIC  X(0001).
  1163     05  FILLER REDEFINES MSAAC1F.
  1164         10  MSAAC1A PIC  X(0001).
  1165     05  MSAAC1I PIC  X(0010).
  1166*    -------------------------------
  1167     05  MSAST1L PIC S9(0004) COMP.
  1168     05  MSAST1F PIC  X(0001).
  1169     05  FILLER REDEFINES MSAST1F.
  1170         10  MSAST1A PIC  X(0001).
  1171     05  MSAST1I PIC  X(0002).
  1172*    -------------------------------
  1173     05  MSACN1L PIC S9(0004) COMP.
  1174     05  MSACN1F PIC  X(0001).
  1175     05  FILLER REDEFINES MSACN1F.
  1176         10  MSACN1A PIC  X(0001).
  1177     05  MSACN1I PIC  X(0001).
  1178*    -------------------------------
  1179     05  MSACM1L PIC S9(0004) COMP.
  1180     05  MSACM1F PIC  X(0001).
  1181     05  FILLER REDEFINES MSACM1F.
  1182         10  MSACM1A PIC  X(0001).
  1183     05  MSACM1I PIC  X(0010).
  1184*    -------------------------------
  1185     05  TYPE1L PIC S9(0004) COMP.
  1186     05  TYPE1F PIC  X(0001).
  1187     05  FILLER REDEFINES TYPE1F.
  1188         10  TYPE1A PIC  X(0001).
  1189     05  TYPE1I PIC  X(0001).
  1190*    -------------------------------
  1191     05  AMT1L PIC S9(0004) COMP.
  1192     05  AMT1F PIC  X(0001).
  1193     05  FILLER REDEFINES AMT1F.
  1194         10  AMT1A PIC  X(0001).
  1195     05  AMT1I PIC  X(0011).
  1196*    -------------------------------
  1197     05  VOID1L PIC S9(0004) COMP.
  1198     05  VOID1F PIC  X(0001).
  1199     05  FILLER REDEFINES VOID1F.
  1200         10  VOID1A PIC  X(0001).
  1201     05  VOID1I PIC  X(0001).
  1202*    -------------------------------
  1203     05  MDT1L PIC S9(0004) COMP.
  1204     05  MDT1F PIC  X(0001).
  1205     05  FILLER REDEFINES MDT1F.
  1206         10  MDT1A PIC  X(0001).
  1207     05  MDT1I PIC  X(0006).
  1208*    -------------------------------
  1209     05  BDT1L PIC S9(0004) COMP.
  1210     05  BDT1F PIC  X(0001).
  1211     05  FILLER REDEFINES BDT1F.
  1212         10  BDT1A PIC  X(0001).
  1213     05  BDT1I PIC  X(0006).
  1214*    -------------------------------
  1215     05  SDT1L PIC S9(0004) COMP.
  1216     05  SDT1F PIC  X(0001).
  1217     05  FILLER REDEFINES SDT1F.
  1218         10  SDT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  28
* EL633.cbl
  1219     05  SDT1I PIC  X(0006).
  1220*    -------------------------------
  1221     05  MSAAC2L PIC S9(0004) COMP.
  1222     05  MSAAC2F PIC  X(0001).
  1223     05  FILLER REDEFINES MSAAC2F.
  1224         10  MSAAC2A PIC  X(0001).
  1225     05  MSAAC2I PIC  X(0010).
  1226*    -------------------------------
  1227     05  MSAST2L PIC S9(0004) COMP.
  1228     05  MSAST2F PIC  X(0001).
  1229     05  FILLER REDEFINES MSAST2F.
  1230         10  MSAST2A PIC  X(0001).
  1231     05  MSAST2I PIC  X(0002).
  1232*    -------------------------------
  1233     05  MSACN2L PIC S9(0004) COMP.
  1234     05  MSACN2F PIC  X(0001).
  1235     05  FILLER REDEFINES MSACN2F.
  1236         10  MSACN2A PIC  X(0001).
  1237     05  MSACN2I PIC  X(0001).
  1238*    -------------------------------
  1239     05  MSACM2L PIC S9(0004) COMP.
  1240     05  MSACM2F PIC  X(0001).
  1241     05  FILLER REDEFINES MSACM2F.
  1242         10  MSACM2A PIC  X(0001).
  1243     05  MSACM2I PIC  X(0010).
  1244*    -------------------------------
  1245     05  TYPE2L PIC S9(0004) COMP.
  1246     05  TYPE2F PIC  X(0001).
  1247     05  FILLER REDEFINES TYPE2F.
  1248         10  TYPE2A PIC  X(0001).
  1249     05  TYPE2I PIC  X(0001).
  1250*    -------------------------------
  1251     05  AMT2L PIC S9(0004) COMP.
  1252     05  AMT2F PIC  X(0001).
  1253     05  FILLER REDEFINES AMT2F.
  1254         10  AMT2A PIC  X(0001).
  1255     05  AMT2I PIC  X(0011).
  1256*    -------------------------------
  1257     05  VOID2L PIC S9(0004) COMP.
  1258     05  VOID2F PIC  X(0001).
  1259     05  FILLER REDEFINES VOID2F.
  1260         10  VOID2A PIC  X(0001).
  1261     05  VOID2I PIC  X(0001).
  1262*    -------------------------------
  1263     05  MDT2L PIC S9(0004) COMP.
  1264     05  MDT2F PIC  X(0001).
  1265     05  FILLER REDEFINES MDT2F.
  1266         10  MDT2A PIC  X(0001).
  1267     05  MDT2I PIC  X(0006).
  1268*    -------------------------------
  1269     05  BDT2L PIC S9(0004) COMP.
  1270     05  BDT2F PIC  X(0001).
  1271     05  FILLER REDEFINES BDT2F.
  1272         10  BDT2A PIC  X(0001).
  1273     05  BDT2I PIC  X(0006).
  1274*    -------------------------------
  1275     05  SDT2L PIC S9(0004) COMP.
  1276     05  SDT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  29
* EL633.cbl
  1277     05  FILLER REDEFINES SDT2F.
  1278         10  SDT2A PIC  X(0001).
  1279     05  SDT2I PIC  X(0006).
  1280*    -------------------------------
  1281     05  MSAAC3L PIC S9(0004) COMP.
  1282     05  MSAAC3F PIC  X(0001).
  1283     05  FILLER REDEFINES MSAAC3F.
  1284         10  MSAAC3A PIC  X(0001).
  1285     05  MSAAC3I PIC  X(0010).
  1286*    -------------------------------
  1287     05  MSAST3L PIC S9(0004) COMP.
  1288     05  MSAST3F PIC  X(0001).
  1289     05  FILLER REDEFINES MSAST3F.
  1290         10  MSAST3A PIC  X(0001).
  1291     05  MSAST3I PIC  X(0002).
  1292*    -------------------------------
  1293     05  MSACN3L PIC S9(0004) COMP.
  1294     05  MSACN3F PIC  X(0001).
  1295     05  FILLER REDEFINES MSACN3F.
  1296         10  MSACN3A PIC  X(0001).
  1297     05  MSACN3I PIC  X(0001).
  1298*    -------------------------------
  1299     05  MSACM3L PIC S9(0004) COMP.
  1300     05  MSACM3F PIC  X(0001).
  1301     05  FILLER REDEFINES MSACM3F.
  1302         10  MSACM3A PIC  X(0001).
  1303     05  MSACM3I PIC  X(0010).
  1304*    -------------------------------
  1305     05  TYPE3L PIC S9(0004) COMP.
  1306     05  TYPE3F PIC  X(0001).
  1307     05  FILLER REDEFINES TYPE3F.
  1308         10  TYPE3A PIC  X(0001).
  1309     05  TYPE3I PIC  X(0001).
  1310*    -------------------------------
  1311     05  AMT3L PIC S9(0004) COMP.
  1312     05  AMT3F PIC  X(0001).
  1313     05  FILLER REDEFINES AMT3F.
  1314         10  AMT3A PIC  X(0001).
  1315     05  AMT3I PIC  X(0011).
  1316*    -------------------------------
  1317     05  VOID3L PIC S9(0004) COMP.
  1318     05  VOID3F PIC  X(0001).
  1319     05  FILLER REDEFINES VOID3F.
  1320         10  VOID3A PIC  X(0001).
  1321     05  VOID3I PIC  X(0001).
  1322*    -------------------------------
  1323     05  MDT3L PIC S9(0004) COMP.
  1324     05  MDT3F PIC  X(0001).
  1325     05  FILLER REDEFINES MDT3F.
  1326         10  MDT3A PIC  X(0001).
  1327     05  MDT3I PIC  X(0006).
  1328*    -------------------------------
  1329     05  BDT3L PIC S9(0004) COMP.
  1330     05  BDT3F PIC  X(0001).
  1331     05  FILLER REDEFINES BDT3F.
  1332         10  BDT3A PIC  X(0001).
  1333     05  BDT3I PIC  X(0006).
  1334*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  30
* EL633.cbl
  1335     05  SDT3L PIC S9(0004) COMP.
  1336     05  SDT3F PIC  X(0001).
  1337     05  FILLER REDEFINES SDT3F.
  1338         10  SDT3A PIC  X(0001).
  1339     05  SDT3I PIC  X(0006).
  1340*    -------------------------------
  1341     05  MSAAC4L PIC S9(0004) COMP.
  1342     05  MSAAC4F PIC  X(0001).
  1343     05  FILLER REDEFINES MSAAC4F.
  1344         10  MSAAC4A PIC  X(0001).
  1345     05  MSAAC4I PIC  X(0010).
  1346*    -------------------------------
  1347     05  MSAST4L PIC S9(0004) COMP.
  1348     05  MSAST4F PIC  X(0001).
  1349     05  FILLER REDEFINES MSAST4F.
  1350         10  MSAST4A PIC  X(0001).
  1351     05  MSAST4I PIC  X(0002).
  1352*    -------------------------------
  1353     05  MSACN4L PIC S9(0004) COMP.
  1354     05  MSACN4F PIC  X(0001).
  1355     05  FILLER REDEFINES MSACN4F.
  1356         10  MSACN4A PIC  X(0001).
  1357     05  MSACN4I PIC  X(0001).
  1358*    -------------------------------
  1359     05  MSACM4L PIC S9(0004) COMP.
  1360     05  MSACM4F PIC  X(0001).
  1361     05  FILLER REDEFINES MSACM4F.
  1362         10  MSACM4A PIC  X(0001).
  1363     05  MSACM4I PIC  X(0010).
  1364*    -------------------------------
  1365     05  TYPE4L PIC S9(0004) COMP.
  1366     05  TYPE4F PIC  X(0001).
  1367     05  FILLER REDEFINES TYPE4F.
  1368         10  TYPE4A PIC  X(0001).
  1369     05  TYPE4I PIC  X(0001).
  1370*    -------------------------------
  1371     05  AMT4L PIC S9(0004) COMP.
  1372     05  AMT4F PIC  X(0001).
  1373     05  FILLER REDEFINES AMT4F.
  1374         10  AMT4A PIC  X(0001).
  1375     05  AMT4I PIC  X(0011).
  1376*    -------------------------------
  1377     05  VOID4L PIC S9(0004) COMP.
  1378     05  VOID4F PIC  X(0001).
  1379     05  FILLER REDEFINES VOID4F.
  1380         10  VOID4A PIC  X(0001).
  1381     05  VOID4I PIC  X(0001).
  1382*    -------------------------------
  1383     05  MDT4L PIC S9(0004) COMP.
  1384     05  MDT4F PIC  X(0001).
  1385     05  FILLER REDEFINES MDT4F.
  1386         10  MDT4A PIC  X(0001).
  1387     05  MDT4I PIC  X(0006).
  1388*    -------------------------------
  1389     05  BDT4L PIC S9(0004) COMP.
  1390     05  BDT4F PIC  X(0001).
  1391     05  FILLER REDEFINES BDT4F.
  1392         10  BDT4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  31
* EL633.cbl
  1393     05  BDT4I PIC  X(0006).
  1394*    -------------------------------
  1395     05  SDT4L PIC S9(0004) COMP.
  1396     05  SDT4F PIC  X(0001).
  1397     05  FILLER REDEFINES SDT4F.
  1398         10  SDT4A PIC  X(0001).
  1399     05  SDT4I PIC  X(0006).
  1400*    -------------------------------
  1401     05  MSAAC5L PIC S9(0004) COMP.
  1402     05  MSAAC5F PIC  X(0001).
  1403     05  FILLER REDEFINES MSAAC5F.
  1404         10  MSAAC5A PIC  X(0001).
  1405     05  MSAAC5I PIC  X(0010).
  1406*    -------------------------------
  1407     05  MSAST5L PIC S9(0004) COMP.
  1408     05  MSAST5F PIC  X(0001).
  1409     05  FILLER REDEFINES MSAST5F.
  1410         10  MSAST5A PIC  X(0001).
  1411     05  MSAST5I PIC  X(0002).
  1412*    -------------------------------
  1413     05  MSACN5L PIC S9(0004) COMP.
  1414     05  MSACN5F PIC  X(0001).
  1415     05  FILLER REDEFINES MSACN5F.
  1416         10  MSACN5A PIC  X(0001).
  1417     05  MSACN5I PIC  X(0001).
  1418*    -------------------------------
  1419     05  MSACM5L PIC S9(0004) COMP.
  1420     05  MSACM5F PIC  X(0001).
  1421     05  FILLER REDEFINES MSACM5F.
  1422         10  MSACM5A PIC  X(0001).
  1423     05  MSACM5I PIC  X(0010).
  1424*    -------------------------------
  1425     05  TYPE5L PIC S9(0004) COMP.
  1426     05  TYPE5F PIC  X(0001).
  1427     05  FILLER REDEFINES TYPE5F.
  1428         10  TYPE5A PIC  X(0001).
  1429     05  TYPE5I PIC  X(0001).
  1430*    -------------------------------
  1431     05  AMT5L PIC S9(0004) COMP.
  1432     05  AMT5F PIC  X(0001).
  1433     05  FILLER REDEFINES AMT5F.
  1434         10  AMT5A PIC  X(0001).
  1435     05  AMT5I PIC  X(0011).
  1436*    -------------------------------
  1437     05  VOID5L PIC S9(0004) COMP.
  1438     05  VOID5F PIC  X(0001).
  1439     05  FILLER REDEFINES VOID5F.
  1440         10  VOID5A PIC  X(0001).
  1441     05  VOID5I PIC  X(0001).
  1442*    -------------------------------
  1443     05  MDT5L PIC S9(0004) COMP.
  1444     05  MDT5F PIC  X(0001).
  1445     05  FILLER REDEFINES MDT5F.
  1446         10  MDT5A PIC  X(0001).
  1447     05  MDT5I PIC  X(0006).
  1448*    -------------------------------
  1449     05  BDT5L PIC S9(0004) COMP.
  1450     05  BDT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  32
* EL633.cbl
  1451     05  FILLER REDEFINES BDT5F.
  1452         10  BDT5A PIC  X(0001).
  1453     05  BDT5I PIC  X(0006).
  1454*    -------------------------------
  1455     05  SDT5L PIC S9(0004) COMP.
  1456     05  SDT5F PIC  X(0001).
  1457     05  FILLER REDEFINES SDT5F.
  1458         10  SDT5A PIC  X(0001).
  1459     05  SDT5I PIC  X(0006).
  1460*    -------------------------------
  1461     05  MSAAC6L PIC S9(0004) COMP.
  1462     05  MSAAC6F PIC  X(0001).
  1463     05  FILLER REDEFINES MSAAC6F.
  1464         10  MSAAC6A PIC  X(0001).
  1465     05  MSAAC6I PIC  X(0010).
  1466*    -------------------------------
  1467     05  MSAST6L PIC S9(0004) COMP.
  1468     05  MSAST6F PIC  X(0001).
  1469     05  FILLER REDEFINES MSAST6F.
  1470         10  MSAST6A PIC  X(0001).
  1471     05  MSAST6I PIC  X(0002).
  1472*    -------------------------------
  1473     05  MSACN6L PIC S9(0004) COMP.
  1474     05  MSACN6F PIC  X(0001).
  1475     05  FILLER REDEFINES MSACN6F.
  1476         10  MSACN6A PIC  X(0001).
  1477     05  MSACN6I PIC  X(0001).
  1478*    -------------------------------
  1479     05  MSACM6L PIC S9(0004) COMP.
  1480     05  MSACM6F PIC  X(0001).
  1481     05  FILLER REDEFINES MSACM6F.
  1482         10  MSACM6A PIC  X(0001).
  1483     05  MSACM6I PIC  X(0010).
  1484*    -------------------------------
  1485     05  TYPE6L PIC S9(0004) COMP.
  1486     05  TYPE6F PIC  X(0001).
  1487     05  FILLER REDEFINES TYPE6F.
  1488         10  TYPE6A PIC  X(0001).
  1489     05  TYPE6I PIC  X(0001).
  1490*    -------------------------------
  1491     05  AMT6L PIC S9(0004) COMP.
  1492     05  AMT6F PIC  X(0001).
  1493     05  FILLER REDEFINES AMT6F.
  1494         10  AMT6A PIC  X(0001).
  1495     05  AMT6I PIC  X(0011).
  1496*    -------------------------------
  1497     05  VOID6L PIC S9(0004) COMP.
  1498     05  VOID6F PIC  X(0001).
  1499     05  FILLER REDEFINES VOID6F.
  1500         10  VOID6A PIC  X(0001).
  1501     05  VOID6I PIC  X(0001).
  1502*    -------------------------------
  1503     05  MDT6L PIC S9(0004) COMP.
  1504     05  MDT6F PIC  X(0001).
  1505     05  FILLER REDEFINES MDT6F.
  1506         10  MDT6A PIC  X(0001).
  1507     05  MDT6I PIC  X(0006).
  1508*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  33
* EL633.cbl
  1509     05  BDT6L PIC S9(0004) COMP.
  1510     05  BDT6F PIC  X(0001).
  1511     05  FILLER REDEFINES BDT6F.
  1512         10  BDT6A PIC  X(0001).
  1513     05  BDT6I PIC  X(0006).
  1514*    -------------------------------
  1515     05  SDT6L PIC S9(0004) COMP.
  1516     05  SDT6F PIC  X(0001).
  1517     05  FILLER REDEFINES SDT6F.
  1518         10  SDT6A PIC  X(0001).
  1519     05  SDT6I PIC  X(0006).
  1520*    -------------------------------
  1521     05  MSAAC7L PIC S9(0004) COMP.
  1522     05  MSAAC7F PIC  X(0001).
  1523     05  FILLER REDEFINES MSAAC7F.
  1524         10  MSAAC7A PIC  X(0001).
  1525     05  MSAAC7I PIC  X(0010).
  1526*    -------------------------------
  1527     05  MSAST7L PIC S9(0004) COMP.
  1528     05  MSAST7F PIC  X(0001).
  1529     05  FILLER REDEFINES MSAST7F.
  1530         10  MSAST7A PIC  X(0001).
  1531     05  MSAST7I PIC  X(0002).
  1532*    -------------------------------
  1533     05  MSACN7L PIC S9(0004) COMP.
  1534     05  MSACN7F PIC  X(0001).
  1535     05  FILLER REDEFINES MSACN7F.
  1536         10  MSACN7A PIC  X(0001).
  1537     05  MSACN7I PIC  X(0001).
  1538*    -------------------------------
  1539     05  MSACM7L PIC S9(0004) COMP.
  1540     05  MSACM7F PIC  X(0001).
  1541     05  FILLER REDEFINES MSACM7F.
  1542         10  MSACM7A PIC  X(0001).
  1543     05  MSACM7I PIC  X(0010).
  1544*    -------------------------------
  1545     05  TYPE7L PIC S9(0004) COMP.
  1546     05  TYPE7F PIC  X(0001).
  1547     05  FILLER REDEFINES TYPE7F.
  1548         10  TYPE7A PIC  X(0001).
  1549     05  TYPE7I PIC  X(0001).
  1550*    -------------------------------
  1551     05  AMT7L PIC S9(0004) COMP.
  1552     05  AMT7F PIC  X(0001).
  1553     05  FILLER REDEFINES AMT7F.
  1554         10  AMT7A PIC  X(0001).
  1555     05  AMT7I PIC  X(0011).
  1556*    -------------------------------
  1557     05  VOID7L PIC S9(0004) COMP.
  1558     05  VOID7F PIC  X(0001).
  1559     05  FILLER REDEFINES VOID7F.
  1560         10  VOID7A PIC  X(0001).
  1561     05  VOID7I PIC  X(0001).
  1562*    -------------------------------
  1563     05  MDT7L PIC S9(0004) COMP.
  1564     05  MDT7F PIC  X(0001).
  1565     05  FILLER REDEFINES MDT7F.
  1566         10  MDT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  34
* EL633.cbl
  1567     05  MDT7I PIC  X(0006).
  1568*    -------------------------------
  1569     05  BDT7L PIC S9(0004) COMP.
  1570     05  BDT7F PIC  X(0001).
  1571     05  FILLER REDEFINES BDT7F.
  1572         10  BDT7A PIC  X(0001).
  1573     05  BDT7I PIC  X(0006).
  1574*    -------------------------------
  1575     05  SDT7L PIC S9(0004) COMP.
  1576     05  SDT7F PIC  X(0001).
  1577     05  FILLER REDEFINES SDT7F.
  1578         10  SDT7A PIC  X(0001).
  1579     05  SDT7I PIC  X(0006).
  1580*    -------------------------------
  1581     05  MSAAC8L PIC S9(0004) COMP.
  1582     05  MSAAC8F PIC  X(0001).
  1583     05  FILLER REDEFINES MSAAC8F.
  1584         10  MSAAC8A PIC  X(0001).
  1585     05  MSAAC8I PIC  X(0010).
  1586*    -------------------------------
  1587     05  MSAST8L PIC S9(0004) COMP.
  1588     05  MSAST8F PIC  X(0001).
  1589     05  FILLER REDEFINES MSAST8F.
  1590         10  MSAST8A PIC  X(0001).
  1591     05  MSAST8I PIC  X(0002).
  1592*    -------------------------------
  1593     05  MSACN8L PIC S9(0004) COMP.
  1594     05  MSACN8F PIC  X(0001).
  1595     05  FILLER REDEFINES MSACN8F.
  1596         10  MSACN8A PIC  X(0001).
  1597     05  MSACN8I PIC  X(0001).
  1598*    -------------------------------
  1599     05  MSACM8L PIC S9(0004) COMP.
  1600     05  MSACM8F PIC  X(0001).
  1601     05  FILLER REDEFINES MSACM8F.
  1602         10  MSACM8A PIC  X(0001).
  1603     05  MSACM8I PIC  X(0010).
  1604*    -------------------------------
  1605     05  TYPE8L PIC S9(0004) COMP.
  1606     05  TYPE8F PIC  X(0001).
  1607     05  FILLER REDEFINES TYPE8F.
  1608         10  TYPE8A PIC  X(0001).
  1609     05  TYPE8I PIC  X(0001).
  1610*    -------------------------------
  1611     05  AMT8L PIC S9(0004) COMP.
  1612     05  AMT8F PIC  X(0001).
  1613     05  FILLER REDEFINES AMT8F.
  1614         10  AMT8A PIC  X(0001).
  1615     05  AMT8I PIC  X(0011).
  1616*    -------------------------------
  1617     05  VOID8L PIC S9(0004) COMP.
  1618     05  VOID8F PIC  X(0001).
  1619     05  FILLER REDEFINES VOID8F.
  1620         10  VOID8A PIC  X(0001).
  1621     05  VOID8I PIC  X(0001).
  1622*    -------------------------------
  1623     05  MDT8L PIC S9(0004) COMP.
  1624     05  MDT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  35
* EL633.cbl
  1625     05  FILLER REDEFINES MDT8F.
  1626         10  MDT8A PIC  X(0001).
  1627     05  MDT8I PIC  X(0006).
  1628*    -------------------------------
  1629     05  BDT8L PIC S9(0004) COMP.
  1630     05  BDT8F PIC  X(0001).
  1631     05  FILLER REDEFINES BDT8F.
  1632         10  BDT8A PIC  X(0001).
  1633     05  BDT8I PIC  X(0006).
  1634*    -------------------------------
  1635     05  SDT8L PIC S9(0004) COMP.
  1636     05  SDT8F PIC  X(0001).
  1637     05  FILLER REDEFINES SDT8F.
  1638         10  SDT8A PIC  X(0001).
  1639     05  SDT8I PIC  X(0006).
  1640*    -------------------------------
  1641     05  MSAAC9L PIC S9(0004) COMP.
  1642     05  MSAAC9F PIC  X(0001).
  1643     05  FILLER REDEFINES MSAAC9F.
  1644         10  MSAAC9A PIC  X(0001).
  1645     05  MSAAC9I PIC  X(0010).
  1646*    -------------------------------
  1647     05  MSAST9L PIC S9(0004) COMP.
  1648     05  MSAST9F PIC  X(0001).
  1649     05  FILLER REDEFINES MSAST9F.
  1650         10  MSAST9A PIC  X(0001).
  1651     05  MSAST9I PIC  X(0002).
  1652*    -------------------------------
  1653     05  MSACN9L PIC S9(0004) COMP.
  1654     05  MSACN9F PIC  X(0001).
  1655     05  FILLER REDEFINES MSACN9F.
  1656         10  MSACN9A PIC  X(0001).
  1657     05  MSACN9I PIC  X(0001).
  1658*    -------------------------------
  1659     05  MSACM9L PIC S9(0004) COMP.
  1660     05  MSACM9F PIC  X(0001).
  1661     05  FILLER REDEFINES MSACM9F.
  1662         10  MSACM9A PIC  X(0001).
  1663     05  MSACM9I PIC  X(0010).
  1664*    -------------------------------
  1665     05  TYPE9L PIC S9(0004) COMP.
  1666     05  TYPE9F PIC  X(0001).
  1667     05  FILLER REDEFINES TYPE9F.
  1668         10  TYPE9A PIC  X(0001).
  1669     05  TYPE9I PIC  X(0001).
  1670*    -------------------------------
  1671     05  AMT9L PIC S9(0004) COMP.
  1672     05  AMT9F PIC  X(0001).
  1673     05  FILLER REDEFINES AMT9F.
  1674         10  AMT9A PIC  X(0001).
  1675     05  AMT9I PIC  X(0011).
  1676*    -------------------------------
  1677     05  VOID9L PIC S9(0004) COMP.
  1678     05  VOID9F PIC  X(0001).
  1679     05  FILLER REDEFINES VOID9F.
  1680         10  VOID9A PIC  X(0001).
  1681     05  VOID9I PIC  X(0001).
  1682*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  36
* EL633.cbl
  1683     05  MDT9L PIC S9(0004) COMP.
  1684     05  MDT9F PIC  X(0001).
  1685     05  FILLER REDEFINES MDT9F.
  1686         10  MDT9A PIC  X(0001).
  1687     05  MDT9I PIC  X(0006).
  1688*    -------------------------------
  1689     05  BDT9L PIC S9(0004) COMP.
  1690     05  BDT9F PIC  X(0001).
  1691     05  FILLER REDEFINES BDT9F.
  1692         10  BDT9A PIC  X(0001).
  1693     05  BDT9I PIC  X(0006).
  1694*    -------------------------------
  1695     05  SDT9L PIC S9(0004) COMP.
  1696     05  SDT9F PIC  X(0001).
  1697     05  FILLER REDEFINES SDT9F.
  1698         10  SDT9A PIC  X(0001).
  1699     05  SDT9I PIC  X(0006).
  1700*    -------------------------------
  1701     05  MSAAC10L PIC S9(0004) COMP.
  1702     05  MSAAC10F PIC  X(0001).
  1703     05  FILLER REDEFINES MSAAC10F.
  1704         10  MSAAC10A PIC  X(0001).
  1705     05  MSAAC10I PIC  X(0010).
  1706*    -------------------------------
  1707     05  MSAST10L PIC S9(0004) COMP.
  1708     05  MSAST10F PIC  X(0001).
  1709     05  FILLER REDEFINES MSAST10F.
  1710         10  MSAST10A PIC  X(0001).
  1711     05  MSAST10I PIC  X(0002).
  1712*    -------------------------------
  1713     05  MSACN10L PIC S9(0004) COMP.
  1714     05  MSACN10F PIC  X(0001).
  1715     05  FILLER REDEFINES MSACN10F.
  1716         10  MSACN10A PIC  X(0001).
  1717     05  MSACN10I PIC  X(0001).
  1718*    -------------------------------
  1719     05  MSACM10L PIC S9(0004) COMP.
  1720     05  MSACM10F PIC  X(0001).
  1721     05  FILLER REDEFINES MSACM10F.
  1722         10  MSACM10A PIC  X(0001).
  1723     05  MSACM10I PIC  X(0010).
  1724*    -------------------------------
  1725     05  TYPE10L PIC S9(0004) COMP.
  1726     05  TYPE10F PIC  X(0001).
  1727     05  FILLER REDEFINES TYPE10F.
  1728         10  TYPE10A PIC  X(0001).
  1729     05  TYPE10I PIC  X(0001).
  1730*    -------------------------------
  1731     05  AMT10L PIC S9(0004) COMP.
  1732     05  AMT10F PIC  X(0001).
  1733     05  FILLER REDEFINES AMT10F.
  1734         10  AMT10A PIC  X(0001).
  1735     05  AMT10I PIC  X(0011).
  1736*    -------------------------------
  1737     05  VOID10L PIC S9(0004) COMP.
  1738     05  VOID10F PIC  X(0001).
  1739     05  FILLER REDEFINES VOID10F.
  1740         10  VOID10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  37
* EL633.cbl
  1741     05  VOID10I PIC  X(0001).
  1742*    -------------------------------
  1743     05  MDT10L PIC S9(0004) COMP.
  1744     05  MDT10F PIC  X(0001).
  1745     05  FILLER REDEFINES MDT10F.
  1746         10  MDT10A PIC  X(0001).
  1747     05  MDT10I PIC  X(0006).
  1748*    -------------------------------
  1749     05  BDT10L PIC S9(0004) COMP.
  1750     05  BDT10F PIC  X(0001).
  1751     05  FILLER REDEFINES BDT10F.
  1752         10  BDT10A PIC  X(0001).
  1753     05  BDT10I PIC  X(0006).
  1754*    -------------------------------
  1755     05  SDT10L PIC S9(0004) COMP.
  1756     05  SDT10F PIC  X(0001).
  1757     05  FILLER REDEFINES SDT10F.
  1758         10  SDT10A PIC  X(0001).
  1759     05  SDT10I PIC  X(0006).
  1760*    -------------------------------
  1761     05  MSAAC11L PIC S9(0004) COMP.
  1762     05  MSAAC11F PIC  X(0001).
  1763     05  FILLER REDEFINES MSAAC11F.
  1764         10  MSAAC11A PIC  X(0001).
  1765     05  MSAAC11I PIC  X(0010).
  1766*    -------------------------------
  1767     05  MSAST11L PIC S9(0004) COMP.
  1768     05  MSAST11F PIC  X(0001).
  1769     05  FILLER REDEFINES MSAST11F.
  1770         10  MSAST11A PIC  X(0001).
  1771     05  MSAST11I PIC  X(0002).
  1772*    -------------------------------
  1773     05  MSACN11L PIC S9(0004) COMP.
  1774     05  MSACN11F PIC  X(0001).
  1775     05  FILLER REDEFINES MSACN11F.
  1776         10  MSACN11A PIC  X(0001).
  1777     05  MSACN11I PIC  X(0001).
  1778*    -------------------------------
  1779     05  MSACM11L PIC S9(0004) COMP.
  1780     05  MSACM11F PIC  X(0001).
  1781     05  FILLER REDEFINES MSACM11F.
  1782         10  MSACM11A PIC  X(0001).
  1783     05  MSACM11I PIC  X(0010).
  1784*    -------------------------------
  1785     05  TYPE11L PIC S9(0004) COMP.
  1786     05  TYPE11F PIC  X(0001).
  1787     05  FILLER REDEFINES TYPE11F.
  1788         10  TYPE11A PIC  X(0001).
  1789     05  TYPE11I PIC  X(0001).
  1790*    -------------------------------
  1791     05  AMT11L PIC S9(0004) COMP.
  1792     05  AMT11F PIC  X(0001).
  1793     05  FILLER REDEFINES AMT11F.
  1794         10  AMT11A PIC  X(0001).
  1795     05  AMT11I PIC  X(0011).
  1796*    -------------------------------
  1797     05  VOID11L PIC S9(0004) COMP.
  1798     05  VOID11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  38
* EL633.cbl
  1799     05  FILLER REDEFINES VOID11F.
  1800         10  VOID11A PIC  X(0001).
  1801     05  VOID11I PIC  X(0001).
  1802*    -------------------------------
  1803     05  MDT11L PIC S9(0004) COMP.
  1804     05  MDT11F PIC  X(0001).
  1805     05  FILLER REDEFINES MDT11F.
  1806         10  MDT11A PIC  X(0001).
  1807     05  MDT11I PIC  X(0006).
  1808*    -------------------------------
  1809     05  BDT11L PIC S9(0004) COMP.
  1810     05  BDT11F PIC  X(0001).
  1811     05  FILLER REDEFINES BDT11F.
  1812         10  BDT11A PIC  X(0001).
  1813     05  BDT11I PIC  X(0006).
  1814*    -------------------------------
  1815     05  SDT11L PIC S9(0004) COMP.
  1816     05  SDT11F PIC  X(0001).
  1817     05  FILLER REDEFINES SDT11F.
  1818         10  SDT11A PIC  X(0001).
  1819     05  SDT11I PIC  X(0006).
  1820*    -------------------------------
  1821     05  MSAAC12L PIC S9(0004) COMP.
  1822     05  MSAAC12F PIC  X(0001).
  1823     05  FILLER REDEFINES MSAAC12F.
  1824         10  MSAAC12A PIC  X(0001).
  1825     05  MSAAC12I PIC  X(0010).
  1826*    -------------------------------
  1827     05  MSAST12L PIC S9(0004) COMP.
  1828     05  MSAST12F PIC  X(0001).
  1829     05  FILLER REDEFINES MSAST12F.
  1830         10  MSAST12A PIC  X(0001).
  1831     05  MSAST12I PIC  X(0002).
  1832*    -------------------------------
  1833     05  MSACN12L PIC S9(0004) COMP.
  1834     05  MSACN12F PIC  X(0001).
  1835     05  FILLER REDEFINES MSACN12F.
  1836         10  MSACN12A PIC  X(0001).
  1837     05  MSACN12I PIC  X(0001).
  1838*    -------------------------------
  1839     05  MSACM12L PIC S9(0004) COMP.
  1840     05  MSACM12F PIC  X(0001).
  1841     05  FILLER REDEFINES MSACM12F.
  1842         10  MSACM12A PIC  X(0001).
  1843     05  MSACM12I PIC  X(0010).
  1844*    -------------------------------
  1845     05  TYPE12L PIC S9(0004) COMP.
  1846     05  TYPE12F PIC  X(0001).
  1847     05  FILLER REDEFINES TYPE12F.
  1848         10  TYPE12A PIC  X(0001).
  1849     05  TYPE12I PIC  X(0001).
  1850*    -------------------------------
  1851     05  AMT12L PIC S9(0004) COMP.
  1852     05  AMT12F PIC  X(0001).
  1853     05  FILLER REDEFINES AMT12F.
  1854         10  AMT12A PIC  X(0001).
  1855     05  AMT12I PIC  X(0011).
  1856*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  39
* EL633.cbl
  1857     05  VOID12L PIC S9(0004) COMP.
  1858     05  VOID12F PIC  X(0001).
  1859     05  FILLER REDEFINES VOID12F.
  1860         10  VOID12A PIC  X(0001).
  1861     05  VOID12I PIC  X(0001).
  1862*    -------------------------------
  1863     05  MDT12L PIC S9(0004) COMP.
  1864     05  MDT12F PIC  X(0001).
  1865     05  FILLER REDEFINES MDT12F.
  1866         10  MDT12A PIC  X(0001).
  1867     05  MDT12I PIC  X(0006).
  1868*    -------------------------------
  1869     05  BDT12L PIC S9(0004) COMP.
  1870     05  BDT12F PIC  X(0001).
  1871     05  FILLER REDEFINES BDT12F.
  1872         10  BDT12A PIC  X(0001).
  1873     05  BDT12I PIC  X(0006).
  1874*    -------------------------------
  1875     05  SDT12L PIC S9(0004) COMP.
  1876     05  SDT12F PIC  X(0001).
  1877     05  FILLER REDEFINES SDT12F.
  1878         10  SDT12A PIC  X(0001).
  1879     05  SDT12I PIC  X(0006).
  1880*    -------------------------------
  1881     05  MSAAC13L PIC S9(0004) COMP.
  1882     05  MSAAC13F PIC  X(0001).
  1883     05  FILLER REDEFINES MSAAC13F.
  1884         10  MSAAC13A PIC  X(0001).
  1885     05  MSAAC13I PIC  X(0010).
  1886*    -------------------------------
  1887     05  MSAST13L PIC S9(0004) COMP.
  1888     05  MSAST13F PIC  X(0001).
  1889     05  FILLER REDEFINES MSAST13F.
  1890         10  MSAST13A PIC  X(0001).
  1891     05  MSAST13I PIC  X(0002).
  1892*    -------------------------------
  1893     05  MSACN13L PIC S9(0004) COMP.
  1894     05  MSACN13F PIC  X(0001).
  1895     05  FILLER REDEFINES MSACN13F.
  1896         10  MSACN13A PIC  X(0001).
  1897     05  MSACN13I PIC  X(0001).
  1898*    -------------------------------
  1899     05  MSACM13L PIC S9(0004) COMP.
  1900     05  MSACM13F PIC  X(0001).
  1901     05  FILLER REDEFINES MSACM13F.
  1902         10  MSACM13A PIC  X(0001).
  1903     05  MSACM13I PIC  X(0010).
  1904*    -------------------------------
  1905     05  TYPE13L PIC S9(0004) COMP.
  1906     05  TYPE13F PIC  X(0001).
  1907     05  FILLER REDEFINES TYPE13F.
  1908         10  TYPE13A PIC  X(0001).
  1909     05  TYPE13I PIC  X(0001).
  1910*    -------------------------------
  1911     05  AMT13L PIC S9(0004) COMP.
  1912     05  AMT13F PIC  X(0001).
  1913     05  FILLER REDEFINES AMT13F.
  1914         10  AMT13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  40
* EL633.cbl
  1915     05  AMT13I PIC  X(0011).
  1916*    -------------------------------
  1917     05  VOID13L PIC S9(0004) COMP.
  1918     05  VOID13F PIC  X(0001).
  1919     05  FILLER REDEFINES VOID13F.
  1920         10  VOID13A PIC  X(0001).
  1921     05  VOID13I PIC  X(0001).
  1922*    -------------------------------
  1923     05  MDT13L PIC S9(0004) COMP.
  1924     05  MDT13F PIC  X(0001).
  1925     05  FILLER REDEFINES MDT13F.
  1926         10  MDT13A PIC  X(0001).
  1927     05  MDT13I PIC  X(0006).
  1928*    -------------------------------
  1929     05  BDT13L PIC S9(0004) COMP.
  1930     05  BDT13F PIC  X(0001).
  1931     05  FILLER REDEFINES BDT13F.
  1932         10  BDT13A PIC  X(0001).
  1933     05  BDT13I PIC  X(0006).
  1934*    -------------------------------
  1935     05  SDT13L PIC S9(0004) COMP.
  1936     05  SDT13F PIC  X(0001).
  1937     05  FILLER REDEFINES SDT13F.
  1938         10  SDT13A PIC  X(0001).
  1939     05  SDT13I PIC  X(0006).
  1940*    -------------------------------
  1941     05  ERRMSG1L PIC S9(0004) COMP.
  1942     05  ERRMSG1F PIC  X(0001).
  1943     05  FILLER REDEFINES ERRMSG1F.
  1944         10  ERRMSG1A PIC  X(0001).
  1945     05  ERRMSG1I PIC  X(0079).
  1946*    -------------------------------
  1947     05  ERRMSG2L PIC S9(0004) COMP.
  1948     05  ERRMSG2F PIC  X(0001).
  1949     05  FILLER REDEFINES ERRMSG2F.
  1950         10  ERRMSG2A PIC  X(0001).
  1951     05  ERRMSG2I PIC  X(0079).
  1952*    -------------------------------
  1953     05  PFENTERL PIC S9(0004) COMP.
  1954     05  PFENTERF PIC  X(0001).
  1955     05  FILLER REDEFINES PFENTERF.
  1956         10  PFENTERA PIC  X(0001).
  1957     05  PFENTERI PIC  9(2).
  1958 01  EL633AO REDEFINES EL633AI.
  1959     05  FILLER            PIC  X(0012).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  DATEO PIC  X(0008).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  TIMEO PIC  99.99.
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  CMPNYIDO PIC  X(0003).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  USERIDO PIC  X(0004).
  1972*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  41
* EL633.cbl
  1973     05  FILLER            PIC  X(0003).
  1974     05  MAINTO PIC  X(0001).
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  CARRIERO PIC  X(0001).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  GROUPO PIC  X(0006).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  FINRESPO PIC  X(0010).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  ACCTO PIC  X(0010).
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  MSAAC1O PIC  X(0010).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  MSAST1O PIC  X(0002).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  MSACN1O PIC  X(0001).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  MSACM1O PIC  X(0010).
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  TYPE1O PIC  X(0001).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  AMT1O PIC  X(0011).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  VOID1O PIC  X(0001).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  MDT1O PIC  X(0006).
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  BDT1O PIC  X(0006).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  SDT1O PIC  X(0006).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  MSAAC2O PIC  X(0010).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  MSAST2O PIC  X(0002).
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  MSACN2O PIC  X(0001).
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  MSACM2O PIC  X(0010).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  42
* EL633.cbl
  2031     05  TYPE2O PIC  X(0001).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  AMT2O PIC  X(0011).
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  VOID2O PIC  X(0001).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  MDT2O PIC  X(0006).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  BDT2O PIC  X(0006).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  SDT2O PIC  X(0006).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  MSAAC3O PIC  X(0010).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  MSAST3O PIC  X(0002).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  MSACN3O PIC  X(0001).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  MSACM3O PIC  X(0010).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  TYPE3O PIC  X(0001).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  AMT3O PIC  X(0011).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
  2067     05  VOID3O PIC  X(0001).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  MDT3O PIC  X(0006).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  BDT3O PIC  X(0006).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  SDT3O PIC  X(0006).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  MSAAC4O PIC  X(0010).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  MSAST4O PIC  X(0002).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  MSACN4O PIC  X(0001).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  MSACM4O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  43
* EL633.cbl
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  TYPE4O PIC  X(0001).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  AMT4O PIC  X(0011).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  VOID4O PIC  X(0001).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  MDT4O PIC  X(0006).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  BDT4O PIC  X(0006).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  SDT4O PIC  X(0006).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  MSAAC5O PIC  X(0010).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  MSAST5O PIC  X(0002).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  MSACN5O PIC  X(0001).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  MSACM5O PIC  X(0010).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  TYPE5O PIC  X(0001).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  AMT5O PIC  X(0011).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  VOID5O PIC  X(0001).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  MDT5O PIC  X(0006).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  BDT5O PIC  X(0006).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  SDT5O PIC  X(0006).
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  MSAAC6O PIC  X(0010).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  MSAST6O PIC  X(0002).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  MSACN6O PIC  X(0001).
  2146*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  44
* EL633.cbl
  2147     05  FILLER            PIC  X(0003).
  2148     05  MSACM6O PIC  X(0010).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  TYPE6O PIC  X(0001).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  AMT6O PIC  X(0011).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  VOID6O PIC  X(0001).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  MDT6O PIC  X(0006).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  BDT6O PIC  X(0006).
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  SDT6O PIC  X(0006).
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  MSAAC7O PIC  X(0010).
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  MSAST7O PIC  X(0002).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  MSACN7O PIC  X(0001).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  MSACM7O PIC  X(0010).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  TYPE7O PIC  X(0001).
  2182*    -------------------------------
  2183     05  FILLER            PIC  X(0003).
  2184     05  AMT7O PIC  X(0011).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  VOID7O PIC  X(0001).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  MDT7O PIC  X(0006).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  BDT7O PIC  X(0006).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  SDT7O PIC  X(0006).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  MSAAC8O PIC  X(0010).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  MSAST8O PIC  X(0002).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  45
* EL633.cbl
  2205     05  MSACN8O PIC  X(0001).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  MSACM8O PIC  X(0010).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  TYPE8O PIC  X(0001).
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  AMT8O PIC  X(0011).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  VOID8O PIC  X(0001).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  MDT8O PIC  X(0006).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  BDT8O PIC  X(0006).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  SDT8O PIC  X(0006).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  MSAAC9O PIC  X(0010).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  MSAST9O PIC  X(0002).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  MSACN9O PIC  X(0001).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  MSACM9O PIC  X(0010).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
  2241     05  TYPE9O PIC  X(0001).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  AMT9O PIC  X(0011).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  VOID9O PIC  X(0001).
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  MDT9O PIC  X(0006).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  BDT9O PIC  X(0006).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  SDT9O PIC  X(0006).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  MSAAC10O PIC  X(0010).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  MSAST10O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  46
* EL633.cbl
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  MSACN10O PIC  X(0001).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  MSACM10O PIC  X(0010).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  TYPE10O PIC  X(0001).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  AMT10O PIC  X(0011).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  VOID10O PIC  X(0001).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  MDT10O PIC  X(0006).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  BDT10O PIC  X(0006).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  SDT10O PIC  X(0006).
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  MSAAC11O PIC  X(0010).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  MSAST11O PIC  X(0002).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  MSACN11O PIC  X(0001).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  MSACM11O PIC  X(0010).
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  TYPE11O PIC  X(0001).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  AMT11O PIC  X(0011).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  VOID11O PIC  X(0001).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  MDT11O PIC  X(0006).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  BDT11O PIC  X(0006).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  SDT11O PIC  X(0006).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  MSAAC12O PIC  X(0010).
  2320*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  47
* EL633.cbl
  2321     05  FILLER            PIC  X(0003).
  2322     05  MSAST12O PIC  X(0002).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  MSACN12O PIC  X(0001).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  MSACM12O PIC  X(0010).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  TYPE12O PIC  X(0001).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  AMT12O PIC  X(0011).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  VOID12O PIC  X(0001).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  MDT12O PIC  X(0006).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  BDT12O PIC  X(0006).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  SDT12O PIC  X(0006).
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  MSAAC13O PIC  X(0010).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
  2352     05  MSAST13O PIC  X(0002).
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  MSACN13O PIC  X(0001).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  MSACM13O PIC  X(0010).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  TYPE13O PIC  X(0001).
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  AMT13O PIC  X(0011).
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  VOID13O PIC  X(0001).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  MDT13O PIC  X(0006).
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  BDT13O PIC  X(0006).
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  SDT13O PIC  X(0006).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  48
* EL633.cbl
  2379     05  ERRMSG1O PIC  X(0079).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  ERRMSG2O PIC  X(0079).
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  PFENTERO PIC  X(0002).
  2386*    -------------------------------
  2387
  2388 01  MAP-EL633A  REDEFINES  EL633AI.
  2389     12  FILLER                  PIC  X(87).
  2390     12  DATA-AREA       OCCURS 13 TIMES
  2391                             INDEXED BY PINDX.
  2392         16  GL-ACCT-LEN         PIC S9(4)              COMP.
  2393         16  GL-ACCT-ATTRB       PIC  X.
  2394         16  GL-ACCT             PIC  X(10).
  2395         16  WSL-COMM  REDEFINES GL-ACCT.
  2396             20  WSL-COMM-DTE.
  2397                 24  WSL-MO      PIC  X(2).
  2398                 24  WSL-DA      PIC  X(2).
  2399                 24  WSL-YR      PIC  X(2).
  2400             20  WSL-COMM-REST   PIC  X(4).
  2401         16  GL-STATE-LEN        PIC S9(4)              COMP.
  2402         16  GL-STATE-ATTRB      PIC  X.
  2403         16  GL-STATE            PIC  X(02).
  2404         16  GL-CANC-LEN         PIC S9(4)              COMP.
  2405         16  GL-CANC-ATTRB       PIC  X.
  2406         16  GL-CANC             PIC  X.
  2407         16  GL-COMM-LEN         PIC S9(4)              COMP.
  2408         16  GL-COMM-ATTRB       PIC  X.
  2409         16  GL-COMM             PIC  X(10).
  2410         16  RTYPE-LEN           PIC S9(4)              COMP.
  2411         16  RTYPE-ATTRB         PIC  X.
  2412         16  RTYPE               PIC  X.
  2413         16  AMT-LEN             PIC S9(4)              COMP.
  2414         16  AMT-ATTRB           PIC  X.
  2415         16  AMT                 PIC S9(9)V9(2).
  2416         16  AMTO  REDEFINES
  2417             AMT                 PIC Z(7).9(2)-.
  2418         16  VOID-SW-LEN         PIC S9(4)              COMP.
  2419         16  VOID-SW-ATTRB       PIC  X.
  2420         16  VOID-SW             PIC  X.
  2421         16  MDTE-LEN            PIC S9(4)              COMP.
  2422         16  MDTE-ATTRB          PIC  X.
  2423         16  MDTE                PIC  X(6).
  2424         16  BDTE-LEN            PIC S9(4)              COMP.
  2425         16  BDTE-ATTRB          PIC  X.
  2426         16  BDTE                PIC  X(6).
  2427         16  SDTE-LEN            PIC S9(4)              COMP.
  2428         16  SDTE-ATTRB          PIC  X.
  2429         16  SDTE                PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  49
* EL633.cbl
  2431****************************************************************
  2432*
  2433* Copyright (c) 2007 by Clerity Solutions, Inc.
  2434* All rights reserved.
  2435*
  2436****************************************************************
  2437 01  DFHEIV.
  2438   02  DFHEIV0               PIC X(35).
  2439   02  DFHEIV1               PIC X(08).
  2440   02  DFHEIV2               PIC X(08).
  2441   02  DFHEIV3               PIC X(08).
  2442   02  DFHEIV4               PIC X(06).
  2443   02  DFHEIV5               PIC X(04).
  2444   02  DFHEIV6               PIC X(04).
  2445   02  DFHEIV7               PIC X(02).
  2446   02  DFHEIV8               PIC X(02).
  2447   02  DFHEIV9               PIC X(01).
  2448   02  DFHEIV10              PIC S9(7) COMP-3.
  2449   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2450   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2451   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2452   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2453   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2454   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2455   02  DFHEIV17              PIC X(04).
  2456   02  DFHEIV18              PIC X(04).
  2457   02  DFHEIV19              PIC X(04).
  2458   02  DFHEIV20              USAGE IS POINTER.
  2459   02  DFHEIV21              USAGE IS POINTER.
  2460   02  DFHEIV22              USAGE IS POINTER.
  2461   02  DFHEIV23              USAGE IS POINTER.
  2462   02  DFHEIV24              USAGE IS POINTER.
  2463   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2464   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2465   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2466   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2467   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2468   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2469   02  FILLER                PIC X(02).
  2470   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2471   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2472   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2473   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2474   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2475 LINKAGE  SECTION.
  2476*****************************************************************
  2477*                                                               *
  2478* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2479* All rights reserved.                                          *
  2480*                                                               *
  2481*****************************************************************
  2482 01  dfheiblk.
  2483     02  eibtime          pic s9(7) comp-3.
  2484     02  eibdate          pic s9(7) comp-3.
  2485     02  eibtrnid         pic x(4).
  2486     02  eibtaskn         pic s9(7) comp-3.
  2487     02  eibtrmid         pic x(4).
  2488     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  50
* EL633.cbl
  2489     02  eibcposn         pic s9(4) comp.
  2490     02  eibcalen         pic s9(4) comp.
  2491     02  eibaid           pic x(1).
  2492     02  eibfiller1       pic x(1).
  2493     02  eibfn            pic x(2).
  2494     02  eibfiller2       pic x(2).
  2495     02  eibrcode         pic x(6).
  2496     02  eibfiller3       pic x(2).
  2497     02  eibds            pic x(8).
  2498     02  eibreqid         pic x(8).
  2499     02  eibrsrce         pic x(8).
  2500     02  eibsync          pic x(1).
  2501     02  eibfree          pic x(1).
  2502     02  eibrecv          pic x(1).
  2503     02  eibsend          pic x(1).
  2504     02  eibatt           pic x(1).
  2505     02  eibeoc           pic x(1).
  2506     02  eibfmh           pic x(1).
  2507     02  eibcompl         pic x(1).
  2508     02  eibsig           pic x(1).
  2509     02  eibconf          pic x(1).
  2510     02  eiberr           pic x(1).
  2511     02  eibrldbk         pic x(1).
  2512     02  eiberrcd         pic x(4).
  2513     02  eibsynrb         pic x(1).
  2514     02  eibnodat         pic x(1).
  2515     02  eibfiller5       pic x(2).
  2516     02  eibresp          pic 9(09) comp.
  2517     02  eibresp2         pic 9(09) comp.
  2518     02  dfheigdj         pic s9(4) comp.
  2519     02  dfheigdk         pic s9(4) comp.
  2520 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  51
* EL633.cbl
  2521/
  2522*                            COPY ERCCHKQ.
  2523******************************************************************
  2524*                                                                *
  2525*                                                                *
  2526*                            ERCCHKQ                             *
  2527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2528*                            VMOD=2.005                          *
  2529*                                                                *
  2530*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  2531*                                                                *
  2532*   FILE TYPE = VSAM,KSDS                                        *
  2533*   RECORD SIZE = 100  RECFORM = FIXED                           *
  2534*                                                                *
  2535*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  2536*       ALTERNATE PATH  = NONE                                   *
  2537*                                                                *
  2538*   LOG = YES                                                    *
  2539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2540******************************************************************
  2541 01  CHECK-QUE.
  2542     12  CQ-RECORD-ID                PIC XX.
  2543         88  VALID-CQ-ID                     VALUE 'CQ'.
  2544
  2545     12  CQ-CONTROL-PRIMARY.
  2546         16  CQ-COMPANY-CD           PIC X.
  2547         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  2548         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  2549
  2550     12  CQ-ENTRY-TYPE               PIC X.
  2551             88  CHECK-ON-QUE           VALUE 'Q'.
  2552             88  ALIGNMENT-CHECK        VALUE 'A'.
  2553             88  MANUAL-CHECK           VALUE 'M'.
  2554             88  SPOILED-CHECK          VALUE 'S'.
  2555             88  VOIDED-CHECK           VALUE 'V'.
  2556             88  PAYMENT-ABORTED        VALUE 'X'.
  2557
  2558     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  2559
  2560     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  2561         CQ-CREDIT-MASTER-CNTL.
  2562         16  CQ-PYAJ-CARRIER         PIC X.
  2563         16  CQ-PYAJ-GROUPING        PIC X(6).
  2564         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  2565         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  2566         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  2567         16  CQ-PYAJ-REC-TYPE        PIC X.
  2568         16  FILLER                  PIC X(18).
  2569
  2570     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  2571         CQ-CREDIT-MASTER-CNTL.
  2572         16  CQ-CHEK-CARRIER         PIC X.
  2573         16  CQ-CHEK-GROUPING        PIC X(6).
  2574         16  CQ-CHEK-STATE           PIC XX.
  2575         16  CQ-CHEK-ACCOUNT         PIC X(10).
  2576         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  2577         16  CQ-CHEK-CERT-NO.
  2578             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  52
* EL633.cbl
  2579             20  CQ-CHEK-CERT-SFX    PIC X.
  2580         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  2581         16  CQ-CHEK-FIN-RESP        PIC X(10).
  2582         16  FILLER                  PIC X(06).
  2583
  2584     12  CQ-CHECK-NUMBER             PIC X(7).
  2585     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  2586     12  CQ-PAYMENT-TYPE             PIC X.
  2587             88  CQ-BILLING-CREDIT         VALUE '1'.
  2588             88  CQ-REFUND-PMT             VALUE '2'.
  2589             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  2590     12  CQ-VOID-INDICATOR           PIC X.
  2591             88  CHECK-IS-VOID             VALUE 'V'.
  2592     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  2593     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  2594     12  CQ-CHECK-BY-USER            PIC X(4).
  2595     12  CQ-PRE-NUMBERING-SW         PIC X.
  2596       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  2597       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  2598
  2599     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  2600     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  2601     12  CQ-ACCOUNT-AGENT            PIC X(10).
  2602     12  CQ-CHECK-VOIDED-DT          PIC XX.
  2603
  2604     12  CQ-LETTERS-IND              PIC X.
  2605         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  2606
  2607******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  53
* EL633.cbl
  2608/
  2609*                            COPY ERCPYAJ.
  2610******************************************************************
  2611*                                                                *
  2612*                            ERCPYAJ                             *
  2613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2614*                            VMOD=2.015                          *
  2615*                                                                *
  2616*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2617*                                                                *
  2618*                                                                *
  2619*   FILE TYPE = VSAM,KSDS                                        *
  2620*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2621*                                                                *
  2622*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2623*       ALTERNATE PATHS = NONE                                   *
  2624*                                                                *
  2625*   LOG = YES                                                    *
  2626*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2627******************************************************************
  2628******************************************************************
  2629*                   C H A N G E   L O G
  2630*
  2631* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2632*-----------------------------------------------------------------
  2633*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2634* EFFECTIVE    NUMBER
  2635*-----------------------------------------------------------------
  2636* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2637* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2638******************************************************************
  2639
  2640 01  PENDING-PAY-ADJ.
  2641     12  PY-RECORD-ID                     PIC XX.
  2642         88  VALID-PY-ID                        VALUE 'PY'.
  2643
  2644     12  PY-CONTROL-PRIMARY.
  2645         16  PY-COMPANY-CD                PIC X.
  2646         16  PY-CARRIER                   PIC X.
  2647         16  PY-GROUPING                  PIC X(6).
  2648         16  PY-FIN-RESP                  PIC X(10).
  2649         16  PY-ACCOUNT                   PIC X(10).
  2650         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2651                                          PIC X(10).
  2652         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2653         16  PY-RECORD-TYPE               PIC X.
  2654             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2655             88  PY-DEPOSIT                   VALUE 'D'.
  2656             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2657             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2658             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2659             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2660             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2661             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2662             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2663             88  PY-FICA-ENTRY                VALUE 'F'.
  2664             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2665             88  PY-POLICY-FEE                VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  54
* EL633.cbl
  2666             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2667
  2668     12  PY-PYMT-TYPE                     PIC X.
  2669             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2670             88  PY-REINS-PYMT                VALUE 'R'.
  2671             88  PY-EXP-PYMT                  VALUE 'E'.
  2672
  2673     12  PY-BIL-INV                       PIC X(6).
  2674     12  PY-REF-NO                        PIC X(12).
  2675
  2676     12  PY-LAST-MAINT-DT                 PIC XX.
  2677     12  PY-LAST-MAINT-BY                 PIC X(4).
  2678     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2679
  2680     12  PY-PYADJ-RECORD.
  2681         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2682         16  PY-ENTRY-COMMENT             PIC X(30).
  2683         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2684             20  PY-GL-ACCOUNT            PIC X(10).
  2685             20  PY-GL-STATE              PIC X(02).
  2686             20  PY-GL-CANC-SW            PIC X(01).
  2687                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2688                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2689             20  PY-GL-COMMENT            PIC X(10).
  2690             20  FILLER      REDEFINES PY-GL-COMMENT.
  2691                 24  PY-GL-CHECK-NO       PIC 9(06).
  2692                 24  FILLER               PIC X(04).
  2693             20  FILLER                   PIC X(07).
  2694         16  PY-SAVE-ACCOUNT              PIC X(10).
  2695         16  PY-SAVE-TYPE                 PIC X(01).
  2696
  2697         16  PY-LETTERS.
  2698             20  PY-LETTER OCCURS 3 TIMES
  2699                           INDEXED BY PY-LET-NDX
  2700                                          PIC X(04).
  2701
  2702         16  PY-ERCOMP-TYPE               PIC X.
  2703             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2704             88  PY-GA-TYPE                   VALUE 'G'.
  2705             88  PY-BANK-TYPE                 VALUE 'B'.
  2706         16  FILLER                       PIC X(05).
  2707
  2708     12  PY-RECORD-STATUS.
  2709         16  PY-CREDIT-SELECT-DT          PIC XX.
  2710         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2711         16  PY-BILLED-DATE               PIC XX.
  2712         16  PY-REPORTED-DT               PIC XX.
  2713         16  PY-PMT-APPLIED               PIC X.
  2714             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2715             88  PY-GA-PMT                    VALUE 'G'.
  2716             88  PY-OVWRITE-PMT               VALUE 'O'.
  2717             88  PY-NON-AR-PMT                VALUE 'N'.
  2718         16  FILLER                       PIC X(5).
  2719         16  PY-INPUT-DT                  PIC XX.
  2720         16  PY-CHECK-NUMBER              PIC X(6).
  2721         16  PY-VOID-SW                   PIC X.
  2722             88  PY-CHECK-VOIDED              VALUE 'V'.
  2723         16  PY-CHECK-ORIGIN-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  55
* EL633.cbl
  2724             88  PY-BILLING-CHECK             VALUE 'B'.
  2725             88  PY-REFUND-CHECK              VALUE 'R'.
  2726             88  PY-GA-CHECK                  VALUE 'G'.
  2727             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2728             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2729         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2730         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2731         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2732         16  PY-BILL-FLAG                 PIC X.
  2733             88  PY-BILLED                    VALUE 'B'.
  2734         16  PY-AR-FLAG                   PIC X.
  2735             88  PY-AR-CYCLE                  VALUE 'C'.
  2736             88  PY-AR-MONTH-END              VALUE 'M'.
  2737         16  PY-AR-DATE                   PIC XX.
  2738
  2739     12  PY-GL-CODES.
  2740         16  PY-GL-DB                     PIC X(14).
  2741         16  PY-GL-CR                     PIC X(14).
  2742         16  PY-GL-FLAG                   PIC X.
  2743         16  PY-GL-DATE                   PIC XX.
  2744
  2745     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2746     12  FILLER                           PIC X(3).
  2747******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  56
* EL633.cbl
  2748/
  2749*                            COPY ERCCOMP.
  2750******************************************************************
  2751*                                                                *
  2752*                                                                *
  2753*                            ERCCOMP                             *
  2754*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2755*                            VMOD=2.019                          *
  2756*                                                                *
  2757*   ONLINE CREDIT SYSTEM                                         *
  2758*                                                                *
  2759*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2760*                                                                *
  2761*   FILE TYPE = VSAM,KSDS                                        *
  2762*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2763*                                                                *
  2764*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2765*       ALTERNATE PATH = NONE                                    *
  2766*                                                                *
  2767*   LOG = NO                                                     *
  2768*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2769*                                                                *
  2770******************************************************************
  2771*                   C H A N G E   L O G
  2772*
  2773* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2774*-----------------------------------------------------------------
  2775*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2776* EFFECTIVE    NUMBER
  2777*-----------------------------------------------------------------
  2778* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2779* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2780* 092205    2005050300006  PEMA  ADD LEASE FEE
  2781* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2782* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2783* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2784* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2785* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2786******************************************************************
  2787
  2788 01  COMPENSATION-MASTER.
  2789     12  CO-RECORD-ID                          PIC XX.
  2790         88  VALID-CO-ID                          VALUE 'CO'.
  2791
  2792     12  CO-CONTROL-PRIMARY.
  2793         16  CO-COMPANY-CD                     PIC X.
  2794         16  CO-CONTROL.
  2795             20  CO-CTL-1.
  2796                 24  CO-CARR-GROUP.
  2797                     28  CO-CARRIER            PIC X.
  2798                     28  CO-GROUPING.
  2799                         32  CO-GROUP-PREFIX   PIC XXX.
  2800                         32  CO-GROUP-PRIME    PIC XXX.
  2801                 24  CO-RESP-NO.
  2802                     28  CO-RESP-PREFIX        PIC X(4).
  2803                     28  CO-RESP-PRIME         PIC X(6).
  2804             20  CO-CTL-2.
  2805                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  57
* EL633.cbl
  2806                     28  CO-ACCT-PREFIX        PIC X(4).
  2807                     28  CO-ACCT-PRIME         PIC X(6).
  2808         16  CO-TYPE                           PIC X.
  2809             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2810             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2811             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2812
  2813     12  CO-MAINT-INFORMATION.
  2814         16  CO-LAST-MAINT-DT                  PIC XX.
  2815         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2816         16  CO-LAST-MAINT-USER                PIC X(4).
  2817     12  FILLER                                PIC XX.
  2818     12  CO-STMT-TYPE                          PIC XXX.
  2819     12  CO-COMP-TYPE                          PIC X.
  2820         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2821     12  CO-STMT-OWNER                         PIC X(4).
  2822     12  CO-BALANCE-CONTROL                    PIC X.
  2823         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2824         88  CO-NO-BALANCE                        VALUE 'N'.
  2825
  2826     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2827         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2828         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2829         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2830
  2831     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2832         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2833         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2834
  2835     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2836     12  CO-GA-DIRECT-DEP                      PIC X.
  2837     12  CO-FUTURE-SPACE                       PIC X.
  2838         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2839
  2840     12  CO-ACCT-NAME                          PIC X(30).
  2841     12  CO-MAIL-NAME                          PIC X(30).
  2842     12  CO-ADDR-1                             PIC X(30).
  2843     12  CO-ADDR-2                             PIC X(30).
  2844     12  CO-ADDR-3.
  2845         16  CO-ADDR-CITY                      PIC X(27).
  2846         16  CO-ADDR-STATE                     PIC XX.
  2847     12  CO-CSO-1099                           PIC X.
  2848     12  CO-ZIP.
  2849         16  CO-ZIP-PRIME.
  2850             20  CO-ZIP-PRI-1ST                PIC X.
  2851                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2852             20  FILLER                        PIC X(4).
  2853         16  CO-ZIP-PLUS4                      PIC X(4).
  2854     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2855         16  CO-CAN-POSTAL-1                   PIC XXX.
  2856         16  CO-CAN-POSTAL-2                   PIC XXX.
  2857         16  FILLER                            PIC XXX.
  2858     12  CO-SOC-SEC                            PIC X(13).
  2859     12  CO-TELEPHONE.
  2860         16  CO-AREA-CODE                      PIC XXX.
  2861         16  CO-PREFIX                         PIC XXX.
  2862         16  CO-PHONE                          PIC X(4).
  2863
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  58
* EL633.cbl
  2864     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2865
  2866     12  CO-AR-BAL-LEVEL                       PIC X.
  2867         88  CO-AR-REF-LVL                        VALUE '1'.
  2868         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2869         88  CO-AR-BILL-LVL                       VALUE '2'.
  2870         88  CO-AR-AGT-LVL                        VALUE '3'.
  2871         88  CO-AR-FR-LVL                         VALUE '4'.
  2872
  2873     12  CO-AR-NORMAL-PRINT                    PIC X.
  2874         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2875         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2876
  2877     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2878
  2879     12  CO-AR-REPORTING                       PIC X.
  2880         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2881         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2882
  2883     12  CO-AR-PULL-CHECK                      PIC X.
  2884         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2885         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2886
  2887     12  CO-AR-BALANCE-PRINT                   PIC X.
  2888         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2889
  2890     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2891         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2892         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2893         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2894
  2895     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2896
  2897     12  CO-USER-CODE                          PIC X.
  2898     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2899
  2900******************************************************************
  2901*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2902*    THE LAST MONTH END RUN.
  2903******************************************************************
  2904
  2905     12  CO-LAST-ACTIVITY-DATE.
  2906         16  CO-ACT-YEAR                       PIC 99.
  2907         16  CO-ACT-MONTH                      PIC 99.
  2908         16  CO-ACT-DAY                        PIC 99.
  2909
  2910     12  CO-LAST-STMT-DT.
  2911         16  CO-LAST-STMT-YEAR                 PIC 99.
  2912         16  CO-LAST-STMT-MONTH                PIC 99.
  2913         16  CO-LAST-STMT-DAY                  PIC 99.
  2914
  2915     12  CO-MO-END-TOTALS.
  2916         16  CO-MONTHLY-TOTALS.
  2917             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2918             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2919             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2920             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2921             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  59
* EL633.cbl
  2922
  2923         16  CO-AGING-TOTALS.
  2924             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2925             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2926             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2927             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2928
  2929         16  CO-YTD-TOTALS.
  2930             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2931             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2932
  2933         16  CO-OVER-UNDER-TOTALS.
  2934             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2935             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2936
  2937     12  CO-MISCELLANEOUS-TOTALS.
  2938         16  CO-FICA-TOTALS.
  2939             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2940             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2941
  2942         16  CO-CLAIM-TOTALS.
  2943             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2944             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2945
  2946******************************************************************
  2947*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2948*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2949******************************************************************
  2950
  2951     12  CO-CURRENT-TOTALS.
  2952         16  CO-CURRENT-LAST-STMT-DT.
  2953             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2954             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2955             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2956
  2957         16  CO-CURRENT-MONTHLY-TOTALS.
  2958             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2959             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2960             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2961             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2962             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2963
  2964         16  CO-CURRENT-AGING-TOTALS.
  2965             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2966             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2967             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2968             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2969
  2970         16  CO-CURRENT-YTD-TOTALS.
  2971             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2972             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2973
  2974     12  CO-PAID-COMM-TOTALS.
  2975         16  CO-YTD-PAID-COMMS.
  2976             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2977             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2978
  2979     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  60
* EL633.cbl
  2980         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2981         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2982
  2983     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2984         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2985         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2986         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2987         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2988         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2989         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2990         88  CO-FINAL-LETTER                  VALUE 'F'.
  2991         88  CO-RECONCILING                   VALUE 'R'.
  2992         88  CO-PHONE-CALL                    VALUE 'P'.
  2993         88  CO-LEGAL                         VALUE 'L'.
  2994         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2995         88  CO-WRITE-OFF                     VALUE 'W'.
  2996         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2997
  2998     12  CO-CSR-CODE                       PIC X(4).
  2999
  3000     12  CO-GA-STATUS-INFO.
  3001         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3002         16  CO-GA-TERMINATION-DT          PIC XX.
  3003         16  CO-GA-STATUS-CODE             PIC X.
  3004             88  CO-GA-ACTIVE                 VALUE 'A'.
  3005             88  CO-GA-INACTIVE               VALUE 'I'.
  3006             88  CO-GA-PENDING                VALUE 'P'.
  3007         16  CO-GA-COMMENTS.
  3008             20  CO-GA-COMMENT-1           PIC X(40).
  3009             20  CO-GA-COMMENT-2           PIC X(40).
  3010             20  CO-GA-COMMENT-3           PIC X(40).
  3011             20  CO-GA-COMMENT-4           PIC X(40).
  3012
  3013     12  CO-RPTCD2                         PIC X(10).
  3014
  3015     12  CO-TYPE-AGENT                     PIC X(01).
  3016         88  CO-CORPORATION                   VALUE 'C'.
  3017         88  CO-PARTNERSHIP                   VALUE 'P'.
  3018         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3019         88  CO-TRUST                         VALUE 'T'.
  3020         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3021
  3022     12  CO-FAXNO.
  3023         16  CO-FAX-AREA-CODE                  PIC XXX.
  3024         16  CO-FAX-PREFIX                     PIC XXX.
  3025         16  CO-FAX-PHONE                      PIC X(4).
  3026
  3027     12  CO-BANK-INFORMATION.
  3028         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3029         16  CO-BANK-TRANSIT-NON REDEFINES
  3030             CO-BANK-TRANSIT-NO                PIC 9(8).
  3031
  3032         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3033     12  CO-MISC-DEDUCT-INFO REDEFINES
  3034                  CO-BANK-INFORMATION.
  3035         16  CO-MD-GL-ACCT                     PIC X(10).
  3036         16  CO-MD-DIV                         PIC XX.
  3037         16  CO-MD-CENTER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  61
* EL633.cbl
  3038         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  3039         16  CO-CREATE-AP-CHECK                PIC X.
  3040         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3041         16  FILLER                            PIC XXX.
  3042     12  CO-ACH-STATUS                         PIC X.
  3043         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3044         88  CO-ACH-PENDING                        VALUE 'P'.
  3045
  3046     12  CO-BILL-SW                            PIC X.
  3047     12  CO-CONTROL-NAME                       PIC X(30).
  3048     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3049     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3050     12  CO-CLP-STATE                          PIC XX.
  3051     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3052     12  CO-SPP-REFUND-EDIT                    PIC X.
  3053
  3054******************************************************************
  3055*
  3056*                            COPY AIRL0009.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  62
* EL633.cbl
  3057/
  3058 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3059                          PENDING-PAY-ADJ COMPENSATION-MASTER.
  3060 0000-DFHEXIT SECTION.
  3061     MOVE '9#                    $   ' TO DFHEIV0.
  3062     MOVE 'EL633' TO DFHEIV1.
  3063     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3064
  3065     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3066     MOVE EIBTRMID               TO  QID-TERM.
  3067     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  3068
  3069     IF EIBCALEN = ZERO
  3070         GO TO 8800-UNAUTHORIZED-ACCESS.
  3071
  3072     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  3073         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  3074
  3075     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3076     MOVE '5'                    TO  DC-OPTION-CODE.
  3077
  3078     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3079
  3080     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  3081     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  3082
  3083     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3084         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3085             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  3086             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  3087             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  3088             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  3089             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  3090             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  3091             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  3092             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  3093         ELSE
  3094             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  3095             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  3096             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  3097             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  3098             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  3099             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  3100             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  3101             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  3102
  3103     MOVE LOW-VALUES             TO  EL633AI.
  3104
  3105     MOVE DC-JULIAN-YYDDD        TO  WORK-DATE-JULIAN.
  3106     COMPUTE WORK-SEQ-NO = WORK-JULIAN-DD * 100000.
  3107     MOVE EIBTIME                TO  WORK-SEQ-TIME.
  3108     ADD WORK-SEQ-HHMMS TO WORK-SEQ-NO.
  3109
  3110     MOVE ZEROS                  TO  TOTAL-ACCT-AMT
  3111                                     TOTAL-ACCT-NET.
  3112
  3113     IF RETURNED-FROM = XCTL-6331 OR
  3114                        XCTL-640  OR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  63
* EL633.cbl
  3115                        XCTL-642  OR
  3116                        XCTL-652
  3117         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT.
  3118
  3119     IF EIBTRNID NOT = TRANS-ID
  3120         MOVE 'T'                TO  PI-PYAJ-FILE-SW
  3121         MOVE 'Y'                TO  PI-PAGE-SW
  3122         MOVE ZEROS              TO  PI-SEQ-NOS
  3123         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3124                                     PI-SAV-ACCT-NET
  3125                                     PI-SAV-PREV-AMT
  3126                                     PI-SAV-PREV-NET
  3127         IF (EIBTRNID NOT = EL640-TRANS-ID  AND
  3128             EIBTRNID NOT = EL642-TRANS-ID  AND
  3129             EIBTRNID NOT = EL652-TRANS-ID) OR
  3130             PI-CR-FIN-RESP = SPACES
  3131             GO TO 8100-SEND-INITIAL-MAP
  3132         ELSE
  3133             IF EIBTRNID = (EL6331-TRANS-ID  OR
  3134                            EL640-TRANS-ID   OR
  3135                            EL642-TRANS-ID)  AND
  3136                PI-CR-CONTROL-IN-PROGRESS  = SPACES
  3137                GO TO 8100-SEND-INITIAL-MAP
  3138             ELSE
  3139                 MOVE DFHENTER   TO  EIBAID
  3140                 MOVE 'S'        TO  MAINTI
  3141                 MOVE PI-CR-CARRIER
  3142                                 TO  CARRIERI
  3143                 MOVE PI-CR-GROUPING
  3144                                 TO  GROUPI
  3145                 MOVE PI-CR-FIN-RESP
  3146                                 TO  FINRESPI
  3147                 MOVE PI-CR-ACCOUNT
  3148                                 TO  ACCTI
  3149                 MOVE 1          TO  CARRIERL  MAINTA
  3150                 MOVE 3          TO  GROUPL
  3151                 MOVE 6          TO  FINRESPL  ACCTL
  3152                 GO TO 0400-VALIDATE-KEY-DATA.
  3153
  3154
  3155* EXEC CICS HANDLE CONDITION
  3156*        PGMIDERR  (9600-PGMID-ERROR)
  3157*        ERROR     (9990-ABEND)
  3158*    END-EXEC.
  3159*    MOVE '"$L.                  ! " #00003150' TO DFHEIV0
  3160     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  3161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3162     MOVE X'2220233030303033313530' TO DFHEIV0(25:11)
  3163     CALL 'kxdfhei1' USING DFHEIV0
  3164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3165
  3166
  3167     IF EIBAID = DFHCLEAR
  3168         GO TO 9400-CLEAR.
  3169
  3170     IF PI-PROCESSOR-ID = 'LGXX'
  3171         GO TO 0200-RECEIVE.
  3172
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  64
* EL633.cbl
  3173
  3174* EXEC CICS READQ TS
  3175*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3176*        INTO   (SECURITY-CONTROL)
  3177*        LENGTH (SC-COMM-LENGTH)
  3178*        ITEM   (SC-ITEM)
  3179*    END-EXEC.
  3180*    MOVE '*$II   L              ''   #00003161' TO DFHEIV0
  3181     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3182     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3183     MOVE X'2020233030303033313631' TO DFHEIV0(25:11)
  3184     CALL 'kxdfhei1' USING DFHEIV0,
  3185           PI-SECURITY-TEMP-STORE-ID,
  3186           SECURITY-CONTROL,
  3187           SC-COMM-LENGTH,
  3188           SC-ITEM,
  3189           DFHEIV99,
  3190           DFHEIV99
  3191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3192
  3193
  3194     MOVE SC-CREDIT-DISPLAY (15)  TO PI-DISPLAY-CAP.
  3195     MOVE SC-CREDIT-UPDATE  (15)  TO PI-MODIFY-CAP.
  3196
  3197     IF NOT DISPLAY-CAP
  3198         MOVE 'READ'          TO SM-READ
  3199         PERFORM 9995-SECURITY-VIOLATION
  3200         MOVE ER-0070         TO  EMI-ERROR
  3201         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3202         GO TO 8100-SEND-INITIAL-MAP.
  3203
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  65
* EL633.cbl
  3205 0200-RECEIVE.
  3206
  3207     IF EIBAID = DFHPA1  OR  DFHPA2  OR  DFHPA3
  3208         MOVE ER-0008            TO  EMI-ERROR
  3209         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3210         MOVE -1                 TO  MAINTL
  3211         GO TO 8200-SEND-DATAONLY.
  3212
  3213
  3214* EXEC CICS RECEIVE
  3215*        MAP     (MAP-NAME)
  3216*        MAPSET  (MAPSET-NAME)
  3217*        INTO    (EL633AI)
  3218*    END-EXEC.
  3219     MOVE LENGTH OF
  3220      EL633AI
  3221       TO DFHEIV11
  3222*    MOVE '8"T I  L              ''   #00003187' TO DFHEIV0
  3223     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3224     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3225     MOVE X'2020233030303033313837' TO DFHEIV0(25:11)
  3226     CALL 'kxdfhei1' USING DFHEIV0,
  3227           MAP-NAME,
  3228           EL633AI,
  3229           DFHEIV11,
  3230           MAPSET-NAME,
  3231           DFHEIV99,
  3232           DFHEIV99
  3233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3234
  3235
  3236     IF MAINTI = 'S' AND
  3237        EIBAID = DFHENTER
  3238         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  3239                                     PI-SAV-ACCT-NET
  3240                                     PI-SAV-PREV-AMT
  3241                                     PI-SAV-PREV-NET
  3242                                     PI-FRST-FILE-SEQ-NO
  3243         MOVE SPACES             TO  PI-FRST-RECORD-TYPE.
  3244
  3245     IF PFENTERL = ZERO
  3246         GO TO 0300-CHECK-PFKEYS.
  3247
  3248     IF (PFENTERI  IS NUMERIC)
  3249       AND (PFENTERI GREATER 0 AND LESS 25)
  3250         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3251     ELSE
  3252         MOVE ER-0029               TO  EMI-ERROR
  3253         GO TO 0320-INPUT-ERROR.
  3254
  3255 0300-CHECK-PFKEYS.
  3256     IF EIBAID = DFHPF23
  3257         GO TO 8810-PF23.
  3258
  3259     IF EIBAID = DFHPF24
  3260         GO TO 9200-RETURN-MAIN-MENU.
  3261
  3262     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  66
* EL633.cbl
  3263         GO TO 9500-PF12.
  3264
  3265     IF EIBAID = DFHPF3
  3266         IF PI-CR-CONTROL-IN-PROGRESS NOT =      SPACES
  3267             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3268             MOVE XCTL-652       TO  PGM-NAME
  3269             IF ERCOMP-KEY  NOT =      SPACES
  3270                 MOVE COMP-CARRIER   TO  PI-CR-CARRIER
  3271                 MOVE COMP-GROUPING  TO  PI-CR-GROUPING
  3272                 MOVE COMP-FIN-RESP  TO  PI-CR-FIN-RESP
  3273                 MOVE COMP-ACCOUNT   TO  PI-CR-ACCOUNT
  3274             END-IF
  3275
  3276             IF PI-CR-ACCOUNT = LOW-VALUES
  3277                 MOVE 'G'        TO  PI-CR-TYPE
  3278                 GO TO 9300-XCTL
  3279             ELSE
  3280                 MOVE 'A'        TO  PI-CR-TYPE
  3281                 GO TO 9300-XCTL
  3282         ELSE
  3283            MOVE ER-3020         TO  EMI-ERROR
  3284            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3285            GO TO 8100-SEND-INITIAL-MAP.
  3286
  3287     IF EIBAID = DFHPF4
  3288         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3289         MOVE XCTL-6331          TO  PGM-NAME
  3290         GO TO 9300-XCTL.
  3291
  3292     IF EIBAID = DFHPF5
  3293         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3294         MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3295         MOVE XCTL-640           TO  PGM-NAME
  3296         IF PI-CR-ACCOUNT = LOW-VALUES
  3297             MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3298             IF ACCTI = LOW-VALUES
  3299                MOVE 'G'         TO  PI-CR-TYPE
  3300             END-IF
  3301             GO TO 9300-XCTL
  3302         ELSE
  3303             MOVE 'A'        TO  PI-CR-TYPE
  3304             GO TO 9300-XCTL.
  3305
  3306     IF EIBAID = DFHPF6
  3307        IF PI-GA-BILLING
  3308            PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  3309            MOVE SPACES TO PI-PROGRAM-WORK-AREA
  3310            MOVE XCTL-642        TO  PGM-NAME
  3311            IF PI-CR-ACCOUNT = LOW-VALUES
  3312                 MOVE 'G'        TO  PI-CR-TYPE
  3313                 GO TO 9300-XCTL
  3314             ELSE
  3315                 MOVE SPACES     TO  PI-CR-CONTROL-IN-PROGRESS
  3316                 GO TO 9300-XCTL
  3317        ELSE
  3318            MOVE ER-2929         TO  EMI-ERROR
  3319            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3320            MOVE AL-UNBON        TO  PFENTERA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  67
* EL633.cbl
  3321            IF PFENTERL = ZERO
  3322                MOVE -1          TO  MAINTL
  3323                GO TO 8200-SEND-DATAONLY
  3324            ELSE
  3325                MOVE -1          TO  PFENTERL
  3326                GO TO 8200-SEND-DATAONLY.
  3327
  3328     IF EIBAID = DFHENTER  OR  DFHPF1  OR  DFHPF2
  3329         GO TO 0400-VALIDATE-KEY-DATA.
  3330
  3331 0320-INPUT-ERROR.
  3332     MOVE ER-0029                TO  EMI-ERROR.
  3333
  3334     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3335
  3336     MOVE AL-UNBON               TO  PFENTERA.
  3337
  3338     IF PFENTERL = ZERO
  3339         MOVE -1                 TO  MAINTL
  3340     ELSE
  3341         MOVE -1                 TO  PFENTERL.
  3342
  3343     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  68
* EL633.cbl
  3345 0400-VALIDATE-KEY-DATA.
  3346     IF MODIFY-CAP  OR (EIBAID = DFHPF1 OR DFHPF2)
  3347         NEXT SENTENCE
  3348       ELSE
  3349        IF MAINTI NOT = 'S'
  3350         MOVE 'UPDATE'       TO SM-READ
  3351         PERFORM 9995-SECURITY-VIOLATION
  3352         MOVE ER-0070        TO EMI-ERROR
  3353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3354         GO TO 8100-SEND-INITIAL-MAP.
  3355
  3356     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD.
  3357
  3358     IF EIBAID = DFHPF1
  3359         GO TO 4000-BROWSE-FRWD.
  3360
  3361     IF EIBAID   = DFHPF1   AND
  3362        CARRIERL = ZEROS    AND
  3363        GROUPL   = ZEROS    AND
  3364        FINRESPL = ZEROS    AND
  3365        ACCTL    = ZEROS
  3366         GO TO 4000-BROWSE-FRWD.
  3367
  3368     IF PI-PROCESSOR-ID = 'LGXX'
  3369         IF MAINTI = 'C'
  3370             MOVE AL-UANON       TO MAINTA
  3371             MOVE MAINTI         TO PI-SAV-FUNCTION
  3372             GO TO CSO-BRANCH
  3373         END-IF
  3374     END-IF.
  3375
  3376     IF MAINTI = 'C' OR  'S'
  3377         MOVE AL-UANON           TO  MAINTA
  3378         MOVE MAINTI             TO  PI-SAV-FUNCTION
  3379     ELSE
  3380         MOVE -1                 TO  MAINTL
  3381         MOVE ER-0023            TO  EMI-ERROR
  3382         MOVE AL-UABON           TO  MAINTA
  3383         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3384
  3385 CSO-BRANCH.
  3386
  3387     IF MAINTI = 'C'
  3388       AND PI-PREV-FUNCTION NOT = 'S' AND 'C'
  3389         MOVE -1                 TO  MAINTL
  3390         MOVE ER-2056            TO  EMI-ERROR
  3391         MOVE AL-UABON           TO  MAINTA
  3392         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3393
  3394     IF CARRIERL = ZEROS  AND
  3395        GROUPL   = ZEROS  AND
  3396        FINRESPL = ZEROS  AND
  3397        ACCTL    = ZEROS
  3398         MOVE -1                 TO  CARRIERL
  3399         MOVE ER-2231            TO  EMI-ERROR
  3400         MOVE AL-UABON           TO  CARRIERA
  3401                                     GROUPA
  3402                                     FINRESPA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  69
* EL633.cbl
  3403                                     ACCTA
  3404         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3405         GO TO 8200-SEND-DATAONLY.
  3406
  3407     IF CARRIERL NOT = ZEROS
  3408         MOVE AL-UANON           TO  CARRIERA
  3409         MOVE CARRIERI           TO  COMP-CARRIER
  3410                                     PI-SAV-CARRIER
  3411                                     PI-CR-CARRIER
  3412         IF CARRIERI NOT = ZEROS
  3413           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3414             MOVE ER-2587        TO  EMI-ERROR
  3415             MOVE -1             TO  CARRIERL
  3416             MOVE AL-UABON       TO  CARRIERA
  3417             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3418         ELSE
  3419             NEXT SENTENCE
  3420     ELSE
  3421         MOVE LOW-VALUES          TO  COMP-CARRIER
  3422                                      PI-SAV-CARRIER.
  3423
  3424     IF CARRIERL NOT = ZEROS
  3425         IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  3426             IF PI-CARRIER-SECURITY = CARRIERI
  3427                 NEXT SENTENCE
  3428             ELSE
  3429                 MOVE -1         TO  CARRIERL
  3430                 MOVE ER-2370    TO  EMI-ERROR
  3431                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3432
  3433     IF GROUPL NOT = ZEROS
  3434         MOVE AL-UANON           TO  GROUPA
  3435         MOVE GROUPI             TO  COMP-GROUPING
  3436                                     PI-SAV-GROUPING
  3437                                     PI-CR-GROUPING
  3438         IF GROUPI NOT = ZEROS
  3439           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3440             MOVE ER-2588        TO  EMI-ERROR
  3441             MOVE -1             TO  GROUPL
  3442             MOVE AL-UABON       TO  GROUPA
  3443             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3444         ELSE
  3445             NEXT SENTENCE
  3446     ELSE
  3447         MOVE LOW-VALUES         TO  COMP-GROUPING
  3448                                     PI-SAV-GROUPING.
  3449
  3450     IF FINRESPL NOT = ZEROS
  3451         MOVE AL-UANON           TO  FINRESPA
  3452         MOVE FINRESPI           TO  COMP-FIN-RESP
  3453                                     PI-SAV-FIN-RESP
  3454                                     PI-CR-FIN-RESP
  3455     ELSE
  3456         MOVE LOW-VALUES         TO  COMP-FIN-RESP
  3457                                     PI-SAV-FIN-RESP.
  3458
  3459     IF ACCTL NOT = ZEROS
  3460         MOVE AL-UANON           TO  ACCTA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  70
* EL633.cbl
  3461         MOVE ACCTI              TO  COMP-ACCOUNT
  3462                                     PI-SAV-ACCOUNT
  3463                                     PI-CR-ACCOUNT
  3464     ELSE
  3465         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3466                                     PI-SAV-ACCOUNT
  3467                                     PI-CR-ACCOUNT.
  3468
  3469     IF EMI-ERROR = ZEROS
  3470         NEXT SENTENCE
  3471     ELSE
  3472         IF EIBTRNID = EL640-TRANS-ID OR
  3473            EIBTRNID = EL642-TRANS-ID OR
  3474            EIBTRNID = EL6331-TRANS-ID
  3475             GO TO 8100-SEND-INITIAL-MAP
  3476         ELSE
  3477             GO TO 8200-SEND-DATAONLY.
  3478
  3479     MOVE MAINTI                 TO  PI-PREV-FUNCTION.
  3480
  3481     IF MAINTI = 'S'
  3482         IF EIBAID = DFHPF1              OR  DFHENTER
  3483             GO TO 4000-BROWSE-FRWD
  3484         ELSE
  3485             GO TO 4100-BROWSE-BKWD.
  3486
  3487     MOVE SPACES                 TO  COMP-RECORD-TYPE.
  3488     MOVE PI-COMPANY-CD          TO  COMP-COMP-CD.
  3489
  3490
  3491* EXEC CICS HANDLE CONDITION
  3492*        NOTFND   (0410-NO-COMP-MSTR)
  3493*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3494*        END-EXEC.
  3495*    MOVE '"$IJ                  ! # #00003447' TO DFHEIV0
  3496     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3498     MOVE X'2320233030303033343437' TO DFHEIV0(25:11)
  3499     CALL 'kxdfhei1' USING DFHEIV0
  3500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3501
  3502
  3503
  3504* EXEC CICS READ
  3505*        DATASET  (COMP-FILE-ID)
  3506*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3507*        RIDFLD   (ERCOMP-KEY)
  3508*        GTEQ
  3509*        END-EXEC.
  3510*    MOVE '&"S        G          (   #00003452' TO DFHEIV0
  3511     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3513     MOVE X'2020233030303033343532' TO DFHEIV0(25:11)
  3514     CALL 'kxdfhei1' USING DFHEIV0,
  3515           COMP-FILE-ID,
  3516           DFHEIV20,
  3517           DFHEIV99,
  3518           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  71
* EL633.cbl
  3519           DFHEIV99,
  3520           DFHEIV99,
  3521           DFHEIV99
  3522     SET ADDRESS OF COMPENSATION-MASTER TO
  3523         DFHEIV20
  3524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3525
  3526
  3527     IF PI-COMPANY-CD = CO-COMPANY-CD  AND
  3528        COMP-CARRIER  = CO-CARRIER     AND
  3529        COMP-GROUPING = CO-GROUPING    AND
  3530        COMP-FIN-RESP = CO-RESP-NO    AND
  3531        COMP-ACCOUNT  = CO-ACCOUNT
  3532         NEXT SENTENCE
  3533     ELSE
  3534         GO TO 0410-NO-COMP-MSTR.
  3535
  3536     IF PI-COMPANY-ID = 'NCL'
  3537         IF CO-GA-INACTIVE
  3538             GO TO 0420-INACTIVE-COMP.
  3539
  3540     IF MAINTI = 'C'
  3541         GO TO 1000-EDIT-DATA.
  3542
  3543     IF EIBAID = DFHPF1
  3544       OR DFHENTER
  3545         GO TO 4000-BROWSE-FRWD.
  3546
  3547     IF EIBAID = DFHPF2
  3548         GO TO 4100-BROWSE-BKWD.
  3549
  3550 0410-NO-COMP-MSTR.
  3551     MOVE ER-2230                TO  EMI-ERROR.
  3552     MOVE -1                     TO  CARRIERL.
  3553     MOVE AL-UABON               TO  CARRIERA
  3554                                     GROUPA
  3555                                     FINRESPA
  3556                                     ACCTA.
  3557
  3558     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3559
  3560     GO TO 8200-SEND-DATAONLY.
  3561
  3562 0420-INACTIVE-COMP.
  3563     MOVE ER-2763                TO  EMI-ERROR.
  3564     MOVE -1                     TO  CARRIERL.
  3565     MOVE AL-UABON               TO  CARRIERA
  3566                                     GROUPA
  3567                                     FINRESPA
  3568                                     ACCTA.
  3569
  3570     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3571
  3572     GO TO 8200-SEND-DATAONLY.
  3573
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  72
* EL633.cbl
  3575 0500-CREATE-TEMP-STORAGE.
  3576
  3577     PERFORM 0800-DELETE-TS  THRU  0890-EXIT.
  3578
  3579
  3580* EXEC CICS WRITEQ TS
  3581*        QUEUE  (QID)
  3582*        FROM   (PROGRAM-INTERFACE-BLOCK)
  3583*        LENGTH (PI-COMM-LENGTH)
  3584*    END-EXEC.
  3585*    MOVE '*"                    ''   #00003511' TO DFHEIV0
  3586     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3588     MOVE X'2020233030303033353131' TO DFHEIV0(25:11)
  3589     CALL 'kxdfhei1' USING DFHEIV0,
  3590           QID,
  3591           PROGRAM-INTERFACE-BLOCK,
  3592           PI-COMM-LENGTH,
  3593           DFHEIV99,
  3594           DFHEIV99,
  3595           DFHEIV99
  3596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3597
  3598
  3599 0590-EXIT.
  3600      EXIT.
  3601
  3602 0600-RECOVER-TEMP-STORAGE.
  3603
  3604* EXEC CICS READQ TS
  3605*        QUEUE  (QID)
  3606*        INTO   (PROGRAM-INTERFACE-BLOCK)
  3607*        LENGTH (PI-COMM-LENGTH)
  3608*    END-EXEC.
  3609*    MOVE '*$I    L              ''   #00003521' TO DFHEIV0
  3610     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3611     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3612     MOVE X'2020233030303033353231' TO DFHEIV0(25:11)
  3613     CALL 'kxdfhei1' USING DFHEIV0,
  3614           QID,
  3615           PROGRAM-INTERFACE-BLOCK,
  3616           PI-COMM-LENGTH,
  3617           DFHEIV99,
  3618           DFHEIV99,
  3619           DFHEIV99
  3620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3621
  3622
  3623     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  3624
  3625 0690-EXIT.
  3626      EXIT.
  3627
  3628 0800-DELETE-TS.
  3629
  3630* EXEC CICS HANDLE CONDITION
  3631*        QIDERR (0890-EXIT)
  3632*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  73
* EL633.cbl
  3633*    MOVE '"$N                   ! $ #00003533' TO DFHEIV0
  3634     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3635     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3636     MOVE X'2420233030303033353333' TO DFHEIV0(25:11)
  3637     CALL 'kxdfhei1' USING DFHEIV0
  3638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3639
  3640
  3641
  3642* EXEC CICS DELETEQ TS
  3643*        QUEUE  (QID)
  3644*    END-EXEC.
  3645*    MOVE '*&                    #   #00003537' TO DFHEIV0
  3646     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3647     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3648     MOVE X'2020233030303033353337' TO DFHEIV0(25:11)
  3649     CALL 'kxdfhei1' USING DFHEIV0,
  3650           QID,
  3651           DFHEIV99
  3652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3653
  3654
  3655
  3656* EXEC CICS SYNCPOINT
  3657*    END-EXEC.
  3658*    MOVE '6"                    !   #00003541' TO DFHEIV0
  3659     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  3660     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3661     MOVE X'2020233030303033353431' TO DFHEIV0(25:11)
  3662     CALL 'kxdfhei1' USING DFHEIV0
  3663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3664
  3665
  3666 0890-EXIT.
  3667      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  74
* EL633.cbl
  3669
  3670 1000-EDIT-DATA.
  3671     SET PINDX                   TO  1.
  3672
  3673     .
  3674 1010-EDIT-LOOP.
  3675     SET NDX                     TO  PINDX.
  3676     IF GL-ACCT-LEN (PINDX)   = ZEROS  AND
  3677        GL-STATE-LEN (PINDX) = ZEROS   AND
  3678        GL-CANC-LEN (PINDX)   = ZEROS  AND
  3679        GL-COMM-LEN (PINDX)   = ZEROS  AND
  3680        RTYPE-LEN (PINDX)     = ZEROS  AND
  3681        AMT-LEN (PINDX)       = ZEROS  AND
  3682        VOID-SW-LEN (PINDX)   = ZEROS  AND
  3683        SDTE-LEN (PINDX)      = ZEROS
  3684         GO TO 1020-INCREMENT-PINDX.
  3685
  3686     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3687         MOVE AL-UANON           TO  GL-ACCT-ATTRB (PINDX)
  3688         IF PI-COMPANY-ID NOT = 'WSL'
  3689             NEXT SENTENCE
  3690         ELSE
  3691             MOVE WSL-COMM-DTE (PINDX)  TO  DC-GREG-DATE-1-MDY
  3692             MOVE '4'                   TO  DC-OPTION-CODE
  3693             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3694             IF NO-CONVERSION-ERROR
  3695                 NEXT SENTENCE
  3696             ELSE
  3697                 MOVE ER-2595    TO  EMI-ERROR
  3698                 MOVE -1         TO  GL-ACCT-LEN (PINDX)
  3699                 MOVE AL-UABON   TO  GL-ACCT-ATTRB (PINDX)
  3700                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3701     ELSE
  3702         IF PI-COMPANY-ID = 'WSL'
  3703           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3704             MOVE ER-2596        TO  EMI-ERROR
  3705             MOVE -1             TO  GL-ACCT-LEN (PINDX)
  3706             MOVE AL-UABON       TO  GL-ACCT-ATTRB (PINDX)
  3707             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3708
  3709
  3710     IF GL-ACCT-LEN (PINDX) NOT = ZEROES
  3711*        MOVE K-SPACE            TO COFA-FILLER
  3712*        MOVE '0001'             TO COFA-COMPANY-X
  3713*        MOVE MSA-ACCT (PINDX)   TO COFA-MSA-ACCT
  3714         MOVE AL-UANON           TO GL-ACCT-ATTRB (PINDX)
  3715     ELSE
  3716         IF PI-FILE-SEQ-NO (NDX) = ZEROES
  3717             MOVE -1             TO GL-ACCT-LEN (PINDX)
  3718             MOVE ER-2957        TO EMI-ERROR
  3719             MOVE AL-UABON       TO GL-ACCT-ATTRB (PINDX)
  3720             PERFORM 9900-ERROR-FORMAT THRU
  3721                     9900-EXIT
  3722             GO TO 1040-CONTINUE-EDIT
  3723         ELSE
  3724             GO TO 1040-CONTINUE-EDIT
  3725         END-IF
  3726     END-IF.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  75
* EL633.cbl
  3727
  3728     IF (PI-COMPANY-ID = 'DCC')
  3729        AND (RTYPE (PINDX) = 'P')
  3730        GO TO 1040-CONTINUE-EDIT
  3731     END-IF
  3732     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  3733        MOVE GL-ACCT (PINDX)     TO CHECK-GL-ACCT
  3734     ELSE
  3735        MOVE SPACES              TO CHECK-GL-ACCT
  3736     END-IF
  3737
  3738     EVALUATE TRUE
  3739        WHEN (PI-COMPANY-ID = 'DCC')
  3740           AND (CO-CARRIER = '1' OR '2')
  3741           AND (VALID-DCC-GL-ACCOUNT)
  3742           GO TO 1040-CONTINUE-EDIT
  3743        WHEN (PI-COMPANY-ID = 'DCC')
  3744           AND (CO-CARRIER = '3' OR '4')
  3745           AND VALID-CSI-GL-ACCOUNT
  3746           GO TO 1040-CONTINUE-EDIT
  3747        WHEN (PI-COMPANY-ID = 'DCC')
  3748           AND (CO-CARRIER = '5' OR '6')
  3749           AND (VALID-CCC-GL-ACCOUNT)
  3750           GO TO 1040-CONTINUE-EDIT
  3751        WHEN (PI-COMPANY-ID = 'CID')
  3752           AND (VALID-GL-ACCOUNT)
  3753           GO TO 1040-CONTINUE-EDIT
  3754     END-EVALUATE
  3755*    EXEC CICS HANDLE CONDITION
  3756*         NOTFND (1040-NO-COFA-MSTR)
  3757*         NOTOPEN (7100-COFA-FILE-NOTOPEN)
  3758*    END-EXEC.
  3759*
  3760*    EXEC CICS READ
  3761*         DATASET (COFA-FILE-ID)
  3762*         SET     (ADDRESS OF CHART-OF-ACCOUNTS)
  3763*         RIDFLD  (COFA-KEY-X)
  3764*    END-EXEC.
  3765*
  3766*    MOVE CHART-OF-ACCOUNTS      TO SV-COFA.
  3767*    GO TO 1040-CONTINUE-EDIT.
  3768*
  3769*1040-NO-COFA-MSTR.
  3770
  3771     MOVE ER-2960                TO EMI-ERROR.
  3772     MOVE -1                     TO GL-ACCT-LEN (PINDX).
  3773     MOVE AL-UABON               TO GL-ACCT-ATTRB (PINDX).
  3774     PERFORM 9900-ERROR-FORMAT THRU
  3775             9900-EXIT.
  3776
  3777 1040-CONTINUE-EDIT.
  3778
  3779*    MOVE MSA-ACCT (PINDX)       TO WS-ACCT-BREAK.
  3780     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  3781         MOVE GL-STATE (PINDX)   TO CHECK-STATE-CODE
  3782         IF NOT VALID-STATE-CODE
  3783             MOVE -1             TO GL-STATE-LEN (PINDX)
  3784             MOVE ER-2957        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  76
* EL633.cbl
  3785             MOVE AL-UABON       TO GL-STATE-ATTRB (PINDX)
  3786             PERFORM 9900-ERROR-FORMAT THRU
  3787                     9900-EXIT
  3788         ELSE
  3789             MOVE AL-UANON       TO GL-STATE-ATTRB (PINDX)
  3790         END-IF
  3791     END-IF.
  3792
  3793 1040-CSO-SKIP.
  3794
  3795     IF GL-CANC (PINDX) = LOW-VALUES
  3796         MOVE SPACES             TO GL-CANC (PINDX)
  3797     END-IF.
  3798
  3799     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  3800         MOVE GL-CANC (PINDX)    TO CHECK-CANC-TYPE
  3801         IF NOT VALID-CANC-TYPE
  3802             MOVE -1             TO GL-CANC-LEN (PINDX)
  3803             MOVE ER-2958        TO EMI-ERROR
  3804             MOVE AL-UABON       TO GL-CANC-ATTRB (PINDX)
  3805             PERFORM 9900-ERROR-FORMAT THRU
  3806                     9900-EXIT
  3807         ELSE
  3808             MOVE AL-UANON       TO GL-CANC-ATTRB (PINDX)
  3809         END-IF
  3810     END-IF.
  3811
  3812     IF RTYPE-LEN (PINDX) NOT = ZEROS
  3813        MOVE RTYPE (PINDX)       TO  CHECK-REC-TYPE
  3814        IF (PI-COMPANY-ID = 'DCC')
  3815           AND (RTYPE (PINDX) = 'P')
  3816           SET VALID-REC-TYPE   TO TRUE
  3817        END-IF
  3818         IF NOT VALID-REC-TYPE
  3819             MOVE -1             TO  RTYPE-LEN (PINDX)
  3820             MOVE ER-2234        TO  EMI-ERROR
  3821             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3822             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3823         ELSE
  3824             MOVE AL-UANON       TO  RTYPE-ATTRB (PINDX)
  3825     ELSE
  3826         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3827             MOVE -1             TO  RTYPE-LEN (PINDX)
  3828             MOVE ER-2235        TO  EMI-ERROR
  3829             MOVE AL-UABON       TO  RTYPE-ATTRB (PINDX)
  3830             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3831
  3832     IF AMT-LEN (PINDX) NOT = ZEROS
  3833
  3834* EXEC CICS BIF DEEDIT
  3835*           FIELD (AMT (PINDX))
  3836*           LENGTH (11)
  3837*       END-EXEC
  3838     MOVE 11
  3839       TO DFHEIV11
  3840*    MOVE '@"L                   #   #00003711' TO DFHEIV0
  3841     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3842     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  77
* EL633.cbl
  3843     MOVE X'2020233030303033373131' TO DFHEIV0(25:11)
  3844     CALL 'kxdfhei1' USING DFHEIV0,
  3845           AMT(PINDX),
  3846           DFHEIV11
  3847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3848         IF AMT (PINDX) = ZEROS
  3849             IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3850                 NEXT SENTENCE
  3851             ELSE
  3852                 MOVE ER-2245    TO  EMI-ERROR
  3853                 MOVE -1         TO  AMT-LEN(PINDX)
  3854                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3855                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3856         ELSE
  3857             IF AMT (PINDX) NUMERIC
  3858                 MOVE AMT (PINDX) TO  AMTO (PINDX)
  3859             ELSE
  3860                 MOVE ER-2245    TO  EMI-ERROR
  3861                 MOVE -1         TO  AMT-LEN(PINDX)
  3862                 MOVE AL-UNBON   TO  AMT-ATTRB (PINDX)
  3863                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3864     ELSE
  3865         IF PI-FILE-SEQ-NO (NDX) = ZEROS
  3866             MOVE -1             TO  AMT-LEN (PINDX)
  3867             MOVE ER-2236        TO  EMI-ERROR
  3868             MOVE AL-UNBON       TO  AMT-ATTRB (PINDX)
  3869             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3870
  3871     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  3872         IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  3873           AND (PI-REC-TYPE (NDX) = 'C')
  3874             IF VOID-SW (PINDX) = 'V'
  3875                 MOVE AL-UANON   TO  VOID-SW-ATTRB (PINDX)
  3876             ELSE
  3877                 MOVE ER-2246    TO  EMI-ERROR
  3878                 MOVE -1         TO  VOID-SW-LEN (PINDX)
  3879                 MOVE AL-UABON   TO  VOID-SW-ATTRB (PINDX)
  3880                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3881         ELSE
  3882             MOVE ER-2449        TO  EMI-ERROR
  3883             MOVE -1             TO  VOID-SW-LEN (PINDX)
  3884             MOVE AL-UABON       TO  VOID-SW-ATTRB (PINDX)
  3885             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3886
  3887     IF SDTE-LEN (PINDX) = ZEROS
  3888        GO TO 1020-INCREMENT-PINDX.
  3889
  3890     MOVE AL-UNNON               TO  SDTE-ATTRB (PINDX).
  3891
  3892     MOVE SDTE (PINDX)           TO DEEDIT-FIELD.
  3893     PERFORM 8600-DEEDIT.
  3894
  3895     IF DEEDIT-FIELD-V0 NOT NUMERIC
  3896        GO TO 1015-DAY-ERROR.
  3897
  3898     MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY.
  3899     MOVE '4'                    TO  DC-OPTION-CODE.
  3900     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  78
* EL633.cbl
  3901
  3902     IF NO-CONVERSION-ERROR
  3903        SET PINDEX               TO  PINDX
  3904        MOVE DC-BIN-DATE-1       TO  WS-EOM-DT (PINDEX)
  3905     ELSE
  3906        GO TO 1015-DAY-ERROR.
  3907
  3908     MOVE DEEDIT-FIELD-V0        TO DATE-TEST-AREA.
  3909
  3910     IF DATE-TEST-MM = 4 OR  6  OR  9  OR  11
  3911         IF DATE-TEST-DD  NOT = 30
  3912             GO TO 1015-DAY-ERROR
  3913         ELSE
  3914             GO TO 1020-INCREMENT-PINDX.
  3915
  3916     IF DATE-TEST-MM = 1 OR  3  OR  5  OR  7  OR
  3917                             8  OR  10  OR  12
  3918         IF DATE-TEST-DD  NOT = 31
  3919             GO TO 1015-DAY-ERROR
  3920         ELSE
  3921             GO TO 1020-INCREMENT-PINDX.
  3922
  3923     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3924         REMAINDER  DIVIDE-REMAINDER.
  3925
  3926     IF (DATE-TEST-YY = ZERO)
  3927       OR (DIVIDE-REMAINDER NOT = ZERO)
  3928         IF DATE-TEST-DD  NOT = 28
  3929             GO TO 1015-DAY-ERROR
  3930         ELSE
  3931             GO TO 1020-INCREMENT-PINDX
  3932     ELSE
  3933         IF DATE-TEST-DD = 29
  3934             GO TO 1020-INCREMENT-PINDX.
  3935
  3936 1015-DAY-ERROR.
  3937     MOVE -1                     TO  SDTE-LEN (PINDX).
  3938     MOVE AL-UNBON               TO  SDTE-ATTRB (PINDX).
  3939     MOVE ER-0587                TO  EMI-ERROR.
  3940
  3941     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3942
  3943 1020-INCREMENT-PINDX.
  3944     SET PINDX  UP  BY  1.
  3945
  3946     IF PINDX  IS NOT GREATER THAN  13
  3947         GO TO 1010-EDIT-LOOP.
  3948
  3949     IF EMI-ERROR = ZEROS
  3950         NEXT SENTENCE
  3951     ELSE
  3952         MOVE 'S'                TO  PI-PREV-FUNCTION
  3953         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  79
* EL633.cbl
  3955 2000-UPDATE-THE-FILE.
  3956     SET PINDX                   TO  ZERO-NDX.
  3957*    SET NDX                     TO  ZERO-NDX.
  3958*    SET NDX  UP  BY  1.
  3959
  3960     IF PI-PYAJ-FILE-SW = 'B'
  3961         MOVE WORK-SEQ-NO        TO  PI-FRST-FILE-SEQ-NO
  3962         MOVE RTYPE (PINDX)      TO  PI-FRST-RECORD-TYPE
  3963     ELSE
  3964         MOVE PI-LAST-FILE-SEQ-NO
  3965                                 TO  PI-SAV-FILE-SEQ-NO
  3966         MOVE PI-LAST-RECORD-TYPE
  3967                                 TO  PI-SAV-RECORD-TYPE.
  3968
  3969 2100-UPDATE-LOOP.
  3970     SET PINDX  UP  BY  1.
  3971     SET NDX                     TO  PINDX.
  3972
  3973     IF PINDX  IS GREATER THAN  13
  3974         GO TO 2200-UPDATE-COMPLETE.
  3975
  3976     IF GL-ACCT-LEN (PINDX)   = ZEROS AND
  3977        GL-STATE-LEN (PINDX) = ZEROS AND
  3978        GL-CANC-LEN (PINDX)   = ZEROS AND
  3979        GL-COMM-LEN (PINDX)   = ZEROS AND
  3980        RTYPE-LEN (PINDX)   = ZEROS  AND
  3981        AMT-LEN (PINDX)     = ZEROS  AND
  3982        VOID-SW-LEN (PINDX) = ZEROS  AND
  3983        SDTE-LEN (PINDX)    = ZEROS
  3984         GO TO 2100-UPDATE-LOOP.
  3985
  3986
  3987* EXEC CICS BIF DEEDIT
  3988*         FIELD (AMT (PINDX))
  3989*         LENGTH (11)
  3990*    END-EXEC.
  3991     MOVE 11
  3992       TO DFHEIV11
  3993*    MOVE '@"L                   #   #00003853' TO DFHEIV0
  3994     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3995     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3996     MOVE X'2020233030303033383533' TO DFHEIV0(25:11)
  3997     CALL 'kxdfhei1' USING DFHEIV0,
  3998           AMT(PINDX),
  3999           DFHEIV11
  4000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4001
  4002
  4003     IF PI-FILE-SEQ-NO (NDX) NOT = ZEROS
  4004         NEXT SENTENCE
  4005     ELSE
  4006         GO TO 2110-ADD-RECORD.
  4007
  4008
  4009* EXEC CICS HANDLE CONDITION
  4010*        NOTFND  (2110-ADD-RECORD)
  4011*    END-EXEC.
  4012*    MOVE '"$I                   ! % #00003863' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  80
* EL633.cbl
  4013     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4015     MOVE X'2520233030303033383633' TO DFHEIV0(25:11)
  4016     CALL 'kxdfhei1' USING DFHEIV0
  4017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4018
  4019
  4020     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4021     MOVE PI-FILE-SEQ-NO (NDX)    TO  PYAJ-FILE-SEQ-NO.
  4022     MOVE PI-REC-TYPE (NDX)       TO  PYAJ-RECORD-TYPE.
  4023
  4024
  4025* EXEC CICS READ
  4026*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4027*        DATASET  (PYAJ-FILE-ID)
  4028*        RIDFLD   (ERPYAJ-KEY)
  4029*        UPDATE
  4030*    END-EXEC.
  4031*    MOVE '&"S        EU         (   #00003871' TO DFHEIV0
  4032     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4033     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4034     MOVE X'2020233030303033383731' TO DFHEIV0(25:11)
  4035     CALL 'kxdfhei1' USING DFHEIV0,
  4036           PYAJ-FILE-ID,
  4037           DFHEIV20,
  4038           DFHEIV99,
  4039           ERPYAJ-KEY,
  4040           DFHEIV99,
  4041           DFHEIV99,
  4042           DFHEIV99
  4043     SET ADDRESS OF PENDING-PAY-ADJ TO
  4044         DFHEIV20
  4045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4046
  4047
  4048
  4049     IF RTYPE-LEN (PINDX)  GREATER THAN +0
  4050        IF RTYPE (PINDX) NOT = PY-RECORD-TYPE
  4051            MOVE PENDING-PAY-ADJ TO WS-SAVE-ERPYAJ
  4052            PERFORM 2190-CHANGE-RECORD-TYPE THRU 2190-EXIT
  4053            MOVE RTYPE (PINDX)     TO  PI-FRST-RECORD-TYPE.
  4054
  4055     IF AMT-LEN (PINDX) NOT = ZEROS
  4056         IF AMT (PINDX) = ZEROS
  4057             IF PY-CHECK-WRITTEN-DT = LOW-VALUES
  4058                 GO TO 2120-DELETE-RECORD
  4059             ELSE
  4060                 MOVE ER-2244       TO  EMI-ERROR
  4061                 MOVE -1            TO  AMT-LEN (PINDX)
  4062                 MOVE AL-UNBON      TO  AMT-ATTRB (PINDX)
  4063                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4064                 MOVE PY-ENTRY-AMT  TO  AMTO (PINDX)
  4065
  4066* EXEC CICS UNLOCK
  4067*                    DATASET  (PYAJ-FILE-ID)
  4068*                END-EXEC
  4069*    MOVE '&*                    #   #00003895' TO DFHEIV0
  4070     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  81
* EL633.cbl
  4071     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4072     MOVE X'2020233030303033383935' TO DFHEIV0(25:11)
  4073     CALL 'kxdfhei1' USING DFHEIV0,
  4074           PYAJ-FILE-ID,
  4075           DFHEIV99
  4076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4077                 GO TO 8200-SEND-DATAONLY.
  4078
  4079     MOVE 'B'                    TO  JP-RECORD-TYPE.
  4080     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4081     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4082
  4083     PERFORM 8400-LOG-JOURNAL-RECORD.
  4084
  4085     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4086     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4087     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4088
  4089     IF GL-ACCT-LEN (PINDX) NOT = ZEROS
  4090         MOVE GL-ACCT (PINDX)    TO  PY-GL-ACCOUNT.
  4091     IF GL-STATE-LEN (PINDX) NOT = ZEROS
  4092         MOVE GL-STATE (PINDX)   TO  PY-GL-STATE.
  4093     IF GL-CANC-LEN (PINDX) NOT = ZEROS
  4094         MOVE GL-CANC (PINDX)    TO  PY-GL-CANC-SW.
  4095     IF GL-COMM-LEN (PINDX) NOT = ZEROS
  4096         MOVE GL-COMM (PINDX)    TO  PY-GL-COMMENT.
  4097     IF AMT-LEN (PINDX) NOT = ZEROS
  4098         MOVE AMT (PINDX)        TO  PY-ENTRY-AMT.
  4099
  4100     IF VOID-SW-LEN (PINDX) NOT = ZEROS
  4101         MOVE VOID-SW (PINDX)    TO  PY-VOID-SW.
  4102
  4103     IF SDTE-LEN (PINDX) NOT = ZEROS
  4104        SET PINDEX               TO  PINDX
  4105        MOVE WS-EOM-DT (PINDEX)  TO  PY-CREDIT-SELECT-DT.
  4106
  4107     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4108     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4109     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4110
  4111
  4112* EXEC CICS REWRITE
  4113*        DATASET  (PYAJ-FILE-ID)
  4114*        FROM     (PENDING-PAY-ADJ)
  4115*    END-EXEC.
  4116     MOVE LENGTH OF
  4117      PENDING-PAY-ADJ
  4118       TO DFHEIV11
  4119*    MOVE '&& L                  %   #00003932' TO DFHEIV0
  4120     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4122     MOVE X'2020233030303033393332' TO DFHEIV0(25:11)
  4123     CALL 'kxdfhei1' USING DFHEIV0,
  4124           PYAJ-FILE-ID,
  4125           PENDING-PAY-ADJ,
  4126           DFHEIV11,
  4127           DFHEIV99
  4128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  82
* EL633.cbl
  4129
  4130
  4131     PERFORM 8400-LOG-JOURNAL-RECORD.
  4132
  4133     GO TO 2100-UPDATE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  83
* EL633.cbl
  4135 2110-ADD-RECORD.
  4136
  4137* EXEC CICS GETMAIN
  4138*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4139*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4140*        INITIMG  (GETMAIN-SPACE)
  4141*    END-EXEC.
  4142*    MOVE ',"IL                  $   #00003942' TO DFHEIV0
  4143     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4144     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4145     MOVE X'2020233030303033393432' TO DFHEIV0(25:11)
  4146     CALL 'kxdfhei1' USING DFHEIV0,
  4147           DFHEIV20,
  4148           ERPYAJ-RECORD-LENGTH,
  4149           GETMAIN-SPACE
  4150     SET ADDRESS OF PENDING-PAY-ADJ TO
  4151         DFHEIV20
  4152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4153
  4154
  4155     MOVE 'PY'                   TO  PY-RECORD-ID.
  4156     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4157     MOVE PI-SAV-CARRIER         TO  PY-CARRIER.
  4158     MOVE PI-SAV-GROUPING        TO  PY-GROUPING.
  4159     MOVE PI-SAV-FIN-RESP        TO  PY-FIN-RESP.
  4160     MOVE PI-SAV-ACCOUNT         TO  PY-ACCOUNT.
  4161
  4162     ADD +1                      TO  WORK-SEQ-NO.
  4163     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4164
  4165     MOVE GL-ACCT (PINDX)        TO  PY-GL-ACCOUNT.
  4166     MOVE GL-STATE (PINDX)       TO  PY-GL-STATE.
  4167     MOVE GL-CANC (PINDX)        TO  PY-GL-CANC-SW.
  4168     MOVE GL-COMM (PINDX)        TO  PY-GL-COMMENT.
  4169
  4170     MOVE RTYPE (PINDX)          TO  PY-RECORD-TYPE.
  4171     MOVE AMT (PINDX)            TO  PY-ENTRY-AMT.
  4172     IF CO-TYPE = 'B' OR 'A' OR 'G'
  4173        MOVE CO-TYPE             TO  PY-ERCOMP-TYPE
  4174     END-IF
  4175     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4176     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4177     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT
  4178                                     PY-INPUT-DT.
  4179     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4180                                     PY-CHECK-QUE-SEQUENCE.
  4181     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4182                                     PY-BILLED-DATE
  4183                                     PY-AR-DATE
  4184                                     PY-REPORTED-DT
  4185                                     PY-CHECK-WRITTEN-DT.
  4186     IF SDTE-LEN (PINDX) = ZEROS
  4187         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT
  4188         GO TO 2115-WRITE-REC
  4189     END-IF.
  4190
  4191     IF SDTE (PINDX) IS NUMERIC
  4192         MOVE SDTE (PINDX)   TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  84
* EL633.cbl
  4193         MOVE '4'            TO  DC-OPTION-CODE
  4194         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4195         IF DATE-CONVERSION-ERROR
  4196             MOVE PI-CR-MONTH-END-DT
  4197                             TO  PY-CREDIT-SELECT-DT
  4198         ELSE
  4199             MOVE DC-BIN-DATE-1
  4200                             TO  PY-CREDIT-SELECT-DT
  4201         END-IF
  4202     ELSE
  4203         MOVE PI-CR-MONTH-END-DT
  4204                             TO  PY-CREDIT-SELECT-DT
  4205     END-IF
  4206
  4207     IF PI-SAV-FILE-SEQ-NO NOT GREATER THAN ZEROS
  4208         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4209         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4210
  4211     IF FIRST-ADD AND END-OF-ACCT-FULL-PAGE
  4212         MOVE RTYPE (PINDX)      TO  PI-SAV-RECORD-TYPE
  4213         MOVE WORK-SEQ-NO        TO  PI-SAV-FILE-SEQ-NO.
  4214
  4215     MOVE 'N'                    TO  FIRST-ADD-SW.
  4216
  4217     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4218     MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4219     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4220 2115-WRITE-REC.
  4221
  4222* EXEC CICS WRITE
  4223*        DATASET  (PYAJ-FILE-ID)
  4224*        FROM     (PENDING-PAY-ADJ)
  4225*        RIDFLD   (PY-CONTROL-PRIMARY)
  4226*    END-EXEC.
  4227     MOVE LENGTH OF
  4228      PENDING-PAY-ADJ
  4229       TO DFHEIV11
  4230*    MOVE '&$ L                  ''   #00004014' TO DFHEIV0
  4231     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4233     MOVE X'2020233030303034303134' TO DFHEIV0(25:11)
  4234     CALL 'kxdfhei1' USING DFHEIV0,
  4235           PYAJ-FILE-ID,
  4236           PENDING-PAY-ADJ,
  4237           DFHEIV11,
  4238           PY-CONTROL-PRIMARY,
  4239           DFHEIV99,
  4240           DFHEIV99
  4241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4242
  4243
  4244     PERFORM 8400-LOG-JOURNAL-RECORD.
  4245
  4246     GO TO 2100-UPDATE-LOOP.
  4247
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  85
* EL633.cbl
  4249 2120-DELETE-RECORD.
  4250     IF PY-RECORD-TYPE NOT = 'C'
  4251         GO TO 2120-DELETE-CONT.
  4252
  4253     IF PY-CHECK-QUE-CONTROL = ZEROS
  4254       AND PY-CHECK-QUE-SEQUENCE = ZEROS
  4255         GO TO 2120-DELETE-CONT.
  4256
  4257
  4258* EXEC CICS HANDLE CONDITION
  4259*        NOTFND  (2120-DELETE-CONT)
  4260*    END-EXEC.
  4261*    MOVE '"$I                   ! & #00004033' TO DFHEIV0
  4262     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4264     MOVE X'2620233030303034303333' TO DFHEIV0(25:11)
  4265     CALL 'kxdfhei1' USING DFHEIV0
  4266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4267
  4268
  4269     MOVE PY-COMPANY-CD          TO  CHKQ-COMPANY-CD.
  4270     MOVE PY-CHECK-QUE-CONTROL   TO  CHKQ-CONTROL-NUMBER.
  4271     MOVE PY-CHECK-QUE-SEQUENCE  TO  CHKQ-SEQUENCE-NUMBER.
  4272
  4273
  4274* EXEC CICS READ
  4275*        SET      (ADDRESS OF CHECK-QUE)
  4276*        DATASET  (CHKQ-FILE-ID)
  4277*        RIDFLD   (ERCHKQ-KEY)
  4278*        UPDATE
  4279*    END-EXEC.
  4280*    MOVE '&"S        EU         (   #00004041' TO DFHEIV0
  4281     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4282     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4283     MOVE X'2020233030303034303431' TO DFHEIV0(25:11)
  4284     CALL 'kxdfhei1' USING DFHEIV0,
  4285           CHKQ-FILE-ID,
  4286           DFHEIV20,
  4287           DFHEIV99,
  4288           ERCHKQ-KEY,
  4289           DFHEIV99,
  4290           DFHEIV99,
  4291           DFHEIV99
  4292     SET ADDRESS OF CHECK-QUE TO
  4293         DFHEIV20
  4294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4295
  4296
  4297*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4298*    MOVE CHKQ-FILE-ID           TO  JP-FILE-ID.
  4299*    MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4300*
  4301*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4302
  4303
  4304* EXEC CICS DELETE
  4305*        DATASET  (CHKQ-FILE-ID)
  4306*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  86
* EL633.cbl
  4307*    MOVE '&(                    &   #00004054' TO DFHEIV0
  4308     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4309     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4310     MOVE X'2020233030303034303534' TO DFHEIV0(25:11)
  4311     CALL 'kxdfhei1' USING DFHEIV0,
  4312           CHKQ-FILE-ID,
  4313           DFHEIV99,
  4314           DFHEIV99,
  4315           DFHEIV99,
  4316           DFHEIV99
  4317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4318
  4319
  4320 2120-DELETE-CONT.
  4321*    MOVE 'D'                    TO  JP-RECORD-TYPE.
  4322*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4323*    MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4324*
  4325*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4326
  4327     IF PI-SAV-ENDING-PYAJ-KEY = ERPYAJ-KEY
  4328         MOVE ZEROS              TO  PI-FRST-FILE-SEQ-NO
  4329         MOVE SPACE              TO  PI-FRST-RECORD-TYPE
  4330         MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4331                                     PI-SAV-ACCT-NET
  4332                                     PI-SAV-PREV-AMT
  4333                                     PI-SAV-PREV-NET.
  4334
  4335
  4336* EXEC CICS DELETE
  4337*        DATASET(PYAJ-FILE-ID)
  4338*    END-EXEC.
  4339*    MOVE '&(                    &   #00004073' TO DFHEIV0
  4340     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4341     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4342     MOVE X'2020233030303034303733' TO DFHEIV0(25:11)
  4343     CALL 'kxdfhei1' USING DFHEIV0,
  4344           PYAJ-FILE-ID,
  4345           DFHEIV99,
  4346           DFHEIV99,
  4347           DFHEIV99,
  4348           DFHEIV99
  4349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4350
  4351
  4352     GO TO 2100-UPDATE-LOOP.
  4353
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  87
* EL633.cbl
  4355
  4356 2190-CHANGE-RECORD-TYPE.
  4357
  4358*    MOVE 'D'                   TO  JP-RECORD-TYPE.
  4359*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4360*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4361*
  4362*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4363
  4364
  4365* EXEC CICS DELETE
  4366*        DATASET(PYAJ-FILE-ID)
  4367*    END-EXEC.
  4368*    MOVE '&(                    &   #00004089' TO DFHEIV0
  4369     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4370     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4371     MOVE X'2020233030303034303839' TO DFHEIV0(25:11)
  4372     CALL 'kxdfhei1' USING DFHEIV0,
  4373           PYAJ-FILE-ID,
  4374           DFHEIV99,
  4375           DFHEIV99,
  4376           DFHEIV99,
  4377           DFHEIV99
  4378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4379
  4380
  4381
  4382* EXEC CICS GETMAIN
  4383*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4384*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  4385*        INITIMG  (GETMAIN-SPACE)
  4386*    END-EXEC.
  4387*    MOVE ',"IL                  $   #00004093' TO DFHEIV0
  4388     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4389     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4390     MOVE X'2020233030303034303933' TO DFHEIV0(25:11)
  4391     CALL 'kxdfhei1' USING DFHEIV0,
  4392           DFHEIV20,
  4393           ERPYAJ-RECORD-LENGTH,
  4394           GETMAIN-SPACE
  4395     SET ADDRESS OF PENDING-PAY-ADJ TO
  4396         DFHEIV20
  4397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4398
  4399
  4400*    MOVE JP-RECORD-AREA        TO  PENDING-PAY-ADJ.
  4401*    MOVE ERPYAJ-KEY            TO  PY-CONTROL-PRIMARY.
  4402
  4403     MOVE WS-SAVE-ERPYAJ        TO  PENDING-PAY-ADJ
  4404     MOVE RTYPE (PINDX)         TO  PY-RECORD-TYPE
  4405                                    PYAJ-RECORD-TYPE.
  4406
  4407
  4408* EXEC CICS HANDLE CONDITION
  4409*        DUPREC (2190-DUP-RECORD)
  4410*    END-EXEC.
  4411*    MOVE '"$%                   ! '' #00004106' TO DFHEIV0
  4412     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  88
* EL633.cbl
  4413     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4414     MOVE X'2720233030303034313036' TO DFHEIV0(25:11)
  4415     CALL 'kxdfhei1' USING DFHEIV0
  4416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4417
  4418
  4419*    MOVE 'A'                   TO  JP-RECORD-TYPE.
  4420*    MOVE PYAJ-FILE-ID          TO  JP-FILE-ID.
  4421*    MOVE PENDING-PAY-ADJ       TO  JP-RECORD-AREA.
  4422
  4423 2190-RETRY-WRITE.
  4424
  4425
  4426* EXEC CICS WRITE
  4427*        DATASET  (PYAJ-FILE-ID)
  4428*        FROM     (PENDING-PAY-ADJ)
  4429*        RIDFLD   (PY-CONTROL-PRIMARY)
  4430*    END-EXEC.
  4431     MOVE LENGTH OF
  4432      PENDING-PAY-ADJ
  4433       TO DFHEIV11
  4434*    MOVE '&$ L                  ''   #00004116' TO DFHEIV0
  4435     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4436     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4437     MOVE X'2020233030303034313136' TO DFHEIV0(25:11)
  4438     CALL 'kxdfhei1' USING DFHEIV0,
  4439           PYAJ-FILE-ID,
  4440           PENDING-PAY-ADJ,
  4441           DFHEIV11,
  4442           PY-CONTROL-PRIMARY,
  4443           DFHEIV99,
  4444           DFHEIV99
  4445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4446
  4447
  4448*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4449
  4450
  4451* EXEC CICS READ
  4452*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4453*        DATASET  (PYAJ-FILE-ID)
  4454*        RIDFLD   (ERPYAJ-KEY)
  4455*        UPDATE
  4456*    END-EXEC.
  4457*    MOVE '&"S        EU         (   #00004124' TO DFHEIV0
  4458     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4459     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4460     MOVE X'2020233030303034313234' TO DFHEIV0(25:11)
  4461     CALL 'kxdfhei1' USING DFHEIV0,
  4462           PYAJ-FILE-ID,
  4463           DFHEIV20,
  4464           DFHEIV99,
  4465           ERPYAJ-KEY,
  4466           DFHEIV99,
  4467           DFHEIV99,
  4468           DFHEIV99
  4469     SET ADDRESS OF PENDING-PAY-ADJ TO
  4470         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  89
* EL633.cbl
  4471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4472
  4473
  4474     GO TO 2190-EXIT.
  4475
  4476 2190-DUP-RECORD.
  4477
  4478     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4479
  4480     GO TO 2190-RETRY-WRITE.
  4481
  4482 2190-EXIT.
  4483     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  90
* EL633.cbl
  4485
  4486 2200-UPDATE-COMPLETE.
  4487     IF EIBAID = DFHPF1
  4488         GO TO 4000-BROWSE-FRWD.
  4489
  4490     IF EIBAID = DFHPF2
  4491         GO TO 4100-BROWSE-BKWD.
  4492
  4493     MOVE LOW-VALUES             TO  EL633AI.
  4494
  4495     MOVE ER-0000                TO  EMI-ERROR.
  4496     MOVE -1                     TO  MAINTL.
  4497
  4498     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4499
  4500     MOVE PI-FRST-FILE-SEQ-NO    TO  PI-SAV-FILE-SEQ-NO.
  4501     MOVE PI-FRST-RECORD-TYPE    TO  PI-SAV-RECORD-TYPE.
  4502
  4503*    GO TO 4000-BROWSE-FRWD.
  4504
  4505*    GO TO 8100-SEND-INITIAL-MAP.
  4506
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  91
* EL633.cbl
  4508 4000-BROWSE-FRWD.
  4509     MOVE '1'                     TO  PI-PREV-PFKEY.
  4510     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4511
  4512     IF EIBAID = DFHPF1
  4513         IF PAGE-FULL
  4514             MOVE PI-FILE-SEQ-NO (PI-FULL-INDX)
  4515                                      TO  PYAJ-FILE-SEQ-NO
  4516             MOVE HIGH-VALUES         TO  PYAJ-RECORD-TYPE
  4517             MOVE 'N'                 TO  PYAJ-READ-SW
  4518             MOVE PI-SAV-ACCT-AMT     TO  TOTAL-ACCT-AMT
  4519             MOVE PI-SAV-ACCT-NET     TO  TOTAL-ACCT-NET
  4520             MOVE PI-SAV-ACCT-AMT     TO  PI-SAV-PREV-AMT
  4521             MOVE PI-SAV-ACCT-NET     TO  PI-SAV-PREV-NET
  4522         ELSE
  4523             MOVE ZEROS               TO  PI-SAV-ACCT-AMT
  4524                                          PI-SAV-ACCT-NET
  4525                                          PI-SAV-PREV-AMT
  4526                                          PI-SAV-PREV-NET
  4527             MOVE 'Y'                 TO  PI-PAGE-SW
  4528             IF NOT END-OF-FILE
  4529                 MOVE 99999999        TO  PYAJ-FILE-SEQ-NO
  4530                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4531             END-IF
  4532             IF TOP-OF-FILE
  4533                 MOVE SPACES          TO  PI-PYAJ-FILE-SW
  4534                 MOVE ZEROS           TO  PYAJ-FILE-SEQ-NO
  4535                 MOVE SPACES          TO  PYAJ-RECORD-TYPE
  4536             ELSE
  4537                 MOVE -1              TO  PYAJ-FILE-SEQ-NO
  4538                 MOVE HIGH-VALUES     TO  PYAJ-RECORD-TYPE
  4539     ELSE
  4540         MOVE PI-SAV-PREV-AMT         TO  TOTAL-ACCT-AMT
  4541         MOVE PI-SAV-PREV-NET         TO  TOTAL-ACCT-NET
  4542         IF MAINTI = 'S'
  4543             MOVE ZEROS               TO  PYAJ-FILE-SEQ-NO
  4544             MOVE SPACES              TO  PYAJ-RECORD-TYPE.
  4545
  4546
  4547     MOVE SPACE                  TO  PI-PYAJ-FILE-SW.
  4548
  4549     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4550         MOVE PI-CARRIER-SECURITY  TO  PYAJ-CARRIER.
  4551
  4552 4000-BROWSE-FRWD-FOR-PREV.
  4553*    IF END-OF-FILE
  4554*        IF EIBAID = DFHPF1
  4555*           IF PI-TOTAL-DISPLAYED
  4556*              NEXT SENTENCE
  4557*           ELSE
  4558*              MOVE -1                 TO  MAINTL
  4559*              MOVE ER-2237            TO  EMI-ERROR
  4560*              PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4561*              MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4562*              SET PINDX               TO  +2
  4563*              MOVE 'TOTAL'            TO  COMM (PINDX)
  4564*              MOVE PI-SAV-ACCT-AMT    TO  AMTO (PINDX)
  4565*              SET PINDEX UP BY 1
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  92
* EL633.cbl
  4566*              MOVE 'NET TOTAL'        TO  COMM (PINDX)
  4567*              MOVE PI-SAV-ACCT-NET    TO  AMTO (PINDX)
  4568*              MOVE ZEROS              TO  PI-SAV-ACCT-AMT
  4569*                                          PI-SAV-ACCT-NET
  4570*              GO TO 8100-SEND-INITIAL-MAP.
  4571*
  4572*     IF END-OF-FILE
  4573*        IF EIBAID = DFHPF1
  4574*           MOVE -1             TO  MAINTL
  4575*           MOVE ER-2237        TO  EMI-ERROR
  4576*           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4577*           GO TO 8200-SEND-DATAONLY.
  4578*
  4579     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4580
  4581     IF NO-RECORDS
  4582        MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4583        MOVE LOW-VALUES         TO  EL633AO
  4584        MOVE ER-2239            TO  EMI-ERROR
  4585        MOVE -1                 TO  MAINTL
  4586        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4587        GO TO 8100-SEND-INITIAL-MAP.
  4588
  4589     IF NOT-OPEN
  4590         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4591
  4592     MOVE LOW-VALUES             TO  EL633AO.
  4593     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4594
  4595     PERFORM 6000-READ-AND-FORMAT-SCREEN  THRU  6200-EXIT
  4596          VARYING  PINDX  FROM  1  BY  1
  4597             UNTIL  END-OF-ACCT
  4598                 OR  END-OF-FILE
  4599                     OR  PAGE-FULL
  4600                         OR  NO-RECORDS.
  4601
  4602     IF NO-RECORDS
  4603         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  4604         MOVE LOW-VALUES         TO  EL633AO
  4605         MOVE ER-2239            TO  EMI-ERROR
  4606         MOVE -1                 TO  MAINTL
  4607         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4608         GO TO 8100-SEND-INITIAL-MAP.
  4609
  4610     IF END-OF-FILE
  4611         IF EIBAID = DFHPF2
  4612             MOVE ER-2238        TO  EMI-ERROR
  4613             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4614             MOVE 'T'            TO  PI-PYAJ-FILE-SW
  4615         ELSE
  4616             MOVE ER-2237        TO  EMI-ERROR
  4617             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4618
  4619     MOVE 'S'                    TO  PI-PREV-FUNCTION
  4620                                     PI-SAV-FUNCTION.
  4621
  4622     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  93
* EL633.cbl
  4624 4100-BROWSE-BKWD.
  4625     MOVE SPACE                   TO  PI-PYAJ-FILE-SW
  4626                                      PI-TOTAL-DISPLAYED-SW.
  4627     MOVE PI-SAV-ENDING-PYAJ-KEY  TO  ERPYAJ-KEY.
  4628     MOVE ZEROS                   TO  PYAJ-FILE-SEQ-NO.
  4629     MOVE ZEROS                   TO  PYAJ-RECORD-TYPE.
  4630     MOVE ZEROS                   TO  PI-SAV-ACCT-AMT
  4631                                      PI-SAV-ACCT-NET
  4632                                      PI-SAV-PREV-AMT
  4633                                      PI-SAV-PREV-NET.
  4634
  4635     PERFORM 5000-START-BROWSE  THRU  5030-EXIT.
  4636
  4637     IF NO-RECORDS
  4638         MOVE SPACES             TO  PI-PYAJ-FILE-SW
  4639         MOVE LOW-VALUES         TO  EL633AO
  4640         MOVE ER-2239            TO  EMI-ERROR
  4641         MOVE -1                 TO  MAINTL
  4642         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4643         GO TO 8100-SEND-INITIAL-MAP.
  4644
  4645     IF NOT-OPEN
  4646         GO TO 7000-PYAJ-FILE-NOTOPEN.
  4647
  4648
  4649* EXEC CICS READNEXT
  4650*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4651*        DATASET  (PYAJ-FILE-ID)
  4652*        RIDFLD   (ERPYAJ-KEY)
  4653*    END-EXEC.
  4654     MOVE 0
  4655       TO DFHEIV11
  4656*    MOVE '&.S                   )   #00004305' TO DFHEIV0
  4657     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4658     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4659     MOVE X'2020233030303034333035' TO DFHEIV0(25:11)
  4660     CALL 'kxdfhei1' USING DFHEIV0,
  4661           PYAJ-FILE-ID,
  4662           DFHEIV20,
  4663           DFHEIV99,
  4664           ERPYAJ-KEY,
  4665           DFHEIV99,
  4666           DFHEIV11,
  4667           DFHEIV99,
  4668           DFHEIV99
  4669     SET ADDRESS OF PENDING-PAY-ADJ TO
  4670         DFHEIV20
  4671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4672
  4673
  4674     IF FIRST-PAGE OR
  4675        PI-PREV-PFKEY = '2'
  4676         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT
  4677         PERFORM 5100-READ-PREVIOUS  THRU  5120-EXIT.
  4678
  4679     PERFORM 5200-END-BROWSE  THRU  5200-EXIT.
  4680
  4681     MOVE ZEROS                  TO  PYAJ-FILE-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  94
* EL633.cbl
  4682     MOVE SPACES                 TO  PYAJ-RECORD-TYPE.
  4683     MOVE '2'                     TO  PI-PREV-PFKEY.
  4684
  4685     GO TO 4000-BROWSE-FRWD-FOR-PREV.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  95
* EL633.cbl
  4687 5000-START-BROWSE.
  4688
  4689* EXEC CICS HANDLE CONDITION
  4690*        NOTOPEN  (5010-NOT-OPEN)
  4691*        NOTFND   (5020-NO-RECORDS)
  4692*        ENDFILE  (5020-NO-RECORDS)
  4693*    END-EXEC.
  4694*    MOVE '"$JI''                 ! ( #00004325' TO DFHEIV0
  4695     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  4696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4697     MOVE X'2820233030303034333235' TO DFHEIV0(25:11)
  4698     CALL 'kxdfhei1' USING DFHEIV0
  4699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4700
  4701
  4702
  4703* EXEC CICS STARTBR
  4704*        DATASET  (PYAJ-FILE-ID)
  4705*        RIDFLD   (ERPYAJ-KEY)
  4706*    END-EXEC.
  4707     MOVE 0
  4708       TO DFHEIV11
  4709*    MOVE '&,         G          &   #00004331' TO DFHEIV0
  4710     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4712     MOVE X'2020233030303034333331' TO DFHEIV0(25:11)
  4713     CALL 'kxdfhei1' USING DFHEIV0,
  4714           PYAJ-FILE-ID,
  4715           ERPYAJ-KEY,
  4716           DFHEIV99,
  4717           DFHEIV11,
  4718           DFHEIV99
  4719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4720
  4721
  4722     GO TO 5030-EXIT.
  4723
  4724 5010-NOT-OPEN.
  4725     MOVE 'Z'                    TO  PI-PYAJ-FILE-SW.
  4726
  4727     GO TO 5030-EXIT.
  4728
  4729 5020-NO-RECORDS.
  4730     MOVE ZEROS                  TO  PI-SEQ-NOS.
  4731     MOVE 'Y'                    TO  PI-PYAJ-FILE-SW.
  4732
  4733 5030-EXIT.
  4734     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  96
* EL633.cbl
  4736 5100-READ-PREVIOUS.
  4737
  4738* EXEC CICS HANDLE CONDITION
  4739*        ENDFILE  (5110-END-OF-FILE)
  4740*        NOTFND   (5110-END-OF-FILE)
  4741*    END-EXEC.
  4742*    MOVE '"$''I                  ! ) #00004351' TO DFHEIV0
  4743     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4745     MOVE X'2920233030303034333531' TO DFHEIV0(25:11)
  4746     CALL 'kxdfhei1' USING DFHEIV0
  4747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4748
  4749
  4750
  4751* EXEC CICS READPREV
  4752*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4753*        DATASET  (PYAJ-FILE-ID)
  4754*        RIDFLD   (ERPYAJ-KEY)
  4755*    END-EXEC.
  4756     MOVE 0
  4757       TO DFHEIV11
  4758*    MOVE '&0S                   )   #00004356' TO DFHEIV0
  4759     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4760     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4761     MOVE X'2020233030303034333536' TO DFHEIV0(25:11)
  4762     CALL 'kxdfhei1' USING DFHEIV0,
  4763           PYAJ-FILE-ID,
  4764           DFHEIV20,
  4765           DFHEIV99,
  4766           ERPYAJ-KEY,
  4767           DFHEIV99,
  4768           DFHEIV11,
  4769           DFHEIV99,
  4770           DFHEIV99
  4771     SET ADDRESS OF PENDING-PAY-ADJ TO
  4772         DFHEIV20
  4773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4774
  4775
  4776     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4777         IF PI-CARRIER-SECURITY = PY-CARRIER
  4778             NEXT SENTENCE
  4779         ELSE
  4780             GO TO 5110-END-OF-FILE.
  4781
  4782     GO TO 5120-EXIT.
  4783
  4784 5110-END-OF-FILE.
  4785     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  4786     MOVE ER-2238                TO  EMI-ERROR.
  4787     MOVE -1                     TO  PFENTERL.
  4788
  4789     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4790
  4791     GO TO 8200-SEND-DATAONLY.
  4792
  4793 5120-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  97
* EL633.cbl
  4794     EXIT.
  4795
  4796 5200-END-BROWSE.
  4797
  4798* EXEC CICS ENDBR
  4799*        DATASET  (PYAJ-FILE-ID)
  4800*    END-EXEC.
  4801     MOVE 0
  4802       TO DFHEIV11
  4803*    MOVE '&2                    $   #00004383' TO DFHEIV0
  4804     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4805     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4806     MOVE X'2020233030303034333833' TO DFHEIV0(25:11)
  4807     CALL 'kxdfhei1' USING DFHEIV0,
  4808           PYAJ-FILE-ID,
  4809           DFHEIV11,
  4810           DFHEIV99
  4811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4812
  4813
  4814 5200-EXIT.
  4815     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  98
* EL633.cbl
  4817 6000-READ-AND-FORMAT-SCREEN.
  4818
  4819* EXEC CICS HANDLE CONDITION
  4820*        ENDFILE  (6100-END-OF-FILE)
  4821*        NOTFND   (6100-END-OF-FILE)
  4822*    END-EXEC.
  4823*    MOVE '"$''I                  ! * #00004391' TO DFHEIV0
  4824     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  4825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4826     MOVE X'2A20233030303034333931' TO DFHEIV0(25:11)
  4827     CALL 'kxdfhei1' USING DFHEIV0
  4828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4829
  4830
  4831*    MOVE SPACES                 TO  PI-TOTAL-DISPLAYED-SW.
  4832*    INITIALIZE  PI-SEQ-NOS.
  4833
  4834 6010-READ-NEXT.
  4835
  4836
  4837* EXEC CICS READNEXT
  4838*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  4839*        DATASET  (PYAJ-FILE-ID)
  4840*        RIDFLD   (ERPYAJ-KEY)
  4841*    END-EXEC.
  4842     MOVE 0
  4843       TO DFHEIV11
  4844*    MOVE '&.S                   )   #00004401' TO DFHEIV0
  4845     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4846     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4847     MOVE X'2020233030303034343031' TO DFHEIV0(25:11)
  4848     CALL 'kxdfhei1' USING DFHEIV0,
  4849           PYAJ-FILE-ID,
  4850           DFHEIV20,
  4851           DFHEIV99,
  4852           ERPYAJ-KEY,
  4853           DFHEIV99,
  4854           DFHEIV11,
  4855           DFHEIV99,
  4856           DFHEIV99
  4857     SET ADDRESS OF PENDING-PAY-ADJ TO
  4858         DFHEIV20
  4859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4860
  4861
  4862     IF PI-COMPANY-CD NOT = PY-COMPANY-CD
  4863       AND PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4864         GO TO 6100-END-OF-FILE.
  4865
  4866     IF PI-CARRIER-SECURITY  IS GREATER THAN  SPACES
  4867         IF PY-CARRIER NOT = PI-CARRIER-SECURITY
  4868             IF PI-SAV-ENDING-PYAJ-KEY NOT = SPACES
  4869                 GO TO 6100-END-OF-FILE.
  4870
  4871     IF PYAJ-1ST-READ
  4872       AND EIBAID NOT = DFHENTER
  4873       AND NOT PAGE-FULL
  4874         MOVE PY-CONTROL-PRIMARY TO  PI-SAV-ENDING-PYAJ-KEY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page  99
* EL633.cbl
  4875         MOVE PY-CARRIER         TO  PI-CR-CARRIER
  4876         MOVE PY-GROUPING        TO  PI-CR-GROUPING
  4877         MOVE PY-FIN-RESP        TO  PI-CR-FIN-RESP
  4878         MOVE PY-ACCOUNT         TO  PI-CR-ACCOUNT.
  4879
  4880     IF PYAJ-1ST-READ
  4881         MOVE PI-SAV-ENDING-PYAJ-KEY
  4882                                 TO  PI-START-PYAJ-KEY.
  4883
  4884     IF PI-COMPANY-CD   = PY-COMPANY-CD  AND
  4885        PI-SAV-CARRIER  = PY-CARRIER     AND
  4886        PI-SAV-GROUPING = PY-GROUPING    AND
  4887        PI-SAV-FIN-RESP = PY-FIN-RESP    AND
  4888        PI-SAV-ACCOUNT  = PY-ACCOUNT
  4889         NEXT SENTENCE
  4890     ELSE
  4891         IF PYAJ-1ST-READ
  4892             MOVE 'Y'            TO  PI-PYAJ-FILE-SW
  4893             MOVE SPACE          TO  PYAJ-READ-SW
  4894             GO TO 6200-EXIT
  4895         ELSE
  4896             MOVE 'A'            TO  PI-PYAJ-FILE-SW
  4897             IF PINDX  IS LESS THAN  12
  4898                 SET PINDX  UP  BY  1
  4899                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4900                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4901                 SET PINDX  UP  BY  1
  4902                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4903                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4904                     GO TO 6200-EXIT
  4905             ELSE
  4906                 MOVE 'TOTAL'         TO  GL-ACCT (PINDX)
  4907                 MOVE TOTAL-ACCT-AMT  TO  AMTO (PINDX)
  4908                 SET PINDX  UP  BY  1
  4909                 MOVE 'NET TOTAL'     TO  GL-ACCT (PINDX)
  4910                 MOVE TOTAL-ACCT-NET  TO  AMTO (PINDX)
  4911                 GO TO 6200-EXIT.
  4912
  4913*    MOVE ' '                    TO  PI-PYAJ-FILE-SW.
  4914
  4915     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  4916         GO TO 6000-READ-AND-FORMAT-SCREEN.
  4917
  4918*    SET PINDX  UP  BY +1.
  4919
  4920     SET WS-SAVE-INDEX-VALUE  TO  PINDX.
  4921
  4922     IF PINDX  IS GREATER THAN  13
  4923         MOVE 'F'                TO  PI-PYAJ-FILE-SW
  4924         MOVE +13                TO  PI-FULL-INDX
  4925         MOVE PI-FRST-FILE-SEQ-NO
  4926                                 TO  PI-LAST-FILE-SEQ-NO
  4927         MOVE PI-FRST-RECORD-TYPE
  4928                                 TO  PI-LAST-RECORD-TYPE
  4929         MOVE TOTAL-ACCT-AMT     TO  PI-SAV-ACCT-AMT
  4930         MOVE TOTAL-ACCT-NET     TO  PI-SAV-ACCT-NET
  4931         GO TO 6200-EXIT.
  4932
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 100
* EL633.cbl
  4933     MOVE PY-FILE-SEQ-NO         TO  PI-PREV-FILE-SEQ-NO.
  4934     MOVE PY-RECORD-TYPE         TO  PI-PREV-RECORD-TYPE.
  4935
  4936     IF PYAJ-1ST-READ
  4937         MOVE SPACE              TO  PYAJ-READ-SW.
  4938
  4939     IF PINDX = 1
  4940         MOVE PI-PREV-FILE-SEQ-NO
  4941                                 TO  PI-FRST-FILE-SEQ-NO
  4942         MOVE PI-PREV-RECORD-TYPE
  4943                                 TO  PI-FRST-RECORD-TYPE
  4944         MOVE PI-PREV-FILE-SEQ-NO
  4945                                 TO  PI-LAST-FILE-SEQ-NO
  4946         MOVE PI-PREV-RECORD-TYPE
  4947                                 TO  PI-LAST-RECORD-TYPE.
  4948
  4949     SET NDX                     TO  PINDX.
  4950     SET WS-SAVE-NDX-VALUE       TO  NDX.
  4951
  4952     MOVE PY-FILE-SEQ-NO         TO  PI-FILE-SEQ-NO (NDX).
  4953
  4954     MOVE PY-GL-ACCOUNT          TO  GL-ACCT (PINDX).
  4955     MOVE PY-GL-STATE            TO  GL-STATE (PINDX).
  4956     MOVE PY-GL-CANC-SW          TO  GL-CANC (PINDX).
  4957     MOVE PY-GL-COMMENT          TO  GL-COMM (PINDX).
  4958     MOVE PY-ENTRY-AMT           TO  AMTO (PINDX).
  4959
  4960     ADD PY-ENTRY-AMT            TO  TOTAL-ACCT-AMT.
  4961
  4962     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'S' OR 'Z'
  4963         ADD PY-ENTRY-AMT        TO  TOTAL-ACCT-NET
  4964     ELSE
  4965         SUBTRACT PY-ENTRY-AMT  FROM  TOTAL-ACCT-NET.
  4966
  4967     MOVE PY-RECORD-TYPE         TO  RTYPE (PINDX)
  4968                                     PI-REC-TYPE (NDX).
  4969
  4970     IF PY-VOID-SW NOT = SPACE
  4971         MOVE PY-VOID-SW         TO  VOID-SW (PINDX).
  4972
  4973     IF PY-LAST-MAINT-DT = PREV-BIN-MAINT-DT
  4974         MOVE PREV-MAINT-DT      TO  MDTE (PINDX)
  4975     ELSE
  4976         MOVE PY-LAST-MAINT-DT   TO  DC-BIN-DATE-1
  4977                                     PREV-BIN-MAINT-DT
  4978         MOVE SPACE              TO  DC-OPTION-CODE
  4979         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  4980* DAN    MOVE DC-GREG-DATE-1-EDIT
  4981         MOVE DC-GREG-DATE-1-MDY
  4982                                 TO  MDTE (PINDX)
  4983                                     PREV-MAINT-DT.
  4984
  4985*    IF PY-GL-COMMENT NOT = (LOW-VALUES OR SPACES OR ZEROS)
  4986     IF PY-GL-COMMENT NOT = (LOW-VALUES AND SPACES AND ZEROS)
  4987         INSPECT PY-GL-COMMENT CONVERTING LOW-VALUES TO SPACES
  4988         MOVE PY-GL-COMMENT      TO  GL-COMM (PINDX)
  4989*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
  4990*        MOVE AL-UANON           TO  GL-COMM-ATTRB (PINDX)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 101
* EL633.cbl
  4991     END-IF.
  4992
  4993     IF PY-BILLED-DATE NOT = LOW-VALUES
  4994         MOVE AL-SANOF           TO  GL-ACCT-ATTRB (PINDX)
  4995                                     AMT-ATTRB (PINDX)
  4996                                     VOID-SW-ATTRB (PINDX)
  4997         IF PY-BILLED-DATE = PREV-BIN-BL-DT
  4998             MOVE PREV-BL-DT     TO  BDTE (PINDX)
  4999         ELSE
  5000             MOVE PY-BILLED-DATE TO  DC-BIN-DATE-1
  5001                                     PREV-BIN-BL-DT
  5002             MOVE SPACE          TO  DC-OPTION-CODE
  5003             PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5004* DAN        MOVE DC-GREG-DATE-1-EDIT
  5005             MOVE DC-GREG-DATE-1-MDY
  5006                                 TO  BDTE (PINDX)
  5007                                     PREV-BL-DT.
  5008
  5009     IF (PY-CHECK-ORIGIN-SW = LOW-VALUES OR SPACES OR 'G')
  5010         NEXT SENTENCE
  5011     ELSE
  5012         MOVE AL-SANOF           TO  RTYPE-ATTRB   (PINDX)
  5013                                     AMT-ATTRB     (PINDX).
  5014
  5015     IF PY-CREDIT-SELECT-DT NOT = LOW-VALUES
  5016         MOVE PY-CREDIT-SELECT-DT
  5017                                 TO  DC-BIN-DATE-1
  5018         MOVE SPACE              TO  DC-OPTION-CODE
  5019         PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  5020
  5021         MOVE DC-GREG-DATE-1-EDIT  TO  WS-GREG-STORE
  5022         MOVE WS-GS-MM             TO  WS-SS-MM
  5023         MOVE WS-GS-DD             TO  WS-SS-DD
  5024         MOVE WS-GS-YY             TO  WS-SS-YY
  5025         MOVE WS-SDTE-STORE        TO  SDTE (PINDX).
  5026     IF (PY-INPUT-DT NOT = WS-CURRENT-BIN-DT)
  5027        AND (PI-PROCESSOR-ID NOT = 'PEMA')
  5028         MOVE AL-SANOF           TO RTYPE-ATTRB    (PINDX)
  5029                                    AMT-ATTRB      (PINDX)
  5030                                    GL-ACCT-ATTRB  (PINDX)
  5031                                    GL-COMM-ATTRB  (PINDX)
  5032                                    VOID-SW-ATTRB  (PINDX)
  5033                                    GL-STATE-ATTRB (PINDX)
  5034                                    GL-CANC-ATTRB  (PINDX)
  5035                                    SDTE-ATTRB     (PINDX)
  5036
  5037     END-IF
  5038
  5039*    GO TO 6010-READ-NEXT.
  5040     GO TO 6200-EXIT.
  5041
  5042 6100-END-OF-FILE.
  5043     MOVE 'X'                    TO  PI-PYAJ-FILE-SW.
  5044
  5045     IF PINDX  IS LESS THAN  12
  5046         SET PINDX  UP  BY  1
  5047         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5048         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 102
* EL633.cbl
  5049         SET PINDX  UP  BY  1
  5050         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5051         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX)
  5052         MOVE 'Y'                TO  PI-TOTAL-DISPLAYED-SW
  5053     ELSE
  5054         MOVE 'TOTAL'            TO  GL-ACCT (PINDX)
  5055         MOVE TOTAL-ACCT-AMT     TO  AMTO (PINDX)
  5056         SET PINDX  UP  BY  1
  5057         MOVE 'NET TOTAL'        TO  GL-ACCT (PINDX)
  5058         MOVE TOTAL-ACCT-NET     TO  AMTO (PINDX).
  5059
  5060 6200-EXIT.
  5061     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 103
* EL633.cbl
  5063 7000-PYAJ-FILE-NOTOPEN.
  5064     MOVE -1                     TO  MAINTL.
  5065     MOVE ER-2232                TO  EMI-ERROR.
  5066
  5067     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5068
  5069     GO TO 8200-SEND-DATAONLY.
  5070
  5071 7100-COMP-FILE-NOTOPEN.
  5072     MOVE -1                     TO  MAINTL.
  5073     MOVE ER-2233                TO  EMI-ERROR.
  5074
  5075     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5076
  5077     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 104
* EL633.cbl
  5079*
  5080*7100-COFA-FILE-NOTOPEN.
  5081*    MOVE -1                     TO PFENTERL.
  5082*    MOVE ER-2959                TO EMI-ERROR.
  5083*    PERFORM 9900-ERROR-FORMAT THRU
  5084*            9900-EXIT.
  5085*    GO TO 8200-SEND-DATAONLY.
  5086*
  5087 8100-SEND-INITIAL-MAP.
  5088     MOVE WS-CURRENT-DT          TO  DATEO.
  5089     MOVE EIBTIME                TO  TIME-IN.
  5090     MOVE TIME-OUT               TO  TIMEO.
  5091     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5092     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5093     MOVE -1                     TO  MAINTL.
  5094     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5095     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5096
  5097     IF EIBTRNID = TRANS-ID
  5098       OR EL640-TRANS-ID
  5099       OR EL642-TRANS-ID
  5100       OR EL652-TRANS-ID
  5101       OR EL6331-TRANS-ID
  5102         IF PI-SAV-ENDING-PYAJ-KEY NOT =  SPACES
  5103             MOVE PI-SAV-FUNCTION  TO  MAINTI
  5104             MOVE PI-SAV-CARRIER   TO  CARRIERO
  5105             MOVE PI-SAV-GROUPING  TO  GROUPO
  5106             MOVE PI-SAV-FIN-RESP  TO  FINRESPO
  5107             MOVE PI-SAV-ACCOUNT   TO  ACCTO
  5108             MOVE AL-UANON         TO  MAINTA
  5109                                       CARRIERA
  5110                                       GROUPA
  5111                                       FINRESPA
  5112                                       ACCTA
  5113         ELSE
  5114             NEXT SENTENCE.
  5115
  5116
  5117* EXEC CICS SEND
  5118*        MAP     (MAP-NAME)
  5119*        MAPSET  (MAPSET-NAME)
  5120*        FROM    (EL633AO)
  5121*        ERASE
  5122*        CURSOR
  5123*        END-EXEC.
  5124     MOVE LENGTH OF
  5125      EL633AO
  5126       TO DFHEIV12
  5127     MOVE -1
  5128       TO DFHEIV11
  5129*    MOVE '8$     CT  E    H L F ,   #00004661' TO DFHEIV0
  5130     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5131     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5132     MOVE X'2020233030303034363631' TO DFHEIV0(25:11)
  5133     CALL 'kxdfhei1' USING DFHEIV0,
  5134           MAP-NAME,
  5135           EL633AO,
  5136           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 105
* EL633.cbl
  5137           MAPSET-NAME,
  5138           DFHEIV99,
  5139           DFHEIV99,
  5140           DFHEIV99,
  5141           DFHEIV11,
  5142           DFHEIV99,
  5143           DFHEIV99,
  5144           DFHEIV99
  5145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5146
  5147
  5148     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 106
* EL633.cbl
  5150 8200-SEND-DATAONLY.
  5151     MOVE WS-CURRENT-DT          TO  DATEO.
  5152     MOVE EIBTIME                TO  TIME-IN.
  5153     MOVE TIME-OUT               TO  TIMEO.
  5154     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  5155     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  5156     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  5157     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  5158
  5159
  5160* EXEC CICS SEND
  5161*        MAP     (MAP-NAME)
  5162*        MAPSET  (MAPSET-NAME)
  5163*        FROM    (EL633AO)
  5164*        DATAONLY
  5165*        CURSOR
  5166*    END-EXEC.
  5167     MOVE LENGTH OF
  5168      EL633AO
  5169       TO DFHEIV12
  5170     MOVE -1
  5171       TO DFHEIV11
  5172*    MOVE '8$D    CT       H L F ,   #00004680' TO DFHEIV0
  5173     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5174     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5175     MOVE X'2020233030303034363830' TO DFHEIV0(25:11)
  5176     CALL 'kxdfhei1' USING DFHEIV0,
  5177           MAP-NAME,
  5178           EL633AO,
  5179           DFHEIV12,
  5180           MAPSET-NAME,
  5181           DFHEIV99,
  5182           DFHEIV99,
  5183           DFHEIV99,
  5184           DFHEIV11,
  5185           DFHEIV99,
  5186           DFHEIV99,
  5187           DFHEIV99
  5188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5189
  5190
  5191     GO TO 9100-RETURN-TRAN.
  5192
  5193 8300-SEND-TEXT.
  5194
  5195* EXEC CICS SEND TEXT
  5196*        FROM    (LOGOFF-TEXT)
  5197*        LENGTH  (LOGOFF-LENGTH)
  5198*        ERASE
  5199*        FREEKB
  5200*    END-EXEC.
  5201*    MOVE '8&      T  E F  H   F -   #00004691' TO DFHEIV0
  5202     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5203     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5204     MOVE X'2020233030303034363931' TO DFHEIV0(25:11)
  5205     CALL 'kxdfhei1' USING DFHEIV0,
  5206           LOGOFF-TEXT,
  5207           LOGOFF-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 107
* EL633.cbl
  5208           DFHEIV99,
  5209           DFHEIV99,
  5210           DFHEIV99,
  5211           DFHEIV99,
  5212           DFHEIV99,
  5213           DFHEIV99,
  5214           DFHEIV99,
  5215           DFHEIV99,
  5216           DFHEIV99,
  5217           DFHEIV99
  5218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5219
  5220
  5221
  5222* EXEC CICS RETURN
  5223*    END-EXEC.
  5224*    MOVE '.(                    &   #00004698' TO DFHEIV0
  5225     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5226     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5227     MOVE X'2020233030303034363938' TO DFHEIV0(25:11)
  5228     CALL 'kxdfhei1' USING DFHEIV0,
  5229           DFHEIV99,
  5230           DFHEIV99,
  5231           DFHEIV99,
  5232           DFHEIV99,
  5233           DFHEIV99
  5234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5235
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 108
* EL633.cbl
  5237 8400-LOG-JOURNAL-RECORD.
  5238*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5239*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5240
  5241*    EXEC CICS JOURNAL
  5242*        JFILEID  (PI-JOURNAL-FILE-ID)
  5243*        JTYPEID  ('EL')
  5244*        FROM     (JOURNAL-RECORD)
  5245*        LENGTH   (223)
  5246*        END-EXEC.
  5247
  5248 8500-DATE-CONVERT.
  5249
  5250* EXEC CICS LINK
  5251*        PROGRAM   (LINK-CLDATCV)
  5252*        COMMAREA  (DATE-CONVERSION-DATA)
  5253*        LENGTH    (DC-COMM-LENGTH)
  5254*    END-EXEC.
  5255*    MOVE '."C                   ''   #00004713' TO DFHEIV0
  5256     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5257     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5258     MOVE X'2020233030303034373133' TO DFHEIV0(25:11)
  5259     CALL 'kxdfhei1' USING DFHEIV0,
  5260           LINK-CLDATCV,
  5261           DATE-CONVERSION-DATA,
  5262           DC-COMM-LENGTH,
  5263           DFHEIV99,
  5264           DFHEIV99,
  5265           DFHEIV99
  5266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5267
  5268
  5269 8500-EXIT.
  5270     EXIT.
  5271
  5272 8600-DEEDIT.
  5273
  5274* EXEC CICS BIF DEEDIT
  5275*        FIELD   (DEEDIT-FIELD)
  5276*        LENGTH  (11)
  5277*    END-EXEC.
  5278     MOVE 11
  5279       TO DFHEIV11
  5280*    MOVE '@"L                   #   #00004723' TO DFHEIV0
  5281     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5282     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5283     MOVE X'2020233030303034373233' TO DFHEIV0(25:11)
  5284     CALL 'kxdfhei1' USING DFHEIV0,
  5285           DEEDIT-FIELD,
  5286           DFHEIV11
  5287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5288
  5289
  5290 8600-EXIT.
  5291     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 109
* EL633.cbl
  5293 8800-UNAUTHORIZED-ACCESS.
  5294     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  5295
  5296     GO TO 8300-SEND-TEXT.
  5297
  5298 8810-PF23.
  5299     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5300     MOVE XCTL-005               TO  PGM-NAME.
  5301
  5302     GO TO 9300-XCTL.
  5303
  5304 9100-RETURN-TRAN.
  5305     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5306     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5307
  5308
  5309* EXEC CICS RETURN
  5310*        TRANSID   (TRANS-ID)
  5311*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5312*        LENGTH    (PI-COMM-LENGTH)
  5313*    END-EXEC.
  5314*    MOVE '.(CT                  &   #00004746' TO DFHEIV0
  5315     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5316     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5317     MOVE X'2020233030303034373436' TO DFHEIV0(25:11)
  5318     CALL 'kxdfhei1' USING DFHEIV0,
  5319           TRANS-ID,
  5320           PROGRAM-INTERFACE-BLOCK,
  5321           PI-COMM-LENGTH,
  5322           DFHEIV99,
  5323           DFHEIV99
  5324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5325
  5326
  5327 9200-RETURN-MAIN-MENU.
  5328     MOVE XCTL-626               TO  PGM-NAME.
  5329
  5330     GO TO 9300-XCTL.
  5331
  5332 9300-XCTL.
  5333
  5334* EXEC CICS XCTL
  5335*        PROGRAM   (PGM-NAME)
  5336*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  5337*        LENGTH    (PI-COMM-LENGTH)
  5338*    END-EXEC.
  5339*    MOVE '.$C                   $   #00004758' TO DFHEIV0
  5340     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5341     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5342     MOVE X'2020233030303034373538' TO DFHEIV0(25:11)
  5343     CALL 'kxdfhei1' USING DFHEIV0,
  5344           PGM-NAME,
  5345           PROGRAM-INTERFACE-BLOCK,
  5346           PI-COMM-LENGTH
  5347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5348
  5349
  5350 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 110
* EL633.cbl
  5351     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  5352
  5353     IF PI-RETURN-TO-PROGRAM = 'EL626'
  5354     MOVE SPACES                 TO  PI-CR-CONTROL-IN-PROGRESS
  5355                                     PI-SAV-COMP-CONTROL.
  5356
  5357     GO TO 9300-XCTL.
  5358
  5359 9500-PF12.
  5360     MOVE XCTL-010               TO  PGM-NAME.
  5361
  5362     GO TO 9300-XCTL.
  5363
  5364 9600-PGMID-ERROR.
  5365
  5366* EXEC CICS HANDLE CONDITION
  5367*        PGMIDERR  (8300-SEND-TEXT)
  5368*    END-EXEC.
  5369*    MOVE '"$L                   ! + #00004779' TO DFHEIV0
  5370     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5371     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5372     MOVE X'2B20233030303034373739' TO DFHEIV0(25:11)
  5373     CALL 'kxdfhei1' USING DFHEIV0
  5374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5375
  5376
  5377     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  5378     MOVE ' '                    TO  PI-ENTRY-CD-1.
  5379     MOVE XCTL-005               TO  PGM-NAME.
  5380     MOVE PGM-NAME               TO  LOGOFF-PGM.
  5381     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5382
  5383     GO TO 9300-XCTL.
  5384
  5385 9900-ERROR-FORMAT.
  5386     IF NOT EMI-ERRORS-COMPLETE
  5387         MOVE LINK-001           TO  PGM-NAME
  5388
  5389* EXEC CICS LINK
  5390*            PROGRAM   (PGM-NAME)
  5391*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  5392*            LENGTH    (EMI-COMM-LENGTH)
  5393*        END-EXEC.
  5394*    MOVE '."C                   ''   #00004794' TO DFHEIV0
  5395     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5396     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5397     MOVE X'2020233030303034373934' TO DFHEIV0(25:11)
  5398     CALL 'kxdfhei1' USING DFHEIV0,
  5399           PGM-NAME,
  5400           ERROR-MESSAGE-INTERFACE-BLOCK,
  5401           EMI-COMM-LENGTH,
  5402           DFHEIV99,
  5403           DFHEIV99,
  5404           DFHEIV99
  5405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5406
  5407
  5408 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 111
* EL633.cbl
  5409     EXIT.
  5410
  5411 9990-ABEND.
  5412     MOVE LINK-004               TO  PGM-NAME.
  5413     MOVE DFHEIBLK               TO  EMI-LINE1.
  5414
  5415
  5416* EXEC CICS LINK
  5417*        PROGRAM   (PGM-NAME)
  5418*        COMMAREA  (EMI-LINE1)
  5419*        LENGTH    (72)
  5420*    END-EXEC.
  5421     MOVE 72
  5422       TO DFHEIV11
  5423*    MOVE '."C                   ''   #00004807' TO DFHEIV0
  5424     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5425     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5426     MOVE X'2020233030303034383037' TO DFHEIV0(25:11)
  5427     CALL 'kxdfhei1' USING DFHEIV0,
  5428           PGM-NAME,
  5429           EMI-LINE1,
  5430           DFHEIV11,
  5431           DFHEIV99,
  5432           DFHEIV99,
  5433           DFHEIV99
  5434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5435
  5436
  5437     MOVE -1                     TO  PFENTERL.
  5438
  5439     GO TO 8200-SEND-DATAONLY.
  5440
  5441 9995-SECURITY-VIOLATION.
  5442*                            COPY ELCSCTP.
  5443******************************************************************
  5444*                                                                *
  5445*                            ELCSCTP                             *
  5446*                            VMOD=2.001                          *
  5447*                                                                *
  5448*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5449******************************************************************
  5450
  5451
  5452     MOVE EIBDATE          TO SM-JUL-DATE.
  5453     MOVE EIBTRMID         TO SM-TERMID.
  5454     MOVE THIS-PGM         TO SM-PGM.
  5455     MOVE EIBTIME          TO TIME-IN.
  5456     MOVE TIME-OUT         TO SM-TIME.
  5457     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5458
  5459
  5460* EXEC CICS LINK
  5461*         PROGRAM  ('EL003')
  5462*         COMMAREA (SECURITY-MESSAGE)
  5463*         LENGTH   (80)
  5464*    END-EXEC.
  5465     MOVE 'EL003' TO DFHEIV1
  5466     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 112
* EL633.cbl
  5467       TO DFHEIV11
  5468*    MOVE '."C                   ''   #00004835' TO DFHEIV0
  5469     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5470     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5471     MOVE X'2020233030303034383335' TO DFHEIV0(25:11)
  5472     CALL 'kxdfhei1' USING DFHEIV0,
  5473           DFHEIV1,
  5474           SECURITY-MESSAGE,
  5475           DFHEIV11,
  5476           DFHEIV99,
  5477           DFHEIV99,
  5478           DFHEIV99
  5479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5480
  5481
  5482******************************************************************
  5483
  5484
  5485 9995-EXIT.
  5486     EXIT.
  5487
  5488
  5489 9999-DFHBACK SECTION.
  5490     MOVE '9%                    "   ' TO DFHEIV0
  5491     MOVE 'EL633' TO DFHEIV1
  5492     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5493     GOBACK.
  5494 9999-DFHEXIT.
  5495     IF DFHEIGDJ EQUAL 0001
  5496         NEXT SENTENCE
  5497     ELSE IF DFHEIGDJ EQUAL 2
  5498         GO TO 9600-PGMID-ERROR,
  5499               9990-ABEND
  5500         DEPENDING ON DFHEIGDI
  5501     ELSE IF DFHEIGDJ EQUAL 3
  5502         GO TO 0410-NO-COMP-MSTR,
  5503               7100-COMP-FILE-NOTOPEN
  5504         DEPENDING ON DFHEIGDI
  5505     ELSE IF DFHEIGDJ EQUAL 4
  5506         GO TO 0890-EXIT
  5507         DEPENDING ON DFHEIGDI
  5508     ELSE IF DFHEIGDJ EQUAL 5
  5509         GO TO 2110-ADD-RECORD
  5510         DEPENDING ON DFHEIGDI
  5511     ELSE IF DFHEIGDJ EQUAL 6
  5512         GO TO 2120-DELETE-CONT
  5513         DEPENDING ON DFHEIGDI
  5514     ELSE IF DFHEIGDJ EQUAL 7
  5515         GO TO 2190-DUP-RECORD
  5516         DEPENDING ON DFHEIGDI
  5517     ELSE IF DFHEIGDJ EQUAL 8
  5518         GO TO 5010-NOT-OPEN,
  5519               5020-NO-RECORDS,
  5520               5020-NO-RECORDS
  5521         DEPENDING ON DFHEIGDI
  5522     ELSE IF DFHEIGDJ EQUAL 9
  5523         GO TO 5110-END-OF-FILE,
  5524               5110-END-OF-FILE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-11 11:25 Page 113
* EL633.cbl
  5525         DEPENDING ON DFHEIGDI
  5526     ELSE IF DFHEIGDJ EQUAL 10
  5527         GO TO 6100-END-OF-FILE,
  5528               6100-END-OF-FILE
  5529         DEPENDING ON DFHEIGDI
  5530     ELSE IF DFHEIGDJ EQUAL 11
  5531         GO TO 8300-SEND-TEXT
  5532         DEPENDING ON DFHEIGDI.
  5533     MOVE '9%                    "   ' TO DFHEIV0
  5534     MOVE 'EL633' TO DFHEIV1
  5535     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5536     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        5632     Code:       17565
