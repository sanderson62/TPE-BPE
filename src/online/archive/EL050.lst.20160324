* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   3
* EL050.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62
    63 77  FILLER   PIC X(32) VALUE '********************************'.
    64 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    65 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    66
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    72 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    73                                   USAGE IS POINTER.
    74 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    75 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    76                                   USAGE IS POINTER.
    77 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    82 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    83                                   USAGE IS POINTER.
    84
    85*    COPY ELC50WS.
    86*****************************************************************
    87*                                                               *
    88*                            ELC50WS.                           *
    89*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    90*                            VMOD=2.061.                        *
    91*                                                               *
    92*   THIS IS THE WORKING STORAGE FOR EL050                       *
    93*                                   EL517                       *
    94*****************************************************************
    95******************************************************************
    96*                   C H A N G E   L O G
    97*
    98* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    99*-----------------------------------------------------------------
   100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   101* EFFECTIVE    NUMBER
   102*-----------------------------------------------------------------
   103* 123102                   PEMA  ADD DCC PROCESSING
   104* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   105* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   106* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   107* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   108* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   109* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   110* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   111* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   112* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   113* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   114* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   115* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   116* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   117* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   4
* EL050.cbl
   118* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   119* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   120* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   121* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   122* 030309  CR2009021700001  PEMA  ADD ER-2883
   123* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   124* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   125* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   126* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   127* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   128* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   129* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   130* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   131* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   132* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   133* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   134* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   135* 061412  CR2011022800001  AJRA  NAPERSOFT
   136* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   137* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   138* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   139* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   140* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   141* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   142* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   143* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   144* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   145* 091114  IR2014091000001  TANA  ADD ERROR 2898
   146* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   147* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   148*-----------------------------------------------------------------
   149
   150 01  WORK-AREAS.
   151
   152*****************************************************************
   153*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   154*****************************************************************
   155
   156     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   157     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   158     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   159     12  WS-NAME-EDIT-WORK-AREA.
   160         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   161         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   162             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   163         16  WS-WORK-NAME.
   164             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   165             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   166             20  FILLER           PIC X(10)     VALUE SPACES.
   167         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   168             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   169
   170*****************************************************************
   171*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   172*****************************************************************
   173
   174     12  WS-ERRESC-KEY.
   175         16 WS-ERRESC-SEARCH-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   5
* EL050.cbl
   176             20  WS-ERRESC-COMPANY-CD PIC  X.
   177             20  WS-ERRESC-CARRIER    PIC  X.
   178             20  WS-ERRESC-GROUP      PIC X(6).
   179             20  WS-ERRESC-STATE      PIC XX.
   180             20  WS-ERRESC-ACCOUNT    PIC X(10).
   181         16 WS-ERRESC-RESIDUAL-KEY.
   182             20  WS-ERRESC-AGENT      PIC X(10).
   183             20  WS-ERRESC-RES-STATE  PIC XX.
   184             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   185*                                          YYYYMMDD
   186     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   187     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   188
   189*RESIDENT STATE TAX MASTER(ERRESS)
   190*
   191     12  WS-ERRESS-KEY.
   192         16  WS-ERRESS-COMPANY-CD      PIC  X.
   193         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   194         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   195         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   196*                                          YYYYMMDD
   197
   198     12  WS-CONTRACT-DATE              PIC 9(8).
   199*                                          YYYYMMDD
   200     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   201     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   202         16 WS-YEAR-YY                 PIC   9999.
   203         16 FILLER                     PIC 9(4).
   204*                                          YYYYMMDD
   205     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   206     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   207     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   208     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   209
   210     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   211         88  DPRB-1ST-TIME                      VALUE ' '.
   212
   213*****************************************************************
   214*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   215*****************************************************************
   216
   217     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   218     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   219     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   221     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   222     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   223     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   224     12  ws-st-agent-sig-edit    pic x          value spaces.
   225     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   226     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   227     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   228     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   229         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   230         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   231     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   232         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   233         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   6
* EL050.cbl
   234     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   235
   236     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   237     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   238
   239     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   240     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   245     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   251     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   252     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   253     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   254     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   268     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   269     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   272     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   273     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   274     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   275     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   276     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   277     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   278     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   285     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   286     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   287     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   288     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   289     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   290     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   291     12  WS-2671-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   7
* EL050.cbl
   292     12  WS-2672-SW               PIC X         VALUE SPACE.
   293     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   294         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   295     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   296         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   297     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   298
   299     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   300         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   301         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   302         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   303         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   304
   305     12  WS-CREDIT-EDIT-CONTROLS.
   306         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   307         16  WS-MIN-AGE           PIC 99                VALUE  0.
   308         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   309         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   310         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   311         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   312
   313     12  ws-vehicle-odometer     pic s9(7) comp-3 value +0.
   314     12  WS-AGE-FIELDS.
   315         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   316         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   317         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   318         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   319
   320     12  WS-SAVE-ALLOWABLE-BENEFIT.
   321         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   322         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   323         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   324         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   325         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   326         16  FILLER                      PIC XX.
   327
   328     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   329     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   330     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   331     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   332     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   333     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   334     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   335     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   336     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   337     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   338
   339     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   340     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   341     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   342     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   343     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   344     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   345     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   346     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   347         88  WS-REDUCING              VALUE 'R'.
   348         88  WS-LEVEL                 VALUE 'L' 'P'.
   349     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   8
* EL050.cbl
   350
   351     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   352     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   353     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   354     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   355     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   356     12  ws-ah-max-bens           pic 99        value zeros.
   357     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   358     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   359     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   360     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   361
   362     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   364     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   365     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   366     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   367     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   368     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   369     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   370     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   371     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   372     12  WS-ACCT-SIG-SW.
   373         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   374         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   375     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   376     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   377     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   382     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   383     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   384     12  WS-INITIALS.
   385         16  WS-INIT-1            PIC X         VALUE SPACES.
   386         16  WS-INIT-2            PIC X         VALUE SPACES.
   387
   388     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   389     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   390     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   391     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   392     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   393*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   394     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   398     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   399     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   400     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   401     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   402     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   403     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   404     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   405     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   406     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   407     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page   9
* EL050.cbl
   408     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   409     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   414     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   415     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   416******** FLA
   417     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   418     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   419     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   420     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   421     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   422********
   423     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   424     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   425     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   426     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   427     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   428     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   429     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   430     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   431     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   432     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   433
   434     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   435         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   436                                         '0' THRU '9'.
   437
   438     12  NUMBER-OF-MONTHS.
   439         16  SK-MO OCCURS 12 TIMES PIC X.
   440
   441     12  WS-WORK-DATE.
   442         16  WS-YEAR            PIC 99    VALUE 00.
   443         16  WS-MONTH           PIC 99    VALUE 00.
   444         16  WS-DAY             PIC 99    VALUE 00.
   445
   446     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   447     12  WS-WORK-CRIT-DEV       REDEFINES
   448         WS-WORK-LF-CRIT-PER    PIC X(03).
   449
   450     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   451     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   452
   453     12  WS-WORK-DATE-FROM.
   454         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   455         16  FILLER             PIC X  VALUE SPACE.
   456         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   457         16  FILLER             PIC X         VALUE SPACE.
   458         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   459
   460     12  WS-WORK-DATE-THRU.
   461         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   462         16  FILLER             PIC X         VALUE SPACE.
   463         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   464         16  FILLER             PIC X         VALUE SPACE.
   465         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  10
* EL050.cbl
   466
   467     12  WS-LF-INPUT-CD.
   468         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   469         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   470
   471     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   472     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   473         16  WS-AH-INPUT-CD-1   PIC X.
   474         16  WS-AH-INPUT-CD-2-3 PIC XX.
   475
   476     12  WS-SWITCHES.
   477         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   478         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   479             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   480         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   481             88  BANK-ACCT-FOUND          VALUE 'Y'.
   482         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   483             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   484         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   485             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   486         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   487             88  COMP-MASTER-FOUND        VALUE 'Y'.
   488         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   489             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   490         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   491             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   492         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   493             88  STAT-MASTER-FOUND        VALUE 'Y'.
   494         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   495             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   496         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   497             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   498         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   499             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   500         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   501             88  FORM-MASTER-FOUND        VALUE 'Y'.
   502         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   503             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   504         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   505             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   506         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   507             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   508         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   509             88  NO-BENEFIT-FOUND         VALUE 'N'.
   510         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   511             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   512         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   513             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   514         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  AH-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   517         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   518             88  LF-BENEFIT-FOUND         VALUE ' '.
   519             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   520         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   521             88  NO-STATE-RECORD          VALUE '1'.
   522         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   523             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  11
* EL050.cbl
   524         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   525             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   526         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   527             88  CERT-WAS-FOUND           VALUE ' '.
   528             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   529         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   530             88  BROWSE-STARTED           VALUE 'Y'.
   531         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   532             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   533         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   534             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   535         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   536             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   537         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   538             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   539         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   540             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   541         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   542             88  APP-CERT-USED            VALUE 'Y' 'A'.
   543         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   544             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   545             88  FIRST-TIME-THROUGH       VALUE '1'.
   546             88  CTBL-NOT-FOUND           VALUE '2'.
   547
   548         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   549             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   550
   551         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   552             88  DLO-ERROR-FOUND          VALUE 'Y'.
   553
   554********FLA
   555     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   556     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   557********
   558     12  RC-SW-1                  PIC X           VALUE '0'.
   559     12  RC-SW-2                  PIC X           VALUE '0'.
   560     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   561     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   562     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   567     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   568     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   569     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   570     12  LIT-SPACES               PIC X           VALUE SPACES.
   571     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   572     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   573     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   574     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   575     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   576     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   577     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   578         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   579         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   580     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   581         88  SKIP-ADDR-EDIT         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  12
* EL050.cbl
   582
   583 01  WS-EXTRA-PERIODS-BY-STATE.
   584     12  WS-INT-PERIODS          PIC 9.
   585     12  WS-EXTRA-PMTS           PIC 9.
   586 01  ws-net-only-state           pic x value 'N'.
   587 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   588     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   589     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   590 01  WS-CRI-SSN-WORK-AREA.
   591     05  WS-CRI-SOC-SEC-NO.
   592         10  WS-SS-REPT-CD       PIC X(5).
   593         10  WS-SS-LAST-NAME     PIC X(5).
   594         10  WS-SS-INITIAL       PIC X.
   595
   596     05  WS-CRI-REPORT-CODE.
   597         10  FILLER              PIC X(5).
   598         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   599
   600     05  WS-CRI-LAST-NAME.
   601         10  WS-CRI-NAME-MOVE    PIC X(5).
   602         10  FILLER              PIC X(10).
   603
   604 01  WS-NUM-TABLE                PIC X(26)  VALUE
   605     '12345678012345070923456789'.
   606 01  FILLER REDEFINES WS-NUM-TABLE.
   607     05  WS-NUM OCCURS 26        PIC 9.
   608 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   609 01  V1                          PIC S999 COMP-3.
   610 01  V2                          PIC S999 COMP-3.
   611 01  V3                          PIC S999 COMP-3.
   612 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   613 01  FILLER REDEFINES WS-WORK-VIN.
   614     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   615 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   616 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   617 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   618 01  WS-HEX-WORK.
   619     05  FILLER                  PIC X  VALUE LOW-VALUES.
   620     05  WS-HEX-BYTE             PIC X.
   621 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   622 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   623 01  WS-WORK-HIN-ROW-B.
   624     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   625
   626 01  ws-benefit-cd-chg-sw      pic x value spaces.
   627     88  benefit-code-chg           value 'Y'.
   628 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   629 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   630     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   631 01  WS-ROW-D-TABLE.
   632     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   633
   634 01  WS-HIN-TABLE-B.
   635     05  F                       PIC XX VALUE 'A2'.
   636     05  F                       PIC XX VALUE 'B3'.
   637     05  F                       PIC XX VALUE 'C4'.
   638     05  F                       PIC XX VALUE 'D5'.
   639     05  F                       PIC XX VALUE 'E6'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  13
* EL050.cbl
   640     05  F                       PIC XX VALUE 'F7'.
   641     05  F                       PIC XX VALUE 'G8'.
   642     05  F                       PIC XX VALUE 'H9'.
   643     05  F                       PIC XX VALUE 'I1'.
   644     05  F                       PIC XX VALUE 'J2'.
   645     05  F                       PIC XX VALUE 'K3'.
   646     05  F                       PIC XX VALUE 'L4'.
   647     05  F                       PIC XX VALUE 'M5'.
   648     05  F                       PIC XX VALUE 'N6'.
   649     05  F                       PIC XX VALUE 'O0'.
   650     05  F                       PIC XX VALUE 'P7'.
   651     05  F                       PIC XX VALUE 'Q0'.
   652     05  F                       PIC XX VALUE 'R8'.
   653     05  F                       PIC XX VALUE 'S9'.
   654     05  F                       PIC XX VALUE 'T2'.
   655     05  F                       PIC XX VALUE 'U3'.
   656     05  F                       PIC XX VALUE 'V4'.
   657     05  F                       PIC XX VALUE 'W5'.
   658     05  F                       PIC XX VALUE 'X6'.
   659     05  F                       PIC XX VALUE 'Y7'.
   660     05  F                       PIC XX VALUE 'Z8'.
   661 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   662     05  WS-VAL-IN               PIC X.
   663     05  WS-VAL-OUT              PIC 9.
   664 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   665 01  WS-COMPARE-BINARY-DATES.
   666     05  WS-971231                PIC XX VALUE X'92FF'.
   667     05  WS-931231                PIC XX VALUE X'8CFF'.
   668     05  WS-791231                PIC XX VALUE X'77FF'.
   669     05  WS-771001                PIC XX VALUE X'74A1'.
   670     05  WS-820301                PIC XX VALUE X'7B41'.
   671     05  WS-831031                PIC XX VALUE X'7DBF'.
   672     05  WS-831231                PIC XX VALUE X'7DFF'.
   673     05  WS-810831                PIC XX VALUE X'7A7F'.
   674     05  WS-830901                PIC XX VALUE X'7D81'.
   675
   676 01  FILE-ACCESS-IDS.
   677     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   678     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   679     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   680     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   681     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   682     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   683     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   684     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   685     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   686     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   687     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   688     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   689     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   690     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   691     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   692     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   693     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   694 01  DD-IU-SW                    PIC X   VALUE ' '.
   695     88  DD-IU-PRESENT                 VALUE 'Y'.
   696
   697 01  ACCESS-KEYS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  14
* EL050.cbl
   698     12  ELMSTR-KEY.
   699         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   701     12  W-CLAIM-KEY.
   702         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   703         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   704
   705     12  ELCNTL-KEY.
   706         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   707         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   708         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   709         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   710
   711     12  ELCERT-KEY.
   712         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   713         16  CERT-CARRIER         PIC X       VALUE SPACE.
   714         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   715         16  CERT-STATE           PIC XX      VALUE SPACES.
   716         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   717         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   718         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   719
   720     12  ELCERT2-KEY.
   721         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   722         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   723
   724     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   725
   726     12  ELCERT-SAVE.
   727         16  FILLER                      PIC XX    VALUE SPACES.
   728
   729         16  WCS-CONTROL-PRIMARY.
   730             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   731             20  WCS-CARRIER             PIC X     VALUE SPACE.
   732             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   733             20  WCS-STATE               PIC XX    VALUE SPACES.
   734             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   735             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   736             20  WCS-CERT-NO.
   737                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   738                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   739
   740         16  CS-CONTROL-BY-NAME.
   741             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   742             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   743             20  CS-INSURED-INITIALS.
   744                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   745                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   746
   747         16  CS-CONTROL-BY-SSN.
   748             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   749             20  CS-SOC-SEC-NO.
   750                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   751                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   752                 24  CS-SSN-LN3.
   753                     28 CS-INSURED-INITIALS-A2   PIC XX
   754                                     VALUE SPACES.
   755                     28 CS-PART-LAST-NAME-A2     PIC X
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  15
* EL050.cbl
   756                                     VALUE SPACE.
   757
   758         16  CS-CONTROL-BY-CERT-NO.
   759             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   760             20  CS-CERT-NO-A4           PIC X(11)
   761                                     VALUE SPACES.
   762
   763         16  CS-CONTROL-BY-MEMB.
   764             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   765             20  CS-MEMBER-NO.
   766                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   767                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   768                 24  CS-MEMB-LN4.
   769                     28 CS-INSURED-INITIALS-A5   PIC XX
   770                                      VALUE SPACES.
   771                     28 CS-PART-LAST-NAME-A5     PIC XX
   772                                      VALUE SPACES.
   773
   774         16  FILLER              PIC X(360) VALUE SPACES.
   775
   776     12  ERACCT-KEY.
   777         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   778         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   779         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   780         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   781         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   782         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   783
   784     12  ERCOMP-KEY.
   785         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   786         16  COMP-CARRIER         PIC X     VALUE SPACES.
   787         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   788         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   789         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   790         16  COMP-TYPE            PIC X     VALUE SPACES.
   791
   792     12  ERLOFC-KEY.
   793         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   794         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   795         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   796         16  LOFC-STATE           PIC XX    VALUE SPACES.
   797         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   798         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   799
   800     12  WS-ELCRTT-KEY.
   801         16  WS-ELCRTT-PRIMARY       PIC X(33).
   802         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   803
   804     12  ERBXRF-KEY.
   805         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   806         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   807         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   808         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   809
   810     12  ERAGTC-KEY.
   811         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   812         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   813         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  16
* EL050.cbl
   814         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   815         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   816         16  AGTC-TYPE            PIC X     VALUE SPACES.
   817
   818     12  ERPLAN-KEY.
   819         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   820         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   821         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   822         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   823         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   824         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   825         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   826         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   827
   828     12  ERFORM-KEY.
   829         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   830         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   831         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   832         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   833
   834     12  ERREIN-KEY.
   835         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   836         16  REIN-TYPE            PIC X     VALUE SPACES.
   837         16  REIN-TABLE-CO.
   838             20  REIN-CODE-1      PIC X     VALUE SPACE.
   839             20  REIN-CODE-2      PIC X     VALUE SPACE.
   840             20  REIN-CODE-3      PIC X     VALUE SPACE.
   841         16  FILLER               PIC X(3)  VALUE SPACES.
   842
   843     12  ERCTBL-KEY.
   844         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   845         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   846         16  CTBL-CNTRL-2.
   847             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   848             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   849
   850     12  ELCRTO-KEY.
   851         16  ELCRTO-COMPANY-CD       PIC X.
   852         16  ELCRTO-CARRIER          PIC X.
   853         16  ELCRTO-GROUPING         PIC X(6).
   854         16  ELCRTO-STATE            PIC XX.
   855         16  ELCRTO-ACCOUNT          PIC X(10).
   856         16  ELCRTO-CERT-EFF-DT      PIC XX.
   857         16  ELCRTO-CERT-NO.
   858             20  ELCRTO-CERT-PRIME   PIC X(10).
   859             20  ELCRTO-CERT-SFX     PIC X.
   860         16  ELCRTO-RECORD-TYPE      PIC X.
   861         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   862
   863
   864     12  WS-ACCESS.
   865         16  FILLER               PIC XX    VALUE SPACES.
   866         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   867
   868     12  WS-CARR-ACCESS.
   869         16  FILLER               PIC X(3)  VALUE SPACES.
   870         16  WS-CARR              PIC X     VALUE SPACE.
   871*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  17
* EL050.cbl
   872*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   873     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   874         88  WS-DMD-LF-RATING   VALUE 'Y'.
   875         88  WS-DMD-AH-RATING   VALUE 'Y'.
   876         88  WS-DMD-NO-RATING   VALUE 'N'.
   877
   878     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   879         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   880                                         'NJ' 'NL'
   881                                         'PJ' 'PL'
   882                                         'SJ' 'SL'.
   883     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   884         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   885                                         'NI' 'NJ' 'NL' 'NU'
   886                                         'PJ' 'PL' 'PI' 'PU'
   887                                         'SI' 'SJ' 'SL' 'SU'
   888                                         'MX' 'MY' 'MZ'.
   889 01  ERPDEF-KEY-SAVE             PIC X(18).
   890 01  ERPDEF-KEY.
   891     12  ERPDEF-COMPANY-CD       PIC X.
   892     12  ERPDEF-STATE            PIC XX.
   893     12  ERPDEF-PROD-CD          PIC XXX.
   894     12  F                       PIC X(7).
   895     12  ERPDEF-BEN-TYPE         PIC X.
   896     12  ERPDEF-BEN-CODE         PIC XX.
   897     12  ERPDEF-EXP-DT           PIC XX.
   898
   899 01  ELSTAT-KEY-SAVE             PIC X(20).
   900 01  ELSTAT-KEY.
   901     12  ELSTAT-COMPANY-ID       PIC XXX.
   902     12  ELSTAT-CARRIER          PIC X.
   903     12  ELSTAT-GROUP            PIC X(6).
   904     12  ELSTAT-STATE            PIC XX.
   905     12  ELSTAT-EXP-DT           PIC 9(8).
   906 01  WS-ERROR-VALUES.
   907     12  ER-1570                     PIC S9(4)   VALUE +1570.
   908     12  ER-1571                     PIC S9(4)   VALUE +1571.
   909     12  er-1572                     pic s9(4)   value +1572.
   910     12  er-1573                     pic s9(4)   value +1573.
   911     12  er-1574                     pic s9(4)   value +1574.
   912     12  ER-1575                     PIC S9(4)   VALUE +1575.
   913     12  er-1576                     pic s9(4)   value +1576.
   914     12  er-1583                     pic s9(4)   value +1583.
   915     12  er-1743                     pic s9(4)   value +1743.
   916     12  er-1744                     pic s9(4)   value +1744.
   917     12  er-1745                     pic s9(4)   value +1745.
   918     12  er-1746                     pic s9(4)   value +1746.
   919     12  er-1747                     pic s9(4)   value +1747.
   920     12  er-1748                     pic s9(4)   value +1748.
   921     12  ER-1891                     PIC S9(4)   VALUE +1891.
   922     12  ER-1892                     PIC S9(4)   VALUE +1892.
   923     12  ER-1893                     PIC S9(4)   VALUE +1893.
   924     12  ER-1894                     PIC S9(4)   VALUE +1894.
   925     12  ER-1895                     PIC S9(4)   VALUE +1895.
   926     12  ER-1896                     PIC S9(4)   VALUE +1896.
   927     12  ER-1897                     PIC S9(4)   VALUE +1897.
   928     12  ER-1898                     PIC S9(4)   VALUE +1898.
   929     12  ER-1899                     PIC S9(4)   VALUE +1899.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  18
* EL050.cbl
   930     12  ER-1900                     PIC S9(4)   VALUE +1900.
   931     12  ER-1901                     PIC S9(4)   VALUE +1901.
   932     12  ER-1902                     PIC S9(4)   VALUE +1902.
   933     12  ER-1903                     PIC S9(4)   VALUE +1903.
   934     12  ER-1904                     PIC S9(4)   VALUE +1904.
   935     12  ER-1905                     PIC S9(4)   VALUE +1905.
   936     12  ER-1906                     PIC S9(4)   VALUE +1906.
   937     12  ER-1907                     PIC S9(4)   VALUE +1907.
   938     12  ER-1909                     PIC S9(4)   VALUE +1909.
   939     12  ER-1910                     PIC S9(4)   VALUE +1910.
   940     12  ER-1911                     PIC S9(4)   VALUE +1911.
   941     12  ER-1912                     PIC S9(4)   VALUE +1912.
   942     12  ER-1913                     PIC S9(4)   VALUE +1913.
   943     12  ER-1914                     PIC S9(4)   VALUE +1914.
   944     12  ER-1915                     PIC S9(4)   VALUE +1915.
   945     12  ER-1916                     PIC S9(4)   VALUE +1916.
   946     12  ER-1917                     PIC S9(4)   VALUE +1917.
   947     12  ER-1918                     PIC S9(4)   VALUE +1918.
   948     12  ER-1919                     PIC S9(4)   VALUE +1919.
   949     12  ER-1920                     PIC S9(4)   VALUE +1920.
   950     12  ER-1921                     PIC S9(4)   VALUE +1921.
   951     12  ER-1922                     PIC S9(4)   VALUE +1922.
   952     12  ER-1923                     PIC S9(4)   VALUE +1923.
   953     12  ER-1924                     PIC S9(4)   VALUE +1924.
   954     12  ER-1925                     PIC S9(4)   VALUE +1925.
   955     12  ER-1926                     PIC S9(4)   VALUE +1926.
   956     12  ER-1927                     PIC S9(4)   VALUE +1927.
   957     12  ER-2393                     PIC S9(4)   VALUE +2393.
   958     12  ER-2600                     PIC S9(4)   VALUE +2600.
   959     12  ER-2601                     PIC S9(4)   VALUE +2601.
   960     12  ER-2602                     PIC S9(4)   VALUE +2602.
   961     12  ER-2603                     PIC S9(4)   VALUE +2603.
   962     12  ER-2604                     PIC S9(4)   VALUE +2604.
   963     12  ER-2605                     PIC S9(4)   VALUE +2605.
   964     12  ER-2606                     PIC S9(4)   VALUE +2606.
   965     12  ER-2607                     PIC S9(4)   VALUE +2607.
   966     12  ER-2608                     PIC S9(4)   VALUE +2608.
   967     12  ER-2609                     PIC S9(4)   VALUE +2609.
   968     12  ER-2610                     PIC S9(4)   VALUE +2610.
   969     12  ER-2611                     PIC S9(4)   VALUE +2611.
   970     12  ER-2612                     PIC S9(4)   VALUE +2612.
   971     12  ER-2613                     PIC S9(4)   VALUE +2613.
   972     12  ER-2614                     PIC S9(4)   VALUE +2614.
   973     12  ER-2615                     PIC S9(4)   VALUE +2615.
   974     12  ER-2616                     PIC S9(4)   VALUE +2616.
   975     12  ER-2617                     PIC S9(4)   VALUE +2617.
   976     12  ER-2618                     PIC S9(4)   VALUE +2618.
   977     12  ER-2619                     PIC S9(4)   VALUE +2619.
   978     12  ER-2620                     PIC S9(4)   VALUE +2620.
   979     12  ER-2621                     PIC S9(4)   VALUE +2621.
   980     12  ER-2622                     PIC S9(4)   VALUE +2622.
   981     12  ER-2623                     PIC S9(4)   VALUE +2623.
   982     12  ER-2624                     PIC S9(4)   VALUE +2624.
   983     12  ER-2625                     PIC S9(4)   VALUE +2625.
   984     12  ER-2626                     PIC S9(4)   VALUE +2626.
   985     12  ER-2627                     PIC S9(4)   VALUE +2627.
   986     12  ER-2628                     PIC S9(4)   VALUE +2628.
   987     12  ER-2629                     PIC S9(4)   VALUE +2629.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  19
* EL050.cbl
   988     12  ER-2630                     PIC S9(4)   VALUE +2630.
   989     12  ER-2631                     PIC S9(4)   VALUE +2631.
   990     12  ER-2632                     PIC S9(4)   VALUE +2632.
   991     12  ER-2633                     PIC S9(4)   VALUE +2633.
   992     12  ER-2634                     PIC S9(4)   VALUE +2634.
   993     12  ER-2635                     PIC S9(4)   VALUE +2635.
   994     12  ER-2636                     PIC S9(4)   VALUE +2636.
   995     12  ER-2637                     PIC S9(4)   VALUE +2637.
   996     12  ER-2638                     PIC S9(4)   VALUE +2638.
   997     12  ER-2639                     PIC S9(4)   VALUE +2639.
   998     12  ER-2640                     PIC S9(4)   VALUE +2640.
   999     12  ER-2641                     PIC S9(4)   VALUE +2641.
  1000     12  ER-2642                     PIC S9(4)   VALUE +2642.
  1001     12  ER-2643                     PIC S9(4)   VALUE +2643.
  1002     12  ER-2644                     PIC S9(4)   VALUE +2644.
  1003     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1004     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1005     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1006     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1007     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1008     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1009     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1010     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1011     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1012     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1013     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1014     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1015     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1016     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1017     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1018     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1019     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1020     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1021     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1022     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1023     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1024     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1025     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1026     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1027     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1028     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1029     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1030     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1031     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1032     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1033     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1034     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1035     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1036     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1037     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1038     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1039     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1040     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1041     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1042     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1043     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1044     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1045     12  ER-2687                     PIC S9(4)   VALUE +2687.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  20
* EL050.cbl
  1046     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1047     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1048     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1049     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1050     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1051     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1052     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1053     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1054     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1055     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1056     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1057     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1058     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1059     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1060     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1061     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1062     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1063     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1064     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1065     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1066     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1067     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1068     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1069     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1070     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1071     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1072     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1073     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1074     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1075     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1076     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1077     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1078     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1079     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1080     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1081     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1082     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1083     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1084     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1085     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1086     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1087     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1088     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1089     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1090     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1091     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1092     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1093     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1094     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1095     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1096     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1097     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1098     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1099     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1100     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1101     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1102     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1103     12  ER-2755                     PIC S9(4)   VALUE +2755.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  21
* EL050.cbl
  1104     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1105     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1106     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1107     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1108     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1109     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1110     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1111     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1112     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1113     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1114     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1115     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1116     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1117     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1118     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1119     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1120     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1121     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1122     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1123     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1124     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1125     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1126     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1127     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1128     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1129     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1130     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1131     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1132     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1133     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1134     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1135     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1136     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1137     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1138     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1139     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1140     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1141     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1142     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1143     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1144     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1145     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1146     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1147     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1148     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1149     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1150     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1151     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1152     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1153     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1154     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1155     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1156     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1157     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1158     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1159     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1160     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1161     12  ER-2964                     PIC S9(4)   VALUE +2964.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  22
* EL050.cbl
  1162     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1163     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1164     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1165     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1166     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1167     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1168     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1169     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1170     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1171     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1172     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1173     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1174     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1175     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1176     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1177     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1178     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1179     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1180     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1181     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1182     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1183     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1184     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1185     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1186     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1187     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1188     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1189     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1190     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1191     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1192     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1193     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1194     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1195     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1196     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1197     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1198     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1199     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1200     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1201     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1202     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1203     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1204     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1205     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1206     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1207     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1208     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1209     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1210     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1211     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1212     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1213     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1214     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1215     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1216     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1217     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1218     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1219     12  ER-8082                     PIC S9(4)   VALUE +8082.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  23
* EL050.cbl
  1220     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1221     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1222     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1223     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1224     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1225     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1226     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1227     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1228     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1229     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1230     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1231     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1232     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1233     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1234     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1235     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1236     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1237     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1238     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1239     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1240     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1241     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1242     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1243     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1244     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1245     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1246     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1247     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1248     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1249     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1250     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1251     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1252     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1253     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1254     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1255     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1256     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1257     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1258     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1259     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1260     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1261     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1262     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1263     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1264     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1265******************************************************************
  1266***************   END OF ELC50WS     ****************************
  1267******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  24
* EL050.cbl
  1270 01  WORKING-STORAGE-WORK-AREAS.
  1271     12  WS-RESPONSE             PIC S9(8)  COMP.
  1272         88  WS-RESP-NORMAL           VALUE +00.
  1273         88  WS-RESP-ERROR            VALUE +01.
  1274         88  WS-RESP-NOTFND           VALUE +13.
  1275         88  WS-RESP-DUPREC           VALUE +14.
  1276         88  WS-RESP-ENDFILE          VALUE +20.
  1277     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1278     12  WORK-AREAS.
  1279         16  WK-CONV-GREG.
  1280             24  WCG-CENT             PIC XX.
  1281             24  WCG-REST             PIC X(4).
  1282         16  WORK-GREGORIAN-DATE.
  1283             24  WK-GREG-CENT         PIC XX.
  1284             24  WK-GREG-DATE-YYMMDD.
  1285                 28  WK-GREG-YYMM     PIC X(4).
  1286                 28  WK-GREG-DD       PIC XX.
  1287
  1288         16  WORK-SELECT-DATE.
  1289             24  WK-SELECT-CENT            PIC XX.
  1290             24  WK-SELECT-DATE-YYMMDD.
  1291                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1292                 28  FILLER                PIC XX.
  1293
  1294         16  WK-FORM-NO.
  1295             24  WK-FORM-BANK-ID       PIC X(5).
  1296             24  WK-FORM-UNDRWRTR      PIC X(1).
  1297             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1298
  1299         16  WK-MEMBER-NO.
  1300             24  WK-MEMBER-1-6        PIC X(6).
  1301             24  WK-MEMBER-7-12       PIC X(6).
  1302
  1303         16  WK-FULL-CERT-NO.
  1304             24  WK-CERT-POS-1-2      PIC X(2).
  1305             24  WK-CERT-POS-3        PIC X(1).
  1306             24  WK-CERT-POS-4        PIC X(1).
  1307             24  WK-CERT-POS-5-6      PIC X(2).
  1308             24  WK-CERT-POS-7        PIC X(1).
  1309             24  WK-CERT-POS-8-11     PIC X(4).
  1310
  1311         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1312             88  VALID-RATE-CODE        VALUE 'Y'.
  1313             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1314
  1315         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1316         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1317         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1318         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1319         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1320         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1321         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1322         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1323         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1324         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1325
  1326* DLO001
  1327 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  25
* EL050.cbl
  1328     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1329     12  DMPF-RETURN-CODE          PIC XX.
  1330         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1331         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1332         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1333         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1334         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1335         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1336
  1337* DLO002
  1338 01  WS-DLO-INTERNAL-POLICY-FORM.
  1339     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1340     12  DIPF-RETURN-CODE          PIC XX.
  1341         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1342         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1343         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1344         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1345         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1346         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1347
  1348* DLO003
  1349 01  WS-DLO-VALID-BANK-ID.
  1350     12  DVBI-BANK-ID              PIC X(5).
  1351     12  DVBI-BANK-ID-TYPE         PIC X.
  1352         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1353         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1354         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1355         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1356         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1357     12  DVBI-RETURN-CODE          PIC XX.
  1358         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1359         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1360         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1361         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1362         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1363         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1364         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1365         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1366         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1367
  1368* DLO007
  1369 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1370     12  DCUA-RES-STATE            PIC XX.
  1371     12  DCUA-BEN-TYPE             PIC XX.
  1372     12  DCUA-SYS-IDENT            PIC X.
  1373         88  DCUA-CLAIM                        VALUE 'C'.
  1374         88  DCUA-PREMIUM                      VALUE 'P'.
  1375     12  DCUA-COVERAGE-RULE        PIC X.
  1376     12  DCUA-CLIENT-ID            PIC X(10).
  1377     12  DCUA-EFF-DATE             PIC X(8).
  1378     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1379     12  DCUA-RETURN-CODE          PIC XX.
  1380         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1381     12  DCUA-CERT-NUMBER          PIC X(11).
  1382     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1383     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1384
  1385* DLO011
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  26
* EL050.cbl
  1386 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1387     12  DPRB-RATE-CODE            PIC X(4).
  1388     12  DPRB-COVERAGE-CATEG       PIC X.
  1389     12  DPRB-RETURN-CODE          PIC XX.
  1390         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1391         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1392         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1393         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1394         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1395         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1396         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1397         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1398         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1399     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1400     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1401     12  DPRB-BEN-TYPE             PIC XX.
  1402
  1403* DLO017
  1404 01  WS-DLO-VALID-RATE-CODE.
  1405     12  DVRC-RATE-CODE            PIC X(4).
  1406     12  DVRC-RETURN-CODE          PIC XX.
  1407         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1408         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1409         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1410         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1411         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1412         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1413
  1414* DLO019
  1415 01  WS-DLO-ORIG-COV-CAT.
  1416     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1417     12  DOCC-RETURN-CODE          PIC XX.
  1418     12  DOCC-ORIG-COV-CAT         PIC X.
  1419     12  DOCC-UNDERWITER           PIC XX.
  1420     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1421     12  DOCC-FILLER               PIC X(6).
  1422
  1423* DLO021
  1424 01  WS-DLO-VALID-LOAN-OFFICER.
  1425     12  DVLO-LOAN-OFFICER.
  1426         16  DVLO-BILL-TYPE        PIC X.
  1427         16  DVLO-BILL-SOURCE      PIC X.
  1428         16  DVLO-BATCH-TYPE       PIC X.
  1429     12  DVLO-RETURN-CODE          PIC XX.
  1430         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1431         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1432         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1433         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1434         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1435         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1436
  1437* DLO022
  1438 01  WS-DLO-VALID-STATE-CODE.
  1439     12  DVSC-STATE-CODE           PIC XX.
  1440     12  DVSC-RETURN-CODE          PIC XX.
  1441         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1442
  1443* DLO023
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  27
* EL050.cbl
  1444 01  WS-DLO-VALID-CODE-VALUES.
  1445     12  DVCV-SYSTEM-ID            PIC XX.
  1446         88  DVCV-CLAIMS                       VALUE 'CL'.
  1447         88  DVCV-CREDIT                       VALUE 'CR'.
  1448     12  DVCV-RECORD-TYPE          PIC XX.
  1449         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1450         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1451         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1452         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1453         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1454         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1455         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1456         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1457     12  DVCV-RECORD-KEY           PIC X(6).
  1458     12  DVCV-RETURN-CODE          PIC XX.
  1459         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1460         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1461         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1462         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1463         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1464         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1465         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1466     12  DVCV-CODE-DESC            PIC X(60).
  1467     12  DVCV-GEN-DESC-1           PIC X(20).
  1468     12  DVCV-GEN-DESC-2           PIC X(20).
  1469     12  DVCV-GEN-DESC-3           PIC X(20).
  1470
  1471****  this is for aggregate report.
  1472****  Length is erpndb + 100 of passed-key-area
  1473 01  ws-passed-key-length        pic s9(4) comp value +587.
  1474 01  ws-pass-to-pemaggo.
  1475     05  ws-passed-erpndb        pic x(585).
  1476     05  ws-exceed-limit-yn      pic x.
  1477     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  28
* EL050.cbl
  1479*    COPY ERCBXRF.
  1480******************************************************************
  1481*                                                                *
  1482*                                                                *
  1483*                            ERCBXRF                             *
  1484*                                                                *
  1485*   ONLINE CREDIT SYSTEM                                         *
  1486*                                                                *
  1487*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1488*                                                                *
  1489*   FILE TYPE = VSAM,KSDS                                        *
  1490*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1491*                                                                *
  1492*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1493*       ALTERNATE PATH = NONE                                    *
  1494*                                                                *
  1495*   LOG = NO                                                     *
  1496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1497*                                                                *
  1498******************************************************************
  1499
  1500 01  BANK-CROSS-REFERENCE.
  1501     12  BK-RECORD-ID                PIC XX.
  1502         88  VALID-BK-ID             VALUE 'BK'.
  1503
  1504     12  BK-CONTROL-PRIMARY.
  1505         16  BK-COMPANY-CD           PIC X.
  1506         16  BK-CARRIER              PIC X.
  1507         16  BK-GROUPING             PIC X(6).
  1508         16  BK-BANK-NO              PIC X(10).
  1509
  1510     12  BK-MAINT-INFORMATION.
  1511         16  BK-LAST-MAINT-DT        PIC XX.
  1512         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1513         16  BK-LAST-MAINT-USER      PIC X(4).
  1514         16  FILLER                  PIC X(9).
  1515
  1516     12  FILLER                      PIC X(37).
  1517
  1518     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1519
  1520     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1521                            DEPENDING ON BK-BANK-POINTER-CNT.
  1522         16  BK-AM-ACCOUNT           PIC X(10).
  1523         16  BK-AM-EXP-DT            PIC XX.
  1524         16  BK-AM-EFF-DT            PIC XX.
  1525         16  BK-AM-STATE             PIC XX.
  1526         16  FILLER                  PIC X(20).
  1527
  1528******************************************************************
  1529
  1530*    COPY ERCCOMP.
  1531******************************************************************
  1532*                                                                *
  1533*                                                                *
  1534*                            ERCCOMP                             *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  29
* EL050.cbl
  1537*                                                                *
  1538*   ONLINE CREDIT SYSTEM                                         *
  1539*                                                                *
  1540*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1541*                                                                *
  1542*   FILE TYPE = VSAM,KSDS                                        *
  1543*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1544*                                                                *
  1545*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1546*       ALTERNATE PATH = NONE                                    *
  1547*                                                                *
  1548*   LOG = NO                                                     *
  1549*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1550*                                                                *
  1551******************************************************************
  1552*                   C H A N G E   L O G
  1553*
  1554* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1555*-----------------------------------------------------------------
  1556*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1557* EFFECTIVE    NUMBER
  1558*-----------------------------------------------------------------
  1559* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1560* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1561* 092205    2005050300006  PEMA  ADD LEASE FEE
  1562* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1563* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1564* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1565* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1566* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1567* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1568******************************************************************
  1569
  1570 01  COMPENSATION-MASTER.
  1571     12  CO-RECORD-ID                          PIC XX.
  1572         88  VALID-CO-ID                          VALUE 'CO'.
  1573
  1574     12  CO-CONTROL-PRIMARY.
  1575         16  CO-COMPANY-CD                     PIC X.
  1576         16  CO-CONTROL.
  1577             20  CO-CTL-1.
  1578                 24  CO-CARR-GROUP.
  1579                     28  CO-CARRIER            PIC X.
  1580                     28  CO-GROUPING.
  1581                         32  CO-GROUP-PREFIX   PIC XXX.
  1582                         32  CO-GROUP-PRIME    PIC XXX.
  1583                 24  CO-RESP-NO.
  1584                     28  CO-RESP-PREFIX        PIC X(4).
  1585                     28  CO-RESP-PRIME         PIC X(6).
  1586             20  CO-CTL-2.
  1587                 24  CO-ACCOUNT.
  1588                     28  CO-ACCT-PREFIX        PIC X(4).
  1589                     28  CO-ACCT-PRIME         PIC X(6).
  1590         16  CO-TYPE                           PIC X.
  1591             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1592             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1593             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1594
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  30
* EL050.cbl
  1595     12  CO-MAINT-INFORMATION.
  1596         16  CO-LAST-MAINT-DT                  PIC XX.
  1597         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1598         16  CO-LAST-MAINT-USER                PIC X(4).
  1599     12  FILLER                                PIC XX.
  1600     12  CO-STMT-TYPE                          PIC XXX.
  1601     12  CO-COMP-TYPE                          PIC X.
  1602         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1603     12  CO-STMT-OWNER                         PIC X(4).
  1604     12  CO-BALANCE-CONTROL                    PIC X.
  1605         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1606         88  CO-NO-BALANCE                        VALUE 'N'.
  1607
  1608     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1609         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1610         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1611         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1612
  1613     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1614         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1615         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1616
  1617     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1618     12  CO-GA-DIRECT-DEP                      PIC X.
  1619     12  CO-FUTURE-SPACE                       PIC X.
  1620         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1621
  1622     12  CO-ACCT-NAME                          PIC X(30).
  1623     12  CO-MAIL-NAME                          PIC X(30).
  1624     12  CO-ADDR-1                             PIC X(30).
  1625     12  CO-ADDR-2                             PIC X(30).
  1626     12  CO-ADDR-3.
  1627         16  CO-ADDR-CITY                      PIC X(27).
  1628         16  CO-ADDR-STATE                     PIC XX.
  1629     12  CO-CSO-1099                           PIC X.
  1630     12  CO-ZIP.
  1631         16  CO-ZIP-PRIME.
  1632             20  CO-ZIP-PRI-1ST                PIC X.
  1633                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1634             20  FILLER                        PIC X(4).
  1635         16  CO-ZIP-PLUS4                      PIC X(4).
  1636     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1637         16  CO-CAN-POSTAL-1                   PIC XXX.
  1638         16  CO-CAN-POSTAL-2                   PIC XXX.
  1639         16  FILLER                            PIC XXX.
  1640     12  CO-SOC-SEC                            PIC X(13).
  1641     12  CO-TELEPHONE.
  1642         16  CO-AREA-CODE                      PIC XXX.
  1643         16  CO-PREFIX                         PIC XXX.
  1644         16  CO-PHONE                          PIC X(4).
  1645
  1646     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1647
  1648     12  CO-AR-BAL-LEVEL                       PIC X.
  1649         88  CO-AR-REF-LVL                        VALUE '1'.
  1650         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1651         88  CO-AR-BILL-LVL                       VALUE '2'.
  1652         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  31
* EL050.cbl
  1653         88  CO-AR-FR-LVL                         VALUE '4'.
  1654
  1655     12  CO-AR-NORMAL-PRINT                    PIC X.
  1656         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1657         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1658
  1659     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1660
  1661     12  CO-AR-REPORTING                       PIC X.
  1662         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1663         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1664
  1665     12  CO-AR-PULL-CHECK                      PIC X.
  1666         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1667         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1668
  1669     12  CO-AR-BALANCE-PRINT                   PIC X.
  1670         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1671
  1672     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1673         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1674         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1675         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1676
  1677     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1678
  1679     12  CO-USER-CODE                          PIC X.
  1680     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1681
  1682******************************************************************
  1683*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1684*    THE LAST MONTH END RUN.
  1685******************************************************************
  1686
  1687     12  CO-LAST-ACTIVITY-DATE.
  1688         16  CO-ACT-YEAR                       PIC 99.
  1689         16  CO-ACT-MONTH                      PIC 99.
  1690         16  CO-ACT-DAY                        PIC 99.
  1691
  1692     12  CO-LAST-STMT-DT.
  1693         16  CO-LAST-STMT-YEAR                 PIC 99.
  1694         16  CO-LAST-STMT-MONTH                PIC 99.
  1695         16  CO-LAST-STMT-DAY                  PIC 99.
  1696
  1697     12  CO-MO-END-TOTALS.
  1698         16  CO-MONTHLY-TOTALS.
  1699             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1700             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1701             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1702             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1703             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1704
  1705         16  CO-AGING-TOTALS.
  1706             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1707             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1708             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1709             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1710
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  32
* EL050.cbl
  1711         16  CO-YTD-TOTALS.
  1712             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1714
  1715         16  CO-OVER-UNDER-TOTALS.
  1716             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1717             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1718
  1719     12  CO-MISCELLANEOUS-TOTALS.
  1720         16  CO-FICA-TOTALS.
  1721             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1722             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1723
  1724         16  CO-CLAIM-TOTALS.
  1725             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1726             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1727
  1728******************************************************************
  1729*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1730*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1731******************************************************************
  1732
  1733     12  CO-CURRENT-TOTALS.
  1734         16  CO-CURRENT-LAST-STMT-DT.
  1735             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1736             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1737             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1738
  1739         16  CO-CURRENT-MONTHLY-TOTALS.
  1740             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1741             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1743             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1745
  1746         16  CO-CURRENT-AGING-TOTALS.
  1747             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1749             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1751
  1752         16  CO-CURRENT-YTD-TOTALS.
  1753             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1754             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1755
  1756     12  CO-PAID-COMM-TOTALS.
  1757         16  CO-YTD-PAID-COMMS.
  1758             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1759             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1760
  1761     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1762         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1763         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1764
  1765     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1766         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1767         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1768         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  33
* EL050.cbl
  1769         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1770         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1771         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1772         88  CO-FINAL-LETTER                  VALUE 'F'.
  1773         88  CO-RECONCILING                   VALUE 'R'.
  1774         88  CO-PHONE-CALL                    VALUE 'P'.
  1775         88  CO-LEGAL                         VALUE 'L'.
  1776         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1777         88  CO-WRITE-OFF                     VALUE 'W'.
  1778         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1779
  1780     12  CO-CSR-CODE                       PIC X(4).
  1781
  1782     12  CO-GA-STATUS-INFO.
  1783         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1784         16  CO-GA-TERMINATION-DT          PIC XX.
  1785         16  CO-GA-STATUS-CODE             PIC X.
  1786             88  CO-GA-ACTIVE                 VALUE 'A'.
  1787             88  CO-GA-INACTIVE               VALUE 'I'.
  1788             88  CO-GA-PENDING                VALUE 'P'.
  1789         16  CO-GA-COMMENTS.
  1790             20  CO-GA-COMMENT-1           PIC X(40).
  1791             20  CO-GA-COMMENT-2           PIC X(40).
  1792             20  CO-GA-COMMENT-3           PIC X(40).
  1793             20  CO-GA-COMMENT-4           PIC X(40).
  1794
  1795     12  CO-RPTCD2                         PIC X(10).
  1796     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1797         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1798         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1799
  1800     12  CO-TYPE-AGENT                     PIC X(01).
  1801         88  CO-CORPORATION                   VALUE 'C'.
  1802         88  CO-PARTNERSHIP                   VALUE 'P'.
  1803         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1804         88  CO-TRUST                         VALUE 'T'.
  1805         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1806
  1807     12  CO-FAXNO.
  1808         16  CO-FAX-AREA-CODE                  PIC XXX.
  1809         16  CO-FAX-PREFIX                     PIC XXX.
  1810         16  CO-FAX-PHONE                      PIC X(4).
  1811
  1812     12  CO-BANK-INFORMATION.
  1813         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1814         16  CO-BANK-TRANSIT-NON REDEFINES
  1815             CO-BANK-TRANSIT-NO                PIC 9(8).
  1816
  1817         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1818     12  CO-MISC-DEDUCT-INFO REDEFINES
  1819                  CO-BANK-INFORMATION.
  1820         16  CO-MD-GL-ACCT                     PIC X(10).
  1821         16  CO-MD-DIV                         PIC XX.
  1822         16  CO-MD-CENTER                      PIC X(4).
  1823         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1824         16  CO-CREATE-AP-CHECK                PIC X.
  1825         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1826         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  34
* EL050.cbl
  1827     12  CO-ACH-STATUS                         PIC X.
  1828         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1829         88  CO-ACH-PENDING                        VALUE 'P'.
  1830
  1831     12  CO-BILL-SW                            PIC X.
  1832     12  CO-CONTROL-NAME                       PIC X(30).
  1833     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1834     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1835     12  CO-CLP-STATE                          PIC XX.
  1836     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1837     12  CO-SPP-REFUND-EDIT                    PIC X.
  1838
  1839******************************************************************
  1840
  1841*    COPY ERCAGTC.
  1842******************************************************************
  1843*                                                                *
  1844*                                                                *
  1845*                            ERCAGTC                             *
  1846*                            VMOD=2.001                          *
  1847*                                                                *
  1848*   ONLINE CREDIT SYSTEM                                         *
  1849*                                                                *
  1850*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1851*                                                                *
  1852*   FILE TYPE = VSAM,KSDS                                        *
  1853*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1854*                                                                *
  1855*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1856*       ALTERNATE PATH = NONE                                    *
  1857*                                                                *
  1858*   LOG = NO                                                     *
  1859*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1860*                                                                *
  1861******************************************************************
  1862*                   C H A N G E   L O G
  1863*
  1864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1865*-----------------------------------------------------------------
  1866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1867* EFFECTIVE    NUMBER
  1868*-----------------------------------------------------------------
  1869* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1870* 111004                         NEW FILE AND COPYBOOK
  1871* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1872******************************************************************
  1873 01  AGENT-COMMISSIONS.
  1874     12  AG-RECORD-ID                          PIC XX.
  1875         88  VALID-CO-ID                          VALUE 'AG'.
  1876     12  AG-CONTROL-PRIMARY.
  1877         16  AG-COMPANY-CD                     PIC X.
  1878         16  AG-CONTROL.
  1879             20  AG-CTL-1.
  1880                 24  AG-CARR-GROUP.
  1881                     28  AG-CARRIER            PIC X.
  1882                     28  AG-GROUPING           PIC X(6).
  1883                 24  AG-BANK                   PIC X(10).
  1884             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  35
* EL050.cbl
  1885                 24  AG-EXP-DT                 PIC XX.
  1886         16  AG-TYPE                           PIC X.
  1887             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1888             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1889     12  AG-MAINT-INFORMATION.
  1890         16  AG-LAST-MAINT-DT                  PIC XX.
  1891         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1892         16  AG-LAST-MAINT-USER                PIC X(4).
  1893         16  FILLER                            PIC X(10).
  1894     12  AG-EFF-DT                             PIC XX.
  1895     12  AG-COMM-STRUCTURE.
  1896         16  AG-AGT-COMMS OCCURS 10.
  1897             20  AG-AGT                PIC X(10).
  1898             20  AG-COM-TYP            PIC X.
  1899             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1900             20  AG-RECALC-LV-INDIC    PIC X.
  1901             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1902             20  AG-LRCALC-LV-INDIC    PIC X.
  1903             20  FILLER                PIC X(05).
  1904     12  FILLER                  PIC X(145).
  1905******************************************************************
  1906*    COPY ERCRESS.
  1907******************************************************************
  1908*                                                                *
  1909*                            ERCRESS                             *
  1910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1911*                            VMOD=2.002                          *
  1912*                                                                *
  1913*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1914*                                                                *
  1915*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1916*   VSAM RESIDENT STATE TAX MASTER                              *
  1917*                                                                *
  1918*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1919*                                                                *
  1920*   FILE TYPE = VSAM,KSDS                                        *
  1921*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1922*                                                                *
  1923*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1924*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1925*                                                                *
  1926*   LOG = NO                                                     *
  1927*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1928*                                                                *
  1929*                                                                *
  1930******************************************************************
  1931
  1932 01  RESIDENT-STATE-TAX-MASTER.
  1933
  1934     10  ERRESS-PRIMARY-KEY.
  1935         15  RES-COMPANY-CD        PIC X.
  1936         15  RES-RESIDENT-STATE    PIC XX.
  1937         15  RES-COVERAGE-CATEGORY PIC X.
  1938         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1939*                                      YYYYMMDD
  1940*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1941
  1942     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  36
* EL050.cbl
  1943
  1944         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1945         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1946         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1947         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1948
  1949     10 RES-RECALC-SW              PIC   X.
  1950         88 RECALC                VALUE 'Y'.
  1951         88 NO-RECALC             VALUE 'N'.
  1952     10  RES-MAINT-BY              PIC X(4).
  1953     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1954     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1955*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  37
* EL050.cbl
  1957*    COPY ERCRESC.
  1958******************************************************************
  1959*                                                                *
  1960*                            ERCRESC                             *
  1961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1962*                            VMOD=2.003                          *
  1963*                                                                *
  1964*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1965*                                                                *
  1966*   FILE TYPE = VSAM,KSDS                                        *
  1967*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1968*                                                                *
  1969*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1970*       ALTERNATE PATH1 = NONE                                   *
  1971*                                                                *
  1972*   LOG = NO                                                     *
  1973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1974*                                                                *
  1975******************************************************************
  1976
  1977 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1978
  1979     10  ERRESC-RECORD-KEY.
  1980         15  RESC-COMPANY-CD           PIC   X.
  1981         15  RESC-CARRIER              PIC   X.
  1982         15  RESC-GROUP                PIC   X(6).
  1983         15  RESC-STATE                PIC   XX.
  1984         15  RESC-ACCOUNT              PIC   X(10).
  1985         15  RESC-AGENT                PIC   X(10).
  1986         15  RESC-RESIDENT-STATE       PIC   XX.
  1987         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1988*                                           YYYYMMDD
  1989     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1990
  1991     10  RESC-COMM-RECORD-DATA.
  1992         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1993             20 RESC-COVERAGE-CAT      PIC    X.
  1994             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1995             20 RESC-COMMISSION-TAB REDEFINES
  1996                RESC-COMMISSION-PER    PIC  XXX.
  1997
  1998     10  RESC-MAINT-BY                 PIC X(4).
  1999     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  2000     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  2001*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  38
* EL050.cbl
  2003*    COPY ERCPLAN.
  2004******************************************************************
  2005*                                                                *
  2006*                                                                *
  2007*                            ERCPLAN                             *
  2008*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2009*                            VMOD=2.003                          *
  2010*                                                                *
  2011*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2012*                                                                *
  2013*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2014*   PLAN MASTER                                                  *
  2015*                                                                *
  2016*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2017*                                                                *
  2018*   FILE TYPE = VSAM,KSDS                                        *
  2019*   RECORD SIZE = 420   RECFORM = FIX                            *
  2020*                                                                *
  2021*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2022*       ALTERNATE PATH1 = N/A                                    *
  2023*                                                                *
  2024*   LOG = NO                                                     *
  2025*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2026*                                                                *
  2027*                                                                *
  2028******************************************************************
  2029
  2030 01  PLAN-MASTER.
  2031     12  PL-RECORD-ID                      PIC XX.
  2032         88  VALID-PL-ID                      VALUE 'PL'.
  2033
  2034     12  PL-CONTROL-PRIMARY.
  2035         16  PL-COMPANY-CD                 PIC X.
  2036         16  PL-MSTR-CNTRL.
  2037             20  PL-CONTROL-A.
  2038                 24  PL-CARRIER            PIC X.
  2039                 24  PL-GROUPING           PIC X(6).
  2040                 24  PL-STATE              PIC XX.
  2041                 24  PL-ACCOUNT            PIC X(10).
  2042             20  PL-BENEFIT-TYPE           PIC X.
  2043             20  PL-BENEFIT-CODE           PIC XX.
  2044             20  PL-REVISION-NO            PIC X(3).
  2045
  2046     12  PL-CONTROL-BY-VAR-GRP.
  2047         16  PL-COMPANY-CD-A1              PIC X.
  2048         16  PL-VG-CARRIER                 PIC X.
  2049         16  PL-VG-GROUPING                PIC X(6).
  2050         16  PL-VG-STATE                   PIC XX.
  2051         16  PL-VG-ACCOUNT                 PIC X(10).
  2052         16  PL-BENEFIT-TYPE-A1            PIC X.
  2053         16  PL-BENEFIT-CODE-A1            PIC XX.
  2054         16  PL-REVISION-NO-A1             PIC 999.
  2055
  2056     12  PL-MAINT-INFORMATION.
  2057         16  PL-LAST-MAINT-DT              PIC XX.
  2058         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2059         16  PL-LAST-MAINT-USER            PIC X(4).
  2060         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  39
* EL050.cbl
  2061
  2062     12  PL-LIABILITY-LIMITS.
  2063         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2064         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2065             20  PL-LM-AGE                 PIC S99        COMP-3.
  2066             20  PL-LM-DUR                 PIC S999       COMP-3.
  2067             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2068             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2069
  2070     12  FILLER                            PIC X(30).
  2071
  2072     12  PL-GL-ACCOUNT-NOS.
  2073         16  PL-PREMIUM-GL                 PIC X(8).
  2074         16  PL-COMM-GL                    PIC X(8).
  2075         16  PL-CLAIM-GL                   PIC X(8).
  2076     12  FILLER                            PIC X(24).
  2077     12  PL-TOLERANCES.
  2078         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2079         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2080         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2081         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2082         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2083         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2084     12  PL-OVER-SHORT.
  2085         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2086         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2087     12  FILLER                            PIC X(24).
  2088     12  PLAN-MISC.
  2089         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2090         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2091         16  PL-IG                         PIC X.
  2092         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2093         16  PL-POLICY-FORM                PIC X(12).
  2094         16  PL-EDIT-FOR-FORM              PIC X(01).
  2095         16  PL-DEV-CODE                   PIC XXX.
  2096         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2097         16  PL-CALC-METHOD                PIC X.
  2098         16  PL-BENEFIT-GROUP              PIC X(05).
  2099         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2100
  2101         16  FILLER                        PIC X(99).
  2102******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  40
* EL050.cbl
  2104*    COPY ELCCERT.
  2105******************************************************************
  2106*                                                                *
  2107*                            ELCCERT.                            *
  2108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2109*                            VMOD=2.013                          *
  2110*                                                                *
  2111*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2112*                                                                *
  2113*   FILE TYPE = VSAM,KSDS                                        *
  2114*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2115*                                                                *
  2116*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2117*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2118*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2119*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2120*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2121*                                                                *
  2122*   LOG = YES                                                    *
  2123*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2124******************************************************************
  2125*                   C H A N G E   L O G
  2126*
  2127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2128*-----------------------------------------------------------------
  2129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2130* EFFECTIVE    NUMBER
  2131*-----------------------------------------------------------------
  2132* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2133* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2134* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2135* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2136* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2137* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2138* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2139* 032612  CR2011110200001  PEMA  AHL CHANGES
  2140* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2141* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2142******************************************************************
  2143
  2144 01  CERTIFICATE-MASTER.
  2145     12  CM-RECORD-ID                      PIC XX.
  2146         88  VALID-CM-ID                      VALUE 'CM'.
  2147
  2148     12  CM-CONTROL-PRIMARY.
  2149         16  CM-COMPANY-CD                 PIC X.
  2150         16  CM-CARRIER                    PIC X.
  2151         16  CM-GROUPING.
  2152             20  CM-GROUPING-PREFIX        PIC X(3).
  2153             20  CM-GROUPING-PRIME         PIC X(3).
  2154         16  CM-STATE                      PIC XX.
  2155         16  CM-ACCOUNT.
  2156             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2157             20  CM-ACCOUNT-PRIME          PIC X(6).
  2158         16  CM-CERT-EFF-DT                PIC XX.
  2159         16  CM-CERT-NO.
  2160             20  CM-CERT-PRIME             PIC X(10).
  2161             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  41
* EL050.cbl
  2162
  2163     12  CM-CONTROL-BY-NAME.
  2164         16  CM-COMPANY-CD-A1              PIC X.
  2165         16  CM-INSURED-LAST-NAME          PIC X(15).
  2166         16  CM-INSURED-INITIALS.
  2167             20  CM-INSURED-INITIAL1       PIC X.
  2168             20  CM-INSURED-INITIAL2       PIC X.
  2169
  2170     12  CM-CONTROL-BY-SSN.
  2171         16  CM-COMPANY-CD-A2              PIC X.
  2172         16  CM-SOC-SEC-NO.
  2173             20  CM-SSN-STATE              PIC XX.
  2174             20  CM-SSN-ACCOUNT            PIC X(6).
  2175             20  CM-SSN-LN3.
  2176                 25  CM-INSURED-INITIALS-A2.
  2177                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2178                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2179                 25 CM-PART-LAST-NAME-A2         PIC X.
  2180
  2181     12  CM-CONTROL-BY-CERT-NO.
  2182         16  CM-COMPANY-CD-A4              PIC X.
  2183         16  CM-CERT-NO-A4                 PIC X(11).
  2184
  2185     12  CM-CONTROL-BY-MEMB.
  2186         16  CM-COMPANY-CD-A5              PIC X.
  2187         16  CM-MEMBER-NO.
  2188             20  CM-MEMB-STATE             PIC XX.
  2189             20  CM-MEMB-ACCOUNT           PIC X(6).
  2190             20  CM-MEMB-LN4.
  2191                 25  CM-INSURED-INITIALS-A5.
  2192                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2193                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2194                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2195
  2196     12  CM-INSURED-PROFILE-DATA.
  2197         16  CM-INSURED-FIRST-NAME.
  2198             20  CM-INSURED-1ST-INIT       PIC X.
  2199             20  FILLER                    PIC X(9).
  2200         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2201         16  CM-INSURED-SEX                PIC X.
  2202             88  CM-SEX-MALE                  VALUE 'M'.
  2203             88  CM-SEX-FEMAL                 VALUE 'F'.
  2204         16  CM-INSURED-JOINT-AGE          PIC 99.
  2205         16  CM-JOINT-INSURED-NAME.
  2206             20  CM-JT-LAST-NAME           PIC X(15).
  2207             20  CM-JT-FIRST-NAME.
  2208                 24  CM-JT-1ST-INIT        PIC X.
  2209                 24  FILLER                PIC X(9).
  2210             20  CM-JT-INITIAL             PIC X.
  2211
  2212     12  CM-LIFE-DATA.
  2213         16  CM-LF-BENEFIT-CD              PIC XX.
  2214         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2215         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2216         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2217         16  CM-LF-DEV-CODE                PIC XXX.
  2218         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2219         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  42
* EL050.cbl
  2220         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2223         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2224         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2225         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2226         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2227         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2228         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2229         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2230         16  cm-temp-epiq                  pic xx.
  2231             88  EPIQ-CLASS                  value 'EQ'.
  2232*        16  FILLER                        PIC XX.
  2233
  2234     12  CM-AH-DATA.
  2235         16  CM-AH-BENEFIT-CD              PIC XX.
  2236         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2237         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2238         16  CM-AH-DEV-CODE                PIC XXX.
  2239         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2240         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2241         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2242         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2243         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2244         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2245         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2246         16  CM-AH-PAID-THRU-DT            PIC XX.
  2247             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2248         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2249         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  2250         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2251         16  FILLER                        PIC X.
  2252
  2253     12  CM-LOAN-INFORMATION.
  2254         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2255         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2256                                           PIC S9(5)V99  COMP-3.
  2257         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2258         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2259         16  CM-PAY-FREQUENCY              PIC S99.
  2260         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2261         16  CM-RATE-CLASS                 PIC XX.
  2262         16  CM-BENEFICIARY                PIC X(25).
  2263         16  CM-POLICY-FORM-NO             PIC X(12).
  2264         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2265         16  CM-LAST-ADD-ON-DT             PIC XX.
  2266         16  CM-DEDUCTIBLE-AMOUNTS.
  2267             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2268             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2269         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2270             20  CM-RESIDENT-STATE         PIC XX.
  2271             20  CM-RATE-CODE              PIC X(4).
  2272             20  FILLER                    PIC XX.
  2273         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2274             20  CM-LOAN-OFFICER           PIC X(5).
  2275             20  FILLER                    PIC XXX.
  2276         16  CM-CSR-CODE                   PIC XXX.
  2277         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  43
* EL050.cbl
  2278             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2279         16  CM-POST-CARD-IND              PIC X.
  2280         16  CM-NH-INTERFACE-SW            PIC X.
  2281         16  CM-PREMIUM-TYPE               PIC X.
  2282             88  CM-SING-PRM                  VALUE '1'.
  2283             88  CM-O-B-COVERAGE              VALUE '2'.
  2284             88  CM-OPEN-END                  VALUE '3'.
  2285         16  CM-IND-GRP-TYPE               PIC X.
  2286             88  CM-INDIVIDUAL                VALUE 'I'.
  2287             88  CM-GROUP                     VALUE 'G'.
  2288         16  CM-SKIP-CODE                  PIC X.
  2289             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2290             88  SKIP-JULY                    VALUE '1'.
  2291             88  SKIP-AUGUST                  VALUE '2'.
  2292             88  SKIP-SEPTEMBER               VALUE '3'.
  2293             88  SKIP-JULY-AUG                VALUE '4'.
  2294             88  SKIP-AUG-SEPT                VALUE '5'.
  2295             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2296             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2297             88  SKIP-JUNE                    VALUE '8'.
  2298             88  SKIP-JUNE-JULY               VALUE '9'.
  2299             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2300             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2301         16  CM-PAYMENT-MODE               PIC X.
  2302             88  PAY-MONTHLY                  VALUE SPACE.
  2303             88  PAY-WEEKLY                   VALUE '1'.
  2304             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2305             88  PAY-BI-WEEKLY                VALUE '3'.
  2306             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2307         16  CM-LOAN-NUMBER                PIC X(8).
  2308         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2309         16  CM-OLD-LOF                    PIC XXX.
  2310*        16  CM-LOAN-OFFICER               PIC XXX.
  2311         16  CM-REIN-TABLE                 PIC XXX.
  2312         16  CM-SPECIAL-REIN-CODE          PIC X.
  2313         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2314         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2315         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2316
  2317     12  CM-STATUS-DATA.
  2318         16  CM-ENTRY-STATUS               PIC X.
  2319         16  CM-ENTRY-DT                   PIC XX.
  2320
  2321         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2322         16  CM-LF-CANCEL-DT               PIC XX.
  2323         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2324
  2325         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2326         16  CM-LF-DEATH-DT                PIC XX.
  2327         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2328
  2329         16  CM-LF-CURRENT-STATUS          PIC X.
  2330             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2331                                                'M' '4' '5' '9'.
  2332             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2333             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2334             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2335             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  44
* EL050.cbl
  2336             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2337             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2338             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2339             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2340             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2341             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2342             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2343             88  CM-LF-DECLINED               VALUE 'D'.
  2344             88  CM-LF-VOIDED                 VALUE 'V'.
  2345
  2346         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2347         16  CM-AH-CANCEL-DT               PIC XX.
  2348         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2349
  2350         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2351         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2352         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2353
  2354         16  CM-AH-CURRENT-STATUS          PIC X.
  2355             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2356                                                'M' '4' '5' '9'.
  2357             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2358             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2359             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2360             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2361             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2362             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2363             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2364             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2365             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2366             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2367             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2368             88  CM-AH-DECLINED               VALUE 'D'.
  2369             88  CM-AH-VOIDED                 VALUE 'V'.
  2370
  2371         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2372             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2373             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2374             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2375         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2376
  2377         16  CM-ENTRY-BATCH                PIC X(6).
  2378         16  CM-LF-EXIT-BATCH              PIC X(6).
  2379         16  CM-AH-EXIT-BATCH              PIC X(6).
  2380         16  CM-LAST-MONTH-END             PIC XX.
  2381
  2382     12  CM-NOTE-SW                        PIC X.
  2383         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2384         88  CERT-NOTES-PRESENT               VALUE '1'.
  2385         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2386         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2387         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2388         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2389         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2390         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2391     12  CM-COMP-EXCP-SW                   PIC X.
  2392         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2393         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  45
* EL050.cbl
  2394     12  CM-INSURED-ADDRESS-SW             PIC X.
  2395         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2396         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2397
  2398*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2399     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2400     12  FILLER                            PIC X.
  2401
  2402*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2403     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2404     12  FILLER                            PIC X.
  2405*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2406     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2407
  2408     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2409         88  CERT-ADDED-BATCH                 VALUE ' '.
  2410         88  CERT-ADDED-ONLINE                VALUE '1'.
  2411         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2412         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2413         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2414     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2415         88  CERT-AS-LOADED                   VALUE ' '.
  2416         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2417         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2418         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2419         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2420         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2421         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2422         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2423
  2424     12  CM-ACCOUNT-COMM-PCTS.
  2425         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2426         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2427
  2428     12  CM-USER-FIELD                     PIC X.
  2429     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2430     12  CM-CLP-STATE                      PIC XX.
  2431     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2432     12  CM-USER-RESERVED                  PIC XXX.
  2433     12  FILLER REDEFINES CM-USER-RESERVED.
  2434         16  CM-AH-CLASS-CD                PIC XX.
  2435         16  F                             PIC X.
  2436******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  46
* EL050.cbl
  2438*    COPY ERCMAIL.
  2439******************************************************************
  2440*                                                                *
  2441*                                                                *
  2442*                            ERCMAIL                             *
  2443*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2444*                            VMOD=2.003                          *
  2445*                                                                *
  2446*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2447*                                                                *
  2448*   FILE TYPE = VSAM,KSDS                                        *
  2449*   RECORD SIZE = 374   RECFORM = FIX                            *
  2450*                                                                *
  2451*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2452*   ALTERNATE PATH    = NOT USED                                 *
  2453*                                                                *
  2454*   LOG = YES                                                    *
  2455*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2456******************************************************************
  2457*                   C H A N G E   L O G
  2458*
  2459* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2460*-----------------------------------------------------------------
  2461*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2462* EFFECTIVE    NUMBER
  2463*-----------------------------------------------------------------
  2464* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2465* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2466* 111108                   PEMA  ADD CRED BENE ADDR2
  2467******************************************************************
  2468
  2469 01  MAILING-DATA.
  2470     12  MA-RECORD-ID                      PIC XX.
  2471         88  VALID-MA-ID                       VALUE 'MA'.
  2472
  2473     12  MA-CONTROL-PRIMARY.
  2474         16  MA-COMPANY-CD                 PIC X.
  2475         16  MA-CARRIER                    PIC X.
  2476         16  MA-GROUPING.
  2477             20  MA-GROUPING-PREFIX        PIC XXX.
  2478             20  MA-GROUPING-PRIME         PIC XXX.
  2479         16  MA-STATE                      PIC XX.
  2480         16  MA-ACCOUNT.
  2481             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2482             20  MA-ACCOUNT-PRIME          PIC X(6).
  2483         16  MA-CERT-EFF-DT                PIC XX.
  2484         16  MA-CERT-NO.
  2485             20  MA-CERT-PRIME             PIC X(10).
  2486             20  MA-CERT-SFX               PIC X.
  2487
  2488     12  FILLER                            PIC XX.
  2489
  2490     12  MA-ACCESS-CONTROL.
  2491         16  MA-SOURCE-SYSTEM              PIC XX.
  2492             88  MA-FROM-CREDIT                VALUE 'CR'.
  2493             88  MA-FROM-VSI                   VALUE 'VS'.
  2494             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2495             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  47
* EL050.cbl
  2496         16  MA-RECORD-ADD-DT              PIC XX.
  2497         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2498         16  MA-LAST-MAINT-DT              PIC XX.
  2499         16  MA-LAST-MAINT-BY              PIC XXXX.
  2500         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2501
  2502     12  MA-PROFILE-INFO.
  2503         16  MA-QUALIFY-CODE-1             PIC XX.
  2504         16  MA-QUALIFY-CODE-2             PIC XX.
  2505         16  MA-QUALIFY-CODE-3             PIC XX.
  2506         16  MA-QUALIFY-CODE-4             PIC XX.
  2507         16  MA-QUALIFY-CODE-5             PIC XX.
  2508
  2509         16  MA-INSURED-LAST-NAME          PIC X(15).
  2510         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2511         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2512         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2513         16  MA-INSURED-BIRTH-DT           PIC XX.
  2514         16  MA-INSURED-SEX                PIC X.
  2515             88  MA-SEX-MALE                   VALUE 'M'.
  2516             88  MA-SEX-FEMALE                 VALUE 'F'.
  2517         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2518
  2519         16  MA-ADDRESS-CORRECTED          PIC X.
  2520         16  MA-JOINT-BIRTH-DT             PIC XX.
  2521*        16  FILLER                        PIC X(12).
  2522
  2523         16  MA-ADDRESS-LINE-1             PIC X(30).
  2524         16  MA-ADDRESS-LINE-2             PIC X(30).
  2525         16  MA-CITY-STATE.
  2526             20  MA-CITY                   PIC X(28).
  2527             20  MA-ADDR-STATE             PIC XX.
  2528         16  MA-ZIP.
  2529             20  MA-ZIP-CODE.
  2530                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2531                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2532                 24  FILLER                PIC X(4).
  2533             20  MA-ZIP-PLUS4              PIC X(4).
  2534         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2535             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2536             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2537             20  FILLER                    PIC X(3).
  2538
  2539         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2540
  2541         16  FILLER                        PIC XXX.
  2542*        16  FILLER                        PIC X(10).
  2543
  2544     12  MA-CRED-BENE-INFO.
  2545         16  MA-CRED-BENE-NAME                 PIC X(25).
  2546         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2547         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2548         16  MA-CRED-BENE-CTYST.
  2549             20  MA-CRED-BENE-CITY             PIC X(28).
  2550             20  MA-CRED-BENE-STATE            PIC XX.
  2551         16  MA-CRED-BENE-ZIP.
  2552             20  MA-CB-ZIP-CODE.
  2553                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  48
* EL050.cbl
  2554                     88  MA-CB-CANADIAN-POST-CODE
  2555                                           VALUE 'A' THRU 'Z'.
  2556                 24  FILLER                    PIC X(4).
  2557             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2558         16  MA-CB-CANADIAN-POSTAL-CODE
  2559                            REDEFINES MA-CRED-BENE-ZIP.
  2560             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2561             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2562             20  FILLER                        PIC X(3).
  2563     12  MA-POST-CARD-MAIL-DATA.
  2564         16  MA-MAIL-DATA OCCURS 7.
  2565             20  MA-MAIL-TYPE              PIC X.
  2566                 88  MA-12MO-MAILING           VALUE '1'.
  2567                 88  MA-EXP-MAILING            VALUE '2'.
  2568             20  MA-MAIL-STATUS            PIC X.
  2569                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2570                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2571                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2572             20  MA-MAIL-DATE              PIC XX.
  2573     12  FILLER                            PIC XX.
  2574     12  FILLER                            PIC XX.
  2575*    12  FILLER                            PIC X(30).
  2576******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  49
* EL050.cbl
  2578*    COPY ERCPNDM.
  2579******************************************************************
  2580*                                                                *
  2581*                                                                *
  2582*                            ERCPNDM                             *
  2583*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2584*                            VMOD=2.003                          *
  2585*                                                                *
  2586*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2587*                                                                *
  2588*   FILE TYPE = VSAM,KSDS                                        *
  2589*   RECORD SIZE = 374   RECFORM = FIX                            *
  2590*                                                                *
  2591*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2592*   ALTERNATE PATH    = NOT USED                                 *
  2593*                                                                *
  2594*   LOG = YES                                                    *
  2595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2596******************************************************************
  2597*                   C H A N G E   L O G
  2598*
  2599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2600*-----------------------------------------------------------------
  2601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2602* EFFECTIVE    NUMBER
  2603*-----------------------------------------------------------------
  2604* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2605* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2606* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2607******************************************************************
  2608
  2609 01  PENDING-MAILING-DATA.
  2610     12  PM-RECORD-ID                      PIC XX.
  2611         88  VALID-MA-ID                       VALUE 'PM'.
  2612
  2613     12  PM-CONTROL-PRIMARY.
  2614         16  PM-COMPANY-CD                 PIC X.
  2615         16  PM-ENTRY-BATCH                PIC X(6).
  2616         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2617         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2618
  2619     12  FILLER                            PIC X(14).
  2620
  2621     12  PM-ACCESS-CONTROL.
  2622         16  PM-SOURCE-SYSTEM              PIC XX.
  2623             88  PM-FROM-CREDIT                VALUE 'CR'.
  2624             88  PM-FROM-VSI                   VALUE 'VS'.
  2625             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2626             88  PM-FROM-OTHER                 VALUE 'OT'.
  2627         16  PM-RECORD-ADD-DT              PIC XX.
  2628         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2629         16  PM-LAST-MAINT-DT              PIC XX.
  2630         16  PM-LAST-MAINT-BY              PIC XXXX.
  2631         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2632
  2633     12  PM-PROFILE-INFO.
  2634         16  PM-QUALIFY-CODE-1             PIC XX.
  2635         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  50
* EL050.cbl
  2636         16  PM-QUALIFY-CODE-3             PIC XX.
  2637         16  PM-QUALIFY-CODE-4             PIC XX.
  2638         16  PM-QUALIFY-CODE-5             PIC XX.
  2639
  2640         16  PM-INSURED-LAST-NAME          PIC X(15).
  2641         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2642         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2643         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2644         16  PM-INSURED-BIRTH-DT           PIC XX.
  2645         16  PM-INSURED-SEX                PIC X.
  2646             88  PM-SEX-MALE                   VALUE 'M'.
  2647             88  PM-SEX-FEMALE                 VALUE 'F'.
  2648         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2649
  2650         16  PM-ADDRESS-CORRECTED          PIC X.
  2651         16  PM-JOINT-BIRTH-DT             PIC XX.
  2652*        16  FILLER                        PIC X(12).
  2653
  2654         16  PM-ADDRESS-LINE-1             PIC X(30).
  2655         16  PM-ADDRESS-LINE-2             PIC X(30).
  2656         16  PM-CITY-STATE.
  2657             20  PM-CITY                   PIC X(28).
  2658             20  PM-STATE                  PIC XX.
  2659         16  PM-ZIP.
  2660             20  PM-ZIP-CODE.
  2661                 24  PM-ZIP-1              PIC X.
  2662                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2663                 24  FILLER                PIC X(4).
  2664             20  PM-ZIP-PLUS4              PIC X(4).
  2665         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2666             20  PM-CAN-POST1              PIC XXX.
  2667             20  PM-CAN-POST2              PIC XXX.
  2668             20  FILLER                    PIC XXX.
  2669
  2670         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2671
  2672         16  FILLER                        PIC X(03).
  2673
  2674     12  PM-CRED-BENE-INFO.
  2675         16  PM-CRED-BENE-NAME             PIC X(25).
  2676         16  PM-CRED-BENE-ADDR             PIC X(30).
  2677         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2678         16  PM-CRED-BENE-CTYST.
  2679             20  PM-CRED-BENE-CITY         PIC X(28).
  2680             20  PM-CRED-BENE-STATE        PIC XX.
  2681         16  PM-CRED-BENE-ZIP.
  2682             20  PM-CB-ZIP-CODE.
  2683                 24  PM-CB-ZIP-1           PIC X.
  2684                     88  PM-CB-CANADIAN-POST-CODE
  2685                                  VALUE 'A' THRU 'Z'.
  2686                 24  FILLER                PIC X(4).
  2687             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2688         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2689             20  PM-CB-CAN-POST1           PIC XXX.
  2690             20  PM-CB-CAN-POST2           PIC XXX.
  2691             20  FILLER                    PIC XXX.
  2692     12  PM-POST-CARD-MAIL-DATA.
  2693         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  51
* EL050.cbl
  2694             20  PM-MAIL-TYPE              PIC X.
  2695                 88  PM-12MO-MAILING           VALUE '1'.
  2696                 88  PM-EXP-MAILING            VALUE '2'.
  2697             20  PM-MAIL-STATUS            PIC X.
  2698                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2699                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2700                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2701             20  PM-MAIL-DATE              PIC XX.
  2702     12  FILLER                            PIC XX.
  2703     12  FILLER                            PIC X(12).
  2704*    12  FILLER                            PIC X(30).
  2705
  2706******************************************************************
  2707*                                COPY ERCLOFC.
  2708******************************************************************
  2709*                                                                *
  2710*                                                                *
  2711*                            ERCLOFC                             *
  2712*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2713*                            VMOD=2.003                          *
  2714*                                                                *
  2715*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2716*                                                                *
  2717*   FILE TYPE = VSAM,KSDS                                        *
  2718*   RECORD SIZE = 670   RECFORM = FIX                            *
  2719*                                                                *
  2720*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2721*                                                                *
  2722*   LOG = YES                                                    *
  2723*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2724*                                                                *
  2725******************************************************************
  2726
  2727 01  LOAN-OFFICER-MASTER.
  2728     12  LO-RECORD-ID                PIC XX.
  2729         88  VALID-LO-ID                VALUE 'LO'.
  2730
  2731     12  LO-CONTROL-PRIMARY.
  2732         16  LO-COMPANY-CD           PIC X.
  2733         16  LO-CARRIER              PIC X.
  2734         16  LO-GROUPING.
  2735             20  LO-GROUPING-PREFIX  PIC XXX.
  2736             20  LO-GROUPING-PRIME   PIC XXX.
  2737         16  LO-STATE                PIC XX.
  2738         16  LO-ACCOUNT.
  2739             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2740             20  LO-ACCOUNT-PRIME    PIC X(6).
  2741         16  LO-OFFICER-CODE         PIC X(5).
  2742
  2743     12  LO-OFFICER-NAME             PIC X(30).
  2744
  2745     12  LO-LAST-MAINT-DT            PIC XX.
  2746     12  LO-LAST-USER                PIC X(4).
  2747     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2748
  2749     12  LO-COMP-CONTROL             PIC X.
  2750             88  LO-SHOW-COMP           VALUE 'Y'.
  2751             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  52
* EL050.cbl
  2752     12  LO-DETAIL-CONTROL           PIC X.
  2753             88  LO-PRINT-DETAIL        VALUE 'D'.
  2754             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2755
  2756     12  LO-SV-CARRIER               PIC X.
  2757     12  LO-SV-GROUPING              PIC X(6).
  2758     12  LO-SV-STATE                 PIC XX.
  2759
  2760     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2761     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2762
  2763     12  LO-OFFICER-INFO.
  2764         16  FILLER OCCURS 12 TIMES.
  2765             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2766             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2767             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2768             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2769             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2770             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2771             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2772             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2773     12  FILLER                      PIC X(198).
  2774******************************************************************
  2775*                                COPY ERCPDEF.
  2776******************************************************************
  2777*                                                                *
  2778*                                                                *
  2779*                            ERCPDEF.                            *
  2780*                                                                *
  2781*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2782*                                                                *
  2783*    FILE TYPE = VSAM,KSDS                                       *
  2784*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2785*                                                                *
  2786*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2787*                                                                *
  2788*    LOG = YES                                                   *
  2789*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2790******************************************************************
  2791*                   C H A N G E   L O G
  2792*
  2793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2794*-----------------------------------------------------------------
  2795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2796* EFFECTIVE    NUMBER
  2797*-----------------------------------------------------------------
  2798* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2799* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2800* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2801******************************************************************
  2802 01  PRODUCT-MASTER.
  2803    12  PD-RECORD-ID                 PIC X(02).
  2804        88  VALID-PD-ID                  VALUE 'PD'.
  2805    12  PD-CONTROL-PRIMARY.
  2806        16  PD-COMPANY-CD            PIC X.
  2807        16  PD-STATE                 PIC XX.
  2808        16  PD-PRODUCT-CD            PIC XXX.
  2809        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  53
* EL050.cbl
  2810        16  PD-BEN-TYPE              PIC X.
  2811        16  PD-BEN-CODE              PIC XX.
  2812        16  PD-PROD-EXP-DT           PIC XX.
  2813    12  FILLER                       PIC X(50).
  2814    12  PD-PRODUCT-DATA OCCURS 8.
  2815        16  PD-PROD-CODE             PIC X.
  2816            88  PD-PROD-LIFE           VALUE 'L'.
  2817            88  PD-PROD-PROP           VALUE 'P'.
  2818            88  PD-PROD-AH             VALUE 'A'.
  2819            88  PD-PROD-IU             VALUE 'I'.
  2820            88  PD-PROD-GAP            VALUE 'G'.
  2821            88  PD-PROD-FAML           VALUE 'F'.
  2822        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2823        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2824        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2825        16  PD-MAX-TERM              PIC S999        COMP-3.
  2826        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2827        16  FILLER                   PIC X.
  2828        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2829        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2830        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2831        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2832        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2833        16  PD-REC-CRIT-PERIOD       PIC 99.
  2834        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2835            20  PD-RECURRING-YN      PIC X.
  2836            20  FILLER               PIC X.
  2837        16  PD-RTW-MOS               PIC 99.
  2838        16  PD-MAX-EXTENSION         PIC 99.
  2839        16  pd-ben-pct               pic sv999 comp-3.
  2840*       16  FILLER                   PIC XX.
  2841    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2842    12  PD-TERM-LIMITS OCCURS 15.
  2843        16  PD-LOW-TERM              PIC S999        COMP-3.
  2844        16  PD-HI-TERM               PIC S999        COMP-3.
  2845*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2846    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2847        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2848        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2849    12  PD-EARN-FACTORS.
  2850        16  FILLER OCCURS 15.
  2851            20  FILLER OCCURS 15.
  2852                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2853    12  PD-PRODUCT-DESC              PIC X(80).
  2854    12  PD-TRUNCATED                 PIC X.
  2855    12  FILLER                       PIC X(59).
  2856    12  PD-MAINT-INFORMATION.
  2857        16  PD-LAST-MAINT-DT         PIC X(02).
  2858        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2859        16  PD-LAST-MAINT-BY         PIC X(04).
  2860*                                COPY ELCSTATE.
  2861******************************************************************
  2862*                                                                *
  2863*                                                                *
  2864*                            ELCSTATE.                           *
  2865*                                                                *
  2866*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2867*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  54
* EL050.cbl
  2868*   FILE TYPE = VSAM,KSDS                                        *
  2869*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2870*                                                                *
  2871*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2872*       ALTERNATE INDEX = NONE                                   *
  2873*                                                                *
  2874*   LOG = YES                                                    *
  2875*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2876******************************************************************
  2877*                   C H A N G E   L O G
  2878*
  2879* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2880*-----------------------------------------------------------------
  2881*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2882* EFFECTIVE    NUMBER
  2883*-----------------------------------------------------------------
  2884* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2885******************************************************************
  2886*
  2887 01  STATE-FILE.
  2888     12  SF-RECORD-ID                       PIC XX.
  2889         88  VALID-CF-ID                        VALUE 'SF'.
  2890     12  SF-CONTROL-PRIMARY.
  2891         16  SF-COMPANY-ID                  PIC XXX.
  2892         16  SF-CARRIER-CODE                PIC X.
  2893         16  SF-GROUPING                    PIC X(6).
  2894         16  SF-STATE-CODE                  PIC XX.
  2895         16  SF-EXPIRE-DATE                 PIC 9(8).
  2896****************************************************************
  2897*             STATE CONTROLS
  2898****************************************************************
  2899     12  SF-LAST-MAINT-DT                   PIC XX.
  2900     12  SF-LAST-MAINT-BY                   PIC X(4).
  2901     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2902     12  SF-STATE-RT-CONTROLS.
  2903         16  SF-ST-RT-CALC                  PIC X.
  2904     12  SF-ST-TAX-CONTROLS.
  2905         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2906         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2907         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2908     12  SF-ST-REFUND-OPTIONS.
  2909         16  SF-ST-RF-LR-CALC               PIC X.
  2910         16  SF-ST-RF-LL-CALC               PIC X.
  2911         16  SF-ST-RF-LN-CALC               PIC X.
  2912         16  SF-ST-RF-AH-CALC               PIC X.
  2913         16  SF-ST-RF-CP-CALC               PIC X.
  2914     12  SF-ST-UNEARN-PREM-OPTIONS.
  2915         16  SF-ST-LUEP-R78                 PIC X.
  2916         16  SF-ST-LUEP-PRO                 PIC X.
  2917         16  SF-ST-LUEP-ST                  PIC X.
  2918         16  SF-ST-LUEP-DOM                 PIC X.
  2919         16  SF-ST-AUEP-R78                 PIC X.
  2920         16  SF-ST-AUEP-PRO                 PIC X.
  2921         16  SF-ST-AUEP-ST                  PIC X.
  2922         16  SF-ST-AUEP-DOM                 PIC X.
  2923         16  SF-ST-CUEP-R78                 PIC X.
  2924         16  SF-ST-CUEP-PRO                 PIC X.
  2925         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  55
* EL050.cbl
  2926         16  SF-ST-CUEP-DOM                 PIC X.
  2927     12  SF-ST-EARN-PREM-OPTIONS.
  2928         16  SF-ST-LEP-R78                  PIC X.
  2929         16  SF-ST-LEP-PRO                  PIC X.
  2930         16  SF-ST-LEP-ST                   PIC X.
  2931         16  SF-ST-LEP-DOM                  PIC X.
  2932         16  SF-ST-AEP-R78                  PIC X.
  2933         16  SF-ST-AEP-PRO                  PIC X.
  2934         16  SF-ST-AEP-ST                   PIC X.
  2935         16  SF-ST-AEP-DOM                  PIC X.
  2936         16  SF-ST-CEP-R78                  PIC X.
  2937         16  SF-ST-CEP-PRO                  PIC X.
  2938         16  SF-ST-CEP-ST                   PIC X.
  2939         16  SF-ST-CEP-DOM                  PIC X.
  2940     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  56
* EL050.cbl
  2942*    COPY ELCCRTT.
  2943******************************************************************
  2944*                                                                *
  2945*                            ELCCRTT.                            *
  2946*                                                                *
  2947*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2948*                                                                *
  2949*   FILE TYPE = VSAM,KSDS                                        *
  2950*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2951*                                                                *
  2952*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2953*                                                                *
  2954*   LOG = YES                                                    *
  2955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2956******************************************************************
  2957*                   C H A N G E   L O G
  2958*
  2959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2960*-----------------------------------------------------------------
  2961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2962* EFFECTIVE    NUMBER
  2963*-----------------------------------------------------------------
  2964* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2965* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2966* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2967* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2968* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2969* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2970* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2971* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2972* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2973******************************************************************
  2974
  2975 01  CERTIFICATE-TRAILERS.
  2976     12  CS-RECORD-ID                      PIC XX.
  2977         88  VALID-CS-ID                      VALUE 'CS'.
  2978
  2979     12  CS-CONTROL-PRIMARY.
  2980         16  CS-COMPANY-CD                 PIC X.
  2981         16  CS-CARRIER                    PIC X.
  2982         16  CS-GROUPING                   PIC X(6).
  2983         16  CS-STATE                      PIC XX.
  2984         16  CS-ACCOUNT                    PIC X(10).
  2985         16  CS-CERT-EFF-DT                PIC XX.
  2986         16  CS-CERT-NO.
  2987             20  CS-CERT-PRIME             PIC X(10).
  2988             20  CS-CERT-SFX               PIC X.
  2989         16  CS-TRAILER-TYPE               PIC X.
  2990             88  COMM-TRLR           VALUE 'A'.
  2991             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2992             88  CERT-DATA-TRLR      VALUE 'C'.
  2993
  2994     12  CS-DATA-AREA                      PIC X(516).
  2995
  2996     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2997         16  CS-BANK-COMMISSION-AREA.
  2998             20  CS-BANK-COMMS       OCCURS 10.
  2999                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  57
* EL050.cbl
  3000                 24  CS-COM-TYP            PIC X.
  3001                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3002                 24  CS-RECALC-LV-INDIC    PIC X.
  3003                 24  FILLER                PIC X(10).
  3004         16  FILLER                        PIC X(256).
  3005
  3006     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3007****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3008         16  CS-MB-CLAIM-DATA OCCURS 24.
  3009             20  CS-CLAIM-NO               PIC X(7).
  3010             20  CS-CLAIM-TYPE             PIC X.
  3011                 88  CS-AH-CLM               VALUE 'A'.
  3012                 88  CS-IU-CLM               VALUE 'I'.
  3013                 88  CS-GP-CLM               VALUE 'G'.
  3014                 88  CS-LF-CLM               VALUE 'L'.
  3015                 88  CS-PR-CLM               VALUE 'P'.
  3016                 88  CS-FL-CLM               VALUE 'F'.
  3017             20  CS-INSURED-TYPE           PIC X.
  3018                 88  CS-PRIM-INSURED          VALUE 'P'.
  3019                 88  CS-CO-BORROWER           VALUE 'C'.
  3020             20  CS-BENEFIT-PERIOD         PIC 99.
  3021             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3022             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3023             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3024         16  FILLER                        PIC X(12).
  3025     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3026         16  CS-VIN-NUMBER                 PIC X(17).
  3027         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3028         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3029         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3030         16  cs-agent-name.
  3031             20  cs-agent-fname            pic x(20).
  3032             20  cs-agent-mi               pic x.
  3033             20  cs-agent-lname            pic x(25).
  3034         16  cs-license-no                 pic x(15).
  3035         16  cs-npn-number                 pic x(10).
  3036         16  cs-agent-edit-status          pic x.
  3037             88  cs-ae-refer-to-manager      value 'M'.
  3038             88  cs-ae-cover-sheet           value 'C'.
  3039             88  cs-ae-sig-form              value 'S'.
  3040             88  cs-ae-verified              value 'V'.
  3041             88  cs-unidentified-signature   value 'U'.
  3042             88  cs-cert-returned            value 'R'.
  3043             88  cs-accept-no-commission     value 'N'.
  3044         16  cs-year                       pic 9999.
  3045         16  cs-make                       pic x(20).
  3046         16  cs-model                      pic x(20).
  3047         16  cs-future                     pic x(20).
  3048         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3049         16  FILLER                        PIC X(356). *> was 420
  3050*        16  FILLER                        PIC X(496).
  3051*    COPY ELCCRTO.
  3052******************************************************************
  3053*                                                                *
  3054*                            ELCCRTO.                            *
  3055*                                                                *
  3056*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3057*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  58
* EL050.cbl
  3058*   FILE TYPE = VSAM,KSDS                                        *
  3059*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3060*                                                                *
  3061*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3062*                                                                *
  3063*   LOG = YES                                                    *
  3064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3065******************************************************************
  3066*                   C H A N G E   L O G
  3067*
  3068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3069*-----------------------------------------------------------------
  3070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3071* EFFECTIVE    NUMBER
  3072*-----------------------------------------------------------------
  3073* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3074* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3075* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3076* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3077* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3078******************************************************************
  3079 01  ORIGINAL-CERTIFICATE.
  3080     12  OC-RECORD-ID                      PIC XX.
  3081         88  VALID-OC-ID                      VALUE 'OC'.
  3082     12  OC-CONTROL-PRIMARY.
  3083         16  OC-COMPANY-CD                 PIC X.
  3084         16  OC-CARRIER                    PIC X.
  3085         16  OC-GROUPING                   PIC X(6).
  3086         16  OC-STATE                      PIC XX.
  3087         16  OC-ACCOUNT                    PIC X(10).
  3088         16  OC-CERT-EFF-DT                PIC XX.
  3089         16  OC-CERT-NO.
  3090             20  OC-CERT-PRIME             PIC X(10).
  3091             20  OC-CERT-SFX               PIC X.
  3092         16  OC-RECORD-TYPE                PIC X.
  3093         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3094     12  OC-LAST-MAINT-DT                  PIC XX.
  3095     12  OC-LAST-MAINT-BY                  PIC X(4).
  3096     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3097     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3098     12  FILLER                            PIC X(49).
  3099     12  OC-ORIG-REC.
  3100         16  OC-INS-LAST-NAME              PIC X(15).
  3101         16  OC-INS-FIRST-NAME             PIC X(10).
  3102         16  OC-INS-MIDDLE-INIT            PIC X.
  3103         16  OC-INS-AGE                    PIC S999     COMP-3.
  3104         16  OC-JNT-LAST-NAME              PIC X(15).
  3105         16  OC-JNT-FIRST-NAME             PIC X(10).
  3106         16  OC-JNT-MIDDLE-INIT            PIC X.
  3107         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3108         16  OC-LF-BENCD                   PIC XX.
  3109         16  OC-LF-TERM                    PIC S999      COMP-3.
  3110         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3111         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3113         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3114         16  OC-LF-EXP-DT                  PIC XX.
  3115         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  59
* EL050.cbl
  3116         16  OC-LF-CANCEL-DT               PIC XX.
  3117         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3118         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3119         16  OC-AH-BENCD                   PIC XX.
  3120         16  OC-AH-TERM                    PIC S999      COMP-3.
  3121         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3122         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3123         16  OC-AH-EXP-DT                  PIC XX.
  3124         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3125         16  OC-AH-CP                      PIC 99.
  3126         16  OC-AH-CANCEL-DT               PIC XX.
  3127         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3128         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3129         16  OC-CRED-BENE-NAME             PIC X(25).
  3130         16  OC-1ST-PMT-DT                 PIC XX.
  3131         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3132         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3133         16  OC-ISSUE-TRAN-IND             PIC X.
  3134         16  OC-CANCEL-TRAN-IND            PIC X.
  3135         16  FILLER                        PIC X(211).
  3136
  3137     12  FILLER                            PIC X(50).
  3138******************************************************************
  3139
  3140*    COPY ELCDATE.
  3141******************************************************************
  3142*                                                                *
  3143*                                                                *
  3144*                            ELCDATE.                            *
  3145*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3146*                            VMOD=2.003
  3147*                                                                *
  3148*                                                                *
  3149*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3150*                 LENGTH = 200                                   *
  3151******************************************************************
  3152
  3153 01  DATE-CONVERSION-DATA.
  3154     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3155     12  DC-OPTION-CODE                PIC X.
  3156         88  BIN-TO-GREG                VALUE ' '.
  3157         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3158         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3159         88  YMD-GREG-TO-BIN            VALUE '3'.
  3160         88  MDY-GREG-TO-BIN            VALUE '4'.
  3161         88  JULIAN-TO-BIN              VALUE '5'.
  3162         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3163         88  FIND-CENTURY               VALUE '7'.
  3164         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3165         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3166         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3167         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3168         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3169         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3170         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3171         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3172         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3173         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  60
* EL050.cbl
  3174         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3175         88  BIN-3-TO-GREG              VALUE 'I'.
  3176         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3177         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3178         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3179         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3180         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3181         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3182         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3183         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3184         88  THREE-CHARACTER-BIN
  3185                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3186         88  GREGORIAN-TO-BIN
  3187                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3188         88  BIN-TO-GREGORIAN
  3189                  VALUES ' ' '1' 'I' '8' 'G'.
  3190         88  JULIAN-TO-BINARY
  3191                  VALUES '5' 'C' 'E' 'F'.
  3192     12  DC-ERROR-CODE                 PIC X.
  3193         88  NO-CONVERSION-ERROR        VALUE ' '.
  3194         88  DATE-CONVERSION-ERROR
  3195                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3196         88  DATE-IS-ZERO               VALUE '1'.
  3197         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3198         88  DATE-IS-INVALID            VALUE '3'.
  3199         88  DATE1-GREATER-DATE2        VALUE '4'.
  3200         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3201         88  DATE-INVALID-OPTION        VALUE '9'.
  3202         88  INVALID-CENTURY            VALUE 'A'.
  3203         88  ONLY-CENTURY               VALUE 'B'.
  3204         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3205         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3206     12  DC-END-OF-MONTH               PIC X.
  3207         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3208     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3209         88  USE-NORMAL-PROCESS         VALUE ' '.
  3210         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3211         88  ADJUST-UP-100-YRS          VALUE '2'.
  3212     12  FILLER                        PIC X.
  3213     12  DC-CONVERSION-DATES.
  3214         16  DC-BIN-DATE-1             PIC XX.
  3215         16  DC-BIN-DATE-2             PIC XX.
  3216         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3217         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3218                       DC-GREG-DATE-1-EDIT.
  3219             20  DC-EDIT1-MONTH        PIC 99.
  3220             20  SLASH1-1              PIC X.
  3221             20  DC-EDIT1-DAY          PIC 99.
  3222             20  SLASH1-2              PIC X.
  3223             20  DC-EDIT1-YEAR         PIC 99.
  3224         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3225         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3226                     DC-GREG-DATE-2-EDIT.
  3227             20  DC-EDIT2-MONTH        PIC 99.
  3228             20  SLASH2-1              PIC X.
  3229             20  DC-EDIT2-DAY          PIC 99.
  3230             20  SLASH2-2              PIC X.
  3231             20  DC-EDIT2-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  61
* EL050.cbl
  3232         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3233         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3234                     DC-GREG-DATE-1-YMD.
  3235             20  DC-YMD-YEAR           PIC 99.
  3236             20  DC-YMD-MONTH          PIC 99.
  3237             20  DC-YMD-DAY            PIC 99.
  3238         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3239         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3240                      DC-GREG-DATE-1-MDY.
  3241             20  DC-MDY-MONTH          PIC 99.
  3242             20  DC-MDY-DAY            PIC 99.
  3243             20  DC-MDY-YEAR           PIC 99.
  3244         16  DC-GREG-DATE-1-ALPHA.
  3245             20  DC-ALPHA-MONTH        PIC X(10).
  3246             20  DC-ALPHA-DAY          PIC 99.
  3247             20  FILLER                PIC XX.
  3248             20  DC-ALPHA-CENTURY.
  3249                 24 DC-ALPHA-CEN-N     PIC 99.
  3250             20  DC-ALPHA-YEAR         PIC 99.
  3251         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3252         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3253         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3254         16  DC-JULIAN-DATE            PIC 9(05).
  3255         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3256                                       PIC 9(05).
  3257         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3258             20  DC-JULIAN-YEAR        PIC 99.
  3259             20  DC-JULIAN-DAYS        PIC 999.
  3260         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3261         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3262         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3263     12  DATE-CONVERSION-VARIBLES.
  3264         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3265         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3266             20  FILLER                PIC 9(3).
  3267             20  HOLD-CEN-1-CCYY.
  3268                 24  HOLD-CEN-1-CC     PIC 99.
  3269                 24  HOLD-CEN-1-YY     PIC 99.
  3270             20  HOLD-CEN-1-MO         PIC 99.
  3271             20  HOLD-CEN-1-DA         PIC 99.
  3272         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3273             20  HOLD-CEN-1-R-MO       PIC 99.
  3274             20  HOLD-CEN-1-R-DA       PIC 99.
  3275             20  HOLD-CEN-1-R-CCYY.
  3276                 24  HOLD-CEN-1-R-CC   PIC 99.
  3277                 24  HOLD-CEN-1-R-YY   PIC 99.
  3278             20  FILLER                PIC 9(3).
  3279         16  HOLD-CENTURY-1-X.
  3280             20  FILLER                PIC X(3)  VALUE SPACES.
  3281             20  HOLD-CEN-1-X-CCYY.
  3282                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3283                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3284             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3285             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3286         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3287             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3288             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3289             20  HOLD-CEN-1-R-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  62
* EL050.cbl
  3290                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3291                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3292             20  FILLER                PIC XXX.
  3293         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3294         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3295         16  DC-JULIAN-DATE-1          PIC 9(07).
  3296         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3297             20  DC-JULIAN-1-CCYY.
  3298                 24  DC-JULIAN-1-CC    PIC 99.
  3299                 24  DC-JULIAN-1-YR    PIC 99.
  3300             20  DC-JULIAN-DA-1        PIC 999.
  3301         16  DC-JULIAN-DATE-2          PIC 9(07).
  3302         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3303             20  DC-JULIAN-2-CCYY.
  3304                 24  DC-JULIAN-2-CC    PIC 99.
  3305                 24  DC-JULIAN-2-YR    PIC 99.
  3306             20  DC-JULIAN-DA-2        PIC 999.
  3307         16  DC-GREG-DATE-A-EDIT.
  3308             20  DC-EDITA-MONTH        PIC 99.
  3309             20  SLASHA-1              PIC X VALUE '/'.
  3310             20  DC-EDITA-DAY          PIC 99.
  3311             20  SLASHA-2              PIC X VALUE '/'.
  3312             20  DC-EDITA-CCYY.
  3313                 24  DC-EDITA-CENT     PIC 99.
  3314                 24  DC-EDITA-YEAR     PIC 99.
  3315         16  DC-GREG-DATE-B-EDIT.
  3316             20  DC-EDITB-MONTH        PIC 99.
  3317             20  SLASHB-1              PIC X VALUE '/'.
  3318             20  DC-EDITB-DAY          PIC 99.
  3319             20  SLASHB-2              PIC X VALUE '/'.
  3320             20  DC-EDITB-CCYY.
  3321                 24  DC-EDITB-CENT     PIC 99.
  3322                 24  DC-EDITB-YEAR     PIC 99.
  3323         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3324         16  DC-GREG-DATE-CYMD-R REDEFINES
  3325                              DC-GREG-DATE-CYMD.
  3326             20  DC-CYMD-CEN           PIC 99.
  3327             20  DC-CYMD-YEAR          PIC 99.
  3328             20  DC-CYMD-MONTH         PIC 99.
  3329             20  DC-CYMD-DAY           PIC 99.
  3330         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3331         16  DC-GREG-DATE-MDCY-R REDEFINES
  3332                              DC-GREG-DATE-MDCY.
  3333             20  DC-MDCY-MONTH         PIC 99.
  3334             20  DC-MDCY-DAY           PIC 99.
  3335             20  DC-MDCY-CEN           PIC 99.
  3336             20  DC-MDCY-YEAR          PIC 99.
  3337    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3338        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3339    12  DC-EL310-DATE                  PIC X(21).
  3340    12  FILLER                         PIC X(28).
  3341
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  63
* EL050.cbl
  3343*    COPY ELCCALC.
  3344******************************************************************
  3345*                                                                *
  3346*                           ELCCALC.                            *
  3347*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3348*                            VMOD=2.025                          *
  3349*                                                                *
  3350*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3351*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3352*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3353*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3354*                                                                *
  3355*  PASSED TO ELRTRM                                              *
  3356*  -----------------                                             *
  3357*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3358*  ORIGINAL TERM                                                 *
  3359*  BEGINNING DATE                                                *
  3360*  ENDING DATE                                                   *
  3361*  COMPANY I.D.                                                  *
  3362*  ACCOUNT MASTER USER FIELD                                     *
  3363*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3364*  FREE LOOK DAYS                                                *
  3365*                                                                *
  3366*  RETURNED FROM ELRTRM                                          *
  3367*  ---------------------                                         *
  3368*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3369*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3370*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3371*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3372*----------------------------------------------------------------*
  3373*  PASSED TO ELRAMT                                              *
  3374*  ----------------                                              *
  3375*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3376*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3377*  ORIGINAL AMOUNT                                               *
  3378*  ALTERNATE BENEFIT (BALLON)                                    *
  3379*  A.P.R. - NET PAY ONLY                                         *
  3380*  METHOD
  3381*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3382*  COMPANY I.D.                                                  *
  3383*  BENEFIT TYPE                                                  *
  3384*                                                                *
  3385*  RETURNED FROM ELRAMT                                          *
  3386*  --------------------                                          *
  3387*  REMAINING AMOUNT 1 - CURRENT                                  *
  3388*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3389*  REMAINING AMOUNT FACTOR
  3390*----------------------------------------------------------------*
  3391*  PASSED TO ELRESV                                              *
  3392*  -----------------                                             *
  3393*  CERTIFICATE EFFECTIVE DATE                                    *
  3394*  VALUATION DATE                                                *
  3395*  PAID THRU DATE                                                *
  3396*  BENEFIT                                                       *
  3397*  INCURRED DATE                                                 *
  3398*  REPORTED DATE                                                 *
  3399*  ISSUE AGE                                                     *
  3400*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  64
* EL050.cbl
  3401*  CDT PERCENT                                                   *
  3402*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3403* *CLAIM TYPE (LIFE, A/H)                                        *
  3404* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3405* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3406*                                                                *
  3407*  RETURNED FROM ELRESV                                          *
  3408*  --------------------                                          *
  3409*  CDT TABLE USED                                                *
  3410*  CDT FACTOR USED                                               *
  3411*  PAY TO CURRENT RESERVE                                        *
  3412*  I.B.N.R. - A/H ONLY                                           *
  3413*  FUTURE (ACCRUED) AH ONLY                                      *
  3414*----------------------------------------------------------------*
  3415*  PASSED TO ELRATE                                              *
  3416*  ----------------                                              *
  3417*  CERT ISSUE DATE                                               *
  3418*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3419*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3420*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3421*  STATE CODE (CLIENT DEFINED)                                   *
  3422*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3423*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3424*  DEVIATION CODE                                                *
  3425*  ISSUE AGE                                                     *
  3426*  ORIGINAL BENEFIT AMOUNT                                       *
  3427*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3428*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3429*  BENEFIT KIND (LIFE OR A/H)                                    *
  3430*  A.P.R.                                                        *
  3431*  METHOD
  3432*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3433*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3434*  COMPANY I.D. (3 CHARACTER)                                    *
  3435*  BENEFIT CODE                                                  *
  3436*  BENEFIT OVERRIDE CODE                                         *
  3437*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3438*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3439*  JOINT INDICATOR (CSL ONLY)                                    *
  3440*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3441*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3442*                                                                *
  3443*  RETURNED FROM ELRATE                                          *
  3444*  --------------------                                          *
  3445*  CALCULATED PREMIUM                                            *
  3446*  PREMIUM RATE                                                  *
  3447*  MORTALITY CODE                                                *
  3448*  MAX ATTAINED AGE                                              *
  3449*  MAX AGE                                                       *
  3450*  MAX TERM                                                      *
  3451*  MAX MONTHLY BENEFIT                                           *
  3452*  MAX TOTAL BENIFIT                                             *
  3453*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3454*----------------------------------------------------------------*
  3455*  PASSED TO ELRFND                                              *
  3456*  ----------------                                              *
  3457*  CERT ISSUE DATE                                               *
  3458*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  65
* EL050.cbl
  3459*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3460*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3461*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3462*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3463*  STATE CODE (CLIENT DEFINED)                                   *
  3464*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3465*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3466*  DEVIATION CODE                                                *
  3467*  ISSUE AGE                                                     *
  3468*  ORIGINAL BENEFIT AMOUNT                                       *
  3469*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3470*  PROCESS TYPE (CANCEL)                                         *
  3471*  BENEFIT KIND (LIFE OR A/H)                                    *
  3472*  A.P.R.                                                        *
  3473*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3474*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3475*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3476*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3477*  COMPANY I.D. (3 CHARACTER)                                    *
  3478*  BENEFIT CODE                                                  *
  3479*  BENEFIT OVERRIDE CODE                                         *
  3480*                                                                *
  3481*  RETURNED FROM ELRFND                                          *
  3482*  --------------------                                          *
  3483*  CALCULATED REFUND                                             *
  3484*----------------------------------------------------------------*
  3485*  PASSED TO ELEARN                                              *
  3486*  ----------------                                              *
  3487*  CERT ISSUE DATE                                               *
  3488*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3489*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3490*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3491*  STATE CODE (CLIENT DEFINED)                                   *
  3492*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3493*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3494*  DEVIATION CODE                                                *
  3495*  ISSUE AGE                                                     *
  3496*  ORIGINAL BENEFIT AMOUNT                                       *
  3497*  BENEFIT KIND (LIFE OR A/H)                                    *
  3498*  A.P.R.                                                        *
  3499*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3500*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3501*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3502*  COMPANY I.D. (3 CHARACTER)                                    *
  3503*  BENEFIT CODE                                                  *
  3504*  BENEFIT OVERRIDE CODE                                         *
  3505*                                                                *
  3506*  RETURNED FROM ELEARN                                          *
  3507*  --------------------                                          *
  3508*  INDICATED  EARNINGS                                           *
  3509*----------------------------------------------------------------*
  3510*                 LENGTH = 450                                   *
  3511*                                                                *
  3512******************************************************************
  3513******************************************************************
  3514*                   C H A N G E   L O G
  3515*
  3516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  66
* EL050.cbl
  3517*-----------------------------------------------------------------
  3518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3519* EFFECTIVE    NUMBER
  3520*-----------------------------------------------------------------
  3521* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3522* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3523* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3524* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3525* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3526* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3527* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3528* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3529* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3530* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3531* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3532******************************************************************
  3533
  3534 01  CALCULATION-PASS-AREA.
  3535     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3536                                     COMP.
  3537
  3538     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3539       88  NO-CP-ERROR                             VALUE ZERO.
  3540       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3541                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3542       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3543       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3544       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3545       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3546       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3547       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3548       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3549       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3550       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3551       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3552       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3553       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3554       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3555       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3556       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3557       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3558       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3559
  3560     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3561       88  NO-CP-ERROR-2                           VALUE ZERO.
  3562***********************  INPUT AREAS ****************************
  3563
  3564     12  CP-CALCULATION-AREA.
  3565         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3566         16  CP-CERT-EFF-DT        PIC XX.
  3567         16  CP-VALUATION-DT       PIC XX.
  3568         16  CP-PAID-THRU-DT       PIC XX.
  3569         16  CP-BENEFIT-TYPE       PIC X.
  3570           88  CP-AH                               VALUE 'A' 'D'
  3571                                                   'I' 'U'.
  3572           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3573           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3574         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  67
* EL050.cbl
  3575         16  CP-REPORTED-DT        PIC XX.
  3576         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3577         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3578         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3579                                     COMP-3.
  3580         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3581                                     COMP-3.
  3582         16  CP-CDT-METHOD         PIC X.
  3583           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3584           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3585           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3586         16  CP-CLAIM-TYPE         PIC X.
  3587           88  CP-AH-CLAIM                         VALUE 'A'.
  3588           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3589         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3592                                     COMP-3.
  3593         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3594                                     COMP-3.
  3595         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3596                                     COMP-3.
  3597         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3598                                     COMP-3.
  3599         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3600                                     COMP-3.
  3601         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3602                                     COMP-3.
  3603         16  CP-REM-TERM-METHOD    PIC X.
  3604           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3605           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3606           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3607           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3608           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3609           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3610           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3611         16  CP-EARNING-METHOD     PIC X.
  3612           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3613           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3614           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3615           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3616           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3617           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3618           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3619           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3620           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3621           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3622           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3623           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3624           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3625           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3626         16  CP-PROCESS-TYPE       PIC X.
  3627           88  CP-CLAIM                            VALUE '1'.
  3628           88  CP-CANCEL                           VALUE '2'.
  3629           88  CP-ISSUE                            VALUE '3'.
  3630         16  CP-SPECIAL-CALC-CD    PIC X.
  3631           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3632           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  68
* EL050.cbl
  3633           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3634           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3635           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3636           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3637           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3638           88  CP-FARM-PLAN                    VALUE 'F'.
  3639           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3640           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3641           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3642           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3643           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3644           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3645           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3646           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3647           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3648           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3649                                                     'W' 'X'.
  3650           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3651           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3652           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3653           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3654           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3655           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3656           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3657           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3658           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3659           88  CP-CSL-METH-1                   VALUE '5'.
  3660           88  CP-CSL-METH-2                   VALUE '6'.
  3661           88  CP-CSL-METH-3                   VALUE '7'.
  3662           88  CP-CSL-METH-4                   VALUE '8'.
  3663
  3664         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3665                                     COMP-3.
  3666         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3667         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3668         16  CP-STATE              PIC XX          VALUE SPACE.
  3669         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3670         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3671           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3672               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3673         16  CP-R78-OPTION         PIC X.
  3674           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3675           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3676
  3677         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3678         16  CP-IBNR-RESERVE-SW    PIC X.
  3679         16  CP-CLAIM-STATUS       PIC X.
  3680         16  CP-RATE-FILE          PIC X.
  3681         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3682                                     COMP-3.
  3683
  3684         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3685         16  CP-AH-OVERRIDE-CODE   PIC X.
  3686
  3687         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3688                                     COMP-3.
  3689         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3690                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  69
* EL050.cbl
  3691         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3692                                     COMP-3.
  3693         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3694                                     COMP-3.
  3695         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3696                                     COMP-3.
  3697         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3698                                  PIC S9(7)V99 COMP-3.
  3699
  3700         16  CP-PAID-FROM-DATE     PIC X(02).
  3701         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3702         16  CP-EXT-DAYS-CALC      PIC X.
  3703           88  CP-EXT-NO-CHG                   VALUE ' '.
  3704           88  CP-EXT-CHG-LF                   VALUE '1'.
  3705           88  CP-EXT-CHG-AH                   VALUE '2'.
  3706           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3707         16  CP-DOMICILE-STATE     PIC XX.
  3708         16  CP-CARRIER            PIC X.
  3709         16  CP-REIN-FLAG          PIC X.
  3710         16  CP-REM-TRM-CALC-OPTION PIC X.
  3711           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3712                      '2' '3' '4' '5'.
  3713           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3714           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3715           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3716           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3717           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3718           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3719           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3720           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3721         16  CP-SIG-SWITCH         PIC X.
  3722         16  CP-RATING-METHOD      PIC X.
  3723           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3724           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3725           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3726           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3727           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3728           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3729           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3730           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3731           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3732         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3733                                     COMP-3.
  3734         16  CP-BEN-CATEGORY       PIC X.
  3735         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3736         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3737                                   PIC S99V9(5) COMP-3.
  3738         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3739         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3740                                   PIC S99V9(5) COMP-3.
  3741         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3742         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3743         16  CP-EXPIRE-DT          PIC XX.
  3744         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3745         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3746         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3747         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3748         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  70
* EL050.cbl
  3749             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3750             88  CP-CALC-CLP              VALUE 'C'.
  3751         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3752         16  CP-CANCEL-REASON      PIC X.
  3753         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3754         16  CP-PMT-MODE           PIC X.
  3755         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3756         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3757         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3758         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3759         16  FILLER                PIC X.
  3760
  3761***************    OUTPUT FROM ELRESV   ************************
  3762
  3763         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3764
  3765         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3766                                     COMP-3.
  3767         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3768                                     COMP-3.
  3769         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3770                                     COMP-3.
  3771         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3772                                     COMP-3.
  3773         16  FILLER                PIC X(09).
  3774***************    OUTPUT FROM ELRTRM   *************************
  3775
  3776         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3781                                     COMP-3.
  3782         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3783                                     COMP-3.
  3784         16  FILLER                PIC X(12).
  3785
  3786***************    OUTPUT FROM ELRAMT   *************************
  3787
  3788         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3789                                     COMP-3.
  3790         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3791                                     COMP-3.
  3792         16  FILLER                PIC X(12).
  3793
  3794***************    OUTPUT FROM ELRATE   *************************
  3795
  3796         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3797                                     COMP-3.
  3798         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3799                                     COMP-3.
  3800         16  CP-MORTALITY-CODE     PIC X(4).
  3801         16  CP-RATE-EDIT-FLAG     PIC X.
  3802             88  CP-RATES-NEED-APR                  VALUE '1'.
  3803         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3806         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  71
* EL050.cbl
  3807         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3808                                   PIC S9(7)V99 COMP-3.
  3809         16  FILLER                PIC X(07).
  3810
  3811***************    OUTPUT FROM ELRFND   *************************
  3812
  3813         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3814                                     COMP-3.
  3815         16  CP-REFUND-TYPE-USED   PIC X.
  3816           88  CP-R-AS-R78                         VALUE '1'.
  3817           88  CP-R-AS-PRORATA                     VALUE '2'.
  3818           88  CP-R-AS-CALIF                       VALUE '3'.
  3819           88  CP-R-AS-TEXAS                       VALUE '4'.
  3820           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3821           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3822           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3823           88  CP-R-AS-MEAN                        VALUE '8'.
  3824           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3825           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3826           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3827           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3828           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3829           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3830         16  FILLER                PIC X(12).
  3831
  3832***************    OUTPUT FROM ELEARN   *************************
  3833
  3834         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3835                                     COMP-3.
  3836         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3837                                     COMP-3.
  3838         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3839                                     COMP-3.
  3840         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3841                                     COMP-3.
  3842         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3843                                     COMP-3.
  3844         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3845                                     COMP-3.
  3846         16  CP-EARNING-TYPE-USED  PIC X.
  3847           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3848           88  CP-E-AS-R78                         VALUE '1'.
  3849           88  CP-E-AS-PRORATA                     VALUE '2'.
  3850           88  CP-E-AS-TEXAS                       VALUE '4'.
  3851           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3852           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3853           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3854           88  CP-E-AS-MEAN                        VALUE '8'.
  3855           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3856         16  FILLER                PIC X(12).
  3857
  3858***************    OUTPUT FROM ELPMNT   *************************
  3859
  3860         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3861                                     COMP-3.
  3862         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3863                                     COMP-3.
  3864         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  72
* EL050.cbl
  3865
  3866***************   MISC WORK AREAS    *****************************
  3867         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3868                                     COMP-3.
  3869         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3870                                     COMP-3.
  3871         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3872                                     COMP-3.
  3873         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3874                                     COMP-3.
  3875         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3876                                     COMP-3.
  3877         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3878                                     COMP-3.
  3879         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3880             88  OPEN-RATE-FILE                   VALUE 'O'.
  3881             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3882             88  IO-ERROR                         VALUE 'E'.
  3883
  3884         16  CP-FIRST-PAY-DATE     PIC XX.
  3885
  3886         16  CP-JOINT-INDICATOR    PIC X.
  3887
  3888         16  CP-RESERVE-REMAINING-TERM
  3889                                   PIC S9(4)V9    VALUE ZERO
  3890                                     COMP-3.
  3891
  3892         16  CP-INSURED-BIRTH-DT   PIC XX.
  3893
  3894         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3898                                     COMP-3.
  3899
  3900         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3904                                     COMP-3.
  3905
  3906         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3907                                     COMP-3.
  3908
  3909         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3910                                     COMP-3.
  3911
  3912         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3913                                     COMP-3.
  3914
  3915         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3916             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3917
  3918         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3919                                     COMP-3.
  3920         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3921                                     COMP-3.
  3922         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  73
* EL050.cbl
  3923         16  cp-extra-periods      pic 9 value zeros.
  3924         16  cp-net-only-state     pic x value spaces.
  3925         16  FILLER                PIC X(13).
  3926******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  74
* EL050.cbl
  3928******************************************************************
  3929*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3930*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3931*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3932*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3933*** MODIFICATION.                                              ***
  3934*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3935*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3936******************************************************************
  3937*    COPY ERCPNDB.
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*                            ERCPNDB.                            *
  3942*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3943*                            VMOD=2.025                          *
  3944*                                                                *
  3945*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3946*                                                                *
  3947******************************************************************
  3948*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3949*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3950******************************************************************
  3951*                                                                *
  3952*                                                                *
  3953*   FILE TYPE = VSAM,KSDS                                        *
  3954*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3955*                                                                *
  3956*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3957*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3958*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3959*                                                 RKP=13,LEN=36  *
  3960*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3961*                                      AND CHG-SEQ.)             *
  3962*                                                RKP=49,LEN=11   *
  3963*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3964*                                      AND CHG-SEQ.)             *
  3965*                                                RKP=60,LEN=15   *
  3966*                                                                *
  3967*   LOG = NO                                                     *
  3968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3969******************************************************************
  3970******************************************************************
  3971*                   C H A N G E   L O G
  3972*
  3973* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3974*-----------------------------------------------------------------
  3975*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3976* EFFECTIVE    NUMBER
  3977*-----------------------------------------------------------------
  3978* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3979* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3980* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3981* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3982* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3983* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3984* 032306                   PEMA  ADD BOW LOAN NUMBER
  3985* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  75
* EL050.cbl
  3986* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3987* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3988* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3989* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3990* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3991* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3992* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3993* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3994* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3995******************************************************************
  3996
  3997 01  PENDING-BUSINESS.
  3998     12  PB-RECORD-ID                     PIC XX.
  3999         88  VALID-PB-ID                        VALUE 'PB'.
  4000
  4001     12  PB-CONTROL-PRIMARY.
  4002         16  PB-COMPANY-CD                PIC X.
  4003         16  PB-ENTRY-BATCH               PIC X(6).
  4004         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4005         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4006
  4007     12  PB-CONTROL-BY-ACCOUNT.
  4008         16  PB-COMPANY-CD-A1             PIC X.
  4009         16  PB-CARRIER                   PIC X.
  4010         16  PB-GROUPING.
  4011             20  PB-GROUPING-PREFIX       PIC XXX.
  4012             20  PB-GROUPING-PRIME        PIC XXX.
  4013         16  PB-STATE                     PIC XX.
  4014         16  PB-ACCOUNT.
  4015             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4016             20  PB-ACCOUNT-PRIME         PIC X(6).
  4017         16  PB-CERT-EFF-DT               PIC XX.
  4018         16  PB-CERT-NO.
  4019             20  PB-CERT-PRIME            PIC X(10).
  4020             20  PB-CERT-SFX              PIC X.
  4021         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4022
  4023         16  PB-RECORD-TYPE               PIC X.
  4024             88  PB-MAILING-DATA                VALUE '0'.
  4025             88  PB-ISSUE                       VALUE '1'.
  4026             88  PB-CANCELLATION                VALUE '2'.
  4027             88  PB-BATCH-TRAILER               VALUE '9'.
  4028
  4029     12  PB-CONTROL-BY-ORIG-BATCH.
  4030         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4031         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4032         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4033         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4034
  4035     12  PB-CONTROL-BY-CSR.
  4036         16  PB-CSR-COMPANY-CD            PIC X.
  4037         16  PB-CSR-ID                    PIC X(4).
  4038         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4039         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4040         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4041******************************************************************
  4042*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4043******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  76
* EL050.cbl
  4044
  4045     12  PB-LAST-MAINT-DT                 PIC XX.
  4046     12  PB-LAST-MAINT-BY                 PIC X(4).
  4047     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4048
  4049     12  PB-RECORD-BODY                   PIC X(375).
  4050
  4051     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4052         16  PB-CERT-ORIGIN               PIC X.
  4053             88  CLASIC-CREATED-CERT         VALUE '1'.
  4054         16  PB-I-NAME.
  4055             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4056             20  PB-I-INSURED-FIRST-NAME.
  4057                 24  PB-I-INSURED-1ST-INIT PIC X.
  4058                 24  FILLER                PIC X(9).
  4059             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4060         16  PB-I-AGE                     PIC S99   COMP-3.
  4061         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4062         16  PB-I-BIRTHDAY                PIC XX.
  4063         16  PB-I-INSURED-SEX             PIC X.
  4064             88  PB-SEX-MALE     VALUE 'M'.
  4065             88  PB-SEX-FEMALE   VALUE 'F'.
  4066
  4067         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4068         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4069         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4070         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4071         16  PB-I-SKIP-CODE               PIC X.
  4072             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4073             88  PB-SKIP-JULY              VALUE '1'.
  4074             88  PB-SKIP-AUGUST            VALUE '2'.
  4075             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4076             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4077             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4078             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4079             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4080             88  PB-SKIP-JUNE              VALUE '8'.
  4081             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4082             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4083             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4084         16  PB-I-TERM-TYPE               PIC X.
  4085             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4086             88  PB-PAID-WEEKLY            VALUE 'W'.
  4087             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4088             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4089             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4090         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4091         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4092         16  PB-I-DATA-ENTRY-SW           PIC X.
  4093             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4094             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4095             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4096             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4097         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4098         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4099*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4100         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4101         16  FILLER                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  77
* EL050.cbl
  4102
  4103         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4104             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4105             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4106                                                   '90' THRU '99'.
  4107         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4108                                          PIC XX.
  4109         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4110         16  PB-I-AMOUNT-FINANCED REDEFINES
  4111                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4112         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4113         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4114                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4115         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4116         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4117         16  PB-I-CLP-AMOUNT REDEFINES
  4118                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4119         16  PB-I-LF-CALC-FLAG            PIC X.
  4120             88 PB-COMP-LF-PREM               VALUE '?'.
  4121         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4122         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4123         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4124         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4125         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4126         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4127         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4128         16  PB-I-LF-ABBR                 PIC XXX.
  4129         16  PB-I-LF-INPUT-CD             PIC XX.
  4130
  4131         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4132             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4133             88  PB-INVALID-AH               VALUE '  ' '00'
  4134                                                   '90' THRU '99'.
  4135         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4136         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4137         16  PB-I-AH-CALC-FLAG            PIC X.
  4138             88 PB-COMP-AH-PREM                  VALUE '?'.
  4139         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4140         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4141         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4142         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4143         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4144         16  PB-I-AH-ABBR                 PIC XXX.
  4145         16  PB-I-AH-INPUT-CD             PIC XXX.
  4146
  4147         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4148         16  PB-I-REIN-TABLE              PIC XXX.
  4149         16  PB-I-BUSINESS-TYPE           PIC 99.
  4150         16  PB-I-INDV-GRP-CD             PIC X.
  4151         16  PB-I-MORT-CODE.
  4152             20  PB-I-TABLE               PIC X.
  4153             20  PB-I-INTEREST            PIC XX.
  4154             20  PB-I-MORT-TYP            PIC X.
  4155         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4156         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4157         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4158         16  PB-I-INDV-GRP-OVRD           PIC X.
  4159         16  PB-I-RATE-CLASS-OVRD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  78
* EL050.cbl
  4160         16  PB-I-SIG-SW                  PIC X.
  4161             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4162         16  PB-I-RATE-CLASS              PIC XX.
  4163         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4164         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4165         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4166         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4167         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4168         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4169         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4170         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4171         16  PB-I-OB-FLAG                 PIC X.
  4172             88  PB-I-OB                      VALUE 'B'.
  4173             88  PB-I-SUMMARY                 VALUE 'Z'.
  4174         16  PB-I-ENTRY-STATUS            PIC X.
  4175             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4176                                              'M' '5' '9' '2'.
  4177             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4178             88  PB-I-POLICY-PENDING          VALUE '2'.
  4179             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4180             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4181             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4182             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4183             88  PB-I-REIN-ONLY               VALUE '9'.
  4184             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4185             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4186             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4187             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4188         16  PB-I-INT-CODE                PIC X.
  4189             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4190             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4191         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4192         16  PB-I-SOC-SEC-NO              PIC X(11).
  4193         16  PB-I-MEMBER-NO               PIC X(12).
  4194         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4195*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4196         16  PB-I-OLD-LOF                 PIC XXX.
  4197         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4198         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4199         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4200         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4201         16  PB-I-LIFE-INDICATOR          PIC X.
  4202             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4203         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4204         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4205                                          PIC S9(5)V99    COMP-3.
  4206         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4207             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4208             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4209         16  PB-I-1ST-PMT-DT              PIC XX.
  4210         16  PB-I-JOINT-INSURED.
  4211             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4212             20 PB-I-JOINT-FIRST-NAME.
  4213                24  PB-I-JOINT-FIRST-INIT PIC X.
  4214                24  FILLER                PIC X(9).
  4215             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4216*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4217         16  PB-I-BENEFICIARY-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  79
* EL050.cbl
  4218             20  PB-I-BANK-NUMBER         PIC X(10).
  4219             20  FILLER                   PIC X(15).
  4220         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4221         16  PB-I-REFERENCE               PIC X(12).
  4222         16  FILLER REDEFINES PB-I-REFERENCE.
  4223             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4224             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4225             20  PB-I-CLP-STATE           PIC XX.
  4226         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4227             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4228             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4229             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4230         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4231         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4232         16  PB-I-RESIDENT-STATE          PIC XX.
  4233         16  PB-I-RATE-CODE               PIC X(4).
  4234         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4235         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4236         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4237         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4238         16  PB-I-BANK-NOCHRGB            PIC 99.
  4239         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4240         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4241
  4242     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4243         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4244             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4245         16  PB-C-CANCEL-ORIGIN           PIC X.
  4246             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4247         16  PB-C-LF-CANCEL-DT            PIC XX.
  4248         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4249         16  PB-C-LF-CALC-REQ             PIC X.
  4250             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4251         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4252         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4253         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4254             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4255         16  PB-C-AH-CANCEL-DT            PIC XX.
  4256         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4257         16  PB-C-AH-CALC-REQ             PIC X.
  4258             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4259         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4260         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4261         16  PB-C-LAST-NAME               PIC X(15).
  4262         16  PB-C-REFUND-SW               PIC X.
  4263             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4264             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4265         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4266         16  PB-C-PAYEE-CODE              PIC X(6).
  4267         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4268         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4269         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4270         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4271         16  PB-C-REFERENCE               PIC X(12).
  4272         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4273         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4274         16  PB-C-POST-CARD-IND           PIC X.
  4275         16  PB-C-CANCEL-REASON           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  80
* EL050.cbl
  4276         16  PB-C-REF-INTERFACE-SW        PIC X.
  4277         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4278         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4279         16  FILLER                       PIC X(01).
  4280*        16  FILLER                       PIC X(18).
  4281         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4282*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4283         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4284         16  PB-CANCELED-CERT-DATA.
  4285             20  PB-CI-INSURED-NAME.
  4286                 24  PB-CI-LAST-NAME      PIC X(15).
  4287                 24  PB-CI-INITIALS       PIC XX.
  4288             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4289             20  PB-CI-INSURED-SEX        PIC X.
  4290             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4291             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4292             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4293             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4294             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4295             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4296             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4297             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4298             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4299             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4300             20  PB-CI-RATE-CLASS         PIC XX.
  4301             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4302             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4303             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4304             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4305             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4306             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4307             20  PB-CI-LF-ABBR            PIC X(3).
  4308             20  PB-CI-AH-ABBR            PIC X(3).
  4309             20  PB-CI-OB-FLAG            PIC X.
  4310                 88  PB-CI-OB                VALUE 'B'.
  4311             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4312                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4313                                           'M' '4' '5' '9' '2'.
  4314                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4315                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4316                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4317                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4318                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4319                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4320                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4321                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4322                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4323                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4324                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4325                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4326                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4327             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4328                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4329                                           'M' '4' '5' '9' '2'.
  4330                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4331                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4332                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4333                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  81
* EL050.cbl
  4334                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4335                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4336                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4337                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4338                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4339                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4340                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4341                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4342                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4343             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4344             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4345             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4346             20  PB-CI-MEMBER-NO          PIC X(12).
  4347             20  PB-CI-INT-CODE           PIC X.
  4348                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4349                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4350             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4351             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4352             20  PB-CI-COMP-EXCP-SW       PIC X.
  4353                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4354                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4355             20  PB-CI-ENTRY-STATUS       PIC X.
  4356             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4357             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4358             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4359             20  PB-CI-DEATH-DT           PIC XX.
  4360             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4361             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4362             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4364             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4365             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4366             20  PB-CI-ENTRY-DT              PIC XX.
  4367             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4368             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4369             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4370             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4371             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4372             20  PB-CI-OLD-LOF               PIC XXX.
  4373*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4374             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4375             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4376             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4377             20  PB-CI-INDV-GRP-CD           PIC X.
  4378             20  PB-CI-BENEFICIARY-NAME.
  4379                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4380                 24  FILLER                  PIC X(15).
  4381             20  PB-CI-NOTE-SW               PIC X.
  4382             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4383             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4384             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4385             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4386             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4387             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4388             20  PB-CI-FIRST-NAME            PIC X(10).
  4389             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4390
  4391         16  FILLER                       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  82
* EL050.cbl
  4392*032306  16  FILLER                       PIC X(27).
  4393*        16  FILLER                       PIC X(46).
  4394
  4395     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4396         16  FILLER                       PIC X(10).
  4397         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4398         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4399         16  PB-M-INSURED-MID-INIT        PIC X.
  4400         16  PB-M-INSURED-AGE             PIC 99.
  4401         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4402         16  PB-M-INSURED-SEX             PIC X.
  4403         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4404         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4405         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4406         16  PB-M-INSURED-CITY-STATE.
  4407             20  PB-M-INSURED-CITY        PIC X(28).
  4408             20  PB-M-INSURED-STATE       PIC XX.
  4409         16  PB-M-INSURED-ZIP-CODE.
  4410             20  PB-M-INSURED-ZIP-PRIME.
  4411                 24  PB-M-INSURED-ZIP-1   PIC X.
  4412                     88  PB-M-CANADIAN-POST-CODE
  4413                                             VALUE 'A' THRU 'Z'.
  4414                 24  FILLER               PIC X(4).
  4415             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4416         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4417                                        PB-M-INSURED-ZIP-CODE.
  4418             20  PM-M-INS-CAN-POST1       PIC XXX.
  4419             20  PM-M-INS-CAN-POST2       PIC XXX.
  4420             20  FILLER                   PIC XXX.
  4421         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4422         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4423         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4424         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4425         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4426         16  PB-M-CRED-BENE-CITYST.
  4427             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4428             20  PB-M-CRED-BENE-STATE     PIC XX.
  4429         16  FILLER                       PIC X(92).
  4430
  4431     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4432         16  FILLER                       PIC X(10).
  4433         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4434         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4435         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4436         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4437         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4438         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4439         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4440         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4441         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4442         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4443         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4444         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4445         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4446         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4447         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4448         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4449         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  83
* EL050.cbl
  4450         16  PB-ACCOUNT-NAME              PIC X(30).
  4451         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4452         16  PB-REFERENCE                 PIC X(12).
  4453         16  PB-B-RECEIVED-DT             PIC XX.
  4454         16  FILLER                       PIC X(234).
  4455
  4456     12  PB-RECORD-STATUS.
  4457         16  PB-CREDIT-SELECT-DT          PIC XX.
  4458         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4459         16  PB-BILLED-DT                 PIC XX.
  4460         16  PB-BILLING-STATUS            PIC X.
  4461             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4462             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4463             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4464         16  PB-RECORD-BILL               PIC X.
  4465             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4466             88  PB-RECORD-RETURNED           VALUE 'R'.
  4467             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4468             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4469             88  PB-OVERRIDE-AH               VALUE 'A'.
  4470             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4471         16  PB-BATCH-ENTRY               PIC X.
  4472             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4473             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4474             88  PB-REISSUED-CERT             VALUE 'E'.
  4475             88  PB-CASH-CERT                 VALUE 'C'.
  4476             88  PB-MONTHLY-CERT              VALUE 'M'.
  4477             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4478             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4479             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4480         16  PB-FORCE-CODE                PIC X.
  4481             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4482             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4483             88  PB-CANCEL-FORCE              VALUE '8'.
  4484             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4485             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4486             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4487             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4488             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4489             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4490             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4491         16  PB-FATAL-FLAG                PIC X.
  4492             88  PB-FATAL-ERRORS              VALUE 'X'.
  4493         16  PB-FORCE-ER-CD               PIC X.
  4494             88  PB-FORCE-ERRORS              VALUE 'F'.
  4495             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4496         16  PB-WARN-ER-CD                PIC X.
  4497             88  PB-WARNING-ERRORS            VALUE 'W'.
  4498         16  FILLER                       PIC X.
  4499         16  PB-OUT-BAL-CD                PIC X.
  4500             88  PB-OUT-OF-BAL                VALUE 'O'.
  4501         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4502         16  PB-AH-OVERRIDE-L1            PIC X.
  4503         16  PB-INPUT-DT                  PIC XX.
  4504         16  PB-INPUT-BY                  PIC X(4).
  4505         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4506         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4507         16  PB-TOLERANCE-REJECT-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  84
* EL050.cbl
  4508         16  PB-LF-EARNING-METHOD         PIC X.
  4509         16  PB-AH-EARNING-METHOD         PIC X.
  4510         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4511         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4512         16  PB-REIN-CD                   PIC XXX.
  4513         16  PB-LF-REFUND-TYPE            PIC X.
  4514         16  PB-AH-REFUND-TYPE            PIC X.
  4515         16  PB-ACCT-EFF-DT               PIC XX.
  4516         16  PB-ACCT-EXP-DT               PIC XX.
  4517         16  PB-COMPANY-ID                PIC X(3).
  4518         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4519         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4520         16  PB-SV-CARRIER                PIC X.
  4521         16  PB-SV-GROUPING               PIC X(6).
  4522         16  PB-SV-STATE                  PIC XX.
  4523         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4524         16  PB-GA-BILLING-INFO.
  4525             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4526                                          PIC XX.
  4527         16  PB-SV-REMIT-TO  REDEFINES
  4528             PB-GA-BILLING-INFO           PIC X(10).
  4529         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4530         16  PB-I-LOAN-OFFICER            PIC X(5).
  4531         16  PB-I-VIN                     PIC X(17).
  4532
  4533         16  FILLER                       PIC X(04).
  4534         16  IMNET-BYPASS-SW              PIC X.
  4535
  4536******************************************************************
  4537*                COMMON EDIT ERRORS                              *
  4538******************************************************************
  4539
  4540     12  PB-COMMON-ERRORS.
  4541         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4542                                           PIC S9(4)     COMP.
  4543
  4544******************************************************************
  4545
  4546* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4547*    COPY ELC50W1.
  4548******************************************************************
  4549*                                                                *
  4550*                                                                *
  4551*                             ELC50W1                            *
  4552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4553*                            VMOD=2.004                          *
  4554*                                                                *
  4555*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4556*                                                                *
  4557*                                                                *
  4558******************************************************************
  4559
  4560     12  WK-WORK-AREA.
  4561         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4562         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4563         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4564         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4565         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  85
* EL050.cbl
  4566         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4567         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4568         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4569         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4570         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4571         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4572         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4573         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4574         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4575         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4576         16  WK-CREDIT-EDIT-CONTROLS.
  4577             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4578             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4579             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4580             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4581             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4582             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4583         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4584         16  WK-SAVE-REIN-DATA.
  4585             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4586             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4587             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4588         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4589             88  ENTRY-FROM-EL6311       VALUE '6'.
  4590         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4591         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4592     12  WK-RECORD-ADDRESSES.
  4593         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4594         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4595         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4596         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4597         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4598         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4599         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4600         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4601     12  WK-OVER-SHORT-AREA.
  4602         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4603         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4604         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4605             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4606         16  FILLER                   PIC X(5) VALUE SPACES.
  4607
  4608*    COPY ELCEDITC.
  4609******************************************************************
  4610*                                                                *
  4611*                                                                *
  4612*                            ELCEDITC                            *
  4613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4614*                            VMOD=2.012                          *
  4615*                                                                *
  4616*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4617*                     EL6313, EL050 AND EL517.                   *
  4618*                                                                *
  4619******************************************************************
  4620******************************************************************
  4621*                   C H A N G E   L O G
  4622*
  4623* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  86
* EL050.cbl
  4624*-----------------------------------------------------------------
  4625*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4626* EFFECTIVE    NUMBER
  4627*-----------------------------------------------------------------
  4628* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4629******************************************************************
  4630
  4631     12  EDIT-CRITERIA-DATA.
  4632         16  EC-CO-MONTH-END-DT       PIC XX.
  4633         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4634         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4635         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4636         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4637         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4638         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4639         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4640         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4641         16  EC-CO-REM-TERM-CALC      PIC X.
  4642               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4643               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4644               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4645               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4646
  4647         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4648               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4649               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4650               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4651               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4652               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4653               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4654               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4655               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4656               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4657               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4658
  4659         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4660               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4661               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4662               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4663               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4664               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4665               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4666               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4667               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4668
  4669         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4670                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4671                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4672
  4673         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4674                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4675                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4676                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4677                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4678                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4679                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4680                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4681                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  87
* EL050.cbl
  4682
  4683         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4684               88  EC-BR-REDUCING                   VALUE 'R'.
  4685               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4686
  4687         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4688         16  EC-BR-LF-DESC             PIC X(10).
  4689         16  EC-BR-AH-DESC             PIC X(10).
  4690         16  EC-BR-LF-COMMENT          PIC X(10).
  4691         16  EC-BR-AH-COMMENT          PIC X(10).
  4692
  4693         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4694               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4695               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4696               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4697               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4698
  4699         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4700               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4701               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4702               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4703               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4704
  4705         16  EC-BR-LF-REFUND-CALC      PIC X.
  4706                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4707                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4708                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4709                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4710                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4711                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4712                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4713
  4714         16  EC-BR-AH-REFUND-CALC      PIC X.
  4715                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4716                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4717                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4718                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4719                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4720                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4721                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4722                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4723
  4724         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4725                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4726                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4727                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4728
  4729         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4730                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4731                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4732                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4733
  4734         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4735         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4736         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4737         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4738
  4739         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  88
* EL050.cbl
  4740         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4741                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4742                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4743                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4744                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4745
  4746         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4747               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4748               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4749               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4750               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4751               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4752
  4753         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4754               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4755               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4756               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4757               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4758               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4759
  4760         16  EC-ST-LF-REFUND-CALC      PIC X.
  4761                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4762                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4763                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4764                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4765                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4766                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4767                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4768                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4769
  4770         16  EC-ST-AH-REFUND-CALC      PIC X.
  4771                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4772                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4773                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4774                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4775                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4776                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4777                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4778                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4779
  4780         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4781         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4782         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4783         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4784         16  EC-AM-EXPIRATION-DT       PIC XX.
  4785         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4786         16  EC-AM-CLASS-CD            PIC XX.
  4787         16  EC-AM-LF-DEVIATION        PIC XXX.
  4788         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4789         16  EC-AM-AH-DEVIATION        PIC XXX.
  4790         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4791         16  EC-AM-PHONE-NO            PIC X(10).
  4792
  4793         16  EC-AM-LF-REFUND-CALC      PIC X.
  4794                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4795                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4796                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4797                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  89
* EL050.cbl
  4798                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4799                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4800                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4801
  4802         16  EC-AM-AH-REFUND-CALC      PIC X.
  4803                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4804                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4805                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4806                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4807                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4808                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4809                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4810
  4811         16  EC-AM-BEN-I-G-CD          PIC X.
  4812                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4813                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4814                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4815
  4816         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4817         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4818         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4819         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4820         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4821         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4822         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4823         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4824         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4825
  4826         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4827         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4828         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4829         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4830         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4831         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4832         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4833         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4834         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4835         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4836         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4837         16  EC-RT-LF-NSP-ST           PIC XX.
  4838         16  EC-RT-AH-NSP-ST           PIC XX.
  4839         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4840         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4841
  4842         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4843             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4844                                             'M' '5' '9' '2'.
  4845             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4846             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4847             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4848             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4849             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4850             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4851             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4852             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4853             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4854             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4855
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  90
* EL050.cbl
  4856         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4857             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4858                                             'M' '5' '9' '2'.
  4859             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4860             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4861             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4862             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4863             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4864             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4865             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4866             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4867             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4868             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4869
  4870         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4871         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4872         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4873         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4874         16  EC-CM-DEATH-DT            PIC XX.
  4875
  4876*DMD CUSTOM CODING FIELDS BELOW
  4877*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4878         16  EC-BR-DMD-RATING-SW       PIC X.
  4879                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4880                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4881                 88  NO-DMD-RATING               VALUE 'N'.
  4882
  4883         16  EC-NEW-CERT               PIC X(11).
  4884         16  EC-NEW-STATE              PIC XX.
  4885         16  FILLER                    PIC X.
  4886*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4887         16  OVER-SHORT-EDIT-FIELDS.
  4888             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4889             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4890             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4891             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4892             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4893             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4894             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4895             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4896             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4897         16  FILLER                    PIC X(71).
  4898******************************************************************
  4899
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  91
* EL050.cbl
  4901*    COPY ELCDIFRD.
  4902******************************************************************
  4903*                                                                *
  4904*                                                                *
  4905*                            ELCDIFRD.                           *
  4906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4907*                            VMOD=2.004                          *
  4908*                                                                *
  4909*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4910*                                                                *
  4911******************************************************************
  4912*
  4913  01  WS-DIFFERENCE-CALCULATION.
  4914        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4915        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4916        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4917        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4918        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4919        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4920        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4921        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4922        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4923        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4924        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4925
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  92
* EL050.cbl
  4927****************************************************************
  4928*
  4929* Copyright (c) 2007 by Clerity Solutions, Inc.
  4930* All rights reserved.
  4931*
  4932****************************************************************
  4933 01  DFHEIV.
  4934   02  DFHEIV0               PIC X(35).
  4935   02  DFHEIV1               PIC X(08).
  4936   02  DFHEIV2               PIC X(08).
  4937   02  DFHEIV3               PIC X(08).
  4938   02  DFHEIV4               PIC X(06).
  4939   02  DFHEIV5               PIC X(04).
  4940   02  DFHEIV6               PIC X(04).
  4941   02  DFHEIV7               PIC X(02).
  4942   02  DFHEIV8               PIC X(02).
  4943   02  DFHEIV9               PIC X(01).
  4944   02  DFHEIV10              PIC S9(7) COMP-3.
  4945   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4946   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4947   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4948   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4949   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4950   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4951   02  DFHEIV17              PIC X(04).
  4952   02  DFHEIV18              PIC X(04).
  4953   02  DFHEIV19              PIC X(04).
  4954   02  DFHEIV20              USAGE IS POINTER.
  4955   02  DFHEIV21              USAGE IS POINTER.
  4956   02  DFHEIV22              USAGE IS POINTER.
  4957   02  DFHEIV23              USAGE IS POINTER.
  4958   02  DFHEIV24              USAGE IS POINTER.
  4959   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4960   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4961   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4962   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4963   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4964   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4965   02  FILLER                PIC X(02).
  4966   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4967   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4968   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4969   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4970   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4971 LINKAGE  SECTION.
  4972*****************************************************************
  4973*                                                               *
  4974* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4975* All rights reserved.                                          *
  4976*                                                               *
  4977*****************************************************************
  4978 01  dfheiblk.
  4979     02  eibtime          pic s9(7) comp-3.
  4980     02  eibdate          pic s9(7) comp-3.
  4981     02  eibtrnid         pic x(4).
  4982     02  eibtaskn         pic s9(7) comp-3.
  4983     02  eibtrmid         pic x(4).
  4984     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  93
* EL050.cbl
  4985     02  eibcposn         pic s9(4) comp.
  4986     02  eibcalen         pic s9(4) comp.
  4987     02  eibaid           pic x(1).
  4988     02  eibfiller1       pic x(1).
  4989     02  eibfn            pic x(2).
  4990     02  eibfiller2       pic x(2).
  4991     02  eibrcode         pic x(6).
  4992     02  eibfiller3       pic x(2).
  4993     02  eibds            pic x(8).
  4994     02  eibreqid         pic x(8).
  4995     02  eibrsrce         pic x(8).
  4996     02  eibsync          pic x(1).
  4997     02  eibfree          pic x(1).
  4998     02  eibrecv          pic x(1).
  4999     02  eibsend          pic x(1).
  5000     02  eibatt           pic x(1).
  5001     02  eibeoc           pic x(1).
  5002     02  eibfmh           pic x(1).
  5003     02  eibcompl         pic x(1).
  5004     02  eibsig           pic x(1).
  5005     02  eibconf          pic x(1).
  5006     02  eiberr           pic x(1).
  5007     02  eibrldbk         pic x(1).
  5008     02  eiberrcd         pic x(4).
  5009     02  eibsynrb         pic x(1).
  5010     02  eibnodat         pic x(1).
  5011     02  eibfiller5       pic x(2).
  5012     02  eibresp          pic 9(09) comp.
  5013     02  eibresp2         pic 9(09) comp.
  5014     02  dfheigdj         pic s9(4) comp.
  5015     02  dfheigdk         pic s9(4) comp.
  5016
  5017 01  DFHCOMMAREA                   PIC X(1036).
  5018
  5019*01 PARMLIST .
  5020*    02  FILLER                    PIC S9(8)   COMP.
  5021*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5022*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5023*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5024*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5025*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5026*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5027*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5028
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  94
* EL050.cbl
  5030*    COPY ELCCNTL.
  5031******************************************************************
  5032*                                                                *
  5033*                                                                *
  5034*                            ELCCNTL.                            *
  5035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5036*                            VMOD=2.059                          *
  5037*                                                                *
  5038*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5039*                                                                *
  5040*   FILE TYPE = VSAM,KSDS                                        *
  5041*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5042*                                                                *
  5043*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5044*       ALTERNATE INDEX = NONE                                   *
  5045*                                                                *
  5046*   LOG = YES                                                    *
  5047*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5048******************************************************************
  5049*                   C H A N G E   L O G
  5050*
  5051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5052*-----------------------------------------------------------------
  5053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5054* EFFECTIVE    NUMBER
  5055*-----------------------------------------------------------------
  5056* 082503                   PEMA  ADD BENEFIT GROUP
  5057* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5058* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5059* 092705    2005050300006  PEMA  ADD SPP LEASES
  5060* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5061* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5062* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5063* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5064* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5065* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5066* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5067* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5068* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5069* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5070******************************************************************
  5071*
  5072 01  CONTROL-FILE.
  5073     12  CF-RECORD-ID                       PIC XX.
  5074         88  VALID-CF-ID                        VALUE 'CF'.
  5075
  5076     12  CF-CONTROL-PRIMARY.
  5077         16  CF-COMPANY-ID                  PIC XXX.
  5078         16  CF-RECORD-TYPE                 PIC X.
  5079             88  CF-COMPANY-MASTER              VALUE '1'.
  5080             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5081             88  CF-STATE-MASTER                VALUE '3'.
  5082             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5083             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5084             88  CF-CARRIER-MASTER              VALUE '6'.
  5085             88  CF-MORTALITY-MASTER            VALUE '7'.
  5086             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5087             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  95
* EL050.cbl
  5088             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5089             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5090             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5091             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5092             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5093             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5094             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5095             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5096             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5097         16  CF-ACCESS-CD-GENL              PIC X(4).
  5098         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5099             20  CF-PROCESSOR               PIC X(4).
  5100         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5101             20  CF-STATE-CODE              PIC XX.
  5102             20  FILLER                     PIC XX.
  5103         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5104             20  FILLER                     PIC XX.
  5105             20  CF-HI-BEN-IN-REC           PIC XX.
  5106         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5107             20  FILLER                     PIC XXX.
  5108             20  CF-CARRIER-CNTL            PIC X.
  5109         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5110             20  FILLER                     PIC XX.
  5111             20  CF-HI-TYPE-IN-REC          PIC 99.
  5112         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5113             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5114                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5115             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5116             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5117         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5118             20  FILLER                     PIC X.
  5119             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5120         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5121             20  FILLER                     PIC XX.
  5122             20  CF-MORTGAGE-PLAN           PIC XX.
  5123         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5124
  5125     12  CF-LAST-MAINT-DT                   PIC XX.
  5126     12  CF-LAST-MAINT-BY                   PIC X(4).
  5127     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5128
  5129     12  CF-RECORD-BODY                     PIC X(728).
  5130
  5131
  5132****************************************************************
  5133*             COMPANY MASTER RECORD                            *
  5134****************************************************************
  5135
  5136     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5137         16  CF-COMPANY-ADDRESS.
  5138             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5139             20  CF-CL-IN-CARE-OF           PIC X(30).
  5140             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5141             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5142             20  CF-CL-CITY-STATE           PIC X(30).
  5143             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5144             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5145         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  96
* EL050.cbl
  5146         16  CF-COMPANY-PASSWORD            PIC X(8).
  5147         16  CF-SECURITY-OPTION             PIC X.
  5148             88  ALL-SECURITY                   VALUE '1'.
  5149             88  COMPANY-VERIFY                 VALUE '2'.
  5150             88  PROCESSOR-VERIFY               VALUE '3'.
  5151             88  NO-SECURITY                    VALUE '4'.
  5152             88  ALL-BUT-TERM                   VALUE '5'.
  5153         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5154             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5155         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5156             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5157         16  CF-INFORCE-LOCATION            PIC X.
  5158             88  CERTS-ARE-ONLINE               VALUE '1'.
  5159             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5160             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5161         16  CF-LOWER-CASE-LETTERS          PIC X.
  5162         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5163             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5164             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5165             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5166             88  CF-ACCNT-CNTL                  VALUE '3'.
  5167             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5168
  5169         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5170         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5171
  5172         16  CF-LGX-CREDIT-USER             PIC X.
  5173             88  CO-IS-NOT-USER                 VALUE 'N'.
  5174             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5175
  5176         16 CF-CREDIT-CALC-CODES.
  5177             20  CF-CR-REM-TERM-CALC PIC X.
  5178               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5179               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5180               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5181               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5182               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5183               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5184               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5185             20  CF-CR-R78-METHOD           PIC X.
  5186               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5187               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5188
  5189         16  CF-CLAIM-CONTROL-COUNTS.
  5190             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5191                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5192
  5193             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5194                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5195
  5196             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5197                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5198
  5199             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5200                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5201
  5202         16  CF-CURRENT-MONTH-END           PIC XX.
  5203
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  97
* EL050.cbl
  5204         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5205             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5206             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5207             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5208             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5209                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5210                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5211             20  CF-CO-PREM-REJECT-SW       PIC X.
  5212                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5213                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5214             20  CF-CO-REF-REJECT-SW        PIC X.
  5215                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5216                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5217
  5218         16  CF-CO-REPORTING-DT             PIC XX.
  5219         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5220         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5221           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5222           88  CF-CO-MONTH-END                  VALUE '1'.
  5223
  5224         16  CF-LGX-CLAIM-USER              PIC X.
  5225             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5226             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5227
  5228         16  CF-CREDIT-EDIT-CONTROLS.
  5229             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5230             20  CF-MIN-AGE                 PIC 99.
  5231             20  CF-DEFAULT-AGE             PIC 99.
  5232             20  CF-MIN-TERM                PIC S999      COMP-3.
  5233             20  CF-MAX-TERM                PIC S999      COMP-3.
  5234             20  CF-DEFAULT-SEX             PIC X.
  5235             20  CF-JOINT-AGE-INPUT         PIC X.
  5236                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5237             20  CF-BIRTH-DATE-INPUT        PIC X.
  5238                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5239             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5240                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5241                 88  CF-ZERO-CARRIER            VALUE '1'.
  5242                 88  CF-ZERO-GROUPING           VALUE '2'.
  5243                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5244             20  CF-EDIT-SW                 PIC X.
  5245                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5246             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5247             20  CF-CR-PR-METHOD            PIC X.
  5248               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5249               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5250             20  FILLER                     PIC X.
  5251
  5252         16  CF-CREDIT-MISC-CONTROLS.
  5253             20  CF-REIN-TABLE-SW           PIC X.
  5254                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5255             20  CF-COMP-TABLE-SW           PIC X.
  5256                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5257             20  CF-EXPERIENCE-RETENTION-AGE
  5258                                            PIC S9        COMP-3.
  5259             20  CF-CONVERSION-DT           PIC XX.
  5260             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5261             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  98
* EL050.cbl
  5262                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5263                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5264
  5265             20  CF-CR-CHECK-NO-CONTROL.
  5266                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5267                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5268                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5269                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5270                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5271                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5272
  5273                 24  CF-CR-CHECK-COUNT       REDEFINES
  5274                     CF-CR-CHECK-COUNTER      PIC X(4).
  5275
  5276                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5277                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5278
  5279                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5280                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5281                 24  CF-MAIL-PROCESSING       PIC X.
  5282                     88  MAIL-PROCESSING          VALUE 'Y'.
  5283
  5284         16  CF-MISC-SYSTEM-CONTROL.
  5285             20  CF-SYSTEM-C                 PIC X.
  5286                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5287             20  CF-SYSTEM-D                 PIC X.
  5288                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5289             20  CF-SOC-SEC-NO-SW            PIC X.
  5290                 88  SOC-SEC-NO-USED             VALUE '1'.
  5291             20  CF-MEMBER-NO-SW             PIC X.
  5292                 88  MEMBER-NO-USED              VALUE '1'.
  5293             20  CF-TAX-ID-NUMBER            PIC X(11).
  5294             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5295             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5296                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5297                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5298                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5299                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5300             20  CF-SYSTEM-E                 PIC X.
  5301                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5302
  5303         16  CF-LGX-LIFE-USER               PIC X.
  5304             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5305             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5306
  5307         16  CF-CR-MONTH-END-DT             PIC XX.
  5308
  5309         16  CF-FILE-MAINT-DATES.
  5310             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5311                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5312             20  CF-LAST-BATCH       REDEFINES
  5313                 CF-LAST-BATCH-NO               PIC X(4).
  5314             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5315             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5316             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5317             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5318             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5319             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page  99
* EL050.cbl
  5320             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5321             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5322             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5323             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5324
  5325         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5326         16  FILLER                         PIC X.
  5327
  5328         16  CF-ALT-MORT-CODE               PIC X(4).
  5329         16  CF-MEMBER-CAPTION              PIC X(10).
  5330
  5331         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5332             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5333             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5334             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5335             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5336             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5337
  5338         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5339
  5340         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5341         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5342         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5343         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5344
  5345         16  CF-AH-OVERRIDE-L1              PIC X.
  5346         16  CF-AH-OVERRIDE-L2              PIC XX.
  5347         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5348         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5349
  5350         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5351         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5352
  5353         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5354         16  CF-AR-LAST-EL860-DT            PIC XX.
  5355         16  CF-MP-MONTH-END-DT             PIC XX.
  5356
  5357         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5358         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5359             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5360
  5361         16  CF-AR-MONTH-END-DT             PIC XX.
  5362
  5363         16  CF-CRDTCRD-USER                PIC X.
  5364             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5365             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5366
  5367         16  CF-CC-MONTH-END-DT             PIC XX.
  5368
  5369         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5370
  5371         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5372             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5373             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5374             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5375         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5376         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5377         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 100
* EL050.cbl
  5378         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5379             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5380             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5381         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5382         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5383         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5384             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5385         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5386
  5387         16  CF-CL-ZIP-CODE.
  5388             20  CF-CL-ZIP-PRIME.
  5389                 24  CF-CL-ZIP-1ST          PIC X.
  5390                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5391                 24  FILLER                 PIC X(4).
  5392             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5393         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5394             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5395             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5396             20  FILLER                     PIC XXX.
  5397
  5398         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5399         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5400         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5401         16  CF-CO-OPTION-START-DATE        PIC XX.
  5402         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5403           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5404                                                      '3' '4'.
  5405           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5406           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5407           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5408           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5409           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5410           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5411
  5412         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5413
  5414         16  CF-PAYMENT-APPROVAL-LEVELS.
  5415             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5416             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5417             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5418             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5419             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5420             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5421
  5422         16  CF-END-USER-REPORTING-USER     PIC X.
  5423             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5424             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5425
  5426         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5427             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5428             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5429
  5430         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5431
  5432         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5433         16  FILLER                         PIC X.
  5434
  5435         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 101
* EL050.cbl
  5436             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5437             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5438             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5439
  5440         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5441
  5442         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5443             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5444             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5445
  5446         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5447             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5448             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5449
  5450         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5451
  5452         16  CF-CO-ACH-ID-CODE              PIC  X.
  5453             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5454             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5455             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5456         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5457         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5458         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5459         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5460         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5461         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5462         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5463         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5464         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5465                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5466         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5467                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5468
  5469         16  CF-CO-OVER-SHORT.
  5470             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5471             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5472
  5473*         16  FILLER                         PIC X(102).
  5474         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5475             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5476             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5477
  5478         16  CF-AH-APPROVAL-DAYS.
  5479             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5480             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5481             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5482             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5483
  5484         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5485
  5486         16  CF-APPROV-LEV-5.
  5487             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5488             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5489             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5490
  5491         16  FILLER                         PIC X(68).
  5492****************************************************************
  5493*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 102
* EL050.cbl
  5494****************************************************************
  5495
  5496     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5497         16  CF-PROCESSOR-NAME              PIC X(30).
  5498         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5499         16  CF-PROCESSOR-TITLE             PIC X(26).
  5500         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5501                 88  MESSAGE-YES                VALUE 'Y'.
  5502                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5503
  5504*****************************************************
  5505****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5506****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5507****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5508****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5509*****************************************************
  5510
  5511         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5512             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5513             20  CF-APPLICATION-FORCE       PIC X.
  5514             20  CF-INDIVIDUAL-APP.
  5515                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5516                     28  CF-BROWSE-APP      PIC X.
  5517                     28  CF-UPDATE-APP      PIC X.
  5518
  5519         16  CF-CURRENT-TERM-ON             PIC X(4).
  5520         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5521             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5522             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5523             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5524             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5525             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5526             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5527             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5528         16  CF-PROCESSOR-CARRIER           PIC X.
  5529             88  NO-CARRIER-SECURITY            VALUE ' '.
  5530         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5531             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5532         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5533             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5534         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5535             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5536
  5537         16  CF-PROC-SYS-ACCESS-SW.
  5538             20  CF-PROC-CREDIT-CLAIMS-SW.
  5539                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5540                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5541                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5542                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5543             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5544                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5545                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5546             20  CF-PROC-LIFE-GNRLDGR-SW.
  5547                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5548                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5549                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5550                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5551             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 103
* EL050.cbl
  5552                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5553                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5554         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5555             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5556             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5557         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5558
  5559         16  CF-APPROVAL-LEVEL                  PIC X.
  5560             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5561             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5562             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5563             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5564             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5565
  5566         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5567
  5568         16  CF-LANGUAGE-TYPE                   PIC X.
  5569             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5570             88  CF-LANG-IS-FR                      VALUE 'F'.
  5571
  5572         16  CF-CSR-IND                         PIC X.
  5573         16  FILLER                             PIC X(239).
  5574
  5575****************************************************************
  5576*             PROCESSOR/REMINDERS RECORD                       *
  5577****************************************************************
  5578
  5579     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5580         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5581             20  CF-START-REMIND-DT         PIC XX.
  5582             20  CF-END-REMIND-DT           PIC XX.
  5583             20  CF-REMINDER-TEXT           PIC X(50).
  5584         16  FILLER                         PIC X(296).
  5585
  5586
  5587****************************************************************
  5588*             STATE MASTER RECORD                              *
  5589****************************************************************
  5590
  5591     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5592         16  CF-STATE-ABBREVIATION          PIC XX.
  5593         16  CF-STATE-NAME                  PIC X(25).
  5594         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5595         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5596             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5597             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5598             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5599             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5600                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5601                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5602             20  CF-ST-PREM-REJECT-SW       PIC X.
  5603                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5604                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5605             20  CF-ST-REF-REJECT-SW        PIC X.
  5606                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5607                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5608         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5609         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 104
* EL050.cbl
  5610         16  CF-ST-REFUND-RULES.
  5611             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5612             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5613             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5614         16  CF-ST-FST-PMT-EXTENSION.
  5615             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5616             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5617                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5618                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5619                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5620                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5621         16  CF-ST-STATE-CALL.
  5622             20  CF-ST-CALL-UNEARNED        PIC X.
  5623             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5624             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5625         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5626             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5627             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5628         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5629         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5630         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5631         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5632         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5633         16  FILLER                         PIC X.
  5634         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5635             20  CF-ST-BENEFIT-CD           PIC XX.
  5636             20  CF-ST-BENEFIT-KIND         PIC X.
  5637                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5638                 88  CF-ST-AH-KIND              VALUE 'A'.
  5639             20  CF-ST-REM-TERM-CALC        PIC X.
  5640                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5641                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5642                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5643                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5644                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5645                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5646                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5647                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5648
  5649             20  CF-ST-REFUND-CALC          PIC X.
  5650                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5651                 88  ST-REFD-BY-R78             VALUE '1'.
  5652                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5654                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5655                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5657                 88  ST-REFD-UTAH               VALUE '7'.
  5658                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5659                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5660                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5661
  5662             20  CF-ST-EARNING-CALC         PIC X.
  5663                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5664                 88  ST-EARN-BY-R78             VALUE '1'.
  5665                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5666                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5667                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 105
* EL050.cbl
  5668                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5669                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5670                 88  ST-EARN-MEAN               VALUE '8'.
  5671                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5672
  5673             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5674                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5675                 88  ST-OVRD-BY-R78             VALUE '1'.
  5676                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5677                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5678                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5679                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5680                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5681                 88  ST-OVRD-MEAN               VALUE '8'.
  5682                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5683             20  cf-st-extra-periods        pic 9.
  5684*            20  FILLER                     PIC X.
  5685
  5686         16  CF-ST-COMMISSION-CAPS.
  5687             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5688             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5689             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5690             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5691         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5692                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5693
  5694         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5695
  5696         16  CF-ST-STATUTORY-INTEREST.
  5697             20  CF-ST-STAT-DATE-FROM       PIC X.
  5698                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5699                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5700             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5701             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5702             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5703             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5704             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5705
  5706         16  CF-ST-OVER-SHORT.
  5707             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5708             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5709
  5710         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5711
  5712         16  CF-ST-RT-CALC                  PIC X.
  5713
  5714         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5715         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5716         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5717         16  CF-ST-RF-LR-CALC               PIC X.
  5718         16  CF-ST-RF-LL-CALC               PIC X.
  5719         16  CF-ST-RF-LN-CALC               PIC X.
  5720         16  CF-ST-RF-AH-CALC               PIC X.
  5721         16  CF-ST-RF-CP-CALC               PIC X.
  5722*        16  FILLER                         PIC X(206).
  5723*CIDMOD         16  FILLER                         PIC X(192).
  5724         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5725             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 106
* EL050.cbl
  5726         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5727         16  CF-ST-VFY-2ND-BENE             PIC X.
  5728         16  CF-ST-CAUSAL-STATE             PIC X.
  5729         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5730         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5731         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5732             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5733         16  CF-ST-NET-ONLY-STATE           PIC X.
  5734             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5735         16  FILLER                         PIC X(181).
  5736
  5737****************************************************************
  5738*             BENEFIT MASTER RECORD                            *
  5739****************************************************************
  5740
  5741     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5742         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5743             20  CF-BENEFIT-CODE            PIC XX.
  5744             20  CF-BENEFIT-NUMERIC  REDEFINES
  5745                 CF-BENEFIT-CODE            PIC XX.
  5746             20  CF-BENEFIT-ALPHA           PIC XXX.
  5747             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5748             20  CF-BENEFIT-COMMENT         PIC X(10).
  5749
  5750             20  CF-LF-COVERAGE-TYPE        PIC X.
  5751                 88  CF-REDUCING                VALUE 'R'.
  5752                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5753
  5754             20  CF-SPECIAL-CALC-CD         PIC X.
  5755                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5756                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5757                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5758                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5759                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5760                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5761                 88  CF-FARM-PLAN               VALUE 'F'.
  5762                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5763                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5764                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5765                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5766                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5767                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5768                 88  CF-PRUDENTIAL              VALUE 'P'.
  5769                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5770                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5771                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5772                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5773                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5774                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5775
  5776             20  CF-JOINT-INDICATOR         PIC X.
  5777                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5778
  5779*            20  FILLER                     PIC X(12).
  5780             20  cf-maximum-benefits        pic s999 comp-3.
  5781             20  FILLER                     PIC X(09).
  5782             20  CF-BENEFIT-CATEGORY        PIC X.
  5783             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 107
* EL050.cbl
  5784
  5785             20  CF-CO-REM-TERM-CALC        PIC X.
  5786                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5787                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5788                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5789                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5790                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5791
  5792             20  CF-CO-EARNINGS-CALC        PIC X.
  5793                 88  CO-EARN-BY-R78             VALUE '1'.
  5794                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5795                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5796                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5797                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5798                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5799                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5800                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5801
  5802             20  CF-CO-REFUND-CALC          PIC X.
  5803                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5804                 88  CO-REFD-BY-R78             VALUE '1'.
  5805                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5807                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-REFD-MEAN               VALUE '8'.
  5811                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5812                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5813                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5814
  5815             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5816                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5817                 88  CO-OVRD-BY-R78             VALUE '1'.
  5818                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5819                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5820                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5821                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5822                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5823                 88  CO-OVRD-MEAN               VALUE '8'.
  5824                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5825
  5826             20  CF-CO-BEN-I-G-CD           PIC X.
  5827                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5828                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5829                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5830
  5831         16  FILLER                         PIC X(304).
  5832
  5833
  5834****************************************************************
  5835*             CARRIER MASTER RECORD                            *
  5836****************************************************************
  5837
  5838     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5839         16  CF-ADDRESS-DATA.
  5840             20  CF-MAIL-TO-NAME            PIC X(30).
  5841             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 108
* EL050.cbl
  5842             20  CF-ADDRESS-LINE-1          PIC X(30).
  5843             20  CF-ADDRESS-LINE-2          PIC X(30).
  5844             20  CF-CITY-STATE              PIC X(30).
  5845             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5846             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5847
  5848         16  CF-CLAIM-NO-CONTROL.
  5849             20  CF-CLAIM-NO-METHOD         PIC X.
  5850                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5851                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5852                 88  CLAIM-NO-SEQ               VALUE '3'.
  5853                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5854             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5855                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5856                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5857                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5858
  5859         16  CF-CHECK-NO-CONTROL.
  5860             20  CF-CHECK-NO-METHOD         PIC X.
  5861                 88  CHECK-NO-MANUAL            VALUE '1'.
  5862                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5863                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5864                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5865             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5866                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5867
  5868         16  CF-DOMICILE-STATE              PIC XX.
  5869
  5870         16  CF-EXPENSE-CONTROLS.
  5871             20  CF-EXPENSE-METHOD          PIC X.
  5872                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5873                 88  DOLLARS-PER-PMT            VALUE '2'.
  5874                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5875                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5876             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5877             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5878
  5879         16  CF-CORRESPONDENCE-CONTROL.
  5880             20  CF-LETTER-RESEND-OPT       PIC X.
  5881                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5882                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5883             20  FILLER                     PIC X(4).
  5884
  5885         16  CF-RESERVE-CONTROLS.
  5886             20  CF-MANUAL-SW               PIC X.
  5887                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5888             20  CF-FUTURE-SW               PIC X.
  5889                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5890             20  CF-PTC-SW                  PIC X.
  5891                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5892             20  CF-IBNR-SW                 PIC X.
  5893                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5894             20  CF-PTC-LF-SW               PIC X.
  5895                 88  CF-LF-PTC-USED             VALUE '1'.
  5896             20  CF-CDT-ACCESS-METHOD       PIC X.
  5897                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5898                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5899                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 109
* EL050.cbl
  5900             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5901
  5902         16  CF-CLAIM-CALC-METHOD           PIC X.
  5903             88  360-PLUS-MONTHS                VALUE '1'.
  5904             88  365-PLUS-MONTHS                VALUE '2'.
  5905             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5906             88  360-DAILY                      VALUE '4'.
  5907             88  365-DAILY                      VALUE '5'.
  5908
  5909         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5910         16  FILLER                         PIC X(11).
  5911
  5912         16  CF-LIMIT-AMOUNTS.
  5913             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5914             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5915             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5916             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5917             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5918             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5919             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5920             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5921             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5922             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5923
  5924         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5925         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5926         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5927
  5928         16  CF-ZIP-CODE.
  5929             20  CF-ZIP-PRIME.
  5930                 24  CF-ZIP-1ST             PIC X.
  5931                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5932                 24  FILLER                 PIC X(4).
  5933             20  CF-ZIP-PLUS4               PIC X(4).
  5934         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5935             20  CF-CAN-POSTAL-1            PIC XXX.
  5936             20  CF-CAN-POSTAL-2            PIC XXX.
  5937             20  FILLER                     PIC XXX.
  5938
  5939         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5940         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5941         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5942
  5943         16  CF-RATING-SWITCH               PIC X.
  5944             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5945             88  CF-NO-RATING                   VALUE 'N'.
  5946
  5947         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5948
  5949         16  CF-CARRIER-OVER-SHORT.
  5950             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5951             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5952
  5953         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5954         16  CF-SECPAY-SWITCH               PIC X.
  5955             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5956             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5957         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 110
* EL050.cbl
  5958         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5959         16  FILLER                         PIC X(444).
  5960*        16  FILLER                         PIC X(452).
  5961
  5962
  5963****************************************************************
  5964*             MORTALITY MASTER RECORD                          *
  5965****************************************************************
  5966
  5967     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5968         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5969                                INDEXED BY CF-MORT-NDX.
  5970             20  CF-MORT-TABLE              PIC X(5).
  5971             20  CF-MORT-TABLE-TYPE         PIC X.
  5972                 88  CF-MORT-JOINT              VALUE 'J'.
  5973                 88  CF-MORT-SINGLE             VALUE 'S'.
  5974                 88  CF-MORT-COMBINED           VALUE 'C'.
  5975                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5976                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5977             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5978             20  CF-MORT-AGE-METHOD         PIC XX.
  5979                 88  CF-AGE-LAST                VALUE 'AL'.
  5980                 88  CF-AGE-NEAR                VALUE 'AN'.
  5981             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5982             20  CF-MORT-ADJUSTMENT-DIRECTION
  5983                                            PIC X.
  5984                 88  CF-MINUS                   VALUE '-'.
  5985                 88  CF-PLUS                    VALUE '+'.
  5986             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5987             20  CF-MORT-JOINT-CODE         PIC X.
  5988                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5989             20  CF-MORT-PC-Q               PIC X.
  5990                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5991             20  CF-MORT-TABLE-CODE         PIC X(4).
  5992             20  CF-MORT-COMMENTS           PIC X(15).
  5993             20  FILLER                     PIC X(14).
  5994
  5995         16  FILLER                         PIC X(251).
  5996
  5997
  5998****************************************************************
  5999*             BUSSINESS TYPE MASTER RECORD                     *
  6000****************************************************************
  6001
  6002     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6003* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6004* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6005* AND RECORD 05 IS TYPES 81-99
  6006         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6007             20  CF-BUSINESS-TITLE          PIC  X(19).
  6008             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6009                                            PIC S9V9(4) COMP-3.
  6010             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6011             20  FILLER                     PIC  X.
  6012         16  FILLER                         PIC  X(248).
  6013
  6014
  6015****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 111
* EL050.cbl
  6016*             TERMINAL MASTER RECORD                           *
  6017****************************************************************
  6018
  6019     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6020
  6021         16  CF-COMPANY-TERMINALS.
  6022             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6023                                  PIC X(4).
  6024         16  FILLER               PIC X(248).
  6025
  6026
  6027****************************************************************
  6028*             LIFE EDIT MASTER RECORD                          *
  6029****************************************************************
  6030
  6031     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6032         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6033             20  CF-LIFE-CODE-IN            PIC XX.
  6034             20  CF-LIFE-CODE-OUT           PIC XX.
  6035         16  FILLER                         PIC X(248).
  6036
  6037
  6038****************************************************************
  6039*             AH EDIT MASTER RECORD                            *
  6040****************************************************************
  6041
  6042     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6043         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6044             20  CF-AH-CODE-IN              PIC XXX.
  6045             20  CF-AH-CODE-OUT             PIC XX.
  6046         16  FILLER                         PIC X(248).
  6047
  6048
  6049****************************************************************
  6050*             CREDIBILITY TABLES                               *
  6051****************************************************************
  6052
  6053     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6054         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6055                             INDEXED BY CF-CRDB-NDX.
  6056             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6057             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6058             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6059         16  FILLER                         PIC  X(332).
  6060
  6061
  6062****************************************************************
  6063*             REPORT CUSTOMIZATION RECORD                      *
  6064****************************************************************
  6065
  6066     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6067         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6068             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6069             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6070             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6071**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6072****       A T-TRANSFER.                                   ****
  6073             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 112
* EL050.cbl
  6074
  6075         16  FILLER                         PIC XX.
  6076
  6077         16  CF-CARRIER-CNTL-OPT.
  6078             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6079                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6080                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6081             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6082                                            PIC X.
  6083         16  CF-GROUP-CNTL-OPT.
  6084             20  CF-GROUP-OPT-SEQ           PIC 9.
  6085                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6086                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6087             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6088                                            PIC X(6).
  6089         16  CF-STATE-CNTL-OPT.
  6090             20  CF-STATE-OPT-SEQ           PIC 9.
  6091                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6092                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6093             20  CF-STATE-SELECT OCCURS 3 TIMES
  6094                                            PIC XX.
  6095         16  CF-ACCOUNT-CNTL-OPT.
  6096             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6097                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6098                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6099             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6100                                            PIC X(10).
  6101         16  CF-BUS-TYP-CNTL-OPT.
  6102             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6103                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6104                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6105             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6106                                            PIC XX.
  6107         16  CF-LF-TYP-CNTL-OPT.
  6108             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6109                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6110                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6111             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6112                                            PIC XX.
  6113         16  CF-AH-TYP-CNTL-OPT.
  6114             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6115                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6116                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6117             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6118                                            PIC XX.
  6119         16  CF-REPTCD1-CNTL-OPT.
  6120             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6121                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6122                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6123             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6124                                            PIC X(10).
  6125         16  CF-REPTCD2-CNTL-OPT.
  6126             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6127                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6128                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6129             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6130                                            PIC X(10).
  6131         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 113
* EL050.cbl
  6132             20  CF-USER1-OPT-SEQ           PIC 9.
  6133                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6134                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6135             20  CF-USER1-SELECT OCCURS 3 TIMES
  6136                                            PIC X(10).
  6137         16  CF-USER2-CNTL-OPT.
  6138             20  CF-USER2-OPT-SEQ           PIC 9.
  6139                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6140                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6141             20  CF-USER2-SELECT OCCURS 3 TIMES
  6142                                            PIC X(10).
  6143         16  CF-USER3-CNTL-OPT.
  6144             20  CF-USER3-OPT-SEQ           PIC 9.
  6145                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6146                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6147             20  CF-USER3-SELECT OCCURS 3 TIMES
  6148                                            PIC X(10).
  6149         16  CF-USER4-CNTL-OPT.
  6150             20  CF-USER4-OPT-SEQ           PIC 9.
  6151                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6152                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6153             20  CF-USER4-SELECT OCCURS 3 TIMES
  6154                                            PIC X(10).
  6155         16  CF-USER5-CNTL-OPT.
  6156             20  CF-USER5-OPT-SEQ           PIC 9.
  6157                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6158                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6159             20  CF-USER5-SELECT OCCURS 3 TIMES
  6160                                            PIC X(10).
  6161         16  CF-REINS-CNTL-OPT.
  6162             20  CF-REINS-OPT-SEQ           PIC 9.
  6163                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6164                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6165             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6166                 24  CF-REINS-PRIME         PIC XXX.
  6167                 24  CF-REINS-SUB           PIC XXX.
  6168
  6169         16  CF-AGENT-CNTL-OPT.
  6170             20  CF-AGENT-OPT-SEQ           PIC 9.
  6171                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6172                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6173             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6174                                            PIC X(10).
  6175
  6176         16  FILLER                         PIC X(43).
  6177
  6178         16  CF-LOSS-RATIO-SELECT.
  6179             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6180             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6181         16  CF-ENTRY-DATE-SELECT.
  6182             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6183             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6184         16  CF-EFFECTIVE-DATE-SELECT.
  6185             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6186             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6187
  6188         16  CF-EXCEPTION-LIST-IND          PIC X.
  6189             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 114
* EL050.cbl
  6190
  6191         16  FILLER                         PIC X(318).
  6192
  6193****************************************************************
  6194*                  EXCEPTION REPORTING RECORD                  *
  6195****************************************************************
  6196
  6197     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6198         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6199             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6200
  6201         16  CF-COMBINED-LIFE-AH-OPT.
  6202             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6203             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6204             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6205             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6206
  6207         16  CF-LIFE-OPT.
  6208             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6209             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6210             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6211             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6212             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6213             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6214             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6215             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6216             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6217             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6218
  6219         16  CF-AH-OPT.
  6220             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6221             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6222             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6223             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6224             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6225             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6226             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6227             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6228             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6229             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6230
  6231         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6232             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6233             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6234             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6235
  6236         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6237
  6238         16  FILLER                         PIC X(673).
  6239
  6240
  6241****************************************************************
  6242*             MORTGAGE SYSTEM PLAN RECORD                      *
  6243****************************************************************
  6244
  6245     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6246         16  CF-PLAN-TYPE                   PIC X.
  6247             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 115
* EL050.cbl
  6248             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6249             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6250         16  CF-PLAN-ABBREV                 PIC XXX.
  6251         16  CF-PLAN-DESCRIPT               PIC X(10).
  6252         16  CF-PLAN-NOTES                  PIC X(20).
  6253         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6254         16  CF-PLAN-UNDERWRITING.
  6255             20  CF-PLAN-TERM-DATA.
  6256                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6257                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6258             20  CF-PLAN-AGE-DATA.
  6259                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6260                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6261                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6262             20  CF-PLAN-BENEFIT-DATA.
  6263                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6264                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6265                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6266                                            PIC S9(7)V99  COMP-3.
  6267         16  CF-PLAN-POLICY-FORMS.
  6268             20  CF-POLICY-FORM             PIC X(12).
  6269             20  CF-MASTER-APPLICATION      PIC X(12).
  6270             20  CF-MASTER-POLICY           PIC X(12).
  6271         16  CF-PLAN-RATING.
  6272             20  CF-RATE-CODE               PIC X(5).
  6273             20  CF-SEX-RATING              PIC X.
  6274                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6275                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6276             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6277             20  CF-SUB-STD-TYPE            PIC X.
  6278                 88  CF-PCT-OF-PREM            VALUE '1'.
  6279                 88  CF-PCT-OF-BENE            VALUE '2'.
  6280         16  CF-PLAN-PREM-TOLERANCES.
  6281             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6282             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6283         16  CF-PLAN-PYMT-TOLERANCES.
  6284             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6285             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6286         16  CF-PLAN-MISC-DATA.
  6287             20  FILLER                     PIC X.
  6288             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6289             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6290         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6291         16  CF-PLAN-IND-GRP                PIC X.
  6292             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6293                                                     '1'.
  6294             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6295                                                     '2'.
  6296         16  CF-MIB-SEARCH-SW               PIC X.
  6297             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6298             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6299             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6300             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6301         16  CF-ALPHA-SEARCH-SW             PIC X.
  6302             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6303             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6304             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6305             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 116
* EL050.cbl
  6306             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6307             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6308             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6309             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6310             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6311             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6312                                                     'A' 'B' 'C'
  6313                                                     'X' 'Y' 'Z'.
  6314         16  CF-EFF-DT-RULE-SW              PIC X.
  6315             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6316             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6317             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6318             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6319             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6320         16  FILLER                         PIC X(4).
  6321         16  CF-HEALTH-QUESTIONS            PIC X.
  6322             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6323         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6324         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6325         16  CF-PLAN-SNGL-JNT               PIC X.
  6326             88  CF-COMBINED-PLAN              VALUE 'C'.
  6327             88  CF-JNT-PLAN                   VALUE 'J'.
  6328             88  CF-SNGL-PLAN                  VALUE 'S'.
  6329         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6330         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6331         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6332         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6333         16  CF-RERATE-CNTL                 PIC  X.
  6334             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6335             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6336             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6337             88  CF-AUTO-RECALC                 VALUE '4'.
  6338         16  CF-BENEFIT-TYPE                PIC  X.
  6339             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6340             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6341         16  CF-POLICY-FEE                  PIC S999V99
  6342                                                    COMP-3.
  6343         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6344         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6345         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6346         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6347         16  FILLER                         PIC  X(32).
  6348         16  CF-TERMINATION-FORM            PIC  X(04).
  6349         16  FILLER                         PIC  X(08).
  6350         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6351                                                       COMP-3.
  6352         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6353         16  CF-ISSUE-LETTER                PIC  X(4).
  6354         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6355         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6356             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6357             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6358         16  CF-MP-REFUND-CALC              PIC X.
  6359             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6360             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6361             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6362             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6363             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 117
* EL050.cbl
  6364             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6365             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6366             88  CF-MP-REFD-MEAN                VALUE '8'.
  6367         16  CF-ALT-RATE-CODE               PIC  X(5).
  6368
  6369
  6370         16  FILLER                         PIC X(498).
  6371****************************************************************
  6372*             MORTGAGE COMPANY MASTER RECORD                   *
  6373****************************************************************
  6374
  6375     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6376         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6377         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6378             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6379             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6380             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6381             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6382             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6383
  6384         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6385         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6386         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6387         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6388         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6389
  6390         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6391             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6392         16  CF-MP-RECON-USE-IND            PIC X(1).
  6393             88  CF-MP-USE-RECON             VALUE 'Y'.
  6394         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6395             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6396         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6397             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6398             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6399         16  FILLER                         PIC X(1).
  6400         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6401             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6402         16  CF-MORTG-MIB-VERSION           PIC X.
  6403             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6404             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6405             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6406         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6407             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6408                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6409             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6410                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6411             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6412                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6413             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6414                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6415             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6416                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6417             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6418                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6419         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6420         16  FILLER                         PIC X(7).
  6421         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 118
* EL050.cbl
  6422             20  CF-MORTG-MIB-COMM          PIC X(5).
  6423             20  CF-MORTG-MIB-TERM          PIC X(5).
  6424         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6425             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6426         16  FILLER                         PIC X(03).
  6427         16  CF-MP-CHECK-NO-CONTROL.
  6428             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6429                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6430                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6431                                                ' ' LOW-VALUES.
  6432                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6433                                               VALUE '3'.
  6434         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6435         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6436         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6437             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6438                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6439             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6440                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6441             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6442                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6443             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6444                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6445             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6446                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6447             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6448                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6449         16  CF-MORTG-BILLING-AREA.
  6450             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6451                                            PIC X.
  6452         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6453         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6454         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6455         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6456             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6457             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6458         16  FILLER                         PIC X.
  6459         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6460             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6461             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6462         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6463         16  FILLER                         PIC X(8).
  6464         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6465         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6466         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6467         16  CF-ACH-COMPANY-ID.
  6468             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6469                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6470                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6471                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6472             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6473         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6474             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6475         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6476             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6477             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6478         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6479         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 119
* EL050.cbl
  6480         16  FILLER                         PIC X(536).
  6481
  6482****************************************************************
  6483*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6484****************************************************************
  6485
  6486     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6487         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6488             20  CF-FEMALE-HEIGHT.
  6489                 24  CF-FEMALE-FT           PIC 99.
  6490                 24  CF-FEMALE-IN           PIC 99.
  6491             20  CF-FEMALE-MIN-WT           PIC 999.
  6492             20  CF-FEMALE-MAX-WT           PIC 999.
  6493         16  FILLER                         PIC X(428).
  6494
  6495     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6496         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6497             20  CF-MALE-HEIGHT.
  6498                 24  CF-MALE-FT             PIC 99.
  6499                 24  CF-MALE-IN             PIC 99.
  6500             20  CF-MALE-MIN-WT             PIC 999.
  6501             20  CF-MALE-MAX-WT             PIC 999.
  6502         16  FILLER                         PIC X(428).
  6503******************************************************************
  6504*             AUTOMATIC ACTIVITY RECORD                          *
  6505******************************************************************
  6506     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6507         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6508             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6509             20  CF-SYS-LETTER-ID           PIC X(04).
  6510             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6511             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6512             20  CF-SYS-RESET-SW            PIC X(01).
  6513             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6514             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6515
  6516         16  FILLER                         PIC X(50).
  6517
  6518         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6519             20  CF-USER-ACTIVE-SW          PIC X(01).
  6520             20  CF-USER-LETTER-ID          PIC X(04).
  6521             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6522             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6523             20  CF-USER-RESET-SW           PIC X(01).
  6524             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6525             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6526             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6527
  6528         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 120
* EL050.cbl
  6530*    COPY ERCACCT.
  6531******************************************************************
  6532*                                                                *
  6533*                                                                *
  6534*                            ERCACCT                             *
  6535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6536*                            VMOD=2.031                          *
  6537*                                                                *
  6538*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6539*                                                                *
  6540*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6541*   VSAM ACCOUNT MASTER FILES.                                   *
  6542*                                                                *
  6543*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6544*                                                                *
  6545*   FILE TYPE = VSAM,KSDS                                        *
  6546*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6547*                                                                *
  6548*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6549*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6550*                                                                *
  6551*   LOG = NO                                                     *
  6552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6553*                                                                *
  6554*                                                                *
  6555******************************************************************
  6556*                   C H A N G E   L O G
  6557*
  6558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6559*-----------------------------------------------------------------
  6560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6561* EFFECTIVE    NUMBER
  6562*-----------------------------------------------------------------
  6563* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6564* 092705    2005050300006  PEMA  ADD SPP LEASES
  6565* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6566* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6567* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6568* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6569* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6570******************************************************************
  6571
  6572 01  ACCOUNT-MASTER.
  6573     12  AM-RECORD-ID                      PIC XX.
  6574         88  VALID-AM-ID                      VALUE 'AM'.
  6575
  6576     12  AM-CONTROL-PRIMARY.
  6577         16  AM-COMPANY-CD                 PIC X.
  6578         16  AM-MSTR-CNTRL.
  6579             20  AM-CONTROL-A.
  6580                 24  AM-CARRIER            PIC X.
  6581                 24  AM-GROUPING.
  6582                     28 AM-GROUPING-PREFIX PIC XXX.
  6583                     28 AM-GROUPING-PRIME  PIC XXX.
  6584                 24  AM-STATE              PIC XX.
  6585                 24  AM-ACCOUNT.
  6586                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6587                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 121
* EL050.cbl
  6588             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6589                                           PIC X(19).
  6590             20  AM-CNTRL-B.
  6591                 24  AM-EXPIRATION-DT      PIC XX.
  6592                 24  FILLER                PIC X(4).
  6593             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6594                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6595
  6596     12  AM-CONTROL-BY-VAR-GRP.
  6597         16  AM-COMPANY-CD-A1              PIC X.
  6598         16  AM-VG-CARRIER                 PIC X.
  6599         16  AM-VG-GROUPING                PIC X(6).
  6600         16  AM-VG-STATE                   PIC XX.
  6601         16  AM-VG-ACCOUNT                 PIC X(10).
  6602         16  AM-VG-DATE.
  6603             20  AM-VG-EXPIRATION-DT       PIC XX.
  6604             20  FILLER                    PIC X(4).
  6605         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6606                                           PIC 9(11)      COMP-3.
  6607     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6608         16  FILLER                        PIC X(10).
  6609         16  AM-VG-KEY3.
  6610             20  AM-VG3-ACCOUNT            PIC X(10).
  6611             20  AM-VG3-EXP-DT             PIC XX.
  6612         16  FILLER                        PIC X(4).
  6613     12  AM-MAINT-INFORMATION.
  6614         16  AM-LAST-MAINT-DT              PIC XX.
  6615         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6616         16  AM-LAST-MAINT-USER            PIC X(4).
  6617         16  FILLER                        PIC XX.
  6618
  6619     12  AM-EFFECTIVE-DT                   PIC XX.
  6620     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6621
  6622     12  AM-PREV-DATES  COMP-3.
  6623         16  AM-PREV-EXP-DT                PIC 9(11).
  6624         16  AM-PREV-EFF-DT                PIC 9(11).
  6625
  6626     12  AM-REPORT-CODE-1                  PIC X(10).
  6627     12  AM-REPORT-CODE-2                  PIC X(10).
  6628
  6629     12  AM-CITY-CODE                      PIC X(4).
  6630     12  AM-COUNTY-PARISH                  PIC X(6).
  6631
  6632     12  AM-NAME                           PIC X(30).
  6633     12  AM-PERSON                         PIC X(30).
  6634     12  AM-ADDRS                          PIC X(30).
  6635     12  AM-CITY.
  6636         16  AM-ADDR-CITY                  PIC X(28).
  6637         16  AM-ADDR-STATE                 PIC XX.
  6638     12  AM-ZIP.
  6639         16  AM-ZIP-PRIME.
  6640             20  AM-ZIP-PRI-1ST            PIC X.
  6641                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6642             20  FILLER                    PIC X(4).
  6643         16  AM-ZIP-PLUS4                  PIC X(4).
  6644     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6645         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 122
* EL050.cbl
  6646         16  AM-CAN-POSTAL-2               PIC XXX.
  6647         16  FILLER                        PIC XXX.
  6648     12  AM-TEL-NO.
  6649         16  AM-AREA-CODE                  PIC 999.
  6650         16  AM-TEL-PRE                    PIC 999.
  6651         16  AM-TEL-NBR                    PIC 9(4).
  6652     12  AM-TEL-LOC                        PIC X.
  6653         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6654         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6655
  6656     12  AM-COMM-STRUCTURE.
  6657         16  AM-DEFN-1.
  6658             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6659                 24  AM-AGT.
  6660                     28  AM-AGT-PREFIX     PIC X(4).
  6661                     28  AM-AGT-PRIME      PIC X(6).
  6662                 24  AM-COM-TYP            PIC X.
  6663                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6664                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6665                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6666                 24  AM-RECALC-LV-INDIC    PIC X.
  6667                 24  AM-RETRO-LV-INDIC     PIC X.
  6668                 24  AM-GL-CODES           PIC X.
  6669                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6670                 24  FILLER                PIC X(01).
  6671         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6672             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6673                 24  FILLER                PIC X(11).
  6674                 24  AM-L-COMA             PIC XXX.
  6675                 24  AM-J-COMA             PIC XXX.
  6676                 24  AM-A-COMA             PIC XXX.
  6677                 24  FILLER                PIC X(6).
  6678
  6679     12  AM-COMM-CHANGE-STATUS             PIC X.
  6680         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6681
  6682     12  AM-CSR-CODE                       PIC X(4).
  6683
  6684     12  AM-BILLING-STATUS                 PIC X.
  6685         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6686         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6687     12  AM-AUTO-REFUND-SW                 PIC X.
  6688         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6689         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6690     12  AM-GPCD                           PIC 99.
  6691     12  AM-IG                             PIC X.
  6692         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6693         88  AM-HAS-GROUP                     VALUE '2'.
  6694     12  AM-STATUS                         PIC X.
  6695         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6696         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6697         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6698         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6699         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6700         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6701     12  AM-REMIT-TO                       PIC 99.
  6702     12  AM-ID-NO                          PIC X(11).
  6703
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 123
* EL050.cbl
  6704     12  AM-CAL-TABLE                      PIC XX.
  6705     12  AM-LF-DEVIATION                   PIC XXX.
  6706     12  AM-AH-DEVIATION                   PIC XXX.
  6707     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6708     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6709     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6710     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6711     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6712     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6713
  6714     12  AM-USER-FIELDS.
  6715         16  AM-FLD-1                      PIC XX.
  6716         16  AM-FLD-2                      PIC XX.
  6717         16  AM-FLD-3                      PIC XX.
  6718         16  AM-FLD-4                      PIC XX.
  6719         16  AM-FLD-5                      PIC XX.
  6720
  6721     12  AM-1ST-PROD-DATE.
  6722         16  AM-1ST-PROD-YR                PIC XX.
  6723         16  AM-1ST-PROD-MO                PIC XX.
  6724         16  AM-1ST-PROD-DA                PIC XX.
  6725     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6726     12  AM-CERTS-PURGED-DATE.
  6727         16  AM-PUR-YR                     PIC XX.
  6728         16  AM-PUR-MO                     PIC XX.
  6729         16  AM-PUR-DA                     PIC XX.
  6730     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6731     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6732     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6733     12  AM-INACTIVE-DATE.
  6734         16  AM-INA-MO                     PIC 99.
  6735         16  AM-INA-DA                     PIC 99.
  6736         16  AM-INA-YR                     PIC 99.
  6737     12  AM-AR-HI-CERT-DATE                PIC XX.
  6738
  6739     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6740     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6741
  6742     12  AM-OB-PAYMENT-MODE                PIC X.
  6743         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6744         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6745         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6746         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6747
  6748     12  AM-AH-ONLY-INDICATOR              PIC X.
  6749         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6750         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6751
  6752     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6753
  6754     12  AM-OVER-SHORT.
  6755         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6756         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6757
  6758     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6759     12  AM-DCC-CLP-STATE                  PIC XX.
  6760
  6761     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 124
* EL050.cbl
  6762     12  AM-RECALC-REIN                    PIC X.
  6763
  6764     12  AM-REI-TABLE                      PIC XXX.
  6765     12  AM-REI-ET-LF                      PIC X.
  6766     12  AM-REI-ET-AH                      PIC X.
  6767     12  AM-REI-PE-LF                      PIC X.
  6768     12  AM-REI-PE-AH                      PIC X.
  6769     12  AM-REI-PRT-ST                     PIC X.
  6770     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6771     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6772     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6773     12  AM-REI-GROUP-A                    PIC X(6).
  6774     12  AM-REI-MORT                       PIC X(4).
  6775     12  AM-REI-PRT-OW                     PIC X.
  6776     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6777     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6778     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6779     12  AM-REI-GROUP-B                    PIC X(6).
  6780
  6781     12  AM-TRUST-TYPE                     PIC X(2).
  6782
  6783     12  AM-EMPLOYER-STMT-USED             PIC X.
  6784     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6785
  6786     12  AM-STD-AH-TYPE                    PIC XX.
  6787     12  AM-EARN-METHODS.
  6788         16  AM-EARN-METHOD-R              PIC X.
  6789             88 AM-REF-RL-R78                 VALUE 'R'.
  6790             88 AM-REF-RL-PR                  VALUE 'P'.
  6791             88 AM-REF-RL-MEAN                VALUE 'M'.
  6792             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6793         16  AM-EARN-METHOD-L              PIC X.
  6794             88 AM-REF-LL-R78                 VALUE 'R'.
  6795             88 AM-REF-LL-PR                  VALUE 'P'.
  6796             88 AM-REF-LL-MEAN                VALUE 'M'.
  6797             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6798         16  AM-EARN-METHOD-A              PIC X.
  6799             88 AM-REF-AH-R78                 VALUE 'R'.
  6800             88 AM-REF-AH-PR                  VALUE 'P'.
  6801             88 AM-REF-AH-MEAN                VALUE 'M'.
  6802             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6803             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6804             88 AM-REF-AH-NET                 VALUE 'N'.
  6805
  6806     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6807     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6808     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6809
  6810     12  AM-RET-Y-N                        PIC X.
  6811     12  AM-RET-P-E                        PIC X.
  6812     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6813     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6814     12  AM-RET-GRP                        PIC X(6).
  6815     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6816         16  AM-POOL-PRIME                 PIC XXX.
  6817         16  AM-POOL-SUB                   PIC XXX.
  6818     12  AM-RETRO-EARNINGS.
  6819         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 125
* EL050.cbl
  6820         16  AM-RET-EARN-L                 PIC X.
  6821         16  AM-RET-EARN-A                 PIC X.
  6822     12  AM-RET-ST-TAX-USE                 PIC X.
  6823         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6824         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6825     12  AM-RETRO-BEG-EARNINGS.
  6826         16  AM-RET-BEG-EARN-R             PIC X.
  6827         16  AM-RET-BEG-EARN-L             PIC X.
  6828         16  AM-RET-BEG-EARN-A             PIC X.
  6829     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6830     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6831
  6832     12  AM-USER-SELECT-OPTIONS.
  6833         16  AM-USER-SELECT-1              PIC X(10).
  6834         16  AM-USER-SELECT-2              PIC X(10).
  6835         16  AM-USER-SELECT-3              PIC X(10).
  6836         16  AM-USER-SELECT-4              PIC X(10).
  6837         16  AM-USER-SELECT-5              PIC X(10).
  6838
  6839     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6840
  6841     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6842
  6843     12  AM-RPT045A-SWITCH                 PIC X.
  6844         88  RPT045A-OFF                   VALUE 'N'.
  6845
  6846     12  AM-INSURANCE-LIMITS.
  6847         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6848         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6849
  6850     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6851         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6852
  6853     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6854         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6855         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6856
  6857     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6858
  6859     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6860     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6861     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6862     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6863     12  AM-DCC-UEF-STATE                  PIC XX.
  6864     12  FILLER                            PIC XXX.
  6865     12  AM-REPORT-CODE-3                  PIC X(10).
  6866*    12  FILLER                            PIC X(22).
  6867
  6868     12  AM-RESERVE-DATE.
  6869         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6870         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6871         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6872
  6873     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6874     12  AM-NOTIFICATION-TYPES.
  6875         16  AM-NOTIF-OF-LETTERS           PIC X.
  6876         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6877         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 126
* EL050.cbl
  6878         16  AM-NOTIF-OF-STATUS            PIC X.
  6879
  6880     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6881         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6882         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6883         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6884         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6885
  6886     12  AM-BENEFIT-CONTROLS.
  6887         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6888             20  AM-BENEFIT-CODE           PIC XX.
  6889             20  AM-BENEFIT-TYPE           PIC X.
  6890             20  AM-BENEFIT-REVISION       PIC XXX.
  6891             20  AM-BENEFIT-REM-TERM       PIC X.
  6892             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6893             20  FILLER                    PIC XX.
  6894         16  FILLER                        PIC X(80).
  6895
  6896     12  AM-TRANSFER-DATA.
  6897         16  AM-TRANSFERRED-FROM.
  6898             20  AM-TRNFROM-CARRIER        PIC X.
  6899             20  AM-TRNFROM-GROUPING.
  6900                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6901                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6902             20  AM-TRNFROM-STATE          PIC XX.
  6903             20  AM-TRNFROM-ACCOUNT.
  6904                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6905                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6906             20  AM-TRNFROM-DTE            PIC XX.
  6907         16  AM-TRANSFERRED-TO.
  6908             20  AM-TRNTO-CARRIER          PIC X.
  6909             20  AM-TRNTO-GROUPING.
  6910                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6911                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6912             20  AM-TRNTO-STATE            PIC XX.
  6913             20  AM-TRNTO-ACCOUNT.
  6914                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6915                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6916             20  AM-TRNTO-DTE              PIC XX.
  6917         16  FILLER                        PIC X(10).
  6918
  6919     12  AM-SAVED-REMIT-TO                 PIC 99.
  6920
  6921     12  AM-COMM-STRUCTURE-SAVED.
  6922         16  AM-DEFN-1-SAVED.
  6923             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6924                 24  AM-AGT-SV             PIC X(10).
  6925                 24  AM-COM-TYP-SV         PIC X.
  6926                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6927                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6928                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6929                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6930                 24  FILLER                PIC X.
  6931                 24  AM-GL-CODES-SV        PIC X.
  6932                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6933                 24  FILLER                PIC X.
  6934         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6935             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 127
* EL050.cbl
  6936                 24  FILLER                PIC X(11).
  6937                 24  AM-L-COMA-SV          PIC XXX.
  6938                 24  AM-J-COMA-SV          PIC XXX.
  6939                 24  AM-A-COMA-SV          PIC XXX.
  6940                 24  FILLER                PIC X(6).
  6941
  6942     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6943         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6944            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6945            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6946            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6947
  6948     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6949     12  FILLER                            PIC X(120).
  6950
  6951     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6952         16  AM-CONTROL-NAME               PIC X(30).
  6953         16  AM-EXECUTIVE-ONE.
  6954             20  AM-EXEC1-NAME             PIC X(15).
  6955             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6956                                                          COMP-3.
  6957             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6958                                                          COMP-3.
  6959         16  AM-EXECUTIVE-TWO.
  6960             20  AM-EXEC2-NAME             PIC X(15).
  6961             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6962                                                          COMP-3.
  6963             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6964                                                          COMP-3.
  6965
  6966     12  AM-RETRO-ADDITIONAL-DATA.
  6967         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6968         16  AM-RETRO-PREM-P-E             PIC X.
  6969         16  AM-RETRO-CLMS-P-I             PIC X.
  6970         16  AM-RETRO-RET-BRACKET-LF.
  6971             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6972                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6973                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6974             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6975                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6976                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6977             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6978                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6979                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6980         16  AM-RETRO-RET-BRACKET-AH.
  6981             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6982                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6983                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6984                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6985             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6986                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6987                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6988             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6989                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6990                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6991
  6992     12  AM-COMMENTS.
  6993         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 128
* EL050.cbl
  6994
  6995     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6996         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6997         16  AM-FLI-BILLING-CODE           PIC X.
  6998         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6999         16  AM-FLI-UNITED-IDENT           PIC X.
  7000         16  AM-FLI-INTEREST-LOST-DATA.
  7001             20  AM-FLI-BANK-NO            PIC X(5).
  7002             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7003             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7004             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7005         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7006             20  AM-FLI-AGT                PIC X(9).
  7007             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7008             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7009         16  FILLER                        PIC X(102).
  7010
  7011     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7012         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7013             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7014             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7015             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7016             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7017             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7018         16  FILLER                          PIC X(10).
  7019******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 129
* EL050.cbl
  7021*    COPY ERCREIN.
  7022******************************************************************
  7023*                                                                *
  7024*                            ERCREIN                             *
  7025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7026*                            VMOD=2.010                          *
  7027*                                                                *
  7028*   ONLINE CREDIT SYSTEM                                         *
  7029*                                                                *
  7030*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7031*                                                                *
  7032*   FILE TYPE = VSAM,KSDS                                        *
  7033*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7034*                                                                *
  7035*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7036*       ALTERNATE PATH = NONE                                    *
  7037*                                                                *
  7038*   LOG = NO                                                     *
  7039*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7040*                                                                *
  7041******************************************************************
  7042*                   C H A N G E   L O G
  7043*
  7044* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7045*-----------------------------------------------------------------
  7046*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7047* EFFECTIVE    NUMBER
  7048*-----------------------------------------------------------------
  7049* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7050* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7051******************************************************************
  7052 01  REINSURANCE-RECORD.
  7053     12  RE-RECORD-ID                      PIC XX.
  7054         88  VALID-RE-ID                      VALUE 'RE'.
  7055
  7056     12  RE-CONTROL-PRIMARY.
  7057         16  RE-COMPANY-CD                 PIC X.
  7058         16  RE-KEY.
  7059             20  RE-CODE                   PIC X.
  7060                 88  RE-TABLE-RECORD          VALUE 'A'.
  7061                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7062             20  RE-TABLE                  PIC XXX.
  7063             20  FILLER                    PIC XXX.
  7064         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7065             20  FILLER                    PIC X.
  7066             20  RE-COMPANY.
  7067                 24  RE-COMP-PRIME         PIC XXX.
  7068                 24  RE-COMP-SUB           PIC XXX.
  7069
  7070     12  RE-MAINT-INFORMATION.
  7071         16  RE-LAST-MAINT-DT              PIC XX.
  7072         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7073         16  RE-LAST-MAINT-USER            PIC X(4).
  7074         16  FILLER                        PIC X(10).
  7075
  7076     12  RE-TABLE-DATA.
  7077         16  RE-100-COMP                   PIC 99.
  7078
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 130
* EL050.cbl
  7079         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7080             20  RE-REI-COMP-NO.
  7081                 24  RE-REI-COMP           PIC XXX.
  7082                 24  RE-REI-COMP-SUB       PIC XXX.
  7083             20  RE-LF-QC                  PIC X.
  7084             20  RE-AH-QC                  PIC X.
  7085             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7086             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7087             20  RE-LFAGE-LO               PIC 99.
  7088             20  RE-LFAGE-HI               PIC 99.
  7089             20  RE-AHAGE-LO               PIC 99.
  7090             20  RE-AHAGE-HI               PIC 99.
  7091             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7092             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7093             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7094             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7095             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7096             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7097             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7098             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7099             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7100             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7101             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7102             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7103             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7104             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7105             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7106             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7107             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7108             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7109             20  RE-LF-BEN-CODE            PIC X.
  7110             20  RE-AH-BEN-CODE            PIC X.
  7111             20  RE-INTERACTIVE            PIC X.
  7112             20  RE-REMAINING              PIC X.
  7113             20  RE-LF-RUNOFF-SW           PIC X.
  7114             20  RE-AH-RUNOFF-SW           PIC X.
  7115             20  FILLER                    PIC X(19).
  7116
  7117         16  RE-COMP-INFO-END              PIC X(6).
  7118         16  RE-NSP-ST-CD-LF               PIC XX.
  7119         16  RE-NSP-ST-CD-AH               PIC XX.
  7120         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7121             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7122
  7123         16  FILLER                        PIC X(27).
  7124
  7125     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7126         16  RE-NAME                       PIC X(30).
  7127         16  RE-LF-PE                      PIC X.
  7128         16  RE-AH-PE                      PIC X.
  7129         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7130         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7131         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7132         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7133         16  RE-PRT-ST                     PIC X.
  7134         16  RE-PRT-OW                     PIC X.
  7135         16  RE-MORT-CODE                  PIC X(4).
  7136         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 131
* EL050.cbl
  7137         16  RE-ZERO-LF-FEE                PIC X.
  7138         16  RE-ZERO-AH-FEE                PIC X.
  7139         16  RE-CEDE-NAME                  PIC X(30).
  7140         16  RE-LF-COMM                    PIC X.
  7141         16  RE-AH-COMM                    PIC X.
  7142         16  RE-LF-TAX                     PIC X.
  7143         16  RE-AH-TAX                     PIC X.
  7144         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7145         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7146         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7147
  7148         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7149             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7150
  7151         16  RE-LF-CEDING-FEE-BRACKETS.
  7152             20  RE-LF-FEE-METHOD          PIC X.
  7153                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7154                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7155                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7156                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7157             20  RE-LF-FEE-BASIS           PIC X.
  7158                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7159                 88  RE-LF-NET-CEDED               VALUE '2'.
  7160                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7161                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7162                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7163                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7164                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7165                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7166             20  FILLER                    PIC XXX.
  7167             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7168                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7169                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7170
  7171         16  RE-AH-CEDING-FEE-BRACKETS.
  7172             20  RE-AH-FEE-METHOD          PIC X.
  7173                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7174                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7175                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7176                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7177             20  RE-AH-FEE-BASIS           PIC X.
  7178                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7179                 88  RE-AH-NET-CEDED               VALUE '2'.
  7180                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7181                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7182                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7183                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7184                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7185                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7186             20  FILLER                    PIC XXX.
  7187             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7188                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7189                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7190
  7191         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7192
  7193         16  RE-OLD-CEDING-STMT            PIC X.
  7194
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 132
* EL050.cbl
  7195         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7196         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7197         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7198         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7199         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7200         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7201         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7202         16  RE-MORT-SW                    PIC X.
  7203         16  RE-CEDING-TYPE-FLAG           PIC X.
  7204             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7205             88  RE-CEDED                          VALUE 'C'.
  7206             88  RE-ASSUMED                        VALUE 'A'.
  7207             88  RE-PHANTOM                        VALUE 'P'.
  7208
  7209         16  RE-CEDING-STMT-OPT-A          PIC X.
  7210             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7211         16  RE-CEDING-STMT-OPT-B          PIC X.
  7212             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7213         16  RE-CEDING-STMT-OPT-C          PIC X.
  7214             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7215         16  RE-CEDING-STMT-OPT-D          PIC X.
  7216             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7217         16  RE-CEDING-STMT-OPT-E          PIC X.
  7218             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7219
  7220         16  RE-PRT-CRSV                   PIC X.
  7221
  7222         16  RE-GL-CENTER                  PIC X(4).
  7223
  7224         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7225
  7226         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7227
  7228         16  RE-EARN-STOP-CODE             PIC X.
  7229             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7230             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7231
  7232         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7233             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7234
  7235         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7236         16  FILLER                        PIC X(2281).
  7237
  7238         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7239
  7240******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 133
* EL050.cbl
  7242*    COPY ERCCTBL.
  7243******************************************************************
  7244*                                                                *
  7245*                                                                *
  7246*                            ERCCTBL                             *
  7247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7248*                            VMOD=2.003
  7249*                                                                *
  7250*   ONLINE CREDIT SYSTEM                                         *
  7251*                                                                *
  7252*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7253*                                                                *
  7254*   FILE TYPE = VSAM,KSDS                                        *
  7255*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7256*                                                                *
  7257*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7258*       ALTERNATE PATH = NONE                                    *
  7259*                                                                *
  7260*   LOG = NO                                                     *
  7261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7262*                                                                *
  7263*                                                                *
  7264******************************************************************
  7265
  7266 01  COMM-TABLE-RECORD.
  7267     12  CT-RECORD-ID                      PIC XX.
  7268         88  VALID-CT-ID                      VALUE 'CT'.
  7269
  7270     12  CT-CONTROL-PRIMARY.
  7271         16  CT-COMPANY-CD                 PIC X.
  7272         16  CT-TABLE                      PIC XXX.
  7273         16  CT-CNTRL-2.
  7274             20  CT-BEN-TYPE               PIC X.
  7275             20  CT-BEN-CODE               PIC XX.
  7276
  7277     12  CT-MAINT-INFORMATION.
  7278         16  CT-LAST-MAINT-DT              PIC XX.
  7279         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7280         16  CT-LAST-MAINT-USER            PIC X(4).
  7281         16  FILLER                        PIC X(31).
  7282
  7283     12  CT-LIMITS.
  7284         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7285
  7286         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7287
  7288         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7289
  7290     12  CT-RATES.
  7291         16  CT-RTX          OCCURS 27 TIMES.
  7292             20  CT-RT                     PIC SV9(5)     COMP-3.
  7293             20  CT-RT-R   REDEFINES
  7294                 CT-RT                     PIC XXX.
  7295
  7296     12  FILLER                            PIC  X(42).
  7297
  7298******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 134
* EL050.cbl
  7300*    COPY ERCFORM.
  7301******************************************************************
  7302*                                                                *
  7303*                                                                *
  7304*                            ERCFORM.                            *
  7305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7306*                            VMOD=2.003                          *
  7307*                                                                *
  7308*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7309*                                                                *
  7310*    FILE TYPE = VSAM,KSDS                                       *
  7311*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7312*                                                                *
  7313*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7314*                                                                *
  7315*    LOG = YES                                                   *
  7316*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7317******************************************************************
  7318 01  FORM-MASTER.
  7319    12  FO-RECORD-ID                 PIC X(02).
  7320        88  VALID-FO-ID                  VALUE 'FO'.
  7321
  7322    12  FO-CONTROL-PRIMARY.
  7323        16  FO-COMPANY-CD            PIC X(01).
  7324        16  FO-STATE                 PIC X(02).
  7325        16  FO-FORM-ID               PIC X(12).
  7326        16  FO-FORM-EXP-DT           PIC X(02).
  7327
  7328    12  FO-POLICY-FORM-DATA.
  7329        16  FO-IND-GRP-CD            PIC X(01).
  7330        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7331        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7332        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7333        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7334        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7335        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7336        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7337        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7338        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7339        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7340        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7341        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7342        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7343        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7344        16  FO-APP-CERT-USE-CD       PIC X(01).
  7345
  7346    12  FILLER                       PIC X(29).
  7347
  7348    12  FO-FORM-PLAN-TABLE.
  7349        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7350            20  FO-PLAN-TYPE         PIC X(01).
  7351            20  FO-PLAN-ID           PIC X(02).
  7352            20  FO-PLAN-TERM         PIC 9(03).
  7353            20  FO-PLAN-REFUND-METHOD
  7354                                     PIC X.
  7355
  7356    12  FILLER                       PIC X(30).
  7357
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 135
* EL050.cbl
  7358    12  FO-COMMENTS-AREA.
  7359        16  FO-COMMENT-LINE-1        PIC X(78).
  7360
  7361    12  FILLER                       PIC X(20).
  7362
  7363    12  FO-MAINT-INFORMATION.
  7364        16  FO-LAST-MAINT-DT         PIC X(02).
  7365        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7366        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 136
* EL050.cbl
  7368*    COPY ELCMSTR.
  7369******************************************************************
  7370*                                                                *
  7371*                            ELCMSTR.                            *
  7372*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7373*                            VMOD=2.012                          *
  7374*                                                                *
  7375*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7376*                                                                *
  7377*   FILE TYPE = VSAM,KSDS                                        *
  7378*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7379*                                                                *
  7380*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7381*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7382*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7383*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7384*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7385*                                                 RKP=75,LEN=21  *
  7386*                                                                *
  7387*   **** NOTE ****                                               *
  7388*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7389*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7390*                                                                *
  7391*   LOG = YES                                                    *
  7392*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7393******************************************************************
  7394*                   C H A N G E   L O G
  7395*
  7396* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7397*-----------------------------------------------------------------
  7398*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7399* EFFECTIVE    NUMBER
  7400*-----------------------------------------------------------------
  7401* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7402* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7403* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7404* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7405* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7406******************************************************************
  7407 01  CLAIM-MASTER.
  7408     12  CL-RECORD-ID                PIC XX.
  7409         88  VALID-CL-ID         VALUE 'CL'.
  7410
  7411     12  CL-CONTROL-PRIMARY.
  7412         16  CL-COMPANY-CD           PIC X.
  7413         16  CL-CARRIER              PIC X.
  7414         16  CL-CLAIM-NO             PIC X(7).
  7415         16  CL-CERT-NO.
  7416             20  CL-CERT-PRIME       PIC X(10).
  7417             20  CL-CERT-SFX         PIC X.
  7418
  7419     12  CL-CONTROL-BY-NAME.
  7420         16  CL-COMPANY-CD-A1        PIC X.
  7421         16  CL-INSURED-LAST-NAME    PIC X(15).
  7422         16  CL-INSURED-NAME.
  7423             20  CL-INSURED-1ST-NAME PIC X(12).
  7424             20  CL-INSURED-MID-INIT PIC X.
  7425
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 137
* EL050.cbl
  7426     12  CL-CONTROL-BY-SSN.
  7427         16  CL-COMPANY-CD-A2        PIC X.
  7428         16  CL-SOC-SEC-NO.
  7429             20  CL-SSN-STATE        PIC XX.
  7430             20  CL-SSN-ACCOUNT      PIC X(6).
  7431             20  CL-SSN-LN3          PIC X(3).
  7432
  7433     12  CL-CONTROL-BY-CERT-NO.
  7434         16  CL-COMPANY-CD-A4        PIC X.
  7435         16  CL-CERT-NO-A4.
  7436             20  CL-CERT-A4-PRIME    PIC X(10).
  7437             20  CL-CERT-A4-SFX      PIC X.
  7438
  7439     12  CL-CONTROL-BY-CCN.
  7440         16  CL-COMPANY-CD-A5        PIC X.
  7441         16  CL-CCN-A5.
  7442             20  CL-CCN.
  7443                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7444                 24  CL-CCN-PRIME-A5 PIC X(12).
  7445             20  CL-CCN-FILLER-A5    PIC X(4).
  7446
  7447     12  CL-INSURED-PROFILE-DATA.
  7448         16  CL-INSURED-BIRTH-DT     PIC XX.
  7449         16  CL-INSURED-SEX-CD       PIC X.
  7450             88  INSURED-IS-MALE        VALUE 'M'.
  7451             88  INSURED-IS-FEMALE      VALUE 'F'.
  7452             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7453         16  CL-INSURED-OCC-CD       PIC X(6).
  7454         16  FILLER                  PIC X(5).
  7455
  7456     12  CL-PROCESSING-INFO.
  7457         16  CL-PROCESSOR-ID         PIC X(4).
  7458         16  CL-CLAIM-STATUS         PIC X.
  7459             88  CLAIM-IS-OPEN          VALUE 'O'.
  7460             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7461         16  CL-CLAIM-TYPE           PIC X.
  7462*            88  AH-CLAIM               VALUE 'A'.
  7463*            88  LIFE-CLAIM             VALUE 'L'.
  7464*            88  PROPERTY-CLAIM         VALUE 'P'.
  7465*            88  IUI-CLAIM              VALUE 'I'.
  7466*            88  GAP-CLAIM              VALUE 'G'.
  7467*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7468         16  CL-CLAIM-PREM-TYPE      PIC X.
  7469             88  SINGLE-PREMIUM         VALUE '1'.
  7470             88  O-B-COVERAGE           VALUE '2'.
  7471             88  OPEN-END-COVERAGE      VALUE '3'.
  7472         16  CL-INCURRED-DT          PIC XX.
  7473         16  CL-REPORTED-DT          PIC XX.
  7474         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7475         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7476         16  CL-LAST-PMT-DT          PIC XX.
  7477         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7478         16  CL-PAID-THRU-DT         PIC XX.
  7479         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7480         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7481         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7482         16  CL-PMT-CALC-METHOD      PIC X.
  7483             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 138
* EL050.cbl
  7484             88  CL-365-DAY-YR          VALUE '2'.
  7485             88  CL-FULL-MONTHS         VALUE '3'.
  7486         16  CL-CAUSE-CD             PIC X(6).
  7487
  7488         16  CL-PRIME-CERT-NO.
  7489             20  CL-PRIME-CERT-PRIME PIC X(10).
  7490             20  CL-PRIME-CERT-SFX   PIC X.
  7491
  7492         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7493             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7494             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7495
  7496         16  CL-MICROFILM-NO         PIC X(10).
  7497         16  FILLER REDEFINES CL-MICROFILM-NO.
  7498             20  CL-BENEFIT-PERIOD   PIC 99.
  7499             20  FILLER              PIC X(8).
  7500         16  CL-PROG-FORM-TYPE       PIC X.
  7501         16  CL-LAST-ADD-ON-DT       PIC XX.
  7502
  7503         16  CL-LAST-REOPEN-DT       PIC XX.
  7504         16  CL-LAST-CLOSE-DT        PIC XX.
  7505         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7506             88  FINAL-PAID             VALUE '1'.
  7507             88  CLAIM-DENIED           VALUE '2'.
  7508             88  AUTO-CLOSE             VALUE '3'.
  7509             88  MANUAL-CLOSE           VALUE '4'.
  7510             88  BENEFITS-CHANGED       VALUE 'C'.
  7511             88  SETUP-ERRORS           VALUE 'E'.
  7512         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7513         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7514         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7515             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7516         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7517         16  FILLER                  PIC X.
  7518
  7519     12  CL-CERTIFICATE-DATA.
  7520         16  CL-CERT-ORIGIN          PIC X.
  7521             88  CERT-WAS-ONLINE        VALUE '1'.
  7522             88  CERT-WAS-CREATED       VALUE '2'.
  7523             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7524         16  CL-CERT-KEY-DATA.
  7525             20  CL-CERT-CARRIER     PIC X.
  7526             20  CL-CERT-GROUPING    PIC X(6).
  7527             20  CL-CERT-STATE       PIC XX.
  7528             20  CL-CERT-ACCOUNT.
  7529                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7530                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7531             20  CL-CERT-EFF-DT      PIC XX.
  7532
  7533     12  CL-STATUS-CONTROLS.
  7534         16  CL-PRIORITY-CD          PIC X.
  7535             88  CONFIDENTIAL-DATA      VALUE '8'.
  7536             88  HIGHEST-PRIORITY       VALUE '9'.
  7537         16  CL-SUPV-ATTN-CD         PIC X.
  7538             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7539             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7540         16  CL-PURGED-DT            PIC XX.
  7541         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 139
* EL050.cbl
  7542         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7543         16  CL-NEXT-RESEND-DT       PIC XX.
  7544         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7545         16  CL-CRITICAL-PERIOD      PIC 99.
  7546*        16  FILLER                  PIC XX.
  7547         16  CL-LAST-MAINT-DT        PIC XX.
  7548         16  CL-LAST-MAINT-USER      PIC X(4).
  7549         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7550         16  CL-LAST-MAINT-TYPE      PIC X.
  7551             88  CLAIM-SET-UP           VALUE ' '.
  7552             88  PAYMENT-MADE           VALUE '1'.
  7553             88  LETTER-SENT            VALUE '2'.
  7554             88  MASTER-WAS-ALTERED     VALUE '3'.
  7555             88  MASTER-WAS-RESTORED    VALUE '4'.
  7556             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7557             88  FILE-CONVERTED         VALUE '6'.
  7558             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7559             88  ERROR-CORRECTION       VALUE 'E'.
  7560         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7561         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7562         16  CL-BENEFICIARY          PIC X(10).
  7563         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7564         16  CL-DENIAL-TYPE          PIC X.
  7565             88  CL-TYPE-DENIAL          VALUE '1'.
  7566             88  CL-TYPE-RESCISSION      VALUE '2'.
  7567             88  CL-TYPE-REFORMATION     VALUE '3'.
  7568             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7569             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7570         16  filler                  pic x(5).
  7571*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7572*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7573*        16  CL-RTW-DT               PIC XX.
  7574
  7575     12  CL-TRAILER-CONTROLS.
  7576         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7577             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7578             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7579             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7580         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7581         16  FILLER                  PIC XX.
  7582         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7583         16  CL-ADDRESS-TRAILER-CNT.
  7584             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7585                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7586             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7587                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7588             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7589                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7590             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7591                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7592             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7593                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7594             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7595                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7596             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7597                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7598
  7599     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 140
* EL050.cbl
  7600         16  CL-CV-REFNO-PRIME       PIC X(18).
  7601         16  CL-CV-REFNO-SFX         PIC XX.
  7602
  7603     12  CL-FILE-LOCATION            PIC X(4).
  7604
  7605     12  CL-PROCESS-ERRORS.
  7606         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7607             88  NO-FATAL-ERRORS        VALUE ZERO.
  7608         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7609             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7610
  7611     12  CL-PRODUCT-CD               PIC X.
  7612
  7613     12  CL-CURRENT-KEY-DATA.
  7614         16  CL-CURRENT-CARRIER      PIC X.
  7615         16  CL-CURRENT-GROUPING     PIC X(6).
  7616         16  CL-CURRENT-STATE        PIC XX.
  7617         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7618
  7619     12  CL-ASSOCIATES               PIC X.
  7620         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7621         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7622         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7623         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7624
  7625     12  CL-ACTIVITY-CODE            PIC 99.
  7626     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7627     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7628
  7629     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7630     12  CL-LAG-REPORT-CODE          PIC 9.
  7631     12  CL-LOAN-TYPE                PIC XX.
  7632     12  CL-LEGAL-STATE              PIC XX.
  7633
  7634     12  CL-YESNOSW                  PIC X.
  7635     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7636         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7637         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7638         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7639     12  cl-insured-type             pic x.
  7640         88  cl-claim-on-primary         value 'P'.
  7641         88  cl-claim-on-co-borrower     value 'C'.
  7642     12  cl-benefit-expiration-dt    PIC XX.
  7643
  7644 01  PLAN-RECORDS.
  7645     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7646     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7647
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 141
* EL050.cbl
  7649 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7650                          ACCOUNT-MASTER REINSURANCE-RECORD
  7651                          COMM-TABLE-RECORD FORM-MASTER
  7652                          CLAIM-MASTER PLAN-RECORDS.
  7653 0000-DFHEXIT SECTION.
  7654     MOVE '9#                    $   ' TO DFHEIV0.
  7655     MOVE 'EL050' TO DFHEIV1.
  7656     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7657
  7658     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7659
  7660
  7661* EXEC CICS  HANDLE CONDITION
  7662*           ERROR    (9300-ABEND)
  7663*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7664*    END-EXEC.
  7665*    MOVE '"$.J                  ! " #00007656' TO DFHEIV0
  7666     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7668     MOVE X'2220233030303037363536' TO DFHEIV0(25:11)
  7669     CALL 'kxdfhei1' USING DFHEIV0
  7670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7671
  7672
  7673 0000-COPY-PROCEDURE-DIV.
  7674*                          COPY ELC50PD.
  7675******************************************************************
  7676*                                                                *
  7677*                            ELC50PD                             *
  7678*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7679*                            VMOD=2.188                          *
  7680*                                                                *
  7681******************************************************************
  7682*                   C H A N G E   L O G
  7683*
  7684* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7685*-----------------------------------------------------------------
  7686*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7687* EFFECTIVE    NUMBER
  7688*-----------------------------------------------------------------
  7689* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7690* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7691* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7692*                             2709 AND 2718
  7693* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7694* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7695* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7696* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7697* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7698*                                IS OPEN OR CNC DT < PD THRU
  7699* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7700* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7701* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7702* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7703* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7704* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7705* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7706* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 142
* EL050.cbl
  7707* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7708* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7709* 020906                   PEMA  EXPAND LOAN OFFICER
  7710* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7711* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7712* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7713* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7714* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7715* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7716* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7717* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7718* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7719* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7720* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7721* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7722* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7723* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7724* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7725* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7726* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7727* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7728* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7729* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7730* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7731* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7732* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7733* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7734* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7735*                                UPDATE VIN ON CERT TRAILER
  7736* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7737* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7738* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7739* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7740* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7741* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7742* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7743* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7744* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7745* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7746* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7747* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7748* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7749* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7750* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7751* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7752* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7753* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7754* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7755* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7756* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7757* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7758* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7759* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7760* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7761* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7762* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7763* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7764* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 143
* EL050.cbl
  7765* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7766* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7767* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7768* 032912  CR2011110200001  PEMA  AHL CHANGES
  7769* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7770* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7771* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7772* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7773* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7774* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7775* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7776* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7777* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7778* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7779* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7780* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7781* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7782* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7783* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7784* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7785* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7786* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7787* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7788* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7789* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7790* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7791* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7792* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7793* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7794* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7795* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7796*                                CERT #, ADD 2898 FORCIBLE ERROR
  7797* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7798* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7799* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7800* 121815  CR2015121700006  PEMA  ADD HANDLING FOR FOREIGN VINS
  7801* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7802* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  7803* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7804******************************************************************
  7805************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7806******************************************************************
  7807
  7808     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7809
  7810     MOVE SPACES                 TO PB-FATAL-FLAG
  7811                                    PB-FORCE-ER-CD
  7812                                    PB-WARN-ER-CD
  7813                                    PB-OUT-BAL-CD.
  7814
  7815     MOVE SPACE                  TO WS-IG-OVRD-AH
  7816                                    WS-IG-OVRD-LF
  7817                                    WS-IG-OVRD-AM
  7818                                    WS-IG-OVRD
  7819                                    WS-IG-OVRD-AH-PL
  7820                                    WS-IG-OVRD-LF-PL
  7821                                    WS-IG-OVRD-AH-BEN
  7822                                    WS-IG-OVRD-LF-BEN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 144
* EL050.cbl
  7823
  7824******************************************************************
  7825*************       INITIALIZE COMMON ERRORS       ***************
  7826******************************************************************
  7827
  7828     MOVE +0                     TO PB-NO-OF-ERRORS.
  7829     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7830
  7831******************************************************************
  7832
  7833     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7834     SET JULIAN-TO-BIN           TO TRUE.
  7835*    MOVE 5                      TO DC-OPTION-CODE.
  7836     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7837     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7838
  7839     MOVE ZERO                   TO  SUB4.
  7840
  7841 0040-INITIALIZE-GA-BILL-DT.
  7842
  7843     ADD +1                      TO  SUB4.
  7844
  7845     IF  SUB4 GREATER THAN +5
  7846         GO TO 0050-CHECK-CNTL-FOUND.
  7847
  7848     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7849         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7850
  7851     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7852
  7853 0050-CHECK-CNTL-FOUND.
  7854
  7855     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7856        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7857                                         WS-AH-REM-TERM-CALC
  7858                                         EC-CO-REM-TERM-CALC
  7859        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7860        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7861        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7862                                         WS-TOL-AH-CLAIM
  7863        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7864                                         WS-TOL-AH-PREM
  7865                                         EC-CO-TOL-PREM
  7866        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7867                                         WS-TOL-AH-REFUND
  7868                                         EC-CO-TOL-REFUND
  7869        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7870                                         WS-AH-REFUND-OVS-AMT
  7871                                         EC-CO-OVR-SHT-AMT
  7872        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7873                                         WS-TOL-AH-PREM-PCT
  7874                                         EC-CO-TOL-PREM-PCT
  7875        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7876                                         WS-TOL-AH-REFUND-PCT
  7877                                         EC-CO-TOL-REFUND-PCT
  7878        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7879                                         WS-AH-REFUND-OVS-PCT
  7880                                         EC-CO-OVR-SHT-PCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 145
* EL050.cbl
  7881        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7882        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7883        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7884        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7885        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7886        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7887        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7888        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7889        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7890        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7891        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7892        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7893                                         EC-CO-MONTH-END-DT
  7894        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7895          GO TO 0100-READ-ACCT.
  7896
  7897     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7898     MOVE SPACES                 TO CNTL-ACCESS.
  7899     MOVE '1'                    TO CNTL-REC-TYPE.
  7900     MOVE +0                     TO CNTL-SEQ-NO.
  7901
  7902     MOVE '1' TO RC-SW-1.
  7903     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7904     IF NOT CF-COMPANY-MASTER
  7905         MOVE ZEROS             TO WK-CO-TOL-PREM
  7906                                   WK-CO-TOL-CLAIM
  7907                                   WK-CO-TOL-REFUND
  7908                                   WK-REFUND-OVS-AMT
  7909                                   WK-REFUND-OVS-PCT
  7910                                   WK-CO-TOL-PREM-PCT
  7911                                   WK-CO-TOL-REFUND-PCT
  7912                                   WK-DEFAULT-APR
  7913                                   WK-CO-MAX-CAP
  7914        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7915                                   WK-CR-R78-METHOD
  7916                                   WK-CO-REF-REJECT-SW
  7917                                   WK-CO-PREM-REJECT-SW
  7918                                   WK-REM-TRM-CALC-OPTION
  7919                                   WK-BIRTH-DATE-INPUT
  7920                                   WK-JOINT-AGE-INPUT
  7921        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7922        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7923        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7924        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7925          GO TO 0099-COMPANY-NOT-FOUND.
  7926
  7927     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7928        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7929     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7930        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7931     IF CF-CO-TOL-CAP NOT NUMERIC
  7932        MOVE +0                    TO CF-CO-TOL-CAP.
  7933     IF CF-DEFAULT-APR NOT NUMERIC
  7934        MOVE +0                    TO CF-DEFAULT-APR.
  7935
  7936     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7937     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7938     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 146
* EL050.cbl
  7939     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7940     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7941     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7942     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7943     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7944     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7945     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7946     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7947     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7948
  7949     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7950          CF-CO-OVR-SHT-AMT > +0
  7951        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7952
  7953     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7954          CF-CO-OVR-SHT-PCT > +0
  7955        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7956
  7957     IF CF-VALID-REM-TRM-OPTION
  7958         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7959     ELSE
  7960         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7961
  7962     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7963     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7964     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7965     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7966
  7967     GO TO 0050-CHECK-CNTL-FOUND.
  7968
  7969 0099-COMPANY-NOT-FOUND.
  7970
  7971     MOVE ER-2616                TO WS-ERROR.
  7972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7973
  7974 0100-READ-ACCT.
  7975
  7976     MOVE SPACES                 TO DATE-RANGE-SW.
  7977
  7978     IF WK-ACCT-ADDR = ZEROS
  7979        GO TO 0102-ACCT-GETMAIN.
  7980
  7981     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7982     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7983     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7984
  7985     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7986        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7987        GO TO 0105-READ-ACCT
  7988     END-IF
  7989
  7990     IF PB-CARRIER NOT = SPACES
  7991        IF PB-CARRIER NOT = AM-VG-CARRIER
  7992           GO TO 0105-READ-ACCT.
  7993
  7994     IF PB-STATE NOT = SPACES
  7995        IF PB-STATE NOT = AM-VG-STATE
  7996           GO TO 0105-READ-ACCT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 147
* EL050.cbl
  7997
  7998     IF PB-GROUPING NOT = SPACES
  7999        IF PB-GROUPING NOT = AM-VG-GROUPING
  8000           GO TO 0105-READ-ACCT.
  8001
  8002     MOVE 'X'                 TO DATE-RANGE-SW.
  8003
  8004     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8005        MOVE 'X'                 TO DATE-RANGE-SW
  8006        GO TO 0105-READ-ACCT.
  8007
  8008     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8009        GO TO 0105-READ-ACCT.
  8010
  8011     GO TO 0180-ACCOUNT-FOUND.
  8012
  8013 0102-ACCT-GETMAIN.
  8014     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8015     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8016
  8017 0105-READ-ACCT.
  8018     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8019     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8020     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8021     MOVE PB-STATE               TO ACCT-STATE.
  8022     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8023     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8024
  8025     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8026
  8027     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8028
  8029 0110-FIND-ACCT-TOLERANCES-LOOP.
  8030     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8031
  8032     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8033        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8034        GO TO 0199-ACCT-NOT-FOUND
  8035     END-IF
  8036     IF PB-CARRIER NOT = SPACES
  8037        IF PB-CARRIER NOT = AM-VG-CARRIER
  8038           GO TO 0199-ACCT-NOT-FOUND.
  8039
  8040     IF PB-STATE NOT = SPACES
  8041        IF PB-STATE NOT = AM-VG-STATE
  8042           GO TO 0199-ACCT-NOT-FOUND.
  8043
  8044     IF PB-GROUPING NOT = SPACES
  8045        IF PB-GROUPING NOT = AM-VG-GROUPING
  8046           GO TO 0199-ACCT-NOT-FOUND.
  8047
  8048     MOVE 'X'                    TO DATE-RANGE-SW.
  8049
  8050     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8051        MOVE 'X'                 TO DATE-RANGE-SW
  8052        GO TO 0199-ACCT-NOT-FOUND.
  8053
  8054     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 148
* EL050.cbl
  8055        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8056
  8057 0180-ACCOUNT-FOUND.
  8058     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8059     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8060     MOVE AM-STATE               TO PB-SV-STATE.
  8061     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8062
  8063     IF AM-CANCEL-FEE  NOT NUMERIC
  8064        MOVE ZEROS TO AM-CANCEL-FEE.
  8065
  8066     IF AM-MAX-MON-BEN NOT NUMERIC
  8067        MOVE ZEROS TO AM-MAX-MON-BEN.
  8068
  8069     IF AM-MAX-TOT-BEN NOT NUMERIC
  8070        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8071
  8072     IF AM-CLP-TOL-PCT NOT NUMERIC
  8073        MOVE +0                  TO AM-CLP-TOL-PCT
  8074     END-IF
  8075     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8076        MOVE +0                  TO AM-SPP-LEASE-COMM
  8077     END-IF
  8078     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8079        MOVE ER-2611             TO   WS-ERROR
  8080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8081
  8082     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8083        MOVE ER-2621             TO   WS-ERROR
  8084        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8085
  8086     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8087        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8088        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8089        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8090         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8091
  8092     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8093     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8094     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8095     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8096     IF AM-CLP-TOL-PCT NOT = ZEROS
  8097        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8098     END-IF
  8099     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8100        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8101     END-IF
  8102*    IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8103*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8104*                                   WS-ADMIN-FEES
  8105*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8106*          (SUB5 > +10)
  8107*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8108*             AND (AM-A-COM (SUB5) NUMERIC)
  8109*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8110*                + (AM-A-COM (SUB5) * 1000)
  8111*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8112*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 149
* EL050.cbl
  8113*                + (AM-A-COM (SUB5) * 1000)
  8114*             END-IF
  8115*             IF AM-COM-TYP (SUB5) = 'N'
  8116*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8117*                + (AM-A-COM (SUB5) * 1000)
  8118*             END-IF
  8119*          END-IF
  8120*       END-PERFORM
  8121*    END-IF
  8122     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  8123        AND (PB-ISSUE)
  8124        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8125                                    ws-cred-union-fees
  8126        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8127           (SUB5 > +10)
  8128           MOVE +0 TO WS-WK-RATE
  8129           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8130                                   'O' OR 'S')
  8131              IF (AM-A-COM (SUB5) NUMERIC)
  8132                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8133                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8134              ELSE
  8135                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8136                 IF PB-ISSUE
  8137                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8138                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8139                 ELSE
  8140                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8141                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8142                 END-IF
  8143                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8144                 MOVE ZEROS             TO WS-SUB1
  8145                                           WS-COMMISSION
  8146                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8147                 MOVE '0530'               TO CTBL-SW
  8148                 MOVE ' '                  TO WS-CTBL-READ-SW
  8149                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8150                 IF FIRST-TIME-THROUGH
  8151                    MOVE 'AA'              TO CTBL-BEN-CODE
  8152                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8153                 END-IF
  8154                 IF CTBL-TABLE-FOUND
  8155                    IF PB-ISSUE
  8156                       COMPUTE WS-COMM-CK-AMT =
  8157                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8158                    ELSE
  8159                       COMPUTE WS-COMM-CK-AMT =
  8160                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8161                    END-IF
  8162                    PERFORM 8800-GET-COMP-RATE
  8163                              THRU 8800-EXIT
  8164                 END-IF
  8165              END-IF
  8166              if am-com-typ (sub5) = 'O' or 'S'
  8167                 compute ws-cred-union-fees rounded =
  8168                    ws-cred-union-fees +
  8169                    (pb-i-ah-premium-amt * ws-wk-rate)
  8170              else
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 150
* EL050.cbl
  8171                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8172                + (WS-WK-RATE * 1000)
  8173              end-if
  8174           END-IF
  8175        END-PERFORM
  8176     END-IF
  8177     IF PB-COMPANY-ID EQUAL 'CRI'
  8178         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8179
  8180     IF PB-COMPANY-ID EQUAL 'NCL'
  8181         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8182     END-IF
  8183
  8184     GO TO 0200-READ-CERT.
  8185
  8186 0199-ACCT-NOT-FOUND.
  8187
  8188     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8189
  8190     IF DATE-RANGE-SW NOT = SPACES
  8191        MOVE ER-2601             TO WS-ERROR
  8192        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8193     ELSE
  8194        MOVE ER-2619             TO WS-ERROR
  8195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8196
  8197     GO TO 9990-RETURN.
  8198
  8199 0200-READ-CERT.
  8200
  8201     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8202     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8203     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8204     MOVE PB-SV-STATE            TO CERT-STATE.
  8205     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8206     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8207     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8208
  8209     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8210
  8211     IF CERT-WAS-NOT-FOUND
  8212        GO TO 0299-CERT-NOT-FOUND.
  8213
  8214     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8215        MOVE ER-2759             TO WS-ERROR
  8216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8217        GO TO 0298-UNLOCK-RETURN.
  8218
  8219     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8220         MOVE ER-2758            TO WS-ERROR
  8221         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8222         GO TO 0298-UNLOCK-RETURN.
  8223
  8224     IF PB-ISSUE
  8225        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8226           IF CERT-WAS-CREATED-FOR-CLAIM
  8227              NEXT SENTENCE
  8228            ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 151
* EL050.cbl
  8229              MOVE ER-2626       TO WS-ERROR
  8230              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8231              GO TO 0298-UNLOCK-RETURN.
  8232
  8233     IF NOT PB-CANCELLATION
  8234        GO TO 0300-CONTINUE-EDIT.
  8235
  8236     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8237     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8238     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8239     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8240     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8241     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8242
  8243     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8244     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8245     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8246     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8247     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8248     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8249     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8250     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8251     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8252
  8253     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8254     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8255     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8256     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8257     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8258     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8259     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8260
  8261     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8262     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8263
  8264     MOVE CM-CREDIT-INTERFACE-SW-1
  8265                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8266     MOVE CM-CREDIT-INTERFACE-SW-2
  8267                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8268
  8269     IF CM-O-B-COVERAGE
  8270         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8271
  8272     IF CM-LIVES NOT NUMERIC
  8273         MOVE ZERO                TO CM-LIVES.
  8274
  8275     IF CM-BILLED NOT NUMERIC
  8276         MOVE ZERO                TO CM-BILLED.
  8277
  8278     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8279         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8280         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8281         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8282         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8283         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8284         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8285         MOVE CM-LIVES             TO PB-CI-LIVES
  8286*The next line causes a problem with my change  I dont think it is
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 152
* EL050.cbl
  8287*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8288
  8289     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8290     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8291     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8292     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8293     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8294     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8295
  8296     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8297     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8298     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8299     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8300
  8301     IF CM-LIFE-COMM-PCT NUMERIC
  8302         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8303     ELSE
  8304         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8305
  8306     IF CM-AH-COMM-PCT NUMERIC
  8307         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8308     ELSE
  8309         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8310
  8311     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8312
  8313     IF CM-LOAN-APR       NOT NUMERIC
  8314           MOVE ZERO               TO CM-LOAN-APR.
  8315
  8316     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8317           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8318
  8319     IF CM-LOAN-TERM      NOT NUMERIC
  8320           MOVE ZERO               TO CM-LOAN-TERM.
  8321
  8322     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8323           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8324
  8325     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8326           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8327
  8328     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8329     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8330     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8331     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8332     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8333     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8334     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8335     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8336     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8337     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8338     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8339     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8340
  8341     IF CM-STATE = CM-SSN-STATE
  8342         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8343
  8344     IF CM-STATE NOT = CM-MEMB-STATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 153
* EL050.cbl
  8345         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8346
  8347     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8348
  8349     IF PB-COMPANY-ID = 'CVL' OR 'DCC' or 'VPP'
  8350        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8351        IF CM-ADDL-CLP NOT NUMERIC
  8352           MOVE +0               TO CM-ADDL-CLP
  8353        END-IF
  8354        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8355        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8356           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8357        END-IF
  8358     END-IF
  8359     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  8360        MOVE +0                  TO WS-ADMIN-FEES
  8361                                    WS-CSO-ADMIN-FEE
  8362                                    WS-COMM-AND-MFEE
  8363                                    WS-1ST-YR-ALLOW
  8364        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8365           (SUB5 > +10)
  8366           MOVE +0 TO WS-WK-RATE
  8367           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8368              IF (AM-A-COM (SUB5) NUMERIC)
  8369                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8370                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8371              ELSE
  8372                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8373                 IF PB-ISSUE
  8374                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8375                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8376                 ELSE
  8377                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8378                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8379                 END-IF
  8380                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8381                 MOVE ZEROS             TO WS-SUB1
  8382                                           WS-COMMISSION
  8383                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8384                 MOVE '0530'               TO CTBL-SW
  8385                 MOVE ' '                  TO WS-CTBL-READ-SW
  8386                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8387                 IF FIRST-TIME-THROUGH
  8388                    MOVE 'AA'              TO CTBL-BEN-CODE
  8389                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8390                 END-IF
  8391                 IF CTBL-TABLE-FOUND
  8392                    IF PB-ISSUE
  8393                       COMPUTE WS-COMM-CK-AMT =
  8394                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8395                    ELSE
  8396                       COMPUTE WS-COMM-CK-AMT =
  8397                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8398                    END-IF
  8399                    PERFORM 8800-GET-COMP-RATE
  8400                              THRU 8800-EXIT
  8401                 END-IF
  8402              END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 154
* EL050.cbl
  8403              IF AM-COM-TYP (SUB5) = 'I'
  8404                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8405                   + (WS-WK-RATE * 1000)
  8406              END-IF
  8407              IF AM-COM-TYP (SUB5) = 'N'
  8408                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8409                   + (WS-WK-RATE * 1000)
  8410              END-IF
  8411              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8412                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8413                   + (WS-WK-RATE * 1000)
  8414              END-IF
  8415              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8416                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8417                   + (WS-WK-RATE * 1000)
  8418              END-IF
  8419           END-IF
  8420        END-PERFORM
  8421     END-IF
  8422     GO TO 0300-CONTINUE-EDIT.
  8423
  8424 0298-UNLOCK-RETURN.
  8425      PERFORM 9250-UNLOCK-RETURN
  8426      GO TO 9990-RETURN.
  8427
  8428 0299-CERT-NOT-FOUND.
  8429
  8430     MOVE '1'                     TO CERT-STATUS-SW.
  8431
  8432     IF PB-COMPANY-ID = 'UCL'
  8433         IF WS-ERROR = ER-2799
  8434             GO TO 3000-CONTINUE-EDIT.
  8435
  8436     IF NOT PB-CANCELLATION
  8437         GO TO 0300-CONTINUE-EDIT.
  8438
  8439     MOVE ER-2726                  TO  WS-ERROR.
  8440     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8441     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8442     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8443                                    PB-CI-LF-TERM
  8444                                    PB-C-LF-REM-TERM
  8445                                    PB-CI-AH-TERM
  8446                                    PB-C-AH-REM-TERM
  8447                                    PB-CI-LF-BENEFIT-CD
  8448                                    PB-CI-LF-BENEFIT-AMT
  8449                                    PB-CI-LF-ALT-BENEFIT-AMT
  8450                                    PB-CI-LF-PREMIUM-AMT
  8451                                    PB-CI-LF-ALT-PREMIUM-AMT
  8452                                    PB-CI-AH-BENEFIT-CD
  8453                                    PB-CI-AH-BENEFIT-AMT
  8454                                    PB-CI-AH-PREMIUM-AMT
  8455                                    PB-CI-PAY-FREQUENCY
  8456                                    PB-CI-LOAN-APR
  8457                                    PB-CI-LOAN-TERM
  8458                                    PB-CI-LIFE-COMMISSION
  8459                                    PB-CI-AH-COMMISSION
  8460                                    PB-CI-CURR-SEQ
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 155
* EL050.cbl
  8461                                    PB-CI-AH-CANCEL-AMT
  8462                                    PB-CI-LF-CANCEL-AMT
  8463                                    PB-CI-RATE-DEV-PCT-LF
  8464                                    PB-CI-RATE-DEV-PCT-AH
  8465                                    PB-CI-EXTENTION-DAYS
  8466                                    PB-CI-TERM-IN-DAYS
  8467                                    PB-CI-LIVES
  8468                                    PB-CI-LF-CRIT-PER
  8469                                    PB-CI-AH-CRIT-PER
  8470                                    PB-CI-ADDL-CLP
  8471                                    PB-CI-DDF-IU-RATE-UP.
  8472
  8473     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8474                                    PB-CI-AH-SETTLEMENT-DT
  8475                                    PB-CI-DEATH-DT
  8476                                    PB-CI-LF-PRIOR-CANCEL-DT
  8477                                    PB-CI-AH-PRIOR-CANCEL-DT
  8478                                    PB-CI-ENTRY-DT
  8479                                    PB-CI-LF-EXPIRE-DT
  8480                                    PB-CI-AH-EXPIRE-DT
  8481                                    PB-CI-LOAN-1ST-PMT-DT.
  8482
  8483     IF ACCOUNT-MAST-FOUND
  8484        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8485        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8486
  8487
  8488 0300-CONTINUE-EDIT.
  8489
  8490     IF PB-ISSUE
  8491        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8492            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8493
  8494     IF PB-ISSUE
  8495        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8496            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8497
  8498     IF PB-ISSUE
  8499       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8500          (AM-NO-AH-ONLY)
  8501           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8502               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8503                   MOVE ER-2679 TO WS-ERROR
  8504                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8505
  8506     IF PB-ISSUE
  8507        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8508        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8509        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8510     ELSE
  8511        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8512        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8513        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8514
  8515     MOVE 'N'                    TO PLAN-MASTER-SW
  8516                                    PLAN-MASTER-LIFE-SW
  8517                                    FORM-MASTER-SW
  8518                                    WS-APP-CERT-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 156
* EL050.cbl
  8519
  8520     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8521                                    WS-PL-TOL-LF-REFUND
  8522                                    WS-PL-REF-OVS-AMT
  8523                                    WS-PL-TOL-LF-PREM-PCT
  8524                                    WS-PL-TOL-LF-REFUND-PCT
  8525                                    WS-PL-REF-OVS-PCT
  8526                                    WS-PL-TOL-LF-CLAIM.
  8527
  8528     IF PB-COMPANY-ID = 'NCL'
  8529       IF PB-ISSUE
  8530         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8531             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8532             IF FORM-MASTER-FOUND
  8533                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8534
  8535     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8536        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8537
  8538********************** MON CODE **********************
  8539     IF PB-COMPANY-ID = 'MON'
  8540     IF PB-ISSUE
  8541     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8542        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8543             PB-I-LOAN-APR = ZERO)
  8544               MOVE 14.0         TO PB-I-LOAN-APR.
  8545******************************************************
  8546
  8547     IF PB-COMPANY-ID = 'NCL'
  8548       IF PB-ISSUE
  8549           IF FORM-MASTER-FOUND
  8550             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8551                AM-DISMBR-COVERAGE
  8552                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8553                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8554                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8555                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8556                                           PB-I-LIFE-BENEFIT-CD.
  8557
  8558     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8559
  8560     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8561         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8562         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8563         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8564         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8565         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8566           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8567             GO TO 0301-LIFE-BENEFIT-SEARCH
  8568         ELSE
  8569             NEXT SENTENCE
  8570     ELSE
  8571         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8572
  8573     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8574     MOVE '4'                    TO CNTL-REC-TYPE.
  8575     MOVE +0                     TO CNTL-SEQ-NO.
  8576     MOVE WS-ACCESS              TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 157
* EL050.cbl
  8577
  8578     MOVE '1' TO RC-SW-2.
  8579     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8580
  8581     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8582        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8583         GO TO 0305-BENEFIT-NOT-FOUND.
  8584
  8585     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8586
  8587 0301-LIFE-BENEFIT-SEARCH.
  8588
  8589     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8590
  8591     IF NO-BENEFIT-FOUND
  8592        GO TO 0305-BENEFIT-NOT-FOUND.
  8593
  8594     IF WS-BEN-CD = '99'
  8595        GO TO 0305-BENEFIT-NOT-FOUND.
  8596
  8597     IF PB-COMPANY-ID = 'NCL'
  8598         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8599             GO TO 0304-LIFE-BENEFIT-FOUND.
  8600
  8601     MOVE +1                     TO SUB5.
  8602     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8603
  8604* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8605* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8606     IF PB-COMPANY-ID = 'DMD'
  8607         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8608
  8609 0302-EDIT-ACCT-LF-BENEFITS.
  8610
  8611     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8612        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8613           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8614                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8615           GO TO 03XX-GET-LIFE-ERPLAN.
  8616
  8617     IF SUB5 LESS THAN +20
  8618        ADD +1                   TO SUB5
  8619        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8620
  8621     MOVE +1                     TO SUB5.
  8622
  8623     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8624        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8625
  8626 0303-EDIT-DMD-EXTRA-BENEFITS.
  8627
  8628     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8629        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8630           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8631                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8632           GO TO 03XX-GET-LIFE-ERPLAN.
  8633
  8634     IF SUB5 LESS THAN +30
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 158
* EL050.cbl
  8635        ADD +1                   TO SUB5
  8636        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8637
  8638     MOVE +1                     TO SUB5.
  8639
  8640 03XX-EDIT-FOR-NINETY-LF.
  8641
  8642***************************************************************
  8643*                                                             *
  8644*    NINETY BENEFIT PLAN TYPES:                               *
  8645*                                                             *
  8646*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8647*      92 = ALL GROUP REDUCING BENEFITS                       *
  8648*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8649*      94 = ALL GROUP LEVEL BENEFITS                          *
  8650*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8651*           BENEFIT CONTROLS.                                 *
  8652*      99 = ALL BENEFITS                                      *
  8653*                                                             *
  8654***************************************************************
  8655
  8656     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8657                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8658
  8659     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8660       AND
  8661        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8662        GO TO 03XX-GET-LIFE-ERPLAN.
  8663
  8664     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8665       AND
  8666        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8667        IF CF-REDUCING (SUB3)
  8668           IF (PB-I-INDV-GRP-OVRD = 'I')
  8669              OR
  8670           ((AM-IG = '1') AND
  8671           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8672              OR
  8673           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8674           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8675           (AM-IG NOT = '2'))
  8676              GO TO 03XX-GET-LIFE-ERPLAN.
  8677
  8678     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8679       AND
  8680        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8681        IF CF-REDUCING (SUB3)
  8682           IF (PB-I-INDV-GRP-OVRD = 'G')
  8683              OR
  8684           ((AM-IG = '2') AND
  8685           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8686              OR
  8687           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8688           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8689           (AM-IG NOT = '1'))
  8690              GO TO 03XX-GET-LIFE-ERPLAN.
  8691
  8692     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 159
* EL050.cbl
  8693       AND
  8694        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8695        IF CF-LEVEL    (SUB3)
  8696           IF (PB-I-INDV-GRP-OVRD = 'I')
  8697              OR
  8698           ((AM-IG = '1') AND
  8699           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8700              OR
  8701           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8702           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8703            (AM-IG NOT = '2'))
  8704              GO TO 03XX-GET-LIFE-ERPLAN.
  8705
  8706     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8707       AND
  8708        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8709        IF CF-LEVEL    (SUB3)
  8710           IF (PB-I-INDV-GRP-OVRD = 'G')
  8711              OR
  8712           ((AM-IG = '2') AND
  8713           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8714              OR
  8715           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8716           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8717           (AM-IG NOT = '1'))
  8718              GO TO 03XX-GET-LIFE-ERPLAN.
  8719
  8720     IF SUB5 LESS THAN +20
  8721        ADD +1                   TO SUB5
  8722        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8723
  8724     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8725
  8726     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8727        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8728
  8729     MOVE +1                     TO SUB5.
  8730
  8731 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8732
  8733     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8734                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8735
  8736     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8737       AND
  8738        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8739        GO TO 03XX-GET-LIFE-ERPLAN.
  8740
  8741     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8742       AND
  8743        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8744        IF CF-REDUCING (SUB3)
  8745           IF (PB-I-INDV-GRP-OVRD = 'I')
  8746              OR
  8747           ((AM-IG = '1') AND
  8748           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8749              OR
  8750           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 160
* EL050.cbl
  8751           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8752           (AM-IG NOT = '2'))
  8753              GO TO 03XX-GET-LIFE-ERPLAN.
  8754
  8755     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8756       AND
  8757        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8758        IF CF-REDUCING (SUB3)
  8759           IF (PB-I-INDV-GRP-OVRD = 'G')
  8760              OR
  8761           ((AM-IG = '2') AND
  8762           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8763              OR
  8764           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8765           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8766           (AM-IG NOT = '1'))
  8767              GO TO 03XX-GET-LIFE-ERPLAN.
  8768
  8769     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8770       AND
  8771        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8772        IF CF-LEVEL    (SUB3)
  8773           IF (PB-I-INDV-GRP-OVRD = 'I')
  8774              OR
  8775           ((AM-IG = '1') AND
  8776           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8777              OR
  8778           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8779           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8780            (AM-IG NOT = '2'))
  8781              GO TO 03XX-GET-LIFE-ERPLAN.
  8782
  8783     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8784       AND
  8785        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8786        IF CF-LEVEL    (SUB3)
  8787           IF (PB-I-INDV-GRP-OVRD = 'G')
  8788              OR
  8789           ((AM-IG = '2') AND
  8790           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8791              OR
  8792           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8793           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8794           (AM-IG NOT = '1'))
  8795              GO TO 03XX-GET-LIFE-ERPLAN.
  8796
  8797     IF SUB5 LESS THAN +30
  8798        ADD +1                   TO SUB5
  8799        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8800
  8801     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8802
  8803 03XX-EDIT-FOR-NINETY-LF-CONT.
  8804
  8805     MOVE +99                    TO SUB5.
  8806
  8807     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8808        IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 161
* EL050.cbl
  8809           MOVE ER-1924          TO  WS-ERROR
  8810           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8811
  8812     GO TO 0304-LIFE-BENEFIT-FOUND.
  8813
  8814 03XX-GET-LIFE-ERPLAN.
  8815
  8816     IF WK-PLAN-ADDR EQUAL +0
  8817        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8818
  8819     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8820     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8821     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8822     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8823     MOVE 'Y'                    TO PLAN-MASTER-SW
  8824                                    PLAN-MASTER-LIFE-SW.
  8825     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8826
  8827 03XX-ERPLAN-LIFE-GETMAIN.
  8828
  8829     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8830     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8831
  8832 03XX-ERPLAN-LIFE-READ.
  8833
  8834     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8835     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8836     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8837     MOVE PB-SV-STATE            TO PLAN-STATE.
  8838     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8839     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8840     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8841     MOVE WS-SAVE-BENEFIT-REVISION
  8842                                 TO PLAN-REVISION-NO.
  8843
  8844     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8845     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8846
  8847     IF PB-COMPANY-ID = 'NCL'
  8848       IF NOT LF-PLAN-MASTER-FOUND
  8849         IF NOT PB-POLICY-IS-DECLINED  AND
  8850            NOT PB-POLICY-IS-VOIDED
  8851             MOVE  ER-1921         TO  WS-ERROR
  8852             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8853             GO TO 0304-LIFE-BENEFIT-FOUND.
  8854
  8855     IF NOT LF-PLAN-MASTER-FOUND
  8856        GO TO 0304-LIFE-BENEFIT-FOUND.
  8857
  8858 XXXX-CHECK-LF-PLAN-KEY.
  8859
  8860     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8861        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8862        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8863        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8864        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8865        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8866        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 162
* EL050.cbl
  8867        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8868        MOVE 'N'                 TO PLAN-MASTER-SW
  8869          GO TO 03XX-ERPLAN-LIFE-READ.
  8870
  8871     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8872
  8873     IF  PB-CANCELLATION
  8874         GO TO  0303-LF-ACCT-BEN-FOUND.
  8875
  8876     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8877        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8878           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8879           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8880              MOVE ER-2644             TO WS-ERROR
  8881              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8882           ELSE
  8883              NEXT SENTENCE
  8884        ELSE
  8885           IF PB-COMPANY-ID NOT = 'NCL'
  8886              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8887                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8888
  8889 0303-LF-ACCT-BEN-FOUND.
  8890
  8891     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8892
  8893     IF PL-DEV-CODE NOT = SPACES
  8894        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8895
  8896     IF PL-DEV-PCT NUMERIC AND
  8897        PL-DEV-PCT NOT = ZEROS
  8898        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8899
  8900     IF PL-TOL-PREM-AMT GREATER THAN +0
  8901        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8902
  8903     IF PL-TOL-REF-AMT GREATER THAN +0
  8904        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8905
  8906     IF PL-TOL-PREM-PCT GREATER THAN +0
  8907        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8908
  8909     IF PL-TOL-REF-PCT GREATER THAN +0
  8910        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8911
  8912     IF PL-TOL-CLM-AMT GREATER THAN +0
  8913        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8914
  8915     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8916                          PL-OVER-SHORT-AMT > +0
  8917        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8918
  8919     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8920                          PL-OVER-SHORT-PCT > +0
  8921        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8922
  8923     IF PL-SALES-TAX NUMERIC AND
  8924                          PL-SALES-TAX > +0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 163
* EL050.cbl
  8925         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8926
  8927     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8928        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8929                                    WS-IG-OVRD-AM.
  8930
  8931 0304-LIFE-BENEFIT-FOUND.
  8932
  8933     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8934
  8935     IF PB-ISSUE
  8936        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8937     ELSE
  8938        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8939
  8940     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8941     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8942     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8943     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8944     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8945                                         WS-LF-REFUND-CALC.
  8946     if (ws-lf-earnings-calc = '5')
  8947        and (pb-i-loan-apr = zeros)
  8948        and (benefit-code-chg)
  8949        move +99.9999 to pb-i-loan-apr
  8950     end-if
  8951
  8952     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8953        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8954
  8955     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8956        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8957     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8958
  8959     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8960     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8961     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8962     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8963     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8964     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8965
  8966     IF PB-COMPANY-ID = 'NCL'  AND
  8967        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8968         NEXT SENTENCE
  8969     ELSE
  8970         IF SUB5 NOT GREATER THAN +20
  8971            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8972               MOVE WS-SAVE-BENEFIT-REM-TERM
  8973                                      TO WS-AM-LF-BENE-REM-TERM
  8974                                         EC-BR-LF-REM-TERM-CALC.
  8975
  8976     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8977     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8978
  8979     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8980
  8981 0305-BENEFIT-NOT-FOUND.
  8982
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 164
* EL050.cbl
  8983     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8984     MOVE ER-2604                TO WS-ERROR.
  8985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8986
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 165
* EL050.cbl
  8988
  8989 0310-FIND-AH-BENEFIT-RECORD.
  8990
  8991     MOVE 'N'                    TO PLAN-MASTER-SW
  8992                                    PLAN-MASTER-AH-SW.
  8993
  8994     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8995                                    WS-PL-TOL-AH-REFUND
  8996                                    WS-AH-PL-REF-OVS-AMT
  8997                                    WS-PL-TOL-AH-PREM-PCT
  8998                                    WS-PL-TOL-AH-REFUND-PCT
  8999                                    WS-AH-PL-REF-OVS-PCT
  9000                                    WS-PL-TOL-AH-CLAIM.
  9001     MOVE ' '                    TO WS-AH-DCC-TRUNC
  9002
  9003
  9004     if pb-issue
  9005        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  9006           MOVE SPACES              TO PB-I-AH-INPUT-CD
  9007        end-if
  9008        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  9009           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  9010           GO TO 0399-BENEFIT-NOT-FOUND
  9011        end-if
  9012     end-if
  9013
  9014     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9015        GO TO 0400-FIND-CARRIER.
  9016
  9017     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9018
  9019     IF WK-AH-BEN-ADDR NOT = ZEROS
  9020         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9021         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9022         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9023         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9024           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9025             GO TO 0311-AH-BENEFIT-SEARCH
  9026         ELSE
  9027             NEXT SENTENCE
  9028     ELSE
  9029         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9030
  9031     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9032     MOVE '5'                    TO CNTL-REC-TYPE.
  9033     MOVE +0                     TO CNTL-SEQ-NO.
  9034     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9035
  9036     MOVE '2' TO RC-SW-2.
  9037     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9038
  9039     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9040        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9041          GO TO 0399-BENEFIT-NOT-FOUND.
  9042
  9043     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9044
  9045 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 166
* EL050.cbl
  9046
  9047     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9048
  9049     IF NO-BENEFIT-FOUND
  9050         GO TO 0399-BENEFIT-NOT-FOUND.
  9051
  9052     IF WS-BEN-CD = '99'
  9053        GO TO 0399-BENEFIT-NOT-FOUND.
  9054
  9055     IF PB-COMPANY-ID  =  'NCL'
  9056         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9057             GO TO 0314-A-H-BENEFIT-FOUND.
  9058
  9059     MOVE +1                     TO SUB5.
  9060     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9061
  9062* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9063* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9064     IF PB-COMPANY-ID = 'DMD'
  9065         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9066
  9067 0312-EDIT-ACCT-AH-BENEFITS.
  9068
  9069     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9070        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9071           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9072                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9073           GO TO 03XX-GET-AH-ERPLAN.
  9074
  9075     IF SUB5 LESS THAN +20
  9076        ADD +1                   TO SUB5
  9077        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9078
  9079     MOVE +1                     TO SUB5.
  9080
  9081     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9082        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9083
  9084 0313-EDIT-DMD-EXTRA-BENEFITS.
  9085
  9086     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9087        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9088           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9089                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9090           GO TO 03XX-GET-AH-ERPLAN.
  9091
  9092     IF SUB5 LESS THAN +30
  9093        ADD +1                   TO SUB5
  9094        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9095
  9096     MOVE +1                     TO SUB5.
  9097
  9098 03XX-EDIT-FOR-NINETY-AH.
  9099
  9100***************************************************************
  9101*                                                             *
  9102*    NINETY BENEFIT PLAN TYPES:                               *
  9103*                                                             *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 167
* EL050.cbl
  9104*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9105*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9106*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9107*           BENEFIT CONTROLS.                                 *
  9108*      99 = ALL BENEFITS.                                     *
  9109*                                                             *
  9110***************************************************************
  9111
  9112     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9113                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9114
  9115     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9116       AND
  9117        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9118        GO TO 03XX-GET-AH-ERPLAN.
  9119
  9120     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9121       AND
  9122        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9123           IF (PB-I-INDV-GRP-OVRD = 'I')
  9124              OR
  9125           ((AM-IG = '1') AND
  9126           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9127              OR
  9128           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9129           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9130           (AM-IG NOT = '2'))
  9131              GO TO 03XX-GET-AH-ERPLAN.
  9132
  9133     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9134       AND
  9135        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9136           IF (PB-I-INDV-GRP-OVRD = 'G')
  9137              OR
  9138           ((AM-IG = '2') AND
  9139           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9140              OR
  9141           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9142           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9143           (AM-IG NOT = '1'))
  9144              GO TO 03XX-GET-AH-ERPLAN.
  9145
  9146     IF SUB5 LESS THAN +20
  9147        ADD +1                   TO SUB5
  9148        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9149
  9150     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9151        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9152
  9153     MOVE +1                    TO SUB5.
  9154
  9155 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9156
  9157     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9158                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9159
  9160     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9161       AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 168
* EL050.cbl
  9162        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9163        GO TO 03XX-GET-AH-ERPLAN.
  9164
  9165     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9166       AND
  9167        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9168           IF (PB-I-INDV-GRP-OVRD = 'I')
  9169              OR
  9170           ((AM-IG = '1') AND
  9171           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9172              OR
  9173           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9174           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9175           (AM-IG NOT = '2'))
  9176              GO TO 03XX-GET-AH-ERPLAN.
  9177
  9178     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9179       AND
  9180        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9181           IF (PB-I-INDV-GRP-OVRD = 'G')
  9182              OR
  9183           ((AM-IG = '2') AND
  9184           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9185              OR
  9186           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9187           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9188           (AM-IG NOT = '1'))
  9189              GO TO 03XX-GET-AH-ERPLAN.
  9190
  9191     IF SUB5 LESS THAN +30
  9192        ADD +1                   TO SUB5
  9193        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9194
  9195 03XX-EDIT-FOR-NINETY-AH-CONT.
  9196
  9197     MOVE +99                    TO SUB5.
  9198
  9199     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9200
  9201     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9202        IF PB-ISSUE
  9203           MOVE ER-1925          TO  WS-ERROR
  9204           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9205
  9206     GO TO 0314-A-H-BENEFIT-FOUND.
  9207
  9208 03XX-GET-AH-ERPLAN.
  9209
  9210     IF WK-PLAN-ADDR EQUAL +0
  9211         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9212
  9213     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9214     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9215     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9216     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9217     MOVE 'Y'                    TO PLAN-MASTER-SW
  9218                                    PLAN-MASTER-AH-SW.
  9219*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 169
* EL050.cbl
  9220     GO TO 03XX-ERPLAN-AH-READ.
  9221
  9222 03XX-ERPLAN-AH-GETMAIN.
  9223
  9224     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9225     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9226
  9227 03XX-ERPLAN-AH-READ.
  9228
  9229     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9230     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9231     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9232     MOVE PB-SV-STATE            TO PLAN-STATE.
  9233     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9234     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9235     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9236     MOVE WS-SAVE-BENEFIT-REVISION
  9237                                 TO PLAN-REVISION-NO.
  9238
  9239     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9240     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9241
  9242     IF PB-COMPANY-ID = 'NCL'
  9243       IF NOT AH-PLAN-MASTER-FOUND
  9244         IF NOT PB-POLICY-IS-DECLINED  AND
  9245            NOT PB-POLICY-IS-VOIDED
  9246             MOVE  ER-1922         TO  WS-ERROR
  9247             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9248             GO TO 0314-A-H-BENEFIT-FOUND.
  9249
  9250     IF NOT AH-PLAN-MASTER-FOUND
  9251        GO TO 0314-A-H-BENEFIT-FOUND.
  9252
  9253 XXXX-CHECK-AH-PLAN-KEY.
  9254
  9255     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9256        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9257        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9258        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9259        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9260        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9261        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9262        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9263        MOVE 'N'                 TO PLAN-MASTER-SW
  9264          GO TO 03XX-ERPLAN-AH-READ.
  9265
  9266     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9267
  9268     IF  PB-CANCELLATION
  9269         GO TO  0313-AH-ACCT-BEN-FOUND.
  9270
  9271     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9272       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9273          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9274          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9275             MOVE ER-2644             TO WS-ERROR
  9276             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9277          ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 170
* EL050.cbl
  9278             NEXT SENTENCE
  9279       ELSE
  9280          IF PB-COMPANY-ID NOT = 'NCL'
  9281             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9282                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9283
  9284 0313-AH-ACCT-BEN-FOUND.
  9285
  9286     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9287
  9288     IF PL-DEV-CODE NOT = SPACES
  9289        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9290
  9291     IF PL-DEV-PCT NUMERIC AND
  9292        PL-DEV-PCT NOT = ZEROS
  9293        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9294
  9295     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9296        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9297
  9298     IF PL-TOL-REF-AMT NOT EQUAL +0
  9299        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9300
  9301     IF PL-TOL-PREM-PCT GREATER THAN +0
  9302        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9303
  9304     IF PL-TOL-REF-PCT GREATER THAN +0
  9305        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9306
  9307     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9308        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9309
  9310     IF PL-OVER-SHORT-AMT NUMERIC AND
  9311                          PL-OVER-SHORT-AMT > +0
  9312        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9313
  9314     IF PL-OVER-SHORT-PCT NUMERIC AND
  9315                          PL-OVER-SHORT-PCT > +0
  9316        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9317
  9318     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9319        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9320        IF WS-IG-OVRD-AM EQUAL SPACES
  9321            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9322
  9323 0314-A-H-BENEFIT-FOUND.
  9324
  9325     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9326
  9327     IF PB-ISSUE
  9328        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9329       ELSE
  9330        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9331
  9332     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9333     if cf-maximum-benefits (sub3) numeric
  9334        move cf-maximum-benefits (sub3)
  9335                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 171
* EL050.cbl
  9336     else
  9337        move zeros               to ws-ah-max-bens
  9338     end-if
  9339     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9340     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9341     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9342                                         WS-AH-REFUND-CALC.
  9343
  9344     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9345        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9346
  9347     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9348        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9349     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9350
  9351     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9352     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9353     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9354     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9355     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9356     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9357
  9358     IF PB-COMPANY-ID = 'NCL'  AND
  9359        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9360         NEXT SENTENCE
  9361     ELSE
  9362         IF SUB5 NOT GREATER THAN +20
  9363            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9364                MOVE WS-SAVE-BENEFIT-REM-TERM
  9365                                      TO WS-AM-AH-BENE-REM-TERM
  9366                                         EC-BR-AH-REM-TERM-CALC.
  9367
  9368     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9369     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9370
  9371     GO TO 0400-FIND-CARRIER.
  9372
  9373 0399-BENEFIT-NOT-FOUND.
  9374
  9375     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9376     MOVE ER-2605                TO WS-ERROR.
  9377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9378
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 172
* EL050.cbl
  9380
  9381 0400-FIND-CARRIER.
  9382
  9383     MOVE PB-SV-CARRIER          TO WS-CARR.
  9384
  9385     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9386     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9387     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9388     MOVE '6'                    TO CNTL-REC-TYPE.
  9389
  9390*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9391     MOVE SPACE                  TO WS-DMD-RATING-SW
  9392                                    EC-BR-DMD-RATING-SW.
  9393
  9394     MOVE '2'                    TO RC-SW-1.
  9395     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9396
  9397     IF NOT CF-CARRIER-MASTER
  9398        GO TO 0400-CARRIER-NOT-FOUND.
  9399
  9400 0400-BUILD-CARR-TOL.
  9401
  9402     IF CF-CR-TOL-PREM NUMERIC AND
  9403        CF-CR-TOL-PREM GREATER THAN +0
  9404        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9405                                    WS-TOL-AH-PREM.
  9406
  9407     IF CF-CR-TOL-REFUND NUMERIC AND
  9408        CF-CR-TOL-REFUND GREATER THAN +0
  9409        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9410                                    WS-TOL-AH-REFUND.
  9411
  9412     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9413        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9414        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9415                                    WS-AH-REFUND-OVS-AMT.
  9416
  9417     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9418        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9419        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9420                                    WS-AH-REFUND-OVS-PCT.
  9421
  9422     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9423        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9424        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9425                                    WS-TOL-AH-PREM-PCT.
  9426
  9427     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9428        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9429        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9430                                     WS-TOL-AH-REFUND-PCT.
  9431
  9432     IF CF-COMPANY-ID EQUAL 'DMD'
  9433         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9434                                    EC-BR-DMD-RATING-SW.
  9435
  9436     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9437     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 173
* EL050.cbl
  9438        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9439     END-IF
  9440     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9441        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9442     END-IF
  9443     IF WS-TOL-CLP-PCT = ZEROS
  9444        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9445     END-IF
  9446
  9447     IF WS-SPP-LEASE-COMM = ZEROS
  9448        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9449     END-IF
  9450     GO TO 0400-FIND-ERPDEF.
  9451
  9452 0400-CARRIER-NOT-FOUND.
  9453
  9454     MOVE ER-2602                TO WS-ERROR.
  9455     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9456
  9457 0400-FIND-ERPDEF.
  9458*    IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9459     IF (PB-COMPANY-ID = 'DCC')
  9460        AND (AM-DCC-PRODUCT-CODE <> spaces)
  9461        CONTINUE
  9462     ELSE
  9463        GO TO 0400-FIND-ERCOMP
  9464     END-IF
  9465     MOVE ' '                    TO PDEF-MASTER-SW
  9466     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9467     MOVE PB-STATE               TO ERPDEF-STATE
  9468     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9469        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9470     END-IF
  9471     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9472     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9473     IF PB-ISSUE
  9474        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9475     ELSE
  9476        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9477     END-IF
  9478     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9479     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9480     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9481     IF PDEF-MASTER-FOUND
  9482        MOVE 'N'                 TO PDEF-MASTER-SW
  9483        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9484        IF PDEF-MASTER-FOUND
  9485           IF (ERPDEF-KEY-SAVE (1:16) =
  9486                        PD-CONTROL-PRIMARY (1:16))
  9487              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9488              CONTINUE
  9489           ELSE
  9490              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9491              IF (ERPDEF-KEY-SAVE (1:16) =
  9492                        PD-CONTROL-PRIMARY (1:16))
  9493                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9494                 CONTINUE
  9495              ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 174
* EL050.cbl
  9496                 MOVE 'N'        TO PDEF-MASTER-SW
  9497              END-IF
  9498           END-IF
  9499        END-IF
  9500        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9501     END-IF
  9502     IF PDEF-MASTER-FOUND
  9503        IF PD-TRUNCATED = 'Y'
  9504           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9505        END-IF
  9506     END-IF
  9507     .
  9508 0400-FIND-ERCOMP.
  9509     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9510        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9511           (WS-SUB1 > +10)
  9512           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9513                 OR 'A' OR 'N'
  9514              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9515              MOVE PB-CARRIER    TO COMP-CARRIER
  9516              MOVE PB-GROUPING   TO COMP-GROUPING
  9517              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9518              MOVE AM-AGT (WS-SUB1)
  9519                                 TO COMP-FIN-RESP
  9520              MOVE 'G'           TO COMP-TYPE
  9521              PERFORM 8582-READ-COMPENSATION-MASTER
  9522                                 THRU 8582-EXIT
  9523              IF COMP-MASTER-FOUND
  9524                 IF CO-GA-INACTIVE
  9525                    MOVE ER-2763 TO WS-ERROR
  9526                    PERFORM 9900-ERROR-FORMAT
  9527                                 THRU 9900-EXIT
  9528                    MOVE +11     TO WS-SUB1
  9529                 END-IF
  9530                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9531                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9532                    MOVE ER-2788 TO WS-ERROR
  9533                    PERFORM 9900-ERROR-FORMAT
  9534                                 THRU 9900-EXIT
  9535                    MOVE +11     TO WS-SUB1
  9536                 END-IF
  9537              END-IF
  9538           END-IF
  9539        END-PERFORM
  9540     END-IF
  9541     IF PB-COMPANY-ID = 'DCC' or 'VPP'
  9542        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9543           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9544                                    WS-CLP-STATE
  9545        ELSE
  9546           MOVE SPACES           TO PB-I-CLP-STATE
  9547                                    WS-CLP-STATE
  9548        END-IF
  9549     END-IF
  9550
  9551     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
  9552        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9553        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 175
* EL050.cbl
  9554        CONTINUE
  9555     ELSE
  9556        GO TO 0400-FIND-STATE-RECORD
  9557     END-IF
  9558     MOVE SPACES                 TO WS-CLP-STATE
  9559     MOVE +0                     TO WS-BANK-FEE
  9560                                    WS-BANK-LFEE
  9561                                    WS-BANK-NOCHRGB
  9562
  9563     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9564     IF (PB-ISSUE)
  9565        AND (PB-I-BANK-NUMBER NOT =
  9566            SPACES AND ZEROS AND LOW-VALUES)
  9567        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9568     ELSE
  9569        IF (PB-CANCELLATION)
  9570           AND (PB-CI-BANK-NUMBER NOT =
  9571                SPACES AND ZEROS AND LOW-VALUES)
  9572           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9573        END-IF
  9574     END-IF
  9575     IF COMP-FIN-RESP NOT = LOW-VALUES
  9576        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9577        MOVE PB-CARRIER          TO COMP-CARRIER
  9578        MOVE PB-GROUPING         TO COMP-GROUPING
  9579        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9580        MOVE 'B'                 TO COMP-TYPE
  9581        PERFORM 8582-READ-COMPENSATION-MASTER
  9582                                 THRU 8582-EXIT
  9583        IF COMP-MASTER-FOUND
  9584           IF CO-MAX-BANK-FEE NOT NUMERIC
  9585              MOVE +0            TO CO-MAX-BANK-FEE
  9586           END-IF
  9587           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9588              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9589           END-IF
  9590           IF CO-GA-INACTIVE
  9591              MOVE ER-2763       TO WS-ERROR
  9592              PERFORM 9900-ERROR-FORMAT
  9593                                 THRU 9900-EXIT
  9594           END-IF
  9595           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9596              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9597              MOVE ER-2788 TO WS-ERROR
  9598              PERFORM 9900-ERROR-FORMAT
  9599                                 THRU 9900-EXIT
  9600              MOVE +11     TO WS-SUB1
  9601           END-IF
  9602           IF WS-AH-BEN-CATEGORY = 'G'
  9603              MOVE CO-MAX-BANK-FEE
  9604                                 TO WS-BANK-FEE
  9605                                    PB-I-BANK-FEE
  9606           ELSE
  9607              MOVE CO-MAX-BANK-FEE-LEASE
  9608                                 TO WS-BANK-LFEE
  9609                                    PB-I-BANK-FEE
  9610           END-IF
  9611           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 176
* EL050.cbl
  9612              AND (WS-AH-REFUND-CALC = 'G'))
  9613                        OR
  9614              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9615              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9616              CONTINUE
  9617           ELSE
  9618              MOVE ER-2789 TO WS-ERROR
  9619              PERFORM 9900-ERROR-FORMAT
  9620                                 THRU 9900-EXIT
  9621           END-IF
  9622           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9623                                    PB-I-CLP-STATE
  9624           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9625           MOVE CO-CARRIER       TO BXRF-CARRIER
  9626           MOVE CO-GROUPING      TO BXRF-GROUPING
  9627           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9628           MOVE BXRF-MAX-REC-LENGTH
  9629                                 TO BXRF-REC-LENGTH
  9630           PERFORM 8584-READ-BANK-CROSS-REF
  9631                                 THRU 8584-EXIT
  9632           IF BXRF-MASTER-FOUND
  9633              MOVE ' '           TO BANK-ACCT-SW
  9634              MOVE BK-BANK-POINTER-CNT
  9635                                 TO BK-BANK-POINTER-CNT
  9636              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9637                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9638                 OR (BANK-ACCT-FOUND)
  9639                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9640                    AND (BK-AM-EXP-DT (WS-SUB1)
  9641                                 > PB-CERT-EFF-DT)
  9642                    AND (BK-AM-EFF-DT (WS-SUB1)
  9643                                 NOT > PB-CERT-EFF-DT)
  9644                    SET BANK-ACCT-FOUND TO TRUE
  9645                 END-IF
  9646              END-PERFORM
  9647              IF NOT BANK-ACCT-FOUND
  9648                 MOVE ZEROS      TO WS-BANK-FEE
  9649                                    WS-BANK-LFEE
  9650                 MOVE ER-2869    TO WS-ERROR
  9651                 PERFORM 9900-ERROR-FORMAT
  9652                                 THRU 9900-EXIT
  9653              ELSE
  9654                 PERFORM 5000-PROCESS-REPS
  9655                                 THRU 5000-EXIT
  9656                 IF AGENT-MASTER-FOUND
  9657                    MOVE +0      TO WS-BANK-FEE
  9658                                    WS-BANK-LFEE
  9659*                   MOVE AG-SPP-FEES (1)
  9660*                                TO PB-I-BANK-FEE
  9661*                                   WS-BANK-FEE
  9662                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9663                       (WS-SUB1 > +10)
  9664                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9665                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9666                       END-IF
  9667                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9668                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9669                       END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 177
* EL050.cbl
  9670                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9671                          AG-SPP-FEES (WS-SUB1)
  9672                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9673                          AG-SPP-LFEES (WS-SUB1)
  9674                    END-PERFORM
  9675                    IF WS-AH-BEN-CATEGORY = 'G'
  9676                       MOVE WS-BANK-FEE
  9677                                 TO PB-I-BANK-FEE
  9678                    ELSE
  9679                       MOVE WS-BANK-LFEE
  9680                                 TO PB-I-BANK-FEE
  9681                    END-IF
  9682                 END-IF
  9683              END-IF
  9684           END-IF
  9685        ELSE
  9686           MOVE ER-2879          TO WS-ERROR
  9687           PERFORM 9900-ERROR-FORMAT
  9688                                 THRU 9900-EXIT
  9689        END-IF
  9690     ELSE
  9691        MOVE ER-2879             TO WS-ERROR
  9692        PERFORM 9900-ERROR-FORMAT
  9693                                 THRU 9900-EXIT
  9694     END-IF
  9695     IF WS-AH-BEN-CATEGORY = 'G'
  9696        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9697        + WS-BANK-FEE
  9698     ELSE
  9699        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9700        + WS-BANK-LFEE
  9701     END-IF
  9702     .
  9703 0400-FIND-STATE-RECORD.
  9704
  9705     IF WK-STATE-ADDR NOT = ZEROS
  9706         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9707         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9708         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9709         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9710         IF PB-SV-STATE = CF-STATE-CODE
  9711             GO TO 0405-CONTINUE-EDIT
  9712         ELSE
  9713             NEXT SENTENCE
  9714     ELSE
  9715         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9716
  9717     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9718     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9719     MOVE '3'                    TO CNTL-REC-TYPE.
  9720     MOVE +0                     TO CNTL-SEQ-NO.
  9721
  9722     MOVE '3'                    TO RC-SW-2.
  9723     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9724
  9725     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9726        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9727        PB-SV-STATE   NOT = CF-STATE-CODE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 178
* EL050.cbl
  9728        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9729                                    WS-TOL-AH-CLAIM
  9730                                    WS-MINIMUM-REFUND
  9731                                    WS-TOL-LF-PREM
  9732                                    WS-TOL-AH-PREM
  9733                                    WS-TOL-LF-REFUND
  9734                                    WS-TOL-AH-REFUND
  9735                                    EC-ST-TOL-PREM-PCT
  9736                                    WS-TOL-LF-PREM-PCT
  9737                                    WS-TOL-AH-PREM-PCT
  9738                                    EC-ST-TOL-REFUND-PCT
  9739                                    WS-TOL-LF-REFUND-PCT
  9740                                    WS-TOL-AH-REFUND-PCT
  9741                                    EC-ST-TOL-PREM
  9742                                    EC-ST-TOL-REFUND
  9743                                    EC-ST-FST-PMT-DAYS-MAX
  9744                                    WS-FREE-LOOK-PERIOD
  9745                                    WS-ST-LF-PREM-TAX
  9746                                    WS-ST-AH-PREM-TAX-I
  9747                                    WS-ST-AH-PREM-TAX-G
  9748                                    WS-BANK-FEE
  9749                                    WS-BANK-LFEE
  9750                                    WS-TOL-CLP-PCT
  9751                                    WS-SPP-LEASE-COMM
  9752                                    WS-INT-PERIODS
  9753                                    WS-EXTRA-PMTS
  9754        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9755                                    EC-ST-FST-PMT-DAYS-CHG
  9756                                    WS-LF-REM-TERM-CALC
  9757                                    WS-LF-REFUND-CALC
  9758                                    EC-ST-LF-REM-TERM-CALC
  9759                                    EC-ST-LF-REFUND-CALC
  9760                                    WS-AH-REM-TERM-CALC
  9761                                    WS-AH-REFUND-CALC
  9762                                    WS-LF-BEN-CATEGORY
  9763                                    WS-AH-BEN-CATEGORY
  9764                                    WS-CLP-STATE
  9765                                    WS-ST-REFUND-CLAIM-FLAG
  9766                                    WS-ST-CAUSAL-STATE
  9767                                    ws-st-agent-sig-edit
  9768                                    EC-ST-AH-REM-TERM-CALC
  9769                                    EC-ST-AH-REFUND-CALC
  9770          GO TO 0499-STATE-NOT-FOUND.
  9771
  9772     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9773
  9774 0405-CONTINUE-EDIT.
  9775
  9776     if pb-company-id = 'AHL'
  9777        continue
  9778     else
  9779        IF PB-CERT-PRIME NOT NUMERIC
  9780           MOVE ER-2722          TO WS-ERROR
  9781           PERFORM 9900-ERROR-FORMAT
  9782                                 THRU 9900-EXIT
  9783        end-if
  9784     END-IF
  9785*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 179
* EL050.cbl
  9786*       MOVE +0                  TO SUB3
  9787*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9788*       IF SUB3 > +0
  9789*          MOVE ER-2722          TO WS-ERROR
  9790*          PERFORM 9900-ERROR-FORMAT
  9791*                                THRU 9900-EXIT
  9792*       END-IF
  9793*    END-IF
  9794*    IF PB-COMPANY-ID = 'CID' OR 'DCC' or 'VPP'
  9795*       IF PB-CERT-PRIME NOT NUMERIC
  9796*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9797*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9798*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9799*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9800*
  9801*          MOVE ER-2722          TO WS-ERROR
  9802*          PERFORM 9900-ERROR-FORMAT
  9803*                                THRU 9900-EXIT
  9804*       END-IF
  9805*    END-IF
  9806
  9807     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9808
  9809     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9810        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9811                                    WS-TOL-AH-CLAIM.
  9812
  9813     IF CF-ST-REFUND-MIN NOT NUMERIC
  9814        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9815
  9816     IF CF-ST-REFUND-MIN NOT = ZEROS
  9817        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9818
  9819     IF CF-ST-TOL-PREM  NOT = ZEROS
  9820        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9821                                    WS-TOL-AH-PREM
  9822        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9823
  9824     IF CF-ST-TOL-REFUND NOT = ZEROS
  9825        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9826                                    WS-TOL-AH-REFUND
  9827        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9828
  9829     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9830        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9831        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9832                                    WS-AH-REFUND-OVS-AMT
  9833                                    EC-ST-OVR-SHT-AMT.
  9834
  9835     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9836        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9837        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9838                                    WS-TOL-LF-PREM-PCT
  9839                                    WS-TOL-AH-PREM-PCT.
  9840
  9841     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9842        CF-ST-TOL-REF-PCT GREATER THAN +0
  9843        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 180
* EL050.cbl
  9844                                    WS-TOL-LF-REFUND-PCT
  9845                                    WS-TOL-AH-REFUND-PCT.
  9846
  9847     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9848        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9849        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9850                                    WS-AH-REFUND-OVS-PCT
  9851                                    EC-ST-OVR-SHT-PCT.
  9852
  9853     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9854     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9855
  9856     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9857          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9858
  9859     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9860     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9861     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9862
  9863     IF CF-ST-LF-PREM-TAX NUMERIC
  9864        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9865     END-IF
  9866     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9867        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9868     END-IF
  9869     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9870        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9871     END-IF
  9872
  9873     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9874         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9875     END-IF.
  9876
  9877     IF CF-ST-CAUSAL-STATE > SPACES
  9878         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9879     END-IF.
  9880     if cf-st-extra-interest-periods not numeric
  9881        move zeros               to cf-st-extra-interest-periods
  9882     end-if
  9883     if cf-st-extra-payments not numeric
  9884        move zeros               to cf-st-extra-payments
  9885     end-if
  9886
  9887     move cf-st-extra-interest-periods
  9888                                 to ws-int-periods
  9889     move cf-st-extra-payments   to ws-extra-pmts
  9890     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9891     move cf-st-net-only-state   to ws-net-only-state
  9892     IF WS-LF-BENEFIT-CD = ZEROS
  9893        GO TO 0410-CHECK-AH.
  9894
  9895     IF CF-ST-RT-CALC NOT = SPACES
  9896        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9897                                    EC-ST-LF-REM-TERM-CALC
  9898     END-IF
  9899
  9900     IF WS-LF-COVERAGE-TYPE = 'R'
  9901        IF WS-LF-EARNINGS-CALC = '5'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 181
* EL050.cbl
  9902           IF CF-ST-RF-LN-CALC > '0'
  9903              MOVE CF-ST-RF-LN-CALC
  9904                                 TO WS-LF-REFUND-CALC
  9905                                    EC-ST-LF-REFUND-CALC
  9906           END-IF
  9907        ELSE
  9908           IF CF-ST-RF-LR-CALC > '0'
  9909              MOVE CF-ST-RF-LR-CALC
  9910                                 TO WS-LF-REFUND-CALC
  9911                                    EC-ST-LF-REFUND-CALC
  9912           END-IF
  9913        END-IF
  9914     ELSE
  9915        IF CF-ST-RF-LL-CALC > '0'
  9916           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9917                                    EC-ST-LF-REFUND-CALC
  9918        END-IF
  9919     END-IF
  9920
  9921     IF CF-ST-RT-CALC NOT = SPACES
  9922        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9923                                    EC-ST-LF-REM-TERM-CALC
  9924     END-IF
  9925
  9926     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9927     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9928
  9929     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9930
  9931     IF NO-BENEFIT-FOUND
  9932        GO TO 0410-CHECK-AH.
  9933
  9934     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9935        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9936                                 TO EC-ST-LF-REM-TERM-CALC
  9937                                    WS-LF-REM-TERM-CALC
  9938     END-IF
  9939
  9940     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9941        MOVE CF-ST-REFUND-CALC (SUB3)
  9942                                 TO WS-LF-REFUND-CALC
  9943                                    EC-ST-LF-REFUND-CALC
  9944     END-IF
  9945*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9946     if cf-st-extra-periods (sub3) not numeric
  9947        move zeros               to cf-st-extra-periods (sub3)
  9948     end-if
  9949     if cf-st-extra-periods (sub3) > zeros
  9950        if ws-lf-ben-category = 'P'
  9951           move cf-st-extra-periods (sub3)
  9952                                 to ws-extra-pmts
  9953        else
  9954           if ws-lf-ben-category = 'I'
  9955              move cf-st-extra-periods (sub3)
  9956                                 to ws-int-periods
  9957           end-if
  9958        end-if
  9959     end-if
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 182
* EL050.cbl
  9960     .
  9961 0410-CHECK-AH.
  9962
  9963     IF WS-AH-BENEFIT-CD = ZEROS
  9964        GO TO 0500-SET-ACCOUNT.
  9965
  9966     IF CF-ST-RT-CALC NOT = SPACES
  9967        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9968                                    EC-ST-AH-REM-TERM-CALC
  9969     END-IF
  9970
  9971     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9972        IF CF-ST-RF-CP-CALC > '0'
  9973           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9974                                    EC-ST-AH-REFUND-CALC
  9975        END-IF
  9976     ELSE
  9977        IF CF-ST-RF-AH-CALC > '0'
  9978           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9979                                    EC-ST-AH-REFUND-CALC
  9980        END-IF
  9981     END-IF
  9982     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9983     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9984
  9985     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9986
  9987     IF NO-BENEFIT-FOUND
  9988        GO TO 0500-SET-ACCOUNT.
  9989
  9990     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9991        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9992                                 TO WS-AH-REM-TERM-CALC
  9993                                    EC-ST-AH-REM-TERM-CALC
  9994     END-IF
  9995
  9996     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9997        MOVE CF-ST-REFUND-CALC (SUB3)
  9998                                 TO WS-AH-REFUND-CALC
  9999                                    EC-ST-AH-REFUND-CALC
 10000     END-IF
 10001
 10002*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
 10003
 10004     GO TO 0500-SET-ACCOUNT.
 10005
 10006 0499-STATE-NOT-FOUND.
 10007
 10008     MOVE ER-2603                TO WS-ERROR.
 10009     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10010
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 183
* EL050.cbl
 10012
 10013 0500-SET-ACCOUNT.
 10014*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10015     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10016        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10017        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10018        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10019        MOVE '3'                 TO CNTL-REC-TYPE
 10020        MOVE +0                  TO CNTL-SEQ-NO
 10021
 10022        MOVE '3'                 TO RC-SW-2
 10023        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10024
 10025        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10026           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10027           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10028           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10029                                    WS-ST-AH-PREM-TAX-I
 10030                                    WS-ST-AH-PREM-TAX-G
 10031        ELSE
 10032           IF CF-ST-LF-PREM-TAX NUMERIC
 10033              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10034           END-IF
 10035           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10036              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10037           END-IF
 10038           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10039              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10040           END-IF
 10041        END-IF
 10042        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10043     END-IF
 10044*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10045*  FOR DCC ONLY
 10046     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10047
 10048     MOVE ' '                    TO STAT-MASTER-SW
 10049     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10050     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10051     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10052     MOVE PB-STATE               TO ELSTAT-STATE
 10053     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10054        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10055     END-IF
 10056
 10057     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10058     SET BIN-TO-GREG             TO TRUE
 10059     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10060     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10061     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10062
 10063     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10064     IF STAT-MASTER-FOUND
 10065        MOVE 'N'                 TO STAT-MASTER-SW
 10066        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10067        IF STAT-MASTER-FOUND
 10068           IF (ELSTAT-KEY-SAVE (1:12) =
 10069                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 184
* EL050.cbl
 10070              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10071                 MOVE 'F'        TO STAT-MASTER-SW
 10072              ELSE
 10073                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10074                 IF (STAT-MASTER-FOUND)
 10075                    AND (ELSTAT-KEY-SAVE (1:12) =
 10076                        SF-CONTROL-PRIMARY (1:12))
 10077                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10078                    MOVE 'F'     TO STAT-MASTER-SW
 10079                 END-IF
 10080              END-IF
 10081           END-IF
 10082        END-IF
 10083     END-IF
 10084
 10085     IF STAT-MASTER-SW = 'F'
 10086        IF SF-ST-LF-PREM-TAX NUMERIC
 10087           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10088        END-IF
 10089        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10090           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10091        END-IF
 10092        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10093           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10094        END-IF
 10095     END-IF
 10096
 10097     END-IF
 10098     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10099        AND (PB-ISSUE)
 10100        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10101        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10102        AND (AM-GPCD = 06)
 10103        MOVE 'Y'                 TO WS-GOOD-HIN
 10104        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10105           MOVE PB-I-VIN         TO WS-WORK-VIN
 10106           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10107              (V1 > 16)
 10108              IF WS-WORK-VIN (V1:1) NUMERIC
 10109                 MOVE WS-WORK-VIN-N (V1)
 10110                                 TO WS-ROW-B-VAL (V1)
 10111              ELSE
 10112                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10113                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10114                    OR (V2 > 26)
 10115                 END-PERFORM
 10116                 IF V2 < 27
 10117                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10118                 ELSE
 10119                    MOVE 'N'     TO WS-GOOD-HIN
 10120                 END-IF
 10121              END-IF
 10122              COMPUTE WS-ROW-D-VAL (V1) =
 10123                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10124              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10125                 WS-ROW-D-VAL (V1)
 10126           END-PERFORM
 10127           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 185
* EL050.cbl
 10128           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10129             REMAINDER WS-VIN-REMAINDER
 10130           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10131              CONTINUE
 10132           ELSE
 10133              MOVE 'N'           TO WS-GOOD-HIN
 10134           END-IF
 10135        ELSE
 10136           MOVE 'N'              TO WS-GOOD-HIN
 10137        END-IF
 10138        IF WS-GOOD-HIN NOT = 'Y'
 10139           MOVE ER-3826           TO WS-ERROR
 10140           PERFORM 9900-ERROR-FORMAT
 10141                                 THRU 9900-EXIT
 10142        END-IF
 10143     END-IF
 10144     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 10145        AND (PB-ISSUE)
 10146        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10147        AND (AM-GPCD NOT = 06)
 10148        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10149           perform 3400-edit-vin thru 3400-exit
 10150        ELSE
 10151          MOVE ER-3826           TO WS-ERROR
 10152          PERFORM 9900-ERROR-FORMAT
 10153                                 THRU 9900-EXIT
 10154        END-IF
 10155     END-IF
 10156     if (pb-company-id = 'CID')
 10157        and (pb-issue)
 10158        and (pb-i-vin not = spaces and low-values and zeros)
 10159        perform 3400-edit-vin    thru 3400-exit
 10160     end-if
 10161******************************************************************
 10162******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10163******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10164******* METHODS.
 10165******************************************************************
 10166     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10167        IF PB-CANCELLATION
 10168           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10169              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10170                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10171                IF FORM-MASTER-FOUND
 10172                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10173******************************************************************
 10174
 10175     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10176     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10177
 10178     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10179     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10180     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10181     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10182
 10183
 10184     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10185     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 186
* EL050.cbl
 10186     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10187
 10188     IF AM-LF-OB-RATE NOT NUMERIC
 10189         MOVE ZERO               TO AM-LF-OB-RATE.
 10190
 10191     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10192         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10193
 10194     IF AM-AH-OB-RATE NOT NUMERIC
 10195         MOVE ZERO               TO AM-AH-OB-RATE.
 10196
 10197     IF WS-LF-JOINT-INDICATOR = 'J'
 10198         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10199     ELSE
 10200         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10201
 10202     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10203
 10204     IF WS-IG-OVRD-AM  EQUAL SPACE
 10205         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10206
 10207     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10208         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10209                                       WS-IG-OVRD
 10210     ELSE
 10211         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10212             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10213                                       WS-IG-OVRD
 10214         ELSE
 10215             MOVE AM-IG             TO WS-IG-OVRD-AH
 10216                                       WS-IG-OVRD.
 10217
 10218     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10219         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10220                                       WS-IG-OVRD
 10221     ELSE
 10222         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10223             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10224                                       WS-IG-OVRD
 10225         ELSE
 10226             MOVE AM-IG             TO WS-IG-OVRD-LF
 10227                                       WS-IG-OVRD.
 10228
 10229     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10230     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10231     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10232     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10233     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10234
 10235     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10236     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10237     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10238     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10239
 10240     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10241     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10242     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10243     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 187
* EL050.cbl
 10244     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10245     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10246     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10247
 10248     IF WS-ACCT-AH-DEV-PCT > +0
 10249        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10250     ELSE
 10251        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10252
 10253     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10254        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10255     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10256        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10257
 10258        IF AM-EARN-METHOD-L = 'S'
 10259            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10260                                        WS-LF-REFUND-CALC.
 10261
 10262        IF AM-EARN-METHOD-R = 'S'
 10263            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10264                                        WS-LF-REFUND-CALC.
 10265
 10266     IF WS-LF-COVERAGE-TYPE = 'R'
 10267         IF AM-EARN-METHOD-R = 'R'
 10268            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10269                                    WS-LF-REFUND-CALC.
 10270     IF WS-LF-COVERAGE-TYPE = 'R'
 10271         IF AM-EARN-METHOD-R = 'P'
 10272            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10273                                    WS-LF-REFUND-CALC.
 10274     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10275         IF AM-EARN-METHOD-L = 'R'
 10276            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10277                                    WS-LF-REFUND-CALC.
 10278     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10279         IF AM-EARN-METHOD-L = 'P'
 10280            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10281                                    WS-LF-REFUND-CALC.
 10282     IF WS-LF-COVERAGE-TYPE = 'R'
 10283         IF AM-EARN-METHOD-R = 'A'
 10284            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10285                                    WS-LF-REFUND-CALC.
 10286     IF WS-LF-COVERAGE-TYPE = 'R'
 10287         IF AM-EARN-METHOD-R = 'M'
 10288            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10289                                    WS-LF-REFUND-CALC.
 10290     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10291         IF AM-EARN-METHOD-L = 'A'
 10292            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10293                                    WS-LF-REFUND-CALC.
 10294     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10295         IF AM-EARN-METHOD-L = 'M'
 10296            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10297                                    WS-LF-REFUND-CALC.
 10298
 10299     IF AM-EARN-METHOD-A = 'R'
 10300        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10301                                    WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 188
* EL050.cbl
 10302     IF AM-EARN-METHOD-A = 'P'
 10303        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10304                                    WS-AH-REFUND-CALC.
 10305     IF AM-EARN-METHOD-A = 'C'
 10306        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10307                                    WS-AH-REFUND-CALC.
 10308     IF AM-EARN-METHOD-A = 'A'
 10309        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10310                                    WS-AH-REFUND-CALC.
 10311     IF AM-EARN-METHOD-A = 'M'
 10312        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10313                                    WS-AH-REFUND-CALC.
 10314     IF AM-EARN-METHOD-A = 'N'
 10315        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10316                                    WS-AH-REFUND-CALC.
 10317     IF AM-EARN-METHOD-A = 'S'
 10318        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10319                                    WS-AH-REFUND-CALC.
 10320
 10321     IF AM-TOL-PREM NOT = ZEROS
 10322        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10323                                    WS-TOL-AH-PREM.
 10324
 10325     IF AM-OVR-SHT-AMT NUMERIC AND
 10326                  AM-OVR-SHT-AMT > 0
 10327        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10328                                    EC-AM-LF-OVR-SHT-AMT
 10329                                    WS-AH-REFUND-OVS-AMT
 10330                                    EC-AM-AH-OVR-SHT-AMT.
 10331
 10332     IF AM-OVR-SHT-PCT NUMERIC AND
 10333                    AM-OVR-SHT-PCT > 0
 10334        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10335                                    EC-AM-LF-OVR-SHT-PCT
 10336                                    WS-AH-REFUND-OVS-PCT
 10337                                    EC-AM-AH-OVR-SHT-PCT.
 10338
 10339     IF AM-TOL-REF-PCT NUMERIC AND
 10340                  AM-TOL-REF-PCT > 0
 10341        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10342                                    WS-TOL-AH-REFUND-PCT.
 10343
 10344     IF AM-TOL-REF  NOT = ZEROS  AND
 10345                  AM-TOL-REF NUMERIC
 10346        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10347                                    EC-AM-LF-TOL-REFUND
 10348                                    WS-TOL-AH-REFUND
 10349                                    EC-AM-AH-TOL-REFUND.
 10350
 10351     IF AM-TOL-CLM  NOT = ZEROS
 10352        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10353                                    WS-TOL-AH-CLAIM.
 10354
 10355     IF AM-CLP-TOL-PCT NOT NUMERIC
 10356        MOVE +0                  TO AM-CLP-TOL-PCT
 10357     END-IF
 10358
 10359     IF AM-SPP-LEASE-COMM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 189
* EL050.cbl
 10360        MOVE +0                  TO AM-SPP-LEASE-COMM
 10361     END-IF
 10362     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10363        MOVE WS-PL-TOL-LF-PREM-PCT
 10364                                 TO WS-TOL-LF-PREM-PCT.
 10365
 10366     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10367        MOVE WS-PL-TOL-AH-PREM-PCT
 10368                                 TO WS-TOL-AH-PREM-PCT.
 10369
 10370     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10371        MOVE WS-PL-TOL-LF-REFUND-PCT
 10372                                 TO WS-TOL-LF-REFUND-PCT.
 10373
 10374     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10375        MOVE WS-PL-TOL-AH-REFUND-PCT
 10376                                 TO WS-TOL-AH-REFUND-PCT.
 10377
 10378     IF WS-PL-REF-OVS-AMT > +0
 10379        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10380
 10381     IF WS-PL-REF-OVS-PCT > +0
 10382        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10383
 10384     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10385        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10386     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10387        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10388     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10389        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10390     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10391        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10392     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10393        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10394     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10395        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10396
 10397     IF WS-AH-PL-REF-OVS-AMT > +0
 10398        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10399
 10400     IF WS-AH-PL-REF-OVS-PCT > +0
 10401        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10402
 10403     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10404     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10405
 10406     IF PB-CANCELLATION
 10407        GO TO 3000-CONTINUE-EDIT.
 10408
 10409     MOVE +1 TO SUB1.
 10410     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10411     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10412
 10413     IF CF-COMPANY-ID = 'DMD'
 10414       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10415         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10416        ELSE
 10417         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 190
* EL050.cbl
 10418
 10419  0525-FIND-ACCT-COMM.
 10420     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10421        NEXT SENTENCE
 10422      ELSE
 10423         ADD +1 TO SUB1
 10424         IF SUB1 LESS +11
 10425            GO TO 0525-FIND-ACCT-COMM
 10426          ELSE
 10427             GO TO 0560-EDIT-CONTINUE.
 10428
 10429     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10430     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10431                                    PB-I-LIFE-COMMISSION.
 10432***  IF PB-COMPANY-ID = 'CRI'
 10433     IF PB-PREM-ACCTNG-ONLY
 10434         GO TO 0560-EDIT-CONTINUE.
 10435
 10436     MOVE '0530' TO CTBL-SW.
 10437     MOVE ' '    TO WS-CTBL-READ-SW.
 10438
 10439
 10440 0530-GET-AH-COMP.
 10441     IF NO-AH-COVERAGE  OR
 10442        NO-AH-BENEFIT-MATCH
 10443           GO TO 0540-NEXT-READ-STEP.
 10444
 10445     IF AM-A-COM (SUB1) NUMERIC
 10446        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10447         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10448         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10449         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10450         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10451     ELSE
 10452          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10453          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10454          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10455          MOVE ZEROS             TO WS-SUB1
 10456                                    WS-COMMISSION
 10457          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10458          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10459          IF WS-COMMISSION > ZEROS
 10460             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10461             GO TO 0540-NEXT-READ-STEP
 10462          END-IF
 10463          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10464          IF CTBL-TABLE-FOUND
 10465             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10466                                        PB-I-AH-TERM
 10467             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10468             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10469             GO TO 0540-NEXT-READ-STEP
 10470          ELSE
 10471             IF FIRST-TIME-THROUGH
 10472                 GO TO 0530-GET-AH-COMP
 10473             ELSE
 10474                 MOVE ER-2609                TO WS-ERROR
 10475                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 191
* EL050.cbl
 10476
 10477 0540-NEXT-READ-STEP.
 10478     MOVE '0540' TO CTBL-SW.
 10479     MOVE ' '    TO WS-CTBL-READ-SW.
 10480
 10481 0540-GET-LF-COMP.
 10482     IF NO-LIFE-COVERAGE  OR
 10483        NO-LF-BENEFIT-MATCH
 10484           GO TO 0560-EDIT-CONTINUE.
 10485
 10486     IF WS-LF-JOINT-INDICATOR = 'J'
 10487        IF AM-J-COM (SUB1) NUMERIC
 10488           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10489           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10490           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10491           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10492           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10493        ELSE
 10494           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10495           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10496           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10497           MOVE ZEROS                TO WS-SUB1
 10498                                        WS-COMMISSION
 10499           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10500           IF WS-COMMISSION > ZEROS
 10501              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10502              GO TO 0560-EDIT-CONTINUE
 10503           END-IF
 10504           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10505           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10506           IF CTBL-TABLE-FOUND
 10507              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10508              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10509              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10510              GO TO 0560-EDIT-CONTINUE
 10511           ELSE
 10512              IF FIRST-TIME-THROUGH
 10513                  GO TO 0540-GET-LF-COMP
 10514              ELSE
 10515                  MOVE ER-2609                TO WS-ERROR
 10516                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10517                  GO TO 0560-EDIT-CONTINUE.
 10518
 10519     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10520        IF AM-L-COM (SUB1) NUMERIC
 10521           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10522           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10523           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10524           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10525           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10526        ELSE
 10527           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10528           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10529           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10530           MOVE ZEROS                TO WS-SUB1
 10531                                        WS-COMMISSION
 10532           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10533           IF WS-COMMISSION IS GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 192
* EL050.cbl
 10534              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10535              GO TO 0560-EDIT-CONTINUE
 10536           END-IF
 10537           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10538           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10539           IF CTBL-TABLE-FOUND
 10540              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10541              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10542              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10543              GO TO 0560-EDIT-CONTINUE
 10544           ELSE
 10545              IF FIRST-TIME-THROUGH
 10546                  GO TO 0540-GET-LF-COMP
 10547              ELSE
 10548                  MOVE ER-2609                TO WS-ERROR
 10549                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10550
 10551*    GO TO 0560-EDIT-CONTINUE.
 10552
 10553 0560-EDIT-CONTINUE.
 10554     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10555                                    WS-AH-PMF-COMM
 10556*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10557*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10558     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10559        (SUB1 > +10)
 10560        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10561           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10562           MOVE '0530'           TO CTBL-SW
 10563           MOVE ' '              TO WS-CTBL-READ-SW
 10564           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10565           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10566           MOVE '0540'           TO CTBL-SW
 10567           MOVE ' '              TO WS-CTBL-READ-SW
 10568           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10569        END-IF
 10570     END-PERFORM
 10571     GO TO 0564-EDIT-CONTINUE
 10572     .
 10573 0561-CHECK-AH.
 10574     IF (NO-AH-COVERAGE)
 10575        OR (NO-AH-BENEFIT-MATCH)
 10576        CONTINUE
 10577     ELSE
 10578        IF (AM-A-COM (SUB1) NUMERIC)
 10579           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10580           IF (AM-COM-TYP (SUB1) = 'A')
 10581              AND (WS-AH-PMF-COMM = ZEROS)
 10582              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10583           END-IF
 10584           CONTINUE
 10585        ELSE
 10586           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10587           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10588           MOVE PB-AH-OVERRIDE-L1
 10589                                 TO CTBL-BEN-TYPE
 10590           MOVE ZEROS            TO WS-SUB1
 10591                                    WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 193
* EL050.cbl
 10592           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10593           PERFORM 8300-READ-CTBL-TABLE
 10594                                 THRU 8300-EXIT
 10595           IF CTBL-TABLE-FOUND
 10596              IF (AM-COM-TYP (SUB1) = 'A')
 10597                 AND (WS-AH-PMF-COMM = ZEROS)
 10598                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10599                                        PB-I-AH-TERM
 10600                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10601                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10602              END-IF
 10603              CONTINUE
 10604           ELSE
 10605              IF FIRST-TIME-THROUGH
 10606                 GO TO 0561-CHECK-AH
 10607              ELSE
 10608                 MOVE ER-2609    TO WS-ERROR
 10609                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10610              END-IF
 10611           END-IF
 10612        END-IF
 10613     END-IF
 10614     .
 10615 0561-EXIT.
 10616     EXIT.
 10617 0563-CHECK-LF.
 10618     IF (NO-LIFE-COVERAGE)
 10619        OR (NO-LF-BENEFIT-MATCH)
 10620        CONTINUE
 10621     ELSE
 10622        IF WS-LF-JOINT-INDICATOR = 'J'
 10623           IF AM-J-COM (SUB1) NUMERIC
 10624              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10625              IF (AM-COM-TYP (SUB1) = 'A')
 10626                 AND (WS-LF-PMF-COMM = ZEROS)
 10627                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10628              END-IF
 10629              CONTINUE
 10630           ELSE
 10631              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10632              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10633              MOVE PB-LIFE-OVERRIDE-L1
 10634                                 TO CTBL-BEN-TYPE
 10635              MOVE ZEROS         TO WS-SUB1
 10636                                    WS-COMMISSION
 10637              MOVE AM-J-COMA (SUB1)
 10638                                 TO CTBL-TABLE
 10639              PERFORM 8300-READ-CTBL-TABLE
 10640                                 THRU 8300-EXIT
 10641              IF CTBL-TABLE-FOUND
 10642                 IF (AM-COM-TYP (SUB1) = 'A')
 10643                    AND (WS-LF-PMF-COMM = ZEROS)
 10644                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10645                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10646                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10647                 END-IF
 10648                 CONTINUE
 10649              ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 194
* EL050.cbl
 10650                 IF FIRST-TIME-THROUGH
 10651                    GO TO 0563-CHECK-LF
 10652                 ELSE
 10653                    MOVE ER-2609 TO WS-ERROR
 10654                    PERFORM 9900-ERROR-FORMAT
 10655                                 THRU 9900-EXIT
 10656*                   GO TO 0560-EDIT-CONTINUE
 10657                 END-IF
 10658              END-IF
 10659           END-IF
 10660        ELSE
 10661           IF AM-L-COM (SUB1) NUMERIC
 10662              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10663              IF (AM-COM-TYP (SUB1) = 'A')
 10664                 AND (WS-LF-PMF-COMM = ZEROS)
 10665                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10666              END-IF
 10667              CONTINUE
 10668           ELSE
 10669              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10670              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10671              MOVE PB-LIFE-OVERRIDE-L1
 10672                                 TO CTBL-BEN-TYPE
 10673              MOVE ZEROS         TO WS-SUB1
 10674                                    WS-COMMISSION
 10675              MOVE AM-L-COMA (SUB1)
 10676                                 TO CTBL-TABLE
 10677              PERFORM 8300-READ-CTBL-TABLE
 10678                                 THRU 8300-EXIT
 10679              IF CTBL-TABLE-FOUND
 10680                 CONTINUE
 10681              ELSE
 10682                 IF FIRST-TIME-THROUGH
 10683                    GO TO 0563-CHECK-LF
 10684                 ELSE
 10685                    MOVE ER-2609 TO WS-ERROR
 10686                    PERFORM 9900-ERROR-FORMAT
 10687                                 THRU 9900-EXIT
 10688                 END-IF
 10689              END-IF
 10690           END-IF
 10691        END-IF
 10692     END-IF
 10693     .
 10694 0563-EXIT.
 10695     EXIT.
 10696 0564-EDIT-CONTINUE.
 10697
 10698     IF  PB-COMPANY-ID EQUAL 'DMD'
 10699         IF PB-I-NUM-BILLED EQUAL ZEROS
 10700            MOVE ER-8148       TO WS-ERROR
 10701            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10702
 10703*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10704*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10705*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10706*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10707*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 195
* EL050.cbl
 10708*         IF NO-CONVERSION-ERROR
 10709*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10710*         ELSE
 10711*             IF PB-COMPANY-ID EQUAL 'HAN'
 10712*                 MOVE ZEROS     TO PB-I-AGE.
 10713     IF PB-I-BIRTHDAY > LOW-VALUES
 10714        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10715        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10716        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10717        PERFORM 8500-DATE-CONVERT
 10718                                 THRU 8500-EXIT
 10719        IF NO-CONVERSION-ERROR
 10720           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10721           IF PB-I-AGE > ZEROS
 10722              IF WS-WORK-AGE NOT = PB-I-AGE
 10723                 MOVE ER-9501    TO WS-ERROR
 10724                 PERFORM 9900-ERROR-FORMAT
 10725                                 THRU 9900-EXIT
 10726              END-IF
 10727           ELSE
 10728              MOVE WS-WORK-AGE   TO PB-I-AGE
 10729           END-IF
 10730        END-IF
 10731     END-IF
 10732     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10733                                   WS-INS-AGE-SET
 10734     IF PB-I-AGE = ZEROS
 10735        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10736           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10737                                   WS-INS-AGE-SET
 10738           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10739
 10740     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10741                                   WS-AH-EDIT-AGE.
 10742
 10743     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10744        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10745        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10746        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10747        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10748        IF NO-CONVERSION-ERROR
 10749           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10750           IF PB-I-JOINT-AGE > 0
 10751              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10752                 MOVE ER-9503    TO WS-ERROR
 10753                 PERFORM 9900-ERROR-FORMAT
 10754                                 THRU 9900-EXIT
 10755              END-IF
 10756           ELSE
 10757              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10758           END-IF
 10759        ELSE
 10760           MOVE ZEROS            TO PB-I-JOINT-AGE
 10761        END-IF
 10762     END-IF
 10763     IF PB-I-JOINT-AGE NOT NUMERIC
 10764        MOVE ZERO               TO PB-I-JOINT-AGE.
 10765
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 196
* EL050.cbl
 10766     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10767                                   WS-JNT-AGE-SET
 10768     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 10769        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10770           (WS-AH-JOINT-INDICATOR = 'J')
 10771           IF PB-I-JOINT-AGE = ZEROS
 10772               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10773                                          WS-JNT-AGE-SET
 10774               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10775           END-IF
 10776        END-IF
 10777     END-IF
 10778
 10779     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10780     IF WS-LF-JOINT-INDICATOR = 'J'
 10781        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10782        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10783            IF  PB-I-JOINT-AGE = ZERO
 10784                MOVE ER-2686       TO WS-ERROR
 10785                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10786            ELSE
 10787                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10788                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10789                    IF PB-COMPANY-ID NOT = 'LBL'
 10790                        MOVE ER-2685    TO WS-ERROR
 10791                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10792
 10793     IF WS-AH-JOINT-INDICATOR = 'J'
 10794        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10795            IF  PB-I-JOINT-AGE = ZERO
 10796                MOVE ER-2686       TO WS-ERROR
 10797                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10798            ELSE
 10799                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10800                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10801                                           WS-EDIT-AGE
 10802                    IF PB-COMPANY-ID NOT = 'LBL'
 10803                        MOVE ER-2685    TO WS-ERROR
 10804                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10805
 10806******************************************************************
 10807*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10808******************************************************************
 10809
 10810     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10811        (WS-AH-SPECIAL-CALC-CD = 'O')
 10812        NEXT SENTENCE
 10813     ELSE
 10814        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10815          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10816           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10817            WS-AH-JOINT-INDICATOR = 'J')  AND
 10818           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10819            MOVE ER-2627             TO WS-ERROR
 10820            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10821
 10822     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10823        (WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 197
* EL050.cbl
 10824         NEXT SENTENCE
 10825     ELSE
 10826         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10827            WS-AH-JOINT-INDICATOR = 'J'
 10828             IF PB-I-JOINT-INSURED = SPACES
 10829                 IF PB-COMPANY-ID NOT = 'JAL'
 10830                     MOVE ER-2696    TO WS-ERROR
 10831                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10832
 10833     IF PB-COMPANY-ID NOT = 'BOA'
 10834        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10835           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10836           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10837               PB-I-JOINT-INSURED NOT = SPACES)
 10838                MOVE ER-2691         TO WS-ERROR
 10839                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10840
 10841     IF PB-COMPANY-ID = 'BOA'
 10842        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10843           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10844            IF PB-I-JOINT-AGE NOT = ZEROS
 10845                MOVE ER-2691         TO WS-ERROR
 10846                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10847
 10848     IF PB-COMPANY-ID = 'CRI'
 10849        IF PB-I-SIG-SW = 'J'
 10850           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10851              WS-AH-JOINT-INDICATOR NOT = 'J'
 10852              MOVE ER-2675       TO WS-ERROR
 10853              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10854
 10855     IF PB-COMPANY-ID = 'CRI'
 10856        IF PB-I-SIG-SW = 'S'
 10857           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10858              WS-AH-JOINT-INDICATOR = 'J'
 10859              MOVE ER-2676       TO WS-ERROR
 10860              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10861
 10862     IF PB-COMPANY-ID = 'CVL'
 10863         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10864            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10865              MOVE ER-2783           TO WS-ERROR
 10866              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10867     IF (WS-LF-JOINT-INDICATOR = 'J')
 10868        AND (WS-AH-JOINT-INDICATOR = 'J')
 10869        AND (PB-I-LF-TERM > 120)
 10870        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10871        MOVE ER-2783             TO WS-ERROR
 10872        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10873     END-IF
 10874     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10875
 10876     IF PB-I-INDV-GRP-OVRD = 'I'
 10877        MOVE ER-2666             TO WS-ERROR
 10878        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10879        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10880
 10881     IF PB-I-INDV-GRP-OVRD = 'G'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 198
* EL050.cbl
 10882        MOVE ER-2666             TO WS-ERROR
 10883        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10884        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10885
 10886     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10887        NEXT SENTENCE
 10888     ELSE
 10889        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10890
 10891     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10892        IF WS-ERROR = ER-2666
 10893           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10894           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10895
 10896     IF PB-COMPANY-ID = 'CID'
 10897        IF PB-STATE = 'UT' OR 'MO'
 10898           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10899                 OR '76' OR '77')
 10900                      OR
 10901               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10902                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10903                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10904                   OR '2K' OR '2L'))
 10905              AND PB-I-INDV-GRP-CD = 'I'
 10906              MOVE ER-2721             TO WS-ERROR
 10907              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10908           END-IF
 10909        END-IF
 10910     END-IF
 10911
 10912     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10913     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10914        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10915     ELSE
 10916        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10917     END-IF
 10918
 10919*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10920*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10921     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10922                                    ACCOUNT-AH-CK-SW.
 10923
 10924     IF PB-REISSUED-CERT       OR
 10925        PB-REIN-ONLY-CERT      OR
 10926        PB-POLICY-IS-DECLINED  OR
 10927        PB-POLICY-IS-VOIDED
 10928*       OR PB-MONTHLY-CERT
 10929         GO TO 3000-CONTINUE-EDIT.
 10930
 10931     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10932        IF WS-EDIT-AGE           > +65
 10933           MOVE ER-2709          TO WS-ERROR
 10934           PERFORM 9900-ERROR-FORMAT
 10935                                 THRU 9900-EXIT
 10936        ELSE
 10937           IF WS-EDIT-AGE        > +55
 10938              MOVE ER-2718       TO WS-ERROR
 10939              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 199
* EL050.cbl
 10940                                 THRU 9900-EXIT
 10941           END-IF
 10942        END-IF
 10943     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 10944        IF WS-EDIT-AGE           > +65
 10945           MOVE ER-2709          TO WS-ERROR
 10946           PERFORM 9900-ERROR-FORMAT
 10947                                 THRU 9900-EXIT
 10948        END-IF
 10949     END-IF
 10950     .
 10951
 10952 0565-LIFE-PLAN-LIMIT-EDITS.
 10953
 10954     IF NOT LF-PLAN-MASTER-FOUND
 10955        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10956                                    EC-AM-LF-MAX-TOT-BEN
 10957        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10958
 10959     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10960
 10961     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10962         IF PL-LM-AGE (1) = ZEROS
 10963             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10964
 10965     IF NO-LF-BENEFIT-MATCH          OR
 10966        WS-LF-BENEFIT-CD = ZEROS     OR
 10967        WS-LF-SPECIAL-CALC-CD = 'M'
 10968        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10969
 10970     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10971     MOVE +1                     TO SUB2.
 10972
 10973     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10974        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10975           MOVE +5   TO SUB2
 10976           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10977              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10978              (PL-LM-AGE (SUB2) EQUAL +0)
 10979              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10980              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10981
 10982     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10983
 10984     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10985                               + PB-I-LF-ALT-BENEFIT-AMT.
 10986
 10987 0568-CHECK-LIFE-ATT-AGE.
 10988
 10989     IF PL-ATT-AGE NUMERIC AND
 10990        PL-ATT-AGE > +0
 10991        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10992     END-IF
 10993*    IF PL-ATT-AGE NUMERIC AND
 10994*       PL-ATT-AGE > +0
 10995*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10996*       IF PB-I-BIRTHDAY > LOW-VALUES
 10997*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 200
* EL050.cbl
 10998*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10999*          MOVE ZERO             TO DC-ELAPSED-DAYS
 11000*          SET BIN-PLUS-ELAPSED  TO TRUE
 11001*          PERFORM 8500-DATE-CONVERT
 11002*                                THRU 8500-EXIT
 11003*          IF NO-CONVERSION-ERROR
 11004*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 11005*             MOVE ER-2669       TO WS-ERROR
 11006*             PERFORM 9900-ERROR-FORMAT
 11007*                                THRU 9900-EXIT
 11008*          END-IF
 11009*       ELSE
 11010*          IF WS-ATT-AGE >= PL-ATT-AGE
 11011*             MOVE ER-2669       TO WS-ERROR
 11012*             PERFORM 9900-ERROR-FORMAT
 11013*                                THRU 9900-EXIT
 11014*          END-IF
 11015*       END-IF
 11016*    END-IF
 11017     .
 11018 0570-CHECK-LIFE-LIMITS.
 11019
 11020     IF PB-COMPANY-ID EQUAL 'CRI'
 11021        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11022           IF SUB2 GREATER THAN +4
 11023              MOVE ER-2637 TO WS-ERROR
 11024              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11025              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11026
 11027     IF PB-COMPANY-ID  =  'NCL'
 11028        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11029            SUB2 GREATER THAN +8
 11030             MOVE 'U'         TO PB-BATCH-ENTRY
 11031             MOVE ER-2637     TO WS-ERROR
 11032             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11033             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11034
 11035     IF SUB2 > +8
 11036        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11037           AND (PB-I-SIG-SW = 'Y')
 11038           CONTINUE
 11039        ELSE
 11040           MOVE ER-2637          TO WS-ERROR
 11041           PERFORM 9900-ERROR-FORMAT
 11042                                 THRU 9900-EXIT
 11043        END-IF
 11044        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11045     END-IF
 11046     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11047     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11048     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11049
 11050     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11051        ADD +1  TO SUB2
 11052        GO TO 0570-CHECK-LIFE-LIMITS.
 11053
 11054     IF PB-COMPANY-ID = 'NCL'
 11055         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 201
* EL050.cbl
 11056
 11057     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11058        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11059        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11060           AND (PB-I-SIG-SW = 'Y')
 11061           CONTINUE
 11062        ELSE
 11063           MOVE ER-2637          TO WS-ERROR
 11064           PERFORM 9900-ERROR-FORMAT
 11065                                 THRU 9900-EXIT
 11066        END-IF
 11067     END-IF
 11068     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11069
 11070
 11071 0570-CHECK-NCL-LIFE-LIMITS.
 11072
 11073     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11074        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11075         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11076
 11077     IF APP-CERT-USED
 11078         IF SUB2  LESS THAN  +5
 11079             MOVE +5          TO SUB2
 11080             GO TO 0570-CHECK-LIFE-LIMITS.
 11081
 11082     MOVE ER-2637             TO WS-ERROR.
 11083     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11084
 11085     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11086
 11087 0575-CHECK-NCL-SIG-SWITCH.
 11088
 11089     IF NOT APP-CERT-USED
 11090         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11091
 11092     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11093        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11094        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11095        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11096         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11097
 11098     IF SUB2 GREATER THAN +4
 11099         IF PL-LM-AGE (5) = ZEROS  AND
 11100            PL-LM-AGE (6) = ZEROS  AND
 11101            PL-LM-AGE (7) = ZEROS  AND
 11102            PL-LM-AGE (8) = ZEROS
 11103             MOVE  ER-1927        TO WS-ERROR
 11104             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11105             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11106         ELSE
 11107             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11108                 MOVE  ER-1920    TO WS-ERROR
 11109                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11110
 11111     IF PB-I-SIG-SW  = 'Y'
 11112       IF NOT PB-I-POLICY-ACCEPTED  AND
 11113          NOT PB-I-POLICY-DECLINED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 202
* EL050.cbl
 11114           MOVE 'U'               TO PB-BATCH-ENTRY
 11115           MOVE  ER-1926          TO WS-ERROR
 11116           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11117
 11118
 11119 0580-AH-PLAN-LIMIT-EDITS.
 11120
 11121     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11122        IF PB-I-AH-BENEFIT-AMT > +1250
 11123           MOVE ER-2702          TO WS-ERROR
 11124           PERFORM 9900-ERROR-FORMAT
 11125                                 THRU 9900-EXIT
 11126        END-IF
 11127     END-IF
 11128
 11129     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 11130        AND (PB-MONTHLY-CERT)
 11131        IF PB-I-AH-BENEFIT-AMT > +3000
 11132           MOVE ER-2881          TO WS-ERROR
 11133           PERFORM 9900-ERROR-FORMAT
 11134                                 THRU 9900-EXIT
 11135        END-IF
 11136     END-IF
 11137     IF NOT AH-PLAN-MASTER-FOUND
 11138        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11139        GO TO 3000-CONTINUE-EDIT.
 11140
 11141     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11142
 11143     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11144         IF PL-LM-AGE (1) = ZEROS
 11145             GO TO 3000-CONTINUE-EDIT.
 11146
 11147     IF NO-AH-BENEFIT-MATCH          OR
 11148        WS-AH-BENEFIT-CD = ZEROS     OR
 11149        WS-AH-SPECIAL-CALC-CD = 'M'
 11150        GO TO 3000-CONTINUE-EDIT.
 11151
 11152     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11153     MOVE +1                     TO SUB2.
 11154
 11155     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11156        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11157           MOVE +5 TO SUB2
 11158           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11159              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11160              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11161              (PL-LM-AGE (SUB2) EQUAL +0)
 11162              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11163              GO TO 3000-CONTINUE-EDIT.
 11164
 11165     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11166
 11167 0590-CHECK-AH-ATT-AGE.
 11168
 11169     IF PL-ATT-AGE NUMERIC AND
 11170        PL-ATT-AGE GREATER THAN +0
 11171        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 203
* EL050.cbl
 11172     END-IF
 11173*       IF WS-ATT-AGE >= PL-ATT-AGE
 11174*          MOVE ER-3054          TO WS-ERROR
 11175*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11176     .
 11177 0597-CHECK-AH-LIMITS.
 11178
 11179     IF PB-COMPANY-ID EQUAL 'CRI'
 11180        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11181           IF SUB2 GREATER THAN +4
 11182              MOVE ER-2638       TO WS-ERROR
 11183              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11184              GO TO 3000-CONTINUE-EDIT.
 11185
 11186     IF PB-COMPANY-ID  =  'NCL'
 11187        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11188            SUB2 GREATER THAN +8
 11189             MOVE 'U'            TO PB-BATCH-ENTRY
 11190             MOVE ER-2638        TO WS-ERROR
 11191             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11192             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11193
 11194     IF SUB2 > +8
 11195        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11196           AND (PB-I-SIG-SW = 'Y')
 11197           CONTINUE
 11198        ELSE
 11199           MOVE ER-2638          TO WS-ERROR
 11200           PERFORM 9900-ERROR-FORMAT
 11201                                 THRU 9900-EXIT
 11202        END-IF
 11203        GO TO 3000-CONTINUE-EDIT
 11204     END-IF
 11205
 11206     IF PB-COMPANY-ID = 'CRI'
 11207        IF WS-ERROR = ER-2638
 11208           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11209
 11210     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11211     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11212     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11213     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11214
 11215     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11216        ADD +1                   TO SUB2
 11217        GO TO 0597-CHECK-AH-LIMITS.
 11218
 11219     IF PB-COMPANY-ID = 'NCL'
 11220         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11221
 11222     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11223        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11224        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11225                                 > PL-LM-AMT (SUB2))
 11226        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP')
 11227           AND (PB-I-SIG-SW = 'Y')
 11228           CONTINUE
 11229        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 204
* EL050.cbl
 11230           MOVE ER-2638          TO WS-ERROR
 11231           PERFORM 9900-ERROR-FORMAT
 11232                                 THRU 9900-EXIT
 11233        END-IF
 11234     END-IF
 11235
 11236     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11237         IF  WS-ERROR    EQUAL    ER-2638
 11238             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11239                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11240                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11241                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11242                MOVE  ER-1910    TO  WS-ERROR
 11243                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11244
 11245     IF PB-COMPANY-ID = 'CRI'
 11246        IF WS-ERROR = ER-2638
 11247            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11248            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11249            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11250
 11251     GO TO 3000-CONTINUE-EDIT.
 11252
 11253 0597-CHECK-NCL-AH-LIMITS.
 11254
 11255     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11256        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11257        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11258                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11259         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11260
 11261     IF APP-CERT-USED
 11262         IF SUB2  LESS THAN  +5
 11263             MOVE +5             TO SUB2
 11264             GO TO 0597-CHECK-AH-LIMITS.
 11265
 11266     MOVE ER-2638                TO WS-ERROR.
 11267     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11268
 11269     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11270
 11271 0599-CHECK-NCL-SIG-SWITCH.
 11272
 11273     IF NOT APP-CERT-USED
 11274         GO TO 3000-CONTINUE-EDIT.
 11275
 11276     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11277        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11278        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11279        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11280         GO TO 3000-CONTINUE-EDIT.
 11281
 11282     IF SUB2 GREATER THAN +4
 11283         IF PL-LM-AGE (5) = ZEROS  AND
 11284            PL-LM-AGE (6) = ZEROS  AND
 11285            PL-LM-AGE (7) = ZEROS  AND
 11286            PL-LM-AGE (8) = ZEROS
 11287             MOVE  ER-1927        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 205
* EL050.cbl
 11288             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11289             GO TO 3000-CONTINUE-EDIT
 11290         ELSE
 11291             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11292                 MOVE  ER-1920    TO WS-ERROR
 11293                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11294
 11295     IF PB-I-SIG-SW  = 'Y'
 11296       IF NOT PB-I-POLICY-ACCEPTED  AND
 11297          NOT PB-I-POLICY-DECLINED
 11298           MOVE 'U'               TO PB-BATCH-ENTRY
 11299           MOVE  ER-1926          TO WS-ERROR
 11300           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11301
 11302******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 206
* EL050.cbl
 11304
 11305 3000-CONTINUE-EDIT.
 11306
 11307     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11308     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11309     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11310     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11311     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11312
 11313     IF BROWSE-STARTED
 11314        PERFORM 9990-RETURN THRU 9990-EXIT
 11315        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11316
 11317     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11318        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11319        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11320        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11321*       MOVE 1                   TO DC-OPTION-CODE
 11322        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11323        IF DATE-CONVERSION-ERROR
 11324           MOVE ER-2622          TO WS-ERROR
 11325           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11326        ELSE
 11327           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11328              MOVE ER-2623       TO WS-ERROR
 11329              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11330           ELSE
 11331              MOVE ER-2622       TO WS-ERROR
 11332              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11333
 11334     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11335     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11336     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11337*    MOVE 1                      TO DC-OPTION-CODE.
 11338     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11339     IF DATE-CONVERSION-ERROR
 11340        GO TO 3005-EDIT-CONTINUE
 11341     ELSE
 11342        IF DC-ELAPSED-DAYS GREATER +180
 11343           MOVE ER-2613          TO WS-ERROR
 11344           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11345        ELSE
 11346           IF DC-ELAPSED-DAYS GREATER +90
 11347              MOVE ER-2612       TO WS-ERROR
 11348              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11349           ELSE
 11350             IF DC-ELAPSED-DAYS GREATER +60
 11351                MOVE ER-2614     TO WS-ERROR
 11352                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11353
 11354 3005-EDIT-CONTINUE.
 11355
 11356     IF PB-CANCELLATION
 11357         GO TO 3700-EDIT-CANCEL.
 11358
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 207
* EL050.cbl
 11360******************************************************************
 11361*                  E D I T   I S S U E                           *
 11362******************************************************************
 11363
 11364 3020-EDIT-ISSUE.
 11365
 11366      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11367      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11368      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11369      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11370      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11371
 11372     IF PB-ISSUE-FORCE
 11373        OR PB-ISSUE-DATE-FORCED
 11374        OR PB-FORCE-OFF
 11375        OR PB-OVERCHARGE-FORCE
 11376        CONTINUE
 11377     ELSE
 11378        MOVE ER-2670             TO WS-ERROR
 11379        PERFORM 9900-ERROR-FORMAT
 11380                                 THRU 9900-EXIT
 11381     END-IF
 11382     .
 11383 3022-SET-POLICY-STATUS.
 11384
 11385     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11386
 11387     IF (PB-REISSUED-CERT)
 11388             OR
 11389        ((PB-COMPANY-ID NOT = 'DCC' and 'VPP')
 11390         AND (PB-MONTHLY-CERT))
 11391         MOVE '5'                TO PB-I-ENTRY-STATUS
 11392         MOVE 'E'                TO PB-BATCH-ENTRY
 11393     END-IF
 11394
 11395     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 11396        IF PB-MONTHLY-CERT
 11397           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11398        END-IF
 11399        IF PB-CASH-CERT
 11400           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11401        END-IF
 11402     END-IF
 11403     IF PB-POLICY-IS-DECLINED
 11404         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11405     IF PB-POLICY-IS-VOIDED
 11406         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11407     IF PB-NEEDS-UNDERWRITING
 11408         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11409     IF PB-REIN-ONLY-CERT
 11410         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11411     IF PB-PREM-ACCTNG-ONLY
 11412         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11413
 11414     MOVE SPACE                  TO PB-I-OB-FLAG.
 11415
 11416     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11417         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 208
* EL050.cbl
 11418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11419         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11420
 11421     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11422        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11423           MOVE 'Z'             TO PB-I-OB-FLAG.
 11424
 11425     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11426        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11427           MOVE 'Z'             TO PB-I-OB-FLAG.
 11428
 11429     IF ACCOUNT-MAST-FOUND
 11430         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11431         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11432         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11433         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11434         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11435         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11436         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11437     END-IF
 11438
 11439     IF ACCOUNT-MAST-FOUND
 11440        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11441         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11442
 11443     IF (ACCOUNT-MAST-FOUND)
 11444        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11445        IF PB-REISSUED-CERT
 11446           CONTINUE
 11447        ELSE
 11448           MOVE ER-2608          TO WS-ERROR
 11449           PERFORM 9900-ERROR-FORMAT
 11450                                 THRU 9900-EXIT
 11451         END-IF
 11452     END-IF
 11453
 11454     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11455        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11456        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11457
 11458**********   DMD CUSTOM CODE FOLLOWS  **********
 11459 3024-EDIT-DMD-FIELDS.
 11460     IF PB-COMPANY-ID NOT = 'DMD'
 11461        GO TO 3025-EDIT-REINSURANCE.
 11462
 11463*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11464*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11465*** ERROR IF THEY ARE NOT EQUAL.
 11466
 11467     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11468     SET BIN-TO-GREG               TO TRUE.
 11469     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11470     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11471**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11472
 11473     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11474     SET BIN-TO-GREG               TO TRUE.
 11475     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 209
* EL050.cbl
 11476     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11477**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11478
 11479     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11480        MOVE ER-8116               TO WS-ERROR
 11481        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11482
 11483     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11484
 11485     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11486                                      WK-FULL-CERT-NO.
 11487     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11488
 11489     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11490
 11491     IF PB-VALID-LIFE
 11492        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11493     ELSE
 11494        IF PB-VALID-AH
 11495          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11496
 11497
 11498     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11499     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11500     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11501                                      DCUA-UNDRWRTR-CODE
 11502                                      DCUA-UNDRWRTR-GROUP-CODE
 11503                                      DCUA-RETURN-CODE.
 11504
 11505****************************************************************
 11506*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11507***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11508***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11509***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11510***   TO THIS RECORD.                                        ***
 11511****************************************************************
 11512     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11513     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11514     IF DCUA-SUCCESSFUL-PROCESS
 11515        GO TO 3024-EDIT-DL7-CONT.
 11516
 11517     IF DCUA-RETURN-CODE EQUAL '01'
 11518        MOVE ER-8110               TO WS-ERROR
 11519        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11521        GO TO 3024-EDIT-DL7-CONT.
 11522
 11523     IF DCUA-RETURN-CODE EQUAL '02'
 11524        MOVE ER-8111               TO WS-ERROR
 11525        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11527        GO TO 3024-EDIT-DL7-CONT.
 11528
 11529     IF DCUA-RETURN-CODE EQUAL '03'
 11530        MOVE ER-8074               TO WS-ERROR
 11531        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11532        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11533        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 210
* EL050.cbl
 11534
 11535     IF DCUA-RETURN-CODE EQUAL '04'
 11536        MOVE ER-8075               TO WS-ERROR
 11537        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11539        GO TO 3024-EDIT-DL7-CONT.
 11540
 11541     IF DCUA-RETURN-CODE EQUAL '05'
 11542        MOVE ER-8076               TO WS-ERROR
 11543        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11545        GO TO 3024-EDIT-DL7-CONT.
 11546
 11547     IF DCUA-RETURN-CODE EQUAL '06'
 11548        MOVE ER-8077               TO WS-ERROR
 11549        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11551        GO TO 3024-EDIT-DL7-CONT.
 11552
 11553     IF DCUA-RETURN-CODE EQUAL '07'
 11554        MOVE ER-8078               TO WS-ERROR
 11555        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11557        GO TO 3024-EDIT-DL7-CONT.
 11558
 11559     IF DCUA-RETURN-CODE EQUAL 'E1'
 11560        MOVE ER-8079               TO WS-ERROR
 11561        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11563        GO TO 3024-EDIT-DL7-CONT.
 11564
 11565     IF DCUA-RETURN-CODE EQUAL 'E2'
 11566        MOVE ER-8080               TO WS-ERROR
 11567        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11568        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11569        GO TO 3024-EDIT-DL7-CONT.
 11570
 11571     IF DCUA-RETURN-CODE EQUAL 'E3'
 11572        MOVE ER-8098               TO WS-ERROR
 11573        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11574        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11575        GO TO 3024-EDIT-DL7-CONT.
 11576
 11577     IF DCUA-RETURN-CODE EQUAL 'C1'
 11578        MOVE ER-8099               TO WS-ERROR
 11579        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11581        GO TO 3024-EDIT-DL7-CONT.
 11582
 11583     IF DCUA-RETURN-CODE EQUAL 'U1'
 11584        MOVE ER-8109               TO WS-ERROR
 11585        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587        GO TO 3024-EDIT-DL7-CONT.
 11588
 11589     IF DCUA-RETURN-CODE EQUAL 'N1'
 11590        MOVE ER-8112               TO WS-ERROR
 11591        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 211
* EL050.cbl
 11592        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11593        GO TO 3024-EDIT-DL7-CONT.
 11594
 11595     IF DCUA-RETURN-CODE EQUAL 'N2'
 11596        MOVE ER-8113               TO WS-ERROR
 11597        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11599        GO TO 3024-EDIT-DL7-CONT.
 11600
 11601     IF DCUA-RETURN-CODE EQUAL 'N3'
 11602        MOVE ER-8114               TO WS-ERROR
 11603        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11605        GO TO 3024-EDIT-DL7-CONT.
 11606
 11607     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11608     MOVE ER-8097                  TO WS-ERROR.
 11609     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11610     GO TO 3024-EDIT-DL7-CONT.
 11611
 11612 3024-EDIT-DL7-CONT.
 11613
 11614     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11615     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11616     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11617        NEXT SENTENCE
 11618     ELSE
 11619        MOVE ER-9263               TO WS-ERROR
 11620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11621
 11622******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11623******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11624     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11625        NEXT SENTENCE
 11626     ELSE
 11627        MOVE ER-8039               TO WS-ERROR
 11628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11629
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 212
* EL050.cbl
 11631****************************************************************
 11632*** VALIDATE STATE  : DLO022                                 ***
 11633****************************************************************
 11634     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11635     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11636
 11637     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11638     IF DVSC-SUCCESSFUL-EDIT
 11639        GO TO 3024-EDIT-DL22-CONT.
 11640
 11641     IF DVSC-RETURN-CODE EQUAL '01'
 11642        MOVE ER-8300               TO WS-ERROR
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644        GO TO 3024-EDIT-DL22-CONT.
 11645
 11646     IF DVSC-RETURN-CODE EQUAL '02'
 11647        MOVE ER-8301               TO WS-ERROR
 11648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11649        GO TO 3024-EDIT-DL22-CONT.
 11650
 11651     IF DVSC-RETURN-CODE EQUAL '03'
 11652        MOVE ER-8302               TO WS-ERROR
 11653        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11654        GO TO 3024-EDIT-DL22-CONT.
 11655
 11656     IF DVSC-RETURN-CODE EQUAL 'N1'
 11657        MOVE ER-8304               TO WS-ERROR
 11658        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11659        GO TO 3024-EDIT-DL22-CONT.
 11660
 11661     MOVE ER-8303                  TO WS-ERROR
 11662     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11663
 11664 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 213
* EL050.cbl
 11666****************************************************************
 11667*** VALIDATE LOAN OFFICER : DLO021                           ***
 11668****************************************************************
 11669
 11670     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11671     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11672     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11673     IF DVLO-SUCCESSFUL-EDIT
 11674        GO TO 3024-EDIT-DL21-CONT.
 11675
 11676     IF DVLO-RETURN-CODE EQUAL '01'
 11677        MOVE ER-8081               TO WS-ERROR
 11678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11679        GO TO 3024-EDIT-DL21-CONT.
 11680
 11681     IF DVLO-RETURN-CODE EQUAL '02'
 11682        MOVE ER-8082               TO WS-ERROR
 11683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11684        GO TO 3024-EDIT-DL21-CONT.
 11685
 11686     IF DVLO-RETURN-CODE EQUAL '03'
 11687        MOVE ER-8083               TO WS-ERROR
 11688        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689        GO TO 3024-EDIT-DL21-CONT.
 11690
 11691     IF DVLO-RETURN-CODE EQUAL '04'
 11692        MOVE ER-8084               TO WS-ERROR
 11693        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11694        GO TO 3024-EDIT-DL21-CONT.
 11695
 11696     IF DVLO-RETURN-CODE EQUAL '05'
 11697        MOVE ER-8085               TO WS-ERROR
 11698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699        GO TO 3024-EDIT-DL21-CONT.
 11700
 11701     MOVE ER-7825                  TO WS-ERROR
 11702     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11703     GO TO 3024-EDIT-DL21-CONT.
 11704
 11705 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 214
* EL050.cbl
 11707
 11708****************************************************************
 11709*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11710****************************************************************
 11711
 11712     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11713     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11714     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11715     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11716     IF DIPF-SUCCESSFUL-EDIT
 11717        GO TO 3024-EDIT-DL02-CONT.
 11718
 11719     IF DIPF-RETURN-CODE EQUAL '01'
 11720        MOVE ER-8086               TO WS-ERROR
 11721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11722        GO TO 3024-EDIT-DL02-CONT.
 11723
 11724     IF DIPF-RETURN-CODE EQUAL '02'
 11725        MOVE ER-8087               TO WS-ERROR
 11726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11727        GO TO 3024-EDIT-DL02-CONT.
 11728
 11729     IF DIPF-RETURN-CODE EQUAL '03'
 11730        MOVE ER-8088               TO WS-ERROR
 11731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11732        GO TO 3024-EDIT-DL02-CONT.
 11733
 11734     MOVE ER-8095                  TO WS-ERROR
 11735     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11736     GO TO 3024-EDIT-DL02-CONT.
 11737
 11738 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 215
* EL050.cbl
 11740
 11741****************************************************************
 11742*** VALIDATE BANK ID : DLO003                                ***
 11743****************************************************************
 11744
 11745     MOVE WK-GREG-CENT           TO WCG-CENT.
 11746     MOVE WK-GREG-YYMM           TO WCG-REST.
 11747     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11748        MOVE ER-8040               TO WS-ERROR
 11749        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11750
 11751     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11752     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11753     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11754     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11755     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11756     IF DVBI-SUCCESSFUL-EDIT
 11757        GO TO 3024-EDIT-DL03-CONT.
 11758
 11759     IF DVBI-RETURN-CODE EQUAL '01'
 11760        MOVE ER-8089               TO WS-ERROR
 11761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11762        GO TO 3024-EDIT-DL03-CONT.
 11763
 11764     IF DVBI-RETURN-CODE EQUAL '02'
 11765        MOVE ER-8090               TO WS-ERROR
 11766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11767        GO TO 3024-EDIT-DL03-CONT.
 11768
 11769     IF DVBI-RETURN-CODE EQUAL '03'
 11770        MOVE ER-8091               TO WS-ERROR
 11771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11772        GO TO 3024-EDIT-DL03-CONT.
 11773
 11774     IF DVBI-RETURN-CODE EQUAL '04'
 11775        MOVE ER-8092               TO WS-ERROR
 11776        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777        GO TO 3024-EDIT-DL03-CONT.
 11778
 11779     IF DVBI-RETURN-CODE EQUAL '05'
 11780        MOVE ER-8093               TO WS-ERROR
 11781        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11782        GO TO 3024-EDIT-DL03-CONT.
 11783
 11784     IF DVBI-RETURN-CODE EQUAL '06'
 11785        MOVE ER-8094               TO WS-ERROR
 11786        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11787        GO TO 3024-EDIT-DL03-CONT.
 11788
 11789     MOVE ER-8096                  TO WS-ERROR
 11790     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11791     GO TO 3024-EDIT-DL03-CONT.
 11792
 11793 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 216
* EL050.cbl
 11795
 11796     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11797        NEXT SENTENCE
 11798     ELSE
 11799        MOVE ER-8042               TO WS-ERROR
 11800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11801
 11802     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11803     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11804     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11805
 11806     IF DMPF-RETURN-CODE = '01'
 11807        MOVE ER-8067               TO WS-ERROR
 11808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11809        GO TO 3024-EDIT-DL01-CONT.
 11810
 11811     IF DMPF-RETURN-CODE = '02'
 11812        MOVE ER-8068               TO WS-ERROR
 11813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11814        GO TO 3024-EDIT-DL01-CONT.
 11815
 11816     IF DMPF-RETURN-CODE = '03'
 11817        MOVE ER-8069               TO WS-ERROR
 11818        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11819        GO TO 3024-EDIT-DL01-CONT.
 11820
 11821     IF DMPF-RETURN-CODE = 'E1'
 11822        MOVE ER-8070               TO WS-ERROR
 11823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11824        GO TO 3024-EDIT-DL01-CONT.
 11825
 11826     IF DMPF-RETURN-CODE = 'N1'
 11827        MOVE ER-8071               TO WS-ERROR
 11828        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11829        GO TO 3024-EDIT-DL01-CONT.
 11830
 11831     IF DMPF-RETURN-CODE NOT = 'OK'
 11832        MOVE ER-8072               TO WS-ERROR
 11833        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11834
 11835 3024-EDIT-DL01-CONT.
 11836******************************************************************
 11837***  VALIDATES RATE CODES : DLO017                             ***
 11838******************************************************************
 11839
 11840      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11841      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11842      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11843      IF DVRC-SUCCESSFUL-EDIT
 11844        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11845        GO TO 3024-CHECK-VALID-RATE.
 11846
 11847      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11848
 11849      IF DVRC-RETURN-CODE EQUAL '01'
 11850         MOVE ER-7817                   TO WS-ERROR
 11851         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11852         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 217
* EL050.cbl
 11853
 11854      IF DVRC-RETURN-CODE EQUAL '02'
 11855         MOVE ER-7818                   TO WS-ERROR
 11856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11857         GO TO 3025-EDIT-REINSURANCE.
 11858
 11859      IF DVRC-RETURN-CODE EQUAL '03'
 11860         MOVE ER-7819                   TO WS-ERROR
 11861         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11862         GO TO 3025-EDIT-REINSURANCE.
 11863
 11864       MOVE ER-7820                     TO WS-ERROR.
 11865       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11866       GO TO 3025-EDIT-REINSURANCE.
 11867
 11868******************************************************************
 11869***  GET PREMIUM RATES : DLO011                                ***
 11870******************************************************************
 11871
 11872 3024-CHECK-VALID-RATE.
 11873
 11874     IF VALID-RATE-CODE
 11875        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11876        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11877        MOVE SPACES                TO DPRB-RETURN-CODE
 11878        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11879     ELSE
 11880         GO TO 3025-EDIT-REINSURANCE.
 11881
 11882      IF DPRB-SUCCESSFUL-PROCESS
 11883         IF PB-VALID-LIFE
 11884             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11885             GO TO 3025-EDIT-REINSURANCE
 11886         ELSE
 11887             IF PB-VALID-AH
 11888                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11889                 GO TO 3025-EDIT-REINSURANCE.
 11890
 11891      IF DPRB-RETURN-CODE EQUAL '01'
 11892         MOVE ER-7812                   TO WS-ERROR
 11893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11894         GO TO 3025-EDIT-REINSURANCE.
 11895
 11896      IF DPRB-RETURN-CODE EQUAL '02'
 11897         MOVE ER-7813                   TO WS-ERROR
 11898         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11899         GO TO 3025-EDIT-REINSURANCE.
 11900
 11901      IF DPRB-RETURN-CODE EQUAL '03'
 11902         MOVE ER-7814                   TO WS-ERROR
 11903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11904         GO TO 3025-EDIT-REINSURANCE.
 11905
 11906      IF DPRB-RETURN-CODE EQUAL '04'
 11907         IF NOT DPRB-1ST-TIME
 11908            MOVE ER-7815                   TO WS-ERROR
 11909            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11910            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 218
* EL050.cbl
 11911          ELSE
 11912         IF PB-VALID-LIFE
 11913            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11914          ELSE
 11915            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11916         END-IF
 11917         MOVE SPACES                TO DOCC-RETURN-CODE
 11918         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11919         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11920         IF DOCC-RETURN-CODE = 'OK'
 11921             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11922             GO TO 3024-CHECK-VALID-RATE
 11923           ELSE
 11924             MOVE ER-7823               TO WS-ERROR
 11925             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11926             GO TO 3025-EDIT-REINSURANCE.
 11927
 11928       MOVE ER-7816                     TO WS-ERROR.
 11929       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11930       GO TO 3025-EDIT-REINSURANCE.
 11931
 11932**********   DMD CUSTOM CODE ABOVE    **********
 11933
 11934 3025-EDIT-REINSURANCE.
 11935     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11936         GO TO 3027-EDIT-CONTINUE.
 11937
 11938     MOVE LOW-VALUES               TO ERREIN-KEY.
 11939     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11940     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11941                                      REIN-CODE-2
 11942                                      REIN-CODE-3.
 11943     MOVE 'A'                      TO REIN-TYPE.
 11944
 11945     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11946
 11947     MOVE '3026' TO REIN-SW.
 11948     MOVE ' '                   TO WS-REIN-READ-SW.
 11949
 11950     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11951     IF REIN-TABLE-NOT-FOUND
 11952         GO TO 3026-NO-SPEC-TABLE.
 11953
 11954     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11955     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11956                                   WS-NSP-ST-CD-LF.
 11957     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11958                                   WS-NSP-ST-CD-AH.
 11959
 11960     GO TO 3040-EDIT-CONTINUE.
 11961
 11962 3026-NO-SPEC-TABLE.
 11963
 11964     MOVE ER-2664                TO WS-ERROR.
 11965     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11966     GO TO 3040-EDIT-CONTINUE.
 11967
 11968 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 219
* EL050.cbl
 11969
 11970     IF PB-I-REIN-TABLE = SPACES
 11971       GO TO 3040-EDIT-CONTINUE.
 11972
 11973     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11974          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11975          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11976           GO TO 3040-EDIT-CONTINUE.
 11977
 11978     MOVE LOW-VALUES            TO ERREIN-KEY.
 11979     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11980     MOVE 'A'                   TO REIN-TYPE.
 11981     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11982
 11983     MOVE '3028'                TO REIN-SW.
 11984     MOVE ' '                   TO WS-REIN-READ-SW.
 11985
 11986     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11987     IF REIN-TABLE-NOT-FOUND
 11988         GO TO 3028-NO-REIN-TABLE.
 11989
 11990     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11991     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11992                                   WS-NSP-ST-CD-LF.
 11993     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11994                                   WS-NSP-ST-CD-AH.
 11995
 11996     GO TO 3040-EDIT-CONTINUE.
 11997
 11998 3028-NO-REIN-TABLE.
 11999
 12000     MOVE ER-2615                TO WS-ERROR.
 12001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12002     GO TO 3040-EDIT-CONTINUE.
 12003
 12004 3040-EDIT-CONTINUE.
 12005
 12006     IF PB-I-LF-PREM-CALC NOT NUMERIC
 12007         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 12008
 12009     IF PB-I-AH-PREM-CALC NOT NUMERIC
 12010         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 12011
 12012     IF (NOT PB-REISSUED-CERT)
 12013        AND (NOT PB-MONTHLY-CERT)
 12014        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12015            MOVE '001'           TO PB-I-LF-TERM
 12016            MOVE 'M'             TO PB-I-INSURED-SEX.
 12017
 12018     IF (NOT PB-REISSUED-CERT)
 12019        AND (NOT PB-MONTHLY-CERT)
 12020        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12021            MOVE '001'           TO PB-I-AH-TERM
 12022            MOVE 'M'             TO PB-I-INSURED-SEX.
 12023
 12024 3040-EDIT-1ST-PMT-DT.
 12025     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12026     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 220
* EL050.cbl
 12027         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12028
 12029******************************************************************
 12030*                                                                *
 12031*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12032*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12033*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12034*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12035*                                                                *
 12036******************************************************************
 12037
 12038     IF PB-EFF-DT-PROCESSING
 12039        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12040                                    PB-I-LF-EXPIRE-DT
 12041                                    PB-I-AH-EXPIRE-DT
 12042        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12043        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12044        MOVE ZERO                TO DC-ELAPSED-DAYS
 12045        MOVE +1                  TO DC-ELAPSED-MONTHS
 12046        SET BIN-PLUS-ELAPSED     TO TRUE
 12047*       MOVE 6                   TO DC-OPTION-CODE
 12048        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12049        IF NO-CONVERSION-ERROR
 12050           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12051
 12052******************************************************************
 12053*                                                                *
 12054*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12055*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12056*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12057*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12058*                                                                *
 12059******************************************************************
 12060
 12061     IF PB-EXT-DAYS-PROCESSING
 12062          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12063                                         PB-I-LF-EXPIRE-DT
 12064                                         PB-I-AH-EXPIRE-DT
 12065          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12066          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12067          MOVE +1                     TO DC-ELAPSED-MONTHS
 12068          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12069          SET BIN-PLUS-ELAPSED        TO TRUE
 12070*         MOVE 6                      TO DC-OPTION-CODE
 12071          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12072          IF NO-CONVERSION-ERROR
 12073             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12074
 12075******************************************************************
 12076*                                                                *
 12077*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12078*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12079*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12080*        (EXPIRE DATE - (TERM -1))  *  -1.
 12081*                                                                *
 12082******************************************************************
 12083
 12084     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 221
* EL050.cbl
 12085        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12086           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12087              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12088              MOVE PB-I-AH-TERM      TO WS-TERM
 12089           ELSE
 12090              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12091              MOVE PB-I-LF-TERM      TO WS-TERM
 12092        ELSE
 12093           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12094              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12095              MOVE PB-I-LF-TERM      TO WS-TERM
 12096           ELSE
 12097              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12098              MOVE PB-I-AH-TERM      TO WS-TERM.
 12099
 12100     IF PB-EXPIRE-DT-PROCESSING
 12101        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12102        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12103        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12104        MOVE ZERO                TO DC-ELAPSED-DAYS
 12105                                    DC-ODD-DAYS-OVER
 12106          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12107          SET BIN-PLUS-ELAPSED    TO TRUE
 12108*         MOVE 6                  TO DC-OPTION-CODE
 12109          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12110          IF NO-CONVERSION-ERROR
 12111             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12112
 12113******************************************************************
 12114*                                                                *
 12115*            1ST PAYMENT DATE PROCESSING                         *
 12116*                                                                *
 12117******************************************************************
 12118
 12119     IF PB-1ST-PMT-DT-PROCESSING
 12120        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12121                                    PB-I-AH-EXPIRE-DT
 12122        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12123
 12124     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12125         NEXT SENTENCE
 12126     ELSE
 12127         MOVE ER-2680                 TO WS-ERROR
 12128         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12129         GO TO 3060-ORIG-TERM-CHECK.
 12130
 12131     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12132     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12133     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12134*    MOVE 1                      TO DC-OPTION-CODE.
 12135     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12136                                    DC-ELAPSED-DAYS
 12137                                    DC-ODD-DAYS-OVER.
 12138
 12139     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12140
 12141     IF DATE-CONVERSION-ERROR
 12142        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 222
* EL050.cbl
 12143
 12144     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12145     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12146        AND (WS-LF-COVERAGE-TYPE = 'L')
 12147        IF (DC-ELAPSED-MONTHS > 1)
 12148                      OR
 12149           ((DC-ELAPSED-MONTHS = 1)
 12150           AND (DC-ODD-DAYS-OVER > 0))
 12151           MOVE ER-2882          TO WS-ERROR
 12152           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12153        END-IF
 12154     END-IF
 12155     if dc-elapsed-months > 0
 12156        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12157        + dc-odd-days-over
 12158     end-if
 12159     IF PB-EXT-DAYS-PROCESSING
 12160        CONTINUE
 12161     ELSE
 12162        IF DC-ELAPSED-MONTHS = +0
 12163           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12164        ELSE
 12165           IF (WS-LF-EARNINGS-CALC = '4')
 12166              AND (DC-ELAPSED-MONTHS > ZERO)
 12167              AND (DC-ELAPSED-DAYS > ZERO)
 12168              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12169           ELSE
 12170              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12171                                 THRU 6499-EXIT
 12172              MOVE WS-ODD-DAYS-OVER
 12173                                 TO PB-I-EXTENTION-DAYS
 12174           END-IF
 12175        END-IF
 12176     END-IF
 12177******************************************************************
 12178*                                                                *
 12179*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12180*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12181*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12182*            AND ANY ODD DAYS.                                   *
 12183*                                                                *
 12184******************************************************************
 12185
 12186     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12187                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12188     IF WS-LF-EARNINGS-CALC NOT = '4'
 12189        IF DC-ELAPSED-DAYS > ZEROS
 12190           MOVE ER-2681          TO WS-ERROR
 12191           PERFORM 9900-ERROR-FORMAT
 12192                                 THRU 9900-EXIT
 12193        END-IF
 12194     END-IF
 12195
 12196     IF WS-LF-EARNINGS-CALC NOT = '4'
 12197        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12198           MOVE ER-2681          TO WS-ERROR
 12199           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12200
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 223
* EL050.cbl
 12201     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12202        (PB-I-LF-TERM NOT = ZERO) AND
 12203         NOT NO-LIFE-COVERAGE
 12204          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12205          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12206          IF WS-LF-EARNINGS-CALC = '4'
 12207             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12208             PB-I-PAY-FREQUENCY
 12209          END-IF
 12210          MOVE ZERO              TO DC-ELAPSED-DAYS
 12211                                    DC-ODD-DAYS-OVER
 12212          MOVE 1                 TO DC-END-OF-MONTH
 12213          SET BIN-PLUS-ELAPSED        TO TRUE
 12214*         MOVE 6                 TO DC-OPTION-CODE
 12215          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12216          IF NO-CONVERSION-ERROR
 12217             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12218             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12219                (WS-LF-SPECIAL-CALC-CD = 'L')
 12220                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12221                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12222                  MOVE +1             TO DC-ELAPSED-MONTHS
 12223                  SET BIN-PLUS-ELAPSED  TO TRUE
 12224*                 MOVE 6              TO DC-OPTION-CODE
 12225                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12226                  IF NO-CONVERSION-ERROR
 12227                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12228
 12229* okay, i had to move the new att age edit down here because the
 12230* expiration date could get recalculated and i need the exp date
 12231     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12232        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12233        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12234        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12235           AND ZEROS
 12236           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12237           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12238           SET ELAPSED-BETWEEN-BIN TO TRUE
 12239           PERFORM 8500-DATE-CONVERT
 12240                                 THRU 8500-EXIT
 12241           IF NO-CONVERSION-ERROR
 12242              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12243                 MOVE ER-2669       TO WS-ERROR
 12244*                PERFORM 9900-ERROR-FORMAT
 12245*                                THRU 9900-EXIT
 12246              END-IF
 12247           END-IF
 12248        ELSE
 12249           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12250           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12251              MOVE ER-2669       TO WS-ERROR
 12252*             PERFORM 9900-ERROR-FORMAT
 12253*                                THRU 9900-EXIT
 12254           ELSE
 12255              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12256                 MOVE ER-1570    TO WS-ERROR
 12257                 PERFORM 9900-ERROR-FORMAT
 12258                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 224
* EL050.cbl
 12259              END-IF
 12260           END-IF
 12261        END-IF
 12262        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12263           AND ZEROS
 12264           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12265           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12266           SET ELAPSED-BETWEEN-BIN TO TRUE
 12267           PERFORM 8500-DATE-CONVERT
 12268                                 THRU 8500-EXIT
 12269           IF NO-CONVERSION-ERROR
 12270              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12271                 MOVE ER-2669       TO WS-ERROR
 12272*                PERFORM 9900-ERROR-FORMAT
 12273*                                THRU 9900-EXIT
 12274              END-IF
 12275           END-IF
 12276        ELSE
 12277           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12278             (PB-I-LF-TERM / 12)
 12279           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12280              MOVE ER-2669       TO WS-ERROR
 12281*             PERFORM 9900-ERROR-FORMAT
 12282*                                THRU 9900-EXIT
 12283           ELSE
 12284              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12285                 MOVE ER-1571    TO WS-ERROR
 12286                 PERFORM 9900-ERROR-FORMAT
 12287                                 THRU 9900-EXIT
 12288              END-IF
 12289           END-IF
 12290        END-IF
 12291        IF WS-ERROR = ER-2669
 12292           PERFORM 9900-ERROR-FORMAT
 12293                                 THRU 9900-EXIT
 12294        END-IF
 12295     END-IF
 12296     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12297        (PB-I-AH-TERM NOT = ZERO) AND
 12298         NOT NO-AH-COVERAGE
 12299          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12300             AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12301             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12302             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12303          ELSE
 12304             IF WS-LF-EARNINGS-CALC = '4'
 12305                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12306                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12307                PB-I-PAY-FREQUENCY
 12308             ELSE
 12309                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12310                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12311             END-IF
 12312          END-IF
 12313          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12314                                         DC-ODD-DAYS-OVER
 12315          MOVE 1                      TO DC-END-OF-MONTH
 12316          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 225
* EL050.cbl
 12317*         MOVE 6                      TO DC-OPTION-CODE
 12318          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12319          IF NO-CONVERSION-ERROR
 12320             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12321     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12322        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12323        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12324        IF PB-I-BIRTHDAY > LOW-VALUES
 12325           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12326           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12327           SET ELAPSED-BETWEEN-BIN TO TRUE
 12328           PERFORM 8500-DATE-CONVERT
 12329                                 THRU 8500-EXIT
 12330           IF NO-CONVERSION-ERROR
 12331              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12332                 MOVE ER-3054       TO WS-ERROR
 12333*                PERFORM 9900-ERROR-FORMAT
 12334*                                THRU 9900-EXIT
 12335              END-IF
 12336           END-IF
 12337        ELSE
 12338           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12339           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12340              MOVE ER-3054       TO WS-ERROR
 12341*             PERFORM 9900-ERROR-FORMAT
 12342*                                THRU 9900-EXIT
 12343           END-IF
 12344        END-IF
 12345        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12346           AND ZEROS
 12347           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12348           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12349           SET ELAPSED-BETWEEN-BIN TO TRUE
 12350           PERFORM 8500-DATE-CONVERT
 12351                                 THRU 8500-EXIT
 12352           IF NO-CONVERSION-ERROR
 12353              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12354                 MOVE ER-3054       TO WS-ERROR
 12355*                PERFORM 9900-ERROR-FORMAT
 12356*                                THRU 9900-EXIT
 12357              END-IF
 12358           END-IF
 12359        ELSE
 12360           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12361             (PB-I-AH-TERM / 12)
 12362           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12363              MOVE ER-3054       TO WS-ERROR
 12364*             PERFORM 9900-ERROR-FORMAT
 12365*                                THRU 9900-EXIT
 12366           END-IF
 12367        END-IF
 12368        IF WS-ERROR = ER-3054
 12369           PERFORM 9900-ERROR-FORMAT
 12370                                 THRU 9900-EXIT
 12371        END-IF
 12372     END-IF
 12373     MOVE SPACE                       TO DC-END-OF-MONTH.
 12374
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 226
* EL050.cbl
 12375     IF PB-COMPANY-ID = 'NCB'
 12376        GO TO 3040-EDIT-EXTENSION-DAYS.
 12377
 12378     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12379       AND
 12380        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12381        NEXT SENTENCE
 12382     ELSE
 12383        GO TO 3040-EDIT-EXTENSION-DAYS.
 12384
 12385     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12386        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12387        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12388     ELSE
 12389        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12390        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12391
 12392     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12393*    MOVE '1'      TO DC-OPTION-CODE
 12394     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12395     IF (NO-CONVERSION-ERROR)
 12396        AND (DC-ELAPSED-MONTHS > +1)
 12397        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12398        MOVE ER-2668   TO WS-ERROR
 12399        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12400
 12401 3040-EDIT-EXTENSION-DAYS.
 12402
 12403     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12404        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12405         GO TO 3050-EDIT-TERM-IN-DAYS
 12406     ELSE
 12407         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12408
 12409     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12410         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12411     ELSE
 12412        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12413           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12414           MOVE ER-2681         TO WS-ERROR
 12415           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12416
 12417     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12418        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12419        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12420         GO TO 3060-ORIG-TERM-CHECK.
 12421
 12422     GO TO 3060-ORIG-TERM-CHECK.
 12423
 12424 3050-EDIT-TERM-IN-DAYS.
 12425
 12426     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12427
 12428     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12429         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12430     ELSE
 12431         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12432            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 227
* EL050.cbl
 12433            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12434
 12435     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12436                                       REMAINDER WS-WORK-TERM.
 12437     IF WS-WORK-TERM GREATER THAN ZERO
 12438         ADD +1 TO PB-I-LF-TERM.
 12439
 12440     IF NOT NO-AH-COVERAGE
 12441         MOVE ER-2684            TO WS-ERROR
 12442         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12443
 12444
 12445 3060-ORIG-TERM-CHECK.
 12446
 12447******************************************************************
 12448*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12449******************************************************************
 12450
 12451     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12452        NEXT SENTENCE
 12453     ELSE
 12454        IF NOT NO-LIFE-COVERAGE
 12455           IF PB-I-LF-TERM NUMERIC
 12456              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12457              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12458              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12459                  NEXT SENTENCE
 12460           ELSE
 12461              MOVE ER-2647       TO WS-ERROR
 12462              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12463
 12464     IF NOT NO-AH-COVERAGE
 12465         IF PB-I-AH-TERM NUMERIC
 12466            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12467            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12468            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12469             NEXT SENTENCE
 12470          ELSE
 12471              MOVE ER-2658       TO WS-ERROR
 12472              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12473
 12474     IF PB-COMPANY-ID = 'NCB'
 12475        GO TO 3070-LOAN-TERM-CHECK.
 12476
 12477     IF POLICY-HAS-AH
 12478       AND
 12479        POLICY-HAS-LIFE
 12480       AND
 12481        PB-I-LF-TERM NUMERIC
 12482       AND
 12483        PB-I-AH-TERM NUMERIC
 12484        NEXT SENTENCE
 12485     ELSE
 12486        GO TO 3070-LOAN-TERM-CHECK.
 12487
 12488     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12489     IF WS-TEX-FACT-2 LESS THAN +0
 12490        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 228
* EL050.cbl
 12491
 12492     IF WS-TEX-FACT-2 GREATER THAN +1
 12493        MOVE ER-2668             TO WS-ERROR
 12494        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12495
 12496 3070-LOAN-TERM-CHECK.
 12497
 12498     IF (WS-LF-BENEFIT-CD = ZERO)
 12499         OR (NO-LF-BENEFIT-MATCH)
 12500            GO TO 3125-EDIT-PMT-FREQ.
 12501*    IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12502*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12503*          AND 'V' AND 'W' AND 'X'
 12504*          GO TO 3125-EDIT-PMT-FREQ
 12505*       END-IF
 12506*    ELSE
 12507*       IF WS-AH-DCC-TRUNC = 'T'
 12508*          CONTINUE
 12509*       ELSE
 12510*          GO TO 3125-EDIT-PMT-FREQ
 12511*       END-IF
 12512*    END-IF
 12513     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12514                    OR
 12515        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12516        AND (WS-AH-DCC-TRUNC = 'T'))
 12517        CONTINUE
 12518     ELSE
 12519        GO TO 3125-EDIT-PMT-FREQ
 12520     END-IF
 12521     IF PB-I-LOAN-TERM NOT NUMERIC
 12522         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12523
 12524     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12525        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12526*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12527        PB-I-LOAN-TERM NOT GREATER THAN +360
 12528         NEXT SENTENCE
 12529     ELSE
 12530         MOVE ER-2648            TO WS-ERROR
 12531         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12532
 12533     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12534        MOVE ER-3058             TO WS-ERROR
 12535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12536     end-if
 12537
 12538     IF WS-STATE-ABBREVIATION = 'NC'
 12539        IF PB-I-LOAN-TERM > +59
 12540           CONTINUE
 12541        ELSE
 12542           MOVE ER-2792          TO WS-ERROR
 12543           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12544        END-IF
 12545     END-IF
 12546
 12547     .
 12548 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 229
* EL050.cbl
 12549     IF (WS-LF-BENEFIT-CD = ZERO)
 12550         OR (NO-LF-BENEFIT-MATCH)
 12551            GO TO 3127-EDIT-LOAN-OFFICER.
 12552     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12553                    OR
 12554        ((PB-COMPANY-ID = 'DCC' or 'VPP')
 12555        AND (WS-AH-DCC-TRUNC = 'T'))
 12556                    OR
 12557         (PB-COMPANY-ID = 'AHL')
 12558        CONTINUE
 12559     ELSE
 12560        IF (PB-I-LOAN-TERM > ZEROS)
 12561           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12562           MOVE ER-1575          TO WS-ERROR
 12563           PERFORM 9900-ERROR-FORMAT
 12564                                 THRU 9900-EXIT
 12565        END-IF
 12566     END-IF
 12567     IF WS-LF-EARNINGS-CALC NOT = '4'
 12568         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12569            MOVE ER-2653         TO WS-ERROR
 12570            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12571            GO TO 3127-EDIT-LOAN-OFFICER
 12572         ELSE
 12573            GO TO 3127-EDIT-LOAN-OFFICER.
 12574
 12575     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12576         MOVE ER-2655            TO WS-ERROR
 12577         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12578         GO TO 3127-EDIT-LOAN-OFFICER.
 12579
 12580     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12581         MOVE ER-2654            TO WS-ERROR
 12582         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12583         GO TO 3127-EDIT-LOAN-OFFICER.
 12584
 12585     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12586         GIVING WS-TEX-FACT-2
 12587             REMAINDER WS-TEX-FACT-3.
 12588
 12589*    IF WS-TEX-FACT-3 NOT = ZERO
 12590*       MOVE ER-2654             TO WS-ERROR
 12591*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12592
 12593
 12594 3127-EDIT-LOAN-OFFICER.
 12595
 12596     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12597        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12598           MOVE ER-2690          TO WS-ERROR
 12599           PERFORM 9900-ERROR-FORMAT
 12600                                 THRU 9900-EXIT
 12601        ELSE
 12602           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12603           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12604           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12605           MOVE PB-SV-STATE      TO LOFC-STATE
 12606           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 230
* EL050.cbl
 12607           MOVE PB-I-LOAN-OFFICER
 12608                                 TO LOFC-CODE
 12609           PERFORM 8586-READ-LOAN-OFFICER
 12610                                 THRU 8586-EXIT
 12611           IF (NOT LOFC-MASTER-FOUND)
 12612              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12613              MOVE ER-3006       TO WS-ERROR
 12614              PERFORM 9900-ERROR-FORMAT
 12615                                 THRU 9900-EXIT
 12616           END-IF
 12617        END-IF
 12618     END-IF
 12619     .
 12620 3129-EDIT-APR.
 12621
 12622     IF (WS-LF-BENEFIT-CD = ZERO)
 12623        OR (NO-LF-BENEFIT-MATCH)
 12624        IF PB-COMPANY-ID NOT = 'DCC' and 'VPP'
 12625           GO TO 3130-EDIT-AGE
 12626*       ELSE
 12627*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12628*             GO TO 3130-EDIT-AGE
 12629*          END-IF
 12630        END-IF
 12631     END-IF
 12632
 12633     IF (WS-STATE-ABBREVIATION = 'OH')
 12634         AND (PB-I-RATE-CLASS NOT = 'L ')
 12635         AND (PB-I-LF-TERM GREATER THAN 60)
 12636         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12637         GO TO 3129-APR-CONT.
 12638
 12639     IF (WS-STATE-ABBREVIATION = 'RI')
 12640         AND (PB-I-LF-TERM GREATER THAN 60)
 12641         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12642         GO TO 3129-APR-CONT.
 12643
 12644     IF (WS-STATE-ABBREVIATION = 'UT')
 12645         AND (PB-I-LF-TERM GREATER THAN 62)
 12646         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12647         AND (PB-CERT-EFF-DT LESS WS-830901)
 12648         GO TO 3129-APR-CONT.
 12649
 12650     IF PB-COMPANY-ID = 'LAP'
 12651        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12652           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12653              MOVE ER-2656         TO WS-ERROR
 12654              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12655              GO TO 3130-EDIT-AGE.
 12656
 12657     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12658        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12659        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12660        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12661        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12662        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12663         GO TO 3130-EDIT-AGE.
 12664
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 231
* EL050.cbl
 12665 3129-APR-CONT.
 12666     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12667         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12668         GO TO 3130-EDIT-AGE.
 12669
 12670     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12671         WS-AH-BENEFIT-CD (1:1) = 'S')
 12672        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 12673        AND (PB-I-LOAN-APR = ZERO)
 12674        MOVE ER-2657             TO WS-ERROR
 12675        PERFORM 9900-ERROR-FORMAT
 12676                                 THRU 9900-EXIT
 12677        GO TO 3130-EDIT-AGE
 12678     END-IF
 12679*    IF PB-I-LOAN-APR = ZERO
 12680*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12681*    END-IF
 12682
 12683     if pb-i-loan-apr = +99.9999
 12684        move er-2656             to ws-error
 12685        PERFORM 9900-ERROR-FORMAT
 12686                                 THRU 9900-EXIT
 12687        GO TO 3130-EDIT-AGE
 12688     end-if
 12689*    IF PB-I-LOAN-APR = ZERO
 12690*       MOVE ER-2656             TO WS-ERROR
 12691*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12692*       GO TO 3130-EDIT-AGE.
 12693
 12694*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12695     if pb-i-loan-apr not = +99.9999
 12696        IF PB-I-LOAN-APR > +30.000
 12697           MOVE ER-2657          TO WS-ERROR
 12698           PERFORM 9900-ERROR-FORMAT
 12699                                 THRU 9900-EXIT
 12700        end-if
 12701     end-if
 12702     .
 12703 3130-EDIT-AGE.
 12704
 12705******************************************************************
 12706*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12707******************************************************************
 12708
 12709     IF NOT NO-LIFE-COVERAGE
 12710        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12711           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12712               MOVE ER-2628             TO WS-ERROR
 12713               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12714
 12715     IF NOT NO-AH-COVERAGE
 12716        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12717           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12718               MOVE ER-2628         TO WS-ERROR
 12719               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12720
 12721 3133-SEX-CODE.
 12722     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 232
* EL050.cbl
 12723         IF WS-DEFAULT-SEX = 'M'
 12724             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12725          ELSE
 12726             IF WS-DEFAULT-SEX = 'F'
 12727             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12728
 12729     IF PB-I-INSURED-SEX = '1'
 12730         MOVE 'M' TO PB-I-INSURED-SEX.
 12731
 12732     IF PB-I-INSURED-SEX = '2'
 12733         MOVE 'F' TO PB-I-INSURED-SEX.
 12734
 12735 3134-SIG-SW-EDIT.
 12736     IF PB-I-SIG-SW = SPACE
 12737         MOVE 'N'                TO  PB-I-SIG-SW.
 12738
 12739     IF PB-COMPANY-ID = 'NCL'
 12740         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12741             NEXT SENTENCE
 12742         ELSE
 12743             MOVE ER-1923        TO  WS-ERROR
 12744             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12745     ELSE
 12746     IF PB-COMPANY-ID = 'CRI'
 12747         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12748             NEXT SENTENCE
 12749         ELSE
 12750             MOVE ER-2606        TO  WS-ERROR
 12751             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12752     ELSE
 12753     IF PB-COMPANY-ID = 'TMS'
 12754         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12755             NEXT SENTENCE
 12756         ELSE
 12757             MOVE ER-2689        TO  WS-ERROR
 12758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12759     ELSE
 12760         IF PB-I-SIG-SW = 'Y' OR 'N'
 12761             NEXT SENTENCE
 12762         ELSE
 12763             MOVE ER-2651        TO  WS-ERROR
 12764             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12765
 12766     IF PB-COMPANY-ID = 'FLA'
 12767         IF (WS-EDIT-AGE GREATER 54  OR
 12768             WS-AH-EDIT-AGE GREATER 54)  AND
 12769            PB-I-SIG-SW = 'N'
 12770            MOVE ER-2651         TO  WS-ERROR
 12771            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12772
 12773 3135-NAME-EDIT.
 12774
 12775     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12776        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12777        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12778           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12779                                 TO PB-I-JOINT-FIRST-NAME
 12780        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 233
* EL050.cbl
 12781     END-IF
 12782     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12783        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12784        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12785           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12786                                 TO PB-I-JOINT-LAST-NAME
 12787        END-PERFORM
 12788     END-IF
 12789     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12790        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12791        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12792           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12793                                 TO PB-I-INSURED-FIRST-NAME
 12794        END-PERFORM
 12795     END-IF
 12796     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12797        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12798        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12799           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12800                                 TO PB-I-INSURED-LAST-NAME
 12801        END-PERFORM
 12802     END-IF
 12803     IF PB-I-INSURED-LAST-NAME = SPACES
 12804       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12805       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12806           MOVE ER-2660    TO WS-ERROR
 12807           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12808
 12809 3136-EDIT-SEX.
 12810
 12811******************************************************************
 12812*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12813******************************************************************
 12814
 12815     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12816        (WS-AH-SPECIAL-CALC-CD = 'O')
 12817        NEXT SENTENCE
 12818     ELSE
 12819        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12820           NEXT SENTENCE
 12821        ELSE
 12822           MOVE ER-2629            TO WS-ERROR
 12823           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12824
 12825 3137-EDIT-EFF-DATE.
 12826
 12827     IF PB-REISSUED-CERT       OR
 12828        PB-POLICY-IS-DECLINED  OR
 12829        PB-POLICY-IS-VOIDED
 12830         GO TO 3139-EDIT-COVERAGE-CODES.
 12831
 12832     MOVE SPACE                  TO WS-2671-SW
 12833                                    WS-2672-SW.
 12834
 12835     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12836         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12837             MOVE ER-2703        TO WS-ERROR
 12838             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 234
* EL050.cbl
 12839             GO TO 3139-EDIT-COVERAGE-CODES.
 12840
 12841     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12842         GO TO 3139-EDIT-COVERAGE-CODES.
 12843
 12844     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12845     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12846*    MOVE '1'                    TO DC-OPTION-CODE.
 12847     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12848     MOVE +0                     TO DC-ELAPSED-MONTHS
 12849                                    DC-ELAPSED-DAYS.
 12850     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12851
 12852     IF DATE-CONVERSION-ERROR
 12853         GO TO 3139-EDIT-COVERAGE-CODES.
 12854
 12855     IF DC-ELAPSED-DAYS GREATER +180
 12856         MOVE ER-2672            TO WS-ERROR
 12857         MOVE 'Y'                TO WS-2672-SW
 12858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12859     END-IF
 12860
 12861     IF WS-ERROR = ER-2671  AND
 12862        PB-COMPANY-ID  = 'LBL'
 12863        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12864        MOVE SPACE               TO WS-2671-SW
 12865        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12866
 12867     IF PB-ISSUE-DATE-FORCED  AND
 12868      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12869         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12870         MOVE ER-2673            TO WS-ERROR
 12871         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12872         MOVE SPACE              TO WS-2671-SW
 12873                                    WS-2672-SW.
 12874
 12875     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12876         IF PB-ISSUE-DATE-FORCED
 12877             MOVE ER-2600          TO  WS-ERROR
 12878             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12879         ELSE
 12880             MOVE ER-2692          TO  WS-ERROR
 12881             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12882
 12883
 12884 3139-EDIT-COVERAGE-CODES.
 12885
 12886     if pb-company-id not = 'AHL'
 12887        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12888           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12889           MOVE ER-2787          TO WS-ERROR
 12890           PERFORM 9900-ERROR-FORMAT
 12891                                 THRU 9900-EXIT
 12892        END-IF
 12893     end-if
 12894     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12895        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12896                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 235
* EL050.cbl
 12897           MOVE ER-2719          TO WS-ERROR
 12898           PERFORM 9900-ERROR-FORMAT
 12899                                 THRU 9900-EXIT
 12900        END-IF
 12901     END-IF
 12902
 12903     IF PB-POLICY-IS-DECLINED  OR
 12904        PB-POLICY-IS-VOIDED
 12905         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12906
 12907     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12908        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12909         MOVE ER-2630                TO WS-ERROR
 12910         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12911
 12912     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12913        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12914        PB-I-LF-PREMIUM-AMT = ZERO
 12915         GO TO 3140-CHECK-AH-FOR-ZERO.
 12916
 12917     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12918        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12919        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12920         GO TO 3140-CHECK-AH-FOR-ZERO.
 12921
 12922     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12923        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12924        MOVE ER-2631             TO WS-ERROR
 12925        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12926     END-IF
 12927
 12928
 12929******************************************************************
 12930*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12931******************************************************************
 12932
 12933     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12934        NEXT SENTENCE
 12935     ELSE
 12936        IF PB-I-LF-BENEFIT-AMT = ZERO
 12937           MOVE ER-2632             TO WS-ERROR
 12938           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12939
 12940
 12941******************************************************************
 12942*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12943******************************************************************
 12944
 12945     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12946        CONTINUE
 12947     ELSE
 12948        IF PB-I-LF-PREMIUM-AMT = ZERO
 12949           IF (NOT PB-COMP-LF-PREM)
 12950              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12951              and (ws-lf-ben-category not = 'C')
 12952              MOVE ER-2633       TO WS-ERROR
 12953              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12954           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 236
* EL050.cbl
 12955        END-IF
 12956     END-IF
 12957     .
 12958 3140-CHECK-AH-FOR-ZERO.
 12959
 12960     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12961        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12962        PB-I-AH-PREMIUM-AMT = ZERO
 12963         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12964
 12965     IF PB-COMPANY-ID = 'CSL'  AND
 12966        PB-I-AH-BENEFIT-CD = ZERO  AND
 12967        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12968        PB-I-AH-PREMIUM-AMT = ZERO
 12969         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12970
 12971     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12972        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12973        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12974         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12975
 12976     IF PB-I-AH-BENEFIT-CD = ZERO
 12977         MOVE ER-2634            TO WS-ERROR
 12978         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12979
 12980******************************************************************
 12981*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12982******************************************************************
 12983
 12984     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12985        NEXT SENTENCE
 12986     ELSE
 12987        IF PB-I-AH-BENEFIT-AMT = ZERO
 12988           MOVE ER-2635             TO WS-ERROR
 12989           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12990
 12991******************************************************************
 12992*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12993******************************************************************
 12994
 12995     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12996        NEXT SENTENCE
 12997     ELSE
 12998        IF PB-I-AH-PREMIUM-AMT = ZERO
 12999            IF NOT PB-COMP-AH-PREM
 13000                MOVE ER-2636    TO WS-ERROR
 13001                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13002
 13003
 13004 3140-EDIT-MAX-AMT-SIZES.
 13005* CUSTOM CODE FOR CLIENT    'DMD'
 13006     MOVE ZEROS                   TO WS-RES-STATE-TAX
 13007                                     WS-RES-MUNI-TAX
 13008                                     PB-I-STATE-TAX
 13009                                     PB-I-MUNI-TAX.
 13010
 13011     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 13012
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 237
* EL050.cbl
 13013     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 13014        GO TO 3150-RATE-OUTSTAND-BAL.
 13015
 13016     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13017        GO TO 3150-RATE-OUTSTAND-BAL.
 13018
 13019     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13020        GO TO 3150-RATE-OUTSTAND-BAL.
 13021
 13022     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13023                             OR 'RIC')
 13024        GO TO 3150-RATE-OUTSTAND-BAL.
 13025
 13026     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13027        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13028            GO TO 3150-RATE-OUTSTAND-BAL
 13029        ELSE
 13030           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13031               GO TO 3150-RATE-OUTSTAND-BAL.
 13032
 13033     IF NOT PB-NO-MONTHS-SKIPPED
 13034        GO TO 3150-RATE-OUTSTAND-BAL.
 13035
 13036     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13037        GO TO 3150-RATE-OUTSTAND-BAL.
 13038
 13039     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13040        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13041           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13042             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13043           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13044           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13045              MOVE ER-2693     TO WS-ERROR
 13046              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13047              GO TO 3150-RATE-OUTSTAND-BAL
 13048           ELSE
 13049              GO TO 3150-RATE-OUTSTAND-BAL.
 13050
 13051 3150-RATE-OUTSTAND-BAL.
 13052
 13053* DMD RATING TEST
 13054     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13055         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13056         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13057         MOVE ER-2687                 TO WS-ERROR
 13058         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13059         MOVE 'B'                     TO PB-I-OB-FLAG
 13060         GO TO 3260-EDIT-CONTINUE.
 13061
 13062     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13063         IF  WS-ERROR    EQUAL    ER-2693
 13064             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13065                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13066                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13067                 MOVE  +0            TO  WS-ERROR.
 13068
 13069     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13070         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 238
* EL050.cbl
 13071             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13072                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13073                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13074                 MOVE  +0            TO  WS-ERROR.
 13075
 13076     IF PLAN-MASTER-AH-SW = 'Y'
 13077        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13078            IF  WS-ERROR    EQUAL    ER-2693
 13079              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13080                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13081                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13082                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13083                 MOVE  ER-1910           TO  WS-ERROR
 13084                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13085
 13086     IF PLAN-MASTER-AH-SW = 'Y'
 13087        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13088            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13089               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13090               MOVE  ER-1910           TO  WS-ERROR
 13091               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13092
 13093     IF PLAN-MASTER-AH-SW = 'Y'
 13094        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13095            IF  WS-ERROR    EQUAL    ER-2693
 13096                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13097                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13098                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13099                 MOVE  +0       TO  WS-ERROR.
 13100
 13101     IF WS-ERROR = ER-2693
 13102        IF PB-COMPANY-ID = 'JAL' AND
 13103           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13104           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13105           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13106
 13107     IF WS-ERROR = ER-2693
 13108        IF PB-COMPANY-ID = 'NCL'  AND
 13109           PB-I-AH-BENEFIT-CD = 'OA'
 13110           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13111           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13112
 13113     IF WS-ERROR = ER-2693
 13114        IF PB-COMPANY-ID = 'CNL' AND
 13115           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13116           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13117           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13118
 13119     IF WS-ERROR = ER-2693
 13120        IF PB-COMPANY-ID = 'HER'
 13121           IF WS-LEVEL
 13122              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13123              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13124
 13125     IF ((LF-BENEFIT-FOUND) AND
 13126         (NOT NO-LIFE-COVERAGE)  AND
 13127         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13128       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 239
* EL050.cbl
 13129             (NOT NO-AH-COVERAGE)    AND
 13130             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13131         NEXT SENTENCE
 13132     ELSE
 13133         GO TO 3215-EDIT-RATES.
 13134
 13135     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13136        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13137           MOVE ER-2674          TO WS-ERROR
 13138           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13139           GO TO 3215-EDIT-RATES.
 13140
 13141     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13142        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13143           MOVE ER-2674          TO WS-ERROR
 13144           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13145           GO TO 3215-EDIT-RATES.
 13146
 13147     MOVE 'B'                    TO PB-I-OB-FLAG.
 13148
 13149     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13150         NEXT SENTENCE
 13151     ELSE
 13152         IF NOT NO-LIFE-COVERAGE
 13153             IF WS-ACCT-LF-OB-RT = ZERO
 13154                MOVE ER-2641    TO WS-ERROR
 13155                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13156
 13157     IF PB-COMPANY-ID = 'CRI'
 13158       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13159         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13160         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13161         IF WS-ERROR = ER-2675
 13162            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13163            MOVE ER-2687              TO WS-ERROR
 13164            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165         ELSE
 13166            MOVE ER-2687              TO WS-ERROR
 13167            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13168
 13169
 13170     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13171         NEXT SENTENCE
 13172     ELSE
 13173       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13174            NEXT SENTENCE
 13175       ELSE
 13176         IF NOT NO-AH-COVERAGE
 13177             IF WS-ACCT-AH-OB-RT = ZERO
 13178                MOVE ER-2642    TO WS-ERROR
 13179                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13180
 13181     IF PB-COMPANY-ID = 'CRI'
 13182       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13183         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13184         IF WS-ERROR = ER-2676
 13185            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13186            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 240
* EL050.cbl
 13187            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13188         ELSE
 13189            MOVE ER-2687              TO WS-ERROR
 13190            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13191
 13192     IF PB-COMPANY-ID NOT = 'GIC'
 13193         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13194            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13195     ELSE
 13196         IF PB-I-LF-PREM-CALC = ZEROS
 13197             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13198                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13199
 13200     IF PB-COMPANY-ID NOT = 'GIC'
 13201         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13202            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13203     ELSE
 13204         IF PB-I-AH-PREM-CALC = ZEROS
 13205             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13206                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13207
 13208     MOVE ZEROS TO PB-I-MORT-CODE.
 13209
 13210     GO TO 3260-EDIT-CONTINUE.
 13211
 13212
 13213 3215-EDIT-RATES.
 13214     IF ACCOUNT-MAST-FOUND
 13215         NEXT SENTENCE
 13216     ELSE
 13217         GO TO 3999-END-EDIT.
 13218
 13219 3220-CHECK-LF-RATES.
 13220
 13221     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13222        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13223        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13224        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13225           AND (NOT WS-LF-CASH))
 13226                           OR
 13227           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13228           AND (NOT WS-AH-CASH)))
 13229                       AND
 13230           (PB-I-ENTRY-STATUS NOT = '5')
 13231           MOVE 'M'              TO PB-BATCH-ENTRY
 13232                                    PB-I-ENTRY-STATUS
 13233        END-IF
 13234     END-IF
 13235     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13236                                    PB-I-AH-PREM-CALC
 13237                                    PB-I-LF-ALT-PREM-CALC
 13238                                    PB-I-LF-ALT-RATE
 13239                                    PB-I-LF-REI-RATE
 13240                                    PB-I-LF-ALT-REI-RATE
 13241                                    PB-I-AH-REI-RATE
 13242                                    PB-I-TOT-FEES-CALC.
 13243
 13244     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 241
* EL050.cbl
 13245        NEXT SENTENCE
 13246     ELSE
 13247        MOVE ZEROS               TO PB-I-LF-RATE
 13248                                    PB-I-AH-RATE.
 13249
 13250     IF PB-I-TOT-FEES NOT NUMERIC
 13251        MOVE ZEROS               TO PB-I-TOT-FEES
 13252     END-IF
 13253     IF PB-I-LIVES NOT NUMERIC
 13254         MOVE ZERO               TO PB-I-LIVES.
 13255
 13256     IF PB-I-NUM-BILLED NOT NUMERIC
 13257         MOVE ZERO               TO PB-I-NUM-BILLED.
 13258
 13259     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13260        MOVE +0                  TO PB-I-LF-PREM-TAX
 13261     END-IF
 13262
 13263     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13264        MOVE +0                  TO PB-I-AH-PREM-TAX
 13265     END-IF
 13266
 13267     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13268        PB-I-PAY-FREQUENCY = ZEROS
 13269            MOVE 12 TO CP-PAY-FREQUENCY
 13270     ELSE
 13271            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13272
 13273     IF PB-I-STATE-TAX NOT NUMERIC
 13274         MOVE ZEROS               TO PB-I-STATE-TAX.
 13275
 13276     IF PB-I-MUNI-TAX NOT NUMERIC
 13277         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13278
 13279     MOVE SPACES                 TO CP-BEN-CATEGORY
 13280     IF PB-COMPANY-ID  = 'CSL'  AND
 13281        PB-I-LF-TERM NOT = ZERO
 13282        COMPUTE WS-PAYMENT-AMT =
 13283             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13284        COMPUTE WS-CSL-AMT1 =
 13285             PB-I-LF-TERM * AM-MAX-MON-BEN
 13286        COMPUTE WS-CSL-AMT2 =
 13287             WS-PAYMENT-AMT * PB-I-LF-TERM
 13288        IF CP-PAY-FREQUENCY NOT = 12
 13289           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13290           MOVE '8' TO WS-CSL-CALC-CD
 13291        ELSE
 13292           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13293              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13294               AM-MAX-TOT-BEN
 13295               MOVE '6' TO WS-CSL-CALC-CD
 13296           ELSE
 13297              IF (WS-CSL-AMT1  GREATER THAN
 13298                 AM-MAX-TOT-BEN) AND
 13299                 (WS-CSL-AMT2  GREATER THAN
 13300                 AM-MAX-TOT-BEN)
 13301                 MOVE '7' TO WS-CSL-CALC-CD
 13302              ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 242
* EL050.cbl
 13303                 MOVE '5' TO WS-CSL-CALC-CD.
 13304
 13305     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13306         NEXT SENTENCE
 13307     ELSE
 13308         GO TO 3300-CHECK-AH-RATES.
 13309
 13310*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13311
 13312     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13313        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13314              OR
 13315           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13316           MOVE ER-2618          TO WS-ERROR
 13317           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13318           GO TO 3300-CHECK-AH-RATES.
 13319
 13320     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13321           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13322                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13323
 13324     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13325         MOVE ER-2687             TO WS-ERROR
 13326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13327         MOVE 'Z000'              TO PB-I-MORT-CODE
 13328         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13329         GO TO 3300-CHECK-AH-RATES.
 13330
 13331     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13332        IF PB-I-LIVES = ZERO
 13333           MOVE ER-2688          TO WS-ERROR
 13334           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13335
 13336     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13337
 13338     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13339     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13340     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13341     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13342     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13343     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13344     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13345     MOVE '3'                    TO CP-PROCESS-TYPE.
 13346     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13347     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13348
 13349******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13350     IF PB-COMPANY-ID EQUAL 'CDL'
 13351         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13352            CP-EARN-AS-NET-PAY)
 13353             IF PB-CERT-EFF-DT GREATER  WS-931231
 13354                 MOVE '1'        TO CP-EARNING-METHOD.
 13355*******
 13356
 13357     MOVE PB-SV-STATE            TO CP-STATE.
 13358     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13359     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13360     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 243
* EL050.cbl
 13361     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13362     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13363                                    CP-RATING-BENEFIT-AMT.
 13364     IF CP-STATE-STD-ABBRV = 'OR'
 13365         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13366                                         PB-I-LF-ALT-BENEFIT-AMT.
 13367     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13368     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13369     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13370     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13371     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13372     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13373     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13374     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13375     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13376                                    CP-REMAINING-TERM
 13377                                    CP-LOAN-TERM.
 13378
 13379     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13380         NEXT SENTENCE
 13381     ELSE
 13382         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13383             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13384                                           PB-I-LF-PREMIUM-AMT.
 13385
 13386     IF PB-COMPANY-ID EQUAL 'CSL'
 13387        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13388           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13389                                         PB-I-LF-PREMIUM-AMT.
 13390
 13391     IF PB-COMPANY-ID EQUAL 'NCB'
 13392         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13393            CP-EARN-AS-NET-PAY
 13394             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13395                 PB-I-LF-PREMIUM-AMT.
 13396
 13397     IF (CP-TRUNCATED-LIFE)
 13398        or ((pb-company-id = 'AHL')
 13399           and (pb-i-loan-term > pb-i-lf-term))
 13400        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13401
 13402     IF PB-COMPANY-ID EQUAL 'CRI'
 13403        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13404
 13405     IF CP-TERM-IS-DAYS
 13406         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13407     ELSE
 13408         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13409     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13410        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13411        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13412        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13413        IF WS-LF-BEN-CATEGORY = 'D'
 13414           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13415           MOVE PB-I-LIFE-COMMISSION
 13416                                 TO CP-DCC-ACT-COMM
 13417           MOVE WS-LF-BEN-CATEGORY
 13418                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 244
* EL050.cbl
 13419        END-IF
 13420        IF (CP-BENEFIT-CD (1:1) = 'P')
 13421           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13422           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13423           add pb-i-ah-premium-amt to cp-original-premium
 13424        END-IF
 13425     END-IF
 13426     IF PB-COMPANY-ID = 'CSL'
 13427         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13428         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13429         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13430
 13431     IF PB-COMPANY-ID = 'CSL'
 13432        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13433
 13434     IF (CP-SPECIAL-CALC-CD = 'H')
 13435        OR (PB-COMPANY-ID = 'DCC' or 'VPP')
 13436         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13437                                    TO CP-ALTERNATE-BENEFIT
 13438         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13439     if (pb-company-id = 'CID')
 13440        and (ws-lf-earnings-calc = '4')
 13441        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13442        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13443        move pb-i-term-type      to cp-pmt-mode
 13444        move pb-i-no-of-payments to cp-no-of-pmts
 13445     end-if
 13446     move ws-net-only-state      to cp-net-only-state
 13447     IF (PB-COMPANY-ID = 'CID')
 13448        AND (WS-LF-EARNINGS-CALC = 'B')
 13449        AND (CP-STATE-STD-ABBRV = 'MN')
 13450        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13451                                 TO CP-ALTERNATE-BENEFIT
 13452        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13453     END-IF
 13454     IF (PB-COMPANY-ID = 'CID')
 13455        AND (WS-LF-EARNINGS-CALC = 'B')
 13456        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13457                                 TO CP-ALTERNATE-BENEFIT
 13458        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13459        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13460*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13461*         pb-i-lf-alt-premium-amt
 13462        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13463        IF WS-LF-BEN-CATEGORY = 'P'
 13464           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13465        ELSE
 13466           IF WS-LF-BEN-CATEGORY = 'I'
 13467              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13468           END-IF
 13469        END-IF
 13470     END-IF
 13471     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13472     MOVE 'R'                   TO CP-RATE-FILE.
 13473     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13474
 13475     IF CP-ERROR-RATE-NOT-FOUND
 13476        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 245
* EL050.cbl
 13477        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13478        GO TO 3300-CHECK-AH-RATES.
 13479
 13480     IF PB-COMPANY-ID EQUAL 'CRI'
 13481        IF CP-ERROR-NO-LIMITS-CRI
 13482           IF NOT ACCOUNT-LIFE-CHECKED
 13483              MOVE ER-2607      TO WS-ERROR
 13484              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13485
 13486******************************************************************
 13487*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13488*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13489******************************************************************
 13490
 13491* CALC LIFE AGE AT EXPIRATION.
 13492
 13493     COMPUTE WS-AGE-AT-EXPIRE =
 13494          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13495
 13496*    IF PB-STATE = 'CO' OR 'UT'
 13497*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13498*        MOVE 'F'            TO PB-FATAL-FLAG
 13499*        MOVE ER-2709        TO WS-ERROR
 13500*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13501*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13502
 13503*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13504*        MOVE 'X'            TO PB-FATAL-FLAG
 13505*        MOVE ER-2718        TO WS-ERROR
 13506*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13507*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13508
 13509* CALC A & H AGE AT EXPIRATION.
 13510
 13511     COMPUTE WS-AGE-AT-EXPIRE =
 13512          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13513
 13514*    IF PB-STATE = 'CO' OR 'UT'
 13515*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13516*        MOVE 'F'            TO PB-FATAL-FLAG
 13517*        MOVE ER-2709        TO WS-ERROR
 13518*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13519*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13520
 13521*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13522*        MOVE 'X'            TO PB-FATAL-FLAG
 13523*        MOVE ER-2718        TO WS-ERROR
 13524*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13525*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13526
 13527     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13528        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13529
 13530     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13531        and (not pb-monthly-cert)
 13532        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13533     end-if
 13534
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 246
* EL050.cbl
 13535     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13536        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13537
 13538     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13539         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13540         MOVE ER-2639        TO WS-ERROR
 13541         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13542
 13543
 13544******************************************************************
 13545*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13546******************************************************************
 13547
 13548 PREMIUM-EDITING-IS-BYPASSED.
 13549     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13550        AND (CP-R-MAX-ATT-AGE > +0)
 13551        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13552        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13553           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13554           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13555           MOVE '1'              TO DC-OPTION-CODE
 13556           PERFORM 8500-DATE-CONVERT
 13557                                 THRU 8500-EXIT
 13558           IF NO-CONVERSION-ERROR
 13559              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13560                 MOVE ER-2661       TO WS-ERROR
 13561*                PERFORM 9900-ERROR-FORMAT
 13562*                                THRU 9900-EXIT
 13563              END-IF
 13564           END-IF
 13565        ELSE
 13566           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13567           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13568              MOVE ER-2661       TO WS-ERROR
 13569*             PERFORM 9900-ERROR-FORMAT
 13570*                                THRU 9900-EXIT
 13571           ELSE
 13572              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13573                 MOVE ER-1570    TO WS-ERROR
 13574                 PERFORM 9900-ERROR-FORMAT
 13575                                 THRU 9900-EXIT
 13576              END-IF
 13577           END-IF
 13578        END-IF
 13579        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13580           MOVE PB-I-JOINT-BIRTHDAY
 13581                                 TO DC-BIN-DATE-1
 13582           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13583           MOVE '1'              TO DC-OPTION-CODE
 13584           PERFORM 8500-DATE-CONVERT
 13585                                 THRU 8500-EXIT
 13586           IF NO-CONVERSION-ERROR
 13587              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13588                 MOVE ER-2661       TO WS-ERROR
 13589*                PERFORM 9900-ERROR-FORMAT
 13590*                                THRU 9900-EXIT
 13591              END-IF
 13592           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 247
* EL050.cbl
 13593              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13594           END-IF
 13595        ELSE
 13596           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13597             (PB-I-LF-TERM / 12)
 13598           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13599              MOVE ER-2661       TO WS-ERROR
 13600*             PERFORM 9900-ERROR-FORMAT
 13601*                                THRU 9900-EXIT
 13602           ELSE
 13603              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13604                 MOVE ER-1571    TO WS-ERROR
 13605                 PERFORM 9900-ERROR-FORMAT
 13606                                 THRU 9900-EXIT
 13607              END-IF
 13608           END-IF
 13609        END-IF
 13610        IF WS-ERROR = ER-2661
 13611           PERFORM 9900-ERROR-FORMAT
 13612                                 THRU 9900-EXIT
 13613        END-IF
 13614     END-IF
 13615*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13616*       MOVE ER-2661             TO WS-ERROR
 13617*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13618
 13619     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13620        MOVE ER-2662             TO WS-ERROR
 13621        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13622
 13623     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13624        MOVE ER-2677             TO WS-ERROR
 13625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13626
 13627     IF CP-ERROR-LOAN-TERM
 13628        MOVE ER-2648             TO WS-ERROR
 13629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13630
 13631 3221-CHECK-ERROR-RATE-OPEN.
 13632
 13633     IF CP-ERROR-RATE-FILE-NOTOPEN
 13634         GO TO 3990-FILES-NOT-OPEN.
 13635
 13636     IF PB-COMPANY-ID NOT = 'DMD'
 13637        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13638     END-IF
 13639     .
 13640 3221-CONTINUE.
 13641     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13642                                    WS-DCC-AH-RATE
 13643     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13644        IF WS-LF-BEN-CATEGORY = 'D'
 13645           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13646              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13647        END-IF
 13648     END-IF
 13649     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13650*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 248
* EL050.cbl
 13651     IF (PB-COMPANY-ID = 'CID')
 13652        AND (WS-LF-EARNINGS-CALC = 'B')
 13653        AND (CP-STATE-STD-ABBRV = 'MN')
 13654        AND (PB-CERT-EFF-DT > X'A4FF')
 13655        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13656     END-IF
 13657     MOVE ZEROS                  TO PB-I-LF-POLICY-FEE.
 13658
 13659     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13660     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13661        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13662        AND (PB-I-POLICY-IS-MONTHLY)
 13663        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13664        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13665     END-IF
 13666     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13667     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13668     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13669     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13670     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13671        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13672        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13673        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13674        MOVE ER-2786             TO WS-ERROR
 13675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13676     END-IF
 13677
 13678     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13679
 13680******************************************************************
 13681*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13682******************************************************************
 13683     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13684        and ((not pb-monthly-cert)
 13685        or (ws-lf-ben-category = 'C'))
 13686        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13687
 13688     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13689        GO TO 3225-CHECK-ALT-LIFE-RATE
 13690     ELSE
 13691       IF PB-I-LF-RATE = ZERO
 13692          MOVE ER-2641          TO WS-ERROR
 13693          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13694
 13695 3225-CHECK-ALT-LIFE-RATE.
 13696
 13697     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13698        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13699        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13700         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13701
 13702     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13703         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13704             AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
 13705                   OR
 13706              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13707              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13708              AND (PB-COMPANY-ID NOT = 'DCC' and 'VPP'))
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 249
* EL050.cbl
 13709             MOVE ER-2720        TO  WS-ERROR
 13710             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13711             GO TO 3225-RATING-CONT
 13712         ELSE
 13713             GO TO 3225-RATING-CONT.
 13714     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13715        AND (AM-GPCD = 01 OR 06 OR 15)
 13716        MOVE ER-2798             TO WS-ERROR
 13717        PERFORM 9900-ERROR-FORMAT
 13718                                 THRU 9900-EXIT
 13719*       GO TO 3225-RATING-CONT
 13720     END-IF
 13721     if (pb-company-id = 'CID')
 13722        and (ws-lf-earnings-calc = 'B')
 13723        and (ws-lf-ben-category = 'P' or 'I')
 13724        and (ws-net-only-state = 'Y')
 13725        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13726        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13727        go to 3225-rating-cont
 13728     end-if
 13729     IF (PB-COMPANY-ID = 'CID')
 13730        AND (WS-LF-EARNINGS-CALC = 'B')
 13731        AND (CP-STATE-STD-ABBRV = 'MN')
 13732        AND (PB-CERT-EFF-DT > X'A4FF')
 13733        GO TO 3225-RATING-CONT
 13734     END-IF
 13735     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13736        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13737           AND (PB-I-POLICY-IS-MONTHLY)
 13738           GO TO 3225-RATING-CONT
 13739        END-IF
 13740     END-IF
 13741
 13742     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13743        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13744        CP-EARN-AS-REG-BALLOON
 13745        NEXT SENTENCE
 13746     ELSE
 13747        MOVE '2'                 TO CP-EARNING-METHOD.
 13748
 13749 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13750
 13751     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13752
 13753     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13754        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13755        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13756         NEXT SENTENCE
 13757     ELSE
 13758         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13759
 13760     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13761     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13762     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13763                                     CP-RATING-BENEFIT-AMT.
 13764     IF CP-STATE-STD-ABBRV = 'OR'
 13765         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13766                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 250
* EL050.cbl
 13767     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13768        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13769     END-IF
 13770     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13771     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13772     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13773                                    CP-REMAINING-TERM
 13774                                    CP-LOAN-TERM.
 13775     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13776        ADD +1                   TO CP-ORIGINAL-TERM
 13777                                    CP-REMAINING-TERM
 13778                                    CP-LOAN-TERM.
 13779
 13780     MOVE 'R'                   TO CP-RATE-FILE.
 13781     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13782
 13783     IF CP-ERROR-RATE-NOT-FOUND
 13784         MOVE ER-2641            TO WS-ERROR
 13785         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13786         GO TO 3300-CHECK-AH-RATES.
 13787
 13788     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13789     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13790
 13791     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13792         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13793
 13794     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13795                               + PB-I-LF-ALT-BENEFIT-AMT.
 13796
 13797     IF ACCOUNT-LIFE-CHECKED  OR
 13798        PB-POLICY-IS-VOIDED   OR
 13799        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13800        and (not pb-monthly-cert))
 13801        GO TO 3225-CONTINUE.
 13802
 13803     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13804        GO TO 3225-CONTINUE.
 13805
 13806     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13807                             EC-RT-LF-MAX-TOT-BEN
 13808        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13809        MOVE ER-2639       TO WS-ERROR
 13810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13811
 13812 3225-CONTINUE.
 13813     IF PB-I-LF-ALT-RATE = ZERO
 13814         MOVE ER-2659            TO WS-ERROR
 13815         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13816
 13817     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13818        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13819        MOVE ER-2698             TO WS-ERROR
 13820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13821
 13822 3225-RATING-CONT.
 13823
 13824     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 251
* EL050.cbl
 13825        and (not pb-monthly-cert)
 13826         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13827         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13828         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 13829            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13830            CONTINUE
 13831         ELSE
 13832            MOVE ER-2687         TO WS-ERROR
 13833            PERFORM 9900-ERROR-FORMAT
 13834                                 THRU 9900-EXIT
 13835         END-IF
 13836         GO TO 3290-EDIT-LF-REIN-RATE
 13837     END-IF
 13838
 13839* DMD RATING TEST
 13840     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13841         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13842         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13843         MOVE ER-2687                 TO WS-ERROR
 13844         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13845         GO TO 3290-EDIT-LF-REIN-RATE.
 13846
 13847 3230-CLIENT-MORT-CD-SPECIALS.
 13848
 13849     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13850     SET BIN-TO-GREG          TO TRUE.
 13851*    MOVE ' '                 TO DC-OPTION-CODE.
 13852     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13853     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13854
 13855 C-POS-3230-MORT-CD.
 13856     IF PB-COMPANY-ID = 'POS' AND
 13857        PB-SV-CARRIER = '2'
 13858         NEXT SENTENCE
 13859     ELSE
 13860         GO TO C-POS-3240-MORT-CD.
 13861
 13862     IF PB-SV-GROUPING = '030'
 13863        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13864         MOVE '2350' TO PB-I-MORT-CODE
 13865      ELSE
 13866         MOVE '3300' TO PB-I-MORT-CODE.
 13867
 13868
 13869 C-POS-3240-MORT-CD.
 13870     IF PB-COMPANY-ID = 'POS' AND
 13871        PB-SV-CARRIER = '1'
 13872         NEXT SENTENCE
 13873     ELSE
 13874         GO TO 3230-CONTINUE.
 13875
 13876     IF PB-SV-STATE = '45' OR '47'
 13877        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13878         MOVE '5200' TO PB-I-MORT-CODE
 13879     ELSE
 13880         MOVE '8300' TO PB-I-MORT-CODE.
 13881
 13882 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 252
* EL050.cbl
 13883
 13884     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13885        GO TO 3240-CONTINUE
 13886     END-IF
 13887
 13888     IF PB-CERT-EFF-DT > WS-971231
 13889        GO TO 3240-CONTINUE
 13890     END-IF
 13891
 13892     IF LF-BENEFIT-FOUND AND
 13893        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13894         MOVE 'F250'       TO PB-I-MORT-CODE
 13895     ELSE
 13896         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13897             MOVE '7250'   TO PB-I-MORT-CODE
 13898         ELSE
 13899             MOVE '4251'   TO PB-I-MORT-CODE
 13900         END-IF
 13901     END-IF
 13902
 13903     .
 13904 3240-CONTINUE.
 13905
 13906     IF PB-COMPANY-ID NOT = 'GNL'
 13907         GO TO 3256-CONTINUE.
 13908
 13909     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13910         MOVE 'A300' TO PB-I-MORT-CODE
 13911     ELSE
 13912         MOVE '8350' TO PB-I-MORT-CODE.
 13913
 13914 3256-CONTINUE.
 13915     IF PB-COMPANY-ID NOT = 'ABL'
 13916         GO TO 3260-EDIT-CONTINUE.
 13917
 13918     IF PB-I-LF-TERM GREATER THAN 59
 13919         MOVE 'F550' TO PB-I-MORT-CODE
 13920     ELSE
 13921         MOVE 'E550' TO PB-I-MORT-CODE.
 13922
 13923 3260-EDIT-CONTINUE.
 13924     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13925
 13926 3290-EDIT-LF-REIN-RATE.
 13927     IF LF-REIN-NSP-NOT-USED
 13928         GO TO 3290-RATING-CONT.
 13929
 13930     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13931        GO TO 3290-RATING-CONT.
 13932     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13933     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13934     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13935     MOVE '3'                   TO CP-PROCESS-TYPE.
 13936     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13937
 13938******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13939     IF PB-COMPANY-ID EQUAL 'CDL'
 13940         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 253
* EL050.cbl
 13941            CP-EARN-AS-NET-PAY)
 13942             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13943*            MOVE SPACE          TO DC-OPTION-CODE
 13944             SET BIN-TO-GREG     TO TRUE
 13945             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13946***  Y2K PROJ 7744
 13947             IF DC-GREG-DATE-CYMD GREATER 19931231
 13948                 MOVE '1'        TO CP-EARNING-METHOD.
 13949***  Y2K PROJ 7744
 13950*******
 13951
 13952     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13953     MOVE PB-SV-STATE           TO CP-STATE.
 13954     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13955     MOVE ZERO                  TO CP-DEVIATION-CODE
 13956                                   CP-RATE-DEV-PCT.
 13957     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13958     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13959                                   CP-RATING-BENEFIT-AMT.
 13960
 13961************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13962     IF PB-COMPANY-ID EQUAL 'NCB'
 13963         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13964            CP-EARN-AS-NET-PAY
 13965             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13966                 PB-I-LF-PREMIUM-AMT.
 13967************
 13968
 13969     IF CP-STATE-STD-ABBRV = 'OR'
 13970         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13971                                         PB-I-LF-ALT-BENEFIT-AMT.
 13972     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13973     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13974     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13975     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13976     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13977     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13978     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13979     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13980                                   CP-REMAINING-TERM
 13981                                   CP-LOAN-TERM.
 13982     IF CP-TRUNCATED-LIFE
 13983        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13984
 13985     IF CP-TERM-IS-DAYS
 13986         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13987     ELSE
 13988         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13989
 13990     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 13991        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13992     END-IF
 13993     IF PB-COMPANY-ID NOT = 'TIC'
 13994          MOVE ZERO          TO CP-CLASS-CODE.
 13995
 13996     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13997
 13998     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 254
* EL050.cbl
 13999     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14000
 14001     IF CP-ERROR-RATE-NOT-FOUND
 14002        IF PB-I-OB
 14003           MOVE ER-2625      TO WS-ERROR
 14004           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14005           GO TO 3299-EDIT-CONTINUE
 14006        ELSE
 14007           MOVE ER-2643      TO WS-ERROR
 14008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14009           GO TO 3299-EDIT-CONTINUE.
 14010
 14011     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 14012
 14013     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 14014     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14015
 14016     IF PB-I-LF-REI-RATE = ZERO
 14017         MOVE ER-2643        TO WS-ERROR
 14018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14019
 14020 3290-CHECK-ALT-REIN-RATE.
 14021
 14022     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14023        GO TO 3290-RATING-CONT.
 14024
 14025     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14026     MOVE '2'                    TO CP-EARNING-METHOD.
 14027     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14028     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14029     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14030     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14031                                     CP-RATING-BENEFIT-AMT.
 14032     IF CP-STATE-STD-ABBRV = 'OR'
 14033         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14034                                         PB-I-LF-ALT-BENEFIT-AMT.
 14035     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14036        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14037     END-IF
 14038     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14039     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14040     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14041                                    CP-REMAINING-TERM
 14042                                    CP-LOAN-TERM.
 14043     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14044        ADD +1                   TO CP-ORIGINAL-TERM
 14045                                    CP-REMAINING-TERM
 14046                                    CP-LOAN-TERM.
 14047
 14048     MOVE 'R'                   TO CP-RATE-FILE.
 14049     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14050
 14051     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14052
 14053     IF PB-I-LF-ALT-REI-RATE = ZERO
 14054         MOVE ER-2643            TO WS-ERROR
 14055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14056
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 255
* EL050.cbl
 14057 3290-RATING-CONT.
 14058
 14059     IF PB-I-OB
 14060*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14061        GO TO 3300-CHECK-AH-RATES.
 14062
 14063 3299-EDIT-CONTINUE.
 14064
 14065     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14066         NEXT SENTENCE
 14067     ELSE
 14068         MOVE ER-2620           TO WS-ERROR
 14069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14070
 14071 3300-CHECK-AH-RATES.
 14072     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14073         NEXT SENTENCE
 14074     ELSE
 14075         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14076
 14077     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14078        and (not pb-monthly-cert))
 14079                  or
 14080        ((CF-COMPANY-ID = 'DMD') AND
 14081                (NO-DMD-RATING))
 14082         IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14083            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14084            CONTINUE
 14085         ELSE
 14086            MOVE ER-2687         TO WS-ERROR
 14087            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14088         END-IF
 14089         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14090         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14091     END-IF
 14092
 14093     IF PB-I-OB
 14094        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14095
 14096     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14097         MOVE ER-2687             TO WS-ERROR
 14098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14099         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14100         GO TO 3999-END-EDIT.
 14101
 14102*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14103     if pb-company-id = 'AHL'
 14104        go to 3300-skip-crit-per
 14105     end-if
 14106     if (pb-i-ah-crit-per not = zeros)
 14107        and (ws-ah-special-calc-cd not = 'C')
 14108        MOVE ER-1572             TO WS-ERROR
 14109        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14110        go to 3300-skip-crit-per
 14111     END-IF
 14112     if (pb-company-id = 'DCC' or 'VPP')
 14113        and (am-dcc-product-code not = spaces)
 14114        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 256
* EL050.cbl
 14115     end-if
 14116     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14117        IF PB-I-AH-CRIT-PER = ZERO
 14118           move ws-ah-max-bens   to pb-i-ah-crit-per
 14119*          MOVE ER-2618       TO WS-ERROR
 14120*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14121*          GO TO 3999-END-EDIT
 14122        END-IF
 14123     END-IF
 14124     if (ws-ah-special-calc-cd = 'C')
 14125        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14126        MOVE ER-1576             TO WS-ERROR
 14127        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14128     end-if
 14129
 14130     .
 14131 3300-skip-crit-per.
 14132     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14133     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14134     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14135     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14136     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14137     MOVE PB-SV-STATE            TO CP-STATE.
 14138     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14139     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14140     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14141*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14142     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14143     MOVE '3'                    TO CP-PROCESS-TYPE.
 14144     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14145     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14146                                    CP-RATING-BENEFIT-AMT.
 14147     IF PB-COMPANY-ID = 'CID'
 14148               OR
 14149        CP-STATE-STD-ABBRV = 'OR'
 14150         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14151                                         PB-I-AH-TERM.
 14152     IF PB-COMPANY-ID = 'DCC' or 'VPP' OR 'CID'
 14153        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14154           AND (PB-I-POLICY-IS-MONTHLY)
 14155           MOVE PB-I-LF-BENEFIT-AMT
 14156                                 TO CP-NET-BENEFIT-AMT
 14157           move pb-i-ah-premium-amt to cp-original-premium
 14158           add pb-i-lf-premium-amt to cp-original-premium
 14159        END-IF
 14160     END-IF
 14161     MOVE SPACES                 TO CP-BEN-CATEGORY
 14162     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14163        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14164        EVALUATE TRUE
 14165           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14166              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14167              MOVE PB-I-LF-BENEFIT-AMT
 14168                                 TO CP-RATING-BENEFIT-AMT
 14169              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14170           WHEN WS-AH-BEN-CATEGORY = 'G'
 14171              MOVE PB-I-UNPAID-CASH-PRICE
 14172                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 257
* EL050.cbl
 14173           WHEN WS-AH-BEN-CATEGORY = 'D'
 14174              MOVE WS-AH-PMF-COMM
 14175                                 TO CP-DCC-PMF-COMM
 14176              MOVE PB-I-AH-COMMISSION
 14177                                 TO CP-DCC-ACT-COMM
 14178        END-EVALUATE
 14179     END-IF
 14180     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14181     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14182     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14183     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14184     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14185     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14186     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14187                                    CP-REMAINING-TERM
 14188                                    WS-WORK-TERM.
 14189     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14190
 14191     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14192     SET BIN-TO-GREG             TO TRUE.
 14193*    MOVE ' '                    TO DC-OPTION-CODE.
 14194     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14195     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14196
 14197     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14198     IF NOT VALID-SKIP-CODE
 14199         MOVE ER-2683            TO WS-ERROR
 14200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14201         GO TO 3320-RATE-CONTINUE.
 14202
 14203     IF PB-NO-MONTHS-SKIPPED
 14204         GO TO 3320-RATE-CONTINUE.
 14205
 14206     MOVE SPACE TO NUMBER-OF-MONTHS.
 14207
 14208     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14209         MOVE 'S'                TO SK-MO (6).
 14210     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14211         MOVE 'S'                TO SK-MO (7).
 14212     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14213         MOVE 'S'                TO SK-MO (8).
 14214     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14215         MOVE 'S'                TO SK-MO (9).
 14216     IF PB-I-SKIP-CODE = 'A'
 14217         MOVE 'S'                TO SK-MO (10).
 14218
 14219     MOVE 1                      TO SUB2.
 14220     MOVE PB-I-AH-TERM           TO SUB3.
 14221     MOVE WS-MONTH               TO SUB1.
 14222     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14223     GO TO 3320-RATE-CONTINUE.
 14224
 14225 3310-GET-SKIP-MO.
 14226     IF SUB1 = 13
 14227         MOVE 1                  TO SUB1.
 14228
 14229     IF SK-MO (SUB1) = 'S'
 14230         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 258
* EL050.cbl
 14231
 14232     ADD 1 TO SUB2
 14233              SUB1.
 14234
 14235 3320-RATE-CONTINUE.
 14236
 14237     IF WS-WORK-TERM = ZERO
 14238         MOVE 1                  TO WS-WORK-TERM.
 14239
 14240     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14241                                    CP-LOAN-TERM.
 14242
 14243     IF PB-COMPANY-ID EQUAL 'DMD'
 14244         NEXT SENTENCE
 14245     ELSE
 14246         MOVE ZERO               TO PB-I-AH-RATE
 14247                                    PB-I-AH-REI-RATE.
 14248
 14249
 14250     IF PB-COMPANY-ID EQUAL 'CRI'
 14251        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14252
 14253     IF PB-COMPANY-ID = 'CSL'
 14254         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14255         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14256         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14257         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14258
 14259     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14260        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14261           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14262              PB-I-RATE-DEV-PCT-LF
 14263        END-IF
 14264        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14265                                 TO CP-ALTERNATE-BENEFIT
 14266        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14267        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14268        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14269     END-IF
 14270     IF (PB-COMPANY-ID = 'CID')
 14271        AND (WS-LF-EARNINGS-CALC = 'B')
 14272        AND (CP-STATE-STD-ABBRV = 'MN')
 14273        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14274     ELSE
 14275        MOVE ' '                 TO CP-AH-BALLOON-SW
 14276     END-IF
 14277     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14278     MOVE 'R'                   TO CP-RATE-FILE.
 14279     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14280
 14281     IF (CP-ERROR-RATE-NOT-FOUND)
 14282        and (not pb-monthly-cert)
 14283        IF PB-I-OB
 14284           MOVE ER-2624          TO WS-ERROR
 14285           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14286           GO TO 3340-CALCULATE-PREMIUM-AMT
 14287        ELSE
 14288          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 259
* EL050.cbl
 14289              NEXT SENTENCE
 14290          ELSE
 14291           MOVE ER-2642          TO WS-ERROR
 14292           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14293           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14294
 14295     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14296        CP-ERROR-DIV-BY-ZERO
 14297           MOVE ER-3782          TO WS-ERROR
 14298           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299
 14300     IF PB-COMPANY-ID EQUAL 'CRI'
 14301        IF CP-ERROR-NO-LIMITS-CRI
 14302           IF NOT ACCOUNT-AH-CHECKED
 14303              MOVE ER-2607          TO WS-ERROR
 14304              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14305
 14306     IF ACCOUNT-AH-CHECKED
 14307        NEXT SENTENCE
 14308     ELSE
 14309       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14310          MOVE ER-2640           TO WS-ERROR
 14311          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14312
 14313     IF PB-COMPANY-ID = 'CRI'
 14314         IF WS-ERROR = ER-2640
 14315             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14316     IF ACCOUNT-AH-CHECKED
 14317        CONTINUE
 14318     ELSE
 14319        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14320           AND (CP-R-MAX-ATT-AGE > +0)
 14321           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14322           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14323              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14324              MOVE PB-I-AH-EXPIRE-DT
 14325                                 TO DC-BIN-DATE-2
 14326              MOVE '1'           TO DC-OPTION-CODE
 14327              PERFORM 8500-DATE-CONVERT
 14328                                 THRU 8500-EXIT
 14329              IF NO-CONVERSION-ERROR
 14330                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14331                    MOVE ER-2661       TO WS-ERROR
 14332*                   PERFORM 9900-ERROR-FORMAT
 14333*                                THRU 9900-EXIT
 14334                 END-IF
 14335              END-IF
 14336           ELSE
 14337              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14338              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14339                 MOVE ER-2661    TO WS-ERROR
 14340*                PERFORM 9900-ERROR-FORMAT
 14341*                                THRU 9900-EXIT
 14342              ELSE
 14343                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14344                    MOVE ER-1570 TO WS-ERROR
 14345                    PERFORM 9900-ERROR-FORMAT
 14346                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 260
* EL050.cbl
 14347                 END-IF
 14348              END-IF
 14349           END-IF
 14350           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14351              MOVE PB-I-JOINT-BIRTHDAY
 14352                                    TO DC-BIN-DATE-1
 14353              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14354              MOVE '1'              TO DC-OPTION-CODE
 14355              PERFORM 8500-DATE-CONVERT
 14356                                    THRU 8500-EXIT
 14357              IF NO-CONVERSION-ERROR
 14358                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14359                    MOVE ER-2661       TO WS-ERROR
 14360*                   PERFORM 9900-ERROR-FORMAT
 14361*                                   THRU 9900-EXIT
 14362                 END-IF
 14363              END-IF
 14364           ELSE
 14365              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14366                (PB-I-AH-TERM / 12)
 14367              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14368                 MOVE ER-2661       TO WS-ERROR
 14369*                PERFORM 9900-ERROR-FORMAT
 14370*                                   THRU 9900-EXIT
 14371              ELSE
 14372                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14373                    MOVE ER-1571 TO WS-ERROR
 14374                    PERFORM 9900-ERROR-FORMAT
 14375                                 THRU 9900-EXIT
 14376                 END-IF
 14377              END-IF
 14378           END-IF
 14379           IF WS-ERROR = ER-2661
 14380              PERFORM 9900-ERROR-FORMAT
 14381                                    THRU 9900-EXIT
 14382           END-IF
 14383        END-IF
 14384     END-IF
 14385*    IF ACCOUNT-AH-CHECKED
 14386*       NEXT SENTENCE
 14387*    ELSE
 14388*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14389*          MOVE ER-2661          TO WS-ERROR
 14390*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14391
 14392     IF ACCOUNT-AH-CHECKED
 14393        NEXT SENTENCE
 14394     ELSE
 14395        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14396           MOVE ER-2663          TO WS-ERROR
 14397           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14398
 14399     IF ACCOUNT-AH-CHECKED OR
 14400        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14401         PB-POLICY-IS-VOIDED
 14402        NEXT SENTENCE
 14403     ELSE
 14404        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 261
* EL050.cbl
 14405           MOVE ER-2667            TO WS-ERROR
 14406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14407
 14408     IF PB-COMPANY-ID = 'CRI'
 14409         IF WS-ERROR = ER-2667
 14410             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14411
 14412     IF ACCOUNT-AH-CHECKED
 14413        NEXT SENTENCE
 14414     ELSE
 14415        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14416           MOVE ER-2678            TO WS-ERROR
 14417           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14418
 14419     IF CP-ERROR-RATE-FILE-NOTOPEN
 14420         GO TO 3990-FILES-NOT-OPEN.
 14421
 14422 3321-CONTINUE.
 14423     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14424     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14425     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14426        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14427        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14428                                    PB-I-LF-ALT-PREM-CALC
 14429        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14430     END-IF
 14431     IF PB-COMPANY-ID = 'DCC'
 14432        IF WS-AH-BEN-CATEGORY = 'G'
 14433           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14434           + PB-I-ADDL-CLP)
 14435           * (1 + WS-TOL-CLP-PCT)
 14436*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14437        ELSE
 14438           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14439           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14440*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14441        END-IF
 14442        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14443                                 TO PB-I-AH-PREM-CALC
 14444        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14445           MOVE ER-8152          TO WS-ERROR
 14446           PERFORM 9900-ERROR-FORMAT
 14447                                 THRU 9900-EXIT
 14448        ELSE
 14449           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14450                 PB-I-ADDL-CLP)
 14451              MOVE ER-8148       TO WS-ERROR
 14452              PERFORM 9900-ERROR-FORMAT
 14453                                 THRU 9900-EXIT
 14454           END-IF
 14455        END-IF
 14456     END-IF
 14457     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14458        AND (PB-I-POLICY-IS-MONTHLY)
 14459        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14460        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14461        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14462           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 262
* EL050.cbl
 14463        END-IF
 14464     END-IF
 14465     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14466        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14467        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14468        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14469        MOVE ER-2786             TO WS-ERROR
 14470        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14471     END-IF
 14472     MOVE +0                     TO PB-I-AH-CLP
 14473     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14474        evaluate true
 14475           when WS-AH-BEN-CATEGORY = 'D'
 14476              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14477                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14478           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14479              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14480           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14481              compute ws-cred-union-fees rounded =
 14482                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14483                    pb-i-ah-commission)
 14484              COMPUTE PB-I-AH-CLP =
 14485                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14486        end-evaluate
 14487     END-IF
 14488     MOVE CP-CANCEL-FEE          TO PB-I-CANCEL-FEE
 14489
 14490     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14491         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14492
 14493     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14494         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14495
 14496     if (ws-ah-special-calc-cd = 'E')
 14497        and (pb-monthly-cert)
 14498        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14499     end-if
 14500     IF PB-COMPANY-ID = 'CRI'
 14501         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14502            PB-I-PAYMENT-AMOUNT = ZERO
 14503             NEXT SENTENCE
 14504         ELSE
 14505             COMPUTE PB-I-AH-PREM-CALC =
 14506                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14507                 (CP-PREMIUM-RATE / 100)
 14508             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14509                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14510                                             PB-I-RATE-DEV-PCT-AH.
 14511
 14512     IF (PB-I-AH-RATE  = ZERO)
 14513        and (not pb-monthly-cert)
 14514       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14515           NEXT SENTENCE
 14516       ELSE
 14517         MOVE ER-2642            TO WS-ERROR
 14518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14519
 14520     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 263
* EL050.cbl
 14521     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14522     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14523     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14524     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14525     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14526
 14527     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14528        AND (WS-AH-BEN-CATEGORY = 'G')
 14529        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14530        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14531        IF CP-DEVIATION-CODE NOT = '000'
 14532           MOVE '000'            TO CP-DEVIATION-CODE
 14533           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14534           IF NO-CP-ERROR
 14535              COMPUTE PB-I-DDF-IU-RATE-UP =
 14536              PB-I-AH-CLP - CP-CALC-PREMIUM
 14537           ELSE
 14538              MOVE ER-3057        TO WS-ERROR
 14539              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14540           END-IF
 14541        END-IF
 14542     END-IF
 14543     .
 14544 3335-EDIT-AH-REIN-NSP-RATE.
 14545     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14546        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14547              compute ws-cred-union-fees rounded =
 14548                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14549                    pb-i-ah-commission)
 14550              COMPUTE PB-I-AH-CLP =
 14551                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14552        end-if
 14553     END-IF
 14554     IF AH-REIN-NSP-NOT-USED
 14555         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14556
 14557     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14558     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14559         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14560     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14561     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14562     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14563     MOVE PB-SV-STATE            TO CP-STATE.
 14564     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14565     MOVE ZERO                   TO CP-DEVIATION-CODE
 14566                                    CP-RATE-DEV-PCT.
 14567*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14568     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14569     MOVE '3'                    TO CP-PROCESS-TYPE.
 14570     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14571     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14572                                    CP-RATING-BENEFIT-AMT.
 14573     IF CP-STATE-STD-ABBRV = 'OR'
 14574         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14575                                         PB-I-AH-TERM.
 14576     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14577     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14578     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 264
* EL050.cbl
 14579     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14580     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14581     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14582                                    CP-REMAINING-TERM
 14583                                    WS-WORK-TERM.
 14584     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14585     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 14586        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14587     END-IF
 14588     IF  PB-COMPANY-ID = 'TIC'
 14589         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14590            MOVE ZERO TO CP-CLASS-CODE.
 14591
 14592     IF PB-COMPANY-ID NOT = 'TIC'
 14593          MOVE ZERO          TO CP-CLASS-CODE.
 14594
 14595     MOVE ZERO               TO CP-DEVIATION-CODE.
 14596
 14597     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14598
 14599     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14600
 14601     MOVE 'R'                   TO CP-RATE-FILE.
 14602     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14603
 14604     IF CP-ERROR-RATE-NOT-FOUND
 14605         MOVE ER-2645        TO WS-ERROR
 14606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14607         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14608
 14609     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14610
 14611     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14612     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14613
 14614     IF PB-I-AH-REI-RATE = ZERO
 14615         MOVE ER-2645        TO WS-ERROR
 14616         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14617
 14618
 14619 3340-CALCULATE-PREMIUM-AMT.
 14620
 14621     IF PB-COMPANY-ID = 'NCL'
 14622         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14623             WS-AH-SPECIAL-CALC-CD = 'O')
 14624             GO TO 3999-END-EDIT.
 14625
 14626     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14627                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14628                        'TMS' OR 'GTL' OR 'CID' OR 'DCC' or 'VPP'
 14629                         OR 'AHL'
 14630         NEXT SENTENCE
 14631     ELSE
 14632         IF WS-STATE-ABBREVIATION = 'CT'
 14633             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14634                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14635                 COMPUTE PB-I-LF-PREM-CALC =
 14636                                     PB-I-LF-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 265
* EL050.cbl
 14637                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14638                                     PB-I-LF-ALT-PREM-CALC * .90
 14639                 COMPUTE PB-I-AH-PREM-CALC =
 14640                                     PB-I-AH-PREM-CALC * .90.
 14641
 14642     IF PB-COMP-LF-PREM
 14643        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14644        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14645
 14646     IF PB-COMP-AH-PREM
 14647        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14648
 14649 3340-CHECK-DCC-TOT-FEES.
 14650     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 14651        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14652        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14653        AND (PB-I-POLICY-IS-MONTHLY)
 14654        CONTINUE
 14655     ELSE
 14656        GO TO 3340-EDIT-LF-AH-TOL
 14657     END-IF
 14658     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14659     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14660     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14661        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14662           PB-I-RATE-DEV-PCT-LF
 14663     END-IF
 14664     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14665        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14666           PB-I-RATE-DEV-PCT-AH
 14667     END-IF
 14668     MOVE 'N'                    TO CP-BEN-CATEGORY
 14669     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14670
 14671     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14672     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14673     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14674     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14675     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14676     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14677     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14678     MOVE '3'                    TO CP-PROCESS-TYPE.
 14679     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14680     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14681
 14682     MOVE PB-SV-STATE            TO CP-STATE.
 14683     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14684     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14685     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14686     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14687     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14688                                    CP-RATING-BENEFIT-AMT.
 14689     IF CP-STATE-STD-ABBRV = 'OR'
 14690         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14691                                         PB-I-LF-ALT-BENEFIT-AMT.
 14692     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14693     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14694     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 266
* EL050.cbl
 14695     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14696     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14697     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14698     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14699     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14700     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14701                                    CP-REMAINING-TERM
 14702                                    CP-LOAN-TERM.
 14703     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14704        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14705           PB-I-LF-PREMIUM-AMT
 14706     end-if
 14707
 14708     IF CP-TRUNCATED-LIFE
 14709        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14710
 14711     IF CP-TERM-IS-DAYS
 14712         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14713     ELSE
 14714         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14715
 14716     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14717     IF CP-SPECIAL-CALC-CD = 'H'
 14718         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14719                                    TO CP-ALTERNATE-BENEFIT
 14720         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14721     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14722     MOVE 'R'                    TO CP-RATE-FILE
 14723     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14724     IF NOT CP-ERROR-RATE-NOT-FOUND
 14725        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14726        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14727           AND (CP-BENEFIT-CD (1:1) = 'S')
 14728           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14729                                    PB-I-LF-PREMIUM-AMT
 14730        END-IF
 14731     ELSE
 14732        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14733     END-IF
 14734     .
 14735 3340-EDIT-LF-AH-TOL.
 14736
 14737***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14738***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14739***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14740***
 14741     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14742         PB-I-AH-PREMIUM-AMT
 14743          GIVING WS-CALC-WORK.
 14744
 14745     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14746        AND WS-CALC-WORK NOT = ZERO
 14747         MOVE ER-2649            TO WS-ERROR
 14748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14749
 14750     SUBTRACT PB-I-LF-PREM-CALC
 14751             FROM PB-I-LF-PREMIUM-AMT
 14752                 GIVING WS-UNSIGN-WRK1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 267
* EL050.cbl
 14753
 14754     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14755             FROM PB-I-LF-ALT-PREMIUM-AMT
 14756                 GIVING WS-UNSIGN-WRK4.
 14757
 14758     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14759                                + WS-UNSIGN-WRK4.
 14760
 14761     SUBTRACT PB-I-AH-PREM-CALC
 14762             FROM PB-I-AH-PREMIUM-AMT
 14763                 GIVING WS-UNSIGN-WRK2.
 14764
 14765******************************************************************
 14766*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14767******************************************************************
 14768
 14769     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14770         MOVE ZERO TO WS-UNSIGN-WRK1.
 14771
 14772     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14773         MOVE ZERO TO WS-UNSIGN-WRK2.
 14774
 14775     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14776             GIVING WS-UNSIGN-WRK3.
 14777
 14778 3342-CONTINUE.
 14779
 14780     IF (PB-I-LF-RATE = ZERO  AND
 14781         PB-I-AH-RATE = ZERO)
 14782         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14783            WS-AH-SPECIAL-CALC-CD = 'O'
 14784              NEXT SENTENCE
 14785         ELSE
 14786             GO TO 3345-EDIT-CONTINUE.
 14787
 14788     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14789         NEXT SENTENCE
 14790     ELSE
 14791     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14792        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14793           IF (PB-REISSUED-CERT         OR
 14794               PB-POLICY-IS-DECLINED    OR
 14795               PB-POLICY-IS-VOIDED)
 14796              NEXT SENTENCE
 14797           ELSE
 14798              IF WS-PREM-REJECT-SW = SPACE
 14799                 MOVE ER-2652    TO WS-ERROR
 14800                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14801                 GO TO 3344-CHECK-AH
 14802              ELSE
 14803                 MOVE ER-2650    TO WS-ERROR
 14804                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14805                 GO TO 3344-CHECK-AH.
 14806
 14807***
 14808***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14809***
 14810
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 268
* EL050.cbl
 14811     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14812         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14813            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14814             (1 + WS-TOL-LF-PREM-PCT)
 14815         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14816            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14817             (1 - WS-TOL-LF-PREM-PCT)
 14818     ELSE
 14819         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14820         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14821
 14822***
 14823***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14824***
 14825
 14826     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14827         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14828          WS-TOL-LF-PREM.
 14829
 14830     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14831         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14832          WS-TOL-LF-PREM.
 14833
 14834     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14835        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14836
 14837     IF PB-REISSUED-CERT
 14838        or PB-POLICY-IS-DECLINED
 14839        or PB-POLICY-IS-VOIDED
 14840        continue
 14841     ELSE
 14842        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14843              > WS-TOL-LF-HIGH-PREM-AMT)
 14844           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14845              < WS-TOL-LF-LOW-PREM-AMT))
 14846                      or
 14847           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14848              > WS-TOL-LF-HIGH-PREM-PCT)
 14849           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14850              < WS-TOL-LF-LOW-PREM-PCT))
 14851           IF WS-PREM-REJECT-SW = SPACE
 14852              MOVE ER-2652       TO WS-ERROR
 14853              PERFORM 9900-ERROR-FORMAT
 14854                                 THRU 9900-EXIT
 14855           ELSE
 14856              MOVE ER-2650       TO WS-ERROR
 14857              PERFORM 9900-ERROR-FORMAT
 14858                                 THRU 9900-EXIT
 14859           end-if
 14860        end-if
 14861     end-if
 14862
 14863*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14864*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14865*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14866*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14867
 14868     IF WS-ERROR  =  ER-2650  OR  ER-2652
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 269
* EL050.cbl
 14869        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14870                      OR
 14871           ((PB-COMPANY-ID = 'DCC' or 'VPP')
 14872           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14873           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14874           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14875        END-IF
 14876     END-IF
 14877
 14878     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14879        IF WS-COMP-MAX-CAP GREATER THAN +0
 14880           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14881              IF (PB-REISSUED-CERT         OR
 14882                  PB-POLICY-IS-DECLINED    OR
 14883                  PB-POLICY-IS-VOIDED)
 14884                 NEXT SENTENCE
 14885              ELSE
 14886                  MOVE ER-2646   TO  WS-ERROR
 14887                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14888
 14889 3344-CVL-TOLERANCE-CHECK.
 14890
 14891      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14892          GO TO 3344-CHECK-AH.
 14893
 14894      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14895          GO TO 3344-CHECK-AH.
 14896
 14897      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14898                                     WS-UNSIGN-WRK6.
 14899
 14900      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14901          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14902                                 + PB-I-LF-PREMIUM-AMT
 14903                                 - PB-I-LF-PREM-CALC.
 14904
 14905      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14906          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14907                                 + PB-I-LF-ALT-PREMIUM-AMT
 14908                                 - PB-I-LF-ALT-PREM-CALC.
 14909
 14910      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14911          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14912              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14913                 MOVE ER-2652    TO  WS-ERROR
 14914                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14915              ELSE
 14916                 MOVE ER-2650    TO  WS-ERROR
 14917                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14918
 14919      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14920          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14921              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14922                 MOVE ER-2652    TO  WS-ERROR
 14923                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14924              ELSE
 14925                 MOVE ER-2650    TO  WS-ERROR
 14926                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 270
* EL050.cbl
 14927
 14928 3344-CHECK-AH.
 14929
 14930****************************************************************
 14931***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14932***
 14933
 14934     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14935         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14936             (1 + WS-TOL-AH-PREM-PCT)
 14937         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14938             (1 - WS-TOL-AH-PREM-PCT)
 14939     ELSE
 14940         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14941         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14942
 14943***
 14944***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14945***
 14946
 14947     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14948         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14949
 14950     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14951         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14952
 14953     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14954        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14955
 14956     IF (PB-REISSUED-CERT)
 14957        OR (PB-POLICY-IS-DECLINED)
 14958        OR (PB-POLICY-IS-VOIDED)
 14959        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14960        CONTINUE
 14961     ELSE
 14962        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14963              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14964                          or
 14965           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14966              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14967           IF WS-PREM-REJECT-SW = SPACE
 14968              MOVE ER-3052       TO WS-ERROR
 14969              PERFORM 9900-ERROR-FORMAT
 14970                                 THRU 9900-EXIT
 14971           ELSE
 14972              MOVE ER-3050       TO WS-ERROR
 14973              PERFORM 9900-ERROR-FORMAT
 14974                                 THRU 9900-EXIT
 14975           END-IF
 14976        END-IF
 14977     END-IF
 14978     if (pb-company-id = 'DCC' or 'VPP')
 14979        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14980        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14981        and (pb-i-policy-is-monthly)
 14982        compute ws-tol-ah-high-prem-amt =
 14983           pb-i-tot-fees-calc + ws-tol-ah-prem
 14984        compute ws-tol-ah-low-prem-amt =
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 271
* EL050.cbl
 14985           pb-i-tot-fees-calc - ws-tol-ah-prem
 14986        if ws-tol-ah-prem-pct > zeros
 14987           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14988              (1 + ws-tol-ah-prem-pct)
 14989           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14990              (1 - ws-tol-ah-prem-pct)
 14991        else
 14992           move +9999999.99      to ws-tol-ah-high-prem-pct
 14993           move +0               to ws-tol-ah-low-prem-pct
 14994        end-if
 14995        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14996            or
 14997           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14998                          or
 14999           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 15000           or
 15001           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 15002            move er-3049         to ws-error
 15003           perform 9900-error-format
 15004                                 thru 9900-exit
 15005
 15006        end-if
 15007     end-if
 15008     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 15009         IF  PB-RECORD-BILL   =  'B' OR 'A'
 15010             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 15011             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 15012
 15013     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 15014        IF WS-COMP-MAX-CAP GREATER THAN +0
 15015           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 15016              IF (PB-REISSUED-CERT         OR
 15017                  PB-POLICY-IS-DECLINED    OR
 15018                  PB-POLICY-IS-VOIDED)
 15019                 NEXT SENTENCE
 15020              ELSE
 15021                  MOVE ER-2646   TO  WS-ERROR
 15022                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15023
 15024     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15025        (WS-COMP-MAX-CAP EQUAL +0)
 15026           GO TO 3345-EDIT-CONTINUE.
 15027
 15028     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15029        GREATER THAN WS-COMP-MAX-CAP
 15030           MOVE ER-2646          TO  WS-ERROR
 15031           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15032
 15033 3345-EDIT-CONTINUE.
 15034
 15035*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15036*       IF PB-ENTRY-BATCH   NUMERIC
 15037*          IF PB-ISSUE
 15038*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15039*          ELSE
 15040*              IF PB-CANCELLATION
 15041*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15042
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 272
* EL050.cbl
 15043*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15044*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 15045*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15046*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15047*        ELSE
 15048*            MOVE  ER-1909            TO  WS-ERROR
 15049*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15050
 15051     IF PB-I-POLICY-ACCEPTED
 15052        IF PB-POLICY-IS-DECLINED  OR
 15053           PB-REISSUED-CERT  OR
 15054           PB-REIN-ONLY-CERT  OR
 15055           PB-POLICY-IS-VOIDED
 15056            MOVE  ER-1891         TO  WS-ERROR
 15057            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15058        ELSE
 15059            MOVE SPACE            TO  PB-BATCH-ENTRY
 15060            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15061
 15062     IF PB-I-POLICY-DECLINED
 15063        IF PB-REISSUED-CERT  OR
 15064           PB-REIN-ONLY-CERT  OR
 15065           PB-POLICY-IS-VOIDED
 15066            MOVE  ER-1906         TO  WS-ERROR
 15067            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15068        ELSE
 15069            MOVE  'D'             TO  PB-BATCH-ENTRY
 15070                                      PB-I-ENTRY-STATUS.
 15071
 15072     IF PB-I-NEEDS-UNDERWRITING
 15073        IF PB-POLICY-IS-DECLINED OR
 15074           PB-REISSUED-CERT  OR
 15075           PB-REIN-ONLY-CERT  OR
 15076           PB-POLICY-IS-VOIDED
 15077            MOVE  ER-1907         TO  WS-ERROR
 15078            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15079        ELSE
 15080            MOVE 'U'              TO  PB-BATCH-ENTRY
 15081                                      PB-I-ENTRY-STATUS.
 15082
 15083     IF PB-NEEDS-UNDERWRITING
 15084        MOVE  ER-1901             TO  WS-ERROR
 15085        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15086     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 15087        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15088        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15089        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15090           AND (NOT WS-LF-CASH))
 15091                           OR
 15092           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15093           AND (NOT WS-AH-CASH)))
 15094                       AND
 15095           (PB-I-ENTRY-STATUS NOT = '5')
 15096           MOVE 'M'              TO PB-BATCH-ENTRY
 15097                                    PB-I-ENTRY-STATUS
 15098        END-IF
 15099     END-IF
 15100     move pending-business       to ws-passed-erpndb
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 273
* EL050.cbl
 15101     move ' '                    to ws-exceed-limit-yn
 15102     perform 7780-call-agg       thru 7780-exit
 15103     display ' el050 exceed ' ws-exceed-limit-yn
 15104     if ws-exceed-limit-yn = 'Y'
 15105        MOVE  ER-9813            TO WS-ERROR
 15106        PERFORM  9900-ERROR-FORMAT
 15107                                 THRU 9900-EXIT
 15108     end-if
 15109     IF  PB-COMPANY-ID NOT = 'NCL'
 15110         GO TO 3999-END-EDIT.
 15111
 15112     IF PB-REISSUED-CERT  OR
 15113        PB-POLICY-IS-DECLINED  OR
 15114        PB-POLICY-IS-VOIDED  OR
 15115        PB-I-OB
 15116         GO TO 3999-END-EDIT.
 15117
 15118     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15119         MOVE  ER-2644            TO  WS-ERROR
 15120         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15121         GO TO 3999-END-EDIT.
 15122
 15123     MOVE 'N'                     TO  FORM-MASTER-SW.
 15124     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15125
 15126     IF NOT FORM-MASTER-FOUND
 15127         GO TO 3999-END-EDIT.
 15128
 15129     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15130                                      FORM-MASTER-AH-SW.
 15131
 15132     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15133         MOVE  +1                 TO SUB6
 15134         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15135
 15136     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15137         MOVE  +1                 TO SUB6
 15138         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15139
 15140     IF LF-FORM-MASTER-FOUND  OR
 15141        AH-FORM-MASTER-FOUND
 15142         GO TO 3360-CHECK-FORM-LIMITS
 15143     ELSE
 15144         GO TO 3999-END-EDIT.
 15145
 15146******************************************************************
 15147*                  3350-GET-ERFORM                               *
 15148*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15149*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15150******************************************************************
 15151
 15152 3350-GET-ERFORM.
 15153
 15154     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15155         GO TO  3350-ERFORM-GETMAIN.
 15156
 15157     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15158     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 274
* EL050.cbl
 15159     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15160     MOVE 'Y'                     TO FORM-MASTER-SW.
 15161
 15162     IF PB-CANCELLATION
 15163         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15164            PB-SV-STATE          EQUAL   FO-STATE       AND
 15165            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15166              GO TO 3350-EXIT
 15167         ELSE
 15168             NEXT SENTENCE
 15169     ELSE
 15170         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15171            PB-SV-STATE          EQUAL   FO-STATE       AND
 15172            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15173              GO TO 3350-EXIT.
 15174
 15175 3350-ERFORM-GETMAIN.
 15176
 15177     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15178     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15179
 15180 3350-ERFORM-READ.
 15181
 15182     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15183     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15184     IF PB-CANCELLATION
 15185         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15186     ELSE
 15187         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15188     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15189
 15190     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15191
 15192     IF FORM-MASTER-FOUND
 15193       IF PB-CANCELLATION
 15194          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15195             PB-SV-STATE          EQUAL   FO-STATE       AND
 15196             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15197              GO  TO 3350-EXIT
 15198          ELSE
 15199              NEXT SENTENCE
 15200       ELSE
 15201          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15202             PB-SV-STATE          EQUAL   FO-STATE       AND
 15203             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15204              GO  TO 3350-EXIT.
 15205
 15206     MOVE  'N'                    TO  FORM-MASTER-SW.
 15207     MOVE  ER-1895                TO  WS-ERROR.
 15208     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15209
 15210 3350-EXIT.
 15211      EXIT.
 15212
 15213******************************************************************
 15214*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15215*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15216*   VALID FOR THE POLICY FORM USED.                              *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 275
* EL050.cbl
 15217******************************************************************
 15218
 15219 3355-EDIT-FORM-LF-BENEFITS.
 15220
 15221     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15222        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15223         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15224         GO TO   3355-EXIT.
 15225
 15226     IF  SUB6    LESS THAN   +40
 15227         ADD  +1      TO  SUB6
 15228         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15229
 15230     MOVE  ER-1896         TO  WS-ERROR.
 15231     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15232
 15233 3355-EXIT.
 15234      EXIT.
 15235
 15236******************************************************************
 15237*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15238*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15239*   VALID FOR THE POLICY FORM USED.                              *
 15240******************************************************************
 15241
 15242 3356-EDIT-FORM-AH-BENEFITS.
 15243
 15244     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15245        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15246         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15247         GO TO  3356-EXIT.
 15248
 15249      IF  SUB6    LESS THAN     +40
 15250          ADD  +1      TO  SUB6
 15251          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15252
 15253     MOVE  ER-1897         TO  WS-ERROR.
 15254     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15255
 15256 3356-EXIT.
 15257      EXIT.
 15258
 15259******************************************************************
 15260*                  3357-BENEFIT-SEARCH                           *
 15261*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15262*   CANCELLATIONS ONLY.                                          *
 15263******************************************************************
 15264 3357-BENEFIT-SEARCH.
 15265     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15266         MOVE +1                          TO SUB6
 15267         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15268
 15269     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15270         MOVE +1                          TO SUB6
 15271         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15272
 15273 3357-EXIT.
 15274     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 276
* EL050.cbl
 15275
 15276******************************************************************
 15277*                  3358-BENEFIT-LIFE-SEARCH                      *
 15278*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15279*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15280*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15281******************************************************************
 15282 3358-BENEFIT-LIFE-SEARCH.
 15283     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15284       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15285         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15286           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15287              IF FO-PLAN-REFUND-METHOD (SUB6)
 15288                     IS GREATER THAN SPACES
 15289                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15290                                          WS-LF-REFUND-CALC
 15291                 GO TO 3358-EXIT.
 15292
 15293     IF SUB6 LESS THAN +40
 15294         ADD +1                 TO SUB6
 15295         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15296
 15297 3358-EXIT.
 15298     EXIT.
 15299******************************************************************
 15300*                  3359-BENEFIT-AH-SEARCH                        *
 15301*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15302*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15303*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15304******************************************************************
 15305 3359-BENEFIT-AH-SEARCH.
 15306     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15307       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15308         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15309           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15310              IF FO-PLAN-REFUND-METHOD (SUB6)
 15311                      IS GREATER THAN SPACES
 15312                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15313                                          WS-AH-REFUND-CALC
 15314                 GO TO 3359-EXIT.
 15315
 15316     IF SUB6 LESS THAN +40
 15317         ADD +1                 TO SUB6
 15318         GO TO 3359-BENEFIT-AH-SEARCH.
 15319
 15320 3359-EXIT.
 15321     EXIT.
 15322
 15323******************************************************************
 15324*                  3360-CHECK-FORM-LIMITS                        *
 15325*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15326*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15327******************************************************************
 15328
 15329 3360-CHECK-FORM-LIMITS.
 15330
 15331     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15332         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 277
* EL050.cbl
 15333
 15334     IF NOT LF-FORM-MASTER-FOUND
 15335         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15336
 15337 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15338
 15339     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15340       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15341        WS-LF-JOINT-INDICATOR = 'J'  AND
 15342        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15343         IF PB-COMPANY-ID = 'NCL'
 15344            MOVE  ER-1911          TO  WS-ERROR
 15345            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15346         ELSE
 15347            MOVE  ER-1892          TO  WS-ERROR
 15348            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15349
 15350 3360-CHECK-FORM-LF-ATT-AGE.
 15351
 15352     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15353
 15354     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15355         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15356         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15357            IF PB-COMPANY-ID = 'NCL'
 15358                MOVE  ER-1913      TO  WS-ERROR
 15359                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15360            ELSE
 15361                MOVE  ER-1894      TO  WS-ERROR
 15362                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15363
 15364 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15365
 15366     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15367         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15368         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15369            IF PB-COMPANY-ID = 'NCL'
 15370                MOVE  ER-1914      TO  WS-ERROR
 15371                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15372            ELSE
 15373                MOVE  ER-1899      TO  WS-ERROR
 15374                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15375
 15376 3360-CHECK-FORM-LF-TERM-BAMT.
 15377
 15378     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15379         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15380         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15381           IF  PB-COMPANY-ID = 'NCL'
 15382               MOVE  ER-1916       TO  WS-ERROR
 15383               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15384           ELSE
 15385               MOVE  ER-1902       TO  WS-ERROR
 15386               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15387
 15388     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15389                                    PB-I-LF-ALT-BENEFIT-AMT.
 15390
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 278
* EL050.cbl
 15391     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15392         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15393         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15394             IF  PB-COMPANY-ID = 'NCL'
 15395                 MOVE  ER-1918     TO  WS-ERROR
 15396                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15397             ELSE
 15398                 MOVE  ER-1904     TO  WS-ERROR
 15399                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15400
 15401******************************************************************
 15402*                  3360-CHECK-FORM-AH-LIMITS                     *
 15403*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15404*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15405******************************************************************
 15406
 15407 3360-CHECK-FORM-AH-LIMITS.
 15408
 15409     IF NOT AH-FORM-MASTER-FOUND
 15410         GO TO 3999-END-EDIT.
 15411
 15412 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15413
 15414     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15415       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15416        WS-AH-JOINT-INDICATOR = 'J'  AND
 15417        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15418         IF PB-COMPANY-ID = 'NCL'
 15419            MOVE  ER-1912          TO  WS-ERROR
 15420            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15421         ELSE
 15422            MOVE  ER-1893          TO  WS-ERROR
 15423            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15424
 15425 3360-CHECK-FORM-AH-ATT-AGE.
 15426
 15427     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15428
 15429     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15430         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15431         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15432            IF PB-COMPANY-ID = 'NCL'
 15433                MOVE  ER-1913      TO  WS-ERROR
 15434                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15435            ELSE
 15436                MOVE  ER-1894      TO  WS-ERROR
 15437                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15438
 15439 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15440
 15441     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15442         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15443         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15444            IF PB-COMPANY-ID = 'NCL'
 15445                MOVE  ER-1915      TO  WS-ERROR
 15446                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15447            ELSE
 15448                MOVE  ER-1900      TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 279
* EL050.cbl
 15449                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15450
 15451 3360-CHECK-FORM-AH-TERM-BAMT.
 15452
 15453     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15454         FO-AH-MAX-TERM    GREATER THAN  +0
 15455         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15456             IF  PB-COMPANY-ID = 'NCL'
 15457                 MOVE  ER-1917     TO  WS-ERROR
 15458                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15459             ELSE
 15460                  MOVE  ER-1903    TO  WS-ERROR
 15461                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15462
 15463     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15464         FO-MAX-AH-AMT    GREATER THAN  +0
 15465         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15466             IF  PB-COMPANY-ID = 'NCL'
 15467                 MOVE  ER-1919     TO  WS-ERROR
 15468                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15469             ELSE
 15470                 MOVE  ER-1905     TO  WS-ERROR
 15471                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15472
 15473     GO TO 3999-END-EDIT.
 15474
 15475******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 280
* EL050.cbl
 15477 3400-edit-vin.
 15478
 15479     MOVE PB-I-VIN               TO WS-WORK-VIN
 15480     MOVE +8                     TO V2
 15481     MOVE ZEROS                  TO WS-VIN-TOTAL
 15482     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15483      (V1 > 17)
 15484        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15485           MOVE ER-3825          TO WS-ERROR
 15486           PERFORM 9900-ERROR-FORMAT
 15487                                 THRU 9900-EXIT
 15488        ELSE
 15489           IF V1 = 8
 15490              MOVE 10            TO V2
 15491           END-IF
 15492           IF V1 = 9
 15493              MOVE 0             TO V2
 15494           END-IF
 15495           IF V1 = 10
 15496              MOVE 9             TO V2
 15497           END-IF
 15498           IF WS-WORK-VIN (V1:1) NUMERIC
 15499              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15500               + (WS-WORK-VIN-N (V1) * V2)
 15501           ELSE
 15502              MOVE WS-WORK-VIN (V1:1)
 15503                            TO WS-HEX-BYTE
 15504              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15505              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15506               + (WS-NUM (V3) * V2)
 15507           END-IF
 15508           COMPUTE V2 = V2 - 1
 15509        END-IF
 15510     END-PERFORM
 15511     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15512     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15513        REMAINDER WS-VIN-REMAINDER
 15514     IF ((WS-WORK-VIN (9:1) = 'X')
 15515        AND (WS-VIN-REMAINDER = 10))
 15516                OR
 15517        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15518        CONTINUE
 15519     ELSE
 15520        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15521           MOVE ER-3826          TO WS-ERROR
 15522           PERFORM 9900-ERROR-FORMAT
 15523                                 THRU 9900-EXIT
 15524        ELSE
 15525           MOVE ER-3827          TO WS-ERROR
 15526           PERFORM 9900-ERROR-FORMAT
 15527                                 THRU 9900-EXIT
 15528        END-IF
 15529     END-IF
 15530
 15531     .
 15532 3400-exit.
 15533     exit.
 15534******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 281
* EL050.cbl
 15535*                  E D I T   C A N C E L                         *
 15536******************************************************************
 15537
 15538 3700-EDIT-CANCEL.
 15539     IF PB-COMPANY-ID = 'DMD'
 15540         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15541                                         WS-RES-MUNI-TAX
 15542                                         PB-CI-STATE-TAX
 15543                                         PB-CI-MUNI-TAX
 15544         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15545
 15546*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15547*       IF PB-ENTRY-BATCH  NUMERIC
 15548*          IF PB-CANCELLATION
 15549*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15550*          ELSE
 15551*             IF PB-ISSUE
 15552*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15553
 15554     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15555        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15556     END-IF
 15557*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15558*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15559
 15560     IF CM-ENTRY-STATUS = 'V'
 15561        MOVE ER-2780             TO WS-ERROR
 15562        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15563        GO TO 3999-END-EDIT.
 15564
 15565     IF CM-ENTRY-STATUS = 'D'
 15566        MOVE ER-2781             TO WS-ERROR
 15567        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15568        GO TO 3999-END-EDIT.
 15569
 15570     IF CM-ENTRY-STATUS = 'U'
 15571        MOVE ER-2782             TO WS-ERROR
 15572        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15573
 15574***************************************************************
 15575*                                                             *
 15576*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15577*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15578*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15579*   OF ANOTHER COVERAGE.                                      *
 15580*                                                             *
 15581***************************************************************
 15582
 15583     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15584                                    PB-C-AH-CANCEL-VOID-SW.
 15585
 15586     IF PB-C-LF-CANCEL-AMT = ZERO
 15587        NEXT SENTENCE
 15588     ELSE
 15589        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15590           AND
 15591           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15592               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 282
* EL050.cbl
 15593               MOVE ER-2745           TO WS-ERROR
 15594               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15595
 15596     IF PB-C-AH-CANCEL-AMT = ZERO
 15597        NEXT SENTENCE
 15598     ELSE
 15599        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15600           AND
 15601           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15602               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15603               MOVE ER-2745           TO WS-ERROR
 15604               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15605
 15606     IF WS-LF-EARNINGS-CALC = '4'
 15607        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15608
 15609     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15610     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15611     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15612     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15613     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15614     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15615
 15616     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15617                                      PB-C-AH-REF-CALC.
 15618     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15619
 15620******************************************************************
 15621*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15622*             TO VALIDATE COVERAGE.                              *
 15623******************************************************************
 15624
 15625     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15626        PB-C-LF-CANCEL-AMT = ZEROS
 15627          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15628      ELSE
 15629          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15630
 15631     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15632        PB-C-AH-CANCEL-AMT = ZEROS
 15633          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15634      ELSE
 15635          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15636
 15637     EVALUATE TRUE
 15638         WHEN PB-CANCEL-FORCE             OR
 15639              PB-CANCEL-DATE-FORCED       OR
 15640              PB-FORCE-OFF
 15641                  IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15642                     MOVE CM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15643                  END-IF
 15644         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15645               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15646              (PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP')
 15647                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15648         WHEN OTHER
 15649              IF PB-COMPANY-ID = 'ACE' or 'DCC' or 'VPP'
 15650                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 283
* EL050.cbl
 15651              ELSE
 15652                 MOVE ER-2749              TO WS-ERROR
 15653              END-IF
 15654              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15655     END-EVALUATE.
 15656
 15657
 15658*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15659*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15660*            MOVE  ER-1909            TO  WS-ERROR
 15661*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15662*        ELSE
 15663*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15664
 15665     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15666     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15667        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15668     ELSE
 15669        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15670     END-IF
 15671     .
 15672 3705-EDIT-CANCEL-DT.
 15673
 15674     IF LF-COVERAGE-CANCELLED
 15675        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15676         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15677         MOVE WS-CURRENT-MONTH-END
 15678                                 TO DC-BIN-DATE-2
 15679         SET ELAPSED-BETWEEN-BIN TO TRUE
 15680*        MOVE 1                  TO DC-OPTION-CODE
 15681         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15682         IF DATE-CONVERSION-ERROR
 15683            NEXT SENTENCE
 15684          ELSE
 15685             IF DC-ELAPSED-DAYS GREATER +180
 15686                IF PB-CANCEL-DATE-FORCED  OR
 15687                   PB-CANCEL-DATE-FORCED-NO-FEE
 15688                      MOVE ER-2751  TO WS-ERROR
 15689                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15690                 ELSE
 15691                   MOVE ER-2752  TO WS-ERROR
 15692                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15693
 15694     IF AH-COVERAGE-CANCELLED
 15695        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15696         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15697         MOVE WS-CURRENT-MONTH-END
 15698                                 TO DC-BIN-DATE-2
 15699         SET ELAPSED-BETWEEN-BIN TO TRUE
 15700*        MOVE 1                  TO DC-OPTION-CODE
 15701         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15702         IF DATE-CONVERSION-ERROR
 15703            NEXT SENTENCE
 15704          ELSE
 15705             IF DC-ELAPSED-DAYS GREATER +180
 15706                IF PB-CANCEL-DATE-FORCED OR
 15707                   PB-CANCEL-DATE-FORCED-NO-FEE
 15708                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 284
* EL050.cbl
 15709                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15710                 ELSE
 15711                   MOVE ER-2752  TO WS-ERROR
 15712                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15713
 15714     IF WS-ERROR = ER-2752
 15715        AND (PB-COMPANY-ID = 'ABL'
 15716         OR  PB-COMPANY-ID = 'FGL'
 15717         OR  PB-COMPANY-ID = 'IST'
 15718         OR  PB-COMPANY-ID = 'JHL'
 15719         OR  PB-COMPANY-ID = 'LAP'
 15720         OR  PB-COMPANY-ID = 'LBL'
 15721         OR  PB-COMPANY-ID = 'NCB'
 15722         OR  PB-COMPANY-ID = 'NLI'
 15723         OR  PB-COMPANY-ID = 'OFI'
 15724         OR  PB-COMPANY-ID = 'PLI'
 15725         OR  PB-COMPANY-ID = 'TAO'
 15726         OR  PB-COMPANY-ID = 'TIC'
 15727         OR  PB-COMPANY-ID = 'HER'
 15728         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15729         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15730            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15731            MOVE ER-2762     TO WS-ERROR
 15732            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15733
 15734     IF LF-COVERAGE-CANCELLED
 15735        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15736        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15737             MOVE ER-2733         TO WS-ERROR
 15738             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15739
 15740     IF AH-COVERAGE-CANCELLED
 15741        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15742        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15743              MOVE ER-2733        TO WS-ERROR
 15744              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15745
 15746     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15747        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15748        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15749           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15750            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15751              IF PB-COMPANY-ID NOT = 'LAP'
 15752               MOVE ER-2704            TO WS-ERROR
 15753               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15754
 15755     IF CERT-WAS-NOT-FOUND
 15756         GO TO 3999-END-EDIT.
 15757
 15758     IF PB-COMPANY-ID EQUAL 'CDC'
 15759        IF LF-COVERAGE-CANCELLED
 15760           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15761            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15762            MOVE PB-C-LF-CANCEL-DT
 15763                                 TO DC-BIN-DATE-2
 15764            SET ELAPSED-BETWEEN-BIN TO TRUE
 15765*           MOVE 1               TO DC-OPTION-CODE
 15766            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 285
* EL050.cbl
 15767            IF DATE-CONVERSION-ERROR
 15768               NEXT SENTENCE
 15769             ELSE
 15770                IF DC-ELAPSED-DAYS GREATER +60
 15771                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15772
 15773     IF PB-COMPANY-ID EQUAL 'CDC'
 15774        IF AH-COVERAGE-CANCELLED
 15775           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15776            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15777            MOVE PB-C-AH-CANCEL-DT
 15778                                 TO DC-BIN-DATE-2
 15779            MOVE +0              TO DC-ELAPSED-DAYS
 15780                                    DC-ELAPSED-MONTHS
 15781            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15782*           MOVE 1               TO DC-OPTION-CODE
 15783            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15784            IF DATE-CONVERSION-ERROR
 15785               NEXT SENTENCE
 15786             ELSE
 15787                IF DC-ELAPSED-DAYS GREATER +60
 15788                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15789
 15790     MOVE +0                     TO DC-ELAPSED-DAYS
 15791                                    DC-ELAPSED-MONTHS.
 15792
 15793     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15794        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15795          MOVE 'Z'                TO PB-CI-OB-FLAG
 15796          MOVE ER-2767            TO WS-ERROR
 15797          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15798          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15799          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15800          GO TO 3775-OVER-REF-CHK
 15801        ELSE
 15802          MOVE ZEROS              TO PB-CI-LIVES
 15803                                     PB-C-LIVES
 15804          IF PB-CI-OB-FLAG NOT = 'B'
 15805             MOVE SPACE           TO PB-CI-OB-FLAG.
 15806
 15807     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15808         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15809     ELSE
 15810         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15811
 15812     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15813        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15814            MOVE ER-2760         TO WS-ERROR
 15815            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15816
 15817     IF LF-COVERAGE-CANCELLED
 15818        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15819         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15820            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15821               MOVE ER-2774       TO WS-ERROR
 15822               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15823
 15824     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 286
* EL050.cbl
 15825        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15826         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15827            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15828               MOVE ER-2775       TO WS-ERROR
 15829               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15830
 15831     IF LF-COVERAGE-CANCELLED
 15832        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15833         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15834            MOVE ER-2776         TO WS-ERROR
 15835            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15836
 15837     IF AH-COVERAGE-CANCELLED
 15838        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15839         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15840            MOVE ER-2777         TO WS-ERROR
 15841            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15842
 15843     IF LF-COVERAGE-CANCELLED
 15844        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15845        if pb-ci-lf-expire-dt = low-values or spaces
 15846           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15847           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15848           MOVE PB-CI-EXTENTION-DAYS
 15849                                 TO DC-ELAPSED-DAYS
 15850           SET BIN-PLUS-ELAPSED  TO TRUE
 15851           PERFORM 8500-DATE-CONVERT
 15852                                 THRU 8500-EXIT
 15853           IF DATE-CONVERSION-ERROR
 15854              move low-values    to dc-bin-date-2
 15855           end-if
 15856        else
 15857           move pb-ci-lf-expire-dt
 15858                                 to dc-bin-date-2
 15859        end-if
 15860        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15861           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15862                             OR  'FIA'
 15863              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15864           ELSE
 15865              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15866              MOVE ER-2731       TO WS-ERROR
 15867              PERFORM 9900-ERROR-FORMAT
 15868                                 THRU 9900-EXIT
 15869           end-if
 15870        end-if
 15871     end-if
 15872*    IF LF-COVERAGE-CANCELLED
 15873*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15874*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15875*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15876*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15877*        SET BIN-PLUS-ELAPSED      TO TRUE
 15878*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15879*        IF DATE-CONVERSION-ERROR
 15880*           NEXT SENTENCE
 15881*         ELSE
 15882*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 287
* EL050.cbl
 15883*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15884*                            OR  'FIA'
 15885*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15886*              ELSE
 15887*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15888*               MOVE ER-2731       TO WS-ERROR
 15889*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15890     .
 15891 3705-EDIT-AH-CANCEL-DT.
 15892     IF AH-COVERAGE-CANCELLED
 15893        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15894        if pb-ci-AH-expire-dt = low-values or spaces
 15895           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15896           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15897           MOVE PB-CI-EXTENTION-DAYS
 15898                                 TO DC-ELAPSED-DAYS
 15899           SET BIN-PLUS-ELAPSED  TO TRUE
 15900           PERFORM 8500-DATE-CONVERT
 15901                                 THRU 8500-EXIT
 15902           IF DATE-CONVERSION-ERROR
 15903              move low-values    to dc-bin-date-2
 15904           end-if
 15905        else
 15906           move pb-ci-ah-expire-dt
 15907                                 to dc-bin-date-2
 15908        end-if
 15909        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15910           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15911                             OR  'FIA'
 15912              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15913           ELSE
 15914              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15915              MOVE ER-2771       TO WS-ERROR
 15916              PERFORM 9900-ERROR-FORMAT
 15917                                 THRU 9900-EXIT
 15918           end-if
 15919        end-if
 15920     end-if
 15921*    IF AH-COVERAGE-CANCELLED
 15922*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15923*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15924*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15925*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15926**       MOVE 6                    TO DC-OPTION-CODE
 15927*        SET BIN-PLUS-ELAPSED      TO TRUE
 15928*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15929*        IF DATE-CONVERSION-ERROR
 15930*           NEXT SENTENCE
 15931*         ELSE
 15932*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15933*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15934*                             OR 'FIA'
 15935*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15936*             ELSE
 15937*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15938*              MOVE ER-2771       TO WS-ERROR
 15939*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15940     .
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 288
* EL050.cbl
 15941 3705-EDIT-CONTINUED.
 15942
 15943*    IF LF-COVERAGE-CANCELLED
 15944*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15945*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15946*            MOVE ER-2727         TO WS-ERROR
 15947*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15948*
 15949*    IF AH-COVERAGE-CANCELLED
 15950*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15951*        IF PB-COMPANY-ID = 'ACE'
 15952*           MOVE ER-2727        TO WS-ERROR
 15953*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15954*        ELSE
 15955*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15956*              MOVE ER-2727     TO WS-ERROR
 15957*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15958
 15959     IF PB-COMPANY-ID = 'ACE'
 15960       IF AH-COVERAGE-CANCELLED
 15961         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15962           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15963              MOVE ER-2732      TO WS-ERROR
 15964              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15965
 15966     IF PB-COMPANY-ID      EQUAL   'HER'
 15967        IF WS-ERROR        EQUAL   ER-2727
 15968            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15969            MOVE  ER-2725          TO  WS-ERROR
 15970            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15971
 15972     IF PB-C-CLAIM-CREATED-CANCEL
 15973            MOVE ER-2748         TO WS-ERROR
 15974            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15975
 15976     IF PB-C-LAST-NAME NOT = SPACES
 15977         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15978            MOVE ER-2747         TO WS-ERROR
 15979            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15980
 15981 3710-EDIT-LUMP-SUM-PRIOR.
 15982
 15983     IF AH-COVERAGE-CANCELLED
 15984         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15985             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15986                MOVE ER-2735    TO WS-ERROR
 15987                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15988
 15989     IF LF-COVERAGE-CANCELLED
 15990         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15991             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15992                MOVE ER-2735    TO WS-ERROR
 15993                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15994
 15995 3710-EDIT-PRIOR-DEATH.
 15996
 15997*    IF LF-COVERAGE-CANCELLED
 15998*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 289
* EL050.cbl
 15999*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16000*           (NOT PB-CI-OB)
 16001*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 16002*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 16003*                   MOVE ER-2732  TO WS-ERROR
 16004*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16005*
 16006*    IF AH-COVERAGE-CANCELLED
 16007*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 16008*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 16009*           (NOT PB-CI-OB)
 16010*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 16011*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 16012*                   MOVE ER-2732  TO WS-ERROR
 16013*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16014
 16015     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 16016         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16017            (NOT PB-COMP-LF-CANCEL)
 16018             NEXT SENTENCE
 16019         ELSE
 16020           IF PB-C-LF-CANCEL-VOIDED
 16021              NEXT SENTENCE
 16022           ELSE
 16023              MOVE ER-2753      TO WS-ERROR
 16024              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16025
 16026     IF CANCEL-FUTURE-DT
 16027         GO TO 3999-END-EDIT.
 16028
 16029 3715-GET-REMAIN-TERM-LF.
 16030
 16031     IF NO-LF-BENEFIT-MATCH  OR
 16032        WS-LF-BENEFIT-CD = ZEROS
 16033        GO TO 3730-GET-AH-REMAIN-TERM.
 16034
 16035     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16036     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16037     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16038     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16039     MOVE PB-SV-STATE            TO CP-STATE.
 16040     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16041     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16042     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16043     MOVE '2'                    TO CP-PROCESS-TYPE.
 16044     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16045     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16046     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16047     IF (PB-COMPANY-ID = 'CID')
 16048        AND (CP-STATE-STD-ABBRV = 'WI')
 16049        MOVE '7'                 TO CP-REM-TERM-METHOD
 16050        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16051     ELSE
 16052        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16053        MOVE WS-REM-TRM-CALC-OPTION
 16054                                 TO CP-REM-TRM-CALC-OPTION
 16055     END-IF
 16056**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 290
* EL050.cbl
 16057     IF (PB-COMPANY-ID = 'CID')
 16058        AND (CP-STATE-STD-ABBRV = 'MO')
 16059        AND (PB-CERT-EFF-DT >= X'9B41')
 16060        AND (PB-CERT-EFF-DT <= X'A2FB')
 16061        MOVE '7'                 TO CP-REM-TERM-METHOD
 16062        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16063     END-IF
 16064     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16065                                    CP-LOAN-TERM.
 16066     IF CP-TRUNCATED-LIFE
 16067        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16068
 16069     IF CP-TERM-IS-DAYS
 16070         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16071     ELSE
 16072         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16073
 16074     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16075
 16076     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16077
 16078     IF LF-COVERAGE-CANCELLED
 16079        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16080        NEXT SENTENCE
 16081      ELSE
 16082          GO TO 3730-GET-AH-REMAIN-TERM.
 16083
 16084 3720-GET-LF-REFUND.
 16085
 16086     IF PB-C-LF-CANCEL-VOIDED
 16087        GO TO 3730-GET-AH-REMAIN-TERM
 16088     end-if
 16089
 16090     IF PB-COMPANY-ID EQUAL 'BOA'
 16091         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16092         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16093         GO TO 3730-GET-AH-REMAIN-TERM.
 16094
 16095     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16096        (WS-AH-SPECIAL-CALC-CD = 'M')
 16097         MOVE ER-2767            TO WS-ERROR
 16098         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16099         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16100         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16101         GO TO 3780-UPDATE-CANCEL-CERT.
 16102
 16103*    if (ws-lf-earnings-calc = '6')
 16104*       or (pb-c-lf-refund-override = '6')
 16105*       move cp-remaining-term-1 to cp-remaining-term-2
 16106*    end-if
 16107     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16108
 16109     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16110     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16111     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16112     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16113     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16114     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 291
* EL050.cbl
 16115     IF PB-COMPANY-ID = 'DCC'
 16116        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16117        IF PDEF-MASTER-FOUND
 16118           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16119              (V1 > +8)
 16120              OR (PD-PROD-CODE (V1) = 'L')
 16121           END-PERFORM
 16122           IF V1 < +9
 16123              MOVE PD-MAX-AMT (V1)
 16124                           TO CP-R-MAX-TOT-BEN
 16125                              EC-AM-LF-MAX-TOT-BEN
 16126           END-IF
 16127        ELSE
 16128        MOVE ' '                 TO PDEF-MASTER-SW
 16129        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16130        MOVE PB-STATE            TO ERPDEF-STATE
 16131        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16132           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16133        END-IF
 16134        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16135        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16136        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16137        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16138        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16139        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16140        IF PDEF-MASTER-FOUND
 16141           MOVE 'N'              TO PDEF-MASTER-SW
 16142           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16143           IF PDEF-MASTER-FOUND
 16144              IF (ERPDEF-KEY-SAVE (1:16) =
 16145                           PD-CONTROL-PRIMARY (1:16))
 16146                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16147                 CONTINUE
 16148              ELSE
 16149                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16150                 IF (ERPDEF-KEY-SAVE (1:16) =
 16151                           PD-CONTROL-PRIMARY (1:16))
 16152                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16153                    CONTINUE
 16154                 ELSE
 16155                    MOVE 'N'     TO PDEF-MASTER-SW
 16156                 END-IF
 16157              END-IF
 16158
 16159              IF PDEF-MASTER-FOUND
 16160                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16161                    (V1 > +8)
 16162                    OR (PD-PROD-CODE (V1) = 'L')
 16163                 END-PERFORM
 16164                 IF V1 < +9
 16165                    MOVE PD-MAX-AMT (V1)
 16166                                 TO CP-R-MAX-TOT-BEN
 16167                                    EC-AM-LF-MAX-TOT-BEN
 16168                 END-IF
 16169              END-IF
 16170           END-IF
 16171           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16172        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 292
* EL050.cbl
 16173        END-IF
 16174     END-IF
 16175     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16176
 16177     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16178
 16179     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16180                                    PB-C-LF-REM-TERM.
 16181
 16182     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16183     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16184
 16185     IF PB-COMPANY-ID EQUAL 'FLC'
 16186        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16187           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16188           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16189                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16190                    - CM-LF-ITD-DEATH-AMT
 16191           IF PB-C-LF-REF-CALC LESS THAN +0
 16192              MOVE +0            TO PB-C-LF-REF-CALC
 16193              GO TO 3730-GET-AH-REMAIN-TERM
 16194           ELSE
 16195              GO TO 3730-GET-AH-REMAIN-TERM.
 16196
 16197     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16198                            OR '4' OR '5' OR '6' OR '8'
 16199                            OR '9' OR 'G'
 16200        MOVE PB-C-LF-REFUND-OVERRIDE
 16201                                 TO CP-EARNING-METHOD.
 16202
 16203     if pb-company-id = 'AHL'
 16204        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16205        if cp-class-code = spaces
 16206           move zeros            to cp-class-code
 16207        end-if
 16208     ELSE
 16209        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16210     END-IF
 16211*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16212     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16213     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16214                                    CP-RATING-BENEFIT-AMT.
 16215     IF CP-STATE-STD-ABBRV = 'OR'
 16216         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16217                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16218     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16219     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16220     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16221     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16222     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16223     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16224     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16225     IF WS-DEFAULT-APR NOT NUMERIC
 16226         MOVE ZEROS TO WS-DEFAULT-APR.
 16227****   N O T E   ****
 16228*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16229*      THE OH HARD CODING IN ELCRFNDP
 16230
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 293
* EL050.cbl
 16231     IF PB-COMPANY-ID = 'CID'
 16232        IF CP-STATE-STD-ABBRV = 'OH'
 16233           MOVE WS-LF-EARNINGS-CALC
 16234                                 TO CP-EARNING-METHOD
 16235        END-IF
 16236     END-IF
 16237
 16238****   N O T E   ****
 16239
 16240     IF CP-EARN-AS-NET-PAY
 16241         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16242            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16243                MOVE WS-DEFAULT-APR
 16244                                 TO  CP-LOAN-APR
 16245                MOVE ER-3780     TO  WS-ERROR
 16246                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16247            ELSE
 16248                MOVE ER-3781     TO  WS-ERROR
 16249                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16250*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16251     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16252
 16253     IF CP-REFUND-TYPE-USED NOT = SPACE
 16254         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16255
 16256     IF CP-ERROR-RATE-IS-ZERO OR
 16257        CP-ERROR-RATE-NOT-FOUND
 16258        MOVE ER-2740             TO WS-ERROR
 16259        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16260
 16261     IF CP-ERROR-RATE-FILE-NOTOPEN
 16262        MOVE ER-2617             TO WS-ERROR
 16263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16264
 16265     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16266        AND PB-CI-ENTRY-STATUS = 'M'
 16267        MOVE +0                  TO PB-C-LF-REF-CALC
 16268     ELSE
 16269        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16270     END-IF
 16271
 16272     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16273         GO TO 3730-GET-AH-REMAIN-TERM.
 16274
 16275*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16276*       ADD +1                   TO PB-C-LF-REM-TERM
 16277*                                   CP-REMAINING-TERM
 16278*                                   CP-ORIGINAL-TERM.
 16279
 16280     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16281     MOVE '2'                    TO CP-EARNING-METHOD
 16282                                    CP-RATING-METHOD.
 16283     IF PB-COMPANY-ID = 'CID'
 16284        IF (CP-STATE-STD-ABBRV = 'MN')
 16285           AND (PB-CERT-EFF-DT > X'A4FF')
 16286           AND (WS-LF-EARNINGS-CALC = 'B')
 16287           MOVE '5'              TO CP-EARNING-METHOD
 16288           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 294
* EL050.cbl
 16289        END-IF
 16290     END-IF
 16291     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16292                                        CP-REMAINING-BENEFIT
 16293                                        CP-RATING-BENEFIT-AMT.
 16294     IF CP-STATE-STD-ABBRV = 'OR'
 16295         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16296                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16297     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16298     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16299
 16300     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16301
 16302     IF CP-ERROR-RATE-IS-ZERO OR
 16303        CP-ERROR-RATE-NOT-FOUND
 16304        MOVE ER-2740             TO WS-ERROR
 16305        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16306
 16307     IF CP-ERROR-RATE-FILE-NOTOPEN
 16308        MOVE ER-2617             TO WS-ERROR
 16309        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16310
 16311     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16312
 16313******************************************************************
 16314
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 295
* EL050.cbl
 16316 3730-GET-AH-REMAIN-TERM.
 16317     IF NO-AH-BENEFIT-MATCH  OR
 16318        WS-AH-BENEFIT-CD = ZEROS
 16319         GO TO 3770-CHECK-REFUNDS.
 16320
 16321     IF PB-CI-AH-LUMP-SUM-DISAB
 16322         IF  PB-C-AH-CANCEL-AMT = ZERO
 16323            IF NOT PB-COMP-AH-CANCEL
 16324             GO TO 3770-CHECK-REFUNDS.
 16325
 16326     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16327     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16328     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16329     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16330     MOVE PB-SV-STATE            TO CP-STATE.
 16331     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16332     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16333     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16334     MOVE '2'                    TO CP-PROCESS-TYPE.
 16335     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16336     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16337     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16338     IF (PB-COMPANY-ID = 'CID')
 16339        AND (CP-STATE-STD-ABBRV = 'WI')
 16340        MOVE '7'                 TO CP-REM-TERM-METHOD
 16341        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16342     ELSE
 16343        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16344        MOVE WS-REM-TRM-CALC-OPTION
 16345                                 TO CP-REM-TRM-CALC-OPTION
 16346     END-IF
 16347     IF (PB-COMPANY-ID = 'CID')
 16348        AND (CP-STATE-STD-ABBRV = 'MO')
 16349        AND (PB-CERT-EFF-DT >= X'9B41')
 16350        AND (PB-CERT-EFF-DT <= X'A2FB')
 16351        MOVE '7'                 TO CP-REM-TERM-METHOD
 16352        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16353     END-IF
 16354     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16355                                    CP-LOAN-TERM.
 16356     IF NOT CP-TERM-IS-DAYS
 16357         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16358
 16359     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16360
 16361     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16362
 16363     IF AH-COVERAGE-CANCELLED
 16364        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16365        NEXT SENTENCE
 16366      ELSE
 16367         GO TO 3770-CHECK-REFUNDS.
 16368
 16369 3740-GET-AH-REFUND.
 16370
 16371     IF PB-C-AH-CANCEL-VOIDED
 16372        GO TO 3780-UPDATE-CANCEL-CERT
 16373     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 296
* EL050.cbl
 16374
 16375     IF PB-COMPANY-ID = 'BOA'
 16376         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16377         GO TO 3770-CHECK-REFUNDS.
 16378
 16379     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16380*    MOVE ' '                    TO DC-OPTION-CODE
 16381     SET BIN-TO-GREG             TO TRUE
 16382     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16383     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16384                                    PB-C-AH-REM-TERM.
 16385     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16386     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16387
 16388     IF PB-COMPANY-ID EQUAL 'FLC'
 16389        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16390           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16391           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16392                    - CM-AH-ITD-AH-PMT)
 16393           IF PB-C-AH-REF-CALC LESS THAN +0
 16394              MOVE +0            TO PB-C-AH-REF-CALC
 16395              GO TO 3770-CHECK-REFUNDS
 16396           ELSE
 16397              GO TO 3770-CHECK-REFUNDS.
 16398
 16399     IF PB-COMPANY-ID = 'DCC'
 16400        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16401            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16402           MOVE 'S'              TO CP-EARNING-METHOD
 16403        END-IF
 16404     END-IF
 16405     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16406                            OR '4' OR '5' OR '6' OR '8'
 16407                            OR '9' OR 'G' OR 'S'
 16408        MOVE PB-C-AH-REFUND-OVERRIDE
 16409                                 TO CP-EARNING-METHOD.
 16410
 16411     if pb-company-id = 'AHL'
 16412        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16413        if cp-class-code = spaces
 16414           move zeros            to cp-class-code
 16415        end-if
 16416     ELSE
 16417        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16418     END-IF
 16419*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16420     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16421     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16422                                    CP-RATING-BENEFIT-AMT.
 16423     IF CP-STATE-STD-ABBRV = 'OR'
 16424         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16425                                         PB-CI-AH-TERM.
 16426     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16427     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16428     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16429     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16430     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16431     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 297
* EL050.cbl
 16432
 16433     IF CP-STATE-STD-ABBRV = 'OH'
 16434        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16435                                AND 'CID' AND 'DCC' and 'VPP'
 16436                                AND 'AHL')
 16437           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16438              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16439              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16440              MOVE '6' TO CP-EARNING-METHOD
 16441           END-IF
 16442        END-IF
 16443        IF PB-COMPANY-ID = 'CID'
 16444           IF NO-LIFE-COVERAGE
 16445              IF CP-CRITICAL-PERIOD
 16446                 MOVE '2'       TO CP-EARNING-METHOD
 16447              ELSE
 16448                 MOVE '6'       TO CP-EARNING-METHOD
 16449              END-IF
 16450           ELSE
 16451              IF WS-LF-COVERAGE-TYPE = 'L'
 16452                 MOVE '2'       TO CP-EARNING-METHOD
 16453              ELSE
 16454                 IF (PB-CI-LF-TERM > +60) OR
 16455                    (WS-LF-EARNINGS-CALC = '5')
 16456                    IF CP-CRITICAL-PERIOD
 16457                       MOVE '2'  TO CP-EARNING-METHOD
 16458                    ELSE
 16459                       MOVE '6'  TO CP-EARNING-METHOD
 16460                    END-IF
 16461                 ELSE
 16462                    MOVE '1'     TO CP-EARNING-METHOD
 16463                 END-IF
 16464              END-IF
 16465           END-IF
 16466        END-IF
 16467     END-IF
 16468
 16469*    IF CP-STATE-STD-ABBRV = 'VA'
 16470*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16471*          IF CP-ORIGINAL-TERM GREATER 61
 16472*             MOVE '6' TO CP-EARNING-METHOD
 16473*          ELSE
 16474*             MOVE '1' TO CP-EARNING-METHOD.
 16475
 16476     IF WS-DEFAULT-APR NOT NUMERIC
 16477         MOVE ZEROS TO WS-DEFAULT-APR.
 16478     IF CP-EARN-AS-NET-PAY
 16479         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16480            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16481                MOVE WS-DEFAULT-APR
 16482                                 TO  CP-LOAN-APR
 16483                MOVE ER-3780     TO  WS-ERROR
 16484                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16485            ELSE
 16486                MOVE ER-3781     TO  WS-ERROR
 16487                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16488     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16489     IF PB-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 298
* EL050.cbl
 16490        AND CP-CANCEL-REASON = 'R'
 16491        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16492        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16493     END-IF
 16494     IF PB-COMPANY-ID = 'DCC'
 16495        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16496        AND (CP-EARNING-METHOD = 'D')
 16497        AND (CP-CANCEL-REASON NOT = 'R')
 16498        CONTINUE
 16499     ELSE
 16500        GO TO 3750-CONTINUE
 16501     END-IF
 16502     MOVE ' '                    TO DD-IU-SW
 16503     IF NOT PDEF-MASTER-FOUND
 16504        MOVE ' '                 TO PDEF-MASTER-SW
 16505        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16506        MOVE PB-STATE            TO ERPDEF-STATE
 16507        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16508           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16509        END-IF
 16510        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16511        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16512        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16513        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16514        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16515        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16516        IF PDEF-MASTER-FOUND
 16517           MOVE 'N'              TO PDEF-MASTER-SW
 16518           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16519           IF PDEF-MASTER-FOUND
 16520              IF (ERPDEF-KEY-SAVE (1:16) =
 16521                           PD-CONTROL-PRIMARY (1:16))
 16522                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16523                 CONTINUE
 16524              ELSE
 16525                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16526                 IF (ERPDEF-KEY-SAVE (1:16) =
 16527                           PD-CONTROL-PRIMARY (1:16))
 16528                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16529                    CONTINUE
 16530                 ELSE
 16531                    MOVE ER-2740 TO WS-ERROR
 16532                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16533                    GO TO 3770-CHECK-REFUNDS
 16534                 END-IF
 16535              END-IF
 16536           END-IF
 16537           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16538        END-IF
 16539     END-IF
 16540     IF PDEF-MASTER-FOUND
 16541        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16542           (V1 > +8)
 16543           OR (PD-PROD-CODE (V1) = 'I')
 16544        END-PERFORM
 16545        IF V1 < +9
 16546           SET DD-IU-PRESENT        TO TRUE
 16547        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 299
* EL050.cbl
 16548        IF WS-AH-DCC-TRUNC = 'T'
 16549           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16550        ELSE
 16551           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16552        END-IF
 16553        EVALUATE TRUE
 16554           WHEN WS-TERM > +168
 16555              MOVE 15               TO V1
 16556           WHEN WS-TERM > +156
 16557              MOVE 14               TO V1
 16558           WHEN WS-TERM > +144
 16559              MOVE 13               TO V1
 16560           WHEN WS-TERM > +132
 16561              MOVE 12               TO V1
 16562           WHEN WS-TERM > +120
 16563              MOVE 11               TO V1
 16564           WHEN WS-TERM > +108
 16565              MOVE 10               TO V1
 16566           WHEN WS-TERM > +96
 16567              MOVE 9                TO V1
 16568           WHEN WS-TERM > +84
 16569              MOVE 8                TO V1
 16570           WHEN WS-TERM > +72
 16571              MOVE 7                TO V1
 16572           WHEN WS-TERM > +60
 16573              MOVE 6                TO V1
 16574           WHEN WS-TERM > +48
 16575              MOVE 5                TO V1
 16576           WHEN WS-TERM > +36
 16577              MOVE 4                TO V1
 16578           WHEN WS-TERM > +24
 16579              MOVE 3                TO V1
 16580           WHEN WS-TERM > +12
 16581              MOVE 2                TO V1
 16582           WHEN OTHER
 16583              MOVE 1                TO V1
 16584        END-EVALUATE
 16585
 16586        EVALUATE TRUE
 16587*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16588*             < +13)
 16589*             AND (DD-IU-PRESENT)
 16590*             MOVE 2                TO V2
 16591*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16592*             MOVE 1                TO V2
 16593           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16594              MOVE 2                TO V2
 16595           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16596              MOVE 3                TO V2
 16597           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16598              MOVE 4                TO V2
 16599           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16600              MOVE 5                TO V2
 16601           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16602              MOVE 6                TO V2
 16603           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16604              MOVE 7                TO V2
 16605           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 300
* EL050.cbl
 16606              MOVE 8                TO V2
 16607           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16608              MOVE 9                TO V2
 16609           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16610              MOVE 10               TO V2
 16611           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16612              MOVE 11               TO V2
 16613           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16614              MOVE 12               TO V2
 16615           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16616              MOVE 13               TO V2
 16617           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16618              MOVE 14               TO V2
 16619           WHEN OTHER
 16620              MOVE 15               TO V2
 16621        END-EVALUATE
 16622
 16623        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16624                                 TO CP-DDF-LO-FACT
 16625        MOVE PD-UEP-FACTOR (V1 V2)
 16626                                 TO CP-DDF-HI-FACT
 16627
 16628        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16629        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16630        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16631           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16632        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16633        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16634        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16635           + PD-1ST-YR-ADMIN-ALLOW
 16636
 16637        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16638*       IF PI-CLP-YN = 'Y'
 16639*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16640*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16641*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16642*       END-IF
 16643
 16644        IF DD-IU-PRESENT
 16645           MOVE 'I'              TO CP-EARNING-METHOD
 16646        END-IF
 16647        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16648                                     CP-CLP-RATE-UP
 16649        IF CP-IU-RATE-UP NOT = ZEROS
 16650           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16651              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16652           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16653              / (1 - WS-WORK-FACT)
 16654        END-IF
 16655     END-IF
 16656     .
 16657 3750-CONTINUE.
 16658     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16659
 16660     IF CP-REFUND-TYPE-USED NOT = SPACE
 16661         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16662
 16663     IF CP-ERROR-RATE-IS-ZERO OR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 301
* EL050.cbl
 16664        CP-ERROR-RATE-NOT-FOUND
 16665        MOVE ER-2740             TO WS-ERROR
 16666        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16667
 16668     IF CP-ERROR-RATE-FILE-NOTOPEN
 16669        MOVE ER-2617             TO WS-ERROR
 16670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16671     IF PB-COMPANY-ID = 'DCC' or 'VPP'
 16672        AND PB-CI-ENTRY-STATUS = 'M'
 16673        MOVE +0                  TO PB-C-AH-REF-CALC
 16674     ELSE
 16675        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16676     END-IF
 16677     if pb-company-id = 'VPP'
 16678        MOVE cm-ah-clp           to cp-original-premium
 16679        move zeros               to cp-calc-refund
 16680        perform 7600-get-refund  thru 7600-exit
 16681        if pb-c-ah-cancel-amt > pb-ci-cancel-fee
 16682           move cp-calc-refund   to pb-c-ah-rfnd-clp
 16683        else
 16684           move zeros            to pb-c-ah-rfnd-clp
 16685        end-if
 16686        display ' vpp ref clp ' cm-cert-no ' ' cm-ah-clp ' '
 16687           pb-c-ah-rfnd-clp ' ' pb-c-ah-cancel-amt ' '
 16688           pb-ci-cancel-fee
 16689     end-if
 16690     IF PB-COMPANY-ID = 'DCC'
 16691        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16692        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16693        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16694        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16695        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16696        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16697        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16698        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16699*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16700     END-IF
 16701     .
 16702 3770-CHECK-REFUNDS.
 16703
 16704     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16705        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16706           MOVE ER-2766          TO WS-ERROR
 16707           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16708           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16709           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16710              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16711
 16712     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16713        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16714           MOVE ER-2766          TO WS-ERROR
 16715           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16716           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16717           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16718              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16719
 16720     IF PB-COMP-LF-CANCEL
 16721        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 302
* EL050.cbl
 16722        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16723           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16724              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16725
 16726     IF PB-COMP-AH-CANCEL
 16727        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16728        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16729           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16730              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16731
 16732     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16733             GIVING WS-UNSIGN-WRK1
 16734     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16735             GIVING WS-UNSIGN-WRK2.
 16736
 16737     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16738         MOVE ZERO TO WS-UNSIGN-WRK1.
 16739
 16740     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16741         MOVE ZERO TO WS-UNSIGN-WRK2.
 16742
 16743     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16744
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 303
* EL050.cbl
 16746
 16747 3772-CONTINUE.
 16748
 16749**********************************
 16750*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16751*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16752*** DOUBLES THE TOLERANCE AMOUNT.
 16753***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16754**********************************
 16755     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'VPP'
 16756     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16757         IF WS-REF-REJECT-SW = SPACE
 16758             MOVE ER-2754        TO WS-ERROR
 16759             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16760           ELSE
 16761             MOVE ER-2736        TO WS-ERROR
 16762             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16763**********************************
 16764
 16765 3773-CONTINUE.
 16766
 16767     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16768        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16769           MOVE ER-2723          TO WS-ERROR
 16770           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16771
 16772     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16773        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16774           MOVE ER-2724          TO WS-ERROR
 16775           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16776
 16777     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16778         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16779             (1 + WS-LF-REFUND-OVS-PCT)
 16780     ELSE
 16781         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16782
 16783     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16784         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16785             (1 - WS-TOL-LF-REFUND-PCT)
 16786     ELSE
 16787         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16788
 16789     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16790        AND (PB-CI-ENTRY-STATUS = 'M')
 16791        AND (PB-C-LF-CANCEL-AMT > +0)
 16792        MOVE ER-3843             TO WS-ERROR
 16793        PERFORM 9900-ERROR-FORMAT
 16794                                 THRU 9900-EXIT
 16795     END-IF
 16796     EVALUATE TRUE
 16797        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16798           CONTINUE
 16799        WHEN PB-C-LF-CANCEL-AMT = +0
 16800                 AND PB-C-LF-REF-CALC > +0
 16801           CONTINUE
 16802        WHEN WS-LF-REFUND-OVS-AMT = 0
 16803                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 304
* EL050.cbl
 16804           CONTINUE
 16805        WHEN OTHER
 16806           IF WS-TOL-LF-REFUND  = +0
 16807              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16808           END-IF
 16809           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16810                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16811                          (PB-C-LF-CANCEL-AMT))
 16812              CONTINUE
 16813           ELSE
 16814              IF WS-LF-REFUND-OVS-AMT = +0
 16815                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16816              END-IF
 16817              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16818                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16819                                       PB-C-LF-CANCEL-AMT)
 16820                 CONTINUE
 16821              ELSE
 16822                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16823                   MOVE ER-2754   TO  WS-ERROR
 16824                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16825                 ELSE
 16826                    MOVE ER-2736   TO  WS-ERROR
 16827                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16828                 END-IF
 16829              END-IF
 16830           END-IF
 16831     END-EVALUATE.
 16832
 16833     EVALUATE TRUE
 16834        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16835           CONTINUE
 16836        WHEN PB-C-LF-CANCEL-AMT = +0
 16837                 AND PB-C-LF-REF-CALC > +0
 16838           CONTINUE
 16839        WHEN OTHER
 16840           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16841               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16842              CONTINUE
 16843           ELSE
 16844              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16845               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16846                CONTINUE
 16847              ELSE
 16848                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16849                     MOVE ER-2754   TO  WS-ERROR
 16850                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16851                 ELSE
 16852                     MOVE ER-2736   TO  WS-ERROR
 16853                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16854                 END-IF
 16855              END-IF
 16856           END-IF
 16857     END-EVALUATE.
 16858
 16859     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16860         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16861             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 305
* EL050.cbl
 16862     ELSE
 16863         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16864
 16865     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16866         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16867             (1 - WS-TOL-AH-REFUND-PCT)
 16868     ELSE
 16869         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16870
 16871     IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16872        AND (PB-CI-ENTRY-STATUS = 'M')
 16873        AND (PB-C-AH-CANCEL-AMT > +0)
 16874        MOVE ER-3843             TO WS-ERROR
 16875        PERFORM 9900-ERROR-FORMAT
 16876                                 THRU 9900-EXIT
 16877     END-IF
 16878     EVALUATE TRUE
 16879        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16880           CONTINUE
 16881*       WHEN PB-C-AH-REF-CALC = +0 AND
 16882*                  PB-C-AH-CANCEL-AMT > +0
 16883        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16884                   PB-C-AH-REF-CALC > +0
 16885           CONTINUE
 16886        WHEN WS-AH-REFUND-OVS-AMT = +0
 16887                AND WS-TOL-AH-REFUND = +0
 16888           CONTINUE
 16889        WHEN OTHER
 16890           IF WS-TOL-AH-REFUND = +0
 16891              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16892           END-IF
 16893           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16894               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16895                                         PB-C-AH-CANCEL-AMT)
 16896              CONTINUE
 16897           ELSE
 16898              IF WS-AH-REFUND-OVS-AMT = +0
 16899                 MOVE +9999999.99 TO
 16900                         WS-AH-REFUND-OVS-AMT
 16901              END-IF
 16902              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16903                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16904                                         PB-C-AH-CANCEL-AMT)
 16905                 CONTINUE
 16906              ELSE
 16907                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16908                    MOVE ER-2754   TO  WS-ERROR
 16909                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16910                 ELSE
 16911                    MOVE ER-2736   TO  WS-ERROR
 16912                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16913                 END-IF
 16914              END-IF
 16915           END-IF
 16916     END-EVALUATE.
 16917
 16918     EVALUATE TRUE
 16919        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 306
* EL050.cbl
 16920           CONTINUE
 16921*       WHEN PB-C-AH-REF-CALC > +0 AND
 16922*                  PB-C-AH-CANCEL-AMT = +0
 16923        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16924                   PB-C-AH-REF-CALC = +0
 16925           CONTINUE
 16926        WHEN OTHER
 16927           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16928               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16929              CONTINUE
 16930           ELSE
 16931              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16932                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16933                 CONTINUE
 16934              ELSE
 16935                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16936                     MOVE ER-2754   TO  WS-ERROR
 16937                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16938                 ELSE
 16939                     MOVE ER-2736   TO  WS-ERROR
 16940                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16941                 END-IF
 16942              END-IF
 16943           END-IF
 16944     END-EVALUATE.
 16945
 16946     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16947        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16948        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16949           AND  PB-C-LF-REF-CALC < +1.00
 16950           AND  PB-C-AH-REF-CALC < +1.00
 16951           CONTINUE
 16952        ELSE
 16953           IF (PB-COMPANY-ID = 'DCC' or 'VPP')
 16954              AND (PB-CI-ENTRY-STATUS = 'M')
 16955              CONTINUE
 16956           ELSE
 16957              MOVE ER-2741       TO WS-ERROR
 16958              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16959           END-IF
 16960        END-IF
 16961     END-IF
 16962
 16963     IF (PB-C-LF-CANCEL-AMT = ZERO
 16964        AND WS-LF-BENEFIT-CD NOT = ZERO
 16965        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16966        AND PB-C-LF-REF-CALC NOT = ZERO)
 16967        OR
 16968        (PB-C-LF-CANCEL-AMT = ZERO
 16969        AND WS-LF-BENEFIT-CD NOT = ZERO
 16970        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16971             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16972                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16973                NEXT SENTENCE
 16974             ELSE
 16975                MOVE ER-2739        TO WS-ERROR
 16976                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16977
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 307
* EL050.cbl
 16978     IF (PB-C-AH-CANCEL-AMT = ZERO
 16979        AND WS-AH-BENEFIT-CD NOT = ZERO
 16980        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16981        AND PB-C-AH-REF-CALC NOT = ZERO)
 16982        OR
 16983        (PB-C-AH-CANCEL-AMT = ZERO
 16984        AND WS-AH-BENEFIT-CD NOT = ZERO
 16985        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16986             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16987                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16988                NEXT SENTENCE
 16989             ELSE
 16990                MOVE ER-2738        TO WS-ERROR
 16991                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16992
 16993 3775-OVER-REF-CHK.
 16994
 16995     IF PB-CI-ENTRY-STATUS = '5'
 16996        GO TO 3780-UPDATE-CANCEL-CERT.
 16997
 16998     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16999                              PB-CI-LF-ALT-PREMIUM-AMT.
 17000
 17001     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17002        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17003                                 PB-C-LF-REF-CALC
 17004      ELSE
 17005        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 17006                                 PB-C-LF-CANCEL-AMT.
 17007
 17008     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 17009        MOVE ER-2755             TO WS-ERROR
 17010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17011
 17012     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 17013
 17014     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17015        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17016                                 PB-C-AH-REF-CALC
 17017      ELSE
 17018        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 17019                                 PB-C-AH-CANCEL-AMT.
 17020
 17021     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 17022        MOVE ER-2778             TO WS-ERROR
 17023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17024
 17025     IF PB-CI-OB-FLAG NOT = 'Z'
 17026        NEXT SENTENCE
 17027       ELSE
 17028         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17029            MOVE ER-2757           TO WS-ERROR
 17030            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17031
 17032 3780-UPDATE-CANCEL-CERT.
 17033
 17034     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17035        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 308
* EL050.cbl
 17036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17037
 17038     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17039         MOVE ER-2729              TO WS-ERROR
 17040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17041
 17042     IF PB-CI-LF-BENEFIT-CD = ZERO
 17043         GO TO 3780-UPDATE-CONT-1.
 17044
 17045     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17046         GO TO 3780-UPDATE-CONT-1.
 17047
 17048     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17049       AND
 17050        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17051       AND
 17052        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17053       AND
 17054        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17055            NEXT SENTENCE
 17056       ELSE
 17057        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17058          AND
 17059***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17060***       AND
 17061           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17062            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17063               MOVE ER-2730      TO WS-ERROR
 17064               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17065               GO TO 3999-END-EDIT
 17066            ELSE
 17067               GO TO 3999-END-EDIT
 17068        ELSE
 17069            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17070               MOVE ER-2765           TO WS-ERROR
 17071               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17072               GO TO 3785-CHECK-NH.
 17073*              GO TO 3999-END-EDIT.
 17074
 17075 3780-UPDATE-CONT-1.
 17076     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17077
 17078     IF PB-CI-AH-BENEFIT-CD = ZERO
 17079         GO TO 3780-UPDATE-CONT-2.
 17080
 17081     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17082         GO TO 3780-UPDATE-CONT-2.
 17083
 17084     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17085
 17086     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17087       AND
 17088        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17089       AND
 17090        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17091       AND
 17092        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17093            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 309
* EL050.cbl
 17094       ELSE
 17095        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17096          AND
 17097***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17098***       AND
 17099           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17100           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17101            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17102               MOVE ER-2773      TO WS-ERROR
 17103               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17104               GO TO 3999-END-EDIT
 17105            ELSE
 17106               GO TO 3999-END-EDIT
 17107            END-IF
 17108           ELSE
 17109             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17110                IF MSTR-CERT-NO = W-CL-CERT-NO
 17111                   MOVE ER-2890 TO WS-ERROR
 17112                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17113                   GO TO 3999-END-EDIT
 17114                ELSE
 17115                   MOVE ER-2898 TO WS-ERROR
 17116                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17117                   GO TO 3999-END-EDIT
 17118                END-IF
 17119             ELSE
 17120                GO TO 3785-CHECK-NH
 17121             END-IF
 17122           END-IF
 17123          ELSE
 17124            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17125              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17126                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17127                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17128                      MOVE ER-2890 TO WS-ERROR
 17129                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17130                      GO TO 3999-END-EDIT
 17131                   ELSE
 17132                      MOVE ER-2898 TO WS-ERROR
 17133                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17134                      GO TO 3999-END-EDIT
 17135                   END-IF
 17136                ELSE
 17137                   MOVE ER-2765 TO WS-ERROR
 17138                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17139                   GO TO 3785-CHECK-NH
 17140                END-IF
 17141              ELSE
 17142               MOVE ER-2765      TO WS-ERROR
 17143               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17144               GO TO 3785-CHECK-NH.
 17145*              GO TO 3999-END-EDIT.
 17146
 17147 3780-UPDATE-CONT-2.
 17148
 17149     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17150        AND WS-LF-BENEFIT-CD = ZERO
 17151           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 310
* EL050.cbl
 17152           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17153
 17154     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17155        AND WS-AH-BENEFIT-CD = ZERO
 17156           MOVE ER-2744           TO WS-ERROR
 17157           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17158
 17159     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17160        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17161        AND
 17162        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17163         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17164           MOVE ER-2746           TO WS-ERROR
 17165           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17166
 17167     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17168       AND
 17169        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17170             MOVE ER-2737        TO WS-ERROR
 17171             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17172
 17173     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17174       AND
 17175        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17176             MOVE ER-2737        TO WS-ERROR
 17177             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17178
 17179     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17180         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17181             OR 'CID' OR 'DCC' or 'VPP' OR 'AHL'
 17182             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17183         ELSE
 17184             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17185                 MOVE ER-2768    TO WS-ERROR
 17186                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17187             ELSE
 17188                 MOVE ER-2756    TO WS-ERROR
 17189                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17190
 17191     IF CERT-PEND-ISSUE-RETURNED
 17192        MOVE ER-2772             TO WS-ERROR
 17193        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17194 3785-CHECK-NH.
 17195*    IF PB-STATE NOT = 'NH' and 'TN'
 17196     IF PB-STATE NOT = 'NH'
 17197        GO TO 3999-END-EDIT
 17198     END-IF
 17199
 17200     MOVE ER-2796                TO WS-ERROR
 17201     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17202     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17203        OR (CM-NH-INTERFACE-SW = 'Y')
 17204        MOVE ER-2793             TO WS-ERROR
 17205        PERFORM 9900-ERROR-FORMAT
 17206                                 THRU 9900-EXIT
 17207     END-IF
 17208     MOVE +0                     TO WS-PAYMENT-AMT
 17209     if pb-state = 'NH'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 311
* EL050.cbl
 17210        IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR
 17211               PB-C-AH-CANCEL-DT
 17212           GO TO 3999-END-EDIT
 17213        END-IF
 17214     end-if
 17215***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17216***-_-
 17217***-_-   For TN it's only flat cancels
 17218***-_-
 17219***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17220     if pb-state = 'TN'
 17221        if ((pb-c-lf-cancel-dt <> low-values)
 17222           and (pb-c-lf-cancel-dt <> pb-cert-eff-dt))
 17223                      or
 17224           ((pb-c-ah-cancel-dt <> low-values)
 17225           and (pb-c-ah-cancel-dt <> pb-cert-eff-dt))
 17226           GO TO 3999-END-EDIT
 17227        END-IF
 17228     end-if
 17229     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17230        GO TO 3999-END-EDIT
 17231     END-IF
 17232***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17233***-_-
 17234***-_-   if cancel date within 15 days of effective date, bypass
 17235***-_-
 17236***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17237     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17238     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17239     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17240        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17241     END-IF
 17242     MOVE '1'                    TO DC-OPTION-CODE
 17243     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17244     IF NO-CONVERSION-ERROR
 17245        and pb-state = 'NH'
 17246        IF DC-ELAPSED-DAYS < +16
 17247           GO TO 3999-END-EDIT
 17248        END-IF
 17249     END-IF
 17250***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17251***-_-
 17252***-_-   if cancel date within 30 days of current date then
 17253***-_-   bypass else subtract 15 days from period
 17254***-_-
 17255***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17256     MOVE +0                     TO DC-ELAPSED-DAYS
 17257     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17258     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17259     MOVE '1'                    TO DC-OPTION-CODE
 17260     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17261     IF NO-CONVERSION-ERROR
 17262        IF DC-ELAPSED-DAYS > +30
 17263           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17264        ELSE
 17265           GO TO 3999-END-EDIT
 17266        END-IF
 17267     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 312
* EL050.cbl
 17268        GO TO 3999-END-EDIT
 17269     END-IF
 17270***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17271***-_-
 17272***-_-   'NH' is 10%, TN is 3.5%
 17273***-_-
 17274***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-
 17275     if pb-state = 'NH'
 17276        move +1.10               to ws-work-rate
 17277     else
 17278        move +1.035              to ws-work-rate
 17279     end-if
 17280     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17281        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17282           (ws-work-rate ** (DC-ELAPSED-DAYS / 365) - 1))
 17283     IF WS-PAYMENT-AMT < 600.00
 17284        GO TO 3999-END-EDIT
 17285     END-IF
 17286     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17287
 17288     IF (ERMAIL-FOUND = ' ')
 17289         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17290         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17291        GO TO 3999-END-EDIT
 17292     END-IF
 17293     MOVE ER-2795                TO WS-ERROR
 17294     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17295
 17296     GO TO 3999-END-EDIT.
 17297******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 313
* EL050.cbl
 17299 3990-FILES-NOT-OPEN.
 17300
 17301     MOVE ER-2617                TO WS-ERROR.
 17302     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17303     GO TO 9990-RETURN.
 17304
 17305 3999-END-EDIT.
 17306
 17307     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17308
 17309     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17310         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17311         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17312             PERFORM 9250-UNLOCK-RETURN
 17313             GO TO 9990-RETURN
 17314          ELSE
 17315             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17316             GO TO 9990-RETURN.
 17317
 17318     IF PB-CANCELLATION
 17319          GO TO 9990-RETURN.
 17320
 17321     IF CERT-WAS-NOT-FOUND
 17322        MOVE SPACES              TO CERTIFICATE-MASTER.
 17323
 17324     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17325
 17326     IF CERT-WAS-FOUND
 17327         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17328             PERFORM 9250-UNLOCK-RETURN
 17329          ELSE
 17330            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17331      ELSE
 17332         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17333
 17334     if pb-company-id = 'VPP'
 17335        perform 8150-read-elcrtt thru 8150-exit
 17336        if ws-vehicle-odometer numeric
 17337           if ws-vehicle-odometer > 6000
 17338              move er-1583       to ws-error
 17339              PERFORM 9900-ERROR-FORMAT
 17340                                 THRU 9900-EXIT
 17341           end-if
 17342        end-if
 17343     end-if
 17344     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17345        IF ((PB-COMPANY-ID = 'DCC')
 17346           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17347                         or
 17348            (pb-company-id = 'CID' or 'VPP')
 17349            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17350        END-IF
 17351     END-IF.
 17352
 17353     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17354         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17355     END-IF.
 17356     move ' '                    to ws-ins-age-defaulted
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 314
* EL050.cbl
 17357     perform 8150-read-elcrtt    thru 8150-exit
 17358     if ws-ins-age-defaulted = 'Y'
 17359        move er-1573             to ws-error
 17360        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17361     end-if
 17362
 17363     if ws-jnt-age-defaulted = 'Y'
 17364        move er-1574             to ws-error
 17365        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17366     end-if
 17367***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17368***                                                           ****
 17369***  Set an error if the state requires verification of agent ****
 17370***  and agent hasn't verified yet and the status is not =    ****
 17371***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17372***  and the entry date > 09/01/2015.                         ****
 17373***                                                           ****
 17374***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17375     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17376        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17377        and (pb-account (9:2) not = 'OB')
 17378        if (ws-st-agent-sig-edit = 'Y')
 17379           and (am-report-code-1 not = 'CONLEY')
 17380           evaluate true
 17381              when cs-agent-edit-status = 'C'
 17382                 move er-1743    to ws-error
 17383                 perform 9900-error-format
 17384                                 thru 9900-exit
 17385              when cs-agent-edit-status = 'S'
 17386                 move er-1744    to ws-error
 17387                 perform 9900-error-format
 17388                                 thru 9900-exit
 17389              when cs-agent-edit-status = 'M'
 17390                 move er-1745    to ws-error
 17391                 perform 9900-error-format
 17392                                 thru 9900-exit
 17393              when cs-agent-edit-status = 'R'
 17394                 move er-1747    to ws-error
 17395                 perform 9900-error-format
 17396                                 thru 9900-exit
 17397              when cs-agent-edit-status = 'N'
 17398                 move er-1748    to ws-error
 17399                 perform 9900-error-format
 17400                                 thru 9900-exit
 17401              when cs-agent-edit-status <> 'V' and 'U' and
 17402                                           'R' and 'N'
 17403                 move er-1746    to ws-error
 17404                 perform 9900-error-format
 17405                                 thru 9900-exit
 17406           end-evaluate
 17407        end-if
 17408     end-if
 17409     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17410     IF ((PB-COMPANY-ID = 'DCC' or 'VPP')
 17411        AND (WS-NO-SECURE-PAY))
 17412                  OR
 17413        (WS-LF-SPECIAL-CALC-CD = 'O'
 17414        OR WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 315
* EL050.cbl
 17415        SET SKIP-ADDR-EDIT       TO TRUE
 17416     END-IF
 17417     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17418        AND (NOT SKIP-ADDR-EDIT)
 17419        MOVE ER-2963             TO WS-ERROR
 17420        PERFORM 9900-ERROR-FORMAT
 17421                                 THRU 9900-EXIT
 17422        GO TO 9990-RETURN
 17423     END-IF
 17424     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17425     IF ERPNDM-FOUND NOT = 'X'
 17426        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17427           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17428           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17429           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17430           AND (NOT SKIP-ADDR-EDIT)
 17431           MOVE ER-2694          TO WS-ERROR
 17432           PERFORM 9900-ERROR-FORMAT
 17433                                 THRU 9900-EXIT
 17434        END-IF
 17435        MOVE ' '                 TO STATE-RECORD-ERROR
 17436        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17437        MOVE PM-STATE            TO CNTL-ACCESS
 17438        MOVE '3'                 TO CNTL-REC-TYPE
 17439        MOVE +0                  TO CNTL-SEQ-NO
 17440        MOVE '0'                 TO RC-SW-2
 17441        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17442        IF (NO-STATE-RECORD)
 17443           OR (CF-RECORD-TYPE NOT = '3')
 17444           OR (PM-STATE NOT = CF-STATE-CODE)
 17445           IF (PM-STATE = SPACES)
 17446              AND (SKIP-ADDR-EDIT)
 17447              CONTINUE
 17448           ELSE
 17449              MOVE ER-2963       TO WS-ERROR
 17450              PERFORM 9900-ERROR-FORMAT
 17451                                 THRU 9900-EXIT
 17452           END-IF
 17453        END-IF
 17454        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17455           MOVE ER-2883          TO WS-ERROR
 17456           PERFORM 9900-ERROR-FORMAT
 17457                                 THRU 9900-EXIT
 17458        END-IF
 17459        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17460           MOVE ' '                 TO STATE-RECORD-ERROR
 17461           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17462           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17463           MOVE '3'                 TO CNTL-REC-TYPE
 17464           MOVE +0                  TO CNTL-SEQ-NO
 17465           MOVE '0'                 TO RC-SW-2
 17466           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17467           IF NO-STATE-RECORD
 17468              OR (CF-RECORD-TYPE NOT = '3')
 17469              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17470              MOVE ER-2964          TO WS-ERROR
 17471              PERFORM 9900-ERROR-FORMAT
 17472                                    THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 316
* EL050.cbl
 17473           END-IF
 17474        END-IF
 17475     ELSE
 17476        IF NOT SKIP-ADDR-EDIT
 17477           MOVE ER-2393          TO WS-ERROR
 17478           PERFORM 9900-ERROR-FORMAT
 17479                                 THRU 9900-EXIT
 17480        END-IF
 17481     END-IF
 17482
 17483     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17484
 17485     IF (ERMAIL-FOUND = ' ' AND
 17486        ERPNDM-FOUND = ' ')
 17487        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17488           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17489           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17490          OR
 17491           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17492          OR
 17493           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17494           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17495           GO TO 3999-UNLOCK-ERMAIL.
 17496
 17497     IF ERPNDM-FOUND = 'X'
 17498        GO TO 3999-UNLOCK-ERMAIL.
 17499
 17500     IF PM-INSURED-LAST-NAME      = SPACES
 17501        AND PM-INSURED-FIRST-NAME = SPACES
 17502        AND PM-ADDRESS-LINE-1     = SPACES
 17503        AND PM-ADDRESS-LINE-2     = SPACES
 17504        AND PM-CITY-STATE         = SPACES
 17505        AND PM-CRED-BENE-NAME     = SPACES
 17506        AND PM-CRED-BENE-ADDR     = SPACES
 17507        AND PM-CRED-BENE-CTYST    = SPACES
 17508        GO TO 3999-UNLOCK-ERMAIL
 17509     END-IF
 17510
 17511     MOVE SPACES                 TO MAILING-DATA.
 17512
 17513     MOVE 'MA'                   TO MA-RECORD-ID.
 17514     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17515     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17516     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17517     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17518     MOVE PB-SV-STATE            TO MA-STATE.
 17519     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17520     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17521
 17522     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17523     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17524
 17525     IF ERMAIL-FOUND = ' '
 17526        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17527     ELSE
 17528        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17529        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17530        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 317
* EL050.cbl
 17531
 17532     GO TO 9990-RETURN.
 17533
 17534 3999-UNLOCK-ERMAIL.
 17535     IF ERMAIL-FOUND = ' '
 17536        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17537
 17538     GO TO 9990-RETURN.
 17539******************************************************************
 17540
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 318
* EL050.cbl
 17542 4000-UPDATE-CANCELLED-CERT.
 17543     IF CERT-WAS-NOT-FOUND
 17544        GO TO 4299-EXIT.
 17545
 17546*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17547     IF PB-C-NH-INT-ON-REFS > ZEROS
 17548        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17549     END-IF
 17550     IF PB-C-REF-INTERFACE-SW = 'Y'
 17551        MOVE PB-C-REF-INTERFACE-SW
 17552                                 TO CM-NH-INTERFACE-SW
 17553     END-IF
 17554     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17555     IF ERMAIL-FOUND = 'X'
 17556        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17557        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17558        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17559        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17560           MOVE ER-2694          TO WS-ERROR
 17561           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17562     END-IF
 17563
 17564     IF PB-C-POST-CARD-IND = 'Y'
 17565        MOVE +8                  TO SUB
 17566*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17567        IF ERMAIL-FOUND = ' '
 17568           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17569              (SUB > +7)
 17570              OR (MA-MAIL-STATUS (SUB) = '1')
 17571           END-PERFORM
 17572        END-IF
 17573        IF (SUB > +7)
 17574           OR (ERMAIL-FOUND = 'X')
 17575           MOVE ER-3789          TO WS-ERROR
 17576           PERFORM 9900-ERROR-FORMAT
 17577                                 THRU 9900-EXIT
 17578        END-IF
 17579     ELSE
 17580        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17581     END-IF
 17582
 17583     IF ERMAIL-FOUND = ' '
 17584        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17585     END-IF.
 17586
 17587     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17588
 17589     IF PB-CI-OB-FLAG = 'Z'
 17590        GO TO 4150-SUMMARY-CERT-CANCEL.
 17591
 17592     IF PB-C-LF-CANCEL-VOIDED
 17593         PERFORM 4200-REVERSE-LF-CANCEL.
 17594     IF PB-C-AH-CANCEL-VOIDED
 17595         PERFORM 4200-REVERSE-AH-CANCEL.
 17596
 17597 4100-APPLY-LF-CANCEL.
 17598
 17599     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 319
* EL050.cbl
 17600
 17601 4100-CHECK-LF-ERRORS.
 17602
 17603     ADD +1                       TO WS-SUB.
 17604
 17605     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17606        IF LF-COVERAGE-CANCELLED
 17607           GO TO 4100-LF-CANCEL-CONT
 17608        ELSE
 17609           GO TO 4100-UPDATE-LF-COVERAGE.
 17610
 17611     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17612                                   ER-2729 OR
 17613                                   ER-2730 OR
 17614                                   ER-2731 OR
 17615                                   ER-2732 OR
 17616                                   ER-2737 OR
 17617                                   ER-2740 OR
 17618                                   ER-2743 OR
 17619                                   ER-2749 OR
 17620                                   ER-2750 OR
 17621                                   ER-2755 OR
 17622                                   ER-2757 OR
 17623                                   ER-2760 OR
 17624                                   ER-2772 OR
 17625                                   ER-2774 OR
 17626                                   ER-2776 OR
 17627                                   ER-2794
 17628        GO TO 4100-UPDATE-LF-COVERAGE.
 17629
 17630     GO TO 4100-CHECK-LF-ERRORS.
 17631
 17632 4100-UPDATE-LF-COVERAGE.
 17633
 17634     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17635     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17636     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17637        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17638     END-IF
 17639     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17640                                      TO CM-CREDIT-INTERFACE-SW-2.
 17641     IF CM-LF-CANCEL-DT = LOW-VALUE
 17642         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17643
 17644     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17645         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17646                                         CM-LF-STATUS-AT-CANCEL.
 17647
 17648     GO TO 4100-APPLY-AH-CANCEL.
 17649
 17650 4100-LF-CANCEL-CONT.
 17651     IF PB-C-LF-CANCEL-VOIDED
 17652         GO TO 4100-APPLY-AH-CANCEL.
 17653
 17654     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17655         GO TO 4100-APPLY-AH-CANCEL.
 17656
 17657     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 320
* EL050.cbl
 17658        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17659           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17660        ELSE
 17661           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17662
 17663     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17664     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17665
 17666     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17667         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17668
 17669     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17670        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17671         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17672         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17673
 17674     IF PB-RECORD-RETURNED
 17675        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17676      ELSE
 17677        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17678
 17679 4100-APPLY-AH-CANCEL.
 17680
 17681     MOVE +0                      TO WS-SUB.
 17682
 17683 4100-CHECK-AH-ERRORS.
 17684
 17685     ADD +1                       TO WS-SUB.
 17686
 17687     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17688        IF AH-COVERAGE-CANCELLED
 17689           GO TO 4100-AH-CANCEL-CONT
 17690        ELSE
 17691           GO TO 4100-UPDATE-AH-COVERAGE.
 17692
 17693     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17694                                   ER-2729 OR
 17695                                   ER-2732 OR
 17696                                   ER-2737 OR
 17697                                   ER-2740 OR
 17698                                   ER-2744 OR
 17699                                   ER-2749 OR
 17700                                   ER-2750 OR
 17701                                   ER-2755 OR
 17702                                   ER-2757 OR
 17703                                   ER-2760 OR
 17704                                   ER-2771 OR
 17705                                   ER-2772 OR
 17706                                   ER-2773 OR
 17707                                   ER-2775 OR
 17708                                   ER-2777 OR
 17709                                   ER-2778 OR
 17710                                   ER-2794
 17711        GO TO 4100-UPDATE-AH-COVERAGE.
 17712
 17713     GO TO 4100-CHECK-AH-ERRORS.
 17714
 17715 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 321
* EL050.cbl
 17716
 17717     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17718     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17719     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17720     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17721                                      TO CM-CREDIT-INTERFACE-SW-2.
 17722     IF CM-AH-CANCEL-DT = LOW-VALUE
 17723         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17724
 17725     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17726         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17727                                         CM-AH-STATUS-AT-CANCEL.
 17728
 17729     IF LF-COVERAGE-CANCELLED
 17730         IF PB-RECORD-RETURNED
 17731              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17732          ELSE
 17733              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17734
 17735     GO TO 4299-EXIT.
 17736
 17737 4100-AH-CANCEL-CONT.
 17738     IF PB-C-AH-CANCEL-VOIDED
 17739         GO TO 4299-EXIT.
 17740
 17741     if cm-credit-interface-sw-2 = ' '
 17742        if pb-fatal-errors or pb-unforced-errors
 17743           move '4'              to cm-credit-interface-sw-2
 17744        else
 17745           move '1'              to cm-credit-interface-sw-2
 17746        end-if
 17747     end-if
 17748     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17749         GO TO 4299-EXIT.
 17750
 17751     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17752        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17753           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17754        ELSE
 17755           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17756
 17757     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17758     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17759
 17760     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17761         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17762
 17763     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17764         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17765         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17766
 17767     IF PB-RECORD-RETURNED
 17768        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17769      ELSE
 17770        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17771
 17772     GO TO 4299-EXIT.
 17773
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 322
* EL050.cbl
 17774 4150-SUMMARY-CERT-CANCEL.
 17775     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17776
 17777     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17778        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17779                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17780     ELSE
 17781        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17782                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17783
 17784     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17785        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17786                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17787     ELSE
 17788        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17789                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17790
 17791     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17792        NEXT SENTENCE
 17793     ELSE
 17794        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17795
 17796     GO TO 4299-EXIT.
 17797
 17798 4200-REVERSE-LF-CANCEL.
 17799     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17800
 17801     IF CM-LF-CANCEL-APPLIED
 17802        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17803        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17804        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17805
 17806     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17807
 17808     IF PB-RECORD-RETURNED
 17809        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17810       ELSE
 17811        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17812
 17813 4200-REVERSE-LF-EXIT.
 17814       EXIT.
 17815
 17816 4200-REVERSE-AH-CANCEL.
 17817     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17818
 17819     IF CM-AH-CANCEL-APPLIED
 17820        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17821        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17822        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17823
 17824     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17825
 17826     IF PB-RECORD-RETURNED
 17827        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17828       ELSE
 17829        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17830
 17831 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 323
* EL050.cbl
 17832       EXIT.
 17833
 17834 4299-EXIT.
 17835       EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 324
* EL050.cbl
 17837
 17838 4500-UPDATE-NEW-CERT.
 17839     IF CERT-WAS-FOUND
 17840         NEXT SENTENCE
 17841       ELSE
 17842         GO TO 4520-BUILD-NEW-KEY.
 17843
 17844     IF  CLASIC-CREATED-CERT
 17845         GO TO 4999-EXIT.
 17846
 17847     IF  CERT-WAS-CREATED-FOR-CLAIM
 17848         GO TO 4520-BUILD-NEW-KEY.
 17849
 17850     IF CERT-ADDED-BATCH
 17851        IF CM-RECORD-ID = 'CM'
 17852            GO TO 4999-EXIT.
 17853
 17854 4520-BUILD-NEW-KEY.
 17855* BUILD CONTROL PRIMARY
 17856
 17857     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17858                                       CM-COMPANY-CD-A1
 17859                                       CM-COMPANY-CD-A2
 17860                                       CM-COMPANY-CD-A4
 17861                                       CM-COMPANY-CD-A5.
 17862
 17863     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17864     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17865     MOVE PB-SV-STATE               TO CM-STATE.
 17866     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17867     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17868     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17869     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17870
 17871     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17872
 17873     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17874     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17875     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17876     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17877
 17878     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17879        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17880
 17881     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17882         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17883         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17884         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17885         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17886     ELSE
 17887         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17888
 17889     IF PB-COMPANY-ID   EQUAL  'CRI'
 17890         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17891         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17892         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17893         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17894         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 325
* EL050.cbl
 17895
 17896     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17897        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17898         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17899
 17900     IF PB-COMPANY-ID  = 'LBL'
 17901        IF PB-I-JOINT-COVERAGE
 17902            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17903                                           PB-I-MEMBER-NO
 17904            GO TO 4550-CONT-CERT-PROCESS.
 17905
 17906     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17907        NEXT SENTENCE
 17908     ELSE
 17909        GO TO 4540-BUILD-MEMBER-NO.
 17910
 17911******************************************************************
 17912*                                                                *
 17913*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17914*    FOR 'MON'.                                                  *
 17915*                                                                *
 17916******************************************************************
 17917
 17918     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17919     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17920     MOVE +1                     TO WS-SUB1
 17921                                    WS-SUB2.
 17922
 17923 4530-EDIT-MEMB-NAME.
 17924
 17925     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17926        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17927        ADD +1                       TO WS-SUB2.
 17928
 17929     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17930        ADD +1                       TO WS-SUB1
 17931        GO TO 4530-EDIT-MEMB-NAME.
 17932
 17933     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17934     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17935     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17936*    MOVE SPACE                      TO DC-OPTION-CODE.
 17937     SET  BIN-TO-GREG                TO TRUE.
 17938     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17939     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17940
 17941     GO TO 4550-CONT-CERT-PROCESS.
 17942
 17943******************************************************************
 17944*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17945******************************************************************
 17946
 17947 4540-BUILD-MEMBER-NO.
 17948
 17949     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17950         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17951         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17952         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 326
* EL050.cbl
 17953         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17954     ELSE
 17955         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17956
 17957     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17958        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17959         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17960
 17961 4550-CONT-CERT-PROCESS.
 17962
 17963*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17964*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17965*    ELSE
 17966*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17967
 17968     IF CERT-WAS-CREATED-FOR-CLAIM
 17969        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17970        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17971
 17972     IF CERT-AND-CLAIM-ONLINE
 17973        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17974        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17975
 17976     MOVE 'CM'                     TO CM-RECORD-ID.
 17977     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17978
 17979     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17980        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17981        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17982     ELSE
 17983        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17984        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17985
 17986     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17987     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17988     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17989     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17990     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17991     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17992     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17993                                      CM-LF-ITD-CANCEL-AMT
 17994                                      CM-LF-ITD-DEATH-AMT
 17995                                      CM-AH-ITD-AH-PMT
 17996                                      CM-AH-ITD-LUMP-PMT
 17997                                      CM-AH-ITD-CANCEL-AMT
 17998                                      CM-LF-NSP-PREMIUM-AMT
 17999                                      CM-AH-NSP-PREMIUM-AMT.
 18000*                                     CM-CLAIM-DEDUCT-WITHHELD
 18001*                                     CM-CANCEL-DEDUCT-WITHHELD.
 18002     if pb-i-loan-apr = +99.9999
 18003        move zeros                 to cm-loan-apr
 18004     else
 18005        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 18006     end-if
 18007     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 18008     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 18009     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 18010     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 327
* EL050.cbl
 18011     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 18012     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 18013     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 18014     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 18015     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 18016     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 18017     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 18018
 18019     IF PB-I-LIVES NOT NUMERIC
 18020         MOVE ZERO                 TO PB-I-LIVES.
 18021
 18022     IF PB-I-NUM-BILLED NOT NUMERIC
 18023         MOVE ZERO                 TO PB-I-NUM-BILLED.
 18024
 18025     MOVE PB-I-LIVES               TO CM-LIVES.
 18026     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 18027
 18028     IF PB-COMPANY-ID EQUAL  'DMD'
 18029         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 18030         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 18031
 18032     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 18033     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 18034     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 18035     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 18036     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 18037     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 18038
 18039     IF PB-I-LF-POLICY-FEE NUMERIC
 18040        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 18041     ELSE
 18042        MOVE +0                    TO CM-LF-POLICY-FEE.
 18043
 18044     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 18045        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 18046        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 18047     ELSE
 18048        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 18049
 18050     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 18051     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 18052     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 18053     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 18054     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 18055     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 18056     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 18057     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 18058     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 18059
 18060     IF PB-I-CANCEL-FEE NUMERIC
 18061        MOVE PB-I-CANCEL-FEE     TO CM-CANCEL-FEE
 18062     ELSE
 18063        MOVE +0                  TO CM-CANCEL-FEE
 18064     END-IF
 18065
 18066     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 18067        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 18068     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 328
* EL050.cbl
 18069        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
 18070
 18071     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 18072     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 18073
 18074     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 18075                                      CM-LF-DEATH-EXIT-DT
 18076                                      CM-AH-SETTLEMENT-EXIT-DT.
 18077
 18078*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 18079*                       'TIH' OR 'OFL' OR 'FLA' OR
 18080*                       'TII' OR 'TMS' OR 'CRI' OR
 18081*                       'NCL'
 18082     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18083
 18084     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18085         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18086            MOVE '2'                TO CM-PREMIUM-TYPE.
 18087
 18088     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18089         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18090            MOVE '2'                TO CM-PREMIUM-TYPE.
 18091
 18092     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18093         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18094     ELSE
 18095         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18096         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18097
 18098     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18099     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18100     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18101     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18102     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18103     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18104     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18105     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18106
 18107     IF PB-NO-MONTHS-SKIPPED
 18108         MOVE SPACE                 TO CM-SKIP-CODE
 18109     ELSE
 18110         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18111
 18112     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18113     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18114                                       CM-LF-STATUS-AT-CANCEL.
 18115
 18116     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18117     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18118                                       CM-AH-STATUS-AT-CANCEL.
 18119
 18120     MOVE '1'                       TO CM-ENTRY-STATUS.
 18121
 18122     IF PB-REISSUED-CERT
 18123        MOVE '5'                    TO CM-ENTRY-STATUS.
 18124
 18125     IF PB-MONTHLY-CERT
 18126        MOVE 'M'                    TO CM-ENTRY-STATUS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 329
* EL050.cbl
 18127
 18128     IF PB-CASH-CERT
 18129        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18130
 18131     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18132     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18133     IF PB-POLICY-IS-DECLINED
 18134        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18135
 18136     IF PB-POLICY-IS-VOIDED
 18137        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18138
 18139     IF PB-NEEDS-UNDERWRITING
 18140        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18141
 18142     IF PB-REIN-ONLY-CERT
 18143        MOVE '9'                    TO CM-ENTRY-STATUS.
 18144
 18145     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18146         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18147     ELSE
 18148         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18149
 18150     IF PB-RECORD-RETURNED
 18151        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18152      ELSE
 18153        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18154
 18155     IF PB-I-MAIL-ADDRS-PRESENT
 18156        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18157
 18158     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18159                                       CM-ENTRY-DT.
 18160
 18161 4999-EXIT.
 18162     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 330
* EL050.cbl
 18164
 18165 5000-PROCESS-REPS.
 18166     MOVE ' '                    TO AGTC-MASTER-SW
 18167     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18168     MOVE CO-TYPE                TO AGTC-TYPE
 18169     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18170     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18171     IF (AGTC-MASTER-SW NOT = 'N')
 18172        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18173        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18174        PERFORM 8583-READ-ERAGTC-NEXT
 18175                                 THRU 8583-EXIT
 18176     END-IF
 18177     IF AGTC-MASTER-SW = 'N'
 18178        CONTINUE
 18179     ELSE
 18180        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18181           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18182              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18183              MOVE 'Y'           TO AGTC-MASTER-SW
 18184           END-IF
 18185        END-IF
 18186     END-IF
 18187     .
 18188 5000-EXIT.
 18189     EXIT.
 18190 6370-EDIT-INPUT-LF-CODE.
 18191     move ' ' to ws-benefit-cd-chg-sw
 18192     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18193        MOVE +1                  TO SUB
 18194        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18195        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18196        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18197        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18198        GO TO 6370-SEARCH-LOOP.
 18199
 18200     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18201
 18202     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18203     MOVE SPACES                 TO CNTL-ACCESS.
 18204*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18205     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18206     MOVE +0                     TO CNTL-SEQ-NO.
 18207     MOVE '4' TO RC-SW-2.
 18208     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18209
 18210     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18211        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18212        GO TO 6370-NO-LF-FOUND.
 18213
 18214     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18215     MOVE +1                     TO SUB.
 18216
 18217 6370-SEARCH-LOOP.
 18218     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18219         GO TO 6370-NO-LF-FOUND.
 18220
 18221     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 331
* EL050.cbl
 18222        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18223           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18224           set benefit-code-chg to true
 18225        end-if
 18226        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18227        GO TO 6370-HER-NET-PAY-CHECK.
 18228
 18229     ADD 1   TO SUB.
 18230*    IF SUB GREATER 120
 18231     IF SUB GREATER 200
 18232         GO TO 6370-NO-LF-FOUND.
 18233
 18234     GO TO 6370-SEARCH-LOOP.
 18235
 18236 6370-NO-LF-FOUND.
 18237
 18238     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18239        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18240        set benefit-code-chg to true
 18241     end-if
 18242     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18243
 18244 6370-HER-NET-PAY-CHECK.
 18245
 18246     IF PB-COMPANY-ID = 'CID'
 18247        IF PB-SV-STATE = 'CA' OR 'MN'
 18248           IF PB-I-LF-BENEFIT-CD = '02'
 18249              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18250           ELSE
 18251              IF PB-I-LF-BENEFIT-CD = '04'
 18252                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18253              END-IF
 18254           END-IF
 18255        END-IF
 18256     END-IF
 18257
 18258     IF PB-COMPANY-ID NOT = 'HER'
 18259         GO TO 6370-EXIT.
 18260
 18261     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18262         GO TO 6370-EXIT.
 18263
 18264     IF PB-I-LF-TERM NOT NUMERIC
 18265         MOVE ZEROS              TO PB-I-LF-TERM.
 18266
 18267     IF PB-I-LOAN-TERM NOT NUMERIC
 18268         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18269
 18270     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18271         GO TO 6370-EXIT.
 18272
 18273     IF PB-I-LF-BENEFIT-CD = '33'
 18274         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18275
 18276     IF PB-I-LF-BENEFIT-CD = '34'
 18277         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18278
 18279 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 332
* EL050.cbl
 18280     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 333
* EL050.cbl
 18282
 18283 6380-EDIT-INPUT-AH-CODE.
 18284     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18285        MOVE +1                  TO SUB
 18286        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18287        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18288        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18289        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18290        GO TO 6380-SEARCH-LOOP.
 18291
 18292     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18293
 18294     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18295     MOVE SPACES                 TO CNTL-ACCESS.
 18296     MOVE 'A'                    TO CNTL-REC-TYPE.
 18297*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18298     MOVE +0                     TO CNTL-SEQ-NO.
 18299     MOVE '5' TO RC-SW-2.
 18300     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18301
 18302     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18303        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18304        GO TO 6380-NO-AH-FOUND.
 18305
 18306     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18307     MOVE +1 TO SUB.
 18308
 18309 6380-SEARCH-LOOP.
 18310     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18311         GO TO 6380-NO-AH-FOUND.
 18312
 18313     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18314         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18315         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18316
 18317     ADD 1   TO SUB.
 18318     IF SUB GREATER THAN 96
 18319*    IF SUB GREATER THAN 300
 18320         GO TO 6380-NO-AH-FOUND.
 18321
 18322     GO TO 6380-SEARCH-LOOP.
 18323
 18324 6380-NO-AH-FOUND.
 18325
 18326     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18327
 18328     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18329         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18330     ELSE
 18331         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18332
 18333 6380-CSO-AH-ONLY-CHECKS.
 18334
 18335     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18336        NEXT SENTENCE
 18337      ELSE
 18338        GO TO 6380-EXIT.
 18339
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 334
* EL050.cbl
 18340     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18341         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18342
 18343
 18344     GO TO 6380-EXIT
 18345     .
 18346 6380-CSO-LIFE-WITH-AH-CHECKS.
 18347
 18348
 18349     .
 18350 6380-EXIT.
 18351     EXIT.
 18352
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 335
* EL050.cbl
 18354
 18355 6400-COMPUTE-EXTENSION-DAYS.
 18356
 18357******************************************************************
 18358*                                                                *
 18359*                   COMPUTE EXTENSION DAYS                       *
 18360*                                                                *
 18361*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18362*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18363*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18364*    THE EXTENSION DAYS.                                         *
 18365*                                                                *
 18366******************************************************************
 18367
 18368     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18369     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18370
 18371******************************************************************
 18372*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18373*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18374******************************************************************
 18375
 18376     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18377        COMPUTE WS-ODD-DAYS-OVER =
 18378               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18379     ELSE
 18380        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18381
 18382     IF WS-ODD-DAYS-OVER = ZEROS
 18383           GO TO 6499-EXIT
 18384     ELSE
 18385        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18386           IF WS-WDF-MONTH = 02
 18387              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18388              ADD 2       TO  WS-ODD-DAYS-OVER
 18389              GO TO 6499-EXIT
 18390           ELSE
 18391              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18392                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18393                 GO TO 6499-EXIT
 18394               ELSE
 18395                 GO TO 6499-EXIT
 18396        ELSE
 18397           GO TO 6499-EXIT.
 18398
 18399 6412-CHECK-TO-DAY.
 18400
 18401        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18402           IF WS-WDT-DAY = 28
 18403              ADD 2              TO WS-ODD-DAYS-OVER
 18404           ELSE
 18405              IF WS-WDT-DAY = 29
 18406                 ADD 1           TO WS-ODD-DAYS-OVER
 18407              ELSE
 18408                 NEXT SENTENCE
 18409        ELSE
 18410           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18411              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 336
* EL050.cbl
 18412
 18413     GO TO 6499-EXIT.
 18414
 18415
 18416 6415-CHECK-LEAP-YEAR.
 18417
 18418     IF DC-DAYS-IN-MONTH = 29
 18419        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18420
 18421 6415-EXIT.
 18422     EXIT.
 18423
 18424 6499-EXIT.
 18425      EXIT.
 18426
 18427 6500-END.
 18428     EXIT.
 18429
 18430
 18431******************************************************************
 18432************* PROCEDURE DIVISION FOR EL050 ***********************
 18433********************** ELC50PD END *******************************
 18434
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 337
* EL050.cbl
 18436
 18437**START***********************************************************
 18438*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18439*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18440******************************************************************
 18441*
 18442 6600-GET-STATE-MUNICIPAL-TAX.
 18443
 18444     IF PB-COMPANY-ID NOT = 'DMD'
 18445         GO TO 6640-EXIT.
 18446
 18447     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18448     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18449     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18450*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18451*
 18452***  Y2K PROJ 7744
 18453     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18454     SET BIN-TO-GREG          TO TRUE.
 18455     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18456
 18457     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18458
 18459     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18460     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18461
 18462
 18463* EXEC CICS HANDLE CONDITION
 18464*        INVREQ    (6610-START-BROWSE)
 18465*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18466*        NOTFND    (6630-END-OF-FILE)
 18467*    END-EXEC.
 18468*    MOVE '"$8JI                 ! # #00018450' TO DFHEIV0
 18469     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18471     MOVE X'2320233030303138343530' TO DFHEIV0(25:11)
 18472     CALL 'kxdfhei1' USING DFHEIV0
 18473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18474
 18475
 18476 6610-START-BROWSE.
 18477
 18478
 18479* EXEC CICS HANDLE CONDITION
 18480*        NOTFND    (6630-END-OF-FILE)
 18481*        DISABLED  (6630-ERRESS-PROBLEM)
 18482*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18483*        ENDFILE   (6630-END-OF-FILE)
 18484*    END-EXEC.
 18485*    MOVE '"$IcJ''                ! $ #00018458' TO DFHEIV0
 18486     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18487     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18488     MOVE X'2420233030303138343538' TO DFHEIV0(25:11)
 18489     CALL 'kxdfhei1' USING DFHEIV0
 18490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18491
 18492
 18493
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 338
* EL050.cbl
 18494* EXEC CICS STARTBR
 18495*        DATASET (FILE-ID-ERRESS)
 18496*        RIDFLD  (WS-ERRESS-KEY)
 18497*        GTEQ
 18498*    END-EXEC.
 18499     MOVE 0
 18500       TO DFHEIV11
 18501*    MOVE '&,         G          &   #00018465' TO DFHEIV0
 18502     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18503     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18504     MOVE X'2020233030303138343635' TO DFHEIV0(25:11)
 18505     CALL 'kxdfhei1' USING DFHEIV0,
 18506           FILE-ID-ERRESS,
 18507           WS-ERRESS-KEY,
 18508           DFHEIV99,
 18509           DFHEIV11,
 18510           DFHEIV99
 18511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18512
 18513
 18514 6620-READ-NEXT-ERRESS-MASTER.
 18515
 18516
 18517* EXEC CICS HANDLE CONDITION
 18518*        NOTFND    (6630-END-OF-FILE)
 18519*        ENDFILE   (6630-END-OF-FILE)
 18520*        DISABLED  (6630-ERRESS-PROBLEM)
 18521*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18522*    END-EXEC.
 18523*    MOVE '"$I''cJ                ! % #00018473' TO DFHEIV0
 18524     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18526     MOVE X'2520233030303138343733' TO DFHEIV0(25:11)
 18527     CALL 'kxdfhei1' USING DFHEIV0
 18528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18529
 18530
 18531
 18532* EXEC CICS READNEXT
 18533*        DATASET (FILE-ID-ERRESS)
 18534*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18535*        RIDFLD  (WS-ERRESS-KEY)
 18536*    END-EXEC.
 18537     MOVE LENGTH OF
 18538      RESIDENT-STATE-TAX-MASTER
 18539       TO DFHEIV12
 18540     MOVE 0
 18541       TO DFHEIV11
 18542*    MOVE '&.IL                  )   #00018480' TO DFHEIV0
 18543     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18544     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18545     MOVE X'2020233030303138343830' TO DFHEIV0(25:11)
 18546     CALL 'kxdfhei1' USING DFHEIV0,
 18547           FILE-ID-ERRESS,
 18548           RESIDENT-STATE-TAX-MASTER,
 18549           DFHEIV12,
 18550           WS-ERRESS-KEY,
 18551           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 339
* EL050.cbl
 18552           DFHEIV11,
 18553           DFHEIV99,
 18554           DFHEIV99
 18555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18556
 18557
 18558     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18559
 18560* EXEC CICS ENDBR
 18561*            DATASET (FILE-ID-ERRESS)
 18562*       END-EXEC
 18563     MOVE 0
 18564       TO DFHEIV11
 18565*    MOVE '&2                    $   #00018487' TO DFHEIV0
 18566     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18567     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18568     MOVE X'2020233030303138343837' TO DFHEIV0(25:11)
 18569     CALL 'kxdfhei1' USING DFHEIV0,
 18570           FILE-ID-ERRESS,
 18571           DFHEIV11,
 18572           DFHEIV99
 18573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18574        GO TO 6630-END-OF-FILE.
 18575
 18576     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18577        NEXT SENTENCE
 18578      ELSE
 18579        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18580
 18581*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18582*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18583*
 18584     MOVE +2                     TO WS-SUB1.
 18585
 18586     IF PB-ISSUE
 18587     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18588        MOVE +1                  TO WS-SUB1.
 18589
 18590     IF PB-CANCELLATION
 18591     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18592        MOVE +1                  TO WS-SUB1.
 18593*
 18594*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18595*
 18596***  Y2K PROJ 7744
 18597     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18598***  Y2K PROJ 7744
 18599
 18600*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18601* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18602* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18603
 18604     ADD 1                    TO WS-YEAR-YY.
 18605
 18606     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18607         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18608                              TO WS-RES-STATE-TAX
 18609         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 340
* EL050.cbl
 18610                              TO WS-RES-MUNI-TAX
 18611     ELSE
 18612         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18613                              TO WS-RES-STATE-TAX
 18614         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18615                              TO WS-RES-MUNI-TAX.
 18616
 18617*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18618
 18619     IF PB-CANCELLATION
 18620         GO TO 6640-CANCEL-TAX.
 18621
 18622     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18623         COMPUTE PB-I-STATE-TAX ROUNDED =
 18624                                   PB-I-LF-PREMIUM-AMT
 18625                                 * WS-RES-STATE-TAX
 18626         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18627                                   PB-I-LF-PREMIUM-AMT
 18628                                 * WS-RES-MUNI-TAX
 18629     ELSE
 18630     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18631         COMPUTE PB-I-STATE-TAX ROUNDED =
 18632                                   PB-I-AH-PREMIUM-AMT
 18633                                 * WS-RES-STATE-TAX
 18634         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18635                                   PB-I-AH-PREMIUM-AMT
 18636                                 * WS-RES-MUNI-TAX.
 18637
 18638
 18639* EXEC CICS ENDBR
 18640*         DATASET (FILE-ID-ERRESS)
 18641*    END-EXEC.
 18642     MOVE 0
 18643       TO DFHEIV11
 18644*    MOVE '&2                    $   #00018554' TO DFHEIV0
 18645     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18646     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18647     MOVE X'2020233030303138353534' TO DFHEIV0(25:11)
 18648     CALL 'kxdfhei1' USING DFHEIV0,
 18649           FILE-ID-ERRESS,
 18650           DFHEIV11,
 18651           DFHEIV99
 18652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18653
 18654
 18655     GO TO 6640-EXIT.
 18656
 18657 6640-CANCEL-TAX.
 18658     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18659
 18660     IF PB-C-LF-CANCEL-AMT > ZEROS
 18661         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18662                                   PB-C-LF-CANCEL-AMT
 18663                                 * WS-RES-STATE-TAX
 18664         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18665                                   PB-C-LF-CANCEL-AMT
 18666                                *  WS-RES-MUNI-TAX
 18667     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 341
* EL050.cbl
 18668     IF PB-C-AH-CANCEL-AMT > ZEROS
 18669         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18670                                   PB-C-AH-CANCEL-AMT
 18671                                 * WS-RES-STATE-TAX
 18672         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18673                                   PB-C-AH-CANCEL-AMT
 18674                                *  WS-RES-MUNI-TAX.
 18675
 18676
 18677* EXEC CICS ENDBR
 18678*         DATASET (FILE-ID-ERRESS)
 18679*    END-EXEC.
 18680     MOVE 0
 18681       TO DFHEIV11
 18682*    MOVE '&2                    $   #00018579' TO DFHEIV0
 18683     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18684     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18685     MOVE X'2020233030303138353739' TO DFHEIV0(25:11)
 18686     CALL 'kxdfhei1' USING DFHEIV0,
 18687           FILE-ID-ERRESS,
 18688           DFHEIV11,
 18689           DFHEIV99
 18690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18691
 18692
 18693     GO TO 6640-EXIT.
 18694
 18695 6630-END-OF-FILE.
 18696     MOVE ER-8002              TO WS-ERROR.
 18697     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18698
 18699     GO TO 6640-EXIT.
 18700
 18701 6630-ERRESS-PROBLEM.
 18702     MOVE ER-8044              TO WS-ERROR.
 18703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18704
 18705 6640-EXIT.
 18706     EXIT.
 18707
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 342
* EL050.cbl
 18709 6650-GET-RES-STATE-COMM.
 18710
 18711     IF PB-COMPANY-ID NOT = 'DMD'
 18712         GO TO 6700-COMM-EXIT.
 18713
 18714     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18715     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18716     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18717     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18718     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18719     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18720     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18721
 18722*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18723*
 18724***  Y2K PROJ 7744
 18725     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18726     SET BIN-TO-GREG          TO TRUE.
 18727     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18728
 18729     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18730***  Y2K PROJ 7744
 18731
 18732     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18733
 18734
 18735* EXEC CICS HANDLE CONDITION
 18736*        INVREQ    (6660-START-BROWSE)
 18737*        DISABLED  (6690-ERRESC-PROBLEM)
 18738*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18739*        NOTFND    (6690-END-OF-FILE)
 18740*    END-EXEC.
 18741*    MOVE '"$8cJI                ! & #00018624' TO DFHEIV0
 18742     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18744     MOVE X'2620233030303138363234' TO DFHEIV0(25:11)
 18745     CALL 'kxdfhei1' USING DFHEIV0
 18746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18747
 18748
 18749
 18750* EXEC CICS RESETBR
 18751*        DATASET (FILE-ID-ERRESC)
 18752*        RIDFLD  (WS-ERRESC-KEY)
 18753*    END-EXEC.
 18754     MOVE 0
 18755       TO DFHEIV11
 18756*    MOVE '&4         G          &   #00018631' TO DFHEIV0
 18757     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18758     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18759     MOVE X'2020233030303138363331' TO DFHEIV0(25:11)
 18760     CALL 'kxdfhei1' USING DFHEIV0,
 18761           FILE-ID-ERRESC,
 18762           WS-ERRESC-KEY,
 18763           DFHEIV99,
 18764           DFHEIV11,
 18765           DFHEIV99
 18766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 343
* EL050.cbl
 18767
 18768
 18769 6660-START-BROWSE.
 18770
 18771
 18772* EXEC CICS HANDLE CONDITION
 18773*        NOTFND    (6690-END-OF-FILE)
 18774*        DISABLED  (6690-ERRESC-PROBLEM)
 18775*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18776*        ENDFILE   (6690-END-OF-FILE)
 18777*    END-EXEC.
 18778*    MOVE '"$IcJ''                ! '' #00018638' TO DFHEIV0
 18779     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18781     MOVE X'2720233030303138363338' TO DFHEIV0(25:11)
 18782     CALL 'kxdfhei1' USING DFHEIV0
 18783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18784
 18785
 18786
 18787* EXEC CICS STARTBR
 18788*        DATASET (FILE-ID-ERRESC)
 18789*        RIDFLD  (WS-ERRESC-KEY)
 18790*        GTEQ
 18791*    END-EXEC.
 18792     MOVE 0
 18793       TO DFHEIV11
 18794*    MOVE '&,         G          &   #00018645' TO DFHEIV0
 18795     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18796     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18797     MOVE X'2020233030303138363435' TO DFHEIV0(25:11)
 18798     CALL 'kxdfhei1' USING DFHEIV0,
 18799           FILE-ID-ERRESC,
 18800           WS-ERRESC-KEY,
 18801           DFHEIV99,
 18802           DFHEIV11,
 18803           DFHEIV99
 18804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18805
 18806
 18807     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18808
 18809 6670-READ-NEXT-ERRESC-MASTER.
 18810
 18811
 18812* EXEC CICS HANDLE CONDITION
 18813*        NOTFND    (6690-END-OF-FILE)
 18814*        DISABLED  (6690-ERRESC-PROBLEM)
 18815*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18816*        ENDFILE   (6690-END-OF-FILE)
 18817*    END-EXEC.
 18818*    MOVE '"$IcJ''                ! ( #00018655' TO DFHEIV0
 18819     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18821     MOVE X'2820233030303138363535' TO DFHEIV0(25:11)
 18822     CALL 'kxdfhei1' USING DFHEIV0
 18823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18824
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 344
* EL050.cbl
 18825
 18826
 18827* EXEC CICS READNEXT
 18828*        DATASET (FILE-ID-ERRESC)
 18829*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18830*        RIDFLD  (ERRESC-RECORD-KEY)
 18831*    END-EXEC.
 18832     MOVE LENGTH OF
 18833      ACCOUNT-RESIDENT-ST-COMMISSION
 18834       TO DFHEIV12
 18835     MOVE 0
 18836       TO DFHEIV11
 18837*    MOVE '&.IL                  )   #00018662' TO DFHEIV0
 18838     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18839     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18840     MOVE X'2020233030303138363632' TO DFHEIV0(25:11)
 18841     CALL 'kxdfhei1' USING DFHEIV0,
 18842           FILE-ID-ERRESC,
 18843           ACCOUNT-RESIDENT-ST-COMMISSION,
 18844           DFHEIV12,
 18845           ERRESC-RECORD-KEY,
 18846           DFHEIV99,
 18847           DFHEIV11,
 18848           DFHEIV99,
 18849           DFHEIV99
 18850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18851
 18852
 18853     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18854        NEXT SENTENCE
 18855     ELSE
 18856
 18857* EXEC CICS ENDBR
 18858*            DATASET (FILE-ID-ERRESC)
 18859*       END-EXEC
 18860     MOVE 0
 18861       TO DFHEIV11
 18862*    MOVE '&2                    $   #00018671' TO DFHEIV0
 18863     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18864     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18865     MOVE X'2020233030303138363731' TO DFHEIV0(25:11)
 18866     CALL 'kxdfhei1' USING DFHEIV0,
 18867           FILE-ID-ERRESC,
 18868           DFHEIV11,
 18869           DFHEIV99
 18870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18871        GO TO 6690-END-OF-FILE.
 18872
 18873     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18874
 18875* EXEC CICS ENDBR
 18876*            DATASET (FILE-ID-ERRESC)
 18877*       END-EXEC
 18878     MOVE 0
 18879       TO DFHEIV11
 18880*    MOVE '&2                    $   #00018677' TO DFHEIV0
 18881     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18882     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 345
* EL050.cbl
 18883     MOVE X'2020233030303138363737' TO DFHEIV0(25:11)
 18884     CALL 'kxdfhei1' USING DFHEIV0,
 18885           FILE-ID-ERRESC,
 18886           DFHEIV11,
 18887           DFHEIV99
 18888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18889        GO TO 6690-END-OF-FILE.
 18890
 18891     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18892        NEXT SENTENCE
 18893      ELSE
 18894        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18895
 18896* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18897*
 18898     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18899
 18900     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18901
 18902     IF WS-SUB1 > ZERO
 18903         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18904             PERFORM 6680-SET-COMMISSION
 18905         ELSE
 18906             PERFORM 6680-SET-TABLE-CODE.
 18907
 18908
 18909* EXEC CICS ENDBR
 18910*         DATASET (FILE-ID-ERRESC)
 18911*    END-EXEC.
 18912     MOVE 0
 18913       TO DFHEIV11
 18914*    MOVE '&2                    $   #00018699' TO DFHEIV0
 18915     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18917     MOVE X'2020233030303138363939' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0,
 18919           FILE-ID-ERRESC,
 18920           DFHEIV11,
 18921           DFHEIV99
 18922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18923
 18924
 18925     GO TO 6700-COMM-EXIT.
 18926
 18927 6680-SET-TABLE-CODE.
 18928     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18929        MOVE ZEROS             TO WS-SUB1
 18930     ELSE
 18931* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18932* TO COMPUTE AH COMMISSION.
 18933        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18934        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18935        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18936        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18937        PERFORM 6680-READ-CTBL-TABLE
 18938        IF WS-CTBL-READ-SW NOT = 'Y'
 18939           MOVE ZEROS          TO WS-SUB1.
 18940
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 346
* EL050.cbl
 18941 6680-READ-CTBL-TABLE.
 18942*
 18943* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18944* TO COMPUTE LIFE COMMISSION
 18945
 18946     IF CTBL-SW = '0540'
 18947        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18948        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18949        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18950
 18951     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18952
 18953     IF CTBL-TABLE-FOUND
 18954        IF CTBL-SW = '0530'
 18955             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18956                                    * PB-I-AH-TERM
 18957             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18958             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18959        ELSE
 18960             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18961             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18962             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18963     ELSE
 18964        IF FIRST-TIME-THROUGH
 18965            GO TO 6680-READ-CTBL-TABLE
 18966        ELSE
 18967            MOVE ZEROS         TO WS-SUB1.
 18968
 18969 6680-SET-COMMISSION.
 18970     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18971           MOVE ZEROS          TO WS-SUB1
 18972       ELSE
 18973           MOVE RESC-COMMISSION-PER (WS-SUB)
 18974                               TO WS-COMMISSION
 18975           IF CTBL-SW = '0530'
 18976               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18977           ELSE
 18978               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18979
 18980 6680-SEARCH-CATEGORY.
 18981     ADD +1                   TO WS-SUB.
 18982     IF WS-SUB > +12
 18983         GO TO 6680-EXIT.
 18984
 18985     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18986          MOVE WS-SUB         TO WS-SUB1
 18987          GO TO 6680-EXIT.
 18988
 18989     GO TO 6680-SEARCH-CATEGORY.
 18990
 18991 6680-EXIT.
 18992     EXIT.
 18993
 18994 6690-END-OF-FILE.
 18995     GO TO 6700-COMM-EXIT.
 18996
 18997 6690-ERRESC-PROBLEM.
 18998      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 347
* EL050.cbl
 18999      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19000
 19001      GO TO 6700-COMM-EXIT.
 19002
 19003 6700-COMM-EXIT.
 19004     EXIT.
 19005
 19006 7000-GET-RATE.
 19007
 19008* EXEC CICS LINK
 19009*        PROGRAM    ('ELRATE')
 19010*        COMMAREA   (CALCULATION-PASS-AREA)
 19011*        LENGTH     (CP-COMM-LENGTH)
 19012*    END-EXEC.
 19013     MOVE 'ELRATE' TO DFHEIV1
 19014*    MOVE '."C                   (   #00018785' TO DFHEIV0
 19015     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19016     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19017     MOVE X'2020233030303138373835' TO DFHEIV0(25:11)
 19018     CALL 'kxdfhei1' USING DFHEIV0,
 19019           DFHEIV1,
 19020           CALCULATION-PASS-AREA,
 19021           CP-COMM-LENGTH,
 19022           DFHEIV99,
 19023           DFHEIV99,
 19024           DFHEIV99,
 19025           DFHEIV99
 19026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19027
 19028
 19029 7000-EXIT.
 19030     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 348
* EL050.cbl
 19032 7100-FIND-BENEFIT-IN-STATE.
 19033     MOVE 'N'                    TO BEN-SEARCH-SW.
 19034
 19035     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 19036         VARYING SUB3 FROM 1 BY 1 UNTIL
 19037            ((SUB3 GREATER 50) OR
 19038              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 19039               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 19040
 19041     IF SUB3 NOT = 51
 19042         MOVE 'Y'                TO BEN-SEARCH-SW.
 19043
 19044     GO TO 7199-EXIT.
 19045
 19046 7100-BENEFIT-DUMMY.
 19047
 19048 7100-DUMMY-EXIT.
 19049     EXIT.
 19050
 19051 7199-EXIT.
 19052     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 349
* EL050.cbl
 19054 7200-FIND-BENEFIT.
 19055     MOVE 'N'                    TO BEN-SEARCH-SW.
 19056
 19057     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 19058         VARYING SUB3 FROM 1 BY 1 UNTIL
 19059            ((SUB3 GREATER 8) OR
 19060            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 19061
 19062     IF SUB3 NOT = 9
 19063         MOVE 'Y'                TO BEN-SEARCH-SW.
 19064
 19065     GO TO 7200-EXIT.
 19066
 19067 7200-BENEFIT-DUMMY.
 19068
 19069 7200-DUMMY-EXIT.
 19070     EXIT.
 19071
 19072 7200-EXIT.
 19073     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 350
* EL050.cbl
 19075 7250-LOOK-FOR-RESCINDED-CLAIM.
 19076     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19077                                    W-CL-COMP-CD.
 19078     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19079                                    W-CL-CERT-NO.
 19080
 19081
 19082* EXEC CICS HANDLE CONDITION
 19083*        NOTFND  (7250-CONTINUE)
 19084*        ENDFILE (7250-CONTINUE)
 19085*    END-EXEC.
 19086*    MOVE '"$I''                  ! ) #00018843' TO DFHEIV0
 19087     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19089     MOVE X'2920233030303138383433' TO DFHEIV0(25:11)
 19090     CALL 'kxdfhei1' USING DFHEIV0
 19091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19092
 19093
 19094
 19095* EXEC CICS IGNORE CONDITION
 19096*        DUPKEY
 19097*    END-EXEC.
 19098*    MOVE '"*$                   !   #00018848' TO DFHEIV0
 19099     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19101     MOVE X'2020233030303138383438' TO DFHEIV0(25:11)
 19102     CALL 'kxdfhei1' USING DFHEIV0
 19103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19104
 19105
 19106
 19107* EXEC CICS STARTBR
 19108*        DATASET   (CLMS-ID)
 19109*        RIDFLD    (ELMSTR-KEY)
 19110*        GENERIC   EQUAL
 19111*        KEYLENGTH (ELMSTR-LENGTH)
 19112*    END-EXEC.
 19113     MOVE 0
 19114       TO DFHEIV11
 19115*    MOVE '&,   KG    E          &   #00018852' TO DFHEIV0
 19116     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19117     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19118     MOVE X'2020233030303138383532' TO DFHEIV0(25:11)
 19119     CALL 'kxdfhei1' USING DFHEIV0,
 19120           CLMS-ID,
 19121           ELMSTR-KEY,
 19122           ELMSTR-LENGTH,
 19123           DFHEIV11,
 19124           DFHEIV99
 19125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19126
 19127
 19128     MOVE 'Y'                    TO W-BROWSE-SW.
 19129
 19130 7250-NEXT-CLAIM.
 19131
 19132
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 351
* EL050.cbl
 19133* EXEC CICS READNEXT
 19134*        DATASET   (CLMS-ID)
 19135*        RIDFLD    (ELMSTR-KEY)
 19136*        SET       (ADDRESS OF CLAIM-MASTER)
 19137*    END-EXEC.
 19138     MOVE 0
 19139       TO DFHEIV11
 19140*    MOVE '&.S                   )   #00018863' TO DFHEIV0
 19141     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19142     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19143     MOVE X'2020233030303138383633' TO DFHEIV0(25:11)
 19144     CALL 'kxdfhei1' USING DFHEIV0,
 19145           CLMS-ID,
 19146           DFHEIV20,
 19147           DFHEIV99,
 19148           ELMSTR-KEY,
 19149           DFHEIV99,
 19150           DFHEIV11,
 19151           DFHEIV99,
 19152           DFHEIV99
 19153     SET ADDRESS OF CLAIM-MASTER TO
 19154         DFHEIV20
 19155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19156
 19157
 19158     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19159        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19160         GO TO 7250-CONTINUE
 19161     END-IF.
 19162
 19163     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19164        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19165        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19166        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19167        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19168         GO TO 7250-NEXT-CLAIM
 19169     END-IF.
 19170
 19171     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19172        OR (CL-CLAIM-TYPE = 'I')
 19173        OR (CL-CLAIM-TYPE = 'G')
 19174        OR (CL-CLAIM-TYPE = 'F')
 19175          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19176              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19177              GO TO 7250-CONTINUE
 19178          END-IF
 19179     END-IF.
 19180
 19181     GO TO 7250-NEXT-CLAIM.
 19182
 19183 7250-CONTINUE.
 19184
 19185     IF W-BROWSE-SW = 'Y'
 19186
 19187* EXEC CICS ENDBR
 19188*            DATASET   (CLMS-ID)
 19189*        END-EXEC
 19190     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 352
* EL050.cbl
 19191       TO DFHEIV11
 19192*    MOVE '&2                    $   #00018897' TO DFHEIV0
 19193     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19194     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19195     MOVE X'2020233030303138383937' TO DFHEIV0(25:11)
 19196     CALL 'kxdfhei1' USING DFHEIV0,
 19197           CLMS-ID,
 19198           DFHEIV11,
 19199           DFHEIV99
 19200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19201         MOVE 'N' TO W-BROWSE-SW
 19202     END-IF.
 19203
 19204 7250-EXIT.
 19205     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 353
* EL050.cbl
 19207 7300-CHECK-FOR-OPEN-CLMS.
 19208
 19209*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19210*    MOVE SPACES                 TO CNTL-ACCESS.
 19211*    MOVE '1'                    TO CNTL-REC-TYPE.
 19212*    MOVE +0                     TO CNTL-SEQ-NO.
 19213
 19214*    MOVE '3'                    TO RC-SW-1.
 19215*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19216
 19217*    IF NOT CF-COMPANY-MASTER
 19218*         PERFORM 0099-COMPANY-NOT-FOUND
 19219*         GO TO 7300-EXIT.
 19220
 19221     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19222                                    W-CL-COMP-CD.
 19223     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19224                                    W-CL-CERT-NO.
 19225
 19226
 19227* EXEC CICS HANDLE CONDITION
 19228*        NOTFND  (7300-CONTINUE)
 19229*        ENDFILE (7300-CONTINUE)
 19230*    END-EXEC.
 19231*    MOVE '"$I''                  ! * #00018925' TO DFHEIV0
 19232     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19234     MOVE X'2A20233030303138393235' TO DFHEIV0(25:11)
 19235     CALL 'kxdfhei1' USING DFHEIV0
 19236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19237
 19238
 19239
 19240* EXEC CICS IGNORE CONDITION
 19241*        DUPKEY
 19242*    END-EXEC.
 19243*    MOVE '"*$                   !   #00018930' TO DFHEIV0
 19244     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19246     MOVE X'2020233030303138393330' TO DFHEIV0(25:11)
 19247     CALL 'kxdfhei1' USING DFHEIV0
 19248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19249
 19250
 19251
 19252* EXEC CICS STARTBR
 19253*        DATASET   (CLMS-ID)
 19254*        RIDFLD    (ELMSTR-KEY)
 19255*        GENERIC   EQUAL
 19256*        KEYLENGTH (ELMSTR-LENGTH)
 19257*    END-EXEC.
 19258     MOVE 0
 19259       TO DFHEIV11
 19260*    MOVE '&,   KG    E          &   #00018934' TO DFHEIV0
 19261     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19262     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19263     MOVE X'2020233030303138393334' TO DFHEIV0(25:11)
 19264     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 354
* EL050.cbl
 19265           CLMS-ID,
 19266           ELMSTR-KEY,
 19267           ELMSTR-LENGTH,
 19268           DFHEIV11,
 19269           DFHEIV99
 19270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19271
 19272
 19273     MOVE 'Y'                    TO W-BROWSE-SW.
 19274
 19275 7300-NEXT-CLAIM.
 19276
 19277
 19278* EXEC CICS READNEXT
 19279*        DATASET   (CLMS-ID)
 19280*        RIDFLD    (ELMSTR-KEY)
 19281*        SET       (ADDRESS OF CLAIM-MASTER)
 19282*    END-EXEC.
 19283     MOVE 0
 19284       TO DFHEIV11
 19285*    MOVE '&.S                   )   #00018945' TO DFHEIV0
 19286     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19287     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19288     MOVE X'2020233030303138393435' TO DFHEIV0(25:11)
 19289     CALL 'kxdfhei1' USING DFHEIV0,
 19290           CLMS-ID,
 19291           DFHEIV20,
 19292           DFHEIV99,
 19293           ELMSTR-KEY,
 19294           DFHEIV99,
 19295           DFHEIV11,
 19296           DFHEIV99,
 19297           DFHEIV99
 19298     SET ADDRESS OF CLAIM-MASTER TO
 19299         DFHEIV20
 19300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19301
 19302
 19303     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19304        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19305         GO TO 7300-CONTINUE.
 19306
 19307     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19308        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19309        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19310        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19311        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19312         GO TO 7300-NEXT-CLAIM.
 19313
 19314*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19315     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19316        OR (CL-CLAIM-TYPE = 'I')
 19317        OR (CL-CLAIM-TYPE = 'G')
 19318        OR (CL-CLAIM-TYPE = 'F')
 19319        IF CLAIM-IS-OPEN
 19320           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19321             AND PB-C-AH-CANCEL-DT > SPACES
 19322              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 355
* EL050.cbl
 19323              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19324           END-IF
 19325           EVALUATE TRUE
 19326             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19327                 MOVE ER-2884      TO WS-ERROR
 19328             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19329                 MOVE ER-2887      TO WS-ERROR
 19330             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19331                 MOVE ER-2886      TO WS-ERROR
 19332             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19333                 MOVE ER-2888      TO WS-ERROR
 19334             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19335                 MOVE ER-2885      TO WS-ERROR
 19336             WHEN OTHER
 19337                 MOVE ER-2768      TO WS-ERROR
 19338           END-EVALUATE
 19339           IF PB-C-AH-CANCEL-VOIDED OR
 19340              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19341                NOT AH-COVERAGE-CANCELLED)
 19342               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19343               MOVE ER-2768      TO WS-ERROR
 19344           END-IF
 19345           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19346           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19347              PB-FORCE-CODE NOT EQUAL '8'
 19348               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19349           END-IF
 19350           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19351           GO TO 7300-NEXT-CLAIM
 19352        ELSE
 19353           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19354*****THIS IS A RESCISSION OR REFORMATION
 19355              IF AH-COVERAGE-CANCELLED
 19356                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19357                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19358                    MOVE 1                   TO DC-ELAPSED-DAYS
 19359                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19360                    SET BIN-PLUS-ELAPSED     TO TRUE
 19361                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19362                    IF NO-CONVERSION-ERROR
 19363                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19364                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19365                          MOVE ER-2897 TO WS-ERROR
 19366                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19367                          GO TO 7300-NEXT-CLAIM
 19368                       END-IF
 19369                    END-IF
 19370                 ELSE
 19371                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19372                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19373                         MOVE ER-2890 TO WS-ERROR
 19374                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19375                         GO TO 7300-NEXT-CLAIM
 19376                      ELSE
 19377                         MOVE ER-2898 TO WS-ERROR
 19378                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19379                         GO TO 7300-NEXT-CLAIM
 19380                      END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 356
* EL050.cbl
 19381                   END-IF
 19382                 END-IF
 19383              END-IF
 19384           ELSE
 19385              IF CL-DENIAL-TYPE = '1'  AND
 19386                 CL-TOTAL-PAID-AMT = 0
 19387                    GO TO 7300-NEXT-CLAIM
 19388              END-IF
 19389              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19390               AND PB-C-AH-CANCEL-DT > SPACES
 19391                 MOVE ER-2756        TO WS-ERROR
 19392                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19393                 GO TO 7300-NEXT-CLAIM
 19394              END-IF
 19395           END-IF
 19396        END-IF
 19397     ELSE
 19398*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19399        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19400           IF (CLAIM-IS-OPEN)
 19401              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19402                 <> zeros
 19403              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19404                 <> zeros)
 19405              MOVE ER-2889      TO WS-ERROR
 19406              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19407              GO TO 7300-NEXT-CLAIM
 19408           ELSE
 19409              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19410*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19411                 IF (LF-COVERAGE-CANCELLED AND
 19412                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19413                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19414                         MOVE ER-2890 TO WS-ERROR
 19415                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19416                         GO TO 7300-NEXT-CLAIM
 19417                      ELSE
 19418                         MOVE ER-2898 TO WS-ERROR
 19419                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19420                         GO TO 7300-NEXT-CLAIM
 19421                      END-IF
 19422                 END-IF
 19423              ELSE
 19424                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19425                    and (CL-TOTAL-PAID-AMT = 0)
 19426                    GO TO 7300-NEXT-CLAIM
 19427                 END-IF
 19428                 IF (
 19429                      (AH-COVERAGE-CANCELLED)
 19430                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19431                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19432                      and (pb-ci-ah-cancel-amt +
 19433                         pb-c-ah-cancel-amt) <> zeros
 19434                    )
 19435                               OR
 19436                    (
 19437                      (LF-COVERAGE-CANCELLED)
 19438                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 357
* EL050.cbl
 19439                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19440                      and (pb-ci-lf-cancel-amt +
 19441                         pb-c-lf-cancel-amt) <> zeros
 19442                    )
 19443                       MOVE ER-2965 TO WS-ERROR
 19444                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19445                       GO TO 7300-NEXT-CLAIM
 19446                 END-IF
 19447                 IF LF-COVERAGE-CANCELLED
 19448                  IF CL-TOTAL-PAID-AMT > 0
 19449                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19450                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19451                        MOVE ER-2891 TO WS-ERROR
 19452                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19453                        GO TO 7300-NEXT-CLAIM
 19454                      END-IF
 19455                    ELSE
 19456****only show this error if cert num matches exactly
 19457                      IF PB-CERT-NO = CL-CERT-NO
 19458                         MOVE ER-2892 TO WS-ERROR
 19459                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19460                         GO TO 7300-NEXT-CLAIM
 19461                      END-IF
 19462                    END-IF
 19463                  END-IF
 19464                 END-IF
 19465              END-IF
 19466           END-IF
 19467        END-IF
 19468     END-IF
 19469
 19470     GO TO 7300-NEXT-CLAIM.
 19471
 19472 7300-CONTINUE.
 19473
 19474     IF W-BROWSE-SW = 'Y'
 19475
 19476* EXEC CICS ENDBR
 19477*            DATASET   (CLMS-ID)
 19478*        END-EXEC.
 19479     MOVE 0
 19480       TO DFHEIV11
 19481*    MOVE '&2                    $   #00019123' TO DFHEIV0
 19482     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19484     MOVE X'2020233030303139313233' TO DFHEIV0(25:11)
 19485     CALL 'kxdfhei1' USING DFHEIV0,
 19486           CLMS-ID,
 19487           DFHEIV11,
 19488           DFHEIV99
 19489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19490
 19491
 19492 7300-EXIT.
 19493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 358
* EL050.cbl
 19495
 19496 7400-GET-REMAIN-TERM.
 19497
 19498* EXEC CICS LINK
 19499*        PROGRAM    ('ELRTRM')
 19500*        COMMAREA   (CALCULATION-PASS-AREA)
 19501*        LENGTH     (CP-COMM-LENGTH)
 19502*    END-EXEC.
 19503     MOVE 'ELRTRM' TO DFHEIV1
 19504*    MOVE '."C                   (   #00019132' TO DFHEIV0
 19505     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19507     MOVE X'2020233030303139313332' TO DFHEIV0(25:11)
 19508     CALL 'kxdfhei1' USING DFHEIV0,
 19509           DFHEIV1,
 19510           CALCULATION-PASS-AREA,
 19511           CP-COMM-LENGTH,
 19512           DFHEIV99,
 19513           DFHEIV99,
 19514           DFHEIV99,
 19515           DFHEIV99
 19516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19517
 19518
 19519 7400-EXIT.
 19520     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 359
* EL050.cbl
 19522
 19523 7500-GET-REMAIN-AMOUNT.
 19524
 19525* EXEC CICS LINK
 19526*        PROGRAM    ('ELRAMT')
 19527*        COMMAREA   (CALCULATION-PASS-AREA)
 19528*        LENGTH     (CP-COMM-LENGTH)
 19529*    END-EXEC.
 19530     MOVE 'ELRAMT' TO DFHEIV1
 19531*    MOVE '."C                   (   #00019143' TO DFHEIV0
 19532     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19533     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19534     MOVE X'2020233030303139313433' TO DFHEIV0(25:11)
 19535     CALL 'kxdfhei1' USING DFHEIV0,
 19536           DFHEIV1,
 19537           CALCULATION-PASS-AREA,
 19538           CP-COMM-LENGTH,
 19539           DFHEIV99,
 19540           DFHEIV99,
 19541           DFHEIV99,
 19542           DFHEIV99
 19543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19544
 19545
 19546 7500-EXIT.
 19547     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 360
* EL050.cbl
 19549
 19550 7600-GET-REFUND.
 19551
 19552* EXEC CICS LINK
 19553*        PROGRAM    ('ELRFND')
 19554*        COMMAREA   (CALCULATION-PASS-AREA)
 19555*        LENGTH     (CP-COMM-LENGTH)
 19556*    END-EXEC.
 19557     MOVE 'ELRFND' TO DFHEIV1
 19558*    MOVE '."C                   (   #00019154' TO DFHEIV0
 19559     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19560     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19561     MOVE X'2020233030303139313534' TO DFHEIV0(25:11)
 19562     CALL 'kxdfhei1' USING DFHEIV0,
 19563           DFHEIV1,
 19564           CALCULATION-PASS-AREA,
 19565           CP-COMM-LENGTH,
 19566           DFHEIV99,
 19567           DFHEIV99,
 19568           DFHEIV99,
 19569           DFHEIV99
 19570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19571
 19572
 19573 7600-EXIT.
 19574     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 361
* EL050.cbl
 19576 7700-CALL-DL1.
 19577
 19578* EXEC CICS LINK
 19579*        PROGRAM    ('DLO001')
 19580*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19581*        LENGTH     (DLO001-COMM-LENGTH)
 19582*    END-EXEC.
 19583     MOVE 'DLO001' TO DFHEIV1
 19584*    MOVE '."C                   (   #00019164' TO DFHEIV0
 19585     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19587     MOVE X'2020233030303139313634' TO DFHEIV0(25:11)
 19588     CALL 'kxdfhei1' USING DFHEIV0,
 19589           DFHEIV1,
 19590           WS-DLO-MASTER-POLICY-FORM,
 19591           DLO001-COMM-LENGTH,
 19592           DFHEIV99,
 19593           DFHEIV99,
 19594           DFHEIV99,
 19595           DFHEIV99
 19596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19597
 19598
 19599 7700-EXIT.
 19600     EXIT.
 19601
 19602 7710-CALL-DL2.
 19603
 19604* EXEC CICS LINK
 19605*        PROGRAM    ('DLO002')
 19606*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19607*        LENGTH     (DLO002-COMM-LENGTH)
 19608*    END-EXEC.
 19609     MOVE 'DLO002' TO DFHEIV1
 19610*    MOVE '."C                   (   #00019174' TO DFHEIV0
 19611     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19612     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19613     MOVE X'2020233030303139313734' TO DFHEIV0(25:11)
 19614     CALL 'kxdfhei1' USING DFHEIV0,
 19615           DFHEIV1,
 19616           WS-DLO-INTERNAL-POLICY-FORM,
 19617           DLO002-COMM-LENGTH,
 19618           DFHEIV99,
 19619           DFHEIV99,
 19620           DFHEIV99,
 19621           DFHEIV99
 19622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19623
 19624
 19625 7710-EXIT.
 19626     EXIT.
 19627
 19628 7720-CALL-DL3.
 19629
 19630* EXEC CICS LINK
 19631*        PROGRAM    ('DLO003')
 19632*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19633*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 362
* EL050.cbl
 19634*    END-EXEC.
 19635     MOVE 'DLO003' TO DFHEIV1
 19636*    MOVE '."C                   (   #00019184' TO DFHEIV0
 19637     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19639     MOVE X'2020233030303139313834' TO DFHEIV0(25:11)
 19640     CALL 'kxdfhei1' USING DFHEIV0,
 19641           DFHEIV1,
 19642           WS-DLO-VALID-BANK-ID,
 19643           DLO003-COMM-LENGTH,
 19644           DFHEIV99,
 19645           DFHEIV99,
 19646           DFHEIV99,
 19647           DFHEIV99
 19648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19649
 19650
 19651 7720-EXIT.
 19652     EXIT.
 19653
 19654 7730-CALL-DL7.
 19655
 19656* EXEC CICS LINK
 19657*        PROGRAM    ('DLO007')
 19658*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19659*        LENGTH     (DLO007-COMM-LENGTH)
 19660*    END-EXEC.
 19661     MOVE 'DLO007' TO DFHEIV1
 19662*    MOVE '."C                   (   #00019194' TO DFHEIV0
 19663     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19665     MOVE X'2020233030303139313934' TO DFHEIV0(25:11)
 19666     CALL 'kxdfhei1' USING DFHEIV0,
 19667           DFHEIV1,
 19668           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19669           DLO007-COMM-LENGTH,
 19670           DFHEIV99,
 19671           DFHEIV99,
 19672           DFHEIV99,
 19673           DFHEIV99
 19674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19675
 19676
 19677 7730-EXIT.
 19678     EXIT.
 19679
 19680 7740-CALL-DL11.
 19681
 19682* EXEC CICS LINK
 19683*        PROGRAM    ('DLO011')
 19684*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19685*        LENGTH     (DLO011-COMM-LENGTH)
 19686*    END-EXEC.
 19687     MOVE 'DLO011' TO DFHEIV1
 19688*    MOVE '."C                   (   #00019204' TO DFHEIV0
 19689     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19690     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19691     MOVE X'2020233030303139323034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 363
* EL050.cbl
 19692     CALL 'kxdfhei1' USING DFHEIV0,
 19693           DFHEIV1,
 19694           WS-DLO-PREM-RATES-BEN-TYPE,
 19695           DLO011-COMM-LENGTH,
 19696           DFHEIV99,
 19697           DFHEIV99,
 19698           DFHEIV99,
 19699           DFHEIV99
 19700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19701
 19702
 19703 7740-EXIT.
 19704     EXIT.
 19705
 19706 7750-CALL-DL17.
 19707
 19708* EXEC CICS LINK
 19709*        PROGRAM    ('DLO017')
 19710*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19711*        LENGTH     (DLO017-COMM-LENGTH)
 19712*    END-EXEC.
 19713     MOVE 'DLO017' TO DFHEIV1
 19714*    MOVE '."C                   (   #00019214' TO DFHEIV0
 19715     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19717     MOVE X'2020233030303139323134' TO DFHEIV0(25:11)
 19718     CALL 'kxdfhei1' USING DFHEIV0,
 19719           DFHEIV1,
 19720           WS-DLO-VALID-RATE-CODE,
 19721           DLO017-COMM-LENGTH,
 19722           DFHEIV99,
 19723           DFHEIV99,
 19724           DFHEIV99,
 19725           DFHEIV99
 19726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19727
 19728
 19729 7750-EXIT.
 19730     EXIT.
 19731
 19732 7755-CALL-DL19.
 19733
 19734* EXEC CICS LINK
 19735*        PROGRAM    ('DLO019')
 19736*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19737*        LENGTH     (DLO019-COMM-LENGTH)
 19738*    END-EXEC.
 19739     MOVE 'DLO019' TO DFHEIV1
 19740*    MOVE '."C                   (   #00019224' TO DFHEIV0
 19741     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19743     MOVE X'2020233030303139323234' TO DFHEIV0(25:11)
 19744     CALL 'kxdfhei1' USING DFHEIV0,
 19745           DFHEIV1,
 19746           WS-DLO-ORIG-COV-CAT,
 19747           DLO019-COMM-LENGTH,
 19748           DFHEIV99,
 19749           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 364
* EL050.cbl
 19750           DFHEIV99,
 19751           DFHEIV99
 19752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19753
 19754
 19755 7755-EXIT.
 19756     EXIT.
 19757
 19758 7760-CALL-DL21.
 19759
 19760* EXEC CICS LINK
 19761*        PROGRAM    ('DLO021')
 19762*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19763*        LENGTH     (DLO021-COMM-LENGTH)
 19764*    END-EXEC.
 19765     MOVE 'DLO021' TO DFHEIV1
 19766*    MOVE '."C                   (   #00019234' TO DFHEIV0
 19767     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19769     MOVE X'2020233030303139323334' TO DFHEIV0(25:11)
 19770     CALL 'kxdfhei1' USING DFHEIV0,
 19771           DFHEIV1,
 19772           WS-DLO-VALID-LOAN-OFFICER,
 19773           DLO021-COMM-LENGTH,
 19774           DFHEIV99,
 19775           DFHEIV99,
 19776           DFHEIV99,
 19777           DFHEIV99
 19778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19779
 19780
 19781 7760-EXIT.
 19782     EXIT.
 19783
 19784 7770-CALL-DL22.
 19785
 19786* EXEC CICS LINK
 19787*        PROGRAM    ('DLO022')
 19788*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19789*        LENGTH     (DLO022-COMM-LENGTH)
 19790*    END-EXEC.
 19791     MOVE 'DLO022' TO DFHEIV1
 19792*    MOVE '."C                   (   #00019244' TO DFHEIV0
 19793     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19794     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19795     MOVE X'2020233030303139323434' TO DFHEIV0(25:11)
 19796     CALL 'kxdfhei1' USING DFHEIV0,
 19797           DFHEIV1,
 19798           WS-DLO-VALID-STATE-CODE,
 19799           DLO022-COMM-LENGTH,
 19800           DFHEIV99,
 19801           DFHEIV99,
 19802           DFHEIV99,
 19803           DFHEIV99
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
 19807 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 365
* EL050.cbl
 19808     EXIT.
 19809
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 366
* EL050.cbl
 19811
 19812 7780-CALL-AGG.
 19813
 19814* EXEC CICS LINK
 19815*        PROGRAM    ('ELAGGO')
 19816*        COMMAREA   (WS-PASS-to-pemaggo)
 19817*        LENGTH     (ws-passed-key-LENGTH)
 19818*    END-EXEC.
 19819     MOVE 'ELAGGO' TO DFHEIV1
 19820*    MOVE '."C                   (   #00019256' TO DFHEIV0
 19821     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19823     MOVE X'2020233030303139323536' TO DFHEIV0(25:11)
 19824     CALL 'kxdfhei1' USING DFHEIV0,
 19825           DFHEIV1,
 19826           WS-PASS-to-pemaggo,
 19827           ws-passed-key-LENGTH,
 19828           DFHEIV99,
 19829           DFHEIV99,
 19830           DFHEIV99,
 19831           DFHEIV99
 19832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19833
 19834 7780-EXIT.
 19835     EXIT.
 19836 7800-REWRITE-CERT.
 19837******************************************************************
 19838*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19839*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19840******************************************************************
 19841
 19842     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19843        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19844        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19845        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19846
 19847* EXEC CICS REWRITE
 19848*                  DATASET (CERT-ID)
 19849*                  FROM    (CERTIFICATE-MASTER)
 19850*              END-EXEC
 19851     MOVE LENGTH OF
 19852      CERTIFICATE-MASTER
 19853       TO DFHEIV11
 19854*    MOVE '&& L                  %   #00019273' TO DFHEIV0
 19855     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19856     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19857     MOVE X'2020233030303139323733' TO DFHEIV0(25:11)
 19858     CALL 'kxdfhei1' USING DFHEIV0,
 19859           CERT-ID,
 19860           CERTIFICATE-MASTER,
 19861           DFHEIV11,
 19862           DFHEIV99
 19863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19864        GO TO 7800-EXIT.
 19865
 19866       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19867       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19868
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 367
* EL050.cbl
 19869 7800-EXIT.
 19870      EXIT.
 19871
 19872 7900-DELETE-CERT.
 19873
 19874* EXEC CICS DELETE
 19875*        DATASET (CERT-ID)
 19876*    END-EXEC.
 19877*    MOVE '&(                    &   #00019286' TO DFHEIV0
 19878     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19879     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19880     MOVE X'2020233030303139323836' TO DFHEIV0(25:11)
 19881     CALL 'kxdfhei1' USING DFHEIV0,
 19882           CERT-ID,
 19883           DFHEIV99,
 19884           DFHEIV99,
 19885           DFHEIV99,
 19886           DFHEIV99
 19887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19888
 19889
 19890 7900-EXIT.
 19891     EXIT.
 19892
 19893 8000-WRITE-CERT.
 19894
 19895* EXEC CICS HANDLE CONDITION
 19896*        DUPKEY    (8000-FREE-MAIN)
 19897*    END-EXEC.
 19898*    MOVE '"$$                   ! + #00019294' TO DFHEIV0
 19899     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19901     MOVE X'2B20233030303139323934' TO DFHEIV0(25:11)
 19902     CALL 'kxdfhei1' USING DFHEIV0
 19903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19904
 19905
 19906
 19907* EXEC CICS WRITE
 19908*        DATASET     (CERT-ID)
 19909*        FROM        (CERTIFICATE-MASTER)
 19910*        RIDFLD      (ELCERT-KEY)
 19911*    END-EXEC.
 19912     MOVE LENGTH OF
 19913      CERTIFICATE-MASTER
 19914       TO DFHEIV11
 19915*    MOVE '&$ L                  ''   #00019298' TO DFHEIV0
 19916     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19918     MOVE X'2020233030303139323938' TO DFHEIV0(25:11)
 19919     CALL 'kxdfhei1' USING DFHEIV0,
 19920           CERT-ID,
 19921           CERTIFICATE-MASTER,
 19922           DFHEIV11,
 19923           ELCERT-KEY,
 19924           DFHEIV99,
 19925           DFHEIV99
 19926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 368
* EL050.cbl
 19927
 19928
 19929 8000-FREE-MAIN.
 19930
 19931 8000-EXIT.
 19932      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 369
* EL050.cbl
 19934
 19935 8100-READ-ERPNDM.
 19936
 19937* EXEC CICS HANDLE CONDITION
 19938*         NOTFND     (8100-NOTFND)
 19939*         ENDFILE    (8100-NOTFND)
 19940*    END-EXEC.
 19941*    MOVE '"$I''                  ! , #00019311' TO DFHEIV0
 19942     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19944     MOVE X'2C20233030303139333131' TO DFHEIV0(25:11)
 19945     CALL 'kxdfhei1' USING DFHEIV0
 19946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19947
 19948
 19949     MOVE SPACES                 TO ERPNDM-FOUND.
 19950     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19951
 19952
 19953* EXEC CICS READ
 19954*         DATASET   (FILE-ERPNDM)
 19955*         RIDFLD    (PM-CONTROL-PRIMARY)
 19956*         INTO      (PENDING-MAILING-DATA)
 19957*    END-EXEC.
 19958     MOVE LENGTH OF
 19959      PENDING-MAILING-DATA
 19960       TO DFHEIV11
 19961*    MOVE '&"IL       E          (   #00019319' TO DFHEIV0
 19962     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19964     MOVE X'2020233030303139333139' TO DFHEIV0(25:11)
 19965     CALL 'kxdfhei1' USING DFHEIV0,
 19966           FILE-ERPNDM,
 19967           PENDING-MAILING-DATA,
 19968           DFHEIV11,
 19969           PM-CONTROL-PRIMARY,
 19970           DFHEIV99,
 19971           DFHEIV99,
 19972           DFHEIV99
 19973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19974
 19975
 19976     GO TO 8100-EXIT.
 19977
 19978 8100-NOTFND.
 19979
 19980     MOVE 'X'                    TO ERPNDM-FOUND.
 19981     MOVE ER-2694                TO WS-ERROR.
 19982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19983     MOVE ER-2883                TO WS-ERROR
 19984     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19985     .
 19986 8100-EXIT.
 19987     EXIT.
 19988
 19989 8110-READ-ERMAIL.
 19990
 19991* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 370
* EL050.cbl
 19992*         NOTFND     (8110-NOTFND)
 19993*         ENDFILE    (8110-NOTFND)
 19994*    END-EXEC.
 19995*    MOVE '"$I''                  ! - #00019339' TO DFHEIV0
 19996     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19997     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19998     MOVE X'2D20233030303139333339' TO DFHEIV0(25:11)
 19999     CALL 'kxdfhei1' USING DFHEIV0
 20000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20001
 20002
 20003     MOVE SPACES                 TO ERMAIL-FOUND.
 20004     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 20005     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 20006     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 20007     MOVE PB-SV-STATE            TO MA-STATE.
 20008
 20009
 20010* EXEC CICS READ
 20011*         UPDATE
 20012*         DATASET   (FILE-ERMAIL)
 20013*         RIDFLD    (MA-CONTROL-PRIMARY)
 20014*         INTO      (MAILING-DATA)
 20015*    END-EXEC.
 20016     MOVE LENGTH OF
 20017      MAILING-DATA
 20018       TO DFHEIV11
 20019*    MOVE '&"IL       EU         (   #00019350' TO DFHEIV0
 20020     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20021     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20022     MOVE X'2020233030303139333530' TO DFHEIV0(25:11)
 20023     CALL 'kxdfhei1' USING DFHEIV0,
 20024           FILE-ERMAIL,
 20025           MAILING-DATA,
 20026           DFHEIV11,
 20027           MA-CONTROL-PRIMARY,
 20028           DFHEIV99,
 20029           DFHEIV99,
 20030           DFHEIV99
 20031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20032
 20033
 20034     GO TO 8110-EXIT.
 20035
 20036 8110-NOTFND.
 20037     MOVE 'X'                    TO ERMAIL-FOUND.
 20038
 20039 8110-EXIT.
 20040     EXIT.
 20041
 20042 8120-REWRITE-ERMAIL.
 20043
 20044* EXEC CICS REWRITE
 20045*         DATASET    (FILE-ERMAIL)
 20046*         FROM       (MAILING-DATA)
 20047*    END-EXEC.
 20048     MOVE LENGTH OF
 20049      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 371
* EL050.cbl
 20050       TO DFHEIV11
 20051*    MOVE '&& L                  %   #00019366' TO DFHEIV0
 20052     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20053     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20054     MOVE X'2020233030303139333636' TO DFHEIV0(25:11)
 20055     CALL 'kxdfhei1' USING DFHEIV0,
 20056           FILE-ERMAIL,
 20057           MAILING-DATA,
 20058           DFHEIV11,
 20059           DFHEIV99
 20060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20061
 20062
 20063 8120-EXIT.
 20064     EXIT.
 20065
 20066 8130-WRITE-ERMAIL.
 20067
 20068* EXEC CICS HANDLE CONDITION
 20069*         DUPKEY   (8130-EXIT)
 20070*    END-EXEC.
 20071*    MOVE '"$$                   ! . #00019375' TO DFHEIV0
 20072     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 20073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20074     MOVE X'2E20233030303139333735' TO DFHEIV0(25:11)
 20075     CALL 'kxdfhei1' USING DFHEIV0
 20076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20077
 20078
 20079
 20080* EXEC CICS WRITE
 20081*         DATASET     (FILE-ERMAIL)
 20082*         RIDFLD      (MA-CONTROL-PRIMARY)
 20083*         FROM        (MAILING-DATA)
 20084*    END-EXEC.
 20085     MOVE LENGTH OF
 20086      MAILING-DATA
 20087       TO DFHEIV11
 20088*    MOVE '&$ L                  ''   #00019379' TO DFHEIV0
 20089     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20090     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20091     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 20092     CALL 'kxdfhei1' USING DFHEIV0,
 20093           FILE-ERMAIL,
 20094           MAILING-DATA,
 20095           DFHEIV11,
 20096           MA-CONTROL-PRIMARY,
 20097           DFHEIV99,
 20098           DFHEIV99
 20099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20100
 20101
 20102 8130-EXIT.
 20103     EXIT.
 20104
 20105 8140-UNLOCK-ERMAIL.
 20106
 20107* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 372
* EL050.cbl
 20108*         DATASET   (FILE-ERMAIL)
 20109*    END-EXEC.
 20110*    MOVE '&*                    #   #00019389' TO DFHEIV0
 20111     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20112     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20113     MOVE X'2020233030303139333839' TO DFHEIV0(25:11)
 20114     CALL 'kxdfhei1' USING DFHEIV0,
 20115           FILE-ERMAIL,
 20116           DFHEIV99
 20117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20118
 20119
 20120 8140-EXIT.
 20121     EXIT.
 20122
 20123 8150-read-elcrtt.
 20124
 20125
 20126* EXEC CICS HANDLE CONDITION
 20127*        NOTFND   (8150-exit)
 20128*    END-EXEC
 20129*    MOVE '"$I                   ! / #00019398' TO DFHEIV0
 20130     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20132     MOVE X'2F20233030303139333938' TO DFHEIV0(25:11)
 20133     CALL 'kxdfhei1' USING DFHEIV0
 20134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20135
 20136     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20137     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20138
 20139
 20140* EXEC CICS READ
 20141*        DATASET  (CRTT-ID)
 20142*        RIDFLD   (WS-ELCRTT-KEY)
 20143*        INTO     (CERTIFICATE-TRAILERS)
 20144*    END-EXEC
 20145     MOVE LENGTH OF
 20146      CERTIFICATE-TRAILERS
 20147       TO DFHEIV11
 20148*    MOVE '&"IL       E          (   #00019405' TO DFHEIV0
 20149     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20151     MOVE X'2020233030303139343035' TO DFHEIV0(25:11)
 20152     CALL 'kxdfhei1' USING DFHEIV0,
 20153           CRTT-ID,
 20154           CERTIFICATE-TRAILERS,
 20155           DFHEIV11,
 20156           WS-ELCRTT-KEY,
 20157           DFHEIV99,
 20158           DFHEIV99,
 20159           DFHEIV99
 20160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20161
 20162     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20163     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20164     move cs-vehicle-odometer    to ws-vehicle-odometer
 20165
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 373
* EL050.cbl
 20166     .
 20167 8150-exit.
 20168     exit.
 20169 8180-UPDATE-VIN-NUMBER.
 20170
 20171* EXEC CICS HANDLE CONDITION
 20172*        NOTFND   (8180-NOTFND)
 20173*    END-EXEC.
 20174*    MOVE '"$I                   ! 0 #00019419' TO DFHEIV0
 20175     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20177     MOVE X'3020233030303139343139' TO DFHEIV0(25:11)
 20178     CALL 'kxdfhei1' USING DFHEIV0
 20179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20180
 20181
 20182     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20183     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20184
 20185
 20186* EXEC CICS READ
 20187*        UPDATE
 20188*        DATASET  (CRTT-ID)
 20189*        RIDFLD   (WS-ELCRTT-KEY)
 20190*        INTO     (CERTIFICATE-TRAILERS)
 20191*    END-EXEC.
 20192     MOVE LENGTH OF
 20193      CERTIFICATE-TRAILERS
 20194       TO DFHEIV11
 20195*    MOVE '&"IL       EU         (   #00019426' TO DFHEIV0
 20196     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20197     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20198     MOVE X'2020233030303139343236' TO DFHEIV0(25:11)
 20199     CALL 'kxdfhei1' USING DFHEIV0,
 20200           CRTT-ID,
 20201           CERTIFICATE-TRAILERS,
 20202           DFHEIV11,
 20203           WS-ELCRTT-KEY,
 20204           DFHEIV99,
 20205           DFHEIV99,
 20206           DFHEIV99
 20207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20208
 20209
 20210     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20211         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20212
 20213* EXEC CICS REWRITE
 20214*           DATASET  (CRTT-ID)
 20215*           FROM     (CERTIFICATE-TRAILERS)
 20216*        END-EXEC
 20217     MOVE LENGTH OF
 20218      CERTIFICATE-TRAILERS
 20219       TO DFHEIV11
 20220*    MOVE '&& L                  %   #00019435' TO DFHEIV0
 20221     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20222     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20223     MOVE X'2020233030303139343335' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 374
* EL050.cbl
 20224     CALL 'kxdfhei1' USING DFHEIV0,
 20225           CRTT-ID,
 20226           CERTIFICATE-TRAILERS,
 20227           DFHEIV11,
 20228           DFHEIV99
 20229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20230     ELSE
 20231
 20232* EXEC CICS UNLOCK
 20233*          DATASET  (CRTT-ID)
 20234*       END-EXEC
 20235*    MOVE '&*                    #   #00019440' TO DFHEIV0
 20236     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20237     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20238     MOVE X'2020233030303139343430' TO DFHEIV0(25:11)
 20239     CALL 'kxdfhei1' USING DFHEIV0,
 20240           CRTT-ID,
 20241           DFHEIV99
 20242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20243     END-IF.
 20244
 20245     GO TO 8180-EXIT.
 20246
 20247 8180-NOTFND.
 20248
 20249     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20250     MOVE 'CS'         TO CS-RECORD-ID.
 20251     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20252     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20253     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20254     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20255
 20256* EXEC CICS WRITE
 20257*       DATASET  (CRTT-ID)
 20258*       RIDFLD   (WS-ELCRTT-KEY)
 20259*       FROM     (CERTIFICATE-TRAILERS)
 20260*    END-EXEC.
 20261     MOVE LENGTH OF
 20262      CERTIFICATE-TRAILERS
 20263       TO DFHEIV11
 20264*    MOVE '&$ L                  ''   #00019455' TO DFHEIV0
 20265     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20267     MOVE X'2020233030303139343535' TO DFHEIV0(25:11)
 20268     CALL 'kxdfhei1' USING DFHEIV0,
 20269           CRTT-ID,
 20270           CERTIFICATE-TRAILERS,
 20271           DFHEIV11,
 20272           WS-ELCRTT-KEY,
 20273           DFHEIV99,
 20274           DFHEIV99
 20275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20276
 20277
 20278 8180-EXIT.
 20279     EXIT.
 20280
 20281 8190-UPDATE-REFUND-CLAIM-FLAG.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 375
* EL050.cbl
 20282
 20283* EXEC CICS HANDLE CONDITION
 20284*        NOTFND   (8190-NOTFND)
 20285*    END-EXEC.
 20286*    MOVE '"$I                   ! 1 #00019465' TO DFHEIV0
 20287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20289     MOVE X'3120233030303139343635' TO DFHEIV0(25:11)
 20290     CALL 'kxdfhei1' USING DFHEIV0
 20291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20292
 20293
 20294     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20295     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20296
 20297
 20298* EXEC CICS READ
 20299*        UPDATE
 20300*        DATASET  (CRTT-ID)
 20301*        RIDFLD   (WS-ELCRTT-KEY)
 20302*        INTO     (CERTIFICATE-TRAILERS)
 20303*    END-EXEC.
 20304     MOVE LENGTH OF
 20305      CERTIFICATE-TRAILERS
 20306       TO DFHEIV11
 20307*    MOVE '&"IL       EU         (   #00019472' TO DFHEIV0
 20308     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20309     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20310     MOVE X'2020233030303139343732' TO DFHEIV0(25:11)
 20311     CALL 'kxdfhei1' USING DFHEIV0,
 20312           CRTT-ID,
 20313           CERTIFICATE-TRAILERS,
 20314           DFHEIV11,
 20315           WS-ELCRTT-KEY,
 20316           DFHEIV99,
 20317           DFHEIV99,
 20318           DFHEIV99
 20319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20320
 20321
 20322     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20323
 20324* EXEC CICS REWRITE
 20325*       DATASET  (CRTT-ID)
 20326*       FROM     (CERTIFICATE-TRAILERS)
 20327*    END-EXEC.
 20328     MOVE LENGTH OF
 20329      CERTIFICATE-TRAILERS
 20330       TO DFHEIV11
 20331*    MOVE '&& L                  %   #00019480' TO DFHEIV0
 20332     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20333     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20334     MOVE X'2020233030303139343830' TO DFHEIV0(25:11)
 20335     CALL 'kxdfhei1' USING DFHEIV0,
 20336           CRTT-ID,
 20337           CERTIFICATE-TRAILERS,
 20338           DFHEIV11,
 20339           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 376
* EL050.cbl
 20340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20341
 20342
 20343     GO TO 8190-EXIT.
 20344
 20345 8190-NOTFND.
 20346
 20347     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20348     MOVE 'CS'         TO CS-RECORD-ID.
 20349     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20350     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20351     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20352     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20353
 20354* EXEC CICS WRITE
 20355*       DATASET  (CRTT-ID)
 20356*       RIDFLD   (WS-ELCRTT-KEY)
 20357*       FROM     (CERTIFICATE-TRAILERS)
 20358*    END-EXEC.
 20359     MOVE LENGTH OF
 20360      CERTIFICATE-TRAILERS
 20361       TO DFHEIV11
 20362*    MOVE '&$ L                  ''   #00019495' TO DFHEIV0
 20363     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20364     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20365     MOVE X'2020233030303139343935' TO DFHEIV0(25:11)
 20366     CALL 'kxdfhei1' USING DFHEIV0,
 20367           CRTT-ID,
 20368           CERTIFICATE-TRAILERS,
 20369           DFHEIV11,
 20370           WS-ELCRTT-KEY,
 20371           DFHEIV99,
 20372           DFHEIV99
 20373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20374
 20375
 20376 8190-EXIT.
 20377     EXIT.
 20378
 20379 8195-UPDATE-AGE-FLAGS.
 20380
 20381* EXEC CICS HANDLE CONDITION
 20382*        NOTFND   (8195-NOTFND)
 20383*    END-EXEC.
 20384*    MOVE '"$I                   ! 2 #00019505' TO DFHEIV0
 20385     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20386     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20387     MOVE X'3220233030303139353035' TO DFHEIV0(25:11)
 20388     CALL 'kxdfhei1' USING DFHEIV0
 20389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20390
 20391
 20392     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20393     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20394
 20395
 20396* EXEC CICS READ
 20397*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 377
* EL050.cbl
 20398*        DATASET  (CRTT-ID)
 20399*        RIDFLD   (WS-ELCRTT-KEY)
 20400*        INTO     (CERTIFICATE-TRAILERS)
 20401*    END-EXEC.
 20402     MOVE LENGTH OF
 20403      CERTIFICATE-TRAILERS
 20404       TO DFHEIV11
 20405*    MOVE '&"IL       EU         (   #00019512' TO DFHEIV0
 20406     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20407     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20408     MOVE X'2020233030303139353132' TO DFHEIV0(25:11)
 20409     CALL 'kxdfhei1' USING DFHEIV0,
 20410           CRTT-ID,
 20411           CERTIFICATE-TRAILERS,
 20412           DFHEIV11,
 20413           WS-ELCRTT-KEY,
 20414           DFHEIV99,
 20415           DFHEIV99,
 20416           DFHEIV99
 20417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20418
 20419
 20420     IF WS-INS-AGE-SET = 'Y'
 20421        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20422     END-IF
 20423     IF WS-JNT-AGE-SET = 'Y'
 20424        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20425     END-IF
 20426
 20427
 20428* EXEC CICS REWRITE
 20429*       DATASET  (CRTT-ID)
 20430*       FROM     (CERTIFICATE-TRAILERS)
 20431*    END-EXEC.
 20432     MOVE LENGTH OF
 20433      CERTIFICATE-TRAILERS
 20434       TO DFHEIV11
 20435*    MOVE '&& L                  %   #00019526' TO DFHEIV0
 20436     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20437     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20438     MOVE X'2020233030303139353236' TO DFHEIV0(25:11)
 20439     CALL 'kxdfhei1' USING DFHEIV0,
 20440           CRTT-ID,
 20441           CERTIFICATE-TRAILERS,
 20442           DFHEIV11,
 20443           DFHEIV99
 20444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20445
 20446
 20447     GO TO 8195-EXIT.
 20448
 20449 8195-NOTFND.
 20450
 20451     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20452     MOVE 'CS'         TO CS-RECORD-ID.
 20453     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20454     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20455     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 378
* EL050.cbl
 20456     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 20457     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20458
 20459* EXEC CICS WRITE
 20460*       DATASET  (CRTT-ID)
 20461*       RIDFLD   (WS-ELCRTT-KEY)
 20462*       FROM     (CERTIFICATE-TRAILERS)
 20463*    END-EXEC.
 20464     MOVE LENGTH OF
 20465      CERTIFICATE-TRAILERS
 20466       TO DFHEIV11
 20467*    MOVE '&$ L                  ''   #00019542' TO DFHEIV0
 20468     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20469     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20470     MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
 20471     CALL 'kxdfhei1' USING DFHEIV0,
 20472           CRTT-ID,
 20473           CERTIFICATE-TRAILERS,
 20474           DFHEIV11,
 20475           WS-ELCRTT-KEY,
 20476           DFHEIV99,
 20477           DFHEIV99
 20478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20479
 20480
 20481 8195-EXIT.
 20482     EXIT.
 20483
 20484 8200-READ-REIN-TABLE.
 20485
 20486* EXEC CICS HANDLE CONDITION
 20487*         NOTFND   (8200-NOTFND)
 20488*    END-EXEC.
 20489*    MOVE '"$I                   ! 3 #00019552' TO DFHEIV0
 20490     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20492     MOVE X'3320233030303139353532' TO DFHEIV0(25:11)
 20493     CALL 'kxdfhei1' USING DFHEIV0
 20494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20495
 20496
 20497
 20498* EXEC CICS READ
 20499*        DATASET     (REIN-ID)
 20500*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20501*        RIDFLD      (ERREIN-KEY)
 20502*    END-EXEC.
 20503*    MOVE '&"S        E          (   #00019556' TO DFHEIV0
 20504     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20505     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20506     MOVE X'2020233030303139353536' TO DFHEIV0(25:11)
 20507     CALL 'kxdfhei1' USING DFHEIV0,
 20508           REIN-ID,
 20509           DFHEIV20,
 20510           DFHEIV99,
 20511           ERREIN-KEY,
 20512           DFHEIV99,
 20513           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 379
* EL050.cbl
 20514           DFHEIV99
 20515     SET ADDRESS OF REINSURANCE-RECORD TO
 20516         DFHEIV20
 20517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20518
 20519
 20520     GO TO 8200-EXIT.
 20521
 20522 8200-NOTFND.
 20523     MOVE 'N'             TO WS-REIN-READ-SW.
 20524
 20525 8200-EXIT.
 20526      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 380
* EL050.cbl
 20528
 20529 8300-READ-CTBL-TABLE.
 20530
 20531* EXEC CICS HANDLE CONDITION
 20532*        NOTFND    (8300-NOTFND)
 20533*        DISABLED  (8300-ERRESS-PROBLEM)
 20534*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20535*        ENDFILE   (8300-NOTFND)
 20536*    END-EXEC.
 20537*    MOVE '"$IcJ''                ! 4 #00019572' TO DFHEIV0
 20538     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20540     MOVE X'3420233030303139353732' TO DFHEIV0(25:11)
 20541     CALL 'kxdfhei1' USING DFHEIV0
 20542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20543
 20544
 20545
 20546* EXEC CICS READ
 20547*        DATASET     (CTBL-ID)
 20548*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20549*        RIDFLD      (ERCTBL-KEY)
 20550*    END-EXEC.
 20551*    MOVE '&"S        E          (   #00019579' TO DFHEIV0
 20552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20554     MOVE X'2020233030303139353739' TO DFHEIV0(25:11)
 20555     CALL 'kxdfhei1' USING DFHEIV0,
 20556           CTBL-ID,
 20557           DFHEIV20,
 20558           DFHEIV99,
 20559           ERCTBL-KEY,
 20560           DFHEIV99,
 20561           DFHEIV99,
 20562           DFHEIV99
 20563     SET ADDRESS OF COMM-TABLE-RECORD TO
 20564         DFHEIV20
 20565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20566
 20567
 20568     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20569
 20570     GO TO 8300-EXIT.
 20571
 20572 8300-NOTFND.
 20573
 20574     IF CTBL-SW = '0530'
 20575         MOVE 'AA'                     TO WS-AH-COMP-CD
 20576         MOVE '0550'                   TO CTBL-SW
 20577         MOVE '1'                      TO WS-CTBL-READ-SW
 20578         GO TO 8300-EXIT.
 20579
 20580     IF CTBL-SW = '0540'
 20581         MOVE 'AA'                     TO WS-LF-COMP-CD
 20582         MOVE '0550'                   TO CTBL-SW
 20583         MOVE '1'                      TO WS-CTBL-READ-SW
 20584         GO TO 8300-EXIT.
 20585
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 381
* EL050.cbl
 20586     IF CTBL-SW = '0550'
 20587         MOVE '2'                      TO WS-CTBL-READ-SW
 20588         GO TO 8300-EXIT.
 20589
 20590     GO TO 8300-EXIT.
 20591
 20592 8300-ERRESS-PROBLEM.
 20593
 20594      MOVE ER-8050              TO WS-ERROR.
 20595      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20596
 20597     GO TO 8300-EXIT.
 20598
 20599 8300-EXIT.
 20600      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 382
* EL050.cbl
 20602
 20603
 20604 8400-GETMAIN-ERFORM.
 20605
 20606
 20607* EXEC CICS   GETMAIN
 20608*        LENGTH  (500)
 20609*        SET     (ADDRESS OF FORM-MASTER)
 20610*    END-EXEC.
 20611     MOVE 500
 20612       TO DFHEIV11
 20613*    MOVE '," L                  $   #00019623' TO DFHEIV0
 20614     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20615     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20616     MOVE X'2020233030303139363233' TO DFHEIV0(25:11)
 20617     CALL 'kxdfhei1' USING DFHEIV0,
 20618           DFHEIV20,
 20619           DFHEIV11,
 20620           DFHEIV99
 20621     SET ADDRESS OF FORM-MASTER TO
 20622         DFHEIV20
 20623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20624
 20625
 20626     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20627
 20628 8400-EXIT.
 20629      EXIT.
 20630
 20631 8450-READ-FORM-MASTER.
 20632
 20633
 20634* EXEC CICS  HANDLE CONDITION
 20635*        NOTFND   (8450-FORM-NOT-FOUND)
 20636*        ENDFILE  (8450-FORM-NOT-FOUND)
 20637*    END-EXEC.
 20638*    MOVE '"$I''                  ! 5 #00019635' TO DFHEIV0
 20639     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20640     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20641     MOVE X'3520233030303139363335' TO DFHEIV0(25:11)
 20642     CALL 'kxdfhei1' USING DFHEIV0
 20643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20644
 20645
 20646
 20647* EXEC CICS   READ
 20648*        DATASET   (FORM-ID)
 20649*        RIDFLD    (ERFORM-KEY)
 20650*        INTO      (FORM-MASTER)
 20651*        GTEQ
 20652*    END-EXEC.
 20653     MOVE LENGTH OF
 20654      FORM-MASTER
 20655       TO DFHEIV11
 20656*    MOVE '&"IL       G          (   #00019640' TO DFHEIV0
 20657     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20659     MOVE X'2020233030303139363430' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 383
* EL050.cbl
 20660     CALL 'kxdfhei1' USING DFHEIV0,
 20661           FORM-ID,
 20662           FORM-MASTER,
 20663           DFHEIV11,
 20664           ERFORM-KEY,
 20665           DFHEIV99,
 20666           DFHEIV99,
 20667           DFHEIV99
 20668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20669
 20670
 20671     MOVE  'Y'           TO  FORM-MASTER-SW.
 20672
 20673     GO TO  8450-EXIT.
 20674
 20675 8450-FORM-NOT-FOUND.
 20676
 20677     MOVE  'N'           TO  FORM-MASTER-SW.
 20678
 20679 8450-EXIT.
 20680      EXIT.
 20681
 20682 8500-DATE-CONVERT.
 20683
 20684* EXEC CICS LINK
 20685*        PROGRAM    ('ELDATCV')
 20686*        COMMAREA   (DATE-CONVERSION-DATA)
 20687*        LENGTH     (DC-COMM-LENGTH)
 20688*    END-EXEC.
 20689     MOVE 'ELDATCV' TO DFHEIV1
 20690*    MOVE '."C                   (   #00019659' TO DFHEIV0
 20691     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20692     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20693     MOVE X'2020233030303139363539' TO DFHEIV0(25:11)
 20694     CALL 'kxdfhei1' USING DFHEIV0,
 20695           DFHEIV1,
 20696           DATE-CONVERSION-DATA,
 20697           DC-COMM-LENGTH,
 20698           DFHEIV99,
 20699           DFHEIV99,
 20700           DFHEIV99,
 20701           DFHEIV99
 20702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20703
 20704
 20705 8500-EXIT.
 20706     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 384
* EL050.cbl
 20708
 20709 8555-RELOAD-CONTROL-FILE.
 20710     CONTINUE.
 20711
 20712 8555-EXIT.
 20713     EXIT.
 20714
 20715 8557-GETMAIN-ERPLAN.
 20716
 20717
 20718* EXEC CICS GETMAIN
 20719*        LENGTH    (840)
 20720*        SET       (ADDRESS OF PLAN-RECORDS)
 20721*    END-EXEC.
 20722     MOVE 840
 20723       TO DFHEIV11
 20724*    MOVE '," L                  $   #00019677' TO DFHEIV0
 20725     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20726     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20727     MOVE X'2020233030303139363737' TO DFHEIV0(25:11)
 20728     CALL 'kxdfhei1' USING DFHEIV0,
 20729           DFHEIV20,
 20730           DFHEIV11,
 20731           DFHEIV99
 20732     SET ADDRESS OF PLAN-RECORDS TO
 20733         DFHEIV20
 20734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20735
 20736
 20737     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20738
 20739 8557-EXIT.
 20740     EXIT.
 20741
 20742 8560-GETMAIN.
 20743
 20744* EXEC CICS GETMAIN
 20745*        LENGTH    (2000)
 20746*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20747*    END-EXEC.
 20748     MOVE 2000
 20749       TO DFHEIV11
 20750*    MOVE '," L                  $   #00019688' TO DFHEIV0
 20751     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20752     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20753     MOVE X'2020233030303139363838' TO DFHEIV0(25:11)
 20754     CALL 'kxdfhei1' USING DFHEIV0,
 20755           DFHEIV20,
 20756           DFHEIV11,
 20757           DFHEIV99
 20758     SET ADDRESS OF ACCOUNT-MASTER TO
 20759         DFHEIV20
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20764
 20765 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 385
* EL050.cbl
 20766     EXIT.
 20767
 20768 8570-START-ACCOUNT-MASTER.
 20769
 20770* EXEC CICS HANDLE CONDITION
 20771*        NOTFND    (0199-ACCT-NOT-FOUND)
 20772*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20773*    END-EXEC.
 20774*    MOVE '"$I''                  ! 6 #00019699' TO DFHEIV0
 20775     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20777     MOVE X'3620233030303139363939' TO DFHEIV0(25:11)
 20778     CALL 'kxdfhei1' USING DFHEIV0
 20779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20780
 20781
 20782
 20783* EXEC CICS STARTBR
 20784*        DATASET    (ACCT-ID)
 20785*        RIDFLD     (ERACCT-KEY)
 20786*        GTEQ
 20787*    END-EXEC.
 20788     MOVE 0
 20789       TO DFHEIV11
 20790*    MOVE '&,         G          &   #00019704' TO DFHEIV0
 20791     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20792     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20793     MOVE X'2020233030303139373034' TO DFHEIV0(25:11)
 20794     CALL 'kxdfhei1' USING DFHEIV0,
 20795           ACCT-ID,
 20796           ERACCT-KEY,
 20797           DFHEIV99,
 20798           DFHEIV11,
 20799           DFHEIV99
 20800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20801
 20802
 20803 8570-EXIT.
 20804     EXIT.
 20805
 20806 8580-READ-ACCOUNT-MASTER.
 20807
 20808* EXEC CICS HANDLE CONDITION
 20809*        NOTFND    (0199-ACCT-NOT-FOUND)
 20810*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20811*    END-EXEC.
 20812*    MOVE '"$I''                  ! 7 #00019714' TO DFHEIV0
 20813     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20815     MOVE X'3720233030303139373134' TO DFHEIV0(25:11)
 20816     CALL 'kxdfhei1' USING DFHEIV0
 20817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20818
 20819
 20820
 20821* EXEC CICS READNEXT
 20822*        DATASET     (ACCT-ID)
 20823*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 386
* EL050.cbl
 20824*        RIDFLD      (ERACCT-KEY)
 20825*    END-EXEC.
 20826     MOVE LENGTH OF
 20827      ACCOUNT-MASTER
 20828       TO DFHEIV12
 20829     MOVE 0
 20830       TO DFHEIV11
 20831*    MOVE '&.IL                  )   #00019719' TO DFHEIV0
 20832     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20833     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20834     MOVE X'2020233030303139373139' TO DFHEIV0(25:11)
 20835     CALL 'kxdfhei1' USING DFHEIV0,
 20836           ACCT-ID,
 20837           ACCOUNT-MASTER,
 20838           DFHEIV12,
 20839           ERACCT-KEY,
 20840           DFHEIV99,
 20841           DFHEIV11,
 20842           DFHEIV99,
 20843           DFHEIV99
 20844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20845
 20846
 20847 8580-EXIT.
 20848     EXIT.
 20849
 20850 8582-READ-COMPENSATION-MASTER.
 20851
 20852* EXEC CICS HANDLE CONDITION
 20853*        NOTFND    (8582-COMP-NOT-FOUND)
 20854*        ENDFILE   (8582-COMP-NOT-FOUND)
 20855*    END-EXEC.
 20856*    MOVE '"$I''                  ! 8 #00019729' TO DFHEIV0
 20857     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20859     MOVE X'3820233030303139373239' TO DFHEIV0(25:11)
 20860     CALL 'kxdfhei1' USING DFHEIV0
 20861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20862
 20863
 20864
 20865* EXEC CICS READ
 20866*        DATASET     (COMP-ID)
 20867*        INTO        (COMPENSATION-MASTER)
 20868*        RIDFLD      (ERCOMP-KEY)
 20869*    END-EXEC.
 20870     MOVE LENGTH OF
 20871      COMPENSATION-MASTER
 20872       TO DFHEIV11
 20873*    MOVE '&"IL       E          (   #00019734' TO DFHEIV0
 20874     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20875     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20876     MOVE X'2020233030303139373334' TO DFHEIV0(25:11)
 20877     CALL 'kxdfhei1' USING DFHEIV0,
 20878           COMP-ID,
 20879           COMPENSATION-MASTER,
 20880           DFHEIV11,
 20881           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 387
* EL050.cbl
 20882           DFHEIV99,
 20883           DFHEIV99,
 20884           DFHEIV99
 20885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20886
 20887
 20888     MOVE 'Y'                    TO COMP-MASTER-SW
 20889
 20890     GO TO 8582-EXIT
 20891     .
 20892 8582-COMP-NOT-FOUND.
 20893
 20894     MOVE 'N'                    TO COMP-MASTER-SW.
 20895
 20896 8582-EXIT.
 20897     EXIT.
 20898
 20899 8583-READ-ERAGTC.
 20900
 20901* EXEC CICS HANDLE CONDITION
 20902*        NOTFND    (8583-AGTC-NOT-FOUND)
 20903*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20904*    END-EXEC.
 20905*    MOVE '"$I''                  ! 9 #00019752' TO DFHEIV0
 20906     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20908     MOVE X'3920233030303139373532' TO DFHEIV0(25:11)
 20909     CALL 'kxdfhei1' USING DFHEIV0
 20910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20911
 20912
 20913
 20914* EXEC CICS STARTBR
 20915*        DATASET    (AGTC-ID)
 20916*        RIDFLD     (ERAGTC-KEY)
 20917*        GTEQ
 20918*    END-EXEC.
 20919     MOVE 0
 20920       TO DFHEIV11
 20921*    MOVE '&,         G          &   #00019757' TO DFHEIV0
 20922     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20924     MOVE X'2020233030303139373537' TO DFHEIV0(25:11)
 20925     CALL 'kxdfhei1' USING DFHEIV0,
 20926           AGTC-ID,
 20927           ERAGTC-KEY,
 20928           DFHEIV99,
 20929           DFHEIV11,
 20930           DFHEIV99
 20931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20932
 20933
 20934 8583-READ-ERAGTC-NEXT.
 20935
 20936* EXEC CICS READNEXT
 20937*        DATASET     (AGTC-ID)
 20938*        INTO        (AGENT-COMMISSIONS)
 20939*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 388
* EL050.cbl
 20940*    END-EXEC.
 20941     MOVE LENGTH OF
 20942      AGENT-COMMISSIONS
 20943       TO DFHEIV12
 20944     MOVE 0
 20945       TO DFHEIV11
 20946*    MOVE '&.IL                  )   #00019764' TO DFHEIV0
 20947     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20948     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20949     MOVE X'2020233030303139373634' TO DFHEIV0(25:11)
 20950     CALL 'kxdfhei1' USING DFHEIV0,
 20951           AGTC-ID,
 20952           AGENT-COMMISSIONS,
 20953           DFHEIV12,
 20954           ERAGTC-KEY,
 20955           DFHEIV99,
 20956           DFHEIV11,
 20957           DFHEIV99,
 20958           DFHEIV99
 20959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20960
 20961
 20962*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20963
 20964     GO TO 8583-EXIT
 20965     .
 20966 8583-AGTC-NOT-FOUND.
 20967
 20968     MOVE 'N'                    TO AGTC-MASTER-SW.
 20969
 20970 8583-EXIT.
 20971     EXIT.
 20972
 20973 8584-READ-BANK-CROSS-REF.
 20974
 20975* EXEC CICS HANDLE CONDITION
 20976*        NOTFND    (8584-BXRF-NOT-FOUND)
 20977*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20978*    END-EXEC.
 20979*    MOVE '"$I''                  ! : #00019782' TO DFHEIV0
 20980     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20982     MOVE X'3A20233030303139373832' TO DFHEIV0(25:11)
 20983     CALL 'kxdfhei1' USING DFHEIV0
 20984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20985
 20986
 20987
 20988* EXEC CICS READ
 20989*        DATASET     (BXRF-ID)
 20990*        INTO        (BANK-CROSS-REFERENCE)
 20991*        RIDFLD      (ERBXRF-KEY)
 20992*        LENGTH      (BXRF-REC-LENGTH)
 20993*    END-EXEC.
 20994*    MOVE '&"IL       E          (   #00019787' TO DFHEIV0
 20995     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20996     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20997     MOVE X'2020233030303139373837' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 389
* EL050.cbl
 20998     CALL 'kxdfhei1' USING DFHEIV0,
 20999           BXRF-ID,
 21000           BANK-CROSS-REFERENCE,
 21001           BXRF-REC-LENGTH,
 21002           ERBXRF-KEY,
 21003           DFHEIV99,
 21004           DFHEIV99,
 21005           DFHEIV99
 21006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21007
 21008
 21009     MOVE 'Y'                    TO BXRF-MASTER-SW
 21010
 21011     GO TO 8584-EXIT
 21012     .
 21013 8584-BXRF-NOT-FOUND.
 21014
 21015     MOVE 'N'                    TO BXRF-MASTER-SW.
 21016
 21017 8584-EXIT.
 21018     EXIT.
 21019
 21020 8585-READ-PLAN-MASTER.
 21021
 21022
 21023* EXEC CICS HANDLE CONDITION
 21024*        NOTFND    (8585-PLAN-NOT-FOUND)
 21025*        ENDFILE   (8585-PLAN-NOT-FOUND)
 21026*    END-EXEC.
 21027*    MOVE '"$I''                  ! ; #00019807' TO DFHEIV0
 21028     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21029     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21030     MOVE X'3B20233030303139383037' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0
 21032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21033
 21034
 21035
 21036* EXEC CICS READ
 21037*        DATASET     (PLAN-ID)
 21038*        INTO        (PLAN-MASTER)
 21039*        RIDFLD      (ERPLAN-KEY)
 21040*    END-EXEC.
 21041     MOVE LENGTH OF
 21042      PLAN-MASTER
 21043       TO DFHEIV11
 21044*    MOVE '&"IL       E          (   #00019812' TO DFHEIV0
 21045     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21047     MOVE X'2020233030303139383132' TO DFHEIV0(25:11)
 21048     CALL 'kxdfhei1' USING DFHEIV0,
 21049           PLAN-ID,
 21050           PLAN-MASTER,
 21051           DFHEIV11,
 21052           ERPLAN-KEY,
 21053           DFHEIV99,
 21054           DFHEIV99,
 21055           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 390
* EL050.cbl
 21056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21057
 21058
 21059     MOVE 'Y'                    TO PLAN-MASTER-SW.
 21060
 21061     GO TO 8585-EXIT.
 21062
 21063 8585-PLAN-NOT-FOUND.
 21064
 21065     MOVE 'N'                    TO PLAN-MASTER-SW.
 21066
 21067 8585-EXIT.
 21068     EXIT.
 21069
 21070 8586-READ-LOAN-OFFICER.
 21071
 21072* EXEC CICS READ
 21073*        DATASET     (LOFC-ID)
 21074*        INTO        (LOAN-OFFICER-MASTER)
 21075*        RIDFLD      (ERLOFC-KEY)
 21076*        RESP        (WS-RESPONSE)
 21077*    END-EXEC
 21078     MOVE LENGTH OF
 21079      LOAN-OFFICER-MASTER
 21080       TO DFHEIV11
 21081*    MOVE '&"IL       E          (  N#00019830' TO DFHEIV0
 21082     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21084     MOVE X'204E233030303139383330' TO DFHEIV0(25:11)
 21085     CALL 'kxdfhei1' USING DFHEIV0,
 21086           LOFC-ID,
 21087           LOAN-OFFICER-MASTER,
 21088           DFHEIV11,
 21089           ERLOFC-KEY,
 21090           DFHEIV99,
 21091           DFHEIV99,
 21092           DFHEIV99
 21093     MOVE EIBRESP  TO WS-RESPONSE
 21094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21095
 21096     IF WS-RESP-NORMAL
 21097        MOVE 'Y'                 TO LOFC-MASTER-SW
 21098     ELSE
 21099        MOVE 'N'                 TO LOFC-MASTER-SW
 21100     END-IF
 21101     .
 21102 8586-EXIT.
 21103     EXIT.
 21104 8587-START-ERPDEF.
 21105
 21106* EXEC CICS STARTBR
 21107*       DATASET   (PDEF-ID)
 21108*       RIDFLD    (ERPDEF-KEY)
 21109*       GTEQ
 21110*       RESP      (WS-RESPONSE)
 21111*    END-EXEC
 21112     MOVE 0
 21113       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 391
* EL050.cbl
 21114*    MOVE '&,         G          &  N#00019846' TO DFHEIV0
 21115     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21116     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21117     MOVE X'204E233030303139383436' TO DFHEIV0(25:11)
 21118     CALL 'kxdfhei1' USING DFHEIV0,
 21119           PDEF-ID,
 21120           ERPDEF-KEY,
 21121           DFHEIV99,
 21122           DFHEIV11,
 21123           DFHEIV99
 21124     MOVE EIBRESP  TO WS-RESPONSE
 21125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21126     IF WS-RESP-NORMAL
 21127        MOVE 'Y'                 TO PDEF-MASTER-SW
 21128     ELSE
 21129        MOVE 'N'                 TO PDEF-MASTER-SW
 21130     END-IF
 21131     .
 21132 8587-EXIT.
 21133     EXIT.
 21134 8588-READ-ERPDEF.
 21135
 21136* EXEC CICS READNEXT
 21137*       DATASET   (PDEF-ID)
 21138*       RIDFLD    (ERPDEF-KEY)
 21139*       INTO      (PRODUCT-MASTER)
 21140*       RESP      (WS-RESPONSE)
 21141*    END-EXEC
 21142     MOVE LENGTH OF
 21143      PRODUCT-MASTER
 21144       TO DFHEIV12
 21145     MOVE 0
 21146       TO DFHEIV11
 21147*    MOVE '&.IL                  )  N#00019861' TO DFHEIV0
 21148     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21149     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21150     MOVE X'204E233030303139383631' TO DFHEIV0(25:11)
 21151     CALL 'kxdfhei1' USING DFHEIV0,
 21152           PDEF-ID,
 21153           PRODUCT-MASTER,
 21154           DFHEIV12,
 21155           ERPDEF-KEY,
 21156           DFHEIV99,
 21157           DFHEIV11,
 21158           DFHEIV99,
 21159           DFHEIV99
 21160     MOVE EIBRESP  TO WS-RESPONSE
 21161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21162     IF WS-RESP-NORMAL
 21163        MOVE 'Y'                 TO PDEF-MASTER-SW
 21164     ELSE
 21165        MOVE 'N'                 TO PDEF-MASTER-SW
 21166     END-IF
 21167     .
 21168 8588-EXIT.
 21169     EXIT.
 21170 8589-ENDBR-ERPDEF.
 21171
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 392
* EL050.cbl
 21172* EXEC CICS ENDBR
 21173*       DATASET   (PDEF-ID)
 21174*    END-EXEC
 21175     MOVE 0
 21176       TO DFHEIV11
 21177*    MOVE '&2                    $   #00019876' TO DFHEIV0
 21178     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21179     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21180     MOVE X'2020233030303139383736' TO DFHEIV0(25:11)
 21181     CALL 'kxdfhei1' USING DFHEIV0,
 21182           PDEF-ID,
 21183           DFHEIV11,
 21184           DFHEIV99
 21185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21186     .
 21187 8589-EXIT.
 21188     EXIT.
 21189 8590-READ-CERT-MASTER.
 21190     IF PB-COMPANY-ID = 'UCL'
 21191         GO TO 8690-READ-CERT-MASTER-UCL.
 21192
 21193
 21194* EXEC CICS HANDLE CONDITION
 21195*         NOTFND    (0299-CERT-NOT-FOUND)
 21196*    END-EXEC.
 21197*    MOVE '"$I                   ! < #00019886' TO DFHEIV0
 21198     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21200     MOVE X'3C20233030303139383836' TO DFHEIV0(25:11)
 21201     CALL 'kxdfhei1' USING DFHEIV0
 21202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21203
 21204
 21205
 21206* EXEC CICS READ
 21207*        DATASET     (CERT-ID)
 21208*        INTO        (CERTIFICATE-MASTER)
 21209*        RIDFLD      (ELCERT-KEY)
 21210*        UPDATE
 21211*    END-EXEC.
 21212     MOVE LENGTH OF
 21213      CERTIFICATE-MASTER
 21214       TO DFHEIV11
 21215*    MOVE '&"IL       EU         (   #00019890' TO DFHEIV0
 21216     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21217     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21218     MOVE X'2020233030303139383930' TO DFHEIV0(25:11)
 21219     CALL 'kxdfhei1' USING DFHEIV0,
 21220           CERT-ID,
 21221           CERTIFICATE-MASTER,
 21222           DFHEIV11,
 21223           ELCERT-KEY,
 21224           DFHEIV99,
 21225           DFHEIV99,
 21226           DFHEIV99
 21227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21228
 21229
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 393
* EL050.cbl
 21230 8590-EXIT.
 21231     EXIT.
 21232
 21233 8690-READ-CERT-MASTER-UCL.
 21234
 21235* EXEC CICS HANDLE CONDITION
 21236*         NOTFND    (8700-READ-CERT-MASTER)
 21237*    END-EXEC.
 21238*    MOVE '"$I                   ! = #00019901' TO DFHEIV0
 21239     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21240     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21241     MOVE X'3D20233030303139393031' TO DFHEIV0(25:11)
 21242     CALL 'kxdfhei1' USING DFHEIV0
 21243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21244
 21245
 21246 8690-READ-CERT-CONT.
 21247
 21248* EXEC CICS READ
 21249*        DATASET     (CERT-ID)
 21250*        INTO        (CERTIFICATE-MASTER)
 21251*        RIDFLD      (ELCERT-KEY)
 21252*        UPDATE
 21253*    END-EXEC.
 21254     MOVE LENGTH OF
 21255      CERTIFICATE-MASTER
 21256       TO DFHEIV11
 21257*    MOVE '&"IL       EU         (   #00019906' TO DFHEIV0
 21258     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21259     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21260     MOVE X'2020233030303139393036' TO DFHEIV0(25:11)
 21261     CALL 'kxdfhei1' USING DFHEIV0,
 21262           CERT-ID,
 21263           CERTIFICATE-MASTER,
 21264           DFHEIV11,
 21265           ELCERT-KEY,
 21266           DFHEIV99,
 21267           DFHEIV99,
 21268           DFHEIV99
 21269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21270
 21271
 21272     GO TO 8590-EXIT.
 21273
 21274 8700-READ-CERT-MASTER.
 21275     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21276     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21277
 21278* EXEC CICS HANDLE CONDITION
 21279*         DUPKEY    (8720-COMP-ACCOUNTS)
 21280*         ENDFILE   (8730-END-BROWSE)
 21281*         NOTFND    (8740-NOT-FOUND)
 21282*    END-EXEC.
 21283*    MOVE '"$$''I                 ! > #00019918' TO DFHEIV0
 21284     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21286     MOVE X'3E20233030303139393138' TO DFHEIV0(25:11)
 21287     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 394
* EL050.cbl
 21288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21289
 21290
 21291
 21292* EXEC CICS STARTBR
 21293*        DATASET     ('ELCERT5')
 21294*        RIDFLD      (ELCERT2-KEY)
 21295*        EQUAL
 21296*    END-EXEC.
 21297     MOVE 'ELCERT5' TO DFHEIV1
 21298     MOVE 0
 21299       TO DFHEIV11
 21300*    MOVE '&,         E          &   #00019924' TO DFHEIV0
 21301     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21302     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21303     MOVE X'2020233030303139393234' TO DFHEIV0(25:11)
 21304     CALL 'kxdfhei1' USING DFHEIV0,
 21305           DFHEIV1,
 21306           ELCERT2-KEY,
 21307           DFHEIV99,
 21308           DFHEIV11,
 21309           DFHEIV99
 21310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21311
 21312
 21313 8710-READ-NEXT.
 21314
 21315* EXEC CICS READNEXT
 21316*        DATASET     ('ELCERT5')
 21317*        INTO        (CERTIFICATE-MASTER)
 21318*        RIDFLD      (ELCERT2-KEY)
 21319*    END-EXEC.
 21320     MOVE LENGTH OF
 21321      CERTIFICATE-MASTER
 21322       TO DFHEIV12
 21323     MOVE 'ELCERT5' TO DFHEIV1
 21324     MOVE 0
 21325       TO DFHEIV11
 21326*    MOVE '&.IL                  )   #00019931' TO DFHEIV0
 21327     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21329     MOVE X'2020233030303139393331' TO DFHEIV0(25:11)
 21330     CALL 'kxdfhei1' USING DFHEIV0,
 21331           DFHEIV1,
 21332           CERTIFICATE-MASTER,
 21333           DFHEIV12,
 21334           ELCERT2-KEY,
 21335           DFHEIV99,
 21336           DFHEIV11,
 21337           DFHEIV99,
 21338           DFHEIV99
 21339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21340
 21341
 21342 8720-COMP-ACCOUNTS.
 21343
 21344* EXEC CICS ENTER
 21345*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 395
* EL050.cbl
 21346*         FROM (PB-C-LAST-NAME)
 21347*    END-EXEC.
 21348     MOVE 001
 21349       TO DFHEIV11
 21350*    MOVE ':$F                   %   #00019938' TO DFHEIV0
 21351     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21352     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21353     MOVE X'2020233030303139393338' TO DFHEIV0(25:11)
 21354     CALL 'kxdfhei1' USING DFHEIV0,
 21355           DFHEIV11,
 21356           PB-C-LAST-NAME,
 21357           DFHEIV99,
 21358           DFHEIV99
 21359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21360
 21361
 21362
 21363* EXEC CICS ENTER
 21364*         TRACEID (002)
 21365*         FROM (CM-INSURED-LAST-NAME)
 21366*    END-EXEC.
 21367     MOVE 002
 21368       TO DFHEIV11
 21369*    MOVE ':$F                   %   #00019943' TO DFHEIV0
 21370     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21371     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21372     MOVE X'2020233030303139393433' TO DFHEIV0(25:11)
 21373     CALL 'kxdfhei1' USING DFHEIV0,
 21374           DFHEIV11,
 21375           CM-INSURED-LAST-NAME,
 21376           DFHEIV99,
 21377           DFHEIV99
 21378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21379
 21380
 21381     IF PB-CERT-NO NOT = CM-CERT-NO
 21382         GO TO 8730-END-BROWSE.
 21383
 21384     IF PB-ACCOUNT = CM-ACCOUNT
 21385         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21386             MOVE ER-2799        TO WS-ERROR
 21387             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21388             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21389             GO TO 8730-END-BROWSE.
 21390
 21391     GO TO 8710-READ-NEXT.
 21392
 21393 8730-END-BROWSE.
 21394
 21395* EXEC CICS ENDBR
 21396*         DATASET    ('ELCERT5')
 21397*    END-EXEC.
 21398     MOVE 'ELCERT5' TO DFHEIV1
 21399     MOVE 0
 21400       TO DFHEIV11
 21401*    MOVE '&2                    $   #00019961' TO DFHEIV0
 21402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 396
* EL050.cbl
 21404     MOVE X'2020233030303139393631' TO DFHEIV0(25:11)
 21405     CALL 'kxdfhei1' USING DFHEIV0,
 21406           DFHEIV1,
 21407           DFHEIV11,
 21408           DFHEIV99
 21409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21410
 21411
 21412 8740-NOT-FOUND.
 21413     GO TO 0299-CERT-NOT-FOUND.
 21414
 21415 8750-START-ELSTAT.
 21416
 21417* EXEC CICS STARTBR
 21418*       DATASET   (STAT-ID)
 21419*       RIDFLD    (ELSTAT-KEY)
 21420*       GTEQ
 21421*       RESP      (WS-RESPONSE)
 21422*    END-EXEC
 21423     MOVE 0
 21424       TO DFHEIV11
 21425*    MOVE '&,         G          &  N#00019969' TO DFHEIV0
 21426     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21427     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21428     MOVE X'204E233030303139393639' TO DFHEIV0(25:11)
 21429     CALL 'kxdfhei1' USING DFHEIV0,
 21430           STAT-ID,
 21431           ELSTAT-KEY,
 21432           DFHEIV99,
 21433           DFHEIV11,
 21434           DFHEIV99
 21435     MOVE EIBRESP  TO WS-RESPONSE
 21436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21437     IF WS-RESP-NORMAL
 21438        MOVE 'Y'                 TO STAT-MASTER-SW
 21439     ELSE
 21440        MOVE 'N'                 TO STAT-MASTER-SW
 21441     END-IF
 21442     .
 21443 8750-EXIT.
 21444     EXIT.
 21445 8752-READ-ELSTAT.
 21446
 21447* EXEC CICS READNEXT
 21448*       DATASET   (STAT-ID)
 21449*       RIDFLD    (ELSTAT-KEY)
 21450*       INTO      (STATE-FILE)
 21451*       RESP      (WS-RESPONSE)
 21452*    END-EXEC
 21453     MOVE LENGTH OF
 21454      STATE-FILE
 21455       TO DFHEIV12
 21456     MOVE 0
 21457       TO DFHEIV11
 21458*    MOVE '&.IL                  )  N#00019984' TO DFHEIV0
 21459     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21460     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21461     MOVE X'204E233030303139393834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 397
* EL050.cbl
 21462     CALL 'kxdfhei1' USING DFHEIV0,
 21463           STAT-ID,
 21464           STATE-FILE,
 21465           DFHEIV12,
 21466           ELSTAT-KEY,
 21467           DFHEIV99,
 21468           DFHEIV11,
 21469           DFHEIV99,
 21470           DFHEIV99
 21471     MOVE EIBRESP  TO WS-RESPONSE
 21472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21473     IF WS-RESP-NORMAL
 21474        MOVE 'Y'                 TO STAT-MASTER-SW
 21475     ELSE
 21476        MOVE 'N'                 TO STAT-MASTER-SW
 21477     END-IF
 21478     .
 21479 8752-EXIT.
 21480     EXIT.
 21481 8800-GET-COMP-RATE.
 21482     MOVE +1 TO IB.
 21483     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21484         ADD +9 TO IB
 21485         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21486             ADD +9 TO IB
 21487             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21488                MOVE ZEROS       TO WS-WK-RATE
 21489                GO TO 8800-EXIT.
 21490
 21491     IF PB-I-AGE GREATER CT-AGE (1)
 21492         ADD +3 TO IB
 21493         IF PB-I-AGE GREATER CT-AGE (2)
 21494             ADD +3 TO IB
 21495             IF PB-I-AGE GREATER CT-AGE (3)
 21496                MOVE ZEROS       TO WS-WK-RATE
 21497                GO TO 8800-EXIT.
 21498
 21499     IF WS-WORK-TERM GREATER CT-TRM (1)
 21500         ADD +1 TO IB
 21501         IF WS-WORK-TERM GREATER CT-TRM (2)
 21502             ADD +1 TO IB
 21503             IF WS-WORK-TERM GREATER CT-TRM (3)
 21504                MOVE ZEROS       TO WS-WK-RATE
 21505                GO TO 8800-EXIT.
 21506
 21507     IF CT-RT (IB) NOT NUMERIC
 21508         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21509         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21510         GO TO 8800-GET-COMP-RATE.
 21511
 21512     MOVE CT-RT (IB) TO WS-WK-RATE.
 21513
 21514 8800-EXIT.
 21515     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 398
* EL050.cbl
 21517 8900-ADDRESS-FILE.
 21518     IF ERACCT-FILE-ADDRESSED
 21519         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21520         GO TO 8900-ADDRESS-EXIT.
 21521
 21522     IF ELCNTL-FILE-ADDRESSED
 21523         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21524         GO TO 8900-ADDRESS-EXIT.
 21525
 21526     IF ERPLAN-FILE-ADDRESSED
 21527         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21528         GO TO 8900-ADDRESS-EXIT.
 21529
 21530     IF ERFORM-FILE-ADDRESSED
 21531         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21532         GO TO 8900-ADDRESS-EXIT.
 21533
 21534 8900-ADDRESS-EXIT.
 21535     EXIT.
 21536
 21537 9000-READ-CONTROL.
 21538
 21539* EXEC CICS HANDLE CONDITION
 21540*        NOTFND    (9000-NOTFND)
 21541*    END-EXEC.
 21542*    MOVE '"$I                   ! ? #00020055' TO DFHEIV0
 21543     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21545     MOVE X'3F20233030303230303535' TO DFHEIV0(25:11)
 21546     CALL 'kxdfhei1' USING DFHEIV0
 21547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21548
 21549
 21550
 21551* EXEC CICS READ
 21552*        DATASET     (CNTL-ID)
 21553*        SET         (ADDRESS OF CONTROL-FILE)
 21554*        RIDFLD      (ELCNTL-KEY)
 21555*        GTEQ
 21556*    END-EXEC.
 21557*    MOVE '&"S        G          (   #00020059' TO DFHEIV0
 21558     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21559     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21560     MOVE X'2020233030303230303539' TO DFHEIV0(25:11)
 21561     CALL 'kxdfhei1' USING DFHEIV0,
 21562           CNTL-ID,
 21563           DFHEIV20,
 21564           DFHEIV99,
 21565           ELCNTL-KEY,
 21566           DFHEIV99,
 21567           DFHEIV99,
 21568           DFHEIV99
 21569     SET ADDRESS OF CONTROL-FILE TO
 21570         DFHEIV20
 21571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21572
 21573
 21574     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 399
* EL050.cbl
 21575
 21576 9000-NOTFND.
 21577     IF RC-SW-1 = '1'
 21578        MOVE ER-2616              TO WS-ERROR
 21579        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21580        GO TO 9000-EXIT.
 21581
 21582     IF RC-SW-1 = '2'
 21583        MOVE ER-2602              TO WS-ERROR
 21584        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21585
 21586 9000-EXIT.
 21587      EXIT.
 21588
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 400
* EL050.cbl
 21590 9100-READ-CONTROL.
 21591
 21592* EXEC CICS HANDLE CONDITION
 21593*        NOTFND  (9100-NOTFND)
 21594*        ENDFILE (9100-NOTFND)
 21595*    END-EXEC.
 21596*    MOVE '"$I''                  ! @ #00020083' TO DFHEIV0
 21597     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21599     MOVE X'4020233030303230303833' TO DFHEIV0(25:11)
 21600     CALL 'kxdfhei1' USING DFHEIV0
 21601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21602
 21603
 21604
 21605* EXEC CICS READ
 21606*        DATASET     (CNTL-ID)
 21607*        INTO        (CONTROL-FILE)
 21608*        RIDFLD      (ELCNTL-KEY)
 21609*        GTEQ
 21610*    END-EXEC.
 21611     MOVE LENGTH OF
 21612      CONTROL-FILE
 21613       TO DFHEIV11
 21614*    MOVE '&"IL       G          (   #00020088' TO DFHEIV0
 21615     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21617     MOVE X'2020233030303230303838' TO DFHEIV0(25:11)
 21618     CALL 'kxdfhei1' USING DFHEIV0,
 21619           CNTL-ID,
 21620           CONTROL-FILE,
 21621           DFHEIV11,
 21622           ELCNTL-KEY,
 21623           DFHEIV99,
 21624           DFHEIV99,
 21625           DFHEIV99
 21626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21627
 21628
 21629     GO TO 9100-EXIT.
 21630
 21631 9100-NOTFND.
 21632     IF RC-SW-2 = '0'
 21633        MOVE '1'                  TO STATE-RECORD-ERROR
 21634        GO TO 9100-EXIT
 21635     END-IF
 21636     IF RC-SW-2 = '1'
 21637        MOVE '1'                  TO LF-BENEFIT-ERROR
 21638        MOVE ER-2604              TO WS-ERROR
 21639        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21640        GO TO 9100-EXIT.
 21641
 21642     IF RC-SW-2 = '2'
 21643        MOVE '1'                  TO AH-BENEFIT-ERROR
 21644        MOVE ER-2605              TO WS-ERROR
 21645        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21646        GO TO 9100-EXIT.
 21647
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 401
* EL050.cbl
 21648     IF RC-SW-2 = '3'
 21649         MOVE ER-2603           TO WS-ERROR
 21650         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21651         GO TO 9100-EXIT.
 21652
 21653     IF RC-SW-2 = '4'
 21654         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21655         GO TO 9100-EXIT.
 21656
 21657     IF RC-SW-2 = '5'
 21658         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21659         IF WS-AH-INPUT-CD-1 = SPACE
 21660             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21661         ELSE
 21662             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21663
 21664 9100-EXIT.
 21665      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 402
* EL050.cbl
 21667 9200-CONTROL-GETMAIN.
 21668
 21669* EXEC CICS GETMAIN
 21670*         LENGTH   (750)
 21671*         SET      (ADDRESS OF CONTROL-FILE)
 21672*    END-EXEC.
 21673     MOVE 750
 21674       TO DFHEIV11
 21675*    MOVE '," L                  $   #00020134' TO DFHEIV0
 21676     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21677     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21678     MOVE X'2020233030303230313334' TO DFHEIV0(25:11)
 21679     CALL 'kxdfhei1' USING DFHEIV0,
 21680           DFHEIV20,
 21681           DFHEIV11,
 21682           DFHEIV99
 21683     SET ADDRESS OF CONTROL-FILE TO
 21684         DFHEIV20
 21685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21686
 21687
 21688     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21689
 21690 9200-EXIT.
 21691     EXIT.
 21692
 21693 9250-UNLOCK-RETURN.
 21694
 21695* EXEC CICS UNLOCK
 21696*        DATASET   (CERT-ID)
 21697*    END-EXEC.
 21698*    MOVE '&*                    #   #00020145' TO DFHEIV0
 21699     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21700     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21701     MOVE X'2020233030303230313435' TO DFHEIV0(25:11)
 21702     CALL 'kxdfhei1' USING DFHEIV0,
 21703           CERT-ID,
 21704           DFHEIV99
 21705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21706
 21707
 21708 9300-ABEND.
 21709     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21710
 21711
 21712* EXEC CICS LINK
 21713*        PROGRAM   ('EL004')
 21714*        COMMAREA  (WS-ERROR-LINE)
 21715*        LENGTH    (72)
 21716*    END-EXEC.
 21717     MOVE 'EL004' TO DFHEIV1
 21718     MOVE 72
 21719       TO DFHEIV11
 21720*    MOVE '."C                   (   #00020152' TO DFHEIV0
 21721     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21723     MOVE X'2020233030303230313532' TO DFHEIV0(25:11)
 21724     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 403
* EL050.cbl
 21725           DFHEIV1,
 21726           WS-ERROR-LINE,
 21727           DFHEIV11,
 21728           DFHEIV99,
 21729           DFHEIV99,
 21730           DFHEIV99,
 21731           DFHEIV99
 21732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21733
 21734
 21735     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21736
 21737
 21738* EXEC CICS ABEND
 21739*        ABCODE ('EL50')
 21740*    END-EXEC.
 21741     MOVE 'EL50' TO DFHEIV5
 21742*    MOVE '.,A                   "   #00020160' TO DFHEIV0
 21743     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21744     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21745     MOVE X'2020233030303230313630' TO DFHEIV0(25:11)
 21746     CALL 'kxdfhei1' USING DFHEIV0,
 21747           DFHEIV5
 21748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21749
 21750
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 404
* EL050.cbl
 21752
 21753******************************************************************
 21754*                                                                *
 21755*            E R R O R   F O R M A T   R O U T I N E             *
 21756*                                                                *
 21757******************************************************************
 21758
 21759 9900-ERROR-FORMAT.
 21760
 21761     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21762                    PB-COMMON-ERROR (2) OR
 21763                    PB-COMMON-ERROR (3) OR
 21764                    PB-COMMON-ERROR (4) OR
 21765                    PB-COMMON-ERROR (5) OR
 21766                    PB-COMMON-ERROR (6) OR
 21767                    PB-COMMON-ERROR (7) OR
 21768                    PB-COMMON-ERROR (8) OR
 21769                    PB-COMMON-ERROR (9) OR
 21770                    PB-COMMON-ERROR (10)
 21771        GO TO 9900-EXIT.
 21772
 21773     IF PB-NO-OF-ERRORS = +10
 21774        GO TO 9900-EXIT.
 21775
 21776     ADD +1  TO PB-NO-OF-ERRORS.
 21777     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21778                                       (PB-NO-OF-ERRORS).
 21779 9900-EXIT.
 21780     EXIT.
 21781
 21782 9990-RETURN.
 21783     IF BROWSE-STARTED
 21784
 21785* EXEC CICS ENDBR
 21786*            DATASET  (ACCT-ID)
 21787*       END-EXEC.
 21788     MOVE 0
 21789       TO DFHEIV11
 21790*    MOVE '&2                    $   #00020197' TO DFHEIV0
 21791     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21792     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21793     MOVE X'2020233030303230313937' TO DFHEIV0(25:11)
 21794     CALL 'kxdfhei1' USING DFHEIV0,
 21795           ACCT-ID,
 21796           DFHEIV11,
 21797           DFHEIV99
 21798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21799
 21800
 21801 9990-EXIT.
 21802     EXIT.
 21803
 21804
 21805****Check for CRTO record, add one if not found.
 21806 9991-CHECK-FOR-ELCRTO.
 21807
 21808* EXEC CICS HANDLE CONDITION
 21809*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 405
* EL050.cbl
 21810*         ENDFILE (9991-CRTO-NOT-FOUND)
 21811*     END-EXEC.
 21812*    MOVE '"$I''                  ! A #00020207' TO DFHEIV0
 21813     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21815     MOVE X'4120233030303230323037' TO DFHEIV0(25:11)
 21816     CALL 'kxdfhei1' USING DFHEIV0
 21817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21818
 21819     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21820     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21821     MOVE +0                     TO ELCRTO-SEQ-NO
 21822
 21823
 21824* EXEC CICS READ
 21825*       DATASET   ('ELCRTO')
 21826*       INTO      (ORIGINAL-CERTIFICATE)
 21827*       RIDFLD    (ELCRTO-KEY)
 21828*       GTEQ
 21829*       RESP      (WS-RESPONSE)
 21830*    END-EXEC
 21831     MOVE LENGTH OF
 21832      ORIGINAL-CERTIFICATE
 21833       TO DFHEIV11
 21834     MOVE 'ELCRTO' TO DFHEIV1
 21835*    MOVE '&"IL       G          (  N#00020215' TO DFHEIV0
 21836     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21838     MOVE X'204E233030303230323135' TO DFHEIV0(25:11)
 21839     CALL 'kxdfhei1' USING DFHEIV0,
 21840           DFHEIV1,
 21841           ORIGINAL-CERTIFICATE,
 21842           DFHEIV11,
 21843           ELCRTO-KEY,
 21844           DFHEIV99,
 21845           DFHEIV99,
 21846           DFHEIV99
 21847     MOVE EIBRESP  TO WS-RESPONSE
 21848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21849
 21850     IF WS-RESP-NORMAL
 21851        AND (OC-CONTROL-PRIMARY (1:33) =
 21852                 PB-CONTROL-BY-ACCOUNT (1:33))
 21853        AND (OC-RECORD-TYPE =  'I')
 21854           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21855               GO TO 9991-CHECK-INDICATORS
 21856           ELSE
 21857               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21858               GO TO 9991-CRTO-ADD-REC
 21859           END-IF
 21860     END-IF.
 21861
 21862 9991-CRTO-NOT-FOUND.
 21863
 21864     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21865     MOVE 'OC'                TO OC-RECORD-ID
 21866     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21867                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 406
* EL050.cbl
 21868     MOVE +4096               TO OC-KEY-SEQ-NO.
 21869
 21870 9991-CRTO-ADD-REC.
 21871
 21872     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21873     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21874     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21875     MOVE 'I'                 TO OC-RECORD-TYPE
 21876     IF PB-ISSUE
 21877         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21878         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21879         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21880         MOVE PB-I-AGE               TO OC-INS-AGE
 21881         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21882         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21883         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21884         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21885         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21886         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21887         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21888         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21889         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21890         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21891         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21892         IF PB-I-JOINT-COMMISSION > +0
 21893             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21894         ELSE
 21895             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21896         END-IF
 21897         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21898         MOVE +0                     TO OC-LF-CANCEL-AMT
 21899                                        OC-LF-ITD-CANCEL-AMT
 21900         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21901         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21902         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21903         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21904         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21905         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21906         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21907         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21908         MOVE +0                     TO OC-AH-CANCEL-AMT
 21909                                        OC-AH-ITD-CANCEL-AMT
 21910         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21911         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21912         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21913     ELSE
 21914         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21915         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21916         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21917         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21918         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21919         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21920         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21921         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21922         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21923          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21924             MOVE SPACES             TO OC-LF-BENCD
 21925             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 407
* EL050.cbl
 21926                                        OC-LF-BEN-AMT
 21927                                        OC-LF-PRM-AMT
 21928                                        OC-LF-ALT-BEN-AMT
 21929                                        OC-LF-ALT-PRM-AMT
 21930                                        OC-LF-COMM-PCT
 21931                                        OC-LF-CANCEL-AMT
 21932             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21933             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21934         ELSE
 21935             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21936             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21937             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21938             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21939             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21940             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21941             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21942             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21943             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21944             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21945         END-IF
 21946         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21947         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21948          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21949             MOVE SPACES             TO OC-AH-BENCD
 21950             MOVE ZEROS              TO OC-AH-TERM
 21951                                        OC-AH-BEN-AMT
 21952                                        OC-AH-PRM-AMT
 21953                                        OC-AH-COMM-PCT
 21954                                        OC-AH-CANCEL-AMT
 21955                                        OC-AH-CP
 21956             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21957             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21958         ELSE
 21959             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21960             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21961             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21962             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21963             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21964             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21965             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21966             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21967             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21968         END-IF
 21969         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21970         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21971         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21972         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21973     END-IF
 21974     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21975
 21976     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21977
 21978
 21979* EXEC CICS READ
 21980*         DATASET   (FILE-ERMAIL)
 21981*         RIDFLD    (MA-CONTROL-PRIMARY)
 21982*         INTO      (MAILING-DATA)
 21983*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 408
* EL050.cbl
 21984*    END-EXEC
 21985     MOVE LENGTH OF
 21986      MAILING-DATA
 21987       TO DFHEIV11
 21988*    MOVE '&"IL       E          (  N#00020351' TO DFHEIV0
 21989     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21990     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21991     MOVE X'204E233030303230333531' TO DFHEIV0(25:11)
 21992     CALL 'kxdfhei1' USING DFHEIV0,
 21993           FILE-ERMAIL,
 21994           MAILING-DATA,
 21995           DFHEIV11,
 21996           MA-CONTROL-PRIMARY,
 21997           DFHEIV99,
 21998           DFHEIV99,
 21999           DFHEIV99
 22000     MOVE EIBRESP  TO WS-RESPONSE
 22001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22002
 22003     IF WS-RESP-NORMAL
 22004         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22005     END-IF.
 22006
 22007     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22008     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22009
 22010
 22011* EXEC CICS READ
 22012*         DATASET  (CRTT-ID)
 22013*         RIDFLD   (WS-ELCRTT-KEY)
 22014*         INTO     (CERTIFICATE-TRAILERS)
 22015*         RESP     (WS-RESPONSE)
 22016*    END-EXEC
 22017     MOVE LENGTH OF
 22018      CERTIFICATE-TRAILERS
 22019       TO DFHEIV11
 22020*    MOVE '&"IL       E          (  N#00020365' TO DFHEIV0
 22021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22023     MOVE X'204E233030303230333635' TO DFHEIV0(25:11)
 22024     CALL 'kxdfhei1' USING DFHEIV0,
 22025           CRTT-ID,
 22026           CERTIFICATE-TRAILERS,
 22027           DFHEIV11,
 22028           WS-ELCRTT-KEY,
 22029           DFHEIV99,
 22030           DFHEIV99,
 22031           DFHEIV99
 22032     MOVE EIBRESP  TO WS-RESPONSE
 22033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22034
 22035     IF WS-RESP-NORMAL
 22036         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 22037         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 22038     END-IF.
 22039
 22040
 22041* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 409
* EL050.cbl
 22042*       DATASET   ('ELCRTO')
 22043*       FROM      (ORIGINAL-CERTIFICATE)
 22044*       RIDFLD    (OC-CONTROL-PRIMARY)
 22045*       RESP      (WS-RESPONSE)
 22046*    END-EXEC.
 22047     MOVE LENGTH OF
 22048      ORIGINAL-CERTIFICATE
 22049       TO DFHEIV11
 22050     MOVE 'ELCRTO' TO DFHEIV1
 22051*    MOVE '&$ L                  ''  N#00020377' TO DFHEIV0
 22052     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 22053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22054     MOVE X'204E233030303230333737' TO DFHEIV0(25:11)
 22055     CALL 'kxdfhei1' USING DFHEIV0,
 22056           DFHEIV1,
 22057           ORIGINAL-CERTIFICATE,
 22058           DFHEIV11,
 22059           OC-CONTROL-PRIMARY,
 22060           DFHEIV99,
 22061           DFHEIV99
 22062     MOVE EIBRESP  TO WS-RESPONSE
 22063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22064
 22065
 22066     GO TO 9991-EXIT.
 22067
 22068 9991-CHECK-INDICATORS.
 22069
 22070     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 22071         GO TO 9991-EXIT
 22072     END-IF.
 22073
 22074     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 22075         GO TO 9991-EXIT
 22076     END-IF.
 22077
 22078
 22079* EXEC CICS READ
 22080*       DATASET   ('ELCRTO')
 22081*       INTO      (ORIGINAL-CERTIFICATE)
 22082*       RIDFLD    (OC-CONTROL-PRIMARY)
 22083*       UPDATE
 22084*       RESP      (WS-RESPONSE)
 22085*    END-EXEC
 22086     MOVE LENGTH OF
 22087      ORIGINAL-CERTIFICATE
 22088       TO DFHEIV11
 22089     MOVE 'ELCRTO' TO DFHEIV1
 22090*    MOVE '&"IL       EU         (  N#00020396' TO DFHEIV0
 22091     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22092     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22093     MOVE X'204E233030303230333936' TO DFHEIV0(25:11)
 22094     CALL 'kxdfhei1' USING DFHEIV0,
 22095           DFHEIV1,
 22096           ORIGINAL-CERTIFICATE,
 22097           DFHEIV11,
 22098           OC-CONTROL-PRIMARY,
 22099           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 410
* EL050.cbl
 22100           DFHEIV99,
 22101           DFHEIV99
 22102     MOVE EIBRESP  TO WS-RESPONSE
 22103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22104     IF WS-RESP-NORMAL
 22105        IF PB-ISSUE
 22106          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22107          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22108          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22109          MOVE PB-I-AGE               TO OC-INS-AGE
 22110          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22111          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22112          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22113          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22114          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22115          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22116          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22117          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22118          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22119          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22120          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22121          IF PB-I-JOINT-COMMISSION > +0
 22122              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22123          ELSE
 22124              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22125          END-IF
 22126          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22127          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22128          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22129          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22130          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22131          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22132          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22133          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22134          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22135
 22136          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22137
 22138* EXEC CICS READ
 22139*             DATASET   (FILE-ERMAIL)
 22140*             RIDFLD    (MA-CONTROL-PRIMARY)
 22141*             INTO      (MAILING-DATA)
 22142*             RESP      (WS-RESPONSE)
 22143*         END-EXEC
 22144     MOVE LENGTH OF
 22145      MAILING-DATA
 22146       TO DFHEIV11
 22147*    MOVE '&"IL       E          (  N#00020436' TO DFHEIV0
 22148     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22150     MOVE X'204E233030303230343336' TO DFHEIV0(25:11)
 22151     CALL 'kxdfhei1' USING DFHEIV0,
 22152           FILE-ERMAIL,
 22153           MAILING-DATA,
 22154           DFHEIV11,
 22155           MA-CONTROL-PRIMARY,
 22156           DFHEIV99,
 22157           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 411
* EL050.cbl
 22158           DFHEIV99
 22159     MOVE EIBRESP  TO WS-RESPONSE
 22160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22161          IF WS-RESP-NORMAL
 22162             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22163          END-IF
 22164
 22165          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22166          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22167
 22168* EXEC CICS READ
 22169*             DATASET  (CRTT-ID)
 22170*             RIDFLD   (WS-ELCRTT-KEY)
 22171*             INTO     (CERTIFICATE-TRAILERS)
 22172*             RESP     (WS-RESPONSE)
 22173*         END-EXEC
 22174     MOVE LENGTH OF
 22175      CERTIFICATE-TRAILERS
 22176       TO DFHEIV11
 22177*    MOVE '&"IL       E          (  N#00020448' TO DFHEIV0
 22178     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22179     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22180     MOVE X'204E233030303230343438' TO DFHEIV0(25:11)
 22181     CALL 'kxdfhei1' USING DFHEIV0,
 22182           CRTT-ID,
 22183           CERTIFICATE-TRAILERS,
 22184           DFHEIV11,
 22185           WS-ELCRTT-KEY,
 22186           DFHEIV99,
 22187           DFHEIV99,
 22188           DFHEIV99
 22189     MOVE EIBRESP  TO WS-RESPONSE
 22190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22191          IF WS-RESP-NORMAL
 22192             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22193                               OC-INS-AGE-DEFAULT-FLAG
 22194             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22195                               OC-JNT-AGE-DEFAULT-FLAG
 22196          END-IF
 22197
 22198        ELSE
 22199          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22200             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22201             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22202             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22203          END-IF
 22204          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22205             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22206             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22207             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22208          END-IF
 22209          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22210        END-IF
 22211
 22212* EXEC CICS REWRITE
 22213*          DATASET   ('ELCRTO')
 22214*          FROM      (ORIGINAL-CERTIFICATE)
 22215*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 412
* EL050.cbl
 22216*       END-EXEC
 22217     MOVE LENGTH OF
 22218      ORIGINAL-CERTIFICATE
 22219       TO DFHEIV11
 22220     MOVE 'ELCRTO' TO DFHEIV1
 22221*    MOVE '&& L                  %  N#00020474' TO DFHEIV0
 22222     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22223     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22224     MOVE X'204E233030303230343734' TO DFHEIV0(25:11)
 22225     CALL 'kxdfhei1' USING DFHEIV0,
 22226           DFHEIV1,
 22227           ORIGINAL-CERTIFICATE,
 22228           DFHEIV11,
 22229           DFHEIV99
 22230     MOVE EIBRESP  TO WS-RESPONSE
 22231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22232     END-IF.
 22233
 22234 9991-EXIT.
 22235     EXIT.
 22236
 22237
 22238 9999-RETURN.
 22239     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22240
 22241
 22242* EXEC CICS RETURN
 22243*    END-EXEC.
 22244*    MOVE '.(                    ''   #00020488' TO DFHEIV0
 22245     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22246     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22247     MOVE X'2020233030303230343838' TO DFHEIV0(25:11)
 22248     CALL 'kxdfhei1' USING DFHEIV0,
 22249           DFHEIV99,
 22250           DFHEIV99,
 22251           DFHEIV99,
 22252           DFHEIV99,
 22253           DFHEIV99,
 22254           DFHEIV99
 22255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22256
 22257
 22258
 22259* GOBACK.
 22260     MOVE '9%                    "   ' TO DFHEIV0
 22261     MOVE 'EL050' TO DFHEIV1
 22262     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22263     GOBACK.
 22264
 22265 9999-DFHBACK SECTION.
 22266     MOVE '9%                    "   ' TO DFHEIV0
 22267     MOVE 'EL050' TO DFHEIV1
 22268     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22269     GOBACK.
 22270 9999-DFHEXIT.
 22271     IF DFHEIGDJ EQUAL 0001
 22272         NEXT SENTENCE
 22273     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 413
* EL050.cbl
 22274         GO TO 9300-ABEND,
 22275               3990-FILES-NOT-OPEN
 22276         DEPENDING ON DFHEIGDI
 22277     ELSE IF DFHEIGDJ EQUAL 3
 22278         GO TO 6610-START-BROWSE,
 22279               6630-ERRESS-PROBLEM,
 22280               6630-END-OF-FILE
 22281         DEPENDING ON DFHEIGDI
 22282     ELSE IF DFHEIGDJ EQUAL 4
 22283         GO TO 6630-END-OF-FILE,
 22284               6630-ERRESS-PROBLEM,
 22285               6630-ERRESS-PROBLEM,
 22286               6630-END-OF-FILE
 22287         DEPENDING ON DFHEIGDI
 22288     ELSE IF DFHEIGDJ EQUAL 5
 22289         GO TO 6630-END-OF-FILE,
 22290               6630-END-OF-FILE,
 22291               6630-ERRESS-PROBLEM,
 22292               6630-ERRESS-PROBLEM
 22293         DEPENDING ON DFHEIGDI
 22294     ELSE IF DFHEIGDJ EQUAL 6
 22295         GO TO 6660-START-BROWSE,
 22296               6690-ERRESC-PROBLEM,
 22297               6690-ERRESC-PROBLEM,
 22298               6690-END-OF-FILE
 22299         DEPENDING ON DFHEIGDI
 22300     ELSE IF DFHEIGDJ EQUAL 7
 22301         GO TO 6690-END-OF-FILE,
 22302               6690-ERRESC-PROBLEM,
 22303               6690-ERRESC-PROBLEM,
 22304               6690-END-OF-FILE
 22305         DEPENDING ON DFHEIGDI
 22306     ELSE IF DFHEIGDJ EQUAL 8
 22307         GO TO 6690-END-OF-FILE,
 22308               6690-ERRESC-PROBLEM,
 22309               6690-ERRESC-PROBLEM,
 22310               6690-END-OF-FILE
 22311         DEPENDING ON DFHEIGDI
 22312     ELSE IF DFHEIGDJ EQUAL 9
 22313         GO TO 7250-CONTINUE,
 22314               7250-CONTINUE
 22315         DEPENDING ON DFHEIGDI
 22316     ELSE IF DFHEIGDJ EQUAL 10
 22317         GO TO 7300-CONTINUE,
 22318               7300-CONTINUE
 22319         DEPENDING ON DFHEIGDI
 22320     ELSE IF DFHEIGDJ EQUAL 11
 22321         GO TO 8000-FREE-MAIN
 22322         DEPENDING ON DFHEIGDI
 22323     ELSE IF DFHEIGDJ EQUAL 12
 22324         GO TO 8100-NOTFND,
 22325               8100-NOTFND
 22326         DEPENDING ON DFHEIGDI
 22327     ELSE IF DFHEIGDJ EQUAL 13
 22328         GO TO 8110-NOTFND,
 22329               8110-NOTFND
 22330         DEPENDING ON DFHEIGDI
 22331     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 414
* EL050.cbl
 22332         GO TO 8130-EXIT
 22333         DEPENDING ON DFHEIGDI
 22334     ELSE IF DFHEIGDJ EQUAL 15
 22335         GO TO 8150-exit
 22336         DEPENDING ON DFHEIGDI
 22337     ELSE IF DFHEIGDJ EQUAL 16
 22338         GO TO 8180-NOTFND
 22339         DEPENDING ON DFHEIGDI
 22340     ELSE IF DFHEIGDJ EQUAL 17
 22341         GO TO 8190-NOTFND
 22342         DEPENDING ON DFHEIGDI
 22343     ELSE IF DFHEIGDJ EQUAL 18
 22344         GO TO 8195-NOTFND
 22345         DEPENDING ON DFHEIGDI
 22346     ELSE IF DFHEIGDJ EQUAL 19
 22347         GO TO 8200-NOTFND
 22348         DEPENDING ON DFHEIGDI
 22349     ELSE IF DFHEIGDJ EQUAL 20
 22350         GO TO 8300-NOTFND,
 22351               8300-ERRESS-PROBLEM,
 22352               8300-ERRESS-PROBLEM,
 22353               8300-NOTFND
 22354         DEPENDING ON DFHEIGDI
 22355     ELSE IF DFHEIGDJ EQUAL 21
 22356         GO TO 8450-FORM-NOT-FOUND,
 22357               8450-FORM-NOT-FOUND
 22358         DEPENDING ON DFHEIGDI
 22359     ELSE IF DFHEIGDJ EQUAL 22
 22360         GO TO 0199-ACCT-NOT-FOUND,
 22361               0199-ACCT-NOT-FOUND
 22362         DEPENDING ON DFHEIGDI
 22363     ELSE IF DFHEIGDJ EQUAL 23
 22364         GO TO 0199-ACCT-NOT-FOUND,
 22365               0199-ACCT-NOT-FOUND
 22366         DEPENDING ON DFHEIGDI
 22367     ELSE IF DFHEIGDJ EQUAL 24
 22368         GO TO 8582-COMP-NOT-FOUND,
 22369               8582-COMP-NOT-FOUND
 22370         DEPENDING ON DFHEIGDI
 22371     ELSE IF DFHEIGDJ EQUAL 25
 22372         GO TO 8583-AGTC-NOT-FOUND,
 22373               8583-AGTC-NOT-FOUND
 22374         DEPENDING ON DFHEIGDI
 22375     ELSE IF DFHEIGDJ EQUAL 26
 22376         GO TO 8584-BXRF-NOT-FOUND,
 22377               8584-BXRF-NOT-FOUND
 22378         DEPENDING ON DFHEIGDI
 22379     ELSE IF DFHEIGDJ EQUAL 27
 22380         GO TO 8585-PLAN-NOT-FOUND,
 22381               8585-PLAN-NOT-FOUND
 22382         DEPENDING ON DFHEIGDI
 22383     ELSE IF DFHEIGDJ EQUAL 28
 22384         GO TO 0299-CERT-NOT-FOUND
 22385         DEPENDING ON DFHEIGDI
 22386     ELSE IF DFHEIGDJ EQUAL 29
 22387         GO TO 8700-READ-CERT-MASTER
 22388         DEPENDING ON DFHEIGDI
 22389     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:09 Page 415
* EL050.cbl
 22390         GO TO 8720-COMP-ACCOUNTS,
 22391               8730-END-BROWSE,
 22392               8740-NOT-FOUND
 22393         DEPENDING ON DFHEIGDI
 22394     ELSE IF DFHEIGDJ EQUAL 31
 22395         GO TO 9000-NOTFND
 22396         DEPENDING ON DFHEIGDI
 22397     ELSE IF DFHEIGDJ EQUAL 32
 22398         GO TO 9100-NOTFND,
 22399               9100-NOTFND
 22400         DEPENDING ON DFHEIGDI
 22401     ELSE IF DFHEIGDJ EQUAL 33
 22402         GO TO 9991-CRTO-NOT-FOUND,
 22403               9991-CRTO-NOT-FOUND
 22404         DEPENDING ON DFHEIGDI.
 22405     MOVE '9%                    "   ' TO DFHEIV0
 22406     MOVE 'EL050' TO DFHEIV1
 22407     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22408     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40696     Code:       91518
