* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   1
* EL154.cbl
* Options: int("EL154.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL154.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL154.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL154.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL154.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/21/94 15:39:26.
     7*                            VMOD=2.022
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   2
* EL154.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EX28 - SET-UP AUTOMATIC PAYMENTS.
    26*        USED TO CREATE NEW AUTOMATIC PAYMENT SCHEDULES AND/OR
    27*        SIGN-OFF CURRENT SCHEDULES.  ONCE A SCHEDULE HAS BEEN
    28*        CREATED IT MAY ONLY BY REPLACED - NOT CHANGED
    29*        OR DELETED.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 090108    2007041300006  AJRA  ENTER LETTER FORM NUMBER ON SET U
    39* 031809    2009031600001  AJRA  ALLOW IU PAYMENT PAST EXP DATE
    40* 070909    2009060400001  AJRA  ADD AUTO PAY STOP LETTER
    41* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    42* 100713  IR2013092400001  PEMA  USE EXP DT IF NO CRIT PER - DCC
    43******************************************************************
    44
    45 ENVIRONMENT DIVISION.
    46
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   3
* EL154.cbl
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*    EL154 WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.022 *********'.
    54 77  P1                          PIC S999 COMP-3 VALUE +0.
    55 77  P2                          PIC S999 COMP-3 VALUE +0.
    56 77  s1                          PIC S999 COMP-3 VALUE +0.
    57 77  s2                          PIC S999 COMP-3 VALUE +0.
    58 77  ws-benefit-expiration-dt    pic xx value low-values.
    59
    60*                            COPY ELCSCTM.
    61******************************************************************
    62*                                                                *
    63*                                                                *
    64*                            ELCSCTM                             *
    65*                            VMOD=2.001                          *
    66*                                                                *
    67*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    68*                                                                *
    69******************************************************************
    70 01  SECURITY-MESSAGE.
    71     12  FILLER                          PIC X(30)
    72            VALUE '** LOGIC SECURITY VIOLATION -'.
    73     12  SM-READ                         PIC X(6).
    74     12  FILLER                          PIC X(5)
    75            VALUE ' PGM='.
    76     12  SM-PGM                          PIC X(6).
    77     12  FILLER                          PIC X(5)
    78            VALUE ' OPR='.
    79     12  SM-PROCESSOR-ID                 PIC X(4).
    80     12  FILLER                          PIC X(6)
    81            VALUE ' TERM='.
    82     12  SM-TERMID                       PIC X(4).
    83     12  FILLER                          PIC XX   VALUE SPACE.
    84     12  SM-JUL-DATE                     PIC 9(5).
    85     12  FILLER                          PIC X    VALUE SPACE.
    86     12  SM-TIME                         PIC 99.99.
    87
    88
    89*                            COPY ELCSCRTY.
    90******************************************************************
    91*                                                                *
    92*                                                                *
    93*                            ELCSCRTY                            *
    94*                            VMOD=2.001                          *
    95*                                                                *
    96*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    97*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    98*        SAVED IN PI-SECURITY-ADDRESS.                           *
    99*                                                                *
   100******************************************************************
   101 01  SECURITY-CONTROL.
   102     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   103     12  FILLER                       PIC XX    VALUE 'SC'.
   104     12  SC-CREDIT-CODES.
   105         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   4
* EL154.cbl
   106             20  SC-CREDIT-DISPLAY    PIC X.
   107             20  SC-CREDIT-UPDATE     PIC X.
   108     12  SC-CLAIMS-CODES.
   109         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   110             20  SC-CLAIMS-DISPLAY    PIC X.
   111             20  SC-CLAIMS-UPDATE     PIC X.
   112
   113 01  WS-DATE-AREA.
   114     05  CURRENT-GREG-DATE   PIC X(8)    VALUE SPACES.
   115     05  CURRENT-BIN-DATE    PIC X(2)    VALUE SPACES.
   116     05  RETRO-ELIM-DATE     PIC XX      VALUE LOW-VALUES.
   117
   118 01  ws-dcc-product-code         pic xxx value spaces.
   119 01  ws-ah-benefit-cd            pic xx  value '00'.
   120 01  ws-monthly-benefit          pic s9(9)v99 comp-3 value +0.
   121 01  ws-max-benefit-amt          pic s9(9)v99 comp-3 value +0.
   122 01  ws-max-benefit-pmts         pic s999 comp-3 value +0.
   123 01  ws-benefits-prev-paid       pic s999 comp-3 value +0.
   124 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   125     88  PDEF-FOUND                   VALUE 'Y'.
   126 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   127     88  ACCT-FOUND                   VALUE 'Y'.
   128 01  ws-cert-trlr-sw             PIC X  VALUE ' '.
   129     88  cert-trlr-found              VALUE 'Y'.
   130 01  STANDARD-AREAS.
   131     12  WS-RESPONSE             PIC S9(8)   COMP.
   132         88  WS-RESP-NORMAL        VALUE +00.
   133         88  WS-RESP-ERROR         VALUE +01.
   134         88  WS-RESP-NOTFND        VALUE +13.
   135         88  WS-RESP-DUPREC        VALUE +14.
   136         88  WS-RESP-ENDFILE       VALUE +20.
   137     12  SC-ITEM             PIC S9(4)   VALUE +1  COMP.
   138     12  SUB-1               PIC S9(4)   VALUE +0  COMP.
   139     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   140     12  MAP-NAME.
   141         16  MAP-PRE         PIC XX      VALUE 'EL'.
   142         16  MAP-NUMBER      PIC X(4)    VALUE '154A'.
   143         16  FILLER          PIC XX      VALUE SPACES.
   144     12  MAPSET-NAME         PIC X(8)    VALUE 'EL154S'.
   145     12  TRANS-ID            PIC X(4)    VALUE 'EX28'.
   146     12  LGXX-ID             PIC X(4)    VALUE 'LGXX'.
   147     12  PGM-NAME            PIC X(8).
   148     12  TIME-IN             PIC S9(7).
   149     12  TIME-OUT-R  REDEFINES TIME-IN.
   150         16  FILLER          PIC X.
   151         16  TIME-OUT        PIC 99V99.
   152         16  FILLER          PIC X(2).
   153     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   154     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   155     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   156
   157     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   158     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   159     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   160     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   161     12  THIS-PGM            PIC X(8)    VALUE 'EL154'.
   162
   163     12  DEEDIT-FIELD            PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   5
* EL154.cbl
   164     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD   PIC S9(15).
   165
   166     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   167     12  NEFFDTE-SAVE            PIC XX       VALUE LOW-VALUES.
   168     12  NFSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   169     12  NLSTPMT-SAVE            PIC XX       VALUE LOW-VALUES.
   170     12  NFSTAMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   171     12  NREGPMT-SAVE            PIC S9(7)V99 VALUE +0   COMP-3.
   172     12  CURRENT-SAVE            PIC XX       VALUE LOW-VALUES.
   173     12  LETTDTE-SAVE            PIC X(10)    VALUE SPACES.
   174     12  WS-WORK                 PIC S9(5)    VALUE ZERO COMP-3.
   175     12  WS-REMAINDER            PIC S9(5)    VALUE ZERO COMP-3.
   176     12  WS-DAYS-MINUS-TOL       PIC S9(5)    VALUE ZERO COMP-3.
   177     12  WS-DAYS-PLUS-TOL        PIC S9(5)    VALUE ZERO COMP-3.
   178     12  WS-DAILY-BEN-AMT        PIC S9(5)V99 VALUE ZERO COMP-3.
   179     12  WS-AMT-MINUS-TOL        PIC S9(7)V99 VALUE ZERO COMP-3.
   180     12  WS-AMT-PLUS-TOL         PIC S9(7)V99 VALUE ZERO COMP-3.
   181     12  WS-AMT-TOL              PIC S9(5)V99 VALUE ZERO COMP-3.
   182     12  WS-DAY-TOL              PIC S9(05)   VALUE ZERO COMP-3.
   183     12  WS-MAX-AUTO-PMT         PIC S9(7)V99 VALUE ZERO COMP-3.
   184     12  WS-MAX-AUTO-MOS         PIC S999     VALUE ZERO COMP-3.
   185     12  WS-ELAPSED-DAYS         PIC S9(04)   VALUE +0   COMP.
   186     12  WS-REG-PMT              PIC S9(7)V99 VALUE ZERO COMP-3.
   187     12  WS-EXP-DT               PIC XX       VALUE LOW-VALUES.
   188     12  WS-EXP-DT-PLUS7         PIC XX       VALUE LOW-VALUES.
   189     12  WS-CALC-METHOD          PIC X.
   190     12  WS-DAILY-RATE           PIC S9(3)V99.
   191     12  WS-CONFIRM-NEEDED       PIC X.
   192     12  WS-ELIMINATION-SW       PIC X        VALUE SPACES.
   193         88  NO-EFFDTE-ENTERED   VALUE 'N'.
   194     12  WS-BENEFIT-FOUND-SW     PIC X        VALUE SPACES.
   195         88  BENEFIT-FOUND       VALUE 'Y'.
   196     12  WS-ACT-REC-FOUND-SW     PIC X(01)    VALUE 'N'.
   197     12  WS-LETTER-SW            PIC X(01)    VALUE 'N'.
   198     12  WS-LETTER-FORM-NUM      PIC X(04)    VALUE SPACES.
   199     12  WS-END-LETTER-FORM-NUM  PIC X(04)    VALUE SPACES.
   200     12  WS-RESET-SW             PIC X(01)    VALUE 'N'.
   201     12  WS-PAYEE-CODE.
   202         16  WS-PAYEE-CD         PIC X(01).
   203         16  WS-PAYEE-SEQ        PIC X(01).
   204         16  WS-PAYEE-SEQ-NUM REDEFINES
   205             WS-PAYEE-SEQ        PIC 9(01).
   206     12  WS-ACCESS.
   207         16  FILLER              PIC XX       VALUE SPACES.
   208         16  WS-BEN-CD           PIC XX.
   209
   210     12  MISC-HEADING-AREAS.
   211         16  FIRST-PMT-HD1       PIC X(23)    VALUE
   212             'FIRST PAY THRU DATE   :'.
   213         16  FIRST-PMT-HD2       PIC X(23)    VALUE
   214             'FIRST PAY-TO DATE     :'.
   215         16  FIRST-PMT-HD3       PIC X(26)    VALUE
   216             '   FIRST PAY-THRU DATE   :'.
   217         16  FIRST-PMT-HD4       PIC X(26)    VALUE
   218             '   FIRST PAY-TO DATE     :'.
   219         16  LAST-PMT-HD1        PIC X(24)    VALUE
   220             'LAST PAY-THRU DATE     :'.
   221         16  LAST-PMT-HD2        PIC X(24)    VALUE
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   6
* EL154.cbl
   222             'LAST PAY-TO DATE       :'.
   223         16  LAST-PMT-HD3        PIC X(23)    VALUE
   224             'LAST PAY-THRU DATE    :'.
   225         16  LAST-PMT-HD4        PIC X(23)    VALUE
   226             'LAST PAY-TO DATE      :'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   7
* EL154.cbl
   228 01  ERROR-MESSAGES.
   229     12  ER-0000                 PIC X(4)     VALUE '0000'.
   230     12  ER-0004                 PIC X(4)     VALUE '0004'.
   231     12  ER-0008                 PIC X(4)     VALUE '0008'.
   232     12  ER-0029                 PIC X(4)     VALUE '0029'.
   233     12  ER-0042                 PIC X(4)     VALUE '0042'.
   234     12  ER-0050                 PIC X(4)     VALUE '0050'.
   235     12  ER-0070                 PIC X(4)     VALUE '0070'.
   236     12  ER-0130                 PIC X(4)     VALUE '0130'.
   237     12  ER-0154                 PIC X(4)     VALUE '0154'.
   238     12  ER-0169                 PIC X(4)     VALUE '0169'.
   239     12  ER-0172                 PIC X(4)     VALUE '0172'.
   240     12  ER-0186                 PIC X(4)     VALUE '0186'.
   241     12  ER-0206                 PIC X(4)     VALUE '0206'.
   242     12  ER-0283                 PIC X(4)     VALUE '0283'.
   243     12  ER-0346                 PIC X(4)     VALUE '0346'.
   244     12  ER-0347                 PIC X(4)     VALUE '0347'.
   245     12  ER-0348                 PIC X(4)     VALUE '0348'.
   246     12  ER-0349                 PIC X(4)     VALUE '0349'.
   247     12  ER-0350                 PIC X(4)     VALUE '0350'.
   248     12  ER-0351                 PIC X(4)     VALUE '0351'.
   249     12  ER-0352                 PIC X(4)     VALUE '0352'.
   250     12  ER-0353                 PIC X(4)     VALUE '0353'.
   251     12  ER-0354                 PIC X(4)     VALUE '0354'.
   252     12  ER-0357                 PIC X(4)     VALUE '0357'.
   253     12  ER-0358                 PIC X(4)     VALUE '0358'.
   254     12  ER-0372                 PIC X(4)     VALUE '0372'.
   255     12  ER-0396                 PIC X(4)     VALUE '0396'.
   256     12  ER-0397                 PIC X(4)     VALUE '0397'.
   257     12  ER-0398                 PIC X(4)     VALUE '0398'.
   258     12  ER-0399                 PIC X(4)     VALUE '0399'.
   259     12  ER-0401                 PIC X(4)     VALUE '0401'.
   260     12  ER-0402                 PIC X(4)     VALUE '0402'.
   261     12  ER-0403                 PIC X(4)     VALUE '0403'.
   262     12  ER-0404                 PIC X(4)     VALUE '0404'.
   263     12  ER-0450                 PIC X(4)     VALUE '0450'.
   264     12  ER-0541                 PIC X(4)     VALUE '0541'.
   265     12  ER-0559                 PIC X(4)     VALUE '0559'.
   266     12  ER-0563                 PIC X(4)     VALUE '0563'.
   267     12  ER-0597                 PIC X(4)     VALUE '0597'.
   268     12  ER-0632                 PIC X(4)     VALUE '0632'.
   269     12  ER-0670                 PIC X(4)     VALUE '0670'.
   270     12  ER-0802                 PIC X(4)     VALUE '0802'.
   271     12  ER-0803                 PIC X(4)     VALUE '0803'.
   272     12  ER-0815                 PIC X(4)     VALUE '0815'.
   273     12  ER-0826                 PIC X(4)     VALUE '0826'.
   274     12  ER-0839                 PIC X(4)     VALUE '0839'.
   275     12  ER-1599                 PIC X(4)     VALUE '1599'.
   276     12  er-1657                 pic x(4)     value '1657'.
   277     12  er-1658                 pic x(4)     value '1658'.
   278     12  ER-3396                 PIC X(4)     VALUE '3396'.
   279     12  ER-3397                 PIC X(4)     VALUE '3397'.
   280     12  ER-3537                 PIC X(4)     VALUE '3537'.
   281     12  ER-3801                 PIC X(4)     VALUE '3801'.
   282     12  ER-8200                 PIC X(4)     VALUE '8200'.
   283     12  ER-9483                 PIC X(4)     VALUE '9483'.
   284     12  ER-9883                 PIC X(4)     VALUE '9883'.
   285
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   8
* EL154.cbl
   287 01  ACCESS-KEYS.
   288     12  CNTL-ID                  PIC X(8)    VALUE 'ELCNTL'.
   289     12  CLAM-ID                  PIC X(8)    VALUE 'ELMSTR'.
   290     12  ACTV-ID                  PIC X(8)    VALUE 'ELTRLR'.
   291     12  CERT-ID                  PIC X(8)    VALUE 'ELCERT'.
   292     12  BENE-ID                  PIC X(8)    VALUE 'ELBENE'.
   293     12  EMPLCY-ID                PIC X(8)    VALUE 'MPPLCY'.
   294
   295     12  CNTL-KEY.
   296         16  CNTL-CO              PIC X(3).
   297         16  CNTL-RECORD-TYPE     PIC X       VALUE '1'.
   298         16  CNTL-GENL.
   299           18 CNTL-GEN1           PIC X(2)    VALUE SPACES.
   300           18 CNTL-GEN2.
   301             20 CNTL-GEN3         PIC X       VALUE SPACES.
   302             20 CNTL-GEN4         PIC X       VALUE SPACES.
   303         16  CNTL-SEQ             PIC S9(4)   VALUE +0    COMP.
   304
   305     12  ELTRLR-KEY.
   306         16  TRLR-COMP-CD        PIC X.
   307         16  TRLR-CARRIER        PIC X.
   308         16  TRLR-CLAIM-NO       PIC X(7).
   309         16  TRLR-CERT-NO        PIC X(11).
   310         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   311     12  CLAM-KEY.
   312         16  CLAM-CO              PIC X.
   313         16  CLAM-CARRIER         PIC X.
   314         16  CLAM-CLAIM           PIC X(7).
   315         16  CLAM-CERT-NUM        PIC X(11).
   316
   317     12  CLAIM-SAVE-KEY           PIC X(20).
   318
   319     12  ACTV-KEY.
   320         16  ACTV-PARTIAL-KEY.
   321             20  ACTV-CO          PIC X.
   322             20  ACTV-CARRIER     PIC X.
   323             20  ACTV-CLAIM       PIC X(7).
   324             20  ACTV-CERT-NUM    PIC X(11).
   325         16  ACTV-SEQ             PIC S9(4)  COMP.
   326
   327     12  CERT-KEY.
   328         16  CERT-CO             PIC X.
   329         16  CERT-CARRIER        PIC X.
   330         16  CERT-GROUPING       PIC X(6).
   331         16  CERT-STATE          PIC XX.
   332         16  CERT-ACCOUNT        PIC X(10).
   333         16  CERT-EFF-DT         PIC XX.
   334         16  CERT-CERT-NUM       PIC X(11).
   335
   336     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   337     12  ERACCT-KEY.
   338         16  ERACCT-PARTIAL-KEY.
   339             20  ACCT-COMP-CD    PIC X.
   340             20  ACCT-CARRIER    PIC X.
   341             20  ACCT-GROUPING   PIC X(6).
   342             20  ACCT-STATE      PIC XX.
   343             20  ACCT-ACCOUNT    PIC X(10).
   344         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page   9
* EL154.cbl
   345         16  FILLER              PIC X(4) VALUE SPACES.
   346     12  EMPLCY-KEY.
   347         16  EMPLCY-COMPANY-CD   PIC X(01).
   348         16  EMPLCY-CARRIER      PIC X(01).
   349         16  EMPLCY-GROUPING     PIC X(06).
   350         16  EMPLCY-STATE        PIC X(02).
   351         16  EMPLCY-PRODUCER     PIC X(10).
   352         16  EMPLCY-EFF-DT       PIC X(02).
   353         16  EMPLCY-REFERENCE-NO PIC X(20).
   354
   355     12  BENE-KEY.
   356         16  BENE-CO             PIC X(01).
   357         16  BENE-REC-TYPE       PIC X(01).
   358         16  BENE-CODE           PIC X(10).
   359 01  ERPDEF-KEY-SAVE             PIC X(18).
   360 01  ERPDEF-KEY.
   361     12  ERPDEF-COMPANY-CD       PIC X.
   362     12  ERPDEF-STATE            PIC XX.
   363     12  ERPDEF-PROD-CD          PIC XXX.
   364     12  F                       PIC X(7).
   365     12  ERPDEF-BEN-TYPE         PIC X.
   366     12  ERPDEF-BEN-CODE         PIC XX.
   367     12  ERPDEF-EXP-DT           PIC XX.
   368
   369 01  ELCRTT-KEY.
   370     05  CTRLR-COMP-CD       PIC X.
   371     05  CTRLR-CARRIER       PIC X.
   372     05  CTRLR-GROUPING      PIC X(6).
   373     05  CTRLR-STATE         PIC X(2).
   374     05  CTRLR-ACCOUNT       PIC X(10).
   375     05  CTRLR-EFF-DT        PIC XX.
   376     05  CTRLR-CERT-NO       PIC X(11).
   377     05  CTRLR-REC-TYPE      PIC X.
   378*                            COPY ELCCALC.
   379******************************************************************
   380*                                                                *
   381*                           ELCCALC.                            *
   382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   383*                            VMOD=2.025                          *
   384*                                                                *
   385*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   386*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   387*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   388*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   389*                                                                *
   390*  PASSED TO ELRTRM                                              *
   391*  -----------------                                             *
   392*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   393*  ORIGINAL TERM                                                 *
   394*  BEGINNING DATE                                                *
   395*  ENDING DATE                                                   *
   396*  COMPANY I.D.                                                  *
   397*  ACCOUNT MASTER USER FIELD                                     *
   398*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   399*  FREE LOOK DAYS                                                *
   400*                                                                *
   401*  RETURNED FROM ELRTRM                                          *
   402*  ---------------------                                         *
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  10
* EL154.cbl
   403*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   404*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   405*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   406*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   407*----------------------------------------------------------------*
   408*  PASSED TO ELRAMT                                              *
   409*  ----------------                                              *
   410*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   411*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   412*  ORIGINAL AMOUNT                                               *
   413*  ALTERNATE BENEFIT (BALLON)                                    *
   414*  A.P.R. - NET PAY ONLY                                         *
   415*  METHOD
   416*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   417*  COMPANY I.D.                                                  *
   418*  BENEFIT TYPE                                                  *
   419*                                                                *
   420*  RETURNED FROM ELRAMT                                          *
   421*  --------------------                                          *
   422*  REMAINING AMOUNT 1 - CURRENT                                  *
   423*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   424*  REMAINING AMOUNT FACTOR
   425*----------------------------------------------------------------*
   426*  PASSED TO ELRESV                                              *
   427*  -----------------                                             *
   428*  CERTIFICATE EFFECTIVE DATE                                    *
   429*  VALUATION DATE                                                *
   430*  PAID THRU DATE                                                *
   431*  BENEFIT                                                       *
   432*  INCURRED DATE                                                 *
   433*  REPORTED DATE                                                 *
   434*  ISSUE AGE                                                     *
   435*  TERM                                                          *
   436*  CDT PERCENT                                                   *
   437*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   438* *CLAIM TYPE (LIFE, A/H)                                        *
   439* *REMAINING BENEFIT (FROM ELRAMT)                               *
   440* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   441*                                                                *
   442*  RETURNED FROM ELRESV                                          *
   443*  --------------------                                          *
   444*  CDT TABLE USED                                                *
   445*  CDT FACTOR USED                                               *
   446*  PAY TO CURRENT RESERVE                                        *
   447*  I.B.N.R. - A/H ONLY                                           *
   448*  FUTURE (ACCRUED) AH ONLY                                      *
   449*----------------------------------------------------------------*
   450*  PASSED TO ELRATE                                              *
   451*  ----------------                                              *
   452*  CERT ISSUE DATE                                               *
   453*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   454*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   455*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   456*  STATE CODE (CLIENT DEFINED)                                   *
   457*  STATE CODE (STANDARD P.O. ABBRV)                              *
   458*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   459*  DEVIATION CODE                                                *
   460*  ISSUE AGE                                                     *
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  11
* EL154.cbl
   461*  ORIGINAL BENEFIT AMOUNT                                       *
   462*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   463*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   464*  BENEFIT KIND (LIFE OR A/H)                                    *
   465*  A.P.R.                                                        *
   466*  METHOD
   467*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   468*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   469*  COMPANY I.D. (3 CHARACTER)                                    *
   470*  BENEFIT CODE                                                  *
   471*  BENEFIT OVERRIDE CODE                                         *
   472*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   473*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   474*  JOINT INDICATOR (CSL ONLY)                                    *
   475*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   476*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   477*                                                                *
   478*  RETURNED FROM ELRATE                                          *
   479*  --------------------                                          *
   480*  CALCULATED PREMIUM                                            *
   481*  PREMIUM RATE                                                  *
   482*  MORTALITY CODE                                                *
   483*  MAX ATTAINED AGE                                              *
   484*  MAX AGE                                                       *
   485*  MAX TERM                                                      *
   486*  MAX MONTHLY BENEFIT                                           *
   487*  MAX TOTAL BENIFIT                                             *
   488*  COMPOSITE RATE (OPEN-END ONLY)                                *
   489*----------------------------------------------------------------*
   490*  PASSED TO ELRFND                                              *
   491*  ----------------                                              *
   492*  CERT ISSUE DATE                                               *
   493*  REFUND DATE                                                   *
   494*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   495*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   496*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   497*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   498*  STATE CODE (CLIENT DEFINED)                                   *
   499*  STATE CODE (STANDARD P.O. ABBRV)                              *
   500*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   501*  DEVIATION CODE                                                *
   502*  ISSUE AGE                                                     *
   503*  ORIGINAL BENEFIT AMOUNT                                       *
   504*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   505*  PROCESS TYPE (CANCEL)                                         *
   506*  BENEFIT KIND (LIFE OR A/H)                                    *
   507*  A.P.R.                                                        *
   508*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   509*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   510*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   511*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   512*  COMPANY I.D. (3 CHARACTER)                                    *
   513*  BENEFIT CODE                                                  *
   514*  BENEFIT OVERRIDE CODE                                         *
   515*                                                                *
   516*  RETURNED FROM ELRFND                                          *
   517*  --------------------                                          *
   518*  CALCULATED REFUND                                             *
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  12
* EL154.cbl
   519*----------------------------------------------------------------*
   520*  PASSED TO ELEARN                                              *
   521*  ----------------                                              *
   522*  CERT ISSUE DATE                                               *
   523*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   524*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   525*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   526*  STATE CODE (CLIENT DEFINED)                                   *
   527*  STATE CODE (STANDARD P.O. ABBRV)                              *
   528*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   529*  DEVIATION CODE                                                *
   530*  ISSUE AGE                                                     *
   531*  ORIGINAL BENEFIT AMOUNT                                       *
   532*  BENEFIT KIND (LIFE OR A/H)                                    *
   533*  A.P.R.                                                        *
   534*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   535*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   536*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   537*  COMPANY I.D. (3 CHARACTER)                                    *
   538*  BENEFIT CODE                                                  *
   539*  BENEFIT OVERRIDE CODE                                         *
   540*                                                                *
   541*  RETURNED FROM ELEARN                                          *
   542*  --------------------                                          *
   543*  INDICATED  EARNINGS                                           *
   544*----------------------------------------------------------------*
   545*                 LENGTH = 450                                   *
   546*                                                                *
   547******************************************************************
   548******************************************************************
   549*                   C H A N G E   L O G
   550*
   551* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   552*-----------------------------------------------------------------
   553*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   554* EFFECTIVE    NUMBER
   555*-----------------------------------------------------------------
   556* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   557* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   558* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   559* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   560* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   561* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   562* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   563* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   564* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   565******************************************************************
   566
   567 01  CALCULATION-PASS-AREA.
   568     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   569                                     COMP.
   570
   571     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   572       88  NO-CP-ERROR                             VALUE ZERO.
   573       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   574                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   575       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   576       88  CP-ERROR-IN-DATES                       VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  13
* EL154.cbl
   577       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   578       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   579       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   580       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   581       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   582       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   583       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   584       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   585       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   586       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   587       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   588       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   589       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   590       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   591       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   592
   593     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   594       88  NO-CP-ERROR-2                           VALUE ZERO.
   595***********************  INPUT AREAS ****************************
   596
   597     12  CP-CALCULATION-AREA.
   598         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   599         16  CP-CERT-EFF-DT        PIC XX.
   600         16  CP-VALUATION-DT       PIC XX.
   601         16  CP-PAID-THRU-DT       PIC XX.
   602         16  CP-BENEFIT-TYPE       PIC X.
   603           88  CP-AH                               VALUE 'A' 'D'
   604                                                   'I' 'U'.
   605           88  CP-REDUCING-LIFE                    VALUE 'R'.
   606           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   607         16  CP-INCURRED-DT        PIC XX.
   608         16  CP-REPORTED-DT        PIC XX.
   609         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
   610         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   611         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   612                                     COMP-3.
   613         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   614                                     COMP-3.
   615         16  CP-CDT-METHOD         PIC X.
   616           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   617           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   618           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   619         16  CP-CLAIM-TYPE         PIC X.
   620           88  CP-AH-CLAIM                         VALUE 'A'.
   621           88  CP-LIFE-CLAIM                       VALUE 'L'.
   622         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   623                                     COMP-3.
   624         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   625                                     COMP-3.
   626         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   627                                     COMP-3.
   628         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   629                                     COMP-3.
   630         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   631                                     COMP-3.
   632         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   633                                     COMP-3.
   634         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  14
* EL154.cbl
   635                                     COMP-3.
   636         16  CP-REM-TERM-METHOD    PIC X.
   637           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   638           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   639           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   640           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   641           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   642           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   643           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   644         16  CP-EARNING-METHOD     PIC X.
   645           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   646           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   647           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   648           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   649           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   650           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   651           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   652           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   653           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   654           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   655           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   656           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   657           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   658           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   659         16  CP-PROCESS-TYPE       PIC X.
   660           88  CP-CLAIM                            VALUE '1'.
   661           88  CP-CANCEL                           VALUE '2'.
   662           88  CP-ISSUE                            VALUE '3'.
   663         16  CP-SPECIAL-CALC-CD    PIC X.
   664           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   665           88  CP-1-MTH-INTEREST               VALUE ' '.
   666           88  CP-0-MTH-INTEREST               VALUE 'A'.
   667           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
   668           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   669           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   670           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   671           88  CP-FARM-PLAN                    VALUE 'F'.
   672           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   673           88  CP-2-MTH-INTEREST               VALUE 'I'.
   674           88  CP-3-MTH-INTEREST               VALUE 'J'.
   675           88  CP-4-MTH-INTEREST               VALUE 'K'.
   676           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   677           88  CP-MORTGAGE-REC                 VALUE 'M'.
   678           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   679           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   680           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   681           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   682                                                     'W' 'X'.
   683           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   684           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   685           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   686           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   687           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   688           88  CP-SUMMARY-REC                  VALUE 'Z'.
   689           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   690           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   691           88  CP-AD-D-BENEFIT                 VALUE '4'.
   692           88  CP-CSL-METH-1                   VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  15
* EL154.cbl
   693           88  CP-CSL-METH-2                   VALUE '6'.
   694           88  CP-CSL-METH-3                   VALUE '7'.
   695           88  CP-CSL-METH-4                   VALUE '8'.
   696
   697         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   698                                     COMP-3.
   699         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   700         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   701         16  CP-STATE              PIC XX          VALUE SPACE.
   702         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   703         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   704           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   705               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   706         16  CP-R78-OPTION         PIC X.
   707           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   708           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   709
   710         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   711         16  CP-IBNR-RESERVE-SW    PIC X.
   712         16  CP-CLAIM-STATUS       PIC X.
   713         16  CP-RATE-FILE          PIC X.
   714         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   715                                     COMP-3.
   716
   717         16  CP-LIFE-OVERRIDE-CODE PIC X.
   718         16  CP-AH-OVERRIDE-CODE   PIC X.
   719
   720         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   721                                     COMP-3.
   722         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   723                                   PIC S9(5)V99 COMP-3.
   724         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   725                                     COMP-3.
   726         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   727                                     COMP-3.
   728         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   729                                     COMP-3.
   730         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   731                                  PIC S9(7)V99 COMP-3.
   732
   733         16  CP-PAID-FROM-DATE     PIC X(02).
   734         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   735         16  CP-EXT-DAYS-CALC      PIC X.
   736           88  CP-EXT-NO-CHG                   VALUE ' '.
   737           88  CP-EXT-CHG-LF                   VALUE '1'.
   738           88  CP-EXT-CHG-AH                   VALUE '2'.
   739           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   740         16  CP-DOMICILE-STATE     PIC XX.
   741         16  CP-CARRIER            PIC X.
   742         16  CP-REIN-FLAG          PIC X.
   743         16  CP-REM-TRM-CALC-OPTION PIC X.
   744           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   745                      '2' '3' '4' '5'.
   746           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   747           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   748           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   749           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   750           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  16
* EL154.cbl
   751           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   752           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   753           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   754         16  CP-SIG-SWITCH         PIC X.
   755         16  CP-RATING-METHOD      PIC X.
   756           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   757           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   758           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   759           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   760           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   761           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   762           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   763           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   764           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   765         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   766                                     COMP-3.
   767         16  CP-BEN-CATEGORY       PIC X.
   768         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   769         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   770                                   PIC S99V9(5) COMP-3.
   771         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   772         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   773                                   PIC S99V9(5) COMP-3.
   774         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   775         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   776         16  CP-EXPIRE-DT          PIC XX.
   777         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   778         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   779         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   780         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   781         16  CP-DDF-SPEC-CALC      PIC X.
   782             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   783             88  CP-CALC-CLP              VALUE 'C'.
   784         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   785         16  CP-CANCEL-REASON      PIC X.
   786         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   787         16  CP-PMT-MODE           PIC X.
   788         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   789         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   790         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   791         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   792         16  FILLER                PIC X.
   793
   794***************    OUTPUT FROM ELRESV   ************************
   795
   796         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   797
   798         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   799                                     COMP-3.
   800         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   801                                     COMP-3.
   802         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   803                                     COMP-3.
   804         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   805                                     COMP-3.
   806         16  FILLER                PIC X(09).
   807***************    OUTPUT FROM ELRTRM   *************************
   808
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  17
* EL154.cbl
   809         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   810                                     COMP-3.
   811         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   812                                     COMP-3.
   813         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   814                                     COMP-3.
   815         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   816                                     COMP-3.
   817         16  FILLER                PIC X(12).
   818
   819***************    OUTPUT FROM ELRAMT   *************************
   820
   821         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   822                                     COMP-3.
   823         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   824                                     COMP-3.
   825         16  FILLER                PIC X(12).
   826
   827***************    OUTPUT FROM ELRATE   *************************
   828
   829         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
   830                                     COMP-3.
   831         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
   832                                     COMP-3.
   833         16  CP-MORTALITY-CODE     PIC X(4).
   834         16  CP-RATE-EDIT-FLAG     PIC X.
   835             88  CP-RATES-NEED-APR                  VALUE '1'.
   836         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
   837                                     COMP-3.
   838         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
   839         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   840         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   841                                   PIC S9(7)V99 COMP-3.
   842         16  FILLER                PIC X(07).
   843
   844***************    OUTPUT FROM ELRFND   *************************
   845
   846         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
   847                                     COMP-3.
   848         16  CP-REFUND-TYPE-USED   PIC X.
   849           88  CP-R-AS-R78                         VALUE '1'.
   850           88  CP-R-AS-PRORATA                     VALUE '2'.
   851           88  CP-R-AS-CALIF                       VALUE '3'.
   852           88  CP-R-AS-TEXAS                       VALUE '4'.
   853           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
   854           88  CP-R-AS-NET-PAY                     VALUE '5'.
   855           88  CP-R-AS-ANTICIPATION                VALUE '6'.
   856           88  CP-R-AS-MEAN                        VALUE '8'.
   857           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
   858           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   859           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   860           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   861           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   862           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   863         16  FILLER                PIC X(12).
   864
   865***************    OUTPUT FROM ELEARN   *************************
   866
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  18
* EL154.cbl
   867         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
   868                                     COMP-3.
   869         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
   870                                     COMP-3.
   871         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
   872                                     COMP-3.
   873         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
   874                                     COMP-3.
   875         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
   876                                     COMP-3.
   877         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
   878                                     COMP-3.
   879         16  CP-EARNING-TYPE-USED  PIC X.
   880           88  CP-E-AS-SPECIAL                     VALUE 'S'.
   881           88  CP-E-AS-R78                         VALUE '1'.
   882           88  CP-E-AS-PRORATA                     VALUE '2'.
   883           88  CP-E-AS-TEXAS                       VALUE '4'.
   884           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
   885           88  CP-E-AS-NET-PAY                     VALUE '5'.
   886           88  CP-E-AS-ANTICIPATION                VALUE '6'.
   887           88  CP-E-AS-MEAN                        VALUE '8'.
   888           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
   889         16  FILLER                PIC X(12).
   890
   891***************    OUTPUT FROM ELPMNT   *************************
   892
   893         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
   894                                     COMP-3.
   895         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
   896                                     COMP-3.
   897         16  FILLER                PIC X(12).
   898
   899***************   MISC WORK AREAS    *****************************
   900         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
   901                                     COMP-3.
   902         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
   903                                     COMP-3.
   904         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
   905                                     COMP-3.
   906         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
   907                                     COMP-3.
   908         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
   909                                     COMP-3.
   910         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
   911                                     COMP-3.
   912         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
   913             88  OPEN-RATE-FILE                   VALUE 'O'.
   914             88  CLOSE-RATE-FILE                  VALUE 'C'.
   915             88  IO-ERROR                         VALUE 'E'.
   916
   917         16  CP-FIRST-PAY-DATE     PIC XX.
   918
   919         16  CP-JOINT-INDICATOR    PIC X.
   920
   921         16  CP-RESERVE-REMAINING-TERM
   922                                   PIC S9(4)V9    VALUE ZERO
   923                                     COMP-3.
   924
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  19
* EL154.cbl
   925         16  CP-INSURED-BIRTH-DT   PIC XX.
   926
   927         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
   928                                     COMP-3.
   929
   930         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
   931                                     COMP-3.
   932
   933         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
   934                                     COMP-3.
   935
   936         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
   937                                     COMP-3.
   938
   939         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
   940                                     COMP-3.
   941
   942         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
   943                                     COMP-3.
   944
   945         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
   946                                     COMP-3.
   947
   948         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
   949             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
   950
   951         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
   952                                     COMP-3.
   953         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   954                                     COMP-3.
   955         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
   956         16  FILLER                PIC X(15).
   957******************************************************************
   958
   959
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  20
* EL154.cbl
   961*                            COPY ELCDATE.
   962******************************************************************
   963*                                                                *
   964*                                                                *
   965*                            ELCDATE.                            *
   966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   967*                            VMOD=2.003
   968*                                                                *
   969*                                                                *
   970*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   971*                 LENGTH = 200                                   *
   972******************************************************************
   973
   974 01  DATE-CONVERSION-DATA.
   975     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   976     12  DC-OPTION-CODE                PIC X.
   977         88  BIN-TO-GREG                VALUE ' '.
   978         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   979         88  EDIT-GREG-TO-BIN           VALUE '2'.
   980         88  YMD-GREG-TO-BIN            VALUE '3'.
   981         88  MDY-GREG-TO-BIN            VALUE '4'.
   982         88  JULIAN-TO-BIN              VALUE '5'.
   983         88  BIN-PLUS-ELAPSED           VALUE '6'.
   984         88  FIND-CENTURY               VALUE '7'.
   985         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   986         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   987         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   988         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   989         88  JULIAN-TO-BIN-3            VALUE 'C'.
   990         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   991         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   992         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   993         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   994         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   995         88  CHECK-LEAP-YEAR            VALUE 'H'.
   996         88  BIN-3-TO-GREG              VALUE 'I'.
   997         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   998         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   999         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1000         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1001         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1002         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1003         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1004         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1005         88  THREE-CHARACTER-BIN
  1006                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1007         88  GREGORIAN-TO-BIN
  1008                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1009         88  BIN-TO-GREGORIAN
  1010                  VALUES ' ' '1' 'I' '8' 'G'.
  1011         88  JULIAN-TO-BINARY
  1012                  VALUES '5' 'C' 'E' 'F'.
  1013     12  DC-ERROR-CODE                 PIC X.
  1014         88  NO-CONVERSION-ERROR        VALUE ' '.
  1015         88  DATE-CONVERSION-ERROR
  1016                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1017         88  DATE-IS-ZERO               VALUE '1'.
  1018         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  21
* EL154.cbl
  1019         88  DATE-IS-INVALID            VALUE '3'.
  1020         88  DATE1-GREATER-DATE2        VALUE '4'.
  1021         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1022         88  DATE-INVALID-OPTION        VALUE '9'.
  1023         88  INVALID-CENTURY            VALUE 'A'.
  1024         88  ONLY-CENTURY               VALUE 'B'.
  1025         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1026         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1027     12  DC-END-OF-MONTH               PIC X.
  1028         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1029     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1030         88  USE-NORMAL-PROCESS         VALUE ' '.
  1031         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1032         88  ADJUST-UP-100-YRS          VALUE '2'.
  1033     12  FILLER                        PIC X.
  1034     12  DC-CONVERSION-DATES.
  1035         16  DC-BIN-DATE-1             PIC XX.
  1036         16  DC-BIN-DATE-2             PIC XX.
  1037         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1038         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1039                       DC-GREG-DATE-1-EDIT.
  1040             20  DC-EDIT1-MONTH        PIC 99.
  1041             20  SLASH1-1              PIC X.
  1042             20  DC-EDIT1-DAY          PIC 99.
  1043             20  SLASH1-2              PIC X.
  1044             20  DC-EDIT1-YEAR         PIC 99.
  1045         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1046         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1047                     DC-GREG-DATE-2-EDIT.
  1048             20  DC-EDIT2-MONTH        PIC 99.
  1049             20  SLASH2-1              PIC X.
  1050             20  DC-EDIT2-DAY          PIC 99.
  1051             20  SLASH2-2              PIC X.
  1052             20  DC-EDIT2-YEAR         PIC 99.
  1053         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1054         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1055                     DC-GREG-DATE-1-YMD.
  1056             20  DC-YMD-YEAR           PIC 99.
  1057             20  DC-YMD-MONTH          PIC 99.
  1058             20  DC-YMD-DAY            PIC 99.
  1059         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1060         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1061                      DC-GREG-DATE-1-MDY.
  1062             20  DC-MDY-MONTH          PIC 99.
  1063             20  DC-MDY-DAY            PIC 99.
  1064             20  DC-MDY-YEAR           PIC 99.
  1065         16  DC-GREG-DATE-1-ALPHA.
  1066             20  DC-ALPHA-MONTH        PIC X(10).
  1067             20  DC-ALPHA-DAY          PIC 99.
  1068             20  FILLER                PIC XX.
  1069             20  DC-ALPHA-CENTURY.
  1070                 24 DC-ALPHA-CEN-N     PIC 99.
  1071             20  DC-ALPHA-YEAR         PIC 99.
  1072         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1073         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1074         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1075         16  DC-JULIAN-DATE            PIC 9(05).
  1076         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  22
* EL154.cbl
  1077                                       PIC 9(05).
  1078         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1079             20  DC-JULIAN-YEAR        PIC 99.
  1080             20  DC-JULIAN-DAYS        PIC 999.
  1081         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1082         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1083         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1084     12  DATE-CONVERSION-VARIBLES.
  1085         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1086         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1087             20  FILLER                PIC 9(3).
  1088             20  HOLD-CEN-1-CCYY.
  1089                 24  HOLD-CEN-1-CC     PIC 99.
  1090                 24  HOLD-CEN-1-YY     PIC 99.
  1091             20  HOLD-CEN-1-MO         PIC 99.
  1092             20  HOLD-CEN-1-DA         PIC 99.
  1093         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1094             20  HOLD-CEN-1-R-MO       PIC 99.
  1095             20  HOLD-CEN-1-R-DA       PIC 99.
  1096             20  HOLD-CEN-1-R-CCYY.
  1097                 24  HOLD-CEN-1-R-CC   PIC 99.
  1098                 24  HOLD-CEN-1-R-YY   PIC 99.
  1099             20  FILLER                PIC 9(3).
  1100         16  HOLD-CENTURY-1-X.
  1101             20  FILLER                PIC X(3)  VALUE SPACES.
  1102             20  HOLD-CEN-1-X-CCYY.
  1103                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1104                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1105             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1106             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1107         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1108             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1109             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1110             20  HOLD-CEN-1-R-X-CCYY.
  1111                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1112                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1113             20  FILLER                PIC XXX.
  1114         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1115         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1116         16  DC-JULIAN-DATE-1          PIC 9(07).
  1117         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1118             20  DC-JULIAN-1-CCYY.
  1119                 24  DC-JULIAN-1-CC    PIC 99.
  1120                 24  DC-JULIAN-1-YR    PIC 99.
  1121             20  DC-JULIAN-DA-1        PIC 999.
  1122         16  DC-JULIAN-DATE-2          PIC 9(07).
  1123         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1124             20  DC-JULIAN-2-CCYY.
  1125                 24  DC-JULIAN-2-CC    PIC 99.
  1126                 24  DC-JULIAN-2-YR    PIC 99.
  1127             20  DC-JULIAN-DA-2        PIC 999.
  1128         16  DC-GREG-DATE-A-EDIT.
  1129             20  DC-EDITA-MONTH        PIC 99.
  1130             20  SLASHA-1              PIC X VALUE '/'.
  1131             20  DC-EDITA-DAY          PIC 99.
  1132             20  SLASHA-2              PIC X VALUE '/'.
  1133             20  DC-EDITA-CCYY.
  1134                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  23
* EL154.cbl
  1135                 24  DC-EDITA-YEAR     PIC 99.
  1136         16  DC-GREG-DATE-B-EDIT.
  1137             20  DC-EDITB-MONTH        PIC 99.
  1138             20  SLASHB-1              PIC X VALUE '/'.
  1139             20  DC-EDITB-DAY          PIC 99.
  1140             20  SLASHB-2              PIC X VALUE '/'.
  1141             20  DC-EDITB-CCYY.
  1142                 24  DC-EDITB-CENT     PIC 99.
  1143                 24  DC-EDITB-YEAR     PIC 99.
  1144         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1145         16  DC-GREG-DATE-CYMD-R REDEFINES
  1146                              DC-GREG-DATE-CYMD.
  1147             20  DC-CYMD-CEN           PIC 99.
  1148             20  DC-CYMD-YEAR          PIC 99.
  1149             20  DC-CYMD-MONTH         PIC 99.
  1150             20  DC-CYMD-DAY           PIC 99.
  1151         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1152         16  DC-GREG-DATE-MDCY-R REDEFINES
  1153                              DC-GREG-DATE-MDCY.
  1154             20  DC-MDCY-MONTH         PIC 99.
  1155             20  DC-MDCY-DAY           PIC 99.
  1156             20  DC-MDCY-CEN           PIC 99.
  1157             20  DC-MDCY-YEAR          PIC 99.
  1158    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1159        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1160    12  DC-EL310-DATE                  PIC X(21).
  1161    12  FILLER                         PIC X(28).
  1162
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  24
* EL154.cbl
  1164*                            COPY ELCLOGOF.
  1165******************************************************************
  1166*                                                                *
  1167*                                                                *
  1168*                            ELCLOGOF.                           *
  1169*                            VMOD=2.001                          *
  1170*                                                                *
  1171*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1172*                                                                *
  1173******************************************************************
  1174 01  CLASIC-LOGOFF.
  1175     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1176     12  LOGOFF-TEXT.
  1177         16  FILLER          PIC X(5)    VALUE SPACES.
  1178         16  LOGOFF-MSG.
  1179             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1180             20  FILLER      PIC X       VALUE SPACES.
  1181             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1182         16  FILLER          PIC X(80)
  1183           VALUE '* YOU ARE NOW LOGGED OFF'.
  1184         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1185         16  FILLER          PIC X       VALUE QUOTE.
  1186         16  LOGOFF-SYS-MSG  PIC X(17)
  1187           VALUE 'S CLAS-IC SYSTEM '.
  1188     12  TEXT-MESSAGES.
  1189         16  UNACCESS-MSG    PIC X(29)
  1190             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1191         16  PGMIDERR-MSG    PIC X(17)
  1192             VALUE 'PROGRAM NOT FOUND'.
  1193
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  25
* EL154.cbl
  1195*                            COPY ELCATTR.
  1196******************************************************************
  1197*                                                                *
  1198*                            ELCATTR.                            *
  1199*                            VMOD=2.001                          *
  1200*                                                                *
  1201*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1202*                                                                *
  1203*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1204*                                                                *
  1205*                   POS 1   P=PROTECTED                          *
  1206*                           U=UNPROTECTED                        *
  1207*                           S=ASKIP                              *
  1208*                   POS 2   A=ALPHA/NUMERIC                      *
  1209*                           N=NUMERIC                            *
  1210*                   POS 3   N=NORMAL                             *
  1211*                           B=BRIGHT                             *
  1212*                           D=DARK                               *
  1213*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1214*                           OF=MODIFIED DATA TAG OFF             *
  1215*                                                                *
  1216*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1217******************************************************************
  1218 01  ATTRIBUTE-LIST.
  1219     12  AL-PABOF            PIC X       VALUE 'Y'.
  1220     12  AL-PABON            PIC X       VALUE 'Z'.
  1221     12  AL-PADOF            PIC X       VALUE '%'.
  1222     12  AL-PADON            PIC X       VALUE '_'.
  1223     12  AL-PANOF            PIC X       VALUE '-'.
  1224     12  AL-PANON            PIC X       VALUE '/'.
  1225     12  AL-SABOF            PIC X       VALUE '8'.
  1226     12  AL-SABON            PIC X       VALUE '9'.
  1227     12  AL-SADOF            PIC X       VALUE '@'.
  1228     12  AL-SADON            PIC X       VALUE QUOTE.
  1229     12  AL-SANOF            PIC X       VALUE '0'.
  1230     12  AL-SANON            PIC X       VALUE '1'.
  1231     12  AL-UABOF            PIC X       VALUE 'H'.
  1232     12  AL-UABON            PIC X       VALUE 'I'.
  1233     12  AL-UADOF            PIC X       VALUE '<'.
  1234     12  AL-UADON            PIC X       VALUE '('.
  1235     12  AL-UANOF            PIC X       VALUE ' '.
  1236     12  AL-UANON            PIC X       VALUE 'A'.
  1237     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1238     12  AL-UNBON            PIC X       VALUE 'R'.
  1239     12  AL-UNDOF            PIC X       VALUE '*'.
  1240     12  AL-UNDON            PIC X       VALUE ')'.
  1241     12  AL-UNNOF            PIC X       VALUE '&'.
  1242     12  AL-UNNON            PIC X       VALUE 'J'.
  1243
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  26
* EL154.cbl
  1245*                            COPY ELCEMIB.
  1246******************************************************************
  1247*                                                                *
  1248*                                                                *
  1249*                            ELCEMIB.                            *
  1250*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1251*                            VMOD=2.005                          *
  1252*                                                                *
  1253*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1254*                                                                *
  1255******************************************************************
  1256 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1257     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1258     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1259     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1260     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1261     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1262     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1263     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1264     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1265     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1266         88  EMI-NO-ERRORS                    VALUE '1'.
  1267         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1268         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1269     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1270         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1271     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1272         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1273         88  EMI-AREA1-FULL                   VALUE '2'.
  1274     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1275         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1276         88  EMI-AREA2-FULL                   VALUE '2'.
  1277     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1278         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1279         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1280         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1281         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1282         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1283     12  EMI-ERROR-LINES.
  1284         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1285         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1286         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1287         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1288             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1289                 24  EMI-ERR-NUM         PIC X(4).
  1290                 24  EMI-FILLER          PIC X.
  1291                 24  EMI-SEV             PIC X.
  1292                 24  FILLER              PIC X.
  1293             20  FILLER                  PIC X(02).
  1294     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1295         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1296             20  EMI-ERROR-NUMBER    PIC X(4).
  1297             20  EMI-FILL            PIC X.
  1298             20  EMI-SEVERITY        PIC X.
  1299             20  FILLER              PIC X.
  1300             20  EMI-ERROR-TEXT.
  1301                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1302                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  27
* EL154.cbl
  1303     12  EMI-SEVERITY-SAVE           PIC X.
  1304         88  EMI-NOTE                    VALUE 'N'.
  1305         88  EMI-WARNING                 VALUE 'W'.
  1306         88  EMI-FORCABLE                VALUE 'F'.
  1307         88  EMI-FATAL                   VALUE 'X'.
  1308     12  EMI-MESSAGE-FLAG            PIC X.
  1309         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1310         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1311     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1312     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1313         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1314         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1315         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1316     12  emi-claim-no                pic x(7).
  1317     12  emi-claim-type              pic x(6).
  1318     12  FILLER                      PIC X(124)  VALUE SPACES.
  1319     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1320     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1321     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1322     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  28
* EL154.cbl
  1324*                            COPY ELCLNKLT.
  1325******************************************************************
  1326*                                                                *
  1327*                                                                *
  1328*                           ELCLNKLT                             *
  1329*                            VMOD=2.003                          *
  1330*                                                                *
  1331*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1332*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1333*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1334*                                                                *
  1335*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1336*   COMPLETING THE REQUIRED FIELDS.                              *
  1337*                                                                *
  1338*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1339*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1340*                              9999 INDICATES AN UNKNOWN ABEND   *
  1341*                                   WAS DETECTED.                *
  1342*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1343*                              CODES FOUND IN THE ERROR FILE.    *
  1344******************************************************************
  1345 01  W-1523-LINKDATA.
  1346     12  W-1523-COMMON-PI-DATA.
  1347         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1348         16  FILLER              PIC  X(67).
  1349         16  W-1523-COMPANY-CD   PIC  X(01).
  1350         16  FILLER              PIC  X(10).
  1351         16  W-1523-CONTROL-IN-PROGRESS.
  1352             20  W-1523-CARRIER  PIC  X(01).
  1353             20  W-1523-GROUPING PIC  X(06).
  1354             20  W-1523-STATE    PIC  X(02).
  1355             20  W-1523-ACCOUNT  PIC  X(10).
  1356             20  W-1523-CLAIM-CERT-GRP.
  1357                 24  W-1523-CLAIM-NO
  1358                                 PIC  X(07).
  1359                 24  W-1523-CERT-NO.
  1360                     28  W-1523-CERT-PRIME
  1361                                 PIC  X(10).
  1362                     28  W-1523-CERT-SFX
  1363                                 PIC  X(01).
  1364                 24  W-1523-CERT-EFF-DT
  1365                                 PIC  X(02).
  1366         16  FILLER              PIC X(265).
  1367
  1368     12  W-1523-WORK-AREA.
  1369         16  W-1523-FORM-NUMBER  PIC  X(04).
  1370         16  W-1523-NUMBER-COPIES
  1371                                 PIC  9(01).
  1372         16  W-1523-ADDR-TYPE    PIC  X(02).
  1373         16  W-1523-FOLLOW-UP-DATE
  1374                                 PIC  X(02).
  1375         16  W-1523-RESEND-DATE  PIC  X(02).
  1376         16  W-1523-ERROR-CODE   PIC  9(04).
  1377             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1378             88  W-1523-FATAL-ERROR
  1379                                    VALUES  0006 0013 0042
  1380                                            0154 0168 0169
  1381                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  29
* EL154.cbl
  1382                                            0179 0186 0281
  1383                                            0332 2055 3697
  1384                                            3698 3699 3770
  1385                                            3771 3772 7675
  1386                                            9106 9808 9883
  1387                                            9887.
  1388             88  W-1523-STOP-ERRORS
  1389                                    VALUES  0013 0042 0154
  1390                                            0168 0169 0172
  1391                                            0281 0332 2055
  1392                                            3698 3699 7675
  1393                                            9106 9808 9883
  1394                                            9999.
  1395         16  W-1523-REASON       PIC  X(70).
  1396         16  W-1523-ARCHIVE-NUMBER
  1397                                 PIC  9(08).
  1398     12  W-1523-POINTER-AREA.
  1399         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1400         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1401         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1402         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1403         16  W-1523-PROD-POINTER PIC S9(08) COMP.
  1404
  1405     12  W-1523-LETTER-DATE       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  30
* EL154.cbl
  1407*                            COPY ELCINTF.
  1408******************************************************************
  1409*                                                                *
  1410*                                                                *
  1411*                            ELCINTF.                            *
  1412*                            VMOD=2.017                          *
  1413*                                                                *
  1414*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1415*                                                                *
  1416*       LENGTH = 1024                                            *
  1417*                                                                *
  1418******************************************************************
  1419*                   C H A N G E   L O G
  1420*
  1421* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1422*-----------------------------------------------------------------
  1423*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1424* EFFECTIVE    NUMBER
  1425*-----------------------------------------------------------------
  1426* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1427******************************************************************
  1428 01  PROGRAM-INTERFACE-BLOCK.
  1429     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1430     12  PI-CALLING-PROGRAM              PIC X(8).
  1431     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1432     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1433     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1434     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1435     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1436     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1437     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1438     12  PI-COMPANY-ID                   PIC XXX.
  1439     12  PI-COMPANY-CD                   PIC X.
  1440
  1441     12  PI-COMPANY-PASSWORD             PIC X(8).
  1442
  1443     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1444
  1445     12  PI-CONTROL-IN-PROGRESS.
  1446         16  PI-CARRIER                  PIC X.
  1447         16  PI-GROUPING                 PIC X(6).
  1448         16  PI-STATE                    PIC XX.
  1449         16  PI-ACCOUNT                  PIC X(10).
  1450         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1451                                         PIC X(10).
  1452         16  PI-CLAIM-CERT-GRP.
  1453             20  PI-CLAIM-NO             PIC X(7).
  1454             20  PI-CERT-NO.
  1455                 25  PI-CERT-PRIME       PIC X(10).
  1456                 25  PI-CERT-SFX         PIC X.
  1457             20  PI-CERT-EFF-DT          PIC XX.
  1458         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1459             20  PI-PLAN-CODE            PIC X(2).
  1460             20  PI-REVISION-NUMBER      PIC X(3).
  1461             20  PI-PLAN-EFF-DT          PIC X(2).
  1462             20  PI-PLAN-EXP-DT          PIC X(2).
  1463             20  FILLER                  PIC X(11).
  1464         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  31
* EL154.cbl
  1465             20  PI-OE-REFERENCE-1.
  1466                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1467                 25  PI-OE-REF-1-SUFF    PIC XX.
  1468
  1469     12  PI-SESSION-IN-PROGRESS          PIC X.
  1470         88  CLAIM-SESSION                   VALUE '1'.
  1471         88  CREDIT-SESSION                  VALUE '2'.
  1472         88  WARRANTY-SESSION                VALUE '3'.
  1473         88  MORTGAGE-SESSION                VALUE '4'.
  1474         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1475
  1476
  1477*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1478
  1479     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1480     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1481
  1482     12  PI-CREDIT-USER                  PIC X.
  1483         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1484         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1485
  1486     12  PI-CLAIM-USER                   PIC X.
  1487         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1488         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1489
  1490     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1491         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1492         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1493         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1494         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1495         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1496
  1497     12  PI-PROCESSOR-ID                 PIC X(4).
  1498
  1499     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1500
  1501     12  PI-MEMBER-CAPTION               PIC X(10).
  1502
  1503     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1504         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1505
  1506     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1507     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1508     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1509     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1510
  1511     12  PI-AH-OVERRIDE-L1               PIC X.
  1512     12  PI-AH-OVERRIDE-L2               PIC XX.
  1513     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1514     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1515
  1516     12  PI-NEW-SYSTEM                   PIC X(2).
  1517
  1518     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1519     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1520         88  PI-USES-PAID-TO                 VALUE '1'.
  1521     12  PI-CRDTCRD-SYSTEM.
  1522         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  32
* EL154.cbl
  1523             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1524             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1525         16  PI-CC-MONTH-END-DT          PIC XX.
  1526     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1527
  1528     12  PI-OE-REFERENCE-2.
  1529         16  PI-OE-REF-2-PRIME           PIC X(10).
  1530         16  PI-OE-REF-2-SUFF            PIC X.
  1531
  1532     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1533
  1534     12  PI-LANGUAGE-TYPE                PIC X.
  1535             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1536             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1537             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1538
  1539     12  PI-POLICY-LINKAGE-IND           PIC X.
  1540         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1541         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1542                                                   LOW-VALUES.
  1543
  1544     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1545     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1546         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1547         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1548
  1549     12  PI-PROCESSOR-CSR-IND            PIC X.
  1550         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1551         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1552
  1553     12  FILLER                          PIC X(3).
  1554
  1555     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1556
  1557     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1558         PI-SYSTEM-LEVEL.
  1559
  1560         16  PI-ENTRY-CODES.
  1561             20  PI-ENTRY-CD-1           PIC X.
  1562             20  PI-ENTRY-CD-2           PIC X.
  1563
  1564         16  PI-RETURN-CODES.
  1565             20  PI-RETURN-CD-1          PIC X.
  1566             20  PI-RETURN-CD-2          PIC X.
  1567
  1568         16  PI-UPDATE-STATUS-SAVE.
  1569             20  PI-UPDATE-BY            PIC X(4).
  1570             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1571
  1572         16  PI-LOWER-CASE-LETTERS       PIC X.
  1573             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1574
  1575*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1576*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1577*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1578
  1579         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1580             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  33
* EL154.cbl
  1581             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1582             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1583             88  ACCNT-CNTL                  VALUE '3'.
  1584             88  CARR-ACCNT-CNTL             VALUE '4'.
  1585
  1586         16  PI-PROCESSOR-CAP-LIST.
  1587             20  PI-SYSTEM-CONTROLS.
  1588                24 PI-SYSTEM-DISPLAY     PIC X.
  1589                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1590                24 PI-SYSTEM-MODIFY      PIC X.
  1591                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1592             20  FILLER                  PIC XX.
  1593             20  PI-DISPLAY-CAP          PIC X.
  1594                 88  DISPLAY-CAP             VALUE 'Y'.
  1595             20  PI-MODIFY-CAP           PIC X.
  1596                 88  MODIFY-CAP              VALUE 'Y'.
  1597             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1598                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1599             20  PI-FORCE-CAP            PIC X.
  1600                 88  FORCE-CAP               VALUE 'Y'.
  1601
  1602         16  PI-PROGRAM-CONTROLS.
  1603             20  PI-PGM-PRINT-OPT        PIC X.
  1604             20  PI-PGM-FORMAT-OPT       PIC X.
  1605             20  PI-PGM-PROCESS-OPT      PIC X.
  1606             20  PI-PGM-TOTALS-OPT       PIC X.
  1607
  1608         16  PI-HELP-INTERFACE.
  1609             20  PI-LAST-ERROR-NO        PIC X(4).
  1610             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1611
  1612         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1613             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1614
  1615         16  PI-CR-CONTROL-IN-PROGRESS.
  1616             20  PI-CR-CARRIER           PIC X.
  1617             20  PI-CR-GROUPING          PIC X(6).
  1618             20  PI-CR-STATE             PIC XX.
  1619             20  PI-CR-ACCOUNT           PIC X(10).
  1620             20  PI-CR-FIN-RESP          PIC X(10).
  1621             20  PI-CR-TYPE              PIC X.
  1622
  1623         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1624
  1625         16  PI-CR-MONTH-END-DT          PIC XX.
  1626
  1627         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1628             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1629             88  PI-ZERO-CARRIER             VALUE '1'.
  1630             88  PI-ZERO-GROUPING            VALUE '2'.
  1631             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1632
  1633         16  PI-CARRIER-SECURITY         PIC X.
  1634             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1635
  1636         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1637             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1638             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  34
* EL154.cbl
  1639
  1640         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1641             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1642                                         INDEXED BY PI-ACCESS-NDX
  1643                                         PIC X.
  1644
  1645         16  PI-GA-BILLING-CONTROL       PIC X.
  1646             88  PI-GA-BILLING               VALUE '1'.
  1647
  1648         16  PI-MAIL-PROCESSING          PIC X.
  1649             88  PI-MAIL-YES                 VALUE 'Y'.
  1650
  1651         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1652
  1653         16  PI-AR-SYSTEM.
  1654             20  PI-AR-PROCESSING-CNTL   PIC X.
  1655                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1656             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1657             20  PI-AR-MONTH-END-DT      PIC XX.
  1658
  1659         16  PI-MP-SYSTEM.
  1660             20  PI-MORTGAGE-USER            PIC X.
  1661                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1662                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1663             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1664                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1665                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1666                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1667                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1668                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1669             20  PI-MP-MONTH-END-DT          PIC XX.
  1670             20  PI-MP-REFERENCE-NO.
  1671                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1672                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1673
  1674         16  PI-LABEL-CONTROL            PIC X(01).
  1675             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1676             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1677
  1678         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1679             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1680
  1681         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1682             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1683             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1684
  1685         16  FILLER                      PIC X(14).
  1686
  1687     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1688******************************************************************
  1689     12  PI-REDEF       REDEFINES PI-PROGRAM-WORK-AREA.
  1690         16  PI-BENEFIT-SAVE.
  1691             18  PI-BEN-DAYS      PIC 99.
  1692             18  PI-BEN-TYPE      PIC X.
  1693*00269   16  FILLER               PIC X(637).
  1694         16  PI-AUTO-END-LETTER   PIC X(04).
  1695         16  FILLER               PIC X(633).
  1696
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  35
* EL154.cbl
  1698*                            COPY ELCAID.
  1699******************************************************************
  1700*                                                                *
  1701*                            ELCAID.                             *
  1702*                            VMOD=2.001                          *
  1703*                                                                *
  1704*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1705*                                                                *
  1706*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1707*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1708******************************************************************
  1709
  1710 01  DFHAID.
  1711   02  DFHNULL   PIC  X  VALUE  ' '.
  1712   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1713   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1714   02  DFHPEN    PIC  X  VALUE  '='.
  1715   02  DFHOPID   PIC  X  VALUE  'W'.
  1716   02  DFHPA1    PIC  X  VALUE  '%'.
  1717   02  DFHPA2    PIC  X  VALUE  '>'.
  1718   02  DFHPA3    PIC  X  VALUE  ','.
  1719   02  DFHPF1    PIC  X  VALUE  '1'.
  1720   02  DFHPF2    PIC  X  VALUE  '2'.
  1721   02  DFHPF3    PIC  X  VALUE  '3'.
  1722   02  DFHPF4    PIC  X  VALUE  '4'.
  1723   02  DFHPF5    PIC  X  VALUE  '5'.
  1724   02  DFHPF6    PIC  X  VALUE  '6'.
  1725   02  DFHPF7    PIC  X  VALUE  '7'.
  1726   02  DFHPF8    PIC  X  VALUE  '8'.
  1727   02  DFHPF9    PIC  X  VALUE  '9'.
  1728   02  DFHPF10   PIC  X  VALUE  ':'.
  1729   02  DFHPF11   PIC  X  VALUE  '#'.
  1730   02  DFHPF12   PIC  X  VALUE  '@'.
  1731   02  DFHPF13   PIC  X  VALUE  'A'.
  1732   02  DFHPF14   PIC  X  VALUE  'B'.
  1733   02  DFHPF15   PIC  X  VALUE  'C'.
  1734   02  DFHPF16   PIC  X  VALUE  'D'.
  1735   02  DFHPF17   PIC  X  VALUE  'E'.
  1736   02  DFHPF18   PIC  X  VALUE  'F'.
  1737   02  DFHPF19   PIC  X  VALUE  'G'.
  1738   02  DFHPF20   PIC  X  VALUE  'H'.
  1739   02  DFHPF21   PIC  X  VALUE  'I'.
  1740*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1741   02  DFHPF22   PIC  X  VALUE  '['.
  1742   02  DFHPF23   PIC  X  VALUE  '.'.
  1743   02  DFHPF24   PIC  X  VALUE  '<'.
  1744   02  DFHMSRE   PIC  X  VALUE  'X'.
  1745   02  DFHSTRF   PIC  X  VALUE  'h'.
  1746   02  DFHTRIG   PIC  X  VALUE  '"'.
  1747 01  FILLER    REDEFINES DFHAID.
  1748     12  FILLER              PIC X(8).
  1749     12  PF-VALUES           PIC X       OCCURS 2.
  1750
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  36
* EL154.cbl
  1752*                            COPY EL154S.
  1753 01  EL154AI.
  1754     05  FILLER            PIC  X(0012).
  1755*    -------------------------------
  1756     05  RUNDTEL PIC S9(0004) COMP.
  1757     05  RUNDTEF PIC  X(0001).
  1758     05  FILLER REDEFINES RUNDTEF.
  1759         10  RUNDTEA PIC  X(0001).
  1760     05  RUNDTEI PIC  X(0008).
  1761*    -------------------------------
  1762     05  RUNTIMEL PIC S9(0004) COMP.
  1763     05  RUNTIMEF PIC  X(0001).
  1764     05  FILLER REDEFINES RUNTIMEF.
  1765         10  RUNTIMEA PIC  X(0001).
  1766     05  RUNTIMEI PIC  X(0005).
  1767*    -------------------------------
  1768     05  CLAIML PIC S9(0004) COMP.
  1769     05  CLAIMF PIC  X(0001).
  1770     05  FILLER REDEFINES CLAIMF.
  1771         10  CLAIMA PIC  X(0001).
  1772     05  CLAIMI PIC  X(0007).
  1773*    -------------------------------
  1774     05  CARRL PIC S9(0004) COMP.
  1775     05  CARRF PIC  X(0001).
  1776     05  FILLER REDEFINES CARRF.
  1777         10  CARRA PIC  X(0001).
  1778     05  CARRI PIC  X(0001).
  1779*    -------------------------------
  1780     05  CERTL PIC S9(0004) COMP.
  1781     05  CERTF PIC  X(0001).
  1782     05  FILLER REDEFINES CERTF.
  1783         10  CERTA PIC  X(0001).
  1784     05  CERTI PIC  X(0010).
  1785*    -------------------------------
  1786     05  SUFFIXL PIC S9(0004) COMP.
  1787     05  SUFFIXF PIC  X(0001).
  1788     05  FILLER REDEFINES SUFFIXF.
  1789         10  SUFFIXA PIC  X(0001).
  1790     05  SUFFIXI PIC  X(0001).
  1791*    -------------------------------
  1792     05  CESTDTEL PIC S9(0004) COMP.
  1793     05  CESTDTEF PIC  X(0001).
  1794     05  FILLER REDEFINES CESTDTEF.
  1795         10  CESTDTEA PIC  X(0001).
  1796     05  CESTDTEI PIC  X(0008).
  1797*    -------------------------------
  1798     05  CESTBYL PIC S9(0004) COMP.
  1799     05  CESTBYF PIC  X(0001).
  1800     05  FILLER REDEFINES CESTBYF.
  1801         10  CESTBYA PIC  X(0001).
  1802     05  CESTBYI PIC  X(0004).
  1803*    -------------------------------
  1804     05  FSTHD1L PIC S9(0004) COMP.
  1805     05  FSTHD1F PIC  X(0001).
  1806     05  FILLER REDEFINES FSTHD1F.
  1807         10  FSTHD1A PIC  X(0001).
  1808     05  FSTHD1I PIC  X(0023).
  1809*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  37
* EL154.cbl
  1810     05  CFSTPMTL PIC S9(0004) COMP.
  1811     05  CFSTPMTF PIC  X(0001).
  1812     05  FILLER REDEFINES CFSTPMTF.
  1813         10  CFSTPMTA PIC  X(0001).
  1814     05  CFSTPMTI PIC  X(0008).
  1815*    -------------------------------
  1816     05  CMONTHSL PIC S9(0004) COMP.
  1817     05  CMONTHSF PIC  X(0001).
  1818     05  FILLER REDEFINES CMONTHSF.
  1819         10  CMONTHSA PIC  X(0001).
  1820     05  CMONTHSI PIC  X(0002).
  1821*    -------------------------------
  1822     05  CFSTAMTL PIC S9(0004) COMP.
  1823     05  CFSTAMTF PIC  X(0001).
  1824     05  FILLER REDEFINES CFSTAMTF.
  1825         10  CFSTAMTA PIC  X(0001).
  1826     05  CFSTAMTI PIC  X(0009).
  1827*    -------------------------------
  1828     05  LSTHD1L PIC S9(0004) COMP.
  1829     05  LSTHD1F PIC  X(0001).
  1830     05  FILLER REDEFINES LSTHD1F.
  1831         10  LSTHD1A PIC  X(0001).
  1832     05  LSTHD1I PIC  X(0024).
  1833*    -------------------------------
  1834     05  CLSTPMTL PIC S9(0004) COMP.
  1835     05  CLSTPMTF PIC  X(0001).
  1836     05  FILLER REDEFINES CLSTPMTF.
  1837         10  CLSTPMTA PIC  X(0001).
  1838     05  CLSTPMTI PIC  X(0008).
  1839*    -------------------------------
  1840     05  CLASTL PIC S9(0004) COMP.
  1841     05  CLASTF PIC  X(0001).
  1842     05  FILLER REDEFINES CLASTF.
  1843         10  CLASTA PIC  X(0001).
  1844     05  CLASTI PIC  X(0001).
  1845*    -------------------------------
  1846     05  CREGPMTL PIC S9(0004) COMP.
  1847     05  CREGPMTF PIC  X(0001).
  1848     05  FILLER REDEFINES CREGPMTF.
  1849         10  CREGPMTA PIC  X(0001).
  1850     05  CREGPMTI PIC  X(0009).
  1851*    -------------------------------
  1852     05  CDAYSFL PIC S9(0004) COMP.
  1853     05  CDAYSFF PIC  X(0001).
  1854     05  FILLER REDEFINES CDAYSFF.
  1855         10  CDAYSFA PIC  X(0001).
  1856     05  CDAYSFI PIC  X(0003).
  1857*    -------------------------------
  1858     05  CPAYEEL PIC S9(0004) COMP.
  1859     05  CPAYEEF PIC  X(0001).
  1860     05  FILLER REDEFINES CPAYEEF.
  1861         10  CPAYEEA PIC  X(0001).
  1862     05  CPAYEEI PIC  X(0008).
  1863*    -------------------------------
  1864     05  DAY2PAYL PIC S9(0004) COMP.
  1865     05  DAY2PAYF PIC  X(0001).
  1866     05  FILLER REDEFINES DAY2PAYF.
  1867         10  DAY2PAYA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  38
* EL154.cbl
  1868     05  DAY2PAYI PIC  99.
  1869*    -------------------------------
  1870     05  CEFFDTEL PIC S9(0004) COMP.
  1871     05  CEFFDTEF PIC  X(0001).
  1872     05  FILLER REDEFINES CEFFDTEF.
  1873         10  CEFFDTEA PIC  X(0001).
  1874     05  CEFFDTEI PIC  X(0008).
  1875*    -------------------------------
  1876     05  TERML PIC S9(0004) COMP.
  1877     05  TERMF PIC  X(0001).
  1878     05  FILLER REDEFINES TERMF.
  1879         10  TERMA PIC  X(0001).
  1880     05  TERMI PIC  X(0001).
  1881*    -------------------------------
  1882     05  CINDCTRL PIC S9(0004) COMP.
  1883     05  CINDCTRF PIC  X(0001).
  1884     05  FILLER REDEFINES CINDCTRF.
  1885         10  CINDCTRA PIC  X(0001).
  1886     05  CINDCTRI PIC  X(0001).
  1887*    -------------------------------
  1888     05  PRINTL PIC S9(0004) COMP.
  1889     05  PRINTF PIC  X(0001).
  1890     05  FILLER REDEFINES PRINTF.
  1891         10  PRINTA PIC  X(0001).
  1892     05  PRINTI PIC  X(0004).
  1893*    -------------------------------
  1894     05  FSTHD2L PIC S9(0004) COMP.
  1895     05  FSTHD2F PIC  X(0001).
  1896     05  FILLER REDEFINES FSTHD2F.
  1897         10  FSTHD2A PIC  X(0001).
  1898     05  FSTHD2I PIC  X(0023).
  1899*    -------------------------------
  1900     05  NFSTPMTL PIC S9(0004) COMP.
  1901     05  NFSTPMTF PIC  X(0001).
  1902     05  FILLER REDEFINES NFSTPMTF.
  1903         10  NFSTPMTA PIC  X(0001).
  1904     05  NFSTPMTI PIC  X(0008).
  1905*    -------------------------------
  1906     05  NFSTAMTL PIC S9(0004) COMP.
  1907     05  NFSTAMTF PIC  X(0001).
  1908     05  FILLER REDEFINES NFSTAMTF.
  1909         10  NFSTAMTA PIC  X(0001).
  1910     05  NFSTAMTI PIC  S9(8)V99.
  1911*    -------------------------------
  1912     05  LSTHD2L PIC S9(0004) COMP.
  1913     05  LSTHD2F PIC  X(0001).
  1914     05  FILLER REDEFINES LSTHD2F.
  1915         10  LSTHD2A PIC  X(0001).
  1916     05  LSTHD2I PIC  X(0023).
  1917*    -------------------------------
  1918     05  NLSTPMTL PIC S9(0004) COMP.
  1919     05  NLSTPMTF PIC  X(0001).
  1920     05  FILLER REDEFINES NLSTPMTF.
  1921         10  NLSTPMTA PIC  X(0001).
  1922     05  NLSTPMTI PIC  X(0008).
  1923*    -------------------------------
  1924     05  NEFFDTEL PIC S9(0004) COMP.
  1925     05  NEFFDTEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  39
* EL154.cbl
  1926     05  FILLER REDEFINES NEFFDTEF.
  1927         10  NEFFDTEA PIC  X(0001).
  1928     05  NEFFDTEI PIC  X(0008).
  1929*    -------------------------------
  1930     05  NMONTHSL PIC S9(0004) COMP.
  1931     05  NMONTHSF PIC  X(0001).
  1932     05  FILLER REDEFINES NMONTHSF.
  1933         10  NMONTHSA PIC  X(0001).
  1934     05  NMONTHSI PIC  99.
  1935*    -------------------------------
  1936     05  NDAYSFL PIC S9(0004) COMP.
  1937     05  NDAYSFF PIC  X(0001).
  1938     05  FILLER REDEFINES NDAYSFF.
  1939         10  NDAYSFA PIC  X(0001).
  1940     05  NDAYSFI PIC  999.
  1941*    -------------------------------
  1942     05  NPAYEEL PIC S9(0004) COMP.
  1943     05  NPAYEEF PIC  X(0001).
  1944     05  FILLER REDEFINES NPAYEEF.
  1945         10  NPAYEEA PIC  X(0001).
  1946     05  NPAYEEI PIC  X(0002).
  1947*    -------------------------------
  1948     05  NREGAMTL PIC S9(0004) COMP.
  1949     05  NREGAMTF PIC  X(0001).
  1950     05  FILLER REDEFINES NREGAMTF.
  1951         10  NREGAMTA PIC  X(0001).
  1952     05  NREGAMTI PIC  X(0010).
  1953*    -------------------------------
  1954     05  NLASTL PIC S9(0004) COMP.
  1955     05  NLASTF PIC  X(0001).
  1956     05  FILLER REDEFINES NLASTF.
  1957         10  NLASTA PIC  X(0001).
  1958     05  NLASTI PIC  X(0001).
  1959*    -------------------------------
  1960     05  NINDCTRL PIC S9(0004) COMP.
  1961     05  NINDCTRF PIC  X(0001).
  1962     05  FILLER REDEFINES NINDCTRF.
  1963         10  NINDCTRA PIC  X(0001).
  1964     05  NINDCTRI PIC  X(0001).
  1965*    -------------------------------
  1966     05  DAYPAYL PIC S9(0004) COMP.
  1967     05  DAYPAYF PIC  X(0001).
  1968     05  FILLER REDEFINES DAYPAYF.
  1969         10  DAYPAYA PIC  X(0001).
  1970     05  DAYPAYI PIC  99.
  1971*    -------------------------------
  1972     05  NPRINTL PIC S9(0004) COMP.
  1973     05  NPRINTF PIC  X(0001).
  1974     05  FILLER REDEFINES NPRINTF.
  1975         10  NPRINTA PIC  X(0001).
  1976     05  NPRINTI PIC  X(0004).
  1977*    -------------------------------
  1978     05  LETTDTEL PIC S9(0004) COMP.
  1979     05  LETTDTEF PIC  X(0001).
  1980     05  FILLER REDEFINES LETTDTEF.
  1981         10  LETTDTEA PIC  X(0001).
  1982     05  LETTDTEI PIC  X(0008).
  1983*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  40
* EL154.cbl
  1984     05  ENDLETTL PIC S9(0004) COMP.
  1985     05  ENDLETTF PIC  X(0001).
  1986     05  FILLER REDEFINES ENDLETTF.
  1987         10  ENDLETTA PIC  X(0001).
  1988     05  ENDLETTI PIC  X(0004).
  1989*    -------------------------------
  1990     05  ERRMSG1L PIC S9(0004) COMP.
  1991     05  ERRMSG1F PIC  X(0001).
  1992     05  FILLER REDEFINES ERRMSG1F.
  1993         10  ERRMSG1A PIC  X(0001).
  1994     05  ERRMSG1I PIC  X(0079).
  1995*    -------------------------------
  1996     05  ERRMSG2L PIC S9(0004) COMP.
  1997     05  ERRMSG2F PIC  X(0001).
  1998     05  FILLER REDEFINES ERRMSG2F.
  1999         10  ERRMSG2A PIC  X(0001).
  2000     05  ERRMSG2I PIC  X(0079).
  2001*    -------------------------------
  2002     05  ENTERPFL PIC S9(0004) COMP.
  2003     05  ENTERPFF PIC  X(0001).
  2004     05  FILLER REDEFINES ENTERPFF.
  2005         10  ENTERPFA PIC  X(0001).
  2006     05  ENTERPFI PIC  99.
  2007 01  EL154AO REDEFINES EL154AI.
  2008     05  FILLER            PIC  X(0012).
  2009*    -------------------------------
  2010     05  FILLER            PIC  X(0003).
  2011     05  RUNDTEO PIC  X(0008).
  2012*    -------------------------------
  2013     05  FILLER            PIC  X(0003).
  2014     05  RUNTIMEO PIC  99.99.
  2015*    -------------------------------
  2016     05  FILLER            PIC  X(0003).
  2017     05  CLAIMO PIC  X(0007).
  2018*    -------------------------------
  2019     05  FILLER            PIC  X(0003).
  2020     05  CARRO PIC  X(0001).
  2021*    -------------------------------
  2022     05  FILLER            PIC  X(0003).
  2023     05  CERTO PIC  X(0010).
  2024*    -------------------------------
  2025     05  FILLER            PIC  X(0003).
  2026     05  SUFFIXO PIC  X(0001).
  2027*    -------------------------------
  2028     05  FILLER            PIC  X(0003).
  2029     05  CESTDTEO PIC  X(0008).
  2030*    -------------------------------
  2031     05  FILLER            PIC  X(0003).
  2032     05  CESTBYO PIC  X(0004).
  2033*    -------------------------------
  2034     05  FILLER            PIC  X(0003).
  2035     05  FSTHD1O PIC  X(0023).
  2036*    -------------------------------
  2037     05  FILLER            PIC  X(0003).
  2038     05  CFSTPMTO PIC  X(0008).
  2039*    -------------------------------
  2040     05  FILLER            PIC  X(0003).
  2041     05  CMONTHSO PIC  99.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  41
* EL154.cbl
  2042*    -------------------------------
  2043     05  FILLER            PIC  X(0003).
  2044     05  CFSTAMTO PIC  ZZ,ZZ9.99.
  2045*    -------------------------------
  2046     05  FILLER            PIC  X(0003).
  2047     05  LSTHD1O PIC  X(0024).
  2048*    -------------------------------
  2049     05  FILLER            PIC  X(0003).
  2050     05  CLSTPMTO PIC  X(0008).
  2051*    -------------------------------
  2052     05  FILLER            PIC  X(0003).
  2053     05  CLASTO PIC  X(0001).
  2054*    -------------------------------
  2055     05  FILLER            PIC  X(0003).
  2056     05  CREGPMTO PIC  ZZ,ZZ9.99.
  2057*    -------------------------------
  2058     05  FILLER            PIC  X(0003).
  2059     05  CDAYSFO PIC  ZZ9.
  2060*    -------------------------------
  2061     05  FILLER            PIC  X(0003).
  2062     05  CPAYEEO PIC  X(0008).
  2063*    -------------------------------
  2064     05  FILLER            PIC  X(0003).
  2065     05  DAY2PAYO PIC  X(0002).
  2066*    -------------------------------
  2067     05  FILLER            PIC  X(0003).
  2068     05  CEFFDTEO PIC  X(0008).
  2069*    -------------------------------
  2070     05  FILLER            PIC  X(0003).
  2071     05  TERMO PIC  X(0001).
  2072*    -------------------------------
  2073     05  FILLER            PIC  X(0003).
  2074     05  CINDCTRO PIC  X(0001).
  2075*    -------------------------------
  2076     05  FILLER            PIC  X(0003).
  2077     05  PRINTO PIC  X(0004).
  2078*    -------------------------------
  2079     05  FILLER            PIC  X(0003).
  2080     05  FSTHD2O PIC  X(0023).
  2081*    -------------------------------
  2082     05  FILLER            PIC  X(0003).
  2083     05  NFSTPMTO PIC  99B99B99.
  2084*    -------------------------------
  2085     05  FILLER            PIC  X(0003).
  2086     05  NFSTAMTO PIC  ZZ,ZZZ.99-.
  2087*    -------------------------------
  2088     05  FILLER            PIC  X(0003).
  2089     05  LSTHD2O PIC  X(0023).
  2090*    -------------------------------
  2091     05  FILLER            PIC  X(0003).
  2092     05  NLSTPMTO PIC  99B99B99.
  2093*    -------------------------------
  2094     05  FILLER            PIC  X(0003).
  2095     05  NEFFDTEO PIC  99B99B99.
  2096*    -------------------------------
  2097     05  FILLER            PIC  X(0003).
  2098     05  NMONTHSO PIC  X(0002).
  2099*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  42
* EL154.cbl
  2100     05  FILLER            PIC  X(0003).
  2101     05  NDAYSFO PIC  X(0003).
  2102*    -------------------------------
  2103     05  FILLER            PIC  X(0003).
  2104     05  NPAYEEO PIC  X(0002).
  2105*    -------------------------------
  2106     05  FILLER            PIC  X(0003).
  2107     05  NREGAMTO PIC  ZZ,ZZZ.99-.
  2108*    -------------------------------
  2109     05  FILLER            PIC  X(0003).
  2110     05  NLASTO PIC  X(0001).
  2111*    -------------------------------
  2112     05  FILLER            PIC  X(0003).
  2113     05  NINDCTRO PIC  X(0001).
  2114*    -------------------------------
  2115     05  FILLER            PIC  X(0003).
  2116     05  DAYPAYO PIC  X(0002).
  2117*    -------------------------------
  2118     05  FILLER            PIC  X(0003).
  2119     05  NPRINTO PIC  X(0004).
  2120*    -------------------------------
  2121     05  FILLER            PIC  X(0003).
  2122     05  LETTDTEO PIC  99B99B99.
  2123*    -------------------------------
  2124     05  FILLER            PIC  X(0003).
  2125     05  ENDLETTO PIC  X(0004).
  2126*    -------------------------------
  2127     05  FILLER            PIC  X(0003).
  2128     05  ERRMSG1O PIC  X(0079).
  2129*    -------------------------------
  2130     05  FILLER            PIC  X(0003).
  2131     05  ERRMSG2O PIC  X(0079).
  2132*    -------------------------------
  2133     05  FILLER            PIC  X(0003).
  2134     05  ENTERPFO PIC  X(0002).
  2135*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  43
* EL154.cbl
  2137****************************************************************
  2138*
  2139* Copyright (c) 2007 by Clerity Solutions, Inc.
  2140* All rights reserved.
  2141*
  2142****************************************************************
  2143 01  DFHEIV.
  2144   02  DFHEIV0               PIC X(35).
  2145   02  DFHEIV1               PIC X(08).
  2146   02  DFHEIV2               PIC X(08).
  2147   02  DFHEIV3               PIC X(08).
  2148   02  DFHEIV4               PIC X(06).
  2149   02  DFHEIV5               PIC X(04).
  2150   02  DFHEIV6               PIC X(04).
  2151   02  DFHEIV7               PIC X(02).
  2152   02  DFHEIV8               PIC X(02).
  2153   02  DFHEIV9               PIC X(01).
  2154   02  DFHEIV10              PIC S9(7) COMP-3.
  2155   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2156   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2157   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2158   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2159   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2160   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2161   02  DFHEIV17              PIC X(04).
  2162   02  DFHEIV18              PIC X(04).
  2163   02  DFHEIV19              PIC X(04).
  2164   02  DFHEIV20              USAGE IS POINTER.
  2165   02  DFHEIV21              USAGE IS POINTER.
  2166   02  DFHEIV22              USAGE IS POINTER.
  2167   02  DFHEIV23              USAGE IS POINTER.
  2168   02  DFHEIV24              USAGE IS POINTER.
  2169   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2170   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2171   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2172   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2173   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2174   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2175   02  FILLER                PIC X(02).
  2176   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2177   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2178   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2179   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2180   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2181 LINKAGE  SECTION.
  2182*****************************************************************
  2183*                                                               *
  2184* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2185* All rights reserved.                                          *
  2186*                                                               *
  2187*****************************************************************
  2188 01  dfheiblk.
  2189     02  eibtime          pic s9(7) comp-3.
  2190     02  eibdate          pic s9(7) comp-3.
  2191     02  eibtrnid         pic x(4).
  2192     02  eibtaskn         pic s9(7) comp-3.
  2193     02  eibtrmid         pic x(4).
  2194     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  44
* EL154.cbl
  2195     02  eibcposn         pic s9(4) comp.
  2196     02  eibcalen         pic s9(4) comp.
  2197     02  eibaid           pic x(1).
  2198     02  eibfiller1       pic x(1).
  2199     02  eibfn            pic x(2).
  2200     02  eibfiller2       pic x(2).
  2201     02  eibrcode         pic x(6).
  2202     02  eibfiller3       pic x(2).
  2203     02  eibds            pic x(8).
  2204     02  eibreqid         pic x(8).
  2205     02  eibrsrce         pic x(8).
  2206     02  eibsync          pic x(1).
  2207     02  eibfree          pic x(1).
  2208     02  eibrecv          pic x(1).
  2209     02  eibsend          pic x(1).
  2210     02  eibatt           pic x(1).
  2211     02  eibeoc           pic x(1).
  2212     02  eibfmh           pic x(1).
  2213     02  eibcompl         pic x(1).
  2214     02  eibsig           pic x(1).
  2215     02  eibconf          pic x(1).
  2216     02  eiberr           pic x(1).
  2217     02  eibrldbk         pic x(1).
  2218     02  eiberrcd         pic x(4).
  2219     02  eibsynrb         pic x(1).
  2220     02  eibnodat         pic x(1).
  2221     02  eibfiller5       pic x(2).
  2222     02  eibresp          pic 9(09) comp.
  2223     02  eibresp2         pic 9(09) comp.
  2224     02  dfheigdj         pic s9(4) comp.
  2225     02  dfheigdk         pic s9(4) comp.
  2226 01  DFHCOMMAREA             PIC X(1024).
  2227
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  45
* EL154.cbl
  2229*                            COPY ELCCNTL.
  2230******************************************************************
  2231*                                                                *
  2232*                                                                *
  2233*                            ELCCNTL.                            *
  2234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2235*                            VMOD=2.059                          *
  2236*                                                                *
  2237*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2238*                                                                *
  2239*   FILE TYPE = VSAM,KSDS                                        *
  2240*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2241*                                                                *
  2242*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2243*       ALTERNATE INDEX = NONE                                   *
  2244*                                                                *
  2245*   LOG = YES                                                    *
  2246*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2247******************************************************************
  2248*                   C H A N G E   L O G
  2249*
  2250* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2251*-----------------------------------------------------------------
  2252*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2253* EFFECTIVE    NUMBER
  2254*-----------------------------------------------------------------
  2255* 082503                   PEMA  ADD BENEFIT GROUP
  2256* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2257* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2258* 092705    2005050300006  PEMA  ADD SPP LEASES
  2259* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2260* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2261* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2262* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2263* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2264* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2265* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2266* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2267* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2268******************************************************************
  2269*
  2270 01  CONTROL-FILE.
  2271     12  CF-RECORD-ID                       PIC XX.
  2272         88  VALID-CF-ID                        VALUE 'CF'.
  2273
  2274     12  CF-CONTROL-PRIMARY.
  2275         16  CF-COMPANY-ID                  PIC XXX.
  2276         16  CF-RECORD-TYPE                 PIC X.
  2277             88  CF-COMPANY-MASTER              VALUE '1'.
  2278             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2279             88  CF-STATE-MASTER                VALUE '3'.
  2280             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2281             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2282             88  CF-CARRIER-MASTER              VALUE '6'.
  2283             88  CF-MORTALITY-MASTER            VALUE '7'.
  2284             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2285             88  CF-TERMINAL-MASTER             VALUE '9'.
  2286             88  CF-AH-EDIT-MASTER              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  46
* EL154.cbl
  2287             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2288             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2289             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2290             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2291             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2292             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2293             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2294             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2295         16  CF-ACCESS-CD-GENL              PIC X(4).
  2296         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2297             20  CF-PROCESSOR               PIC X(4).
  2298         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2299             20  CF-STATE-CODE              PIC XX.
  2300             20  FILLER                     PIC XX.
  2301         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2302             20  FILLER                     PIC XX.
  2303             20  CF-HI-BEN-IN-REC           PIC XX.
  2304         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2305             20  FILLER                     PIC XXX.
  2306             20  CF-CARRIER-CNTL            PIC X.
  2307         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2308             20  FILLER                     PIC XX.
  2309             20  CF-HI-TYPE-IN-REC          PIC 99.
  2310         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2311             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2312                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2313             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2314             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2315         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2316             20  FILLER                     PIC X.
  2317             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2318         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2319             20  FILLER                     PIC XX.
  2320             20  CF-MORTGAGE-PLAN           PIC XX.
  2321         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2322
  2323     12  CF-LAST-MAINT-DT                   PIC XX.
  2324     12  CF-LAST-MAINT-BY                   PIC X(4).
  2325     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2326
  2327     12  CF-RECORD-BODY                     PIC X(728).
  2328
  2329
  2330****************************************************************
  2331*             COMPANY MASTER RECORD                            *
  2332****************************************************************
  2333
  2334     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2335         16  CF-COMPANY-ADDRESS.
  2336             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2337             20  CF-CL-IN-CARE-OF           PIC X(30).
  2338             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2339             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2340             20  CF-CL-CITY-STATE           PIC X(30).
  2341             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2342             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2343         16  CF-COMPANY-CD                  PIC X.
  2344         16  CF-COMPANY-PASSWORD            PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  47
* EL154.cbl
  2345         16  CF-SECURITY-OPTION             PIC X.
  2346             88  ALL-SECURITY                   VALUE '1'.
  2347             88  COMPANY-VERIFY                 VALUE '2'.
  2348             88  PROCESSOR-VERIFY               VALUE '3'.
  2349             88  NO-SECURITY                    VALUE '4'.
  2350             88  ALL-BUT-TERM                   VALUE '5'.
  2351         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2352             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2353         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2354             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2355         16  CF-INFORCE-LOCATION            PIC X.
  2356             88  CERTS-ARE-ONLINE               VALUE '1'.
  2357             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2358             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2359         16  CF-LOWER-CASE-LETTERS          PIC X.
  2360         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2361             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2362             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2363             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2364             88  CF-ACCNT-CNTL                  VALUE '3'.
  2365             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2366
  2367         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2368         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2369
  2370         16  CF-LGX-CREDIT-USER             PIC X.
  2371             88  CO-IS-NOT-USER                 VALUE 'N'.
  2372             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2373
  2374         16 CF-CREDIT-CALC-CODES.
  2375             20  CF-CR-REM-TERM-CALC PIC X.
  2376               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2377               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2378               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2379               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2380               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2381               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2382               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2383             20  CF-CR-R78-METHOD           PIC X.
  2384               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2385               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2386
  2387         16  CF-CLAIM-CONTROL-COUNTS.
  2388             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2389                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2390
  2391             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2392                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2393
  2394             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2395                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2396
  2397             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2398                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2399
  2400         16  CF-CURRENT-MONTH-END           PIC XX.
  2401
  2402         16  CF-CO-CALC-QUOTE-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  48
* EL154.cbl
  2403             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2404             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2405             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2406             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2407                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2408                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2409             20  CF-CO-PREM-REJECT-SW       PIC X.
  2410                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2411                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2412             20  CF-CO-REF-REJECT-SW        PIC X.
  2413                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2414                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2415
  2416         16  CF-CO-REPORTING-DT             PIC XX.
  2417         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2418         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2419           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2420           88  CF-CO-MONTH-END                  VALUE '1'.
  2421
  2422         16  CF-LGX-CLAIM-USER              PIC X.
  2423             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2424             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2425
  2426         16  CF-CREDIT-EDIT-CONTROLS.
  2427             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2428             20  CF-MIN-AGE                 PIC 99.
  2429             20  CF-DEFAULT-AGE             PIC 99.
  2430             20  CF-MIN-TERM                PIC S999      COMP-3.
  2431             20  CF-MAX-TERM                PIC S999      COMP-3.
  2432             20  CF-DEFAULT-SEX             PIC X.
  2433             20  CF-JOINT-AGE-INPUT         PIC X.
  2434                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2435             20  CF-BIRTH-DATE-INPUT        PIC X.
  2436                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2437             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2438                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2439                 88  CF-ZERO-CARRIER            VALUE '1'.
  2440                 88  CF-ZERO-GROUPING           VALUE '2'.
  2441                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2442             20  CF-EDIT-SW                 PIC X.
  2443                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2444             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2445             20  CF-CR-PR-METHOD            PIC X.
  2446               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2447               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2448             20  FILLER                     PIC X.
  2449
  2450         16  CF-CREDIT-MISC-CONTROLS.
  2451             20  CF-REIN-TABLE-SW           PIC X.
  2452                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2453             20  CF-COMP-TABLE-SW           PIC X.
  2454                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2455             20  CF-EXPERIENCE-RETENTION-AGE
  2456                                            PIC S9        COMP-3.
  2457             20  CF-CONVERSION-DT           PIC XX.
  2458             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2459             20  CF-RUN-FREQUENCY-SW        PIC X.
  2460                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  49
* EL154.cbl
  2461                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2462
  2463             20  CF-CR-CHECK-NO-CONTROL.
  2464                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2465                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2466                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2467                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2468                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2469                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2470
  2471                 24  CF-CR-CHECK-COUNT       REDEFINES
  2472                     CF-CR-CHECK-COUNTER      PIC X(4).
  2473
  2474                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2475                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2476
  2477                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2478                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2479                 24  CF-MAIL-PROCESSING       PIC X.
  2480                     88  MAIL-PROCESSING          VALUE 'Y'.
  2481
  2482         16  CF-MISC-SYSTEM-CONTROL.
  2483             20  CF-SYSTEM-C                 PIC X.
  2484                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2485             20  CF-SYSTEM-D                 PIC X.
  2486                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2487             20  CF-SOC-SEC-NO-SW            PIC X.
  2488                 88  SOC-SEC-NO-USED             VALUE '1'.
  2489             20  CF-MEMBER-NO-SW             PIC X.
  2490                 88  MEMBER-NO-USED              VALUE '1'.
  2491             20  CF-TAX-ID-NUMBER            PIC X(11).
  2492             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2493             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2494                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2495                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2496                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2497                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2498             20  CF-SYSTEM-E                 PIC X.
  2499                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2500
  2501         16  CF-LGX-LIFE-USER               PIC X.
  2502             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2503             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2504
  2505         16  CF-CR-MONTH-END-DT             PIC XX.
  2506
  2507         16  CF-FILE-MAINT-DATES.
  2508             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2509                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2510             20  CF-LAST-BATCH       REDEFINES
  2511                 CF-LAST-BATCH-NO               PIC X(4).
  2512             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2513             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2514             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2515             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2516             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2517             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2518             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  50
* EL154.cbl
  2519             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2520             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2521             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2522
  2523         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2524         16  FILLER                         PIC X.
  2525
  2526         16  CF-ALT-MORT-CODE               PIC X(4).
  2527         16  CF-MEMBER-CAPTION              PIC X(10).
  2528
  2529         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2530             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2531             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2532             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2533             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2534             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2535
  2536         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2537
  2538         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2539         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2540         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2541         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2542
  2543         16  CF-AH-OVERRIDE-L1              PIC X.
  2544         16  CF-AH-OVERRIDE-L2              PIC XX.
  2545         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2546         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2547
  2548         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2549         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2550
  2551         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2552         16  CF-AR-LAST-EL860-DT            PIC XX.
  2553         16  CF-MP-MONTH-END-DT             PIC XX.
  2554
  2555         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2556         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2557             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2558
  2559         16  CF-AR-MONTH-END-DT             PIC XX.
  2560
  2561         16  CF-CRDTCRD-USER                PIC X.
  2562             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2563             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2564
  2565         16  CF-CC-MONTH-END-DT             PIC XX.
  2566
  2567         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2568
  2569         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2570             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2571             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2572             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2573         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2574         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2575         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2576         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  51
* EL154.cbl
  2577             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2578             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2579         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2580         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2581         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2582             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2583         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2584
  2585         16  CF-CL-ZIP-CODE.
  2586             20  CF-CL-ZIP-PRIME.
  2587                 24  CF-CL-ZIP-1ST          PIC X.
  2588                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2589                 24  FILLER                 PIC X(4).
  2590             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2591         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2592             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2593             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2594             20  FILLER                     PIC XXX.
  2595
  2596         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2597         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2598         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2599         16  CF-CO-OPTION-START-DATE        PIC XX.
  2600         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2601           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2602                                                      '3' '4'.
  2603           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2604           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2605           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2606           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2607           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2608           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2609
  2610         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2611
  2612         16  CF-PAYMENT-APPROVAL-LEVELS.
  2613             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2614             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2615             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2616             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2617             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2618             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2619
  2620         16  CF-END-USER-REPORTING-USER     PIC X.
  2621             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2622             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2623
  2624         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2625             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2626             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2627
  2628         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2629
  2630         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2631         16  FILLER                         PIC X.
  2632
  2633         16  CF-CREDIT-ARCHIVE-CNTL.
  2634             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  52
* EL154.cbl
  2635             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2636             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2637
  2638         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2639
  2640         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2641             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2642             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2643
  2644         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2645             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2646             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2647
  2648         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2649
  2650         16  CF-CO-ACH-ID-CODE              PIC  X.
  2651             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2652             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2653             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2654         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2655         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2656         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2657         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2658         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2659         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2660         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2661         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2662         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2663                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2664         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2665                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2666
  2667         16  CF-CO-OVER-SHORT.
  2668             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2669             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2670
  2671*         16  FILLER                         PIC X(102).
  2672         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2673             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2674             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2675
  2676         16  CF-AH-APPROVAL-DAYS.
  2677             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2678             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2679             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2680             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2681
  2682         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2683
  2684         16  CF-APPROV-LEV-5.
  2685             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2686             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2687             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2688
  2689         16  FILLER                         PIC X(68).
  2690****************************************************************
  2691*             PROCESSOR/USER RECORD                            *
  2692****************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  53
* EL154.cbl
  2693
  2694     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2695         16  CF-PROCESSOR-NAME              PIC X(30).
  2696         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2697         16  CF-PROCESSOR-TITLE             PIC X(26).
  2698         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2699                 88  MESSAGE-YES                VALUE 'Y'.
  2700                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2701
  2702*****************************************************
  2703****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2704****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2705****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2706****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2707*****************************************************
  2708
  2709         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2710             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2711             20  CF-APPLICATION-FORCE       PIC X.
  2712             20  CF-INDIVIDUAL-APP.
  2713                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2714                     28  CF-BROWSE-APP      PIC X.
  2715                     28  CF-UPDATE-APP      PIC X.
  2716
  2717         16  CF-CURRENT-TERM-ON             PIC X(4).
  2718         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2719             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2720             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2721             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2722             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2723             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2724             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2725             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2726         16  CF-PROCESSOR-CARRIER           PIC X.
  2727             88  NO-CARRIER-SECURITY            VALUE ' '.
  2728         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2729             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2730         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2731             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2732         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2733             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2734
  2735         16  CF-PROC-SYS-ACCESS-SW.
  2736             20  CF-PROC-CREDIT-CLAIMS-SW.
  2737                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2738                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2739                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2740                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2741             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2742                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2743                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2744             20  CF-PROC-LIFE-GNRLDGR-SW.
  2745                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2746                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2747                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2748                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2749             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2750                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  54
* EL154.cbl
  2751                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2752         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2753             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2754             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2755         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2756
  2757         16  CF-APPROVAL-LEVEL                  PIC X.
  2758             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2759             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2760             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2761             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2762             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2763
  2764         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2765
  2766         16  CF-LANGUAGE-TYPE                   PIC X.
  2767             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2768             88  CF-LANG-IS-FR                      VALUE 'F'.
  2769
  2770         16  CF-CSR-IND                         PIC X.
  2771         16  FILLER                             PIC X(239).
  2772
  2773****************************************************************
  2774*             PROCESSOR/REMINDERS RECORD                       *
  2775****************************************************************
  2776
  2777     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2778         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2779             20  CF-START-REMIND-DT         PIC XX.
  2780             20  CF-END-REMIND-DT           PIC XX.
  2781             20  CF-REMINDER-TEXT           PIC X(50).
  2782         16  FILLER                         PIC X(296).
  2783
  2784
  2785****************************************************************
  2786*             STATE MASTER RECORD                              *
  2787****************************************************************
  2788
  2789     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2790         16  CF-STATE-ABBREVIATION          PIC XX.
  2791         16  CF-STATE-NAME                  PIC X(25).
  2792         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2793         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2794             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2795             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2796             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2797             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2798                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2799                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2800             20  CF-ST-PREM-REJECT-SW       PIC X.
  2801                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2802                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2803             20  CF-ST-REF-REJECT-SW        PIC X.
  2804                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2805                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2806         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2807         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2808         16  CF-ST-REFUND-RULES.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  55
* EL154.cbl
  2809             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2810             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2811             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2812         16  CF-ST-FST-PMT-EXTENSION.
  2813             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2814             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2815                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2816                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2817                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2818                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2819         16  CF-ST-STATE-CALL.
  2820             20  CF-ST-CALL-UNEARNED        PIC X.
  2821             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2822             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2823         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2824             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2825             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2826         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2827         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2828         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2829         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2830         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2831         16  FILLER                         PIC X.
  2832         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2833             20  CF-ST-BENEFIT-CD           PIC XX.
  2834             20  CF-ST-BENEFIT-KIND         PIC X.
  2835                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2836                 88  CF-ST-AH-KIND              VALUE 'A'.
  2837             20  CF-ST-REM-TERM-CALC        PIC X.
  2838                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2839                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2840                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2841                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2842                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2843                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2844                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2845                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2846
  2847             20  CF-ST-REFUND-CALC          PIC X.
  2848                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2849                 88  ST-REFD-BY-R78             VALUE '1'.
  2850                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2851                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2852                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2853                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2854                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2855                 88  ST-REFD-UTAH               VALUE '7'.
  2856                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2857                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2858                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2859
  2860             20  CF-ST-EARNING-CALC         PIC X.
  2861                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2862                 88  ST-EARN-BY-R78             VALUE '1'.
  2863                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2864                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2865                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2866                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  56
* EL154.cbl
  2867                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2868                 88  ST-EARN-MEAN               VALUE '8'.
  2869                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2870
  2871             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2872                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2873                 88  ST-OVRD-BY-R78             VALUE '1'.
  2874                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2875                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2876                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2877                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2878                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2879                 88  ST-OVRD-MEAN               VALUE '8'.
  2880                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2881             20  FILLER                     PIC X.
  2882
  2883         16  CF-ST-COMMISSION-CAPS.
  2884             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2885             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2886             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2887             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2888         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2889                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2890
  2891         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2892
  2893         16  CF-ST-STATUTORY-INTEREST.
  2894             20  CF-ST-STAT-DATE-FROM       PIC X.
  2895                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2896                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2897             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2898             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2899             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2900             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2901             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2902
  2903         16  CF-ST-OVER-SHORT.
  2904             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2905             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2906
  2907         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2908
  2909         16  CF-ST-RT-CALC                  PIC X.
  2910
  2911         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2912         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2913         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2914         16  CF-ST-RF-LR-CALC               PIC X.
  2915         16  CF-ST-RF-LL-CALC               PIC X.
  2916         16  CF-ST-RF-LN-CALC               PIC X.
  2917         16  CF-ST-RF-AH-CALC               PIC X.
  2918         16  CF-ST-RF-CP-CALC               PIC X.
  2919*        16  FILLER                         PIC X(206).
  2920*CIDMOD         16  FILLER                         PIC X(192).
  2921         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2922             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2923         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2924         16  CF-ST-VFY-2ND-BENE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  57
* EL154.cbl
  2925         16  CF-ST-CAUSAL-STATE             PIC X.
  2926         16  FILLER                         PIC X(185).
  2927
  2928****************************************************************
  2929*             BENEFIT MASTER RECORD                            *
  2930****************************************************************
  2931
  2932     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2933         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2934             20  CF-BENEFIT-CODE            PIC XX.
  2935             20  CF-BENEFIT-NUMERIC  REDEFINES
  2936                 CF-BENEFIT-CODE            PIC XX.
  2937             20  CF-BENEFIT-ALPHA           PIC XXX.
  2938             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2939             20  CF-BENEFIT-COMMENT         PIC X(10).
  2940
  2941             20  CF-LF-COVERAGE-TYPE        PIC X.
  2942                 88  CF-REDUCING                VALUE 'R'.
  2943                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2944
  2945             20  CF-SPECIAL-CALC-CD         PIC X.
  2946                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2947                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2948                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2949                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2950                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2951                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2952                 88  CF-FARM-PLAN               VALUE 'F'.
  2953                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2954                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2955                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2956                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2957                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2958                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2959                 88  CF-PRUDENTIAL              VALUE 'P'.
  2960                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2961                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2962                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2963                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2964                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2965                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2966
  2967             20  CF-JOINT-INDICATOR         PIC X.
  2968                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2969
  2970*            20  FILLER                     PIC X(12).
  2971             20  FILLER                     PIC X(11).
  2972             20  CF-BENEFIT-CATEGORY        PIC X.
  2973             20  CF-LOAN-TYPE               PIC X(8).
  2974
  2975             20  CF-CO-REM-TERM-CALC        PIC X.
  2976                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2977                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2978                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2979                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2980                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2981
  2982             20  CF-CO-EARNINGS-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  58
* EL154.cbl
  2983                 88  CO-EARN-BY-R78             VALUE '1'.
  2984                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2985                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2986                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2987                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2988                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2989                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2990                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2991
  2992             20  CF-CO-REFUND-CALC          PIC X.
  2993                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2994                 88  CO-REFD-BY-R78             VALUE '1'.
  2995                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2996                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2997                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2998                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2999                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3000                 88  CO-REFD-MEAN               VALUE '8'.
  3001                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3002                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3003                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3004
  3005             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3006                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3007                 88  CO-OVRD-BY-R78             VALUE '1'.
  3008                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3009                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3010                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3011                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3012                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3013                 88  CO-OVRD-MEAN               VALUE '8'.
  3014                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3015
  3016             20  CF-CO-BEN-I-G-CD           PIC X.
  3017                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3018                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3019                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3020
  3021         16  FILLER                         PIC X(304).
  3022
  3023
  3024****************************************************************
  3025*             CARRIER MASTER RECORD                            *
  3026****************************************************************
  3027
  3028     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3029         16  CF-ADDRESS-DATA.
  3030             20  CF-MAIL-TO-NAME            PIC X(30).
  3031             20  CF-IN-CARE-OF              PIC X(30).
  3032             20  CF-ADDRESS-LINE-1          PIC X(30).
  3033             20  CF-ADDRESS-LINE-2          PIC X(30).
  3034             20  CF-CITY-STATE              PIC X(30).
  3035             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3036             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3037
  3038         16  CF-CLAIM-NO-CONTROL.
  3039             20  CF-CLAIM-NO-METHOD         PIC X.
  3040                 88  CLAIM-NO-MANUAL            VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  59
* EL154.cbl
  3041                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3042                 88  CLAIM-NO-SEQ               VALUE '3'.
  3043                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3044             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3045                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3046                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3047                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3048
  3049         16  CF-CHECK-NO-CONTROL.
  3050             20  CF-CHECK-NO-METHOD         PIC X.
  3051                 88  CHECK-NO-MANUAL            VALUE '1'.
  3052                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3053                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3054                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3055             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3056                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3057
  3058         16  CF-DOMICILE-STATE              PIC XX.
  3059
  3060         16  CF-EXPENSE-CONTROLS.
  3061             20  CF-EXPENSE-METHOD          PIC X.
  3062                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3063                 88  DOLLARS-PER-PMT            VALUE '2'.
  3064                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3065                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3066             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3067             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3068
  3069         16  CF-CORRESPONDENCE-CONTROL.
  3070             20  CF-LETTER-RESEND-OPT       PIC X.
  3071                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3072                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3073             20  FILLER                     PIC X(4).
  3074
  3075         16  CF-RESERVE-CONTROLS.
  3076             20  CF-MANUAL-SW               PIC X.
  3077                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3078             20  CF-FUTURE-SW               PIC X.
  3079                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3080             20  CF-PTC-SW                  PIC X.
  3081                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3082             20  CF-IBNR-SW                 PIC X.
  3083                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3084             20  CF-PTC-LF-SW               PIC X.
  3085                 88  CF-LF-PTC-USED             VALUE '1'.
  3086             20  CF-CDT-ACCESS-METHOD       PIC X.
  3087                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3088                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3089                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3090             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3091
  3092         16  CF-CLAIM-CALC-METHOD           PIC X.
  3093             88  360-PLUS-MONTHS                VALUE '1'.
  3094             88  365-PLUS-MONTHS                VALUE '2'.
  3095             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3096             88  360-DAILY                      VALUE '4'.
  3097             88  365-DAILY                      VALUE '5'.
  3098
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  60
* EL154.cbl
  3099         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3100         16  FILLER                         PIC X(11).
  3101
  3102         16  CF-LIMIT-AMOUNTS.
  3103             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3104             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3105             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3106             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3107             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3108             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3109             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3110             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3111             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3112             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3113
  3114         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3115         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3116         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3117
  3118         16  CF-ZIP-CODE.
  3119             20  CF-ZIP-PRIME.
  3120                 24  CF-ZIP-1ST             PIC X.
  3121                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3122                 24  FILLER                 PIC X(4).
  3123             20  CF-ZIP-PLUS4               PIC X(4).
  3124         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3125             20  CF-CAN-POSTAL-1            PIC XXX.
  3126             20  CF-CAN-POSTAL-2            PIC XXX.
  3127             20  FILLER                     PIC XXX.
  3128
  3129         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3130         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3131         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3132
  3133         16  CF-RATING-SWITCH               PIC X.
  3134             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3135             88  CF-NO-RATING                   VALUE 'N'.
  3136
  3137         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3138
  3139         16  CF-CARRIER-OVER-SHORT.
  3140             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3141             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3142
  3143         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3144         16  CF-SECPAY-SWITCH               PIC X.
  3145             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3146             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3147         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3148         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3149         16  FILLER                         PIC X(444).
  3150*        16  FILLER                         PIC X(452).
  3151
  3152
  3153****************************************************************
  3154*             MORTALITY MASTER RECORD                          *
  3155****************************************************************
  3156
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  61
* EL154.cbl
  3157     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3158         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3159                                INDEXED BY CF-MORT-NDX.
  3160             20  CF-MORT-TABLE              PIC X(5).
  3161             20  CF-MORT-TABLE-TYPE         PIC X.
  3162                 88  CF-MORT-JOINT              VALUE 'J'.
  3163                 88  CF-MORT-SINGLE             VALUE 'S'.
  3164                 88  CF-MORT-COMBINED           VALUE 'C'.
  3165                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3166                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3167             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3168             20  CF-MORT-AGE-METHOD         PIC XX.
  3169                 88  CF-AGE-LAST                VALUE 'AL'.
  3170                 88  CF-AGE-NEAR                VALUE 'AN'.
  3171             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3172             20  CF-MORT-ADJUSTMENT-DIRECTION
  3173                                            PIC X.
  3174                 88  CF-MINUS                   VALUE '-'.
  3175                 88  CF-PLUS                    VALUE '+'.
  3176             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3177             20  CF-MORT-JOINT-CODE         PIC X.
  3178                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3179             20  CF-MORT-PC-Q               PIC X.
  3180                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3181             20  CF-MORT-TABLE-CODE         PIC X(4).
  3182             20  CF-MORT-COMMENTS           PIC X(15).
  3183             20  FILLER                     PIC X(14).
  3184
  3185         16  FILLER                         PIC X(251).
  3186
  3187
  3188****************************************************************
  3189*             BUSSINESS TYPE MASTER RECORD                     *
  3190****************************************************************
  3191
  3192     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3193* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3194* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3195* AND RECORD 05 IS TYPES 81-99
  3196         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3197             20  CF-BUSINESS-TITLE          PIC  X(19).
  3198             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3199                                            PIC S9V9(4) COMP-3.
  3200             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3201             20  FILLER                     PIC  X.
  3202         16  FILLER                         PIC  X(248).
  3203
  3204
  3205****************************************************************
  3206*             TERMINAL MASTER RECORD                           *
  3207****************************************************************
  3208
  3209     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3210
  3211         16  CF-COMPANY-TERMINALS.
  3212             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3213                                  PIC X(4).
  3214         16  FILLER               PIC X(248).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  62
* EL154.cbl
  3215
  3216
  3217****************************************************************
  3218*             LIFE EDIT MASTER RECORD                          *
  3219****************************************************************
  3220
  3221     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3222         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3223             20  CF-LIFE-CODE-IN            PIC XX.
  3224             20  CF-LIFE-CODE-OUT           PIC XX.
  3225         16  FILLER                         PIC X(248).
  3226
  3227
  3228****************************************************************
  3229*             AH EDIT MASTER RECORD                            *
  3230****************************************************************
  3231
  3232     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3233         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3234             20  CF-AH-CODE-IN              PIC XXX.
  3235             20  CF-AH-CODE-OUT             PIC XX.
  3236         16  FILLER                         PIC X(248).
  3237
  3238
  3239****************************************************************
  3240*             CREDIBILITY TABLES                               *
  3241****************************************************************
  3242
  3243     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3244         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3245                             INDEXED BY CF-CRDB-NDX.
  3246             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3247             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3248             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3249         16  FILLER                         PIC  X(332).
  3250
  3251
  3252****************************************************************
  3253*             REPORT CUSTOMIZATION RECORD                      *
  3254****************************************************************
  3255
  3256     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3257         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3258             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3259             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3260             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3261**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3262****       A T-TRANSFER.                                   ****
  3263             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3264
  3265         16  FILLER                         PIC XX.
  3266
  3267         16  CF-CARRIER-CNTL-OPT.
  3268             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3269                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3270                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3271             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3272                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  63
* EL154.cbl
  3273         16  CF-GROUP-CNTL-OPT.
  3274             20  CF-GROUP-OPT-SEQ           PIC 9.
  3275                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3276                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3277             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3278                                            PIC X(6).
  3279         16  CF-STATE-CNTL-OPT.
  3280             20  CF-STATE-OPT-SEQ           PIC 9.
  3281                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3282                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3283             20  CF-STATE-SELECT OCCURS 3 TIMES
  3284                                            PIC XX.
  3285         16  CF-ACCOUNT-CNTL-OPT.
  3286             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3287                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3288                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3289             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3290                                            PIC X(10).
  3291         16  CF-BUS-TYP-CNTL-OPT.
  3292             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3293                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3294                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3295             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3296                                            PIC XX.
  3297         16  CF-LF-TYP-CNTL-OPT.
  3298             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3299                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3300                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3301             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3302                                            PIC XX.
  3303         16  CF-AH-TYP-CNTL-OPT.
  3304             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3305                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3306                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3307             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3308                                            PIC XX.
  3309         16  CF-REPTCD1-CNTL-OPT.
  3310             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3311                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3312                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3313             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3314                                            PIC X(10).
  3315         16  CF-REPTCD2-CNTL-OPT.
  3316             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3317                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3318                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3319             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3320                                            PIC X(10).
  3321         16  CF-USER1-CNTL-OPT.
  3322             20  CF-USER1-OPT-SEQ           PIC 9.
  3323                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3324                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3325             20  CF-USER1-SELECT OCCURS 3 TIMES
  3326                                            PIC X(10).
  3327         16  CF-USER2-CNTL-OPT.
  3328             20  CF-USER2-OPT-SEQ           PIC 9.
  3329                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3330                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  64
* EL154.cbl
  3331             20  CF-USER2-SELECT OCCURS 3 TIMES
  3332                                            PIC X(10).
  3333         16  CF-USER3-CNTL-OPT.
  3334             20  CF-USER3-OPT-SEQ           PIC 9.
  3335                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3336                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3337             20  CF-USER3-SELECT OCCURS 3 TIMES
  3338                                            PIC X(10).
  3339         16  CF-USER4-CNTL-OPT.
  3340             20  CF-USER4-OPT-SEQ           PIC 9.
  3341                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3342                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3343             20  CF-USER4-SELECT OCCURS 3 TIMES
  3344                                            PIC X(10).
  3345         16  CF-USER5-CNTL-OPT.
  3346             20  CF-USER5-OPT-SEQ           PIC 9.
  3347                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3348                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3349             20  CF-USER5-SELECT OCCURS 3 TIMES
  3350                                            PIC X(10).
  3351         16  CF-REINS-CNTL-OPT.
  3352             20  CF-REINS-OPT-SEQ           PIC 9.
  3353                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3354                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3355             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3356                 24  CF-REINS-PRIME         PIC XXX.
  3357                 24  CF-REINS-SUB           PIC XXX.
  3358
  3359         16  CF-AGENT-CNTL-OPT.
  3360             20  CF-AGENT-OPT-SEQ           PIC 9.
  3361                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3362                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3363             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3364                                            PIC X(10).
  3365
  3366         16  FILLER                         PIC X(43).
  3367
  3368         16  CF-LOSS-RATIO-SELECT.
  3369             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3370             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3371         16  CF-ENTRY-DATE-SELECT.
  3372             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3373             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3374         16  CF-EFFECTIVE-DATE-SELECT.
  3375             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3376             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3377
  3378         16  CF-EXCEPTION-LIST-IND          PIC X.
  3379             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3380
  3381         16  FILLER                         PIC X(318).
  3382
  3383****************************************************************
  3384*                  EXCEPTION REPORTING RECORD                  *
  3385****************************************************************
  3386
  3387     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3388         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  65
* EL154.cbl
  3389             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3390
  3391         16  CF-COMBINED-LIFE-AH-OPT.
  3392             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3393             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3394             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3395             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3396
  3397         16  CF-LIFE-OPT.
  3398             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3399             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3400             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3401             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3402             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3403             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3404             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3405             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3406             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3407             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3408
  3409         16  CF-AH-OPT.
  3410             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3411             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3412             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3413             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3414             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3415             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3416             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3417             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3418             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3419             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3420
  3421         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3422             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3423             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3424             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3425
  3426         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3427
  3428         16  FILLER                         PIC X(673).
  3429
  3430
  3431****************************************************************
  3432*             MORTGAGE SYSTEM PLAN RECORD                      *
  3433****************************************************************
  3434
  3435     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3436         16  CF-PLAN-TYPE                   PIC X.
  3437             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3438             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3439             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3440         16  CF-PLAN-ABBREV                 PIC XXX.
  3441         16  CF-PLAN-DESCRIPT               PIC X(10).
  3442         16  CF-PLAN-NOTES                  PIC X(20).
  3443         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3444         16  CF-PLAN-UNDERWRITING.
  3445             20  CF-PLAN-TERM-DATA.
  3446                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  66
* EL154.cbl
  3447                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3448             20  CF-PLAN-AGE-DATA.
  3449                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3450                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3451                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3452             20  CF-PLAN-BENEFIT-DATA.
  3453                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3454                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3455                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3456                                            PIC S9(7)V99  COMP-3.
  3457         16  CF-PLAN-POLICY-FORMS.
  3458             20  CF-POLICY-FORM             PIC X(12).
  3459             20  CF-MASTER-APPLICATION      PIC X(12).
  3460             20  CF-MASTER-POLICY           PIC X(12).
  3461         16  CF-PLAN-RATING.
  3462             20  CF-RATE-CODE               PIC X(5).
  3463             20  CF-SEX-RATING              PIC X.
  3464                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3465                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3466             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3467             20  CF-SUB-STD-TYPE            PIC X.
  3468                 88  CF-PCT-OF-PREM            VALUE '1'.
  3469                 88  CF-PCT-OF-BENE            VALUE '2'.
  3470         16  CF-PLAN-PREM-TOLERANCES.
  3471             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3472             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3473         16  CF-PLAN-PYMT-TOLERANCES.
  3474             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3475             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3476         16  CF-PLAN-MISC-DATA.
  3477             20  FILLER                     PIC X.
  3478             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3479             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3480         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3481         16  CF-PLAN-IND-GRP                PIC X.
  3482             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3483                                                     '1'.
  3484             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3485                                                     '2'.
  3486         16  CF-MIB-SEARCH-SW               PIC X.
  3487             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3488             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3489             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3490             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3491         16  CF-ALPHA-SEARCH-SW             PIC X.
  3492             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3493             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3494             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3495             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3496             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3497             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3498             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3499             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3500             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3501             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3502                                                     'A' 'B' 'C'
  3503                                                     'X' 'Y' 'Z'.
  3504         16  CF-EFF-DT-RULE-SW              PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  67
* EL154.cbl
  3505             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3506             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3507             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3508             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3509             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3510         16  FILLER                         PIC X(4).
  3511         16  CF-HEALTH-QUESTIONS            PIC X.
  3512             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3513         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3514         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3515         16  CF-PLAN-SNGL-JNT               PIC X.
  3516             88  CF-COMBINED-PLAN              VALUE 'C'.
  3517             88  CF-JNT-PLAN                   VALUE 'J'.
  3518             88  CF-SNGL-PLAN                  VALUE 'S'.
  3519         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3520         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3521         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3522         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3523         16  CF-RERATE-CNTL                 PIC  X.
  3524             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3525             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3526             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3527             88  CF-AUTO-RECALC                 VALUE '4'.
  3528         16  CF-BENEFIT-TYPE                PIC  X.
  3529             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3530             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3531         16  CF-POLICY-FEE                  PIC S999V99
  3532                                                    COMP-3.
  3533         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3534         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3535         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3536         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3537         16  FILLER                         PIC  X(32).
  3538         16  CF-TERMINATION-FORM            PIC  X(04).
  3539         16  FILLER                         PIC  X(08).
  3540         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3541                                                       COMP-3.
  3542         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3543         16  CF-ISSUE-LETTER                PIC  X(4).
  3544         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3545         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3546             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3547             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3548         16  CF-MP-REFUND-CALC              PIC X.
  3549             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3550             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3551             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3552             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3553             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3554             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3555             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3556             88  CF-MP-REFD-MEAN                VALUE '8'.
  3557         16  CF-ALT-RATE-CODE               PIC  X(5).
  3558
  3559
  3560         16  FILLER                         PIC X(498).
  3561****************************************************************
  3562*             MORTGAGE COMPANY MASTER RECORD                   *
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  68
* EL154.cbl
  3563****************************************************************
  3564
  3565     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3566         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3567         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3568             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3569             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3570             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3571             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3572             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3573
  3574         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3575         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3576         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3577         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3578         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3579
  3580         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3581             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3582         16  CF-MP-RECON-USE-IND            PIC X(1).
  3583             88  CF-MP-USE-RECON             VALUE 'Y'.
  3584         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3585             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3586         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3587             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3588             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3589         16  FILLER                         PIC X(1).
  3590         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3591             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3592         16  CF-MORTG-MIB-VERSION           PIC X.
  3593             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3594             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3595             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3596         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3597             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3598                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3599             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3600                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3601             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3602                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3603             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3604                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3605             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3606                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3607             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3608                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3609         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3610         16  FILLER                         PIC X(7).
  3611         16  CF-MORTG-DESTINATION-SYMBOL.
  3612             20  CF-MORTG-MIB-COMM          PIC X(5).
  3613             20  CF-MORTG-MIB-TERM          PIC X(5).
  3614         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3615             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3616         16  FILLER                         PIC X(03).
  3617         16  CF-MP-CHECK-NO-CONTROL.
  3618             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3619                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3620                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  69
* EL154.cbl
  3621                                                ' ' LOW-VALUES.
  3622                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3623                                               VALUE '3'.
  3624         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3625         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3626         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3627             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3628                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3629             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3630                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3631             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3632                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3633             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3634                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3635             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3636                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3637             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3638                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3639         16  CF-MORTG-BILLING-AREA.
  3640             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3641                                            PIC X.
  3642         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3643         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3644         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3645         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3646             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3647             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3648         16  FILLER                         PIC X.
  3649         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3650             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3651             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3652         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3653         16  FILLER                         PIC X(8).
  3654         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3655         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3656         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3657         16  CF-ACH-COMPANY-ID.
  3658             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3659                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3660                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3661                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3662             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3663         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3664             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3665         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3666             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3667             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3668         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3669         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3670         16  FILLER                         PIC X(536).
  3671
  3672****************************************************************
  3673*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3674****************************************************************
  3675
  3676     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3677         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3678             20  CF-FEMALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  70
* EL154.cbl
  3679                 24  CF-FEMALE-FT           PIC 99.
  3680                 24  CF-FEMALE-IN           PIC 99.
  3681             20  CF-FEMALE-MIN-WT           PIC 999.
  3682             20  CF-FEMALE-MAX-WT           PIC 999.
  3683         16  FILLER                         PIC X(428).
  3684
  3685     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3686         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3687             20  CF-MALE-HEIGHT.
  3688                 24  CF-MALE-FT             PIC 99.
  3689                 24  CF-MALE-IN             PIC 99.
  3690             20  CF-MALE-MIN-WT             PIC 999.
  3691             20  CF-MALE-MAX-WT             PIC 999.
  3692         16  FILLER                         PIC X(428).
  3693******************************************************************
  3694*             AUTOMATIC ACTIVITY RECORD                          *
  3695******************************************************************
  3696     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3697         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3698             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3699             20  CF-SYS-LETTER-ID           PIC X(04).
  3700             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3701             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3702             20  CF-SYS-RESET-SW            PIC X(01).
  3703             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3704             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3705
  3706         16  FILLER                         PIC X(50).
  3707
  3708         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3709             20  CF-USER-ACTIVE-SW          PIC X(01).
  3710             20  CF-USER-LETTER-ID          PIC X(04).
  3711             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3712             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3713             20  CF-USER-RESET-SW           PIC X(01).
  3714             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3715             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3716             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3717
  3718         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  71
* EL154.cbl
  3720*                            COPY ELCMSTR.
  3721******************************************************************
  3722*                                                                *
  3723*                            ELCMSTR.                            *
  3724*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3725*                            VMOD=2.012                          *
  3726*                                                                *
  3727*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3728*                                                                *
  3729*   FILE TYPE = VSAM,KSDS                                        *
  3730*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3731*                                                                *
  3732*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3733*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3734*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3735*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3736*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3737*                                                 RKP=75,LEN=21  *
  3738*                                                                *
  3739*   **** NOTE ****                                               *
  3740*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3741*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3742*                                                                *
  3743*   LOG = YES                                                    *
  3744*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3745******************************************************************
  3746*                   C H A N G E   L O G
  3747*
  3748* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3749*-----------------------------------------------------------------
  3750*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3751* EFFECTIVE    NUMBER
  3752*-----------------------------------------------------------------
  3753* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3754* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3755* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3756******************************************************************
  3757 01  CLAIM-MASTER.
  3758     12  CL-RECORD-ID                PIC XX.
  3759         88  VALID-CL-ID         VALUE 'CL'.
  3760
  3761     12  CL-CONTROL-PRIMARY.
  3762         16  CL-COMPANY-CD           PIC X.
  3763         16  CL-CARRIER              PIC X.
  3764         16  CL-CLAIM-NO             PIC X(7).
  3765         16  CL-CERT-NO.
  3766             20  CL-CERT-PRIME       PIC X(10).
  3767             20  CL-CERT-SFX         PIC X.
  3768
  3769     12  CL-CONTROL-BY-NAME.
  3770         16  CL-COMPANY-CD-A1        PIC X.
  3771         16  CL-INSURED-LAST-NAME    PIC X(15).
  3772         16  CL-INSURED-NAME.
  3773             20  CL-INSURED-1ST-NAME PIC X(12).
  3774             20  CL-INSURED-MID-INIT PIC X.
  3775
  3776     12  CL-CONTROL-BY-SSN.
  3777         16  CL-COMPANY-CD-A2        PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  72
* EL154.cbl
  3778         16  CL-SOC-SEC-NO.
  3779             20  CL-SSN-STATE        PIC XX.
  3780             20  CL-SSN-ACCOUNT      PIC X(6).
  3781             20  CL-SSN-LN3          PIC X(3).
  3782
  3783     12  CL-CONTROL-BY-CERT-NO.
  3784         16  CL-COMPANY-CD-A4        PIC X.
  3785         16  CL-CERT-NO-A4.
  3786             20  CL-CERT-A4-PRIME    PIC X(10).
  3787             20  CL-CERT-A4-SFX      PIC X.
  3788
  3789     12  CL-CONTROL-BY-CCN.
  3790         16  CL-COMPANY-CD-A5        PIC X.
  3791         16  CL-CCN-A5.
  3792             20  CL-CCN.
  3793                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3794                 24  CL-CCN-PRIME-A5 PIC X(12).
  3795             20  CL-CCN-FILLER-A5    PIC X(4).
  3796
  3797     12  CL-INSURED-PROFILE-DATA.
  3798         16  CL-INSURED-BIRTH-DT     PIC XX.
  3799         16  CL-INSURED-SEX-CD       PIC X.
  3800             88  INSURED-IS-MALE        VALUE 'M'.
  3801             88  INSURED-IS-FEMALE      VALUE 'F'.
  3802             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3803         16  CL-INSURED-OCC-CD       PIC X(6).
  3804         16  FILLER                  PIC X(5).
  3805
  3806     12  CL-PROCESSING-INFO.
  3807         16  CL-PROCESSOR-ID         PIC X(4).
  3808         16  CL-CLAIM-STATUS         PIC X.
  3809             88  CLAIM-IS-OPEN          VALUE 'O'.
  3810             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3811         16  CL-CLAIM-TYPE           PIC X.
  3812*            88  AH-CLAIM               VALUE 'A'.
  3813*            88  LIFE-CLAIM             VALUE 'L'.
  3814*            88  PROPERTY-CLAIM         VALUE 'P'.
  3815*            88  IUI-CLAIM              VALUE 'I'.
  3816*            88  GAP-CLAIM              VALUE 'G'.
  3817         16  CL-CLAIM-PREM-TYPE      PIC X.
  3818             88  SINGLE-PREMIUM         VALUE '1'.
  3819             88  O-B-COVERAGE           VALUE '2'.
  3820             88  OPEN-END-COVERAGE      VALUE '3'.
  3821         16  CL-INCURRED-DT          PIC XX.
  3822         16  CL-REPORTED-DT          PIC XX.
  3823         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3824         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3825         16  CL-LAST-PMT-DT          PIC XX.
  3826         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3827         16  CL-PAID-THRU-DT         PIC XX.
  3828         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3829         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3830         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3831         16  CL-PMT-CALC-METHOD      PIC X.
  3832             88  CL-360-DAY-YR          VALUE '1'.
  3833             88  CL-365-DAY-YR          VALUE '2'.
  3834             88  CL-FULL-MONTHS         VALUE '3'.
  3835         16  CL-CAUSE-CD             PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  73
* EL154.cbl
  3836
  3837         16  CL-PRIME-CERT-NO.
  3838             20  CL-PRIME-CERT-PRIME PIC X(10).
  3839             20  CL-PRIME-CERT-SFX   PIC X.
  3840
  3841         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3842             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3843             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3844
  3845         16  CL-MICROFILM-NO         PIC X(10).
  3846         16  CL-PROG-FORM-TYPE       PIC X.
  3847         16  CL-LAST-ADD-ON-DT       PIC XX.
  3848
  3849         16  CL-LAST-REOPEN-DT       PIC XX.
  3850         16  CL-LAST-CLOSE-DT        PIC XX.
  3851         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3852             88  FINAL-PAID             VALUE '1'.
  3853             88  CLAIM-DENIED           VALUE '2'.
  3854             88  AUTO-CLOSE             VALUE '3'.
  3855             88  MANUAL-CLOSE           VALUE '4'.
  3856             88  BENEFITS-CHANGED       VALUE 'C'.
  3857             88  SETUP-ERRORS           VALUE 'E'.
  3858         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3859         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3860         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3861             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3862         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3863         16  FILLER                  PIC X.
  3864
  3865     12  CL-CERTIFICATE-DATA.
  3866         16  CL-CERT-ORIGIN          PIC X.
  3867             88  CERT-WAS-ONLINE        VALUE '1'.
  3868             88  CERT-WAS-CREATED       VALUE '2'.
  3869             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3870         16  CL-CERT-KEY-DATA.
  3871             20  CL-CERT-CARRIER     PIC X.
  3872             20  CL-CERT-GROUPING    PIC X(6).
  3873             20  CL-CERT-STATE       PIC XX.
  3874             20  CL-CERT-ACCOUNT.
  3875                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3876                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3877             20  CL-CERT-EFF-DT      PIC XX.
  3878
  3879     12  CL-STATUS-CONTROLS.
  3880         16  CL-PRIORITY-CD          PIC X.
  3881             88  CONFIDENTIAL-DATA      VALUE '8'.
  3882             88  HIGHEST-PRIORITY       VALUE '9'.
  3883         16  CL-SUPV-ATTN-CD         PIC X.
  3884             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3885             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3886         16  CL-PURGED-DT            PIC XX.
  3887         16  CL-RESTORED-DT          PIC XX.
  3888         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3889         16  CL-NEXT-RESEND-DT       PIC XX.
  3890         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3891         16  CL-CRITICAL-PERIOD      PIC 99.
  3892*        16  FILLER                  PIC XX.
  3893         16  CL-LAST-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  74
* EL154.cbl
  3894         16  CL-LAST-MAINT-USER      PIC X(4).
  3895         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3896         16  CL-LAST-MAINT-TYPE      PIC X.
  3897             88  CLAIM-SET-UP           VALUE ' '.
  3898             88  PAYMENT-MADE           VALUE '1'.
  3899             88  LETTER-SENT            VALUE '2'.
  3900             88  MASTER-WAS-ALTERED     VALUE '3'.
  3901             88  MASTER-WAS-RESTORED    VALUE '4'.
  3902             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3903             88  FILE-CONVERTED         VALUE '6'.
  3904             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3905             88  ERROR-CORRECTION       VALUE 'E'.
  3906         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3907         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3908         16  CL-BENEFICIARY          PIC X(10).
  3909         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3910         16  CL-DENIAL-TYPE          PIC X.
  3911             88  CL-TYPE-DENIAL          VALUE '1'.
  3912             88  CL-TYPE-RESCISSION      VALUE '2'.
  3913             88  CL-TYPE-REFORMATION     VALUE '3'.
  3914             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3915             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3916         16  CL-CRIT-PER-RECURRENT   PIC X.
  3917         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3918         16  CL-RTW-DT               PIC XX.
  3919
  3920     12  CL-TRAILER-CONTROLS.
  3921         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3922             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3923             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3924             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3925         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3926         16  FILLER                  PIC XX.
  3927         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3928         16  CL-ADDRESS-TRAILER-CNT.
  3929             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3930                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3931             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3932                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3933             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3934                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3935             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3936                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3937             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3938                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3939             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3940                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3941             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3942                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3943
  3944     12  CL-CV-REFERENCE-NO.
  3945         16  CL-CV-REFNO-PRIME       PIC X(18).
  3946         16  CL-CV-REFNO-SFX         PIC XX.
  3947
  3948     12  CL-FILE-LOCATION            PIC X(4).
  3949
  3950     12  CL-PROCESS-ERRORS.
  3951         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  75
* EL154.cbl
  3952             88  NO-FATAL-ERRORS        VALUE ZERO.
  3953         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3954             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3955
  3956     12  CL-PRODUCT-CD               PIC X.
  3957
  3958     12  CL-CURRENT-KEY-DATA.
  3959         16  CL-CURRENT-CARRIER      PIC X.
  3960         16  CL-CURRENT-GROUPING     PIC X(6).
  3961         16  CL-CURRENT-STATE        PIC XX.
  3962         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3963
  3964     12  CL-ASSOCIATES               PIC X.
  3965         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3966         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3967         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3968         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3969
  3970     12  CL-ACTIVITY-CODE            PIC 99.
  3971     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3972     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3973
  3974     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3975     12  CL-LAG-REPORT-CODE          PIC 9.
  3976     12  CL-LOAN-TYPE                PIC XX.
  3977     12  CL-LEGAL-STATE              PIC XX.
  3978
  3979     12  CL-YESNOSW                  PIC X.
  3980     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3981         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3982         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3983         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3984     12  cl-insured-claim            pic x.
  3985         88  cl-claim-on-primary         value 'P'.
  3986         88  cl-claim-on-secondary       value 'S'.
  3987     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  76
* EL154.cbl
  3989*                            COPY ELCTRLR.
  3990******************************************************************
  3991*                                                                *
  3992*                            ELCTRLR.                            *
  3993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3994*                            VMOD=2.014                          *
  3995*                                                                *
  3996*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  3997*                                                                *
  3998*   FILE TYPE = VSAM,KSDS                                        *
  3999*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4000*                                                                *
  4001*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4002*       ALTERNATE INDEX = NONE                                   *
  4003*                                                                *
  4004*   LOG = YES                                                    *
  4005*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4006******************************************************************
  4007*                   C H A N G E   L O G
  4008*
  4009* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4010*-----------------------------------------------------------------
  4011*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4012* EFFECTIVE    NUMBER
  4013*-----------------------------------------------------------------
  4014* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4015* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4016* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4017* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4018* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4019* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4020* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4021* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4022* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4023* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4024* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4025* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4026* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4027* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4028* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4029* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4030******************************************************************
  4031 01  ACTIVITY-TRAILERS.
  4032     12  AT-RECORD-ID                    PIC XX.
  4033         88  VALID-AT-ID                       VALUE 'AT'.
  4034
  4035     12  AT-CONTROL-PRIMARY.
  4036         16  AT-COMPANY-CD               PIC X.
  4037         16  AT-CARRIER                  PIC X.
  4038         16  AT-CLAIM-NO                 PIC X(7).
  4039         16  AT-CERT-NO.
  4040             20  AT-CERT-PRIME           PIC X(10).
  4041             20  AT-CERT-SFX             PIC X.
  4042         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4043             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4044             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4045             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4046             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  77
* EL154.cbl
  4047             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4048             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4049             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4050             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4051             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4052             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4053             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4054             88  AT-BENEFICIARY-TRL           VALUE +91.
  4055             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4056             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4057             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4058             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4059
  4060     12  AT-TRAILER-TYPE                 PIC X.
  4061         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4062         88  PAYMENT-TR                       VALUE '2'.
  4063         88  AUTO-PAY-TR                      VALUE '3'.
  4064         88  CORRESPONDENCE-TR                VALUE '4'.
  4065         88  ADDRESS-TR                       VALUE '5'.
  4066         88  GENERAL-INFO-TR                  VALUE '6'.
  4067         88  AUTO-PROMPT-TR                   VALUE '7'.
  4068         88  DENIAL-TR                        VALUE '8'.
  4069         88  INCURRED-CHG-TR                  VALUE '9'.
  4070         88  FORM-CONTROL-TR                  VALUE 'A'.
  4071
  4072     12  AT-RECORDED-DT                  PIC XX.
  4073     12  AT-RECORDED-BY                  PIC X(4).
  4074     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4075
  4076     12  AT-TRAILER-BODY                 PIC X(165).
  4077
  4078     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4079         16  AT-RESERVE-CONTROLS.
  4080             20  AT-MANUAL-SW            PIC X.
  4081                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4082             20  AT-FUTURE-SW            PIC X.
  4083                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4084             20  AT-PTC-SW               PIC X.
  4085                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4086             20  AT-IBNR-SW              PIC X.
  4087                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4088             20  AT-PTC-LF-SW            PIC X.
  4089                 88  AT-LF-PTC-USED          VALUE '1'.
  4090             20  AT-CDT-ACCESS-METHOD    PIC X.
  4091                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4092                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4093                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4094             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4095         16  AT-LAST-COMPUTED-DT         PIC XX.
  4096         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4097         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4098         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4099         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4100         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4101         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4102         16  AT-EXPENSE-CONTROLS.
  4103             20  AT-EXPENSE-METHOD       PIC X.
  4104                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  78
* EL154.cbl
  4105                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4106                 88  PERCENT-OF-PMT           VALUE '3'.
  4107                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4108             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4109             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4110         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4111         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4112
  4113         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4114         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4115
  4116*        16  FILLER                      PIC X(53).
  4117         16  FILLER                      PIC X(47).
  4118
  4119         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4120         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4121
  4122         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4123             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4124             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4125*                    C = CLOSED
  4126*                    O = OPEN
  4127             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4128*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4129
  4130     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4131         16  AT-PAYMENT-TYPE             PIC X.
  4132             88  PARTIAL-PAYMENT                VALUE '1'.
  4133             88  FINAL-PAYMENT                  VALUE '2'.
  4134             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4135             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4136             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4137             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4138             88  VOIDED-PAYMENT                 VALUE '9'.
  4139             88  TRANSFER                       VALUE 'T'.
  4140             88  LIFE-INTEREST                  VALUE 'I'.
  4141
  4142         16  AT-CLAIM-TYPE               PIC X.
  4143             88  PAID-FOR-AH                    VALUE 'A'.
  4144             88  PAID-FOR-LIFE                  VALUE 'L'.
  4145             88  PAID-FOR-IUI                   VALUE 'I'.
  4146             88  PAID-FOR-GAP                   VALUE 'G'.
  4147         16  AT-CLAIM-PREM-TYPE          PIC X.
  4148             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4149             88  AT-O-B-COVERAGE                VALUE '2'.
  4150             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4151         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4152         16  AT-CHECK-NO                 PIC X(7).
  4153         16  AT-PAID-FROM-DT             PIC XX.
  4154         16  AT-PAID-THRU-DT             PIC XX.
  4155         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4156         16  FILLER                      PIC X.
  4157         16  AT-PAYEES-NAME              PIC X(30).
  4158         16  AT-PAYMENT-ORIGIN           PIC X.
  4159             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4160             88  ONLINE-AUTO-PMT                VALUE '2'.
  4161             88  OFFLINE-PMT                    VALUE '3'.
  4162         16  AT-CHECK-WRITTEN-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  79
* EL154.cbl
  4163         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4164         16  AT-VOID-DATA.
  4165             20  AT-VOID-DT              PIC XX.
  4166*00144       20  AT-VOID-REASON          PIC X(30).
  4167             20  AT-VOID-REASON          PIC X(26).
  4168         16  AT-PMT-APPROVED-BY          PIC X(04).
  4169         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4170         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4171         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4172                                         PIC S99V9(5)  COMP-3.
  4173         16  AT-CREDIT-INTERFACE.
  4174             20  AT-PMT-SELECT-DT        PIC XX.
  4175                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4176             20  AT-PMT-ACCEPT-DT        PIC XX.
  4177                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4178             20  AT-VOID-SELECT-DT       PIC XX.
  4179                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4180             20  AT-VOID-ACCEPT-DT       PIC XX.
  4181                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4182
  4183         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4184                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4185                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4186         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4187
  4188         16  AT-FORCE-CONTROL            PIC X.
  4189             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4190         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4191         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4192         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4193         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4194         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4195         16  AT-BENEFIT-TYPE             PIC X.
  4196
  4197         16  AT-EXPENSE-TYPE             PIC X.
  4198         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4199
  4200         16  AT-PAYEE-TYPE-CD.
  4201             20  AT-PAYEE-TYPE           PIC X.
  4202                 88  INSURED-PAID           VALUE 'I'.
  4203                 88  BENEFICIARY-PAID       VALUE 'B'.
  4204                 88  ACCOUNT-PAID           VALUE 'A'.
  4205                 88  OTHER-1-PAID           VALUE 'O'.
  4206                 88  OTHER-2-PAID           VALUE 'Q'.
  4207                 88  DOCTOR-PAID            VALUE 'P'.
  4208                 88  EMPLOYER-PAID          VALUE 'E'.
  4209             20  AT-PAYEE-SEQ            PIC X.
  4210
  4211         16  AT-CASH-PAYMENT             PIC X.
  4212         16  AT-GROUPED-PAYMENT          PIC X.
  4213         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4214         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4215         16  AT-APPROVED-LEVEL           PIC X.
  4216         16  AT-VOID-TYPE                PIC X.
  4217             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4218             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4219         16  AT-AIG-UNEMP-IND            PIC X.
  4220             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  80
* EL154.cbl
  4221         16  AT-ASSOCIATES               PIC X.
  4222             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4223             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4224
  4225         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4226         16  AT-CV-PMT-CODE              PIC X.
  4227             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4228             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4229             88  FULL-ADD-PAYMENT           VALUE '3'.
  4230             88  HALF-ADD-PAYMENT           VALUE '4'.
  4231             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4232             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4233             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4234             88  ADDL-PAYMENT               VALUE '8'.
  4235
  4236         16  AT-EOB-CODE1                PIC XXX.
  4237         16  AT-EOB-CODE2                PIC XXX.
  4238         16  AT-EOB-CODE3                PIC XXX.
  4239         16  FILLER REDEFINES AT-EOB-CODE3.
  4240             20  AT-PRINT-CLM-FORM       PIC X.
  4241             20  AT-PRINT-SURVEY         PIC X.
  4242             20  FILLER                  PIC X.
  4243         16  AT-EOB-CODE4                PIC XXX.
  4244         16  FILLER REDEFINES AT-EOB-CODE4.
  4245             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4246             20  FILLER                  PIC X.
  4247         16  AT-EOB-CODE5                PIC XXX.
  4248         16  FILLER REDEFINES AT-EOB-CODE5.
  4249             20  AT-PMT-PROOF-DT         PIC XX.
  4250             20  FILLER                  PIC X.
  4251
  4252         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4253             88  AT-PRINT-EOB            VALUE 'Y'.
  4254
  4255         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4256         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4257
  4258     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4259         16  AT-SCHEDULE-START-DT        PIC XX.
  4260         16  AT-SCHEDULE-END-DT          PIC XX.
  4261         16  AT-TERMINATED-DT            PIC XX.
  4262         16  AT-LAST-PMT-TYPE            PIC X.
  4263             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4264             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4265         16  AT-FIRST-PMT-DATA.
  4266             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4267             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4268             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4269         16  AT-REGULAR-PMT-DATA.
  4270             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4271             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4272             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4273         16  AT-AUTO-PAYEE-CD.
  4274             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4275                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4276                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4277                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4278                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  81
* EL154.cbl
  4279                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4280             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4281         16  AT-AUTO-PAY-DAY             PIC 99.
  4282         16  AT-AUTO-CASH                PIC X.
  4283             88  AT-CASH                      VALUE 'Y'.
  4284             88  AT-NON-CASH                  VALUE 'N'.
  4285*        16  FILLER                      PIC X(129).
  4286         16  AT-AUTO-END-LETTER          PIC X(4).
  4287         16  FILLER                      PIC X(125).
  4288
  4289         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4290         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4291
  4292     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4293         16  AT-LETTER-SENT-DT           PIC XX.
  4294         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4295         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4296         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4297         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4298         16  AT-LETTER-ORIGIN            PIC X.
  4299             88  ONLINE-CREATION              VALUE '1' '3'.
  4300             88  OFFLINE-CREATION             VALUE '2' '4'.
  4301             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4302             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4303         16  AT-STD-LETTER-FORM          PIC X(4).
  4304         16  AT-REASON-TEXT              PIC X(70).
  4305         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4306         16  AT-ADDRESEE-TYPE            PIC X.
  4307              88  INSURED-ADDRESEE            VALUE 'I'.
  4308              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4309              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4310              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4311              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4312              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4313              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4314         16  AT-ADDRESSEE-NAME           PIC X(30).
  4315         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4316         16  AT-RESEND-PRINT-DATE        PIC XX.
  4317         16  AT-CORR-SOL-UNSOL           PIC X.
  4318         16  AT-LETTER-PURGED-DT         PIC XX.
  4319*
  4320*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4321*
  4322         16  AT-CSO-REDEFINITION.
  4323             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4324             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4325             20  AT-LETTER-TO-BENE       PIC X(1).
  4326             20  AT-STOP-LETTER-DT       PIC X(2).
  4327             20  FILLER                  PIC X(19).
  4328*             20  FILLER                  PIC X(27).
  4329             20  AT-CSO-LETTER-STATUS    PIC X.
  4330                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4331                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4332                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4333             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4334             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4335*
  4336*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  82
* EL154.cbl
  4337*
  4338*        16  FILLER                      PIC X(26).
  4339*
  4340*        16  AT-DMD-BSR-CODE             PIC X.
  4341*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4342*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4343*
  4344*        16  AT-DMD-LETTER-STATUS        PIC X.
  4345*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4346*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4347*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4348*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4349*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4350
  4351         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4352         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4353
  4354     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4355         16  AT-ADDRESS-TYPE             PIC X.
  4356             88  INSURED-ADDRESS               VALUE 'I'.
  4357             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4358             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4359             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4360             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4361             88  OTHER-ADDRESS-1               VALUE 'O'.
  4362             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4363         16  AT-MAIL-TO-NAME             PIC X(30).
  4364         16  AT-ADDRESS-LINE-1           PIC X(30).
  4365         16  AT-ADDRESS-LINE-2           PIC X(30).
  4366         16  AT-CITY-STATE.
  4367             20  AT-CITY                 PIC X(28).
  4368             20  AT-STATE                PIC XX.
  4369         16  AT-ZIP.
  4370             20  AT-ZIP-CODE.
  4371                 24  AT-ZIP-1ST          PIC X.
  4372                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4373                 24  FILLER              PIC X(4).
  4374             20  AT-ZIP-PLUS4            PIC X(4).
  4375         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4376             20  AT-CAN-POSTAL-1         PIC XXX.
  4377             20  AT-CAN-POSTAL-2         PIC XXX.
  4378             20  FILLER                  PIC XXX.
  4379         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4380*         16  FILLER                      PIC X(23).
  4381         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4382         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4383         16  FILLER                      PIC X(13).
  4384         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4385         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4386
  4387     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4388         16  AT-INFO-LINE-1              PIC X(60).
  4389         16  FILLER REDEFINES AT-INFO-LINE-1.
  4390             20  AT-NOTE-ERROR-NO OCCURS 15
  4391                                         PIC X(4).
  4392         16  AT-INFO-LINE-2              PIC X(60).
  4393         16  AT-INFO-TRAILER-TYPE        PIC X.
  4394             88  AT-ERRORS-NOTE          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  83
* EL154.cbl
  4395             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4396             88  AT-CALL-NOTE            VALUE 'C'.
  4397             88  AT-MAINT-NOTE           VALUE 'M'.
  4398             88  AT-CERT-CHANGE          VALUE 'X'.
  4399             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4400             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4401         16  AT-CALL-TYPE                PIC X.
  4402             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4403             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4404         16  AT-NOTE-CONTINUATION        PIC X.
  4405             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4406         16  AT-EOB-CODES-EXIST          PIC X.
  4407             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4408         16  FILLER                      PIC X(35).
  4409         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4410         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4411
  4412     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4413         16  AT-PROMPT-LINE-1            PIC X(60).
  4414         16  AT-PROMPT-LINE-2            PIC X(60).
  4415         16  AT-PROMPT-START-DT          PIC XX.
  4416         16  AT-PROMPT-END-DT            PIC XX.
  4417         16  FILLER                      PIC X(35).
  4418         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4419         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4420
  4421     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4422         16  AT-DENIAL-INFO-1            PIC X(60).
  4423         16  AT-DENIAL-INFO-2            PIC X(60).
  4424         16  AT-DENIAL-DT                PIC XX.
  4425         16  AT-RETRACTION-DT            PIC XX.
  4426         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4427*         16  FILLER                      PIC X(31).
  4428         16  AT-DENIAL-PROOF-DT          PIC XX.
  4429         16  FILLER                      PIC X(29).
  4430         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4431         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4432
  4433     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4434         16  AT-OLD-INCURRED-DT          PIC XX.
  4435         16  AT-OLD-REPORTED-DT          PIC XX.
  4436         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4437         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4438         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4439         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4440         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4441         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4442         16  FILLER                      PIC X(26).
  4443         16  AT-OLD-DIAG-CODE            PIC X(6).
  4444         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4445         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4446         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4447         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4448         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4449         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4450         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4451         16  FILLER                      PIC X(25).
  4452         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  84
* EL154.cbl
  4453
  4454     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4455         16  AT-FORM-SEND-ON-DT          PIC XX.
  4456         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4457         16  AT-FORM-RE-SEND-DT          PIC XX.
  4458         16  AT-FORM-ANSWERED-DT         PIC XX.
  4459         16  AT-FORM-PRINTED-DT          PIC XX.
  4460         16  AT-FORM-REPRINT-DT          PIC XX.
  4461         16  AT-FORM-TYPE                PIC X.
  4462             88  INITIAL-FORM                  VALUE '1'.
  4463             88  PROGRESS-FORM                 VALUE '2'.
  4464         16  AT-INSTRUCT-LN-1            PIC X(28).
  4465         16  AT-INSTRUCT-LN-2            PIC X(28).
  4466         16  AT-INSTRUCT-LN-3            PIC X(28).
  4467         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4468         16  AT-FORM-ADDRESS             PIC X.
  4469             88  FORM-TO-INSURED              VALUE 'I'.
  4470             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4471             88  FORM-TO-OTHER-1              VALUE 'O'.
  4472             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4473         16  AT-RELATED-1.
  4474             20 AT-REL-CARR-1            PIC X.
  4475             20 AT-REL-CLAIM-1           PIC X(7).
  4476             20 AT-REL-CERT-1            PIC X(11).
  4477         16  AT-RELATED-2.
  4478             20 AT-REL-CARR-2            PIC X.
  4479             20 AT-REL-CLAIM-2           PIC X(7).
  4480             20 AT-REL-CERT-2            PIC X(11).
  4481         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4482         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4483         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4484         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4485         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4486         16  AT-STOP-FORM-DT             PIC X(2).
  4487
  4488         16  FILLER                      PIC X(09).
  4489         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4490         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4491******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  85
* EL154.cbl
  4493*                            COPY ELCCERT.
  4494******************************************************************
  4495*                                                                *
  4496*                            ELCCERT.                            *
  4497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4498*                            VMOD=2.013                          *
  4499*                                                                *
  4500*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4501*                                                                *
  4502*   FILE TYPE = VSAM,KSDS                                        *
  4503*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4504*                                                                *
  4505*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4506*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4507*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4508*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4509*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4510*                                                                *
  4511*   LOG = YES                                                    *
  4512*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4513******************************************************************
  4514*                   C H A N G E   L O G
  4515*
  4516* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4517*-----------------------------------------------------------------
  4518*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4519* EFFECTIVE    NUMBER
  4520*-----------------------------------------------------------------
  4521* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4522* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4523* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4524* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4525* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4526* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4527* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4528* 032612  CR2011110200001  PEMA  AHL CHANGES
  4529******************************************************************
  4530
  4531 01  CERTIFICATE-MASTER.
  4532     12  CM-RECORD-ID                      PIC XX.
  4533         88  VALID-CM-ID                      VALUE 'CM'.
  4534
  4535     12  CM-CONTROL-PRIMARY.
  4536         16  CM-COMPANY-CD                 PIC X.
  4537         16  CM-CARRIER                    PIC X.
  4538         16  CM-GROUPING.
  4539             20  CM-GROUPING-PREFIX        PIC X(3).
  4540             20  CM-GROUPING-PRIME         PIC X(3).
  4541         16  CM-STATE                      PIC XX.
  4542         16  CM-ACCOUNT.
  4543             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4544             20  CM-ACCOUNT-PRIME          PIC X(6).
  4545         16  CM-CERT-EFF-DT                PIC XX.
  4546         16  CM-CERT-NO.
  4547             20  CM-CERT-PRIME             PIC X(10).
  4548             20  CM-CERT-SFX               PIC X.
  4549
  4550     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  86
* EL154.cbl
  4551         16  CM-COMPANY-CD-A1              PIC X.
  4552         16  CM-INSURED-LAST-NAME          PIC X(15).
  4553         16  CM-INSURED-INITIALS.
  4554             20  CM-INSURED-INITIAL1       PIC X.
  4555             20  CM-INSURED-INITIAL2       PIC X.
  4556
  4557     12  CM-CONTROL-BY-SSN.
  4558         16  CM-COMPANY-CD-A2              PIC X.
  4559         16  CM-SOC-SEC-NO.
  4560             20  CM-SSN-STATE              PIC XX.
  4561             20  CM-SSN-ACCOUNT            PIC X(6).
  4562             20  CM-SSN-LN3.
  4563                 25  CM-INSURED-INITIALS-A2.
  4564                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4565                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4566                 25 CM-PART-LAST-NAME-A2         PIC X.
  4567
  4568     12  CM-CONTROL-BY-CERT-NO.
  4569         16  CM-COMPANY-CD-A4              PIC X.
  4570         16  CM-CERT-NO-A4                 PIC X(11).
  4571
  4572     12  CM-CONTROL-BY-MEMB.
  4573         16  CM-COMPANY-CD-A5              PIC X.
  4574         16  CM-MEMBER-NO.
  4575             20  CM-MEMB-STATE             PIC XX.
  4576             20  CM-MEMB-ACCOUNT           PIC X(6).
  4577             20  CM-MEMB-LN4.
  4578                 25  CM-INSURED-INITIALS-A5.
  4579                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4580                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4581                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4582
  4583     12  CM-INSURED-PROFILE-DATA.
  4584         16  CM-INSURED-FIRST-NAME.
  4585             20  CM-INSURED-1ST-INIT       PIC X.
  4586             20  FILLER                    PIC X(9).
  4587         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4588         16  CM-INSURED-SEX                PIC X.
  4589             88  CM-SEX-MALE                  VALUE 'M'.
  4590             88  CM-SEX-FEMAL                 VALUE 'F'.
  4591         16  CM-INSURED-JOINT-AGE          PIC 99.
  4592         16  CM-JOINT-INSURED-NAME.
  4593             20  CM-JT-LAST-NAME           PIC X(15).
  4594             20  CM-JT-FIRST-NAME.
  4595                 24  CM-JT-1ST-INIT        PIC X.
  4596                 24  FILLER                PIC X(9).
  4597             20  CM-JT-INITIAL             PIC X.
  4598
  4599     12  CM-LIFE-DATA.
  4600         16  CM-LF-BENEFIT-CD              PIC XX.
  4601         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4602         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4603         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4604         16  CM-LF-DEV-CODE                PIC XXX.
  4605         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4606         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4607         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4608         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  87
* EL154.cbl
  4609         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4610         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4611         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4612         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4613         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4614         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4615         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4616         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4617         16  FILLER                        PIC XX.
  4618
  4619     12  CM-AH-DATA.
  4620         16  CM-AH-BENEFIT-CD              PIC XX.
  4621         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4622         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4623         16  CM-AH-DEV-CODE                PIC XXX.
  4624         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4625         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4626         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4627         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4628         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4629         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4630         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4631         16  CM-AH-PAID-THRU-DT            PIC XX.
  4632             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4633         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4634         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4635         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4636         16  FILLER                        PIC X.
  4637
  4638     12  CM-LOAN-INFORMATION.
  4639         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4640         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4641                                           PIC S9(5)V99  COMP-3.
  4642         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4643         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4644         16  CM-PAY-FREQUENCY              PIC S99.
  4645         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4646         16  CM-RATE-CLASS                 PIC XX.
  4647         16  CM-BENEFICIARY                PIC X(25).
  4648         16  CM-POLICY-FORM-NO             PIC X(12).
  4649         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4650         16  CM-LAST-ADD-ON-DT             PIC XX.
  4651         16  CM-DEDUCTIBLE-AMOUNTS.
  4652             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4653             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4654         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4655             20  CM-RESIDENT-STATE         PIC XX.
  4656             20  CM-RATE-CODE              PIC X(4).
  4657             20  FILLER                    PIC XX.
  4658         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4659             20  CM-LOAN-OFFICER           PIC X(5).
  4660             20  FILLER                    PIC XXX.
  4661         16  CM-CSR-CODE                   PIC XXX.
  4662         16  CM-UNDERWRITING-CODE          PIC X.
  4663             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4664         16  CM-POST-CARD-IND              PIC X.
  4665         16  CM-NH-INTERFACE-SW            PIC X.
  4666         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  88
* EL154.cbl
  4667             88  CM-SING-PRM                  VALUE '1'.
  4668             88  CM-O-B-COVERAGE              VALUE '2'.
  4669             88  CM-OPEN-END                  VALUE '3'.
  4670         16  CM-IND-GRP-TYPE               PIC X.
  4671             88  CM-INDIVIDUAL                VALUE 'I'.
  4672             88  CM-GROUP                     VALUE 'G'.
  4673         16  CM-SKIP-CODE                  PIC X.
  4674             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4675             88  SKIP-JULY                    VALUE '1'.
  4676             88  SKIP-AUGUST                  VALUE '2'.
  4677             88  SKIP-SEPTEMBER               VALUE '3'.
  4678             88  SKIP-JULY-AUG                VALUE '4'.
  4679             88  SKIP-AUG-SEPT                VALUE '5'.
  4680             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4681             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4682             88  SKIP-JUNE                    VALUE '8'.
  4683             88  SKIP-JUNE-JULY               VALUE '9'.
  4684             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4685             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4686         16  CM-PAYMENT-MODE               PIC X.
  4687             88  PAY-MONTHLY                  VALUE SPACE.
  4688             88  PAY-WEEKLY                   VALUE '1'.
  4689             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4690             88  PAY-BI-WEEKLY                VALUE '3'.
  4691             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4692         16  CM-LOAN-NUMBER                PIC X(8).
  4693         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4694         16  CM-OLD-LOF                    PIC XXX.
  4695*        16  CM-LOAN-OFFICER               PIC XXX.
  4696         16  CM-REIN-TABLE                 PIC XXX.
  4697         16  CM-SPECIAL-REIN-CODE          PIC X.
  4698         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4699         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4700         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4701
  4702     12  CM-STATUS-DATA.
  4703         16  CM-ENTRY-STATUS               PIC X.
  4704         16  CM-ENTRY-DT                   PIC XX.
  4705
  4706         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4707         16  CM-LF-CANCEL-DT               PIC XX.
  4708         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4709
  4710         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4711         16  CM-LF-DEATH-DT                PIC XX.
  4712         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4713
  4714         16  CM-LF-CURRENT-STATUS          PIC X.
  4715             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4716                                                'M' '4' '5' '9'.
  4717             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4718             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4719             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4720             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4721             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4722             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4723             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4724             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  89
* EL154.cbl
  4725             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4726             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4727             88  CM-LF-DECLINED               VALUE 'D'.
  4728             88  CM-LF-VOIDED                 VALUE 'V'.
  4729
  4730         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4731         16  CM-AH-CANCEL-DT               PIC XX.
  4732         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4733
  4734         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4735         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4736         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4737
  4738         16  CM-AH-CURRENT-STATUS          PIC X.
  4739             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4740                                                'M' '4' '5' '9'.
  4741             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4742             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4743             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4744             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4745             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4746             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4747             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4748             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4749             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4750             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4751             88  CM-AH-DECLINED               VALUE 'D'.
  4752             88  CM-AH-VOIDED                 VALUE 'V'.
  4753
  4754         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4755             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4756             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4757             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4758         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4759
  4760         16  CM-ENTRY-BATCH                PIC X(6).
  4761         16  CM-LF-EXIT-BATCH              PIC X(6).
  4762         16  CM-AH-EXIT-BATCH              PIC X(6).
  4763         16  CM-LAST-MONTH-END             PIC XX.
  4764
  4765     12  CM-NOTE-SW                        PIC X.
  4766         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4767         88  CERT-NOTES-PRESENT               VALUE '1'.
  4768         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4769         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4770         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4771         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4772         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4773         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4774     12  CM-COMP-EXCP-SW                   PIC X.
  4775         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4776         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4777     12  CM-INSURED-ADDRESS-SW             PIC X.
  4778         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4779         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4780
  4781*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4782     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  90
* EL154.cbl
  4783     12  FILLER                            PIC X.
  4784
  4785*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4786     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4787     12  FILLER                            PIC X.
  4788*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4789     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4790
  4791     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4792         88  CERT-ADDED-BATCH                 VALUE ' '.
  4793         88  CERT-ADDED-ONLINE                VALUE '1'.
  4794         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4795         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4796         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4797     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4798         88  CERT-AS-LOADED                   VALUE ' '.
  4799         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4800         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4801         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4802         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4803         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4804         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4805         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4806
  4807     12  CM-ACCOUNT-COMM-PCTS.
  4808         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4809         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4810
  4811     12  CM-USER-FIELD                     PIC X.
  4812     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4813     12  CM-CLP-STATE                      PIC XX.
  4814     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4815     12  CM-USER-RESERVED                  PIC XXX.
  4816     12  FILLER REDEFINES CM-USER-RESERVED.
  4817         16  CM-AH-CLASS-CD                PIC XX.
  4818         16  F                             PIC X.
  4819******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  91
* EL154.cbl
  4821*                            COPY ELCBENE.
  4822******************************************************************
  4823*                                                                *
  4824*                            ELCBENE.                            *
  4825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4826*                            VMOD=2.006                          *
  4827*                                                                *
  4828*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  4829*                                                                *
  4830*   FILE TYPE = VSAM,KSDS                                        *
  4831*   RECORD SIZE = 500   RECFORM = FIX                            *
  4832*                                                                *
  4833*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  4834*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  4835*                                                                *
  4836*   LOG = YES                                                    *
  4837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4838*                                                                *
  4839*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  4840******************************************************************
  4841
  4842 01  BENEFICIARY-MASTER.
  4843     12  BE-RECORD-ID                PIC XX.
  4844         88  VALID-BE-ID                VALUE 'BE'.
  4845
  4846     12  BE-CONTROL-PRIMARY.
  4847         16  BE-COMPANY-CD           PIC X.
  4848         16  BE-RECORD-TYPE          PIC X.
  4849             88  BENEFICIARY-RECORD  VALUE 'B'.
  4850             88  ADJUSTOR-RECORD     VALUE 'A'.
  4851         16  BE-BENEFICIARY          PIC X(10).
  4852     12  BE-CONTROL-BY-NAME.
  4853         16  BE-COMPANY-CD-A1        PIC X.
  4854         16  BE-RECORD-TYPE-A1       PIC X.
  4855         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  4856         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  4857
  4858     12  BE-LAST-MAINT-DT            PIC XX.
  4859     12  BE-LAST-MAINT-BY            PIC X(4).
  4860     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4861
  4862     12  BE-ADDRESS-DATA.
  4863         16  BE-MAIL-TO-NAME         PIC X(30).
  4864         16  BE-ADDRESS-LINE-1       PIC X(30).
  4865         16  BE-ADDRESS-LINE-2       PIC X(30).
  4866         16  BE-ADDRESS-LINE-3       PIC X(30).
  4867         16  BE-CITY-STATE.
  4868             20  BE-CITY             PIC X(28).
  4869             20  BE-STATE            PIC XX.
  4870         16  BE-ZIP-CODE.
  4871             20  BE-ZIP-PRIME.
  4872                 24  BE-ZIP-1ST      PIC X.
  4873                     88  BE-CANADIAN-POST-CODE
  4874                                         VALUE 'A' THRU 'Z'.
  4875                 24  FILLER          PIC X(4).
  4876             20  BE-ZIP-PLUS4        PIC X(4).
  4877         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  4878             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  92
* EL154.cbl
  4879             20  BE-CAN-POSTAL-2     PIC XXX.
  4880             20  FILLER              PIC XXX.
  4881         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  4882         16  BE-GROUP-CHECKS-Y-N     PIC X.
  4883
  4884******************************************************************
  4885*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  4886*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  4887******************************************************************
  4888     12  BE-CARRIER                  PIC X.
  4889
  4890     12  BE-ADDRESS-DATA2.
  4891         16  BE-MAIL-TO-NAME2        PIC X(30).
  4892         16  BE-ADDRESS-LINE-12      PIC X(30).
  4893         16  BE-ADDRESS-LINE-22      PIC X(30).
  4894         16  BE-ADDRESS-LINE-32      PIC X(30).
  4895         16  BE-CITY-STATE2.
  4896             20  BE-CITY2            PIC X(28).
  4897             20  BE-STATE2           PIC XX.
  4898         16  BE-ZIP-CODE2.
  4899             20  BE-ZIP-PRIME2.
  4900                 24  BE-ZIP-1ST2     PIC X.
  4901                     88  BE-CANADIAN-POST-CODE2
  4902                                         VALUE 'A' THRU 'Z'.
  4903                 24  FILLER          PIC X(4).
  4904             20  BE-ZIP-PLUS42       PIC X(4).
  4905         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  4906             20  BE-CAN-POSTAL-12    PIC XXX.
  4907             20  BE-CAN-POSTAL-22    PIC XXX.
  4908             20  FILLER              PIC XXX.
  4909         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  4910         16  BE-BILLING-STMT-DATA.
  4911             20  BE-BSR              PIC X.
  4912                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  4913                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  4914             20  BE-BSR-FROM         PIC X(30).
  4915             20  BE-BSR-DEPT         PIC X(30).
  4916             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  4917             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  4918             20  BE-OUTPUT-TYPE      PIC X.
  4919                 88  BE-FAX-OUTPUT         VALUE 'F'.
  4920                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  4921
  4922     12  FILLER                      PIC X(28).
  4923******************************************************************
  4924*                            COPY ERCACCT.
  4925******************************************************************
  4926*                                                                *
  4927*                                                                *
  4928*                            ERCACCT                             *
  4929*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4930*                            VMOD=2.031                          *
  4931*                                                                *
  4932*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4933*                                                                *
  4934*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4935*   VSAM ACCOUNT MASTER FILES.                                   *
  4936*                                                                *
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  93
* EL154.cbl
  4937*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4938*                                                                *
  4939*   FILE TYPE = VSAM,KSDS                                        *
  4940*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4941*                                                                *
  4942*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4943*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4944*                                                                *
  4945*   LOG = NO                                                     *
  4946*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4947*                                                                *
  4948*                                                                *
  4949******************************************************************
  4950*                   C H A N G E   L O G
  4951*
  4952* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4953*-----------------------------------------------------------------
  4954*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4955* EFFECTIVE    NUMBER
  4956*-----------------------------------------------------------------
  4957* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4958* 092705    2005050300006  PEMA  ADD SPP LEASES
  4959* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4960* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4961* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4962* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4963* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4964******************************************************************
  4965
  4966 01  ACCOUNT-MASTER.
  4967     12  AM-RECORD-ID                      PIC XX.
  4968         88  VALID-AM-ID                      VALUE 'AM'.
  4969
  4970     12  AM-CONTROL-PRIMARY.
  4971         16  AM-COMPANY-CD                 PIC X.
  4972         16  AM-MSTR-CNTRL.
  4973             20  AM-CONTROL-A.
  4974                 24  AM-CARRIER            PIC X.
  4975                 24  AM-GROUPING.
  4976                     28 AM-GROUPING-PREFIX PIC XXX.
  4977                     28 AM-GROUPING-PRIME  PIC XXX.
  4978                 24  AM-STATE              PIC XX.
  4979                 24  AM-ACCOUNT.
  4980                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4981                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4982             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4983                                           PIC X(19).
  4984             20  AM-CNTRL-B.
  4985                 24  AM-EXPIRATION-DT      PIC XX.
  4986                 24  FILLER                PIC X(4).
  4987             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4988                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4989
  4990     12  AM-CONTROL-BY-VAR-GRP.
  4991         16  AM-COMPANY-CD-A1              PIC X.
  4992         16  AM-VG-CARRIER                 PIC X.
  4993         16  AM-VG-GROUPING                PIC X(6).
  4994         16  AM-VG-STATE                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  94
* EL154.cbl
  4995         16  AM-VG-ACCOUNT                 PIC X(10).
  4996         16  AM-VG-DATE.
  4997             20  AM-VG-EXPIRATION-DT       PIC XX.
  4998             20  FILLER                    PIC X(4).
  4999         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5000                                           PIC 9(11)      COMP-3.
  5001     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5002         16  FILLER                        PIC X(10).
  5003         16  AM-VG-KEY3.
  5004             20  AM-VG3-ACCOUNT            PIC X(10).
  5005             20  AM-VG3-EXP-DT             PIC XX.
  5006         16  FILLER                        PIC X(4).
  5007     12  AM-MAINT-INFORMATION.
  5008         16  AM-LAST-MAINT-DT              PIC XX.
  5009         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5010         16  AM-LAST-MAINT-USER            PIC X(4).
  5011         16  FILLER                        PIC XX.
  5012
  5013     12  AM-EFFECTIVE-DT                   PIC XX.
  5014     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5015
  5016     12  AM-PREV-DATES  COMP-3.
  5017         16  AM-PREV-EXP-DT                PIC 9(11).
  5018         16  AM-PREV-EFF-DT                PIC 9(11).
  5019
  5020     12  AM-REPORT-CODE-1                  PIC X(10).
  5021     12  AM-REPORT-CODE-2                  PIC X(10).
  5022
  5023     12  AM-CITY-CODE                      PIC X(4).
  5024     12  AM-COUNTY-PARISH                  PIC X(6).
  5025
  5026     12  AM-NAME                           PIC X(30).
  5027     12  AM-PERSON                         PIC X(30).
  5028     12  AM-ADDRS                          PIC X(30).
  5029     12  AM-CITY.
  5030         16  AM-ADDR-CITY                  PIC X(28).
  5031         16  AM-ADDR-STATE                 PIC XX.
  5032     12  AM-ZIP.
  5033         16  AM-ZIP-PRIME.
  5034             20  AM-ZIP-PRI-1ST            PIC X.
  5035                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5036             20  FILLER                    PIC X(4).
  5037         16  AM-ZIP-PLUS4                  PIC X(4).
  5038     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5039         16  AM-CAN-POSTAL-1               PIC XXX.
  5040         16  AM-CAN-POSTAL-2               PIC XXX.
  5041         16  FILLER                        PIC XXX.
  5042     12  AM-TEL-NO.
  5043         16  AM-AREA-CODE                  PIC 999.
  5044         16  AM-TEL-PRE                    PIC 999.
  5045         16  AM-TEL-NBR                    PIC 9(4).
  5046     12  AM-TEL-LOC                        PIC X.
  5047         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5048         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5049
  5050     12  AM-COMM-STRUCTURE.
  5051         16  AM-DEFN-1.
  5052             20  AM-AGT-COMMS       OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  95
* EL154.cbl
  5053                 24  AM-AGT.
  5054                     28  AM-AGT-PREFIX     PIC X(4).
  5055                     28  AM-AGT-PRIME      PIC X(6).
  5056                 24  AM-COM-TYP            PIC X.
  5057                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5058                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5059                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5060                 24  AM-RECALC-LV-INDIC    PIC X.
  5061                 24  AM-RETRO-LV-INDIC     PIC X.
  5062                 24  AM-GL-CODES           PIC X.
  5063                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5064                 24  FILLER                PIC X(01).
  5065         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5066             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5067                 24  FILLER                PIC X(11).
  5068                 24  AM-L-COMA             PIC XXX.
  5069                 24  AM-J-COMA             PIC XXX.
  5070                 24  AM-A-COMA             PIC XXX.
  5071                 24  FILLER                PIC X(6).
  5072
  5073     12  AM-COMM-CHANGE-STATUS             PIC X.
  5074         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5075
  5076     12  AM-CSR-CODE                       PIC X(4).
  5077
  5078     12  AM-BILLING-STATUS                 PIC X.
  5079         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5080         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5081     12  AM-AUTO-REFUND-SW                 PIC X.
  5082         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5083         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5084     12  AM-GPCD                           PIC 99.
  5085     12  AM-IG                             PIC X.
  5086         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5087         88  AM-HAS-GROUP                     VALUE '2'.
  5088     12  AM-STATUS                         PIC X.
  5089         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5090         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5091         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5092         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5093         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5094         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5095     12  AM-REMIT-TO                       PIC 99.
  5096     12  AM-ID-NO                          PIC X(11).
  5097
  5098     12  AM-CAL-TABLE                      PIC XX.
  5099     12  AM-LF-DEVIATION                   PIC XXX.
  5100     12  AM-AH-DEVIATION                   PIC XXX.
  5101     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5102     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5103     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5104     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5105     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5106     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5107
  5108     12  AM-USER-FIELDS.
  5109         16  AM-FLD-1                      PIC XX.
  5110         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  96
* EL154.cbl
  5111         16  AM-FLD-3                      PIC XX.
  5112         16  AM-FLD-4                      PIC XX.
  5113         16  AM-FLD-5                      PIC XX.
  5114
  5115     12  AM-1ST-PROD-DATE.
  5116         16  AM-1ST-PROD-YR                PIC XX.
  5117         16  AM-1ST-PROD-MO                PIC XX.
  5118         16  AM-1ST-PROD-DA                PIC XX.
  5119     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5120     12  AM-CERTS-PURGED-DATE.
  5121         16  AM-PUR-YR                     PIC XX.
  5122         16  AM-PUR-MO                     PIC XX.
  5123         16  AM-PUR-DA                     PIC XX.
  5124     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5125     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5126     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5127     12  AM-INACTIVE-DATE.
  5128         16  AM-INA-MO                     PIC 99.
  5129         16  AM-INA-DA                     PIC 99.
  5130         16  AM-INA-YR                     PIC 99.
  5131     12  AM-AR-HI-CERT-DATE                PIC XX.
  5132
  5133     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5134     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5135
  5136     12  AM-OB-PAYMENT-MODE                PIC X.
  5137         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5138         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5139         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5140         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5141
  5142     12  AM-AH-ONLY-INDICATOR              PIC X.
  5143         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5144         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5145
  5146     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5147
  5148     12  AM-OVER-SHORT.
  5149         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5150         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5151
  5152     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5153     12  AM-DCC-CLP-STATE                  PIC XX.
  5154
  5155     12  AM-RECALC-COMM                    PIC X.
  5156     12  AM-RECALC-REIN                    PIC X.
  5157
  5158     12  AM-REI-TABLE                      PIC XXX.
  5159     12  AM-REI-ET-LF                      PIC X.
  5160     12  AM-REI-ET-AH                      PIC X.
  5161     12  AM-REI-PE-LF                      PIC X.
  5162     12  AM-REI-PE-AH                      PIC X.
  5163     12  AM-REI-PRT-ST                     PIC X.
  5164     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5165     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5166     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5167     12  AM-REI-GROUP-A                    PIC X(6).
  5168     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  97
* EL154.cbl
  5169     12  AM-REI-PRT-OW                     PIC X.
  5170     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5171     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5172     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5173     12  AM-REI-GROUP-B                    PIC X(6).
  5174
  5175     12  AM-TRUST-TYPE                     PIC X(2).
  5176
  5177     12  AM-EMPLOYER-STMT-USED             PIC X.
  5178     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5179
  5180     12  AM-STD-AH-TYPE                    PIC XX.
  5181     12  AM-EARN-METHODS.
  5182         16  AM-EARN-METHOD-R              PIC X.
  5183             88 AM-REF-RL-R78                 VALUE 'R'.
  5184             88 AM-REF-RL-PR                  VALUE 'P'.
  5185             88 AM-REF-RL-MEAN                VALUE 'M'.
  5186             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5187         16  AM-EARN-METHOD-L              PIC X.
  5188             88 AM-REF-LL-R78                 VALUE 'R'.
  5189             88 AM-REF-LL-PR                  VALUE 'P'.
  5190             88 AM-REF-LL-MEAN                VALUE 'M'.
  5191             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5192         16  AM-EARN-METHOD-A              PIC X.
  5193             88 AM-REF-AH-R78                 VALUE 'R'.
  5194             88 AM-REF-AH-PR                  VALUE 'P'.
  5195             88 AM-REF-AH-MEAN                VALUE 'M'.
  5196             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5197             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5198             88 AM-REF-AH-NET                 VALUE 'N'.
  5199
  5200     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5201     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5202     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5203
  5204     12  AM-RET-Y-N                        PIC X.
  5205     12  AM-RET-P-E                        PIC X.
  5206     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5207     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5208     12  AM-RET-GRP                        PIC X(6).
  5209     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5210         16  AM-POOL-PRIME                 PIC XXX.
  5211         16  AM-POOL-SUB                   PIC XXX.
  5212     12  AM-RETRO-EARNINGS.
  5213         16  AM-RET-EARN-R                 PIC X.
  5214         16  AM-RET-EARN-L                 PIC X.
  5215         16  AM-RET-EARN-A                 PIC X.
  5216     12  AM-RET-ST-TAX-USE                 PIC X.
  5217         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5218         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5219     12  AM-RETRO-BEG-EARNINGS.
  5220         16  AM-RET-BEG-EARN-R             PIC X.
  5221         16  AM-RET-BEG-EARN-L             PIC X.
  5222         16  AM-RET-BEG-EARN-A             PIC X.
  5223     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5224     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5225
  5226     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  98
* EL154.cbl
  5227         16  AM-USER-SELECT-1              PIC X(10).
  5228         16  AM-USER-SELECT-2              PIC X(10).
  5229         16  AM-USER-SELECT-3              PIC X(10).
  5230         16  AM-USER-SELECT-4              PIC X(10).
  5231         16  AM-USER-SELECT-5              PIC X(10).
  5232
  5233     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5234
  5235     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5236
  5237     12  AM-RPT045A-SWITCH                 PIC X.
  5238         88  RPT045A-OFF                   VALUE 'N'.
  5239
  5240     12  AM-INSURANCE-LIMITS.
  5241         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5242         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5243
  5244     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5245         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5246
  5247     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5248         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5249         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5250
  5251     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5252
  5253     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5254     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5255     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5256     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5257     12  AM-DCC-UEF-STATE                  PIC XX.
  5258     12  FILLER                            PIC XXX.
  5259     12  AM-REPORT-CODE-3                  PIC X(10).
  5260*    12  FILLER                            PIC X(22).
  5261
  5262     12  AM-RESERVE-DATE.
  5263         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5264         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5265         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5266
  5267     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5268     12  AM-NOTIFICATION-TYPES.
  5269         16  AM-NOTIF-OF-LETTERS           PIC X.
  5270         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5271         16  AM-NOTIF-OF-REPORTS           PIC X.
  5272         16  AM-NOTIF-OF-STATUS            PIC X.
  5273
  5274     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5275         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5276         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5277         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5278         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5279
  5280     12  AM-BENEFIT-CONTROLS.
  5281         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5282             20  AM-BENEFIT-CODE           PIC XX.
  5283             20  AM-BENEFIT-TYPE           PIC X.
  5284             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page  99
* EL154.cbl
  5285             20  AM-BENEFIT-REM-TERM       PIC X.
  5286             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5287             20  FILLER                    PIC XX.
  5288         16  FILLER                        PIC X(80).
  5289
  5290     12  AM-TRANSFER-DATA.
  5291         16  AM-TRANSFERRED-FROM.
  5292             20  AM-TRNFROM-CARRIER        PIC X.
  5293             20  AM-TRNFROM-GROUPING.
  5294                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5295                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5296             20  AM-TRNFROM-STATE          PIC XX.
  5297             20  AM-TRNFROM-ACCOUNT.
  5298                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5299                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5300             20  AM-TRNFROM-DTE            PIC XX.
  5301         16  AM-TRANSFERRED-TO.
  5302             20  AM-TRNTO-CARRIER          PIC X.
  5303             20  AM-TRNTO-GROUPING.
  5304                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5305                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5306             20  AM-TRNTO-STATE            PIC XX.
  5307             20  AM-TRNTO-ACCOUNT.
  5308                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5309                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5310             20  AM-TRNTO-DTE              PIC XX.
  5311         16  FILLER                        PIC X(10).
  5312
  5313     12  AM-SAVED-REMIT-TO                 PIC 99.
  5314
  5315     12  AM-COMM-STRUCTURE-SAVED.
  5316         16  AM-DEFN-1-SAVED.
  5317             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5318                 24  AM-AGT-SV             PIC X(10).
  5319                 24  AM-COM-TYP-SV         PIC X.
  5320                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5321                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5322                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5323                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5324                 24  FILLER                PIC X.
  5325                 24  AM-GL-CODES-SV        PIC X.
  5326                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5327                 24  FILLER                PIC X.
  5328         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5329             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5330                 24  FILLER                PIC X(11).
  5331                 24  AM-L-COMA-SV          PIC XXX.
  5332                 24  AM-J-COMA-SV          PIC XXX.
  5333                 24  AM-A-COMA-SV          PIC XXX.
  5334                 24  FILLER                PIC X(6).
  5335
  5336     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5337         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5338            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5339            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5340            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5341
  5342     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 100
* EL154.cbl
  5343     12  FILLER                            PIC X(120).
  5344
  5345     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5346         16  AM-CONTROL-NAME               PIC X(30).
  5347         16  AM-EXECUTIVE-ONE.
  5348             20  AM-EXEC1-NAME             PIC X(15).
  5349             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5350                                                          COMP-3.
  5351             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5352                                                          COMP-3.
  5353         16  AM-EXECUTIVE-TWO.
  5354             20  AM-EXEC2-NAME             PIC X(15).
  5355             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5356                                                          COMP-3.
  5357             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5358                                                          COMP-3.
  5359
  5360     12  AM-RETRO-ADDITIONAL-DATA.
  5361         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5362         16  AM-RETRO-PREM-P-E             PIC X.
  5363         16  AM-RETRO-CLMS-P-I             PIC X.
  5364         16  AM-RETRO-RET-BRACKET-LF.
  5365             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5366                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5367                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5368             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5369                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5370                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5371             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5372                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5373                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5374         16  AM-RETRO-RET-BRACKET-AH.
  5375             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5376                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5377                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5378                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5379             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5380                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5381                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5382             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5383                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5384                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5385
  5386     12  AM-COMMENTS.
  5387         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5388
  5389     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5390         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5391         16  AM-FLI-BILLING-CODE           PIC X.
  5392         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5393         16  AM-FLI-UNITED-IDENT           PIC X.
  5394         16  AM-FLI-INTEREST-LOST-DATA.
  5395             20  AM-FLI-BANK-NO            PIC X(5).
  5396             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5397             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5398             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5399         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5400             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 101
* EL154.cbl
  5401             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5402             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5403         16  FILLER                        PIC X(102).
  5404
  5405     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5406         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5407             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5408             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5409             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5410             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5411             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5412         16  FILLER                          PIC X(10).
  5413******************************************************************
  5414*                            COPY ERCPDEF.
  5415******************************************************************
  5416*                                                                *
  5417*                                                                *
  5418*                            ERCPDEF.                            *
  5419*                                                                *
  5420*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  5421*                                                                *
  5422*    FILE TYPE = VSAM,KSDS                                       *
  5423*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  5424*                                                                *
  5425*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  5426*                                                                *
  5427*    LOG = YES                                                   *
  5428*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5429******************************************************************
  5430 01  PRODUCT-MASTER.
  5431    12  PD-RECORD-ID                 PIC X(02).
  5432        88  VALID-PD-ID                  VALUE 'PD'.
  5433    12  PD-CONTROL-PRIMARY.
  5434        16  PD-COMPANY-CD            PIC X.
  5435        16  PD-STATE                 PIC XX.
  5436        16  PD-PRODUCT-CD            PIC XXX.
  5437        16  PD-FILLER                PIC X(7).
  5438        16  PD-BEN-TYPE              PIC X.
  5439        16  PD-BEN-CODE              PIC XX.
  5440        16  PD-PROD-EXP-DT           PIC XX.
  5441    12  FILLER                       PIC X(50).
  5442    12  PD-PRODUCT-DATA OCCURS 8.
  5443        16  PD-PROD-CODE             PIC X.
  5444            88  PD-PROD-LIFE           VALUE 'L'.
  5445            88  PD-PROD-PROP           VALUE 'P'.
  5446            88  PD-PROD-AH             VALUE 'A'.
  5447            88  PD-PROD-IU             VALUE 'I'.
  5448            88  PD-PROD-GAP            VALUE 'G'.
  5449        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  5450        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  5451        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  5452        16  PD-MAX-TERM              PIC S999        COMP-3.
  5453        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  5454        16  FILLER                   PIC X.
  5455        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  5456        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  5457        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  5458        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 102
* EL154.cbl
  5459        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  5460        16  PD-REC-CRIT-PERIOD       PIC X.
  5461        16  PD-RTW-MOS               PIC 99.
  5462        16  FILLER                   PIC X(5).
  5463    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  5464    12  PD-TERM-LIMITS OCCURS 15.
  5465        16  PD-LOW-TERM              PIC S999        COMP-3.
  5466        16  PD-HI-TERM               PIC S999        COMP-3.
  5467*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  5468    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  5469        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  5470        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  5471    12  PD-EARN-FACTORS.
  5472        16  FILLER OCCURS 15.
  5473            20  FILLER OCCURS 15.
  5474                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  5475    12  PD-PRODUCT-DESC              PIC X(80).
  5476    12  PD-TRUNCATED                 PIC X.
  5477    12  FILLER                       PIC X(59).
  5478    12  PD-MAINT-INFORMATION.
  5479        16  PD-LAST-MAINT-DT         PIC X(02).
  5480        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  5481        16  PD-LAST-MAINT-BY         PIC X(04).
  5482*                            copy ELCCRTT.
  5483******************************************************************
  5484*                                                                *
  5485*                            ELCCRTT.                            *
  5486*                                                                *
  5487*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5488*                                                                *
  5489*   FILE TYPE = VSAM,KSDS                                        *
  5490*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5491*                                                                *
  5492*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5493*                                                                *
  5494*   LOG = YES                                                    *
  5495*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5496******************************************************************
  5497*                   C H A N G E   L O G
  5498*
  5499* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5500*-----------------------------------------------------------------
  5501*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5502* EFFECTIVE    NUMBER
  5503*-----------------------------------------------------------------
  5504* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5505* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5506* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5507* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5508* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5509******************************************************************
  5510
  5511 01  CERTIFICATE-TRAILERS.
  5512     12  CS-RECORD-ID                      PIC XX.
  5513         88  VALID-CS-ID                      VALUE 'CS'.
  5514
  5515     12  CS-CONTROL-PRIMARY.
  5516         16  CS-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 103
* EL154.cbl
  5517         16  CS-CARRIER                    PIC X.
  5518         16  CS-GROUPING                   PIC X(6).
  5519         16  CS-STATE                      PIC XX.
  5520         16  CS-ACCOUNT                    PIC X(10).
  5521         16  CS-CERT-EFF-DT                PIC XX.
  5522         16  CS-CERT-NO.
  5523             20  CS-CERT-PRIME             PIC X(10).
  5524             20  CS-CERT-SFX               PIC X.
  5525         16  CS-TRAILER-TYPE               PIC X.
  5526             88  COMM-TRLR           VALUE 'A'.
  5527             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5528             88  CERT-DATA-TRLR      VALUE 'C'.
  5529
  5530     12  CS-DATA-AREA                      PIC X(516).
  5531
  5532     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5533         16  CS-BANK-COMMISSION-AREA.
  5534             20  CS-BANK-COMMS       OCCURS 10.
  5535                 24  CS-AGT                PIC X(10).
  5536                 24  CS-COM-TYP            PIC X.
  5537                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5538                 24  CS-RECALC-LV-INDIC    PIC X.
  5539                 24  FILLER                PIC X(10).
  5540         16  FILLER                        PIC X(256).
  5541
  5542     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5543****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5544****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5545         16  CS-MB-CLAIM-DATA OCCURS 2.
  5546             20  FILLER OCCURS 10.
  5547                 24  CS-CLAIM-TYPE         PIC X.
  5548                     88  CS-AH-CLM           VALUE 'A'.
  5549                     88  CS-IU-CLM           VALUE 'I'.
  5550                     88  CS-GP-CLM           VALUE 'G'.
  5551                     88  CS-LF-CLM           VALUE 'L'.
  5552                     88  CS-PR-CLM           VALUE 'P'.
  5553                 24  CS-BANK               PIC S999 COMP-3.
  5554                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5555                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5556                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5557         16  FILLER                        PIC X(216).
  5558     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5559         16  CS-VIN-NUMBER                 PIC X(17).
  5560         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5561         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5562         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5563         16  FILLER                        PIC X(496).
  5564******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 104
* EL154.cbl
  5566*                            COPY MPCPLCY.
  5567******************************************************************
  5568*                                                                *
  5569*                           MPCPLCY                              *
  5570*                            VMOD=1.024                          *
  5571*                                                                *
  5572*   FILE DESCRIPTION = POLICY MASTER                             *
  5573*                                                                *
  5574*   FILE TYPE = VSAM,KSDS                                        *
  5575*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  5576*                                                                *
  5577*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  5578*       ALTERNATE PATH2 = ** NOT USED **                         *
  5579*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5580*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  5581*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  5582*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  5583*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  5584*                                                                *
  5585*   LOG = YES                                                    *
  5586*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5587******************************************************************
  5588**WARNING*********************************************************
  5589**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  5590**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  5591**                             MPCPHSTD                          *
  5592**                             MPCPHSTC                          *
  5593**                             MPCPHSTT                          *
  5594**                                                               *
  5595******************************************************************
  5596
  5597 01  POLICY-MASTER.
  5598     12  PM-RECORD-ID                      PIC XX.
  5599         88  VALID-PM-ID                      VALUE 'PM'.
  5600
  5601******************************************************************
  5602*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  5603******************************************************************
  5604
  5605     12  PM-CONTROL-PRIMARY.
  5606         16  PM-PRODUCER-PRIMARY.
  5607             20  PM-PROD-PRIMARY.
  5608                 24  PM-COMPANY-CD         PIC X.
  5609                 24  PM-CGSP-KEY.
  5610                     28  PM-CARRIER        PIC X.
  5611                     28  PM-GROUPING.
  5612                         32  PM-GROUPING-PREFIX
  5613                                           PIC X(3).
  5614                         32  PM-GROUPING-PRIME
  5615                                           PIC X(3).
  5616                     28  PM-STATE          PIC X(2).
  5617                     28  PM-PRODUCER.
  5618                         32  PM-PRODUCER-PREFIX
  5619                                           PIC X(4).
  5620                         32  PM-PRODUCER-PRIME
  5621                                           PIC X(6).
  5622             20  PM-POLICY-EFF-DT              PIC XX.
  5623         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 105
* EL154.cbl
  5624             20  PM-REFNO-PRIME            PIC X(18).
  5625             20  PM-REFNO-SFX              PIC XX.
  5626
  5627******************************************************************
  5628*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  5629******************************************************************
  5630
  5631     12  PM-CONTROL-BY-SSN.
  5632         16  PM-COMPANY-CD-A3              PIC X.
  5633         16  PM-SOC-SEC-NO.
  5634             20  PM-SSN-STATE              PIC XX.
  5635             20  PM-SSN-PRODUCER           PIC X(6).
  5636             20  PM-SSN-LN3.
  5637                 25  PM-INSURED-INITIALS-A3.
  5638                     30 PM-INSURED-INITIAL1-A3 PIC X.
  5639                     30 PM-INSURED-INITIAL2-A3 PIC X.
  5640                 25 PM-PART-LAST-NAME-A3         PIC X.
  5641         16  PM-DATE-A3                     PIC XX.
  5642         16  PM-TIME-A3                     PIC S9(04)   COMP.
  5643
  5644******************************************************************
  5645*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  5646******************************************************************
  5647
  5648     12  PM-CONTROL-BY-POLICY-NO.
  5649         16  PM-COMPANY-CD-A4              PIC X.
  5650         16  PM-POLICY-NO-A4.
  5651             20  PM-POLICY-PRIME-A4        PIC X(18).
  5652             20  PM-POLICY-SFX-A4          PIC XX.
  5653         16  PM-DATE-A4                    PIC XX.
  5654         16  PM-TIME-A4                    PIC S9(04)   COMP.
  5655
  5656******************************************************************
  5657*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  5658******************************************************************
  5659
  5660     12  PM-CONTROL-BY-ACCOUNT.
  5661         16  PM-COMPANY-CD-A5              PIC X.
  5662         16  PM-BANK-ACCOUNT-NUMBER        PIC X(20).
  5663         16  PM-DATE-A5                    PIC XX.
  5664         16  PM-TIME-A5                    PIC S9(07)   COMP.
  5665
  5666******************************************************************
  5667*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  5668******************************************************************
  5669
  5670     12  PM-CONTROL-BY-TRANSIT.
  5671         16  PM-COMPANY-CD-A6              PIC X.
  5672         16  PM-BANK-TRANSIT-NUMBER.
  5673             20  PM-FEDERAL-NUMBER         PIC X(4).
  5674             20  PM-BANK-NUMBER            PIC X(4).
  5675         16  PM-DATE-A6                    PIC XX.
  5676         16  PM-TIME-A6                    PIC S9(07)   COMP.
  5677
  5678******************************************************************
  5679*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  5680******************************************************************
  5681
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 106
* EL154.cbl
  5682     12  PM-CONTROL-BY-LOAN-NO.
  5683         16  PM-COMPANY-CD-A7              PIC X.
  5684         16  PM-LOAN-NUMBER                PIC X(20).
  5685         16  PM-DATE-A7                    PIC XX.
  5686         16  PM-TIME-A7                    PIC S9(07)   COMP.
  5687
  5688******************************************************************
  5689*                 FILE SYNCHRONIZATION DATA                      *
  5690******************************************************************
  5691
  5692     12  FILLER                            PIC X(05).
  5693     12  PM-FILE-SYNCH-DATA.
  5694         16  PM-LAST-CHANGE-DT             PIC XX.
  5695         16  PM-LAST-CHANGE-TIME           PIC S9(7)    COMP.
  5696         16  PM-LAST-CHANGE-PROCESSOR      PIC X(4).
  5697     12  FILLER                            PIC X(05).
  5698
  5699******************************************************************
  5700*                    INSUREDS PROFILE DATA                       *
  5701******************************************************************
  5702
  5703     12  PM-INSURED-PROFILE-DATA.
  5704         16  PM-INSURED-NAME.
  5705             20  PM-INSURED-LAST-NAME     PIC X(15).
  5706             20  PM-INSURED-FIRST-NAME.
  5707                 24  PM-INSURED-1ST-INIT PIC X.
  5708                 24  FILLER               PIC X(9).
  5709             20  PM-INSURED-MIDDLE-INIT PIC X.
  5710         16  PM-INSURED-ADDRESS.
  5711             20  PM-ADDRESS-LINE-1         PIC X(30).
  5712             20  PM-ADDRESS-LINE-2         PIC X(30).
  5713             20  PM-CITY                   PIC X(25).
  5714             20  PM-RESIDENT-STATE         PIC XX.
  5715             20  PM-ZIP-CD.
  5716                 24  PM-ZIP-FIRST-FIVE     PIC X(5).
  5717                 24  PM-ZIP-PLUS-FOUR      PIC X(4).
  5718         16  PM-INSURED-PERSONAL.
  5719             20  PM-INSURED-OCC-CLASS      PIC X.
  5720                 88  PM-PREFERRED            VALUE '1'.
  5721                 88  PM-STANDARD             VALUE '2'.
  5722                 88  PM-HAZARDOUS            VALUE '3'.
  5723                 88  PM-VERY-HAZARDOUS       VALUE '4'.
  5724                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  5725                 88  PM-NOT-OCC              VALUE '6'.
  5726                 88  PM-OCC-UNKNOWN          VALUE '9'.
  5727             20  PM-INSURED-OCC-CD         PIC X(3).
  5728             20  PM-INSURED-OCC-CD-NUM REDEFINES
  5729                 PM-INSURED-OCC-CD         PIC 9(3).
  5730             20  PM-INSURED-SEX            PIC X.
  5731                 88  PM-INSURED-SEX-MALE      VALUE 'M'.
  5732                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  5733             20  PM-INSURED-BIRTH-DT       PIC XX.
  5734             20  PM-INSURED-ISSUE-AGE      PIC S9(3)     COMP-3.
  5735             20  PM-INSURED-HEIGHT-FT      PIC S9(3)     COMP-3.
  5736             20  PM-INSURED-HEIGHT-IN      PIC S9(3)     COMP-3.
  5737             20  PM-INSURED-WEIGHT         PIC S9(3)     COMP-3.
  5738             20  PM-INSURED-BIRTH-STATE PIC XX.
  5739             20  PM-INSURED-PHONE-NO       PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 107
* EL154.cbl
  5740             20  PM-INSURED-RATED-AGE      PIC S9(3)     COMP-3.
  5741         16  PM-INS-LANGUAGE-IND           PIC X(01).
  5742             88  PM-ENGLISH                           VALUE 'E'.
  5743             88  PM-FRENCH                            VALUE 'F'.
  5744             88  PM-SPANISH                           VALUE 'S'.
  5745         16  PM-INSURED-TOT-BENEFIT        PIC S9(7)V99  COMP-3.
  5746
  5747         16  PM-INSURED-AGE-IND            PIC X(01).
  5748             88  PM-INSURED-AGE-75-REACHED            VALUE 'Y'.
  5749     12  FILLER                            PIC X(13).
  5750
  5751******************************************************************
  5752*                JOINT INSUREDS PROFILE DATA                     *
  5753******************************************************************
  5754
  5755     12  PM-JOINT-PROFILE-DATA.
  5756         16  PM-JOINT-NAME.
  5757             20  PM-JOINT-LAST-NAME        PIC X(15).
  5758             20  PM-JOINT-FIRST-NAME.
  5759                 24  PM-JOINT-1ST-INIT     PIC X.
  5760                 24  FILLER                PIC X(9).
  5761             20  PM-JOINT-MIDDLE-INIT      PIC X.
  5762         16  PM-JOINT-SOC-SEC-NO.
  5763             20  PM-JT-SSN-STATE           PIC XX.
  5764             20  PM-JT-SSN-PRODUCER        PIC X(6).
  5765             20  PM-JT-SSN-LN3.
  5766                 25  PM-JT-INSURED-INITIALS-A3.
  5767                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  5768                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  5769                 25 PM-JT-PART-LAST-NAME-A3        PIC X.
  5770         16  PM-JOINT-PERSONAL.
  5771             20  PM-JOINT-OCC-CLASS        PIC X.
  5772                 88 PM-JNT-PREFERRED          VALUE '1'.
  5773                 88 PM-JNT-STANDARD           VALUE '2'.
  5774                 88 PM-JNT-HAZARDOUS          VALUE '3'.
  5775                 88 PM-JNT-VERY-HAZARDOUS     VALUE '4'.
  5776                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  5777                 88 PM-JNT-NOT-OCC            VALUE '6'.
  5778                 88 PM-JNT-OCC-UNKNOWN        VALUE '9'.
  5779             20  PM-JOINT-OCC-CD           PIC X(3).
  5780             20  PM-JOINT-SEX              PIC X.
  5781                 88  PM-JOINT-SEX-MALE        VALUE 'M'.
  5782                 88  PM-JOINT-SEX-FEMALE      VALUE 'F'.
  5783             20  PM-JOINT-BIRTH-DT         PIC XX.
  5784             20  PM-JOINT-ISSUE-AGE        PIC S9(3)     COMP-3.
  5785             20  PM-JOINT-HEIGHT-FT        PIC S9(3)     COMP-3.
  5786             20  PM-JOINT-HEIGHT-IN        PIC S9(3)     COMP-3.
  5787             20  PM-JOINT-WEIGHT           PIC S9(3)     COMP-3.
  5788             20  PM-JOINT-BIRTH-STATE      PIC XX.
  5789             20  PM-JOINT-RATED-AGE        PIC S9(3)     COMP-3.
  5790         16  PM-JOINT-TOT-BENEFIT          PIC S9(7)V99  COMP-3.
  5791         16  PM-JOINT-AGE-IND              PIC X(01).
  5792             88  PM-JOINT-AGE-75-REACHED              VALUE 'Y'.
  5793
  5794     12  FILLER                            PIC X(12).
  5795
  5796******************************************************************
  5797*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 108
* EL154.cbl
  5798******************************************************************
  5799
  5800     12  PM-INS-COVERAGE-DATA.
  5801         16  PM-FREE-PERIOD                PIC S9(03)    COMP-3.
  5802         16  PM-LOAN-TERM                  PIC S9(3)     COMP-3.
  5803         16  PM-LOAN-APR                   PIC S9V9999   COMP-3.
  5804         16  PM-LOAN-DT                    PIC XX.
  5805         16  PM-LOAN-PYMT                  PIC S9(5)V99  COMP-3.
  5806         16  PM-LOAN-BALC                  PIC S9(7)V99  COMP-3.
  5807         16  PM-INS-BENEFIT-MONTHS         PIC S9(3)     COMP-3.
  5808         16  PM-INS-MONTH-BENEFIT          PIC S9(7)V99  COMP-3.
  5809         16  PM-INS-TOTAL-BENEFIT          PIC S9(7)V99  COMP-3.
  5810         16  PM-INS-PLAN-TYPE              PIC X.
  5811             88  PM-AH-MORT-PLAN              VALUE 'A'.
  5812             88  PM-AD-D-MORT-PLAN            VALUE 'E'.
  5813             88  PM-DISMEM-MORT-PLAN          VALUE 'D'.
  5814             88  PM-LIFE-MORT-PLAN            VALUE 'L'.
  5815         16  PM-INS-PLAN-CD                PIC XX.
  5816         16  PM-INS-PLAN-REVISION          PIC X(3).
  5817         16  PM-INS-POLICY-FORM            PIC X(12).
  5818         16  PM-INS-MSTR-POLICY.
  5819             20  PM-FREE-TYPE              PIC X(04).
  5820             20  FILLER                    PIC X(08).
  5821         16  PM-INS-MSTR-APP.
  5822             20  FILLER                    PIC X(11).
  5823             20  PM-INS-B-C-TYPE           PIC X(01).
  5824         16  PM-INS-RATE-CD                PIC X(5).
  5825         16  PM-INS-SEX-RATING             PIC X.
  5826             88  PM-NOT-SEX-RATED              VALUE '1'.
  5827             88  PM-SEX-RATED                  VALUE '2'.
  5828         16  PM-INS-SUBSTANDARD-PCT        PIC S9V9999   COMP-3.
  5829         16  PM-INS-SUBSTANDARD-TYPE       PIC X.
  5830         16  PM-INS-TERMINATION-DT         PIC XX.
  5831         16  PM-INS-MONTH-PREMIUM      PIC S9(5)V999999  COMP-3.
  5832         16  PM-INS-CALC-MO-PREM       PIC S9(5)V999999  COMP-3.
  5833         16  PM-REINSURANCE-TABLE          PIC X(3).
  5834         16  PM-MORTALITY-CD               PIC X(4).
  5835         16  PM-INS-TYPE                   PIC X.
  5836             88  PM-INDIVIDUAL                VALUES ARE '1' 'I'.
  5837             88  PM-GROUP                     VALUES ARE '2' 'G'.
  5838         16  PM-LOAN-OFFICER               PIC X(5).
  5839         16  PM-POLICY-FEE                 PIC S9(3)V99 COMP-3.
  5840         16  PM-DEPENDENT-COUNT            PIC S99      COMP-3.
  5841         16  PM-CWA-AMOUNT                 PIC S9(5)V99  COMP-3.
  5842         16  PM-LAST-AUTO-RERATE-DT        PIC XX.
  5843         16  PM-PREM-FINANCED-SW           PIC X.
  5844             88  PM-PREM-FINANCED              VALUE 'Y'.
  5845             88  PM-PREM-NOT-FINANCED          VALUE 'N'.
  5846
  5847         16  PM-INS-TERM-LETTER-IND        PIC X.
  5848             88  PM-TERM-INITIALIZED           VALUE 'Y'.
  5849         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99     COMP-3.
  5850     12  FILLER                            PIC X(11).
  5851
  5852******************************************************************
  5853*                    POLICY BILLING DATA                         *
  5854******************************************************************
  5855
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 109
* EL154.cbl
  5856     12  PM-BILLING-DATA.
  5857         16  PM-BILLING-MODE               PIC X(1).
  5858             88  PM-ANNUAL                    VALUE '1'.
  5859             88  PM-SEMI-ANNUAL               VALUE '2'.
  5860             88  PM-QUARTERLY                 VALUE '3'.
  5861             88  PM-MONTHLY                   VALUE '4'.
  5862             88  PM-BI-MONTHLY                VALUE '5'.
  5863             88  PM-SINGLE-PREM               VALUE '6'.
  5864         16  PM-BILLING-SCHEDULE           PIC X(1).
  5865         16  PM-BILLING-SW                 PIC X(1).
  5866             88  PM-FIRST-BILLING             VALUE 'Y'.
  5867             88  PM-PAID-IN-ADVANCE           VALUE 'A'.
  5868             88  PM-POLICY-FEE-REFUNDED       VALUE 'F'.
  5869         16  PM-BILLING-TYPE               PIC X(1).
  5870             88  PM-LIST-BILL                 VALUE '1'.
  5871             88  PM-TAPE-BILL                 VALUE '2'.
  5872             88  PM-TAPE-LIST-BILL            VALUE '3'.
  5873             88  PM-GROUP-BILL          VALUE ARE '1' '2' '3'.
  5874             88  PM-DIRECT-BILL               VALUE '4'.
  5875             88  PM-PAC-BILL            VALUE ARE '5' 'C' 'S'.
  5876             88  PM-CHARGE-CARD-BILL          VALUE '6'.
  5877             88  PM-INDIV-BILL
  5878                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  5879             88  PM-GRP-PLCY-BILL             VALUE '7'.
  5880             88  PM-GRP-PLCY-PAC              VALUE '8'.
  5881             88  PM-GRP-PLCY-CR-CRD           VALUE '9'.
  5882             88  PM-GRP-PLCY            VALUE ARE '7' '8' '9'.
  5883             88  PM-GRP-PROD                  VALUE 'A'.
  5884             88  PM-EFT-CHECKING              VALUE 'C'.
  5885             88  PM-EFT-SAVINGS               VALUE 'S'.
  5886         16  PM-PAYMENT-AMT                PIC S9(5)V99  COMP-3.
  5887         16  PM-OVER-SHORT-AMT             PIC S9(5)V99  COMP-3.
  5888         16  PM-LAST-BILL-DT               PIC XX.
  5889         16  PM-LAST-BILL-AMT              PIC S9(5)V99  COMP-3.
  5890         16  PM-BILL-TO-DT                 PIC XX.
  5891         16  PM-LAST-PYMT-DT               PIC XX.
  5892         16  PM-PAID-TO-DT                 PIC XX.
  5893         16  PM-PYMT-INVOICE-NUMBER        PIC X(6).
  5894         16  PM-MONTHS-PAID                PIC S9(3)     COMP-3.
  5895         16  PM-TOTAL-PREM-RECVD           PIC S9(7)V99  COMP-3.
  5896         16  PM-BILLING-GROUPING-CODE      PIC X(6).
  5897         16  PM-CHARGE-CARD-EXP-DT         PIC X(2).
  5898         16  PM-CHARGE-CARD-TYPE           PIC X(2).
  5899             88  PM-VISA                      VALUE 'VI'.
  5900             88  PM-MSTR-CARD                 VALUE 'MC'.
  5901             88  PM-DINERS-CLUB               VALUE 'DN'.
  5902             88  PM-DISCOVER                  VALUE 'DS'.
  5903             88  PM-CARTE-BLANCHE             VALUE 'CB'.
  5904             88  PM-AMERICAN-EXPRESS          VALUE 'AE'.
  5905         16  PM-BILL-INVOICE-NUMBER        PIC X(6).
  5906         16  PM-BILL-DAY                   PIC S99       COMP-3.
  5907         16  PM-RES-PREM-TAX           PIC S9(3)V999999  COMP-3.
  5908     12  FILLER                            PIC X(15).
  5909
  5910******************************************************************
  5911*                     CLAIM PAYMENT DATA                         *
  5912******************************************************************
  5913
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 110
* EL154.cbl
  5914     12  PM-CLAIM-PAYMENT-DATA.
  5915         16  PM-CLAIM-BENEFICIARY-NAME     PIC X(25).
  5916         16  PM-CLAIM-INTERFACE-SW         PIC X.
  5917             88  PM-NO-CLAIM-ATTACHED         VALUE SPACE.
  5918             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  5919             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  5920             88  PM-CLAIM-CLOSED              VALUE '3'.
  5921             88  PM-ACTIVE-CLAIM              VALUE '1' '2'.
  5922             88  PM-CLAIM-ATTACHED            VALUE '1' '2' '3'.
  5923         16  PM-CLAIM-INCURRED-DT          PIC XX.
  5924         16  PM-CLAIM-PAID-TO-DT           PIC XX.
  5925         16  PM-CLAIM-PAYMENT-CNT          PIC S9(3)     COMP-3.
  5926         16  PM-CLAIM-LAST-PAYMENT-AMT     PIC S9(7)V99  COMP-3.
  5927         16  PM-CLAIM-EXPENSES-ITD         PIC S9(7)V99  COMP-3.
  5928         16  PM-CLAIM-PAYMENTS-ITD         PIC S9(7)V99  COMP-3.
  5929         16  PM-CLAIM-ACCUMULATOR          PIC S9(7)V99  COMP-3.
  5930         16  PM-CLAIM-ATTACH-CNT           PIC S9(3)     COMP-3.
  5931         16  PM-CLAIM-LIFE-ITD             PIC S9(7)V99  COMP-3.
  5932         16  PM-CLAIM-AH-ITD               PIC S9(7)V99  COMP-3.
  5933         16  PM-CLAIM-RIDER-ITD            PIC S9(7)V99  COMP-3.
  5934
  5935     12  FILLER                            PIC X(03).
  5936
  5937******************************************************************
  5938*                POLICY STATUS AND DISPOSITION                   *
  5939******************************************************************
  5940
  5941     12  PM-STATUS-DISPOSITION-DATA.
  5942         16  PM-ISSUE-EOM-DT               PIC XX.
  5943         16  PM-REPLACEMENT-SWITCH         PIC X.
  5944         16  PM-APPL-SIGN-DT               PIC XX.
  5945         16  PM-UNDERWRITER                PIC X(3).
  5946         16  PM-ENTRY-PROCESSOR            PIC X(4).
  5947         16  PM-ENTRY-STATUS               PIC X.
  5948             88  PM-NORMAL                    VALUE '1'.
  5949             88  PM-TAKE-OVER                 VALUE '2'.
  5950             88  PM-CONVERSION                VALUE '4'.
  5951             88  PM-RE-ISSUE                  VALUE '5'.
  5952             88  PM-REINSURANCE-ONLY          VALUE '9'.
  5953         16  PM-ENTRY-DT                   PIC XX.
  5954         16  PM-ENTRY-TIME                 PIC S9(7) COMP-3.
  5955         16  PM-EXIT-DT                    PIC XX.
  5956         16  PM-CURRENT-STATUS             PIC X.
  5957             88  PM-LAPSE                     VALUE '0'.
  5958             88  PM-ACTIVE                    VALUE '1'.
  5959             88  PM-PENDING-ISSUE             VALUE '2'.
  5960             88  PM-DECLINED                  VALUE '3'.
  5961             88  PM-PENDING-CANCEL            VALUE '4'.
  5962             88  PM-PENDING-ISSUE-ERROR       VALUE '5'.
  5963             88  PM-CLAIM-APPLIED             VALUE '6'.
  5964             88  PM-CANCEL                    VALUE '7'.
  5965             88  PM-PENDING-UNWTR-REVW        VALUE '8'.
  5966             88  PM-PENDING-CANCEL-ERROR      VALUE '9'.
  5967             88  PM-CANCEL-TRANSFER           VALUE 'C'.
  5968             88  PM-CLAIM-SETTLEMENT          VALUE 'F'.
  5969             88  PM-TERMINATE                 VALUE 'T'.
  5970** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  5971** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 111
* EL154.cbl
  5972** THESE GROUPS.
  5973             88  PM-TYPE-STAT-1
  5974                     VALUES ARE '0' '1' '4' '6' '7' '9'
  5975                                'C' 'F' 'T'.
  5976             88  PM-TYPE-STAT-2
  5977                     VALUES ARE '2' '3' '5' '8'.
  5978             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  5979             88  PM-PENDING-STATUS
  5980                                VALUES ARE '2' '4' '5' '8' '9'.
  5981             88  PM-PENDING-ISSUE-STATUS
  5982                                VALUES ARE '2' '5' '8'.
  5983             88  PM-CANCEL-STATUS
  5984                                VALUES ARE '4' '7' '9' 'C'.
  5985         16  PM-CANCEL-CAUSE-CD            PIC X(3).
  5986         16  PM-CANCEL-DT                  PIC XX.
  5987         16  PM-REFUND-AMT                 PIC S9(5)V99  COMP-3.
  5988         16  PM-CALC-REFUND-AMT            PIC S9(5)V99  COMP-3.
  5989         16  PM-DECLINE-CD                 PIC X(3).
  5990         16  PM-DECLINE-DT                 PIC XX.
  5991         16  PM-LAST-LAPSE-DT              PIC XX.
  5992         16  PM-LAST-REINSTATE-DT          PIC XX.
  5993         16  PM-SECURITY-ACCESS-CODE       PIC X.
  5994         16  PM-PREV-CONTROL-PRIMARY.
  5995             20  PM-PREV-COMPANY-CD             PIC X.
  5996             20  PM-PREV-CARRIER                PIC X.
  5997             20  PM-PREV-GROUPING.
  5998                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  5999                 24  PM-PREV-GROUPING-PRIME     PIC X(3).
  6000             20  PM-PREV-STATE                  PIC XX.
  6001             20  PM-PREV-PRODUCER.
  6002                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6003                 24  PM-PREV-PRODUCER-PRIME     PIC X(6).
  6004             20  PM-PREV-POLICY-EFF-DT          PIC XX.
  6005             20  PM-PREV-REFERENCE-NUMBER.
  6006                 24  PM-PREV-REFNO-PRIME        PIC X(18).
  6007                 24  PM-PREV-REFNO-SFX          PIC XX.
  6008         16  PM-ACTION-DT                  PIC XX.
  6009         16  PM-ACTION-CODE                PIC X(3).
  6010         16  PM-ACTION-DT-2                PIC XX.
  6011         16  PM-ACTION-CODE-2              PIC X(3).
  6012         16  PM-ACTION-DT-3                PIC XX.
  6013         16  PM-ACTION-CODE-3              PIC X(3).
  6014         16  PM-ACTION-DT-4                PIC XX.
  6015         16  PM-ACTION-CODE-4              PIC X(3).
  6016         16  PM-ACTION-DT-5                PIC XX.
  6017         16  PM-ACTION-CODE-5              PIC X(3).
  6018
  6019         16  PM-KEY-CHANGE                 PIC X.
  6020                 88  PM-NO-KEY-CHG      VALUES ARE ' ' 'N'.
  6021                 88  PM-KEY-CHG              VALUE 'Y'.
  6022         16  PM-KEY-CHANGE-DT              PIC XX.
  6023
  6024         16  PM-RTI-INDICATOR              PIC X.
  6025         16  PM-REASON-CODE                PIC X(3).
  6026         16  PM-IN-OUT-PROCESSING-IND      PIC X(1).
  6027             88  PM-IN-OUT-PROCESSING      VALUE 'Y'.
  6028             88  PM-NOT-IN-OUT-PROCESSING  VALUE SPACES.
  6029
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 112
* EL154.cbl
  6030     12  FILLER                            PIC X(12).
  6031
  6032******************************************************************
  6033*                 AGENT AND COMMISSION DATA                      *
  6034******************************************************************
  6035
  6036     12  PM-COMMISSION-DATA.
  6037         16  PM-REMIT-TO                   PIC S9(3) COMP-3.
  6038         16  PM-COMM-CHANGE-SW             PIC X.
  6039                 88  PM-COMMISSION-CHANGE     VALUE 'Y'.
  6040         16  PM-AGENT-INFORMATION OCCURS     5 TIMES.
  6041             20  PM-AGENT-NUMBER           PIC X(10).
  6042             20  PM-AGENT-TYPE             PIC X.
  6043                 88  PM-PRODUCER-LEVEL-AGENT
  6044                                              VALUES ARE 'C' 'D'.
  6045                 88  PM-AGENT-GROSS           VALUE 'C'.
  6046                 88  PM-AGENT-REINS           VALUE 'R'.
  6047                 88  PM-AGENT-GROSS-REINS     VALUE 'D'.
  6048                 88  PM-OVERWRITE-GROSS       VALUE 'O'.
  6049                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  6050                 88  PM-OVERWRITE-REINS       VALUE 'T'.
  6051                 88  PM-REINS-ONLY            VALUE 'W'.
  6052             20  PM-COMMISSION-BILL-PAID PIC X(1).
  6053                 88  PM-GENERATE-BILL         VALUE 'B'.
  6054                 88  PM-GENERATE-PAID         VALUE 'P'.
  6055             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  6056             20  PM-COMP-1ST-YEAR-TYPE     PIC X(1).
  6057                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  6058                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  6059                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  6060             20  PM-RENEWAL-DATA.
  6061                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  6062                     28  PM-RENEW-MONTHS     PIC S999    COMP-3.
  6063                     28  PM-RENEW-COMMISSION
  6064                                             PIC S99V999 COMP-3.
  6065                     28  PM-RENEW-TYPE       PIC X(1).
  6066                         88  PM-COMP-RENEW-PERCENT      VALUE '1'.
  6067                         88  PM-COMP-RENEW-DOLLARS      VALUE '2'.
  6068                         88  PM-COMP-RENEW-NOT-USED     VALUE '3'.
  6069             20  PM-COMP-RECALC-FLAG       PIC X(1).
  6070                 88  PM-BYPASS-RECALC         VALUE 'N'.
  6071     12  FILLER                            PIC X(20).
  6072******************************************************************
  6073*             CUSTOMER DATA                                      *
  6074******************************************************************
  6075     12  PM-CUSTOMER-ID                    PIC X(20).
  6076******************************************************************
  6077     12  FILLER                            PIC X(43).
  6078******************************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 113
* EL154.cbl
  6080 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  6081                          CLAIM-MASTER ACTIVITY-TRAILERS
  6082                          CERTIFICATE-MASTER BENEFICIARY-MASTER
  6083                          ACCOUNT-MASTER PRODUCT-MASTER
  6084                          CERTIFICATE-TRAILERS POLICY-MASTER.
  6085 0000-DFHEXIT SECTION.
  6086     MOVE '9#                    $   ' TO DFHEIV0.
  6087     MOVE 'EL154' TO DFHEIV1.
  6088     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6089     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  6090     MOVE '5'                   TO DC-OPTION-CODE.
  6091     PERFORM 9700-DATE-LINK.
  6092     MOVE DC-GREG-DATE-1-EDIT   TO  CURRENT-GREG-DATE.
  6093     MOVE DC-BIN-DATE-1         TO  CURRENT-BIN-DATE.
  6094
  6095
  6096     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6097     MOVE 2 TO EMI-NUMBER-OF-LINES.
  6098     IF EIBCALEN = 0
  6099         GO TO 8800-UNAUTHORIZED-ACCESS.
  6100
  6101     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6102         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6103             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6104             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  6105             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6106             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6107             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6108             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6109             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6110             MOVE THIS-PGM  TO PI-CALLING-PROGRAM
  6111             MOVE LOW-VALUES TO EL154AO
  6112             GO TO 7000-BUILD-SCREEN.
  6113
  6114
  6115* EXEC CICS HANDLE CONDITION
  6116*        NOTOPEN(8860-CLAM-NOT-OPEN)
  6117*        PGMIDERR(9600-PGMID-ERROR)
  6118*        ERROR(9990-ABEND)
  6119*        END-EXEC.
  6120*    MOVE '"$JL.                 ! " #00006110' TO DFHEIV0
  6121     MOVE X'22244A4C2E20202020202020' TO DFHEIV0(1:12)
  6122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6123     MOVE X'2220233030303036313130' TO DFHEIV0(25:11)
  6124     CALL 'kxdfhei1' USING DFHEIV0
  6125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6126
  6127
  6128     IF EIBAID = DFHCLEAR
  6129         GO TO 9400-CLEAR.
  6130
  6131     IF PI-PROCESSOR-ID = 'LGXX'
  6132         GO TO 0200-RECEIVE.
  6133
  6134
  6135* EXEC CICS READQ TS
  6136*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6137*        INTO    (SECURITY-CONTROL)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 114
* EL154.cbl
  6138*        LENGTH  (SC-COMM-LENGTH)
  6139*        ITEM    (SC-ITEM)
  6140*    END-EXEC.
  6141*    MOVE '*$II   L              ''   #00006122' TO DFHEIV0
  6142     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6143     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6144     MOVE X'2020233030303036313232' TO DFHEIV0(25:11)
  6145     CALL 'kxdfhei1' USING DFHEIV0,
  6146           PI-SECURITY-TEMP-STORE-ID,
  6147           SECURITY-CONTROL,
  6148           SC-COMM-LENGTH,
  6149           SC-ITEM,
  6150           DFHEIV99,
  6151           DFHEIV99
  6152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6153
  6154
  6155     MOVE SC-CLAIMS-DISPLAY (9)   TO  PI-DISPLAY-CAP.
  6156     MOVE SC-CLAIMS-UPDATE  (9)   TO  PI-MODIFY-CAP.
  6157
  6158     IF NOT MODIFY-CAP
  6159         MOVE 'UPDATE'            TO  SM-READ
  6160         PERFORM 9995-SECURITY-VIOLATION
  6161         MOVE ER-0070             TO  EMI-ERROR
  6162         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6163         GO TO 8100-SEND-INITIAL-MAP.
  6164
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 115
* EL154.cbl
  6166 0200-RECEIVE.
  6167     MOVE LOW-VALUES TO EL154AI.
  6168     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6169         MOVE ER-0008 TO EMI-ERROR
  6170         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6171         GO TO 8200-SEND-DATAONLY.
  6172
  6173
  6174* EXEC CICS RECEIVE
  6175*        MAP(MAP-NAME)
  6176*        MAPSET(MAPSET-NAME)
  6177*        INTO(EL154AI)
  6178*        END-EXEC.
  6179     MOVE LENGTH OF
  6180      EL154AI
  6181       TO DFHEIV11
  6182*    MOVE '8"T I  L              ''   #00006147' TO DFHEIV0
  6183     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6185     MOVE X'2020233030303036313437' TO DFHEIV0(25:11)
  6186     CALL 'kxdfhei1' USING DFHEIV0,
  6187           MAP-NAME,
  6188           EL154AI,
  6189           DFHEIV11,
  6190           MAPSET-NAME,
  6191           DFHEIV99,
  6192           DFHEIV99
  6193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6194
  6195
  6196     IF ENTERPFL = 0
  6197         GO TO 0300-CHECK-PFKEYS.
  6198     IF EIBAID NOT = DFHENTER
  6199         MOVE ER-0004 TO EMI-ERROR
  6200         GO TO 0320-INPUT-ERROR.
  6201
  6202     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  6203         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6204     ELSE
  6205         MOVE ER-0029 TO EMI-ERROR
  6206         GO TO 0320-INPUT-ERROR.
  6207
  6208 0300-CHECK-PFKEYS.
  6209
  6210     IF EIBAID = DFHPF23
  6211         GO TO 8810-PF23.
  6212     IF EIBAID = DFHPF24
  6213         GO TO 9200-RETURN-MAIN-MENU.
  6214     IF EIBAID = DFHPF12
  6215         GO TO 9500-PF12.
  6216     IF EIBAID EQUAL DFHPF1
  6217        GO TO 0400-PAGE-FORWARD.
  6218     IF EIBAID EQUAL DFHPF2
  6219        GO TO 0700-PAGE-BACKWARD.
  6220     IF EIBAID EQUAL DFHPF3
  6221        MOVE CURRENT-BIN-DATE TO CURRENT-SAVE
  6222        IF TERMI = 'A'
  6223            GO TO 2000-ADD-ONLY
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 116
* EL154.cbl
  6224        ELSE
  6225        IF TERMI = 'N'
  6226            GO TO 3000-TERMINATE-AND-GENERATE.
  6227     IF (TERML NOT = 0) AND (EIBAID NOT = DFHENTER)
  6228         MOVE ER-0050 TO EMI-ERROR
  6229         GO TO 0320-INPUT-ERROR.
  6230     IF EIBAID = DFHENTER
  6231         GO TO 0330-EDIT-DATA.
  6232
  6233     MOVE ER-0029 TO EMI-ERROR.
  6234 0320-INPUT-ERROR.
  6235     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6236     MOVE AL-UNBON TO ENTERPFA.
  6237     IF ENTERPFL = 0
  6238         MOVE -1 TO TERML
  6239     ELSE
  6240         MOVE -1 TO ENTERPFL.
  6241
  6242     GO TO 8200-SEND-DATAONLY.
  6243
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 117
* EL154.cbl
  6245 0330-EDIT-DATA.
  6246     IF NOT MODIFY-CAP
  6247           MOVE ER-0070          TO EMI-ERROR
  6248           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6249           MOVE LOW-VALUES       TO EL154AO
  6250           GO TO 8100-SEND-INITIAL-MAP.
  6251
  6252     MOVE CURRENT-BIN-DATE       TO CURRENT-SAVE
  6253
  6254     IF TERMI = 'Y'
  6255         GO TO 1000-DELETE-CURRENT.
  6256     IF TERMI = 'A'
  6257         GO TO 2000-ADD-ONLY.
  6258     IF TERMI = 'N'
  6259         GO TO 3000-TERMINATE-AND-GENERATE.
  6260     MOVE ER-0347                TO EMI-ERROR.
  6261     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6262     MOVE -1                     TO TERML.
  6263     MOVE AL-UABON               TO TERMA.
  6264     GO TO 8200-SEND-DATAONLY.
  6265
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 118
* EL154.cbl
  6267 0400-PAGE-FORWARD.
  6268
  6269* EXEC CICS HANDLE CONDITION
  6270*         NOTFND    (8850-CLAM-END-FILE)
  6271*         ENDFILE   (8850-CLAM-END-FILE)
  6272*    END-EXEC.
  6273*    MOVE '"$I''                  ! # #00006225' TO DFHEIV0
  6274     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6275     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6276     MOVE X'2320233030303036323235' TO DFHEIV0(25:11)
  6277     CALL 'kxdfhei1' USING DFHEIV0
  6278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6279
  6280
  6281     MOVE PI-CARRIER      TO CLAM-CARRIER
  6282     MOVE PI-COMPANY-CD   TO CLAM-CO
  6283     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6284     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6285     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6286
  6287
  6288* EXEC CICS STARTBR
  6289*         DATASET   ('ELMSTR')
  6290*         RIDFLD    (CLAM-KEY)
  6291*    END-EXEC.
  6292     MOVE 'ELMSTR' TO DFHEIV1
  6293     MOVE 0
  6294       TO DFHEIV11
  6295*    MOVE '&,         G          &   #00006236' TO DFHEIV0
  6296     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6297     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6298     MOVE X'2020233030303036323336' TO DFHEIV0(25:11)
  6299     CALL 'kxdfhei1' USING DFHEIV0,
  6300           DFHEIV1,
  6301           CLAM-KEY,
  6302           DFHEIV99,
  6303           DFHEIV11,
  6304           DFHEIV99
  6305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6306
  6307
  6308 0450-READ-NEXT-CLAIM.
  6309
  6310
  6311* EXEC CICS READNEXT
  6312*         DATASET   ('ELMSTR')
  6313*         RIDFLD    (CLAM-KEY)
  6314*         SET       (ADDRESS OF CLAIM-MASTER)
  6315*    END-EXEC.
  6316     MOVE 'ELMSTR' TO DFHEIV1
  6317     MOVE 0
  6318       TO DFHEIV11
  6319*    MOVE '&.S                   )   #00006243' TO DFHEIV0
  6320     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6321     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6322     MOVE X'2020233030303036323433' TO DFHEIV0(25:11)
  6323     CALL 'kxdfhei1' USING DFHEIV0,
  6324           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 119
* EL154.cbl
  6325           DFHEIV20,
  6326           DFHEIV99,
  6327           CLAM-KEY,
  6328           DFHEIV99,
  6329           DFHEIV11,
  6330           DFHEIV99,
  6331           DFHEIV99
  6332     SET ADDRESS OF CLAIM-MASTER TO
  6333         DFHEIV20
  6334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6335
  6336
  6337     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6338        GO TO 8850-CLAM-END-FILE.
  6339
  6340     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6341        GO TO 0450-READ-NEXT-CLAIM.
  6342
  6343     IF PI-CARRIER-SECURITY GREATER SPACES
  6344         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6345             GO TO 0450-READ-NEXT-CLAIM.
  6346
  6347     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6348         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6349             GO TO 0450-READ-NEXT-CLAIM.
  6350
  6351     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6352         GO TO 0450-READ-NEXT-CLAIM.
  6353
  6354     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6355     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6356     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6357     MOVE CL-CERT-STATE       TO PI-STATE
  6358     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6359     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6360     MOVE CL-CERT-NO          TO PI-CERT-NO
  6361
  6362     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6363         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6364
  6365
  6366* EXEC CICS ENDBR
  6367*         DATASET    ('ELMSTR')
  6368*    END-EXEC.
  6369     MOVE 'ELMSTR' TO DFHEIV1
  6370     MOVE 0
  6371       TO DFHEIV11
  6372*    MOVE '&2                    $   #00006277' TO DFHEIV0
  6373     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6374     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6375     MOVE X'2020233030303036323737' TO DFHEIV0(25:11)
  6376     CALL 'kxdfhei1' USING DFHEIV0,
  6377           DFHEIV1,
  6378           DFHEIV11,
  6379           DFHEIV99
  6380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6381
  6382
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 120
* EL154.cbl
  6383     MOVE LOW-VALUES TO EL154AO.
  6384     GO TO 7000-BUILD-SCREEN.
  6385
  6386 0700-PAGE-BACKWARD.
  6387
  6388
  6389* EXEC CICS HANDLE CONDITION
  6390*         NOTFND    (8850-CLAM-END-FILE)
  6391*         ENDFILE   (8850-CLAM-END-FILE)
  6392*    END-EXEC.
  6393*    MOVE '"$I''                  ! $ #00006286' TO DFHEIV0
  6394     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6396     MOVE X'2420233030303036323836' TO DFHEIV0(25:11)
  6397     CALL 'kxdfhei1' USING DFHEIV0
  6398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6399
  6400
  6401     MOVE PI-CARRIER      TO CLAM-CARRIER
  6402     MOVE PI-COMPANY-CD   TO CLAM-CO
  6403     MOVE PI-CLAIM-NO     TO CLAM-CLAIM
  6404     MOVE PI-CERT-NO      TO CLAM-CERT-NUM
  6405     MOVE CLAM-KEY        TO CLAIM-SAVE-KEY.
  6406
  6407
  6408* EXEC CICS STARTBR
  6409*         DATASET   ('ELMSTR')
  6410*         RIDFLD    (CLAM-KEY)
  6411*    END-EXEC.
  6412     MOVE 'ELMSTR' TO DFHEIV1
  6413     MOVE 0
  6414       TO DFHEIV11
  6415*    MOVE '&,         G          &   #00006297' TO DFHEIV0
  6416     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6417     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6418     MOVE X'2020233030303036323937' TO DFHEIV0(25:11)
  6419     CALL 'kxdfhei1' USING DFHEIV0,
  6420           DFHEIV1,
  6421           CLAM-KEY,
  6422           DFHEIV99,
  6423           DFHEIV11,
  6424           DFHEIV99
  6425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6426
  6427
  6428 0750-READ-PREV-CLAIM.
  6429
  6430
  6431* EXEC CICS READPREV
  6432*         DATASET   ('ELMSTR')
  6433*         RIDFLD    (CLAM-KEY)
  6434*         SET       (ADDRESS OF CLAIM-MASTER)
  6435*    END-EXEC.
  6436     MOVE 'ELMSTR' TO DFHEIV1
  6437     MOVE 0
  6438       TO DFHEIV11
  6439*    MOVE '&0S                   )   #00006304' TO DFHEIV0
  6440     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 121
* EL154.cbl
  6441     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6442     MOVE X'2020233030303036333034' TO DFHEIV0(25:11)
  6443     CALL 'kxdfhei1' USING DFHEIV0,
  6444           DFHEIV1,
  6445           DFHEIV20,
  6446           DFHEIV99,
  6447           CLAM-KEY,
  6448           DFHEIV99,
  6449           DFHEIV11,
  6450           DFHEIV99,
  6451           DFHEIV99
  6452     SET ADDRESS OF CLAIM-MASTER TO
  6453         DFHEIV20
  6454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6455
  6456
  6457     IF PI-COMPANY-CD NOT EQUAL CLAM-CO
  6458        GO TO 8850-CLAM-END-FILE.
  6459
  6460     IF CLAM-KEY EQUAL CLAIM-SAVE-KEY
  6461        GO TO 0750-READ-PREV-CLAIM.
  6462
  6463     IF PI-CARRIER-SECURITY GREATER SPACES
  6464         IF CL-CERT-CARRIER NOT = PI-CARRIER-SECURITY
  6465             GO TO 0750-READ-PREV-CLAIM.
  6466
  6467     IF PI-ACCOUNT-SECURITY GREATER SPACES
  6468         IF CL-CERT-ACCOUNT NOT = PI-ACCOUNT-SECURITY
  6469             GO TO 0750-READ-PREV-CLAIM.
  6470
  6471     IF CL-CLAIM-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  6472         GO TO 0750-READ-PREV-CLAIM.
  6473
  6474     MOVE CL-CLAIM-NO         TO PI-CLAIM-NO.
  6475     MOVE CL-CERT-CARRIER     TO PI-CARRIER
  6476     MOVE CL-CERT-GROUPING    TO PI-GROUPING
  6477     MOVE CL-CERT-STATE       TO PI-STATE
  6478     MOVE CL-CERT-ACCOUNT     TO PI-ACCOUNT
  6479     MOVE CL-CERT-EFF-DT      TO PI-CERT-EFF-DT
  6480     MOVE CL-CERT-NO          TO PI-CERT-NO
  6481
  6482     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  6483         MOVE CL-CV-REFERENCE-NO TO  PI-MP-REFERENCE-NO.
  6484
  6485
  6486* EXEC CICS ENDBR
  6487*         DATASET    ('ELMSTR')
  6488*    END-EXEC.
  6489     MOVE 'ELMSTR' TO DFHEIV1
  6490     MOVE 0
  6491       TO DFHEIV11
  6492*    MOVE '&2                    $   #00006338' TO DFHEIV0
  6493     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6494     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6495     MOVE X'2020233030303036333338' TO DFHEIV0(25:11)
  6496     CALL 'kxdfhei1' USING DFHEIV0,
  6497           DFHEIV1,
  6498           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 122
* EL154.cbl
  6499           DFHEIV99
  6500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6501
  6502
  6503     MOVE LOW-VALUES TO EL154AO.
  6504     GO TO 7000-BUILD-SCREEN.
  6505
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 123
* EL154.cbl
  6507 1000-DELETE-CURRENT.
  6508     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6509     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6510
  6511     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6512     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6513     MOVE ZEROS                  TO CL-AUTO-PAY-SEQ.
  6514     MOVE LOW-VALUES             TO CL-NEXT-AUTO-PAY-DT.
  6515
  6516     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6517
  6518     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6519
  6520     MOVE SPACES TO WS-END-LETTER-FORM-NUM.
  6521*    IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6522     IF PRINTL IS GREATER THAN +0
  6523         MOVE PRINTI   TO PI-AUTO-END-LETTER
  6524     END-IF.
  6525     IF PI-AUTO-END-LETTER IS GREATER THAN SPACES
  6526         IF PI-AUTO-END-LETTER IS EQUAL TO 'N   '
  6527             GO TO 1000-FINISH-DELETE
  6528         ELSE
  6529             MOVE PI-AUTO-END-LETTER TO WS-END-LETTER-FORM-NUM
  6530             MOVE 'Y'    TO WS-ACT-REC-FOUND-SW
  6531                            WS-LETTER-SW
  6532         END-IF
  6533     END-IF.
  6534
  6535     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6536         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6537             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6538
  6539 1000-FINISH-DELETE.
  6540
  6541     IF EMI-NO-ERRORS
  6542         GO TO 8200-SEND-DATAONLY.
  6543
  6544     MOVE LOW-VALUES             TO EL154AO.
  6545     MOVE -1                     TO TERML.
  6546     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 124
* EL154.cbl
  6548 2000-ADD-ONLY.
  6549     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6550     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6551     IF NOT EMI-NO-ERRORS
  6552        GO TO 8200-SEND-DATAONLY.
  6553
  6554     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6555     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6556     IF NOT EMI-NO-ERRORS
  6557         GO TO 8200-SEND-DATAONLY.
  6558
  6559     IF CL-AUTO-PAY-SEQ  NOT = ZEROS
  6560        MOVE ER-0372             TO EMI-ERROR
  6561        MOVE -1                  TO NEFFDTEL
  6562        MOVE AL-UABON            TO NEFFDTEA
  6563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6564        GO TO 8200-SEND-DATAONLY.
  6565
  6566     PERFORM 6400-PAYMENT-CALCULATION  THRU 6499-EXIT.
  6567
  6568     IF NFSTAMT-SAVE IS EQUAL TO +0
  6569         MOVE ER-0350            TO  EMI-ERROR
  6570         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6571         MOVE -1                 TO  NFSTAMTL
  6572         MOVE AL-UNBON           TO  NFSTAMTA
  6573         GO TO 8200-SEND-DATAONLY.
  6574
  6575     IF EIBAID NOT = DFHPF3
  6576         GO TO 3500-CONFIRM-DATA.
  6577
  6578
  6579* EXEC CICS HANDLE CONDITION
  6580*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6581*        END-EXEC.
  6582*    MOVE '"$J                   ! % #00006417' TO DFHEIV0
  6583     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  6584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6585     MOVE X'2520233030303036343137' TO DFHEIV0(25:11)
  6586     CALL 'kxdfhei1' USING DFHEIV0
  6587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6588
  6589
  6590     PERFORM 4100-BUILD-AUTO-PAY THRU 4199-EXIT.
  6591
  6592     PERFORM 7100-CHECK-AUTO-ACTIVITY THRU 7100-EXIT.
  6593
  6594     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6595
  6596     MOVE SPACES TO WS-LETTER-FORM-NUM.
  6597*     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6598         IF NPRINTL IS GREATER THAN +0
  6599            IF NPRINTI IS EQUAL TO 'N   '
  6600                GO TO 2000-FINISH-ADD
  6601            ELSE
  6602                MOVE NPRINTI TO WS-LETTER-FORM-NUM
  6603                MOVE 'Y' TO WS-ACT-REC-FOUND-SW
  6604                            WS-LETTER-SW.
  6605
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 125
* EL154.cbl
  6606     IF WS-ACT-REC-FOUND-SW IS EQUAL TO 'Y'
  6607         IF WS-LETTER-SW IS EQUAL TO 'Y'
  6608             PERFORM 7150-CREATE-AUTO-LETTER THRU 7150-EXIT.
  6609
  6610 2000-FINISH-ADD.
  6611
  6612     IF EMI-NO-ERRORS
  6613         GO TO 8200-SEND-DATAONLY.
  6614
  6615     MOVE LOW-VALUES             TO EL154AO.
  6616     GO TO 7000-BUILD-SCREEN.
  6617
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 126
* EL154.cbl
  6619 3000-TERMINATE-AND-GENERATE.
  6620     PERFORM 6900-SET-CODES THRU 6999-EXIT.
  6621     PERFORM 5900-VERIFY-ALL-FIELDS THRU 5999-EXIT.
  6622     IF NOT EMI-NO-ERRORS
  6623         GO TO 8200-SEND-DATAONLY.
  6624
  6625     PERFORM 5000-READ-CLAIM THRU 5099-EXIT.
  6626     PERFORM 6000-EDIT-INPUT-DATA THRU 6300-EXIT.
  6627     IF NOT EMI-NO-ERRORS
  6628         GO TO 8200-SEND-DATAONLY.
  6629
  6630     PERFORM 6400-PAYMENT-CALCULATION THRU 6499-EXIT.
  6631
  6632     IF EIBAID NOT = DFHPF3
  6633         GO TO 3500-CONFIRM-DATA.
  6634
  6635     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  6636     PERFORM 4000-DELETE-AUTO-PAY THRU 4099-EXIT.
  6637
  6638     PERFORM 4100-BUILD-AUTO-PAY  THRU 4199-EXIT.
  6639
  6640     PERFORM 5200-REWRITE THRU 5299-EXIT.
  6641
  6642     IF EMI-NO-ERRORS
  6643         GO TO 8200-SEND-DATAONLY.
  6644
  6645     MOVE LOW-VALUES TO EL154AO.
  6646     GO TO 7000-BUILD-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 127
* EL154.cbl
  6648 3500-CONFIRM-DATA.
  6649
  6650     MOVE -1                     TO  ENTERPFL.
  6651     MOVE ER-0670                TO  EMI-ERROR.
  6652     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6653     GO TO 8200-SEND-DATAONLY.
  6654
  6655 4000-DELETE-AUTO-PAY.
  6656
  6657* EXEC CICS HANDLE CONDITION
  6658*        NOTOPEN(8870-ACTV-NOT-OPEN)
  6659*        NOTFND(4099-EXIT)
  6660*        END-EXEC.
  6661*    MOVE '"$JI                  ! & #00006487' TO DFHEIV0
  6662     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  6663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6664     MOVE X'2620233030303036343837' TO DFHEIV0(25:11)
  6665     CALL 'kxdfhei1' USING DFHEIV0
  6666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6667
  6668
  6669
  6670* EXEC CICS READ
  6671*        UPDATE
  6672*        DATASET(ACTV-ID)
  6673*        SET(ADDRESS OF ACTIVITY-TRAILERS)
  6674*        RIDFLD(ACTV-KEY)
  6675*        END-EXEC.
  6676*    MOVE '&"S        EU         (   #00006492' TO DFHEIV0
  6677     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6678     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6679     MOVE X'2020233030303036343932' TO DFHEIV0(25:11)
  6680     CALL 'kxdfhei1' USING DFHEIV0,
  6681           ACTV-ID,
  6682           DFHEIV20,
  6683           DFHEIV99,
  6684           ACTV-KEY,
  6685           DFHEIV99,
  6686           DFHEIV99,
  6687           DFHEIV99
  6688     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6689         DFHEIV20
  6690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6691
  6692
  6693     IF PRINTL > ZEROS
  6694         MOVE PRINTI             TO AT-AUTO-END-LETTER
  6695     END-IF.
  6696
  6697     MOVE CURRENT-SAVE           TO AT-TERMINATED-DT
  6698                                    AT-AUTO-PAY-LAST-MAINT-DT
  6699     MOVE PI-PROCESSOR-ID        TO AT-AUTO-PAY-LAST-UPDATED-BY
  6700     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
  6701
  6702* EXEC CICS REWRITE
  6703*        DATASET(ACTV-ID)
  6704*        FROM(ACTIVITY-TRAILERS)
  6705*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 128
* EL154.cbl
  6706     MOVE LENGTH OF
  6707      ACTIVITY-TRAILERS
  6708       TO DFHEIV11
  6709*    MOVE '&& L                  %   #00006507' TO DFHEIV0
  6710     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6712     MOVE X'2020233030303036353037' TO DFHEIV0(25:11)
  6713     CALL 'kxdfhei1' USING DFHEIV0,
  6714           ACTV-ID,
  6715           ACTIVITY-TRAILERS,
  6716           DFHEIV11,
  6717           DFHEIV99
  6718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6719
  6720
  6721 4099-EXIT.
  6722      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 129
* EL154.cbl
  6724 4100-BUILD-AUTO-PAY.
  6725******************************************************************
  6726*               CREATE AUTO PAY TRAILER
  6727******************************************************************
  6728
  6729     SUBTRACT 1                  FROM CL-TRAILER-SEQ-CNT.
  6730     MOVE CL-TRAILER-SEQ-CNT     TO ACTV-SEQ
  6731                                    CL-AUTO-PAY-SEQ.
  6732
  6733* EXEC CICS GETMAIN
  6734*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
  6735*         LENGTH    (TRLR-LENGTH)
  6736*         INITIMG   (GETMAIN-SPACE)
  6737*    END-EXEC.
  6738*    MOVE ',"IL                  $   #00006523' TO DFHEIV0
  6739     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6740     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6741     MOVE X'2020233030303036353233' TO DFHEIV0(25:11)
  6742     CALL 'kxdfhei1' USING DFHEIV0,
  6743           DFHEIV20,
  6744           TRLR-LENGTH,
  6745           GETMAIN-SPACE
  6746     SET ADDRESS OF ACTIVITY-TRAILERS TO
  6747         DFHEIV20
  6748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6749
  6750
  6751     MOVE ZEROS                  TO AT-DAYS-IN-REG-PMT.
  6752     MOVE NEFFDTE-SAVE           TO AT-SCHEDULE-START-DT.
  6753     MOVE NFSTPMT-SAVE           TO AT-1ST-PAY-THRU-DT
  6754                                    CL-NEXT-AUTO-PAY-DT.
  6755     MOVE DAYPAYI                TO AT-AUTO-PAY-DAY.
  6756     MOVE NLSTPMT-SAVE           TO AT-SCHEDULE-END-DT.
  6757     MOVE NFSTAMT-SAVE           TO AT-FIRST-PMT-AMT.
  6758     MOVE NDAYSFI                TO AT-DAYS-IN-1ST-PMT.
  6759
  6760*    IF PI-USES-PAID-TO
  6761*        MOVE NFSTPMT-SAVE       TO  DC-BIN-DATE-1
  6762*        MOVE '6'                TO  DC-OPTION-CODE
  6763*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6764*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6765*        PERFORM 9700-DATE-LINK
  6766*        IF NO-CONVERSION-ERROR
  6767*            MOVE DC-BIN-DATE-2  TO  AT-1ST-PAY-THRU-DT
  6768*                                    CL-NEXT-AUTO-PAY-DT
  6769*        ELSE
  6770*            MOVE LOW-VALUES     TO  AT-1ST-PAY-THRU-DT
  6771*                                    CL-NEXT-AUTO-PAY-DT
  6772*    ELSE
  6773*        MOVE NFSTPMT-SAVE       TO  AT-1ST-PAY-THRU-DT
  6774*                                    CL-NEXT-AUTO-PAY-DT.
  6775
  6776*    IF PI-USES-PAID-TO
  6777*        MOVE NLSTPMT-SAVE       TO  DC-BIN-DATE-1
  6778*        MOVE '6'                TO  DC-OPTION-CODE
  6779*        MOVE -1                 TO  DC-ELAPSED-DAYS
  6780*        MOVE +0                 TO  DC-ELAPSED-MONTHS
  6781*        PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 130
* EL154.cbl
  6782*        IF NO-CONVERSION-ERROR
  6783*            MOVE DC-BIN-DATE-2  TO  AT-SCHEDULE-END-DT
  6784*        ELSE
  6785*            MOVE LOW-VALUES     TO  AT-SCHEDULE-END-DT
  6786*    ELSE
  6787*        MOVE NLSTPMT-SAVE       TO  AT-SCHEDULE-END-DT.
  6788
  6789     IF NLASTI = 'Y'
  6790        MOVE 'F'                 TO AT-LAST-PMT-TYPE
  6791     ELSE
  6792        MOVE 'P'                 TO AT-LAST-PMT-TYPE.
  6793
  6794     MOVE NMONTHSI               TO AT-INTERVAL-MONTHS.
  6795     MOVE NREGPMT-SAVE           TO AT-REGULAR-PMT-AMT.
  6796
  6797     MOVE WS-PAYEE-CODE          TO AT-AUTO-PAYEE-CD.
  6798
  6799     IF NINDCTRI    IS EQUAL TO  'N'
  6800         MOVE 'N'                TO AT-AUTO-CASH
  6801     ELSE
  6802         MOVE 'Y'                TO AT-AUTO-CASH.
  6803
  6804     MOVE ENDLETTI               TO AT-AUTO-END-LETTER.
  6805
  6806     IF PI-COMPANY-ID = 'CSL'
  6807        IF PI-CARRIER = 'A' OR 'B' OR 'C' OR '1' OR '2' OR
  6808                        '3' OR '4'
  6809         INSPECT AT-AUTO-PAYEE-CD CONVERTING 'IBA' TO 'IOA'.
  6810
  6811     MOVE LOW-VALUE              TO AT-TERMINATED-DT.
  6812     MOVE 'AT'                   TO AT-RECORD-ID.
  6813     MOVE  3                     TO AT-TRAILER-TYPE.
  6814     MOVE CURRENT-SAVE           TO AT-RECORDED-DT
  6815                                    AT-AUTO-PAY-LAST-MAINT-DT
  6816     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  6817                                    AT-AUTO-PAY-LAST-UPDATED-BY
  6818     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  6819     MOVE ACTV-KEY               TO AT-CONTROL-PRIMARY.
  6820
  6821
  6822* EXEC CICS WRITE
  6823*         DATASET(ACTV-ID)
  6824*         FROM   (ACTIVITY-TRAILERS)
  6825*         RIDFLD (AT-CONTROL-PRIMARY)
  6826*         END-EXEC.
  6827     MOVE LENGTH OF
  6828      ACTIVITY-TRAILERS
  6829       TO DFHEIV11
  6830*    MOVE '&$ L                  ''   #00006599' TO DFHEIV0
  6831     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6832     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6833     MOVE X'2020233030303036353939' TO DFHEIV0(25:11)
  6834     CALL 'kxdfhei1' USING DFHEIV0,
  6835           ACTV-ID,
  6836           ACTIVITY-TRAILERS,
  6837           DFHEIV11,
  6838           AT-CONTROL-PRIMARY,
  6839           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 131
* EL154.cbl
  6840           DFHEIV99
  6841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6842
  6843
  6844 4199-EXIT.
  6845      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 132
* EL154.cbl
  6847 5000-READ-CLAIM.
  6848
  6849* EXEC CICS READ
  6850*        UPDATE
  6851*        DATASET(CLAM-ID)
  6852*        SET    (ADDRESS OF CLAIM-MASTER)
  6853*        RIDFLD (CLAM-KEY)
  6854*        END-EXEC.
  6855*    MOVE '&"S        EU         (   #00006609' TO DFHEIV0
  6856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6857     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6858     MOVE X'2020233030303036363039' TO DFHEIV0(25:11)
  6859     CALL 'kxdfhei1' USING DFHEIV0,
  6860           CLAM-ID,
  6861           DFHEIV20,
  6862           DFHEIV99,
  6863           CLAM-KEY,
  6864           DFHEIV99,
  6865           DFHEIV99,
  6866           DFHEIV99
  6867     SET ADDRESS OF CLAIM-MASTER TO
  6868         DFHEIV20
  6869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6870
  6871
  6872 5099-EXIT.
  6873      EXIT.
  6874
  6875 5200-REWRITE.
  6876
  6877* EXEC CICS HANDLE CONDITION
  6878*        DUPKEY
  6879*        END-EXEC.
  6880*    MOVE '"$                   ! '' #00006620' TO DFHEIV0
  6881     MOVE X'222494202020202020202020' TO DFHEIV0(1:12)
  6882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6883     MOVE X'2720233030303036363230' TO DFHEIV0(25:11)
  6884     CALL 'kxdfhei1' USING DFHEIV0
  6885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6886
  6887
  6888     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
  6889     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
  6890     MOVE CURRENT-SAVE           TO CL-LAST-MAINT-DT.
  6891
  6892* EXEC CICS REWRITE
  6893*        DATASET(CLAM-ID)
  6894*        FROM   (CLAIM-MASTER)
  6895*        END-EXEC.
  6896     MOVE LENGTH OF
  6897      CLAIM-MASTER
  6898       TO DFHEIV11
  6899*    MOVE '&& L                  %   #00006627' TO DFHEIV0
  6900     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6901     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6902     MOVE X'2020233030303036363237' TO DFHEIV0(25:11)
  6903     CALL 'kxdfhei1' USING DFHEIV0,
  6904           CLAM-ID,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 133
* EL154.cbl
  6905           CLAIM-MASTER,
  6906           DFHEIV11,
  6907           DFHEIV99
  6908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6909
  6910
  6911*    MOVE 1                      TO EMI-NUMBER-OF-LINES.
  6912     MOVE ER-0000                TO EMI-ERROR.
  6913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6914
  6915 5299-EXIT.
  6916      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 134
* EL154.cbl
  6918 5900-VERIFY-ALL-FIELDS.
  6919******************************************************************
  6920*       PRELIMINARY EDITS TO VERIFY THAT THE REQUIRED FIELDS     *
  6921*       HAVE DATA ENTERED IN THEM                                *
  6922******************************************************************
  6923
  6924     IF DAYPAYL EQUAL +0
  6925        MOVE ZEROS TO DAYPAYI.
  6926
  6927     IF NEFFDTEL EQUAL +0
  6928        MOVE LOW-VALUES TO NEFFDTEI.
  6929
  6930     IF NFSTAMTL EQUAL +0
  6931        MOVE ZEROS TO NFSTAMTI
  6932                      NFSTAMTO.
  6933
  6934     IF NDAYSFL EQUAL +0
  6935        MOVE ZEROS TO NDAYSFI.
  6936
  6937     IF NFSTAMTL EQUAL +0
  6938        IF NDAYSFL NOT EQUAL +0
  6939           MOVE +0        TO NDAYSFL
  6940           MOVE ZEROS     TO NDAYSFI.
  6941
  6942     IF NMONTHSL = ZEROS
  6943        MOVE -1                  TO NMONTHSL
  6944        GO TO 5910-REQUIRED-ERROR.
  6945
  6946     IF NFSTPMTL = ZEROS
  6947        MOVE -1                  TO NFSTPMTL
  6948        GO TO 5910-REQUIRED-ERROR.
  6949
  6950     IF NLSTPMTL = ZEROS
  6951        MOVE -1                  TO NLSTPMTL
  6952        GO TO 5910-REQUIRED-ERROR.
  6953
  6954     IF NLASTL = ZEROS
  6955        MOVE -1                  TO NLASTL
  6956        GO TO 5910-REQUIRED-ERROR.
  6957
  6958     IF NPAYEEL = ZEROS
  6959        MOVE -1                  TO NPAYEEL
  6960        GO TO 5910-REQUIRED-ERROR.
  6961
  6962     IF LETTDTEL EQUAL +0
  6963        MOVE LOW-VALUES TO LETTDTEI.
  6964
  6965     IF (PI-COMPANY-ID  =  'AIG' OR  'AUK') AND
  6966        (NINDCTRL =  ZEROS)
  6967           MOVE -1               TO NINDCTRL
  6968           GO TO 5910-REQUIRED-ERROR.
  6969
  6970     GO TO 5999-EXIT.
  6971
  6972 5910-REQUIRED-ERROR.
  6973     MOVE ER-0358                TO EMI-ERROR.
  6974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6975
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 135
* EL154.cbl
  6976 5999-EXIT.
  6977      EXIT.
  6978
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 136
* EL154.cbl
  6980 6000-EDIT-INPUT-DATA.
  6981******************************************************
  6982*    IF THE EFFECTIVE OR "PAID FROM" WAS NOT         *
  6983*    ENTERED, THEN USE THE INCURRED OR LAST PAID     *
  6984*    THRU DATE                                       *
  6985******************************************************
  6986
  6987     MOVE SPACES TO WS-ELIMINATION-SW.
  6988
  6989     IF NEFFDTEL NOT = ZEROS
  6990        MOVE NEFFDTEI            TO DEEDIT-FIELD
  6991        PERFORM 8600-DEEDIT
  6992        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  6993        MOVE '4'                 TO DC-OPTION-CODE
  6994        PERFORM 9700-DATE-LINK
  6995        IF DATE-CONVERSION-ERROR
  6996           MOVE ER-0348          TO EMI-ERROR
  6997           MOVE -1               TO NEFFDTEL
  6998           MOVE AL-UABON         TO NEFFDTEA
  6999           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7000        ELSE
  7001           MOVE DEEDIT-FIELD-V0  TO NEFFDTEO
  7002           INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7003           MOVE AL-UANON         TO NEFFDTEA
  7004           MOVE DC-BIN-DATE-1    TO NEFFDTE-SAVE
  7005     ELSE
  7006        IF CL-PAID-THRU-DT EQUAL LOW-VALUES
  7007           MOVE 'N' TO WS-ELIMINATION-SW
  7008           MOVE CL-INCURRED-DT TO NEFFDTE-SAVE
  7009                                  DC-BIN-DATE-1
  7010           MOVE ' ' TO DC-OPTION-CODE
  7011           PERFORM 9700-DATE-LINK
  7012           IF NO-CONVERSION-ERROR
  7013              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7014              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7015           ELSE
  7016              MOVE LOW-VALUES TO NEFFDTE-SAVE
  7017        ELSE
  7018           MOVE CL-PAID-THRU-DT TO DC-BIN-DATE-1
  7019           MOVE +1 TO DC-ELAPSED-DAYS
  7020           MOVE +0 TO DC-ELAPSED-MONTHS
  7021           MOVE '6' TO DC-OPTION-CODE
  7022           PERFORM 9700-DATE-LINK
  7023           IF NO-CONVERSION-ERROR
  7024              MOVE DC-BIN-DATE-2 TO NEFFDTE-SAVE
  7025              MOVE DC-GREG-DATE-1-MDY  TO NEFFDTEO
  7026              INSPECT NEFFDTEI CONVERTING SPACES TO '/'
  7027           ELSE
  7028              MOVE LOW-VALUES TO NEFFDTE-SAVE.
  7029
  7030******************************************************************
  7031*       EDIT FIRST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7032*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7033*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7034******************************************************************
  7035
  7036     IF NFSTPMTL NOT = ZEROS
  7037        MOVE NFSTPMTI            TO DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 137
* EL154.cbl
  7038        PERFORM 8600-DEEDIT
  7039        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7040        MOVE '4'                 TO DC-OPTION-CODE
  7041        PERFORM 9700-DATE-LINK
  7042        IF DATE-CONVERSION-ERROR
  7043           MOVE ER-0349          TO EMI-ERROR
  7044           MOVE -1               TO NFSTPMTL
  7045           MOVE AL-UABON         TO NFSTPMTA
  7046           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7047          ELSE
  7048           MOVE DEEDIT-FIELD-V0  TO NFSTPMTO
  7049           INSPECT NFSTPMTI CONVERTING SPACES TO '/'
  7050           MOVE AL-UANON         TO NFSTPMTA.
  7051*          MOVE DC-BIN-DATE-1    TO NFSTPMT-SAVE.
  7052
  7053     IF PI-USES-PAID-TO
  7054         MOVE '6'                TO  DC-OPTION-CODE
  7055         MOVE -1                 TO  DC-ELAPSED-DAYS
  7056         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7057         PERFORM 9700-DATE-LINK
  7058         IF NO-CONVERSION-ERROR
  7059             MOVE DC-BIN-DATE-2  TO  NFSTPMT-SAVE
  7060         ELSE
  7061             MOVE ER-0349        TO  EMI-ERROR
  7062             MOVE -1             TO  NFSTPMTL
  7063             MOVE AL-UABON       TO  NFSTPMTA
  7064             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7065     ELSE
  7066         MOVE DC-BIN-DATE-1      TO  NFSTPMT-SAVE.
  7067
  7068******************************************************************
  7069*       EDIT LAST PAY THRU/TO DATE.  IF THE "PAY TO" OPTION ON
  7070*       THE COMPANY CONTROL IS SET, THE FIRST PAYMENT SAVE DATE
  7071*       IS SET BACK MINUS 1 DAY FOR PROCESSING.
  7072******************************************************************
  7073
  7074     IF NLSTPMTL NOT = ZEROS
  7075        MOVE NLSTPMTI            TO DEEDIT-FIELD
  7076        PERFORM 8600-DEEDIT
  7077        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7078        MOVE '4'                 TO DC-OPTION-CODE
  7079        PERFORM 9700-DATE-LINK
  7080        IF DATE-CONVERSION-ERROR
  7081           MOVE ER-0354          TO EMI-ERROR
  7082           MOVE -1               TO NLSTPMTL
  7083           MOVE AL-UABON         TO NLSTPMTA
  7084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7085          ELSE
  7086           MOVE DEEDIT-FIELD-V0  TO NLSTPMTO
  7087           INSPECT NLSTPMTI CONVERTING SPACES TO '/'
  7088           MOVE AL-UANON         TO NLSTPMTA.
  7089
  7090     IF PI-USES-PAID-TO
  7091         MOVE '6'                TO  DC-OPTION-CODE
  7092         MOVE -1                 TO  DC-ELAPSED-DAYS
  7093         MOVE +0                 TO  DC-ELAPSED-MONTHS
  7094         PERFORM 9700-DATE-LINK
  7095         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 138
* EL154.cbl
  7096             MOVE DC-BIN-DATE-2  TO  NLSTPMT-SAVE
  7097         ELSE
  7098             MOVE ER-0354        TO  EMI-ERROR
  7099             MOVE -1             TO  NLSTPMTL
  7100             MOVE AL-UABON       TO  NLSTPMTA
  7101             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7102     ELSE
  7103         MOVE DC-BIN-DATE-1      TO  NLSTPMT-SAVE.
  7104
  7105******************************************************************
  7106*       EDIT FIRST PAYMENT AMOUNT
  7107******************************************************************
  7108
  7109     IF NFSTAMTL NOT = ZEROS
  7110
  7111* EXEC CICS BIF DEEDIT
  7112*          FIELD (NFSTAMTI)
  7113*          LENGTH(10)
  7114*       END-EXEC
  7115     MOVE 10
  7116       TO DFHEIV11
  7117*    MOVE '@"L                   #   #00006831' TO DFHEIV0
  7118     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7119     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7120     MOVE X'2020233030303036383331' TO DFHEIV0(25:11)
  7121     CALL 'kxdfhei1' USING DFHEIV0,
  7122           NFSTAMTI,
  7123           DFHEIV11
  7124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7125        IF NFSTAMTI NOT NUMERIC
  7126           MOVE ER-0350          TO EMI-ERROR
  7127           MOVE -1               TO NFSTAMTL
  7128           MOVE AL-UNBON         TO NFSTAMTA
  7129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7130        ELSE
  7131           MOVE NFSTAMTI         TO NFSTAMT-SAVE
  7132                                    NFSTAMTO
  7133           MOVE AL-UNNON         TO NFSTAMTA
  7134        end-if
  7135     end-if
  7136******************************************************************
  7137*       EDIT DAY TO PAY
  7138******************************************************************
  7139
  7140     IF DAYPAYL NOT EQUAL +0
  7141        IF DAYPAYI NUMERIC AND
  7142           DAYPAYI LESS THAN 32
  7143           MOVE AL-UNNON         TO DAYPAYA
  7144        ELSE
  7145           MOVE ER-0632          TO EMI-ERROR
  7146           MOVE -1               TO DAYPAYL
  7147           MOVE AL-UNBON         TO DAYPAYA
  7148           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7149
  7150******************************************************************
  7151*       EDIT NUMBER OF DAYS IN FIRST PAYMENT PERIOD
  7152******************************************************************
  7153
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 139
* EL154.cbl
  7154     IF NDAYSFL NOT = ZEROS
  7155        IF NDAYSFI NOT NUMERIC
  7156           MOVE ER-0351          TO EMI-ERROR
  7157           MOVE -1               TO NDAYSFL
  7158           MOVE AL-UNBON         TO NDAYSFA
  7159           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7160        ELSE
  7161           MOVE AL-UNNON         TO NDAYSFA.
  7162
  7163******************************************************************
  7164*       EDIT NUMBER OF MONTHS BETWEEN PAYMENTS
  7165******************************************************************
  7166
  7167     IF NMONTHSL EQUAL +0
  7168        MOVE +1                  TO NMONTHSL
  7169        MOVE 1                   TO NMONTHSI.
  7170
  7171     IF NMONTHSL NOT = ZEROS
  7172        IF NMONTHSI NOT NUMERIC
  7173           MOVE ER-0353          TO EMI-ERROR
  7174           MOVE -1               TO NMONTHSL
  7175           MOVE AL-UNBON         TO NMONTHSA
  7176           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7177        ELSE
  7178           IF NMONTHSI NOT GREATER THAN ZERO
  7179              MOVE ER-0353          TO EMI-ERROR
  7180              MOVE -1               TO NMONTHSL
  7181              MOVE AL-UNBON         TO NMONTHSA
  7182              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7183              ELSE
  7184              MOVE AL-UNNON         TO NMONTHSA.
  7185
  7186******************************************************************
  7187*       EDIT PAYEE CODE
  7188******************************************************************
  7189
  7190     MOVE NPAYEEI TO WS-PAYEE-CODE.
  7191
  7192     IF WS-PAYEE-SEQ NOT NUMERIC
  7193        MOVE ER-0357          TO EMI-ERROR
  7194        MOVE -1               TO NPAYEEL
  7195        MOVE AL-UNBON         TO NPAYEEA
  7196        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7197        GO TO 6300-EXIT.
  7198
  7199     IF WS-PAYEE-CD EQUAL 'I' AND
  7200        WS-PAYEE-SEQ-NUM EQUAL 0
  7201        MOVE ER-0357          TO EMI-ERROR
  7202        MOVE -1               TO NPAYEEL
  7203        MOVE AL-UNBON         TO NPAYEEA
  7204        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7205
  7206     IF WS-PAYEE-SEQ-NUM GREATER THAN 9
  7207        MOVE ER-0357          TO EMI-ERROR
  7208        MOVE -1               TO NPAYEEL
  7209        MOVE AL-UNBON         TO NPAYEEA
  7210        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7211
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 140
* EL154.cbl
  7212     IF NPAYEEL NOT EQUAL +0
  7213        IF WS-PAYEE-CD = ('I' OR 'B' OR 'A')
  7214           MOVE AL-UNNON         TO NPAYEEA
  7215        ELSE
  7216           MOVE ER-0357          TO EMI-ERROR
  7217           MOVE -1               TO NPAYEEL
  7218           MOVE AL-UNBON         TO NPAYEEA
  7219           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7220
  7221******************************************************************
  7222*       EDIT LAST PAYMENT TYPE
  7223******************************************************************
  7224
  7225     IF NLASTL NOT = ZEROS
  7226        IF NLASTI = 'Y' OR 'N'
  7227           MOVE AL-UANON         TO NLASTA
  7228        ELSE
  7229           MOVE ER-0352          TO EMI-ERROR
  7230           MOVE -1               TO NLASTL
  7231           MOVE AL-UABON         TO NLASTA
  7232           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7233
  7234******************************************************************
  7235*       EDIT CASH / NON CASH INDICATOR
  7236******************************************************************
  7237
  7238     IF NINDCTRL NOT =  ZEROS
  7239        IF NINDCTRI  = 'Y' OR 'N'
  7240           MOVE AL-UANON         TO NINDCTRA
  7241        ELSE
  7242           MOVE ER-0815          TO EMI-ERROR
  7243           MOVE -1               TO NINDCTRL
  7244           MOVE AL-UABON         TO NINDCTRA
  7245           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7246
  7247     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7248         IF (CL-ASSOCIATES IS EQUAL TO 'A' OR 'N')
  7249             IF NINDCTRI IS EQUAL TO 'N'
  7250                 MOVE ER-3537    TO  EMI-ERROR
  7251                 MOVE -1         TO  NINDCTRL
  7252                 MOVE AL-UABON   TO  NINDCTRA
  7253                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7254
  7255******************************************************************
  7256*       EDIT LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7257******************************************************************
  7258
  7259     IF NPRINTL IS NOT EQUAL TO +0
  7260*01157         IF NPRINTI IS EQUAL TO 'N'
  7261           MOVE AL-UANON         TO  NPRINTA
  7262*01159         ELSE
  7263*01160            MOVE ER-0826          TO  EMI-ERROR
  7264*01161            MOVE -1               TO  NPRINTL
  7265*01162            MOVE AL-UABON         TO  NPRINTA
  7266*01163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7267     END-IF.
  7268
  7269******************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 141
* EL154.cbl
  7270*    IF THE AUTO LETTER DATE IS ENTERED IT IS USED   *
  7271*    TO RESOLVE VAIABLE @@AUTOPYDT IN THE LETTER     *
  7272*    FORM THAT IS ENTERED IN THE PRINT LETTER FIELD. *
  7273******************************************************
  7274
  7275     IF LETTDTEL NOT = ZEROS
  7276        MOVE LETTDTEI            TO DEEDIT-FIELD
  7277        PERFORM 8600-DEEDIT
  7278        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  7279        MOVE '4'                 TO DC-OPTION-CODE
  7280        PERFORM 9700-DATE-LINK
  7281        IF DATE-CONVERSION-ERROR
  7282           MOVE ER-3801          TO EMI-ERROR
  7283           MOVE -1               TO LETTDTEL
  7284           MOVE AL-UABON         TO LETTDTEA
  7285           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7286        ELSE
  7287           MOVE DEEDIT-FIELD-V0  TO LETTDTEO
  7288           INSPECT LETTDTEI CONVERTING SPACES TO '/'
  7289           MOVE AL-UANON         TO LETTDTEA
  7290           MOVE DC-GREG-DATE-A-EDIT TO LETTDTE-SAVE
  7291        END-IF
  7292     ELSE
  7293         MOVE SPACES TO LETTDTE-SAVE
  7294     END-IF.
  7295
  7296******************************************************************
  7297*       EDIT END LETTER PRINT INDICATOR FOR AUTO ACTIVITY
  7298******************************************************************
  7299     IF ENDLETTL NOT = ZEROS
  7300             MOVE AL-UANON          TO ENDLETTA
  7301     ELSE
  7302         IF NPRINTL NOT = ZEROS
  7303             IF NPRINTI NOT = 'N   '
  7304                 MOVE ER-3397    TO EMI-ERROR
  7305                 MOVE -1         TO ENDLETTL
  7306                 MOVE AL-UABON   TO ENDLETTA
  7307                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7308             END-IF
  7309         END-IF
  7310     END-IF.
  7311
  7312     IF NOT EMI-NO-ERRORS
  7313        GO TO 6300-EXIT.
  7314
  7315     IF PI-PROCESSOR-ID  =  LGXX-ID
  7316        GO TO 6150-READ-CARRIER.
  7317
  7318******************************************************************
  7319*       READ PROCESSOR RECORD ON THE CONTROL FILE TO GET THE
  7320*       PROCESSOR LIMITS
  7321******************************************************************
  7322
  7323
  7324* EXEC CICS HANDLE CONDITION
  7325*         NOTFND (6150-READ-CARRIER)
  7326*         NOTOPEN(8890-CNTL-NOT-OPEN)
  7327*         END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 142
* EL154.cbl
  7328*    MOVE '"$IJ                  ! ( #00007033' TO DFHEIV0
  7329     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  7330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7331     MOVE X'2820233030303037303333' TO DFHEIV0(25:11)
  7332     CALL 'kxdfhei1' USING DFHEIV0
  7333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7334
  7335
  7336
  7337* EXEC CICS READ
  7338*         DATASET(CNTL-ID)
  7339*         RIDFLD (CNTL-KEY)
  7340*         SET    (ADDRESS OF CONTROL-FILE)
  7341*         END-EXEC.
  7342*    MOVE '&"S        E          (   #00007038' TO DFHEIV0
  7343     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7345     MOVE X'2020233030303037303338' TO DFHEIV0(25:11)
  7346     CALL 'kxdfhei1' USING DFHEIV0,
  7347           CNTL-ID,
  7348           DFHEIV20,
  7349           DFHEIV99,
  7350           CNTL-KEY,
  7351           DFHEIV99,
  7352           DFHEIV99,
  7353           DFHEIV99
  7354     SET ADDRESS OF CONTROL-FILE TO
  7355         DFHEIV20
  7356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7357
  7358
  7359     MOVE CF-PROC-CALC-AMT-TOL       TO WS-AMT-TOL.
  7360     MOVE CF-PROC-CALC-DAYS-TOL      TO WS-DAY-TOL.
  7361     MOVE CF-PROC-MAX-AUTO-PMT       TO WS-MAX-AUTO-PMT.
  7362     MOVE CF-PROC-MAX-AUTO-MOS       TO WS-MAX-AUTO-MOS.
  7363     MOVE CF-PROC-MAX-REG-PMT        TO WS-REG-PMT.
  7364
  7365  6150-READ-CARRIER.
  7366******************************************************************
  7367*       READ THE CARRIER RECORD TO GET PAYMENT TOLERANCES
  7368******************************************************************
  7369
  7370     MOVE '6'                    TO CNTL-RECORD-TYPE.
  7371     MOVE SPACES                 TO CNTL-GENL.
  7372
  7373     IF CONTROL-IS-ACTUAL-CARRIER
  7374         MOVE PI-CARRIER                 TO CNTL-GEN4
  7375     ELSE
  7376         MOVE PI-CARRIER-CONTROL-LEVEL   TO CNTL-GEN4.
  7377
  7378
  7379* EXEC CICS HANDLE CONDITION
  7380*         NOTFND(6180-READ-CERT)
  7381*         END-EXEC.
  7382*    MOVE '"$I                   ! ) #00007063' TO DFHEIV0
  7383     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7385     MOVE X'2920233030303037303633' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 143
* EL154.cbl
  7386     CALL 'kxdfhei1' USING DFHEIV0
  7387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7388
  7389
  7390
  7391* EXEC CICS READ
  7392*         DATASET(CNTL-ID)
  7393*         RIDFLD (CNTL-KEY)
  7394*         SET    (ADDRESS OF CONTROL-FILE)
  7395*         END-EXEC.
  7396*    MOVE '&"S        E          (   #00007067' TO DFHEIV0
  7397     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7398     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7399     MOVE X'2020233030303037303637' TO DFHEIV0(25:11)
  7400     CALL 'kxdfhei1' USING DFHEIV0,
  7401           CNTL-ID,
  7402           DFHEIV20,
  7403           DFHEIV99,
  7404           CNTL-KEY,
  7405           DFHEIV99,
  7406           DFHEIV99,
  7407           DFHEIV99
  7408     SET ADDRESS OF CONTROL-FILE TO
  7409         DFHEIV20
  7410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7411
  7412
  7413     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
  7414
  7415     IF WS-AMT-TOL = ZERO
  7416        MOVE CF-CALC-AMT-TOL     TO WS-AMT-TOL.
  7417
  7418     IF WS-DAY-TOL = ZEROS
  7419        MOVE CF-CALC-DAYS-TOL    TO WS-DAY-TOL.
  7420
  7421     IF WS-MAX-AUTO-PMT = ZEROS
  7422        MOVE CF-MAX-AUTO-PMT     TO WS-MAX-AUTO-PMT.
  7423
  7424     IF WS-MAX-AUTO-MOS = ZEROS
  7425        MOVE CF-MAX-AUTO-MOS     TO WS-MAX-AUTO-MOS.
  7426
  7427     IF WS-REG-PMT = ZEROS
  7428        MOVE CF-MAX-REG-PMT      TO WS-REG-PMT.
  7429
  7430 6180-READ-CERT.
  7431
  7432     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7433         GO TO 6190-READ-EMPLCY.
  7434
  7435
  7436* EXEC CICS HANDLE CONDITION
  7437*         NOTOPEN   (8880-CERT-NOT-OPEN)
  7438*         NOTFND    (6185-CERT-NOT-FOUND)
  7439*         END-EXEC.
  7440*    MOVE '"$JI                  ! * #00007095' TO DFHEIV0
  7441     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7443     MOVE X'2A20233030303037303935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 144
* EL154.cbl
  7444     CALL 'kxdfhei1' USING DFHEIV0
  7445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7446
  7447
  7448
  7449* EXEC CICS READ
  7450*         DATASET(CERT-ID)
  7451*         RIDFLD (CERT-KEY)
  7452*         SET    (ADDRESS OF CERTIFICATE-MASTER)
  7453*         END-EXEC.
  7454*    MOVE '&"S        E          (   #00007100' TO DFHEIV0
  7455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7457     MOVE X'2020233030303037313030' TO DFHEIV0(25:11)
  7458     CALL 'kxdfhei1' USING DFHEIV0,
  7459           CERT-ID,
  7460           DFHEIV20,
  7461           DFHEIV99,
  7462           CERT-KEY,
  7463           DFHEIV99,
  7464           DFHEIV99,
  7465           DFHEIV99
  7466     SET ADDRESS OF CERTIFICATE-MASTER TO
  7467         DFHEIV20
  7468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7469
  7470
  7471     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7472         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
  7473         MOVE '6'                    TO  DC-OPTION-CODE
  7474         MOVE '1'                    TO  DC-END-OF-MONTH
  7475         MOVE +0                     TO  DC-ELAPSED-DAYS
  7476                                         DC-ODD-DAYS-OVER
  7477         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
  7478         PERFORM 9700-DATE-LINK
  7479         IF NO-CONVERSION-ERROR
  7480             MOVE DC-BIN-DATE-2      TO  WS-EXP-DT
  7481         ELSE
  7482             MOVE LOW-VALUES         TO  WS-EXP-DT
  7483     ELSE
  7484         MOVE CM-AH-LOAN-EXPIRE-DT   TO  WS-EXP-DT.
  7485
  7486     move cm-ah-benefit-amt      to ws-monthly-benefit
  7487     move cm-ah-benefit-cd       to ws-ah-benefit-cd
  7488     GO TO 6200-START-FINAL-EDITS.
  7489
  7490 6185-CERT-NOT-FOUND.
  7491     MOVE ER-0206                TO EMI-ERROR.
  7492     MOVE -1                     TO NEFFDTEL.
  7493     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7494     GO TO 6300-EXIT.
  7495
  7496 6190-READ-EMPLCY.
  7497
  7498
  7499* EXEC CICS HANDLE CONDITION
  7500*        NOTOPEN   (8885-EMPLCY-NOT-OPEN)
  7501*        NOTFND    (6195-EMPLCY-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 145
* EL154.cbl
  7502*    END-EXEC.
  7503*    MOVE '"$JI                  ! + #00007133' TO DFHEIV0
  7504     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  7505     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7506     MOVE X'2B20233030303037313333' TO DFHEIV0(25:11)
  7507     CALL 'kxdfhei1' USING DFHEIV0
  7508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7509
  7510
  7511     MOVE CL-CV-REFERENCE-NO     TO  EMPLCY-REFERENCE-NO.
  7512
  7513
  7514* EXEC CICS READ
  7515*        DATASET   (EMPLCY-ID)
  7516*        RIDFLD    (EMPLCY-KEY)
  7517*        SET       (ADDRESS OF POLICY-MASTER)
  7518*    END-EXEC.
  7519*    MOVE '&"S        E          (   #00007140' TO DFHEIV0
  7520     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7521     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7522     MOVE X'2020233030303037313430' TO DFHEIV0(25:11)
  7523     CALL 'kxdfhei1' USING DFHEIV0,
  7524           EMPLCY-ID,
  7525           DFHEIV20,
  7526           DFHEIV99,
  7527           EMPLCY-KEY,
  7528           DFHEIV99,
  7529           DFHEIV99,
  7530           DFHEIV99
  7531     SET ADDRESS OF POLICY-MASTER TO
  7532         DFHEIV20
  7533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7534
  7535
  7536     MOVE PM-INS-TERMINATION-DT  TO  WS-EXP-DT.
  7537     GO TO 6200-START-FINAL-EDITS.
  7538
  7539 6195-EMPLCY-NOT-FOUND.
  7540
  7541     MOVE ER-9483                TO  EMI-ERROR.
  7542     MOVE -1                     TO  NEFFDTEL.
  7543     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7544     GO TO 6300-EXIT.
  7545
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 146
* EL154.cbl
  7547 6200-START-FINAL-EDITS.
  7548
  7549******************************************************************
  7550****** VERIFY ELIMINATION PERIOD
  7551******************************************************************
  7552
  7553     IF CL-PAID-THRU-DT NOT EQUAL LOW-VALUES
  7554          GO TO 6225-CONTINUE-EDIT.
  7555
  7556     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7557         GO TO 6225-CONTINUE-EDIT.
  7558
  7559     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
  7560     MOVE WS-ACCESS              TO CNTL-GENL.
  7561     MOVE PI-COMPANY-ID          TO CNTL-CO.
  7562     MOVE '5'                    TO CNTL-RECORD-TYPE.
  7563     MOVE ZEROS                  TO CNTL-SEQ.
  7564
  7565     IF WS-BEN-CD = ZEROS
  7566         MOVE ER-0283            TO EMI-ERROR
  7567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7568         MOVE -1                 TO NFSTPMTL
  7569         MOVE AL-UNBON           TO NFSTPMTA
  7570         GO TO 6300-EXIT.
  7571
  7572     PERFORM 7200-LOCATE-BENEFIT THRU 7200-EXIT.
  7573
  7574     IF NOT BENEFIT-FOUND
  7575         MOVE ER-0283            TO EMI-ERROR
  7576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7577         MOVE -1                 TO NFSTPMTL
  7578         MOVE AL-UNBON           TO NFSTPMTA
  7579         GO TO 6300-EXIT.
  7580
  7581     MOVE CF-BENEFIT-ALPHA (SUB-1) TO PI-BENEFIT-SAVE.
  7582
  7583     IF PI-BEN-DAYS NOT NUMERIC
  7584        MOVE ZEROS               TO PI-BEN-DAYS.
  7585
  7586     IF PI-BEN-TYPE = 'R'
  7587         IF PI-BEN-DAYS IS EQUAL TO ZEROS
  7588             NEXT SENTENCE
  7589         ELSE
  7590             SUBTRACT 1 FROM PI-BEN-DAYS.
  7591
  7592     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
  7593     MOVE PI-BEN-DAYS            TO DC-ELAPSED-DAYS.
  7594     MOVE +0                     TO DC-ELAPSED-MONTHS.
  7595     MOVE '6'                    TO DC-OPTION-CODE.
  7596     PERFORM 9700-DATE-LINK.
  7597     MOVE DC-BIN-DATE-2          TO RETRO-ELIM-DATE.
  7598     IF NO-EFFDTE-ENTERED
  7599        IF PI-BEN-TYPE EQUAL 'E'
  7600          MOVE  SPACES              TO  WS-ELIMINATION-SW
  7601          MOVE  DC-BIN-DATE-2       TO  NEFFDTE-SAVE
  7602          MOVE  DC-GREG-DATE-1-MDY  TO  NEFFDTEO
  7603          INSPECT NEFFDTEI CONVERTING SPACES TO '/'.
  7604
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 147
* EL154.cbl
  7605     IF PI-BEN-TYPE = 'E'
  7606         IF RETRO-ELIM-DATE GREATER THAN NEFFDTE-SAVE
  7607             MOVE ER-0541            TO EMI-ERROR
  7608             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7609             MOVE -1                 TO NEFFDTEL
  7610             MOVE AL-UNBON           TO NEFFDTEA.
  7611
  7612     IF PI-BEN-TYPE = 'R'
  7613         IF RETRO-ELIM-DATE GREATER THAN NFSTPMT-SAVE
  7614             MOVE ER-0541            TO EMI-ERROR
  7615             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7616             MOVE -1                 TO NEFFDTEL
  7617             MOVE AL-UNBON           TO NEFFDTEA.
  7618
  7619
  7620 6225-CONTINUE-EDIT.
  7621******************************************************
  7622*VERIFY THAT THE LAST PAYMENT DATE IS NOT BEYOND     *
  7623*THE EXPIRATION DATE.                                *
  7624******************************************************
  7625* FOR BIU ALLOW PAYMENT PAST EXP + 7 MONTHS
  7626     MOVE WS-EXP-DT TO DC-BIN-DATE-1.
  7627     MOVE 6         TO DC-OPTION-CODE.
  7628     MOVE 0         TO DC-ELAPSED-DAYS.
  7629     MOVE 7         TO DC-ELAPSED-MONTHS.
  7630     PERFORM 9700-DATE-LINK.
  7631     IF NO-CONVERSION-ERROR
  7632         MOVE DC-BIN-DATE-2 TO WS-EXP-DT-PLUS7
  7633     ELSE
  7634         MOVE WS-EXP-DT     TO WS-EXP-DT-PLUS7
  7635     END-IF.
  7636
  7637     IF NLSTPMT-SAVE GREATER THAN WS-EXP-DT
  7638       IF CL-CERT-ACCOUNT (9:2) = 'BI' AND
  7639                      NLSTPMT-SAVE <= WS-EXP-DT-PLUS7
  7640         IF PI-LAST-ERROR-NO EQUAL ER-3396 OR ER-0670
  7641             CONTINUE
  7642         ELSE
  7643             MOVE ER-3396             TO EMI-ERROR
  7644             MOVE AL-UABON            TO NLSTPMTA
  7645             MOVE -1                  TO NLSTPMTL
  7646             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7647         END-IF
  7648       ELSE
  7649        MOVE ER-0396             TO EMI-ERROR
  7650        MOVE AL-UABON            TO NLSTPMTA
  7651        MOVE -1                  TO NLSTPMTL
  7652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7653        GO TO 6300-EXIT.
  7654
  7655******************************************************
  7656*VERIFY THAT THE LAST PAYMENT DATE IS GREATER THAN   *
  7657*THE FIRST PAYMENT DATE.                             *
  7658******************************************************
  7659
  7660     IF NLSTPMT-SAVE NOT GREATER THAN NFSTPMT-SAVE
  7661        MOVE ER-0559             TO EMI-ERROR
  7662        MOVE AL-UABON            TO NLSTPMTA
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 148
* EL154.cbl
  7663        MOVE -1                  TO NLSTPMTL
  7664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7665        GO TO 6300-EXIT.
  7666
  7667******************************************************
  7668*    MAKE SURE THE DIFFERENCE BETWEEN THE FIRST      *
  7669*    PAYMENT DATE AND LAST PAYMENT DATE IS           *
  7670*    DIVISABLE BY THE INTERVAL OF MONTHS,            *
  7671*    AND THE DURATION IS IN FULL MONTH PMTS.         *
  7672******************************************************
  7673     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  7674     MOVE NLSTPMT-SAVE           TO DC-BIN-DATE-2.
  7675     MOVE '1'                    TO DC-OPTION-CODE.
  7676     PERFORM 9700-DATE-LINK.
  7677     DIVIDE DC-ELAPSED-MONTHS BY NMONTHSI GIVING WS-WORK
  7678            REMAINDER WS-REMAINDER.
  7679     IF WS-REMAINDER NOT = 0
  7680        MOVE ER-0397             TO EMI-ERROR
  7681        MOVE -1                  TO NMONTHSL
  7682        MOVE AL-UNBON            TO NMONTHSA
  7683        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7684        GO TO 6300-EXIT.
  7685
  7686     IF DC-ODD-DAYS-OVER GREATER THAN +0
  7687        MOVE ER-0597             TO EMI-ERROR
  7688        MOVE -1                  TO NLSTPMTL
  7689        MOVE AL-UNBON            TO NLSTPMTA
  7690                                    NFSTPMTA
  7691        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7692        GO TO 6300-EXIT.
  7693
  7694******************************************************
  7695*    VERIFY THAT FIRST PAYMENT DATE IS NOT LESS      *
  7696*    THAN THE CURRENT DATE.                          *
  7697******************************************************
  7698     IF NFSTPMT-SAVE LESS THAN CURRENT-SAVE
  7699        MOVE ER-0563             TO EMI-ERROR
  7700        MOVE -1                  TO NFSTPMTL
  7701        MOVE AL-UNBON            TO NFSTPMTA
  7702        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7703        GO TO 6300-EXIT.
  7704
  7705******************************************************
  7706*                                                    *
  7707*    EDIT THE NUMBER OF DAYS IN FIRST PAYMENT        *
  7708*                                                    *
  7709******************************************************
  7710
  7711     MOVE NEFFDTE-SAVE       TO DC-BIN-DATE-1
  7712     MOVE -1                 TO DC-ELAPSED-DAYS
  7713     MOVE +0                 TO DC-ELAPSED-MONTHS
  7714     MOVE '6'                TO DC-OPTION-CODE
  7715     PERFORM 9700-DATE-LINK
  7716     IF NO-CONVERSION-ERROR
  7717        MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1.
  7718
  7719     MOVE NFSTPMT-SAVE       TO DC-BIN-DATE-2
  7720     MOVE +0                 TO DC-ELAPSED-MONTHS
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 149
* EL154.cbl
  7721                                DC-ELAPSED-DAYS
  7722     MOVE '1'                TO DC-OPTION-CODE
  7723     PERFORM 9700-DATE-LINK
  7724     IF NO-CONVERSION-ERROR
  7725        MOVE DC-ELAPSED-DAYS  TO WS-ELAPSED-DAYS.
  7726
  7727     IF NDAYSFL EQUAL +0
  7728       OR
  7729        NDAYSFI NOT NUMERIC
  7730       OR
  7731        NDAYSFI EQUAL ZEROS
  7732        MOVE DC-ELAPSED-DAYS  TO NDAYSFI.
  7733
  7734     IF DATE1-GREATER-DATE2
  7735        MOVE ER-0450 TO EMI-ERROR
  7736        MOVE -1      TO NEFFDTEL
  7737        MOVE AL-UABON TO NEFFDTEA
  7738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7739        GO TO 6300-EXIT.
  7740
  7741     ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL
  7742     SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL
  7743     IF WS-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7744        WS-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7745        NDAYSFI = ZEROS
  7746         MOVE ER-0398             TO EMI-ERROR
  7747         MOVE -1                  TO NDAYSFL
  7748         MOVE AL-UNBON            TO NDAYSFA
  7749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7750         GO TO 6300-EXIT.
  7751
  7752******************************************************
  7753*                                                    *
  7754*    VERIFY OR CALCULATE THE FIRST PAYMENT AMOUNT    *
  7755*                                                    *
  7756******************************************************
  7757
  7758     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
  7759     MOVE NEFFDTE-SAVE          TO CP-PAID-FROM-DATE.
  7760     MOVE NFSTPMT-SAVE          TO CP-PAID-THRU-DT.
  7761     MOVE WS-CALC-METHOD        TO CP-CLAIM-CALC-METHOD.
  7762
  7763     IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  7764         MOVE PM-PRODUCER           TO CP-ACCOUNT-NUMBER
  7765         MOVE PM-INS-MONTH-BENEFIT  TO  CP-ORIGINAL-BENEFIT
  7766     ELSE
  7767         MOVE CM-AH-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
  7768         MOVE CM-ACCOUNT            TO CP-ACCOUNT-NUMBER.
  7769
  7770
  7771* EXEC CICS LINK
  7772*         PROGRAM   ('ELPMNT')
  7773*         COMMAREA  (CALCULATION-PASS-AREA)
  7774*         LENGTH    (CP-COMM-LENGTH)
  7775*    END-EXEC.
  7776     MOVE 'ELPMNT' TO DFHEIV1
  7777*    MOVE '."C                   (   #00007380' TO DFHEIV0
  7778     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 150
* EL154.cbl
  7779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7780     MOVE X'2020233030303037333830' TO DFHEIV0(25:11)
  7781     CALL 'kxdfhei1' USING DFHEIV0,
  7782           DFHEIV1,
  7783           CALCULATION-PASS-AREA,
  7784           CP-COMM-LENGTH,
  7785           DFHEIV99,
  7786           DFHEIV99,
  7787           DFHEIV99,
  7788           DFHEIV99
  7789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7790
  7791
  7792     IF CP-CLAIM-PAYMENT NOT NUMERIC
  7793        MOVE +0 TO CP-CLAIM-PAYMENT.
  7794
  7795     IF CP-ACTUAL-DAYS NOT NUMERIC
  7796        MOVE +0 TO CP-ACTUAL-DAYS.
  7797
  7798     IF NFSTAMT-SAVE EQUAL +0
  7799        MOVE CP-CLAIM-PAYMENT TO NFSTAMT-SAVE
  7800                                 NFSTAMTO.
  7801
  7802     IF NDAYSFI EQUAL ZEROS
  7803        MOVE CP-ACTUAL-DAYS   TO NDAYSFI.
  7804
  7805
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 151
* EL154.cbl
  7807******************************************************
  7808*    VERIFY THAT DAYS IN FIRST PAY PERIOD IS REALLY  *
  7809*    THE DIFFERENCE BETWEEN THE IST PAYMENT DATE     *
  7810*    AND THE EFFECTIVE DATE                          *
  7811******************************************************
  7812*    MOVE NEFFDTE-SAVE           TO DC-BIN-DATE-1.
  7813*    MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-2.
  7814*    MOVE '1'                    TO DC-OPTION-CODE.
  7815*    PERFORM 9700-DATE-LINK.
  7816*    IF DATE1-GREATER-DATE2
  7817*       MOVE ER-0450 TO EMI-ERROR
  7818*       MOVE -1      TO NEFFDTEL
  7819*       MOVE AL-UABON TO NEFFDTEA
  7820*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7821*       GO TO 6300-EXIT.
  7822*
  7823*    ADD WS-DAY-TOL    NDAYSFI GIVING WS-DAYS-PLUS-TOL.
  7824*    SUBTRACT WS-DAY-TOL FROM NDAYSFI GIVING WS-DAYS-MINUS-TOL.
  7825*    IF DC-ELAPSED-DAYS  LESS THAN WS-DAYS-MINUS-TOL  OR
  7826*       DC-ELAPSED-DAYS GREATER THAN WS-DAYS-PLUS-TOL OR
  7827*       NDAYSFI = ZEROS
  7828*        MOVE ER-0398             TO EMI-ERROR
  7829*        MOVE -1                  TO NDAYSFL
  7830*        MOVE AL-UNBON            TO NDAYSFA
  7831*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7832*        GO TO 6300-EXIT.
  7833*
  7834******************************************************
  7835*   VERIFY THAT THE FIRST PAYMENT AMOUNT IS WITHIN   *
  7836*   THE TOLERANCE OF THE DAILY BENEFITS              *
  7837******************************************************
  7838*    IF CL-PMT-CALC-METHOD = '2' OR '5'
  7839*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 365
  7840*    ELSE
  7841*       COMPUTE WS-DAILY-BEN-AMT = CM-AH-BENEFIT-AMT * 12  / 360.
  7842
  7843     IF WS-AMT-TOL NOT = ZEROS
  7844        COMPUTE WS-AMT-PLUS-TOL = (NFSTAMT-SAVE + WS-AMT-TOL)
  7845        COMPUTE WS-AMT-MINUS-TOL = (NFSTAMT-SAVE - WS-AMT-TOL)
  7846        IF CP-CLAIM-PAYMENT LESS THAN WS-AMT-MINUS-TOL OR
  7847           CP-CLAIM-PAYMENT GREATER THAN WS-AMT-PLUS-TOL OR
  7848           NFSTAMT-SAVE = +0
  7849           MOVE ER-0399          TO EMI-ERROR
  7850           MOVE -1               TO NFSTAMTL
  7851           MOVE AL-UNBON         TO NFSTAMTA
  7852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7853           GO TO 6300-EXIT.
  7854
  7855******************************************************
  7856*   VERIFY THERE IS AN ADDR TRAILER AVAILABLE        *
  7857*   FOR THE PAYEE CODE SPECIFIED                     *
  7858******************************************************
  7859     IF (WS-PAYEE-CD EQUAL 'I' AND
  7860        WS-PAYEE-SEQ-NUM GREATER THAN CL-INSURED-ADDR-CNT)
  7861       OR
  7862        (WS-PAYEE-CD EQUAL 'B' AND
  7863        WS-PAYEE-SEQ-NUM GREATER THAN CL-BENIF-ADDR-CNT)
  7864       OR
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 152
* EL154.cbl
  7865        (WS-PAYEE-CD EQUAL 'A' AND
  7866        WS-PAYEE-SEQ-NUM GREATER THAN CL-ACCOUNT-ADDR-CNT)
  7867        GO TO 6250-ADDR-ERROR.
  7868
  7869     IF (WS-PAYEE-CD EQUAL 'I')
  7870       OR
  7871        ((WS-PAYEE-CD EQUAL 'B' OR 'A') AND
  7872        (WS-PAYEE-SEQ-NUM GREATER THAN 0))
  7873        GO TO 6260-CONT.
  7874
  7875     IF WS-PAYEE-CD EQUAL 'A'
  7876        GO TO 6260-CONT.
  7877
  7878     IF (WS-PAYEE-CD EQUAL 'B' AND
  7879        CL-BENEFICIARY EQUAL SPACES)
  7880        GO TO 6250-ADDR-ERROR.
  7881
  7882     MOVE PI-COMPANY-CD          TO BENE-CO.
  7883     MOVE 'B'                    TO BENE-REC-TYPE.
  7884     MOVE CL-BENEFICIARY         TO BENE-CODE.
  7885
  7886
  7887* EXEC CICS HANDLE CONDITION
  7888*         NOTFND   (6250-ADDR-ERROR)
  7889*         END-EXEC.
  7890*    MOVE '"$I                   ! , #00007480' TO DFHEIV0
  7891     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7893     MOVE X'2C20233030303037343830' TO DFHEIV0(25:11)
  7894     CALL 'kxdfhei1' USING DFHEIV0
  7895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7896
  7897
  7898
  7899* EXEC CICS READ
  7900*         DATASET     (BENE-ID)
  7901*         SET         (ADDRESS OF BENEFICIARY-MASTER)
  7902*         RIDFLD      (BENE-KEY)
  7903*         END-EXEC.
  7904*    MOVE '&"S        E          (   #00007484' TO DFHEIV0
  7905     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7906     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7907     MOVE X'2020233030303037343834' TO DFHEIV0(25:11)
  7908     CALL 'kxdfhei1' USING DFHEIV0,
  7909           BENE-ID,
  7910           DFHEIV20,
  7911           DFHEIV99,
  7912           BENE-KEY,
  7913           DFHEIV99,
  7914           DFHEIV99,
  7915           DFHEIV99
  7916     SET ADDRESS OF BENEFICIARY-MASTER TO
  7917         DFHEIV20
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7919
  7920
  7921     GO TO 6260-CONT.
  7922
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 153
* EL154.cbl
  7923 6250-ADDR-ERROR.
  7924     IF (PI-COMPANY-ID EQUAL 'AIG' OR 'AUK' OR 'CIG' OR 'CUK')
  7925         IF (WS-PAYEE-CD EQUAL 'B')   AND
  7926            (WS-PAYEE-SEQ-NUM EQUAL 9)
  7927             GO TO 6260-CONT.
  7928
  7929     MOVE ER-0401         TO EMI-ERROR.
  7930     MOVE -1              TO NPAYEEL.
  7931     MOVE AL-UNBON        TO NPAYEEA.
  7932     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7933
  7934 6260-CONT.
  7935******************************************************
  7936*   VERIFY THAT THE EFFECTIVE DATE IS NOT            *
  7937*   BEFORE THE INCURRED DATE                         *
  7938******************************************************
  7939     IF NEFFDTE-SAVE LESS THAN CL-INCURRED-DT
  7940        MOVE ER-0402             TO EMI-ERROR
  7941        MOVE -1                  TO NEFFDTEL
  7942        MOVE AL-UABON            TO NEFFDTEA
  7943        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7944
  7945******************************************************
  7946*   VERIFY THAT THE CLAIM HAS NOT BEEN CLOSED.       *
  7947******************************************************
  7948     IF CLAIM-IS-CLOSED
  7949        MOVE ER-1599            TO EMI-ERROR
  7950        MOVE -1                  TO TERML
  7951        MOVE AL-UABON            TO TERMA
  7952        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7953
  7954******************************************************
  7955*  VERIFY THAT THE EFFECTIVE DATE IS                 *
  7956*  SUBSEQUENT TO THE PAID-THRU DATE                  *
  7957******************************************************
  7958     IF NEFFDTE-SAVE NOT GREATER THAN CL-PAID-THRU-DT
  7959        MOVE ER-0403             TO EMI-ERROR
  7960        MOVE -1                  TO NEFFDTEL
  7961        MOVE AL-UABON            TO NEFFDTEA
  7962        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7963
  7964******************************************************
  7965*  VERIFY THAT THE NUMBER OF MONTHS BETWEEN          *
  7966*  THE EFFECTIVE DATE AND THE LAST PAYMENT DATE      *
  7967*  IS NOT GREATER THAN THE MAXIMUM ALLOWED           *
  7968******************************************************
  7969     IF WS-MAX-AUTO-MOS NOT = ZEROS
  7970        MOVE NEFFDTE-SAVE        TO DC-BIN-DATE-1
  7971        MOVE NLSTPMT-SAVE        TO DC-BIN-DATE-2
  7972        MOVE '1'                 TO DC-OPTION-CODE
  7973        PERFORM 9700-DATE-LINK
  7974        IF DC-ELAPSED-MONTHS GREATER THAN WS-MAX-AUTO-MOS
  7975           MOVE ER-0404             TO EMI-ERROR
  7976           MOVE -1                  TO NEFFDTEL
  7977           MOVE AL-UABON            TO NEFFDTEA NLSTPMTA
  7978           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7979
  7980******************************************************
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 154
* EL154.cbl
  7981*  VERIFY THAT THE CERTIFICATE DOES NOT HAVE A       *
  7982*  CURRENT STATUS OF '8' (CANCEL APPLIED)            *
  7983******************************************************
  7984
  7985     IF PI-COMPANY-ID IS EQUAL TO 'HAN' OR 'LGX'
  7986         IF CM-AH-CANCEL-APPLIED
  7987             MOVE ER-0839            TO  EMI-ERROR
  7988             MOVE -1                 TO  ENTERPFL
  7989             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7990******************************************************************
  7991*   check to see if the pd thru dates are past the benefit exp dt
  7992******************************************************************
  7993
  7994     if pi-company-id not = 'DCC'
  7995        GO TO 6300-EXIT
  7996     END-IF
  7997
  7998     perform 6320-read-acct      thru 6320-exit
  7999     perform 6340-GET-DDF-FACTORS
  8000                                 thru 6340-exit
  8001     if ws-max-benefit-amt not = zeros
  8002        and ws-max-benefit-amt < ws-monthly-benefit
  8003        move ws-max-benefit-amt  to ws-monthly-benefit
  8004     end-if
  8005     perform 6350-get-cert-trlr  thru 6350-exit
  8006
  8007     if (nfstamt-save = zeros)
  8008        or (nfstamt-save = cp-claim-payment)
  8009        move ws-monthly-benefit  to nfstamt-save
  8010                                    nfstamto
  8011     end-if
  8012
  8013     if nfstamt-save > ws-monthly-benefit
  8014        move er-1657             to emi-error
  8015        move -1                  to nfstamtl
  8016        move al-unbon            to nfstamta
  8017        perform 9900-error-format
  8018                                 thru 9900-exit
  8019     end-if
  8020
  8021     if nfstamt-save = zeros
  8022        move ws-monthly-benefit to nfstamt-save
  8023     end-if
  8024
  8025     move cm-ah-loan-expire-dt   to ws-benefit-expiration-dt
  8026     IF CL-CRITICAL-PERIOD NOT = ZEROS and spaces
  8027        move cl-critical-period  to dc-elapsed-months
  8028        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
  8029        MOVE ZEROS               TO DC-ELAPSED-DAYS
  8030        MOVE '6'                 TO DC-OPTION-CODE
  8031        PERFORM 9700-DATE-LINK
  8032        MOVE DC-BIN-DATE-2       TO ws-BENEFIT-EXPIRATION-DT
  8033     END-IF
  8034
  8035     if nlstpmt-save > ws-benefit-expiration-dt
  8036        move er-1658             to emi-error
  8037        move -1                  to nlstpmtl
  8038        move al-uabon            to nlstpmta
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 155
* EL154.cbl
  8039        perform 9900-error-format thru 9900-exit
  8040     end-if
  8041
  8042     MOVE cl-control-primary     TO ELTRLR-KEY
  8043     MOVE +95                    TO TRLR-SEQ-NO
  8044
  8045* EXEC CICS READ
  8046*       DATASET  ('ELTRLR')
  8047*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8048*       RIDFLD   (ELTRLR-KEY)
  8049*       RESP     (WS-RESPONSE)
  8050*    END-EXEC
  8051     MOVE 'ELTRLR' TO DFHEIV1
  8052*    MOVE '&"S        E          (  N#00007613' TO DFHEIV0
  8053     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8055     MOVE X'204E233030303037363133' TO DFHEIV0(25:11)
  8056     CALL 'kxdfhei1' USING DFHEIV0,
  8057           DFHEIV1,
  8058           DFHEIV20,
  8059           DFHEIV99,
  8060           ELTRLR-KEY,
  8061           DFHEIV99,
  8062           DFHEIV99,
  8063           DFHEIV99
  8064     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8065         DFHEIV20
  8066     MOVE EIBRESP  TO WS-RESPONSE
  8067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8068
  8069     if ws-resp-normal
  8070        perform varying s1 from +1 by +1 until
  8071           at-note-error-no (s1) = spaces
  8072           if at-note-error-no (s1) not = '1661' and '1662'
  8073           move at-note-error-no (s1)
  8074                                 to emi-error
  8075           if at-note-error-no (s1) = '1653'
  8076              evaluate true
  8077                 when cl-claim-type = 'L'
  8078                    move '  LF  '
  8079                                 to emi-claim-type
  8080                 when cl-claim-type = 'I'
  8081                    move '  IU  '
  8082                                 to emi-claim-type
  8083                 when other
  8084                    move '  AH  '
  8085                                 to emi-claim-type
  8086              end-evaluate
  8087           end-if
  8088           move -1               to nlstpmtl
  8089           PERFORM 9900-ERROR-FORMAT
  8090                                 THRU 9900-EXIT
  8091           end-if
  8092        end-perform
  8093     end-if
  8094
  8095     .
  8096 6300-EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 156
* EL154.cbl
  8097      EXIT.
  8098 6320-read-acct.
  8099
  8100     move spaces              to WS-ACCT-RECORD-SW
  8101                                 ws-dcc-product-code
  8102
  8103     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
  8104     MOVE PI-CARRIER          TO ACCT-CARRIER
  8105     MOVE PI-GROUPING         TO ACCT-GROUPING
  8106     MOVE PI-STATE            TO ACCT-STATE
  8107     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
  8108     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
  8109     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
  8110
  8111
  8112* EXEC CICS READ
  8113*       DATASET ('ERACCT')
  8114*       RIDFLD  (ERACCT-KEY)
  8115*       SET     (ADDRESS OF ACCOUNT-MASTER)
  8116*       GTEQ
  8117*       resp    (WS-RESPONSE)
  8118*    END-EXEC
  8119     MOVE 'ERACCT' TO DFHEIV1
  8120*    MOVE '&"S        G          (  N#00007662' TO DFHEIV0
  8121     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8122     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8123     MOVE X'204E233030303037363632' TO DFHEIV0(25:11)
  8124     CALL 'kxdfhei1' USING DFHEIV0,
  8125           DFHEIV1,
  8126           DFHEIV20,
  8127           DFHEIV99,
  8128           ERACCT-KEY,
  8129           DFHEIV99,
  8130           DFHEIV99,
  8131           DFHEIV99
  8132     SET ADDRESS OF ACCOUNT-MASTER TO
  8133         DFHEIV20
  8134     MOVE EIBRESP  TO WS-RESPONSE
  8135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8136     IF WS-RESP-NORMAL
  8137        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
  8138        and pi-cert-eff-dt < am-expiration-dt
  8139        and pi-cert-eff-dt >= am-effective-dt
  8140        move am-dcc-product-code to ws-dcc-product-code
  8141        set acct-found           to true
  8142     end-if
  8143
  8144     .
  8145 6320-exit.
  8146     exit.
  8147
  8148 6340-GET-DDF-FACTORS.
  8149
  8150     MOVE ' '                    TO WS-PDEF-RECORD-SW
  8151     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  8152     MOVE pi-state               TO ERPDEF-STATE
  8153     MOVE WS-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  8154     MOVE 'A'                    TO ERPDEF-BEN-TYPE
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 157
* EL154.cbl
  8155     MOVE ws-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
  8156     MOVE pi-CERT-EFF-DT         TO ERPDEF-EXP-DT
  8157
  8158     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  8159
  8160
  8161* EXEC CICS STARTBR
  8162*        DATASET  ('ERPDEF')
  8163*        RIDFLD   (ERPDEF-KEY)
  8164*        GTEQ
  8165*        RESP     (WS-RESPONSE)
  8166*    END-EXEC
  8167     MOVE 'ERPDEF' TO DFHEIV1
  8168     MOVE 0
  8169       TO DFHEIV11
  8170*    MOVE '&,         G          &  N#00007693' TO DFHEIV0
  8171     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8172     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8173     MOVE X'204E233030303037363933' TO DFHEIV0(25:11)
  8174     CALL 'kxdfhei1' USING DFHEIV0,
  8175           DFHEIV1,
  8176           ERPDEF-KEY,
  8177           DFHEIV99,
  8178           DFHEIV11,
  8179           DFHEIV99
  8180     MOVE EIBRESP  TO WS-RESPONSE
  8181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8182
  8183     IF NOT WS-RESP-NORMAL
  8184        GO TO 6340-EXIT
  8185     END-IF
  8186
  8187     .
  8188 6340-READNEXT.
  8189
  8190
  8191* EXEC CICS READNEXT
  8192*       DATASET  ('ERPDEF')
  8193*       SET      (ADDRESS OF PRODUCT-MASTER)
  8194*       RIDFLD   (ERPDEF-KEY)
  8195*       RESP     (WS-RESPONSE)
  8196*    END-EXEC
  8197     MOVE 'ERPDEF' TO DFHEIV1
  8198     MOVE 0
  8199       TO DFHEIV11
  8200*    MOVE '&.S                   )  N#00007707' TO DFHEIV0
  8201     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8202     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8203     MOVE X'204E233030303037373037' TO DFHEIV0(25:11)
  8204     CALL 'kxdfhei1' USING DFHEIV0,
  8205           DFHEIV1,
  8206           DFHEIV20,
  8207           DFHEIV99,
  8208           ERPDEF-KEY,
  8209           DFHEIV99,
  8210           DFHEIV11,
  8211           DFHEIV99,
  8212           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 158
* EL154.cbl
  8213     SET ADDRESS OF PRODUCT-MASTER TO
  8214         DFHEIV20
  8215     MOVE EIBRESP  TO WS-RESPONSE
  8216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8217
  8218     IF NOT WS-RESP-NORMAL
  8219        GO TO 6340-ENDBR
  8220     END-IF
  8221
  8222     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  8223        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  8224           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  8225        ELSE
  8226           GO TO 6340-READNEXT
  8227        END-IF
  8228     ELSE
  8229        GO TO 6340-ENDBR
  8230     END-IF
  8231
  8232     PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  8233        (P1 > +8)
  8234        OR (PD-PROD-CODE (P1) = cl-claim-type)
  8235     END-PERFORM
  8236     IF P1 < +9
  8237        MOVE PD-MAX-AMT (P1)     TO ws-max-benefit-amt
  8238        move pd-crit-period (p1) to ws-max-benefit-pmts
  8239     END-IF
  8240
  8241     .
  8242 6340-ENDBR.
  8243
  8244
  8245* EXEC CICS ENDBR
  8246*       DATASET  ('ERPDEF')
  8247*    END-EXEC
  8248     MOVE 'ERPDEF' TO DFHEIV1
  8249     MOVE 0
  8250       TO DFHEIV11
  8251*    MOVE '&2                    $   #00007740' TO DFHEIV0
  8252     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8253     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8254     MOVE X'2020233030303037373430' TO DFHEIV0(25:11)
  8255     CALL 'kxdfhei1' USING DFHEIV0,
  8256           DFHEIV1,
  8257           DFHEIV11,
  8258           DFHEIV99
  8259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8260
  8261     .
  8262 6340-EXIT.
  8263     EXIT.
  8264
  8265 6350-get-cert-trlr.
  8266
  8267     move spaces                 to ws-cert-trlr-sw
  8268     move zeros                  to ws-benefits-prev-paid
  8269     move cl-cert-key-data       to elcrtt-key (2:21)
  8270     move cl-company-cd          to ctrlr-comp-cd
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 159
* EL154.cbl
  8271     move cl-cert-no             to ctrlr-cert-no
  8272     move 'B'                    to ctrlr-rec-type
  8273
  8274
  8275* EXEC CICS READ
  8276*       DATASET  ('ELCRTT')
  8277*       set      (address of CERTIFICATE-TRAILERS)
  8278*       RIDFLD   (ELCRTT-KEY)
  8279*       RESP     (WS-RESPONSE)
  8280*    END-EXEC
  8281     MOVE 'ELCRTT' TO DFHEIV1
  8282*    MOVE '&"S        E          (  N#00007757' TO DFHEIV0
  8283     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8284     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8285     MOVE X'204E233030303037373537' TO DFHEIV0(25:11)
  8286     CALL 'kxdfhei1' USING DFHEIV0,
  8287           DFHEIV1,
  8288           DFHEIV20,
  8289           DFHEIV99,
  8290           ELCRTT-KEY,
  8291           DFHEIV99,
  8292           DFHEIV99,
  8293           DFHEIV99
  8294     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8295         DFHEIV20
  8296     MOVE EIBRESP  TO WS-RESPONSE
  8297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8298     IF not WS-RESP-NORMAL
  8299        go to 6350-exit
  8300     end-if
  8301
  8302     set cert-trlr-found         to true
  8303*    if cl-insured-claim = 'P'
  8304*       move +1 to s1
  8305*    else
  8306*       MOVE +2 to s1
  8307*    end-if
  8308
  8309     move +1 to s1
  8310     evaluate cl-claim-type
  8311        when 'A'
  8312           move +1 to s2
  8313        when 'I'
  8314           move +2 to s2
  8315        when 'G'
  8316           move +3 to s2
  8317        when 'L'
  8318           move +4 to s2
  8319        when 'P'
  8320           move +5 to s2
  8321     end-evaluate
  8322
  8323     compute ws-benefits-prev-paid =
  8324        (cs-total-paid (s1 s2) / ws-monthly-benefit)
  8325
  8326     .
  8327 6350-exit.
  8328     exit.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 160
* EL154.cbl
  8329 6400-PAYMENT-CALCULATION.
  8330
  8331     IF WS-CALC-METHOD = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  8332         IF CL-SYSTEM-IDENTIFIER IS EQUAL TO 'CV'
  8333             COMPUTE NREGPMT-SAVE ROUNDED =
  8334                 (PM-INS-MONTH-BENEFIT * NMONTHSI)
  8335             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8336             GO TO 6499-EXIT
  8337         ELSE
  8338             COMPUTE NREGPMT-SAVE ROUNDED =
  8339                 (ws-monthly-benefit * NMONTHSI)
  8340             MOVE NREGPMT-SAVE   TO  NREGAMTO
  8341             GO TO 6499-EXIT.
  8342
  8343     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8344     MOVE +0                     TO DC-ELAPSED-DAYS.
  8345     MOVE NMONTHSI               TO DC-ELAPSED-MONTHS.
  8346     MOVE '6'                    TO DC-OPTION-CODE.
  8347     PERFORM 9700-DATE-LINK.
  8348
  8349     MOVE NFSTPMT-SAVE           TO DC-BIN-DATE-1.
  8350     MOVE '1'                    TO DC-OPTION-CODE.
  8351     PERFORM 9700-DATE-LINK.
  8352
  8353     IF (PI-COMPANY-ID  = 'FIA' AND
  8354        CL-CERT-ACCOUNT = '0000011043')
  8355        COMPUTE WS-DAILY-RATE ROUNDED =
  8356                             (CM-AH-BENEFIT-AMT * 13) / 365
  8357        COMPUTE NREGPMT-SAVE ROUNDED =
  8358                             WS-DAILY-RATE * DC-ELAPSED-DAYS
  8359        MOVE NREGPMT-SAVE  TO  NREGAMTO
  8360        GO TO 6499-EXIT.
  8361
  8362*    IF WS-CALC-METHOD = '4'
  8363*       COMPUTE WS-DAILY-RATE ROUNDED =
  8364*                            (CM-AH-BENEFIT-AMT / 30)
  8365*       COMPUTE NREGPMT-SAVE ROUNDED =
  8366*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8367*
  8368*    IF WS-CALC-METHOD = '5'
  8369*       COMPUTE WS-DAILY-RATE ROUNDED =
  8370*                            (CM-AH-BENEFIT-AMT * 12) / 365
  8371*       COMPUTE NREGPMT-SAVE ROUNDED =
  8372*                            WS-DAILY-RATE * DC-ELAPSED-DAYS.
  8373
  8374 6499-EXIT.
  8375      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 161
* EL154.cbl
  8377 6900-SET-CODES.
  8378     MOVE PI-CLAIM-NO            TO CLAM-CLAIM
  8379                                    ACTV-CLAIM.
  8380
  8381     MOVE PI-COMPANY-ID          TO CNTL-CO.
  8382
  8383     MOVE PI-COMPANY-CD          TO CLAM-CO
  8384                                    ACTV-CO
  8385                                    CERT-CO
  8386                                    EMPLCY-COMPANY-CD.
  8387
  8388     MOVE PI-CARRIER             TO CLAM-CARRIER
  8389                                    ACTV-CARRIER
  8390                                    CERT-CARRIER
  8391                                    EMPLCY-CARRIER.
  8392
  8393     MOVE PI-CERT-NO             TO CLAM-CERT-NUM
  8394                                    ACTV-CERT-NUM
  8395                                    CERT-CERT-NUM.
  8396
  8397     MOVE PI-GROUPING            TO CERT-GROUPING
  8398                                    EMPLCY-GROUPING.
  8399     MOVE PI-STATE               TO CERT-STATE
  8400                                    EMPLCY-STATE.
  8401     MOVE PI-ACCOUNT             TO CERT-ACCOUNT
  8402                                    EMPLCY-PRODUCER.
  8403     MOVE PI-CERT-EFF-DT         TO CERT-EFF-DT
  8404                                    EMPLCY-EFF-DT.
  8405     MOVE '2'                    TO CNTL-RECORD-TYPE.
  8406     MOVE PI-PROCESSOR-ID        TO CNTL-GENL.
  8407     MOVE ZEROS                  TO CNTL-SEQ.
  8408
  8409 6999-EXIT.
  8410      EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 162
* EL154.cbl
  8412 7000-BUILD-SCREEN.
  8413     PERFORM 6900-SET-CODES.
  8414
  8415
  8416* EXEC CICS HANDLE CONDITION
  8417*         NOTOPEN(8860-CLAM-NOT-OPEN)
  8418*         NOTFND (7090-CLAIM-NOT-FOUND)
  8419*         END-EXEC.
  8420*    MOVE '"$JI                  ! - #00007880' TO DFHEIV0
  8421     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8423     MOVE X'2D20233030303037383830' TO DFHEIV0(25:11)
  8424     CALL 'kxdfhei1' USING DFHEIV0
  8425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8426
  8427
  8428
  8429* EXEC CICS READ
  8430*         DATASET(CLAM-ID)
  8431*         SET    (ADDRESS OF CLAIM-MASTER)
  8432*         RIDFLD (CLAM-KEY)
  8433*         END-EXEC.
  8434*    MOVE '&"S        E          (   #00007885' TO DFHEIV0
  8435     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8436     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8437     MOVE X'2020233030303037383835' TO DFHEIV0(25:11)
  8438     CALL 'kxdfhei1' USING DFHEIV0,
  8439           CLAM-ID,
  8440           DFHEIV20,
  8441           DFHEIV99,
  8442           CLAM-KEY,
  8443           DFHEIV99,
  8444           DFHEIV99,
  8445           DFHEIV99
  8446     SET ADDRESS OF CLAIM-MASTER TO
  8447         DFHEIV20
  8448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8449
  8450
  8451     MOVE CL-CLAIM-NO            TO CLAIMO
  8452     MOVE CL-CERT-PRIME          TO CERTO
  8453     MOVE CL-CERT-SFX            TO SUFFIXO
  8454     MOVE CL-CARRIER             TO CARRO
  8455     MOVE CL-AUTO-PAY-SEQ        TO ACTV-SEQ.
  8456
  8457     IF ACTV-SEQ = ZEROS
  8458        GO TO 7080-NO-TRAILER.
  8459
  8460
  8461* EXEC CICS HANDLE CONDITION
  8462*         NOTOPEN(8870-ACTV-NOT-OPEN)
  8463*         NOTFND (7080-NO-TRAILER)
  8464*         END-EXEC.
  8465*    MOVE '"$JI                  ! . #00007900' TO DFHEIV0
  8466     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8467     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8468     MOVE X'2E20233030303037393030' TO DFHEIV0(25:11)
  8469     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 163
* EL154.cbl
  8470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8471
  8472
  8473
  8474* EXEC CICS READ
  8475*         DATASET(ACTV-ID)
  8476*         SET    (ADDRESS OF ACTIVITY-TRAILERS)
  8477*         RIDFLD (ACTV-KEY)
  8478*    END-EXEC.
  8479*    MOVE '&"S        E          (   #00007905' TO DFHEIV0
  8480     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8481     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8482     MOVE X'2020233030303037393035' TO DFHEIV0(25:11)
  8483     CALL 'kxdfhei1' USING DFHEIV0,
  8484           ACTV-ID,
  8485           DFHEIV20,
  8486           DFHEIV99,
  8487           ACTV-KEY,
  8488           DFHEIV99,
  8489           DFHEIV99,
  8490           DFHEIV99
  8491     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8492         DFHEIV20
  8493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8494
  8495
  8496     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
  8497     MOVE SPACE                  TO DC-OPTION-CODE.
  8498     PERFORM 9700-DATE-LINK.
  8499     MOVE DC-GREG-DATE-1-EDIT    TO CESTDTEI.
  8500
  8501
  8502     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
  8503     MOVE SPACE                  TO DC-OPTION-CODE.
  8504     PERFORM 9700-DATE-LINK.
  8505     MOVE DC-GREG-DATE-1-EDIT    TO CEFFDTEI.
  8506
  8507     IF AT-AUTO-PAY-DAY NUMERIC
  8508         MOVE AT-AUTO-PAY-DAY    TO DAY2PAYI
  8509     ELSE
  8510         MOVE ZEROS              TO DAY2PAYI.
  8511
  8512     IF PI-USES-PAID-TO
  8513         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8514         MOVE '6'                     TO  DC-OPTION-CODE
  8515         MOVE +1                      TO  DC-ELAPSED-DAYS
  8516         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8517         PERFORM 9700-DATE-LINK
  8518         IF NO-CONVERSION-ERROR
  8519             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
  8520         ELSE
  8521             MOVE LOW-VALUES          TO  CFSTPMTI
  8522     ELSE
  8523         MOVE AT-1ST-PAY-THRU-DT      TO  DC-BIN-DATE-1
  8524         MOVE SPACE                   TO  DC-OPTION-CODE
  8525         PERFORM 9700-DATE-LINK
  8526         IF NO-CONVERSION-ERROR
  8527             MOVE DC-GREG-DATE-1-EDIT TO  CFSTPMTI
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 164
* EL154.cbl
  8528         ELSE
  8529             MOVE LOW-VALUES          TO  CFSTPMTI.
  8530
  8531     IF PI-USES-PAID-TO
  8532         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8533         MOVE '6'                     TO  DC-OPTION-CODE
  8534         MOVE +1                      TO  DC-ELAPSED-DAYS
  8535         MOVE +0                      TO  DC-ELAPSED-MONTHS
  8536         PERFORM 9700-DATE-LINK
  8537         IF NO-CONVERSION-ERROR
  8538             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8539         ELSE
  8540             MOVE LOW-VALUES          TO  CLSTPMTI
  8541     ELSE
  8542         MOVE AT-SCHEDULE-END-DT      TO  DC-BIN-DATE-1
  8543         MOVE SPACE                   TO  DC-OPTION-CODE
  8544         MOVE +0                      TO  DC-ELAPSED-DAYS
  8545                                          DC-ELAPSED-MONTHS
  8546         PERFORM 9700-DATE-LINK
  8547         IF NO-CONVERSION-ERROR
  8548             MOVE DC-GREG-DATE-1-EDIT TO  CLSTPMTI
  8549         ELSE
  8550             MOVE LOW-VALUES          TO  CLSTPMTI.
  8551
  8552     MOVE AT-FIRST-PMT-AMT       TO CFSTAMTO.
  8553     MOVE AT-DAYS-IN-1ST-PMT     TO CDAYSFO.
  8554
  8555     IF AT-LAST-PMT-TYPE = 'F'
  8556        MOVE 'Y'                 TO CLASTO
  8557     ELSE
  8558        MOVE 'N'                 TO CLASTO.
  8559
  8560     MOVE AT-RECORDED-BY         TO CESTBYO.
  8561     MOVE AT-REGULAR-PMT-AMT     TO CREGPMTO.
  8562     MOVE AT-AUTO-CASH           TO CINDCTRO.
  8563
  8564     MOVE AT-AUTO-END-LETTER     TO PRINTI
  8565                                    PI-AUTO-END-LETTER.
  8566
  8567     IF AT-AUTO-PAYEE-TYPE EQUAL 'I'
  8568        MOVE 'INSURED'           TO CPAYEEO
  8569     ELSE
  8570     IF AT-AUTO-PAYEE-TYPE EQUAL 'B'
  8571        MOVE 'BENEFIC'           TO CPAYEEO
  8572     ELSE
  8573     IF AT-AUTO-PAYEE-TYPE EQUAL 'A'
  8574        MOVE 'ACCOUNT'           TO CPAYEEO.
  8575
  8576     MOVE AT-INTERVAL-MONTHS     TO CMONTHSO.
  8577     MOVE -1                     TO TERML.
  8578     GO TO 8100-SEND-INITIAL-MAP.
  8579
  8580 7080-NO-TRAILER.
  8581     MOVE 'A'                    TO TERMI.
  8582     MOVE AL-PADON               TO TERMA
  8583                                    PRINTA.
  8584     MOVE -1                     TO NFSTPMTL.
  8585     MOVE ER-0346                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 165
* EL154.cbl
  8586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8587     GO TO 8100-SEND-INITIAL-MAP.
  8588
  8589 7090-CLAIM-NOT-FOUND.
  8590     MOVE ER-0186                TO EMI-ERROR.
  8591     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8592     GO TO 8100-SEND-INITIAL-MAP.
  8593
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 166
* EL154.cbl
  8595 7100-CHECK-AUTO-ACTIVITY.
  8596
  8597
  8598* EXEC CICS HANDLE CONDITION
  8599*        NOTFND   (7100-NOT-FOUND)
  8600*    END-EXEC.
  8601*    MOVE '"$I                   ! / #00008012' TO DFHEIV0
  8602     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8604     MOVE X'2F20233030303038303132' TO DFHEIV0(25:11)
  8605     CALL 'kxdfhei1' USING DFHEIV0
  8606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8607
  8608
  8609     MOVE PI-COMPANY-ID          TO  CNTL-CO.
  8610     MOVE 'T'                    TO  CNTL-RECORD-TYPE.
  8611     MOVE SPACES                 TO  CNTL-GENL.
  8612     MOVE +0                     TO  CNTL-SEQ.
  8613
  8614
  8615* EXEC CICS READ
  8616*        DATASET   (CNTL-ID)
  8617*        RIDFLD    (CNTL-KEY)
  8618*        SET       (ADDRESS OF CONTROL-FILE)
  8619*    END-EXEC.
  8620*    MOVE '&"S        E          (   #00008021' TO DFHEIV0
  8621     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8622     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8623     MOVE X'2020233030303038303231' TO DFHEIV0(25:11)
  8624     CALL 'kxdfhei1' USING DFHEIV0,
  8625           CNTL-ID,
  8626           DFHEIV20,
  8627           DFHEIV99,
  8628           CNTL-KEY,
  8629           DFHEIV99,
  8630           DFHEIV99,
  8631           DFHEIV99
  8632     SET ADDRESS OF CONTROL-FILE TO
  8633         DFHEIV20
  8634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8635
  8636
  8637     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
  8638
  8639 7100-CHECK-SYSTEM-ACTIVITY.
  8640
  8641     IF CL-ACTIVITY-CODE IS NOT EQUAL TO ZEROS
  8642         MOVE CL-ACTIVITY-CODE             TO  SUB-1
  8643         IF SUB-1 IS GREATER THAN +9
  8644             SUBTRACT +9 FROM SUB-1
  8645             MOVE CF-USER-RESET-SW (SUB-1) TO  WS-RESET-SW
  8646         ELSE
  8647             MOVE CF-SYS-RESET-SW  (SUB-1) TO  WS-RESET-SW
  8648     ELSE
  8649         MOVE 'Y'                          TO  WS-RESET-SW.
  8650
  8651     IF TERMI IS EQUAL TO 'A'
  8652         IF (CF-SYS-ACTIVE-SW (5) IS EQUAL TO 'N' OR ' ')
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 167
* EL154.cbl
  8653             MOVE 'N'                TO  WS-LETTER-SW
  8654                                         WS-RESET-SW
  8655             GO TO 7100-EXIT.
  8656
  8657     IF TERMI IS EQUAL TO 'A'
  8658         IF (CF-SYS-LETTER-ID (5) EQUAL SPACES OR LOW-VALUES)
  8659             MOVE 'N'                TO  WS-LETTER-SW
  8660         ELSE
  8661             MOVE 'Y'                TO  WS-LETTER-SW.
  8662
  8663     IF TERMI IS EQUAL TO 'Y'
  8664         IF (CF-SYS-ACTIVE-SW (6) IS EQUAL TO 'N' OR ' ')
  8665             MOVE 'N'                TO  WS-LETTER-SW
  8666                                         WS-RESET-SW
  8667             GO TO 7100-EXIT.
  8668
  8669     IF TERMI IS EQUAL TO 'Y'
  8670         IF (CF-SYS-LETTER-ID (6) EQUAL SPACES OR LOW-VALUES)
  8671             MOVE 'N'                TO  WS-LETTER-SW
  8672         ELSE
  8673             MOVE 'Y'                TO  WS-LETTER-SW.
  8674
  8675     IF CL-ACTIVITY-CODE IS EQUAL TO 09
  8676         GO TO 7100-EXIT.
  8677
  8678     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK') AND
  8679        (CL-ACTIVITY-CODE IS EQUAL TO 11)
  8680         GO TO 7100-EXIT.
  8681
  8682     IF WS-RESET-SW IS EQUAL TO 'N'
  8683         GO TO 7100-EXIT.
  8684
  8685     MOVE CURRENT-BIN-DATE           TO  CL-ACTIVITY-MAINT-DT.
  8686
  8687     IF TERMI IS EQUAL TO 'A'
  8688         MOVE 05                     TO  CL-ACTIVITY-CODE
  8689         MOVE 'AUTO'                 TO  CL-ACTIVITY-MAINT-TYPE
  8690     ELSE
  8691         MOVE 06                     TO  CL-ACTIVITY-CODE
  8692         MOVE 'TERM'                 TO  CL-ACTIVITY-MAINT-TYPE.
  8693
  8694     GO TO 7100-EXIT.
  8695
  8696 7100-NOT-FOUND.
  8697
  8698     MOVE 'N'                        TO  WS-ACT-REC-FOUND-SW
  8699                                         WS-LETTER-SW.
  8700
  8701 7100-EXIT.
  8702     EXIT.
  8703
  8704 7150-CREATE-AUTO-LETTER.
  8705
  8706     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
  8707     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
  8708
  8709     IF TERMI IS EQUAL TO 'A'
  8710         IF WS-LETTER-FORM-NUM > SPACES
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 168
* EL154.cbl
  8711            MOVE WS-LETTER-FORM-NUM     TO  W-1523-FORM-NUMBER
  8712         ELSE
  8713         MOVE CF-SYS-LETTER-ID (5)   TO  W-1523-FORM-NUMBER
  8714         END-IF
  8715     ELSE
  8716         IF WS-END-LETTER-FORM-NUM > SPACES
  8717             MOVE WS-END-LETTER-FORM-NUM TO W-1523-FORM-NUMBER
  8718         ELSE
  8719         MOVE CF-SYS-LETTER-ID (6)   TO  W-1523-FORM-NUMBER.
  8720
  8721     IF TERMI IS EQUAL TO 'A'
  8722       IF CF-SYS-RESEND-DAYS (5) IS NOT EQUAL TO ZEROS
  8723         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8724         MOVE '6'                    TO  DC-OPTION-CODE
  8725         MOVE CF-SYS-RESEND-DAYS (5) TO  DC-ELAPSED-DAYS
  8726         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8727         PERFORM 9700-DATE-LINK
  8728         IF NO-CONVERSION-ERROR
  8729             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8730         ELSE
  8731             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8732
  8733
  8734     IF TERMI IS EQUAL TO 'A'
  8735       IF CF-SYS-FOLLOW-UP-DAYS (5) IS NOT EQUAL TO ZEROS
  8736         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8737         MOVE '6'                    TO  DC-OPTION-CODE
  8738         MOVE CF-SYS-FOLLOW-UP-DAYS (5)  TO  DC-ELAPSED-DAYS
  8739         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8740         PERFORM 9700-DATE-LINK
  8741         IF NO-CONVERSION-ERROR
  8742             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8743         ELSE
  8744             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8745
  8746     IF TERMI IS EQUAL TO 'Y'
  8747       IF CF-SYS-RESEND-DAYS (6) IS NOT EQUAL TO ZEROS
  8748         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8749         MOVE '6'                    TO  DC-OPTION-CODE
  8750         MOVE CF-SYS-RESEND-DAYS (6) TO  DC-ELAPSED-DAYS
  8751         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8752         PERFORM 9700-DATE-LINK
  8753         IF NO-CONVERSION-ERROR
  8754             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
  8755         ELSE
  8756             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
  8757
  8758
  8759     IF TERMI IS EQUAL TO 'Y'
  8760       IF CF-SYS-FOLLOW-UP-DAYS (6) IS NOT EQUAL TO ZEROS
  8761         MOVE CURRENT-BIN-DATE       TO  DC-BIN-DATE-1
  8762         MOVE '6'                    TO  DC-OPTION-CODE
  8763         MOVE CF-SYS-FOLLOW-UP-DAYS (6)  TO  DC-ELAPSED-DAYS
  8764         MOVE +0                     TO  DC-ELAPSED-MONTHS
  8765         PERFORM 9700-DATE-LINK
  8766         IF NO-CONVERSION-ERROR
  8767             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
  8768         ELSE
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 169
* EL154.cbl
  8769             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
  8770
  8771     MOVE LETTDTE-SAVE               TO W-1523-LETTER-DATE.
  8772
  8773
  8774* EXEC CICS LINK
  8775*        PROGRAM    (LINK-1523)
  8776*        COMMAREA   (W-1523-LINKDATA)
  8777*        LENGTH     (W-1523-COMM-LENGTH)
  8778*    END-EXEC.
  8779*    MOVE '."C                   (   #00008163' TO DFHEIV0
  8780     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8781     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8782     MOVE X'2020233030303038313633' TO DFHEIV0(25:11)
  8783     CALL 'kxdfhei1' USING DFHEIV0,
  8784           LINK-1523,
  8785           W-1523-LINKDATA,
  8786           W-1523-COMM-LENGTH,
  8787           DFHEIV99,
  8788           DFHEIV99,
  8789           DFHEIV99,
  8790           DFHEIV99
  8791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8792
  8793
  8794     IF W-1523-ERROR-CODE IS EQUAL TO ZEROS
  8795         GO TO 7150-EXIT.
  8796
  8797     IF W-1523-FATAL-ERROR
  8798         MOVE ER-0802                TO  EMI-ERROR
  8799         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8800         GO TO 7150-EXIT.
  8801
  8802     IF W-1523-ERROR-CODE IS EQUAL TO 0191
  8803         MOVE ER-0803                TO  EMI-ERROR
  8804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8805
  8806 7150-EXIT.
  8807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 170
* EL154.cbl
  8809 7200-LOCATE-BENEFIT.
  8810     MOVE SPACES TO WS-BENEFIT-FOUND-SW.
  8811
  8812
  8813* EXEC CICS HANDLE CONDITION
  8814*        ENDFILE(7200-EXIT)
  8815*        NOTFND(7200-EXIT)
  8816*        END-EXEC.
  8817*    MOVE '"$''I                  ! 0 #00008187' TO DFHEIV0
  8818     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8820     MOVE X'3020233030303038313837' TO DFHEIV0(25:11)
  8821     CALL 'kxdfhei1' USING DFHEIV0
  8822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8823
  8824
  8825
  8826* EXEC CICS READ
  8827*        DATASET(CNTL-ID)
  8828*        SET(ADDRESS OF CONTROL-FILE)
  8829*        RIDFLD(CNTL-KEY)
  8830*        GTEQ
  8831*        END-EXEC.
  8832*    MOVE '&"S        G          (   #00008192' TO DFHEIV0
  8833     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8835     MOVE X'2020233030303038313932' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0,
  8837           CNTL-ID,
  8838           DFHEIV20,
  8839           DFHEIV99,
  8840           CNTL-KEY,
  8841           DFHEIV99,
  8842           DFHEIV99,
  8843           DFHEIV99
  8844     SET ADDRESS OF CONTROL-FILE TO
  8845         DFHEIV20
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8847
  8848
  8849     IF (CNTL-CO NOT = CF-COMPANY-ID)   OR
  8850        (CNTL-RECORD-TYPE NOT = CF-RECORD-TYPE)
  8851           GO TO 7200-EXIT.
  8852
  8853     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
  8854         VARYING SUB-1 FROM 1 BY 1 UNTIL
  8855            ((SUB-1 GREATER 8) OR
  8856            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
  8857
  8858     IF SUB-1 NOT = 9
  8859         MOVE 'Y' TO WS-BENEFIT-FOUND-SW.
  8860
  8861     GO TO 7200-EXIT.
  8862
  8863 7200-BENEFIT-DUMMY.
  8864
  8865 7200-DUMMY-EXIT.
  8866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 171
* EL154.cbl
  8867
  8868 7200-EXIT.
  8869     EXIT.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 172
* EL154.cbl
  8871 8100-SEND-INITIAL-MAP.
  8872     MOVE CURRENT-GREG-DATE      TO RUNDTEO.
  8873     MOVE EIBTIME                TO TIME-IN.
  8874     MOVE TIME-OUT               TO RUNTIMEO.
  8875     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8876     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8877
  8878     IF PI-USES-PAID-TO
  8879         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  8880                                     FSTHD2O
  8881         MOVE LAST-PMT-HD2       TO  LSTHD1O
  8882         MOVE LAST-PMT-HD4       TO  LSTHD2O
  8883     ELSE
  8884         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  8885                                     FSTHD2O
  8886         MOVE LAST-PMT-HD1       TO  LSTHD1O
  8887         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  8888
  8889
  8890* EXEC CICS SEND
  8891*        MAP(MAP-NAME)
  8892*        MAPSET(MAPSET-NAME)
  8893*        FROM(EL154AO)
  8894*        ERASE
  8895*        CURSOR
  8896*        END-EXEC.
  8897     MOVE LENGTH OF
  8898      EL154AO
  8899       TO DFHEIV12
  8900     MOVE -1
  8901       TO DFHEIV11
  8902*    MOVE '8$     CT  E    H L F ,   #00008239' TO DFHEIV0
  8903     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8904     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8905     MOVE X'2020233030303038323339' TO DFHEIV0(25:11)
  8906     CALL 'kxdfhei1' USING DFHEIV0,
  8907           MAP-NAME,
  8908           EL154AO,
  8909           DFHEIV12,
  8910           MAPSET-NAME,
  8911           DFHEIV99,
  8912           DFHEIV99,
  8913           DFHEIV99,
  8914           DFHEIV11,
  8915           DFHEIV99,
  8916           DFHEIV99,
  8917           DFHEIV99
  8918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8919
  8920
  8921     MOVE 'EL154   ' TO PI-CALLING-PROGRAM.
  8922     GO TO 9100-RETURN-TRAN.
  8923
  8924 8200-SEND-DATAONLY.
  8925     MOVE CURRENT-GREG-DATE TO RUNDTEO.
  8926     MOVE EIBTIME           TO TIME-IN.
  8927     MOVE TIME-OUT          TO RUNTIMEO.
  8928     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 173
* EL154.cbl
  8929     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8930
  8931     IF PI-USES-PAID-TO
  8932         MOVE FIRST-PMT-HD2      TO  FSTHD1O
  8933                                     FSTHD2O
  8934         MOVE LAST-PMT-HD2       TO  LSTHD1O
  8935         MOVE LAST-PMT-HD4       TO  LSTHD2O
  8936     ELSE
  8937         MOVE FIRST-PMT-HD1      TO  FSTHD1O
  8938                                     FSTHD2O
  8939         MOVE LAST-PMT-HD1       TO  LSTHD1O
  8940         MOVE LAST-PMT-HD3       TO  LSTHD2O.
  8941
  8942
  8943* EXEC CICS SEND
  8944*        MAP(MAP-NAME)
  8945*        MAPSET(MAPSET-NAME)
  8946*        FROM(EL154AO)
  8947*        DATAONLY
  8948*        ERASEAUP
  8949*        CURSOR
  8950*        END-EXEC.
  8951     MOVE LENGTH OF
  8952      EL154AO
  8953       TO DFHEIV12
  8954     MOVE -1
  8955       TO DFHEIV11
  8956*    MOVE '8$D    CT  A    H L F ,   #00008268' TO DFHEIV0
  8957     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8958     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8959     MOVE X'2020233030303038323638' TO DFHEIV0(25:11)
  8960     CALL 'kxdfhei1' USING DFHEIV0,
  8961           MAP-NAME,
  8962           EL154AO,
  8963           DFHEIV12,
  8964           MAPSET-NAME,
  8965           DFHEIV99,
  8966           DFHEIV99,
  8967           DFHEIV99,
  8968           DFHEIV11,
  8969           DFHEIV99,
  8970           DFHEIV99,
  8971           DFHEIV99
  8972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8973
  8974
  8975     GO TO 9100-RETURN-TRAN.
  8976
  8977 8300-SEND-TEXT.
  8978
  8979* EXEC CICS SEND TEXT
  8980*        FROM(LOGOFF-TEXT)
  8981*        LENGTH(LOGOFF-LENGTH)
  8982*        ERASE
  8983*        FREEKB
  8984*        END-EXEC.
  8985*    MOVE '8&      T  E F  H   F -   #00008280' TO DFHEIV0
  8986     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 174
* EL154.cbl
  8987     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8988     MOVE X'2020233030303038323830' TO DFHEIV0(25:11)
  8989     CALL 'kxdfhei1' USING DFHEIV0,
  8990           LOGOFF-TEXT,
  8991           LOGOFF-LENGTH,
  8992           DFHEIV99,
  8993           DFHEIV99,
  8994           DFHEIV99,
  8995           DFHEIV99,
  8996           DFHEIV99,
  8997           DFHEIV99,
  8998           DFHEIV99,
  8999           DFHEIV99,
  9000           DFHEIV99,
  9001           DFHEIV99
  9002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9003
  9004
  9005
  9006* EXEC CICS RETURN
  9007*        END-EXEC.
  9008*    MOVE '.(                    ''   #00008287' TO DFHEIV0
  9009     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9010     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9011     MOVE X'2020233030303038323837' TO DFHEIV0(25:11)
  9012     CALL 'kxdfhei1' USING DFHEIV0,
  9013           DFHEIV99,
  9014           DFHEIV99,
  9015           DFHEIV99,
  9016           DFHEIV99,
  9017           DFHEIV99,
  9018           DFHEIV99
  9019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9020
  9021
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 175
* EL154.cbl
  9023 8600-DEEDIT.
  9024
  9025* EXEC CICS BIF DEEDIT
  9026*         FIELD(DEEDIT-FIELD)
  9027*         LENGTH(15)
  9028*         END-EXEC.
  9029     MOVE 15
  9030       TO DFHEIV11
  9031*    MOVE '@"L                   #   #00008292' TO DFHEIV0
  9032     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9033     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9034     MOVE X'2020233030303038323932' TO DFHEIV0(25:11)
  9035     CALL 'kxdfhei1' USING DFHEIV0,
  9036           DEEDIT-FIELD,
  9037           DFHEIV11
  9038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9039
  9040
  9041 8800-UNAUTHORIZED-ACCESS.
  9042     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  9043     GO TO 8300-SEND-TEXT.
  9044
  9045 8810-PF23.
  9046     MOVE EIBAID TO PI-ENTRY-CD-1.
  9047     MOVE XCTL-005 TO PGM-NAME.
  9048     GO TO 9300-XCTL.
  9049
  9050
  9051 8850-CLAM-END-FILE.
  9052     MOVE -1                     TO  ENTERPFL.
  9053     MOVE ER-0130 TO EMI-ERROR.
  9054     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9055     GO TO 8200-SEND-DATAONLY.
  9056
  9057 8860-CLAM-NOT-OPEN.
  9058     MOVE -1                     TO  ENTERPFL.
  9059     MOVE ER-0154 TO EMI-ERROR.
  9060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9061     GO TO 8200-SEND-DATAONLY.
  9062
  9063 8870-ACTV-NOT-OPEN.
  9064     MOVE -1                     TO  ENTERPFL.
  9065     MOVE ER-0172 TO EMI-ERROR.
  9066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9067     GO TO 8200-SEND-DATAONLY.
  9068
  9069 8880-CERT-NOT-OPEN.
  9070     MOVE -1                     TO  ENTERPFL.
  9071     MOVE ER-0169                TO EMI-ERROR.
  9072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9073     GO TO 8200-SEND-DATAONLY.
  9074
  9075 8885-EMPLCY-NOT-OPEN.
  9076     MOVE -1                     TO  ENTERPFL.
  9077     MOVE ER-9883                TO  EMI-ERROR.
  9078     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9079     GO TO 8200-SEND-DATAONLY.
  9080
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 176
* EL154.cbl
  9081 8890-CNTL-NOT-OPEN.
  9082     MOVE -1                     TO  ENTERPFL.
  9083     MOVE ER-0042                TO EMI-ERROR.
  9084     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9085     GO TO 8200-SEND-DATAONLY.
  9086
  9087 9000-RETURN-CICS.
  9088
  9089* EXEC CICS RETURN
  9090*        END-EXEC.
  9091*    MOVE '.(                    ''   #00008344' TO DFHEIV0
  9092     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9093     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9094     MOVE X'2020233030303038333434' TO DFHEIV0(25:11)
  9095     CALL 'kxdfhei1' USING DFHEIV0,
  9096           DFHEIV99,
  9097           DFHEIV99,
  9098           DFHEIV99,
  9099           DFHEIV99,
  9100           DFHEIV99,
  9101           DFHEIV99
  9102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9103
  9104
  9105 9100-RETURN-TRAN.
  9106     MOVE    EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  9107     MOVE '154A' TO PI-CURRENT-SCREEN-NO.
  9108
  9109* EXEC CICS RETURN
  9110*        TRANSID(TRANS-ID)
  9111*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9112*        LENGTH(PI-COMM-LENGTH)
  9113*        END-EXEC.
  9114*    MOVE '.(CT                  ''   #00008350' TO DFHEIV0
  9115     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9116     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9117     MOVE X'2020233030303038333530' TO DFHEIV0(25:11)
  9118     CALL 'kxdfhei1' USING DFHEIV0,
  9119           TRANS-ID,
  9120           PROGRAM-INTERFACE-BLOCK,
  9121           PI-COMM-LENGTH,
  9122           DFHEIV99,
  9123           DFHEIV99,
  9124           DFHEIV99
  9125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9126
  9127
  9128 9200-RETURN-MAIN-MENU.
  9129     MOVE XCTL-126 TO PGM-NAME.
  9130     GO TO 9300-XCTL.
  9131
  9132 9300-XCTL.
  9133
  9134* EXEC CICS XCTL
  9135*        PROGRAM(PGM-NAME)
  9136*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  9137*        LENGTH(PI-COMM-LENGTH)
  9138*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 177
* EL154.cbl
  9139*    MOVE '.$C                   %   #00008361' TO DFHEIV0
  9140     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9141     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9142     MOVE X'2020233030303038333631' TO DFHEIV0(25:11)
  9143     CALL 'kxdfhei1' USING DFHEIV0,
  9144           PGM-NAME,
  9145           PROGRAM-INTERFACE-BLOCK,
  9146           PI-COMM-LENGTH,
  9147           DFHEIV99
  9148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9149
  9150
  9151 9400-CLEAR.
  9152     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  9153     GO TO 9300-XCTL.
  9154
  9155 9500-PF12.
  9156     MOVE XCTL-010 TO PGM-NAME.
  9157     GO TO 9300-XCTL.
  9158
  9159 9600-PGMID-ERROR.
  9160
  9161* EXEC CICS HANDLE CONDITION
  9162*        PGMIDERR(8300-SEND-TEXT)
  9163*        END-EXEC.
  9164*    MOVE '"$L                   ! 1 #00008376' TO DFHEIV0
  9165     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9167     MOVE X'3120233030303038333736' TO DFHEIV0(25:11)
  9168     CALL 'kxdfhei1' USING DFHEIV0
  9169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9170
  9171
  9172     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  9173     MOVE ' '          TO PI-ENTRY-CD-1.
  9174     MOVE XCTL-005     TO PGM-NAME.
  9175     MOVE PGM-NAME     TO LOGOFF-PGM.
  9176     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  9177     GO TO 9300-XCTL.
  9178
  9179 9700-DATE-LINK.
  9180     MOVE LINK-ELDATCV TO PGM-NAME
  9181
  9182* EXEC CICS LINK
  9183*        PROGRAM    (PGM-NAME)
  9184*        COMMAREA   (DATE-CONVERSION-DATA)
  9185*        LENGTH     (DC-COMM-LENGTH)
  9186*        END-EXEC.
  9187*    MOVE '."C                   (   #00008389' TO DFHEIV0
  9188     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9190     MOVE X'2020233030303038333839' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0,
  9192           PGM-NAME,
  9193           DATE-CONVERSION-DATA,
  9194           DC-COMM-LENGTH,
  9195           DFHEIV99,
  9196           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 178
* EL154.cbl
  9197           DFHEIV99,
  9198           DFHEIV99
  9199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9200
  9201
  9202 9900-ERROR-FORMAT.
  9203     IF NOT EMI-ERRORS-COMPLETE
  9204         MOVE LINK-001 TO PGM-NAME
  9205
  9206* EXEC CICS LINK
  9207*            PROGRAM(PGM-NAME)
  9208*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  9209*            LENGTH(EMI-COMM-LENGTH)
  9210*            END-EXEC.
  9211*    MOVE '."C                   (   #00008398' TO DFHEIV0
  9212     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9213     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9214     MOVE X'2020233030303038333938' TO DFHEIV0(25:11)
  9215     CALL 'kxdfhei1' USING DFHEIV0,
  9216           PGM-NAME,
  9217           ERROR-MESSAGE-INTERFACE-BLOCK,
  9218           EMI-COMM-LENGTH,
  9219           DFHEIV99,
  9220           DFHEIV99,
  9221           DFHEIV99,
  9222           DFHEIV99
  9223     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9224
  9225
  9226 9900-EXIT.
  9227     EXIT.
  9228
  9229 9990-ABEND.
  9230     MOVE LINK-004 TO PGM-NAME.
  9231     MOVE DFHEIBLK TO EMI-LINE1.
  9232
  9233* EXEC CICS LINK
  9234*        PROGRAM(PGM-NAME)
  9235*        COMMAREA(EMI-LINE1)
  9236*        LENGTH(72)
  9237*        END-EXEC.
  9238     MOVE 72
  9239       TO DFHEIV11
  9240*    MOVE '."C                   (   #00008410' TO DFHEIV0
  9241     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9243     MOVE X'2020233030303038343130' TO DFHEIV0(25:11)
  9244     CALL 'kxdfhei1' USING DFHEIV0,
  9245           PGM-NAME,
  9246           EMI-LINE1,
  9247           DFHEIV11,
  9248           DFHEIV99,
  9249           DFHEIV99,
  9250           DFHEIV99,
  9251           DFHEIV99
  9252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9253
  9254
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 179
* EL154.cbl
  9255     GO TO 8200-SEND-DATAONLY.
  9256
  9257* GOBACK.
  9258     MOVE '9%                    "   ' TO DFHEIV0
  9259     MOVE 'EL154' TO DFHEIV1
  9260     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9261     GOBACK.
  9262
  9263 9995-SECURITY-VIOLATION.
  9264*                            COPY ELCSCTP.
  9265******************************************************************
  9266*                                                                *
  9267*                            ELCSCTP                             *
  9268*                            VMOD=2.001                          *
  9269*                                                                *
  9270*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9271******************************************************************
  9272
  9273
  9274     MOVE EIBDATE          TO SM-JUL-DATE.
  9275     MOVE EIBTRMID         TO SM-TERMID.
  9276     MOVE THIS-PGM         TO SM-PGM.
  9277     MOVE EIBTIME          TO TIME-IN.
  9278     MOVE TIME-OUT         TO SM-TIME.
  9279     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9280
  9281
  9282* EXEC CICS LINK
  9283*         PROGRAM  ('EL003')
  9284*         COMMAREA (SECURITY-MESSAGE)
  9285*         LENGTH   (80)
  9286*    END-EXEC.
  9287     MOVE 'EL003' TO DFHEIV1
  9288     MOVE 80
  9289       TO DFHEIV11
  9290*    MOVE '."C                   (   #00008437' TO DFHEIV0
  9291     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9292     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9293     MOVE X'2020233030303038343337' TO DFHEIV0(25:11)
  9294     CALL 'kxdfhei1' USING DFHEIV0,
  9295           DFHEIV1,
  9296           SECURITY-MESSAGE,
  9297           DFHEIV11,
  9298           DFHEIV99,
  9299           DFHEIV99,
  9300           DFHEIV99,
  9301           DFHEIV99
  9302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9303
  9304
  9305******************************************************************
  9306
  9307
  9308 9995-EXIT.
  9309     EXIT.
  9310
  9311
  9312 9999-DFHBACK SECTION.
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 180
* EL154.cbl
  9313     MOVE '9%                    "   ' TO DFHEIV0
  9314     MOVE 'EL154' TO DFHEIV1
  9315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9316     GOBACK.
  9317 9999-DFHEXIT.
  9318     IF DFHEIGDJ EQUAL 0001
  9319         NEXT SENTENCE
  9320     ELSE IF DFHEIGDJ EQUAL 2
  9321         GO TO 8860-CLAM-NOT-OPEN,
  9322               9600-PGMID-ERROR,
  9323               9990-ABEND
  9324         DEPENDING ON DFHEIGDI
  9325     ELSE IF DFHEIGDJ EQUAL 3
  9326         GO TO 8850-CLAM-END-FILE,
  9327               8850-CLAM-END-FILE
  9328         DEPENDING ON DFHEIGDI
  9329     ELSE IF DFHEIGDJ EQUAL 4
  9330         GO TO 8850-CLAM-END-FILE,
  9331               8850-CLAM-END-FILE
  9332         DEPENDING ON DFHEIGDI
  9333     ELSE IF DFHEIGDJ EQUAL 5
  9334         GO TO 8870-ACTV-NOT-OPEN
  9335         DEPENDING ON DFHEIGDI
  9336     ELSE IF DFHEIGDJ EQUAL 6
  9337         GO TO 8870-ACTV-NOT-OPEN,
  9338               4099-EXIT
  9339         DEPENDING ON DFHEIGDI
  9340     ELSE IF DFHEIGDJ EQUAL 7
  9341         GO TO 9999-DFHBACK
  9342         DEPENDING ON DFHEIGDI
  9343     ELSE IF DFHEIGDJ EQUAL 8
  9344         GO TO 6150-READ-CARRIER,
  9345               8890-CNTL-NOT-OPEN
  9346         DEPENDING ON DFHEIGDI
  9347     ELSE IF DFHEIGDJ EQUAL 9
  9348         GO TO 6180-READ-CERT
  9349         DEPENDING ON DFHEIGDI
  9350     ELSE IF DFHEIGDJ EQUAL 10
  9351         GO TO 8880-CERT-NOT-OPEN,
  9352               6185-CERT-NOT-FOUND
  9353         DEPENDING ON DFHEIGDI
  9354     ELSE IF DFHEIGDJ EQUAL 11
  9355         GO TO 8885-EMPLCY-NOT-OPEN,
  9356               6195-EMPLCY-NOT-FOUND
  9357         DEPENDING ON DFHEIGDI
  9358     ELSE IF DFHEIGDJ EQUAL 12
  9359         GO TO 6250-ADDR-ERROR
  9360         DEPENDING ON DFHEIGDI
  9361     ELSE IF DFHEIGDJ EQUAL 13
  9362         GO TO 8860-CLAM-NOT-OPEN,
  9363               7090-CLAIM-NOT-FOUND
  9364         DEPENDING ON DFHEIGDI
  9365     ELSE IF DFHEIGDJ EQUAL 14
  9366         GO TO 8870-ACTV-NOT-OPEN,
  9367               7080-NO-TRAILER
  9368         DEPENDING ON DFHEIGDI
  9369     ELSE IF DFHEIGDJ EQUAL 15
  9370         GO TO 7100-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 07-Oct-13 13:29 Page 181
* EL154.cbl
  9371         DEPENDING ON DFHEIGDI
  9372     ELSE IF DFHEIGDJ EQUAL 16
  9373         GO TO 7200-EXIT,
  9374               7200-EXIT
  9375         DEPENDING ON DFHEIGDI
  9376     ELSE IF DFHEIGDJ EQUAL 17
  9377         GO TO 8300-SEND-TEXT
  9378         DEPENDING ON DFHEIGDI.
  9379     MOVE '9%                    "   ' TO DFHEIV0
  9380     MOVE 'EL154' TO DFHEIV1
  9381     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9382     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5964     Code:       18954
