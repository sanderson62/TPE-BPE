* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54******************************************************************
    55
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   3
* EL156.cbl
    57 ENVIRONMENT DIVISION.
    58
    59 DATA DIVISION.
    60
    61 WORKING-STORAGE SECTION.
    62 01  DFH-START PIC X(04).
    63
    64 77  FILLER  PIC X(32)  VALUE '********************************'.
    65 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    66 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    67 77  WS-SSN  PIC X(9) VALUE ZEROS.
    68 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    69 77  C0                          PIC S999 COMP-3 VALUE +0.
    70 77  C1                          PIC S999 COMP-3 VALUE +0.
    71 77  C2                          PIC S999 COMP-3 VALUE +0.
    72 77  C3                          PIC S999 COMP-3 VALUE +0.
    73 77  s1                          PIC S999 COMP-3 VALUE +0.
    74 77  s2                          pic s999 comp-3 value +0.
    75 77  P1                          PIC S999 COMP-3 VALUE +0.
    76 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    77 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    78 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    79 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    80 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    81 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    82 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    83 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    84 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    85 77  ws-max-bens                 pic s999 comp-3 value +0.
    86 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    87 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    88 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    89 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    90 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    91
    92*    COPY ELCSCTM.
    93******************************************************************
    94*                                                                *
    95*                                                                *
    96*                            ELCSCTM                             *
    97*                            VMOD=2.001                          *
    98*                                                                *
    99*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   100*                                                                *
   101******************************************************************
   102 01  SECURITY-MESSAGE.
   103     12  FILLER                          PIC X(30)
   104            VALUE '** LOGIC SECURITY VIOLATION -'.
   105     12  SM-READ                         PIC X(6).
   106     12  FILLER                          PIC X(5)
   107            VALUE ' PGM='.
   108     12  SM-PGM                          PIC X(6).
   109     12  FILLER                          PIC X(5)
   110            VALUE ' OPR='.
   111     12  SM-PROCESSOR-ID                 PIC X(4).
   112     12  FILLER                          PIC X(6)
   113            VALUE ' TERM='.
   114     12  SM-TERMID                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   4
* EL156.cbl
   115     12  FILLER                          PIC XX   VALUE SPACE.
   116     12  SM-JUL-DATE                     PIC 9(5).
   117     12  FILLER                          PIC X    VALUE SPACE.
   118     12  SM-TIME                         PIC 99.99.
   119
   120
   121*    COPY ELCSCRTY.
   122******************************************************************
   123*                                                                *
   124*                                                                *
   125*                            ELCSCRTY                            *
   126*                            VMOD=2.001                          *
   127*                                                                *
   128*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   129*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   130*        SAVED IN PI-SECURITY-ADDRESS.                           *
   131*                                                                *
   132******************************************************************
   133 01  SECURITY-CONTROL.
   134     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   135     12  FILLER                       PIC XX    VALUE 'SC'.
   136     12  SC-CREDIT-CODES.
   137         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   138             20  SC-CREDIT-DISPLAY    PIC X.
   139             20  SC-CREDIT-UPDATE     PIC X.
   140     12  SC-CLAIMS-CODES.
   141         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   142             20  SC-CLAIMS-DISPLAY    PIC X.
   143             20  SC-CLAIMS-UPDATE     PIC X.
   144
   145 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   146 01  WS-DATE-AREA.
   147     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   148     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   149     12  SAVE-DATE-CCYYMMDD.
   150         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   151         16  SAVE-DATE-YMD.
   152             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   153             20  FILLER              PIC X(04)   VALUE SPACES.
   154
   155 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   156 01  STANDARD-AREAS.
   157     12  WS-RESPONSE         PIC S9(8)   COMP.
   158         88  WS-RESP-NORMAL              VALUE +00.
   159         88  WS-RESP-ERROR               VALUE +01.
   160         88  WS-RESP-NOTFND              VALUE +13.
   161         88  WS-RESP-DUPREC              VALUE +14.
   162         88  WS-RESP-ENDFILE             VALUE +20.
   163     12  PMT-HEAD-A.
   164         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   165         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   166         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   167-        '     RESERVES  TYPE    AMOUNT'.
   168     12  PMT-HEAD-B.
   169         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   170         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   171         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
   172     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   5
* EL156.cbl
   173     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   174     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   175     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   176     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   177     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   178     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   179     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   180     12  PGM-NAME            PIC X(8).
   181     12  TIME-IN             PIC S9(7).
   182     12  TIME-OUT-R  REDEFINES TIME-IN.
   183         16  FILLER          PIC X.
   184         16  TIME-OUT        PIC 99V99.
   185         16  FILLER          PIC XX.
   186     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   187     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   188     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   189     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   190     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   191     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   192     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   193     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   194     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   195     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   196     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   197     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   198     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   199     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   200     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   201     12  WS-BLANK            PIC X       VALUE ' '.
   202
   203 01  MISC-WORK-AREAS.
   204     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   205     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   206     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   207     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   208     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   209     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   210     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   211     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   212     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   213     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   214     12  W-CALLED-NAME           PIC X(08).
   215     12  W-EOB-CODES.
   216         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   217             20  W-EOB-CODE      PIC XXX.
   218             20  W-EOB-FILLER    PIC X.
   219     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   220     12  W-NAME-LAST             PIC X(15).
   221     12  W-NAME-FIRST            PIC X(15).
   222     12  W-NAME-MIDDLE.
   223         16  FILLER              PIC X.
   224         16  W-NAME-MIDDLE-2     PIC X.
   225         16  FILLER              PIC X(13).
   226     12  W-DMD-CHECK-NO.
   227         16  W-DMD-CHECK-NO-1    PIC X(4).
   228         16  W-DMD-CHECK-NO-2    PIC X.
   229         16  W-DMD-CHECK-NO-3    PIC XX.
   230
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   6
* EL156.cbl
   231     12  WS-COMPUTE-FROM-DT  PIC XX.
   232     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   233     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   234     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   235     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   236     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   237     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   238         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   239         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   240     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   241         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   242     12  WS-UPDATE-SW        PIC X VALUE ' '.
   243     12  WS-GROUPING.
   244         16  WS-GROUP-1      PIC X VALUE SPACES.
   245         16  FILLER          PIC X(05) VALUE SPACES.
   246     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   247     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   248     12  WS-WORK-STATE-ACCT.
   249         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   250         16  FILLER          PIC X       VALUE '/'.
   251         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   252     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   253     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   254     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   255     12  QID.
   256         16  QID-TERM        PIC X(4)    VALUE SPACES.
   257         16  FILLER          PIC X(4)    VALUE '156A'.
   258     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   259     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   260     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   261     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   262     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   263     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   264     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   265     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   266     12  WS-STATUS           PIC X       VALUE SPACES.
   267     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   268     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   269     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   270     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   271     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   272     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   273     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   274     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   275     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   276     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   277     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   278     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   279     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   280     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   281     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   282     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   283     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   284     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   285     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   286     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
   287     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   288     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   7
* EL156.cbl
   289     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   290     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   291     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   292     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   293     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   294     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   295     12  WORK-DATE-FROM.
   296         16  WDF-MONTH       PIC 99        VALUE ZERO.
   297         16  WDF-DAY         PIC 99        VALUE ZERO.
   298         16  WDF-YEAR        PIC 99        VALUE ZERO.
   299     12  WORK-DATE-THRU.
   300         16  WDT-MONTH       PIC 99        VALUE ZERO.
   301         16  WDT-DAY         PIC 99        VALUE ZERO.
   302         16  WDT-YEAR        PIC 99        VALUE ZERO.
   303     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   304     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   305     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   306     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   307     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   308     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   309     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   310     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   311     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   312     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   313     12  WS-PY-WK REDEFINES WS-PY-WORK.
   314         16  WS-PY-NUM       PIC S9(7)V99.
   315         16  WS-PY-SIGN      PIC X.
   316     12  WS-DY-WORK          PIC S9(5).
   317     12  WS-DY-WK REDEFINES WS-DY-WORK.
   318         16  WS-DY-NUM       PIC S9(4).
   319         16  WS-DY-SIGN      PIC X.
   320     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   321         88  COMP-REC-FOUND              VALUE 'Y'.
   322     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   323         88  BENEFIT-FOUND       VALUE 'Y'.
   324         88  NO-BENEFIT-FOUND    VALUE 'N'.
   325     12  WS-TERMS.
   326         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   327         16  FILLER          PIC X       VALUE '/'.
   328         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   329         16  WST-REM-DAYS-GRP.
   330             20  WST-SLASH   PIC X       VALUE '/'.
   331             20  WST-REM-DAYS
   332                             PIC --9.
   333     12  WS-ACCESS.
   334         16  FILLER          PIC XX      VALUE SPACES.
   335         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   336     12  WS-STATE-ACCESS.
   337         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   338         16  FILLER          PIC XX      VALUE SPACES.
   339     12  WS-CARR-ACCESS.
   340         16  FILLER          PIC X(3)    VALUE SPACES.
   341         16  WS-CARR         PIC X       VALUE SPACES.
   342     12  DATE-WORK.
   343         16  FILLER          PIC XX      VALUE SPACES.
   344         16  NUM-WORK        PIC X(6)    VALUE SPACES.
   345     12  WS-SAVE-INPUT.
   346         16  WS-PMTTYPE      PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   8
* EL156.cbl
   347         16  WS-PAYEE        PIC XX      VALUE SPACE.
   348         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   349         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   350         16  WS-OFFLINE      PIC X       VALUE SPACE.
   351         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   352         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   353         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   354         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   355         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   356         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   357         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   358         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   359         16  WS-ETYPE        PIC X       VALUE SPACE.
   360         16  WS-CASH         PIC X       VALUE SPACE.
   361         16  WS-GROUPED      PIC X       VALUE SPACE.
   362         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   363         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   364         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   365         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   366         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   367         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   368         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   369         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   370     12  LAST-ERROR-LINE.
   371         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   372         16  FILLER              PIC X(30)
   373             VALUE ' FATAL ERRORS ENCOUNTERED'.
   374         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   375         16  FILLER              PIC X(28)
   376             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   377     12  WS-CHECK-AREA.
   378         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   379         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   380     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   381     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   382         16  FILLER              PIC XX.
   383         16  WS-A-CHECK-NUM-5    PIC 9(5).
   384     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   385         16  FILLER              PIC X.
   386         16  WS-A-CHECK-NUM-6    PIC 9(6).
   387     12  OPTION-1-SAVE-AREA.
   388         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   389         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   390     12  WS-WORK-ZIP.
   391         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   392         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   393     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   394                                 PIC 9(9).
   395     12  WS-FLI-PMTNOTE.
   396         16  WS-PMTOPTION        PIC XX.
   397         16  WS-DOCNAME          PIC X(28).
   398         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   399             20  WS-AMOUNT       PIC X(8).
   400             20  FILLER          PIC X(20).
   401         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   402             20  WS-NUM-AMT      PIC 9(6)V99.
   403             20  FILLER          PIC X(20).
   404
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page   9
* EL156.cbl
   405     12  WS-HAN-PMTNOTE.
   406         16  WS-HAN-PMT-CODE     PIC X.
   407         16  WS-HAN-PMT-NOTE     PIC X(39).
   408
   409     12  WS-NCL-PMT-OPTION       PIC XX.
   410         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   411
   412     12  WS-CLAIM-SEQUENCE.
   413         16  FILLER              PIC X VALUE '('.
   414         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   415         16  FILLER              PIC X(04) VALUE ' OF '.
   416         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   417         16  FILLER              PIC X VALUE ')'.
   418
   419     12  WS-REFUND-AMT           PIC Z(7).99.
   420     12  WS-CALC-INT             PIC S9(7)V99.
   421     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   422
   423     12  SUB                     PIC 99 VALUE ZEROS.
   424
   425     12  WS-BOANOTE1.
   426         16  WS-BOANOTE1-DESC    PIC X(11).
   427         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   428         16  FILLER              PIC X(17).
   429     12  WS-BOANOTE2.
   430         16  WS-BOANOTE2-DESC    PIC X(11).
   431         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   432         16  FILLER              PIC X(17).
   433
   434     12  WS-NCLNOTE1.
   435         16  WS-NCLNOTE1-DESC    PIC X(11).
   436         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   437         16  FILLER              PIC X(17).
   438     12  WS-NCLNOTE2.
   439         16  WS-NCLNOTE2-DESC    PIC X(11).
   440         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   441         16  FILLER              PIC X(17).
   442
   443     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   444     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   445     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   446     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   447     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   448     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   449     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   450     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   451     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   452     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   453
   454     12  WS-AIG-WORK-AREAS.
   455         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   456             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   457         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   458             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   459         16  WS-FROM-DATE-MDY.
   460             20  WS-FROM-MO      PIC 99.
   461             20  WS-FROM-DA      PIC 99.
   462             20  WS-FROM-YR      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  10
* EL156.cbl
   463         16  WS-TEMP-DATE-MDY.
   464             20  WS-TEMP-MO      PIC 99.
   465             20  WS-TEMP-DA      PIC 99.
   466             20  WS-TEMP-YR      PIC 99.
   467         16  WS-BIN-FROM-DT      PIC XX.
   468         16  WS-TEMP-INC-MDY.
   469             20  WS-TEMP-INC-MO  PIC 99.
   470             20  WS-TEMP-INC-DA  PIC 99.
   471             20  WS-TEMP-INC-YR  PIC 99.
   472         16  WS-PMT-DUE-MDY.
   473             20  WS-PMT-DUE-MO   PIC 99.
   474             20  WS-PMT-DUE-DA   PIC 99.
   475             20  WS-PMT-DUE-YR   PIC 99.
   476         16  WS-PMT-DUE-DT       PIC XX.
   477         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   478         16  WS-RETRO-ELIM-DT    PIC XX.
   479         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   480             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   481         16  WS-SAVE-DUE-DA      PIC 99.
   482         16  WS-CDAYS            PIC S9(05).
   483         16  WS-DAYS-OFF         PIC S9(05).
   484         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   485             88  ELIM-SATISFIED            VALUE 'Y'.
   486         16  WS-AIG-CHECKNO.
   487             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   488             20  WS-A-CHECKNO-3-7.
   489                 24  FILLER              PIC X(3)    VALUE SPACES.
   490                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   491                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   492         16  WS-AIG-GROUPING.
   493             20  WS-A-BENE               PIC XXX.
   494             20  FILLER                  PIC XXX.
   495         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   496             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   497             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   498         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   499                 VALUE 'UNEMPLOYMENT PAYMENT'.
   500         16  WS-CHK-THRU-DT              PIC XX.
   501         16  WS-HOLD-BIN-DATE-1          PIC XX.
   502
   503 01  MISC-CSO-AREA.
   504     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   505     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   506     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   507         88  APPROVAL-NEEDED                        VALUE 'Y'.
   508     12  WS-APPROV-NOTE                  PIC X(43)
   509         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   510     12  WS-3550-APPROV-NOTE             PIC X(43)
   511         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   512     12  WS-REAUDIT-NOTE                 PIC X(43)
   513         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   514     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   515     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   516     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   517     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   518     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   519     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   520     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  11
* EL156.cbl
   521         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   522     12  WS-PAYEE-CITY-STATE     PIC X(30).
   523     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   524         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   525     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   526     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   527     12  WS-WORK-NAME            PIC X(30).
   528     12  FILLER  REDEFINES WS-WORK-NAME.
   529         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   530     12  WS-INSURED-NAME         PIC X(30).
   531     12  FILLER  REDEFINES WS-INSURED-NAME.
   532         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   533     12  WS-PAYEE-NAME           PIC X(30).
   534     12  FILLER  REDEFINES WS-PAYEE-NAME.
   535         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   536
   537 01  ERROR-MESSAGES.
   538     12  ER-0000                 PIC X(4)  VALUE '0000'.
   539     12  ER-0004                 PIC X(4)  VALUE '0004'.
   540     12  ER-0008                 PIC X(4)  VALUE '0008'.
   541     12  ER-0019                 PIC X(4)  VALUE '0019'.
   542     12  ER-0029                 PIC X(4)  VALUE '0029'.
   543     12  ER-0042                 PIC X(4)  VALUE '0042'.
   544     12  ER-0070                 PIC X(4)  VALUE '0070'.
   545     12  ER-0130                 PIC X(4)  VALUE '0130'.
   546     12  ER-0149                 PIC X(4)  VALUE '0149'.
   547     12  ER-0154                 PIC X(4)  VALUE '0154'.
   548     12  ER-0168                 PIC X(4)  VALUE '0168'.
   549     12  ER-0169                 PIC X(4)  VALUE '0169'.
   550     12  ER-0172                 PIC X(4)  VALUE '0174'.
   551     12  ER-0198                 PIC X(4)  VALUE '0198'.
   552     12  ER-0204                 PIC X(4)  VALUE '0204'.
   553     12  ER-0206                 PIC X(4)  VALUE '0206'.
   554     12  ER-0252                 PIC X(4)  VALUE '0252'.
   555     12  ER-0254                 PIC X(4)  VALUE '0254'.
   556     12  ER-0282                 PIC X(4)  VALUE '0282'.
   557     12  ER-0283                 PIC X(4)  VALUE '0283'.
   558     12  ER-0294                 PIC X(4)  VALUE '0294'.
   559     12  ER-0338                 PIC X(4)  VALUE '0338'.
   560     12  ER-0419                 PIC X(4)  VALUE '0419'.
   561     12  ER-0420                 PIC X(4)  VALUE '0420'.
   562     12  ER-0421                 PIC X(4)  VALUE '0421'.
   563     12  ER-0422                 PIC X(4)  VALUE '0422'.
   564     12  ER-0433                 PIC X(4)  VALUE '0433'.
   565     12  ER-0436                 PIC X(4)  VALUE '0436'.
   566     12  ER-0437                 PIC X(4)  VALUE '0437'.
   567     12  ER-0438                 PIC X(4)  VALUE '0438'.
   568     12  ER-0439                 PIC X(4)  VALUE '0439'.
   569     12  ER-0440                 PIC X(4)  VALUE '0440'.
   570     12  ER-0441                 PIC X(4)  VALUE '0441'.
   571     12  ER-0442                 PIC X(4)  VALUE '0442'.
   572     12  ER-0443                 PIC X(4)  VALUE '0443'.
   573     12  ER-0444                 PIC X(4)  VALUE '0444'.
   574     12  ER-0445                 PIC X(4)  VALUE '0445'.
   575     12  ER-0446                 PIC X(4)  VALUE '0446'.
   576     12  ER-0447                 PIC X(4)  VALUE '0447'.
   577     12  ER-0448                 PIC X(4)  VALUE '0448'.
   578     12  ER-0449                 PIC X(4)  VALUE '0449'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  12
* EL156.cbl
   579     12  ER-0452                 PIC X(4)  VALUE '0452'.
   580     12  ER-0458                 PIC X(4)  VALUE '0458'.
   581     12  ER-0459                 PIC X(4)  VALUE '0459'.
   582     12  ER-0460                 PIC X(4)  VALUE '0460'.
   583     12  ER-0461                 PIC X(4)  VALUE '0461'.
   584     12  ER-0462                 PIC X(4)  VALUE '0462'.
   585     12  ER-0463                 PIC X(4)  VALUE '0463'.
   586     12  ER-0464                 PIC X(4)  VALUE '0464'.
   587     12  ER-0465                 PIC X(4)  VALUE '0465'.
   588     12  ER-0466                 PIC X(4)  VALUE '0466'.
   589     12  ER-0467                 PIC X(4)  VALUE '0467'.
   590     12  ER-0468                 PIC X(4)  VALUE '0468'.
   591     12  ER-0469                 PIC X(4)  VALUE '0469'.
   592     12  ER-0473                 PIC X(4)  VALUE '0473'.
   593     12  ER-0474                 PIC X(4)  VALUE '0474'.
   594     12  ER-0475                 PIC X(4)  VALUE '0475'.
   595     12  ER-0476                 PIC X(4)  VALUE '0476'.
   596     12  ER-0477                 PIC X(4)  VALUE '0477'.
   597     12  ER-0478                 PIC X(4)  VALUE '0478'.
   598     12  ER-0479                 PIC X(4)  VALUE '0479'.
   599     12  ER-0481                 PIC X(4)  VALUE '0481'.
   600     12  ER-0491                 PIC X(4)  VALUE '0491'.
   601     12  ER-0492                 PIC X(4)  VALUE '0492'.
   602     12  ER-0493                 PIC X(4)  VALUE '0493'.
   603     12  ER-0494                 PIC X(4)  VALUE '0494'.
   604     12  ER-0495                 PIC X(4)  VALUE '0495'.
   605     12  ER-0499                 PIC X(4)  VALUE '0499'.
   606     12  ER-0500                 PIC X(4)  VALUE '0500'.
   607     12  ER-0501                 PIC X(4)  VALUE '0501'.
   608     12  ER-0502                 PIC X(4)  VALUE '0502'.
   609     12  ER-0508                 PIC X(4)  VALUE '0508'.
   610     12  ER-0513                 PIC X(4)  VALUE '0513'.
   611     12  ER-0518                 PIC X(4)  VALUE '0518'.
   612     12  ER-0524                 PIC X(4)  VALUE '0524'.
   613     12  ER-0525                 PIC X(4)  VALUE '0525'.
   614     12  ER-0526                 PIC X(4)  VALUE '0526'.
   615     12  ER-0530                 PIC X(4)  VALUE '0530'.
   616     12  ER-0540                 PIC X(4)  VALUE '0540'.
   617     12  ER-0541                 PIC X(4)  VALUE '0541'.
   618     12  ER-0542                 PIC X(4)  VALUE '0542'.
   619     12  ER-0543                 PIC X(4)  VALUE '0543'.
   620     12  ER-0545                 PIC X(4)  VALUE '0545'.
   621     12  ER-0552                 PIC X(4)  VALUE '0552'.
   622     12  ER-0555                 PIC X(4)  VALUE '0555'.
   623     12  ER-0556                 PIC X(4)  VALUE '0556'.
   624     12  ER-0557                 PIC X(4)  VALUE '0557'.
   625     12  ER-0572                 PIC X(4)  VALUE '0572'.
   626     12  ER-0573                 PIC X(4)  VALUE '0573'.
   627     12  ER-0594                 PIC X(4)  VALUE '0594'.
   628     12  ER-0616                 PIC X(4)  VALUE '0616'.
   629     12  ER-0617                 PIC X(4)  VALUE '0617'.
   630     12  ER-0618                 PIC X(4)  VALUE '0618'.
   631     12  ER-0657                 PIC X(4)  VALUE '0657'.
   632     12  ER-0658                 PIC X(4)  VALUE '0658'.
   633     12  ER-0699                 PIC X(4)  VALUE '0699'.
   634     12  ER-0730                 PIC X(4)  VALUE '0730'.
   635     12  ER-0737                 PIC X(4)  VALUE '0737'.
   636     12  ER-0760                 PIC X(4)  VALUE '0760'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  13
* EL156.cbl
   637     12  ER-0768                 PIC X(4)  VALUE '0768'.
   638     12  ER-0769                 PIC X(4)  VALUE '0769'.
   639     12  ER-0770                 PIC X(4)  VALUE '0770'.
   640     12  ER-0802                 PIC X(4)  VALUE '0802'.
   641     12  ER-0803                 PIC X(4)  VALUE '0803'.
   642     12  ER-0819                 PIC X(4)  VALUE '0819'.
   643     12  ER-0834                 PIC X(4)  VALUE '0834'.
   644     12  ER-0836                 PIC X(4)  VALUE '0836'.
   645     12  ER-0844                 PIC X(4)  VALUE '0844'.
   646     12  ER-0845                 PIC X(4)  VALUE '0845'.
   647     12  ER-0846                 PIC X(4)  VALUE '0846'.
   648     12  ER-0849                 PIC X(4)  VALUE '0849'.
   649     12  ER-0851                 PIC X(4)  VALUE '0851'.
   650     12  ER-0872                 PIC X(4)  VALUE '0872'.
   651     12  ER-0873                 PIC X(4)  VALUE '0873'.
   652     12  ER-0874                 PIC X(4)  VALUE '0874'.
   653     12  ER-0879                 PIC X(4)  VALUE '0879'.
   654     12  ER-0919                 PIC X(4)  VALUE '0919'.
   655     12  ER-0921                 PIC X(4)  VALUE '0921'.
   656     12  ER-0923                 PIC X(4)  VALUE '0923'.
   657     12  ER-0925                 PIC X(4)  VALUE '0925'.
   658     12  ER-0944                 PIC X(4)  VALUE '0944'.
   659     12  ER-0945                 PIC X(4)  VALUE '0945'.
   660     12  ER-0946                 PIC X(4)  VALUE '0946'.
   661     12  ER-0947                 PIC X(4)  VALUE '0947'.
   662     12  ER-0948                 PIC X(4)  VALUE '0948'.
   663     12  ER-0949                 PIC X(4)  VALUE '0949'.
   664     12  ER-0950                 PIC X(4)  VALUE '0950'.
   665     12  ER-0951                 PIC X(4)  VALUE '0951'.
   666     12  ER-0954                 PIC X(4)  VALUE '0954'.
   667     12  ER-0956                 PIC X(4)  VALUE '0956'.
   668     12  ER-0967                 PIC X(4)  VALUE '0967'.
   669     12  ER-0968                 PIC X(4)  VALUE '0968'.
   670     12  ER-0974                 PIC X(4)  VALUE '0974'.
   671     12  ER-0975                 PIC X(4)  VALUE '0975'.
   672     12  ER-1561                 PIC X(4)  VALUE '1561'.
   673     12  ER-1566                 PIC X(4)  VALUE '1566'.
   674     12  ER-1567                 PIC X(4)  VALUE '1567'.
   675     12  ER-1569                 PIC X(4)  VALUE '1569'.
   676     12  er-1657                 pic x(4)  value '1657'.
   677     12  er-1658                 pic x(4)  value '1658'.
   678     12  er-1667                 pic x(4)  value '1667'.
   679     12  er-1670                 pic x(4)  value '1670'.
   680     12  er-1671                 pic x(4)  value '1671'.
   681     12  er-1672                 pic x(4)  value '1672'.
   682     12  er-1673                 pic x(4)  value '1673'.
   683     12  er-1674                 pic x(4)  value '1674'.
   684     12  ER-1775                 PIC X(4)  VALUE '1775'.
   685     12  ER-1880                 PIC X(4)  VALUE '1880'.
   686     12  ER-2044                 PIC X(4)  VALUE '2044'.
   687     12  ER-3140                 PIC X(4)  VALUE '3140'.
   688     12  ER-3141                 PIC X(4)  VALUE '3141'.
   689     12  ER-3255                 PIC X(4)  VALUE '3255'.
   690     12  ER-3516                 PIC X(4)  VALUE '3516'.
   691     12  ER-3527                 PIC X(4)  VALUE '3527'.
   692     12  ER-3528                 PIC X(4)  VALUE '3528'.
   693     12  ER-3529                 PIC X(4)  VALUE '3529'.
   694     12  ER-3530                 PIC X(4)  VALUE '3530'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  14
* EL156.cbl
   695     12  ER-3531                 PIC X(4)  VALUE '3531'.
   696     12  ER-3532                 PIC X(4)  VALUE '3532'.
   697     12  ER-3533                 PIC X(4)  VALUE '3533'.
   698     12  ER-3534                 PIC X(4)  VALUE '3534'.
   699     12  ER-3535                 PIC X(4)  VALUE '3535'.
   700     12  ER-3536                 PIC X(4)  VALUE '3536'.
   701     12  ER-3537                 PIC X(4)  VALUE '3537'.
   702     12  ER-3538                 PIC X(4)  VALUE '3538'.
   703     12  ER-3539                 PIC X(4)  VALUE '3539'.
   704     12  ER-3540                 PIC X(4)  VALUE '3540'.
   705     12  ER-3541                 PIC X(4)  VALUE '3541'.
   706     12  ER-3542                 PIC X(4)  VALUE '3542'.
   707     12  ER-3543                 PIC X(4)  VALUE '3543'.
   708     12  ER-3546                 PIC X(4)  VALUE '3546'.
   709     12  ER-3549                 PIC X(4)  VALUE '3549'.
   710     12  ER-3818                 PIC X(4)  VALUE '3818'.
   711     12  ER-7540                 PIC X(4)  VALUE '7540'.
   712     12  ER-7576                 PIC X(4)  VALUE '7576'.
   713     12  ER-7579                 PIC X(4)  VALUE '7579'.
   714     12  ER-7580                 PIC X(4)  VALUE '7580'.
   715     12  ER-7583                 PIC X(4)  VALUE '7583'.
   716     12  ER-7830                 PIC X(4)  VALUE '7830'.
   717     12  ER-7831                 PIC X(4)  VALUE '7831'.
   718     12  ER-7832                 PIC X(4)  VALUE '7832'.
   719     12  ER-7833                 PIC X(4)  VALUE '7833'.
   720     12  ER-7834                 PIC X(4)  VALUE '7834'.
   721     12  ER-7835                 PIC X(4)  VALUE '7835'.
   722     12  ER-7836                 PIC X(4)  VALUE '7836'.
   723     12  ER-7837                 PIC X(4)  VALUE '7837'.
   724     12  ER-7838                 PIC X(4)  VALUE '7838'.
   725     12  ER-7841                 PIC X(4)  VALUE '7841'.
   726     12  ER-7844                 PIC X(4)  VALUE '7844'.
   727     12  ER-7845                 PIC X(4)  VALUE '7845'.
   728     12  ER-8000                 PIC X(4)  VALUE '8000'.
   729     12  ER-8051                 PIC X(4)  VALUE '8051'.
   730     12  ER-8052                 PIC X(4)  VALUE '8052'.
   731     12  ER-8053                 PIC X(4)  VALUE '8053'.
   732     12  ER-8054                 PIC X(4)  VALUE '8054'.
   733     12  ER-8055                 PIC X(4)  VALUE '8055'.
   734     12  ER-8056                 PIC X(4)  VALUE '8056'.
   735     12  ER-8057                 PIC X(4)  VALUE '8057'.
   736     12  ER-8058                 PIC X(4)  VALUE '8058'.
   737     12  ER-8059                 PIC X(4)  VALUE '8059'.
   738     12  ER-8060                 PIC X(4)  VALUE '8060'.
   739     12  ER-8061                 PIC X(4)  VALUE '8061'.
   740     12  ER-8062                 PIC X(4)  VALUE '8062'.
   741     12  ER-8063                 PIC X(4)  VALUE '8063'.
   742     12  ER-8064                 PIC X(4)  VALUE '8064'.
   743     12  ER-8065                 PIC X(4)  VALUE '8065'.
   744     12  ER-8066                 PIC X(4)  VALUE '8066'.
   745     12  ER-8146                 PIC X(4)  VALUE '8146'.
   746     12  ER-8147                 PIC X(4)  VALUE '8147'.
   747     12  ER-8152                 PIC X(4)  VALUE '8152'.
   748     12  ER-8153                 PIC X(4)  VALUE '8153'.
   749     12  ER-8154                 PIC X(4)  VALUE '8154'.
   750     12  ER-8155                 PIC X(4)  VALUE '8155'.
   751     12  ER-8310                 PIC X(4)  VALUE '8310'.
   752     12  ER-8311                 PIC X(4)  VALUE '8311'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  15
* EL156.cbl
   753     12  ER-8312                 PIC X(4)  VALUE '8312'.
   754     12  ER-8313                 PIC X(4)  VALUE '8313'.
   755     12  ER-8314                 PIC X(4)  VALUE '8314'.
   756     12  ER-8315                 PIC X(4)  VALUE '8315'.
   757     12  ER-8316                 PIC X(4)  VALUE '8316'.
   758     12  ER-8317                 PIC X(4)  VALUE '8317'.
   759
   760 01  CSO-WORK-FIELDS.
   761     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   762       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   763
   764     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   765     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   766         88  CERT-NOTE-ADDED           VALUE 'Y'.
   767     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   768         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   769     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   770
   771     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   772
   773 01  SC-NP6-CERT-NOTE.
   774     12  FILLER                  PIC X(12)
   775               VALUE 'REM BENEFIT '.
   776     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   777     12  SC-NP6-COMM             PIC X(8)
   778               VALUE ' + 6 MO '.
   779     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   780     12  FILLER                  PIC X(12)
   781               VALUE ' = AMT PAID '.
   782     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   783
   784 01  SC-NP6-ORIG-NOTE.
   785     12  FILLER                  PIC X(63)  VALUE
   786         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   787 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   788     88  PDEF-FOUND                   VALUE 'Y'.
   789 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   790     88  ACCT-FOUND                   VALUE 'Y'.
   791 01  CTBL-KEY-SAVE               PIC X(5).
   792 01  CTBL-KEY.
   793     05  CTBL-COMPANY-CD         PIC X.
   794     05  CTBL-TABLE              PIC XXX.
   795     05  CTBL-BEN-TYPE           PIC X.
   796     05  CTBL-BEN-CODE           PIC XX.
   797 01  ERPDEF-KEY-SAVE             PIC X(18).
   798 01  ERPDEF-KEY.
   799     12  ERPDEF-COMPANY-CD       PIC X.
   800     12  ERPDEF-STATE            PIC XX.
   801     12  ERPDEF-PROD-CD          PIC XXX.
   802     12  F                       PIC X(7).
   803     12  ERPDEF-BEN-TYPE         PIC X.
   804     12  ERPDEF-BEN-CODE         PIC XX.
   805     12  ERPDEF-EXP-DT           PIC XX.
   806 01  ELCRTT-KEY.
   807     05  CTRLR-COMP-CD       PIC X.
   808     05  CTRLR-CARRIER       PIC X.
   809     05  CTRLR-GROUPING      PIC X(6).
   810     05  CTRLR-STATE         PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  16
* EL156.cbl
   811     05  CTRLR-ACCOUNT       PIC X(10).
   812     05  CTRLR-EFF-DT        PIC XX.
   813     05  CTRLR-CERT-NO       PIC X(11).
   814     05  CTRLR-REC-TYPE      PIC X.
   815 01  ACCESS-KEYS.
   816     12  ELARCH-KEY.
   817         16  ARCH-CO             PIC X.
   818         16  ARCH-NUMBER         PIC S9(08) COMP.
   819         16  ARCH-REC-TYPE       PIC X.
   820         16  ARCH-SEQ            PIC S9(04) COMP.
   821     12  ELMSTR-KEY.
   822         16  MSTR-COMP-CD        PIC X.
   823         16  MSTR-CARRIER        PIC X.
   824         16  MSTR-CLAIM-NO       PIC X(7).
   825         16  MSTR-CERT-NO        PIC X(11).
   826     12  ELCNTL-KEY.
   827         16  CNTL-COMP-ID        PIC X(3).
   828         16  CNTL-REC-TYPE       PIC X.
   829         16  CNTL-ACCESS         PIC X(4).
   830         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   831     12  ELCERT-KEY.
   832         16  CERT-COMP-CD        PIC X.
   833         16  CERT-CARRIER        PIC X.
   834         16  CERT-GROUPING       PIC X(6).
   835         16  CERT-STATE          PIC XX.
   836         16  CERT-ACCOUNT        PIC X(10).
   837         16  CERT-EFF-DT         PIC XX.
   838         16  CERT-CERT-NO        PIC X(11).
   839     12  ELTRLR-KEY.
   840         16  TRLR-COMP-CD        PIC X.
   841         16  TRLR-CARRIER        PIC X.
   842         16  TRLR-CLAIM-NO       PIC X(7).
   843         16  TRLR-CERT-NO        PIC X(11).
   844         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   845     12  ELACTQ-KEY.
   846         16  ACTQ-COMP-CD        PIC X.
   847         16  ACTQ-CARRIER        PIC X.
   848         16  ACTQ-CLAIM-NO       PIC X(7).
   849         16  ACTQ-CERT-NO        PIC X(11).
   850     12  W-NOTE-KEY.
   851         16  W-NOTE-COMP-CD      PIC X.
   852         16  W-NOTE-CERT-KEY.
   853             20  W-NOTE-CARRIER  PIC X.
   854             20  W-NOTE-GROUPING PIC X(6).
   855             20  W-NOTE-STATE    PIC XX.
   856             20  W-NOTE-ACCOUNT  PIC X(10).
   857             20  W-NOTE-EFF-DT   PIC XX.
   858             20  W-NOTE-CERT-NO  PIC X(11).
   859     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   860     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   861     12  ERACCT-KEY.
   862         16  ERACCT-PARTIAL-KEY.
   863             20  ACCT-COMP-CD    PIC X.
   864             20  ACCT-CARRIER    PIC X.
   865             20  ACCT-GROUPING   PIC X(6).
   866             20  ACCT-STATE      PIC XX.
   867             20  ACCT-ACCOUNT    PIC X(10).
   868         16  ACCT-EXP-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  17
* EL156.cbl
   869         16  FILLER              PIC X(4) VALUE SPACES.
   870     12  ELCHKQ-KEY.
   871         16  CHKQ-COMP-CD        PIC X.
   872         16  CHKQ-CONTROL        PIC S9(8) COMP.
   873         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   874     12  ELBENE-KEY.
   875         16  BENE-COMP-CD         PIC X.
   876         16  BENE-RECORD-TYPE     PIC X.
   877         16  BENE-NUMBER          PIC X(10).
   878     12  ERCOMP-KEY.
   879         16  COMP-COMP-CD        PIC X.
   880         16  COMP-CARRIER        PIC X.
   881         16  COMP-GROUP          PIC X(06).
   882         16  COMP-FIN-RESP       PIC X(10).
   883         16  COMP-ACCOUNT        PIC X(10).
   884         16  COMP-TYPE           PIC X.
   885
   886     12  DLO035-KEY.
   887         16  DL35-PROCESS-TYPE   PIC X.
   888         16  DL35-CREDIT-CARD    PIC X(20).
   889         16  DL35-BEN-TYPE       PIC XX.
   890         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   891         16  DL35-RETURN-CODE    PIC XX.
   892
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  18
* EL156.cbl
   894*    COPY ELCDATE.
   895******************************************************************
   896*                                                                *
   897*                                                                *
   898*                            ELCDATE.                            *
   899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   900*                            VMOD=2.003
   901*                                                                *
   902*                                                                *
   903*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   904*                 LENGTH = 200                                   *
   905******************************************************************
   906
   907 01  DATE-CONVERSION-DATA.
   908     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   909     12  DC-OPTION-CODE                PIC X.
   910         88  BIN-TO-GREG                VALUE ' '.
   911         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   912         88  EDIT-GREG-TO-BIN           VALUE '2'.
   913         88  YMD-GREG-TO-BIN            VALUE '3'.
   914         88  MDY-GREG-TO-BIN            VALUE '4'.
   915         88  JULIAN-TO-BIN              VALUE '5'.
   916         88  BIN-PLUS-ELAPSED           VALUE '6'.
   917         88  FIND-CENTURY               VALUE '7'.
   918         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   919         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   920         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   921         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   922         88  JULIAN-TO-BIN-3            VALUE 'C'.
   923         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   924         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   925         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   926         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   927         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   928         88  CHECK-LEAP-YEAR            VALUE 'H'.
   929         88  BIN-3-TO-GREG              VALUE 'I'.
   930         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   931         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   932         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   933         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   934         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   935         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   936         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   937         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   938         88  THREE-CHARACTER-BIN
   939                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   940         88  GREGORIAN-TO-BIN
   941                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   942         88  BIN-TO-GREGORIAN
   943                  VALUES ' ' '1' 'I' '8' 'G'.
   944         88  JULIAN-TO-BINARY
   945                  VALUES '5' 'C' 'E' 'F'.
   946     12  DC-ERROR-CODE                 PIC X.
   947         88  NO-CONVERSION-ERROR        VALUE ' '.
   948         88  DATE-CONVERSION-ERROR
   949                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   950         88  DATE-IS-ZERO               VALUE '1'.
   951         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  19
* EL156.cbl
   952         88  DATE-IS-INVALID            VALUE '3'.
   953         88  DATE1-GREATER-DATE2        VALUE '4'.
   954         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   955         88  DATE-INVALID-OPTION        VALUE '9'.
   956         88  INVALID-CENTURY            VALUE 'A'.
   957         88  ONLY-CENTURY               VALUE 'B'.
   958         88  ONLY-LEAP-YEAR             VALUE 'C'.
   959         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   960     12  DC-END-OF-MONTH               PIC X.
   961         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   962     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   963         88  USE-NORMAL-PROCESS         VALUE ' '.
   964         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   965         88  ADJUST-UP-100-YRS          VALUE '2'.
   966     12  FILLER                        PIC X.
   967     12  DC-CONVERSION-DATES.
   968         16  DC-BIN-DATE-1             PIC XX.
   969         16  DC-BIN-DATE-2             PIC XX.
   970         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   971         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   972                       DC-GREG-DATE-1-EDIT.
   973             20  DC-EDIT1-MONTH        PIC 99.
   974             20  SLASH1-1              PIC X.
   975             20  DC-EDIT1-DAY          PIC 99.
   976             20  SLASH1-2              PIC X.
   977             20  DC-EDIT1-YEAR         PIC 99.
   978         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   979         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   980                     DC-GREG-DATE-2-EDIT.
   981             20  DC-EDIT2-MONTH        PIC 99.
   982             20  SLASH2-1              PIC X.
   983             20  DC-EDIT2-DAY          PIC 99.
   984             20  SLASH2-2              PIC X.
   985             20  DC-EDIT2-YEAR         PIC 99.
   986         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   987         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   988                     DC-GREG-DATE-1-YMD.
   989             20  DC-YMD-YEAR           PIC 99.
   990             20  DC-YMD-MONTH          PIC 99.
   991             20  DC-YMD-DAY            PIC 99.
   992         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   993         16  DC-GREG-DATE-1-MDY-R REDEFINES
   994                      DC-GREG-DATE-1-MDY.
   995             20  DC-MDY-MONTH          PIC 99.
   996             20  DC-MDY-DAY            PIC 99.
   997             20  DC-MDY-YEAR           PIC 99.
   998         16  DC-GREG-DATE-1-ALPHA.
   999             20  DC-ALPHA-MONTH        PIC X(10).
  1000             20  DC-ALPHA-DAY          PIC 99.
  1001             20  FILLER                PIC XX.
  1002             20  DC-ALPHA-CENTURY.
  1003                 24 DC-ALPHA-CEN-N     PIC 99.
  1004             20  DC-ALPHA-YEAR         PIC 99.
  1005         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1006         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1007         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1008         16  DC-JULIAN-DATE            PIC 9(05).
  1009         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  20
* EL156.cbl
  1010                                       PIC 9(05).
  1011         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1012             20  DC-JULIAN-YEAR        PIC 99.
  1013             20  DC-JULIAN-DAYS        PIC 999.
  1014         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1015         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1016         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1017     12  DATE-CONVERSION-VARIBLES.
  1018         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1019         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1020             20  FILLER                PIC 9(3).
  1021             20  HOLD-CEN-1-CCYY.
  1022                 24  HOLD-CEN-1-CC     PIC 99.
  1023                 24  HOLD-CEN-1-YY     PIC 99.
  1024             20  HOLD-CEN-1-MO         PIC 99.
  1025             20  HOLD-CEN-1-DA         PIC 99.
  1026         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1027             20  HOLD-CEN-1-R-MO       PIC 99.
  1028             20  HOLD-CEN-1-R-DA       PIC 99.
  1029             20  HOLD-CEN-1-R-CCYY.
  1030                 24  HOLD-CEN-1-R-CC   PIC 99.
  1031                 24  HOLD-CEN-1-R-YY   PIC 99.
  1032             20  FILLER                PIC 9(3).
  1033         16  HOLD-CENTURY-1-X.
  1034             20  FILLER                PIC X(3)  VALUE SPACES.
  1035             20  HOLD-CEN-1-X-CCYY.
  1036                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1037                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1038             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1039             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1040         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1041             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1042             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1043             20  HOLD-CEN-1-R-X-CCYY.
  1044                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1045                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1046             20  FILLER                PIC XXX.
  1047         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1048         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1049         16  DC-JULIAN-DATE-1          PIC 9(07).
  1050         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1051             20  DC-JULIAN-1-CCYY.
  1052                 24  DC-JULIAN-1-CC    PIC 99.
  1053                 24  DC-JULIAN-1-YR    PIC 99.
  1054             20  DC-JULIAN-DA-1        PIC 999.
  1055         16  DC-JULIAN-DATE-2          PIC 9(07).
  1056         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1057             20  DC-JULIAN-2-CCYY.
  1058                 24  DC-JULIAN-2-CC    PIC 99.
  1059                 24  DC-JULIAN-2-YR    PIC 99.
  1060             20  DC-JULIAN-DA-2        PIC 999.
  1061         16  DC-GREG-DATE-A-EDIT.
  1062             20  DC-EDITA-MONTH        PIC 99.
  1063             20  SLASHA-1              PIC X VALUE '/'.
  1064             20  DC-EDITA-DAY          PIC 99.
  1065             20  SLASHA-2              PIC X VALUE '/'.
  1066             20  DC-EDITA-CCYY.
  1067                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  21
* EL156.cbl
  1068                 24  DC-EDITA-YEAR     PIC 99.
  1069         16  DC-GREG-DATE-B-EDIT.
  1070             20  DC-EDITB-MONTH        PIC 99.
  1071             20  SLASHB-1              PIC X VALUE '/'.
  1072             20  DC-EDITB-DAY          PIC 99.
  1073             20  SLASHB-2              PIC X VALUE '/'.
  1074             20  DC-EDITB-CCYY.
  1075                 24  DC-EDITB-CENT     PIC 99.
  1076                 24  DC-EDITB-YEAR     PIC 99.
  1077         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1078         16  DC-GREG-DATE-CYMD-R REDEFINES
  1079                              DC-GREG-DATE-CYMD.
  1080             20  DC-CYMD-CEN           PIC 99.
  1081             20  DC-CYMD-YEAR          PIC 99.
  1082             20  DC-CYMD-MONTH         PIC 99.
  1083             20  DC-CYMD-DAY           PIC 99.
  1084         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1085         16  DC-GREG-DATE-MDCY-R REDEFINES
  1086                              DC-GREG-DATE-MDCY.
  1087             20  DC-MDCY-MONTH         PIC 99.
  1088             20  DC-MDCY-DAY           PIC 99.
  1089             20  DC-MDCY-CEN           PIC 99.
  1090             20  DC-MDCY-YEAR          PIC 99.
  1091    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1092        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1093    12  DC-EL310-DATE                  PIC X(21).
  1094    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  22
* EL156.cbl
  1096*    COPY ELCLOGOF.
  1097******************************************************************
  1098*                                                                *
  1099*                                                                *
  1100*                            ELCLOGOF.                           *
  1101*                            VMOD=2.001                          *
  1102*                                                                *
  1103*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1104*                                                                *
  1105******************************************************************
  1106 01  CLASIC-LOGOFF.
  1107     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1108     12  LOGOFF-TEXT.
  1109         16  FILLER          PIC X(5)    VALUE SPACES.
  1110         16  LOGOFF-MSG.
  1111             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1112             20  FILLER      PIC X       VALUE SPACES.
  1113             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1114         16  FILLER          PIC X(80)
  1115           VALUE '* YOU ARE NOW LOGGED OFF'.
  1116         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1117         16  FILLER          PIC X       VALUE QUOTE.
  1118         16  LOGOFF-SYS-MSG  PIC X(17)
  1119           VALUE 'S CLAS-IC SYSTEM '.
  1120     12  TEXT-MESSAGES.
  1121         16  UNACCESS-MSG    PIC X(29)
  1122             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1123         16  PGMIDERR-MSG    PIC X(17)
  1124             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  23
* EL156.cbl
  1126*    COPY ELCCALC.
  1127******************************************************************
  1128*                                                                *
  1129*                           ELCCALC.                            *
  1130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1131*                            VMOD=2.025                          *
  1132*                                                                *
  1133*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1134*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1135*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1136*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1137*                                                                *
  1138*  PASSED TO ELRTRM                                              *
  1139*  -----------------                                             *
  1140*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1141*  ORIGINAL TERM                                                 *
  1142*  BEGINNING DATE                                                *
  1143*  ENDING DATE                                                   *
  1144*  COMPANY I.D.                                                  *
  1145*  ACCOUNT MASTER USER FIELD                                     *
  1146*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1147*  FREE LOOK DAYS                                                *
  1148*                                                                *
  1149*  RETURNED FROM ELRTRM                                          *
  1150*  ---------------------                                         *
  1151*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1152*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1153*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1154*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1155*----------------------------------------------------------------*
  1156*  PASSED TO ELRAMT                                              *
  1157*  ----------------                                              *
  1158*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1159*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1160*  ORIGINAL AMOUNT                                               *
  1161*  ALTERNATE BENEFIT (BALLON)                                    *
  1162*  A.P.R. - NET PAY ONLY                                         *
  1163*  METHOD
  1164*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1165*  COMPANY I.D.                                                  *
  1166*  BENEFIT TYPE                                                  *
  1167*                                                                *
  1168*  RETURNED FROM ELRAMT                                          *
  1169*  --------------------                                          *
  1170*  REMAINING AMOUNT 1 - CURRENT                                  *
  1171*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1172*  REMAINING AMOUNT FACTOR
  1173*----------------------------------------------------------------*
  1174*  PASSED TO ELRESV                                              *
  1175*  -----------------                                             *
  1176*  CERTIFICATE EFFECTIVE DATE                                    *
  1177*  VALUATION DATE                                                *
  1178*  PAID THRU DATE                                                *
  1179*  BENEFIT                                                       *
  1180*  INCURRED DATE                                                 *
  1181*  REPORTED DATE                                                 *
  1182*  ISSUE AGE                                                     *
  1183*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  24
* EL156.cbl
  1184*  CDT PERCENT                                                   *
  1185*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1186* *CLAIM TYPE (LIFE, A/H)                                        *
  1187* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1188* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1189*                                                                *
  1190*  RETURNED FROM ELRESV                                          *
  1191*  --------------------                                          *
  1192*  CDT TABLE USED                                                *
  1193*  CDT FACTOR USED                                               *
  1194*  PAY TO CURRENT RESERVE                                        *
  1195*  I.B.N.R. - A/H ONLY                                           *
  1196*  FUTURE (ACCRUED) AH ONLY                                      *
  1197*----------------------------------------------------------------*
  1198*  PASSED TO ELRATE                                              *
  1199*  ----------------                                              *
  1200*  CERT ISSUE DATE                                               *
  1201*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1202*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1203*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1204*  STATE CODE (CLIENT DEFINED)                                   *
  1205*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1206*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1207*  DEVIATION CODE                                                *
  1208*  ISSUE AGE                                                     *
  1209*  ORIGINAL BENEFIT AMOUNT                                       *
  1210*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1211*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1212*  BENEFIT KIND (LIFE OR A/H)                                    *
  1213*  A.P.R.                                                        *
  1214*  METHOD
  1215*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1216*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1217*  COMPANY I.D. (3 CHARACTER)                                    *
  1218*  BENEFIT CODE                                                  *
  1219*  BENEFIT OVERRIDE CODE                                         *
  1220*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1221*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1222*  JOINT INDICATOR (CSL ONLY)                                    *
  1223*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1224*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1225*                                                                *
  1226*  RETURNED FROM ELRATE                                          *
  1227*  --------------------                                          *
  1228*  CALCULATED PREMIUM                                            *
  1229*  PREMIUM RATE                                                  *
  1230*  MORTALITY CODE                                                *
  1231*  MAX ATTAINED AGE                                              *
  1232*  MAX AGE                                                       *
  1233*  MAX TERM                                                      *
  1234*  MAX MONTHLY BENEFIT                                           *
  1235*  MAX TOTAL BENIFIT                                             *
  1236*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1237*----------------------------------------------------------------*
  1238*  PASSED TO ELRFND                                              *
  1239*  ----------------                                              *
  1240*  CERT ISSUE DATE                                               *
  1241*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  25
* EL156.cbl
  1242*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1243*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1244*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1245*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1246*  STATE CODE (CLIENT DEFINED)                                   *
  1247*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1248*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1249*  DEVIATION CODE                                                *
  1250*  ISSUE AGE                                                     *
  1251*  ORIGINAL BENEFIT AMOUNT                                       *
  1252*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1253*  PROCESS TYPE (CANCEL)                                         *
  1254*  BENEFIT KIND (LIFE OR A/H)                                    *
  1255*  A.P.R.                                                        *
  1256*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1257*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1258*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1259*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1260*  COMPANY I.D. (3 CHARACTER)                                    *
  1261*  BENEFIT CODE                                                  *
  1262*  BENEFIT OVERRIDE CODE                                         *
  1263*                                                                *
  1264*  RETURNED FROM ELRFND                                          *
  1265*  --------------------                                          *
  1266*  CALCULATED REFUND                                             *
  1267*----------------------------------------------------------------*
  1268*  PASSED TO ELEARN                                              *
  1269*  ----------------                                              *
  1270*  CERT ISSUE DATE                                               *
  1271*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1272*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1273*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1274*  STATE CODE (CLIENT DEFINED)                                   *
  1275*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1276*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1277*  DEVIATION CODE                                                *
  1278*  ISSUE AGE                                                     *
  1279*  ORIGINAL BENEFIT AMOUNT                                       *
  1280*  BENEFIT KIND (LIFE OR A/H)                                    *
  1281*  A.P.R.                                                        *
  1282*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1283*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1284*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1285*  COMPANY I.D. (3 CHARACTER)                                    *
  1286*  BENEFIT CODE                                                  *
  1287*  BENEFIT OVERRIDE CODE                                         *
  1288*                                                                *
  1289*  RETURNED FROM ELEARN                                          *
  1290*  --------------------                                          *
  1291*  INDICATED  EARNINGS                                           *
  1292*----------------------------------------------------------------*
  1293*                 LENGTH = 450                                   *
  1294*                                                                *
  1295******************************************************************
  1296******************************************************************
  1297*                   C H A N G E   L O G
  1298*
  1299* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  26
* EL156.cbl
  1300*-----------------------------------------------------------------
  1301*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1302* EFFECTIVE    NUMBER
  1303*-----------------------------------------------------------------
  1304* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1305* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1306* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1307* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1308* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1309* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1310* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1311* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1312* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1313******************************************************************
  1314
  1315 01  CALCULATION-PASS-AREA.
  1316     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1317                                     COMP.
  1318
  1319     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1320       88  NO-CP-ERROR                             VALUE ZERO.
  1321       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1322                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1323       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1324       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1325       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1326       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1327       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1328       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1329       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1330       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1331       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1332       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1333       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1334       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1335       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1336       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1337       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1338       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1339       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1340
  1341     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1342       88  NO-CP-ERROR-2                           VALUE ZERO.
  1343***********************  INPUT AREAS ****************************
  1344
  1345     12  CP-CALCULATION-AREA.
  1346         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1347         16  CP-CERT-EFF-DT        PIC XX.
  1348         16  CP-VALUATION-DT       PIC XX.
  1349         16  CP-PAID-THRU-DT       PIC XX.
  1350         16  CP-BENEFIT-TYPE       PIC X.
  1351           88  CP-AH                               VALUE 'A' 'D'
  1352                                                   'I' 'U'.
  1353           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1354           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1355         16  CP-INCURRED-DT        PIC XX.
  1356         16  CP-REPORTED-DT        PIC XX.
  1357         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  27
* EL156.cbl
  1358         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1359         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1360                                     COMP-3.
  1361         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1362                                     COMP-3.
  1363         16  CP-CDT-METHOD         PIC X.
  1364           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1365           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1366           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1367         16  CP-CLAIM-TYPE         PIC X.
  1368           88  CP-AH-CLAIM                         VALUE 'A'.
  1369           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1370         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1371                                     COMP-3.
  1372         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1373                                     COMP-3.
  1374         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1375                                     COMP-3.
  1376         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1377                                     COMP-3.
  1378         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1379                                     COMP-3.
  1380         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1383                                     COMP-3.
  1384         16  CP-REM-TERM-METHOD    PIC X.
  1385           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1386           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1387           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1388           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1389           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1390           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1391           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1392         16  CP-EARNING-METHOD     PIC X.
  1393           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1394           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1395           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1396           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1397           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1398           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1399           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1400           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1401           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1402           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1403           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1404           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1405           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1406           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1407         16  CP-PROCESS-TYPE       PIC X.
  1408           88  CP-CLAIM                            VALUE '1'.
  1409           88  CP-CANCEL                           VALUE '2'.
  1410           88  CP-ISSUE                            VALUE '3'.
  1411         16  CP-SPECIAL-CALC-CD    PIC X.
  1412           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1413           88  CP-1-MTH-INTEREST               VALUE ' '.
  1414           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1415           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  28
* EL156.cbl
  1416           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1417           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1418           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1419           88  CP-FARM-PLAN                    VALUE 'F'.
  1420           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1421           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1422           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1423           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1424           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1425           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1426           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1427           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1428           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1429           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1430                                                     'W' 'X'.
  1431           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1432           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1433           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1434           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1435           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1436           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1437           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1438           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1439           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1440           88  CP-CSL-METH-1                   VALUE '5'.
  1441           88  CP-CSL-METH-2                   VALUE '6'.
  1442           88  CP-CSL-METH-3                   VALUE '7'.
  1443           88  CP-CSL-METH-4                   VALUE '8'.
  1444
  1445         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1446                                     COMP-3.
  1447         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1448         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1449         16  CP-STATE              PIC XX          VALUE SPACE.
  1450         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1451         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1452           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1453               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1454         16  CP-R78-OPTION         PIC X.
  1455           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1456           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1457
  1458         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1459         16  CP-IBNR-RESERVE-SW    PIC X.
  1460         16  CP-CLAIM-STATUS       PIC X.
  1461         16  CP-RATE-FILE          PIC X.
  1462         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1463                                     COMP-3.
  1464
  1465         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1466         16  CP-AH-OVERRIDE-CODE   PIC X.
  1467
  1468         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1469                                     COMP-3.
  1470         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1471                                   PIC S9(5)V99 COMP-3.
  1472         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1473                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  29
* EL156.cbl
  1474         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1475                                     COMP-3.
  1476         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1477                                     COMP-3.
  1478         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1479                                  PIC S9(7)V99 COMP-3.
  1480
  1481         16  CP-PAID-FROM-DATE     PIC X(02).
  1482         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1483         16  CP-EXT-DAYS-CALC      PIC X.
  1484           88  CP-EXT-NO-CHG                   VALUE ' '.
  1485           88  CP-EXT-CHG-LF                   VALUE '1'.
  1486           88  CP-EXT-CHG-AH                   VALUE '2'.
  1487           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1488         16  CP-DOMICILE-STATE     PIC XX.
  1489         16  CP-CARRIER            PIC X.
  1490         16  CP-REIN-FLAG          PIC X.
  1491         16  CP-REM-TRM-CALC-OPTION PIC X.
  1492           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1493                      '2' '3' '4' '5'.
  1494           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1495           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1496           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1497           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1498           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1499           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1500           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1501           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1502         16  CP-SIG-SWITCH         PIC X.
  1503         16  CP-RATING-METHOD      PIC X.
  1504           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1505           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1506           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1507           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1508           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1509           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1510           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1511           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1512           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1513         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1514                                     COMP-3.
  1515         16  CP-BEN-CATEGORY       PIC X.
  1516         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1517         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1518                                   PIC S99V9(5) COMP-3.
  1519         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1520         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1521                                   PIC S99V9(5) COMP-3.
  1522         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1523         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1524         16  CP-EXPIRE-DT          PIC XX.
  1525         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1526         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1527         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1528         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1529         16  CP-DDF-SPEC-CALC      PIC X.
  1530             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1531             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  30
* EL156.cbl
  1532         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1533         16  CP-CANCEL-REASON      PIC X.
  1534         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1535         16  CP-PMT-MODE           PIC X.
  1536         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1537         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1538         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1539         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1540         16  FILLER                PIC X.
  1541
  1542***************    OUTPUT FROM ELRESV   ************************
  1543
  1544         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1545
  1546         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1547                                     COMP-3.
  1548         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1549                                     COMP-3.
  1550         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1551                                     COMP-3.
  1552         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1553                                     COMP-3.
  1554         16  FILLER                PIC X(09).
  1555***************    OUTPUT FROM ELRTRM   *************************
  1556
  1557         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1558                                     COMP-3.
  1559         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1560                                     COMP-3.
  1561         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1562                                     COMP-3.
  1563         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1564                                     COMP-3.
  1565         16  FILLER                PIC X(12).
  1566
  1567***************    OUTPUT FROM ELRAMT   *************************
  1568
  1569         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1570                                     COMP-3.
  1571         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1572                                     COMP-3.
  1573         16  FILLER                PIC X(12).
  1574
  1575***************    OUTPUT FROM ELRATE   *************************
  1576
  1577         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1578                                     COMP-3.
  1579         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1580                                     COMP-3.
  1581         16  CP-MORTALITY-CODE     PIC X(4).
  1582         16  CP-RATE-EDIT-FLAG     PIC X.
  1583             88  CP-RATES-NEED-APR                  VALUE '1'.
  1584         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1585                                     COMP-3.
  1586         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1587         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1588         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1589                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  31
* EL156.cbl
  1590         16  FILLER                PIC X(07).
  1591
  1592***************    OUTPUT FROM ELRFND   *************************
  1593
  1594         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1595                                     COMP-3.
  1596         16  CP-REFUND-TYPE-USED   PIC X.
  1597           88  CP-R-AS-R78                         VALUE '1'.
  1598           88  CP-R-AS-PRORATA                     VALUE '2'.
  1599           88  CP-R-AS-CALIF                       VALUE '3'.
  1600           88  CP-R-AS-TEXAS                       VALUE '4'.
  1601           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1602           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1603           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1604           88  CP-R-AS-MEAN                        VALUE '8'.
  1605           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1606           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1607           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1608           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1609           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1610           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1611         16  FILLER                PIC X(12).
  1612
  1613***************    OUTPUT FROM ELEARN   *************************
  1614
  1615         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1616                                     COMP-3.
  1617         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1618                                     COMP-3.
  1619         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1620                                     COMP-3.
  1621         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1622                                     COMP-3.
  1623         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1624                                     COMP-3.
  1625         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-EARNING-TYPE-USED  PIC X.
  1628           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1629           88  CP-E-AS-R78                         VALUE '1'.
  1630           88  CP-E-AS-PRORATA                     VALUE '2'.
  1631           88  CP-E-AS-TEXAS                       VALUE '4'.
  1632           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1633           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1634           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1635           88  CP-E-AS-MEAN                        VALUE '8'.
  1636           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1637         16  FILLER                PIC X(12).
  1638
  1639***************    OUTPUT FROM ELPMNT   *************************
  1640
  1641         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1642                                     COMP-3.
  1643         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1644                                     COMP-3.
  1645         16  FILLER                PIC X(12).
  1646
  1647***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  32
* EL156.cbl
  1648         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1649                                     COMP-3.
  1650         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1651                                     COMP-3.
  1652         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1653                                     COMP-3.
  1654         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1655                                     COMP-3.
  1656         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1657                                     COMP-3.
  1658         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1659                                     COMP-3.
  1660         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1661             88  OPEN-RATE-FILE                   VALUE 'O'.
  1662             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1663             88  IO-ERROR                         VALUE 'E'.
  1664
  1665         16  CP-FIRST-PAY-DATE     PIC XX.
  1666
  1667         16  CP-JOINT-INDICATOR    PIC X.
  1668
  1669         16  CP-RESERVE-REMAINING-TERM
  1670                                   PIC S9(4)V9    VALUE ZERO
  1671                                     COMP-3.
  1672
  1673         16  CP-INSURED-BIRTH-DT   PIC XX.
  1674
  1675         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1676                                     COMP-3.
  1677
  1678         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1679                                     COMP-3.
  1680
  1681         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1682                                     COMP-3.
  1683
  1684         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1685                                     COMP-3.
  1686
  1687         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1688                                     COMP-3.
  1689
  1690         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1691                                     COMP-3.
  1692
  1693         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1694                                     COMP-3.
  1695
  1696         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1697             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1698
  1699         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1700                                     COMP-3.
  1701         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1702                                     COMP-3.
  1703         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1704         16  FILLER                PIC X(15).
  1705******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  33
* EL156.cbl
  1706*    COPY ELCICALC.
  1707******************************************************************
  1708*                                                                *
  1709*                           ELCCICALC.                           *
  1710*                            VMOD=2.001                          *
  1711*                                                                *
  1712*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1713*                 CALCULATION MODULE                             *
  1714*                                                                *
  1715*  PASSED TO ELCLMI                                              *
  1716*  -----------------                                             *
  1717*  STATE                                                         *
  1718*  PRODUCT                                                       *
  1719*  COVERAGE                                                      *
  1720*  EFFECTIVE DATE                                                *
  1721*  INCURRED DATE                                                 *
  1722*  ESTABLISHED DATE                                              *
  1723*  LAST PAID DATE                                                *
  1724*  REPORTED DATE                                                 *
  1725*  CLAIM PAYMENT AMOUNT                                          *
  1726*                                                                *
  1727*  RETURNED FROM ELRTRM                                          *
  1728*  ---------------------                                         *
  1729*  RETURN CODE                                                   *
  1730*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1731*  CLAIM INTEREST AMOUNT                                         *
  1732*----------------------------------------------------------------*
  1733*----------------------------------------------------------------*
  1734*                 LENGTH = 100                                   *
  1735*                                                                *
  1736******************************************************************
  1737******************************************************************
  1738*                   C H A N G E   L O G
  1739*
  1740* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1741*-----------------------------------------------------------------
  1742*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1743* EFFECTIVE    NUMBER
  1744*-----------------------------------------------------------------
  1745* 120905    2004040700004  PEMA  NEW COPYBOOK
  1746* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1747******************************************************************
  1748
  1749 01  CLAIM-INT-PASS-AREA.
  1750     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1751                                     COMP.
  1752
  1753     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1754       88  NO-CI-ERROR                             VALUE ZERO.
  1755       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1756       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1757       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1758       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1759       88  CP-AMT-LT-5000                          VALUE '4'.
  1760       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1761       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1762       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1763       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  34
* EL156.cbl
  1764***********************  INPUT AREAS ****************************
  1765
  1766     12  CP-CALCULATION-AREA.
  1767         16  CP-COMPANY-CD         PIC X.
  1768         16  CP-STATE              PIC XX.
  1769         16  CP-PRODUCT            PIC XX.
  1770         16  CP-COVERAGE           PIC XX.
  1771         16  CP-INC-DT             PIC XX.
  1772         16  CP-EST-DT             PIC XX.
  1773         16  CP-LSTPD-DT           PIC XX.
  1774         16  CP-RPT-DT             PIC XX.
  1775         16  CP-PRF-DT             PIC XX.
  1776         16  CP-EFF-DT             PIC XX.
  1777         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1778         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1779         16  FILLER                PIC X(37).
  1780
  1781***************    OUTPUT FROM ELCLMI   ************************
  1782
  1783         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1784
  1785         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1786         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1787         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1788         16  FILLER                PIC X(19).
  1789******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  35
* EL156.cbl
  1791*    COPY ELCATTR.
  1792******************************************************************
  1793*                                                                *
  1794*                            ELCATTR.                            *
  1795*                            VMOD=2.001                          *
  1796*                                                                *
  1797*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1798*                                                                *
  1799*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1800*                                                                *
  1801*                   POS 1   P=PROTECTED                          *
  1802*                           U=UNPROTECTED                        *
  1803*                           S=ASKIP                              *
  1804*                   POS 2   A=ALPHA/NUMERIC                      *
  1805*                           N=NUMERIC                            *
  1806*                   POS 3   N=NORMAL                             *
  1807*                           B=BRIGHT                             *
  1808*                           D=DARK                               *
  1809*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1810*                           OF=MODIFIED DATA TAG OFF             *
  1811*                                                                *
  1812*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1813******************************************************************
  1814 01  ATTRIBUTE-LIST.
  1815     12  AL-PABOF            PIC X       VALUE 'Y'.
  1816     12  AL-PABON            PIC X       VALUE 'Z'.
  1817     12  AL-PADOF            PIC X       VALUE '%'.
  1818     12  AL-PADON            PIC X       VALUE '_'.
  1819     12  AL-PANOF            PIC X       VALUE '-'.
  1820     12  AL-PANON            PIC X       VALUE '/'.
  1821     12  AL-SABOF            PIC X       VALUE '8'.
  1822     12  AL-SABON            PIC X       VALUE '9'.
  1823     12  AL-SADOF            PIC X       VALUE '@'.
  1824     12  AL-SADON            PIC X       VALUE QUOTE.
  1825     12  AL-SANOF            PIC X       VALUE '0'.
  1826     12  AL-SANON            PIC X       VALUE '1'.
  1827     12  AL-UABOF            PIC X       VALUE 'H'.
  1828     12  AL-UABON            PIC X       VALUE 'I'.
  1829     12  AL-UADOF            PIC X       VALUE '<'.
  1830     12  AL-UADON            PIC X       VALUE '('.
  1831     12  AL-UANOF            PIC X       VALUE ' '.
  1832     12  AL-UANON            PIC X       VALUE 'A'.
  1833     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1834     12  AL-UNBON            PIC X       VALUE 'R'.
  1835     12  AL-UNDOF            PIC X       VALUE '*'.
  1836     12  AL-UNDON            PIC X       VALUE ')'.
  1837     12  AL-UNNOF            PIC X       VALUE '&'.
  1838     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  36
* EL156.cbl
  1840*    COPY ELCEMIB.
  1841******************************************************************
  1842*                                                                *
  1843*                                                                *
  1844*                            ELCEMIB.                            *
  1845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1846*                            VMOD=2.005                          *
  1847*                                                                *
  1848*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1849*                                                                *
  1850******************************************************************
  1851 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1852     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1853     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1854     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1855     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1856     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1857     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1858     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1859     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1860     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1861         88  EMI-NO-ERRORS                    VALUE '1'.
  1862         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1863         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1864     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1865         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1866     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1867         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1868         88  EMI-AREA1-FULL                   VALUE '2'.
  1869     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1870         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1871         88  EMI-AREA2-FULL                   VALUE '2'.
  1872     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1873         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1874         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1875         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1876         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1877         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1878     12  EMI-ERROR-LINES.
  1879         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1880         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1881         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1882         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1883             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1884                 24  EMI-ERR-NUM         PIC X(4).
  1885                 24  EMI-FILLER          PIC X.
  1886                 24  EMI-SEV             PIC X.
  1887                 24  FILLER              PIC X.
  1888             20  FILLER                  PIC X(02).
  1889     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1890         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1891             20  EMI-ERROR-NUMBER    PIC X(4).
  1892             20  EMI-FILL            PIC X.
  1893             20  EMI-SEVERITY        PIC X.
  1894             20  FILLER              PIC X.
  1895             20  EMI-ERROR-TEXT.
  1896                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1897                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  37
* EL156.cbl
  1898     12  EMI-SEVERITY-SAVE           PIC X.
  1899         88  EMI-NOTE                    VALUE 'N'.
  1900         88  EMI-WARNING                 VALUE 'W'.
  1901         88  EMI-FORCABLE                VALUE 'F'.
  1902         88  EMI-FATAL                   VALUE 'X'.
  1903     12  EMI-MESSAGE-FLAG            PIC X.
  1904         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1905         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1906     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1907     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1908         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1909         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1910         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1911     12  emi-claim-no                pic x(7).
  1912     12  emi-claim-type              pic x(6).
  1913     12  FILLER                      PIC X(124)  VALUE SPACES.
  1914     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1915     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1916     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1917     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  38
* EL156.cbl
  1919*    COPY ELCLNKLT.
  1920******************************************************************
  1921*                                                                *
  1922*                                                                *
  1923*                           ELCLNKLT                             *
  1924*                            VMOD=2.003                          *
  1925*                                                                *
  1926*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1927*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1928*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1929*                                                                *
  1930*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1931*   COMPLETING THE REQUIRED FIELDS.                              *
  1932*                                                                *
  1933*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1934*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1935*                              9999 INDICATES AN UNKNOWN ABEND   *
  1936*                                   WAS DETECTED.                *
  1937*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1938*                              CODES FOUND IN THE ERROR FILE.    *
  1939******************************************************************
  1940 01  W-1523-LINKDATA.
  1941     12  W-1523-COMMON-PI-DATA.
  1942         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1943         16  FILLER              PIC  X(67).
  1944         16  W-1523-COMPANY-CD   PIC  X(01).
  1945         16  FILLER              PIC  X(10).
  1946         16  W-1523-CONTROL-IN-PROGRESS.
  1947             20  W-1523-CARRIER  PIC  X(01).
  1948             20  W-1523-GROUPING PIC  X(06).
  1949             20  W-1523-STATE    PIC  X(02).
  1950             20  W-1523-ACCOUNT  PIC  X(10).
  1951             20  W-1523-CLAIM-CERT-GRP.
  1952                 24  W-1523-CLAIM-NO
  1953                                 PIC  X(07).
  1954                 24  W-1523-CERT-NO.
  1955                     28  W-1523-CERT-PRIME
  1956                                 PIC  X(10).
  1957                     28  W-1523-CERT-SFX
  1958                                 PIC  X(01).
  1959                 24  W-1523-CERT-EFF-DT
  1960                                 PIC  X(02).
  1961         16  FILLER              PIC X(265).
  1962
  1963     12  W-1523-WORK-AREA.
  1964         16  W-1523-FORM-NUMBER  PIC  X(04).
  1965         16  W-1523-NUMBER-COPIES
  1966                                 PIC  9(01).
  1967         16  W-1523-ADDR-TYPE    PIC  X(02).
  1968         16  W-1523-FOLLOW-UP-DATE
  1969                                 PIC  X(02).
  1970         16  W-1523-RESEND-DATE  PIC  X(02).
  1971         16  W-1523-ERROR-CODE   PIC  9(04).
  1972             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1973             88  W-1523-FATAL-ERROR
  1974                                    VALUES  0006 0013 0042
  1975                                            0154 0168 0169
  1976                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  39
* EL156.cbl
  1977                                            0179 0186 0281
  1978                                            0332 2055 3697
  1979                                            3698 3699 3770
  1980                                            3771 3772 7675
  1981                                            9106 9808 9883
  1982                                            9887.
  1983             88  W-1523-STOP-ERRORS
  1984                                    VALUES  0013 0042 0154
  1985                                            0168 0169 0172
  1986                                            0281 0332 2055
  1987                                            3698 3699 7675
  1988                                            9106 9808 9883
  1989                                            9999.
  1990         16  W-1523-REASON       PIC  X(70).
  1991         16  W-1523-ARCHIVE-NUMBER
  1992                                 PIC  9(08).
  1993     12  W-1523-POINTER-AREA.
  1994         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  1995         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  1996         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  1997         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  1998         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  40
* EL156.cbl
  2000*    COPY ELCNWA.
  2001*****************************************************************
  2002*                                                               *
  2003*                                                               *
  2004*                            ELCNWA.                            *
  2005*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2006*                            VMOD=2.003                         *
  2007*                                                               *
  2008*            M O V E   N A M E   W O R K   A R E A.             *
  2009*                                                               *
  2010*****************************************************************.
  2011
  2012 01  WS-NAME-WORK-AREA.
  2013     05  WS-INSURED-LAST-NAME        PIC X(15).
  2014     05  WS-INSURED-1ST-NAME         PIC X(12).
  2015     05  WS-INSURED-MID-INIT         PIC X.
  2016
  2017     05  WS-NAME-WORK.
  2018         10  WS-NW                   PIC X
  2019             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2020
  2021     05  WS-NAME-WORK2.
  2022         10  WS-NW2                  PIC X
  2023             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2024                                        NWA-INDEX0.
  2025
  2026     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2027                                     COMP-3.
  2028
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  41
* EL156.cbl
  2030*    COPY ELCDMO.
  2031******************************************************************
  2032*                                                                *
  2033*                                                                *
  2034*                            ELCDMO.                             *
  2035*                            VMOD=2.004                          *
  2036*                                                                *
  2037*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2038*        COMMUNICATION AREA                                      *
  2039*   FILE TYPE = NA                                               *
  2040*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2041*                                                                *
  2042******************************************************************
  2043 01  DMO-COMMUNICATION-AREA.
  2044     12  DM-RECORD-TYPE                  PIC  X(02).
  2045             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2046             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2047             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2048     12  DM-DIST-CODE                    PIC  X(04).
  2049     12  DM-MAIL-CODE                    PIC  X(05).
  2050     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2051     12  DM-INSURED-NAME                 PIC  X(30).
  2052     12  DM-CLAIM-NO                     PIC  X(07).
  2053     12  DM-CLAIM-TYPE                   PIC  X.
  2054
  2055     12  DM-STATUS-DATA-AREA.
  2056         16  DM-CLAIM-STATUS             PIC  X.
  2057             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2058             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2059             88  DM-CLOSED                        VALUE '3'.
  2060             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2061             88  DM-DEFAULT                       VALUE '9'.
  2062         16  DM-STATUS-DATE              PIC  X(08).
  2063******YYYYMMDD
  2064         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2065             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2066             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2067             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2068             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2069             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2070             88  DM-RE-OPENED                     VALUE 'R'.
  2071             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2072             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2073             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2074         16  DM-STAT-CARRIER             PIC X.
  2075
  2076     12  DM-DRAFT-DATA-AREA.
  2077         16  DM-PAYMENT-TYPE             PIC  X.
  2078             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2079         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2080         16  DM-PAYMENT-DATE             PIC  X(08).
  2081******YYYYMMDD
  2082         16  DM-CERT-NO                  PIC  X(11).
  2083         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2084         16  DM-CARRIER                  PIC  X.
  2085
  2086     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  42
* EL156.cbl
  2088*    COPY ELCDMDCD.
  2089******************************************************************
  2090*                                                                *
  2091*                                                                *
  2092*                            ELCDMDCD.                           *
  2093*                            VMOD=2.001                          *
  2094*                                                                *
  2095*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2096*       COMMUNICATIONS AREA                                      *
  2097*                                                                *
  2098******************************************************************
  2099 01  CD-COMMUNICATION-AREA.
  2100     12  CD-SYSTEM-ID            PIC  X(02).
  2101         88 CD-CLAIMS                      VALUE 'CL'.
  2102         88 CD-CREDIT                      VALUE 'CR'.
  2103     12  CD-RECORD-TYPE          PIC  X(02).
  2104         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2105         88 CD-EOB-CODE                    VALUE 'EO'.
  2106         88 CD-ICD9-CODE                   VALUE 'I9'.
  2107         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2108         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2109         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2110         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2111         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2112     12  CD-RECORD-KEY           PIC  X(06).
  2113         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2114     12  CD-RETURN-CODE          PIC  X(02).
  2115     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2116     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2117     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2118     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  43
* EL156.cbl
  2120*    COPY ELCDCTB.
  2121******************************************************************
  2122*                                                                *
  2123*                                                                *
  2124*                            ELCDCTB.                            *
  2125*                            VMOD=2.002                          *
  2126*                                                                *
  2127*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2128*       COMMUNICATIONS AREA                                      *
  2129*                                                                *
  2130******************************************************************
  2131 01  DCT-COMMUNICATION-AREA.
  2132     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2133     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2134     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2135     12  DCT-PRODUCT-CODE         PIC  X(02).
  2136     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2137     12  DCT-RETURN-CODE          PIC  X(02).
  2138     12  DCT-MAIL-CODE            PIC  X(05).
  2139     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2140     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  44
* EL156.cbl
  2142 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2143 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2144 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2145 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  45
* EL156.cbl
  2147*    COPY ELCINTF.
  2148******************************************************************
  2149*                                                                *
  2150*                                                                *
  2151*                            ELCINTF.                            *
  2152*                            VMOD=2.017                          *
  2153*                                                                *
  2154*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2155*                                                                *
  2156*       LENGTH = 1024                                            *
  2157*                                                                *
  2158******************************************************************
  2159*                   C H A N G E   L O G
  2160*
  2161* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2162*-----------------------------------------------------------------
  2163*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2164* EFFECTIVE    NUMBER
  2165*-----------------------------------------------------------------
  2166* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2167******************************************************************
  2168 01  PROGRAM-INTERFACE-BLOCK.
  2169     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2170     12  PI-CALLING-PROGRAM              PIC X(8).
  2171     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2172     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2173     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2174     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2175     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2176     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2177     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2178     12  PI-COMPANY-ID                   PIC XXX.
  2179     12  PI-COMPANY-CD                   PIC X.
  2180
  2181     12  PI-COMPANY-PASSWORD             PIC X(8).
  2182
  2183     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2184
  2185     12  PI-CONTROL-IN-PROGRESS.
  2186         16  PI-CARRIER                  PIC X.
  2187         16  PI-GROUPING                 PIC X(6).
  2188         16  PI-STATE                    PIC XX.
  2189         16  PI-ACCOUNT                  PIC X(10).
  2190         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2191                                         PIC X(10).
  2192         16  PI-CLAIM-CERT-GRP.
  2193             20  PI-CLAIM-NO             PIC X(7).
  2194             20  PI-CERT-NO.
  2195                 25  PI-CERT-PRIME       PIC X(10).
  2196                 25  PI-CERT-SFX         PIC X.
  2197             20  PI-CERT-EFF-DT          PIC XX.
  2198         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2199             20  PI-PLAN-CODE            PIC X(2).
  2200             20  PI-REVISION-NUMBER      PIC X(3).
  2201             20  PI-PLAN-EFF-DT          PIC X(2).
  2202             20  PI-PLAN-EXP-DT          PIC X(2).
  2203             20  FILLER                  PIC X(11).
  2204         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  46
* EL156.cbl
  2205             20  PI-OE-REFERENCE-1.
  2206                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2207                 25  PI-OE-REF-1-SUFF    PIC XX.
  2208
  2209     12  PI-SESSION-IN-PROGRESS          PIC X.
  2210         88  CLAIM-SESSION                   VALUE '1'.
  2211         88  CREDIT-SESSION                  VALUE '2'.
  2212         88  WARRANTY-SESSION                VALUE '3'.
  2213         88  MORTGAGE-SESSION                VALUE '4'.
  2214         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2215
  2216
  2217*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2218
  2219     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2220     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2221
  2222     12  PI-CREDIT-USER                  PIC X.
  2223         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2224         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2225
  2226     12  PI-CLAIM-USER                   PIC X.
  2227         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2228         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2229
  2230     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2231         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2232         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2233         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2234         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2235         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2236
  2237     12  PI-PROCESSOR-ID                 PIC X(4).
  2238
  2239     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2240
  2241     12  PI-MEMBER-CAPTION               PIC X(10).
  2242
  2243     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2244         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2245
  2246     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2247     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2248     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2249     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2250
  2251     12  PI-AH-OVERRIDE-L1               PIC X.
  2252     12  PI-AH-OVERRIDE-L2               PIC XX.
  2253     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2254     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2255
  2256     12  PI-NEW-SYSTEM                   PIC X(2).
  2257
  2258     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2259     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2260         88  PI-USES-PAID-TO                 VALUE '1'.
  2261     12  PI-CRDTCRD-SYSTEM.
  2262         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  47
* EL156.cbl
  2263             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2264             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2265         16  PI-CC-MONTH-END-DT          PIC XX.
  2266     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2267
  2268     12  PI-OE-REFERENCE-2.
  2269         16  PI-OE-REF-2-PRIME           PIC X(10).
  2270         16  PI-OE-REF-2-SUFF            PIC X.
  2271
  2272     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2273
  2274     12  PI-LANGUAGE-TYPE                PIC X.
  2275             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2276             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2277             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2278
  2279     12  PI-POLICY-LINKAGE-IND           PIC X.
  2280         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2281         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2282                                                   LOW-VALUES.
  2283
  2284     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2285     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2286         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2287         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2288
  2289     12  PI-PROCESSOR-CSR-IND            PIC X.
  2290         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2291         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2292
  2293     12  FILLER                          PIC X(3).
  2294
  2295     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2296
  2297     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2298         PI-SYSTEM-LEVEL.
  2299
  2300         16  PI-ENTRY-CODES.
  2301             20  PI-ENTRY-CD-1           PIC X.
  2302             20  PI-ENTRY-CD-2           PIC X.
  2303
  2304         16  PI-RETURN-CODES.
  2305             20  PI-RETURN-CD-1          PIC X.
  2306             20  PI-RETURN-CD-2          PIC X.
  2307
  2308         16  PI-UPDATE-STATUS-SAVE.
  2309             20  PI-UPDATE-BY            PIC X(4).
  2310             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2311
  2312         16  PI-LOWER-CASE-LETTERS       PIC X.
  2313             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2314
  2315*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2316*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2317*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2318
  2319         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2320             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  48
* EL156.cbl
  2321             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2322             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2323             88  ACCNT-CNTL                  VALUE '3'.
  2324             88  CARR-ACCNT-CNTL             VALUE '4'.
  2325
  2326         16  PI-PROCESSOR-CAP-LIST.
  2327             20  PI-SYSTEM-CONTROLS.
  2328                24 PI-SYSTEM-DISPLAY     PIC X.
  2329                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2330                24 PI-SYSTEM-MODIFY      PIC X.
  2331                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2332             20  FILLER                  PIC XX.
  2333             20  PI-DISPLAY-CAP          PIC X.
  2334                 88  DISPLAY-CAP             VALUE 'Y'.
  2335             20  PI-MODIFY-CAP           PIC X.
  2336                 88  MODIFY-CAP              VALUE 'Y'.
  2337             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2338                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2339             20  PI-FORCE-CAP            PIC X.
  2340                 88  FORCE-CAP               VALUE 'Y'.
  2341
  2342         16  PI-PROGRAM-CONTROLS.
  2343             20  PI-PGM-PRINT-OPT        PIC X.
  2344             20  PI-PGM-FORMAT-OPT       PIC X.
  2345             20  PI-PGM-PROCESS-OPT      PIC X.
  2346             20  PI-PGM-TOTALS-OPT       PIC X.
  2347
  2348         16  PI-HELP-INTERFACE.
  2349             20  PI-LAST-ERROR-NO        PIC X(4).
  2350             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2351
  2352         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2353             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2354
  2355         16  PI-CR-CONTROL-IN-PROGRESS.
  2356             20  PI-CR-CARRIER           PIC X.
  2357             20  PI-CR-GROUPING          PIC X(6).
  2358             20  PI-CR-STATE             PIC XX.
  2359             20  PI-CR-ACCOUNT           PIC X(10).
  2360             20  PI-CR-FIN-RESP          PIC X(10).
  2361             20  PI-CR-TYPE              PIC X.
  2362
  2363         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2364
  2365         16  PI-CR-MONTH-END-DT          PIC XX.
  2366
  2367         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2368             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2369             88  PI-ZERO-CARRIER             VALUE '1'.
  2370             88  PI-ZERO-GROUPING            VALUE '2'.
  2371             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2372
  2373         16  PI-CARRIER-SECURITY         PIC X.
  2374             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2375
  2376         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2377             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2378             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  49
* EL156.cbl
  2379
  2380         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2381             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2382                                         INDEXED BY PI-ACCESS-NDX
  2383                                         PIC X.
  2384
  2385         16  PI-GA-BILLING-CONTROL       PIC X.
  2386             88  PI-GA-BILLING               VALUE '1'.
  2387
  2388         16  PI-MAIL-PROCESSING          PIC X.
  2389             88  PI-MAIL-YES                 VALUE 'Y'.
  2390
  2391         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2392
  2393         16  PI-AR-SYSTEM.
  2394             20  PI-AR-PROCESSING-CNTL   PIC X.
  2395                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2396             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2397             20  PI-AR-MONTH-END-DT      PIC XX.
  2398
  2399         16  PI-MP-SYSTEM.
  2400             20  PI-MORTGAGE-USER            PIC X.
  2401                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2402                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2403             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2404                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2405                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2406                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2407                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2408                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2409             20  PI-MP-MONTH-END-DT          PIC XX.
  2410             20  PI-MP-REFERENCE-NO.
  2411                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2412                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2413
  2414         16  PI-LABEL-CONTROL            PIC X(01).
  2415             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2416             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2417
  2418         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2419             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2420
  2421         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2422             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2423             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2424
  2425         16  FILLER                      PIC X(14).
  2426
  2427     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2428******************************************************************
  2429     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2430         16  PI-SAVE-FORM        PIC X(12).
  2431         16  PI-ACCT-KEY         PIC X(26).
  2432         16  PI-PAYEE-NAME       PIC X(30).
  2433         16  PI-DAILY-RATE       PIC S9(3)V99.
  2434         16  PI-MONTH-END-SAVE   PIC XX.
  2435         16  PI-BENEFIT-SAVE.
  2436             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  50
* EL156.cbl
  2437             20  PI-BEN-TYPE     PIC X.
  2438         16  PI-MANUAL-SW        PIC 9.
  2439         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2440         16  PI-PASS-SW          PIC X.
  2441         16  PI-PFKEY-USED       PIC X.
  2442         16  PI-CK-ASSIGN        PIC X.
  2443         16  PI-FATAL-COUNT      PIC 99.
  2444         16  PI-FORCE-COUNT      PIC 99.
  2445         16  PI-SAVE-INPUT.
  2446             20  PI-PMTTYPE      PIC X.
  2447             20  PI-PAYEE.
  2448                 24  PI-PAYEE-TYPE PIC X.
  2449                 24  PI-PAYEE-SEQ  PIC X.
  2450                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2451                   PI-PAYEE-SEQ    PIC S9.
  2452             20  PI-PMTNOTE1     PIC X(60).
  2453             20  PI-PMTNOTE2     PIC X(60).
  2454             20  PI-OFFLINE      PIC X.
  2455             20  PI-ECHECKNO     PIC X(7).
  2456             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2457                 28  PI-ECHECKNO-N     PIC X.
  2458                 28  PI-ECHECKNO-6     PIC X(6).
  2459             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2460                 24  PI-ECHECKNO-CR    PIC XX.
  2461                 24  PI-ECHECKNO-5     PIC X(5).
  2462             20  PI-HOLDTIL      PIC 9(6).
  2463             20  PI-EPYFROM      PIC 9(6).
  2464             20  PI-EPYTHRU      PIC 9(6).
  2465             20  PI-EDAYS        PIC S9(5).
  2466             20  PI-EPYAMT       PIC S9(7)V99.
  2467             20  PI-ERESV        PIC S9(7)V99.
  2468             20  PI-EEXPENS      PIC 9(6)V99.
  2469             20  PI-ETYPE        PIC X.
  2470             20  PI-CASH         PIC X.
  2471             20  PI-GROUPED      PIC X.
  2472             20  PI-INT-RATE     PIC S99V9(5).
  2473             20  PI-AIGFROM      PIC 9(6).
  2474             20  PI-LOAN-NO      PIC X(20).
  2475             20  PI-PROOF-DATE   PIC 9(6).
  2476             20  PI-PRINT-EOB-YN PIC X.
  2477             20  PI-PRINT-CLM-FRM-YN PIC X.
  2478             20  PI-PRINT-SURVEY-YN PIC X.
  2479             20  PI-SPECIAL-RELEASE-YN PIC X.
  2480         16  PI-SAVE-COMPUTED.
  2481             20  PI-CCHECKNO     PIC X(7).
  2482             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2483                 28  PI-CCHECKNO-N     PIC X.
  2484                 28  PI-CCHECKNO-6     PIC X(6).
  2485             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2486                 24  PI-CCHECKNO-CR    PIC XX.
  2487                 24  PI-CCHECKNO-5     PIC X(5).
  2488             20  PI-CPYFROM      PIC XX.
  2489             20  PI-CPYTHRU      PIC XX.
  2490             20  PI-CDAYS        PIC S9(5).
  2491             20  PI-CPYAMT       PIC S9(7)V99.
  2492             20  PI-CRESV        PIC 9(6)V99.
  2493             20  PI-CEXPENS      PIC 9(6)V99.
  2494             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  51
* EL156.cbl
  2495                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2496                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2497                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2498         16  PI-PREV-CLMNO       PIC X(7).
  2499         16  PI-LF-COVERAGE-TYPE PIC X.
  2500         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2501         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2502         16  PI-PROVISIONAL-IND  PIC X.
  2503             88 PI-PROV-PMT      VALUE 'P'.
  2504         16  PI-PREV-TRLR-KEY    PIC X(22).
  2505         16  PI-SPLIT-PMT-SW     PIC X.
  2506         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2507         16  PI-ACTIVITY-CODE    PIC 99.
  2508         16  PI-RESET-SW         PIC X.
  2509         16  PI-SPECIAL-BEN-SW   PIC X.
  2510             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2511         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2512         16  PI-EXP-DT           PIC XX.
  2513         16  PI-LOAN-DUE-DAY     PIC 99.
  2514         16  PI-3RD-PARTY-SW     PIC X.
  2515         16  PI-LOAN-UPDATE-SW   PIC X.
  2516
  2517         16  PI-DMD-DATA.
  2518             20  PI-SV-CERT-KEY       PIC X(21).
  2519             20  PI-SV-CERT-NO        PIC X(11).
  2520             20  PI-SV-BEN            PIC X(10).
  2521             20  PI-SV-CCN            PIC X(16).
  2522             20  PI-INTEREST-PAID-IND PIC X.
  2523                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2524             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2525             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2526             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2527             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2528         16  PI-AT-EOB-CODES.
  2529             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2530         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2531         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2532         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2533         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2534         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2535         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2536         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2537         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2538         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2539         16  PI-LF-BENEFIT-CD         PIC X(2).
  2540         16  PI-EOB-CODES-EXIST PIC X.
  2541         16  PI-SET-NOTE2-MDT   PIC X.
  2542         16  PI-VFY-2ND-BENE          PIC X.
  2543         16  PI-CLM-TYPE              PIC X.
  2544         16  PI-APPROVAL-LEVEL        PIC X.
  2545         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2546         16  PI-REAUDIT-NEEDED        PIC X.
  2547         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2548         16  PI-AH-BENEFIT-CD         PIC XX.
  2549         16  pi-ah-term               pic s999 comp-3.
  2550         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2551         16  pi-max-ext               pic 999.
  2552         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  52
* EL156.cbl
  2553         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2554         16  PI-JOINT-COV-IND         PIC X.
  2555             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2556             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2557         16  PI-JOINT-INSURED-IND     PIC X.
  2558             88  PI-JOINT-INSURED        VALUE 'Y'.
  2559             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2560*00781          16  FILLER                   PIC X(176).
  2561*052506         16  FILLER                   PIC X(161).
  2562*031808         16  FILLER                   PIC X(154).
  2563*091808         16  FILLER                   PIC X(152).
  2564*041710         16  FILLER                   PIC X(94).
  2565         16  FILLER                   PIC X(67).
  2566
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  53
* EL156.cbl
  2568*    COPY ELCJPFX.
  2569******************************************************************
  2570*                                                                *
  2571*                                                                *
  2572*                            ELCJPFX.                            *
  2573*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2574*                            VMOD=2.002                          *
  2575*                                                                *
  2576*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2577*                                                                *
  2578*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2579*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2580*        ELCNTL - CONTROL FILE                                   *
  2581*        ELMSTR - CLAIM MASTERS                                  *
  2582*        ELTRLR - ACTIVITY TRAILERS                              *
  2583*        ELCHKQ - CHECK QUE                                      *
  2584******************************************************************
  2585 01  JOURNAL-RECORD.
  2586     12  jp-date                     pic s9(5) comp-3.
  2587     12  jp-time                     pic s9(7) comp-3.
  2588     12  JP-USER-ID                  PIC X(4).
  2589     12  JP-FILE-ID                  PIC X(8).
  2590     12  JP-PROGRAM-ID               PIC X(8).
  2591     12  JP-RECORD-TYPE              PIC X.
  2592         88 JP-ADD              VALUE 'A'.
  2593         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2594         88 JP-AFTER-CHANGE     VALUE 'C'.
  2595         88 JP-DELETE           VALUE 'D'.
  2596         88 JP-GENERIC-DELETE   VALUE 'G'.
  2597         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2598         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2599     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2600     12  JP-RECORD-AREA
  2601
  2602
  2603                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  54
* EL156.cbl
  2605*    COPY ELCAID.
  2606******************************************************************
  2607*                                                                *
  2608*                            ELCAID.                             *
  2609*                            VMOD=2.001                          *
  2610*                                                                *
  2611*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2612*                                                                *
  2613*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2614*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2615******************************************************************
  2616
  2617 01  DFHAID.
  2618   02  DFHNULL   PIC  X  VALUE  ' '.
  2619   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2620   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2621   02  DFHPEN    PIC  X  VALUE  '='.
  2622   02  DFHOPID   PIC  X  VALUE  'W'.
  2623   02  DFHPA1    PIC  X  VALUE  '%'.
  2624   02  DFHPA2    PIC  X  VALUE  '>'.
  2625   02  DFHPA3    PIC  X  VALUE  ','.
  2626   02  DFHPF1    PIC  X  VALUE  '1'.
  2627   02  DFHPF2    PIC  X  VALUE  '2'.
  2628   02  DFHPF3    PIC  X  VALUE  '3'.
  2629   02  DFHPF4    PIC  X  VALUE  '4'.
  2630   02  DFHPF5    PIC  X  VALUE  '5'.
  2631   02  DFHPF6    PIC  X  VALUE  '6'.
  2632   02  DFHPF7    PIC  X  VALUE  '7'.
  2633   02  DFHPF8    PIC  X  VALUE  '8'.
  2634   02  DFHPF9    PIC  X  VALUE  '9'.
  2635   02  DFHPF10   PIC  X  VALUE  ':'.
  2636   02  DFHPF11   PIC  X  VALUE  '#'.
  2637   02  DFHPF12   PIC  X  VALUE  '@'.
  2638   02  DFHPF13   PIC  X  VALUE  'A'.
  2639   02  DFHPF14   PIC  X  VALUE  'B'.
  2640   02  DFHPF15   PIC  X  VALUE  'C'.
  2641   02  DFHPF16   PIC  X  VALUE  'D'.
  2642   02  DFHPF17   PIC  X  VALUE  'E'.
  2643   02  DFHPF18   PIC  X  VALUE  'F'.
  2644   02  DFHPF19   PIC  X  VALUE  'G'.
  2645   02  DFHPF20   PIC  X  VALUE  'H'.
  2646   02  DFHPF21   PIC  X  VALUE  'I'.
  2647*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2648   02  DFHPF22   PIC  X  VALUE  '['.
  2649   02  DFHPF23   PIC  X  VALUE  '.'.
  2650   02  DFHPF24   PIC  X  VALUE  '<'.
  2651   02  DFHMSRE   PIC  X  VALUE  'X'.
  2652   02  DFHSTRF   PIC  X  VALUE  'h'.
  2653   02  DFHTRIG   PIC  X  VALUE  '"'.
  2654 01  FILLER    REDEFINES DFHAID.
  2655     12  FILLER              PIC X(8).
  2656     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  55
* EL156.cbl
  2658*    COPY EL156S.
  2659 01  EL156AI.
  2660     05  FILLER            PIC  X(0012).
  2661*    -------------------------------
  2662     05  RUNDTEAL PIC S9(0004) COMP.
  2663     05  RUNDTEAF PIC  X(0001).
  2664     05  FILLER REDEFINES RUNDTEAF.
  2665         10  RUNDTEAA PIC  X(0001).
  2666     05  RUNDTEAI PIC  X(0008).
  2667*    -------------------------------
  2668     05  RUNTIMAL PIC S9(0004) COMP.
  2669     05  RUNTIMAF PIC  X(0001).
  2670     05  FILLER REDEFINES RUNTIMAF.
  2671         10  RUNTIMAA PIC  X(0001).
  2672     05  RUNTIMAI PIC  X(0005).
  2673*    -------------------------------
  2674     05  SEQUL PIC S9(0004) COMP.
  2675     05  SEQUF PIC  X(0001).
  2676     05  FILLER REDEFINES SEQUF.
  2677         10  SEQUA PIC  X(0001).
  2678     05  SEQUI PIC  X(0010).
  2679*    -------------------------------
  2680     05  CLMNOL PIC S9(0004) COMP.
  2681     05  CLMNOF PIC  X(0001).
  2682     05  FILLER REDEFINES CLMNOF.
  2683         10  CLMNOA PIC  X(0001).
  2684     05  CLMNOI PIC  X(0007).
  2685*    -------------------------------
  2686     05  CARRL PIC S9(0004) COMP.
  2687     05  CARRF PIC  X(0001).
  2688     05  FILLER REDEFINES CARRF.
  2689         10  CARRA PIC  X(0001).
  2690     05  CARRI PIC  X(0001).
  2691*    -------------------------------
  2692     05  CERTNOL PIC S9(0004) COMP.
  2693     05  CERTNOF PIC  X(0001).
  2694     05  FILLER REDEFINES CERTNOF.
  2695         10  CERTNOA PIC  X(0001).
  2696     05  CERTNOI PIC  X(0010).
  2697*    -------------------------------
  2698     05  SUFXL PIC S9(0004) COMP.
  2699     05  SUFXF PIC  X(0001).
  2700     05  FILLER REDEFINES SUFXF.
  2701         10  SUFXA PIC  X(0001).
  2702     05  SUFXI PIC  X(0001).
  2703*    -------------------------------
  2704     05  CLMTYPL PIC S9(0004) COMP.
  2705     05  CLMTYPF PIC  X(0001).
  2706     05  FILLER REDEFINES CLMTYPF.
  2707         10  CLMTYPA PIC  X(0001).
  2708     05  CLMTYPI PIC  X(0006).
  2709*    -------------------------------
  2710     05  CLMSTATL PIC S9(0004) COMP.
  2711     05  CLMSTATF PIC  X(0001).
  2712     05  FILLER REDEFINES CLMSTATF.
  2713         10  CLMSTATA PIC  X(0001).
  2714     05  CLMSTATI PIC  X(0006).
  2715*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  56
* EL156.cbl
  2716     05  LSTNMEL PIC S9(0004) COMP.
  2717     05  LSTNMEF PIC  X(0001).
  2718     05  FILLER REDEFINES LSTNMEF.
  2719         10  LSTNMEA PIC  X(0001).
  2720     05  LSTNMEI PIC  X(0015).
  2721*    -------------------------------
  2722     05  FSTNMEL PIC S9(0004) COMP.
  2723     05  FSTNMEF PIC  X(0001).
  2724     05  FILLER REDEFINES FSTNMEF.
  2725         10  FSTNMEA PIC  X(0001).
  2726     05  FSTNMEI PIC  X(0012).
  2727*    -------------------------------
  2728     05  MINITL PIC S9(0004) COMP.
  2729     05  MINITF PIC  X(0001).
  2730     05  FILLER REDEFINES MINITF.
  2731         10  MINITA PIC  X(0001).
  2732     05  MINITI PIC  X(0001).
  2733*    -------------------------------
  2734     05  PRIMHDGL PIC S9(0004) COMP.
  2735     05  PRIMHDGF PIC  X(0001).
  2736     05  FILLER REDEFINES PRIMHDGF.
  2737         10  PRIMHDGA PIC  X(0001).
  2738     05  PRIMHDGI PIC  X(0012).
  2739*    -------------------------------
  2740     05  PCERTNOL PIC S9(0004) COMP.
  2741     05  PCERTNOF PIC  X(0001).
  2742     05  FILLER REDEFINES PCERTNOF.
  2743         10  PCERTNOA PIC  X(0001).
  2744     05  PCERTNOI PIC  X(0010).
  2745*    -------------------------------
  2746     05  PSUFXL PIC S9(0004) COMP.
  2747     05  PSUFXF PIC  X(0001).
  2748     05  FILLER REDEFINES PSUFXF.
  2749         10  PSUFXA PIC  X(0001).
  2750     05  PSUFXI PIC  X(0001).
  2751*    -------------------------------
  2752     05  STATUSL PIC S9(0004) COMP.
  2753     05  STATUSF PIC  X(0001).
  2754     05  FILLER REDEFINES STATUSF.
  2755         10  STATUSA PIC  X(0001).
  2756     05  STATUSI PIC  X(0010).
  2757*    -------------------------------
  2758     05  LOANHL PIC S9(0004) COMP.
  2759     05  LOANHF PIC  X(0001).
  2760     05  FILLER REDEFINES LOANHF.
  2761         10  LOANHA PIC  X(0001).
  2762     05  LOANHI PIC  X(0014).
  2763*    -------------------------------
  2764     05  LOANNOL PIC S9(0004) COMP.
  2765     05  LOANNOF PIC  X(0001).
  2766     05  FILLER REDEFINES LOANNOF.
  2767         10  LOANNOA PIC  X(0001).
  2768     05  LOANNOI PIC  X(0025).
  2769*    -------------------------------
  2770     05  DUEDAYHL PIC S9(0004) COMP.
  2771     05  DUEDAYHF PIC  X(0001).
  2772     05  FILLER REDEFINES DUEDAYHF.
  2773         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  57
* EL156.cbl
  2774     05  DUEDAYHI PIC  X(0008).
  2775*    -------------------------------
  2776     05  DUEDAYL PIC S9(0004) COMP.
  2777     05  DUEDAYF PIC  X(0001).
  2778     05  FILLER REDEFINES DUEDAYF.
  2779         10  DUEDAYA PIC  X(0001).
  2780     05  DUEDAYI PIC  X(0002).
  2781*    -------------------------------
  2782     05  ZINTHL PIC S9(0004) COMP.
  2783     05  ZINTHF PIC  X(0001).
  2784     05  FILLER REDEFINES ZINTHF.
  2785         10  ZINTHA PIC  X(0001).
  2786     05  ZINTHI PIC  X(0009).
  2787*    -------------------------------
  2788     05  ZINTL PIC S9(0004) COMP.
  2789     05  ZINTF PIC  X(0001).
  2790     05  FILLER REDEFINES ZINTF.
  2791         10  ZINTA PIC  X(0001).
  2792     05  ZINTI PIC  99V99999.
  2793*    -------------------------------
  2794     05  PTHRHDGL PIC S9(0004) COMP.
  2795     05  PTHRHDGF PIC  X(0001).
  2796     05  FILLER REDEFINES PTHRHDGF.
  2797         10  PTHRHDGA PIC  X(0001).
  2798     05  PTHRHDGI PIC  X(0014).
  2799*    -------------------------------
  2800     05  PDTHRUL PIC S9(0004) COMP.
  2801     05  PDTHRUF PIC  X(0001).
  2802     05  FILLER REDEFINES PDTHRUF.
  2803         10  PDTHRUA PIC  X(0001).
  2804     05  PDTHRUI PIC  X(0008).
  2805*    -------------------------------
  2806     05  TOTPAIDL PIC S9(0004) COMP.
  2807     05  TOTPAIDF PIC  X(0001).
  2808     05  FILLER REDEFINES TOTPAIDF.
  2809         10  TOTPAIDA PIC  X(0001).
  2810     05  TOTPAIDI PIC  X(0010).
  2811*    -------------------------------
  2812     05  COVERL PIC S9(0004) COMP.
  2813     05  COVERF PIC  X(0001).
  2814     05  FILLER REDEFINES COVERF.
  2815         10  COVERA PIC  X(0001).
  2816     05  COVERI PIC  X(0010).
  2817*    -------------------------------
  2818     05  INCURL PIC S9(0004) COMP.
  2819     05  INCURF PIC  X(0001).
  2820     05  FILLER REDEFINES INCURF.
  2821         10  INCURA PIC  X(0001).
  2822     05  INCURI PIC  X(0008).
  2823*    -------------------------------
  2824     05  LSTDTEL PIC S9(0004) COMP.
  2825     05  LSTDTEF PIC  X(0001).
  2826     05  FILLER REDEFINES LSTDTEF.
  2827         10  LSTDTEA PIC  X(0001).
  2828     05  LSTDTEI PIC  X(0008).
  2829*    -------------------------------
  2830     05  CRTSTATL PIC S9(0004) COMP.
  2831     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  58
* EL156.cbl
  2832     05  FILLER REDEFINES CRTSTATF.
  2833         10  CRTSTATA PIC  X(0001).
  2834     05  CRTSTATI PIC  X(0010).
  2835*    -------------------------------
  2836     05  EFFECTL PIC S9(0004) COMP.
  2837     05  EFFECTF PIC  X(0001).
  2838     05  FILLER REDEFINES EFFECTF.
  2839         10  EFFECTA PIC  X(0001).
  2840     05  EFFECTI PIC  X(0008).
  2841*    -------------------------------
  2842     05  TERMSL PIC S9(0004) COMP.
  2843     05  TERMSF PIC  X(0001).
  2844     05  FILLER REDEFINES TERMSF.
  2845         10  TERMSA PIC  X(0001).
  2846     05  TERMSI PIC  X(0011).
  2847*    -------------------------------
  2848     05  STACCTL PIC S9(0004) COMP.
  2849     05  STACCTF PIC  X(0001).
  2850     05  FILLER REDEFINES STACCTF.
  2851         10  STACCTA PIC  X(0001).
  2852     05  STACCTI PIC  X(0013).
  2853*    -------------------------------
  2854     05  EXPDTEHL PIC S9(0004) COMP.
  2855     05  EXPDTEHF PIC  X(0001).
  2856     05  FILLER REDEFINES EXPDTEHF.
  2857         10  EXPDTEHA PIC  X(0001).
  2858     05  EXPDTEHI PIC  X(0014).
  2859*    -------------------------------
  2860     05  EXPDTEL PIC S9(0004) COMP.
  2861     05  EXPDTEF PIC  X(0001).
  2862     05  FILLER REDEFINES EXPDTEF.
  2863         10  EXPDTEA PIC  X(0001).
  2864     05  EXPDTEI PIC  X(0008).
  2865*    -------------------------------
  2866     05  BENECAPL PIC S9(0004) COMP.
  2867     05  BENECAPF PIC  X(0001).
  2868     05  FILLER REDEFINES BENECAPF.
  2869         10  BENECAPA PIC  X(0001).
  2870     05  BENECAPI PIC  X(0013).
  2871*    -------------------------------
  2872     05  BENEL PIC S9(0004) COMP.
  2873     05  BENEF PIC  X(0001).
  2874     05  FILLER REDEFINES BENEF.
  2875         10  BENEA PIC  X(0001).
  2876     05  BENEI PIC  X(0009).
  2877*    -------------------------------
  2878     05  FORMTYPL PIC S9(0004) COMP.
  2879     05  FORMTYPF PIC  X(0001).
  2880     05  FILLER REDEFINES FORMTYPF.
  2881         10  FORMTYPA PIC  X(0001).
  2882     05  FORMTYPI PIC  X(0001).
  2883*    -------------------------------
  2884     05  PMTTYPEL PIC S9(0004) COMP.
  2885     05  PMTTYPEF PIC  X(0001).
  2886     05  FILLER REDEFINES PMTTYPEF.
  2887         10  PMTTYPEA PIC  X(0001).
  2888     05  PMTTYPEI PIC  X(0001).
  2889*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  59
* EL156.cbl
  2890     05  PAYEEL PIC S9(0004) COMP.
  2891     05  PAYEEF PIC  X(0001).
  2892     05  FILLER REDEFINES PAYEEF.
  2893         10  PAYEEA PIC  X(0001).
  2894     05  PAYEEI PIC  X(0002).
  2895*    -------------------------------
  2896     05  CHECKNOL PIC S9(0004) COMP.
  2897     05  CHECKNOF PIC  X(0001).
  2898     05  FILLER REDEFINES CHECKNOF.
  2899         10  CHECKNOA PIC  X(0001).
  2900     05  CHECKNOI PIC  X(0007).
  2901*    -------------------------------
  2902     05  OFFLINEL PIC S9(0004) COMP.
  2903     05  OFFLINEF PIC  X(0001).
  2904     05  FILLER REDEFINES OFFLINEF.
  2905         10  OFFLINEA PIC  X(0001).
  2906     05  OFFLINEI PIC  X(0001).
  2907*    -------------------------------
  2908     05  HOLDTILL PIC S9(0004) COMP.
  2909     05  HOLDTILF PIC  X(0001).
  2910     05  FILLER REDEFINES HOLDTILF.
  2911         10  HOLDTILA PIC  X(0001).
  2912     05  HOLDTILI PIC  X(0008).
  2913*    -------------------------------
  2914     05  NOTE1L PIC S9(0004) COMP.
  2915     05  NOTE1F PIC  X(0001).
  2916     05  FILLER REDEFINES NOTE1F.
  2917         10  NOTE1A PIC  X(0001).
  2918     05  NOTE1I PIC  X(0060).
  2919*    -------------------------------
  2920     05  NOTE2L PIC S9(0004) COMP.
  2921     05  NOTE2F PIC  X(0001).
  2922     05  FILLER REDEFINES NOTE2F.
  2923         10  NOTE2A PIC  X(0001).
  2924     05  NOTE2I PIC  X(0060).
  2925*    -------------------------------
  2926     05  EOBYNL PIC S9(0004) COMP.
  2927     05  EOBYNF PIC  X(0001).
  2928     05  FILLER REDEFINES EOBYNF.
  2929         10  EOBYNA PIC  X(0001).
  2930     05  EOBYNI PIC  X(0001).
  2931*    -------------------------------
  2932     05  CLMFMYNL PIC S9(0004) COMP.
  2933     05  CLMFMYNF PIC  X(0001).
  2934     05  FILLER REDEFINES CLMFMYNF.
  2935         10  CLMFMYNA PIC  X(0001).
  2936     05  CLMFMYNI PIC  X(0001).
  2937*    -------------------------------
  2938     05  SURVYYNL PIC S9(0004) COMP.
  2939     05  SURVYYNF PIC  X(0001).
  2940     05  FILLER REDEFINES SURVYYNF.
  2941         10  SURVYYNA PIC  X(0001).
  2942     05  SURVYYNI PIC  X(0001).
  2943*    -------------------------------
  2944     05  SPRELYNL PIC S9(0004) COMP.
  2945     05  SPRELYNF PIC  X(0001).
  2946     05  FILLER REDEFINES SPRELYNF.
  2947         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  60
* EL156.cbl
  2948     05  SPRELYNI PIC  X(0001).
  2949*    -------------------------------
  2950     05  PINTHL PIC S9(0004) COMP.
  2951     05  PINTHF PIC  X(0001).
  2952     05  FILLER REDEFINES PINTHF.
  2953         10  PINTHA PIC  X(0001).
  2954     05  PINTHI PIC  X(0004).
  2955*    -------------------------------
  2956     05  PINTL PIC S9(0004) COMP.
  2957     05  PINTF PIC  X(0001).
  2958     05  FILLER REDEFINES PINTF.
  2959         10  PINTA PIC  X(0001).
  2960     05  PINTI PIC  X(0008).
  2961*    -------------------------------
  2962     05  PROOFDTL PIC S9(0004) COMP.
  2963     05  PROOFDTF PIC  X(0001).
  2964     05  FILLER REDEFINES PROOFDTF.
  2965         10  PROOFDTA PIC  X(0001).
  2966     05  PROOFDTI PIC  X(0008).
  2967*    -------------------------------
  2968     05  AIGFRMHL PIC S9(0004) COMP.
  2969     05  AIGFRMHF PIC  X(0001).
  2970     05  FILLER REDEFINES AIGFRMHF.
  2971         10  AIGFRMHA PIC  X(0001).
  2972     05  AIGFRMHI PIC  X(0012).
  2973*    -------------------------------
  2974     05  AIGFROML PIC S9(0004) COMP.
  2975     05  AIGFROMF PIC  X(0001).
  2976     05  FILLER REDEFINES AIGFROMF.
  2977         10  AIGFROMA PIC  X(0001).
  2978     05  AIGFROMI PIC  X(0008).
  2979*    -------------------------------
  2980     05  PMTHDGAL PIC S9(0004) COMP.
  2981     05  PMTHDGAF PIC  X(0001).
  2982     05  FILLER REDEFINES PMTHDGAF.
  2983         10  PMTHDGAA PIC  X(0001).
  2984     05  PMTHDGAI PIC  X(0066).
  2985*    -------------------------------
  2986     05  EPYFROML PIC S9(0004) COMP.
  2987     05  EPYFROMF PIC  X(0001).
  2988     05  FILLER REDEFINES EPYFROMF.
  2989         10  EPYFROMA PIC  X(0001).
  2990     05  EPYFROMI PIC  X(0008).
  2991*    -------------------------------
  2992     05  EPYTHRUL PIC S9(0004) COMP.
  2993     05  EPYTHRUF PIC  X(0001).
  2994     05  FILLER REDEFINES EPYTHRUF.
  2995         10  EPYTHRUA PIC  X(0001).
  2996     05  EPYTHRUI PIC  X(0008).
  2997*    -------------------------------
  2998     05  EDAYSL PIC S9(0004) COMP.
  2999     05  EDAYSF PIC  X(0001).
  3000     05  FILLER REDEFINES EDAYSF.
  3001         10  EDAYSA PIC  X(0001).
  3002     05  EDAYSI PIC  S9(6).
  3003*    -------------------------------
  3004     05  EPYAMTL PIC S9(0004) COMP.
  3005     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  61
* EL156.cbl
  3006     05  FILLER REDEFINES EPYAMTF.
  3007         10  EPYAMTA PIC  X(0001).
  3008     05  EPYAMTI PIC  S9(8)V99.
  3009*    -------------------------------
  3010     05  ERESVL PIC S9(0004) COMP.
  3011     05  ERESVF PIC  X(0001).
  3012     05  FILLER REDEFINES ERESVF.
  3013         10  ERESVA PIC  X(0001).
  3014     05  ERESVI PIC  S9(7)V99.
  3015*    -------------------------------
  3016     05  ETYPEL PIC S9(0004) COMP.
  3017     05  ETYPEF PIC  X(0001).
  3018     05  FILLER REDEFINES ETYPEF.
  3019         10  ETYPEA PIC  X(0001).
  3020     05  ETYPEI PIC  X(0001).
  3021*    -------------------------------
  3022     05  EEXPENSL PIC S9(0004) COMP.
  3023     05  EEXPENSF PIC  X(0001).
  3024     05  FILLER REDEFINES EEXPENSF.
  3025         10  EEXPENSA PIC  X(0001).
  3026     05  EEXPENSI PIC  9(6)V99.
  3027*    -------------------------------
  3028     05  CPYFROML PIC S9(0004) COMP.
  3029     05  CPYFROMF PIC  X(0001).
  3030     05  FILLER REDEFINES CPYFROMF.
  3031         10  CPYFROMA PIC  X(0001).
  3032     05  CPYFROMI PIC  X(0008).
  3033*    -------------------------------
  3034     05  CPYTHRUL PIC S9(0004) COMP.
  3035     05  CPYTHRUF PIC  X(0001).
  3036     05  FILLER REDEFINES CPYTHRUF.
  3037         10  CPYTHRUA PIC  X(0001).
  3038     05  CPYTHRUI PIC  X(0008).
  3039*    -------------------------------
  3040     05  CDAYSL PIC S9(0004) COMP.
  3041     05  CDAYSF PIC  X(0001).
  3042     05  FILLER REDEFINES CDAYSF.
  3043         10  CDAYSA PIC  X(0001).
  3044     05  CDAYSI PIC  9(6).
  3045*    -------------------------------
  3046     05  CPYAMTL PIC S9(0004) COMP.
  3047     05  CPYAMTF PIC  X(0001).
  3048     05  FILLER REDEFINES CPYAMTF.
  3049         10  CPYAMTA PIC  X(0001).
  3050     05  CPYAMTI PIC  S9(8)V99.
  3051*    -------------------------------
  3052     05  CRESVL PIC S9(0004) COMP.
  3053     05  CRESVF PIC  X(0001).
  3054     05  FILLER REDEFINES CRESVF.
  3055         10  CRESVA PIC  X(0001).
  3056     05  CRESVI PIC  9(6)V99.
  3057*    -------------------------------
  3058     05  CEXPENSL PIC S9(0004) COMP.
  3059     05  CEXPENSF PIC  X(0001).
  3060     05  FILLER REDEFINES CEXPENSF.
  3061         10  CEXPENSA PIC  X(0001).
  3062     05  CEXPENSI PIC  9(6)V99.
  3063*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  62
* EL156.cbl
  3064     05  ERRMSG0L PIC S9(0004) COMP.
  3065     05  ERRMSG0F PIC  X(0001).
  3066     05  FILLER REDEFINES ERRMSG0F.
  3067         10  ERRMSG0A PIC  X(0001).
  3068     05  ERRMSG0I PIC  X(0072).
  3069*    -------------------------------
  3070     05  ERRMSG1L PIC S9(0004) COMP.
  3071     05  ERRMSG1F PIC  X(0001).
  3072     05  FILLER REDEFINES ERRMSG1F.
  3073         10  ERRMSG1A PIC  X(0001).
  3074     05  ERRMSG1I PIC  X(0072).
  3075*    -------------------------------
  3076     05  ERRMSG2L PIC S9(0004) COMP.
  3077     05  ERRMSG2F PIC  X(0001).
  3078     05  FILLER REDEFINES ERRMSG2F.
  3079         10  ERRMSG2A PIC  X(0001).
  3080     05  ERRMSG2I PIC  X(0072).
  3081*    -------------------------------
  3082     05  ENTERPFL PIC S9(0004) COMP.
  3083     05  ENTERPFF PIC  X(0001).
  3084     05  FILLER REDEFINES ENTERPFF.
  3085         10  ENTERPFA PIC  X(0001).
  3086     05  ENTERPFI PIC  99.
  3087*    -------------------------------
  3088     05  PF6TITL PIC S9(0004) COMP.
  3089     05  PF6TITF PIC  X(0001).
  3090     05  FILLER REDEFINES PF6TITF.
  3091         10  PF6TITA PIC  X(0001).
  3092     05  PF6TITI PIC  X(0016).
  3093 01  EL156AO REDEFINES EL156AI.
  3094     05  FILLER            PIC  X(0012).
  3095*    -------------------------------
  3096     05  FILLER            PIC  X(0003).
  3097     05  RUNDTEAO PIC  X(0008).
  3098*    -------------------------------
  3099     05  FILLER            PIC  X(0003).
  3100     05  RUNTIMAO PIC  99.99.
  3101*    -------------------------------
  3102     05  FILLER            PIC  X(0003).
  3103     05  SEQUO PIC  X(0010).
  3104*    -------------------------------
  3105     05  FILLER            PIC  X(0003).
  3106     05  CLMNOO PIC  X(0007).
  3107*    -------------------------------
  3108     05  FILLER            PIC  X(0003).
  3109     05  CARRO PIC  X(0001).
  3110*    -------------------------------
  3111     05  FILLER            PIC  X(0003).
  3112     05  CERTNOO PIC  X(0010).
  3113*    -------------------------------
  3114     05  FILLER            PIC  X(0003).
  3115     05  SUFXO PIC  X(0001).
  3116*    -------------------------------
  3117     05  FILLER            PIC  X(0003).
  3118     05  CLMTYPO PIC  X(0006).
  3119*    -------------------------------
  3120     05  FILLER            PIC  X(0003).
  3121     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  63
* EL156.cbl
  3122*    -------------------------------
  3123     05  FILLER            PIC  X(0003).
  3124     05  LSTNMEO PIC  X(0015).
  3125*    -------------------------------
  3126     05  FILLER            PIC  X(0003).
  3127     05  FSTNMEO PIC  X(0012).
  3128*    -------------------------------
  3129     05  FILLER            PIC  X(0003).
  3130     05  MINITO PIC  X(0001).
  3131*    -------------------------------
  3132     05  FILLER            PIC  X(0003).
  3133     05  PRIMHDGO PIC  X(0012).
  3134*    -------------------------------
  3135     05  FILLER            PIC  X(0003).
  3136     05  PCERTNOO PIC  X(0010).
  3137*    -------------------------------
  3138     05  FILLER            PIC  X(0003).
  3139     05  PSUFXO PIC  X(0001).
  3140*    -------------------------------
  3141     05  FILLER            PIC  X(0003).
  3142     05  STATUSO PIC  X(0010).
  3143*    -------------------------------
  3144     05  FILLER            PIC  X(0003).
  3145     05  LOANHO PIC  X(0014).
  3146*    -------------------------------
  3147     05  FILLER            PIC  X(0003).
  3148     05  LOANNOO PIC  X(0025).
  3149*    -------------------------------
  3150     05  FILLER            PIC  X(0003).
  3151     05  DUEDAYHO PIC  X(0008).
  3152*    -------------------------------
  3153     05  FILLER            PIC  X(0003).
  3154     05  DUEDAYO PIC  X(0002).
  3155*    -------------------------------
  3156     05  FILLER            PIC  X(0003).
  3157     05  ZINTHO PIC  X(0009).
  3158*    -------------------------------
  3159     05  FILLER            PIC  X(0003).
  3160     05  ZINTO PIC  9.99999.
  3161*    -------------------------------
  3162     05  FILLER            PIC  X(0003).
  3163     05  PTHRHDGO PIC  X(0014).
  3164*    -------------------------------
  3165     05  FILLER            PIC  X(0003).
  3166     05  PDTHRUO PIC  X(0008).
  3167*    -------------------------------
  3168     05  FILLER            PIC  X(0003).
  3169     05  TOTPAIDO PIC  Z(6).99-.
  3170*    -------------------------------
  3171     05  FILLER            PIC  X(0003).
  3172     05  COVERO PIC  X(0010).
  3173*    -------------------------------
  3174     05  FILLER            PIC  X(0003).
  3175     05  INCURO PIC  X(0008).
  3176*    -------------------------------
  3177     05  FILLER            PIC  X(0003).
  3178     05  LSTDTEO PIC  X(0008).
  3179*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  64
* EL156.cbl
  3180     05  FILLER            PIC  X(0003).
  3181     05  CRTSTATO PIC  X(0010).
  3182*    -------------------------------
  3183     05  FILLER            PIC  X(0003).
  3184     05  EFFECTO PIC  X(0008).
  3185*    -------------------------------
  3186     05  FILLER            PIC  X(0003).
  3187     05  TERMSO PIC  X(0011).
  3188*    -------------------------------
  3189     05  FILLER            PIC  X(0003).
  3190     05  STACCTO PIC  X(0013).
  3191*    -------------------------------
  3192     05  FILLER            PIC  X(0003).
  3193     05  EXPDTEHO PIC  X(0014).
  3194*    -------------------------------
  3195     05  FILLER            PIC  X(0003).
  3196     05  EXPDTEO PIC  X(0008).
  3197*    -------------------------------
  3198     05  FILLER            PIC  X(0003).
  3199     05  BENECAPO PIC  X(0013).
  3200*    -------------------------------
  3201     05  FILLER            PIC  X(0003).
  3202     05  BENEO PIC  Z(6).99.
  3203*    -------------------------------
  3204     05  FILLER            PIC  X(0003).
  3205     05  FORMTYPO PIC  X(0001).
  3206*    -------------------------------
  3207     05  FILLER            PIC  X(0003).
  3208     05  PMTTYPEO PIC  X(0001).
  3209*    -------------------------------
  3210     05  FILLER            PIC  X(0003).
  3211     05  PAYEEO PIC  X(0002).
  3212*    -------------------------------
  3213     05  FILLER            PIC  X(0003).
  3214     05  CHECKNOO PIC  X(0007).
  3215*    -------------------------------
  3216     05  FILLER            PIC  X(0003).
  3217     05  OFFLINEO PIC  X(0001).
  3218*    -------------------------------
  3219     05  FILLER            PIC  X(0003).
  3220     05  HOLDTILO PIC  99B99B99.
  3221*    -------------------------------
  3222     05  FILLER            PIC  X(0003).
  3223     05  NOTE1O PIC  X(0060).
  3224*    -------------------------------
  3225     05  FILLER            PIC  X(0003).
  3226     05  NOTE2O PIC  X(0060).
  3227*    -------------------------------
  3228     05  FILLER            PIC  X(0003).
  3229     05  EOBYNO PIC  X(0001).
  3230*    -------------------------------
  3231     05  FILLER            PIC  X(0003).
  3232     05  CLMFMYNO PIC  X(0001).
  3233*    -------------------------------
  3234     05  FILLER            PIC  X(0003).
  3235     05  SURVYYNO PIC  X(0001).
  3236*    -------------------------------
  3237     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  65
* EL156.cbl
  3238     05  SPRELYNO PIC  X(0001).
  3239*    -------------------------------
  3240     05  FILLER            PIC  X(0003).
  3241     05  PINTHO PIC  X(0004).
  3242*    -------------------------------
  3243     05  FILLER            PIC  X(0003).
  3244     05  PINTO PIC  Z,ZZ9.99.
  3245*    -------------------------------
  3246     05  FILLER            PIC  X(0003).
  3247     05  PROOFDTO PIC  99B99B99.
  3248*    -------------------------------
  3249     05  FILLER            PIC  X(0003).
  3250     05  AIGFRMHO PIC  X(0012).
  3251*    -------------------------------
  3252     05  FILLER            PIC  X(0003).
  3253     05  AIGFROMO PIC  99B99B99.
  3254*    -------------------------------
  3255     05  FILLER            PIC  X(0003).
  3256     05  PMTHDGAO PIC  X(0066).
  3257*    -------------------------------
  3258     05  FILLER            PIC  X(0003).
  3259     05  EPYFROMO PIC  99B99B99.
  3260*    -------------------------------
  3261     05  FILLER            PIC  X(0003).
  3262     05  EPYTHRUO PIC  99B99B99.
  3263*    -------------------------------
  3264     05  FILLER            PIC  X(0003).
  3265     05  EDAYSO PIC  Z(4)9-.
  3266*    -------------------------------
  3267     05  FILLER            PIC  X(0003).
  3268     05  EPYAMTO PIC  Z(6).99-.
  3269*    -------------------------------
  3270     05  FILLER            PIC  X(0003).
  3271     05  ERESVO PIC  Z(5).99-.
  3272*    -------------------------------
  3273     05  FILLER            PIC  X(0003).
  3274     05  ETYPEO PIC  X(0001).
  3275*    -------------------------------
  3276     05  FILLER            PIC  X(0003).
  3277     05  EEXPENSO PIC  Z(5).99.
  3278*    -------------------------------
  3279     05  FILLER            PIC  X(0003).
  3280     05  CPYFROMO PIC  99B99B99.
  3281*    -------------------------------
  3282     05  FILLER            PIC  X(0003).
  3283     05  CPYTHRUO PIC  99B99B99.
  3284*    -------------------------------
  3285     05  FILLER            PIC  X(0003).
  3286     05  CDAYSO PIC  Z(4)9-.
  3287*    -------------------------------
  3288     05  FILLER            PIC  X(0003).
  3289     05  CPYAMTO PIC  Z(6).99-.
  3290*    -------------------------------
  3291     05  FILLER            PIC  X(0003).
  3292     05  CRESVO PIC  Z(5).99.
  3293*    -------------------------------
  3294     05  FILLER            PIC  X(0003).
  3295     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  66
* EL156.cbl
  3296*    -------------------------------
  3297     05  FILLER            PIC  X(0003).
  3298     05  ERRMSG0O PIC  X(0072).
  3299*    -------------------------------
  3300     05  FILLER            PIC  X(0003).
  3301     05  ERRMSG1O PIC  X(0072).
  3302*    -------------------------------
  3303     05  FILLER            PIC  X(0003).
  3304     05  ERRMSG2O PIC  X(0072).
  3305*    -------------------------------
  3306     05  FILLER            PIC  X(0003).
  3307     05  ENTERPFO PIC  X(0002).
  3308*    -------------------------------
  3309     05  FILLER            PIC  X(0003).
  3310     05  PF6TITO PIC  X(0016).
  3311*    -------------------------------
  3312 01  EL156BI REDEFINES EL156AI.
  3313     05  FILLER            PIC  X(0012).
  3314*    -------------------------------
  3315     05  RUNDTEBL PIC S9(0004) COMP.
  3316     05  RUNDTEBF PIC  X(0001).
  3317     05  FILLER REDEFINES RUNDTEBF.
  3318         10  RUNDTEBA PIC  X(0001).
  3319     05  RUNDTEBI PIC  X(0008).
  3320*    -------------------------------
  3321     05  RUNTIMBL PIC S9(0004) COMP.
  3322     05  RUNTIMBF PIC  X(0001).
  3323     05  FILLER REDEFINES RUNTIMBF.
  3324         10  RUNTIMBA PIC  X(0001).
  3325     05  RUNTIMBI PIC  X(0005).
  3326*    -------------------------------
  3327     05  PAYDTBL PIC S9(0004) COMP.
  3328     05  PAYDTBF PIC  X(0001).
  3329     05  FILLER REDEFINES PAYDTBF.
  3330         10  PAYDTBA PIC  X(0001).
  3331     05  PAYDTBI PIC  X(0008).
  3332*    -------------------------------
  3333     05  PAYTYPBL PIC S9(0004) COMP.
  3334     05  PAYTYPBF PIC  X(0001).
  3335     05  FILLER REDEFINES PAYTYPBF.
  3336         10  PAYTYPBA PIC  X(0001).
  3337     05  PAYTYPBI PIC  X(0015).
  3338*    -------------------------------
  3339     05  PAYAMTBL PIC S9(0004) COMP.
  3340     05  PAYAMTBF PIC  X(0001).
  3341     05  FILLER REDEFINES PAYAMTBF.
  3342         10  PAYAMTBA PIC  X(0001).
  3343     05  PAYAMTBI PIC  X(0011).
  3344*    -------------------------------
  3345     05  LOANHBL PIC S9(0004) COMP.
  3346     05  LOANHBF PIC  X(0001).
  3347     05  FILLER REDEFINES LOANHBF.
  3348         10  LOANHBA PIC  X(0001).
  3349     05  LOANHBI PIC  X(0012).
  3350*    -------------------------------
  3351     05  LOANNBL PIC S9(0004) COMP.
  3352     05  LOANNBF PIC  X(0001).
  3353     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  67
* EL156.cbl
  3354         10  LOANNBA PIC  X(0001).
  3355     05  LOANNBI PIC  X(0025).
  3356*    -------------------------------
  3357     05  CKNUMHDL PIC S9(0004) COMP.
  3358     05  CKNUMHDF PIC  X(0001).
  3359     05  FILLER REDEFINES CKNUMHDF.
  3360         10  CKNUMHDA PIC  X(0001).
  3361     05  CKNUMHDI PIC  X(0012).
  3362*    -------------------------------
  3363     05  CKNUMBL PIC S9(0004) COMP.
  3364     05  CKNUMBF PIC  X(0001).
  3365     05  FILLER REDEFINES CKNUMBF.
  3366         10  CKNUMBA PIC  X(0001).
  3367     05  CKNUMBI PIC  X(0007).
  3368*    -------------------------------
  3369     05  AGTHDGL PIC S9(0004) COMP.
  3370     05  AGTHDGF PIC  X(0001).
  3371     05  FILLER REDEFINES AGTHDGF.
  3372         10  AGTHDGA PIC  X(0001).
  3373     05  AGTHDGI PIC  X(0016).
  3374*    -------------------------------
  3375     05  NAMEBL PIC S9(0004) COMP.
  3376     05  NAMEBF PIC  X(0001).
  3377     05  FILLER REDEFINES NAMEBF.
  3378         10  NAMEBA PIC  X(0001).
  3379     05  NAMEBI PIC  X(0030).
  3380*    -------------------------------
  3381     05  NAMEB2L PIC S9(0004) COMP.
  3382     05  NAMEB2F PIC  X(0001).
  3383     05  FILLER REDEFINES NAMEB2F.
  3384         10  NAMEB2A PIC  X(0001).
  3385     05  NAMEB2I PIC  X(0030).
  3386*    -------------------------------
  3387     05  ADDR1BL PIC S9(0004) COMP.
  3388     05  ADDR1BF PIC  X(0001).
  3389     05  FILLER REDEFINES ADDR1BF.
  3390         10  ADDR1BA PIC  X(0001).
  3391     05  ADDR1BI PIC  X(0030).
  3392*    -------------------------------
  3393     05  ADDR1B2L PIC S9(0004) COMP.
  3394     05  ADDR1B2F PIC  X(0001).
  3395     05  FILLER REDEFINES ADDR1B2F.
  3396         10  ADDR1B2A PIC  X(0001).
  3397     05  ADDR1B2I PIC  X(0030).
  3398*    -------------------------------
  3399     05  ADDR2BL PIC S9(0004) COMP.
  3400     05  ADDR2BF PIC  X(0001).
  3401     05  FILLER REDEFINES ADDR2BF.
  3402         10  ADDR2BA PIC  X(0001).
  3403     05  ADDR2BI PIC  X(0030).
  3404*    -------------------------------
  3405     05  ADDR2B2L PIC S9(0004) COMP.
  3406     05  ADDR2B2F PIC  X(0001).
  3407     05  FILLER REDEFINES ADDR2B2F.
  3408         10  ADDR2B2A PIC  X(0001).
  3409     05  ADDR2B2I PIC  X(0030).
  3410*    -------------------------------
  3411     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  68
* EL156.cbl
  3412     05  CITYSTBF PIC  X(0001).
  3413     05  FILLER REDEFINES CITYSTBF.
  3414         10  CITYSTBA PIC  X(0001).
  3415     05  CITYSTBI PIC  X(0030).
  3416*    -------------------------------
  3417     05  CITYST2L PIC S9(0004) COMP.
  3418     05  CITYST2F PIC  X(0001).
  3419     05  FILLER REDEFINES CITYST2F.
  3420         10  CITYST2A PIC  X(0001).
  3421     05  CITYST2I PIC  X(0030).
  3422*    -------------------------------
  3423     05  ZIPBL PIC S9(0004) COMP.
  3424     05  ZIPBF PIC  X(0001).
  3425     05  FILLER REDEFINES ZIPBF.
  3426         10  ZIPBA PIC  X(0001).
  3427     05  ZIPBI PIC  X(0009).
  3428*    -------------------------------
  3429     05  ZIPB2L PIC S9(0004) COMP.
  3430     05  ZIPB2F PIC  X(0001).
  3431     05  FILLER REDEFINES ZIPB2F.
  3432         10  ZIPB2A PIC  X(0001).
  3433     05  ZIPB2I PIC  X(0009).
  3434*    -------------------------------
  3435     05  INTHDBL PIC S9(0004) COMP.
  3436     05  INTHDBF PIC  X(0001).
  3437     05  FILLER REDEFINES INTHDBF.
  3438         10  INTHDBA PIC  X(0001).
  3439     05  INTHDBI PIC  X(0012).
  3440*    -------------------------------
  3441     05  INTAMTBL PIC S9(0004) COMP.
  3442     05  INTAMTBF PIC  X(0001).
  3443     05  FILLER REDEFINES INTAMTBF.
  3444         10  INTAMTBA PIC  X(0001).
  3445     05  INTAMTBI PIC  X(0011).
  3446*    -------------------------------
  3447     05  PMTHDGBL PIC S9(0004) COMP.
  3448     05  PMTHDGBF PIC  X(0001).
  3449     05  FILLER REDEFINES PMTHDGBF.
  3450         10  PMTHDGBA PIC  X(0001).
  3451     05  PMTHDGBI PIC  X(0034).
  3452*    -------------------------------
  3453     05  CLMNOBL PIC S9(0004) COMP.
  3454     05  CLMNOBF PIC  X(0001).
  3455     05  FILLER REDEFINES CLMNOBF.
  3456         10  CLMNOBA PIC  X(0001).
  3457     05  CLMNOBI PIC  X(0007).
  3458*    -------------------------------
  3459     05  CARRBL PIC S9(0004) COMP.
  3460     05  CARRBF PIC  X(0001).
  3461     05  FILLER REDEFINES CARRBF.
  3462         10  CARRBA PIC  X(0001).
  3463     05  CARRBI PIC  X(0001).
  3464*    -------------------------------
  3465     05  CERTNOBL PIC S9(0004) COMP.
  3466     05  CERTNOBF PIC  X(0001).
  3467     05  FILLER REDEFINES CERTNOBF.
  3468         10  CERTNOBA PIC  X(0001).
  3469     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  69
* EL156.cbl
  3470*    -------------------------------
  3471     05  SUFXBL PIC S9(0004) COMP.
  3472     05  SUFXBF PIC  X(0001).
  3473     05  FILLER REDEFINES SUFXBF.
  3474         10  SUFXBA PIC  X(0001).
  3475     05  SUFXBI PIC  X(0001).
  3476*    -------------------------------
  3477     05  CLMTYPBL PIC S9(0004) COMP.
  3478     05  CLMTYPBF PIC  X(0001).
  3479     05  FILLER REDEFINES CLMTYPBF.
  3480         10  CLMTYPBA PIC  X(0001).
  3481     05  CLMTYPBI PIC  X(0006).
  3482*    -------------------------------
  3483     05  INCURBL PIC S9(0004) COMP.
  3484     05  INCURBF PIC  X(0001).
  3485     05  FILLER REDEFINES INCURBF.
  3486         10  INCURBA PIC  X(0001).
  3487     05  INCURBI PIC  X(0008).
  3488*    -------------------------------
  3489     05  PYFROMBL PIC S9(0004) COMP.
  3490     05  PYFROMBF PIC  X(0001).
  3491     05  FILLER REDEFINES PYFROMBF.
  3492         10  PYFROMBA PIC  X(0001).
  3493     05  PYFROMBI PIC  X(0008).
  3494*    -------------------------------
  3495     05  PYTHRUBL PIC S9(0004) COMP.
  3496     05  PYTHRUBF PIC  X(0001).
  3497     05  FILLER REDEFINES PYTHRUBF.
  3498         10  PYTHRUBA PIC  X(0001).
  3499     05  PYTHRUBI PIC  X(0008).
  3500*    -------------------------------
  3501     05  DAYSBL PIC S9(0004) COMP.
  3502     05  DAYSBF PIC  X(0001).
  3503     05  FILLER REDEFINES DAYSBF.
  3504         10  DAYSBA PIC  X(0001).
  3505     05  DAYSBI PIC  X(0005).
  3506*    -------------------------------
  3507     05  BYBL PIC S9(0004) COMP.
  3508     05  BYBF PIC  X(0001).
  3509     05  FILLER REDEFINES BYBF.
  3510         10  BYBA PIC  X(0001).
  3511     05  BYBI PIC  X(0004).
  3512*    -------------------------------
  3513     05  PROOFDBL PIC S9(0004) COMP.
  3514     05  PROOFDBF PIC  X(0001).
  3515     05  FILLER REDEFINES PROOFDBF.
  3516         10  PROOFDBA PIC  X(0001).
  3517     05  PROOFDBI PIC  X(0008).
  3518*    -------------------------------
  3519     05  ACCTBL PIC S9(0004) COMP.
  3520     05  ACCTBF PIC  X(0001).
  3521     05  FILLER REDEFINES ACCTBF.
  3522         10  ACCTBA PIC  X(0001).
  3523     05  ACCTBI PIC  X(0010).
  3524*    -------------------------------
  3525     05  STATEBL PIC S9(0004) COMP.
  3526     05  STATEBF PIC  X(0001).
  3527     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  70
* EL156.cbl
  3528         10  STATEBA PIC  X(0001).
  3529     05  STATEBI PIC  X(0002).
  3530*    -------------------------------
  3531     05  GROUPBL PIC S9(0004) COMP.
  3532     05  GROUPBF PIC  X(0001).
  3533     05  FILLER REDEFINES GROUPBF.
  3534         10  GROUPBA PIC  X(0001).
  3535     05  GROUPBI PIC  X(0006).
  3536*    -------------------------------
  3537     05  ACARRBL PIC S9(0004) COMP.
  3538     05  ACARRBF PIC  X(0001).
  3539     05  FILLER REDEFINES ACARRBF.
  3540         10  ACARRBA PIC  X(0001).
  3541     05  ACARRBI PIC  X(0001).
  3542*    -------------------------------
  3543     05  ACCTNMBL PIC S9(0004) COMP.
  3544     05  ACCTNMBF PIC  X(0001).
  3545     05  FILLER REDEFINES ACCTNMBF.
  3546         10  ACCTNMBA PIC  X(0001).
  3547     05  ACCTNMBI PIC  X(0030).
  3548*    -------------------------------
  3549     05  UNDISBL PIC S9(0004) COMP.
  3550     05  UNDISBF PIC  X(0001).
  3551     05  FILLER REDEFINES UNDISBF.
  3552         10  UNDISBA PIC  X(0001).
  3553     05  UNDISBI PIC  X(0010).
  3554*    -------------------------------
  3555     05  RATEBL PIC S9(0004) COMP.
  3556     05  RATEBF PIC  X(0001).
  3557     05  FILLER REDEFINES RATEBF.
  3558         10  RATEBA PIC  X(0001).
  3559     05  RATEBI PIC  X(0006).
  3560*    -------------------------------
  3561     05  ERMSG1BL PIC S9(0004) COMP.
  3562     05  ERMSG1BF PIC  X(0001).
  3563     05  FILLER REDEFINES ERMSG1BF.
  3564         10  ERMSG1BA PIC  X(0001).
  3565     05  ERMSG1BI PIC  X(0072).
  3566*    -------------------------------
  3567     05  ENTPFBL PIC S9(0004) COMP.
  3568     05  ENTPFBF PIC  X(0001).
  3569     05  FILLER REDEFINES ENTPFBF.
  3570         10  ENTPFBA PIC  X(0001).
  3571     05  ENTPFBI PIC  99.
  3572 01  EL156BO REDEFINES EL156AI.
  3573     05  FILLER            PIC  X(0012).
  3574*    -------------------------------
  3575     05  FILLER            PIC  X(0003).
  3576     05  RUNDTEBO PIC  X(0008).
  3577*    -------------------------------
  3578     05  FILLER            PIC  X(0003).
  3579     05  RUNTIMBO PIC  99.99.
  3580*    -------------------------------
  3581     05  FILLER            PIC  X(0003).
  3582     05  PAYDTBO PIC  99B99B99.
  3583*    -------------------------------
  3584     05  FILLER            PIC  X(0003).
  3585     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  71
* EL156.cbl
  3586*    -------------------------------
  3587     05  FILLER            PIC  X(0003).
  3588     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3589*    -------------------------------
  3590     05  FILLER            PIC  X(0003).
  3591     05  LOANHBO PIC  X(0012).
  3592*    -------------------------------
  3593     05  FILLER            PIC  X(0003).
  3594     05  LOANNBO PIC  X(0025).
  3595*    -------------------------------
  3596     05  FILLER            PIC  X(0003).
  3597     05  CKNUMHDO PIC  X(0012).
  3598*    -------------------------------
  3599     05  FILLER            PIC  X(0003).
  3600     05  CKNUMBO PIC  X(0007).
  3601*    -------------------------------
  3602     05  FILLER            PIC  X(0003).
  3603     05  AGTHDGO PIC  X(0016).
  3604*    -------------------------------
  3605     05  FILLER            PIC  X(0003).
  3606     05  NAMEBO PIC  X(0030).
  3607*    -------------------------------
  3608     05  FILLER            PIC  X(0003).
  3609     05  NAMEB2O PIC  X(0030).
  3610*    -------------------------------
  3611     05  FILLER            PIC  X(0003).
  3612     05  ADDR1BO PIC  X(0030).
  3613*    -------------------------------
  3614     05  FILLER            PIC  X(0003).
  3615     05  ADDR1B2O PIC  X(0030).
  3616*    -------------------------------
  3617     05  FILLER            PIC  X(0003).
  3618     05  ADDR2BO PIC  X(0030).
  3619*    -------------------------------
  3620     05  FILLER            PIC  X(0003).
  3621     05  ADDR2B2O PIC  X(0030).
  3622*    -------------------------------
  3623     05  FILLER            PIC  X(0003).
  3624     05  CITYSTBO PIC  X(0030).
  3625*    -------------------------------
  3626     05  FILLER            PIC  X(0003).
  3627     05  CITYST2O PIC  X(0030).
  3628*    -------------------------------
  3629     05  FILLER            PIC  X(0003).
  3630     05  ZIPBO PIC  ZZZZ99999.
  3631*    -------------------------------
  3632     05  FILLER            PIC  X(0003).
  3633     05  ZIPB2O PIC  ZZZZZZZZZ.
  3634*    -------------------------------
  3635     05  FILLER            PIC  X(0003).
  3636     05  INTHDBO PIC  X(0012).
  3637*    -------------------------------
  3638     05  FILLER            PIC  X(0003).
  3639     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3640*    -------------------------------
  3641     05  FILLER            PIC  X(0003).
  3642     05  PMTHDGBO PIC  X(0034).
  3643*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  72
* EL156.cbl
  3644     05  FILLER            PIC  X(0003).
  3645     05  CLMNOBO PIC  X(0007).
  3646*    -------------------------------
  3647     05  FILLER            PIC  X(0003).
  3648     05  CARRBO PIC  X(0001).
  3649*    -------------------------------
  3650     05  FILLER            PIC  X(0003).
  3651     05  CERTNOBO PIC  X(0010).
  3652*    -------------------------------
  3653     05  FILLER            PIC  X(0003).
  3654     05  SUFXBO PIC  X(0001).
  3655*    -------------------------------
  3656     05  FILLER            PIC  X(0003).
  3657     05  CLMTYPBO PIC  X(0006).
  3658*    -------------------------------
  3659     05  FILLER            PIC  X(0003).
  3660     05  INCURBO PIC  X(0008).
  3661*    -------------------------------
  3662     05  FILLER            PIC  X(0003).
  3663     05  PYFROMBO PIC  99B99B99.
  3664*    -------------------------------
  3665     05  FILLER            PIC  X(0003).
  3666     05  PYTHRUBO PIC  99B99B99.
  3667*    -------------------------------
  3668     05  FILLER            PIC  X(0003).
  3669     05  DAYSBO PIC  X(0005).
  3670*    -------------------------------
  3671     05  FILLER            PIC  X(0003).
  3672     05  BYBO PIC  X(0004).
  3673*    -------------------------------
  3674     05  FILLER            PIC  X(0003).
  3675     05  PROOFDBO PIC  99B99B99.
  3676*    -------------------------------
  3677     05  FILLER            PIC  X(0003).
  3678     05  ACCTBO PIC  X(0010).
  3679*    -------------------------------
  3680     05  FILLER            PIC  X(0003).
  3681     05  STATEBO PIC  X(0002).
  3682*    -------------------------------
  3683     05  FILLER            PIC  X(0003).
  3684     05  GROUPBO PIC  X(0006).
  3685*    -------------------------------
  3686     05  FILLER            PIC  X(0003).
  3687     05  ACARRBO PIC  X(0001).
  3688*    -------------------------------
  3689     05  FILLER            PIC  X(0003).
  3690     05  ACCTNMBO PIC  X(0030).
  3691*    -------------------------------
  3692     05  FILLER            PIC  X(0003).
  3693     05  UNDISBO PIC  ZZZ,Z99.99.
  3694*    -------------------------------
  3695     05  FILLER            PIC  X(0003).
  3696     05  RATEBO PIC  ZZZ.99.
  3697*    -------------------------------
  3698     05  FILLER            PIC  X(0003).
  3699     05  ERMSG1BO PIC  X(0072).
  3700*    -------------------------------
  3701     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  73
* EL156.cbl
  3702     05  ENTPFBO PIC  X(0002).
  3703*    -------------------------------
  3704****************************************************************
  3705*
  3706* Copyright (c) 2007 by Clerity Solutions, Inc.
  3707* All rights reserved.
  3708*
  3709****************************************************************
  3710 01  DFHEIV.
  3711   02  DFHEIV0               PIC X(35).
  3712   02  DFHEIV1               PIC X(08).
  3713   02  DFHEIV2               PIC X(08).
  3714   02  DFHEIV3               PIC X(08).
  3715   02  DFHEIV4               PIC X(06).
  3716   02  DFHEIV5               PIC X(04).
  3717   02  DFHEIV6               PIC X(04).
  3718   02  DFHEIV7               PIC X(02).
  3719   02  DFHEIV8               PIC X(02).
  3720   02  DFHEIV9               PIC X(01).
  3721   02  DFHEIV10              PIC S9(7) COMP-3.
  3722   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3723   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3724   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3725   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3726   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3727   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3728   02  DFHEIV17              PIC X(04).
  3729   02  DFHEIV18              PIC X(04).
  3730   02  DFHEIV19              PIC X(04).
  3731   02  DFHEIV20              USAGE IS POINTER.
  3732   02  DFHEIV21              USAGE IS POINTER.
  3733   02  DFHEIV22              USAGE IS POINTER.
  3734   02  DFHEIV23              USAGE IS POINTER.
  3735   02  DFHEIV24              USAGE IS POINTER.
  3736   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3737   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3738   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3739   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3740   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3741   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3742   02  FILLER                PIC X(02).
  3743   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3744   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3745   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3746   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3747   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3748 LINKAGE  SECTION.
  3749*****************************************************************
  3750*                                                               *
  3751* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3752* All rights reserved.                                          *
  3753*                                                               *
  3754*****************************************************************
  3755 01  dfheiblk.
  3756     02  eibtime          pic s9(7) comp-3.
  3757     02  eibdate          pic s9(7) comp-3.
  3758     02  eibtrnid         pic x(4).
  3759     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  74
* EL156.cbl
  3760     02  eibtrmid         pic x(4).
  3761     02  dfheigdi         pic s9(4) comp.
  3762     02  eibcposn         pic s9(4) comp.
  3763     02  eibcalen         pic s9(4) comp.
  3764     02  eibaid           pic x(1).
  3765     02  eibfiller1       pic x(1).
  3766     02  eibfn            pic x(2).
  3767     02  eibfiller2       pic x(2).
  3768     02  eibrcode         pic x(6).
  3769     02  eibfiller3       pic x(2).
  3770     02  eibds            pic x(8).
  3771     02  eibreqid         pic x(8).
  3772     02  eibrsrce         pic x(8).
  3773     02  eibsync          pic x(1).
  3774     02  eibfree          pic x(1).
  3775     02  eibrecv          pic x(1).
  3776     02  eibsend          pic x(1).
  3777     02  eibatt           pic x(1).
  3778     02  eibeoc           pic x(1).
  3779     02  eibfmh           pic x(1).
  3780     02  eibcompl         pic x(1).
  3781     02  eibsig           pic x(1).
  3782     02  eibconf          pic x(1).
  3783     02  eiberr           pic x(1).
  3784     02  eibrldbk         pic x(1).
  3785     02  eiberrcd         pic x(4).
  3786     02  eibsynrb         pic x(1).
  3787     02  eibnodat         pic x(1).
  3788     02  eibfiller5       pic x(2).
  3789     02  eibresp          pic 9(09) comp.
  3790     02  eibresp2         pic 9(09) comp.
  3791     02  dfheigdj         pic s9(4) comp.
  3792     02  dfheigdk         pic s9(4) comp.
  3793 01  DFHCOMMAREA             PIC X(1024).
  3794
  3795*    COPY ELCMSTR.
  3796******************************************************************
  3797*                                                                *
  3798*                            ELCMSTR.                            *
  3799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3800*                            VMOD=2.012                          *
  3801*                                                                *
  3802*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3803*                                                                *
  3804*   FILE TYPE = VSAM,KSDS                                        *
  3805*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3806*                                                                *
  3807*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3808*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3809*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3810*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3811*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3812*                                                 RKP=75,LEN=21  *
  3813*                                                                *
  3814*   **** NOTE ****                                               *
  3815*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3816*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3817*                                                                *
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  75
* EL156.cbl
  3818*   LOG = YES                                                    *
  3819*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3820******************************************************************
  3821*                   C H A N G E   L O G
  3822*
  3823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3824*-----------------------------------------------------------------
  3825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3826* EFFECTIVE    NUMBER
  3827*-----------------------------------------------------------------
  3828* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3829* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3830* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3831* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3832******************************************************************
  3833 01  CLAIM-MASTER.
  3834     12  CL-RECORD-ID                PIC XX.
  3835         88  VALID-CL-ID         VALUE 'CL'.
  3836
  3837     12  CL-CONTROL-PRIMARY.
  3838         16  CL-COMPANY-CD           PIC X.
  3839         16  CL-CARRIER              PIC X.
  3840         16  CL-CLAIM-NO             PIC X(7).
  3841         16  CL-CERT-NO.
  3842             20  CL-CERT-PRIME       PIC X(10).
  3843             20  CL-CERT-SFX         PIC X.
  3844
  3845     12  CL-CONTROL-BY-NAME.
  3846         16  CL-COMPANY-CD-A1        PIC X.
  3847         16  CL-INSURED-LAST-NAME    PIC X(15).
  3848         16  CL-INSURED-NAME.
  3849             20  CL-INSURED-1ST-NAME PIC X(12).
  3850             20  CL-INSURED-MID-INIT PIC X.
  3851
  3852     12  CL-CONTROL-BY-SSN.
  3853         16  CL-COMPANY-CD-A2        PIC X.
  3854         16  CL-SOC-SEC-NO.
  3855             20  CL-SSN-STATE        PIC XX.
  3856             20  CL-SSN-ACCOUNT      PIC X(6).
  3857             20  CL-SSN-LN3          PIC X(3).
  3858
  3859     12  CL-CONTROL-BY-CERT-NO.
  3860         16  CL-COMPANY-CD-A4        PIC X.
  3861         16  CL-CERT-NO-A4.
  3862             20  CL-CERT-A4-PRIME    PIC X(10).
  3863             20  CL-CERT-A4-SFX      PIC X.
  3864
  3865     12  CL-CONTROL-BY-CCN.
  3866         16  CL-COMPANY-CD-A5        PIC X.
  3867         16  CL-CCN-A5.
  3868             20  CL-CCN.
  3869                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3870                 24  CL-CCN-PRIME-A5 PIC X(12).
  3871             20  CL-CCN-FILLER-A5    PIC X(4).
  3872
  3873     12  CL-INSURED-PROFILE-DATA.
  3874         16  CL-INSURED-BIRTH-DT     PIC XX.
  3875         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  76
* EL156.cbl
  3876             88  INSURED-IS-MALE        VALUE 'M'.
  3877             88  INSURED-IS-FEMALE      VALUE 'F'.
  3878             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3879         16  CL-INSURED-OCC-CD       PIC X(6).
  3880         16  FILLER                  PIC X(5).
  3881
  3882     12  CL-PROCESSING-INFO.
  3883         16  CL-PROCESSOR-ID         PIC X(4).
  3884         16  CL-CLAIM-STATUS         PIC X.
  3885             88  CLAIM-IS-OPEN          VALUE 'O'.
  3886             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3887         16  CL-CLAIM-TYPE           PIC X.
  3888*            88  AH-CLAIM               VALUE 'A'.
  3889*            88  LIFE-CLAIM             VALUE 'L'.
  3890*            88  PROPERTY-CLAIM         VALUE 'P'.
  3891*            88  IUI-CLAIM              VALUE 'I'.
  3892*            88  GAP-CLAIM              VALUE 'G'.
  3893         16  CL-CLAIM-PREM-TYPE      PIC X.
  3894             88  SINGLE-PREMIUM         VALUE '1'.
  3895             88  O-B-COVERAGE           VALUE '2'.
  3896             88  OPEN-END-COVERAGE      VALUE '3'.
  3897         16  CL-INCURRED-DT          PIC XX.
  3898         16  CL-REPORTED-DT          PIC XX.
  3899         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3900         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3901         16  CL-LAST-PMT-DT          PIC XX.
  3902         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3903         16  CL-PAID-THRU-DT         PIC XX.
  3904         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3905         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3906         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3907         16  CL-PMT-CALC-METHOD      PIC X.
  3908             88  CL-360-DAY-YR          VALUE '1'.
  3909             88  CL-365-DAY-YR          VALUE '2'.
  3910             88  CL-FULL-MONTHS         VALUE '3'.
  3911         16  CL-CAUSE-CD             PIC X(6).
  3912
  3913         16  CL-PRIME-CERT-NO.
  3914             20  CL-PRIME-CERT-PRIME PIC X(10).
  3915             20  CL-PRIME-CERT-SFX   PIC X.
  3916
  3917         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3918             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3919             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3920
  3921         16  CL-MICROFILM-NO         PIC X(10).
  3922         16  FILLER REDEFINES CL-MICROFILM-NO.
  3923             20  CL-BENEFIT-PERIOD   PIC 99.
  3924             20  FILLER              PIC X(8).
  3925         16  CL-PROG-FORM-TYPE       PIC X.
  3926         16  CL-LAST-ADD-ON-DT       PIC XX.
  3927
  3928         16  CL-LAST-REOPEN-DT       PIC XX.
  3929         16  CL-LAST-CLOSE-DT        PIC XX.
  3930         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3931             88  FINAL-PAID             VALUE '1'.
  3932             88  CLAIM-DENIED           VALUE '2'.
  3933             88  AUTO-CLOSE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  77
* EL156.cbl
  3934             88  MANUAL-CLOSE           VALUE '4'.
  3935             88  BENEFITS-CHANGED       VALUE 'C'.
  3936             88  SETUP-ERRORS           VALUE 'E'.
  3937         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3938         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3939         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3940             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3941         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3942         16  FILLER                  PIC X.
  3943
  3944     12  CL-CERTIFICATE-DATA.
  3945         16  CL-CERT-ORIGIN          PIC X.
  3946             88  CERT-WAS-ONLINE        VALUE '1'.
  3947             88  CERT-WAS-CREATED       VALUE '2'.
  3948             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3949         16  CL-CERT-KEY-DATA.
  3950             20  CL-CERT-CARRIER     PIC X.
  3951             20  CL-CERT-GROUPING    PIC X(6).
  3952             20  CL-CERT-STATE       PIC XX.
  3953             20  CL-CERT-ACCOUNT.
  3954                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3955                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3956             20  CL-CERT-EFF-DT      PIC XX.
  3957
  3958     12  CL-STATUS-CONTROLS.
  3959         16  CL-PRIORITY-CD          PIC X.
  3960             88  CONFIDENTIAL-DATA      VALUE '8'.
  3961             88  HIGHEST-PRIORITY       VALUE '9'.
  3962         16  CL-SUPV-ATTN-CD         PIC X.
  3963             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3964             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3965         16  CL-PURGED-DT            PIC XX.
  3966         16  CL-RESTORED-DT          PIC XX.
  3967         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3968         16  CL-NEXT-RESEND-DT       PIC XX.
  3969         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3970         16  CL-CRITICAL-PERIOD      PIC 99.
  3971*        16  FILLER                  PIC XX.
  3972         16  CL-LAST-MAINT-DT        PIC XX.
  3973         16  CL-LAST-MAINT-USER      PIC X(4).
  3974         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3975         16  CL-LAST-MAINT-TYPE      PIC X.
  3976             88  CLAIM-SET-UP           VALUE ' '.
  3977             88  PAYMENT-MADE           VALUE '1'.
  3978             88  LETTER-SENT            VALUE '2'.
  3979             88  MASTER-WAS-ALTERED     VALUE '3'.
  3980             88  MASTER-WAS-RESTORED    VALUE '4'.
  3981             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3982             88  FILE-CONVERTED         VALUE '6'.
  3983             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3984             88  ERROR-CORRECTION       VALUE 'E'.
  3985         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3986         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3987         16  CL-BENEFICIARY          PIC X(10).
  3988         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3989         16  CL-DENIAL-TYPE          PIC X.
  3990             88  CL-TYPE-DENIAL          VALUE '1'.
  3991             88  CL-TYPE-RESCISSION      VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  78
* EL156.cbl
  3992             88  CL-TYPE-REFORMATION     VALUE '3'.
  3993             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3994             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3995         16  filler                  pic x(5).
  3996*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3997*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3998*        16  CL-RTW-DT               PIC XX.
  3999
  4000     12  CL-TRAILER-CONTROLS.
  4001         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4002             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4003             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4004             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4005         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4006         16  FILLER                  PIC XX.
  4007         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4008         16  CL-ADDRESS-TRAILER-CNT.
  4009             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4010                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4011             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4012                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4013             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4014                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4015             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4016                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4017             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4018                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4019             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4020                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4021             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4022                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4023
  4024     12  CL-CV-REFERENCE-NO.
  4025         16  CL-CV-REFNO-PRIME       PIC X(18).
  4026         16  CL-CV-REFNO-SFX         PIC XX.
  4027
  4028     12  CL-FILE-LOCATION            PIC X(4).
  4029
  4030     12  CL-PROCESS-ERRORS.
  4031         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4032             88  NO-FATAL-ERRORS        VALUE ZERO.
  4033         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4034             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4035
  4036     12  CL-PRODUCT-CD               PIC X.
  4037
  4038     12  CL-CURRENT-KEY-DATA.
  4039         16  CL-CURRENT-CARRIER      PIC X.
  4040         16  CL-CURRENT-GROUPING     PIC X(6).
  4041         16  CL-CURRENT-STATE        PIC XX.
  4042         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4043
  4044     12  CL-ASSOCIATES               PIC X.
  4045         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4046         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4047         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4048         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4049
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  79
* EL156.cbl
  4050     12  CL-ACTIVITY-CODE            PIC 99.
  4051     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4052     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4053
  4054     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4055     12  CL-LAG-REPORT-CODE          PIC 9.
  4056     12  CL-LOAN-TYPE                PIC XX.
  4057     12  CL-LEGAL-STATE              PIC XX.
  4058
  4059     12  CL-YESNOSW                  PIC X.
  4060     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4061         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4062         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4063         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4064     12  cl-insured-type             pic x.
  4065         88  cl-claim-on-primary         value 'P'.
  4066         88  cl-claim-on-co-borrower     value 'C'.
  4067     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  80
* EL156.cbl
  4069*    COPY ELCCNTL.
  4070******************************************************************
  4071*                                                                *
  4072*                                                                *
  4073*                            ELCCNTL.                            *
  4074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4075*                            VMOD=2.059                          *
  4076*                                                                *
  4077*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4078*                                                                *
  4079*   FILE TYPE = VSAM,KSDS                                        *
  4080*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4081*                                                                *
  4082*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4083*       ALTERNATE INDEX = NONE                                   *
  4084*                                                                *
  4085*   LOG = YES                                                    *
  4086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4087******************************************************************
  4088*                   C H A N G E   L O G
  4089*
  4090* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4091*-----------------------------------------------------------------
  4092*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4093* EFFECTIVE    NUMBER
  4094*-----------------------------------------------------------------
  4095* 082503                   PEMA  ADD BENEFIT GROUP
  4096* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4097* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4098* 092705    2005050300006  PEMA  ADD SPP LEASES
  4099* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4100* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4101* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4102* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4103* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4104* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4105* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4106* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4107* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4108* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4109******************************************************************
  4110*
  4111 01  CONTROL-FILE.
  4112     12  CF-RECORD-ID                       PIC XX.
  4113         88  VALID-CF-ID                        VALUE 'CF'.
  4114
  4115     12  CF-CONTROL-PRIMARY.
  4116         16  CF-COMPANY-ID                  PIC XXX.
  4117         16  CF-RECORD-TYPE                 PIC X.
  4118             88  CF-COMPANY-MASTER              VALUE '1'.
  4119             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4120             88  CF-STATE-MASTER                VALUE '3'.
  4121             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4122             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4123             88  CF-CARRIER-MASTER              VALUE '6'.
  4124             88  CF-MORTALITY-MASTER            VALUE '7'.
  4125             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4126             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  81
* EL156.cbl
  4127             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4128             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4129             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4130             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4131             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4132             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4133             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4134             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4135             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4136         16  CF-ACCESS-CD-GENL              PIC X(4).
  4137         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4138             20  CF-PROCESSOR               PIC X(4).
  4139         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4140             20  CF-STATE-CODE              PIC XX.
  4141             20  FILLER                     PIC XX.
  4142         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4143             20  FILLER                     PIC XX.
  4144             20  CF-HI-BEN-IN-REC           PIC XX.
  4145         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4146             20  FILLER                     PIC XXX.
  4147             20  CF-CARRIER-CNTL            PIC X.
  4148         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4149             20  FILLER                     PIC XX.
  4150             20  CF-HI-TYPE-IN-REC          PIC 99.
  4151         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4152             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4153                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4154             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4155             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4156         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4157             20  FILLER                     PIC X.
  4158             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4159         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4160             20  FILLER                     PIC XX.
  4161             20  CF-MORTGAGE-PLAN           PIC XX.
  4162         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4163
  4164     12  CF-LAST-MAINT-DT                   PIC XX.
  4165     12  CF-LAST-MAINT-BY                   PIC X(4).
  4166     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4167
  4168     12  CF-RECORD-BODY                     PIC X(728).
  4169
  4170
  4171****************************************************************
  4172*             COMPANY MASTER RECORD                            *
  4173****************************************************************
  4174
  4175     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4176         16  CF-COMPANY-ADDRESS.
  4177             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4178             20  CF-CL-IN-CARE-OF           PIC X(30).
  4179             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4180             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4181             20  CF-CL-CITY-STATE           PIC X(30).
  4182             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4183             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4184         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  82
* EL156.cbl
  4185         16  CF-COMPANY-PASSWORD            PIC X(8).
  4186         16  CF-SECURITY-OPTION             PIC X.
  4187             88  ALL-SECURITY                   VALUE '1'.
  4188             88  COMPANY-VERIFY                 VALUE '2'.
  4189             88  PROCESSOR-VERIFY               VALUE '3'.
  4190             88  NO-SECURITY                    VALUE '4'.
  4191             88  ALL-BUT-TERM                   VALUE '5'.
  4192         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4193             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4194         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4195             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4196         16  CF-INFORCE-LOCATION            PIC X.
  4197             88  CERTS-ARE-ONLINE               VALUE '1'.
  4198             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4199             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4200         16  CF-LOWER-CASE-LETTERS          PIC X.
  4201         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4202             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4203             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4204             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4205             88  CF-ACCNT-CNTL                  VALUE '3'.
  4206             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4207
  4208         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4209         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4210
  4211         16  CF-LGX-CREDIT-USER             PIC X.
  4212             88  CO-IS-NOT-USER                 VALUE 'N'.
  4213             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4214
  4215         16 CF-CREDIT-CALC-CODES.
  4216             20  CF-CR-REM-TERM-CALC PIC X.
  4217               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4218               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4219               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4220               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4221               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4222               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4223               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4224             20  CF-CR-R78-METHOD           PIC X.
  4225               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4226               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4227
  4228         16  CF-CLAIM-CONTROL-COUNTS.
  4229             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4230                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4231
  4232             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4233                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4234
  4235             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4236                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4237
  4238             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4239                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4240
  4241         16  CF-CURRENT-MONTH-END           PIC XX.
  4242
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  83
* EL156.cbl
  4243         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4244             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4245             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4246             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4247             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4248                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4249                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4250             20  CF-CO-PREM-REJECT-SW       PIC X.
  4251                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4252                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4253             20  CF-CO-REF-REJECT-SW        PIC X.
  4254                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4255                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4256
  4257         16  CF-CO-REPORTING-DT             PIC XX.
  4258         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4259         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4260           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4261           88  CF-CO-MONTH-END                  VALUE '1'.
  4262
  4263         16  CF-LGX-CLAIM-USER              PIC X.
  4264             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4265             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4266
  4267         16  CF-CREDIT-EDIT-CONTROLS.
  4268             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4269             20  CF-MIN-AGE                 PIC 99.
  4270             20  CF-DEFAULT-AGE             PIC 99.
  4271             20  CF-MIN-TERM                PIC S999      COMP-3.
  4272             20  CF-MAX-TERM                PIC S999      COMP-3.
  4273             20  CF-DEFAULT-SEX             PIC X.
  4274             20  CF-JOINT-AGE-INPUT         PIC X.
  4275                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4276             20  CF-BIRTH-DATE-INPUT        PIC X.
  4277                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4278             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4279                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4280                 88  CF-ZERO-CARRIER            VALUE '1'.
  4281                 88  CF-ZERO-GROUPING           VALUE '2'.
  4282                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4283             20  CF-EDIT-SW                 PIC X.
  4284                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4285             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4286             20  CF-CR-PR-METHOD            PIC X.
  4287               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4288               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4289             20  FILLER                     PIC X.
  4290
  4291         16  CF-CREDIT-MISC-CONTROLS.
  4292             20  CF-REIN-TABLE-SW           PIC X.
  4293                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4294             20  CF-COMP-TABLE-SW           PIC X.
  4295                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4296             20  CF-EXPERIENCE-RETENTION-AGE
  4297                                            PIC S9        COMP-3.
  4298             20  CF-CONVERSION-DT           PIC XX.
  4299             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4300             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  84
* EL156.cbl
  4301                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4302                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4303
  4304             20  CF-CR-CHECK-NO-CONTROL.
  4305                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4306                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4307                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4308                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4309                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4310                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4311
  4312                 24  CF-CR-CHECK-COUNT       REDEFINES
  4313                     CF-CR-CHECK-COUNTER      PIC X(4).
  4314
  4315                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4316                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4317
  4318                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4319                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4320                 24  CF-MAIL-PROCESSING       PIC X.
  4321                     88  MAIL-PROCESSING          VALUE 'Y'.
  4322
  4323         16  CF-MISC-SYSTEM-CONTROL.
  4324             20  CF-SYSTEM-C                 PIC X.
  4325                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4326             20  CF-SYSTEM-D                 PIC X.
  4327                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4328             20  CF-SOC-SEC-NO-SW            PIC X.
  4329                 88  SOC-SEC-NO-USED             VALUE '1'.
  4330             20  CF-MEMBER-NO-SW             PIC X.
  4331                 88  MEMBER-NO-USED              VALUE '1'.
  4332             20  CF-TAX-ID-NUMBER            PIC X(11).
  4333             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4334             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4335                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4336                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4337                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4338                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4339             20  CF-SYSTEM-E                 PIC X.
  4340                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4341
  4342         16  CF-LGX-LIFE-USER               PIC X.
  4343             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4344             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4345
  4346         16  CF-CR-MONTH-END-DT             PIC XX.
  4347
  4348         16  CF-FILE-MAINT-DATES.
  4349             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4350                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4351             20  CF-LAST-BATCH       REDEFINES
  4352                 CF-LAST-BATCH-NO               PIC X(4).
  4353             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4354             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4355             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4356             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4357             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4358             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  85
* EL156.cbl
  4359             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4360             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4361             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4362             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4363
  4364         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4365         16  FILLER                         PIC X.
  4366
  4367         16  CF-ALT-MORT-CODE               PIC X(4).
  4368         16  CF-MEMBER-CAPTION              PIC X(10).
  4369
  4370         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4371             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4372             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4373             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4374             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4375             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4376
  4377         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4378
  4379         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4380         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4381         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4382         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4383
  4384         16  CF-AH-OVERRIDE-L1              PIC X.
  4385         16  CF-AH-OVERRIDE-L2              PIC XX.
  4386         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4387         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4388
  4389         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4390         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4391
  4392         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4393         16  CF-AR-LAST-EL860-DT            PIC XX.
  4394         16  CF-MP-MONTH-END-DT             PIC XX.
  4395
  4396         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4397         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4398             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4399
  4400         16  CF-AR-MONTH-END-DT             PIC XX.
  4401
  4402         16  CF-CRDTCRD-USER                PIC X.
  4403             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4404             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4405
  4406         16  CF-CC-MONTH-END-DT             PIC XX.
  4407
  4408         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4409
  4410         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4411             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4412             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4413             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4414         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4415         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4416         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  86
* EL156.cbl
  4417         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4418             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4419             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4420         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4421         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4422         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4423             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4424         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4425
  4426         16  CF-CL-ZIP-CODE.
  4427             20  CF-CL-ZIP-PRIME.
  4428                 24  CF-CL-ZIP-1ST          PIC X.
  4429                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4430                 24  FILLER                 PIC X(4).
  4431             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4432         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4433             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4434             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4435             20  FILLER                     PIC XXX.
  4436
  4437         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4438         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4439         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4440         16  CF-CO-OPTION-START-DATE        PIC XX.
  4441         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4442           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4443                                                      '3' '4'.
  4444           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4445           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4446           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4447           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4448           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4449           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4450
  4451         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4452
  4453         16  CF-PAYMENT-APPROVAL-LEVELS.
  4454             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4455             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4456             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4457             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4458             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4459             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4460
  4461         16  CF-END-USER-REPORTING-USER     PIC X.
  4462             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4463             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4464
  4465         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4466             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4467             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4468
  4469         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4470
  4471         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4472         16  FILLER                         PIC X.
  4473
  4474         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  87
* EL156.cbl
  4475             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4476             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4477             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4478
  4479         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4480
  4481         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4482             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4483             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4484
  4485         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4486             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4487             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4488
  4489         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4490
  4491         16  CF-CO-ACH-ID-CODE              PIC  X.
  4492             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4493             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4494             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4495         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4496         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4497         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4498         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4499         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4500         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4501         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4502         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4503         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4504                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4505         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4506                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4507
  4508         16  CF-CO-OVER-SHORT.
  4509             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4510             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4511
  4512*         16  FILLER                         PIC X(102).
  4513         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4514             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4515             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4516
  4517         16  CF-AH-APPROVAL-DAYS.
  4518             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4519             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4520             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4521             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4522
  4523         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4524
  4525         16  CF-APPROV-LEV-5.
  4526             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4527             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4528             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4529
  4530         16  FILLER                         PIC X(68).
  4531****************************************************************
  4532*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  88
* EL156.cbl
  4533****************************************************************
  4534
  4535     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4536         16  CF-PROCESSOR-NAME              PIC X(30).
  4537         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4538         16  CF-PROCESSOR-TITLE             PIC X(26).
  4539         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4540                 88  MESSAGE-YES                VALUE 'Y'.
  4541                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4542
  4543*****************************************************
  4544****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4545****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4546****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4547****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4548*****************************************************
  4549
  4550         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4551             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4552             20  CF-APPLICATION-FORCE       PIC X.
  4553             20  CF-INDIVIDUAL-APP.
  4554                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4555                     28  CF-BROWSE-APP      PIC X.
  4556                     28  CF-UPDATE-APP      PIC X.
  4557
  4558         16  CF-CURRENT-TERM-ON             PIC X(4).
  4559         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4560             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4561             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4562             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4563             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4564             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4565             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4566             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4567         16  CF-PROCESSOR-CARRIER           PIC X.
  4568             88  NO-CARRIER-SECURITY            VALUE ' '.
  4569         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4570             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4571         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4572             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4573         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4574             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4575
  4576         16  CF-PROC-SYS-ACCESS-SW.
  4577             20  CF-PROC-CREDIT-CLAIMS-SW.
  4578                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4579                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4580                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4581                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4582             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4583                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4584                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4585             20  CF-PROC-LIFE-GNRLDGR-SW.
  4586                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4587                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4588                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4589                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4590             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  89
* EL156.cbl
  4591                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4592                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4593         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4594             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4595             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4596         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4597
  4598         16  CF-APPROVAL-LEVEL                  PIC X.
  4599             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4600             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4601             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4602             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4603             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4604
  4605         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4606
  4607         16  CF-LANGUAGE-TYPE                   PIC X.
  4608             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4609             88  CF-LANG-IS-FR                      VALUE 'F'.
  4610
  4611         16  CF-CSR-IND                         PIC X.
  4612         16  FILLER                             PIC X(239).
  4613
  4614****************************************************************
  4615*             PROCESSOR/REMINDERS RECORD                       *
  4616****************************************************************
  4617
  4618     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4619         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4620             20  CF-START-REMIND-DT         PIC XX.
  4621             20  CF-END-REMIND-DT           PIC XX.
  4622             20  CF-REMINDER-TEXT           PIC X(50).
  4623         16  FILLER                         PIC X(296).
  4624
  4625
  4626****************************************************************
  4627*             STATE MASTER RECORD                              *
  4628****************************************************************
  4629
  4630     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4631         16  CF-STATE-ABBREVIATION          PIC XX.
  4632         16  CF-STATE-NAME                  PIC X(25).
  4633         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4634         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4635             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4636             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4637             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4638             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4639                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4640                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4641             20  CF-ST-PREM-REJECT-SW       PIC X.
  4642                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4643                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4644             20  CF-ST-REF-REJECT-SW        PIC X.
  4645                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4646                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4647         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4648         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  90
* EL156.cbl
  4649         16  CF-ST-REFUND-RULES.
  4650             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4651             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4652             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4653         16  CF-ST-FST-PMT-EXTENSION.
  4654             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4655             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4656                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4657                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4658                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4659                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4660         16  CF-ST-STATE-CALL.
  4661             20  CF-ST-CALL-UNEARNED        PIC X.
  4662             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4663             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4664         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4665             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4666             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4667         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4668         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4669         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4670         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4671         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4672         16  FILLER                         PIC X.
  4673         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4674             20  CF-ST-BENEFIT-CD           PIC XX.
  4675             20  CF-ST-BENEFIT-KIND         PIC X.
  4676                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4677                 88  CF-ST-AH-KIND              VALUE 'A'.
  4678             20  CF-ST-REM-TERM-CALC        PIC X.
  4679                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4680                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4681                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4682                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4683                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4684                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4685                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4686                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4687
  4688             20  CF-ST-REFUND-CALC          PIC X.
  4689                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4690                 88  ST-REFD-BY-R78             VALUE '1'.
  4691                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4692                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4693                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4694                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4695                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4696                 88  ST-REFD-UTAH               VALUE '7'.
  4697                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4698                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4699                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4700
  4701             20  CF-ST-EARNING-CALC         PIC X.
  4702                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4703                 88  ST-EARN-BY-R78             VALUE '1'.
  4704                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4705                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4706                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  91
* EL156.cbl
  4707                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4708                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4709                 88  ST-EARN-MEAN               VALUE '8'.
  4710                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4711
  4712             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4713                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4714                 88  ST-OVRD-BY-R78             VALUE '1'.
  4715                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4716                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4717                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4718                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4719                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4720                 88  ST-OVRD-MEAN               VALUE '8'.
  4721                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4722             20  FILLER                     PIC X.
  4723
  4724         16  CF-ST-COMMISSION-CAPS.
  4725             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4726             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4727             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4728             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4729         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4730                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4731
  4732         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4733
  4734         16  CF-ST-STATUTORY-INTEREST.
  4735             20  CF-ST-STAT-DATE-FROM       PIC X.
  4736                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4737                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4738             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4739             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4740             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4741             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4742             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4743
  4744         16  CF-ST-OVER-SHORT.
  4745             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4746             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4747
  4748         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4749
  4750         16  CF-ST-RT-CALC                  PIC X.
  4751
  4752         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4753         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4754         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4755         16  CF-ST-RF-LR-CALC               PIC X.
  4756         16  CF-ST-RF-LL-CALC               PIC X.
  4757         16  CF-ST-RF-LN-CALC               PIC X.
  4758         16  CF-ST-RF-AH-CALC               PIC X.
  4759         16  CF-ST-RF-CP-CALC               PIC X.
  4760*        16  FILLER                         PIC X(206).
  4761*CIDMOD         16  FILLER                         PIC X(192).
  4762         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4763             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4764         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  92
* EL156.cbl
  4765         16  CF-ST-VFY-2ND-BENE             PIC X.
  4766         16  CF-ST-CAUSAL-STATE             PIC X.
  4767         16  FILLER                         PIC X(185).
  4768
  4769****************************************************************
  4770*             BENEFIT MASTER RECORD                            *
  4771****************************************************************
  4772
  4773     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4774         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4775             20  CF-BENEFIT-CODE            PIC XX.
  4776             20  CF-BENEFIT-NUMERIC  REDEFINES
  4777                 CF-BENEFIT-CODE            PIC XX.
  4778             20  CF-BENEFIT-ALPHA           PIC XXX.
  4779             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4780             20  CF-BENEFIT-COMMENT         PIC X(10).
  4781
  4782             20  CF-LF-COVERAGE-TYPE        PIC X.
  4783                 88  CF-REDUCING                VALUE 'R'.
  4784                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4785
  4786             20  CF-SPECIAL-CALC-CD         PIC X.
  4787                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4788                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4789                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4790                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4791                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4792                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4793                 88  CF-FARM-PLAN               VALUE 'F'.
  4794                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4795                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4796                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4797                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4798                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4799                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4800                 88  CF-PRUDENTIAL              VALUE 'P'.
  4801                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4802                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4803                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4804                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4805                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4806                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4807
  4808             20  CF-JOINT-INDICATOR         PIC X.
  4809                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4810
  4811*            20  FILLER                     PIC X(12).
  4812             20  cf-maximum-benefits        pic s999 comp-3.
  4813             20  FILLER                     PIC X(09).
  4814             20  CF-BENEFIT-CATEGORY        PIC X.
  4815             20  CF-LOAN-TYPE               PIC X(8).
  4816
  4817             20  CF-CO-REM-TERM-CALC        PIC X.
  4818                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4819                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4820                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4821                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4822                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  93
* EL156.cbl
  4823
  4824             20  CF-CO-EARNINGS-CALC        PIC X.
  4825                 88  CO-EARN-BY-R78             VALUE '1'.
  4826                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4827                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4828                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4829                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4830                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4831                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4832                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4833
  4834             20  CF-CO-REFUND-CALC          PIC X.
  4835                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4836                 88  CO-REFD-BY-R78             VALUE '1'.
  4837                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4838                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4839                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4840                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4841                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4842                 88  CO-REFD-MEAN               VALUE '8'.
  4843                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4844                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4845                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4846
  4847             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4848                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4849                 88  CO-OVRD-BY-R78             VALUE '1'.
  4850                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4851                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4852                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4853                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4854                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4855                 88  CO-OVRD-MEAN               VALUE '8'.
  4856                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4857
  4858             20  CF-CO-BEN-I-G-CD           PIC X.
  4859                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4860                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4861                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4862
  4863         16  FILLER                         PIC X(304).
  4864
  4865
  4866****************************************************************
  4867*             CARRIER MASTER RECORD                            *
  4868****************************************************************
  4869
  4870     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4871         16  CF-ADDRESS-DATA.
  4872             20  CF-MAIL-TO-NAME            PIC X(30).
  4873             20  CF-IN-CARE-OF              PIC X(30).
  4874             20  CF-ADDRESS-LINE-1          PIC X(30).
  4875             20  CF-ADDRESS-LINE-2          PIC X(30).
  4876             20  CF-CITY-STATE              PIC X(30).
  4877             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4878             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4879
  4880         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  94
* EL156.cbl
  4881             20  CF-CLAIM-NO-METHOD         PIC X.
  4882                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4883                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4884                 88  CLAIM-NO-SEQ               VALUE '3'.
  4885                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4886             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4887                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4888                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4889                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4890
  4891         16  CF-CHECK-NO-CONTROL.
  4892             20  CF-CHECK-NO-METHOD         PIC X.
  4893                 88  CHECK-NO-MANUAL            VALUE '1'.
  4894                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4895                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4896                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4897             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4898                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4899
  4900         16  CF-DOMICILE-STATE              PIC XX.
  4901
  4902         16  CF-EXPENSE-CONTROLS.
  4903             20  CF-EXPENSE-METHOD          PIC X.
  4904                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4905                 88  DOLLARS-PER-PMT            VALUE '2'.
  4906                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4907                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4908             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4909             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4910
  4911         16  CF-CORRESPONDENCE-CONTROL.
  4912             20  CF-LETTER-RESEND-OPT       PIC X.
  4913                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4914                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4915             20  FILLER                     PIC X(4).
  4916
  4917         16  CF-RESERVE-CONTROLS.
  4918             20  CF-MANUAL-SW               PIC X.
  4919                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4920             20  CF-FUTURE-SW               PIC X.
  4921                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4922             20  CF-PTC-SW                  PIC X.
  4923                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4924             20  CF-IBNR-SW                 PIC X.
  4925                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4926             20  CF-PTC-LF-SW               PIC X.
  4927                 88  CF-LF-PTC-USED             VALUE '1'.
  4928             20  CF-CDT-ACCESS-METHOD       PIC X.
  4929                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4930                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4931                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4932             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4933
  4934         16  CF-CLAIM-CALC-METHOD           PIC X.
  4935             88  360-PLUS-MONTHS                VALUE '1'.
  4936             88  365-PLUS-MONTHS                VALUE '2'.
  4937             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4938             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  95
* EL156.cbl
  4939             88  365-DAILY                      VALUE '5'.
  4940
  4941         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4942         16  FILLER                         PIC X(11).
  4943
  4944         16  CF-LIMIT-AMOUNTS.
  4945             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4946             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4947             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4948             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4949             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4950             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4951             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4952             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4953             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4954             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4955
  4956         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4957         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4958         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4959
  4960         16  CF-ZIP-CODE.
  4961             20  CF-ZIP-PRIME.
  4962                 24  CF-ZIP-1ST             PIC X.
  4963                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4964                 24  FILLER                 PIC X(4).
  4965             20  CF-ZIP-PLUS4               PIC X(4).
  4966         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4967             20  CF-CAN-POSTAL-1            PIC XXX.
  4968             20  CF-CAN-POSTAL-2            PIC XXX.
  4969             20  FILLER                     PIC XXX.
  4970
  4971         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4972         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4973         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4974
  4975         16  CF-RATING-SWITCH               PIC X.
  4976             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4977             88  CF-NO-RATING                   VALUE 'N'.
  4978
  4979         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4980
  4981         16  CF-CARRIER-OVER-SHORT.
  4982             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4983             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4984
  4985         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4986         16  CF-SECPAY-SWITCH               PIC X.
  4987             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4988             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4989         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4990         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4991         16  FILLER                         PIC X(444).
  4992*        16  FILLER                         PIC X(452).
  4993
  4994
  4995****************************************************************
  4996*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  96
* EL156.cbl
  4997****************************************************************
  4998
  4999     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5000         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5001                                INDEXED BY CF-MORT-NDX.
  5002             20  CF-MORT-TABLE              PIC X(5).
  5003             20  CF-MORT-TABLE-TYPE         PIC X.
  5004                 88  CF-MORT-JOINT              VALUE 'J'.
  5005                 88  CF-MORT-SINGLE             VALUE 'S'.
  5006                 88  CF-MORT-COMBINED           VALUE 'C'.
  5007                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5008                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5009             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5010             20  CF-MORT-AGE-METHOD         PIC XX.
  5011                 88  CF-AGE-LAST                VALUE 'AL'.
  5012                 88  CF-AGE-NEAR                VALUE 'AN'.
  5013             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5014             20  CF-MORT-ADJUSTMENT-DIRECTION
  5015                                            PIC X.
  5016                 88  CF-MINUS                   VALUE '-'.
  5017                 88  CF-PLUS                    VALUE '+'.
  5018             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5019             20  CF-MORT-JOINT-CODE         PIC X.
  5020                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5021             20  CF-MORT-PC-Q               PIC X.
  5022                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5023             20  CF-MORT-TABLE-CODE         PIC X(4).
  5024             20  CF-MORT-COMMENTS           PIC X(15).
  5025             20  FILLER                     PIC X(14).
  5026
  5027         16  FILLER                         PIC X(251).
  5028
  5029
  5030****************************************************************
  5031*             BUSSINESS TYPE MASTER RECORD                     *
  5032****************************************************************
  5033
  5034     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5035* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5036* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5037* AND RECORD 05 IS TYPES 81-99
  5038         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5039             20  CF-BUSINESS-TITLE          PIC  X(19).
  5040             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5041                                            PIC S9V9(4) COMP-3.
  5042             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5043             20  FILLER                     PIC  X.
  5044         16  FILLER                         PIC  X(248).
  5045
  5046
  5047****************************************************************
  5048*             TERMINAL MASTER RECORD                           *
  5049****************************************************************
  5050
  5051     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5052
  5053         16  CF-COMPANY-TERMINALS.
  5054             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  97
* EL156.cbl
  5055                                  PIC X(4).
  5056         16  FILLER               PIC X(248).
  5057
  5058
  5059****************************************************************
  5060*             LIFE EDIT MASTER RECORD                          *
  5061****************************************************************
  5062
  5063     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5064         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5065             20  CF-LIFE-CODE-IN            PIC XX.
  5066             20  CF-LIFE-CODE-OUT           PIC XX.
  5067         16  FILLER                         PIC X(248).
  5068
  5069
  5070****************************************************************
  5071*             AH EDIT MASTER RECORD                            *
  5072****************************************************************
  5073
  5074     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5075         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5076             20  CF-AH-CODE-IN              PIC XXX.
  5077             20  CF-AH-CODE-OUT             PIC XX.
  5078         16  FILLER                         PIC X(248).
  5079
  5080
  5081****************************************************************
  5082*             CREDIBILITY TABLES                               *
  5083****************************************************************
  5084
  5085     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5086         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5087                             INDEXED BY CF-CRDB-NDX.
  5088             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5089             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5090             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5091         16  FILLER                         PIC  X(332).
  5092
  5093
  5094****************************************************************
  5095*             REPORT CUSTOMIZATION RECORD                      *
  5096****************************************************************
  5097
  5098     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5099         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5100             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5101             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5102             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5103**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5104****       A T-TRANSFER.                                   ****
  5105             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5106
  5107         16  FILLER                         PIC XX.
  5108
  5109         16  CF-CARRIER-CNTL-OPT.
  5110             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5111                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5112                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  98
* EL156.cbl
  5113             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5114                                            PIC X.
  5115         16  CF-GROUP-CNTL-OPT.
  5116             20  CF-GROUP-OPT-SEQ           PIC 9.
  5117                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5118                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5119             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5120                                            PIC X(6).
  5121         16  CF-STATE-CNTL-OPT.
  5122             20  CF-STATE-OPT-SEQ           PIC 9.
  5123                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5124                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5125             20  CF-STATE-SELECT OCCURS 3 TIMES
  5126                                            PIC XX.
  5127         16  CF-ACCOUNT-CNTL-OPT.
  5128             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5129                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5130                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5131             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5132                                            PIC X(10).
  5133         16  CF-BUS-TYP-CNTL-OPT.
  5134             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5135                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5136                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5137             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5138                                            PIC XX.
  5139         16  CF-LF-TYP-CNTL-OPT.
  5140             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5141                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5142                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5143             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5144                                            PIC XX.
  5145         16  CF-AH-TYP-CNTL-OPT.
  5146             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5147                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5148                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5149             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5150                                            PIC XX.
  5151         16  CF-REPTCD1-CNTL-OPT.
  5152             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5153                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5154                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5155             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5156                                            PIC X(10).
  5157         16  CF-REPTCD2-CNTL-OPT.
  5158             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5159                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5160                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5161             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5162                                            PIC X(10).
  5163         16  CF-USER1-CNTL-OPT.
  5164             20  CF-USER1-OPT-SEQ           PIC 9.
  5165                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5166                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5167             20  CF-USER1-SELECT OCCURS 3 TIMES
  5168                                            PIC X(10).
  5169         16  CF-USER2-CNTL-OPT.
  5170             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page  99
* EL156.cbl
  5171                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5172                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5173             20  CF-USER2-SELECT OCCURS 3 TIMES
  5174                                            PIC X(10).
  5175         16  CF-USER3-CNTL-OPT.
  5176             20  CF-USER3-OPT-SEQ           PIC 9.
  5177                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5178                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5179             20  CF-USER3-SELECT OCCURS 3 TIMES
  5180                                            PIC X(10).
  5181         16  CF-USER4-CNTL-OPT.
  5182             20  CF-USER4-OPT-SEQ           PIC 9.
  5183                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5184                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5185             20  CF-USER4-SELECT OCCURS 3 TIMES
  5186                                            PIC X(10).
  5187         16  CF-USER5-CNTL-OPT.
  5188             20  CF-USER5-OPT-SEQ           PIC 9.
  5189                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5190                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5191             20  CF-USER5-SELECT OCCURS 3 TIMES
  5192                                            PIC X(10).
  5193         16  CF-REINS-CNTL-OPT.
  5194             20  CF-REINS-OPT-SEQ           PIC 9.
  5195                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5196                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5197             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5198                 24  CF-REINS-PRIME         PIC XXX.
  5199                 24  CF-REINS-SUB           PIC XXX.
  5200
  5201         16  CF-AGENT-CNTL-OPT.
  5202             20  CF-AGENT-OPT-SEQ           PIC 9.
  5203                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5204                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5205             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5206                                            PIC X(10).
  5207
  5208         16  FILLER                         PIC X(43).
  5209
  5210         16  CF-LOSS-RATIO-SELECT.
  5211             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5212             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5213         16  CF-ENTRY-DATE-SELECT.
  5214             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5215             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5216         16  CF-EFFECTIVE-DATE-SELECT.
  5217             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5218             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5219
  5220         16  CF-EXCEPTION-LIST-IND          PIC X.
  5221             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5222
  5223         16  FILLER                         PIC X(318).
  5224
  5225****************************************************************
  5226*                  EXCEPTION REPORTING RECORD                  *
  5227****************************************************************
  5228
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 100
* EL156.cbl
  5229     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5230         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5231             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5232
  5233         16  CF-COMBINED-LIFE-AH-OPT.
  5234             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5235             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5236             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5237             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5238
  5239         16  CF-LIFE-OPT.
  5240             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5241             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5242             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5243             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5244             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5245             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5246             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5247             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5248             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5249             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5250
  5251         16  CF-AH-OPT.
  5252             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5253             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5254             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5255             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5256             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5257             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5258             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5259             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5260             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5261             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5262
  5263         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5264             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5265             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5266             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5267
  5268         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5269
  5270         16  FILLER                         PIC X(673).
  5271
  5272
  5273****************************************************************
  5274*             MORTGAGE SYSTEM PLAN RECORD                      *
  5275****************************************************************
  5276
  5277     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5278         16  CF-PLAN-TYPE                   PIC X.
  5279             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5280             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5281             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5282         16  CF-PLAN-ABBREV                 PIC XXX.
  5283         16  CF-PLAN-DESCRIPT               PIC X(10).
  5284         16  CF-PLAN-NOTES                  PIC X(20).
  5285         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5286         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 101
* EL156.cbl
  5287             20  CF-PLAN-TERM-DATA.
  5288                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5289                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5290             20  CF-PLAN-AGE-DATA.
  5291                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5292                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5293                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5294             20  CF-PLAN-BENEFIT-DATA.
  5295                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5296                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5297                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5298                                            PIC S9(7)V99  COMP-3.
  5299         16  CF-PLAN-POLICY-FORMS.
  5300             20  CF-POLICY-FORM             PIC X(12).
  5301             20  CF-MASTER-APPLICATION      PIC X(12).
  5302             20  CF-MASTER-POLICY           PIC X(12).
  5303         16  CF-PLAN-RATING.
  5304             20  CF-RATE-CODE               PIC X(5).
  5305             20  CF-SEX-RATING              PIC X.
  5306                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5307                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5308             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5309             20  CF-SUB-STD-TYPE            PIC X.
  5310                 88  CF-PCT-OF-PREM            VALUE '1'.
  5311                 88  CF-PCT-OF-BENE            VALUE '2'.
  5312         16  CF-PLAN-PREM-TOLERANCES.
  5313             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5314             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5315         16  CF-PLAN-PYMT-TOLERANCES.
  5316             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5317             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5318         16  CF-PLAN-MISC-DATA.
  5319             20  FILLER                     PIC X.
  5320             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5321             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5322         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5323         16  CF-PLAN-IND-GRP                PIC X.
  5324             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5325                                                     '1'.
  5326             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5327                                                     '2'.
  5328         16  CF-MIB-SEARCH-SW               PIC X.
  5329             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5330             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5331             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5332             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5333         16  CF-ALPHA-SEARCH-SW             PIC X.
  5334             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5335             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5336             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5337             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5338             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5339             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5340             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5341             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5342             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5343             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5344                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 102
* EL156.cbl
  5345                                                     'X' 'Y' 'Z'.
  5346         16  CF-EFF-DT-RULE-SW              PIC X.
  5347             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5348             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5349             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5350             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5351             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5352         16  FILLER                         PIC X(4).
  5353         16  CF-HEALTH-QUESTIONS            PIC X.
  5354             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5355         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5356         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5357         16  CF-PLAN-SNGL-JNT               PIC X.
  5358             88  CF-COMBINED-PLAN              VALUE 'C'.
  5359             88  CF-JNT-PLAN                   VALUE 'J'.
  5360             88  CF-SNGL-PLAN                  VALUE 'S'.
  5361         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5362         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5363         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5364         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5365         16  CF-RERATE-CNTL                 PIC  X.
  5366             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5367             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5368             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5369             88  CF-AUTO-RECALC                 VALUE '4'.
  5370         16  CF-BENEFIT-TYPE                PIC  X.
  5371             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5372             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5373         16  CF-POLICY-FEE                  PIC S999V99
  5374                                                    COMP-3.
  5375         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5376         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5377         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5378         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5379         16  FILLER                         PIC  X(32).
  5380         16  CF-TERMINATION-FORM            PIC  X(04).
  5381         16  FILLER                         PIC  X(08).
  5382         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5383                                                       COMP-3.
  5384         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5385         16  CF-ISSUE-LETTER                PIC  X(4).
  5386         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5387         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5388             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5389             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5390         16  CF-MP-REFUND-CALC              PIC X.
  5391             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5392             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5393             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5394             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5395             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5396             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5397             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5398             88  CF-MP-REFD-MEAN                VALUE '8'.
  5399         16  CF-ALT-RATE-CODE               PIC  X(5).
  5400
  5401
  5402         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 103
* EL156.cbl
  5403****************************************************************
  5404*             MORTGAGE COMPANY MASTER RECORD                   *
  5405****************************************************************
  5406
  5407     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5408         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5409         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5410             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5411             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5412             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5413             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5414             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5415
  5416         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5417         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5418         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5419         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5420         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5421
  5422         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5423             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5424         16  CF-MP-RECON-USE-IND            PIC X(1).
  5425             88  CF-MP-USE-RECON             VALUE 'Y'.
  5426         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5427             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5428         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5429             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5430             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5431         16  FILLER                         PIC X(1).
  5432         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5433             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5434         16  CF-MORTG-MIB-VERSION           PIC X.
  5435             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5436             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5437             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5438         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5439             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5440                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5441             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5442                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5443             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5444                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5445             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5446                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5447             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5448                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5449             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5450                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5451         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5452         16  FILLER                         PIC X(7).
  5453         16  CF-MORTG-DESTINATION-SYMBOL.
  5454             20  CF-MORTG-MIB-COMM          PIC X(5).
  5455             20  CF-MORTG-MIB-TERM          PIC X(5).
  5456         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5457             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5458         16  FILLER                         PIC X(03).
  5459         16  CF-MP-CHECK-NO-CONTROL.
  5460             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 104
* EL156.cbl
  5461                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5462                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5463                                                ' ' LOW-VALUES.
  5464                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5465                                               VALUE '3'.
  5466         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5467         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5468         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5469             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5470                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5471             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5472                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5473             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5474                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5475             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5476                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5477             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5478                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5479             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5480                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5481         16  CF-MORTG-BILLING-AREA.
  5482             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5483                                            PIC X.
  5484         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5485         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5486         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5487         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5488             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5489             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5490         16  FILLER                         PIC X.
  5491         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5492             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5493             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5494         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5495         16  FILLER                         PIC X(8).
  5496         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5497         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5498         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5499         16  CF-ACH-COMPANY-ID.
  5500             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5501                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5502                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5503                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5504             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5505         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5506             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5507         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5508             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5509             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5510         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5511         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5512         16  FILLER                         PIC X(536).
  5513
  5514****************************************************************
  5515*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5516****************************************************************
  5517
  5518     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 105
* EL156.cbl
  5519         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5520             20  CF-FEMALE-HEIGHT.
  5521                 24  CF-FEMALE-FT           PIC 99.
  5522                 24  CF-FEMALE-IN           PIC 99.
  5523             20  CF-FEMALE-MIN-WT           PIC 999.
  5524             20  CF-FEMALE-MAX-WT           PIC 999.
  5525         16  FILLER                         PIC X(428).
  5526
  5527     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5528         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5529             20  CF-MALE-HEIGHT.
  5530                 24  CF-MALE-FT             PIC 99.
  5531                 24  CF-MALE-IN             PIC 99.
  5532             20  CF-MALE-MIN-WT             PIC 999.
  5533             20  CF-MALE-MAX-WT             PIC 999.
  5534         16  FILLER                         PIC X(428).
  5535******************************************************************
  5536*             AUTOMATIC ACTIVITY RECORD                          *
  5537******************************************************************
  5538     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5539         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5540             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5541             20  CF-SYS-LETTER-ID           PIC X(04).
  5542             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5543             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5544             20  CF-SYS-RESET-SW            PIC X(01).
  5545             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5546             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5547
  5548         16  FILLER                         PIC X(50).
  5549
  5550         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5551             20  CF-USER-ACTIVE-SW          PIC X(01).
  5552             20  CF-USER-LETTER-ID          PIC X(04).
  5553             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5554             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5555             20  CF-USER-RESET-SW           PIC X(01).
  5556             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5557             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5558             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5559
  5560         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 106
* EL156.cbl
  5562*    COPY ELCCERT.
  5563******************************************************************
  5564*                                                                *
  5565*                            ELCCERT.                            *
  5566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5567*                            VMOD=2.013                          *
  5568*                                                                *
  5569*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5570*                                                                *
  5571*   FILE TYPE = VSAM,KSDS                                        *
  5572*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5573*                                                                *
  5574*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5575*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5576*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5577*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5578*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5579*                                                                *
  5580*   LOG = YES                                                    *
  5581*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5582******************************************************************
  5583*                   C H A N G E   L O G
  5584*
  5585* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5586*-----------------------------------------------------------------
  5587*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5588* EFFECTIVE    NUMBER
  5589*-----------------------------------------------------------------
  5590* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5591* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5592* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5593* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5594* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5595* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5596* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5597* 032612  CR2011110200001  PEMA  AHL CHANGES
  5598******************************************************************
  5599
  5600 01  CERTIFICATE-MASTER.
  5601     12  CM-RECORD-ID                      PIC XX.
  5602         88  VALID-CM-ID                      VALUE 'CM'.
  5603
  5604     12  CM-CONTROL-PRIMARY.
  5605         16  CM-COMPANY-CD                 PIC X.
  5606         16  CM-CARRIER                    PIC X.
  5607         16  CM-GROUPING.
  5608             20  CM-GROUPING-PREFIX        PIC X(3).
  5609             20  CM-GROUPING-PRIME         PIC X(3).
  5610         16  CM-STATE                      PIC XX.
  5611         16  CM-ACCOUNT.
  5612             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5613             20  CM-ACCOUNT-PRIME          PIC X(6).
  5614         16  CM-CERT-EFF-DT                PIC XX.
  5615         16  CM-CERT-NO.
  5616             20  CM-CERT-PRIME             PIC X(10).
  5617             20  CM-CERT-SFX               PIC X.
  5618
  5619     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 107
* EL156.cbl
  5620         16  CM-COMPANY-CD-A1              PIC X.
  5621         16  CM-INSURED-LAST-NAME          PIC X(15).
  5622         16  CM-INSURED-INITIALS.
  5623             20  CM-INSURED-INITIAL1       PIC X.
  5624             20  CM-INSURED-INITIAL2       PIC X.
  5625
  5626     12  CM-CONTROL-BY-SSN.
  5627         16  CM-COMPANY-CD-A2              PIC X.
  5628         16  CM-SOC-SEC-NO.
  5629             20  CM-SSN-STATE              PIC XX.
  5630             20  CM-SSN-ACCOUNT            PIC X(6).
  5631             20  CM-SSN-LN3.
  5632                 25  CM-INSURED-INITIALS-A2.
  5633                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5634                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5635                 25 CM-PART-LAST-NAME-A2         PIC X.
  5636
  5637     12  CM-CONTROL-BY-CERT-NO.
  5638         16  CM-COMPANY-CD-A4              PIC X.
  5639         16  CM-CERT-NO-A4                 PIC X(11).
  5640
  5641     12  CM-CONTROL-BY-MEMB.
  5642         16  CM-COMPANY-CD-A5              PIC X.
  5643         16  CM-MEMBER-NO.
  5644             20  CM-MEMB-STATE             PIC XX.
  5645             20  CM-MEMB-ACCOUNT           PIC X(6).
  5646             20  CM-MEMB-LN4.
  5647                 25  CM-INSURED-INITIALS-A5.
  5648                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5649                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5650                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5651
  5652     12  CM-INSURED-PROFILE-DATA.
  5653         16  CM-INSURED-FIRST-NAME.
  5654             20  CM-INSURED-1ST-INIT       PIC X.
  5655             20  FILLER                    PIC X(9).
  5656         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5657         16  CM-INSURED-SEX                PIC X.
  5658             88  CM-SEX-MALE                  VALUE 'M'.
  5659             88  CM-SEX-FEMAL                 VALUE 'F'.
  5660         16  CM-INSURED-JOINT-AGE          PIC 99.
  5661         16  CM-JOINT-INSURED-NAME.
  5662             20  CM-JT-LAST-NAME           PIC X(15).
  5663             20  CM-JT-FIRST-NAME.
  5664                 24  CM-JT-1ST-INIT        PIC X.
  5665                 24  FILLER                PIC X(9).
  5666             20  CM-JT-INITIAL             PIC X.
  5667
  5668     12  CM-LIFE-DATA.
  5669         16  CM-LF-BENEFIT-CD              PIC XX.
  5670         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5671         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5672         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5673         16  CM-LF-DEV-CODE                PIC XXX.
  5674         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5675         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5676         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5677         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 108
* EL156.cbl
  5678         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5679         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5680         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5681         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5682         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5683         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5684         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5685         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5686         16  FILLER                        PIC XX.
  5687
  5688     12  CM-AH-DATA.
  5689         16  CM-AH-BENEFIT-CD              PIC XX.
  5690         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5691         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5692         16  CM-AH-DEV-CODE                PIC XXX.
  5693         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5694         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5695         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5696         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5697         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5698         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5699         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5700         16  CM-AH-PAID-THRU-DT            PIC XX.
  5701             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5702         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5703         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5704         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5705         16  FILLER                        PIC X.
  5706
  5707     12  CM-LOAN-INFORMATION.
  5708         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5709         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5710                                           PIC S9(5)V99  COMP-3.
  5711         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5712         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5713         16  CM-PAY-FREQUENCY              PIC S99.
  5714         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5715         16  CM-RATE-CLASS                 PIC XX.
  5716         16  CM-BENEFICIARY                PIC X(25).
  5717         16  CM-POLICY-FORM-NO             PIC X(12).
  5718         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5719         16  CM-LAST-ADD-ON-DT             PIC XX.
  5720         16  CM-DEDUCTIBLE-AMOUNTS.
  5721             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5722             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5723         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5724             20  CM-RESIDENT-STATE         PIC XX.
  5725             20  CM-RATE-CODE              PIC X(4).
  5726             20  FILLER                    PIC XX.
  5727         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5728             20  CM-LOAN-OFFICER           PIC X(5).
  5729             20  FILLER                    PIC XXX.
  5730         16  CM-CSR-CODE                   PIC XXX.
  5731         16  CM-UNDERWRITING-CODE          PIC X.
  5732             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5733         16  CM-POST-CARD-IND              PIC X.
  5734         16  CM-NH-INTERFACE-SW            PIC X.
  5735         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 109
* EL156.cbl
  5736             88  CM-SING-PRM                  VALUE '1'.
  5737             88  CM-O-B-COVERAGE              VALUE '2'.
  5738             88  CM-OPEN-END                  VALUE '3'.
  5739         16  CM-IND-GRP-TYPE               PIC X.
  5740             88  CM-INDIVIDUAL                VALUE 'I'.
  5741             88  CM-GROUP                     VALUE 'G'.
  5742         16  CM-SKIP-CODE                  PIC X.
  5743             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5744             88  SKIP-JULY                    VALUE '1'.
  5745             88  SKIP-AUGUST                  VALUE '2'.
  5746             88  SKIP-SEPTEMBER               VALUE '3'.
  5747             88  SKIP-JULY-AUG                VALUE '4'.
  5748             88  SKIP-AUG-SEPT                VALUE '5'.
  5749             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5750             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5751             88  SKIP-JUNE                    VALUE '8'.
  5752             88  SKIP-JUNE-JULY               VALUE '9'.
  5753             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5754             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5755         16  CM-PAYMENT-MODE               PIC X.
  5756             88  PAY-MONTHLY                  VALUE SPACE.
  5757             88  PAY-WEEKLY                   VALUE '1'.
  5758             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5759             88  PAY-BI-WEEKLY                VALUE '3'.
  5760             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5761         16  CM-LOAN-NUMBER                PIC X(8).
  5762         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5763         16  CM-OLD-LOF                    PIC XXX.
  5764*        16  CM-LOAN-OFFICER               PIC XXX.
  5765         16  CM-REIN-TABLE                 PIC XXX.
  5766         16  CM-SPECIAL-REIN-CODE          PIC X.
  5767         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5768         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5769         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5770
  5771     12  CM-STATUS-DATA.
  5772         16  CM-ENTRY-STATUS               PIC X.
  5773         16  CM-ENTRY-DT                   PIC XX.
  5774
  5775         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5776         16  CM-LF-CANCEL-DT               PIC XX.
  5777         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5778
  5779         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5780         16  CM-LF-DEATH-DT                PIC XX.
  5781         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5782
  5783         16  CM-LF-CURRENT-STATUS          PIC X.
  5784             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5785                                                'M' '4' '5' '9'.
  5786             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5787             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5788             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5789             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5790             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5791             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5792             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5793             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 110
* EL156.cbl
  5794             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5795             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5796             88  CM-LF-DECLINED               VALUE 'D'.
  5797             88  CM-LF-VOIDED                 VALUE 'V'.
  5798
  5799         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5800         16  CM-AH-CANCEL-DT               PIC XX.
  5801         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5802
  5803         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5804         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5805         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5806
  5807         16  CM-AH-CURRENT-STATUS          PIC X.
  5808             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5809                                                'M' '4' '5' '9'.
  5810             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5811             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5812             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5813             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5814             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5815             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5816             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5817             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5818             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5819             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5820             88  CM-AH-DECLINED               VALUE 'D'.
  5821             88  CM-AH-VOIDED                 VALUE 'V'.
  5822
  5823         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5824             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5825             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5826             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5827         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5828
  5829         16  CM-ENTRY-BATCH                PIC X(6).
  5830         16  CM-LF-EXIT-BATCH              PIC X(6).
  5831         16  CM-AH-EXIT-BATCH              PIC X(6).
  5832         16  CM-LAST-MONTH-END             PIC XX.
  5833
  5834     12  CM-NOTE-SW                        PIC X.
  5835         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5836         88  CERT-NOTES-PRESENT               VALUE '1'.
  5837         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5838         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5839         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5840         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5841         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5842         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5843     12  CM-COMP-EXCP-SW                   PIC X.
  5844         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5845         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5846     12  CM-INSURED-ADDRESS-SW             PIC X.
  5847         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5848         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5849
  5850*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5851     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 111
* EL156.cbl
  5852     12  FILLER                            PIC X.
  5853
  5854*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5855     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5856     12  FILLER                            PIC X.
  5857*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5858     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5859
  5860     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5861         88  CERT-ADDED-BATCH                 VALUE ' '.
  5862         88  CERT-ADDED-ONLINE                VALUE '1'.
  5863         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5864         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5865         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5866     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5867         88  CERT-AS-LOADED                   VALUE ' '.
  5868         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5869         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5870         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5871         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5872         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5873         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5874         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5875
  5876     12  CM-ACCOUNT-COMM-PCTS.
  5877         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5878         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5879
  5880     12  CM-USER-FIELD                     PIC X.
  5881     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5882     12  CM-CLP-STATE                      PIC XX.
  5883     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5884     12  CM-USER-RESERVED                  PIC XXX.
  5885     12  FILLER REDEFINES CM-USER-RESERVED.
  5886         16  CM-AH-CLASS-CD                PIC XX.
  5887         16  F                             PIC X.
  5888******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 112
* EL156.cbl
  5890*    COPY ELCTRLR.
  5891******************************************************************
  5892*                                                                *
  5893*                            ELCTRLR.                            *
  5894*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5895*                            VMOD=2.014                          *
  5896*                                                                *
  5897*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5898*                                                                *
  5899*   FILE TYPE = VSAM,KSDS                                        *
  5900*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5901*                                                                *
  5902*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5903*       ALTERNATE INDEX = NONE                                   *
  5904*                                                                *
  5905*   LOG = YES                                                    *
  5906*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5907******************************************************************
  5908*                   C H A N G E   L O G
  5909*
  5910* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5911*-----------------------------------------------------------------
  5912*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5913* EFFECTIVE    NUMBER
  5914*-----------------------------------------------------------------
  5915* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5916* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5917* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5918* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5919* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5920* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5921* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5922* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5923* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5924* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5925* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5926* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5927* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5928* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5929* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5930* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5931* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5932* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5933* 040814    2014030500002  AJRA  ADD ICD CODES
  5934******************************************************************
  5935 01  ACTIVITY-TRAILERS.
  5936     12  AT-RECORD-ID                    PIC XX.
  5937         88  VALID-AT-ID                       VALUE 'AT'.
  5938
  5939     12  AT-CONTROL-PRIMARY.
  5940         16  AT-COMPANY-CD               PIC X.
  5941         16  AT-CARRIER                  PIC X.
  5942         16  AT-CLAIM-NO                 PIC X(7).
  5943         16  AT-CERT-NO.
  5944             20  AT-CERT-PRIME           PIC X(10).
  5945             20  AT-CERT-SFX             PIC X.
  5946         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5947             88  AT-1ST-TRL-AVAIL             VALUE +4095.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 113
* EL156.cbl
  5948             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5949             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5950             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5951             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5952             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5953             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5954             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5955             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5956             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5957             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5958             88  AT-BENEFICIARY-TRL           VALUE +91.
  5959             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5960             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5961             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5962             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5963
  5964     12  AT-TRAILER-TYPE                 PIC X.
  5965         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5966         88  PAYMENT-TR                       VALUE '2'.
  5967         88  AUTO-PAY-TR                      VALUE '3'.
  5968         88  CORRESPONDENCE-TR                VALUE '4'.
  5969         88  ADDRESS-TR                       VALUE '5'.
  5970         88  GENERAL-INFO-TR                  VALUE '6'.
  5971         88  AUTO-PROMPT-TR                   VALUE '7'.
  5972         88  DENIAL-TR                        VALUE '8'.
  5973         88  INCURRED-CHG-TR                  VALUE '9'.
  5974         88  FORM-CONTROL-TR                  VALUE 'A'.
  5975
  5976     12  AT-RECORDED-DT                  PIC XX.
  5977     12  AT-RECORDED-BY                  PIC X(4).
  5978     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5979
  5980     12  AT-TRAILER-BODY                 PIC X(165).
  5981
  5982     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5983         16  AT-RESERVE-CONTROLS.
  5984             20  AT-MANUAL-SW            PIC X.
  5985                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5986             20  AT-FUTURE-SW            PIC X.
  5987                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5988             20  AT-PTC-SW               PIC X.
  5989                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5990             20  AT-IBNR-SW              PIC X.
  5991                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5992             20  AT-PTC-LF-SW            PIC X.
  5993                 88  AT-LF-PTC-USED          VALUE '1'.
  5994             20  AT-CDT-ACCESS-METHOD    PIC X.
  5995                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5996                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5997                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5998             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5999         16  AT-LAST-COMPUTED-DT         PIC XX.
  6000         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6001         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6002         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6003         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6004         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6005         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 114
* EL156.cbl
  6006         16  AT-EXPENSE-CONTROLS.
  6007             20  AT-EXPENSE-METHOD       PIC X.
  6008                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6009                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6010                 88  PERCENT-OF-PMT           VALUE '3'.
  6011                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6012             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6013             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6014         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6015         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6016
  6017         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6018         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6019
  6020*        16  FILLER                      PIC X(53).
  6021         16  FILLER                      PIC X(47).
  6022
  6023         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6024         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6025
  6026         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6027             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6028             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6029*                    C = CLOSED
  6030*                    O = OPEN
  6031             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6032*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6033
  6034     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6035         16  AT-PAYMENT-TYPE             PIC X.
  6036             88  PARTIAL-PAYMENT                VALUE '1'.
  6037             88  FINAL-PAYMENT                  VALUE '2'.
  6038             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6039             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6040             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6041             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6042             88  VOIDED-PAYMENT                 VALUE '9'.
  6043             88  TRANSFER                       VALUE 'T'.
  6044             88  LIFE-INTEREST                  VALUE 'I'.
  6045
  6046         16  AT-CLAIM-TYPE               PIC X.
  6047             88  PAID-FOR-AH                    VALUE 'A'.
  6048             88  PAID-FOR-LIFE                  VALUE 'L'.
  6049             88  PAID-FOR-IUI                   VALUE 'I'.
  6050             88  PAID-FOR-GAP                   VALUE 'G'.
  6051         16  AT-CLAIM-PREM-TYPE          PIC X.
  6052             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6053             88  AT-O-B-COVERAGE                VALUE '2'.
  6054             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6055         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6056         16  AT-CHECK-NO                 PIC X(7).
  6057         16  AT-PAID-FROM-DT             PIC XX.
  6058         16  AT-PAID-THRU-DT             PIC XX.
  6059         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6060         16  FILLER                      PIC X.
  6061         16  AT-PAYEES-NAME              PIC X(30).
  6062         16  AT-PAYMENT-ORIGIN           PIC X.
  6063             88  ONLINE-MANUAL-PMT              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 115
* EL156.cbl
  6064             88  ONLINE-AUTO-PMT                VALUE '2'.
  6065             88  OFFLINE-PMT                    VALUE '3'.
  6066         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6067         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6068         16  AT-VOID-DATA.
  6069             20  AT-VOID-DT              PIC XX.
  6070*00144       20  AT-VOID-REASON          PIC X(30).
  6071             20  AT-VOID-REASON          PIC X(26).
  6072         16  AT-PMT-APPROVED-BY          PIC X(04).
  6073         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6074         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6075         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6076                                         PIC S99V9(5)  COMP-3.
  6077         16  AT-CREDIT-INTERFACE.
  6078             20  AT-PMT-SELECT-DT        PIC XX.
  6079                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6080             20  AT-PMT-ACCEPT-DT        PIC XX.
  6081                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6082             20  AT-VOID-SELECT-DT       PIC XX.
  6083                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6084             20  AT-VOID-ACCEPT-DT       PIC XX.
  6085                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6086
  6087         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6088                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6089                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6090         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6091
  6092         16  AT-FORCE-CONTROL            PIC X.
  6093             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6094         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6095         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6096         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6097         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6098         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6099         16  AT-BENEFIT-TYPE             PIC X.
  6100
  6101         16  AT-EXPENSE-TYPE             PIC X.
  6102         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6103
  6104         16  AT-PAYEE-TYPE-CD.
  6105             20  AT-PAYEE-TYPE           PIC X.
  6106                 88  INSURED-PAID           VALUE 'I'.
  6107                 88  BENEFICIARY-PAID       VALUE 'B'.
  6108                 88  ACCOUNT-PAID           VALUE 'A'.
  6109                 88  OTHER-1-PAID           VALUE 'O'.
  6110                 88  OTHER-2-PAID           VALUE 'Q'.
  6111                 88  DOCTOR-PAID            VALUE 'P'.
  6112                 88  EMPLOYER-PAID          VALUE 'E'.
  6113             20  AT-PAYEE-SEQ            PIC X.
  6114
  6115         16  AT-CASH-PAYMENT             PIC X.
  6116         16  AT-GROUPED-PAYMENT          PIC X.
  6117         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6118         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6119         16  AT-APPROVED-LEVEL           PIC X.
  6120         16  AT-VOID-TYPE                PIC X.
  6121             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 116
* EL156.cbl
  6122             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6123         16  AT-AIG-UNEMP-IND            PIC X.
  6124             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6125         16  AT-ASSOCIATES               PIC X.
  6126             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6127             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6128
  6129         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6130         16  AT-CV-PMT-CODE              PIC X.
  6131             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6132             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6133             88  FULL-ADD-PAYMENT           VALUE '3'.
  6134             88  HALF-ADD-PAYMENT           VALUE '4'.
  6135             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6136             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6137             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6138             88  ADDL-PAYMENT               VALUE '8'.
  6139
  6140         16  AT-EOB-CODE1                PIC XXX.
  6141         16  AT-EOB-CODE2                PIC XXX.
  6142         16  AT-EOB-CODE3                PIC XXX.
  6143         16  FILLER REDEFINES AT-EOB-CODE3.
  6144             20  AT-PRINT-CLM-FORM       PIC X.
  6145             20  AT-PRINT-SURVEY         PIC X.
  6146             20  AT-SPECIAL-RELEASE      PIC X.
  6147         16  AT-EOB-CODE4                PIC XXX.
  6148         16  FILLER REDEFINES AT-EOB-CODE4.
  6149             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6150             20  FILLER                  PIC X.
  6151         16  AT-EOB-CODE5                PIC XXX.
  6152         16  FILLER REDEFINES AT-EOB-CODE5.
  6153             20  AT-PMT-PROOF-DT         PIC XX.
  6154             20  FILLER                  PIC X.
  6155
  6156         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6157             88  AT-PRINT-EOB            VALUE 'Y'.
  6158
  6159         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6160         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6161
  6162     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6163         16  AT-SCHEDULE-START-DT        PIC XX.
  6164         16  AT-SCHEDULE-END-DT          PIC XX.
  6165         16  AT-TERMINATED-DT            PIC XX.
  6166         16  AT-LAST-PMT-TYPE            PIC X.
  6167             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6168             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6169         16  AT-FIRST-PMT-DATA.
  6170             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6171             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6172             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6173         16  AT-REGULAR-PMT-DATA.
  6174             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6175             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6176             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6177         16  AT-AUTO-PAYEE-CD.
  6178             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6179                 88  INSURED-PAID-AUTO      VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 117
* EL156.cbl
  6180                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6181                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6182                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6183                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6184             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6185         16  AT-AUTO-PAY-DAY             PIC 99.
  6186         16  AT-AUTO-CASH                PIC X.
  6187             88  AT-CASH                      VALUE 'Y'.
  6188             88  AT-NON-CASH                  VALUE 'N'.
  6189*        16  FILLER                      PIC X(129).
  6190         16  AT-AUTO-END-LETTER          PIC X(4).
  6191         16  FILLER                      PIC X(125).
  6192
  6193         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6194         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6195
  6196     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6197         16  AT-LETTER-SENT-DT           PIC XX.
  6198         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6199         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6200         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6201         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6202         16  AT-LETTER-ORIGIN            PIC X.
  6203             88  ONLINE-CREATION              VALUE '1' '3'.
  6204             88  OFFLINE-CREATION             VALUE '2' '4'.
  6205             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6206             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6207         16  AT-STD-LETTER-FORM          PIC X(4).
  6208         16  AT-REASON-TEXT              PIC X(70).
  6209         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6210         16  AT-ADDRESEE-TYPE            PIC X.
  6211              88  INSURED-ADDRESEE            VALUE 'I'.
  6212              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6213              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6214              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6215              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6216              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6217              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6218         16  AT-ADDRESSEE-NAME           PIC X(30).
  6219         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6220         16  AT-RESEND-PRINT-DATE        PIC XX.
  6221         16  AT-CORR-SOL-UNSOL           PIC X.
  6222         16  AT-LETTER-PURGED-DT         PIC XX.
  6223*
  6224*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6225*
  6226         16  AT-CSO-REDEFINITION.
  6227             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6228             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6229             20  AT-LETTER-TO-BENE       PIC X(1).
  6230             20  AT-STOP-LETTER-DT       PIC X(2).
  6231             20  FILLER                  PIC X(19).
  6232*             20  FILLER                  PIC X(27).
  6233             20  AT-CSO-LETTER-STATUS    PIC X.
  6234                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6235                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6236                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6237             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 118
* EL156.cbl
  6238             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6239*
  6240*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6241*
  6242*        16  FILLER                      PIC X(26).
  6243*
  6244*        16  AT-DMD-BSR-CODE             PIC X.
  6245*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6246*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6247*
  6248*        16  AT-DMD-LETTER-STATUS        PIC X.
  6249*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6250*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6251*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6252*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6253*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6254
  6255         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6256         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6257
  6258     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6259         16  AT-ADDRESS-TYPE             PIC X.
  6260             88  INSURED-ADDRESS               VALUE 'I'.
  6261             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6262             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6263             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6264             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6265             88  OTHER-ADDRESS-1               VALUE 'O'.
  6266             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6267         16  AT-MAIL-TO-NAME             PIC X(30).
  6268         16  AT-ADDRESS-LINE-1           PIC X(30).
  6269         16  AT-ADDRESS-LINE-2           PIC X(30).
  6270         16  AT-CITY-STATE.
  6271             20  AT-CITY                 PIC X(28).
  6272             20  AT-STATE                PIC XX.
  6273         16  AT-ZIP.
  6274             20  AT-ZIP-CODE.
  6275                 24  AT-ZIP-1ST          PIC X.
  6276                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6277                 24  FILLER              PIC X(4).
  6278             20  AT-ZIP-PLUS4            PIC X(4).
  6279         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6280             20  AT-CAN-POSTAL-1         PIC XXX.
  6281             20  AT-CAN-POSTAL-2         PIC XXX.
  6282             20  FILLER                  PIC XXX.
  6283         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6284*         16  FILLER                      PIC X(23).
  6285         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6286         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6287         16  FILLER                      PIC X(13).
  6288         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6289         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6290
  6291     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6292         16  AT-INFO-LINE-1              PIC X(60).
  6293         16  FILLER REDEFINES AT-INFO-LINE-1.
  6294             20  AT-NOTE-ERROR-NO OCCURS 15
  6295                                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 119
* EL156.cbl
  6296         16  AT-INFO-LINE-2              PIC X(60).
  6297         16  FILLER REDEFINES AT-INFO-LINE-2.
  6298             20  AT-ICD-CODE-1           PIC X(8).
  6299             20  AT-ICD-CODE-2           PIC X(8).
  6300             20  FILLER                  PIC X(44).
  6301         16  AT-INFO-TRAILER-TYPE        PIC X.
  6302             88  AT-ERRORS-NOTE          VALUE 'E'.
  6303             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6304             88  AT-CALL-NOTE            VALUE 'C'.
  6305             88  AT-MAINT-NOTE           VALUE 'M'.
  6306             88  AT-CERT-CHANGE          VALUE 'X'.
  6307             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6308             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6309             88  AT-CERT-CANCELLED       VALUE 'T'.
  6310         16  AT-CALL-TYPE                PIC X.
  6311             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6312             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6313         16  AT-NOTE-CONTINUATION        PIC X.
  6314             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6315         16  AT-EOB-CODES-EXIST          PIC X.
  6316             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6317         16  FILLER                      PIC X(35).
  6318         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6319         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6320
  6321     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6322         16  AT-PROMPT-LINE-1            PIC X(60).
  6323         16  AT-PROMPT-LINE-2            PIC X(60).
  6324         16  AT-PROMPT-START-DT          PIC XX.
  6325         16  AT-PROMPT-END-DT            PIC XX.
  6326         16  FILLER                      PIC X(35).
  6327         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6328         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6329
  6330     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6331         16  AT-DENIAL-INFO-1            PIC X(60).
  6332         16  AT-DENIAL-INFO-2            PIC X(60).
  6333         16  AT-DENIAL-DT                PIC XX.
  6334         16  AT-RETRACTION-DT            PIC XX.
  6335         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6336*         16  FILLER                      PIC X(31).
  6337         16  AT-DENIAL-PROOF-DT          PIC XX.
  6338         16  FILLER                      PIC X(29).
  6339         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6340         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6341
  6342     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6343         16  AT-OLD-INCURRED-DT          PIC XX.
  6344         16  AT-OLD-REPORTED-DT          PIC XX.
  6345         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6346         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6347         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6348         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6349         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6350         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6351         16  FILLER                      PIC X(26).
  6352         16  AT-OLD-DIAG-CODE            PIC X(6).
  6353         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 120
* EL156.cbl
  6354         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6355         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6356         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6357         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6358         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6359         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6360         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6361         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6362         16  FILLER                      PIC X(9).
  6363         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6364
  6365     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6366         16  AT-FORM-SEND-ON-DT          PIC XX.
  6367         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6368         16  AT-FORM-RE-SEND-DT          PIC XX.
  6369         16  AT-FORM-ANSWERED-DT         PIC XX.
  6370         16  AT-FORM-PRINTED-DT          PIC XX.
  6371         16  AT-FORM-REPRINT-DT          PIC XX.
  6372         16  AT-FORM-TYPE                PIC X.
  6373             88  INITIAL-FORM                  VALUE '1'.
  6374             88  PROGRESS-FORM                 VALUE '2'.
  6375         16  AT-INSTRUCT-LN-1            PIC X(28).
  6376         16  AT-INSTRUCT-LN-2            PIC X(28).
  6377         16  AT-INSTRUCT-LN-3            PIC X(28).
  6378         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6379         16  AT-FORM-ADDRESS             PIC X.
  6380             88  FORM-TO-INSURED              VALUE 'I'.
  6381             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6382             88  FORM-TO-OTHER-1              VALUE 'O'.
  6383             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6384         16  AT-RELATED-1.
  6385             20 AT-REL-CARR-1            PIC X.
  6386             20 AT-REL-CLAIM-1           PIC X(7).
  6387             20 AT-REL-CERT-1            PIC X(11).
  6388         16  AT-RELATED-2.
  6389             20 AT-REL-CARR-2            PIC X.
  6390             20 AT-REL-CLAIM-2           PIC X(7).
  6391             20 AT-REL-CERT-2            PIC X(11).
  6392         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6393         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6394         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6395         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6396         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6397         16  AT-STOP-FORM-DT             PIC X(2).
  6398
  6399         16  FILLER                      PIC X(09).
  6400         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6401         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6402******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 121
* EL156.cbl
  6404*    COPY ELCACTQ.
  6405******************************************************************
  6406*                                                                *
  6407*                            ELCACTQ.                            *
  6408*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6409*                            VMOD=2.004                          *
  6410*                                                                *
  6411*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6412*                                                                *
  6413*   FILE TYPE = VSAM,KSDS                                        *
  6414*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6415*                                                                *
  6416*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6417*       ALTERNATE INDEX = NONE                                   *
  6418*                                                                *
  6419*   LOG = YES                                                    *
  6420*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6421*                                                                *
  6422*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6423******************************************************************
  6424
  6425 01  ACTIVITY-QUE.
  6426     12  AQ-RECORD-ID                PIC XX.
  6427         88  VALID-AQ-ID                VALUE 'AQ'.
  6428
  6429     12  AQ-CONTROL-PRIMARY.
  6430         16  AQ-COMPANY-CD           PIC X.
  6431         16  AQ-CARRIER              PIC X.
  6432         16  AQ-CLAIM-NO             PIC X(7).
  6433         16  AQ-CERT-NO.
  6434             20  AQ-CERT-PRIME       PIC X(10).
  6435             20  AQ-CERT-SFX         PIC X.
  6436
  6437     12  AQ-PENDING-ACTIVITY-FLAGS.
  6438         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6439         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6440             88  PENDING-PAYMENTS       VALUE '1'.
  6441         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6442             88  PENDING-FULL-PRINT     VALUE '1'.
  6443             88  PENDING-PART-PRINT     VALUE '2'.
  6444         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6445             88  PENDING-LETTERS        VALUE '1'.
  6446         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6447             88  PENDING-RESTORE        VALUE 'C'.
  6448             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6449
  6450     12  FILLER                      PIC X(20).
  6451
  6452     12  AQ-RESEND-DATE              PIC XX.
  6453     12  AQ-FOLLOWUP-DATE            PIC XX.
  6454     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6455     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6456     12  AQ-AUTO-LETTER              PIC X(4).
  6457     12  FILLER                      PIC XX.
  6458     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6459*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 122
* EL156.cbl
  6461*    COPY ERCACCT.
  6462******************************************************************
  6463*                                                                *
  6464*                                                                *
  6465*                            ERCACCT                             *
  6466*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6467*                            VMOD=2.031                          *
  6468*                                                                *
  6469*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6470*                                                                *
  6471*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6472*   VSAM ACCOUNT MASTER FILES.                                   *
  6473*                                                                *
  6474*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6475*                                                                *
  6476*   FILE TYPE = VSAM,KSDS                                        *
  6477*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6478*                                                                *
  6479*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6480*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6481*                                                                *
  6482*   LOG = NO                                                     *
  6483*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6484*                                                                *
  6485*                                                                *
  6486******************************************************************
  6487*                   C H A N G E   L O G
  6488*
  6489* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6490*-----------------------------------------------------------------
  6491*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6492* EFFECTIVE    NUMBER
  6493*-----------------------------------------------------------------
  6494* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6495* 092705    2005050300006  PEMA  ADD SPP LEASES
  6496* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6497* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6498* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6499* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6500* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6501******************************************************************
  6502
  6503 01  ACCOUNT-MASTER.
  6504     12  AM-RECORD-ID                      PIC XX.
  6505         88  VALID-AM-ID                      VALUE 'AM'.
  6506
  6507     12  AM-CONTROL-PRIMARY.
  6508         16  AM-COMPANY-CD                 PIC X.
  6509         16  AM-MSTR-CNTRL.
  6510             20  AM-CONTROL-A.
  6511                 24  AM-CARRIER            PIC X.
  6512                 24  AM-GROUPING.
  6513                     28 AM-GROUPING-PREFIX PIC XXX.
  6514                     28 AM-GROUPING-PRIME  PIC XXX.
  6515                 24  AM-STATE              PIC XX.
  6516                 24  AM-ACCOUNT.
  6517                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6518                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 123
* EL156.cbl
  6519             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6520                                           PIC X(19).
  6521             20  AM-CNTRL-B.
  6522                 24  AM-EXPIRATION-DT      PIC XX.
  6523                 24  FILLER                PIC X(4).
  6524             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6525                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6526
  6527     12  AM-CONTROL-BY-VAR-GRP.
  6528         16  AM-COMPANY-CD-A1              PIC X.
  6529         16  AM-VG-CARRIER                 PIC X.
  6530         16  AM-VG-GROUPING                PIC X(6).
  6531         16  AM-VG-STATE                   PIC XX.
  6532         16  AM-VG-ACCOUNT                 PIC X(10).
  6533         16  AM-VG-DATE.
  6534             20  AM-VG-EXPIRATION-DT       PIC XX.
  6535             20  FILLER                    PIC X(4).
  6536         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6537                                           PIC 9(11)      COMP-3.
  6538     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6539         16  FILLER                        PIC X(10).
  6540         16  AM-VG-KEY3.
  6541             20  AM-VG3-ACCOUNT            PIC X(10).
  6542             20  AM-VG3-EXP-DT             PIC XX.
  6543         16  FILLER                        PIC X(4).
  6544     12  AM-MAINT-INFORMATION.
  6545         16  AM-LAST-MAINT-DT              PIC XX.
  6546         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6547         16  AM-LAST-MAINT-USER            PIC X(4).
  6548         16  FILLER                        PIC XX.
  6549
  6550     12  AM-EFFECTIVE-DT                   PIC XX.
  6551     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6552
  6553     12  AM-PREV-DATES  COMP-3.
  6554         16  AM-PREV-EXP-DT                PIC 9(11).
  6555         16  AM-PREV-EFF-DT                PIC 9(11).
  6556
  6557     12  AM-REPORT-CODE-1                  PIC X(10).
  6558     12  AM-REPORT-CODE-2                  PIC X(10).
  6559
  6560     12  AM-CITY-CODE                      PIC X(4).
  6561     12  AM-COUNTY-PARISH                  PIC X(6).
  6562
  6563     12  AM-NAME                           PIC X(30).
  6564     12  AM-PERSON                         PIC X(30).
  6565     12  AM-ADDRS                          PIC X(30).
  6566     12  AM-CITY.
  6567         16  AM-ADDR-CITY                  PIC X(28).
  6568         16  AM-ADDR-STATE                 PIC XX.
  6569     12  AM-ZIP.
  6570         16  AM-ZIP-PRIME.
  6571             20  AM-ZIP-PRI-1ST            PIC X.
  6572                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6573             20  FILLER                    PIC X(4).
  6574         16  AM-ZIP-PLUS4                  PIC X(4).
  6575     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6576         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 124
* EL156.cbl
  6577         16  AM-CAN-POSTAL-2               PIC XXX.
  6578         16  FILLER                        PIC XXX.
  6579     12  AM-TEL-NO.
  6580         16  AM-AREA-CODE                  PIC 999.
  6581         16  AM-TEL-PRE                    PIC 999.
  6582         16  AM-TEL-NBR                    PIC 9(4).
  6583     12  AM-TEL-LOC                        PIC X.
  6584         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6585         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6586
  6587     12  AM-COMM-STRUCTURE.
  6588         16  AM-DEFN-1.
  6589             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6590                 24  AM-AGT.
  6591                     28  AM-AGT-PREFIX     PIC X(4).
  6592                     28  AM-AGT-PRIME      PIC X(6).
  6593                 24  AM-COM-TYP            PIC X.
  6594                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6595                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6596                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6597                 24  AM-RECALC-LV-INDIC    PIC X.
  6598                 24  AM-RETRO-LV-INDIC     PIC X.
  6599                 24  AM-GL-CODES           PIC X.
  6600                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6601                 24  FILLER                PIC X(01).
  6602         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6603             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6604                 24  FILLER                PIC X(11).
  6605                 24  AM-L-COMA             PIC XXX.
  6606                 24  AM-J-COMA             PIC XXX.
  6607                 24  AM-A-COMA             PIC XXX.
  6608                 24  FILLER                PIC X(6).
  6609
  6610     12  AM-COMM-CHANGE-STATUS             PIC X.
  6611         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6612
  6613     12  AM-CSR-CODE                       PIC X(4).
  6614
  6615     12  AM-BILLING-STATUS                 PIC X.
  6616         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6617         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6618     12  AM-AUTO-REFUND-SW                 PIC X.
  6619         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6620         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6621     12  AM-GPCD                           PIC 99.
  6622     12  AM-IG                             PIC X.
  6623         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6624         88  AM-HAS-GROUP                     VALUE '2'.
  6625     12  AM-STATUS                         PIC X.
  6626         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6627         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6628         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6629         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6630         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6631         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6632     12  AM-REMIT-TO                       PIC 99.
  6633     12  AM-ID-NO                          PIC X(11).
  6634
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 125
* EL156.cbl
  6635     12  AM-CAL-TABLE                      PIC XX.
  6636     12  AM-LF-DEVIATION                   PIC XXX.
  6637     12  AM-AH-DEVIATION                   PIC XXX.
  6638     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6639     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6640     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6641     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6642     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6643     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6644
  6645     12  AM-USER-FIELDS.
  6646         16  AM-FLD-1                      PIC XX.
  6647         16  AM-FLD-2                      PIC XX.
  6648         16  AM-FLD-3                      PIC XX.
  6649         16  AM-FLD-4                      PIC XX.
  6650         16  AM-FLD-5                      PIC XX.
  6651
  6652     12  AM-1ST-PROD-DATE.
  6653         16  AM-1ST-PROD-YR                PIC XX.
  6654         16  AM-1ST-PROD-MO                PIC XX.
  6655         16  AM-1ST-PROD-DA                PIC XX.
  6656     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6657     12  AM-CERTS-PURGED-DATE.
  6658         16  AM-PUR-YR                     PIC XX.
  6659         16  AM-PUR-MO                     PIC XX.
  6660         16  AM-PUR-DA                     PIC XX.
  6661     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6662     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6663     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6664     12  AM-INACTIVE-DATE.
  6665         16  AM-INA-MO                     PIC 99.
  6666         16  AM-INA-DA                     PIC 99.
  6667         16  AM-INA-YR                     PIC 99.
  6668     12  AM-AR-HI-CERT-DATE                PIC XX.
  6669
  6670     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6671     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6672
  6673     12  AM-OB-PAYMENT-MODE                PIC X.
  6674         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6675         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6676         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6677         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6678
  6679     12  AM-AH-ONLY-INDICATOR              PIC X.
  6680         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6681         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6682
  6683     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6684
  6685     12  AM-OVER-SHORT.
  6686         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6687         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6688
  6689     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6690     12  AM-DCC-CLP-STATE                  PIC XX.
  6691
  6692     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 126
* EL156.cbl
  6693     12  AM-RECALC-REIN                    PIC X.
  6694
  6695     12  AM-REI-TABLE                      PIC XXX.
  6696     12  AM-REI-ET-LF                      PIC X.
  6697     12  AM-REI-ET-AH                      PIC X.
  6698     12  AM-REI-PE-LF                      PIC X.
  6699     12  AM-REI-PE-AH                      PIC X.
  6700     12  AM-REI-PRT-ST                     PIC X.
  6701     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6702     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6703     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6704     12  AM-REI-GROUP-A                    PIC X(6).
  6705     12  AM-REI-MORT                       PIC X(4).
  6706     12  AM-REI-PRT-OW                     PIC X.
  6707     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6708     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6709     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6710     12  AM-REI-GROUP-B                    PIC X(6).
  6711
  6712     12  AM-TRUST-TYPE                     PIC X(2).
  6713
  6714     12  AM-EMPLOYER-STMT-USED             PIC X.
  6715     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6716
  6717     12  AM-STD-AH-TYPE                    PIC XX.
  6718     12  AM-EARN-METHODS.
  6719         16  AM-EARN-METHOD-R              PIC X.
  6720             88 AM-REF-RL-R78                 VALUE 'R'.
  6721             88 AM-REF-RL-PR                  VALUE 'P'.
  6722             88 AM-REF-RL-MEAN                VALUE 'M'.
  6723             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6724         16  AM-EARN-METHOD-L              PIC X.
  6725             88 AM-REF-LL-R78                 VALUE 'R'.
  6726             88 AM-REF-LL-PR                  VALUE 'P'.
  6727             88 AM-REF-LL-MEAN                VALUE 'M'.
  6728             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6729         16  AM-EARN-METHOD-A              PIC X.
  6730             88 AM-REF-AH-R78                 VALUE 'R'.
  6731             88 AM-REF-AH-PR                  VALUE 'P'.
  6732             88 AM-REF-AH-MEAN                VALUE 'M'.
  6733             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6734             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6735             88 AM-REF-AH-NET                 VALUE 'N'.
  6736
  6737     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6738     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6739     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6740
  6741     12  AM-RET-Y-N                        PIC X.
  6742     12  AM-RET-P-E                        PIC X.
  6743     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6744     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6745     12  AM-RET-GRP                        PIC X(6).
  6746     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6747         16  AM-POOL-PRIME                 PIC XXX.
  6748         16  AM-POOL-SUB                   PIC XXX.
  6749     12  AM-RETRO-EARNINGS.
  6750         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 127
* EL156.cbl
  6751         16  AM-RET-EARN-L                 PIC X.
  6752         16  AM-RET-EARN-A                 PIC X.
  6753     12  AM-RET-ST-TAX-USE                 PIC X.
  6754         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6755         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6756     12  AM-RETRO-BEG-EARNINGS.
  6757         16  AM-RET-BEG-EARN-R             PIC X.
  6758         16  AM-RET-BEG-EARN-L             PIC X.
  6759         16  AM-RET-BEG-EARN-A             PIC X.
  6760     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6761     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6762
  6763     12  AM-USER-SELECT-OPTIONS.
  6764         16  AM-USER-SELECT-1              PIC X(10).
  6765         16  AM-USER-SELECT-2              PIC X(10).
  6766         16  AM-USER-SELECT-3              PIC X(10).
  6767         16  AM-USER-SELECT-4              PIC X(10).
  6768         16  AM-USER-SELECT-5              PIC X(10).
  6769
  6770     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6771
  6772     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6773
  6774     12  AM-RPT045A-SWITCH                 PIC X.
  6775         88  RPT045A-OFF                   VALUE 'N'.
  6776
  6777     12  AM-INSURANCE-LIMITS.
  6778         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6779         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6780
  6781     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6782         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6783
  6784     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6785         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6786         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6787
  6788     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6789
  6790     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6791     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6792     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6793     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6794     12  AM-DCC-UEF-STATE                  PIC XX.
  6795     12  FILLER                            PIC XXX.
  6796     12  AM-REPORT-CODE-3                  PIC X(10).
  6797*    12  FILLER                            PIC X(22).
  6798
  6799     12  AM-RESERVE-DATE.
  6800         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6801         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6802         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6803
  6804     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6805     12  AM-NOTIFICATION-TYPES.
  6806         16  AM-NOTIF-OF-LETTERS           PIC X.
  6807         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6808         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 128
* EL156.cbl
  6809         16  AM-NOTIF-OF-STATUS            PIC X.
  6810
  6811     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6812         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6813         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6814         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6815         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6816
  6817     12  AM-BENEFIT-CONTROLS.
  6818         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6819             20  AM-BENEFIT-CODE           PIC XX.
  6820             20  AM-BENEFIT-TYPE           PIC X.
  6821             20  AM-BENEFIT-REVISION       PIC XXX.
  6822             20  AM-BENEFIT-REM-TERM       PIC X.
  6823             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6824             20  FILLER                    PIC XX.
  6825         16  FILLER                        PIC X(80).
  6826
  6827     12  AM-TRANSFER-DATA.
  6828         16  AM-TRANSFERRED-FROM.
  6829             20  AM-TRNFROM-CARRIER        PIC X.
  6830             20  AM-TRNFROM-GROUPING.
  6831                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6832                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6833             20  AM-TRNFROM-STATE          PIC XX.
  6834             20  AM-TRNFROM-ACCOUNT.
  6835                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6836                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6837             20  AM-TRNFROM-DTE            PIC XX.
  6838         16  AM-TRANSFERRED-TO.
  6839             20  AM-TRNTO-CARRIER          PIC X.
  6840             20  AM-TRNTO-GROUPING.
  6841                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6842                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6843             20  AM-TRNTO-STATE            PIC XX.
  6844             20  AM-TRNTO-ACCOUNT.
  6845                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6846                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6847             20  AM-TRNTO-DTE              PIC XX.
  6848         16  FILLER                        PIC X(10).
  6849
  6850     12  AM-SAVED-REMIT-TO                 PIC 99.
  6851
  6852     12  AM-COMM-STRUCTURE-SAVED.
  6853         16  AM-DEFN-1-SAVED.
  6854             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6855                 24  AM-AGT-SV             PIC X(10).
  6856                 24  AM-COM-TYP-SV         PIC X.
  6857                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6858                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6859                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6860                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6861                 24  FILLER                PIC X.
  6862                 24  AM-GL-CODES-SV        PIC X.
  6863                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6864                 24  FILLER                PIC X.
  6865         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6866             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 129
* EL156.cbl
  6867                 24  FILLER                PIC X(11).
  6868                 24  AM-L-COMA-SV          PIC XXX.
  6869                 24  AM-J-COMA-SV          PIC XXX.
  6870                 24  AM-A-COMA-SV          PIC XXX.
  6871                 24  FILLER                PIC X(6).
  6872
  6873     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6874         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6875            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6876            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6877            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6878
  6879     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6880     12  FILLER                            PIC X(120).
  6881
  6882     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6883         16  AM-CONTROL-NAME               PIC X(30).
  6884         16  AM-EXECUTIVE-ONE.
  6885             20  AM-EXEC1-NAME             PIC X(15).
  6886             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6887                                                          COMP-3.
  6888             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6889                                                          COMP-3.
  6890         16  AM-EXECUTIVE-TWO.
  6891             20  AM-EXEC2-NAME             PIC X(15).
  6892             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6893                                                          COMP-3.
  6894             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6895                                                          COMP-3.
  6896
  6897     12  AM-RETRO-ADDITIONAL-DATA.
  6898         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6899         16  AM-RETRO-PREM-P-E             PIC X.
  6900         16  AM-RETRO-CLMS-P-I             PIC X.
  6901         16  AM-RETRO-RET-BRACKET-LF.
  6902             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6903                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6904                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6905             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6906                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6907                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6908             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6909                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6910                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6911         16  AM-RETRO-RET-BRACKET-AH.
  6912             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6913                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6914                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6915                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6916             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6917                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6918                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6919             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6920                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6921                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6922
  6923     12  AM-COMMENTS.
  6924         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 130
* EL156.cbl
  6925
  6926     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6927         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6928         16  AM-FLI-BILLING-CODE           PIC X.
  6929         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6930         16  AM-FLI-UNITED-IDENT           PIC X.
  6931         16  AM-FLI-INTEREST-LOST-DATA.
  6932             20  AM-FLI-BANK-NO            PIC X(5).
  6933             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6934             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6935             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6936         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6937             20  AM-FLI-AGT                PIC X(9).
  6938             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6939             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6940         16  FILLER                        PIC X(102).
  6941
  6942     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6943         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6944             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6945             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6946             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6947             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6948             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6949         16  FILLER                          PIC X(10).
  6950******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 131
* EL156.cbl
  6952*    COPY ELCCHKQ.
  6953******************************************************************
  6954*                                                                *
  6955*                                                                *
  6956*                            ELCCHKQ.                            *
  6957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6958*                            VMOD=2.007                          *
  6959*                                                                *
  6960*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6961*                                                                *
  6962*   FILE TYPE = VSAM,KSDS                                        *
  6963*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6964*                                                                *
  6965*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6966*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6967*                                                                *
  6968*   LOG = YES                                                    *
  6969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6970******************************************************************
  6971 01  CHECK-QUE.
  6972     12  CQ-RECORD-ID                PIC XX.
  6973         88  VALID-CQ-ID         VALUE 'CQ'.
  6974
  6975     12  CQ-CONTROL-PRIMARY.
  6976         16  CQ-COMPANY-CD           PIC X.
  6977         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6978         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6979
  6980     12  CQ-CONTROL-BY-PAYEE.
  6981         16  CQ-CONTROL-BY-NUMBER.
  6982             20  CQ-COMPANY-CD-A1     PIC X.
  6983             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6984         16  CQ-PAYEE-CARRIER        PIC X.
  6985         16  CQ-PAYEE-GROUPING       PIC X(6).
  6986         16  CQ-PAYEE-STATE          PIC XX.
  6987         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6988         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6989
  6990     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6991         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6992         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6993         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6994         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6995         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6996         16  FILLER                  PIC X(3).
  6997
  6998     12  CQ-ENTRY-TYPE               PIC X.
  6999             88  CHECK-ON-QUE           VALUE 'Q'.
  7000             88  ALIGNMENT-CHECK        VALUE 'A'.
  7001             88  SPOILED-CHECK          VALUE 'S'.
  7002             88  PAYMENT-ABORTED        VALUE 'X'.
  7003
  7004     12  CQ-CLAIM-MAST-CNTL.
  7005         16  CQ-CARRIER              PIC X.
  7006         16  CQ-CLAIM-NO             PIC X(7).
  7007         16  CQ-CERT-NO.
  7008             20  CQ-CERT-PRIME       PIC X(10).
  7009             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 132
* EL156.cbl
  7010         16  CQ-CLAIM-TYPE           PIC X.
  7011             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7012             88  CQ-AH-CLAIM            VALUE 'A'.
  7013         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7014             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7015             88  CQ-O-B-COVERAGE        VALUE '2'.
  7016             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7017
  7018     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7019     12  CQ-CHECK-NUMBER             PIC X(7).
  7020     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7021     12  CQ-PAYMENT-TYPE             PIC X.
  7022             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7023             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7024             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7025             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7026             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7027             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7028             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7029             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7030     12  CQ-VOID-INDICATOR           PIC X.
  7031             88  CHECK-IS-STOPPED          VALUE 'S'.
  7032             88  CHECK-IS-VOID             VALUE 'V'.
  7033     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7034     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7035     12  CQ-CHECK-BY-USER            PIC X(4).
  7036     12  CQ-PRE-NUMBERING-SW         PIC X.
  7037       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7038       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7039
  7040     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7041     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7042     12  CQ-LEDGER-FLAG              PIC X(01).
  7043     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7044     12  CQ-LAST-UPDATED-DT          PIC XX.
  7045     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7046     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7047
  7048     12  FILLER                      PIC X(04).
  7049
  7050******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 133
* EL156.cbl
  7052*    COPY ELCBENE.
  7053******************************************************************
  7054*                                                                *
  7055*                            ELCBENE.                            *
  7056*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7057*                            VMOD=2.006                          *
  7058*                                                                *
  7059*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7060*                                                                *
  7061*   FILE TYPE = VSAM,KSDS                                        *
  7062*   RECORD SIZE = 500   RECFORM = FIX                            *
  7063*                                                                *
  7064*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7065*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7066*                                                                *
  7067*   LOG = YES                                                    *
  7068*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7069*                                                                *
  7070*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7071******************************************************************
  7072
  7073 01  BENEFICIARY-MASTER.
  7074     12  BE-RECORD-ID                PIC XX.
  7075         88  VALID-BE-ID                VALUE 'BE'.
  7076
  7077     12  BE-CONTROL-PRIMARY.
  7078         16  BE-COMPANY-CD           PIC X.
  7079         16  BE-RECORD-TYPE          PIC X.
  7080             88  BENEFICIARY-RECORD  VALUE 'B'.
  7081             88  ADJUSTOR-RECORD     VALUE 'A'.
  7082         16  BE-BENEFICIARY          PIC X(10).
  7083     12  BE-CONTROL-BY-NAME.
  7084         16  BE-COMPANY-CD-A1        PIC X.
  7085         16  BE-RECORD-TYPE-A1       PIC X.
  7086         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7087         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7088
  7089     12  BE-LAST-MAINT-DT            PIC XX.
  7090     12  BE-LAST-MAINT-BY            PIC X(4).
  7091     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7092
  7093     12  BE-ADDRESS-DATA.
  7094         16  BE-MAIL-TO-NAME         PIC X(30).
  7095         16  BE-ADDRESS-LINE-1       PIC X(30).
  7096         16  BE-ADDRESS-LINE-2       PIC X(30).
  7097         16  BE-ADDRESS-LINE-3       PIC X(30).
  7098         16  BE-CITY-STATE.
  7099             20  BE-CITY             PIC X(28).
  7100             20  BE-STATE            PIC XX.
  7101         16  BE-ZIP-CODE.
  7102             20  BE-ZIP-PRIME.
  7103                 24  BE-ZIP-1ST      PIC X.
  7104                     88  BE-CANADIAN-POST-CODE
  7105                                         VALUE 'A' THRU 'Z'.
  7106                 24  FILLER          PIC X(4).
  7107             20  BE-ZIP-PLUS4        PIC X(4).
  7108         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7109             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 134
* EL156.cbl
  7110             20  BE-CAN-POSTAL-2     PIC XXX.
  7111             20  FILLER              PIC XXX.
  7112         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7113         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7114
  7115******************************************************************
  7116*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7117*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7118******************************************************************
  7119     12  BE-CARRIER                  PIC X.
  7120
  7121     12  BE-ADDRESS-DATA2.
  7122         16  BE-MAIL-TO-NAME2        PIC X(30).
  7123         16  BE-ADDRESS-LINE-12      PIC X(30).
  7124         16  BE-ADDRESS-LINE-22      PIC X(30).
  7125         16  BE-ADDRESS-LINE-32      PIC X(30).
  7126         16  BE-CITY-STATE2.
  7127             20  BE-CITY2            PIC X(28).
  7128             20  BE-STATE2           PIC XX.
  7129         16  BE-ZIP-CODE2.
  7130             20  BE-ZIP-PRIME2.
  7131                 24  BE-ZIP-1ST2     PIC X.
  7132                     88  BE-CANADIAN-POST-CODE2
  7133                                         VALUE 'A' THRU 'Z'.
  7134                 24  FILLER          PIC X(4).
  7135             20  BE-ZIP-PLUS42       PIC X(4).
  7136         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7137             20  BE-CAN-POSTAL-12    PIC XXX.
  7138             20  BE-CAN-POSTAL-22    PIC XXX.
  7139             20  FILLER              PIC XXX.
  7140         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7141         16  BE-BILLING-STMT-DATA.
  7142             20  BE-BSR              PIC X.
  7143                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7144                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7145             20  BE-BSR-FROM         PIC X(30).
  7146             20  BE-BSR-DEPT         PIC X(30).
  7147             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7148             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7149             20  BE-OUTPUT-TYPE      PIC X.
  7150                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7151                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7152
  7153     12  FILLER                      PIC X(28).
  7154******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 135
* EL156.cbl
  7156*    COPY ELCARCH.
  7157******************************************************************
  7158*                                                                *
  7159*                            ELCARCH.                            *
  7160*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7161*                            VMOD=2.007                          *
  7162*                                                                *
  7163*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7164*                                                                *
  7165*   FILE TYPE = VSAM,KSDS                                        *
  7166*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7167*                                                                *
  7168*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7169*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7170*                                                                *
  7171*   LOG = NO                                                     *
  7172*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7173*                                                                *
  7174*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7175******************************************************************
  7176 01  LETTER-ARCHIVE.
  7177     12  LA-RECORD-ID                PIC XX.
  7178         88  VALID-LA-ID                VALUE 'LA'.
  7179
  7180     12  LA-CONTROL-PRIMARY.
  7181         16  LA-COMPANY-CD           PIC X.
  7182         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7183         16  LA-RECORD-TYPE          PIC X.
  7184             88  LA-HEADER-DATA         VALUE '1'.
  7185             88  LA-ADDRESS-DATA        VALUE '2'.
  7186             88  LA-TEXT-DATA           VALUE '3'.
  7187             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7188         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7189
  7190     12  LA-CONTROL-BY-TYPE.
  7191         16  LA-COMPANY-CD-A1        PIC X.
  7192         16  LA-RECORD-TYPE-A1       PIC X.
  7193         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7194         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7195
  7196     12  LA-TEXT-RECORD.
  7197         16  LA-SKIP-CONTROL         PIC XX.
  7198             88  NO-LINES-SKIPPED       VALUE SPACES.
  7199             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7200         16  LA-TEXT-LINE            PIC X(70).
  7201
  7202     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7203         16  FILLER                  PIC XX.
  7204         16  LA-ADDRESS-LINE         PIC X(30).
  7205         16  FILLER                  PIC X(40).
  7206
  7207     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7208         16  FILLER                  PIC XX.
  7209         16  LA-CARRIER              PIC X.
  7210         16  LA-CLAIM-NO             PIC X(7).
  7211         16  LA-CERT-NO.
  7212             20  LA-CERT-PRIME       PIC X(10).
  7213             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 136
* EL156.cbl
  7214         16  LA-NO-OF-COPIES         PIC S9.
  7215         16  LA-RESEND-DATE          PIC XX.
  7216         16  LA-PROCESSOR-CD         PIC X(4).
  7217         16  LA-CREATION-DT          PIC XX.
  7218         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7219         16  LA-RESEND-PRINT-DATE    PIC XX.
  7220         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7221         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7222*
  7223* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7224*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7225*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7226*   I        20  LA-DMD-RES-ST           PIC XX.
  7227*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7228*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7229*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7230*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7231*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7232*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7233*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7234*   I        20  LA-DMD-UND-CODE         PIC XX.
  7235*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7236*   V    16  FILLER                  PIC X(15).
  7237* -----
  7238*
  7239* REINSERTED  CSO  MODS
  7240*
  7241         16  FILLER.
  7242             20  FILLER                  PIC X(29).
  7243             20  LA-CSO-LETTER-STATUS    PIC X.
  7244                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7245                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7246                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7247             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7248             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7249*
  7250
  7251     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7252         16  FILLER                  PIC XX.
  7253         16  LA4-CARRIER             PIC X.
  7254         16  LA4-CLAIM-NO            PIC X(7).
  7255         16  LA4-CERT-NO.
  7256             20  LA4-CERT-PRIME      PIC X(10).
  7257             20  LA4-CERT-SFX        PIC X.
  7258         16  LA4-NO-OF-COPIES        PIC S9.
  7259         16  LA4-RESEND-DATE         PIC XX.
  7260         16  LA4-PROCESSOR-CD        PIC X(4).
  7261         16  LA4-CREATION-DT         PIC XX.
  7262         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7263         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7264         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7265         16  LA4-FORM-TYPE           PIC X.
  7266             88  LA4-INITIAL-FORM    VALUE '1'.
  7267             88  LA4-PROGRESS-FORM   VALUE '2'.
  7268         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7269         16  LA4-STATE               PIC X(02).
  7270         16  FILLER                  PIC X(31).
  7271******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 137
* EL156.cbl
  7273*    COPY ELCDAR.
  7274******************************************************************
  7275*                                                                *
  7276*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7277*   FILE TYPE = VSAM,KSDS                                        *
  7278*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7279*   BASE CLUSTER = DLYACTV                                       *
  7280*   LOG = YES                                                    *
  7281*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7282*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7283*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7284*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7285*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7286*               BY PROGRAM "LGINFCE".                            *
  7287*                                                                *
  7288******************************************************************
  7289 01  DAILY-ACTIVITY-RECORD.
  7290     05  DA-KEY.
  7291         10  DA-COMP-CD          PIC X.
  7292         10  DA-CARRIER          PIC X.
  7293         10  DA-CLAIM-NO         PIC X(7).
  7294         10  DA-CERT-NO.
  7295             15  DA-CERT-PRIME   PIC X(10).
  7296             15  DA-CERT-SFX     PIC X.
  7297     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7298     05  DA-RECORD-TYPE          PIC X.
  7299     05  FILLER                  PIC X(2).
  7300******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 138
* EL156.cbl
  7302*    COPY ERCCOMP.
  7303******************************************************************
  7304*                                                                *
  7305*                                                                *
  7306*                            ERCCOMP                             *
  7307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7308*                            VMOD=2.019                          *
  7309*                                                                *
  7310*   ONLINE CREDIT SYSTEM                                         *
  7311*                                                                *
  7312*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7313*                                                                *
  7314*   FILE TYPE = VSAM,KSDS                                        *
  7315*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7316*                                                                *
  7317*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7318*       ALTERNATE PATH = NONE                                    *
  7319*                                                                *
  7320*   LOG = NO                                                     *
  7321*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7322*                                                                *
  7323******************************************************************
  7324*                   C H A N G E   L O G
  7325*
  7326* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7327*-----------------------------------------------------------------
  7328*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7329* EFFECTIVE    NUMBER
  7330*-----------------------------------------------------------------
  7331* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7332* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7333* 092205    2005050300006  PEMA  ADD LEASE FEE
  7334* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7335* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7336* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7337* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7338* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7339* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7340******************************************************************
  7341
  7342 01  COMPENSATION-MASTER.
  7343     12  CO-RECORD-ID                          PIC XX.
  7344         88  VALID-CO-ID                          VALUE 'CO'.
  7345
  7346     12  CO-CONTROL-PRIMARY.
  7347         16  CO-COMPANY-CD                     PIC X.
  7348         16  CO-CONTROL.
  7349             20  CO-CTL-1.
  7350                 24  CO-CARR-GROUP.
  7351                     28  CO-CARRIER            PIC X.
  7352                     28  CO-GROUPING.
  7353                         32  CO-GROUP-PREFIX   PIC XXX.
  7354                         32  CO-GROUP-PRIME    PIC XXX.
  7355                 24  CO-RESP-NO.
  7356                     28  CO-RESP-PREFIX        PIC X(4).
  7357                     28  CO-RESP-PRIME         PIC X(6).
  7358             20  CO-CTL-2.
  7359                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 139
* EL156.cbl
  7360                     28  CO-ACCT-PREFIX        PIC X(4).
  7361                     28  CO-ACCT-PRIME         PIC X(6).
  7362         16  CO-TYPE                           PIC X.
  7363             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7364             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7365             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7366
  7367     12  CO-MAINT-INFORMATION.
  7368         16  CO-LAST-MAINT-DT                  PIC XX.
  7369         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7370         16  CO-LAST-MAINT-USER                PIC X(4).
  7371     12  FILLER                                PIC XX.
  7372     12  CO-STMT-TYPE                          PIC XXX.
  7373     12  CO-COMP-TYPE                          PIC X.
  7374         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7375     12  CO-STMT-OWNER                         PIC X(4).
  7376     12  CO-BALANCE-CONTROL                    PIC X.
  7377         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7378         88  CO-NO-BALANCE                        VALUE 'N'.
  7379
  7380     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7381         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7382         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7383         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7384
  7385     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7386         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7387         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7388
  7389     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7390     12  CO-GA-DIRECT-DEP                      PIC X.
  7391     12  CO-FUTURE-SPACE                       PIC X.
  7392         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7393
  7394     12  CO-ACCT-NAME                          PIC X(30).
  7395     12  CO-MAIL-NAME                          PIC X(30).
  7396     12  CO-ADDR-1                             PIC X(30).
  7397     12  CO-ADDR-2                             PIC X(30).
  7398     12  CO-ADDR-3.
  7399         16  CO-ADDR-CITY                      PIC X(27).
  7400         16  CO-ADDR-STATE                     PIC XX.
  7401     12  CO-CSO-1099                           PIC X.
  7402     12  CO-ZIP.
  7403         16  CO-ZIP-PRIME.
  7404             20  CO-ZIP-PRI-1ST                PIC X.
  7405                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7406             20  FILLER                        PIC X(4).
  7407         16  CO-ZIP-PLUS4                      PIC X(4).
  7408     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7409         16  CO-CAN-POSTAL-1                   PIC XXX.
  7410         16  CO-CAN-POSTAL-2                   PIC XXX.
  7411         16  FILLER                            PIC XXX.
  7412     12  CO-SOC-SEC                            PIC X(13).
  7413     12  CO-TELEPHONE.
  7414         16  CO-AREA-CODE                      PIC XXX.
  7415         16  CO-PREFIX                         PIC XXX.
  7416         16  CO-PHONE                          PIC X(4).
  7417
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 140
* EL156.cbl
  7418     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7419
  7420     12  CO-AR-BAL-LEVEL                       PIC X.
  7421         88  CO-AR-REF-LVL                        VALUE '1'.
  7422         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7423         88  CO-AR-BILL-LVL                       VALUE '2'.
  7424         88  CO-AR-AGT-LVL                        VALUE '3'.
  7425         88  CO-AR-FR-LVL                         VALUE '4'.
  7426
  7427     12  CO-AR-NORMAL-PRINT                    PIC X.
  7428         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7429         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7430
  7431     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7432
  7433     12  CO-AR-REPORTING                       PIC X.
  7434         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7435         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7436
  7437     12  CO-AR-PULL-CHECK                      PIC X.
  7438         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7439         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7440
  7441     12  CO-AR-BALANCE-PRINT                   PIC X.
  7442         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7443
  7444     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7445         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7446         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7447         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7448
  7449     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7450
  7451     12  CO-USER-CODE                          PIC X.
  7452     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7453
  7454******************************************************************
  7455*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7456*    THE LAST MONTH END RUN.
  7457******************************************************************
  7458
  7459     12  CO-LAST-ACTIVITY-DATE.
  7460         16  CO-ACT-YEAR                       PIC 99.
  7461         16  CO-ACT-MONTH                      PIC 99.
  7462         16  CO-ACT-DAY                        PIC 99.
  7463
  7464     12  CO-LAST-STMT-DT.
  7465         16  CO-LAST-STMT-YEAR                 PIC 99.
  7466         16  CO-LAST-STMT-MONTH                PIC 99.
  7467         16  CO-LAST-STMT-DAY                  PIC 99.
  7468
  7469     12  CO-MO-END-TOTALS.
  7470         16  CO-MONTHLY-TOTALS.
  7471             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7472             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7473             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7474             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7475             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 141
* EL156.cbl
  7476
  7477         16  CO-AGING-TOTALS.
  7478             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7479             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7480             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7481             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7482
  7483         16  CO-YTD-TOTALS.
  7484             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7485             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7486
  7487         16  CO-OVER-UNDER-TOTALS.
  7488             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7489             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7490
  7491     12  CO-MISCELLANEOUS-TOTALS.
  7492         16  CO-FICA-TOTALS.
  7493             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7494             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7495
  7496         16  CO-CLAIM-TOTALS.
  7497             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7498             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7499
  7500******************************************************************
  7501*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7502*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7503******************************************************************
  7504
  7505     12  CO-CURRENT-TOTALS.
  7506         16  CO-CURRENT-LAST-STMT-DT.
  7507             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7508             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7509             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7510
  7511         16  CO-CURRENT-MONTHLY-TOTALS.
  7512             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7513             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7514             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7515             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7516             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7517
  7518         16  CO-CURRENT-AGING-TOTALS.
  7519             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7520             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7521             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7522             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7523
  7524         16  CO-CURRENT-YTD-TOTALS.
  7525             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7526             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7527
  7528     12  CO-PAID-COMM-TOTALS.
  7529         16  CO-YTD-PAID-COMMS.
  7530             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7531             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7532
  7533     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 142
* EL156.cbl
  7534         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7535         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7536
  7537     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7538         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7539         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7540         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7541         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7542         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7543         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7544         88  CO-FINAL-LETTER                  VALUE 'F'.
  7545         88  CO-RECONCILING                   VALUE 'R'.
  7546         88  CO-PHONE-CALL                    VALUE 'P'.
  7547         88  CO-LEGAL                         VALUE 'L'.
  7548         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7549         88  CO-WRITE-OFF                     VALUE 'W'.
  7550         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7551
  7552     12  CO-CSR-CODE                       PIC X(4).
  7553
  7554     12  CO-GA-STATUS-INFO.
  7555         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7556         16  CO-GA-TERMINATION-DT          PIC XX.
  7557         16  CO-GA-STATUS-CODE             PIC X.
  7558             88  CO-GA-ACTIVE                 VALUE 'A'.
  7559             88  CO-GA-INACTIVE               VALUE 'I'.
  7560             88  CO-GA-PENDING                VALUE 'P'.
  7561         16  CO-GA-COMMENTS.
  7562             20  CO-GA-COMMENT-1           PIC X(40).
  7563             20  CO-GA-COMMENT-2           PIC X(40).
  7564             20  CO-GA-COMMENT-3           PIC X(40).
  7565             20  CO-GA-COMMENT-4           PIC X(40).
  7566
  7567     12  CO-RPTCD2                         PIC X(10).
  7568     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7569         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7570         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7571
  7572     12  CO-TYPE-AGENT                     PIC X(01).
  7573         88  CO-CORPORATION                   VALUE 'C'.
  7574         88  CO-PARTNERSHIP                   VALUE 'P'.
  7575         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7576         88  CO-TRUST                         VALUE 'T'.
  7577         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7578
  7579     12  CO-FAXNO.
  7580         16  CO-FAX-AREA-CODE                  PIC XXX.
  7581         16  CO-FAX-PREFIX                     PIC XXX.
  7582         16  CO-FAX-PHONE                      PIC X(4).
  7583
  7584     12  CO-BANK-INFORMATION.
  7585         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7586         16  CO-BANK-TRANSIT-NON REDEFINES
  7587             CO-BANK-TRANSIT-NO                PIC 9(8).
  7588
  7589         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7590     12  CO-MISC-DEDUCT-INFO REDEFINES
  7591                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 143
* EL156.cbl
  7592         16  CO-MD-GL-ACCT                     PIC X(10).
  7593         16  CO-MD-DIV                         PIC XX.
  7594         16  CO-MD-CENTER                      PIC X(4).
  7595         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7596         16  CO-CREATE-AP-CHECK                PIC X.
  7597         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7598         16  FILLER                            PIC XXX.
  7599     12  CO-ACH-STATUS                         PIC X.
  7600         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7601         88  CO-ACH-PENDING                        VALUE 'P'.
  7602
  7603     12  CO-BILL-SW                            PIC X.
  7604     12  CO-CONTROL-NAME                       PIC X(30).
  7605     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7606     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7607     12  CO-CLP-STATE                          PIC XX.
  7608     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7609     12  CO-SPP-REFUND-EDIT                    PIC X.
  7610
  7611******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 144
* EL156.cbl
  7613*    COPY ERCDMDNT.
  7614******************************************************************
  7615*                                                                *
  7616*                            ERCDMDNT                            *
  7617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7618*                            VMOD=2.005                          *
  7619*                                                                *
  7620*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7621*                                                                *
  7622*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7623*                                                                *
  7624*        FILE TYPE= VSAM,KSDS                                    *
  7625*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7626*                                                                *
  7627*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7628*                                                                *
  7629*        LOG = YES                                               *
  7630*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7631*                                                                *
  7632******************************************************************
  7633
  7634 01  CERTIFICATE-NOTE.
  7635     12  CN-RECORD-ID                     PIC  XX.
  7636         88  VALID-CN-ID                      VALUE 'CN'.
  7637
  7638     12  CN-CONTROL-PRIMARY.
  7639         16  CN-COMPANY-CD                PIC X.
  7640         16  CN-CERT-KEY.
  7641             20  CN-CARRIER               PIC X.
  7642             20  CN-GROUPING.
  7643                 24  CN-GROUPING-PREFIX   PIC XXX.
  7644                 24  CN-GROUPING-PRIME    PIC XXX.
  7645             20  CN-STATE                 PIC XX.
  7646             20  CN-ACCOUNT.
  7647                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7648                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7649             20  CN-CERT-EFF-DT           PIC XX.
  7650             20  CN-CERT-NO.
  7651                 24  CN-CERT-PRIME        PIC X(10).
  7652                 24  CN-CERT-SFX          PIC X.
  7653
  7654     12  CN-BILLING-START-LINE-NO         PIC 99.
  7655     12  CN-BILLING-END-LINE-NO           PIC 99.
  7656
  7657     12  CN-LINES.
  7658         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7659
  7660     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7661         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7662         16  CN-CSI-GENERAL-DATA-AREA.
  7663             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7664
  7665         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7666             CN-CSI-GENERAL-DATA-AREA.
  7667             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7668             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7669             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7670             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 145
* EL156.cbl
  7671             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7672             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7673             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7674             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7675             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7676             20  FILLER                       PIC XX.
  7677             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7678             20  FILLER                       PIC X(38).
  7679
  7680         16  CN-CSI-PRODUCT-DATA-AREA.
  7681             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7682
  7683         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7684             CN-CSI-PRODUCT-DATA-AREA.
  7685             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7686             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7687             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7688             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7689             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7690             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7691             20  FILLER                   PIC XX.
  7692             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7693             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7694             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7695             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7696             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7697             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7698             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7699             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7700             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7701             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7702             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7703             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7704             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7705             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7706             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7707             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7708             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7709             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7710             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7711             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7712             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7713             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7714             20  FILLER                   PIC X(25).
  7715
  7716         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7717             CN-CSI-CREDIT-CARD-DATA.
  7718             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7719             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7720             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7721             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7722             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7723             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7724             20  FILLER                   PIC XX.
  7725             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7726             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7727             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7728             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 146
* EL156.cbl
  7729             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7730             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7731             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7732             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7733             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7734             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7735             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7736             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7737             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7738             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7739             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7740             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7741             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7742             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7743             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7744             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7745             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7746             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7747             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7748             20  FILLER                   PIC X(17).
  7749
  7750         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7751             CN-CSI-FAMILY-LEAVE-DATA.
  7752             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7753             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7754             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7755             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7756             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7757             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7758             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7759             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7760             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7761             20  CN-CSI-SL-INT-ON-PROCEEDS
  7762                                          PIC S9(5)V99  COMP-3.
  7763             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7764             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7765             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7766             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7767             20  CN-CSI-SL-POLICY-BENEFITS
  7768                                          PIC S9(5)V99  COMP-3.
  7769             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7770             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7771             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7772             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7773             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7774             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7775             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7776             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7777             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7778             20  CN-CSI-SL-STATE-NOT      PIC X.
  7779             20  FILLER                   PIC XX.
  7780
  7781         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7782             CN-CSI-SENIOR-LIFE-DATA.
  7783             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7784             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7785             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7786                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 147
* EL156.cbl
  7787             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7788             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7789             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7790             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7791             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7792             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7793             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7794             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7795             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7796             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7797             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7798             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7799             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7800             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7801             20  CN-CSI-PP-REPAIR         PIC X.
  7802             20  CN-CSI-PP-REPLACE        PIC X.
  7803             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7804             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7805             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7806             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7807             20  FILLER                   PIC X(5).
  7808
  7809         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7810             CN-CSI-PURCH-PROP-DATA.
  7811             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7812             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7813             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7814             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7815             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7816             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7817             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7818             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7819             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7820             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7821             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7822             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7823             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7824             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7825             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7826             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7827             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7828             20  CN-CSI-EW-REPLACE        PIC X.
  7829             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7830             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7831             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7832             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7833             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7834             20  FILLER                   PIC X(4).
  7835
  7836     12  CN-LAST-MAINT-DT                 PIC XX.
  7837     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7838     12  CN-LAST-MAINT-USER               PIC X(4).
  7839     12  FILLER                           PIC X(6).
  7840
  7841******************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 148
* EL156.cbl
  7843*    COPY ERCCNOT.
  7844******************************************************************
  7845*                                                                *
  7846*                            ERCCNOT                             *
  7847*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7848*                            VMOD=2.003                          *
  7849*                                                                *
  7850*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7851*                                                                *
  7852*        FILE TYPE= VSAM,KSDS                                    *
  7853*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7854*                                                                *
  7855*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7856*                                                                *
  7857*        LOG = YES                                               *
  7858*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7859*                                                                *
  7860******************************************************************
  7861*                   C H A N G E   L O G
  7862*
  7863* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7864*-----------------------------------------------------------------
  7865*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7866* EFFECTIVE    NUMBER
  7867*-----------------------------------------------------------------
  7868* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7869******************************************************************
  7870
  7871 01  CERT-NOTE-FILE.
  7872     12  CZ-RECORD-ID                PIC  XX.
  7873         88  VALID-CZ-ID                  VALUE 'CZ'.
  7874
  7875     12  CZ-CONTROL-PRIMARY.
  7876         16  CZ-COMPANY-CD           PIC X.
  7877         16  CZ-CARRIER              PIC X.
  7878         16  CZ-GROUPING.
  7879             20 CZ-GROUPING-PREFIX   PIC XXX.
  7880             20 CZ-GROUPING-PRIME    PIC XXX.
  7881         16  CZ-STATE                PIC XX.
  7882         16  CZ-ACCOUNT.
  7883             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7884             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7885         16  CZ-CERT-EFF-DT          PIC XX.
  7886         16  CZ-CERT-NO.
  7887             20  CZ-CERT-PRIME       PIC X(10).
  7888             20  CZ-CERT-SFX         PIC X.
  7889         16  CZ-RECORD-TYPE          PIC X.
  7890             88  CERT-NOTE           VALUE '1'.
  7891             88  CLAIM-CERT-NOTE     VALUE '2'.
  7892         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7893
  7894     12  CZ-LAST-MAINT-DT            PIC XX.
  7895     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7896     12  CZ-LAST-MAINT-USER          PIC X(4).
  7897
  7898     12  CZ-NOTE-INFORMATION.
  7899         16  CZ-NOTE                 PIC X(63).
  7900         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 149
* EL156.cbl
  7901******************************************************************
  7902*                            COPY ERCPDEF.
  7903******************************************************************
  7904*                                                                *
  7905*                                                                *
  7906*                            ERCPDEF.                            *
  7907*                                                                *
  7908*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7909*                                                                *
  7910*    FILE TYPE = VSAM,KSDS                                       *
  7911*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7912*                                                                *
  7913*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7914*                                                                *
  7915*    LOG = YES                                                   *
  7916*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7917******************************************************************
  7918*                   C H A N G E   L O G
  7919*
  7920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7921*-----------------------------------------------------------------
  7922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7923* EFFECTIVE    NUMBER
  7924*-----------------------------------------------------------------
  7925* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7926******************************************************************
  7927 01  PRODUCT-MASTER.
  7928    12  PD-RECORD-ID                 PIC X(02).
  7929        88  VALID-PD-ID                  VALUE 'PD'.
  7930    12  PD-CONTROL-PRIMARY.
  7931        16  PD-COMPANY-CD            PIC X.
  7932        16  PD-STATE                 PIC XX.
  7933        16  PD-PRODUCT-CD            PIC XXX.
  7934        16  PD-FILLER                PIC X(7).
  7935        16  PD-BEN-TYPE              PIC X.
  7936        16  PD-BEN-CODE              PIC XX.
  7937        16  PD-PROD-EXP-DT           PIC XX.
  7938    12  FILLER                       PIC X(50).
  7939    12  PD-PRODUCT-DATA OCCURS 8.
  7940        16  PD-PROD-CODE             PIC X.
  7941            88  PD-PROD-LIFE           VALUE 'L'.
  7942            88  PD-PROD-PROP           VALUE 'P'.
  7943            88  PD-PROD-AH             VALUE 'A'.
  7944            88  PD-PROD-IU             VALUE 'I'.
  7945            88  PD-PROD-GAP            VALUE 'G'.
  7946            88  PD-PROD-FMLA           VALUE 'F'.
  7947        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7948        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7949        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7950        16  PD-MAX-TERM              PIC S999        COMP-3.
  7951        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7952        16  FILLER                   PIC X.
  7953        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7954        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7955        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7956        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  7957        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7958        16  PD-REC-CRIT-PERIOD       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 150
* EL156.cbl
  7959        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7960            20  PD-RECURRING-YN      PIC X.
  7961            20  FILLER               PIC X.
  7962        16  PD-RTW-MOS               PIC 99.
  7963        16  PD-MAX-EXTENSION         PIC 99.
  7964        16  FILLER                   PIC XX.
  7965    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7966    12  PD-TERM-LIMITS OCCURS 15.
  7967        16  PD-LOW-TERM              PIC S999        COMP-3.
  7968        16  PD-HI-TERM               PIC S999        COMP-3.
  7969*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  7970    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  7971        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  7972        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  7973    12  PD-EARN-FACTORS.
  7974        16  FILLER OCCURS 15.
  7975            20  FILLER OCCURS 15.
  7976                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  7977    12  PD-PRODUCT-DESC              PIC X(80).
  7978    12  PD-TRUNCATED                 PIC X.
  7979    12  FILLER                       PIC X(59).
  7980    12  PD-MAINT-INFORMATION.
  7981        16  PD-LAST-MAINT-DT         PIC X(02).
  7982        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7983        16  PD-LAST-MAINT-BY         PIC X(04).
  7984*                            COPY ELCCRTT.
  7985******************************************************************
  7986*                                                                *
  7987*                            ELCCRTT.                            *
  7988*                                                                *
  7989*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7990*                                                                *
  7991*   FILE TYPE = VSAM,KSDS                                        *
  7992*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7993*                                                                *
  7994*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7995*                                                                *
  7996*   LOG = YES                                                    *
  7997*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7998******************************************************************
  7999*                   C H A N G E   L O G
  8000*
  8001* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8002*-----------------------------------------------------------------
  8003*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8004* EFFECTIVE    NUMBER
  8005*-----------------------------------------------------------------
  8006* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8007* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8008* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8009* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8010* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8011* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8012******************************************************************
  8013
  8014 01  CERTIFICATE-TRAILERS.
  8015     12  CS-RECORD-ID                      PIC XX.
  8016         88  VALID-CS-ID                      VALUE 'CS'.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 151
* EL156.cbl
  8017
  8018     12  CS-CONTROL-PRIMARY.
  8019         16  CS-COMPANY-CD                 PIC X.
  8020         16  CS-CARRIER                    PIC X.
  8021         16  CS-GROUPING                   PIC X(6).
  8022         16  CS-STATE                      PIC XX.
  8023         16  CS-ACCOUNT                    PIC X(10).
  8024         16  CS-CERT-EFF-DT                PIC XX.
  8025         16  CS-CERT-NO.
  8026             20  CS-CERT-PRIME             PIC X(10).
  8027             20  CS-CERT-SFX               PIC X.
  8028         16  CS-TRAILER-TYPE               PIC X.
  8029             88  COMM-TRLR           VALUE 'A'.
  8030             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8031             88  CERT-DATA-TRLR      VALUE 'C'.
  8032
  8033     12  CS-DATA-AREA                      PIC X(516).
  8034
  8035     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8036         16  CS-BANK-COMMISSION-AREA.
  8037             20  CS-BANK-COMMS       OCCURS 10.
  8038                 24  CS-AGT                PIC X(10).
  8039                 24  CS-COM-TYP            PIC X.
  8040                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8041                 24  CS-RECALC-LV-INDIC    PIC X.
  8042                 24  FILLER                PIC X(10).
  8043         16  FILLER                        PIC X(256).
  8044
  8045     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8046****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8047         16  CS-MB-CLAIM-DATA OCCURS 24.
  8048             20  CS-CLAIM-NO               PIC X(7).
  8049             20  CS-CLAIM-TYPE             PIC X.
  8050                 88  CS-AH-CLM               VALUE 'A'.
  8051                 88  CS-IU-CLM               VALUE 'I'.
  8052                 88  CS-GP-CLM               VALUE 'G'.
  8053                 88  CS-LF-CLM               VALUE 'L'.
  8054                 88  CS-PR-CLM               VALUE 'P'.
  8055             20  CS-INSURED-TYPE           PIC X.
  8056                 88  CS-PRIM-INSURED          VALUE 'P'.
  8057                 88  CS-CO-BORROWER           VALUE 'C'.
  8058             20  CS-BENEFIT-PERIOD         PIC 99.
  8059             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8060             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8061             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8062         16  FILLER                        PIC X(12).
  8063     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8064         16  CS-VIN-NUMBER                 PIC X(17).
  8065         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8066         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8067         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8068         16  FILLER                        PIC X(496).
  8069 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8070                          CONTROL-FILE CERTIFICATE-MASTER
  8071                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8072                          ACCOUNT-MASTER CHECK-QUE
  8073                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8074                          DAILY-ACTIVITY-RECORD
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 152
* EL156.cbl
  8075                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8076                          CERT-NOTE-FILE PRODUCT-MASTER
  8077                          CERTIFICATE-TRAILERS.
  8078 0000-DFHEXIT SECTION.
  8079     MOVE '9#                    $   ' TO DFHEIV0.
  8080     MOVE 'EL156' TO DFHEIV1.
  8081     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8082
  8083     IF EIBCALEN = 0
  8084         GO TO 8800-UNAUTHORIZED-ACCESS.
  8085
  8086     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8087     MOVE EIBTRMID               TO QID-TERM.
  8088     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8089     MOVE '2'                    TO EMI-SWITCH2.
  8090     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8091     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8092
  8093     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8094     MOVE '5'                    TO DC-OPTION-CODE.
  8095     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8096     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8097                                    SAVE-BIN-DATE.
  8098     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8099     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8100
  8101     IF SAVE-DATE-YY > 70
  8102         MOVE 19                 TO SAVE-DATE-CC
  8103     ELSE
  8104         MOVE 20                 TO SAVE-DATE-CC.
  8105
  8106     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8107         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8108     END-IF.
  8109
  8110     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8111        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8112     ELSE
  8113        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8114     END-IF
  8115
  8116     IF PI-PRINT-CLM-FRM-YN = 'N'
  8117         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8118     ELSE
  8119         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8120     END-IF
  8121
  8122     IF PI-PRINT-SURVEY-YN = 'N'
  8123         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8124     ELSE
  8125         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8126     END-IF
  8127
  8128     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8129         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8130     ELSE
  8131         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8132     END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 153
* EL156.cbl
  8133
  8134* EXEC CICS HANDLE CONDITION
  8135*        NOTOPEN   (9990-ABEND)
  8136*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8137*        MAPFAIL   (0400-FIRST-TIME)
  8138*        DUPREC    (6180-DUPREC)
  8139*        ERROR     (9990-ABEND)
  8140*    END-EXEC.
  8141*    MOVE '"$JL?%.               ! " #00008129' TO DFHEIV0
  8142     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8144     MOVE X'2220233030303038313239' TO DFHEIV0(25:11)
  8145     CALL 'kxdfhei1' USING DFHEIV0
  8146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8147
  8148
  8149     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8150         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8151
  8152     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8153         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8154             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8155             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8156             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8157             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8158             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8159             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8160             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8161             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8162             MOVE LOW-VALUES           TO EL156AI
  8163             MOVE 'Y'                  TO FIRST-ENTRY
  8164         ELSE
  8165             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8166             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8167             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8168             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8169             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8170             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8171             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8172             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8173
  8174     IF RETURNED-FROM NOT = SPACES
  8175        IF (RETURNED-FROM = 'EL614')
  8176           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8177           IF WS-SAVED-EOB-CODES NOT = SPACES
  8178              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8179           ELSE
  8180              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8181           END-IF
  8182        END-IF
  8183         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8184            MOVE 'Y'             TO FIRST-ENTRY
  8185            IF RETURNED-FROM = 'EL614'
  8186               AND (PI-PASS-SW NOT = 'C')
  8187               IF WS-SAVED-EOB-CODES NOT = SPACES
  8188                  MOVE WS-SAVED-EOB-CODES
  8189                                 TO PI-PMTNOTE2
  8190                                    WS-PMTNOTE2
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 154
* EL156.cbl
  8191                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8192               ELSE
  8193                  MOVE SPACES    TO PI-PMTNOTE2
  8194                                    WS-PMTNOTE2
  8195                                    PI-EOB-CODES-EXIST
  8196               END-IF
  8197            END-IF
  8198            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8199            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8200            IF RETURNED-FROM = 'EL614'
  8201               GO TO 1000-EDIT-DATA
  8202            END-IF
  8203            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8204               (PAYEEI   = LOW-VALUES OR SPACES)
  8205               GO TO 8100-SEND-INITIAL-MAP
  8206            ELSE
  8207               GO TO 1000-EDIT-DATA.
  8208
  8209     IF EIBTRNID NOT = TRANS-ID
  8210         GO TO 0400-FIRST-TIME.
  8211
  8212     IF EIBAID = DFHCLEAR
  8213        IF PI-PASS-SW = 'C'
  8214           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8215           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8216           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8217           MOVE 'Y'            TO RETURNED-FROM-B
  8218           GO TO 1000-EDIT-DATA
  8219        ELSE
  8220           GO TO 9400-CLEAR.
  8221
  8222     IF PI-PASS-SW = 'C'
  8223         MOVE MAP-NAMEB          TO MAP-NAME
  8224         IF EIBAID = DFHPF1 OR DFHPF13
  8225             GO TO 5000-UPDATE
  8226           ELSE
  8227             IF EIBAID NOT = DFHENTER
  8228                 MOVE LOW-VALUES TO EL156BI
  8229                 MOVE MAP-NAMEB  TO MAP-NAME
  8230                 MOVE ER-0029    TO EMI-ERROR
  8231                 MOVE -1         TO  ENTPFBL
  8232                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8233                 GO TO 8200-SEND-DATAONLY.
  8234
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 155
* EL156.cbl
  8236 0200-RECEIVE.
  8237     MOVE LOW-VALUES             TO EL156AI.
  8238     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8239         MOVE ER-0008            TO EMI-ERROR
  8240         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8241         IF PI-PASS-SW = 'C'
  8242             MOVE -1             TO ENTPFBL
  8243             GO TO 8200-SEND-DATAONLY
  8244         ELSE
  8245             MOVE -1             TO PMTTYPEL
  8246             GO TO 8200-SEND-DATAONLY.
  8247
  8248     IF PI-COMPANY-ID = 'DMD'
  8249         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8250
  8251     IF PI-PASS-SW = 'C'
  8252         MOVE MAP-NAMEB          TO MAP-NAME.
  8253
  8254
  8255* EXEC CICS RECEIVE
  8256*        MAP   (MAP-NAME)
  8257*        MAPSET(MAPSET-NAME)
  8258*        ASIS
  8259*        INTO  (EL156AI)
  8260*    END-EXEC.
  8261     MOVE LENGTH OF
  8262      EL156AI
  8263       TO DFHEIV11
  8264*    MOVE '8"TAI  L              ''   #00008242' TO DFHEIV0
  8265     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8266     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8267     MOVE X'2020233030303038323432' TO DFHEIV0(25:11)
  8268     CALL 'kxdfhei1' USING DFHEIV0,
  8269           MAP-NAME,
  8270           EL156AI,
  8271           DFHEIV11,
  8272           MAPSET-NAME,
  8273           DFHEIV99,
  8274           DFHEIV99
  8275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8276
  8277
  8278     IF PI-PASS-SW NOT = 'C'
  8279         GO TO 0250-MAPA.
  8280
  8281     IF ENTPFBL NOT > ZERO
  8282         MOVE MAP-NAMEB          TO MAP-NAME
  8283         MOVE ER-0029            TO EMI-ERROR
  8284         MOVE -1                 TO  ENTPFBL
  8285         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8286         GO TO 8200-SEND-DATAONLY.
  8287
  8288     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8289         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8290       ELSE
  8291         MOVE MAP-NAMEB           TO MAP-NAME
  8292         MOVE ER-0029             TO EMI-ERROR
  8293         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 156
* EL156.cbl
  8294         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8295         GO TO 8200-SEND-DATAONLY.
  8296
  8297     IF EIBAID = DFHPF1 OR DFHPF13
  8298         IF MODIFY-CAP
  8299            GO TO 5000-UPDATE
  8300          ELSE
  8301            MOVE 'UPDATE'           TO SM-READ
  8302            PERFORM 9995-SECURITY-VIOLATION
  8303            MOVE MAP-NAMEB          TO MAP-NAME
  8304            MOVE ER-0070            TO EMI-ERROR
  8305            MOVE -1                 TO  ENTPFBL
  8306            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8307            GO TO 8200-SEND-DATAONLY.
  8308
  8309 0250-MAPA.
  8310     IF ENTERPFL = 0
  8311         GO TO 0300-CHECK-PFKEYS.
  8312
  8313     IF EIBAID NOT = DFHENTER
  8314         MOVE ER-0004            TO EMI-ERROR
  8315         GO TO 0320-INPUT-ERROR.
  8316
  8317     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8318         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8319     ELSE
  8320         MOVE ER-0029            TO EMI-ERROR
  8321         GO TO 0320-INPUT-ERROR.
  8322
  8323 0300-CHECK-PFKEYS.
  8324     IF EIBAID = DFHPF7 OR DFHPF8
  8325         GO TO 8820-PF7-8.
  8326
  8327     IF EIBAID = DFHPF23
  8328         GO TO 8810-PF23.
  8329
  8330     IF EIBAID = DFHPF24
  8331         GO TO 9200-RETURN-MAIN-MENU.
  8332
  8333     IF EIBAID = DFHPF12
  8334         GO TO 9500-PF12.
  8335
  8336     IF EIBAID = DFHPF1
  8337        IF PI-PASS-SW = 'A' OR 'B'
  8338          GO TO 0330-BROWSE-FORWARD.
  8339
  8340     IF EIBAID = DFHPF2
  8341        IF PI-PASS-SW = 'A' OR 'B'
  8342          GO TO 0350-BROWSE-BACKWARD.
  8343
  8344     IF EIBAID = DFHPF6
  8345        IF PI-EOB-CODES-EXIST = 'Y'
  8346           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8347        ELSE
  8348           MOVE SPACES              TO WS-PMTNOTE2
  8349        END-IF
  8350         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8351         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 157
* EL156.cbl
  8352            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8353         END-IF
  8354         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8355         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8356             MOVE 'EL614'        TO PGM-NAME
  8357             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8358             GO TO 9300-XCTL
  8359         ELSE
  8360             MOVE XCTL-157       TO PGM-NAME
  8361             GO TO 9300-XCTL.
  8362
  8363     IF EIBAID = DFHPF9
  8364        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8365        MOVE XCTL-141            TO PGM-NAME
  8366        GO TO 9300-XCTL.
  8367
  8368     IF EIBAID = DFHPF10
  8369        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8370        MOVE XCTL-155            TO PGM-NAME
  8371        GO TO 9300-XCTL.
  8372
  8373     MOVE SPACES                 TO ERRMSG0O
  8374                                    ERRMSG1O
  8375                                    ERRMSG2O.
  8376
  8377     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8378         IF PI-PASS-SW NOT = 'B'
  8379             MOVE ER-0422        TO EMI-ERROR
  8380             GO TO 0320-INPUT-ERROR
  8381           ELSE
  8382             GO TO 0700-TEST-FOR-CHANGES.
  8383
  8384     IF EIBAID = DFHPF11
  8385        IF PI-PASS-SW = 'C'
  8386           MOVE ER-0029          TO EMI-ERROR
  8387           GO TO 0320-INPUT-ERROR.
  8388
  8389     IF EIBAID = DFHENTER OR DFHPF11
  8390        NEXT SENTENCE
  8391     ELSE
  8392        MOVE ER-0029             TO EMI-ERROR
  8393        GO TO 0320-INPUT-ERROR.
  8394
  8395     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8396
  8397     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8398         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8399         GO TO 1000-EDIT-DATA
  8400     ELSE
  8401         IF PI-FATAL-COUNT NOT = 0 OR
  8402            PI-FORCE-COUNT NOT = 0
  8403             GO TO 1000-EDIT-DATA
  8404         ELSE
  8405             GO TO 2000-EDIT-DONE.
  8406
  8407 0320-INPUT-ERROR.
  8408     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8409
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 158
* EL156.cbl
  8410     IF ENTERPFL = 0
  8411         MOVE -1                 TO PMTTYPEL
  8412     ELSE
  8413         MOVE AL-UNBON           TO ENTERPFA
  8414         MOVE -1                 TO ENTERPFL.
  8415
  8416     GO TO 8200-SEND-DATAONLY.
  8417
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 159
* EL156.cbl
  8419 0330-BROWSE-FORWARD.
  8420
  8421     MOVE CLMNOI            TO PI-CLAIM-NO.
  8422     MOVE CARRI             TO PI-CARRIER.
  8423     MOVE CERTNOI           TO PI-CERT-PRIME.
  8424     MOVE SUFXI             TO PI-CERT-SFX.
  8425
  8426     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8427     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8428     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8429     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8430
  8431     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8432
  8433
  8434* EXEC CICS HANDLE CONDITION
  8435*         NOTFND   (0380-CLAIM-END-FILE)
  8436*         ENDFILE  (0380-CLAIM-END-FILE)
  8437*    END-EXEC.
  8438*    MOVE '"$I''                  ! # #00008404' TO DFHEIV0
  8439     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8441     MOVE X'2320233030303038343034' TO DFHEIV0(25:11)
  8442     CALL 'kxdfhei1' USING DFHEIV0
  8443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8444
  8445
  8446
  8447* EXEC CICS STARTBR
  8448*         DATASET    ('ELMSTR')
  8449*         RIDFLD     (ELMSTR-KEY)
  8450*         GTEQ
  8451*    END-EXEC.
  8452     MOVE 'ELMSTR' TO DFHEIV1
  8453     MOVE 0
  8454       TO DFHEIV11
  8455*    MOVE '&,         G          &   #00008409' TO DFHEIV0
  8456     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8457     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8458     MOVE X'2020233030303038343039' TO DFHEIV0(25:11)
  8459     CALL 'kxdfhei1' USING DFHEIV0,
  8460           DFHEIV1,
  8461           ELMSTR-KEY,
  8462           DFHEIV99,
  8463           DFHEIV11,
  8464           DFHEIV99
  8465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8466
  8467
  8468     MOVE 'Y' TO WS-BROWSE-START-SW.
  8469
  8470 0335-READNEXT.
  8471
  8472
  8473* EXEC CICS READNEXT
  8474*         DATASET    ('ELMSTR')
  8475*         RIDFLD     (ELMSTR-KEY)
  8476*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 160
* EL156.cbl
  8477*    END-EXEC.
  8478     MOVE 'ELMSTR' TO DFHEIV1
  8479     MOVE 0
  8480       TO DFHEIV11
  8481*    MOVE '&.S                   )   #00008419' TO DFHEIV0
  8482     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8484     MOVE X'2020233030303038343139' TO DFHEIV0(25:11)
  8485     CALL 'kxdfhei1' USING DFHEIV0,
  8486           DFHEIV1,
  8487           DFHEIV20,
  8488           DFHEIV99,
  8489           ELMSTR-KEY,
  8490           DFHEIV99,
  8491           DFHEIV11,
  8492           DFHEIV99,
  8493           DFHEIV99
  8494     SET ADDRESS OF CLAIM-MASTER TO
  8495         DFHEIV20
  8496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8497
  8498
  8499     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8500        GO TO 0380-CLAIM-END-FILE.
  8501
  8502     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8503        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8504        GO TO 0335-READNEXT.
  8505
  8506     IF PI-COMPANY-ID = 'CRI'
  8507         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8508            GO TO 0380-CLAIM-END-FILE.
  8509
  8510     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8511         GO TO 0335-READNEXT.
  8512
  8513     IF PI-CARRIER-SECURITY > SPACES
  8514         IF CL-CARRIER = PI-CARRIER-SECURITY
  8515             NEXT SENTENCE
  8516         ELSE
  8517             GO TO 0335-READNEXT.
  8518
  8519     IF PI-ACCOUNT-SECURITY > SPACES
  8520         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8521             NEXT SENTENCE
  8522         ELSE
  8523             GO TO 0335-READNEXT.
  8524
  8525     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8526     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8527     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8528
  8529     GO TO 0400-FIRST-TIME.
  8530
  8531 0350-BROWSE-BACKWARD.
  8532
  8533     MOVE CLMNOI            TO PI-CLAIM-NO
  8534                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 161
* EL156.cbl
  8535     MOVE CARRI             TO PI-CARRIER.
  8536     MOVE CERTNOI           TO PI-CERT-PRIME.
  8537     MOVE SUFXI             TO PI-CERT-SFX.
  8538
  8539     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8540
  8541     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8542     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8543     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8544
  8545
  8546* EXEC CICS HANDLE CONDITION
  8547*         NOTFND   (0380-CLAIM-END-FILE)
  8548*         ENDFILE  (0380-CLAIM-END-FILE)
  8549*    END-EXEC.
  8550*    MOVE '"$I''                  ! $ #00008471' TO DFHEIV0
  8551     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8553     MOVE X'2420233030303038343731' TO DFHEIV0(25:11)
  8554     CALL 'kxdfhei1' USING DFHEIV0
  8555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8556
  8557
  8558
  8559* EXEC CICS STARTBR
  8560*         DATASET    ('ELMSTR')
  8561*         RIDFLD     (ELMSTR-KEY)
  8562*         GTEQ
  8563*    END-EXEC.
  8564     MOVE 'ELMSTR' TO DFHEIV1
  8565     MOVE 0
  8566       TO DFHEIV11
  8567*    MOVE '&,         G          &   #00008476' TO DFHEIV0
  8568     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8569     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8570     MOVE X'2020233030303038343736' TO DFHEIV0(25:11)
  8571     CALL 'kxdfhei1' USING DFHEIV0,
  8572           DFHEIV1,
  8573           ELMSTR-KEY,
  8574           DFHEIV99,
  8575           DFHEIV11,
  8576           DFHEIV99
  8577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8578
  8579
  8580     MOVE 'Y' TO WS-BROWSE-START-SW.
  8581
  8582
  8583* EXEC CICS READNEXT
  8584*         DATASET    ('ELMSTR')
  8585*         RIDFLD     (ELMSTR-KEY)
  8586*         SET        (ADDRESS OF CLAIM-MASTER)
  8587*    END-EXEC.
  8588     MOVE 'ELMSTR' TO DFHEIV1
  8589     MOVE 0
  8590       TO DFHEIV11
  8591*    MOVE '&.S                   )   #00008484' TO DFHEIV0
  8592     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 162
* EL156.cbl
  8593     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8594     MOVE X'2020233030303038343834' TO DFHEIV0(25:11)
  8595     CALL 'kxdfhei1' USING DFHEIV0,
  8596           DFHEIV1,
  8597           DFHEIV20,
  8598           DFHEIV99,
  8599           ELMSTR-KEY,
  8600           DFHEIV99,
  8601           DFHEIV11,
  8602           DFHEIV99,
  8603           DFHEIV99
  8604     SET ADDRESS OF CLAIM-MASTER TO
  8605         DFHEIV20
  8606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8607
  8608
  8609
  8610* EXEC CICS READPREV
  8611*         DATASET    ('ELMSTR')
  8612*         RIDFLD     (ELMSTR-KEY)
  8613*         SET        (ADDRESS OF CLAIM-MASTER)
  8614*    END-EXEC.
  8615     MOVE 'ELMSTR' TO DFHEIV1
  8616     MOVE 0
  8617       TO DFHEIV11
  8618*    MOVE '&0S                   )   #00008490' TO DFHEIV0
  8619     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8620     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8621     MOVE X'2020233030303038343930' TO DFHEIV0(25:11)
  8622     CALL 'kxdfhei1' USING DFHEIV0,
  8623           DFHEIV1,
  8624           DFHEIV20,
  8625           DFHEIV99,
  8626           ELMSTR-KEY,
  8627           DFHEIV99,
  8628           DFHEIV11,
  8629           DFHEIV99,
  8630           DFHEIV99
  8631     SET ADDRESS OF CLAIM-MASTER TO
  8632         DFHEIV20
  8633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8634
  8635
  8636 0360-BROWSE-BACKWARD.
  8637
  8638
  8639* EXEC CICS READPREV
  8640*         DATASET    ('ELMSTR')
  8641*         RIDFLD     (ELMSTR-KEY)
  8642*         SET        (ADDRESS OF CLAIM-MASTER)
  8643*    END-EXEC.
  8644     MOVE 'ELMSTR' TO DFHEIV1
  8645     MOVE 0
  8646       TO DFHEIV11
  8647*    MOVE '&0S                   )   #00008498' TO DFHEIV0
  8648     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8649     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8650     MOVE X'2020233030303038343938' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 163
* EL156.cbl
  8651     CALL 'kxdfhei1' USING DFHEIV0,
  8652           DFHEIV1,
  8653           DFHEIV20,
  8654           DFHEIV99,
  8655           ELMSTR-KEY,
  8656           DFHEIV99,
  8657           DFHEIV11,
  8658           DFHEIV99,
  8659           DFHEIV99
  8660     SET ADDRESS OF CLAIM-MASTER TO
  8661         DFHEIV20
  8662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8663
  8664
  8665     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8666        GO TO 0380-CLAIM-END-FILE.
  8667
  8668     IF PI-COMPANY-ID = 'CRI'
  8669         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8670            GO TO 0380-CLAIM-END-FILE.
  8671
  8672     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8673         GO TO 0360-BROWSE-BACKWARD.
  8674
  8675     IF PI-CARRIER-SECURITY > SPACES
  8676         IF CL-CARRIER = PI-CARRIER-SECURITY
  8677             NEXT SENTENCE
  8678         ELSE
  8679             GO TO 0360-BROWSE-BACKWARD.
  8680
  8681     IF PI-ACCOUNT-SECURITY > SPACES
  8682         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8683             NEXT SENTENCE
  8684         ELSE
  8685             GO TO 0360-BROWSE-BACKWARD.
  8686
  8687     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8688     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8689     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8690
  8691     GO TO 0400-FIRST-TIME.
  8692
  8693 0380-CLAIM-END-FILE.
  8694
  8695     MOVE ER-0130     TO EMI-ERROR.
  8696     MOVE -1          TO CLMNOL.
  8697     MOVE AL-UABON    TO CARRA
  8698                         CLMNOA
  8699                         CERTNOA
  8700                         SUFXA.
  8701
  8702     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8703
  8704     GO TO 8200-SEND-DATAONLY.
  8705
  8706 0400-FIRST-TIME.
  8707
  8708     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 164
* EL156.cbl
  8709        MOVE 'N'         TO WS-BROWSE-START-SW
  8710
  8711* EXEC CICS ENDBR
  8712*            DATASET    ('ELMSTR')
  8713*       END-EXEC.
  8714     MOVE 'ELMSTR' TO DFHEIV1
  8715     MOVE 0
  8716       TO DFHEIV11
  8717*    MOVE '&2                    $   #00008549' TO DFHEIV0
  8718     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8719     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8720     MOVE X'2020233030303038353439' TO DFHEIV0(25:11)
  8721     CALL 'kxdfhei1' USING DFHEIV0,
  8722           DFHEIV1,
  8723           DFHEIV11,
  8724           DFHEIV99
  8725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8726
  8727
  8728     IF PI-PROCESSOR-ID = 'LGXX'
  8729         NEXT SENTENCE
  8730     ELSE
  8731
  8732* EXEC CICS READQ TS
  8733*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8734*            INTO    (SECURITY-CONTROL)
  8735*            LENGTH  (SC-COMM-LENGTH)
  8736*            ITEM    (SC-ITEM)
  8737*        END-EXEC
  8738*    MOVE '*$II   L              ''   #00008556' TO DFHEIV0
  8739     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8740     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8741     MOVE X'2020233030303038353536' TO DFHEIV0(25:11)
  8742     CALL 'kxdfhei1' USING DFHEIV0,
  8743           PI-SECURITY-TEMP-STORE-ID,
  8744           SECURITY-CONTROL,
  8745           SC-COMM-LENGTH,
  8746           SC-ITEM,
  8747           DFHEIV99,
  8748           DFHEIV99
  8749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8750         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8751         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8752
  8753     MOVE LOW-VALUES             TO EL156AI.
  8754     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8755     MOVE 'Y'                    TO FIRST-ENTRY.
  8756     GO TO 7000-SHOW-CLAIM.
  8757
  8758 0500-CREATE-TEMP-STORAGE.
  8759     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8760
  8761
  8762* EXEC CICS WRITEQ TS
  8763*        QUEUE (QID)
  8764*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8765*        LENGTH(PI-COMM-LENGTH)
  8766*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 165
* EL156.cbl
  8767*    MOVE '*"                    ''   #00008573' TO DFHEIV0
  8768     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8769     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8770     MOVE X'2020233030303038353733' TO DFHEIV0(25:11)
  8771     CALL 'kxdfhei1' USING DFHEIV0,
  8772           QID,
  8773           PROGRAM-INTERFACE-BLOCK,
  8774           PI-COMM-LENGTH,
  8775           DFHEIV99,
  8776           DFHEIV99,
  8777           DFHEIV99
  8778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8779
  8780
  8781
  8782* EXEC CICS WRITEQ TS
  8783*        QUEUE (QID)
  8784*        FROM  (EL156AI)
  8785*        LENGTH(MAP-LENGTH)
  8786*    END-EXEC.
  8787*    MOVE '*"                    ''   #00008579' TO DFHEIV0
  8788     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8789     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8790     MOVE X'2020233030303038353739' TO DFHEIV0(25:11)
  8791     CALL 'kxdfhei1' USING DFHEIV0,
  8792           QID,
  8793           EL156AI,
  8794           MAP-LENGTH,
  8795           DFHEIV99,
  8796           DFHEIV99,
  8797           DFHEIV99
  8798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8799
  8800
  8801 0599-EXIT.
  8802      EXIT.
  8803
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 166
* EL156.cbl
  8805 0600-RECOVER-TEMP-STORAGE.
  8806
  8807* EXEC CICS READQ TS
  8808*        QUEUE (QID)
  8809*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8810*        LENGTH(PI-COMM-LENGTH)
  8811*    END-EXEC.
  8812*    MOVE '*$I    L              ''   #00008590' TO DFHEIV0
  8813     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8814     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8815     MOVE X'2020233030303038353930' TO DFHEIV0(25:11)
  8816     CALL 'kxdfhei1' USING DFHEIV0,
  8817           QID,
  8818           PROGRAM-INTERFACE-BLOCK,
  8819           PI-COMM-LENGTH,
  8820           DFHEIV99,
  8821           DFHEIV99,
  8822           DFHEIV99
  8823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8824
  8825
  8826
  8827* EXEC CICS READQ TS
  8828*        QUEUE (QID)
  8829*        INTO  (EL156AI)
  8830*        LENGTH(MAP-LENGTH)
  8831*    END-EXEC.
  8832*    MOVE '*$I    L              ''   #00008596' TO DFHEIV0
  8833     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8835     MOVE X'2020233030303038353936' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0,
  8837           QID,
  8838           EL156AI,
  8839           MAP-LENGTH,
  8840           DFHEIV99,
  8841           DFHEIV99,
  8842           DFHEIV99
  8843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8844
  8845
  8846     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8847
  8848     IF PMTTYPEI NOT = LOW-VALUES
  8849         MOVE AL-UANON           TO PMTTYPEA.
  8850
  8851     IF PAYEEI NOT = LOW-VALUES
  8852         MOVE AL-UANON           TO PAYEEA.
  8853
  8854     IF NOTE1I NOT = LOW-VALUES
  8855         MOVE AL-UANON           TO NOTE1A.
  8856
  8857     IF (RETURNED-FROM = 'EL614')
  8858        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8859     END-IF
  8860*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8861*       AND (PI-EOB-CODES-EXIST = 'Y')
  8862*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 167
* EL156.cbl
  8863*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8864     IF PI-SET-NOTE2-MDT = 'Y'
  8865         MOVE AL-SANON           TO NOTE2A
  8866     END-IF
  8867
  8868     IF OFFLINEI NOT = LOW-VALUES
  8869         MOVE AL-UANON           TO OFFLINEA.
  8870
  8871*    IF GROUPEDI NOT = LOW-VALUES
  8872*        MOVE AL-UANON           TO GROUPEDA.
  8873
  8874*    IF CASHI NOT = LOW-VALUES
  8875*        MOVE AL-UANON           TO CASHA.
  8876
  8877     IF CHECKNOI NOT = LOW-VALUES
  8878         MOVE AL-UANON           TO CHECKNOA.
  8879
  8880     IF HOLDTILI NOT = LOW-VALUES
  8881         MOVE AL-UANON           TO HOLDTILA.
  8882
  8883     IF EPYFROMI NOT = LOW-VALUES
  8884         MOVE AL-UANON           TO EPYFROMA.
  8885
  8886     IF AIGFROMI NOT = LOW-VALUES
  8887         MOVE AL-UANON           TO AIGFROMA.
  8888
  8889     IF EPYTHRUI NOT = LOW-VALUES
  8890         MOVE AL-UANON           TO EPYTHRUA.
  8891
  8892     IF EDAYSI NOT = LOW-VALUES
  8893         MOVE AL-UNNON           TO EDAYSA.
  8894
  8895     IF EPYAMTL NOT = +0
  8896         MOVE AL-UNNON           TO EPYAMTA.
  8897
  8898     IF ERESVL NOT = +0
  8899         MOVE AL-UNNON           TO ERESVA.
  8900
  8901     IF EEXPENSL NOT = +0
  8902         MOVE AL-UNNON           TO EEXPENSA.
  8903
  8904     IF ETYPEI NOT = LOW-VALUES
  8905         MOVE AL-UNNON           TO ETYPEA.
  8906
  8907     IF PROOFDTI NOT = 0
  8908         MOVE AL-UNNON           TO PROOFDTA.
  8909
  8910     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8911        MOVE AL-UANON            TO EOBYNA
  8912     END-IF
  8913     IF CLMFMYNI = 'Y' OR 'N'
  8914        MOVE AL-UANON            TO CLMFMYNA
  8915     END-IF
  8916
  8917     IF SURVYYNI = 'Y' OR 'N'
  8918        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8919           MOVE AL-UANON         TO SURVYYNA
  8920        END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 168
* EL156.cbl
  8921     END-IF
  8922
  8923     IF SPRELYNI = 'Y' OR 'N'
  8924        MOVE AL-UANON            TO SPRELYNA
  8925     END-IF
  8926
  8927     .
  8928 0699-EXIT.
  8929      EXIT.
  8930
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 169
* EL156.cbl
  8932 0700-TEST-FOR-CHANGES.
  8933     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8934         MOVE ER-0433            TO EMI-ERROR
  8935         GO TO 0750-FUNCTION-ERROR.
  8936
  8937     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8938
  8939     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  8940         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8941         MOVE 'A'                TO PI-PASS-SW
  8942         GO TO 1000-EDIT-DATA.
  8943
  8944     IF PI-FATAL-COUNT NOT = 0
  8945         MOVE ER-0499            TO EMI-ERROR
  8946         GO TO 0750-FUNCTION-ERROR.
  8947
  8948     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  8949         MOVE ER-0500            TO EMI-ERROR
  8950         GO TO 0750-FUNCTION-ERROR.
  8951
  8952     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  8953        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  8954           MOVE ER-0542          TO EMI-ERROR
  8955           MOVE -1               TO EPYAMTL
  8956           GO TO 0750-FUNCTION-ERROR.
  8957
  8958     IF PI-OFFLINE = 'Y'  OR
  8959        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  8960        MOVE EIBAID              TO PI-PFKEY-USED
  8961        GO TO 5000-UPDATE.
  8962
  8963     GO TO 6000-BUILD-SCREEN-B.
  8964
  8965 0750-FUNCTION-ERROR.
  8966     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8967
  8968     IF ENTERPFL > 0
  8969         MOVE -1                 TO ENTERPFL
  8970         MOVE AL-UNBON           TO ENTERPFA
  8971         GO TO 8200-SEND-DATAONLY
  8972     ELSE
  8973         MOVE -1                 TO ENTERPFL
  8974         MOVE AL-UNNOF           TO ENTERPFA
  8975         GO TO 8200-SEND-DATAONLY.
  8976
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 170
* EL156.cbl
  8978 0800-DELETE-TS.
  8979
  8980* EXEC CICS HANDLE CONDITION
  8981*        QIDERR(0800-EXIT)
  8982*    END-EXEC.
  8983*    MOVE '"$N                   ! % #00008735' TO DFHEIV0
  8984     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8985     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8986     MOVE X'2520233030303038373335' TO DFHEIV0(25:11)
  8987     CALL 'kxdfhei1' USING DFHEIV0
  8988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8989
  8990
  8991
  8992* EXEC CICS DELETEQ TS
  8993*        QUEUE(QID)
  8994*    END-EXEC.
  8995*    MOVE '*&                    #   #00008739' TO DFHEIV0
  8996     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8997     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8998     MOVE X'2020233030303038373339' TO DFHEIV0(25:11)
  8999     CALL 'kxdfhei1' USING DFHEIV0,
  9000           QID,
  9001           DFHEIV99
  9002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9003
  9004
  9005 0800-EXIT.
  9006      EXIT.
  9007 0900-GET-DDF-LIMITS.
  9008
  9009     if cm-clp-state = zeros or spaces or low-values
  9010        move cm-state            to cm-clp-state
  9011     end-if
  9012     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9013     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9014     MOVE cm-clp-state           TO ERPDEF-STATE
  9015     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9016     if (cl-claim-type = 'L' or 'P')
  9017        and (pi-lf-benefit-cd not = '00' and '  ' and 'DD')
  9018        move 'L'                 to erpdef-ben-type
  9019        move pi-lf-benefit-cd    to erpdef-ben-code
  9020     else
  9021        MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9022        MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9023     end-if
  9024     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9025
  9026     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9027
  9028
  9029* EXEC CICS STARTBR
  9030*        DATASET  ('ERPDEF')
  9031*        RIDFLD   (ERPDEF-KEY)
  9032*        GTEQ
  9033*        RESP     (WS-RESPONSE)
  9034*    END-EXEC
  9035     MOVE 'ERPDEF' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 171
* EL156.cbl
  9036     MOVE 0
  9037       TO DFHEIV11
  9038*    MOVE '&,         G          &  N#00008766' TO DFHEIV0
  9039     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9040     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9041     MOVE X'204E233030303038373636' TO DFHEIV0(25:11)
  9042     CALL 'kxdfhei1' USING DFHEIV0,
  9043           DFHEIV1,
  9044           ERPDEF-KEY,
  9045           DFHEIV99,
  9046           DFHEIV11,
  9047           DFHEIV99
  9048     MOVE EIBRESP  TO WS-RESPONSE
  9049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9050
  9051     IF NOT WS-RESP-NORMAL
  9052        GO TO 0900-EXIT
  9053     END-IF
  9054
  9055     .
  9056 0900-READNEXT.
  9057
  9058
  9059* EXEC CICS READNEXT
  9060*       DATASET  ('ERPDEF')
  9061*       SET      (ADDRESS OF PRODUCT-MASTER)
  9062*       RIDFLD   (ERPDEF-KEY)
  9063*       RESP     (WS-RESPONSE)
  9064*    END-EXEC
  9065     MOVE 'ERPDEF' TO DFHEIV1
  9066     MOVE 0
  9067       TO DFHEIV11
  9068*    MOVE '&.S                   )  N#00008780' TO DFHEIV0
  9069     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9070     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9071     MOVE X'204E233030303038373830' TO DFHEIV0(25:11)
  9072     CALL 'kxdfhei1' USING DFHEIV0,
  9073           DFHEIV1,
  9074           DFHEIV20,
  9075           DFHEIV99,
  9076           ERPDEF-KEY,
  9077           DFHEIV99,
  9078           DFHEIV11,
  9079           DFHEIV99,
  9080           DFHEIV99
  9081     SET ADDRESS OF PRODUCT-MASTER TO
  9082         DFHEIV20
  9083     MOVE EIBRESP  TO WS-RESPONSE
  9084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9085
  9086     IF NOT WS-RESP-NORMAL
  9087        GO TO 0900-ENDBR
  9088     END-IF
  9089
  9090     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9091        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9092           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9093        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 172
* EL156.cbl
  9094           GO TO 0900-READNEXT
  9095        END-IF
  9096     ELSE
  9097        GO TO 0900-ENDBR
  9098     END-IF
  9099
  9100     IF CM-LOAN-TERM = ZEROS
  9101        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9102     END-IF
  9103
  9104     .
  9105 0900-ENDBR.
  9106
  9107
  9108* EXEC CICS ENDBR
  9109*       DATASET  ('ERPDEF')
  9110*    END-EXEC
  9111     MOVE 'ERPDEF' TO DFHEIV1
  9112     MOVE 0
  9113       TO DFHEIV11
  9114*    MOVE '&2                    $   #00008808' TO DFHEIV0
  9115     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9116     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9117     MOVE X'2020233030303038383038' TO DFHEIV0(25:11)
  9118     CALL 'kxdfhei1' USING DFHEIV0,
  9119           DFHEIV1,
  9120           DFHEIV11,
  9121           DFHEIV99
  9122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9123
  9124     .
  9125 0900-EXIT.
  9126     EXIT.
  9127 1000-EDIT-DATA.
  9128
  9129     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9130         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9131         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9132
  9133     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9134
  9135     IF NOT MODIFY-CAP
  9136         MOVE ER-0070            TO EMI-ERROR
  9137         MOVE -1                 TO PMTTYPEL
  9138         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9139         GO TO 2000-EDIT-DONE.
  9140
  9141     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9142                         '5' AND '6'
  9143         MOVE ER-0420            TO EMI-ERROR
  9144         MOVE -1                 TO PMTTYPEL
  9145         MOVE AL-UABON           TO PMTTYPEA
  9146         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9147     ELSE
  9148         MOVE AL-UANON           TO PMTTYPEA.
  9149
  9150*    IF PI-OFFLINE = 'Y'
  9151*       IF PI-GROUPED = 'Y'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 173
* EL156.cbl
  9152*          MOVE ER-1880         TO EMI-ERROR
  9153*          MOVE -1              TO GROUPEDL
  9154*          MOVE AL-UABON        TO GROUPEDA
  9155*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9156*
  9157*    IF GROUPEDL > +0
  9158*       IF PI-GROUPED = 'Y' OR 'N'
  9159*          MOVE AL-UANON TO GROUPEDA
  9160*       ELSE
  9161*          MOVE ER-3140            TO EMI-ERROR
  9162*          MOVE -1                 TO GROUPEDL
  9163*          MOVE AL-UABON           TO GROUPEDA
  9164*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9165*
  9166*    IF CASHL > +0
  9167*       IF PI-CASH = 'Y' OR 'N'
  9168*          MOVE AL-UANON           TO CASHA
  9169*       ELSE
  9170*          MOVE ER-3141            TO EMI-ERROR
  9171*          MOVE -1                 TO CASHL
  9172*          MOVE AL-UABON           TO CASHA
  9173*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9174
  9175     IF LOANNOL > +0
  9176         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9177
  9178 1000-EDIT-PAYEE.
  9179
  9180     IF PI-PAYEE-SEQ NOT NUMERIC
  9181         MOVE ER-0294            TO  EMI-ERROR
  9182         MOVE -1                 TO  PAYEEL
  9183         MOVE AL-UABON           TO  PAYEEA
  9184         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9185         GO TO 1000-CONT-EDIT.
  9186
  9187     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9188                         'E' OR 'O' OR 'Q'
  9189         NEXT SENTENCE
  9190     ELSE
  9191         MOVE ER-0294            TO  EMI-ERROR
  9192         MOVE -1                 TO  PAYEEL
  9193         MOVE AL-UABON           TO  PAYEEA
  9194         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9195         GO TO 1000-CONT-EDIT.
  9196
  9197     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9198        (PI-PAYEE-SEQ NOT < '1' AND
  9199         PI-PAYEE-SEQ NOT > '9'))
  9200      OR
  9201        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9202         (PI-PAYEE-SEQ NOT > '9'))
  9203         MOVE AL-UANON            TO PAYEEA
  9204     ELSE
  9205         MOVE ER-0294            TO EMI-ERROR
  9206         MOVE -1                 TO PAYEEL
  9207         MOVE AL-UABON           TO PAYEEA
  9208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9209
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 174
* EL156.cbl
  9210     IF PI-COMPANY-ID = 'DMD'
  9211         IF PI-PAYEE-TYPE = 'B' AND
  9212            PI-PAYEE-SEQ NOT = '0'
  9213               MOVE ER-7841            TO EMI-ERROR
  9214               MOVE -1                 TO PAYEEL
  9215               MOVE AL-UABON           TO PAYEEA
  9216               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9217
  9218     IF PI-COMPANY-ID = 'JHL'
  9219         IF PI-PAYEE = 'B0'
  9220             NEXT SENTENCE
  9221           ELSE
  9222
  9223* EXEC CICS HANDLE CONDITION
  9224*            ENDFILE(1950-NOT-FOUND)
  9225*            NOTFND (1950-NOT-FOUND)
  9226*        END-EXEC
  9227*    MOVE '"$''I                  ! & #00008910' TO DFHEIV0
  9228     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9229     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9230     MOVE X'2620233030303038393130' TO DFHEIV0(25:11)
  9231     CALL 'kxdfhei1' USING DFHEIV0
  9232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9233         MOVE 'N'                    TO FOUND-TOL-SW
  9234         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9235         MOVE '2'                    TO CNTL-REC-TYPE
  9236         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9237         MOVE +0                     TO CNTL-SEQ-NO
  9238         MOVE 'PROC'                 TO FILE-SWITCH
  9239         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9240         IF PI-PAYEE = 'I1' AND
  9241            APPROVAL-LEVEL-2
  9242             NEXT SENTENCE
  9243           ELSE
  9244         IF NOT PI-USER-ALMIGHTY-YES
  9245             MOVE ER-3546        TO EMI-ERROR
  9246             MOVE -1             TO PAYEEL
  9247             MOVE AL-UABON       TO PAYEEA
  9248             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9249
  9250     IF PI-PAYEE-TYPE = 'E'
  9251        IF PI-PMTTYPE = '5' OR '6'
  9252            NEXT SENTENCE
  9253        ELSE
  9254            MOVE ER-3539            TO EMI-ERROR
  9255            MOVE -1                 TO PAYEEL
  9256            MOVE AL-UABON           TO PAYEEA
  9257            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9258
  9259 1000-CONT-EDIT.
  9260
  9261     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9262        IF PI-EPYAMT NOT NEGATIVE
  9263            MOVE ER-0421         TO EMI-ERROR
  9264            MOVE -1              TO OFFLINEL
  9265            MOVE AL-UABON        TO OFFLINEA
  9266            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9267        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 175
* EL156.cbl
  9268            MOVE AL-UANON        TO OFFLINEA.
  9269
  9270     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9271        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9272           CONTINUE
  9273        ELSE
  9274           IF PI-PRINT-EOB-YN = 'S' AND
  9275              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9276                CONTINUE
  9277           ELSE
  9278              MOVE ER-1561       TO EMI-ERROR
  9279              MOVE -1            TO EOBYNL
  9280              MOVE AL-UABON      TO EOBYNA
  9281              PERFORM 9900-ERROR-FORMAT
  9282                                 THRU 9900-EXIT
  9283           END-IF
  9284        END-IF
  9285
  9286        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9287            MOVE ER-1566        TO EMI-ERROR
  9288            MOVE -1             TO CLMFMYNL
  9289            MOVE AL-UABON       TO CLMFMYNA
  9290            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9291        END-IF
  9292
  9293        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9294            MOVE ER-1567        TO EMI-ERROR
  9295            MOVE -1             TO SURVYYNL
  9296            MOVE AL-UABON       TO SURVYYNA
  9297            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9298        END-IF
  9299
  9300        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9301            MOVE ER-1569        TO EMI-ERROR
  9302            MOVE -1             TO SPRELYNL
  9303            MOVE AL-UABON       TO SPRELYNA
  9304            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9305        END-IF
  9306
  9307     END-IF
  9308     IF PI-EPYAMT IS NEGATIVE
  9309         IF PI-OFFLINE NOT = 'Y'
  9310             MOVE ER-0836        TO  EMI-ERROR
  9311             MOVE -1             TO  OFFLINEL
  9312             MOVE AL-UABON       TO  OFFLINEA
  9313             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9314
  9315     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9316        MOVE ER-0872             TO EMI-ERROR
  9317        MOVE -1                  TO PROOFDTL
  9318        MOVE AL-UABON            TO PROOFDTA
  9319        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9320     ELSE
  9321        MOVE '4'                TO DC-OPTION-CODE
  9322        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9323        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9324        IF DATE-CONVERSION-ERROR
  9325            MOVE ER-0873        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 176
* EL156.cbl
  9326            MOVE -1                  TO PROOFDTL
  9327            MOVE AL-UABON            TO PROOFDTA
  9328            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9329        ELSE
  9330            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9331            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9332                MOVE ER-0873    TO EMI-ERROR
  9333                MOVE -1                  TO PROOFDTL
  9334                MOVE AL-UABON            TO PROOFDTA
  9335                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9336            END-IF
  9337        END-IF
  9338     END-IF.
  9339
  9340     IF PI-COMPANY-ID = 'DMD'
  9341        IF NOTE1L NOT = ZEROS
  9342            MOVE ER-7844        TO  EMI-ERROR
  9343            MOVE -1             TO  NOTE1L
  9344            MOVE AL-UABON       TO  NOTE1A
  9345            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9346
  9347     IF PI-COMPANY-ID = 'DMD'
  9348        IF NOTE2L NOT = ZEROS
  9349          GO TO 1004-DMD-EOB-CHECKS.
  9350
  9351     IF NOTE1L NOT > +0
  9352         GO TO 1005-CHECK-ERRORS.
  9353
  9354     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9355         GO TO 1005-CHECK-ERRORS.
  9356
  9357     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9358         GO TO 1003-HAN-PMT-NOTES.
  9359
  9360     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
  9361
  9362     IF WS-PMTOPTION NUMERIC
  9363        IF WS-PMTOPTION > '00' AND < '17'
  9364           NEXT SENTENCE
  9365        ELSE
  9366           MOVE ER-0618          TO EMI-ERROR
  9367           MOVE -1               TO NOTE1L
  9368           MOVE AL-UABON         TO NOTE1A
  9369           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9370     ELSE
  9371        GO TO 1005-CHECK-ERRORS.
  9372
  9373     IF WS-PMTOPTION = '05' AND
  9374        WS-DOCNAME = SPACES
  9375          MOVE ER-0616             TO EMI-ERROR
  9376          MOVE -1                  TO NOTE1L
  9377          MOVE AL-UABON            TO NOTE1A
  9378          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9379
  9380     IF WS-PMTOPTION = '15' OR '16'
  9381
  9382* EXEC CICS BIF DEEDIT
  9383*            FIELD (WS-AMOUNT)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 177
* EL156.cbl
  9384*            LENGTH(08)
  9385*        END-EXEC
  9386     MOVE 08
  9387       TO DFHEIV11
  9388*    MOVE '@"L                   #   #00009062' TO DFHEIV0
  9389     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9390     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9391     MOVE X'2020233030303039303632' TO DFHEIV0(25:11)
  9392     CALL 'kxdfhei1' USING DFHEIV0,
  9393           WS-AMOUNT,
  9394           DFHEIV11
  9395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9396        IF (WS-NUM-AMT = ZEROS) OR
  9397           (WS-AMOUNT NOT NUMERIC)
  9398           MOVE ER-0617          TO EMI-ERROR
  9399           MOVE -1               TO NOTE1L
  9400           MOVE AL-UABON         TO NOTE1A
  9401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9402
  9403     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9404
  9405     GO TO 1005-CHECK-ERRORS.
  9406
  9407 1003-HAN-PMT-NOTES.
  9408
  9409     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9410
  9411     IF WS-HAN-PMT-CODE = SPACE
  9412         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9413     ELSE
  9414     IF WS-HAN-PMT-CODE = 'A'
  9415         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9416                                 TO WS-HAN-PMT-NOTE
  9417     ELSE
  9418     IF WS-HAN-PMT-CODE = 'B'
  9419         MOVE ':FINAL PAYMENT / DECEASED'
  9420                                 TO WS-HAN-PMT-NOTE
  9421     ELSE
  9422     IF WS-HAN-PMT-CODE = 'C'
  9423         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9424                                 TO WS-HAN-PMT-NOTE
  9425     ELSE
  9426     IF WS-HAN-PMT-CODE = 'D'
  9427         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9428                                 TO WS-HAN-PMT-NOTE
  9429     ELSE
  9430     IF WS-HAN-PMT-CODE = 'E'
  9431         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9432                                 TO WS-HAN-PMT-NOTE
  9433     ELSE
  9434     IF WS-HAN-PMT-CODE = 'F'
  9435         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9436                                 TO WS-HAN-PMT-NOTE
  9437     ELSE
  9438     IF WS-HAN-PMT-CODE = 'P'
  9439         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9440
  9441     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 178
* EL156.cbl
  9442     GO TO 1005-CHECK-ERRORS.
  9443
  9444 1004-DMD-EOB-CHECKS.
  9445
  9446     INITIALIZE PI-AT-EOB-CODES.
  9447
  9448     IF NOTE2I (20:21) > SPACES
  9449         MOVE ER-7845          TO EMI-ERROR
  9450         MOVE -1               TO NOTE2L
  9451         MOVE AL-UABON         TO NOTE2A
  9452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9453         GO TO 1005-CHECK-ERRORS
  9454      ELSE
  9455         MOVE NOTE2I             TO W-EOB-CODES.
  9456
  9457     MOVE +1                     TO W-EOB-NDX.
  9458
  9459 1004-CHECK-EACH-EOB.
  9460
  9461     IF W-EOB-NDX > +5
  9462             OR
  9463        W-EOB-CODE (W-EOB-NDX) = SPACES
  9464         GO TO 1004-CHECK-DUP-EOB.
  9465
  9466     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9467         MOVE ER-0956            TO EMI-ERROR
  9468         MOVE -1                 TO NOTE2L
  9469         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9470         GO TO 1005-CHECK-ERRORS.
  9471
  9472     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9473     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9474     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9475     MOVE 'DLO023'               TO PGM-NAME.
  9476
  9477
  9478* EXEC CICS LINK
  9479*        PROGRAM    (PGM-NAME)
  9480*        COMMAREA   (CD-COMMUNICATION-AREA)
  9481*        LENGTH     (CD-RCRD-LENGTH)
  9482*    END-EXEC.
  9483*    MOVE '."C                   (   #00009147' TO DFHEIV0
  9484     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9486     MOVE X'2020233030303039313437' TO DFHEIV0(25:11)
  9487     CALL 'kxdfhei1' USING DFHEIV0,
  9488           PGM-NAME,
  9489           CD-COMMUNICATION-AREA,
  9490           CD-RCRD-LENGTH,
  9491           DFHEIV99,
  9492           DFHEIV99,
  9493           DFHEIV99,
  9494           DFHEIV99
  9495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9496
  9497
  9498     IF CD-RETURN-CODE = 'OK'
  9499         GO TO 1004-CONT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 179
* EL156.cbl
  9500
  9501     MOVE -1                     TO NOTE2L.
  9502
  9503     IF CD-RETURN-CODE = '01'
  9504         MOVE ER-8310            TO EMI-ERROR
  9505         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9506         GO TO 1005-CHECK-ERRORS.
  9507
  9508     IF CD-RETURN-CODE = '02'
  9509         MOVE ER-8311            TO EMI-ERROR
  9510         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9511         GO TO 1005-CHECK-ERRORS.
  9512
  9513     IF CD-RETURN-CODE = '03'
  9514         MOVE ER-8312            TO EMI-ERROR
  9515         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9516         GO TO 1005-CHECK-ERRORS.
  9517
  9518     IF CD-RETURN-CODE = '04'
  9519         MOVE ER-8313            TO EMI-ERROR
  9520         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9521         GO TO 1005-CHECK-ERRORS.
  9522
  9523     IF CD-RETURN-CODE = '05'
  9524         MOVE ER-8314            TO EMI-ERROR
  9525         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9526         GO TO 1005-CHECK-ERRORS.
  9527
  9528     IF CD-RETURN-CODE = '06'
  9529         MOVE ER-8315            TO EMI-ERROR
  9530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9531         GO TO 1005-CHECK-ERRORS.
  9532
  9533     IF CD-RETURN-CODE = 'E1'
  9534         MOVE ER-8316            TO EMI-ERROR
  9535         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9536         GO TO 1005-CHECK-ERRORS.
  9537
  9538     IF CD-RETURN-CODE = 'N1'
  9539         MOVE ER-8317            TO EMI-ERROR
  9540         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9541         GO TO 1005-CHECK-ERRORS.
  9542
  9543 1004-CONT.
  9544     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9545
  9546     ADD +1 TO W-EOB-NDX.
  9547     GO TO 1004-CHECK-EACH-EOB.
  9548
  9549 1004-CHECK-DUP-EOB.
  9550     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9551         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9552                               PI-AT-EOB-CODE (3) OR
  9553                               PI-AT-EOB-CODE (4) OR
  9554                               PI-AT-EOB-CODE (5)))
  9555                  OR
  9556        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9557         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 180
* EL156.cbl
  9558                               PI-AT-EOB-CODE (4) OR
  9559                               PI-AT-EOB-CODE (5)))
  9560                  OR
  9561        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9562         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9563                               PI-AT-EOB-CODE (5)))
  9564                  OR
  9565        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9566         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9567            MOVE ER-8000            TO EMI-ERROR
  9568            MOVE AL-UABON           TO NOTE2A
  9569            MOVE -1                 TO NOTE2L
  9570            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9571            GO TO 1005-CHECK-ERRORS.
  9572
  9573 1005-CHECK-ERRORS.
  9574*    IF PI-COMPANY-ID NOT = 'DMD'
  9575        GO TO 1006-CHECK-ERRORS.
  9576
  9577*********  DMD CODE START ******************
  9578*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9579*       GO TO 1006-CHECK-ERRORS.
  9580*
  9581*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9582*
  9583*    COMPUTE W-PAYMENT-TOTAL
  9584*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9585*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9586*               AND
  9587*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9588*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9589*          MOVE ER-0967    TO EMI-ERROR
  9590*          MOVE -1         TO PMTTYPEL
  9591*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9592*
  9593*    GO TO 1006-CHECK-ERRORS.
  9594*********  DMD CODE END ******************
  9595
  9596 1006-CHECK-ERRORS.
  9597     IF NOT EMI-NO-ERRORS
  9598        GO TO 2000-EDIT-DONE.
  9599
  9600
  9601* EXEC CICS HANDLE CONDITION
  9602*        NOTFND(1950-NOT-FOUND)
  9603*    END-EXEC.
  9604*    MOVE '"$I                   ! '' #00009255' TO DFHEIV0
  9605     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9607     MOVE X'2720233030303039323535' TO DFHEIV0(25:11)
  9608     CALL 'kxdfhei1' USING DFHEIV0
  9609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9610
  9611
  9612     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9613     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9614     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9615     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 181
* EL156.cbl
  9616     MOVE 'MSTR'                 TO FILE-SWITCH.
  9617
  9618     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9619
  9620     IF PI-COMPANY-ID = 'DMD'
  9621         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9622
  9623     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9624        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9625           MOVE ER-0873    TO EMI-ERROR
  9626           MOVE -1                  TO PROOFDTL
  9627           MOVE AL-UABON            TO PROOFDTA
  9628           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9629        END-IF
  9630     END-IF
  9631     if cl-benefit-period = zeros
  9632        move er-1667             to emi-error
  9633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9634     end-if
  9635     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9636     MOVE +95                    TO TRLR-SEQ-NO
  9637
  9638* EXEC CICS READ
  9639*       DATASET  ('ELTRLR')
  9640*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9641*       RIDFLD   (ELTRLR-KEY)
  9642*       RESP     (WS-RESPONSE)
  9643*    END-EXEC
  9644     MOVE 'ELTRLR' TO DFHEIV1
  9645*    MOVE '&"S        E          (  N#00009284' TO DFHEIV0
  9646     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9648     MOVE X'204E233030303039323834' TO DFHEIV0(25:11)
  9649     CALL 'kxdfhei1' USING DFHEIV0,
  9650           DFHEIV1,
  9651           DFHEIV20,
  9652           DFHEIV99,
  9653           ELTRLR-KEY,
  9654           DFHEIV99,
  9655           DFHEIV99,
  9656           DFHEIV99
  9657     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9658         DFHEIV20
  9659     MOVE EIBRESP  TO WS-RESPONSE
  9660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9661
  9662     if ws-resp-normal
  9663        perform varying s1 from +1 by +1 until
  9664           at-note-error-no (s1) = spaces
  9665           if at-note-error-no (s1) = '1662'
  9666              continue
  9667           else
  9668              move at-note-error-no (s1)
  9669                                 to emi-error
  9670              if at-note-error-no (s1) = '1653'
  9671                 evaluate true
  9672                    when cl-claim-type = 'L'
  9673                       move '  LF  '
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 182
* EL156.cbl
  9674                                 to emi-claim-type
  9675                    when cl-claim-type = 'I'
  9676                       move '  IU  '
  9677                                 to emi-claim-type
  9678                    when cl-claim-type = 'A'
  9679                       move '  AH  '
  9680                                 to emi-claim-type
  9681                    when other
  9682                       move ' FMLA '
  9683                                 to emi-claim-type
  9684                 end-evaluate
  9685              end-if
  9686              PERFORM 9900-ERROR-FORMAT
  9687                                 THRU 9900-EXIT
  9688           end-if
  9689        end-perform
  9690     end-if
  9691     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9692         IF PI-PMTTYPE = '5' OR '6'
  9693             NEXT SENTENCE
  9694         ELSE
  9695             MOVE ER-0555             TO EMI-ERROR
  9696             MOVE -1                  TO PMTTYPEL
  9697             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9698
  9699     IF CL-LAST-CLOSE-REASON = '2'
  9700         IF CL-CLAIM-STATUS = 'C'
  9701             MOVE ER-0760        TO  EMI-ERROR
  9702             MOVE -1             TO  PMTTYPEL
  9703             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9704
  9705     IF PI-ACTIVITY-CODE = 9
  9706         MOVE ER-3538            TO  EMI-ERROR
  9707         MOVE -1                 TO  PMTTYPEL
  9708         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9709
  9710     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9711         GO TO 1008-READ-CERT.
  9712**********************AIG LOGIC STARTS *********************
  9713     IF CL-CERT-PRIME = 'INCOMPLETE'
  9714         MOVE ER-3540            TO  EMI-ERROR
  9715         MOVE -1                 TO  PMTTYPEL
  9716         MOVE AL-UABON           TO  PMTTYPEA
  9717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9718         GO TO 2000-EDIT-DONE.
  9719
  9720     IF PI-PMTTYPE = '4'
  9721         IF PI-EPYAMT IS NEGATIVE
  9722             IF PI-ECHECKNO-CR = 'CR'
  9723                 NEXT SENTENCE
  9724             ELSE
  9725                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9726
  9727     IF PI-PMTTYPE = '4'
  9728         IF PI-ECHECKNO-CR = 'CR'
  9729             IF PI-EPYAMT IS NEGATIVE
  9730                 NEXT SENTENCE
  9731             ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 183
* EL156.cbl
  9732                 MOVE ER-0834    TO  EMI-ERROR
  9733                 MOVE -1         TO  EPYAMTL
  9734                 MOVE AL-UNBON   TO  EPYAMTA
  9735                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9736
  9737     IF PI-PMTTYPE = '4'
  9738         IF PI-EPYAMT IS NEGATIVE
  9739             IF PI-OFFLINE = 'Y'
  9740                 NEXT SENTENCE
  9741             ELSE
  9742                 MOVE 'Y'        TO  PI-OFFLINE
  9743                                     WS-OFFLINE
  9744                                     OFFLINEO
  9745                 MOVE AL-UANON   TO  OFFLINEA.
  9746
  9747*    IF PI-PMTTYPE = '4'
  9748*        IF PI-EPYAMT IS NEGATIVE
  9749*            IF PI-CASH = 'Y'
  9750*                NEXT SENTENCE
  9751*            ELSE
  9752*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9753*                MOVE AL-UANON   TO  CASHA
  9754*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9755*
  9756*    IF PI-CASH NOT = 'Y' AND 'N'
  9757*         IF PI-OFFLINE = 'Y'  AND
  9758*            PI-ECHECKNO-CR = 'CR'
  9759*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9760*              MOVE AL-UANON     TO  CASHA
  9761*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9762*
  9763*    IF PI-CASH NOT = 'Y' AND 'N'
  9764*        IF PI-PMTTYPE = '5' OR '6'
  9765*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9766*            MOVE AL-UANON       TO  CASHA
  9767*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9768*
  9769*    IF PI-CASH NOT = 'Y' AND 'N'
  9770*       IF CL-ASSOCIATES = 'N' OR 'A'
  9771*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9772*           MOVE AL-UANON        TO  CASHA
  9773*       ELSE
  9774*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9775*           MOVE AL-UANON        TO  CASHA.
  9776*
  9777*    IF PI-PMTTYPE = '5' OR '6'
  9778*        IF PI-CASH = 'N'
  9779*            MOVE ER-0819        TO  EMI-ERROR
  9780*            MOVE AL-UANON       TO  CASHA
  9781*            MOVE -1             TO  CASHL
  9782*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9783*
  9784*    IF CL-ASSOCIATES = 'N' OR 'A'
  9785*       IF CASHI = 'N'
  9786*        MOVE ER-3537            TO  EMI-ERROR
  9787*        MOVE AL-UANON           TO  CASHA
  9788*        MOVE -1                 TO  CASHL
  9789*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 184
* EL156.cbl
  9790
  9791 1007-DEFAULT-AIG-CHECKNO.
  9792
  9793     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9794         MOVE ER-3532            TO  EMI-ERROR
  9795         MOVE -1                 TO  PMTTYPEL
  9796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9797**********************AIG LOGIC ENDS ***********************
  9798
  9799 1008-READ-CERT.
  9800
  9801     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9802     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9803     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9804     MOVE CL-CERT-STATE          TO CERT-STATE.
  9805     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9806     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9807     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9808     MOVE 'CERT'                 TO FILE-SWITCH.
  9809
  9810     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9811
  9812     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9813         MOVE CM-LF-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT
  9814     ELSE
  9815         MOVE CM-AH-LOAN-EXPIRE-DT  TO WS-EXP-DT PI-EXP-DT.
  9816
  9817*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9818*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9819
  9820     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9821         MOVE ER-0458            TO EMI-ERROR
  9822         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9823
  9824     IF CL-INCURRED-DT NOT < WS-EXP-DT
  9825         MOVE ER-0459            TO EMI-ERROR
  9826         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9827
  9828     IF CL-REPORTED-DT = LOW-VALUES
  9829        MOVE ER-0530             TO EMI-ERROR
  9830        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9831
  9832     IF PI-COMPANY-ID = 'NCL'
  9833        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9834            MOVE ER-0770            TO EMI-ERROR
  9835            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9836
  9837     IF PI-COMPANY-ID = 'NCL'
  9838        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9839            MOVE ER-0737            TO EMI-ERROR
  9840            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9841
  9842     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9843         MOVE ER-0768            TO  EMI-ERROR
  9844         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9845
  9846     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9847         MOVE ER-0769            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 185
* EL156.cbl
  9848         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9849
  9850     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9851         GO TO 1020-DO-LIFE-EDITS
  9852     ELSE
  9853         GO TO 1030-DO-AH-EDITS.
  9854
  9855 1010-GENERAL-ERROR.
  9856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9857
  9858     IF EMI-MESSAGE-FORMATTED
  9859         MOVE -1                 TO PMTTYPEL.
  9860
  9861 1010-EXIT.
  9862     EXIT.
  9863
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 186
* EL156.cbl
  9865 1020-DO-LIFE-EDITS.
  9866     IF CM-LF-BENEFIT-CD = '00'
  9867         IF PI-PMTTYPE = '5' OR '6'
  9868             MOVE ER-0658        TO EMI-ERROR
  9869             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9870         ELSE
  9871             MOVE ER-1775        TO EMI-ERROR
  9872             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9873
  9874     move cm-ah-benefit-cd to pi-ah-benefit-cd
  9875     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  9876         MOVE ER-0460            TO EMI-ERROR
  9877         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9878
  9879     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
  9880     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
  9881     MOVE WS-ACCESS              TO  CNTL-ACCESS.
  9882     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9883     MOVE '4'                    TO  CNTL-REC-TYPE.
  9884     MOVE ZEROS                  TO  CNTL-SEQ-NO.
  9885     MOVE 'BENE'                 TO  FILE-SWITCH.
  9886     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9887     IF NO-BENEFIT-FOUND
  9888         GO TO 1950-NOT-FOUND.
  9889
  9890     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
  9891
  9892     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
  9893         IF PI-PMTTYPE = '4'
  9894             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9895                PI-LF-COVERAGE-TYPE = 'P'
  9896                 NEXT SENTENCE
  9897             ELSE
  9898                 MOVE ER-0461        TO EMI-ERROR
  9899                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9900         ELSE
  9901            NEXT SENTENCE
  9902     ELSE
  9903         IF PI-PMTTYPE = '2'
  9904            IF NOT CM-O-B-COVERAGE
  9905              AND CM-LF-CURRENT-STATUS = '7'
  9906                MOVE ER-0462     TO EMI-ERROR
  9907                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9908
  9909     IF PI-PMTTYPE = '2'
  9910         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
  9911            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
  9912             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
  9913             MOVE ER-0730            TO  EMI-ERROR
  9914             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9915             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
  9916
  9917     IF PI-PMTTYPE = '2'
  9918         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9919            PI-LF-COVERAGE-TYPE = 'P'
  9920             IF CL-PAID-THRU-DT = CL-INCURRED-DT
  9921                 MOVE ER-0462    TO  EMI-ERROR
  9922                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 187
* EL156.cbl
  9923
  9924     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  9925       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
  9926         MOVE ER-0466            TO EMI-ERROR
  9927         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9928
  9929     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
  9930         IF PI-PMTTYPE = '3'
  9931             MOVE 0436           TO EMI-ERROR
  9932             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9933             GO TO 1045-EDIT-PAYEE-ADDR
  9934         ELSE
  9935             GO TO 1045-EDIT-PAYEE-ADDR.
  9936
  9937     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
  9938        PI-LF-COVERAGE-TYPE = 'P'
  9939         IF PI-PMTTYPE = '3'
  9940             MOVE ER-0436          TO  EMI-ERROR
  9941             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9942         ELSE
  9943             NEXT SENTENCE
  9944     ELSE
  9945         IF PI-PMTTYPE = '1' OR '3'
  9946             MOVE ER-0436            TO EMI-ERROR
  9947             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9948*
  9949     IF PI-COMPANY-ID = 'CID' AND
  9950        CL-CERT-STATE = 'SC'  AND
  9951        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  9952           MOVE ER-0879    TO  EMI-ERROR
  9953           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9954           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
  9955     END-IF.
  9956     IF PI-COMPANY-ID = 'AHL'
  9957        evaluate true
  9958           when CM-LF-BENEFIT-CD = '5I' OR '6J'
  9959              MOVE ER-0879       TO  EMI-ERROR
  9960              PERFORM 1040-PMTTYPE-ERROR
  9961                                 THRU 1040-EXIT
  9962              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
  9963           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
  9964                 '6D' OR '6H' OR '6R'
  9965              MOVE ER-0879       TO  EMI-ERROR
  9966              PERFORM 1040-PMTTYPE-ERROR
  9967                                 THRU 1040-EXIT
  9968              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
  9969           when CM-LF-BENEFIT-CD = '5M' OR '6M'
  9970              MOVE ER-0879       TO  EMI-ERROR
  9971              PERFORM 1040-PMTTYPE-ERROR
  9972                                 THRU 1040-EXIT
  9973              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
  9974        end-evaluate
  9975     END-IF
  9976     GO TO 1045-EDIT-PAYEE-ADDR.
  9977
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 188
* EL156.cbl
  9979 1030-DO-AH-EDITS.
  9980     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
  9981     IF CM-AH-BENEFIT-CD = '00'
  9982         IF PI-PMTTYPE = '5' OR '6'
  9983             MOVE ER-0658        TO EMI-ERROR
  9984             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9985         ELSE
  9986             MOVE ER-1775        TO EMI-ERROR
  9987             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9988
  9989     IF CL-TOTAL-PAID-AMT = ZEROS
  9990         IF PI-PMTTYPE = '4'
  9991             MOVE ER-0438        TO EMI-ERROR
  9992             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
  9993
  9994     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
  9995         IF PI-PMTTYPE = '3'
  9996             MOVE ER-0463        TO EMI-ERROR
  9997             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9998         ELSE
  9999             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10000              AND CM-LF-CURRENT-STATUS = '7'
 10001                 MOVE ER-0465    TO EMI-ERROR
 10002                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10003
 10004     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10005         IF PI-PMTTYPE = '3'
 10006             MOVE ER-0464        TO EMI-ERROR
 10007             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10008         ELSE
 10009             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10010                 MOVE ER-0469    TO EMI-ERROR
 10011                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10012
 10013     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10014         IF PI-PMTTYPE = '3'
 10015             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10016                 MOVE ER-0467    TO EMI-ERROR
 10017                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10018             ELSE
 10019                 NEXT SENTENCE
 10020         ELSE
 10021             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10022                 MOVE ER-0468    TO EMI-ERROR
 10023                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10024
 10025     GO TO 1045-EDIT-PAYEE-ADDR.
 10026
 10027 1040-PMTTYPE-ERROR.
 10028     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10029
 10030     IF EMI-MESSAGE-FORMATTED
 10031         MOVE -1                 TO PMTTYPEL
 10032         MOVE AL-UABON           TO PMTTYPEA.
 10033
 10034 1040-EXIT.
 10035     EXIT.
 10036
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 189
* EL156.cbl
 10038 1045-EDIT-PAYEE-ADDR.
 10039
 10040     IF PI-OFFLINE = 'N' AND
 10041        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10042           < PI-PAYEE-SEQ-NUM)
 10043        OR
 10044         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10045         (PI-PAYEE-TYPE = 'B')                 AND
 10046         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10047        OR
 10048         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10049           < PI-PAYEE-SEQ-NUM)
 10050        OR
 10051         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10052           < PI-PAYEE-SEQ-NUM)
 10053        OR
 10054         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10055           < PI-PAYEE-SEQ-NUM)
 10056        OR
 10057         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10058           < PI-PAYEE-SEQ-NUM)
 10059        OR
 10060         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10061           < PI-PAYEE-SEQ-NUM))
 10062             MOVE ER-0437        TO EMI-ERROR
 10063             MOVE -1             TO PAYEEL
 10064             MOVE AL-UABON       TO PAYEEA
 10065             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10066
 10067     IF PI-OFFLINE    = 'N' AND
 10068        PI-PAYEE-TYPE = 'B' AND
 10069        PI-PAYEE-SEQ  = '0'
 10070         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10071         IF BENE-FOUND-SW = 'N'
 10072             MOVE ER-0437        TO EMI-ERROR
 10073             MOVE -1             TO PAYEEL
 10074             MOVE AL-UABON       TO PAYEEA
 10075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10076
 10077     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10078        IF PI-OFFLINE    = 'N'  AND
 10079           PI-PAYEE-TYPE = 'B'  AND
 10080           PI-PAYEE-SEQ  = '9'
 10081             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10082             IF BENE-FOUND-SW = 'N'
 10083                MOVE ER-0437        TO EMI-ERROR
 10084                MOVE -1             TO PAYEEL
 10085                MOVE AL-UABON       TO PAYEEA
 10086                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10087
 10088*    IF PI-COMPANY-ID = 'CRI'
 10089*        IF CL-CLAIM-TYPE = 'L'
 10090*            MOVE 'N'                TO  WS-GROUPED
 10091*                                        PI-GROUPED
 10092*                                        GROUPEDI
 10093*            MOVE AL-UANON           TO  GROUPEDA
 10094*            GO TO 1050-EDIT-CHECK-NO
 10095*        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 190
* EL156.cbl
 10096*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10097*            IF WS-GROUP-1 = 'C'
 10098*                NEXT SENTENCE
 10099*            ELSE
 10100*                MOVE 'N'            TO  WS-GROUPED
 10101*                                        PI-GROUPED
 10102*                                        GROUPEDI
 10103*                MOVE AL-UANON       TO  GROUPEDA
 10104*                GO TO 1050-EDIT-CHECK-NO.
 10105
 10106*     IF PI-GROUPED = 'Y'
 10107*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10108*           NEXT SENTENCE
 10109*        ELSE
 10110*           MOVE ER-0437        TO EMI-ERROR
 10111*           MOVE -1             TO PAYEEL
 10112**02180            MOVE AL-UABON       TO PAYEEA
 10113*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10114*
 10115*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10116*        (PI-GROUPED    = ' ')
 10117*        NEXT SENTENCE
 10118*     ELSE
 10119*
 10120     GO TO 1050-EDIT-CHECK-NO.
 10121*     IF PI-COMPANY-ID = 'CRI'
 10122*        MOVE 'N'           TO GROUPEDI
 10123*                              PI-GROUPED
 10124*                              WS-GROUPED
 10125*        MOVE AL-UANON      TO GROUPEDA.
 10126*
 10127*     IF PI-COMPANY-ID = 'CRI'
 10128*        IF PI-PAYEE-TYPE = 'B'
 10129*           IF BENE-FOUND-SW = 'Y'
 10130*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10131*                 MOVE 'Y'           TO GROUPEDI
 10132*                                       PI-GROUPED
 10133*                                       WS-GROUPED
 10134*                 MOVE AL-UANON      TO GROUPEDA
 10135*              ELSE
 10136*                 NEXT SENTENCE
 10137*           ELSE
 10138*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10139*              IF BENE-FOUND-SW = 'Y'
 10140*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10141*                    MOVE 'Y'      TO GROUPEDI
 10142*                                     PI-GROUPED
 10143*                                     WS-GROUPED
 10144*                    MOVE AL-UANON TO GROUPEDA.
 10145*
 10146
 10147     IF PI-COMPANY-ID NOT = 'CRI'
 10148        GO TO 1050-EDIT-CHECK-NO.
 10149
 10150*************** CRI CODE START ******************
 10151     IF PI-PAYEE-TYPE NOT = 'A'
 10152        GO TO 1050-EDIT-CHECK-NO.
 10153
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 191
* EL156.cbl
 10154     MOVE LOW-VALUES             TO ERACCT-KEY.
 10155     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10156     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10157     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10158     MOVE PI-STATE               TO ACCT-STATE.
 10159     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10160     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10161     MOVE 'ACCT'                 TO FILE-SWITCH.
 10162
 10163     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10164     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10165
 10166
 10167* EXEC CICS HANDLE CONDITION
 10168*         NOTFND   (1950-NOT-FOUND)
 10169*         ENDFILE  (1950-NOT-FOUND)
 10170*    END-EXEC.
 10171*    MOVE '"$I''                  ! ( #00009795' TO DFHEIV0
 10172     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10174     MOVE X'2820233030303039373935' TO DFHEIV0(25:11)
 10175     CALL 'kxdfhei1' USING DFHEIV0
 10176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10177
 10178
 10179
 10180* EXEC CICS STARTBR
 10181*         DATASET   ('ERACCT')
 10182*         RIDFLD    (ERACCT-KEY)
 10183*         GTEQ
 10184*    END-EXEC.
 10185     MOVE 'ERACCT' TO DFHEIV1
 10186     MOVE 0
 10187       TO DFHEIV11
 10188*    MOVE '&,         G          &   #00009800' TO DFHEIV0
 10189     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10190     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10191     MOVE X'2020233030303039383030' TO DFHEIV0(25:11)
 10192     CALL 'kxdfhei1' USING DFHEIV0,
 10193           DFHEIV1,
 10194           ERACCT-KEY,
 10195           DFHEIV99,
 10196           DFHEIV11,
 10197           DFHEIV99
 10198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10199
 10200
 10201 1046-READNEXT-ERACCT.
 10202
 10203
 10204* EXEC CICS READNEXT
 10205*         DATASET   ('ERACCT')
 10206*         RIDFLD    (ERACCT-KEY)
 10207*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10208*    END-EXEC.
 10209     MOVE 'ERACCT' TO DFHEIV1
 10210     MOVE 0
 10211       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 192
* EL156.cbl
 10212*    MOVE '&.S                   )   #00009808' TO DFHEIV0
 10213     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10214     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10215     MOVE X'2020233030303039383038' TO DFHEIV0(25:11)
 10216     CALL 'kxdfhei1' USING DFHEIV0,
 10217           DFHEIV1,
 10218           DFHEIV20,
 10219           DFHEIV99,
 10220           ERACCT-KEY,
 10221           DFHEIV99,
 10222           DFHEIV11,
 10223           DFHEIV99,
 10224           DFHEIV99
 10225     SET ADDRESS OF ACCOUNT-MASTER TO
 10226         DFHEIV20
 10227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10228
 10229
 10230     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10231        IF WS-ERACCT-HOLD-RECORD = SPACES
 10232           GO TO 1950-NOT-FOUND
 10233        ELSE
 10234           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10235           GO TO 1048-CONTINUE.
 10236
 10237     IF ACCT-EXP-DT = HIGH-VALUES
 10238        NEXT SENTENCE
 10239     ELSE
 10240        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10241        GO TO 1046-READNEXT-ERACCT.
 10242
 10243 1048-CONTINUE.
 10244
 10245*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10246*       MOVE 'Y'                 TO GROUPEDI
 10247*                                   PI-GROUPED
 10248*                                   WS-GROUPED
 10249*       MOVE AL-UANON            TO GROUPEDA.
 10250*************** CRI CODE END ******************
 10251
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 193
* EL156.cbl
 10253 1050-EDIT-CHECK-NO.
 10254
 10255     IF PI-OFFLINE = 'Y'
 10256         IF PI-ECHECKNO = SPACES
 10257              MOVE ER-0439        TO EMI-ERROR
 10258              GO TO 1090-CHECK-NO-ERROR
 10259           ELSE
 10260*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10261*           IF PI-ECHECKNO-N = 'N' AND
 10262*              PI-CASH       = 'Y'
 10263*                MOVE ER-3535        TO EMI-ERROR
 10264*                GO TO 1090-CHECK-NO-ERROR
 10265*             ELSE
 10266*                MOVE AL-UANON    TO CHECKNOA
 10267*                GO TO 1100-EDIT-HOLDTIL
 10268*         ELSE
 10269            MOVE AL-UANON    TO CHECKNOA
 10270            GO TO 1100-EDIT-HOLDTIL.
 10271
 10272     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10273     MOVE '6'                    TO CNTL-REC-TYPE.
 10274
 10275     IF CONTROL-IS-ACTUAL-CARRIER
 10276         MOVE PI-CARRIER         TO WS-CARR
 10277     ELSE
 10278         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10279
 10280     IF PI-COMPANY-ID = 'FIA'
 10281         MOVE PI-CARRIER         TO WS-CARR.
 10282
 10283     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10284     MOVE 0                      TO CNTL-SEQ-NO.
 10285     MOVE 'CARR'                 TO FILE-SWITCH.
 10286
 10287     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10288
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 194
* EL156.cbl
 10290     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10291         GO TO 1051-EDIT-CHECKNO-CONT.
 10292
 10293**********************AIG LOGIC STARTS**********************
 10294     IF PI-ECHECKNO = SPACES
 10295         IF CHECK-NO-MANUAL
 10296             MOVE ER-0441        TO EMI-ERROR
 10297             GO TO 1090-CHECK-NO-ERROR
 10298         ELSE
 10299             MOVE AL-UANOF       TO CHECKNOA
 10300             GO TO 1100-EDIT-HOLDTIL.
 10301
 10302     IF PI-ECHECKNO NOT = SPACES
 10303         IF CHECK-NO-MANUAL
 10304             MOVE AL-UANON       TO CHECKNOA
 10305             GO TO 1100-EDIT-HOLDTIL.
 10306
 10307     IF PI-ECHECKNO-CR = 'CR'
 10308        IF PI-OFFLINE = 'Y'
 10309            MOVE AL-UANON       TO CHECKNOA
 10310            GO TO 1100-EDIT-HOLDTIL
 10311        ELSE
 10312            MOVE ER-3534        TO EMI-ERROR
 10313            GO TO 1090-CHECK-NO-ERROR.
 10314
 10315     IF PI-ECHECKNO-N = 'N'
 10316        IF PI-CASH = 'N'
 10317            MOVE AL-UANON       TO CHECKNOA
 10318            GO TO 1100-EDIT-HOLDTIL
 10319        ELSE
 10320            MOVE ER-3535          TO EMI-ERROR
 10321            GO TO 1090-CHECK-NO-ERROR.
 10322
 10323     MOVE ER-0442        TO EMI-ERROR
 10324     GO TO 1090-CHECK-NO-ERROR.
 10325**********************AIG LOGIC ENDS************************
 10326
 10327 1051-EDIT-CHECKNO-CONT.
 10328
 10329     IF PI-COMPANY-ID = 'DMD'
 10330        IF PI-ECHECKNO NOT = SPACES
 10331           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10332              MOVE ER-0442        TO EMI-ERROR
 10333              GO TO 1090-CHECK-NO-ERROR
 10334            ELSE
 10335              GO TO 1100-EDIT-HOLDTIL
 10336          ELSE
 10337           GO TO 1100-EDIT-HOLDTIL.
 10338
 10339     IF PI-ECHECKNO = SPACES
 10340         IF CHECK-NO-MANUAL
 10341             MOVE ER-0441        TO EMI-ERROR
 10342             GO TO 1090-CHECK-NO-ERROR
 10343         ELSE
 10344             MOVE AL-UANOF       TO CHECKNOA
 10345             GO TO 1100-EDIT-HOLDTIL
 10346     ELSE
 10347         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 195
* EL156.cbl
 10348             MOVE AL-UANON       TO CHECKNOA
 10349             GO TO 1100-EDIT-HOLDTIL
 10350         ELSE
 10351             MOVE ER-0442        TO EMI-ERROR
 10352             GO TO 1090-CHECK-NO-ERROR.
 10353
 10354 1090-CHECK-NO-ERROR.
 10355     MOVE -1                     TO CHECKNOL.
 10356     MOVE AL-UABON               TO CHECKNOA.
 10357     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10358
 10359     GO TO 2000-EDIT-DONE.
 10360
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 196
* EL156.cbl
 10362 1100-EDIT-HOLDTIL.
 10363     MOVE AL-UANON               TO HOLDTILA.
 10364
 10365     IF PI-HOLDTIL = ZEROS
 10366        IF PI-OFFLINE = 'Y'
 10367           MOVE ER-0572          TO EMI-ERROR
 10368           GO TO 1105-HOLDTIL-ERROR
 10369        ELSE
 10370           GO TO 1110-EDIT-PAID-FROM.
 10371
 10372     MOVE '4'                    TO DC-OPTION-CODE.
 10373     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10374     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10375
 10376     IF DATE-CONVERSION-ERROR
 10377         MOVE ER-0446            TO EMI-ERROR
 10378         GO TO 1105-HOLDTIL-ERROR
 10379     END-IF
 10380     IF PI-OFFLINE = 'Y'
 10381        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10382           MOVE ER-0446            TO EMI-ERROR
 10383           GO TO 1105-HOLDTIL-ERROR
 10384        END-IF
 10385     END-IF
 10386
 10387     IF PI-OFFLINE = 'Y'
 10388        GO TO 1110-EDIT-PAID-FROM.
 10389
 10390     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10391     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10392     MOVE '1'                    TO DC-OPTION-CODE.
 10393     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10394
 10395     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10396         MOVE ER-0447            TO EMI-ERROR
 10397         GO TO 1105-HOLDTIL-ERROR.
 10398
 10399     GO TO 1110-EDIT-PAID-FROM.
 10400
 10401 1105-HOLDTIL-ERROR.
 10402     MOVE -1                     TO HOLDTILL.
 10403     MOVE AL-UNBON               TO HOLDTILA.
 10404     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10405
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 197
* EL156.cbl
 10407 1110-EDIT-PAID-FROM.
 10408     MOVE AL-UANON               TO EPYFROMA.
 10409
 10410     IF PI-EPYFROM = ZEROS
 10411         GO TO 1120-CALCULATE-PAID-FROM.
 10412
 10413     IF PI-PMTTYPE = '5' OR '6'
 10414         MOVE ER-0448            TO EMI-ERROR
 10415         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10416         MOVE AL-UNBON           TO EPYFROMA
 10417         MOVE -1                 TO EPYFROML
 10418         GO TO 1150-EDIT-PAID-THRU.
 10419
 10420     MOVE '4'                    TO DC-OPTION-CODE.
 10421     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10422     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10423
 10424     IF DATE-CONVERSION-ERROR
 10425         MOVE ER-0449            TO EMI-ERROR
 10426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10427         MOVE AL-UNBON           TO EPYFROMA
 10428         MOVE -1                 TO EPYFROML
 10429     ELSE
 10430         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10431
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 198
* EL156.cbl
 10433 1120-CALCULATE-PAID-FROM.
 10434     IF PI-PMTTYPE = '5' OR '6'
 10435         GO TO 1150-EDIT-PAID-THRU.
 10436
 10437*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10438*       IF PI-PMTTYPE = '4'
 10439*         GO TO 1150-EDIT-PAID-THRU.
 10440
 10441     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10442         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10443         MOVE ' '                TO DC-OPTION-CODE
 10444         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10445         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10446         GO TO 1145-TEST-PAID-FROM.
 10447
 10448     IF PI-PMTTYPE = '4'
 10449        GO TO 1150-EDIT-PAID-THRU.
 10450
 10451     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10452     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10453     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10454     MOVE '5'                    TO CNTL-REC-TYPE.
 10455     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10456     MOVE 'BENE'                 TO FILE-SWITCH.
 10457
 10458     IF WS-BEN-CD = ZEROS
 10459         GO TO 1950-NOT-FOUND.
 10460
 10461     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10462
 10463     IF NO-BENEFIT-FOUND
 10464         GO TO 1950-NOT-FOUND.
 10465
 10466     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10467     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10468
 10469     IF PI-BEN-DAYS NOT NUMERIC
 10470        MOVE ZEROS               TO PI-BEN-DAYS.
 10471
 10472     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10473
 10474     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10475        (CL-TOTAL-PAID-AMT > ZEROS)
 10476         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10477         MOVE '6'                 TO DC-OPTION-CODE
 10478         MOVE +0                  TO DC-ELAPSED-MONTHS
 10479         MOVE +1                  TO DC-ELAPSED-DAYS
 10480         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10481         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10482         GO TO 1145-TEST-PAID-FROM.
 10483
 10484******************************************************************
 10485****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10486****** SPECIAL ENTERED DATE.
 10487******************************************************************
 10488
 10489     IF PI-AIGFROM = ZEROS
 10490         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 199
* EL156.cbl
 10491
 10492     MOVE AL-UANON TO AIGFROMA.
 10493
 10494     MOVE '4'                    TO DC-OPTION-CODE.
 10495     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10496     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10497
 10498     IF DATE-CONVERSION-ERROR
 10499         MOVE ER-0449            TO EMI-ERROR
 10500         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10501         MOVE AL-UNBON           TO AIGFROMA
 10502         MOVE -1                 TO AIGFROML
 10503         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10504     ELSE
 10505         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10506         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10507
 10508     GO TO 1140-CONTINUE-PAID-FROM.
 10509
 10510 1130-CONTINUE-PAID-FROM.
 10511
 10512     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10513        (CL-TOTAL-PAID-AMT = ZEROS)
 10514           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10515
 10516 1140-CONTINUE-PAID-FROM.
 10517
 10518     IF PI-BEN-TYPE = 'R'
 10519         IF PI-BEN-DAYS = ZEROS
 10520             NEXT SENTENCE
 10521         ELSE
 10522         IF PI-COMPANY-ID NOT = 'DMD'
 10523             SUBTRACT 1 FROM PI-BEN-DAYS.
 10524
 10525     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10526
 10527     IF PI-COMPANY-ID = 'DMD'
 10528         MOVE -1                 TO DC-ELAPSED-DAYS
 10529         MOVE +0                 TO DC-ELAPSED-MONTHS
 10530         MOVE '6'                TO DC-OPTION-CODE
 10531         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10532         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10533         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10534                               REMAINDER DC-ELAPSED-DAYS
 10535      ELSE
 10536         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10537         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10538
 10539     MOVE '6'                    TO DC-OPTION-CODE.
 10540     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10541     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10542
 10543     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10544
 10545     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10546         MOVE ER-0541            TO EMI-ERROR
 10547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10548         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 200
* EL156.cbl
 10549         MOVE AL-UNBON           TO EPYFROMA.
 10550
 10551     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10552        (PI-BENEFIT-SAVE = '60E')
 10553        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10554           (CL-TOTAL-PAID-AMT = ZEROS)
 10555             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10556             MOVE 30                  TO DC-ELAPSED-DAYS
 10557             MOVE +0                  TO DC-ELAPSED-MONTHS
 10558             MOVE '6'                 TO DC-OPTION-CODE
 10559             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10560
 10561     IF PI-BEN-TYPE = 'R'
 10562         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10563     ELSE
 10564         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10565         IF WS-SV-EPYFROM = LOW-VALUES
 10566            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10567
 10568     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10569         IF WS-USE-AIG-PAYFROM   OR
 10570            WS-AIG-RECALC-PAYFROM
 10571              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10572                                      DC-BIN-DATE-1
 10573              MOVE ' '            TO  DC-OPTION-CODE
 10574              MOVE +0             TO  DC-ELAPSED-MONTHS
 10575                                      DC-ELAPSED-DAYS
 10576              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10577              IF NO-CONVERSION-ERROR
 10578                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10579
 10580     IF PI-CPYFROM < CL-INCURRED-DT
 10581        MOVE -1                  TO EPYFROML
 10582        MOVE ER-3542             TO EMI-ERROR
 10583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10584
 10585     IF CM-ENTRY-DT < CL-INCURRED-DT
 10586        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10587        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10588        MOVE +0                     TO DC-ELAPSED-DAYS
 10589        MOVE +0                     TO DC-ELAPSED-MONTHS
 10590        MOVE '1'                    TO DC-OPTION-CODE
 10591        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10592        ELSE
 10593        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10594
 10595     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10596         NEXT SENTENCE
 10597     ELSE
 10598         IF DC-ELAPSED-MONTHS < 2
 10599             MOVE ER-3255        TO EMI-ERROR
 10600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10601
 10602 1145-TEST-PAID-FROM.
 10603     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10604         GO TO 1150-EDIT-PAID-THRU.
 10605
 10606     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 201
* EL156.cbl
 10607         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10608         MOVE ' '                TO DC-OPTION-CODE
 10609         MOVE +0                 TO DC-ELAPSED-MONTHS
 10610                                    DC-ELAPSED-DAYS
 10611         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10612         IF NO-CONVERSION-ERROR
 10613             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10614         ELSE
 10615             MOVE SPACES             TO EMI-DATE-FIELD.
 10616
 10617     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10618         IF CL-TOTAL-PAID-AMT = ZEROS
 10619             MOVE ER-3543            TO EMI-ERROR
 10620             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10621             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10622             IF EMI-MESSAGE-FORMATTED
 10623                MOVE -1             TO EPYFROML
 10624                MOVE AL-UNBON       TO EPYFROMA
 10625             ELSE
 10626                NEXT SENTENCE
 10627         ELSE
 10628             MOVE ER-0452            TO EMI-ERROR
 10629             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10630             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10631             IF EMI-MESSAGE-FORMATTED
 10632                MOVE -1             TO EPYFROML
 10633                MOVE AL-UNBON       TO EPYFROMA.
 10634
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 202
* EL156.cbl
 10636 1150-EDIT-PAID-THRU.
 10637
 10638     MOVE AL-UANON               TO EPYTHRUA.
 10639
 10640     IF PI-EPYTHRU = ZEROS
 10641         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10642             GO TO 1200-EDIT-FIND-TOLERANCES
 10643         ELSE
 10644            IF (PI-PMTTYPE = '3') OR
 10645               (PI-PMTTYPE = '2' AND
 10646                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10647               GO TO 1152-CHECK-TYPE
 10648            ELSE
 10649               MOVE ER-0473      TO EMI-ERROR
 10650               GO TO 1170-PAID-THRU-FATAL-ERROR
 10651     ELSE
 10652         IF PI-PMTTYPE = '5' OR '6'
 10653             MOVE ER-0474        TO EMI-ERROR
 10654             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10655
 10656     MOVE '4'                    TO DC-OPTION-CODE.
 10657     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10658     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10659
 10660     IF DATE-CONVERSION-ERROR
 10661         MOVE ER-0475            TO EMI-ERROR
 10662         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10663
 10664     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10665
 10666     IF PI-COMPANY-ID = 'DMD'
 10667         IF PI-PMTTYPE NOT = '2'
 10668                 AND
 10669            WS-EXP-DT > WS-SV-EPYTHRU
 10670             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10671             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10672             MOVE '1'              TO DC-OPTION-CODE
 10673             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10674             IF DATE-CONVERSION-ERROR
 10675                 MOVE ER-0944      TO EMI-ERROR
 10676                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10677             ELSE
 10678                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10679                    DC-ELAPSED-DAYS   = 1
 10680                     MOVE ER-0945  TO EMI-ERROR
 10681                     MOVE -1       TO EPYTHRUL
 10682                     MOVE AL-UABON TO EPYTHRUA
 10683                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10684
 10685     IF PI-PMTTYPE = '4'
 10686         NEXT SENTENCE
 10687     ELSE
 10688         IF WS-SV-EPYTHRU = WS-EXP-DT
 10689             IF PI-PMTTYPE NOT = '2' AND '3'
 10690                 MOVE ER-3541    TO EMI-ERROR
 10691                 MOVE -1         TO PMTTYPEL
 10692                 MOVE AL-UABON   TO PMTTYPEA
 10693                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 203
* EL156.cbl
 10694
 10695     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10696         MOVE ER-0501            TO EMI-ERROR
 10697         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10698
 10699     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10700        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 10701*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10702*              MOVE ER-0540         TO EMI-ERROR
 10703*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10704*              MOVE -1              TO EPYTHRUL
 10705*              MOVE AL-UNBON        TO EPYTHRUA
 10706*          ELSE
 10707*          IF PI-COMPANY-ID = 'DMD'
 10708*              MOVE ER-7540         TO EMI-ERROR
 10709*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10710*              MOVE -1              TO EPYTHRUL
 10711*              MOVE AL-UNBON        TO EPYTHRUA
 10712*          ELSE
 10713               IF PI-PMTTYPE NOT = '2' AND '3'
 10714                  IF PI-COMPANY-ID = '???'
 10715                      MOVE ER-7540  TO EMI-ERROR
 10716                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10717                      MOVE -1       TO EPYTHRUL
 10718                      MOVE AL-UNBON TO EPYTHRUA
 10719                  ELSE
 10720                      MOVE ER-0540  TO EMI-ERROR
 10721                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10722                      MOVE -1       TO EPYTHRUL
 10723                      MOVE AL-UNBON TO EPYTHRUA.
 10724
 10725     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10726            OR
 10727        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10728         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10729            OR
 10730        (PI-CPYFROM NOT = LOW-VALUES AND
 10731         PI-CPYFROM < CL-PAID-THRU-DT)
 10732        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10733
 10734 1152-CHECK-TYPE.
 10735     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 10736        OR (PI-PMTTYPE = '5' OR '6')
 10737         GO TO 1160-EDIT-PAID-THRU-AH.
 10738
 10739 1155-EDIT-PAID-THRU-LIFE.
 10740     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10741     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10742     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10743     MOVE '4'                    TO CNTL-REC-TYPE.
 10744     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10745     MOVE 'BENE'                 TO FILE-SWITCH.
 10746
 10747     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10748
 10749     IF NO-BENEFIT-FOUND
 10750         GO TO 1950-NOT-FOUND.
 10751
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 204
* EL156.cbl
 10752     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10753
 10754     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10755
 10756     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10757        PI-LF-COVERAGE-TYPE = 'P'
 10758         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10759         GO TO 1200-EDIT-FIND-TOLERANCES.
 10760
 10761     IF PI-EPYTHRU = ZEROS
 10762        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10763
 10764     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10765         MOVE ER-0476            TO EMI-ERROR
 10766         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10767
 10768     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10769*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10770     move cl-critical-period    to dc-elapsed-months
 10771     MOVE +0                    TO DC-ELAPSED-DAYS.
 10772     MOVE '6'                   TO DC-OPTION-CODE.
 10773     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10774
 10775     IF (NO-CONVERSION-ERROR AND
 10776         WS-SPECIAL-CALC-CD = 'C')
 10777        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10778            MOVE ER-0657 TO EMI-ERROR
 10779            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10780
 10781     IF PI-COMPANY-ID = 'NCL'
 10782         IF WS-SPECIAL-CALC-CD = 'C' AND
 10783            cl-critical-period = zeros
 10784*           CM-LF-CRITICAL-PERIOD = +0
 10785             MOVE ER-0844       TO EMI-ERROR
 10786             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10787
 10788     GO TO 1200-EDIT-FIND-TOLERANCES.
 10789
 10790 1160-EDIT-PAID-THRU-AH.
 10791     IF PI-EPYTHRU = ZEROS
 10792        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10793                                    WS-SV-EPYTHRU
 10794     ELSE
 10795        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10796
 10797     IF WS-SV-EPYTHRU < PI-CPYFROM
 10798         MOVE ER-0508            TO EMI-ERROR
 10799         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10800
 10801     perform 7975-read-acct      thru 7975-exit
 10802     move zeros                  to pi-max-ext
 10803     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10804        PERFORM 0900-GET-DDF-LIMITS
 10805                                 THRU 0900-EXIT
 10806        IF PDEF-FOUND
 10807           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10808              (P1 > +8)
 10809              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 205
* EL156.cbl
 10810           END-PERFORM
 10811           IF P1 < +9
 10812              MOVE PD-MAX-extension (P1)
 10813                                 TO pi-max-ext
 10814           else
 10815              move er-1674       to emi-error
 10816              PERFORM 9900-ERROR-FORMAT
 10817                                 THRU 9900-EXIT
 10818           END-IF
 10819        else
 10820           move er-1672          to emi-error
 10821           PERFORM 9900-ERROR-FORMAT
 10822                                 THRU 9900-EXIT
 10823        END-IF
 10824     end-if
 10825     move spaces                 to pi-max-ext-used
 10826     IF PI-PMTTYPE = '3'
 10827        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10828        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10829           MOVE ER-0477          TO EMI-ERROR
 10830           PERFORM 1165-PAID-THRU-ERROR
 10831                                 THRU 1165-EXIT
 10832        ELSE
 10833           continue
 10834        end-if
 10835     ELSE
 10836        IF WS-SV-EPYTHRU > WS-EXP-DT
 10837           move ws-exp-dt        to dc-bin-date-1
 10838           move ws-sv-epythru    to dc-bin-date-2
 10839           MOVE '1'              TO DC-OPTION-CODE
 10840           MOVE +0               TO DC-ELAPSED-DAYS
 10841                                    DC-ELAPSED-MONTHS
 10842           PERFORM 9700-LINK-DATE-CONVERT
 10843                                 THRU 9700-EXIT
 10844           if no-conversion-error
 10845              if dc-elapsed-days > zeros
 10846                 add +1 to dc-elapsed-months
 10847              end-if
 10848              if dc-elapsed-months > pi-max-ext
 10849                 MOVE ER-0557    TO EMI-ERROR
 10850                 PERFORM 1165-PAID-THRU-ERROR
 10851                                 THRU 1165-EXIT
 10852              else
 10853                 move 'Y'        to pi-max-ext-used
 10854                 move er-1670    to emi-error
 10855                 perform 9900-error-format
 10856                                 thru 9900-exit
 10857              end-if
 10858           end-if
 10859        end-if
 10860     end-if
 10861
 10862     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10863         PI-PMTTYPE NOT = '3'
 10864         MOVE ER-0541        TO EMI-ERROR
 10865         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10866
 10867     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 206
* EL156.cbl
 10868        (PI-PMTTYPE NOT = '3')
 10869         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10870             MOVE ER-0478        TO EMI-ERROR
 10871             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10872
 10873     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 10874        (PI-PMTTYPE NOT = '4')
 10875         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 10876             MOVE ER-0479        TO EMI-ERROR
 10877             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10878
 10879     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 10880         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 10881             MOVE ER-0545        TO EMI-ERROR
 10882             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10883
 10884     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10885         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 10886             MOVE ER-0481        TO EMI-ERROR
 10887             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10888
 10889*    IF PI-COMPANY-ID = 'NCL'
 10890*        IF WS-SPECIAL-CALC-CD = 'C' AND
 10891*           CM-AH-CRITICAL-PERIOD = +0
 10892*            MOVE ER-0844        TO  EMI-ERROR
 10893*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10894
 10895*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 10896     if (cl-critical-period = zeros)
 10897        or (WS-SPECIAL-CALC-CD NOT = 'C')
 10898          GO TO 1200-EDIT-FIND-TOLERANCES.
 10899
 10900     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 10901     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 10902     MOVE '1'        TO DC-OPTION-CODE.
 10903     MOVE +0         TO DC-ELAPSED-DAYS
 10904                        DC-ELAPSED-MONTHS.
 10905     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10906
 10907*    IF NO-CONVERSION-ERROR
 10908*       COMPUTE ws-benefits-paid =
 10909*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 10910*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 10911*           MOVE ER-0657 TO EMI-ERROR
 10912*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10913
 10914     GO TO 1200-EDIT-FIND-TOLERANCES.
 10915
 10916 1165-PAID-THRU-ERROR.
 10917     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10918
 10919     IF EMI-MESSAGE-FORMATTED
 10920         MOVE -1                 TO EPYTHRUL
 10921         MOVE AL-UNBON           TO EPYTHRUA.
 10922
 10923 1165-EXIT.
 10924     EXIT.
 10925
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 207
* EL156.cbl
 10926 1166-CHECK-ALL-TRLRS.
 10927
 10928     IF PI-PMTTYPE = '4'
 10929        GO TO 1166-TRLR-EXIT.
 10930
 10931     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 10932
 10933     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 10934        WS-SV-EPYFROM = LOW-VALUES
 10935          GO TO 1166-END-CHECK.
 10936
 10937
 10938* EXEC CICS HANDLE CONDITION
 10939*        ENDFILE   (1166-END-CHECK)
 10940*        NOTFND    (1166-END-CHECK)
 10941*    END-EXEC.
 10942*    MOVE '"$''I                  ! ) #00010521' TO DFHEIV0
 10943     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10945     MOVE X'2920233030303130353231' TO DFHEIV0(25:11)
 10946     CALL 'kxdfhei1' USING DFHEIV0
 10947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10948
 10949
 10950     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 10951     MOVE +100                   TO TRLR-SEQ-NO.
 10952
 10953
 10954* EXEC CICS STARTBR
 10955*         DATASET    ('ELTRLR')
 10956*         RIDFLD     (ELTRLR-KEY)
 10957*         GTEQ
 10958*    END-EXEC.
 10959     MOVE 'ELTRLR' TO DFHEIV1
 10960     MOVE 0
 10961       TO DFHEIV11
 10962*    MOVE '&,         G          &   #00010529' TO DFHEIV0
 10963     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10964     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10965     MOVE X'2020233030303130353239' TO DFHEIV0(25:11)
 10966     CALL 'kxdfhei1' USING DFHEIV0,
 10967           DFHEIV1,
 10968           ELTRLR-KEY,
 10969           DFHEIV99,
 10970           DFHEIV11,
 10971           DFHEIV99
 10972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10973
 10974
 10975     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 10976
 10977 1166-READ-TRLR-NEXT.
 10978
 10979
 10980* EXEC CICS READNEXT
 10981*         DATASET    ('ELTRLR')
 10982*         RIDFLD     (ELTRLR-KEY)
 10983*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 208
* EL156.cbl
 10984*    END-EXEC.
 10985     MOVE 'ELTRLR' TO DFHEIV1
 10986     MOVE 0
 10987       TO DFHEIV11
 10988*    MOVE '&.S                   )   #00010539' TO DFHEIV0
 10989     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10990     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10991     MOVE X'2020233030303130353339' TO DFHEIV0(25:11)
 10992     CALL 'kxdfhei1' USING DFHEIV0,
 10993           DFHEIV1,
 10994           DFHEIV20,
 10995           DFHEIV99,
 10996           ELTRLR-KEY,
 10997           DFHEIV99,
 10998           DFHEIV11,
 10999           DFHEIV99,
 11000           DFHEIV99
 11001     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11002         DFHEIV20
 11003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11004
 11005
 11006     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11007        TRLR-CARRIER  = MSTR-CARRIER  AND
 11008        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11009        TRLR-CERT-NO  = MSTR-CERT-NO
 11010          NEXT SENTENCE
 11011      ELSE
 11012          GO TO 1166-END-CHECK.
 11013
 11014* **  BYPASS ALL NON-PAYMENT TRAILERS
 11015
 11016     IF AT-TRAILER-TYPE = '2'
 11017        NEXT SENTENCE
 11018     ELSE
 11019        GO TO 1166-READ-TRLR-NEXT.
 11020
 11021* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11022
 11023     IF AT-PAYMENT-TYPE = '1' OR '2'
 11024        NEXT SENTENCE
 11025     ELSE
 11026        GO TO 1166-READ-TRLR-NEXT.
 11027
 11028* **  BYPASS ALL VOID PAYMENTS
 11029
 11030     IF AT-VOID-DT NOT = LOW-VALUES
 11031        GO TO 1166-READ-TRLR-NEXT.
 11032
 11033     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11034        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11035          GO TO 1166-READ-TRLR-NEXT.
 11036
 11037     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11038         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11039            OR
 11040        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11041         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 209
* EL156.cbl
 11042        NEXT SENTENCE
 11043     ELSE
 11044         IF CL-TOTAL-PAID-AMT > ZEROS
 11045             MOVE ER-0502            TO EMI-ERROR
 11046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11047             MOVE -1                 TO EPYTHRUL
 11048             MOVE AL-UNBON           TO EPYTHRUA.
 11049
 11050     GO TO 1166-READ-TRLR-NEXT.
 11051
 11052 1166-END-CHECK.
 11053
 11054     IF WS-BROWSE-TRLR-SW = 'Y'
 11055
 11056* EXEC CICS ENDBR
 11057*            DATASET   ('ELTRLR')
 11058*       END-EXEC.
 11059     MOVE 'ELTRLR' TO DFHEIV1
 11060     MOVE 0
 11061       TO DFHEIV11
 11062*    MOVE '&2                    $   #00010594' TO DFHEIV0
 11063     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11064     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11065     MOVE X'2020233030303130353934' TO DFHEIV0(25:11)
 11066     CALL 'kxdfhei1' USING DFHEIV0,
 11067           DFHEIV1,
 11068           DFHEIV11,
 11069           DFHEIV99
 11070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11071
 11072
 11073     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11074
 11075 1166-TRLR-EXIT.
 11076     EXIT.
 11077
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 210
* EL156.cbl
 11079 1170-PAID-THRU-FATAL-ERROR.
 11080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11081
 11082     MOVE -1                     TO EPYTHRUL.
 11083     MOVE AL-UNBON               TO EPYTHRUA.
 11084
 11085 1200-EDIT-FIND-TOLERANCES.
 11086
 11087* EXEC CICS HANDLE CONDITION
 11088*        ENDFILE(1950-NOT-FOUND)
 11089*        NOTFND (1950-NOT-FOUND)
 11090*    END-EXEC.
 11091*    MOVE '"$''I                  ! * #00010611' TO DFHEIV0
 11092     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11094     MOVE X'2A20233030303130363131' TO DFHEIV0(25:11)
 11095     CALL 'kxdfhei1' USING DFHEIV0
 11096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11097
 11098
 11099     IF PI-PROCESSOR-ID = 'LGXX'
 11100        GO TO 1240-FIND-ACCT-TOLERANCES.
 11101
 11102     MOVE 'N'                    TO FOUND-TOL-SW.
 11103     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11104     MOVE '2'                    TO CNTL-REC-TYPE.
 11105     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11106     MOVE +0                     TO CNTL-SEQ-NO.
 11107     MOVE 'PROC'                 TO FILE-SWITCH.
 11108
 11109     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11110
 11111     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11112     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11113                                    PI-MAX-PMT-TOL.
 11114     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11115
 11116     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11117         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11118
 11119     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11120     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11121                                    PI-MAX-LF-PMT-TOL.
 11122
 11123     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11124         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11125
 11126     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11127                                    PI-MAX-EXP-PMT.
 11128
 11129 1240-FIND-ACCT-TOLERANCES.
 11130
 11131     IF WS-PMT-TOL NOT = +0
 11132         MOVE 'Y'                TO FOUND-TOL-SW.
 11133
 11134     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11135         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11136         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 211
* EL156.cbl
 11137         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11138         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11139         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11140         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11141     ELSE
 11142         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11143         MOVE PI-CARRIER             TO ACCT-CARRIER
 11144         MOVE PI-GROUPING            TO ACCT-GROUPING
 11145         MOVE PI-STATE               TO ACCT-STATE
 11146         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11147         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11148
 11149     MOVE 'ACCT'                 TO FILE-SWITCH.
 11150
 11151     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11152     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11153
 11154
 11155* EXEC CICS HANDLE CONDITION
 11156*         NOTFND   (1950-NOT-FOUND)
 11157*         ENDFILE  (1950-NOT-FOUND)
 11158*    END-EXEC.
 11159*    MOVE '"$I''                  ! + #00010671' TO DFHEIV0
 11160     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11162     MOVE X'2B20233030303130363731' TO DFHEIV0(25:11)
 11163     CALL 'kxdfhei1' USING DFHEIV0
 11164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11165
 11166
 11167
 11168* EXEC CICS STARTBR
 11169*        DATASET('ERACCT')
 11170*        RIDFLD (ERACCT-KEY)
 11171*        GTEQ
 11172*    END-EXEC.
 11173     MOVE 'ERACCT' TO DFHEIV1
 11174     MOVE 0
 11175       TO DFHEIV11
 11176*    MOVE '&,         G          &   #00010676' TO DFHEIV0
 11177     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11178     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11179     MOVE X'2020233030303130363736' TO DFHEIV0(25:11)
 11180     CALL 'kxdfhei1' USING DFHEIV0,
 11181           DFHEIV1,
 11182           ERACCT-KEY,
 11183           DFHEIV99,
 11184           DFHEIV11,
 11185           DFHEIV99
 11186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11187
 11188
 11189 1245-FIND-ACCT-TOLERANCES-LOOP.
 11190
 11191
 11192* EXEC CICS READNEXT
 11193*        DATASET('ERACCT')
 11194*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 212
* EL156.cbl
 11195*        RIDFLD (ERACCT-KEY)
 11196*    END-EXEC.
 11197     MOVE 'ERACCT' TO DFHEIV1
 11198     MOVE 0
 11199       TO DFHEIV11
 11200*    MOVE '&.S                   )   #00010684' TO DFHEIV0
 11201     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11202     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11203     MOVE X'2020233030303130363834' TO DFHEIV0(25:11)
 11204     CALL 'kxdfhei1' USING DFHEIV0,
 11205           DFHEIV1,
 11206           DFHEIV20,
 11207           DFHEIV99,
 11208           ERACCT-KEY,
 11209           DFHEIV99,
 11210           DFHEIV11,
 11211           DFHEIV99,
 11212           DFHEIV99
 11213     SET ADDRESS OF ACCOUNT-MASTER TO
 11214         DFHEIV20
 11215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11216
 11217
 11218     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11219        IF WS-ERACCT-HOLD-RECORD = SPACES
 11220           GO TO 1950-NOT-FOUND
 11221        ELSE
 11222           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11223           GO TO 1250-CONTINUE.
 11224
 11225     IF ACCT-EXP-DT = HIGH-VALUES
 11226        NEXT SENTENCE
 11227     ELSE
 11228        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11229        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11230
 11231 1250-CONTINUE.
 11232
 11233     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11234
 11235     IF FOUND-TOL-SW = 'N'
 11236         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11237
 11238********* 1260-FIND-STATE-TOLERANCES.
 11239
 11240     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11241     MOVE PI-STATE               TO WS-ST-ACCESS.
 11242     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11243     MOVE '3'                    TO CNTL-REC-TYPE.
 11244     MOVE +0                     TO CNTL-SEQ-NO.
 11245     MOVE 'STAT'                 TO FILE-SWITCH.
 11246
 11247     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11248
 11249     IF WS-PMT-TOL = +0
 11250         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11251
 11252     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 213
* EL156.cbl
 11253     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11254     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11255     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11256     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11257
 11258****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11259****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11260     IF PI-PAYEE-TYPE <> 'B'
 11261           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11262     END-IF.
 11263
 11264     IF PI-PMTTYPE      = '2'  AND
 11265        PI-SPLIT-PMT-SW = 'Y'  AND
 11266        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11267          MOVE ER-3530                TO EMI-ERROR
 11268          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11269
 11270********* 1280-FIND-BENEFIT-TOLERANCES.
 11271
 11272     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 11273        OR (PI-PMTTYPE = '5' OR '6')
 11274         GO TO 1300-FIND-CARR-TOLERANCES.
 11275
 11276     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11277     MOVE '4'                    TO CNTL-REC-TYPE.
 11278     MOVE +0                     TO CNTL-SEQ-NO.
 11279     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11280     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11281     MOVE 'BENE'                 TO FILE-SWITCH.
 11282
 11283     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11284
 11285     IF NO-BENEFIT-FOUND
 11286         GO TO 1950-NOT-FOUND.
 11287
 11288     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11289     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11290     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11291
 11292
 11293* EXEC CICS HANDLE CONDITION
 11294*        NOTFND(1950-NOT-FOUND)
 11295*    END-EXEC.
 11296*    MOVE '"$I                   ! , #00010764' TO DFHEIV0
 11297     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11298     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11299     MOVE X'2C20233030303130373634' TO DFHEIV0(25:11)
 11300     CALL 'kxdfhei1' USING DFHEIV0
 11301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11302
 11303
 11304 1300-FIND-CARR-TOLERANCES.
 11305     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11306     MOVE '6'                    TO CNTL-REC-TYPE.
 11307
 11308     IF CONTROL-IS-ACTUAL-CARRIER
 11309         MOVE PI-CARRIER               TO WS-CARR
 11310     ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 214
* EL156.cbl
 11311         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11312
 11313     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11314     MOVE +0                     TO CNTL-SEQ-NO.
 11315     MOVE 'CARR'                 TO FILE-SWITCH.
 11316
 11317     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11318
 11319     IF WS-DAYS-TOL = +0
 11320         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11321
 11322     IF WS-PMT-TOL = +0
 11323         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11324
 11325     IF WS-MAX-DAYS-TOL = +0
 11326         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11327
 11328     IF WS-MAX-PMT-TOL = +0
 11329         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11330                                    PI-MAX-PMT-TOL.
 11331
 11332     IF WS-MAX-LF-PMT-TOL = +0
 11333        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11334                                    PI-MAX-LF-PMT-TOL.
 11335
 11336     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11337
 11338********* 1320-FIND-COMP-TOLERANCES.
 11339
 11340     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11341     MOVE '1'                    TO CNTL-REC-TYPE.
 11342     MOVE SPACES                 TO CNTL-ACCESS.
 11343     MOVE +0                     TO CNTL-SEQ-NO.
 11344     MOVE 'COMP'                 TO FILE-SWITCH.
 11345
 11346     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11347
 11348     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11349     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11350
 11351     IF WS-PMT-TOL NOT = +0
 11352        IF WS-TOL-SEVERITY NOT = ' '
 11353         GO TO 1360-EDIT-DAYS.
 11354
 11355     IF WS-PMT-TOL = +0
 11356         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11357
 11358     IF WS-TOL-SEVERITY = ' '
 11359         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11360
 11361 1360-EDIT-DAYS.
 11362     IF PI-PMTTYPE NOT = '4'
 11363        IF PI-EDAYS NEGATIVE OR
 11364           PI-EPYAMT NEGATIVE
 11365          MOVE ER-0513             TO EMI-ERROR
 11366          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11367          MOVE -1                  TO PMTTYPEL.
 11368
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 215
* EL156.cbl
 11369     IF PI-PMTTYPE = '5' OR '6'
 11370        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11371
 11372     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11373        IF PI-PMTTYPE = '4'
 11374          MOVE PI-EDAYS          TO PI-CDAYS.
 11375
 11376     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11377         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11378
 11379     IF PI-PMTTYPE = '4'
 11380        MOVE PI-EDAYS            TO PI-CDAYS
 11381        GO TO 1400-EDIT-PAYMENT.
 11382
 11383     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11384        GO TO 1500-EDIT-EXPENSES.
 11385
 11386*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11387*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11388*          CM-AH-BENEFIT-CD = '23'              AND
 11389*          CL-CERT-STATE    = '04'              AND
 11390*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11391*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11392*            GO TO 1362-CHECK-MAX-DAYS.
 11393
 11394     IF PI-EDAYS = ZEROS
 11395*        IF PI-COMPANY-ID = 'DMD'
 11396*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11397*            MOVE -1             TO DC-ELAPSED-DAYS
 11398*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11399*            MOVE '6'            TO DC-OPTION-CODE
 11400*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11401*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11402*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11403*            MOVE '1'            TO DC-OPTION-CODE
 11404*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11405*            IF NO-CONVERSION-ERROR
 11406*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11407*                                 + DC-ODD-DAYS-OVER
 11408*               MOVE 6           TO EDAYSL
 11409*               MOVE AL-UNNON    TO EDAYSA
 11410*            ELSE
 11411*                NEXT SENTENCE
 11412*       ELSE
 11413            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11414            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11415            MOVE '1'             TO DC-OPTION-CODE
 11416            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11417            IF NO-CONVERSION-ERROR
 11418                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11419                ADD 1                 TO PI-EDAYS
 11420                MOVE AL-UNNON         TO EDAYSA.
 11421
 11422*    IF PI-COMPANY-ID = 'DMD'
 11423*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11424*        MOVE -1                 TO DC-ELAPSED-DAYS
 11425*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11426*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 216
* EL156.cbl
 11427*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11428*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11429*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11430*        MOVE '1'                TO DC-OPTION-CODE
 11431*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11432*    ELSE
 11433         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11434         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11435         MOVE '1'                TO DC-OPTION-CODE.
 11436         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11437
 11438     IF NO-CONVERSION-ERROR
 11439        IF PI-COMPANY-ID = 'DMD'
 11440            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11441                             + DC-ODD-DAYS-OVER
 11442        ELSE
 11443            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11444            ADD 1                TO PI-CDAYS.
 11445
 11446     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11447        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11448        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11449
 11450     IF PI-EDAYS NOT NUMERIC
 11451         MOVE ER-0491            TO EMI-ERROR
 11452         GO TO 1370-DAYS-ERROR.
 11453
 11454     IF CL-NO-OF-PMTS-MADE = 0
 11455        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11456        AND CL-CERT-STATE = 'MI'
 11457        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11458            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11459     END-IF.
 11460
 11461 1362-CHECK-MAX-DAYS.
 11462
 11463     IF WS-MAX-DAYS-TOL = +999
 11464         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11465
 11466     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11467         IF PI-EDAYS = ZEROS
 11468             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11469         ELSE
 11470             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11471
 11472     IF WS-MAX-DAYS-TOL NOT = ZERO
 11473        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11474           PI-CDAYS > WS-MAX-DAYS-TOL
 11475             MOVE ER-0492          TO EMI-ERROR
 11476             GO TO 1370-DAYS-ERROR.
 11477
 11478 1365-SKIP-MAX-DAYS-EDIT.
 11479     IF PI-EDAYS = ZEROS
 11480        GO TO 1400-EDIT-PAYMENT.
 11481
 11482     IF WS-DAYS-TOL NOT = ZERO
 11483        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11484           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 217
* EL156.cbl
 11485                MOVE ER-0493     TO EMI-ERROR
 11486                GO TO 1370-DAYS-ERROR.
 11487
 11488     GO TO 1400-EDIT-PAYMENT.
 11489
 11490 1370-DAYS-ERROR.
 11491     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11492
 11493     IF EMI-MESSAGE-FORMATTED
 11494         MOVE -1                 TO EDAYSL
 11495         MOVE AL-UABON           TO EDAYSA.
 11496
 11497     GO TO 1400-EDIT-PAYMENT.
 11498
 11499 1380-EDIT-EXPENSE-PMT-AMT.
 11500     IF PI-PMTTYPE = '5' OR '6'
 11501         NEXT SENTENCE
 11502     ELSE
 11503         GO TO 1400-EDIT-PAYMENT.
 11504
 11505     IF WS-MAX-EXP-PMT NOT = ZEROS
 11506        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11507            MOVE ER-3529            TO EMI-ERROR
 11508            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11509
 11510     GO TO 1500-EDIT-EXPENSES.
 11511
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 218
* EL156.cbl
 11513
 11514 1390-CHECK-PAYMENT-DAYS.
 11515
 11516     IF PI-EDAYS = 0
 11517         MOVE PI-CDAYS TO WS-PD-DAYS
 11518     ELSE
 11519         MOVE PI-EDAYS TO WS-PD-DAYS
 11520     END-IF.
 11521
 11522     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11523         IF WS-PD-DAYS = 14
 11524            GO TO 1390-EXIT
 11525         END-IF
 11526     END-IF.
 11527
 11528     IF PI-COMPANY-ID = 'AHL'  AND
 11529        CM-AH-BENEFIT-CD = '1K'
 11530         IF WS-PD-DAYS = 14
 11531            GO TO 1390-EXIT
 11532         END-IF
 11533     END-IF.
 11534
 11535     IF WS-PD-DAYS < 30
 11536         MOVE ER-3549              TO EMI-ERROR
 11537         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11538     END-IF.
 11539
 11540 1390-EXIT.
 11541      EXIT.
 11542
 11543 1400-EDIT-PAYMENT.
 11544*    IF PI-COMPANY-ID = 'DMD'
 11545*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11546*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11547
 11548     IF PI-COMPANY-ID = 'DCC'
 11549        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11550        MOVE PI-CARRIER          TO ACCT-CARRIER
 11551        MOVE PI-GROUPING         TO ACCT-GROUPING
 11552        MOVE PI-STATE            TO ACCT-STATE
 11553        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11554        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11555        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11556        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11557
 11558
 11559* EXEC CICS READ
 11560*          DATASET ('ERACCT')
 11561*          RIDFLD  (ERACCT-KEY)
 11562*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11563*          GTEQ
 11564*          resp    (WS-RESPONSE)
 11565*       END-EXEC
 11566     MOVE 'ERACCT' TO DFHEIV1
 11567*    MOVE '&"S        G          (  N#00011022' TO DFHEIV0
 11568     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11570     MOVE X'204E233030303131303232' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 219
* EL156.cbl
 11571     CALL 'kxdfhei1' USING DFHEIV0,
 11572           DFHEIV1,
 11573           DFHEIV20,
 11574           DFHEIV99,
 11575           ERACCT-KEY,
 11576           DFHEIV99,
 11577           DFHEIV99,
 11578           DFHEIV99
 11579     SET ADDRESS OF ACCOUNT-MASTER TO
 11580         DFHEIV20
 11581     MOVE EIBRESP  TO WS-RESPONSE
 11582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11583        IF WS-RESP-NORMAL
 11584           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11585           and pi-cert-eff-dt < am-expiration-dt
 11586           and pi-cert-eff-dt >= am-effective-dt
 11587           move am-dcc-product-code to pi-dcc-product-code
 11588        else
 11589           move spaces           to pi-dcc-product-code
 11590        end-if
 11591        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11592           PERFORM 0900-GET-DDF-LIMITS
 11593                                 THRU 0900-EXIT
 11594           IF PDEF-FOUND
 11595              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11596                 (P1 > +8)
 11597                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11598              END-PERFORM
 11599              IF P1 < +9
 11600                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11601                    MOVE PD-MAX-AMT (P1)
 11602                                 TO CM-AH-BENEFIT-AMT
 11603                 end-if
 11604              else
 11605                 move er-1674    to emi-error
 11606                 PERFORM 9900-ERROR-FORMAT
 11607                                 THRU 9900-EXIT
 11608              END-IF
 11609           else
 11610              move er-1672       to emi-error
 11611              PERFORM 9900-ERROR-FORMAT
 11612                                 THRU 9900-EXIT
 11613           END-IF
 11614        end-if
 11615     END-IF
 11616     IF PI-PMTTYPE NOT = '4'
 11617        GO TO 1405-CALC-PAYMENT.
 11618
 11619     IF PI-EDAYS NOT NUMERIC
 11620         MOVE PI-EPYAMT           TO PI-CPYAMT
 11621         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11622         GO TO 1430-CHECK-AH-TOLERANCE.
 11623
 11624*    IF PI-COMPANY-ID = 'FIA'
 11625*       IF CERT-ACCOUNT = '0000011043'
 11626*        COMPUTE PI-DAILY-RATE ROUNDED =
 11627*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11628*        COMPUTE PI-CPYAMT ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 220
* EL156.cbl
 11629*                          PI-DAILY-RATE * PI-EDAYS
 11630*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11631*        GO TO 1430-CHECK-AH-TOLERANCE.
 11632
 11633     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11634         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11635         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11636         GO TO 1420-CHECK-AIG-BENEFIT.
 11637
 11638     IF WS-CALC-METHOD = '2' OR  '5'
 11639         COMPUTE PI-DAILY-RATE ROUNDED =
 11640                        (CM-AH-BENEFIT-AMT * 12) / 365
 11641         COMPUTE PI-CPYAMT ROUNDED =
 11642                           PI-DAILY-RATE * PI-EDAYS
 11643        GO TO 1420-CHECK-AIG-BENEFIT.
 11644
 11645     IF WS-CALC-METHOD = '3'
 11646         COMPUTE PI-DAILY-RATE =
 11647                         (CM-AH-BENEFIT-AMT * 12) / 365
 11648         COMPUTE PI-CPYAMT ROUNDED =
 11649                           PI-DAILY-RATE * PI-EDAYS
 11650        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 221
* EL156.cbl
 11652*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11653
 11654****************************************************************
 11655****************************************************************
 11656*                  CALCULATED FROM      PAYMENT      PAYMENT
 11657*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11658* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11659*1-01-83  1-15-83    0    15     15        15           15
 11660*1-01-83  1-30-83    0    30     30        30           30
 11661*1-01-83  1-31-83    1     0     31        30           30
 11662*1-01-83  2-01-83    1     1     32        31           31
 11663*1-01-83  2-15-83    1    15     46        45           45
 11664*1-01-83  2-28-83    2     0     59        60           60
 11665*1-01-83  3-01-83    2     1     60        61           61
 11666*1-01-83  3-31-83    3     0     90        90           90
 11667*1-15-83  1-31-83    0    17     17        17           16
 11668*1-15-83  2-01-83    0    18     18        18           17
 11669*1-15-83  2-28-83    1    14     45        44           46
 11670*1-21-83  3-09-83    1    20     48        50           49
 11671*2-05-83  3-06-83    1     2     30        32           32
 11672*2-05-83  3-23-83    1    19     47        49           49
 11673*2-15-83  2-28-83    0    14     14        14           16
 11674*2-15-83  3-01-83    0    15     15        15           17
 11675*2-21-83  3-19-83    0    27     27        27           29
 11676*2-21-83  3-20-83    1     0     28        30           30
 11677*2-21-83  4-10-83    1    18     49        30           50
 11678*2-21-83  5-19-83    2    27     88        87           89
 11679*2-21-83  5-22-83    3     2     91        92           92
 11680*3-21-83  5-19-83    1    30     60        60           59
 11681****************************************************************
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 222
* EL156.cbl
 11683 1405-CALC-PAYMENT.
 11684     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11685     MOVE ' '                    TO DC-OPTION-CODE.
 11686     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11687     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11688     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11689
 11690     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11691     MOVE ' '                    TO DC-OPTION-CODE.
 11692     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11693     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11694     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11695
 11696     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11697     MOVE -1                     TO DC-ELAPSED-DAYS.
 11698     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11699     MOVE '6'                    TO DC-OPTION-CODE.
 11700     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11701     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11702
 11703     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11704     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11705     MOVE '1'                    TO DC-OPTION-CODE.
 11706     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11707
 11708     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11709     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11710     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11711
 11712******************************************************************
 11713*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11714*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11715*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11716******************************************************************
 11717
 11718     IF WS-CALC-METHOD = '1'           AND
 11719        DC-ELAPSED-MONTHS > ZERO AND
 11720        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11721        WDF-DAY > WDT-DAY
 11722          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11723          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11724          MOVE -1                  TO DC-ELAPSED-MONTHS
 11725          MOVE '6'                 TO DC-OPTION-CODE
 11726          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11727          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11728          COMPUTE WS-SAVE-ODD-DAYS =
 11729          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11730          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11731
 11732     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11733     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11734     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11735
 11736     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11737     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11738
 11739*    IF PI-COMPANY-ID = 'FIA'
 11740*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 223
* EL156.cbl
 11741*        COMPUTE PI-DAILY-RATE ROUNDED =
 11742*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11743*        COMPUTE PI-CPYAMT ROUNDED =
 11744*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11745*        GO TO 1420-CHECK-AIG-BENEFIT.
 11746
 11747*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11748*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11749*          CM-AH-BENEFIT-CD = '23'               AND
 11750*          CL-CERT-STATE    = '04'               AND
 11751*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11752*            COMPUTE WS-DAILY-RATE ROUNDED =
 11753*                               CM-AH-BENEFIT-AMT / 30
 11754*            COMPUTE PI-CPYAMT ROUNDED =
 11755*                               (WS-DAILY-RATE * PI-CDAYS)
 11756*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11757*            GO TO 1420-CHECK-AIG-BENEFIT.
 11758
 11759     IF WS-CALC-METHOD = '1'
 11760         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11761         COMPUTE PI-CPYAMT ROUNDED =
 11762             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11763             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11764         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11765         GO TO 1420-CHECK-AIG-BENEFIT.
 11766
 11767     IF WS-CALC-METHOD = '2'
 11768         COMPUTE PI-DAILY-RATE ROUNDED =
 11769                          (CM-AH-BENEFIT-AMT * 12) / 365
 11770         COMPUTE PI-CPYAMT ROUNDED =
 11771             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11772             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11773         GO TO 1420-CHECK-AIG-BENEFIT.
 11774
 11775     IF WS-CALC-METHOD = '4'
 11776         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11777         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11778         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11779         COMPUTE PI-CPYAMT ROUNDED =
 11780                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11781         GO TO 1420-CHECK-AIG-BENEFIT.
 11782
 11783     IF WS-CALC-METHOD = '5'
 11784         COMPUTE PI-DAILY-RATE ROUNDED =
 11785                            (CM-AH-BENEFIT-AMT * 12) / 365
 11786         COMPUTE PI-CPYAMT ROUNDED =
 11787                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11788         GO TO 1420-CHECK-AIG-BENEFIT.
 11789
 11790     IF WS-CALC-METHOD NOT = '3'
 11791        GO TO 1410-CHECK-PAYMENT.
 11792
 11793******   CALCULATION METHOD  3  ROUTINE
 11794     COMPUTE PI-DAILY-RATE =
 11795                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11796
 11797******CHECK TO SEE IF WITHIN SAME MONTH
 11798     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 224
* EL156.cbl
 11799        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11800                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11801         GO TO 1420-CHECK-AIG-BENEFIT.
 11802
 11803******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11804     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11805             SAVE-ODD-DAYS-OVER = ZEROS
 11806      COMPUTE PI-CPYAMT  ROUNDED =
 11807                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11808      GO TO 1420-CHECK-AIG-BENEFIT.
 11809
 11810******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11811******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11812     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11813        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11814        IF WDF-MONTH > 12
 11815           ADD 1                 TO WDF-YEAR
 11816           SUBTRACT 12         FROM WDF-MONTH.
 11817
 11818******CONVERT THE NEW FROM MONTH TO BINARY
 11819     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11820        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11821        MOVE '4'              TO DC-OPTION-CODE
 11822        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11823        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11824
 11825     IF WDF-MONTH = WDT-MONTH AND
 11826        WDF-YEAR  = WDT-YEAR
 11827          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11828                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11829                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11830        ELSE
 11831          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11832          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11833          COMPUTE PI-CPYAMT ROUNDED =
 11834       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11835       +
 11836       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11837       +
 11838       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11839
 11840     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 225
* EL156.cbl
 11842 1410-CHECK-PAYMENT.
 11843******PAYMENT OPTION 6
 11844******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11845     IF SAVE-ELAPSED-MONTHS > ZERO
 11846        IF SAVE-ODD-DAYS-OVER = ZEROS
 11847           GO TO 1412-CHECK-TO-DAY
 11848        ELSE
 11849           IF WDF-DAY > WDT-DAY
 11850              IF WDF-MONTH = 02
 11851                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11852                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11853                  GO TO 1412-CHECK-TO-DAY
 11854              ELSE
 11855                  IF FROM-DAYS-IN-MONTH = 31
 11856                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11857                     GO TO 1412-CHECK-TO-DAY
 11858                  ELSE
 11859                     GO TO 1412-CHECK-TO-DAY
 11860           ELSE
 11861               GO TO 1412-CHECK-TO-DAY.
 11862
 11863     IF WDF-MONTH NOT = WDT-MONTH
 11864        IF WDF-MONTH = 02
 11865           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11866           IF WDF-DAY = 29
 11867              ADD 1              TO SAVE-ODD-DAYS-OVER
 11868           ELSE
 11869              ADD 2              TO SAVE-ODD-DAYS-OVER
 11870        ELSE
 11871           IF FROM-DAYS-IN-MONTH = 31
 11872              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11873
 11874 1412-CHECK-TO-DAY.
 11875        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 11876           IF WDT-DAY = 28
 11877              ADD 2              TO SAVE-ODD-DAYS-OVER
 11878           ELSE
 11879              IF WDT-DAY = 29
 11880                 ADD 1           TO SAVE-ODD-DAYS-OVER
 11881              ELSE
 11882                 NEXT SENTENCE
 11883        ELSE
 11884           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 11885              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 11886
 11887     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 11888     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 11889     COMPUTE PI-CPYAMT ROUNDED =
 11890         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 11891         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 11892
 11893     GO TO 1420-CHECK-AIG-BENEFIT.
 11894
 11895 1415-CHECK-LEAP-YEAR.
 11896     IF FROM-DAYS-IN-MONTH = 29
 11897        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 11898
 11899 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 226
* EL156.cbl
 11900     EXIT.
 11901
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 227
* EL156.cbl
 11903 1420-CHECK-AIG-BENEFIT.
 11904
 11905     IF WS-SPECIAL-CALC-CD = 'Q'
 11906         GO TO 1425-CHECK-WHOLE-MONTH.
 11907
 11908*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 11909*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 11910*       (CL-NO-OF-PMTS-MADE < +6)          AND
 11911*       (PI-PMTTYPE = '1' OR '2')
 11912*        NEXT SENTENCE
 11913*    ELSE
 11914         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 11915         GO TO 1430-CHECK-AH-TOLERANCE.
 11916
 11917******************AIG LOGIC STARTS**********************
 11918*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 11919*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 11920*    MOVE ER-3533      TO EMI-ERROR.
 11921*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11922*    GO TO 1430-CHECK-AH-TOLERANCE.
 11923******************AIG LOGIC ENDS************************
 11924
 11925 1425-CHECK-WHOLE-MONTH.
 11926******************************************************************
 11927****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 11928****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 11929****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 11930****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 11931****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 11932****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 11933****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 11934****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 11935****          PAID * MONTHLY BENEFIT.                         ****
 11936******************************************************************
 11937
 11938     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 11939
 11940     IF CL-NO-OF-PMTS-MADE > +0
 11941         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 11942
 11943     IF PI-CDAYS < WS-BEN-DAYS
 11944         GO TO 1430-CHECK-AH-TOLERANCE.
 11945
 11946     IF PI-CDAYS = WS-BEN-DAYS
 11947         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 11948         GO TO 1430-CHECK-AH-TOLERANCE.
 11949
 11950*    IF PI-COMPANY-ID = 'ACM'
 11951*       NEXT SENTENCE
 11952*    ELSE
 11953        GO TO 1425-NOT-ACM-W15C.
 11954
 11955*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 11956*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 11957*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 11958*    MOVE '6'                    TO  DC-OPTION-CODE.
 11959*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11960*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 228
* EL156.cbl
 11961*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 11962*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 11963*       MOVE '1'                 TO  DC-OPTION-CODE
 11964*       MOVE +0                  TO  DC-ELAPSED-DAYS
 11965*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 11966*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11967*       IF NO-CONVERSION-ERROR
 11968*          IF (DC-ELAPSED-MONTHS > +0) OR
 11969*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 11970*             NEXT SENTENCE
 11971*          ELSE
 11972*             MOVE +0            TO  PI-CPYAMT
 11973*             MOVE ER-0846       TO  EMI-ERROR
 11974*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11975*             GO TO 1430-CHECK-AH-TOLERANCE
 11976*       ELSE
 11977*           MOVE ER-0846         TO  EMI-ERROR
 11978*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11979*           GO TO 1430-CHECK-AH-TOLERANCE.
 11980*
 11981*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 11982*       ADD +1 TO DC-ELAPSED-MONTHS.
 11983*
 11984*    COMPUTE PI-CPYAMT ROUNDED =
 11985*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 11986*
 11987*    GO TO 1430-CHECK-AH-TOLERANCE.
 11988
 11989 1425-NOT-ACM-W15C.
 11990
 11991     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 11992     MOVE '6'                        TO  DC-OPTION-CODE.
 11993     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 11994     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 11995
 11996     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11997     IF NO-CONVERSION-ERROR
 11998         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 11999     ELSE
 12000         MOVE ER-0846                TO  EMI-ERROR
 12001         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12002         GO TO 1430-CHECK-AH-TOLERANCE.
 12003
 12004     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12005     MOVE '1'                        TO  DC-OPTION-CODE.
 12006     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12007     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12008     IF NO-CONVERSION-ERROR
 12009         IF DC-ODD-DAYS-OVER = +0
 12010             NEXT SENTENCE
 12011         ELSE
 12012             MOVE ER-0846            TO  EMI-ERROR
 12013             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12014             GO TO 1430-CHECK-AH-TOLERANCE
 12015     ELSE
 12016         MOVE ER-0846                TO  EMI-ERROR
 12017         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12018         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 229
* EL156.cbl
 12019
 12020     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12021         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12022
 12023     GO TO 1430-CHECK-AH-TOLERANCE.
 12024
 12025 1425-CONT-WHOLE-MONTH-PMTS.
 12026******************************************************************
 12027****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12028****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12029****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12030******************************************************************
 12031
 12032     IF PI-COMPANY-ID = 'ACM'
 12033        NEXT SENTENCE
 12034     ELSE
 12035        IF DC-ODD-DAYS-OVER = +0
 12036            NEXT SENTENCE
 12037        ELSE
 12038            MOVE ER-0845            TO  EMI-ERROR
 12039            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12040            GO TO 1430-CHECK-AH-TOLERANCE.
 12041
 12042     COMPUTE PI-CPYAMT ROUNDED =
 12043                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12044
 12045 1430-CHECK-AH-TOLERANCE.
 12046     IF PI-PMT-APPR-SW = 'G'
 12047         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12048
 12049*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12050*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12051*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12052*
 12053*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12054*      IF WDF-MONTH = 02
 12055*        IF SAVE-ELAPSED-MONTHS = 0
 12056*          NEXT SENTENCE
 12057*        ELSE
 12058*          IF SAVE-ODD-DAYS-OVER > 0
 12059*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12060*            COMPUTE WS-PMT-MOS ROUNDED =
 12061*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12062*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12063*                                     WS-PMT-MOS
 12064*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12065*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12066*          ELSE
 12067*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12068*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12069*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12070*                                     WS-PMT-MOS.
 12071
 12072     IF WS-MAX-PMT-TOL NOT = ZERO
 12073        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12074           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12075            MOVE ER-0494         TO  EMI-ERROR
 12076            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 230
* EL156.cbl
 12077            GO TO 1500-EDIT-EXPENSES.
 12078
 12079 1430-CONT-CHECK-AH-TOLERANCE.
 12080
 12081     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12082        GO TO 1500-EDIT-EXPENSES.
 12083
 12084     IF CM-O-B-COVERAGE
 12085        GO TO 1500-EDIT-EXPENSES.
 12086
 12087     IF PI-COMPANY-ID = 'NCL'
 12088       IF FOUND-TOL-SW = 'Y'
 12089         IF WS-PMT-TOL NOT = ZERO
 12090           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12091              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12092                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12093                  IF WS-NCL-PMT-OPTION = SPACES
 12094                      MOVE ER-0699 TO EMI-ERROR
 12095                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12096                  ELSE
 12097                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12098                      NEXT SENTENCE
 12099                  ELSE
 12100                  IF NOT WS-VALID-NCL-OPTION
 12101                      MOVE ER-0699 TO EMI-ERROR
 12102                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12103
 12104     IF WS-PMT-TOL NOT = ZERO
 12105        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12106           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12107           MOVE ER-0495          TO EMI-ERROR
 12108           PERFORM 1490-PAYMENT-ERROR
 12109                                 THRU 1490-EXIT
 12110        end-if
 12111     end-if
 12112
 12113     GO TO 1500-EDIT-EXPENSES.
 12114
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 231
* EL156.cbl
 12116 1440-COMPUTE-LIFE-REMAINING.
 12117
 12118     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12119        IF PI-PMTTYPE = '4'
 12120          MOVE PI-EPYAMT TO PI-CPYAMT
 12121          GO TO 1460-TEST-TYPE.
 12122
 12123     IF WS-LF-COVERAGE-TYPE = 'L'
 12124        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12125                          - CL-TOTAL-PAID-AMT
 12126        GO TO 1450-CHECK-MAX.
 12127
 12128     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12129        PI-LF-COVERAGE-TYPE = 'P'
 12130          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12131                              CM-LF-ITD-DEATH-AMT
 12132          GO TO 1450-CHECK-MAX.
 12133
 12134     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12135     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12136     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12137     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12138     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12139     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12140     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12141     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12142     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12143
 12144     PERFORM 9800-LINK-REM-TERM.
 12145
 12146     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12147     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12148     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12149     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12150     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12151     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12152     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12153     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12154     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12155     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12156     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12157     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12158     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12159     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12160     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12161     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12162     IF PI-COMPANY-ID = 'DCC'
 12163        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12164        MOVE PI-CARRIER          TO ACCT-CARRIER
 12165        MOVE PI-GROUPING         TO ACCT-GROUPING
 12166        MOVE PI-STATE            TO ACCT-STATE
 12167        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12168        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12169        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12170        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12171
 12172
 12173* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 232
* EL156.cbl
 12174*          DATASET ('ERACCT')
 12175*          RIDFLD  (ERACCT-KEY)
 12176*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12177*          GTEQ
 12178*          resp    (WS-RESPONSE)
 12179*       END-EXEC
 12180     MOVE 'ERACCT' TO DFHEIV1
 12181*    MOVE '&"S        G          (  N#00011618' TO DFHEIV0
 12182     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12183     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12184     MOVE X'204E233030303131363138' TO DFHEIV0(25:11)
 12185     CALL 'kxdfhei1' USING DFHEIV0,
 12186           DFHEIV1,
 12187           DFHEIV20,
 12188           DFHEIV99,
 12189           ERACCT-KEY,
 12190           DFHEIV99,
 12191           DFHEIV99,
 12192           DFHEIV99
 12193     SET ADDRESS OF ACCOUNT-MASTER TO
 12194         DFHEIV20
 12195     MOVE EIBRESP  TO WS-RESPONSE
 12196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12197        IF WS-RESP-NORMAL
 12198           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12199           and (pi-cert-eff-dt < am-expiration-dt)
 12200           and (pi-cert-eff-dt >= am-effective-dt)
 12201           move am-dcc-product-code to pi-dcc-product-code
 12202        else
 12203           move spaces           to pi-dcc-product-code
 12204        end-if
 12205        if pi-dcc-product-code not = spaces
 12206           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12207           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12208           PERFORM 0900-GET-DDF-limits
 12209                                 THRU 0900-EXIT
 12210           IF PDEF-FOUND
 12211              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12212                 (P1 > +8)
 12213                 OR (PD-PROD-CODE (P1) = 'L')
 12214              END-PERFORM
 12215              IF P1 < +9
 12216                 MOVE PD-MAX-AMT (P1)
 12217                                 TO CP-R-MAX-TOT-BEN
 12218              else
 12219                 move er-1674    to emi-error
 12220                 PERFORM 9900-ERROR-FORMAT
 12221                                 THRU 9900-EXIT
 12222              END-IF
 12223           else
 12224              move er-1672       to emi-error
 12225              PERFORM 9900-ERROR-FORMAT
 12226                                 THRU 9900-EXIT
 12227           END-IF
 12228        end-if
 12229     END-IF
 12230
 12231* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 233
* EL156.cbl
 12232*       PROGRAM  (LINK-REMAMT)
 12233*       COMMAREA (CALCULATION-PASS-AREA)
 12234*       LENGTH   (CP-COMM-LENGTH)
 12235*    END-EXEC.
 12236*    MOVE '."C                   (   #00011658' TO DFHEIV0
 12237     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12239     MOVE X'2020233030303131363538' TO DFHEIV0(25:11)
 12240     CALL 'kxdfhei1' USING DFHEIV0,
 12241           LINK-REMAMT,
 12242           CALCULATION-PASS-AREA,
 12243           CP-COMM-LENGTH,
 12244           DFHEIV99,
 12245           DFHEIV99,
 12246           DFHEIV99,
 12247           DFHEIV99
 12248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12249
 12250
 12251     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12252
 12253     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12254     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12255
 12256     IF PI-COMPANY-ID = 'BOA' AND
 12257        PI-PMTTYPE    = '2'   AND
 12258        PI-OFFLINE    = 'N'
 12259           GO TO 1441-COMPUTE-BOA-INTEREST.
 12260
 12261     IF PI-COMPANY-ID = 'NCL' AND
 12262        PI-PMTTYPE    = '2'   AND
 12263        PI-OFFLINE    = 'N'
 12264          GO TO 1442-COMPUTE-NCL-INTEREST
 12265       ELSE
 12266          GO TO 1445-CONTINUE.
 12267
 12268 1441-COMPUTE-BOA-INTEREST.
 12269     MOVE +0             TO WS-CALC-INT.
 12270
 12271     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12272     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12273     MOVE +0             TO DC-ELAPSED-MONTHS
 12274                            DC-ELAPSED-DAYS.
 12275     MOVE '1'            TO DC-OPTION-CODE.
 12276     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12277     IF NO-CONVERSION-ERROR
 12278         NEXT SENTENCE
 12279     ELSE
 12280         GO TO 1445-CONTINUE.
 12281
 12282     IF (PI-INT-RATE NOT > ZEROS)  AND
 12283        (DC-ELAPSED-DAYS > +30)
 12284         MOVE ER-3531            TO EMI-ERROR
 12285         MOVE -1                 TO PINTL
 12286         MOVE AL-UNBON           TO PINTA
 12287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12288
 12289     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 234
* EL156.cbl
 12290         GO TO 1445-CONTINUE.
 12291
 12292     IF (PI-INT-RATE NOT > ZEROS)  OR
 12293        (DC-ELAPSED-DAYS NOT > +30)
 12294         MOVE PI-EPYAMT TO PI-CPYAMT
 12295         GO TO 1441-FORMAT-NOTE.
 12296
 12297     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12298                                 *  PI-INT-RATE
 12299                                 *  DC-ELAPSED-DAYS
 12300                                 /  365
 12301                                 /  100.
 12302
 12303     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12304
 12305 1441-FORMAT-NOTE.
 12306
 12307     MOVE SPACES        TO WS-BOANOTE1.
 12308     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12309     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12310     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12311     MOVE AL-UANON      TO NOTE1A.
 12312
 12313     IF WS-CALC-INT > ZEROS
 12314         MOVE SPACES        TO WS-BOANOTE2
 12315         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12316         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12317         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12318         MOVE AL-UANON      TO NOTE2A.
 12319
 12320     GO TO 1445-CONTINUE.
 12321
 12322 1442-COMPUTE-NCL-INTEREST.
 12323     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12324     MOVE PI-STATE               TO WS-ST-ACCESS.
 12325     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12326     MOVE '3'                    TO CNTL-REC-TYPE.
 12327     MOVE +0                     TO CNTL-SEQ-NO.
 12328     MOVE 'STAT'                 TO FILE-SWITCH.
 12329
 12330     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12331
 12332     MOVE +0                 TO WS-CALC-INT.
 12333
 12334     IF ST-STAT-FROM-INCURRED
 12335         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12336       ELSE
 12337     IF ST-STAT-FROM-REPORTED
 12338         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12339       ELSE
 12340         GO TO 1445-CONTINUE.
 12341
 12342     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12343     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12344     MOVE +0                 TO DC-ELAPSED-MONTHS
 12345                                DC-ELAPSED-DAYS.
 12346     MOVE '1'                TO DC-OPTION-CODE.
 12347     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 235
* EL156.cbl
 12348     IF NO-CONVERSION-ERROR
 12349         NEXT SENTENCE
 12350     ELSE
 12351         GO TO 1445-CONTINUE.
 12352
 12353     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12354        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12355         GO TO 1445-CONTINUE.
 12356
 12357     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12358                                 *  CF-ST-STAT-INTEREST.
 12359
 12360     MOVE SPACES              TO WS-NCLNOTE1.
 12361     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12362     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12363     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12364                                 PI-PMTNOTE1
 12365                                 NOTE1I.
 12366     MOVE AL-UANON            TO NOTE1A.
 12367
 12368     IF WS-CALC-INT > ZEROS
 12369         MOVE SPACES          TO WS-NCLNOTE2
 12370         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12371         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12372         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12373                                 PI-PMTNOTE2
 12374                                 NOTE2I
 12375         MOVE AL-UANON        TO NOTE2A.
 12376
 12377     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12378
 12379 1445-CONTINUE.
 12380
 12381     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12382        GO TO 1460-TEST-TYPE.
 12383
 12384     IF CM-O-B-COVERAGE
 12385        GO TO 1460-TEST-TYPE.
 12386
 12387     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12388         GO TO 1450-CHECK-MAX.
 12389
 12390     if (pi-company-id = 'DCC')
 12391        and (pdef-found)
 12392        and (pi-epyamt > pd-max-amt (p1))
 12393        move er-1657             to emi-error
 12394        perform 1490-payment-error
 12395                                 thru 1490-exit
 12396        go to 1460-test-type
 12397     else
 12398        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12399           > PI-EPYAMT)
 12400                         OR
 12401           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12402           < PI-EPYAMT)
 12403           MOVE ER-0594          TO EMI-ERROR
 12404           PERFORM 1490-PAYMENT-ERROR
 12405                                 THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 236
* EL156.cbl
 12406           GO TO 1460-TEST-TYPE
 12407        end-if
 12408     end-if
 12409     .
 12410 1450-CHECK-MAX.
 12411
 12412     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12413        PI-LF-COVERAGE-TYPE = 'P'
 12414         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12415                                   CM-LF-ITD-DEATH-AMT
 12416     ELSE
 12417         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12418                                   CL-TOTAL-PAID-AMT.
 12419
 12420     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12421          MOVE ER-0543           TO EMI-ERROR
 12422          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12423
 12424 1460-TEST-TYPE.
 12425
 12426     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12427        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12428           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12429                                   CM-LF-ALT-BENEFIT-AMT -
 12430                                   CL-TOTAL-PAID-AMT
 12431           IF PI-EPYAMT > WS-LF-BEN-AMT
 12432               MOVE ER-0543      TO EMI-ERROR
 12433               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12434           END-IF
 12435        END-IF
 12436     END-IF
 12437
 12438     IF PI-PMT-APPR-SW = 'G'
 12439       NEXT SENTENCE
 12440     ELSE
 12441       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12442         IF PI-EPYAMT = ZERO
 12443             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12444                 MOVE ER-0494    TO  EMI-ERROR
 12445                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12446                 GO TO 1500-EDIT-EXPENSES
 12447             ELSE
 12448                 NEXT SENTENCE
 12449         ELSE
 12450             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12451                 MOVE ER-0494    TO  EMI-ERROR
 12452                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12453                 GO TO 1500-EDIT-EXPENSES.
 12454
 12455     IF PI-PMTTYPE NOT = '2' OR
 12456        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12457         GO TO 1500-EDIT-EXPENSES.
 12458
 12459     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12460     MOVE ER-0526                TO EMI-ERROR.
 12461     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12462
 12463     IF EMI-ERROR-NUMBER (1) = '0526'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 237
* EL156.cbl
 12464        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12465
 12466     IF EMI-ERROR-NUMBER (2) = '0526'
 12467        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12468
 12469     GO TO 1500-EDIT-EXPENSES.
 12470
 12471 1490-PAYMENT-ERROR.
 12472     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12473
 12474     IF EMI-MESSAGE-FORMATTED
 12475         MOVE -1                 TO EPYAMTL
 12476         MOVE AL-UNBON           TO EPYAMTA.
 12477
 12478 1490-EXIT.
 12479      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 238
* EL156.cbl
 12481 1500-EDIT-EXPENSES.
 12482     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12483         GO TO 1500-SKIP-ERROR-0556.
 12484
 12485 1500-CONTINUE-ON.
 12486
 12487     IF CM-O-B-COVERAGE
 12488        MOVE ER-0556             TO EMI-ERROR
 12489        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12490
 12491 1500-SKIP-ERROR-0556.
 12492     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12493        IF PI-EEXPENS NOT = ZEROS
 12494           MOVE ER-0524          TO EMI-ERROR
 12495           GO TO 1590-EXPENSE-ERROR
 12496        ELSE
 12497           GO TO 1600-EDIT-RESERVES.
 12498
 12499     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12500     MOVE '6'                    TO CNTL-REC-TYPE.
 12501
 12502     IF CONTROL-IS-ACTUAL-CARRIER
 12503         MOVE PI-CARRIER         TO WS-CARR
 12504     ELSE
 12505         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12506
 12507     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12508     MOVE +0                     TO CNTL-SEQ-NO.
 12509     MOVE 'CARR'                 TO FILE-SWITCH.
 12510
 12511     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12512
 12513     IF EXPENSE-CALC-MANUAL
 12514        GO TO 1600-EDIT-RESERVES.
 12515
 12516     IF DOLLARS-PER-PMT
 12517        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12518        GO TO 1600-EDIT-RESERVES.
 12519
 12520     IF DOLLARS-PER-MONTH AND
 12521        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 12522       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12523       GO TO 1600-EDIT-RESERVES.
 12524
 12525     IF PERCENT-OF-PAYMENT
 12526        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12527
 12528     GO TO 1600-EDIT-RESERVES.
 12529
 12530 1590-EXPENSE-ERROR.
 12531     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12532
 12533     IF EMI-MESSAGE-FORMATTED
 12534        MOVE -1                  TO EEXPENSL
 12535        MOVE AL-UNBON            TO EEXPENSA.
 12536
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 239
* EL156.cbl
 12538 1600-EDIT-RESERVES.
 12539     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12540        IF PI-ERESV = ZEROS
 12541           GO TO 1700-EDIT-EXPENSE-TYPE
 12542        ELSE
 12543           MOVE ER-0525          TO EMI-ERROR
 12544           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12545           GO TO 1700-EDIT-EXPENSE-TYPE.
 12546
 12547     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12548     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12549     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12550
 12551     IF NOT AT-MANUAL-RESERVES-USED
 12552        IF PI-ERESV NOT = ZEROS
 12553           MOVE ER-0518          TO EMI-ERROR
 12554           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12555
 12556     IF AT-MANUAL-RESERVES-USED
 12557        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12558        GO TO 1700-EDIT-EXPENSE-TYPE.
 12559
 12560     IF AT-FUTURE-RESERVES-USED
 12561        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12562
 12563     IF AT-FUTURE-RESERVES-USED
 12564        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12565
 12566     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12567        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12568
 12569     IF AT-IBNR-RESERVES-USED
 12570        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12571
 12572     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12573     GO TO 1700-EDIT-EXPENSE-TYPE.
 12574
 12575 1690-RESERVE-ERROR.
 12576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12577
 12578     IF EMI-MESSAGE-FORMATTED
 12579        MOVE AL-UNBON            TO ERESVA
 12580        MOVE -1                  TO ERESVL.
 12581
 12582 1690-EXIT.
 12583      EXIT.
 12584
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 240
* EL156.cbl
 12586 1700-EDIT-EXPENSE-TYPE.
 12587     IF PI-PMTTYPE NOT = '5' AND '6'
 12588        GO TO 2000-EDIT-DONE.
 12589
 12590     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12591                   '6' OR '7' OR '8' OR '9'
 12592        GO TO 2000-EDIT-DONE.
 12593
 12594 1705-EXPENSE-ERROR.
 12595     MOVE ER-0573                TO EMI-ERROR.
 12596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12597
 12598     IF EMI-MESSAGE-FORMATTED
 12599        MOVE AL-UABON            TO ETYPEA
 12600        MOVE -1                  TO ETYPEL.
 12601
 12602     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 241
* EL156.cbl
 12604 1950-NOT-FOUND.
 12605     IF FILE-SWITCH = 'MSTR'
 12606        MOVE ER-0204             TO EMI-ERROR.
 12607
 12608     IF FILE-SWITCH = 'CARR'
 12609        MOVE ER-0252             TO EMI-ERROR.
 12610
 12611     IF FILE-SWITCH = 'COMP'
 12612        MOVE ER-0254             TO EMI-ERROR.
 12613
 12614     IF FILE-SWITCH = 'STAT'
 12615        MOVE ER-0149             TO EMI-ERROR.
 12616
 12617     IF FILE-SWITCH = 'PROC'
 12618        MOVE ER-0019             TO EMI-ERROR.
 12619
 12620     IF FILE-SWITCH = 'ACCT'
 12621        MOVE ER-0198             TO EMI-ERROR.
 12622
 12623     IF FILE-SWITCH = 'BENE'
 12624        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12625           MOVE ER-0282          TO EMI-ERROR
 12626        ELSE
 12627           MOVE ER-0283          TO EMI-ERROR.
 12628
 12629     MOVE -1                     TO PMTTYPEL.
 12630     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12631
 12632     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12633                                     WS-FORCE-CTR.
 12634
 12635     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12636                                     WS-FATAL-CTR.
 12637
 12638     GO TO 8200-SEND-DATAONLY.
 12639
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 242
* EL156.cbl
 12641 2000-EDIT-DONE.
 12642*********************
 12643     perform 2210-dcc-max-benes thru 2210-exit
 12644     if pi-company-id not = 'DCC'
 12645        IF (WS-SPECIAL-CALC-CD = 'C')
 12646           and (cl-critical-period > 0)
 12647           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12648              IF PI-EPYAMT > ZEROS
 12649                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12650                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12651              ELSE
 12652                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12653                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12654              END-IF
 12655              if ws-benefits-paid > cl-critical-period
 12656                 MOVE ER-0657          TO EMI-ERROR
 12657                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12658              END-IF
 12659           END-IF
 12660        END-IF
 12661     end-if
 12662     IF PI-HOLDTIL NOT = ZEROS
 12663        MOVE PI-HOLDTIL          TO HOLDTILO
 12664        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12665
 12666     IF PI-EPYFROM NOT = ZEROS
 12667        MOVE PI-EPYFROM          TO EPYFROMO
 12668        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12669
 12670     IF PI-EPYTHRU NOT = ZEROS
 12671        MOVE PI-EPYTHRU            TO EPYTHRUO
 12672        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12673        IF PI-USES-PAID-TO
 12674           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12675           MOVE '4'                TO DC-OPTION-CODE
 12676           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12677           IF NO-CONVERSION-ERROR
 12678              MOVE +1              TO DC-ELAPSED-DAYS
 12679              MOVE +0              TO DC-ELAPSED-MONTHS
 12680              MOVE '6'             TO DC-OPTION-CODE
 12681              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12682              IF NO-CONVERSION-ERROR
 12683                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12684
 12685     MOVE PI-EDAYS               TO EDAYSO.
 12686
 12687     IF PI-AIGFROM NOT = ZEROS
 12688        MOVE PI-AIGFROM          TO AIGFROMO
 12689        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12690
 12691     MOVE PI-EPYAMT              TO EPYAMTO.
 12692     MOVE PI-ERESV               TO ERESVO.
 12693     MOVE PI-EEXPENS             TO EEXPENSO.
 12694
 12695     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12696     MOVE SPACES                 TO DC-OPTION-CODE.
 12697     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12698
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 243
* EL156.cbl
 12699     IF DATE-CONVERSION-ERROR
 12700        MOVE SPACES              TO CPYFROMI
 12701     ELSE
 12702        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12703        IF PI-EPYFROM = ZEROS
 12704           MOVE AL-UANON             TO EPYFROMA
 12705           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12706           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12707
 12708     IF PI-USES-PAID-TO
 12709        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12710        MOVE +1                            TO DC-ELAPSED-DAYS
 12711        MOVE +0                            TO DC-ELAPSED-MONTHS
 12712        MOVE '6'                           TO DC-OPTION-CODE
 12713        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12714        IF NO-CONVERSION-ERROR
 12715           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12716           IF PI-EPYTHRU = ZEROS
 12717              MOVE AL-UANON                TO EPYTHRUA
 12718              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12719              MOVE ' '                     TO DC-OPTION-CODE
 12720              MOVE +0                      TO DC-ELAPSED-DAYS
 12721                                              DC-ELAPSED-MONTHS
 12722              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12723              IF NO-CONVERSION-ERROR
 12724                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12725                  GO TO 2001-CONTINUE
 12726              ELSE
 12727                  GO TO 2001-CONTINUE
 12728           ELSE
 12729              GO TO 2001-CONTINUE.
 12730
 12731     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12732     MOVE SPACES                 TO DC-OPTION-CODE.
 12733     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12734
 12735     IF DATE-CONVERSION-ERROR
 12736        MOVE SPACES              TO CPYTHRUI
 12737     ELSE
 12738        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12739        IF PI-EPYTHRU = ZEROS
 12740           MOVE AL-UANON TO EPYTHRUA
 12741           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12742           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12743
 12744 2001-CONTINUE.
 12745
 12746     MOVE PI-CDAYS               TO CDAYSO.
 12747
 12748     IF PI-EDAYS = ZEROS
 12749        MOVE AL-UNNON TO EDAYSA
 12750        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12751
 12752     MOVE PI-CPYAMT              TO CPYAMTO.
 12753
 12754     IF PI-EPYAMT = ZEROS
 12755        MOVE AL-UNNON            TO EPYAMTA
 12756        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 244
* EL156.cbl
 12757
 12758     MOVE PI-CRESV               TO CRESVO.
 12759     MOVE PI-CEXPENS             TO CEXPENSO.
 12760
 12761     IF PI-EEXPENS = ZEROS
 12762        MOVE AL-UNNON TO EEXPENSA
 12763        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12764
 12765     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12766        AND (CL-CLAIM-TYPE = 'L')
 12767        AND (PI-OFFLINE NOT EQUAL 'Y')
 12768        IF PI-PMTTYPE = '2' OR '4'
 12769           PERFORM 2200-CALC-INTEREST
 12770                                 THRU 2200-EXIT
 12771        END-IF
 12772     END-IF
 12773     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12774     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12775     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12776
 12777     IF EMI-FATAL-CTR = ZEROS
 12778        MOVE 'B'                 TO PI-PASS-SW.
 12779
 12780     IF NOT EMI-MESSAGE-FORMATTED
 12781         MOVE -1                 TO EPYFROML
 12782     ELSE
 12783         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12784            EMI-ERROR-NUMBER (2) = SPACES
 12785             MOVE -1             TO EPYFROML.
 12786
 12787     GO TO 8200-SEND-DATAONLY.
 12788
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 245
* EL156.cbl
 12790 2200-CALC-INTEREST.
 12791     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12792        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12793        MOVE '4'                 TO DC-OPTION-CODE
 12794        PERFORM 9700-LINK-DATE-CONVERT
 12795        IF DATE-CONVERSION-ERROR
 12796            MOVE LOW-VALUES      TO CP-PRF-DT
 12797        ELSE
 12798           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12799        END-IF
 12800     END-IF
 12801     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12802        IN CLAIM-INT-PASS-AREA
 12803     MOVE CL-CERT-STATE          TO CP-STATE
 12804        IN CLAIM-INT-PASS-AREA
 12805     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12806     MOVE 'LF'                   TO CP-COVERAGE
 12807     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12808     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12809     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12810     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12811     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12812     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12813
 12814* EXEC CICS LINK
 12815*       PROGRAM   ('ELCLMI')
 12816*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12817*       LENGTH    (CP-CLAIM-LENGTH)
 12818*    END-EXEC
 12819     MOVE 'ELCLMI' TO DFHEIV1
 12820*    MOVE '."C                   (   #00012226' TO DFHEIV0
 12821     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12822     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12823     MOVE X'2020233030303132323236' TO DFHEIV0(25:11)
 12824     CALL 'kxdfhei1' USING DFHEIV0,
 12825           DFHEIV1,
 12826           CLAIM-INT-PASS-AREA,
 12827           CP-CLAIM-LENGTH,
 12828           DFHEIV99,
 12829           DFHEIV99,
 12830           DFHEIV99,
 12831           DFHEIV99
 12832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12833     MOVE AL-PANOF               TO PINTHA
 12834                                    PINTA
 12835     IF NO-CI-ERROR
 12836        MOVE CP-CLM-INT-AMT      TO PINTO
 12837                                    PI-INT-AMT
 12838        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12839        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12840        MOVE AL-PANOF            TO PINTHA
 12841                                    PINTA
 12842     ELSE
 12843        IF CI-RETURN-CODE = '8'
 12844           MOVE ER-3818          TO EMI-ERROR
 12845           MOVE -1               TO ZINTL
 12846           PERFORM 9900-ERROR-FORMAT
 12847                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 246
* EL156.cbl
 12848           GO TO 2200-EXIT
 12849        ELSE
 12850           MOVE ZEROS            TO PINTO
 12851                                    PI-INT-AMT
 12852                                    PI-INT-DAYS
 12853                                    PI-INT-RATE-USED
 12854        END-IF
 12855     END-IF
 12856     IF PI-INT-AMT NOT = ZEROS
 12857        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12858           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12859           CONTINUE
 12860        ELSE
 12861           MOVE CL-SOC-SEC-NO (1:3)
 12862                                 TO WS-SSN (1:3)
 12863           MOVE CL-SOC-SEC-NO (5:2)
 12864                                 TO WS-SSN (4:2)
 12865           MOVE CL-SOC-SEC-NO (8:4)
 12866                                 TO WS-SSN (6:4)
 12867           IF (WS-SSN NUMERIC)
 12868              AND (WS-SSN NOT = ZEROS)
 12869              CONTINUE
 12870           ELSE
 12871              MOVE ER-2044       TO EMI-ERROR
 12872              PERFORM 9900-ERROR-FORMAT
 12873                                 THRU 9900-EXIT
 12874           END-IF
 12875        END-IF
 12876        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 12877        MOVE +51                 TO TRLR-SEQ-NO
 12878
 12879* EXEC CICS READ
 12880*          DATASET  ('ELTRLR')
 12881*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12882*          RIDFLD   (ELTRLR-KEY)
 12883*          RESP     (WS-RESPONSE)
 12884*       END-EXEC
 12885     MOVE 'ELTRLR' TO DFHEIV1
 12886*    MOVE '&"S        E          (  N#00012276' TO DFHEIV0
 12887     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12888     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12889     MOVE X'204E233030303132323736' TO DFHEIV0(25:11)
 12890     CALL 'kxdfhei1' USING DFHEIV0,
 12891           DFHEIV1,
 12892           DFHEIV20,
 12893           DFHEIV99,
 12894           ELTRLR-KEY,
 12895           DFHEIV99,
 12896           DFHEIV99,
 12897           DFHEIV99
 12898     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12899         DFHEIV20
 12900     MOVE EIBRESP  TO WS-RESPONSE
 12901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12902        IF (NOT WS-RESP-NORMAL)
 12903                    OR
 12904           ((WS-RESP-NORMAL)
 12905           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 247
* EL156.cbl
 12906           OR (AT-CITY-STATE = SPACES)))
 12907           MOVE ER-0874          TO EMI-ERROR
 12908           PERFORM 9900-ERROR-FORMAT
 12909                                 THRU 9900-EXIT
 12910        END-IF
 12911     END-IF
 12912     .
 12913 2200-EXIT.
 12914     EXIT.
 12915 2210-dcc-max-benes.
 12916
 12917     move pi-ah-term             to ws-max-bens
 12918     if cl-critical-period not = zeros and spaces
 12919        move cl-critical-period  to ws-max-bens
 12920     end-if
 12921     move cm-ah-benefit-amt      to ws-monthly-benefit
 12922     if pdef-found
 12923        and (pd-max-amt (p1) not = zeros)
 12924        and (pd-max-amt (p1) < ws-monthly-benefit)
 12925        move pd-max-amt (p1)     to ws-monthly-benefit
 12926     end-if
 12927
 12928     move cl-cert-key-data       to elcrtt-key (2:21)
 12929     move cl-company-cd          to ctrlr-comp-cd
 12930     move cl-cert-no             to ctrlr-cert-no
 12931     move 'B'                    to ctrlr-rec-type
 12932
 12933
 12934* EXEC CICS READ
 12935*       DATASET  ('ELCRTT')
 12936*       set      (address of CERTIFICATE-TRAILERS)
 12937*       RIDFLD   (ELCRTT-KEY)
 12938*       RESP     (WS-RESPONSE)
 12939*    END-EXEC
 12940     MOVE 'ELCRTT' TO DFHEIV1
 12941*    MOVE '&"S        E          (  N#00012313' TO DFHEIV0
 12942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12944     MOVE X'204E233030303132333133' TO DFHEIV0(25:11)
 12945     CALL 'kxdfhei1' USING DFHEIV0,
 12946           DFHEIV1,
 12947           DFHEIV20,
 12948           DFHEIV99,
 12949           ELCRTT-KEY,
 12950           DFHEIV99,
 12951           DFHEIV99,
 12952           DFHEIV99
 12953     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12954         DFHEIV20
 12955     MOVE EIBRESP  TO WS-RESPONSE
 12956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12957     IF not WS-RESP-NORMAL
 12958        go to 2210-exit
 12959     end-if
 12960
 12961*    if instypei = 'P'
 12962*       move +1 to s1
 12963*    else
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 248
* EL156.cbl
 12964*       MOVE +2 to s1
 12965*    end-if
 12966
 12967*    move +1 to s1
 12968*    evaluate cl-claim-type
 12969*       when 'A'
 12970*          move +1 to s2
 12971*       when 'I'
 12972*          move +2 to s2
 12973*       when 'G'
 12974*          move +3 to s2
 12975*       when 'L'
 12976*          move +4 to s2
 12977*       when 'P'
 12978*          move +5 to s2
 12979*    end-evaluate
 12980
 12981     move zeros                  to ws-prev-days-paid
 12982                                    ws-benefits-paid
 12983                                    ws-prev-amt-paid
 12984     perform varying s1 from +1 by +1 until
 12985        (s1 > +24)
 12986        or (cs-claim-type (s1) = spaces)
 12987        if pi-company-id not = 'DCC'
 12988           if cs-claim-type (s1) = cl-claim-type
 12989              compute ws-prev-days-paid =
 12990                 ws-prev-days-paid + cs-days-paid (s1)
 12991              compute ws-prev-amt-paid =
 12992                 ws-prev-amt-paid + cs-total-paid (s1)
 12993           end-if
 12994        else
 12995           if (cs-claim-type (s1) = cl-claim-type)
 12996              and (cs-benefit-period (s1) = cl-benefit-period)
 12997              and (cs-insured-type (s1) = cl-insured-type)
 12998              compute ws-prev-days-paid =
 12999                 ws-prev-days-paid + cs-days-paid (s1)
 13000              compute ws-prev-amt-paid =
 13001                 ws-prev-amt-paid + cs-total-paid (s1)
 13002           end-if
 13003        end-if
 13004     end-perform
 13005     if pi-epyamt > zeros
 13006        compute ws-benefits-paid =
 13007           (ws-prev-amt-paid + pi-epyamt)
 13008           / ws-monthly-benefit
 13009     else
 13010        compute ws-benefits-paid =
 13011           (ws-prev-amt-paid + pi-cpyamt)
 13012           / ws-monthly-benefit
 13013     end-if
 13014     if pi-company-id = 'DCC'
 13015     if cl-claim-type not = 'L' and 'P'
 13016        if ws-benefits-paid > ws-max-bens
 13017           move er-1658          to emi-error
 13018           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13019        end-if
 13020     end-if
 13021     end-if
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 249
* EL156.cbl
 13022*     if s1 < +25
 13023*        if pi-epyamt > zeros
 13024*           compute ws-benefits-paid =
 13025*              (cs-total-paid (s1) + PI-EPYAMT)
 13026*              / ws-monthly-benefit
 13027*        else
 13028*           compute ws-benefits-paid =
 13029*              (cs-total-paid (s1) + PI-CPYAMT)
 13030*              / ws-monthly-benefit
 13031*        end-if
 13032
 13033*       if ws-benefits-paid > pd-crit-period (p1)
 13034*        if ws-benefits-paid > ws-max-bens
 13035*           move er-1658          to emi-error
 13036*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13037*        end-if
 13038*     end-if
 13039     .
 13040 2210-exit.
 13041     exit.
 13042
 13043 2220-update-elcrtt.
 13044
 13045
 13046* EXEC CICS GETMAIN
 13047*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13048*       LENGTH   (ELCRTT-LENGTH)
 13049*       INITIMG  (GETMAIN-SPACE)
 13050*    END-EXEC
 13051*    MOVE ',"IL                  $   #00012407' TO DFHEIV0
 13052     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13053     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13054     MOVE X'2020233030303132343037' TO DFHEIV0(25:11)
 13055     CALL 'kxdfhei1' USING DFHEIV0,
 13056           DFHEIV20,
 13057           ELCRTT-LENGTH,
 13058           GETMAIN-SPACE
 13059     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13060         DFHEIV20
 13061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13062
 13063     move cl-cert-key-data       to elcrtt-key (2:21)
 13064     move cl-company-cd          to ctrlr-comp-cd
 13065     move cl-cert-no             to ctrlr-cert-no
 13066     move 'B'                    to ctrlr-rec-type
 13067
 13068
 13069* EXEC CICS READ
 13070*       UPDATE
 13071*       DATASET  (ELCRTT-DSID)
 13072*       into     (CERTIFICATE-TRAILERS)
 13073*       RIDFLD   (ELCRTT-KEY)
 13074*       RESP     (WS-RESPONSE)
 13075*    END-EXEC
 13076     MOVE LENGTH OF
 13077      CERTIFICATE-TRAILERS
 13078       TO DFHEIV11
 13079*    MOVE '&"IL       EU         (  N#00012418' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 250
* EL156.cbl
 13080     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13081     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13082     MOVE X'204E233030303132343138' TO DFHEIV0(25:11)
 13083     CALL 'kxdfhei1' USING DFHEIV0,
 13084           ELCRTT-DSID,
 13085           CERTIFICATE-TRAILERS,
 13086           DFHEIV11,
 13087           ELCRTT-KEY,
 13088           DFHEIV99,
 13089           DFHEIV99,
 13090           DFHEIV99
 13091     MOVE EIBRESP  TO WS-RESPONSE
 13092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13093
 13094     IF WS-RESP-NORMAL
 13095        perform 2225-upd-crt-trlr thru 2225-exit
 13096
 13097* EXEC CICS REWRITE
 13098*          DATASET  (ELCRTT-DSID)
 13099*          from     (CERTIFICATE-TRAILERS)
 13100*          RESP     (WS-RESPONSE)
 13101*       END-EXEC
 13102     MOVE LENGTH OF
 13103      CERTIFICATE-TRAILERS
 13104       TO DFHEIV11
 13105*    MOVE '&& L                  %  N#00012428' TO DFHEIV0
 13106     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13107     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13108     MOVE X'204E233030303132343238' TO DFHEIV0(25:11)
 13109     CALL 'kxdfhei1' USING DFHEIV0,
 13110           ELCRTT-DSID,
 13111           CERTIFICATE-TRAILERS,
 13112           DFHEIV11,
 13113           DFHEIV99
 13114     MOVE EIBRESP  TO WS-RESPONSE
 13115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13116     else
 13117        if ws-resp-notfnd
 13118           move 'CS'             to certificate-trailers
 13119           move cl-company-cd    to cs-company-cd
 13120           move cl-cert-key-data to cs-control-primary (2:21)
 13121           move cl-cert-no       to cs-cert-no
 13122           move 'B'              to cs-trailer-type
 13123           perform varying s1 from +1 by +1 until s1 > +24
 13124              move zeros         to cs-benefit-period (s1)
 13125                                    cs-days-paid (s1)
 13126                                    cs-total-paid (s1)
 13127                                    cs-remaining-bens (s1)
 13128           end-perform
 13129           perform 2225-upd-crt-trlr
 13130                                 thru 2225-exit
 13131
 13132* EXEC CICS WRITE
 13133*             DATASET  (ELCRTT-DSID)
 13134*             from     (CERTIFICATE-TRAILERS)
 13135*             RIDFLD   (cs-control-primary)
 13136*             RESP     (WS-RESPONSE)
 13137*          END-EXEC
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 251
* EL156.cbl
 13138     MOVE LENGTH OF
 13139      CERTIFICATE-TRAILERS
 13140       TO DFHEIV11
 13141*    MOVE '&$ L                  ''  N#00012448' TO DFHEIV0
 13142     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13143     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13144     MOVE X'204E233030303132343438' TO DFHEIV0(25:11)
 13145     CALL 'kxdfhei1' USING DFHEIV0,
 13146           ELCRTT-DSID,
 13147           CERTIFICATE-TRAILERS,
 13148           DFHEIV11,
 13149           cs-control-primary,
 13150           DFHEIV99,
 13151           DFHEIV99
 13152     MOVE EIBRESP  TO WS-RESPONSE
 13153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13154        end-if
 13155     END-IF
 13156
 13157     .
 13158 2220-exit.
 13159     exit.
 13160
 13161 2225-upd-crt-trlr.
 13162
 13163*    if instypei = 'P'
 13164*       move +1 to s1
 13165*    else
 13166*       MOVE +2 to s1
 13167*    end-if
 13168
 13169*    move +1 to s1
 13170*    evaluate cl-claim-type
 13171*       when 'A'
 13172*          move +1 to s2
 13173*       when 'I'
 13174*          move +2 to s2
 13175*       when 'G'
 13176*          move +3 to s2
 13177*       when 'L'
 13178*          move +4 to s2
 13179*       when 'P'
 13180*          move +5 to s2
 13181*    end-evaluate
 13182     perform varying s1 from +1 by +1 until
 13183        (s1 > +24)
 13184        or (cl-claim-no = cs-claim-no (s1))
 13185     end-perform
 13186     if s1 < +25
 13187        compute cs-total-paid (s1) =
 13188           cs-total-paid (s1) + at-amount-paid
 13189        compute cs-days-paid (s1) =
 13190           cs-days-paid (s1) +  at-days-in-period
 13191*       compute cs-remaining-bens (s1) =
 13192*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13193        perform 2230-accum-bens-paid thru 2230-exit
 13194     end-if
 13195
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 252
* EL156.cbl
 13196     .
 13197 2225-exit.
 13198     exit.
 13199 2230-accum-bens-paid.
 13200     if cl-claim-type not = 'L' and 'P'
 13201        move pi-ah-term          to ws-max-bens
 13202        if cl-critical-period not = zeros and spaces
 13203           move cl-critical-period
 13204                                 to ws-max-bens
 13205        end-if
 13206     else
 13207        move 01                  to ws-max-bens
 13208     end-if
 13209     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13210     perform varying s2 from +1 by +1 until
 13211        (s2 > +24)
 13212        or (cs-claim-no (s2) = spaces)
 13213        if pi-company-id not = 'DCC'
 13214           if cs-claim-type (s2) = cl-claim-type
 13215              compute ws-tot-days-paid =
 13216                 ws-tot-days-paid + cs-days-paid (s2)
 13217              compute ws-tot-amt-paid =
 13218                 ws-tot-amt-paid + cs-total-paid (s2)
 13219           end-if
 13220        else
 13221           if (cs-benefit-period (s2) = cl-benefit-period)
 13222              and (cs-claim-type (s2) = cl-claim-type)
 13223              and (cs-insured-type (s2) = cl-insured-type)
 13224              compute ws-tot-days-paid =
 13225                 ws-tot-days-paid + cs-days-paid (s2)
 13226              compute ws-tot-amt-paid =
 13227                 ws-tot-amt-paid + cs-total-paid (s2)
 13228           end-if
 13229        end-if
 13230     end-perform
 13231     if cl-claim-type = 'L' and 'P'
 13232        if ws-tot-amt-paid > zeros
 13233           move zeros            to cs-remaining-bens (s1)
 13234        else
 13235           move 01               to cs-remaining-bens (s1)
 13236        end-if
 13237     else
 13238        compute ws-pd-bens rounded =
 13239           ws-tot-amt-paid / pi-ah-benefit-amt
 13240        compute cs-remaining-bens (s1) =
 13241           ws-max-bens - ws-pd-bens
 13242        if cs-remaining-bens (s1) < zeros
 13243           move zeros            to cs-remaining-bens (s1)
 13244        end-if
 13245     end-if
 13246     .
 13247 2230-exit.
 13248     exit.
 13249 3000-MOVE-INPUT-TO-SAVE-AREA.
 13250     IF PMTTYPEL > 0
 13251         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13252
 13253     MOVE SPACES                 TO PI-PROVISIONAL-IND.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 253
* EL156.cbl
 13254
 13255     IF WS-PMTTYPE = '9'
 13256         MOVE 'P'                TO PI-PROVISIONAL-IND
 13257         MOVE '1'                TO WS-PMTTYPE.
 13258
 13259     IF PAYEEL > 0
 13260         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13261         MOVE PAYEEI             TO WS-PAYEE.
 13262
 13263     IF NOTE1L > +0
 13264         MOVE NOTE1I             TO WS-PMTNOTE1
 13265                                    WS-FLI-PMTNOTE
 13266                                    WS-HAN-PMTNOTE.
 13267
 13268     IF NOTE2L > +0
 13269         MOVE NOTE2I             TO WS-PMTNOTE2.
 13270
 13271     IF OFFLINEL > 0
 13272         MOVE OFFLINEI           TO WS-OFFLINE.
 13273
 13274     IF PROOFDTL > 0
 13275         MOVE PROOFDTI            TO DATE-WORK
 13276         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13277         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13278         MOVE '4'                 TO DC-OPTION-CODE
 13279         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13280         IF NO-CONVERSION-ERROR
 13281            MOVE NUM-WORK         TO PROOFDTO
 13282            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13283            MOVE NUM-WORK         TO WS-PROOF-DATE
 13284         ELSE
 13285            MOVE ZEROS            TO WS-PROOF-DATE
 13286         END-IF
 13287     END-IF.
 13288
 13289     IF EOBYNL > +0
 13290         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13291         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13292     END-IF
 13293
 13294     IF CLMFMYNL > +0
 13295         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13296         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13297     END-IF
 13298
 13299     IF SURVYYNL > +0
 13300         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13301         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13302     END-IF
 13303
 13304     IF SPRELYNL > +0
 13305         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13306         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13307     END-IF
 13308*    IF GROUPEDL > +0
 13309*        MOVE GROUPEDI           TO WS-GROUPED.
 13310*
 13311*    IF CASHL > +0
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 254
* EL156.cbl
 13312*       MOVE CASHI               TO WS-CASH.
 13313     IF LOANNOL > +0
 13314         MOVE LOANNOI            TO WS-LOAN-NO.
 13315
 13316     IF CHECKNOL > 0
 13317         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13318
 13319     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13320         IF WS-AIG-CREDIT-ENTERED
 13321             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13322             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13323             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13324             MOVE AL-UANON         TO CHECKNOA.
 13325
 13326     IF HOLDTILL > 0
 13327         MOVE HOLDTILI           TO DATE-WORK
 13328         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13329         MOVE NUM-WORK           TO WS-HOLDTIL.
 13330
 13331     IF ZINTL > +0
 13332
 13333* EXEC CICS BIF DEEDIT
 13334*           FIELD   (ZINTI)
 13335*           LENGTH  (07)
 13336*       END-EXEC
 13337     MOVE 07
 13338       TO DFHEIV11
 13339*    MOVE '@"L                   #   #00012632' TO DFHEIV0
 13340     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13341     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13342     MOVE X'2020233030303132363332' TO DFHEIV0(25:11)
 13343     CALL 'kxdfhei1' USING DFHEIV0,
 13344           ZINTI,
 13345           DFHEIV11
 13346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13347        IF ZINTI NOT NUMERIC
 13348           MOVE ER-0419          TO EMI-ERROR
 13349           PERFORM 9900-ERROR-FORMAT
 13350           MOVE AL-UABON         TO ZINTA
 13351           MOVE -1               TO ZINTL
 13352        ELSE
 13353           MOVE ZINTI            TO CP-INT-RATE
 13354                                    WS-INT-RATE
 13355           MOVE CP-INT-RATE      TO ZINTO
 13356           MOVE AL-UNNON         TO ZINTA
 13357        END-IF
 13358     ELSE
 13359        MOVE ZEROS               TO CP-INT-RATE
 13360     END-IF
 13361     IF EPYFROML > 0
 13362         MOVE EPYFROMI           TO DATE-WORK
 13363         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13364         MOVE NUM-WORK           TO WS-EPYFROM.
 13365
 13366     IF AIGFROML > 0
 13367         MOVE AIGFROMI           TO DATE-WORK
 13368         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13369         MOVE NUM-WORK           TO WS-AIGFROM
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 255
* EL156.cbl
 13370     ELSE
 13371         IF (AIGFROMI = LOW-VALUES) AND
 13372            (PI-AIGFROM NOT = ZEROS)
 13373              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13374
 13375     IF EPYTHRUL > +0
 13376        MOVE EPYTHRUI           TO DATE-WORK
 13377        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13378        MOVE NUM-WORK           TO WS-EPYTHRU
 13379        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13380        MOVE '4'                TO DC-OPTION-CODE
 13381        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13382        IF NO-CONVERSION-ERROR
 13383           IF PI-USES-PAID-TO
 13384              MOVE '6'                TO DC-OPTION-CODE
 13385              MOVE -1                 TO DC-ELAPSED-DAYS
 13386              MOVE +0                 TO DC-ELAPSED-MONTHS
 13387              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13388              IF NO-CONVERSION-ERROR
 13389                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13390                 MOVE ' '             TO DC-OPTION-CODE
 13391                 MOVE +0              TO DC-ELAPSED-DAYS
 13392                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13393              IF NO-CONVERSION-ERROR
 13394                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13395
 13396*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13397*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13398     IF EDAYSL > 0
 13399
 13400* EXEC CICS BIF DEEDIT
 13401*            FIELD(EDAYSI)
 13402*            LENGTH(6)
 13403*        END-EXEC
 13404     MOVE 6
 13405       TO DFHEIV11
 13406*    MOVE '@"L                   #   #00012688' TO DFHEIV0
 13407     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13408     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13409     MOVE X'2020233030303132363838' TO DFHEIV0(25:11)
 13410     CALL 'kxdfhei1' USING DFHEIV0,
 13411           EDAYSI,
 13412           DFHEIV11
 13413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13414         MOVE EDAYSI             TO WS-DY-WORK
 13415         IF WS-DY-SIGN = SPACES
 13416            MOVE WS-DY-NUM       TO WS-EDAYS
 13417            ADD 0                TO WS-EDAYS
 13418         ELSE
 13419            MOVE EDAYSI          TO WS-EDAYS
 13420            ADD 0                TO WS-EDAYS.
 13421
 13422*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13423*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13424     IF EPYAMTL > 0
 13425
 13426* EXEC CICS BIF DEEDIT
 13427*            FIELD(EPYAMTI)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 256
* EL156.cbl
 13428*            LENGTH(10)
 13429*        END-EXEC
 13430     MOVE 10
 13431       TO DFHEIV11
 13432*    MOVE '@"L                   #   #00012703' TO DFHEIV0
 13433     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13434     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13435     MOVE X'2020233030303132373033' TO DFHEIV0(25:11)
 13436     CALL 'kxdfhei1' USING DFHEIV0,
 13437           EPYAMTI,
 13438           DFHEIV11
 13439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13440         MOVE EPYAMTI            TO WS-PY-WORK
 13441         IF WS-PY-SIGN = SPACES
 13442            MOVE WS-PY-NUM       TO WS-EPYAMT
 13443            ADD 0                TO WS-EPYAMT
 13444         ELSE
 13445            MOVE EPYAMTI         TO WS-EPYAMT
 13446            ADD 0                TO WS-EPYAMT.
 13447
 13448     IF ERESVL > 0
 13449
 13450* EXEC CICS BIF DEEDIT
 13451*            FIELD(ERESVI)
 13452*            LENGTH(9)
 13453*        END-EXEC
 13454     MOVE 9
 13455       TO DFHEIV11
 13456*    MOVE '@"L                   #   #00012716' TO DFHEIV0
 13457     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13458     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13459     MOVE X'2020233030303132373136' TO DFHEIV0(25:11)
 13460     CALL 'kxdfhei1' USING DFHEIV0,
 13461           ERESVI,
 13462           DFHEIV11
 13463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13464         MOVE ERESVI TO WS-ERESV.
 13465
 13466     IF EEXPENSL > 0
 13467
 13468* EXEC CICS BIF DEEDIT
 13469*            FIELD(EEXPENSI)
 13470*            LENGTH(8)
 13471*        END-EXEC
 13472     MOVE 8
 13473       TO DFHEIV11
 13474*    MOVE '@"L                   #   #00012723' TO DFHEIV0
 13475     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13476     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13477     MOVE X'2020233030303132373233' TO DFHEIV0(25:11)
 13478     CALL 'kxdfhei1' USING DFHEIV0,
 13479           EEXPENSI,
 13480           DFHEIV11
 13481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13482         MOVE EEXPENSI           TO WS-EEXPENS.
 13483
 13484     IF ETYPEL > ZEROS
 13485         MOVE ETYPEI             TO WS-ETYPE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 257
* EL156.cbl
 13486
 13487     IF PI-COMPANY-ID = 'BOA'
 13488        IF PINTL > ZEROS
 13489
 13490* EXEC CICS BIF DEEDIT
 13491*            FIELD (PINTI)
 13492*            LENGTH(05)
 13493*          END-EXEC
 13494     MOVE 05
 13495       TO DFHEIV11
 13496*    MOVE '@"L                   #   #00012734' TO DFHEIV0
 13497     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13498     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13499     MOVE X'2020233030303132373334' TO DFHEIV0(25:11)
 13500     CALL 'kxdfhei1' USING DFHEIV0,
 13501           PINTI,
 13502           DFHEIV11
 13503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13504           IF PINTI NUMERIC
 13505               MOVE AL-UNNON     TO PINTA
 13506               MOVE PINTI        TO WS-INT-RATE
 13507               MOVE WS-INT-RATE  TO PINTO.
 13508
 13509 3000-EXIT.
 13510     EXIT.
 13511
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 258
* EL156.cbl
 13513 3050-REBUILD-ENTERED.
 13514
 13515     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13516
 13517     IF PI-PROV-PMT
 13518         MOVE '9'           TO PMTTYPEO
 13519     ELSE
 13520         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13521
 13522     MOVE PI-PAYEE          TO PAYEEO.
 13523     MOVE PI-PMTNOTE1       TO NOTE1O.
 13524     MOVE PI-PMTNOTE2       TO NOTE2O.
 13525     MOVE PI-OFFLINE        TO OFFLINEO.
 13526     IF PI-PROOF-DATE NOT = ZEROS
 13527         MOVE PI-PROOF-DATE TO PROOFDTO
 13528         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13529     END-IF.
 13530*    MOVE PI-GROUPED        TO GROUPEDO.
 13531
 13532*    MOVE PI-CASH           TO CASHO.
 13533
 13534     IF PI-INT-RATE > ZEROS
 13535         MOVE PI-INT-RATE   TO PINTO.
 13536
 13537     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13538        IF PI-INT-AMT > ZEROS
 13539           MOVE PI-INT-AMT       TO PINTO
 13540           MOVE AL-PANOF         TO PINTA
 13541                                    PINTHA
 13542        END-IF
 13543     END-IF
 13544     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13545     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13546     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13547     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13548     IF PI-HOLDTIL NOT = ZEROS
 13549        MOVE PI-HOLDTIL          TO HOLDTILO
 13550        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13551
 13552     IF PI-EPYFROM NOT = ZEROS
 13553        MOVE PI-EPYFROM          TO EPYFROMO
 13554        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13555
 13556     IF PI-AIGFROM NOT = ZEROS
 13557        MOVE PI-AIGFROM          TO AIGFROMO
 13558        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13559
 13560     IF PI-EPYTHRU NOT = ZEROS
 13561        MOVE PI-EPYTHRU          TO EPYTHRUO
 13562        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13563        IF PI-USES-PAID-TO
 13564           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13565           MOVE '4'                TO DC-OPTION-CODE
 13566           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13567           IF NO-CONVERSION-ERROR
 13568              MOVE +1 TO DC-ELAPSED-DAYS
 13569              MOVE +0 TO DC-ELAPSED-MONTHS
 13570              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 259
* EL156.cbl
 13571              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13572              IF NO-CONVERSION-ERROR
 13573                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13574
 13575     IF PI-EDAYS NOT = ZEROS
 13576        MOVE PI-EDAYS TO EDAYSO.
 13577
 13578     IF PI-EPYAMT NOT = ZEROS
 13579        MOVE PI-EPYAMT TO EPYAMTO.
 13580
 13581     IF PI-ERESV NOT = ZEROS
 13582        MOVE PI-ERESV TO ERESVO.
 13583
 13584     IF PI-EEXPENS NOT = ZEROS
 13585        MOVE PI-EEXPENS TO EEXPENSO.
 13586
 13587     MOVE PI-ETYPE TO ETYPEO.
 13588
 13589     IF PI-ECHECKNO NOT = SPACES
 13590        MOVE PI-ECHECKNO         TO CHECKNOO
 13591     ELSE
 13592        MOVE PI-CCHECKNO         TO CHECKNOO.
 13593
 13594     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13595     MOVE SPACES                 TO DC-OPTION-CODE.
 13596     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13597
 13598     IF DATE-CONVERSION-ERROR
 13599        MOVE SPACES              TO CPYFROMI
 13600     ELSE
 13601        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13602
 13603     IF PI-USES-PAID-TO
 13604        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13605        MOVE +1                  TO DC-ELAPSED-DAYS
 13606        MOVE +0                  TO DC-ELAPSED-MONTHS
 13607        MOVE '6'                 TO DC-OPTION-CODE
 13608        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13609        IF NO-CONVERSION-ERROR
 13610           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13611           GO TO 3051-CONTINUE.
 13612
 13613     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13614     MOVE SPACES                 TO DC-OPTION-CODE.
 13615     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13616
 13617     IF DATE-CONVERSION-ERROR
 13618        MOVE SPACES              TO CPYTHRUI
 13619     ELSE
 13620        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13621
 13622 3051-CONTINUE.
 13623
 13624     IF PI-CDAYS NOT = ZEROS
 13625        MOVE PI-CDAYS TO CDAYSO.
 13626
 13627     IF PI-CPYAMT NOT = ZEROS
 13628        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 260
* EL156.cbl
 13629
 13630     IF PI-CRESV NOT = ZEROS
 13631        MOVE PI-CRESV TO CRESVO.
 13632
 13633     IF PI-CEXPENS NOT = ZEROS
 13634        MOVE PI-CEXPENS TO CEXPENSO.
 13635
 13636 3059-EXIT.
 13637     EXIT.
 13638
 13639 3100-DEEDIT-DATE.
 13640
 13641* EXEC CICS BIF DEEDIT
 13642*        FIELD(DATE-WORK)
 13643*        LENGTH(8)
 13644*    END-EXEC.
 13645     MOVE 8
 13646       TO DFHEIV11
 13647*    MOVE '@"L                   #   #00012874' TO DFHEIV0
 13648     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13649     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13650     MOVE X'2020233030303132383734' TO DFHEIV0(25:11)
 13651     CALL 'kxdfhei1' USING DFHEIV0,
 13652           DATE-WORK,
 13653           DFHEIV11
 13654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13655
 13656
 13657 3100-EXIT.
 13658     EXIT.
 13659
 13660 3200-CALC-AIG-DAYS.
 13661
 13662     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13663
 13664     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13665     MOVE ' '                    TO DC-OPTION-CODE.
 13666     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13667     IF NO-CONVERSION-ERROR
 13668         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13669     ELSE
 13670         GO TO 3290-ERROR.
 13671
 13672     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13673         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13674                                WS-BIN-FROM-DT
 13675     ELSE
 13676         IF CL-TOTAL-PAID-AMT > ZEROS
 13677             IF WS-SV-EPYFROM = LOW-VALUES
 13678                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13679                                        WS-BIN-FROM-DT
 13680             ELSE
 13681                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13682                                        WS-BIN-FROM-DT
 13683         ELSE
 13684             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13685                                        WS-BIN-FROM-DT.
 13686
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 261
* EL156.cbl
 13687 3210-CONTINUE.
 13688
 13689     MOVE ' '                    TO DC-OPTION-CODE.
 13690     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13691     IF DATE-CONVERSION-ERROR
 13692         GO TO 3290-ERROR.
 13693
 13694     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13695
 13696     IF PI-LOAN-DUE-DAY = 31
 13697         MOVE 30              TO WS-PMT-DUE-DA
 13698                                 WS-SAVE-DUE-DA
 13699     ELSE
 13700         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13701                                 WS-SAVE-DUE-DA.
 13702
 13703     IF (PI-LOAN-DUE-DAY > 28) AND
 13704        (WS-PMT-DUE-MO = 2)
 13705         MOVE 'Y'                TO WS-DUE-DAY-SW
 13706         MOVE 28                 TO WS-PMT-DUE-DA.
 13707
 13708     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13709     MOVE '4'                    TO DC-OPTION-CODE.
 13710     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13711     IF NO-CONVERSION-ERROR
 13712         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13713     ELSE
 13714         GO TO 3290-ERROR.
 13715
 13716*--------------------------------------------------------------*
 13717*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13718*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13719*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13720*                                                              *
 13721*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13722*             INCURRED DATE      - 04/15/91                    *
 13723*             PMT DUE DATE       - 04/03/91                    *
 13724*             PMT DUE DATE       - 05/03/91                    *
 13725*--------------------------------------------------------------*
 13726
 13727     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13728        (WS-SV-AIGFROM = LOW-VALUES)
 13729         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13730            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13731             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13732             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13733             IF NO-CONVERSION-ERROR
 13734                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13735                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13736             ELSE
 13737                 GO TO 3290-ERROR.
 13738
 13739     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13740        (WS-SV-AIGFROM = LOW-VALUES)
 13741         GO TO 3205-CONT-CALC-PMT.
 13742
 13743     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13744     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 262
* EL156.cbl
 13745     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13746     IF NO-CONVERSION-ERROR
 13747         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13748     ELSE
 13749         GO TO 3290-ERROR.
 13750
 13751     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13752        (WS-PMT-DUE-DA < WS-FROM-DA)
 13753          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13754          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13755          IF NO-CONVERSION-ERROR
 13756              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13757              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13758          ELSE
 13759              GO TO 3290-ERROR.
 13760
 13761 3205-CONT-CALC-PMT.
 13762
 13763*--------------------------------------------------------------*
 13764*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13765*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13766*--------------------------------------------------------------*
 13767
 13768     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13769        PI-PMTTYPE = '2'
 13770          NEXT SENTENCE
 13771     ELSE
 13772        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13773           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13774             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13775             MOVE ER-3527            TO EMI-ERROR
 13776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13777             MOVE -1                 TO EPYTHRUL
 13778             MOVE AL-UNBON           TO EPYTHRUA
 13779                                        EPYFROMA
 13780             GO TO 3299-EXIT.
 13781
 13782*--------------------------------------------------------------*
 13783*    CALCULATE RETRO ELIMINATION DATE                          *
 13784*--------------------------------------------------------------*
 13785
 13786     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13787         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13788     ELSE
 13789         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13790
 13791     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13792     MOVE +0             TO DC-ELAPSED-MONTHS.
 13793     MOVE '6'            TO DC-OPTION-CODE.
 13794     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13795     IF NO-CONVERSION-ERROR
 13796         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13797     ELSE
 13798         GO TO 3290-ERROR.
 13799
 13800 3210-CHECK-PMT-DATE.
 13801
 13802*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 263
* EL156.cbl
 13803*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13804*    THE ENTERED PAY FROM DATE                                 *
 13805*--------------------------------------------------------------*
 13806
 13807     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13808         NEXT SENTENCE
 13809     ELSE
 13810         GO TO 3220-COMPUTE-DAYS.
 13811
 13812     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13813     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13814     IF NO-CONVERSION-ERROR
 13815         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13816         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13817         GO TO 3210-CHECK-PMT-DATE
 13818     ELSE
 13819         GO TO 3290-ERROR.
 13820
 13821 3220-COMPUTE-DAYS.
 13822
 13823     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13824     MOVE ZEROS         TO WS-CDAYS.
 13825     MOVE 'N'           TO WS-ELIMINATION-SW.
 13826
 13827*--------------------------------------------------------------*
 13828*    COMPUTE CALIFORNIA DUE DAYS                               *
 13829*--------------------------------------------------------------*
 13830
 13831     IF CL-TOTAL-PAID-AMT > ZEROS
 13832         MOVE 'Y' TO WS-ELIMINATION-SW
 13833         GO TO 3240-FIRST-PMT-DUE
 13834     ELSE
 13835        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13836            NEXT SENTENCE
 13837        ELSE
 13838            GO TO 3240-FIRST-PMT-DUE.
 13839
 13840 3230-NEXT-PMT-DUE.
 13841
 13842     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13843     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13844     IF NO-CONVERSION-ERROR
 13845         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13846         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13847     ELSE
 13848         GO TO 3290-ERROR.
 13849
 13850 3240-FIRST-PMT-DUE.
 13851
 13852     IF CL-TOTAL-PAID-AMT > ZEROS
 13853         NEXT SENTENCE
 13854     ELSE
 13855        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 13856            GO TO 3230-NEXT-PMT-DUE.
 13857
 13858     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 13859         GO TO 3250-VERIFY-ELIMINATION.
 13860
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 264
* EL156.cbl
 13861     ADD +30 TO WS-CDAYS.
 13862     MOVE 'Y' TO WS-ELIMINATION-SW.
 13863     GO TO 3230-NEXT-PMT-DUE.
 13864
 13865 3250-VERIFY-ELIMINATION.
 13866
 13867     IF ELIM-SATISFIED
 13868         GO TO 3260-END-CALC.
 13869
 13870     IF PI-PMTTYPE = '1'
 13871         MOVE ZEROS TO WS-CDAYS
 13872         GO TO 3260-END-CALC.
 13873
 13874     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13875         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13876     ELSE
 13877         IF CL-TOTAL-PAID-AMT > ZEROS
 13878             IF WS-SV-EPYFROM = LOW-VALUES
 13879                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13880             ELSE
 13881                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13882         ELSE
 13883             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 13884
 13885     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 13886     MOVE '1'                    TO DC-OPTION-CODE.
 13887     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13888     IF NO-CONVERSION-ERROR
 13889         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 13890     ELSE
 13891         GO TO 3290-ERROR.
 13892
 13893     IF CL-TOTAL-PAID-AMT > ZEROS
 13894         MOVE WS-DAYS-OFF TO WS-CDAYS
 13895     ELSE
 13896         IF PI-BEN-DAYS > WS-DAYS-OFF
 13897             MOVE ZEROS TO WS-CDAYS
 13898         ELSE
 13899             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 13900
 13901 3260-END-CALC.
 13902
 13903     MOVE WS-CDAYS TO PI-CDAYS.
 13904
 13905     IF PI-EDAYS = ZEROS
 13906         MOVE PI-CDAYS TO PI-EDAYS
 13907         MOVE AL-UNNON TO EDAYSA.
 13908
 13909     GO TO 3299-EXIT.
 13910
 13911 3290-ERROR.
 13912
 13913     MOVE ER-3528            TO EMI-ERROR.
 13914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13915     MOVE -1                 TO CDAYSL.
 13916     MOVE AL-UNBON           TO CDAYSA.
 13917
 13918 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 265
* EL156.cbl
 13919     EXIT.
 13920
 13921 3300-BUMP-DATE.
 13922
 13923     IF WS-RESTORE-DUE-DAY
 13924         MOVE 'N'              TO WS-DUE-DAY-SW
 13925         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 13926         ADD 1                 TO WS-PMT-DUE-MO
 13927         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 13928         MOVE '4'              TO DC-OPTION-CODE
 13929         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13930         IF NO-CONVERSION-ERROR
 13931             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13932             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 13933             GO TO 3399-EXIT
 13934         ELSE
 13935             MOVE '9'          TO DC-ERROR-CODE
 13936             GO TO 3399-EXIT.
 13937
 13938     IF (WS-PMT-DUE-MO = 1) AND
 13939        (WS-SAVE-DUE-DA > 28)
 13940           MOVE 'Y' TO WS-DUE-DAY-SW.
 13941
 13942     MOVE +0                 TO DC-ELAPSED-DAYS.
 13943     MOVE +1                 TO DC-ELAPSED-MONTHS.
 13944     MOVE '6'                TO DC-OPTION-CODE.
 13945     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13946
 13947 3399-EXIT.
 13948     EXIT.
 13949
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 266
* EL156.cbl
 13951 3400-COMPUTE-EXPIRY.
 13952
 13953     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 13954     MOVE +0                    TO DC-ELAPSED-DAYS
 13955                                   DC-ODD-DAYS-OVER.
 13956     MOVE '1'                   TO DC-END-OF-MONTH.
 13957     MOVE '6'                   TO DC-OPTION-CODE.
 13958
 13959     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 13960         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 13961     ELSE
 13962         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 13963
 13964     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13965     IF NO-CONVERSION-ERROR
 13966         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 13967     ELSE
 13968         GO TO 3390-CONTINUE.
 13969
 13970     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 13971         GO TO 3390-CONTINUE.
 13972
 13973     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13974     MOVE '4'                    TO CNTL-REC-TYPE.
 13975     MOVE +0                     TO CNTL-SEQ-NO.
 13976     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 13977     MOVE WS-ACCESS              TO CNTL-ACCESS.
 13978     MOVE 'BENE'                 TO FILE-SWITCH.
 13979
 13980     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 13981
 13982     IF NO-BENEFIT-FOUND
 13983         GO TO 3390-CONTINUE.
 13984
 13985     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 13986        IF (PI-OFFLINE = 'Y') OR
 13987           (PI-PMTTYPE = '7')
 13988           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 13989                                     THRU 9870-EXIT
 13990           IF ERROR-ON-OUTPUT
 13991             MOVE -1                 TO ENTERPFL
 13992             MOVE AL-UANON           TO ENTERPFA
 13993             MOVE MAP-NAMEA          TO MAP-NAME
 13994             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13995             GO TO 8200-SEND-DATAONLY.
 13996
 13997     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 13998        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 13999        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14000          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14001          MOVE +0        TO DC-ELAPSED-DAYS
 14002          MOVE +1        TO DC-ELAPSED-MONTHS
 14003          MOVE 6         TO DC-OPTION-CODE
 14004          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14005          IF NO-CONVERSION-ERROR
 14006              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14007
 14008 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 267
* EL156.cbl
 14009
 14010      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14011         MOVE CM-AH-LOAN-EXPIRE-DT
 14012                                 TO DC-BIN-DATE-1
 14013      ELSE
 14014         MOVE CM-LF-LOAN-EXPIRE-DT
 14015                                 TO DC-BIN-DATE-1
 14016      END-IF
 14017
 14018      MOVE ' '                    TO DC-OPTION-CODE.
 14019      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14020      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14021      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14022
 14023 3499-EXIT.
 14024     EXIT.
 14025
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 268
* EL156.cbl
 14027
 14028 3600-CHECK-VERIFICATION.
 14029
 14030     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14031
 14032     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14033
 14034     IF PI-PAYEE-TYPE = 'I'
 14035        GO TO 3600-READ-TRAILER.
 14036
 14037     IF PI-PAYEE-TYPE = 'B'
 14038        ADD +10                  TO TRLR-SEQ-NO
 14039        GO TO 3600-READ-TRAILER.
 14040
 14041     IF PI-PAYEE-TYPE = 'A'
 14042        ADD +20                  TO TRLR-SEQ-NO
 14043        GO TO 3600-READ-TRAILER.
 14044
 14045     IF PI-PAYEE-TYPE = 'O'
 14046        ADD +50                  TO TRLR-SEQ-NO
 14047        GO TO 3600-READ-TRAILER.
 14048
 14049     IF PI-PAYEE-TYPE = 'Q'
 14050        ADD +60                  TO TRLR-SEQ-NO
 14051        GO TO 3600-READ-TRAILER.
 14052
 14053     IF PI-PAYEE-TYPE = 'P'
 14054        ADD +30                  TO TRLR-SEQ-NO
 14055        GO TO 3600-READ-TRAILER.
 14056
 14057     IF PI-PAYEE-TYPE = 'E'
 14058        ADD +40                  TO TRLR-SEQ-NO.
 14059
 14060 3600-READ-TRAILER.
 14061
 14062
 14063* EXEC CICS HANDLE CONDITION
 14064*         NOTFND(3600-CONTINUE)
 14065*    END-EXEC.
 14066*    MOVE '"$I                   ! - #00013284' TO DFHEIV0
 14067     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14068     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14069     MOVE X'2D20233030303133323834' TO DFHEIV0(25:11)
 14070     CALL 'kxdfhei1' USING DFHEIV0
 14071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14072
 14073
 14074     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14075
 14076 3600-CONTINUE.
 14077
 14078     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14079         GO TO 3600-AH-VERIFY
 14080     END-IF.
 14081
 14082     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14083       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14084         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 269
* EL156.cbl
 14085           MOVE ER-7576            TO EMI-ERROR
 14086           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14087           MOVE -1                 TO PAYEEL
 14088           MOVE AL-UABON           TO PAYEEA
 14089           GO TO 3600-EXIT
 14090         END-IF
 14091       END-IF
 14092     END-IF.
 14093
 14094     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14095     MOVE 1 TO WS-SUB2
 14096     MOVE SPACES TO WS-PAYEE-NAME
 14097     PERFORM VARYING WS-SUB FROM 1 BY 1
 14098             UNTIL WS-SUB > 30
 14099         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14100            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14101                 WS-PAYEE-NAME-X (WS-SUB2)
 14102            ADD +1 TO WS-SUB2
 14103         END-IF
 14104     END-PERFORM.
 14105
 14106     STRING CL-INSURED-1ST-NAME
 14107            CL-INSURED-MID-INIT
 14108            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14109     MOVE 1 TO WS-SUB2
 14110     MOVE SPACES TO WS-INSURED-NAME
 14111     PERFORM VARYING WS-SUB FROM 1 BY 1
 14112             UNTIL WS-SUB > 30
 14113         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14114            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14115                 WS-INSURED-NAME-X (WS-SUB2)
 14116            ADD +1 TO WS-SUB2
 14117         END-IF
 14118     END-PERFORM.
 14119
 14120     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14121        MOVE ER-7579            TO EMI-ERROR
 14122        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14123        MOVE -1                 TO PAYEEL
 14124        MOVE AL-UABON           TO PAYEEA
 14125     END-IF.
 14126
 14127     IF PI-PMTTYPE = '4'  AND
 14128        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14129        PI-PAYEE-TYPE <> 'I'
 14130          MOVE ER-7580          TO EMI-ERROR
 14131          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14132          MOVE -1               TO PAYEEL
 14133          MOVE AL-UABON         TO PAYEEA
 14134     END-IF.
 14135
 14136     GO TO 3600-EXIT.
 14137
 14138 3600-AH-VERIFY.
 14139
 14140     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14141        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14142           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 270
* EL156.cbl
 14143           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14144           MOVE -1                 TO PAYEEL
 14145           MOVE AL-UABON           TO PAYEEA
 14146        END-IF
 14147     END-IF.
 14148
 14149
 14150 3600-EXIT.
 14151     EXIT.
 14152
 14153 5000-UPDATE.
 14154
 14155     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14156
 14157     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14158
 14159     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14160        PI-OFFLINE = 'Y'
 14161        NEXT SENTENCE
 14162     ELSE
 14163        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14164
 14165*    IF PI-COMPANY-ID = 'CRI'
 14166*       IF PI-PMTTYPE = '1' OR  '2'
 14167*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14168*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14169*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14170
 14171*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14172*       IF PI-PMTTYPE = '1'
 14173*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14174*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14175
 14176     IF PI-PMTTYPE      = '2' AND
 14177        PI-SPLIT-PMT-SW = 'Y' AND
 14178        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14179          MOVE ER-3530                TO EMI-ERROR
 14180          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14181
 14182     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14183        AND (CL-CLAIM-TYPE = 'L')
 14184        IF PI-PMTTYPE = '2' OR '4'
 14185           IF PI-INT-AMT NOT = ZEROS
 14186              PERFORM 7110-BUILD-PMT-TRLR
 14187                                 THRU 7130-EXIT
 14188           ELSE
 14189              IF PI-PMTTYPE = '2'
 14190                 PERFORM 7140-BUILD-NOTE-TRLR
 14191                                 THRU 7170-EXIT
 14192              END-IF
 14193           END-IF
 14194        END-IF
 14195     END-IF
 14196*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14197*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14198*            MOVE 'N'                 TO  WS-LETTER-SW.
 14199
 14200*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 271
* EL156.cbl
 14201*        IF CL-NO-OF-PMTS-MADE = +1
 14202*                OR
 14203*           PI-PMTTYPE = '2'
 14204*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14205
 14206     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14207
 14208*    IF PI-COMPANY-ID = 'DMD'
 14209*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14210*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14211
 14212
 14213* EXEC CICS REWRITE
 14214*         DATASET('ELMSTR')
 14215*         FROM(CLAIM-MASTER)
 14216*     END-EXEC.
 14217     MOVE LENGTH OF
 14218      CLAIM-MASTER
 14219       TO DFHEIV11
 14220     MOVE 'ELMSTR' TO DFHEIV1
 14221*    MOVE '&& L                  %   #00013426' TO DFHEIV0
 14222     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14223     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14224     MOVE X'2020233030303133343236' TO DFHEIV0(25:11)
 14225     CALL 'kxdfhei1' USING DFHEIV0,
 14226           DFHEIV1,
 14227           CLAIM-MASTER,
 14228           DFHEIV11,
 14229           DFHEIV99
 14230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14231
 14232
 14233     IF WS-LETTER-SW = 'N'
 14234         GO TO 5000-END-UPDATE.
 14235
 14236 5000-GENERATE-AUTO-LETTER.
 14237
 14238
 14239* EXEC CICS LINK
 14240*        PROGRAM    (LINK-1523)
 14241*        COMMAREA   (W-1523-LINKDATA)
 14242*        LENGTH     (W-1523-COMM-LENGTH)
 14243*    END-EXEC.
 14244*    MOVE '."C                   (   #00013436' TO DFHEIV0
 14245     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14246     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14247     MOVE X'2020233030303133343336' TO DFHEIV0(25:11)
 14248     CALL 'kxdfhei1' USING DFHEIV0,
 14249           LINK-1523,
 14250           W-1523-LINKDATA,
 14251           W-1523-COMM-LENGTH,
 14252           DFHEIV99,
 14253           DFHEIV99,
 14254           DFHEIV99,
 14255           DFHEIV99
 14256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14257
 14258
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 272
* EL156.cbl
 14259     IF W-1523-FATAL-ERROR
 14260         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14261         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14262         MOVE ER-0802                TO  EMI-ERROR
 14263         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14264
 14265     IF W-1523-ERROR-CODE = 0191
 14266         MOVE ER-0803                TO  EMI-ERROR
 14267         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14268
 14269     IF PI-COMPANY-ID      = 'HAN' AND
 14270        PI-PMTTYPE         = '1'   AND
 14271        PI-3RD-PARTY-SW    = 'Y'   AND
 14272        W-1523-FORM-NUMBER = 'EOB1'
 14273           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14274           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14275           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14276           GO TO 5000-GENERATE-AUTO-LETTER.
 14277
 14278 5000-END-UPDATE.
 14279
 14280     MOVE ER-0000                TO EMI-ERROR.
 14281     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14282     GO TO 7000-SHOW-CLAIM.
 14283
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 273
* EL156.cbl
 14285 5000-MOVE-NAME.
 14286     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14287     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14288     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14289
 14290 5000-EXIT.
 14291     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 274
* EL156.cbl
 14293 5300-CREATE-DMO.
 14294
 14295     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14296     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14297     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14298
 14299
 14300* EXEC CICS HANDLE CONDITION
 14301*         NOTFND   (5300-NOTE-NOT-FOUND)
 14302*    END-EXEC.
 14303*    MOVE '"$I                   ! . #00013482' TO DFHEIV0
 14304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14306     MOVE X'2E20233030303133343832' TO DFHEIV0(25:11)
 14307     CALL 'kxdfhei1' USING DFHEIV0
 14308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14309
 14310
 14311
 14312* EXEC CICS READ
 14313*         DATASET('ERNOTE')
 14314*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14315*         RIDFLD (W-NOTE-KEY)
 14316*    END-EXEC.
 14317     MOVE 'ERNOTE' TO DFHEIV1
 14318*    MOVE '&"S        E          (   #00013486' TO DFHEIV0
 14319     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14320     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14321     MOVE X'2020233030303133343836' TO DFHEIV0(25:11)
 14322     CALL 'kxdfhei1' USING DFHEIV0,
 14323           DFHEIV1,
 14324           DFHEIV20,
 14325           DFHEIV99,
 14326           W-NOTE-KEY,
 14327           DFHEIV99,
 14328           DFHEIV99,
 14329           DFHEIV99
 14330     SET ADDRESS OF CERTIFICATE-NOTE TO
 14331         DFHEIV20
 14332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14333
 14334
 14335     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14336     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14337     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14338
 14339     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14340         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14341     ELSE
 14342         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14343
 14344     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14345     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14346     MOVE 'DLO006'               TO PGM-NAME.
 14347
 14348
 14349* EXEC CICS LINK
 14350*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 275
* EL156.cbl
 14351*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14352*        LENGTH     (DCT-RCRD-LENGTH)
 14353*    END-EXEC.
 14354*    MOVE '."C                   (   #00013505' TO DFHEIV0
 14355     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14357     MOVE X'2020233030303133353035' TO DFHEIV0(25:11)
 14358     CALL 'kxdfhei1' USING DFHEIV0,
 14359           PGM-NAME,
 14360           DCT-COMMUNICATION-AREA,
 14361           DCT-RCRD-LENGTH,
 14362           DFHEIV99,
 14363           DFHEIV99,
 14364           DFHEIV99,
 14365           DFHEIV99
 14366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14367
 14368
 14369     IF DCT-RETURN-CODE = 'OK'
 14370         GO TO 5300-CONT.
 14371
 14372     IF DCT-RETURN-CODE = '01' OR '02'
 14373         GO TO 5300-EXIT.
 14374
 14375     IF DCT-RETURN-CODE = '03'
 14376         MOVE ER-0951            TO EMI-ERROR
 14377         GO TO 5300-BAD-EXIT.
 14378
 14379     IF DCT-RETURN-CODE = '04'
 14380         MOVE ER-0946            TO EMI-ERROR
 14381         GO TO 5300-BAD-EXIT.
 14382
 14383     IF DCT-RETURN-CODE = '05'
 14384         MOVE ER-0947            TO EMI-ERROR
 14385         GO TO 5300-BAD-EXIT.
 14386
 14387     IF DCT-RETURN-CODE = '06'
 14388         MOVE ER-0921            TO EMI-ERROR
 14389         GO TO 5300-BAD-EXIT.
 14390
 14391     IF DCT-RETURN-CODE = '07'
 14392         MOVE ER-0849            TO EMI-ERROR
 14393         GO TO 5300-BAD-EXIT.
 14394
 14395     IF DCT-RETURN-CODE = '08'
 14396         MOVE ER-0948            TO EMI-ERROR
 14397         GO TO 5300-BAD-EXIT.
 14398
 14399     IF DCT-RETURN-CODE = 'N1'
 14400         MOVE ER-0950            TO EMI-ERROR
 14401         GO TO 5300-BAD-EXIT.
 14402
 14403     IF DCT-RETURN-CODE = 'E1'
 14404         MOVE ER-0974            TO EMI-ERROR
 14405         GO TO 5300-BAD-EXIT.
 14406
 14407     IF DCT-RETURN-CODE = 'E2'
 14408         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 276
* EL156.cbl
 14409         GO TO 5300-BAD-EXIT.
 14410
 14411     IF DCT-RETURN-CODE NOT = 'OK'
 14412         MOVE ER-0949            TO EMI-ERROR
 14413         GO TO 5300-BAD-EXIT.
 14414
 14415 5300-CONT.
 14416
 14417     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14418     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14419     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14420     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14421     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14422     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14423     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14424     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14425
 14426     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14427     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14428     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14429     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14430     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14431
 14432     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14433
 14434     IF PI-PMTTYPE = '2'
 14435         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14436         MOVE '4'                TO DM-CLAIM-STATUS
 14437     ELSE
 14438         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14439         MOVE '2'                TO DM-CLAIM-STATUS.
 14440
 14441     MOVE 'DLO025'               TO PGM-NAME.
 14442
 14443
 14444* EXEC CICS LINK
 14445*        PROGRAM    (PGM-NAME)
 14446*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14447*        LENGTH     (DM-DMO-LENGTH)
 14448*    END-EXEC.
 14449*    MOVE '."C                   (   #00013585' TO DFHEIV0
 14450     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14452     MOVE X'2020233030303133353835' TO DFHEIV0(25:11)
 14453     CALL 'kxdfhei1' USING DFHEIV0,
 14454           PGM-NAME,
 14455           DMO-COMMUNICATION-AREA,
 14456           DM-DMO-LENGTH,
 14457           DFHEIV99,
 14458           DFHEIV99,
 14459           DFHEIV99,
 14460           DFHEIV99
 14461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14462
 14463
 14464     IF DM-RETURN-CODE = 'OK'
 14465         GO TO 5300-EXIT.
 14466
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 277
* EL156.cbl
 14467     IF DM-RETURN-CODE = '01'
 14468         MOVE ER-8051            TO EMI-ERROR
 14469         GO TO 5300-BAD-EXIT.
 14470
 14471     IF DM-RETURN-CODE = '02'
 14472         MOVE ER-8052            TO EMI-ERROR
 14473         GO TO 5300-BAD-EXIT.
 14474
 14475     IF DM-RETURN-CODE = '03'
 14476         MOVE ER-8053            TO EMI-ERROR
 14477         GO TO 5300-BAD-EXIT.
 14478
 14479     IF DM-RETURN-CODE = '04'
 14480         MOVE ER-8054            TO EMI-ERROR
 14481         GO TO 5300-BAD-EXIT.
 14482
 14483     IF DM-RETURN-CODE = '05'
 14484         MOVE ER-8055            TO EMI-ERROR
 14485         GO TO 5300-BAD-EXIT.
 14486
 14487     IF DM-RETURN-CODE = '06'
 14488         MOVE ER-8056            TO EMI-ERROR
 14489         GO TO 5300-BAD-EXIT.
 14490
 14491     IF DM-RETURN-CODE = '07'
 14492         MOVE ER-8057            TO EMI-ERROR
 14493         GO TO 5300-BAD-EXIT.
 14494
 14495     IF DM-RETURN-CODE = '08'
 14496         MOVE ER-8058            TO EMI-ERROR
 14497         GO TO 5300-BAD-EXIT.
 14498
 14499     IF DM-RETURN-CODE = '09'
 14500         MOVE ER-8059            TO EMI-ERROR
 14501         GO TO 5300-BAD-EXIT.
 14502
 14503     IF DM-RETURN-CODE = '10'
 14504         MOVE ER-8060            TO EMI-ERROR
 14505         GO TO 5300-BAD-EXIT.
 14506
 14507     IF DM-RETURN-CODE = '11'
 14508         MOVE ER-8061            TO EMI-ERROR
 14509         GO TO 5300-BAD-EXIT.
 14510
 14511     IF DM-RETURN-CODE = '12'
 14512         MOVE ER-8062            TO EMI-ERROR
 14513         GO TO 5300-BAD-EXIT.
 14514
 14515     IF DM-RETURN-CODE = '13'
 14516         MOVE ER-8063            TO EMI-ERROR
 14517         GO TO 5300-BAD-EXIT.
 14518
 14519     IF DM-RETURN-CODE = '14'
 14520         MOVE ER-8064            TO EMI-ERROR
 14521         GO TO 5300-BAD-EXIT.
 14522
 14523     IF DM-RETURN-CODE = '15'
 14524         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 278
* EL156.cbl
 14525         GO TO 5300-BAD-EXIT.
 14526
 14527     IF DM-RETURN-CODE = '16'
 14528         MOVE ER-8154            TO EMI-ERROR
 14529         GO TO 5300-BAD-EXIT.
 14530
 14531     IF DM-RETURN-CODE = '17'
 14532         MOVE ER-8155            TO EMI-ERROR
 14533         GO TO 5300-BAD-EXIT.
 14534
 14535     IF DM-RETURN-CODE = 'N1'
 14536         MOVE ER-8152            TO EMI-ERROR
 14537         GO TO 5300-BAD-EXIT.
 14538
 14539     IF DM-RETURN-CODE = 'E1'
 14540         MOVE ER-8153            TO EMI-ERROR
 14541         GO TO 5300-BAD-EXIT.
 14542
 14543     MOVE ER-8066            TO EMI-ERROR.
 14544     GO TO 5300-BAD-EXIT.
 14545
 14546 5300-NOTE-NOT-FOUND.
 14547
 14548     MOVE ER-0954                TO EMI-ERROR.
 14549     GO TO 5300-BAD-EXIT.
 14550
 14551 5300-BAD-EXIT.
 14552
 14553* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14554*    MOVE '6"R                   !   #00013679' TO DFHEIV0
 14555     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14557     MOVE X'2020233030303133363739' TO DFHEIV0(25:11)
 14558     CALL 'kxdfhei1' USING DFHEIV0
 14559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14560
 14561     IF MAP-NAME = 'EL156A'
 14562         MOVE -1             TO ENTERPFL
 14563       ELSE
 14564         MOVE LOW-VALUES     TO EL156BI
 14565         MOVE -1             TO ENTPFBL.
 14566
 14567     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14568     GO TO 8200-SEND-DATAONLY.
 14569
 14570 5300-EXIT.
 14571     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 279
* EL156.cbl
 14573 5350-FORMAT-LAST-NAME-1ST.
 14574*****************************************************************
 14575*             M O V E   N A M E   R O U T I N E                 *
 14576*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14577*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14578*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14579*                  FIELD                   VALUE                *
 14580*           W-NAME-LAST    (CL15)      SMITH                    *
 14581*           W-NAME-FIRST   (CL15)      JOHN                     *
 14582*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14583*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14584*     CONTAIN                                                   *
 14585*                SMITH, JOHN ALLEN                              *
 14586*     OR                                                        *
 14587*                SMITH, JOHN A.                                 *
 14588*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14589*     COPYBOOK, ELCNWA.                                         *
 14590*****************************************************************.
 14591
 14592     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14593     MOVE ZERO                   TO  WS-NAME-SW.
 14594     SET NWA-INDEX               TO +1.
 14595
 14596     IF W-NAME-LAST   = SPACES AND
 14597        W-NAME-MIDDLE = SPACES
 14598         MOVE +1                 TO WS-NAME-SW.
 14599
 14600     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14601     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14602
 14603     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14604     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14605
 14606     SET NWA-INDEX UP BY +1.
 14607
 14608     IF W-NAME-MIDDLE NOT = SPACES
 14609         IF W-NAME-MIDDLE-2 = SPACES
 14610             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14611             SET NWA-INDEX UP BY +1
 14612             MOVE '.'            TO WS-NW (NWA-INDEX)
 14613             SET NWA-INDEX UP BY +2
 14614         ELSE
 14615             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14616             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14617
 14618 5350-EXIT.
 14619     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 280
* EL156.cbl
 14621 5360-MOVE-NAME.
 14622
 14623     IF WS-NAME-SW > +1
 14624         GO TO 5360-EXIT.
 14625
 14626     IF WS-NAME-WORK2 = SPACES
 14627         GO TO 5360-EXIT.
 14628
 14629     SET NWA-INDEX2            TO +1.
 14630     SET NWA-INDEX3            TO +2.
 14631
 14632 5360-MOVE-NAME-CYCLE.
 14633
 14634     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14635
 14636     IF NWA-INDEX < +30
 14637         SET NWA-INDEX UP BY +1
 14638     ELSE
 14639         ADD +2                TO  WS-NAME-SW
 14640         GO TO 5360-EXIT.
 14641
 14642     IF NWA-INDEX2 < +20
 14643         SET NWA-INDEX3 UP BY +1
 14644         SET NWA-INDEX2 UP BY +1.
 14645
 14646     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14647        WS-NW2 (NWA-INDEX3) = SPACES
 14648         IF WS-NAME-SW = ZERO
 14649             MOVE ','            TO  WS-NW (NWA-INDEX)
 14650             SET NWA-INDEX UP BY +2
 14651             MOVE +1             TO  WS-NAME-SW
 14652             GO TO 5360-EXIT
 14653         ELSE
 14654             GO TO 5360-EXIT.
 14655
 14656     GO TO 5360-MOVE-NAME-CYCLE.
 14657
 14658 5360-EXIT.
 14659     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 281
* EL156.cbl
 14661 6000-BUILD-SCREEN-B.
 14662     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14663     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14664     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14665     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14666
 14667     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14668
 14669 6050-BUILD-SCREEN.
 14670     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14671     MOVE LOW-VALUES             TO EL156BI.
 14672     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14673
 14674     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14675
 14676     IF PI-PAYEE-TYPE = 'I'
 14677        GO TO 6060-READ-TRAILER.
 14678
 14679     IF PI-PAYEE-TYPE = 'B'
 14680        ADD +10                  TO TRLR-SEQ-NO
 14681        GO TO 6060-READ-TRAILER.
 14682
 14683     IF PI-PAYEE-TYPE = 'A'
 14684        ADD +20                  TO TRLR-SEQ-NO
 14685        GO TO 6060-READ-TRAILER.
 14686
 14687     IF PI-PAYEE-TYPE = 'O'
 14688        ADD +50                  TO TRLR-SEQ-NO
 14689        GO TO 6060-READ-TRAILER.
 14690
 14691     IF PI-PAYEE-TYPE = 'Q'
 14692        ADD +60                  TO TRLR-SEQ-NO
 14693        GO TO 6060-READ-TRAILER.
 14694
 14695     IF PI-PAYEE-TYPE = 'P'
 14696        ADD +30                  TO TRLR-SEQ-NO
 14697        GO TO 6060-READ-TRAILER.
 14698
 14699     IF PI-PAYEE-TYPE = 'E'
 14700        ADD +40                  TO TRLR-SEQ-NO.
 14701
 14702 6060-READ-TRAILER.
 14703
 14704     IF PI-PAYEE-TYPE    = 'A' AND
 14705        PI-PAYEE-SEQ-NUM = 0
 14706          GO TO 6061-READ-ACCOUNT.
 14707
 14708     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14709        (PI-PAYEE-TYPE    = 'B')             AND
 14710        (PI-PAYEE-SEQ-NUM = 9)
 14711          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14712          IF BENE-FOUND-SW = 'N'
 14713            GO TO 6065-NOT-FOUND
 14714          ELSE
 14715            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14716            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14717            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14718*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 282
* EL156.cbl
 14719            STRING BE-CITY ' ' BE-STATE
 14720               DELIMITED BY '  ' INTO CITYSTBO
 14721            END-STRING
 14722            MOVE BE-ZIP-CODE       TO ZIPBO
 14723            GO TO 6061-READ-ACCOUNT.
 14724
 14725     IF PI-PAYEE-TYPE    = 'B' AND
 14726        PI-PAYEE-SEQ-NUM = 0
 14727          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14728          IF BENE-FOUND-SW = 'N'
 14729            GO TO 6065-NOT-FOUND
 14730          ELSE
 14731            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14732            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14733            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14734*           MOVE BE-CITY-STATE     TO CITYSTBO
 14735            STRING BE-CITY ' ' BE-STATE
 14736               DELIMITED BY '  ' INTO CITYSTBO
 14737            END-STRING
 14738            MOVE BE-ZIP-CODE       TO ZIPBO
 14739            GO TO 6061-READ-ACCOUNT.
 14740
 14741
 14742* EXEC CICS HANDLE CONDITION
 14743*         NOTFND(6065-NOT-FOUND)
 14744*     END-EXEC.
 14745*    MOVE '"$I                   ! / #00013860' TO DFHEIV0
 14746     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14747     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14748     MOVE X'2F20233030303133383630' TO DFHEIV0(25:11)
 14749     CALL 'kxdfhei1' USING DFHEIV0
 14750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14751
 14752
 14753     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14754
 14755     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14756     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14757     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14758     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14759*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14760     STRING AT-CITY ' ' AT-STATE
 14761        DELIMITED BY '  ' INTO CITYSTBO
 14762     END-STRING
 14763     MOVE AT-ZIP-CODE            TO ZIPBO.
 14764
 14765 6061-READ-ACCOUNT.
 14766
 14767* EXEC CICS HANDLE CONDITION
 14768*         NOTFND(6068-ACCT-NOT-FND)
 14769*     END-EXEC.
 14770*    MOVE '"$I                   ! 0 #00013877' TO DFHEIV0
 14771     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14773     MOVE X'3020233030303133383737' TO DFHEIV0(25:11)
 14774     CALL 'kxdfhei1' USING DFHEIV0
 14775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14776
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 283
* EL156.cbl
 14777
 14778
 14779* EXEC CICS READ
 14780*         DATASET('ERACCT')
 14781*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14782*         RIDFLD (PI-ACCT-KEY)
 14783*     END-EXEC.
 14784     MOVE 'ERACCT' TO DFHEIV1
 14785*    MOVE '&"S        E          (   #00013881' TO DFHEIV0
 14786     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14787     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14788     MOVE X'2020233030303133383831' TO DFHEIV0(25:11)
 14789     CALL 'kxdfhei1' USING DFHEIV0,
 14790           DFHEIV1,
 14791           DFHEIV20,
 14792           DFHEIV99,
 14793           PI-ACCT-KEY,
 14794           DFHEIV99,
 14795           DFHEIV99,
 14796           DFHEIV99
 14797     SET ADDRESS OF ACCOUNT-MASTER TO
 14798         DFHEIV20
 14799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14800
 14801
 14802     MOVE AM-CARRIER             TO ACARRBO.
 14803     MOVE AM-GROUPING            TO GROUPBO.
 14804     MOVE AM-STATE               TO STATEBO.
 14805     MOVE AM-ACCOUNT             TO ACCTBO.
 14806     MOVE AM-NAME                TO ACCTNMBO.
 14807
 14808     IF PI-PAYEE-TYPE = 'A' AND
 14809        PI-PAYEE-SEQ-NUM = 0
 14810          MOVE AM-NAME             TO NAMEBO
 14811                                      PI-PAYEE-NAME
 14812          MOVE AM-ADDRS            TO ADDR1BO
 14813          MOVE SPACES              TO ADDR2BO
 14814*         MOVE AM-CITY             TO CITYSTBO
 14815          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14816             DELIMITED BY '  ' INTO CITYSTBO
 14817          END-STRING
 14818          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14819          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14820          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14821          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14822
 14823     IF CITYSTBO EQUAL SPACES
 14824         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14825         GO TO 6070-FORMAT-DATA
 14826     END-IF.
 14827
 14828     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14829     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14830     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14831     PERFORM VARYING WS-SUB FROM 30 BY -1
 14832          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14833        IF WS-END-SUB = 0  AND
 14834           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 284
* EL156.cbl
 14835              OR LOW-VALUES  OR '.')
 14836            CONTINUE
 14837        ELSE
 14838            IF WS-END-SUB = 0
 14839                MOVE WS-SUB TO WS-END-SUB
 14840            ELSE
 14841                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14842                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14843                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14844                END-IF
 14845            END-IF
 14846        END-IF
 14847        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 14848            COMPUTE WS-BEG-SUB = WS-SUB + 1
 14849            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14850        END-IF
 14851     END-PERFORM.
 14852
 14853     IF WS-BEG-SUB > 0
 14854         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 14855         IF WS-STATE-LENGTH = 2
 14856             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 14857                  TO PI-CHECK-STATE-FOR-AK
 14858         ELSE
 14859             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 14860                'ALASKA'
 14861                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 14862             ELSE
 14863                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14864             END-IF
 14865         END-IF
 14866     ELSE
 14867         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14868     END-IF.
 14869
 14870     GO TO 6070-FORMAT-DATA.
 14871
 14872 6065-NOT-FOUND.
 14873     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 14874     GO TO 6061-READ-ACCOUNT.
 14875
 14876 6068-ACCT-NOT-FND.
 14877     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 14878
 14879 6070-FORMAT-DATA.
 14880     IF PI-HOLDTIL = ZEROS
 14881        MOVE SAVE-DATE           TO PAYDTBI
 14882       ELSE
 14883        MOVE PI-HOLDTIL          TO PAYDTBO
 14884        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 14885
 14886     MOVE PI-PROOF-DATE          TO PROOFDBO.
 14887     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 14888
 14889     IF EIBAID = DFHPF3 OR DFHPF4
 14890        NEXT SENTENCE
 14891     ELSE
 14892       GO TO 6071-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 285
* EL156.cbl
 14893
 14894     MOVE PI-EPYFROM          TO PYFROMBO.
 14895     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 14896
 14897     IF NOT PI-USES-PAID-TO
 14898        MOVE PI-EPYTHRU          TO PYTHRUBO
 14899        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 14900     ELSE
 14901        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 14902        MOVE '4'              TO DC-OPTION-CODE
 14903        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14904        IF NO-CONVERSION-ERROR
 14905           MOVE +1            TO DC-ELAPSED-DAYS
 14906           MOVE +0            TO DC-ELAPSED-MONTHS
 14907           MOVE '6'           TO DC-OPTION-CODE
 14908           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14909           IF NO-CONVERSION-ERROR
 14910              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14911
 14912     MOVE PI-EDAYS            TO DAYSBO.
 14913     MOVE PI-EPYAMT           TO PAYAMTBO.
 14914     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14915        IF PI-INT-AMT > ZEROS
 14916           MOVE PI-INT-AMT       TO INTAMTBO
 14917        END-IF
 14918     END-IF
 14919     GO TO 6072-SET-TYPE.
 14920
 14921 6071-CONTINUE.
 14922
 14923     IF PI-CPYFROM NOT = LOW-VALUES
 14924        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 14925        MOVE SPACES              TO DC-OPTION-CODE
 14926        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14927        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 14928
 14929     IF PI-CPYTHRU NOT = LOW-VALUES
 14930        IF NOT PI-USES-PAID-TO
 14931           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14932           MOVE SPACES             TO DC-OPTION-CODE
 14933           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14934           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 14935        ELSE
 14936           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 14937           MOVE '6'                TO DC-OPTION-CODE
 14938           MOVE +1                 TO DC-ELAPSED-DAYS
 14939           MOVE +0                 TO DC-ELAPSED-MONTHS
 14940           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14941           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 14942
 14943     MOVE PI-CDAYS               TO DAYSBO.
 14944     MOVE PI-CPYAMT              TO PAYAMTBO.
 14945     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 14946        IF PI-INT-AMT > ZEROS
 14947           MOVE PI-INT-AMT       TO INTAMTBO
 14948        END-IF
 14949     END-IF
 14950     .
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 286
* EL156.cbl
 14951 6072-SET-TYPE.
 14952     IF PI-PMTTYPE = '1'
 14953        MOVE 'PARTIAL'           TO PAYTYPBO.
 14954
 14955     IF PI-PMTTYPE = '2'
 14956        MOVE 'FINAL'             TO PAYTYPBO.
 14957
 14958     IF PI-PMTTYPE = '3'
 14959        MOVE 'LUMP SUM'          TO PAYTYPBO.
 14960
 14961     IF PI-PMTTYPE = '4'
 14962        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 14963
 14964     IF PI-PMTTYPE = '5'
 14965        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 14966
 14967     IF PI-PMTTYPE = '6'
 14968        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 14969
 14970     IF PI-PROV-PMT
 14971        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 14972
 14973     IF PI-ECHECKNO NOT = SPACES
 14974        MOVE PI-ECHECKNO         TO CKNUMBO
 14975     ELSE
 14976        MOVE PI-CCHECKNO         TO CKNUMBO.
 14977
 14978     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 14979        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 14980        MOVE +91                 TO  TRLR-SEQ-NO
 14981
 14982* EXEC CICS READ
 14983*           DATASET  ('ELTRLR')
 14984*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14985*           RIDFLD   (ELTRLR-KEY)
 14986*           RESP     (WS-RESPONSE)
 14987*       END-EXEC
 14988     MOVE 'ELTRLR' TO DFHEIV1
 14989*    MOVE '&"S        E          (  N#00014066' TO DFHEIV0
 14990     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14992     MOVE X'204E233030303134303636' TO DFHEIV0(25:11)
 14993     CALL 'kxdfhei1' USING DFHEIV0,
 14994           DFHEIV1,
 14995           DFHEIV20,
 14996           DFHEIV99,
 14997           ELTRLR-KEY,
 14998           DFHEIV99,
 14999           DFHEIV99,
 15000           DFHEIV99
 15001     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15002         DFHEIV20
 15003     MOVE EIBRESP  TO WS-RESPONSE
 15004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15005
 15006        IF WS-RESP-NORMAL
 15007           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15008        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 287
* EL156.cbl
 15009           MOVE SPACES           TO  LOANNBO
 15010        END-IF
 15011     END-IF
 15012
 15013*       MOVE PI-LOAN-NO          TO LOANNBO
 15014
 15015     IF CKNUMBO = SPACES
 15016         MOVE SPACES             TO CKNUMHDO.
 15017
 15018     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15019     MOVE CL-CARRIER             TO CARRBO.
 15020     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15021     MOVE CL-CERT-SFX            TO SUFXBO.
 15022
 15023     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 15024        EVALUATE CL-CLAIM-TYPE
 15025           WHEN 'I'
 15026              MOVE '  IU  '      TO CLMTYPBO
 15027           WHEN 'G'
 15028              MOVE ' GAP  '      TO CLMTYPBO
 15029           WHEN OTHER
 15030              MOVE PI-AH-OVERRIDE-L6
 15031                                 TO CLMTYPBO
 15032        END-EVALUATE
 15033        MOVE ZEROS               TO UNDISBO
 15034*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15035        IF PI-PMTTYPE = '5' OR '6'
 15036           GO TO 6073-GET-NOTIFY-DATA
 15037        ELSE
 15038           MOVE PI-DAILY-RATE    TO RATEBO
 15039           GO TO 6073-GET-NOTIFY-DATA.
 15040
 15041     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15042
 15043     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15044        MOVE ZEROS               TO UNDISBO
 15045     ELSE
 15046        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15047
 15048 6073-GET-NOTIFY-DATA.
 15049
 15050     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15051
 15052     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15053         MOVE SPACES             TO  NAMEB2O
 15054                                     ADDR1B2O
 15055                                     ADDR2B2O
 15056                                     CITYST2O
 15057                                     AGTHDGO
 15058         MOVE ZEROS              TO  ZIPB2O
 15059         GO TO 6080-SET-INCURRED.
 15060
 15061     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15062     MOVE +29                    TO  TRLR-SEQ-NO.
 15063
 15064
 15065* EXEC CICS HANDLE CONDITION
 15066*        NOTFND   (6074-GET-COMP-DATA)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 288
* EL156.cbl
 15067*    END-EXEC.
 15068*    MOVE '"$I                   ! 1 #00014131' TO DFHEIV0
 15069     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15070     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15071     MOVE X'3120233030303134313331' TO DFHEIV0(25:11)
 15072     CALL 'kxdfhei1' USING DFHEIV0
 15073     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15074
 15075
 15076     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15077
 15078     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15079     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15080     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15081*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15082     STRING AT-CITY ' ' AT-STATE
 15083        DELIMITED BY '  ' INTO CITYST2O
 15084     END-STRING
 15085     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15086     GO TO 6080-SET-INCURRED.
 15087
 15088 6074-GET-COMP-DATA.
 15089
 15090     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15091         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15092
 15093     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15094         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15095                                         ADDR1B2O
 15096                                         ADDR2B2O
 15097                                         CITYST2O
 15098         MOVE ZEROS                  TO  ZIPB2O
 15099         GO TO 6080-SET-INCURRED.
 15100
 15101     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15102     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15103     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15104     MOVE AM-GROUPING            TO  COMP-GROUP.
 15105     MOVE 'A'                    TO  COMP-TYPE.
 15106     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15107                                 TO  COMP-FIN-RESP.
 15108
 15109     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15110         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15111                                       'G' OR 'B'
 15112             MOVE 'G'            TO  COMP-TYPE
 15113             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15114         ELSE
 15115             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15116                                 TO  COMP-ACCOUNT
 15117     ELSE
 15118         MOVE 'G'                TO  COMP-TYPE
 15119         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15120
 15121     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15122
 15123     IF COMP-REC-FOUND
 15124         MOVE CO-ACCT-NAME       TO  NAMEB2O
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 289
* EL156.cbl
 15125         MOVE CO-ADDR-1          TO  ADDR1B2O
 15126         MOVE CO-ADDR-2          TO  ADDR2B2O
 15127*        MOVE CO-ADDR-3          TO  CITYST2O
 15128         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15129            DELIMITED BY '  ' INTO CITYST2O
 15130         END-STRING
 15131         MOVE CO-ZIP             TO  ZIPB2O
 15132     ELSE
 15133         MOVE 'NO COMP ADDRESS AVAILABLE'
 15134                                 TO  NAMEB2O
 15135                                     ADDR1B2O
 15136                                     ADDR2B2O
 15137                                     CITYST2O
 15138         MOVE ZEROS               TO ZIPB2O.
 15139
 15140 6080-SET-INCURRED.
 15141     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15142     MOVE SPACES                 TO DC-OPTION-CODE.
 15143     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15144     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15145     MOVE PI-PROCESSOR-ID        TO BYBO.
 15146     MOVE MAP-NAMEB              TO MAP-NAME.
 15147     MOVE 'C'                    TO PI-PASS-SW.
 15148     MOVE EIBAID                 TO PI-PFKEY-USED.
 15149     MOVE -1                     TO ENTPFBL.
 15150     GO TO 8100-SEND-INITIAL-MAP.
 15151
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 290
* EL156.cbl
 15153 6100-BUILD-PAYMENT-TRAILER.
 15154
 15155     IF PI-CHECK-STATE-FOR-AK = 'AK' AND
 15156       (PI-COMPANY-ID = 'CID' OR 'AHL')
 15157         GO TO 6105-STATE-CHECK-NUMBER
 15158     END-IF.
 15159
 15160     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15161     MOVE '6'                    TO CNTL-REC-TYPE.
 15162
 15163     IF CONTROL-IS-ACTUAL-CARRIER
 15164         MOVE PI-CARRIER         TO WS-CARR
 15165     ELSE
 15166         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15167
 15168     IF PI-COMPANY-ID = 'FIA'
 15169         MOVE PI-CARRIER         TO  WS-CARR.
 15170
 15171     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15172     MOVE 0                      TO CNTL-SEQ-NO.
 15173     MOVE 'CARR'                 TO FILE-SWITCH.
 15174
 15175     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15176
 15177     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15178         IF PI-OFFLINE     = 'Y' AND
 15179            PI-ECHECKNO-CR = 'CR'
 15180              GO TO 6110-READ-CONTROL
 15181         ELSE
 15182            IF PI-CASH = 'N'
 15183                GO TO 6110-READ-CONTROL.
 15184
 15185     IF CHECK-NO-MANUAL    OR
 15186        CHECK-NO-AT-PRINT  OR
 15187        PI-OFFLINE = 'Y'
 15188          GO TO 6130-BUILD-TRAILER.
 15189
 15190     IF PI-COMPANY-ID = 'FIA'
 15191         NEXT SENTENCE
 15192     ELSE
 15193         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15194             GO TO 6110-READ-CONTROL.
 15195
 15196     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15197
 15198     IF CHECK-CNT-RESET-VALUE
 15199        MOVE +1                  TO CF-CHECK-COUNTER
 15200     ELSE
 15201        ADD +1                   TO CF-CHECK-COUNTER.
 15202
 15203     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15204
 15205     IF CHECK-NO-CARR-SEQ
 15206        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15207
 15208     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15209
 15210     MOVE 'N' TO PI-REAUDIT-NEEDED.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 291
* EL156.cbl
 15211     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15212        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15213         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15214         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15215            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15216         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15217                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15218     END-IF.
 15219
 15220     GO TO 6120-REWRITE.
 15221
 15222 6105-STATE-CHECK-NUMBER.
 15223     IF CHECK-NO-MANUAL    OR
 15224        CHECK-NO-AT-PRINT  OR
 15225        PI-OFFLINE = 'Y'
 15226           GO TO 6130-BUILD-TRAILER
 15227     END-IF.
 15228
 15229     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15230     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15231     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15232     MOVE '3'                TO CNTL-REC-TYPE.
 15233     MOVE +0                 TO CNTL-SEQ-NO.
 15234     MOVE 'STAT'             TO FILE-SWITCH.
 15235     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15236
 15237     IF CF-ST-CHECK-CNT-RESET
 15238         MOVE +1             TO CF-ST-CHECK-COUNTER
 15239     ELSE
 15240         ADD +1              TO CF-ST-CHECK-COUNTER
 15241     END-IF.
 15242
 15243     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15244     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15245     GO TO 6120-REWRITE.
 15246
 15247 6110-READ-CONTROL.
 15248     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15249     MOVE '1'                    TO CNTL-REC-TYPE.
 15250     MOVE SPACES                 TO CNTL-ACCESS.
 15251     MOVE 0                      TO CNTL-SEQ-NO.
 15252
 15253     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15254
 15255     IF CO-CHECK-COUNT-RESET
 15256        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15257     ELSE
 15258        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15259
 15260     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15261
 15262     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15263         IF PI-OFFLINE     = 'Y'  AND
 15264            PI-ECHECKNO-CR = 'CR'
 15265              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15266              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15267              MOVE AL-UANON           TO CHECKNOA
 15268              GO TO 6120-REWRITE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 292
* EL156.cbl
 15269         ELSE
 15270         IF PI-CASH = 'N'
 15271             MOVE 'N'                TO PI-ECHECKNO-N
 15272             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15273             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15274             MOVE AL-UANON           TO CHECKNOA
 15275             GO TO 6120-REWRITE.
 15276
 15277     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15278
 15279 6120-REWRITE.
 15280
 15281* EXEC CICS REWRITE
 15282*         DATASET('ELCNTL')
 15283*         FROM(CONTROL-FILE)
 15284*     END-EXEC.
 15285     MOVE LENGTH OF
 15286      CONTROL-FILE
 15287       TO DFHEIV11
 15288     MOVE 'ELCNTL' TO DFHEIV1
 15289*    MOVE '&& L                  %   #00014339' TO DFHEIV0
 15290     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15291     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15292     MOVE X'2020233030303134333339' TO DFHEIV0(25:11)
 15293     CALL 'kxdfhei1' USING DFHEIV0,
 15294           DFHEIV1,
 15295           CONTROL-FILE,
 15296           DFHEIV11,
 15297           DFHEIV99
 15298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15299
 15300
 15301     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15302
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 293
* EL156.cbl
 15304 6130-BUILD-TRAILER.
 15305
 15306
 15307* EXEC CICS GETMAIN
 15308*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15309*         LENGTH    (200)
 15310*         INITIMG   (GETMAIN-SPACE)
 15311*     END-EXEC.
 15312     MOVE 200
 15313       TO DFHEIV11
 15314*    MOVE ',"IL                  $   #00014349' TO DFHEIV0
 15315     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15316     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15317     MOVE X'2020233030303134333439' TO DFHEIV0(25:11)
 15318     CALL 'kxdfhei1' USING DFHEIV0,
 15319           DFHEIV20,
 15320           DFHEIV11,
 15321           GETMAIN-SPACE
 15322     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15323         DFHEIV20
 15324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15325
 15326
 15327     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15328                                    AT-PREV-PAID-THRU-DT.
 15329     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15330     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15331     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15332     MOVE 'AT'                   TO AT-RECORD-ID.
 15333     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15334
 15335     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15336        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15337           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15338     ELSE
 15339           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15340           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15341
 15342     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15343         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15344             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15345             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15346           ELSE
 15347             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15348             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15349
 15350     MOVE '2'                    TO AT-TRAILER-TYPE.
 15351     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15352                                    AT-PAYMENT-LAST-MAINT-DT.
 15353     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15354                                    AT-PAYMENT-LAST-UPDATED-BY.
 15355     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15356     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15357     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15358     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15359
 15360     IF PI-PMT-APPROVED
 15361        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 294
* EL156.cbl
 15362           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15363
 15364     IF PI-PFKEY-USED = DFHPF5
 15365        GO TO 6140-PF5-ENTERED.
 15366
 15367     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15368     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15369
 15370     IF PI-AIG-SPECIAL-BENEFIT
 15371         IF WS-1ST-SPECIAL-PMT
 15372             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15373             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15374                                        AT-AMOUNT-PAID
 15375         ELSE
 15376             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15377
 15378     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15379
 15380     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15381     MOVE '4'                    TO DC-OPTION-CODE.
 15382     PERFORM 9700-LINK-DATE-CONVERT.
 15383
 15384     IF DATE-CONVERSION-ERROR
 15385        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15386     ELSE
 15387        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15388
 15389     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15390     MOVE '4'                    TO DC-OPTION-CODE.
 15391     PERFORM 9700-LINK-DATE-CONVERT.
 15392
 15393     IF DATE-CONVERSION-ERROR
 15394        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15395     ELSE
 15396        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15397
 15398     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15399     GO TO 6150-FINISH-MOVE.
 15400
 15401 6140-PF5-ENTERED.
 15402     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15403     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15404
 15405     IF PI-AIG-SPECIAL-BENEFIT
 15406         IF WS-1ST-SPECIAL-PMT
 15407             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15408             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15409                                        AT-AMOUNT-PAID
 15410         ELSE
 15411             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15412
 15413     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15414     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15415     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15416
 15417 6150-FINISH-MOVE.
 15418
 15419     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 295
* EL156.cbl
 15420         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15421     ELSE
 15422         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15423
 15424     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15425     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15426
 15427*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15428*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15429
 15430     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15431         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15432
 15433     IF PI-OFFLINE = 'N'
 15434        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15435        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15436     ELSE
 15437        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15438        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15439
 15440     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15441
 15442     IF WS-2ND-SPECIAL-PMT
 15443         MOVE 'Y'                TO AT-CASH-PAYMENT
 15444         MOVE SPACES             TO AT-CHECK-NO
 15445         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15446         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15447         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15448         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15449
 15450     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15451                                    AT-TO-BE-WRITTEN-DT.
 15452
 15453     IF PI-HOLDTIL NOT = ZEROS
 15454        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15455        MOVE '4'                 TO DC-OPTION-CODE
 15456        PERFORM 9700-LINK-DATE-CONVERT
 15457        IF PI-OFFLINE = 'N'
 15458           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15459        ELSE
 15460           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15461
 15462     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15463     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15464                                    AT-CHECK-QUE-SEQUENCE.
 15465
 15466     IF PI-PFKEY-USED = DFHPF4
 15467        MOVE '1'                 TO AT-FORCE-CONTROL.
 15468
 15469     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15470        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15471        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15472        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15473
 15474     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15475                                    AT-VOID-SELECT-DT
 15476                                    AT-VOID-ACCEPT-DT
 15477                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 296
* EL156.cbl
 15478     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 15479        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15480        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15481        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15482        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15483     ELSE
 15484        MOVE ZEROS               TO AT-DAILY-RATE
 15485                                    AT-ELIMINATION-DAYS
 15486        MOVE SPACES              TO AT-BENEFIT-TYPE
 15487     END-IF
 15488     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15489     MOVE '4'                    TO DC-OPTION-CODE.
 15490     PERFORM 9700-LINK-DATE-CONVERT.
 15491     IF DATE-CONVERSION-ERROR
 15492         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15493     ELSE
 15494         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15495     END-IF.
 15496     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15497     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15498     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15499     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15500     IF (PI-REAUDIT-NEEDED = 'Y')
 15501        or (pi-max-ext-used = 'Y')
 15502        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15503         MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15504         MOVE 'Y' TO WS-NEED-APPROVAL
 15505         GO TO 6170-WRITE
 15506     END-IF.
 15507*******************************************************
 15508     IF NOT PI-PMT-GRADUATED
 15509         GO TO 6170-WRITE.
 15510
 15511     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15512     MOVE '1'                    TO CNTL-REC-TYPE.
 15513     MOVE SPACES                 TO CNTL-ACCESS.
 15514     MOVE +0                     TO CNTL-SEQ-NO.
 15515     MOVE 'COMP'                 TO FILE-SWITCH.
 15516
 15517     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15518
 15519     IF PAID-FOR-LIFE
 15520         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15521             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15522                                     WS-PMT-APPROVAL-SW
 15523             GO TO 6170-WRITE.
 15524
 15525*05999      IF PAID-FOR-AH
 15526     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15527         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15528             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15529                                     WS-PMT-APPROVAL-SW
 15530             GO TO 6170-WRITE.
 15531
 15532     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15533
 15534******A&H Limits are set as a monthly payment.  Calculate the mont
 15535******equivalent of the amount paid today
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 297
* EL156.cbl
 15536     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15537        PI-SAVE-ODD-DAYS-OVER > 0
 15538           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15539                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15540           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15541                                  WS-CALC-PMT-MONTHS
 15542     ELSE
 15543           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15544     END-IF.
 15545*06007      IF ((PAID-FOR-AH) AND
 15546     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15547*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15548        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15549              OR
 15550        ((PAID-FOR-LIFE) AND
 15551        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15552            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15553       ELSE
 15554*06014      IF ((PAID-FOR-AH)  AND
 15555         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15556*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15557           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15558              OR
 15559        ((PAID-FOR-LIFE) AND
 15560        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15561            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15562         ELSE
 15563*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15564           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15565               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15566              OR
 15567          ((PAID-FOR-LIFE) AND
 15568          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15569            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15570       ELSE
 15571           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15572               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15573              OR
 15574          ((PAID-FOR-LIFE) AND
 15575          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15576            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15577       ELSE
 15578            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15579
 15580     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15581        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15582        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15583            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15584        END-IF
 15585     ELSE
 15586     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15587        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15588        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15589            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15590        END-IF
 15591     ELSE
 15592     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15593        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 298
* EL156.cbl
 15594        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15595            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15596        END-IF
 15597     ELSE
 15598     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15599        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15600        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15601            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15602        END-IF
 15603     ELSE
 15604     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15605            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15606
 15607     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15608
 15609     IF NOT PI-PMT-GRADUATED
 15610         GO TO 6170-WRITE.
 15611
 15612
 15613* EXEC CICS HANDLE CONDITION
 15614*        NOTFND   (6170-WRITE)
 15615*    END-EXEC.
 15616*    MOVE '"$I                   ! 2 #00014640' TO DFHEIV0
 15617     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15619     MOVE X'3220233030303134363430' TO DFHEIV0(25:11)
 15620     CALL 'kxdfhei1' USING DFHEIV0
 15621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15622
 15623
 15624     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15625     MOVE '2'                    TO CNTL-REC-TYPE.
 15626     MOVE +0                     TO CNTL-SEQ-NO.
 15627     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15628
 15629
 15630* EXEC CICS READ
 15631*         DATASET  ('ELCNTL')
 15632*         SET      (ADDRESS OF CONTROL-FILE)
 15633*         RIDFLD   (ELCNTL-KEY)
 15634*    END-EXEC.
 15635     MOVE 'ELCNTL' TO DFHEIV1
 15636*    MOVE '&"S        E          (   #00014649' TO DFHEIV0
 15637     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15638     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15639     MOVE X'2020233030303134363439' TO DFHEIV0(25:11)
 15640     CALL 'kxdfhei1' USING DFHEIV0,
 15641           DFHEIV1,
 15642           DFHEIV20,
 15643           DFHEIV99,
 15644           ELCNTL-KEY,
 15645           DFHEIV99,
 15646           DFHEIV99,
 15647           DFHEIV99
 15648     SET ADDRESS OF CONTROL-FILE TO
 15649         DFHEIV20
 15650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15651
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 299
* EL156.cbl
 15652
 15653     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15654
 15655     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15656                         OR '4' OR '5'
 15657         NEXT SENTENCE
 15658     ELSE
 15659         MOVE 'Y' TO WS-NEED-APPROVAL
 15660         GO TO 6170-WRITE.
 15661
 15662     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15663         MOVE 'Y' TO WS-NEED-APPROVAL
 15664         IF WS-APPROVAL-LEVEL = '1'
 15665             MOVE '2'        TO  AT-APPROVED-LEVEL
 15666                            WS-SAVE-APPROVED-LEVEL
 15667             GO TO 6170-WRITE
 15668         ELSE
 15669             IF WS-APPROVAL-LEVEL = '2'
 15670                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15671                                WS-SAVE-APPROVED-LEVEL
 15672                 GO TO 6170-WRITE
 15673             ELSE IF WS-APPROVAL-LEVEL = '3'
 15674                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15675                                WS-SAVE-APPROVED-LEVEL
 15676                 GO TO 6170-WRITE
 15677             ELSE IF WS-APPROVAL-LEVEL = '4'
 15678                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15679                                WS-SAVE-APPROVED-LEVEL
 15680                 GO TO 6170-WRITE.
 15681
 15682     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15683                             WS-PMT-APPROVAL-SW.
 15684     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15685                             AT-APPROVAL-LEVEL-REQD.
 15686
 15687*******************************************************
 15688
 15689 6170-WRITE.
 15690
 15691     if pi-company-id = 'DCC'
 15692        PERFORM 0900-GET-DDF-limits
 15693                                 THRU 0900-EXIT
 15694     end-if
 15695     perform 2220-update-elcrtt  thru 2220-exit
 15696     IF PI-COMPANY-ID = 'DMD'
 15697        IF PI-AT-EOB-CODES NOT = SPACES
 15698           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15699           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15700           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15701           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15702           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 15703
 15704
 15705* EXEC CICS HANDLE CONDITION
 15706*        DUPREC    (6180-DUPREC)
 15707*    END-EXEC.
 15708*    MOVE '"$%                   ! 3 #00014706' TO DFHEIV0
 15709     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 300
* EL156.cbl
 15710     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15711     MOVE X'3320233030303134373036' TO DFHEIV0(25:11)
 15712     CALL 'kxdfhei1' USING DFHEIV0
 15713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15714
 15715
 15716
 15717* EXEC CICS WRITE
 15718*         DATASET       ('ELTRLR')
 15719*         FROM          (ACTIVITY-TRAILERS)
 15720*         RIDFLD        (AT-CONTROL-PRIMARY)
 15721*     END-EXEC.
 15722     MOVE LENGTH OF
 15723      ACTIVITY-TRAILERS
 15724       TO DFHEIV11
 15725     MOVE 'ELTRLR' TO DFHEIV1
 15726*    MOVE '&$ L                  ''   #00014710' TO DFHEIV0
 15727     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15729     MOVE X'2020233030303134373130' TO DFHEIV0(25:11)
 15730     CALL 'kxdfhei1' USING DFHEIV0,
 15731           DFHEIV1,
 15732           ACTIVITY-TRAILERS,
 15733           DFHEIV11,
 15734           AT-CONTROL-PRIMARY,
 15735           DFHEIV99,
 15736           DFHEIV99
 15737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15738
 15739
 15740     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15741        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15742*06088           GO TO 6199-EXIT.
 15743           GO TO 6176-APPROVAL-NOTE.
 15744
 15745
 15746* EXEC CICS GETMAIN
 15747*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15748*         LENGTH    (200)
 15749*         INITIMG   (GETMAIN-SPACE)
 15750*     END-EXEC.
 15751     MOVE 200
 15752       TO DFHEIV11
 15753*    MOVE ',"IL                  $   #00014721' TO DFHEIV0
 15754     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15755     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15756     MOVE X'2020233030303134373231' TO DFHEIV0(25:11)
 15757     CALL 'kxdfhei1' USING DFHEIV0,
 15758           DFHEIV20,
 15759           DFHEIV11,
 15760           GETMAIN-SPACE
 15761     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15762         DFHEIV20
 15763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15764
 15765
 15766     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15767
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 301
* EL156.cbl
 15768     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15769     MOVE 'AT'                   TO AT-RECORD-ID.
 15770     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15771     MOVE '6'                    TO AT-TRAILER-TYPE.
 15772     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15773                                    AT-GEN-INFO-LAST-MAINT-DT
 15774     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15775                                    AT-GEN-INFO-LAST-UPDATED-BY
 15776     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15777
 15778     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15779     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15780     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15781
 15782     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15783
 15784 6175-WRITE.
 15785
 15786
 15787* EXEC CICS HANDLE CONDITION
 15788*        DUPREC    (6190-DUPREC)
 15789*    END-EXEC.
 15790*    MOVE '"$%                   ! 4 #00014747' TO DFHEIV0
 15791     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15793     MOVE X'3420233030303134373437' TO DFHEIV0(25:11)
 15794     CALL 'kxdfhei1' USING DFHEIV0
 15795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15796
 15797
 15798
 15799* EXEC CICS WRITE
 15800*         DATASET     ('ELTRLR')
 15801*         FROM        (ACTIVITY-TRAILERS)
 15802*         RIDFLD      (AT-CONTROL-PRIMARY)
 15803*     END-EXEC.
 15804     MOVE LENGTH OF
 15805      ACTIVITY-TRAILERS
 15806       TO DFHEIV11
 15807     MOVE 'ELTRLR' TO DFHEIV1
 15808*    MOVE '&$ L                  ''   #00014751' TO DFHEIV0
 15809     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15810     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15811     MOVE X'2020233030303134373531' TO DFHEIV0(25:11)
 15812     CALL 'kxdfhei1' USING DFHEIV0,
 15813           DFHEIV1,
 15814           ACTIVITY-TRAILERS,
 15815           DFHEIV11,
 15816           AT-CONTROL-PRIMARY,
 15817           DFHEIV99,
 15818           DFHEIV99
 15819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15820
 15821
 15822 6176-APPROVAL-NOTE.
 15823
 15824     IF NOT APPROVAL-NEEDED
 15825         GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 302
* EL156.cbl
 15826
 15827
 15828* EXEC CICS GETMAIN
 15829*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15830*        LENGTH    (200)
 15831*        INITIMG   (GETMAIN-SPACE)
 15832*    END-EXEC.
 15833     MOVE 200
 15834       TO DFHEIV11
 15835*    MOVE ',"IL                  $   #00014762' TO DFHEIV0
 15836     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15837     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15838     MOVE X'2020233030303134373632' TO DFHEIV0(25:11)
 15839     CALL 'kxdfhei1' USING DFHEIV0,
 15840           DFHEIV20,
 15841           DFHEIV11,
 15842           GETMAIN-SPACE
 15843     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15844         DFHEIV20
 15845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15846
 15847
 15848     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 15849
 15850     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 15851     MOVE 'AT'               TO AT-RECORD-ID
 15852     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 15853     MOVE '6'                TO AT-TRAILER-TYPE
 15854     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 15855                                AT-GEN-INFO-LAST-MAINT-DT
 15856     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 15857                                AT-GEN-INFO-LAST-UPDATED-BY
 15858     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 15859
 15860     IF PI-REAUDIT-NEEDED = 'Y'
 15861         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 15862     ELSE
 15863         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 15864     END-IF
 15865     IF PI-APPROVAL-3550-NEEDED = 'Y'
 15866         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 15867     END-IF
 15868     MOVE SPACES             TO AT-INFO-LINE-2
 15869
 15870     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 15871 6177-WRITE.
 15872
 15873
 15874* EXEC CICS HANDLE CONDITION
 15875*        DUPREC    (6185-DUPREC)
 15876*    END-EXEC.
 15877*    MOVE '"$%                   ! 5 #00014793' TO DFHEIV0
 15878     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15880     MOVE X'3520233030303134373933' TO DFHEIV0(25:11)
 15881     CALL 'kxdfhei1' USING DFHEIV0
 15882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15883
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 303
* EL156.cbl
 15884
 15885
 15886* EXEC CICS WRITE
 15887*         DATASET     ('ELTRLR')
 15888*         FROM        (ACTIVITY-TRAILERS)
 15889*         RIDFLD      (AT-CONTROL-PRIMARY)
 15890*     END-EXEC.
 15891     MOVE LENGTH OF
 15892      ACTIVITY-TRAILERS
 15893       TO DFHEIV11
 15894     MOVE 'ELTRLR' TO DFHEIV1
 15895*    MOVE '&$ L                  ''   #00014797' TO DFHEIV0
 15896     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15898     MOVE X'2020233030303134373937' TO DFHEIV0(25:11)
 15899     CALL 'kxdfhei1' USING DFHEIV0,
 15900           DFHEIV1,
 15901           ACTIVITY-TRAILERS,
 15902           DFHEIV11,
 15903           AT-CONTROL-PRIMARY,
 15904           DFHEIV99,
 15905           DFHEIV99
 15906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15907
 15908
 15909
 15910     GO TO 6199-EXIT.
 15911
 15912 6180-DUPREC.
 15913
 15914     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15915     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15916     GO TO 6170-WRITE.
 15917
 15918 6185-DUPREC.
 15919     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15920     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15921     GO TO 6177-WRITE.
 15922
 15923 6190-DUPREC.
 15924     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15925     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 15926     GO TO 6175-WRITE.
 15927
 15928 6199-EXIT.
 15929      EXIT.
 15930
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 304
* EL156.cbl
 15932 6200-UPDATE-CLAIM-MSTR.
 15933     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15934     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15935     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15936     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15937
 15938     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 15939
 15940     MOVE ZEROS                  TO W-INTEREST.
 15941
 15942     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 15943        IF (PI-OFFLINE = 'Y') OR
 15944           (PI-PMTTYPE = '7')
 15945           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 15946                                 THRU 9870-EXIT
 15947        END-IF
 15948     END-IF
 15949     IF NOT ERROR-ON-OUTPUT
 15950        CONTINUE
 15951     ELSE
 15952
 15953* EXEC CICS REWRITE
 15954*          DATASET('ELMSTR')
 15955*          FROM(CLAIM-MASTER)
 15956*       END-EXEC
 15957     MOVE LENGTH OF
 15958      CLAIM-MASTER
 15959       TO DFHEIV11
 15960     MOVE 'ELMSTR' TO DFHEIV1
 15961*    MOVE '&& L                  %   #00014846' TO DFHEIV0
 15962     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15963     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15964     MOVE X'2020233030303134383436' TO DFHEIV0(25:11)
 15965     CALL 'kxdfhei1' USING DFHEIV0,
 15966           DFHEIV1,
 15967           CLAIM-MASTER,
 15968           DFHEIV11,
 15969           DFHEIV99
 15970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15971
 15972        MOVE -1                  TO ENTPFBL
 15973        MOVE AL-UANON            TO ENTPFBA
 15974        MOVE MAP-NAMEB           TO MAP-NAME
 15975        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15976        GO TO 8200-SEND-DATAONLY
 15977     END-IF
 15978
 15979     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 15980
 15981     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 15982
 15983     IF PI-AIG-SPECIAL-BENEFIT
 15984         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 15985
 15986     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 15987
 15988     IF PI-SPECIAL-BEN-SW = 'Y'
 15989         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 305
* EL156.cbl
 15990         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 15991
 15992     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15993         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 15994     ELSE
 15995         IF PI-PMTTYPE NOT = '4'
 15996            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 15997
 15998     IF PI-PMTTYPE = '5' OR '6'
 15999        GO TO  6250-SET-MAINT.
 16000
 16001     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16002                                         CL-LAG-REPORT-CODE.
 16003
 16004     IF CL-ACTIVITY-CODE = 09
 16005         GO TO 6200-CONT-UPDATE.
 16006
 16007     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16008         IF CL-ACTIVITY-CODE = 11
 16009             GO TO 6200-CONT-UPDATE.
 16010
 16011     IF WS-ACT-REC-FOUND-SW = 'N'
 16012         GO TO 6200-CONT-UPDATE.
 16013
 16014     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16015         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16016         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16017         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16018
 16019     IF WS-UPDATE-SW = 'Y'
 16020         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16021                                         CL-NEXT-FOLLOWUP-DT.
 16022
 16023 6200-CONT-UPDATE.
 16024
 16025     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16026       IF CLAIM-IS-CLOSED
 16027         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16028           IF WS-OPEN-CLOSE-SW = '2'
 16029             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16030                                        CL-LAST-CLOSE-DT.
 16031
 16032     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16033        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16034        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16035
 16036     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16037        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16038        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16039        MOVE 'C'                 TO CL-CLAIM-STATUS
 16040        IF PI-PMTTYPE = '2'
 16041           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16042           CONTINUE
 16043        ELSE
 16044           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16045        END-IF
 16046     ELSE
 16047        IF PI-PMTTYPE = '2' OR '3'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 306
* EL156.cbl
 16048           IF PI-PMTTYPE = '2' AND
 16049              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G')
 16050              CONTINUE
 16051           ELSE
 16052              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16053           END-IF
 16054        END-IF
 16055     END-IF
 16056
 16057     IF PI-PMTTYPE = '4'
 16058        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16059
 16060     IF PI-COMPANY-ID = 'CVL'
 16061         IF PI-LOAN-UPDATE-SW = 'Y'
 16062             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16063             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16064             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16065             MOVE CL-CERT-STATE      TO  CERT-STATE
 16066             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16067             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16068             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16069             MOVE 'CERT'             TO  FILE-SWITCH
 16070             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16071             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16072             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16073
 16074     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16075        GO TO 6220-USE-COMPUTED.
 16076
 16077     IF (PI-PMTTYPE = '4')  AND
 16078        (PI-EPYAMT < ZEROS)
 16079          COMPUTE CL-NO-OF-DAYS-PAID =
 16080                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16081          IF CL-NO-OF-DAYS-PAID < +0
 16082              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16083          ELSE
 16084              NEXT SENTENCE
 16085     ELSE
 16086          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16087
 16088     IF PI-PROCESSOR-ID = 'FIX '
 16089        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16090           NEXT SENTENCE
 16091        ELSE
 16092           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16093     ELSE
 16094        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16095
 16096     IF PI-PMTTYPE = '4'
 16097        GO TO 6250-SET-MAINT.
 16098
 16099     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16100
 16101     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16102     MOVE '4'                    TO DC-OPTION-CODE.
 16103     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16104     IF DATE-CONVERSION-ERROR
 16105        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 307
* EL156.cbl
 16106     ELSE
 16107        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16108           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16109           IF PI-AIG-SPECIAL-BENEFIT
 16110               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16111           ELSE
 16112               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16113
 16114     GO TO 6250-SET-MAINT.
 16115
 16116 6220-USE-COMPUTED.
 16117
 16118     IF (PI-PMTTYPE = '4')  AND
 16119        (PI-CPYAMT < ZEROS)
 16120          COMPUTE CL-NO-OF-DAYS-PAID =
 16121                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16122          IF CL-NO-OF-DAYS-PAID < +0
 16123              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16124          ELSE
 16125              NEXT SENTENCE
 16126     ELSE
 16127          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16128
 16129     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16130
 16131     IF PI-PMTTYPE = '4'
 16132        GO TO 6250-SET-MAINT.
 16133
 16134     IF PI-AIG-SPECIAL-BENEFIT
 16135         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16136     ELSE
 16137         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16138
 16139     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16140
 16141     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16142        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16143
 16144 6250-SET-MAINT.
 16145     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16146
 16147     IF PI-PROCESSOR-ID = 'FIX '
 16148        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16149           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16150        ELSE
 16151           NEXT SENTENCE
 16152     ELSE
 16153        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16154
 16155     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16156     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16157     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16158
 16159 6299-EXIT.
 16160      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 308
* EL156.cbl
 16162 6300-UPDATE-CERT.
 16163
 16164*  ADD CERTNOTE FOR SC NP+6
 16165     IF PI-COMPANY-ID = 'CID' AND
 16166       (PI-PMTTYPE = '2' OR '3') AND
 16167        CL-CERT-STATE = 'SC'  AND
 16168        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16169           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16170     END-IF.
 16171
 16172     IF PI-COMPANY-ID = 'AHL' AND
 16173       (PI-PMTTYPE = '2' OR '3') AND
 16174        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16175           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16176           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16177     END-IF.
 16178
 16179     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16180     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16181     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16182     MOVE CL-CERT-STATE    TO CERT-STATE.
 16183     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16184     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16185     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16186     MOVE 'CERT'           TO FILE-SWITCH.
 16187
 16188     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16189
 16190     IF CERT-NOTE-ADDED
 16191        IF CM-NOTE-SW = ' '
 16192           MOVE '4'             TO CM-NOTE-SW
 16193        ELSE
 16194           IF CM-NOTE-SW = '1'
 16195               MOVE '5'           TO CM-NOTE-SW
 16196           ELSE
 16197              IF CM-NOTE-SW = '2'
 16198                 MOVE '6'         TO CM-NOTE-SW
 16199              ELSE
 16200                 IF CM-NOTE-SW = '3'
 16201                    MOVE '7'      TO CM-NOTE-SW
 16202                 END-IF
 16203              END-IF
 16204           END-IF
 16205        END-IF
 16206     END-IF.
 16207
 16208     IF PI-COMPANY-ID = 'CVL'
 16209         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16210         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16211
 16212     IF PI-PMTTYPE NOT = '4'
 16213        GO TO 6340-UPDATE-CERT.
 16214
 16215     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16216        IF PI-PFKEY-USED = DFHPF5
 16217           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16218        ELSE
 16219           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 309
* EL156.cbl
 16220
 16221*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16222*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16223*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16224*               PI-LF-COVERAGE-TYPE = 'P'
 16225*                GO TO 6350-REWRITE-CERT.
 16226
 16227     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16228       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16229          PI-LF-COVERAGE-TYPE = 'P'
 16230           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16231                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16232                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16233                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16234                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16235                GO TO 6350-REWRITE-CERT
 16236            ELSE
 16237                GO TO 6350-REWRITE-CERT.
 16238
 16239     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16240         GO TO 6350-REWRITE-CERT.
 16241
 16242     IF NOT CM-AH-LUMP-SUM-DISAB
 16243        GO TO 6380-UNLOCK-CERT.
 16244
 16245     IF PI-PFKEY-USED = DFHPF5
 16246        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16247                                    CM-AH-ITD-AH-PMT
 16248        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16249        GO TO 6350-REWRITE-CERT
 16250     ELSE
 16251        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16252                                    CM-AH-ITD-AH-PMT
 16253        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16254        GO TO 6350-REWRITE-CERT.
 16255
 16256 6340-UPDATE-CERT.
 16257
 16258     IF CL-CLAIM-TYPE = 'L'
 16259         IF PI-PFKEY-USED = DFHPF5
 16260             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16261         ELSE
 16262             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16263
 16264     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16265         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16266             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16267                PI-LF-COVERAGE-TYPE = 'P'
 16268                 GO TO 6350-REWRITE-CERT.
 16269
 16270     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16271       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16272          PI-LF-COVERAGE-TYPE = 'P'
 16273           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16274                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16275                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16276                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16277                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 310
* EL156.cbl
 16278                GO TO 6350-REWRITE-CERT.
 16279
 16280     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16281         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16282            PI-LF-COVERAGE-TYPE NOT = 'P'
 16283             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16284             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16285             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16286             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16287             GO TO 6350-REWRITE-CERT.
 16288
 16289     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16290         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16291         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16292         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16293         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16294         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16295         IF PI-PFKEY-USED = DFHPF5
 16296             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16297                                        CM-AH-ITD-AH-PMT
 16298             GO TO 6350-REWRITE-CERT
 16299         ELSE
 16300             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16301                                        CM-AH-ITD-AH-PMT
 16302             GO TO 6350-REWRITE-CERT.
 16303
 16304 6350-REWRITE-CERT.
 16305
 16306
 16307* EXEC CICS REWRITE
 16308*         DATASET  ('ELCERT')
 16309*         FROM(CERTIFICATE-MASTER)
 16310*     END-EXEC.
 16311     MOVE LENGTH OF
 16312      CERTIFICATE-MASTER
 16313       TO DFHEIV11
 16314     MOVE 'ELCERT' TO DFHEIV1
 16315*    MOVE '&& L                  %   #00015185' TO DFHEIV0
 16316     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16317     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16318     MOVE X'2020233030303135313835' TO DFHEIV0(25:11)
 16319     CALL 'kxdfhei1' USING DFHEIV0,
 16320           DFHEIV1,
 16321           CERTIFICATE-MASTER,
 16322           DFHEIV11,
 16323           DFHEIV99
 16324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16325
 16326
 16327     GO TO 6399-EXIT.
 16328
 16329 6380-UNLOCK-CERT.
 16330
 16331* EXEC CICS UNLOCK
 16332*         DATASET  ('ELCERT')
 16333*     END-EXEC.
 16334     MOVE 'ELCERT' TO DFHEIV1
 16335*    MOVE '&*                    #   #00015193' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 311
* EL156.cbl
 16336     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16337     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16338     MOVE X'2020233030303135313933' TO DFHEIV0(25:11)
 16339     CALL 'kxdfhei1' USING DFHEIV0,
 16340           DFHEIV1,
 16341           DFHEIV99
 16342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16343
 16344
 16345 6399-EXIT.
 16346      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 312
* EL156.cbl
 16348 6400-UPDATE-ZERO-TRAILER.
 16349     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16350     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16351
 16352     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16353
 16354     IF PI-EPYAMT NOT = ZEROS
 16355         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16356     ELSE
 16357         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16358
 16359     IF PI-ERESV NOT = ZEROS
 16360        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16361
 16362     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16363        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16364
 16365     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16366        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16367     ELSE
 16368        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16369
 16370     IF PI-PMTTYPE = '5'
 16371        IF PI-EPYAMT = ZEROS
 16372           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16373        ELSE
 16374           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16375
 16376     IF PI-PMTTYPE = '6'
 16377        IF PI-EPYAMT = ZEROS
 16378           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16379        ELSE
 16380           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16381
 16382 6420-CHECK-OPEN-CLOSE.
 16383     IF PI-PMTTYPE = '5' OR '6'
 16384        GO TO 6450-REWRITE.
 16385
 16386     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16387         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16388             IF CLAIM-IS-CLOSED
 16389                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16390                 MOVE 1          TO  SUB-1
 16391                 GO TO 6440-AIG-LOOP.
 16392
 16393     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16394        GO TO 6450-REWRITE.
 16395
 16396     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16397        GO TO 6450-REWRITE.
 16398
 16399     MOVE 1                      TO SUB-1.
 16400
 16401 6430-LOOP.
 16402     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16403        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16404        IF PI-PMTTYPE = '1' OR '4'
 16405           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 313
* EL156.cbl
 16406           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16407           GO TO 6450-REWRITE
 16408        ELSE
 16409           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16410           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16411           GO TO 6450-REWRITE.
 16412
 16413     IF SUB-1 = 6
 16414      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16415      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16416      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16417      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16418      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16419      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16420      GO TO 6430-LOOP.
 16421
 16422     ADD 1                       TO SUB-1.
 16423     GO TO 6430-LOOP.
 16424
 16425
 16426 6440-AIG-LOOP.
 16427
 16428     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16429       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16430       IF WS-OPEN-CLOSE-SW = '1'
 16431         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16432         IF PI-PMTTYPE = '2'
 16433           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16434           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16435         ELSE
 16436           IF PI-PMTTYPE = '3'
 16437             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16438             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16439           ELSE
 16440             IF PI-PMTTYPE = '4'
 16441               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16442               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16443             ELSE
 16444               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16445               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16446       ELSE
 16447         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16448         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16449         GO TO 6450-REWRITE.
 16450
 16451     IF SUB-1 = 6
 16452      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16453      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16454      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16455      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16456      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16457      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16458      GO TO 6440-AIG-LOOP.
 16459
 16460     ADD 1                       TO SUB-1.
 16461     GO TO 6440-AIG-LOOP.
 16462
 16463 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 314
* EL156.cbl
 16464     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16465     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16466     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16467
 16468     IF PI-COMPANY-ID = 'DMD'
 16469         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16470         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16471         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16472         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16473         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16474
 16475
 16476* EXEC CICS REWRITE
 16477*         DATASET  ('ELTRLR')
 16478*         FROM     (ACTIVITY-TRAILERS)
 16479*     END-EXEC.
 16480     MOVE LENGTH OF
 16481      ACTIVITY-TRAILERS
 16482       TO DFHEIV11
 16483     MOVE 'ELTRLR' TO DFHEIV1
 16484*    MOVE '&& L                  %   #00015327' TO DFHEIV0
 16485     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16486     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16487     MOVE X'2020233030303135333237' TO DFHEIV0(25:11)
 16488     CALL 'kxdfhei1' USING DFHEIV0,
 16489           DFHEIV1,
 16490           ACTIVITY-TRAILERS,
 16491           DFHEIV11,
 16492           DFHEIV99
 16493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16494
 16495
 16496 6499-EXIT.
 16497      EXIT.
 16498
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 315
* EL156.cbl
 16500 6500-READ-DLO035.
 16501     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16502     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16503     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16504     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16505
 16506
 16507* EXEC CICS LINK
 16508*        PROGRAM    ('DLO035')
 16509*        COMMAREA   (DLO035-KEY)
 16510*        LENGTH     (DL35-LENGTH)
 16511*    END-EXEC.
 16512     MOVE 'DLO035' TO DFHEIV1
 16513*    MOVE '."C                   (   #00015342' TO DFHEIV0
 16514     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16516     MOVE X'2020233030303135333432' TO DFHEIV0(25:11)
 16517     CALL 'kxdfhei1' USING DFHEIV0,
 16518           DFHEIV1,
 16519           DLO035-KEY,
 16520           DL35-LENGTH,
 16521           DFHEIV99,
 16522           DFHEIV99,
 16523           DFHEIV99,
 16524           DFHEIV99
 16525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16526
 16527
 16528     IF DL35-RETURN-CODE = 'OK'
 16529         GO TO 6500-EXIT.
 16530
 16531     IF DL35-RETURN-CODE = '01'
 16532         MOVE ER-7830            TO EMI-ERROR
 16533         GO TO 6500-BAD-EXIT.
 16534
 16535     IF DL35-RETURN-CODE = '02'
 16536         MOVE ER-7831            TO EMI-ERROR
 16537         GO TO 6500-BAD-EXIT.
 16538
 16539     IF DL35-RETURN-CODE = '03'
 16540         MOVE ER-7832            TO EMI-ERROR
 16541         GO TO 6500-BAD-EXIT.
 16542
 16543     IF DL35-RETURN-CODE = '04'
 16544         MOVE ER-7833            TO EMI-ERROR
 16545         GO TO 6500-BAD-EXIT.
 16546
 16547     IF DL35-RETURN-CODE = '05'
 16548         MOVE ER-7834            TO EMI-ERROR
 16549         GO TO 6500-BAD-EXIT.
 16550
 16551     IF DL35-RETURN-CODE = '06'
 16552         MOVE ER-7835            TO EMI-ERROR
 16553         GO TO 6500-BAD-EXIT.
 16554
 16555     IF DL35-RETURN-CODE = '07'
 16556         MOVE ER-7836            TO EMI-ERROR
 16557         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 316
* EL156.cbl
 16558
 16559     IF DL35-RETURN-CODE = 'E1'
 16560         MOVE ER-7837            TO EMI-ERROR
 16561         GO TO 6500-BAD-EXIT.
 16562
 16563     IF DL35-RETURN-CODE NOT = 'OK'
 16564         MOVE ER-7838            TO EMI-ERROR
 16565         GO TO 6500-BAD-EXIT.
 16566
 16567 6500-EXIT.
 16568      EXIT.
 16569
 16570 6500-BAD-EXIT.
 16571
 16572* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16573*    MOVE '6"R                   !   #00015391' TO DFHEIV0
 16574     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16575     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16576     MOVE X'2020233030303135333931' TO DFHEIV0(25:11)
 16577     CALL 'kxdfhei1' USING DFHEIV0
 16578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16579
 16580     MOVE -1                 TO PMTTYPEL.
 16581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16582     GO TO 8200-SEND-DATAONLY.
 16583
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 317
* EL156.cbl
 16585 6600-UPDATE-DLO035.
 16586     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16587     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16588     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16589     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16590
 16591
 16592* EXEC CICS LINK
 16593*        PROGRAM    ('DLO035')
 16594*        COMMAREA   (DLO035-KEY)
 16595*        LENGTH     (DL35-LENGTH)
 16596*    END-EXEC.
 16597     MOVE 'DLO035' TO DFHEIV1
 16598*    MOVE '."C                   (   #00015403' TO DFHEIV0
 16599     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16600     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16601     MOVE X'2020233030303135343033' TO DFHEIV0(25:11)
 16602     CALL 'kxdfhei1' USING DFHEIV0,
 16603           DFHEIV1,
 16604           DLO035-KEY,
 16605           DL35-LENGTH,
 16606           DFHEIV99,
 16607           DFHEIV99,
 16608           DFHEIV99,
 16609           DFHEIV99
 16610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16611
 16612
 16613     IF DL35-RETURN-CODE = 'OK'
 16614         GO TO 6600-EXIT.
 16615
 16616     IF DL35-RETURN-CODE = '01'
 16617         MOVE ER-7830            TO EMI-ERROR
 16618         GO TO 6500-BAD-EXIT.
 16619
 16620     IF DL35-RETURN-CODE = '02'
 16621         MOVE ER-7831            TO EMI-ERROR
 16622         GO TO 6500-BAD-EXIT.
 16623
 16624     IF DL35-RETURN-CODE = '03'
 16625         MOVE ER-7832            TO EMI-ERROR
 16626         GO TO 6500-BAD-EXIT.
 16627
 16628     IF DL35-RETURN-CODE = '04'
 16629         MOVE ER-7833            TO EMI-ERROR
 16630         GO TO 6500-BAD-EXIT.
 16631
 16632     IF DL35-RETURN-CODE = '05'
 16633         MOVE ER-7834            TO EMI-ERROR
 16634         GO TO 6500-BAD-EXIT.
 16635
 16636     IF DL35-RETURN-CODE = '06'
 16637         MOVE ER-7835            TO EMI-ERROR
 16638         GO TO 6500-BAD-EXIT.
 16639
 16640     IF DL35-RETURN-CODE = '07'
 16641         MOVE ER-7836            TO EMI-ERROR
 16642         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 318
* EL156.cbl
 16643
 16644     IF DL35-RETURN-CODE = 'E1'
 16645         MOVE ER-7837            TO EMI-ERROR
 16646         GO TO 6500-BAD-EXIT.
 16647
 16648     IF DL35-RETURN-CODE NOT = 'OK'
 16649         MOVE ER-7838            TO EMI-ERROR
 16650         GO TO 6500-BAD-EXIT.
 16651
 16652 6600-EXIT.
 16653      EXIT.
 16654
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 319
* EL156.cbl
 16656 6700-UPDATE-ACTQ.
 16657***************************************************************
 16658*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16659*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16660*    ONE ALREADY THERE.                                       *
 16661***************************************************************
 16662
 16663
 16664* EXEC CICS HANDLE CONDITION
 16665*         NOTFND(6720-BUILD-NEW-RECORD)
 16666*     END-EXEC.
 16667*    MOVE '"$I                   ! 6 #00015459' TO DFHEIV0
 16668     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16670     MOVE X'3620233030303135343539' TO DFHEIV0(25:11)
 16671     CALL 'kxdfhei1' USING DFHEIV0
 16672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16673
 16674
 16675
 16676* EXEC CICS READ
 16677*         DATASET('ELACTQ')
 16678*         RIDFLD (ELMSTR-KEY)
 16679*         SET    (ADDRESS OF ACTIVITY-QUE)
 16680*         UPDATE
 16681*     END-EXEC.
 16682     MOVE 'ELACTQ' TO DFHEIV1
 16683*    MOVE '&"S        EU         (   #00015463' TO DFHEIV0
 16684     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16685     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16686     MOVE X'2020233030303135343633' TO DFHEIV0(25:11)
 16687     CALL 'kxdfhei1' USING DFHEIV0,
 16688           DFHEIV1,
 16689           DFHEIV20,
 16690           DFHEIV99,
 16691           ELMSTR-KEY,
 16692           DFHEIV99,
 16693           DFHEIV99,
 16694           DFHEIV99
 16695     SET ADDRESS OF ACTIVITY-QUE TO
 16696         DFHEIV20
 16697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16698
 16699
 16700     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16701
 16702     IF PI-AIG-SPECIAL-BENEFIT AND
 16703        PI-CASH = 'Y'
 16704         ADD 2                   TO AQ-PAYMENT-COUNTER
 16705     ELSE
 16706         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16707
 16708     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16709         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16710
 16711     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16712
 16713     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 320
* EL156.cbl
 16714         IF WS-PMT-APPROVAL-SW = 'A'
 16715             NEXT SENTENCE
 16716         ELSE
 16717            IF PI-AIG-SPECIAL-BENEFIT AND
 16718               PI-CASH = 'Y'
 16719                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16720                                     WS-PMT-UNAPPROVED-CNT
 16721            ELSE
 16722                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16723                                     WS-PMT-UNAPPROVED-CNT
 16724     ELSE
 16725         IF PI-PMT-APPR-SW = 'Y'
 16726            IF PI-AIG-SPECIAL-BENEFIT AND
 16727               PI-CASH = 'Y'
 16728                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16729                                     WS-PMT-UNAPPROVED-CNT
 16730            ELSE
 16731                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16732                                     WS-PMT-UNAPPROVED-CNT.
 16733
 16734     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16735         MOVE ER-3536 TO EMI-ERROR
 16736         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16737
 16738     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16739
 16740
 16741* EXEC CICS REWRITE
 16742*         DATASET('ELACTQ')
 16743*         FROM   (ACTIVITY-QUE)
 16744*     END-EXEC.
 16745     MOVE LENGTH OF
 16746      ACTIVITY-QUE
 16747       TO DFHEIV11
 16748     MOVE 'ELACTQ' TO DFHEIV1
 16749*    MOVE '&& L                  %   #00015510' TO DFHEIV0
 16750     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16751     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16752     MOVE X'2020233030303135353130' TO DFHEIV0(25:11)
 16753     CALL 'kxdfhei1' USING DFHEIV0,
 16754           DFHEIV1,
 16755           ACTIVITY-QUE,
 16756           DFHEIV11,
 16757           DFHEIV99
 16758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16759
 16760
 16761     GO TO 6799-EXIT.
 16762
 16763 6720-BUILD-NEW-RECORD.
 16764
 16765* EXEC CICS GETMAIN
 16766*         SET    (ADDRESS OF ACTIVITY-QUE)
 16767*         LENGTH (60)
 16768*         INITIMG(GETMAIN-SPACE)
 16769*     END-EXEC.
 16770     MOVE 60
 16771       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 321
* EL156.cbl
 16772*    MOVE ',"IL                  $   #00015518' TO DFHEIV0
 16773     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16774     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16775     MOVE X'2020233030303135353138' TO DFHEIV0(25:11)
 16776     CALL 'kxdfhei1' USING DFHEIV0,
 16777           DFHEIV20,
 16778           DFHEIV11,
 16779           GETMAIN-SPACE
 16780     SET ADDRESS OF ACTIVITY-QUE TO
 16781         DFHEIV20
 16782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16783
 16784
 16785     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16786
 16787     IF PI-AIG-SPECIAL-BENEFIT AND
 16788        PI-CASH = 'Y'
 16789         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16790     ELSE
 16791         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16792
 16793     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16794     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16795     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16796     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16797                                    AQ-FOLLOWUP-DATE.
 16798     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16799     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16800
 16801     IF PI-PMT-GRADUATED
 16802         IF WS-PMT-APPROVAL-SW = 'A'
 16803             NEXT SENTENCE
 16804         ELSE
 16805            IF PI-AIG-SPECIAL-BENEFIT AND
 16806               PI-CASH = 'Y'
 16807                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16808            ELSE
 16809                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16810     ELSE
 16811         IF PI-PMT-APPR-SW = 'Y'
 16812            IF PI-AIG-SPECIAL-BENEFIT AND
 16813               PI-CASH = 'Y'
 16814                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16815            ELSE
 16816                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16817
 16818     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16819         MOVE ER-3536 TO EMI-ERROR
 16820         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16821
 16822
 16823* EXEC CICS WRITE
 16824*         DATASET('ELACTQ')
 16825*         RIDFLD (ELMSTR-KEY)
 16826*         FROM   (ACTIVITY-QUE)
 16827*     END-EXEC.
 16828     MOVE LENGTH OF
 16829      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 322
* EL156.cbl
 16830       TO DFHEIV11
 16831     MOVE 'ELACTQ' TO DFHEIV1
 16832*    MOVE '&$ L                  ''   #00015561' TO DFHEIV0
 16833     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16834     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16835     MOVE X'2020233030303135353631' TO DFHEIV0(25:11)
 16836     CALL 'kxdfhei1' USING DFHEIV0,
 16837           DFHEIV1,
 16838           ACTIVITY-QUE,
 16839           DFHEIV11,
 16840           ELMSTR-KEY,
 16841           DFHEIV99,
 16842           DFHEIV99
 16843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16844
 16845
 16846 6799-EXIT.
 16847      EXIT.
 16848
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 323
* EL156.cbl
 16850 6800-BUILD-FORM-TRAILER.
 16851
 16852
 16853* EXEC CICS GETMAIN
 16854*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 16855*         LENGTH   (200)
 16856*         INITIMG  (GETMAIN-SPACE)
 16857*    END-EXEC.
 16858     MOVE 200
 16859       TO DFHEIV11
 16860*    MOVE ',"IL                  $   #00015573' TO DFHEIV0
 16861     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16862     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16863     MOVE X'2020233030303135353733' TO DFHEIV0(25:11)
 16864     CALL 'kxdfhei1' USING DFHEIV0,
 16865           DFHEIV20,
 16866           DFHEIV11,
 16867           GETMAIN-SPACE
 16868     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16869         DFHEIV20
 16870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16871
 16872
 16873     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 16874
 16875     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 16876     MOVE 'AT'                   TO AT-RECORD-ID.
 16877     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16878
 16879     MOVE 'A'                    TO AT-TRAILER-TYPE.
 16880     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16881                                    AT-FORM-LAST-MAINT-DT
 16882                                    AT-FORM-SEND-ON-DT.
 16883     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16884                                    AT-FORM-LAST-UPDATED-BY.
 16885     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16886     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 16887     MOVE '6'                    TO DC-OPTION-CODE.
 16888     MOVE +29                    TO DC-ELAPSED-DAYS.
 16889     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16890     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16891     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 16892
 16893     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16894         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 16895
 16896     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 16897                                    AT-FORM-RE-SEND-DT
 16898                                    AT-EMP-FORM-ANSWERED-DT
 16899                                    AT-PHY-FORM-ANSWERED-DT
 16900                                    AT-EMP-FORM-SEND-ON-DT
 16901                                    AT-PHY-FORM-SEND-ON-DT
 16902                                    AT-FORM-PRINTED-DT
 16903                                    AT-FORM-REPRINT-DT.
 16904     MOVE '2'                    TO AT-FORM-TYPE.
 16905
 16906     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 16907     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 324
* EL156.cbl
 16908
 16909     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 16910         NEXT SENTENCE
 16911     ELSE
 16912         IF CL-PROG-FORM-TYPE NOT = 'S'
 16913            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 16914
 16915
 16916* EXEC CICS WRITE
 16917*         DATASET  ('ELTRLR')
 16918*         FROM     (ACTIVITY-TRAILERS)
 16919*         RIDFLD   (AT-CONTROL-PRIMARY)
 16920*     END-EXEC.
 16921     MOVE LENGTH OF
 16922      ACTIVITY-TRAILERS
 16923       TO DFHEIV11
 16924     MOVE 'ELTRLR' TO DFHEIV1
 16925*    MOVE '&$ L                  ''   #00015621' TO DFHEIV0
 16926     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16928     MOVE X'2020233030303135363231' TO DFHEIV0(25:11)
 16929     CALL 'kxdfhei1' USING DFHEIV0,
 16930           DFHEIV1,
 16931           ACTIVITY-TRAILERS,
 16932           DFHEIV11,
 16933           AT-CONTROL-PRIMARY,
 16934           DFHEIV99,
 16935           DFHEIV99
 16936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16937
 16938
 16939 6899-EXIT.
 16940      EXIT.
 16941
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 325
* EL156.cbl
 16943 6900-BUILD-ARCHIVE-HEADER.
 16944
 16945     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16946     MOVE '1'                    TO CNTL-REC-TYPE.
 16947     MOVE +0                     TO CNTL-SEQ-NO.
 16948     MOVE SPACES                 TO CNTL-ACCESS.
 16949
 16950
 16951* EXEC CICS READ
 16952*         DATASET  ('ELCNTL')
 16953*         SET      (ADDRESS OF CONTROL-FILE)
 16954*         RIDFLD   (ELCNTL-KEY)
 16955*         UPDATE
 16956*    END-EXEC.
 16957     MOVE 'ELCNTL' TO DFHEIV1
 16958*    MOVE '&"S        EU         (   #00015638' TO DFHEIV0
 16959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16960     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16961     MOVE X'2020233030303135363338' TO DFHEIV0(25:11)
 16962     CALL 'kxdfhei1' USING DFHEIV0,
 16963           DFHEIV1,
 16964           DFHEIV20,
 16965           DFHEIV99,
 16966           ELCNTL-KEY,
 16967           DFHEIV99,
 16968           DFHEIV99,
 16969           DFHEIV99
 16970     SET ADDRESS OF CONTROL-FILE TO
 16971         DFHEIV20
 16972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16973
 16974
 16975     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 16976     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 16977
 16978
 16979* EXEC CICS REWRITE
 16980*         FROM     (CONTROL-FILE)
 16981*         DATASET  ('ELCNTL')
 16982*    END-EXEC.
 16983     MOVE LENGTH OF
 16984      CONTROL-FILE
 16985       TO DFHEIV11
 16986     MOVE 'ELCNTL' TO DFHEIV1
 16987*    MOVE '&& L                  %   #00015648' TO DFHEIV0
 16988     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16990     MOVE X'2020233030303135363438' TO DFHEIV0(25:11)
 16991     CALL 'kxdfhei1' USING DFHEIV0,
 16992           DFHEIV1,
 16993           CONTROL-FILE,
 16994           DFHEIV11,
 16995           DFHEIV99
 16996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16997
 16998
 16999
 17000* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 326
* EL156.cbl
 17001*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17002*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17003*    END-EXEC.
 17004*    MOVE '"$$%                  ! 7 #00015653' TO DFHEIV0
 17005     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17007     MOVE X'3720233030303135363533' TO DFHEIV0(25:11)
 17008     CALL 'kxdfhei1' USING DFHEIV0
 17009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17010
 17011
 17012
 17013* EXEC CICS GETMAIN
 17014*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17015*         LENGTH  (ELARCH-LENGTH)
 17016*         INITIMG (GETMAIN-SPACE)
 17017*    END-EXEC.
 17018*    MOVE ',"IL                  $   #00015658' TO DFHEIV0
 17019     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17020     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17021     MOVE X'2020233030303135363538' TO DFHEIV0(25:11)
 17022     CALL 'kxdfhei1' USING DFHEIV0,
 17023           DFHEIV20,
 17024           ELARCH-LENGTH,
 17025           GETMAIN-SPACE
 17026     SET ADDRESS OF LETTER-ARCHIVE TO
 17027         DFHEIV20
 17028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17029
 17030
 17031     MOVE 'LA'                   TO LA-RECORD-ID.
 17032     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17033                                    LA-ARCHIVE-NO-A1.
 17034     MOVE '4'                    TO LA-RECORD-TYPE
 17035                                    LA-RECORD-TYPE-A1.
 17036     MOVE +0                     TO LA-LINE-SEQ-NO
 17037                                    LA-LINE-SEQ-NO-A1.
 17038     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17039                                    LA-COMPANY-CD-A1.
 17040     MOVE CL-CARRIER             TO LA4-CARRIER.
 17041     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17042     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17043     MOVE CL-CERT-STATE          TO LA4-STATE.
 17044     MOVE +0                     TO LA4-NO-OF-COPIES.
 17045     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17046     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17047     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17048                                    LA4-INITIAL-PRINT-DATE
 17049                                    LA4-RESEND-PRINT-DATE
 17050                                    LA4-FORM-REM-PRINT-DT.
 17051     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17052     MOVE '2'                    TO LA4-FORM-TYPE.
 17053
 17054
 17055* EXEC CICS WRITE
 17056*         DATASET  ('ELARCH')
 17057*         FROM     (LETTER-ARCHIVE)
 17058*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 327
* EL156.cbl
 17059*    END-EXEC.
 17060     MOVE LENGTH OF
 17061      LETTER-ARCHIVE
 17062       TO DFHEIV11
 17063     MOVE 'ELARCH' TO DFHEIV1
 17064*    MOVE '&$ L                  ''   #00015687' TO DFHEIV0
 17065     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17066     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17067     MOVE X'2020233030303135363837' TO DFHEIV0(25:11)
 17068     CALL 'kxdfhei1' USING DFHEIV0,
 17069           DFHEIV1,
 17070           LETTER-ARCHIVE,
 17071           DFHEIV11,
 17072           LA-CONTROL-PRIMARY,
 17073           DFHEIV99,
 17074           DFHEIV99
 17075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17076
 17077
 17078 6999-EXIT.
 17079      EXIT.
 17080
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 328
* EL156.cbl
 17082 7000-SHOW-CLAIM.
 17083     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17084     MOVE 'A'                    TO PI-PASS-SW.
 17085     MOVE LOW-VALUES             TO PI-CPYFROM
 17086                                    PI-MONTH-END-SAVE
 17087                                    PI-CPYTHRU.
 17088
 17089     MOVE ZEROS                  TO PI-FATAL-COUNT
 17090                                    PI-DAILY-RATE
 17091                                    PI-BEN-DAYS
 17092                                    PI-MANUAL-SW
 17093                                    PI-SAVE-CURSOR
 17094                                    PI-FORCE-COUNT
 17095                                    PI-HOLDTIL
 17096                                    PI-EPYFROM
 17097                                    PI-EPYTHRU
 17098                                    PI-EDAYS
 17099                                    PI-EPYAMT
 17100                                    PI-ERESV
 17101                                    PI-EEXPENS
 17102                                    PI-CDAYS
 17103                                    PI-CPYAMT
 17104                                    PI-CRESV
 17105                                    PI-CEXPENS
 17106                                    PI-INT-RATE
 17107                                    PI-AIGFROM.
 17108     MOVE ZEROS                  TO PI-PROOF-DATE.
 17109     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17110                                    PI-REM-BEN-AMT
 17111                                    PI-MO-BEN-AMT
 17112                                    pi-ah-term.
 17113
 17114     MOVE LOW-VALUES             TO EL156AI.
 17115     MOVE MAP-NAMEA              TO MAP-NAME.
 17116
 17117* EXEC CICS HANDLE CONDITION
 17118*        NOTFND   (7010-BUILD-MAP)
 17119*    END-EXEC.
 17120*    MOVE '"$I                   ! 8 #00015731' TO DFHEIV0
 17121     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17122     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17123     MOVE X'3820233030303135373331' TO DFHEIV0(25:11)
 17124     CALL 'kxdfhei1' USING DFHEIV0
 17125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17126
 17127
 17128     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17129     MOVE '2'                    TO CNTL-REC-TYPE.
 17130     MOVE +0                     TO CNTL-SEQ-NO.
 17131     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17132
 17133
 17134* EXEC CICS READ
 17135*         DATASET  ('ELCNTL')
 17136*         SET      (ADDRESS OF CONTROL-FILE)
 17137*         RIDFLD   (ELCNTL-KEY)
 17138*    END-EXEC.
 17139     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 329
* EL156.cbl
 17140*    MOVE '&"S        E          (   #00015740' TO DFHEIV0
 17141     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17142     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17143     MOVE X'2020233030303135373430' TO DFHEIV0(25:11)
 17144     CALL 'kxdfhei1' USING DFHEIV0,
 17145           DFHEIV1,
 17146           DFHEIV20,
 17147           DFHEIV99,
 17148           ELCNTL-KEY,
 17149           DFHEIV99,
 17150           DFHEIV99,
 17151           DFHEIV99
 17152     SET ADDRESS OF CONTROL-FILE TO
 17153         DFHEIV20
 17154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17155
 17156
 17157     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17158
 17159     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17160         MOVE AL-UANON      TO SURVYYNA
 17161     END-IF.
 17162
 17163
 17164     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17165     MOVE '1'                    TO CNTL-REC-TYPE.
 17166     MOVE SPACES                 TO CNTL-ACCESS.
 17167     MOVE +0                     TO CNTL-SEQ-NO.
 17168
 17169
 17170* EXEC CICS READ
 17171*         DATASET  ('ELCNTL')
 17172*         SET      (ADDRESS OF CONTROL-FILE)
 17173*         RIDFLD   (ELCNTL-KEY)
 17174*    END-EXEC.
 17175     MOVE 'ELCNTL' TO DFHEIV1
 17176*    MOVE '&"S        E          (   #00015758' TO DFHEIV0
 17177     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17178     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17179     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 17180     CALL 'kxdfhei1' USING DFHEIV0,
 17181           DFHEIV1,
 17182           DFHEIV20,
 17183           DFHEIV99,
 17184           ELCNTL-KEY,
 17185           DFHEIV99,
 17186           DFHEIV99,
 17187           DFHEIV99
 17188     SET ADDRESS OF CONTROL-FILE TO
 17189         DFHEIV20
 17190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17191
 17192
 17193     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17194
 17195 7010-BUILD-MAP.
 17196
 17197
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 330
* EL156.cbl
 17198* EXEC CICS HANDLE CONDITION
 17199*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17200*    END-EXEC.
 17201*    MOVE '"$I                   ! 9 #00015768' TO DFHEIV0
 17202     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17204     MOVE X'3920233030303135373638' TO DFHEIV0(25:11)
 17205     CALL 'kxdfhei1' USING DFHEIV0
 17206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17207
 17208
 17209     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17210     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17211     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17212     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17213     MOVE 'MSTR'                 TO FILE-SWITCH.
 17214
 17215     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17216
 17217     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17218     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17219     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17220     MOVE CL-CCN                 TO PI-SV-CCN.
 17221
 17222     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17223     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17224     MOVE CL-CLAIM-NO            TO CLMNOO.
 17225     MOVE CL-CARRIER             TO CARRO.
 17226     MOVE CL-CERT-PRIME          TO CERTNOO.
 17227     MOVE CL-CERT-SFX            TO SUFXO.
 17228
 17229     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17230        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17231        CONTINUE
 17232     ELSE
 17233        MOVE AL-SADOF            TO ZINTHA
 17234                                    ZINTA
 17235                                    PINTHA
 17236                                    PINTA
 17237     END-IF
 17238     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17239     EVALUATE TRUE
 17240     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17241         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17242     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17243         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17244
 17245     WHEN CL-CLAIM-TYPE = 'I'
 17246         MOVE '  IU  '           TO CLMTYPO
 17247     WHEN CL-CLAIM-TYPE = 'G'
 17248         MOVE ' GAP  '           TO CLMTYPO
 17249     END-EVALUATE.
 17250     IF CLAIM-IS-OPEN
 17251         MOVE ' OPEN'            TO CLMSTATO
 17252     ELSE
 17253         MOVE 'CLOSED'           TO CLMSTATO.
 17254
 17255     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 331
* EL156.cbl
 17256
 17257     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17258         MOVE SPACES             TO  PCERTNOO
 17259                                     PSUFXO
 17260                                     PRIMHDGO
 17261                                     SEQUO
 17262         MOVE AL-SADOF           TO  PCERTNOA
 17263                                     PSUFXA
 17264                                     PRIMHDGA
 17265                                     SEQUA
 17266     ELSE
 17267         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17268         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17269         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17270         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17271         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17272         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17273         MOVE AL-SANON               TO  PCERTNOA
 17274                                         PSUFXA
 17275                                         PRIMHDGA
 17276         MOVE AL-SABON               TO  SEQUA.
 17277
 17278     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17279
 17280     IF CL-NO-OF-PMTS-MADE = 0 AND
 17281        CL-TOTAL-PAID-AMT = 0
 17282         NEXT SENTENCE
 17283     ELSE
 17284         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17285             IF NOT PI-USES-PAID-TO
 17286                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17287                 MOVE ' '                 TO DC-OPTION-CODE
 17288                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17289                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17290             ELSE
 17291                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17292                 MOVE '6'                 TO DC-OPTION-CODE
 17293                 MOVE +1                  TO DC-ELAPSED-DAYS
 17294                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17295                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17296                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17297
 17298     IF MAP-NAME = 'EL156A'
 17299        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17300           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17301             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17302           end-if
 17303        end-if
 17304     end-if
 17305     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17306         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17307         MOVE ' '                TO DC-OPTION-CODE
 17308         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17309         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17310
 17311     IF CL-INCURRED-DT NOT = LOW-VALUES
 17312         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17313         MOVE ' '                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 332
* EL156.cbl
 17314         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17315         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17316
 17317     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17318
 17319     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17320         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17321         MOVE ' '                TO DC-OPTION-CODE
 17322         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17323         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17324
 17325     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17326         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17327         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17328     ELSE
 17329         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17330         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17331
 17332     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17333     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17334     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17335     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17336                                    PI-GROUPING.
 17337     MOVE CL-CERT-STATE          TO CERT-STATE
 17338                                    PI-STATE.
 17339     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17340                                    PI-ACCOUNT.
 17341     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17342     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17343     MOVE 'CERT'                 TO FILE-SWITCH.
 17344
 17345     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17346     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17347        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17348        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17349            MOVE 'N' TO PI-JOINT-INSURED-IND
 17350     ELSE
 17351            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17352     END-IF.
 17353
 17354     perform 7975-read-acct      thru 7975-exit
 17355     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17356     MOVE PI-STATE               TO WS-ST-ACCESS.
 17357     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17358     MOVE '3'                    TO CNTL-REC-TYPE.
 17359     MOVE +0                     TO CNTL-SEQ-NO.
 17360     MOVE 'STAT'                 TO FILE-SWITCH.
 17361
 17362     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17363
 17364     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17365     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17366
 17367     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17368        GO TO 7020-BYPASS-BENEFIT.
 17369
 17370     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17371     MOVE '4'                    TO CNTL-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 333
* EL156.cbl
 17372     MOVE +0                     TO CNTL-SEQ-NO.
 17373     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17374     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17375     MOVE 'BENE'                 TO FILE-SWITCH.
 17376
 17377     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17378
 17379     IF NO-BENEFIT-FOUND
 17380        GO TO 7020-BYPASS-BENEFIT.
 17381
 17382     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17383     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17384     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17385
 17386 7020-BYPASS-BENEFIT.
 17387
 17388*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17389*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17390*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17391
 17392     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
 17393         GO TO 7021-GO-TO-LIFE.
 17394     move zeros                  to PI-MAX-BENEFIT-AMT
 17395     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17396     move cm-ah-orig-term        to pi-ah-term
 17397     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17398
 17399     IF (PI-COMPANY-ID = 'DCC')
 17400        and (acct-found)
 17401        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17402        PERFORM 0900-GET-DDF-limits
 17403                                 THRU 0900-EXIT
 17404        IF PDEF-FOUND
 17405           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17406              (P1 > +8)
 17407              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17408           END-PERFORM
 17409           IF P1 < +9
 17410              MOVE PD-MAX-AMT (P1)
 17411                                 TO PI-MAX-BENEFIT-AMT
 17412           END-IF
 17413        END-IF
 17414     end-if
 17415     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17416     MOVE 'MO. BENEFIT :'        TO BENECAPO.
 17417     if (pi-max-benefit-amt not = zeros)
 17418        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17419        move pi-max-benefit-amt  to beneo
 17420     else
 17421        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17422     end-if
 17423     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17424     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17425                                    CP-ORIGINAL-TERM.
 17426     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17427
 17428*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17429*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 334
* EL156.cbl
 17430*    ELSE
 17431         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17432
 17433     MOVE ' '                    TO DC-OPTION-CODE.
 17434     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17435     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17436
 17437     IF PI-COMPANY-ID = 'DMD'
 17438         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17439         GO TO 7023-BYPASS-REMAINING-TERM.
 17440
 17441     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17442     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17443     GO TO 7022-AROUND-LIFE.
 17444
 17445 7021-GO-TO-LIFE.
 17446
 17447     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17448     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17449     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17450                                    CP-ORIGINAL-TERM.
 17451     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17452     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17453     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17454     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17455
 17456     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17457         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17458     ELSE
 17459         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17460
 17461     MOVE ' '                    TO DC-OPTION-CODE.
 17462     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17463     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17464
 17465 7022-AROUND-LIFE.
 17466
 17467     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17468     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17469     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17470     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17471     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17472     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17473     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17474
 17475     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17476
 17477     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17478        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17479           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17480
 17481     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17482        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17483           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17484
 17485 7023-BYPASS-REMAINING-TERM.
 17486     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17487       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 335
* EL156.cbl
 17488          MOVE ZEROS                  TO BENEO
 17489       ELSE
 17490          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17491          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17492          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17493          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17494          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17495          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17496          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17497          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17498          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17499          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17500          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17501          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17502          IF (PI-COMPANY-ID = 'DCC')
 17503             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17504             PERFORM 0900-GET-DDF-limits
 17505                                 THRU 0900-EXIT
 17506             IF PDEF-FOUND
 17507                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17508                   (P1 > +8)
 17509                   OR (PD-PROD-CODE (P1) = 'L')
 17510                END-PERFORM
 17511                IF P1 < +9
 17512                   MOVE PD-MAX-AMT (P1)
 17513                                 TO CP-R-MAX-TOT-BEN
 17514                END-IF
 17515             END-IF
 17516          END-IF
 17517
 17518* EXEC CICS LINK
 17519*            PROGRAM  (LINK-REMAMT)
 17520*            COMMAREA (CALCULATION-PASS-AREA)
 17521*            LENGTH   (CP-COMM-LENGTH)
 17522*         END-EXEC
 17523*    MOVE '."C                   (   #00016080' TO DFHEIV0
 17524     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17526     MOVE X'2020233030303136303830' TO DFHEIV0(25:11)
 17527     CALL 'kxdfhei1' USING DFHEIV0,
 17528           LINK-REMAMT,
 17529           CALCULATION-PASS-AREA,
 17530           CP-COMM-LENGTH,
 17531           DFHEIV99,
 17532           DFHEIV99,
 17533           DFHEIV99,
 17534           DFHEIV99
 17535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17536          MOVE CP-REMAINING-AMT       TO BENEO
 17537       end-if
 17538     end-if
 17539     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17540     MOVE +95                    TO TRLR-SEQ-NO
 17541
 17542* EXEC CICS READ
 17543*       DATASET  ('ELTRLR')
 17544*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17545*       RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 336
* EL156.cbl
 17546*       RESP     (WS-RESPONSE)
 17547*    END-EXEC
 17548     MOVE 'ELTRLR' TO DFHEIV1
 17549*    MOVE '&"S        E          (  N#00016090' TO DFHEIV0
 17550     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17552     MOVE X'204E233030303136303930' TO DFHEIV0(25:11)
 17553     CALL 'kxdfhei1' USING DFHEIV0,
 17554           DFHEIV1,
 17555           DFHEIV20,
 17556           DFHEIV99,
 17557           ELTRLR-KEY,
 17558           DFHEIV99,
 17559           DFHEIV99,
 17560           DFHEIV99
 17561     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17562         DFHEIV20
 17563     MOVE EIBRESP  TO WS-RESPONSE
 17564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17565
 17566     if ws-resp-normal
 17567        perform varying s1 from +1 by +1 until
 17568           at-note-error-no (s1) = spaces
 17569           move at-note-error-no (s1)
 17570                                 to emi-error
 17571           if at-note-error-no (s1) = '1653'
 17572              evaluate true
 17573                 when cl-claim-type = 'L'
 17574                    move '  LF  '
 17575                                 to emi-claim-type
 17576                 when cl-claim-type = 'I'
 17577                    move '  IU  '
 17578                                 to emi-claim-type
 17579                 when other
 17580                    move '  AH  '
 17581                                 to emi-claim-type
 17582              end-evaluate
 17583           end-if
 17584           PERFORM 9900-ERROR-FORMAT
 17585                                 THRU 9900-EXIT
 17586        end-perform
 17587     end-if
 17588     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17589         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17590            WS-LF-COVERAGE-TYPE = 'P'
 17591             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17592                                        CM-LF-ITD-DEATH-AMT
 17593             MOVE WS-REMAINING-AMT  TO  BENEO.
 17594
 17595     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17596     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17597     MOVE WS-TERMS               TO TERMSO.
 17598
 17599     IF WS-STATUS = '6' OR '7' OR '8'
 17600         MOVE AL-SABOF           TO CRTSTATA.
 17601
 17602     IF WS-STATUS = '1' OR '4'
 17603        IF CP-REMAINING-TERM-3 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 337
* EL156.cbl
 17604           MOVE 'EXPIRED'        TO CRTSTATO
 17605        ELSE
 17606           MOVE 'ACTIVE  '       TO CRTSTATO.
 17607
 17608     IF WS-STATUS = '2'
 17609         MOVE 'PEND    '         TO CRTSTATO.
 17610
 17611     IF WS-STATUS = '3'
 17612         MOVE 'RESTORE '         TO CRTSTATO.
 17613
 17614     IF WS-STATUS = '5'
 17615         MOVE 'REISSUE '         TO CRTSTATO.
 17616
 17617     IF WS-STATUS = '6'
 17618         MOVE 'LMP DIS'          TO CRTSTATO.
 17619
 17620     IF WS-STATUS = '7'
 17621         MOVE 'DEATH'            TO CRTSTATO.
 17622
 17623     IF WS-STATUS = '8'
 17624         MOVE 'CANCEL'           TO CRTSTATO.
 17625
 17626     IF WS-STATUS = '9'
 17627         MOVE 'RE-ONLY '         TO CRTSTATO.
 17628
 17629     IF WS-STATUS = 'V'
 17630         MOVE 'VOID  '           TO CRTSTATO.
 17631
 17632     IF WS-STATUS = 'D'
 17633         MOVE 'DECLINE '         TO CRTSTATO.
 17634
 17635     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 17636         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17637         MOVE '5'                TO CNTL-REC-TYPE
 17638     ELSE
 17639         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17640         MOVE '4'                TO CNTL-REC-TYPE.
 17641
 17642     MOVE '** NONE **'           TO COVERO.
 17643     MOVE AL-SABON               TO COVERA.
 17644
 17645     IF PI-COMPANY-ID = 'CVL'
 17646         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17647             MOVE CM-BENEFICIARY TO LOANNOO
 17648             MOVE AL-UANON       TO LOANNOA.
 17649
 17650     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17651        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17652        MOVE +91                 TO  TRLR-SEQ-NO
 17653
 17654* EXEC CICS READ
 17655*           DATASET  ('ELTRLR')
 17656*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17657*           RIDFLD   (ELTRLR-KEY)
 17658*           RESP     (WS-RESPONSE)
 17659*       END-EXEC
 17660     MOVE 'ELTRLR' TO DFHEIV1
 17661*    MOVE '&"S        E          (  N#00016184' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 338
* EL156.cbl
 17662     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17663     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17664     MOVE X'204E233030303136313834' TO DFHEIV0(25:11)
 17665     CALL 'kxdfhei1' USING DFHEIV0,
 17666           DFHEIV1,
 17667           DFHEIV20,
 17668           DFHEIV99,
 17669           ELTRLR-KEY,
 17670           DFHEIV99,
 17671           DFHEIV99,
 17672           DFHEIV99
 17673     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17674         DFHEIV20
 17675     MOVE EIBRESP  TO WS-RESPONSE
 17676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17677
 17678        IF WS-RESP-NORMAL
 17679           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17680        ELSE
 17681           MOVE SPACES           TO  LOANNOO
 17682        END-IF
 17683*052506
 17684*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17685*052506
 17686     END-IF
 17687
 17688     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17689        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17690
 17691     IF WS-BEN-CD = ZEROS
 17692         GO TO 7050-SHOW-CONTINUE.
 17693
 17694     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17695     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17696     MOVE +0                     TO CNTL-SEQ-NO.
 17697     MOVE 'BENE'                 TO FILE-SWITCH.
 17698
 17699     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17700
 17701     IF BENEFIT-FOUND
 17702         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17703         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
 17704         MOVE AL-SANON                    TO COVERA.
 17705
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 339
* EL156.cbl
 17707 7050-SHOW-CONTINUE.
 17708
 17709     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17710        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17711            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17712     END-IF
 17713
 17714     IF PI-COMPANY-ID = 'DMD'
 17715         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17716
 17717     MOVE -1                     TO PMTTYPEL.
 17718     GO TO 8100-SEND-INITIAL-MAP.
 17719
 17720 7100-SHOW-RECORD-NOT-FOUND.
 17721     IF FILE-SWITCH = 'MSTR'
 17722         MOVE ER-0204            TO EMI-ERROR.
 17723
 17724     IF FILE-SWITCH = 'CERT'
 17725         MOVE ER-0206            TO EMI-ERROR.
 17726
 17727     IF FILE-SWITCH = 'STAT'
 17728         MOVE ER-0149            TO EMI-ERROR.
 17729
 17730     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17731
 17732     MOVE -1                     TO PMTTYPEL.
 17733     GO TO 8100-SEND-INITIAL-MAP
 17734
 17735     .
 17736 7110-BUILD-PMT-TRLR.
 17737     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17738     MOVE +51                    TO TRLR-SEQ-NO
 17739
 17740* EXEC CICS READ
 17741*        DATASET  ('ELTRLR')
 17742*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17743*        RIDFLD   (ELTRLR-KEY)
 17744*        RESP     (WS-RESPONSE)
 17745*    END-EXEC
 17746     MOVE 'ELTRLR' TO DFHEIV1
 17747*    MOVE '&"S        E          (  N#00016252' TO DFHEIV0
 17748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17750     MOVE X'204E233030303136323532' TO DFHEIV0(25:11)
 17751     CALL 'kxdfhei1' USING DFHEIV0,
 17752           DFHEIV1,
 17753           DFHEIV20,
 17754           DFHEIV99,
 17755           ELTRLR-KEY,
 17756           DFHEIV99,
 17757           DFHEIV99,
 17758           DFHEIV99
 17759     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17760         DFHEIV20
 17761     MOVE EIBRESP  TO WS-RESPONSE
 17762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17763     IF WS-RESP-NORMAL
 17764        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 340
* EL156.cbl
 17765     END-IF
 17766     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17767
 17768* EXEC CICS GETMAIN
 17769*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17770*         LENGTH    (200)
 17771*         INITIMG   (GETMAIN-SPACE)
 17772*     END-EXEC
 17773     MOVE 200
 17774       TO DFHEIV11
 17775*    MOVE ',"IL                  $   #00016262' TO DFHEIV0
 17776     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17777     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17778     MOVE X'2020233030303136323632' TO DFHEIV0(25:11)
 17779     CALL 'kxdfhei1' USING DFHEIV0,
 17780           DFHEIV20,
 17781           DFHEIV11,
 17782           GETMAIN-SPACE
 17783     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17784         DFHEIV20
 17785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17786     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17787                                    AT-PREV-PAID-THRU-DT
 17788     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17789     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17790     MOVE 'AT'                   TO AT-RECORD-ID
 17791     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17792     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17793     MOVE '2'                    TO AT-TRAILER-TYPE
 17794     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17795                                    AT-PAYMENT-LAST-MAINT-DT
 17796     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17797                                    AT-PAYMENT-LAST-UPDATED-BY
 17798     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17799     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17800     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17801     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17802     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17803     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17804     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17805     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17806     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17807     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17808     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17809     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17810     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17811     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17812     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17813     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17814                                    AT-TO-BE-WRITTEN-DT
 17815     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17816                                    AT-CHECK-QUE-SEQUENCE
 17817                                    AT-ADDL-RESERVE
 17818     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17819                                    AT-VOID-SELECT-DT
 17820                                    AT-VOID-ACCEPT-DT
 17821                                    AT-VOID-DT
 17822                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 341
* EL156.cbl
 17823                                    AT-INT-PMT-SELECT-DT
 17824     MOVE ZEROS                  TO AT-DAILY-RATE
 17825                                    AT-ELIMINATION-DAYS
 17826     MOVE SPACES                 TO AT-BENEFIT-TYPE
 17827*    EXEC CICS HANDLE CONDITION
 17828*        DUPREC    (7120-DUPREC)
 17829*    END-EXEC
 17830     .
 17831 7115-WRITE-INT-TRLR.
 17832
 17833* EXEC CICS WRITE
 17834*         DATASET       ('ELTRLR')
 17835*         FROM          (ACTIVITY-TRAILERS)
 17836*         RIDFLD        (AT-CONTROL-PRIMARY)
 17837*         RESP          (WS-RESPONSE)
 17838*     END-EXEC
 17839     MOVE LENGTH OF
 17840      ACTIVITY-TRAILERS
 17841       TO DFHEIV11
 17842     MOVE 'ELTRLR' TO DFHEIV1
 17843*    MOVE '&$ L                  ''  N#00016313' TO DFHEIV0
 17844     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17845     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17846     MOVE X'204E233030303136333133' TO DFHEIV0(25:11)
 17847     CALL 'kxdfhei1' USING DFHEIV0,
 17848           DFHEIV1,
 17849           ACTIVITY-TRAILERS,
 17850           DFHEIV11,
 17851           AT-CONTROL-PRIMARY,
 17852           DFHEIV99,
 17853           DFHEIV99
 17854     MOVE EIBRESP  TO WS-RESPONSE
 17855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17856      IF WS-RESP-DUPREC
 17857         GO TO 7120-DUPREC
 17858      END-IF
 17859     GO TO 7130-EXIT
 17860     .
 17861 7120-DUPREC.
 17862     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17863     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17864     GO TO 7115-WRITE-INT-TRLR
 17865     .
 17866 7130-EXIT.
 17867      EXIT.
 17868 7140-BUILD-NOTE-TRLR.
 17869
 17870
 17871* EXEC CICS GETMAIN
 17872*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17873*         LENGTH    (200)
 17874*         INITIMG   (GETMAIN-SPACE)
 17875*     END-EXEC
 17876     MOVE 200
 17877       TO DFHEIV11
 17878*    MOVE ',"IL                  $   #00016333' TO DFHEIV0
 17879     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17880     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 342
* EL156.cbl
 17881     MOVE X'2020233030303136333333' TO DFHEIV0(25:11)
 17882     CALL 'kxdfhei1' USING DFHEIV0,
 17883           DFHEIV20,
 17884           DFHEIV11,
 17885           GETMAIN-SPACE
 17886     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17887         DFHEIV20
 17888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17889     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17890     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17891     MOVE 'AT'                   TO AT-RECORD-ID
 17892     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17893     MOVE '6'                    TO AT-TRAILER-TYPE
 17894     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17895                                    AT-GEN-INFO-LAST-MAINT-DT
 17896     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17897                                    AT-GEN-INFO-LAST-UPDATED-BY
 17898     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17899     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 17900     .
 17901 7150-WRITE.
 17902
 17903* EXEC CICS HANDLE CONDITION
 17904*        DUPREC    (7160-DUPREC)
 17905*    END-EXEC
 17906*    MOVE '"$%                   ! : #00016351' TO DFHEIV0
 17907     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17909     MOVE X'3A20233030303136333531' TO DFHEIV0(25:11)
 17910     CALL 'kxdfhei1' USING DFHEIV0
 17911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17912
 17913* EXEC CICS WRITE
 17914*         DATASET     ('ELTRLR')
 17915*         FROM        (ACTIVITY-TRAILERS)
 17916*         RIDFLD      (AT-CONTROL-PRIMARY)
 17917*         RESP        (WS-RESPONSE)
 17918*     END-EXEC
 17919     MOVE LENGTH OF
 17920      ACTIVITY-TRAILERS
 17921       TO DFHEIV11
 17922     MOVE 'ELTRLR' TO DFHEIV1
 17923*    MOVE '&$ L                  ''  N#00016354' TO DFHEIV0
 17924     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17926     MOVE X'204E233030303136333534' TO DFHEIV0(25:11)
 17927     CALL 'kxdfhei1' USING DFHEIV0,
 17928           DFHEIV1,
 17929           ACTIVITY-TRAILERS,
 17930           DFHEIV11,
 17931           AT-CONTROL-PRIMARY,
 17932           DFHEIV99,
 17933           DFHEIV99
 17934     MOVE EIBRESP  TO WS-RESPONSE
 17935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17936      IF WS-RESP-DUPREC
 17937         GO TO 7160-DUPREC
 17938      END-IF
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 343
* EL156.cbl
 17939     GO TO 7170-EXIT
 17940     .
 17941 7160-DUPREC.
 17942     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 17943     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 17944     GO TO 7150-WRITE
 17945     .
 17946 7170-EXIT.
 17947      EXIT.
 17948
 17949 7180-ADD-CERT-NOTE.
 17950*ADD CERT NOTE FOR SC NP+6
 17951
 17952
 17953* EXEC CICS GETMAIN
 17954*         SET       (ADDRESS OF CERT-NOTE-FILE)
 17955*         LENGTH    (150)
 17956*         INITIMG   (GETMAIN-SPACE)
 17957*     END-EXEC.
 17958     MOVE 150
 17959       TO DFHEIV11
 17960*    MOVE ',"IL                  $   #00016376' TO DFHEIV0
 17961     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17962     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17963     MOVE X'2020233030303136333736' TO DFHEIV0(25:11)
 17964     CALL 'kxdfhei1' USING DFHEIV0,
 17965           DFHEIV20,
 17966           DFHEIV11,
 17967           GETMAIN-SPACE
 17968     SET ADDRESS OF CERT-NOTE-FILE TO
 17969         DFHEIV20
 17970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17971
 17972
 17973     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 17974     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 17975     MOVE +1                     TO WRK-NOTE-SEQ.
 17976     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 17977     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 17978     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 17979     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 17980     MOVE CL-CERT-STATE          TO CZ-STATE.
 17981     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 17982     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 17983     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 17984     MOVE '2'                    TO CZ-RECORD-TYPE.
 17985     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 17986     MOVE 'CZ'                   TO CZ-RECORD-ID.
 17987     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 17988     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 17989     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 17990     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 17991     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 17992     MOVE ' + 6 MO '             TO SC-NP6-COMM
 17993     IF PI-COMPANY-ID = 'AHL'
 17994        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 17995           CONTINUE
 17996        ELSE
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 344
* EL156.cbl
 17997           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 17998              MOVE ' + 1 MO '    TO SC-NP6-COMM
 17999           ELSE
 18000              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18001           END-IF
 18002        END-IF
 18003     END-IF
 18004     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18005     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18006
 18007 7181-WRITE.
 18008
 18009
 18010* EXEC CICS WRITE
 18011*         DATASET     ('ERCNOT')
 18012*         FROM        (CERT-NOTE-FILE)
 18013*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18014*         RESP        (WS-RESPONSE)
 18015*    END-EXEC.
 18016     MOVE LENGTH OF
 18017      CERT-NOTE-FILE
 18018       TO DFHEIV11
 18019     MOVE 'ERCNOT' TO DFHEIV1
 18020*    MOVE '&$ L                  ''  N#00016418' TO DFHEIV0
 18021     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18022     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18023     MOVE X'204E233030303136343138' TO DFHEIV0(25:11)
 18024     CALL 'kxdfhei1' USING DFHEIV0,
 18025           DFHEIV1,
 18026           CERT-NOTE-FILE,
 18027           DFHEIV11,
 18028           CZ-CONTROL-PRIMARY,
 18029           DFHEIV99,
 18030           DFHEIV99
 18031     MOVE EIBRESP  TO WS-RESPONSE
 18032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18033
 18034
 18035     IF WS-RESP-DUPREC
 18036         GO TO 7182-DUPREC
 18037     END-IF.
 18038
 18039     SET CERT-NOTE-ADDED TO TRUE.
 18040
 18041     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18042         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18043     END-IF.
 18044
 18045     GO TO 7189-EXIT.
 18046
 18047 7182-DUPREC.
 18048
 18049     ADD +1                      TO  WRK-NOTE-SEQ.
 18050     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18051     GO TO 7181-WRITE.
 18052
 18053 7189-EXIT.
 18054      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 345
* EL156.cbl
 18055
 18056 7190-ADD-ORIG-NOTE.
 18057
 18058
 18059* EXEC CICS GETMAIN
 18060*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18061*         LENGTH    (150)
 18062*         INITIMG   (GETMAIN-SPACE)
 18063*     END-EXEC.
 18064     MOVE 150
 18065       TO DFHEIV11
 18066*    MOVE ',"IL                  $   #00016448' TO DFHEIV0
 18067     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18068     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18069     MOVE X'2020233030303136343438' TO DFHEIV0(25:11)
 18070     CALL 'kxdfhei1' USING DFHEIV0,
 18071           DFHEIV20,
 18072           DFHEIV11,
 18073           GETMAIN-SPACE
 18074     SET ADDRESS OF CERT-NOTE-FILE TO
 18075         DFHEIV20
 18076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18077
 18078
 18079     ADD +1                      TO WRK-NOTE-SEQ.
 18080     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18081     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18082     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18083     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18084     MOVE CL-CERT-STATE          TO CZ-STATE.
 18085     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18086     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18087     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18088     MOVE '2'                    TO CZ-RECORD-TYPE.
 18089     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18090     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18091     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18092     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18093     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18094     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18095
 18096 7191-WRITE.
 18097
 18098
 18099* EXEC CICS WRITE
 18100*         DATASET     ('ERCNOT')
 18101*         FROM        (CERT-NOTE-FILE)
 18102*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18103*         RESP        (WS-RESPONSE)
 18104*    END-EXEC.
 18105     MOVE LENGTH OF
 18106      CERT-NOTE-FILE
 18107       TO DFHEIV11
 18108     MOVE 'ERCNOT' TO DFHEIV1
 18109*    MOVE '&$ L                  ''  N#00016473' TO DFHEIV0
 18110     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18111     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18112     MOVE X'204E233030303136343733' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 346
* EL156.cbl
 18113     CALL 'kxdfhei1' USING DFHEIV0,
 18114           DFHEIV1,
 18115           CERT-NOTE-FILE,
 18116           DFHEIV11,
 18117           CZ-CONTROL-PRIMARY,
 18118           DFHEIV99,
 18119           DFHEIV99
 18120     MOVE EIBRESP  TO WS-RESPONSE
 18121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18122
 18123
 18124     IF WS-RESP-DUPREC
 18125         GO TO 7192-DUPREC
 18126     END-IF.
 18127
 18128     GO TO 7199-EXIT.
 18129
 18130 7192-DUPREC.
 18131
 18132     ADD +1                      TO  WRK-NOTE-SEQ.
 18133     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18134     GO TO 7191-WRITE.
 18135
 18136 7199-EXIT.
 18137      EXIT.
 18138 7200-FIND-BENEFIT.
 18139     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18140
 18141
 18142* EXEC CICS HANDLE CONDITION
 18143*        ENDFILE(7200-EXIT)
 18144*        NOTFND(7200-EXIT)
 18145*    END-EXEC.
 18146*    MOVE '"$''I                  ! ; #00016497' TO DFHEIV0
 18147     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18148     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18149     MOVE X'3B20233030303136343937' TO DFHEIV0(25:11)
 18150     CALL 'kxdfhei1' USING DFHEIV0
 18151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18152
 18153
 18154
 18155* EXEC CICS READ
 18156*        DATASET('ELCNTL')
 18157*        SET(ADDRESS OF CONTROL-FILE)
 18158*        RIDFLD(ELCNTL-KEY)
 18159*        GTEQ
 18160*    END-EXEC.
 18161     MOVE 'ELCNTL' TO DFHEIV1
 18162*    MOVE '&"S        G          (   #00016502' TO DFHEIV0
 18163     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18165     MOVE X'2020233030303136353032' TO DFHEIV0(25:11)
 18166     CALL 'kxdfhei1' USING DFHEIV0,
 18167           DFHEIV1,
 18168           DFHEIV20,
 18169           DFHEIV99,
 18170           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 347
* EL156.cbl
 18171           DFHEIV99,
 18172           DFHEIV99,
 18173           DFHEIV99
 18174     SET ADDRESS OF CONTROL-FILE TO
 18175         DFHEIV20
 18176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18177
 18178
 18179     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18180        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18181           GO TO 7200-EXIT.
 18182
 18183     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18184         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18185            ((SUB-1 > 8) OR
 18186            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18187
 18188     IF SUB-1 NOT = 9
 18189         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18190
 18191     GO TO 7200-EXIT.
 18192
 18193 7200-BENEFIT-DUMMY.
 18194
 18195 7200-DUMMY-EXIT.
 18196     EXIT.
 18197
 18198 7200-EXIT.
 18199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 348
* EL156.cbl
 18201*052506
 18202*052506 7250-FIND-LETTER-TRLR.
 18203*052506     EXEC CICS HANDLE CONDITION
 18204*052506         ENDFILE  (7250-END)
 18205*052506         NOTFND   (7250-END)
 18206*052506     END-EXEC.
 18207*052506
 18208*052506     EXEC CICS STARTBR
 18209*052506         DATASET   ('ELTRLR')
 18210*052506         RIDFLD    (ELTRLR-KEY)
 18211*052506         GTEQ
 18212*052506     END-EXEC.
 18213*052506
 18214*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18215*052506
 18216*052506 7250-FIND-LOOP.
 18217*052506     EXEC CICS READNEXT
 18218*052506         DATASET   ('ELTRLR')
 18219*052506         RIDFLD    (ELTRLR-KEY)
 18220*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18221*052506     END-EXEC.
 18222*052506
 18223*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18224*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18225*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18226*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18227*052506        GO TO 7250-END
 18228*052506     END-IF.
 18229*052506
 18230*052506     IF AT-TRAILER-TYPE NOT = '4'
 18231*052506         GO TO 7250-FIND-LOOP
 18232*052506     END-IF.
 18233*052506
 18234*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18235*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18236*052506     END-IF.
 18237*052506
 18238*052506     GO TO 7250-FIND-LOOP.
 18239*052506
 18240*052506 7250-END.
 18241*052506
 18242*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18243*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18244*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18245*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18246*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18247*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18248*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18249*052506     END-IF.
 18250*052506
 18251*052506     EXEC CICS ENDBR
 18252*052506          DATASET    ('ELTRLR')
 18253*052506     END-EXEC.
 18254*052506
 18255*052506 7250-EXIT.
 18256*052506     EXIT.
 18257*052506     EJECT
 18258*052506
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 349
* EL156.cbl
 18259 7300-CHECK-AUTO-ACTIVITY.
 18260
 18261     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18262         NEXT SENTENCE
 18263     ELSE
 18264         GO TO 7399-EXIT.
 18265
 18266     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18267
 18268     IF WS-ACT-REC-FOUND-SW = 'N'
 18269         GO TO 7399-EXIT.
 18270
 18271     IF PI-ACTIVITY-CODE = 09
 18272         GO TO 7300-CONT-AUTO-ACTIVITY.
 18273
 18274     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18275        (PI-ACTIVITY-CODE = 11)
 18276         GO TO 7300-CONT-AUTO-ACTIVITY.
 18277
 18278     IF PI-PROVISIONAL-IND = 'P'
 18279         IF PI-PMTTYPE = '1'
 18280             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18281                 MOVE 'N'    TO  PI-RESET-SW
 18282                 GO TO 7399-EXIT.
 18283
 18284     IF PI-PMTTYPE = '1'
 18285         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18286             MOVE 'N'        TO  PI-RESET-SW
 18287             GO TO 7399-EXIT.
 18288
 18289     IF PI-PMTTYPE = '2' OR '3'
 18290         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18291             MOVE 'N'        TO  PI-RESET-SW
 18292             GO TO 7399-EXIT.
 18293
 18294     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18295         IF PI-PROVISIONAL-IND = 'P'
 18296             NEXT SENTENCE
 18297         ELSE
 18298             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18299
 18300 7300-CONT-AUTO-ACTIVITY.
 18301
 18302     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18303         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18304         MOVE '4'            TO DC-OPTION-CODE
 18305         MOVE +0             TO DC-ELAPSED-DAYS
 18306                                DC-ELAPSED-MONTHS
 18307         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18308         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18309         IF PI-USES-PAID-TO
 18310             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18311             IF NO-CONVERSION-ERROR
 18312                 MOVE +1     TO DC-ELAPSED-DAYS
 18313                 MOVE +0     TO DC-ELAPSED-MONTHS
 18314                 MOVE '6'    TO DC-OPTION-CODE
 18315                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18316                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 350
* EL156.cbl
 18317                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18318
 18319     IF PI-PFKEY-USED = DFHPF5
 18320         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18321         IF PI-USES-PAID-TO
 18322             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18323             MOVE +1                  TO DC-ELAPSED-DAYS
 18324             MOVE +0                  TO DC-ELAPSED-MONTHS
 18325             MOVE '6'                 TO DC-OPTION-CODE
 18326             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18327             IF NO-CONVERSION-ERROR
 18328                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18329
 18330     IF WS-CHK-THRU-DT < PI-EXP-DT
 18331         NEXT SENTENCE
 18332     ELSE
 18333         MOVE 03                     TO  WS-ACTIVITY-CODE
 18334         GO TO 7390-PROCESS-ACTIVITY.
 18335
 18336     IF PI-PROV-PMT
 18337         MOVE 09                     TO  WS-ACTIVITY-CODE
 18338     ELSE
 18339        IF PI-PMTTYPE = '1'
 18340            MOVE 02                  TO  WS-ACTIVITY-CODE
 18341        ELSE
 18342        IF PI-PMTTYPE = '2' OR '3'
 18343            MOVE 07                  TO  WS-ACTIVITY-CODE
 18344        ELSE
 18345        IF PI-PMTTYPE = '4'
 18346            MOVE 00                  TO  WS-ACTIVITY-CODE
 18347        ELSE
 18348            MOVE 'N'                 TO  PI-RESET-SW
 18349            GO TO 7399-EXIT.
 18350
 18351 7390-PROCESS-ACTIVITY.
 18352
 18353     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18354
 18355 7399-EXIT.
 18356     EXIT.
 18357
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 351
* EL156.cbl
 18359 7400-CHECK-AUTO-ACTIVITY.
 18360
 18361
 18362* EXEC CICS HANDLE CONDITION
 18363*        NOTFND   (7400-NOT-FOUND)
 18364*    END-EXEC.
 18365*    MOVE '"$I                   ! < #00016691' TO DFHEIV0
 18366     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18368     MOVE X'3C20233030303136363931' TO DFHEIV0(25:11)
 18369     CALL 'kxdfhei1' USING DFHEIV0
 18370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18371
 18372
 18373     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18374     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18375     MOVE SPACES                 TO  CNTL-ACCESS.
 18376     MOVE +0                     TO  CNTL-SEQ-NO.
 18377
 18378
 18379* EXEC CICS READ
 18380*        DATASET   ('ELCNTL')
 18381*        RIDFLD    (ELCNTL-KEY)
 18382*        SET       (ADDRESS OF CONTROL-FILE)
 18383*    END-EXEC.
 18384     MOVE 'ELCNTL' TO DFHEIV1
 18385*    MOVE '&"S        E          (   #00016700' TO DFHEIV0
 18386     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18388     MOVE X'2020233030303136373030' TO DFHEIV0(25:11)
 18389     CALL 'kxdfhei1' USING DFHEIV0,
 18390           DFHEIV1,
 18391           DFHEIV20,
 18392           DFHEIV99,
 18393           ELCNTL-KEY,
 18394           DFHEIV99,
 18395           DFHEIV99,
 18396           DFHEIV99
 18397     SET ADDRESS OF CONTROL-FILE TO
 18398         DFHEIV20
 18399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18400
 18401
 18402     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18403     GO TO 7400-EXIT.
 18404
 18405 7400-NOT-FOUND.
 18406     MOVE 'N'                        TO  PI-RESET-SW
 18407                                         WS-LETTER-SW
 18408                                         WS-ACT-REC-FOUND-SW.
 18409
 18410     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18411
 18412 7400-EXIT.
 18413     EXIT.
 18414
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 352
* EL156.cbl
 18416 7450-FORMAT-AUTO-LETTER.
 18417
 18418     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18419         MOVE 'Y'                    TO PI-RESET-SW
 18420         GO TO 7450-CONTINUE-PROCESS.
 18421
 18422     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18423
 18424     IF SUB > 9
 18425         SUBTRACT 9 FROM SUB
 18426         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18427     ELSE
 18428         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18429
 18430 7450-CONTINUE-PROCESS.
 18431
 18432     IF WS-ACTIVITY-CODE = ZEROS
 18433         MOVE 'N'                    TO  WS-LETTER-SW
 18434         GO TO 7450-EXIT.
 18435
 18436     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18437
 18438     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18439         MOVE 'N'                    TO  PI-RESET-SW
 18440                                         WS-LETTER-SW
 18441         GO TO 7450-EXIT.
 18442
 18443     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18444         MOVE 'N'                    TO  WS-LETTER-SW
 18445         GO TO 7450-EXIT.
 18446
 18447     MOVE 'Y'                        TO  WS-LETTER-SW.
 18448     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18449     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18450
 18451     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18452
 18453     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18454         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18455         MOVE '6'                    TO  DC-OPTION-CODE
 18456         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18457         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18458         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18459         IF NO-CONVERSION-ERROR
 18460             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18461         ELSE
 18462              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18463
 18464     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18465         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18466         MOVE '6'                    TO  DC-OPTION-CODE
 18467         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18468         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18469         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18470         IF NO-CONVERSION-ERROR
 18471             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18472         ELSE
 18473             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 353
* EL156.cbl
 18474
 18475 7450-EXIT.
 18476     EXIT.
 18477
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 354
* EL156.cbl
 18479 7500-RESET-AUTO-ACTIVITY.
 18480
 18481     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18482     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18483     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18484     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18485     MOVE +100                   TO  TRLR-SEQ-NO.
 18486
 18487 7500-STARTBR-TRLR.
 18488
 18489
 18490* EXEC CICS HANDLE CONDITION
 18491*        ENDFILE  (7590-END)
 18492*        NOTFND   (7590-END)
 18493*    END-EXEC.
 18494*    MOVE '"$''I                  ! = #00016793' TO DFHEIV0
 18495     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18496     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18497     MOVE X'3D20233030303136373933' TO DFHEIV0(25:11)
 18498     CALL 'kxdfhei1' USING DFHEIV0
 18499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18500
 18501
 18502
 18503* EXEC CICS STARTBR
 18504*        DATASET   ('ELTRLR')
 18505*        RIDFLD    (ELTRLR-KEY)
 18506*        GTEQ
 18507*    END-EXEC.
 18508     MOVE 'ELTRLR' TO DFHEIV1
 18509     MOVE 0
 18510       TO DFHEIV11
 18511*    MOVE '&,         G          &   #00016798' TO DFHEIV0
 18512     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18513     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18514     MOVE X'2020233030303136373938' TO DFHEIV0(25:11)
 18515     CALL 'kxdfhei1' USING DFHEIV0,
 18516           DFHEIV1,
 18517           ELTRLR-KEY,
 18518           DFHEIV99,
 18519           DFHEIV11,
 18520           DFHEIV99
 18521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18522
 18523
 18524     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18525
 18526 7500-READ-NEXT.
 18527
 18528
 18529* EXEC CICS READNEXT
 18530*        DATASET   ('ELTRLR')
 18531*        RIDFLD    (ELTRLR-KEY)
 18532*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18533*    END-EXEC.
 18534     MOVE 'ELTRLR' TO DFHEIV1
 18535     MOVE 0
 18536       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 355
* EL156.cbl
 18537*    MOVE '&.S                   )   #00016808' TO DFHEIV0
 18538     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18539     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18540     MOVE X'2020233030303136383038' TO DFHEIV0(25:11)
 18541     CALL 'kxdfhei1' USING DFHEIV0,
 18542           DFHEIV1,
 18543           DFHEIV20,
 18544           DFHEIV99,
 18545           ELTRLR-KEY,
 18546           DFHEIV99,
 18547           DFHEIV11,
 18548           DFHEIV99,
 18549           DFHEIV99
 18550     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18551         DFHEIV20
 18552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18553
 18554
 18555     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18556        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18557        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18558        PI-CERT-NO    NOT = TRLR-CERT-NO
 18559         GO TO 7590-END.
 18560
 18561     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18562         GO TO 7500-READ-NEXT.
 18563
 18564     IF AT-TRAILER-TYPE NOT = '4'
 18565         GO TO 7500-READ-NEXT.
 18566
 18567     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18568         GO TO 7500-READ-NEXT.
 18569
 18570     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18571        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18572         GO TO 7500-READ-NEXT.
 18573
 18574     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18575        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18576        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18577         GO TO 7500-READ-NEXT.
 18578
 18579     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18580                         AND
 18581        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18582                         AND
 18583        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18584            GO TO 7500-READ-NEXT.
 18585
 18586     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18587
 18588
 18589* EXEC CICS ENDBR
 18590*        DATASET   ('ELTRLR')
 18591*    END-EXEC.
 18592     MOVE 'ELTRLR' TO DFHEIV1
 18593     MOVE 0
 18594       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 356
* EL156.cbl
 18595*    MOVE '&2                    $   #00016847' TO DFHEIV0
 18596     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18597     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18598     MOVE X'2020233030303136383437' TO DFHEIV0(25:11)
 18599     CALL 'kxdfhei1' USING DFHEIV0,
 18600           DFHEIV1,
 18601           DFHEIV11,
 18602           DFHEIV99
 18603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18604
 18605
 18606     MOVE 'N'                        TO  WS-BROWSE-SW.
 18607
 18608
 18609* EXEC CICS READ
 18610*        DATASET   ('ELTRLR')
 18611*        RIDFLD    (ELTRLR-KEY)
 18612*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18613*        UPDATE
 18614*    END-EXEC.
 18615     MOVE 'ELTRLR' TO DFHEIV1
 18616*    MOVE '&"S        EU         (   #00016853' TO DFHEIV0
 18617     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18618     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18619     MOVE X'2020233030303136383533' TO DFHEIV0(25:11)
 18620     CALL 'kxdfhei1' USING DFHEIV0,
 18621           DFHEIV1,
 18622           DFHEIV20,
 18623           DFHEIV99,
 18624           ELTRLR-KEY,
 18625           DFHEIV99,
 18626           DFHEIV99,
 18627           DFHEIV99
 18628     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18629         DFHEIV20
 18630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18631
 18632
 18633     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18634
 18635     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18636         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18637     ELSE
 18638         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18639             NEXT SENTENCE
 18640         ELSE
 18641             GO TO 7500-REWRITE-TRLR.
 18642
 18643     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18644
 18645     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18646     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18647     MOVE '1'                        TO  ARCH-REC-TYPE.
 18648     MOVE +0                         TO  ARCH-SEQ.
 18649
 18650     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18651
 18652 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 357
* EL156.cbl
 18653
 18654
 18655* EXEC CICS REWRITE
 18656*        DATASET   ('ELTRLR')
 18657*        FROM      (ACTIVITY-TRAILERS)
 18658*    END-EXEC.
 18659     MOVE LENGTH OF
 18660      ACTIVITY-TRAILERS
 18661       TO DFHEIV11
 18662     MOVE 'ELTRLR' TO DFHEIV1
 18663*    MOVE '&& L                  %   #00016881' TO DFHEIV0
 18664     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18665     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18666     MOVE X'2020233030303136383831' TO DFHEIV0(25:11)
 18667     CALL 'kxdfhei1' USING DFHEIV0,
 18668           DFHEIV1,
 18669           ACTIVITY-TRAILERS,
 18670           DFHEIV11,
 18671           DFHEIV99
 18672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18673
 18674
 18675     GO TO 7500-STARTBR-TRLR.
 18676
 18677 7590-END.
 18678
 18679     IF WS-BROWSE-SW = 'Y'
 18680         MOVE 'N'                    TO  WS-BROWSE-SW
 18681
 18682* EXEC CICS ENDBR
 18683*            DATASET   ('ELTRLR')
 18684*        END-EXEC.
 18685     MOVE 'ELTRLR' TO DFHEIV1
 18686     MOVE 0
 18687       TO DFHEIV11
 18688*    MOVE '&2                    $   #00016892' TO DFHEIV0
 18689     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18690     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18691     MOVE X'2020233030303136383932' TO DFHEIV0(25:11)
 18692     CALL 'kxdfhei1' USING DFHEIV0,
 18693           DFHEIV1,
 18694           DFHEIV11,
 18695           DFHEIV99
 18696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18697
 18698
 18699 7599-EXIT.
 18700     EXIT.
 18701
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 358
* EL156.cbl
 18703 7600-READ-ARCH-UPDATE.
 18704
 18705
 18706* EXEC CICS HANDLE CONDITION
 18707*        NOTFND   (7699-EXIT)
 18708*    END-EXEC.
 18709*    MOVE '"$I                   ! > #00016902' TO DFHEIV0
 18710     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18712     MOVE X'3E20233030303136393032' TO DFHEIV0(25:11)
 18713     CALL 'kxdfhei1' USING DFHEIV0
 18714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18715
 18716
 18717
 18718* EXEC CICS READ
 18719*        DATASET   ('ELARCH')
 18720*        RIDFLD    (ELARCH-KEY)
 18721*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18722*        UPDATE
 18723*    END-EXEC.
 18724     MOVE 'ELARCH' TO DFHEIV1
 18725*    MOVE '&"S        EU         (   #00016906' TO DFHEIV0
 18726     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18727     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18728     MOVE X'2020233030303136393036' TO DFHEIV0(25:11)
 18729     CALL 'kxdfhei1' USING DFHEIV0,
 18730           DFHEIV1,
 18731           DFHEIV20,
 18732           DFHEIV99,
 18733           ELARCH-KEY,
 18734           DFHEIV99,
 18735           DFHEIV99,
 18736           DFHEIV99
 18737     SET ADDRESS OF LETTER-ARCHIVE TO
 18738         DFHEIV20
 18739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18740
 18741
 18742     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18743
 18744
 18745* EXEC CICS REWRITE
 18746*        DATASET   ('ELARCH')
 18747*        FROM      (LETTER-ARCHIVE)
 18748*    END-EXEC.
 18749     MOVE LENGTH OF
 18750      LETTER-ARCHIVE
 18751       TO DFHEIV11
 18752     MOVE 'ELARCH' TO DFHEIV1
 18753*    MOVE '&& L                  %   #00016915' TO DFHEIV0
 18754     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18755     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18756     MOVE X'2020233030303136393135' TO DFHEIV0(25:11)
 18757     CALL 'kxdfhei1' USING DFHEIV0,
 18758           DFHEIV1,
 18759           LETTER-ARCHIVE,
 18760           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 359
* EL156.cbl
 18761           DFHEIV99
 18762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18763
 18764
 18765 7699-EXIT.
 18766     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 360
* EL156.cbl
 18768 7700-GET-DCT.
 18769
 18770     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18771     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18772     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18773     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18774                                    PI-MAX-BENEFIT-AMT
 18775                                    PI-MAX-BENEFIT-PYMT
 18776                                    PI-MIN-PAYMENT-AMT
 18777                                    PI-TIME-OF-LOSS-BAL.
 18778
 18779
 18780* EXEC CICS HANDLE CONDITION
 18781*         NOTFND (5300-NOTE-NOT-FOUND)
 18782*     END-EXEC.
 18783*    MOVE '"$I                   ! ? #00016934' TO DFHEIV0
 18784     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18786     MOVE X'3F20233030303136393334' TO DFHEIV0(25:11)
 18787     CALL 'kxdfhei1' USING DFHEIV0
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18789
 18790
 18791
 18792* EXEC CICS READ
 18793*         DATASET('ERNOTE')
 18794*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18795*         RIDFLD (W-NOTE-KEY)
 18796*     END-EXEC.
 18797     MOVE 'ERNOTE' TO DFHEIV1
 18798*    MOVE '&"S        E          (   #00016938' TO DFHEIV0
 18799     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18800     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18801     MOVE X'2020233030303136393338' TO DFHEIV0(25:11)
 18802     CALL 'kxdfhei1' USING DFHEIV0,
 18803           DFHEIV1,
 18804           DFHEIV20,
 18805           DFHEIV99,
 18806           W-NOTE-KEY,
 18807           DFHEIV99,
 18808           DFHEIV99,
 18809           DFHEIV99
 18810     SET ADDRESS OF CERTIFICATE-NOTE TO
 18811         DFHEIV20
 18812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18813
 18814
 18815     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18816     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18817     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18818     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18819     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18820
 18821     IF PI-PAYEE-TYPE NOT = 'B'
 18822         GO TO 7700-EXIT.
 18823
 18824     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 18825     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 361
* EL156.cbl
 18826     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 18827
 18828     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 18829         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 18830     ELSE
 18831         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 18832
 18833     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 18834     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 18835     MOVE 'DLO006'               TO PGM-NAME.
 18836
 18837
 18838* EXEC CICS LINK
 18839*        PROGRAM    (PGM-NAME)
 18840*        COMMAREA   (DCT-COMMUNICATION-AREA)
 18841*        LENGTH     (DCT-RCRD-LENGTH)
 18842*    END-EXEC.
 18843*    MOVE '."C                   (   #00016966' TO DFHEIV0
 18844     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18846     MOVE X'2020233030303136393636' TO DFHEIV0(25:11)
 18847     CALL 'kxdfhei1' USING DFHEIV0,
 18848           PGM-NAME,
 18849           DCT-COMMUNICATION-AREA,
 18850           DCT-RCRD-LENGTH,
 18851           DFHEIV99,
 18852           DFHEIV99,
 18853           DFHEIV99,
 18854           DFHEIV99
 18855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18856
 18857
 18858     IF DCT-RETURN-CODE = 'OK'
 18859         GO TO 7700-CONT.
 18860
 18861     IF DCT-RETURN-CODE = '01' OR '02'
 18862         GO TO 7700-SET-TO-YES.
 18863
 18864     IF DCT-RETURN-CODE = '03'
 18865
 18866* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18867*    MOVE '6"R                   !   #00016979' TO DFHEIV0
 18868     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18870     MOVE X'2020233030303136393739' TO DFHEIV0(25:11)
 18871     CALL 'kxdfhei1' USING DFHEIV0
 18872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18873         MOVE ER-0951            TO EMI-ERROR
 18874         MOVE -1                 TO PMTTYPEL
 18875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18876         GO TO 8200-SEND-DATAONLY.
 18877
 18878     IF DCT-RETURN-CODE = '04'
 18879
 18880* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18881*    MOVE '6"R                   !   #00016986' TO DFHEIV0
 18882     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18883     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 362
* EL156.cbl
 18884     MOVE X'2020233030303136393836' TO DFHEIV0(25:11)
 18885     CALL 'kxdfhei1' USING DFHEIV0
 18886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18887         MOVE ER-0946            TO EMI-ERROR
 18888         MOVE -1                 TO PMTTYPEL
 18889         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18890         GO TO 8200-SEND-DATAONLY.
 18891
 18892     IF DCT-RETURN-CODE = '05'
 18893
 18894* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18895*    MOVE '6"R                   !   #00016993' TO DFHEIV0
 18896     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18898     MOVE X'2020233030303136393933' TO DFHEIV0(25:11)
 18899     CALL 'kxdfhei1' USING DFHEIV0
 18900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18901         MOVE ER-0947            TO EMI-ERROR
 18902         MOVE -1                 TO PMTTYPEL
 18903         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18904         GO TO 8200-SEND-DATAONLY.
 18905
 18906     IF DCT-RETURN-CODE = '06'
 18907
 18908* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18909*    MOVE '6"R                   !   #00017000' TO DFHEIV0
 18910     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18912     MOVE X'2020233030303137303030' TO DFHEIV0(25:11)
 18913     CALL 'kxdfhei1' USING DFHEIV0
 18914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18915         MOVE ER-0921            TO EMI-ERROR
 18916         MOVE -1                 TO PMTTYPEL
 18917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18918         GO TO 8200-SEND-DATAONLY.
 18919
 18920     IF DCT-RETURN-CODE = '07'
 18921
 18922* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18923*    MOVE '6"R                   !   #00017007' TO DFHEIV0
 18924     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18925     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18926     MOVE X'2020233030303137303037' TO DFHEIV0(25:11)
 18927     CALL 'kxdfhei1' USING DFHEIV0
 18928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18929         MOVE ER-0919            TO EMI-ERROR
 18930         MOVE -1                 TO PMTTYPEL
 18931         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18932         GO TO 8200-SEND-DATAONLY.
 18933
 18934     IF DCT-RETURN-CODE = '08'
 18935
 18936* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18937*    MOVE '6"R                   !   #00017014' TO DFHEIV0
 18938     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18939     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18940     MOVE X'2020233030303137303134' TO DFHEIV0(25:11)
 18941     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 363
* EL156.cbl
 18942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18943         MOVE ER-0948            TO EMI-ERROR
 18944         MOVE -1                 TO PMTTYPEL
 18945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18946         GO TO 8200-SEND-DATAONLY.
 18947
 18948     IF DCT-RETURN-CODE = 'N1'
 18949
 18950* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18951*    MOVE '6"R                   !   #00017021' TO DFHEIV0
 18952     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18953     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18954     MOVE X'2020233030303137303231' TO DFHEIV0(25:11)
 18955     CALL 'kxdfhei1' USING DFHEIV0
 18956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18957         MOVE ER-0950            TO EMI-ERROR
 18958         MOVE -1                 TO PMTTYPEL
 18959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18960         GO TO 8200-SEND-DATAONLY.
 18961
 18962     IF DCT-RETURN-CODE = 'E1'
 18963
 18964* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18965*    MOVE '6"R                   !   #00017028' TO DFHEIV0
 18966     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18967     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18968     MOVE X'2020233030303137303238' TO DFHEIV0(25:11)
 18969     CALL 'kxdfhei1' USING DFHEIV0
 18970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18971         MOVE ER-0974            TO EMI-ERROR
 18972         MOVE -1                 TO PMTTYPEL
 18973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18974         GO TO 8200-SEND-DATAONLY.
 18975
 18976     IF DCT-RETURN-CODE = 'E2'
 18977
 18978* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18979*    MOVE '6"R                   !   #00017035' TO DFHEIV0
 18980     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18981     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18982     MOVE X'2020233030303137303335' TO DFHEIV0(25:11)
 18983     CALL 'kxdfhei1' USING DFHEIV0
 18984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18985         MOVE ER-0975            TO EMI-ERROR
 18986         MOVE -1                 TO PMTTYPEL
 18987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18988         GO TO 8200-SEND-DATAONLY.
 18989
 18990     IF DCT-RETURN-CODE NOT = 'OK'
 18991
 18992* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 18993*    MOVE '6"R                   !   #00017042' TO DFHEIV0
 18994     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 18995     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18996     MOVE X'2020233030303137303432' TO DFHEIV0(25:11)
 18997     CALL 'kxdfhei1' USING DFHEIV0
 18998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18999         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 364
* EL156.cbl
 19000         MOVE -1                 TO PMTTYPEL
 19001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19002         GO TO 8200-SEND-DATAONLY.
 19003
 19004 7700-CONT.
 19005
 19006*    MOVE 'N'                    TO CASHO.
 19007*    MOVE +1                     TO CASHL.
 19008*    MOVE AL-UANON               TO CASHA.
 19009
 19010     IF PI-OFFLINE = 'Y'
 19011         GO TO 7700-EXIT.
 19012
 19013     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19014     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19015     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19016     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19017     MOVE +7                     TO CHECKNOL.
 19018     MOVE AL-UANON               TO CHECKNOA.
 19019     GO TO 7700-EXIT.
 19020
 19021 7700-SET-TO-YES.
 19022
 19023*    MOVE 'Y'                    TO CASHO.
 19024*    MOVE +1                     TO CASHL.
 19025*    MOVE AL-UANON               TO CASHA.
 19026
 19027 7700-EXIT.
 19028     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 365
* EL156.cbl
 19030 7800-READ-COMP-MSTR.
 19031
 19032
 19033* EXEC CICS HANDLE CONDITION
 19034*        NOTFND   (7800-COMP-NOTFND)
 19035*    END-EXEC.
 19036*    MOVE '"$I                   ! @ #00017076' TO DFHEIV0
 19037     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19038     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19039     MOVE X'4020233030303137303736' TO DFHEIV0(25:11)
 19040     CALL 'kxdfhei1' USING DFHEIV0
 19041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19042
 19043
 19044
 19045* EXEC CICS READ
 19046*        DATASET   ('ERCOMP')
 19047*        RIDFLD    (ERCOMP-KEY)
 19048*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19049*    END-EXEC.
 19050     MOVE 'ERCOMP' TO DFHEIV1
 19051*    MOVE '&"S        E          (   #00017080' TO DFHEIV0
 19052     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19053     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19054     MOVE X'2020233030303137303830' TO DFHEIV0(25:11)
 19055     CALL 'kxdfhei1' USING DFHEIV0,
 19056           DFHEIV1,
 19057           DFHEIV20,
 19058           DFHEIV99,
 19059           ERCOMP-KEY,
 19060           DFHEIV99,
 19061           DFHEIV99,
 19062           DFHEIV99
 19063     SET ADDRESS OF COMPENSATION-MASTER TO
 19064         DFHEIV20
 19065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19066
 19067
 19068     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19069     GO TO 7800-COMP-EXIT.
 19070
 19071 7800-COMP-NOTFND.
 19072     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19073
 19074 7800-COMP-EXIT.
 19075     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 366
* EL156.cbl
 19077 7900-READ-CLAIM.
 19078
 19079* EXEC CICS READ
 19080*        DATASET  ('ELMSTR')
 19081*        SET      (ADDRESS OF CLAIM-MASTER)
 19082*        RIDFLD   (ELMSTR-KEY)
 19083*    END-EXEC.
 19084     MOVE 'ELMSTR' TO DFHEIV1
 19085*    MOVE '&"S        E          (   #00017096' TO DFHEIV0
 19086     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19087     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19088     MOVE X'2020233030303137303936' TO DFHEIV0(25:11)
 19089     CALL 'kxdfhei1' USING DFHEIV0,
 19090           DFHEIV1,
 19091           DFHEIV20,
 19092           DFHEIV99,
 19093           ELMSTR-KEY,
 19094           DFHEIV99,
 19095           DFHEIV99,
 19096           DFHEIV99
 19097     SET ADDRESS OF CLAIM-MASTER TO
 19098         DFHEIV20
 19099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19100
 19101
 19102 7900-EXIT.
 19103      EXIT.
 19104
 19105 7910-READ-CLAIM-UPDATE.
 19106
 19107* EXEC CICS READ
 19108*        DATASET  ('ELMSTR')
 19109*        SET      (ADDRESS OF CLAIM-MASTER)
 19110*        RIDFLD   (ELMSTR-KEY)
 19111*        UPDATE
 19112*    END-EXEC.
 19113     MOVE 'ELMSTR' TO DFHEIV1
 19114*    MOVE '&"S        EU         (   #00017106' TO DFHEIV0
 19115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19117     MOVE X'2020233030303137313036' TO DFHEIV0(25:11)
 19118     CALL 'kxdfhei1' USING DFHEIV0,
 19119           DFHEIV1,
 19120           DFHEIV20,
 19121           DFHEIV99,
 19122           ELMSTR-KEY,
 19123           DFHEIV99,
 19124           DFHEIV99,
 19125           DFHEIV99
 19126     SET ADDRESS OF CLAIM-MASTER TO
 19127         DFHEIV20
 19128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19129
 19130
 19131 7910-EXIT.
 19132      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 367
* EL156.cbl
 19134 7920-READ-BENE.
 19135     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19136     MOVE 'B'                TO BENE-RECORD-TYPE.
 19137     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19138
 19139     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19140        IF PI-PAYEE-TYPE    = 'B' AND
 19141           PI-PAYEE-SEQ-NUM = 9
 19142             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19143             MOVE WS-A-BENE           TO BENE-NUMBER.
 19144
 19145
 19146* EXEC CICS HANDLE CONDITION
 19147*        NOTFND   (7920-NOT-FOUND)
 19148*    END-EXEC.
 19149*    MOVE '"$I                   ! A #00017127' TO DFHEIV0
 19150     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19152     MOVE X'4120233030303137313237' TO DFHEIV0(25:11)
 19153     CALL 'kxdfhei1' USING DFHEIV0
 19154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19155
 19156
 19157
 19158* EXEC CICS READ
 19159*        DATASET  ('ELBENE')
 19160*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19161*        RIDFLD   (ELBENE-KEY)
 19162*    END-EXEC.
 19163     MOVE 'ELBENE' TO DFHEIV1
 19164*    MOVE '&"S        E          (   #00017131' TO DFHEIV0
 19165     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19167     MOVE X'2020233030303137313331' TO DFHEIV0(25:11)
 19168     CALL 'kxdfhei1' USING DFHEIV0,
 19169           DFHEIV1,
 19170           DFHEIV20,
 19171           DFHEIV99,
 19172           ELBENE-KEY,
 19173           DFHEIV99,
 19174           DFHEIV99,
 19175           DFHEIV99
 19176     SET ADDRESS OF BENEFICIARY-MASTER TO
 19177         DFHEIV20
 19178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19179
 19180
 19181     MOVE 'Y' TO BENE-FOUND-SW.
 19182     GO TO 7920-EXIT.
 19183
 19184 7920-NOT-FOUND.
 19185     MOVE 'N'                    TO BENE-FOUND-SW.
 19186
 19187 7920-EXIT.
 19188      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 368
* EL156.cbl
 19190 7930-READ-CONTROL.
 19191
 19192* EXEC CICS READ
 19193*        DATASET  ('ELCNTL')
 19194*        SET      (ADDRESS OF CONTROL-FILE)
 19195*        RIDFLD   (ELCNTL-KEY)
 19196*    END-EXEC.
 19197     MOVE 'ELCNTL' TO DFHEIV1
 19198*    MOVE '&"S        E          (   #00017147' TO DFHEIV0
 19199     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19200     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19201     MOVE X'2020233030303137313437' TO DFHEIV0(25:11)
 19202     CALL 'kxdfhei1' USING DFHEIV0,
 19203           DFHEIV1,
 19204           DFHEIV20,
 19205           DFHEIV99,
 19206           ELCNTL-KEY,
 19207           DFHEIV99,
 19208           DFHEIV99,
 19209           DFHEIV99
 19210     SET ADDRESS OF CONTROL-FILE TO
 19211         DFHEIV20
 19212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19213
 19214
 19215 7930-EXIT.
 19216      EXIT.
 19217
 19218 7940-READ-CONTROL-UPDATE.
 19219
 19220* EXEC CICS READ
 19221*        DATASET  ('ELCNTL')
 19222*        SET      (ADDRESS OF CONTROL-FILE)
 19223*        RIDFLD   (ELCNTL-KEY)
 19224*        UPDATE
 19225*    END-EXEC.
 19226     MOVE 'ELCNTL' TO DFHEIV1
 19227*    MOVE '&"S        EU         (   #00017157' TO DFHEIV0
 19228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19229     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303137313537' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0,
 19232           DFHEIV1,
 19233           DFHEIV20,
 19234           DFHEIV99,
 19235           ELCNTL-KEY,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99
 19239     SET ADDRESS OF CONTROL-FILE TO
 19240         DFHEIV20
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244 7940-EXIT.
 19245      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 369
* EL156.cbl
 19247 7950-READ-TRAILER.
 19248
 19249* EXEC CICS READ
 19250*        DATASET  ('ELTRLR')
 19251*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19252*        RIDFLD   (ELTRLR-KEY)
 19253*    END-EXEC.
 19254     MOVE 'ELTRLR' TO DFHEIV1
 19255*    MOVE '&"S        E          (   #00017168' TO DFHEIV0
 19256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19257     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19258     MOVE X'2020233030303137313638' TO DFHEIV0(25:11)
 19259     CALL 'kxdfhei1' USING DFHEIV0,
 19260           DFHEIV1,
 19261           DFHEIV20,
 19262           DFHEIV99,
 19263           ELTRLR-KEY,
 19264           DFHEIV99,
 19265           DFHEIV99,
 19266           DFHEIV99
 19267     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19268         DFHEIV20
 19269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19270
 19271
 19272 7950-EXIT.
 19273      EXIT.
 19274
 19275 7960-READ-TRAILER-UPDATE.
 19276
 19277* EXEC CICS READ
 19278*        DATASET  ('ELTRLR')
 19279*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19280*        RIDFLD   (ELTRLR-KEY)
 19281*        UPDATE
 19282*    END-EXEC.
 19283     MOVE 'ELTRLR' TO DFHEIV1
 19284*    MOVE '&"S        EU         (   #00017178' TO DFHEIV0
 19285     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19286     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19287     MOVE X'2020233030303137313738' TO DFHEIV0(25:11)
 19288     CALL 'kxdfhei1' USING DFHEIV0,
 19289           DFHEIV1,
 19290           DFHEIV20,
 19291           DFHEIV99,
 19292           ELTRLR-KEY,
 19293           DFHEIV99,
 19294           DFHEIV99,
 19295           DFHEIV99
 19296     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19297         DFHEIV20
 19298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19299
 19300
 19301 7960-EXIT.
 19302      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 370
* EL156.cbl
 19304 7970-READ-CERT.
 19305
 19306* EXEC CICS READ
 19307*        DATASET  ('ELCERT')
 19308*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19309*        RIDFLD   (ELCERT-KEY)
 19310*    END-EXEC.
 19311     MOVE 'ELCERT' TO DFHEIV1
 19312*    MOVE '&"S        E          (   #00017189' TO DFHEIV0
 19313     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19314     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19315     MOVE X'2020233030303137313839' TO DFHEIV0(25:11)
 19316     CALL 'kxdfhei1' USING DFHEIV0,
 19317           DFHEIV1,
 19318           DFHEIV20,
 19319           DFHEIV99,
 19320           ELCERT-KEY,
 19321           DFHEIV99,
 19322           DFHEIV99,
 19323           DFHEIV99
 19324     SET ADDRESS OF CERTIFICATE-MASTER TO
 19325         DFHEIV20
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329 7970-EXIT.
 19330      EXIT.
 19331 7975-read-acct.
 19332
 19333     move spaces              to WS-ACCT-RECORD-SW
 19334                                 pi-dcc-product-code
 19335
 19336     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19337     MOVE PI-CARRIER          TO ACCT-CARRIER
 19338     MOVE PI-GROUPING         TO ACCT-GROUPING
 19339     MOVE PI-STATE            TO ACCT-STATE
 19340     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19341     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19342     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19343     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19344
 19345
 19346* EXEC CICS READ
 19347*       DATASET ('ERACCT')
 19348*       RIDFLD  (ERACCT-KEY)
 19349*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19350*       GTEQ
 19351*       resp    (WS-RESPONSE)
 19352*    END-EXEC
 19353     MOVE 'ERACCT' TO DFHEIV1
 19354*    MOVE '&"S        G          (  N#00017211' TO DFHEIV0
 19355     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19356     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19357     MOVE X'204E233030303137323131' TO DFHEIV0(25:11)
 19358     CALL 'kxdfhei1' USING DFHEIV0,
 19359           DFHEIV1,
 19360           DFHEIV20,
 19361           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 371
* EL156.cbl
 19362           ERACCT-KEY,
 19363           DFHEIV99,
 19364           DFHEIV99,
 19365           DFHEIV99
 19366     SET ADDRESS OF ACCOUNT-MASTER TO
 19367         DFHEIV20
 19368     MOVE EIBRESP  TO WS-RESPONSE
 19369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19370     IF WS-RESP-NORMAL
 19371        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19372        and pi-cert-eff-dt < am-expiration-dt
 19373        and pi-cert-eff-dt >= am-effective-dt
 19374        move am-dcc-product-code to pi-dcc-product-code
 19375        set acct-found to true
 19376     end-if
 19377
 19378     .
 19379 7975-exit.
 19380     exit.
 19381 7980-READ-CERT-UPDATE.
 19382
 19383* EXEC CICS READ
 19384*        DATASET  ('ELCERT')
 19385*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19386*        RIDFLD   (ELCERT-KEY)
 19387*        UPDATE
 19388*    END-EXEC.
 19389     MOVE 'ELCERT' TO DFHEIV1
 19390*    MOVE '&"S        EU         (   #00017230' TO DFHEIV0
 19391     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19392     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19393     MOVE X'2020233030303137323330' TO DFHEIV0(25:11)
 19394     CALL 'kxdfhei1' USING DFHEIV0,
 19395           DFHEIV1,
 19396           DFHEIV20,
 19397           DFHEIV99,
 19398           ELCERT-KEY,
 19399           DFHEIV99,
 19400           DFHEIV99,
 19401           DFHEIV99
 19402     SET ADDRESS OF CERTIFICATE-MASTER TO
 19403         DFHEIV20
 19404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19405
 19406
 19407 7980-EXIT.
 19408      EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 372
* EL156.cbl
 19410 8000-LOAD-ERROR-MESSAGES.
 19411     IF PI-PASS-SW = 'C'
 19412        MOVE EMI-LINE1           TO ERMSG1BO
 19413     ELSE
 19414        MOVE EMI-LINE1           TO ERRMSG1O
 19415        MOVE EMI-LINE2           TO ERRMSG2O.
 19416
 19417 8000-EXIT.
 19418     EXIT.
 19419
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 373
* EL156.cbl
 19421
 19422 8010-DMD-ERROR-CHECKS.
 19423     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19424
 19425     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19426         GO TO 8051-ISSUE-ERROR.
 19427
 19428     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19429     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19430     MOVE '3'                    TO DC-OPTION-CODE.
 19431     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19432     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19433         GO TO 8051-ISSUE-ERROR.
 19434
 19435     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19436       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19437                           OR
 19438          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19439           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19440             MOVE ER-0851         TO EMI-ERROR
 19441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19442       END-IF
 19443       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19444             MOVE ER-8147         TO EMI-ERROR
 19445             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19446
 19447     GO TO 8090-EXIT.
 19448
 19449 8051-ISSUE-ERROR.
 19450     MOVE ER-8146            TO EMI-ERROR.
 19451     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19452     GO TO 8090-EXIT.
 19453
 19454 8090-EXIT.
 19455      EXIT.
 19456
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 374
* EL156.cbl
 19458 8100-SEND-INITIAL-MAP.
 19459
 19460     MOVE SAVE-DATE              TO RUNDTEAO.
 19461     MOVE EIBTIME                TO TIME-IN.
 19462     MOVE TIME-OUT               TO RUNTIMAO.
 19463     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19464
 19465     IF MAP-NAME = 'EL156A'
 19466        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19467           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19468        END-IF
 19469     END-IF
 19470*    IF MAP-NAME = 'EL156A'
 19471*       IF PI-COMPANY-ID = 'CRI'
 19472*          NEXT SENTENCE
 19473*       ELSE
 19474*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19475
 19476     IF MAP-NAME = 'EL156A'
 19477        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19478           NEXT SENTENCE
 19479        ELSE
 19480           MOVE AL-SADOF TO  PINTA    PINTHA.
 19481
 19482     IF MAP-NAME = 'EL156A'
 19483        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19484            NEXT SENTENCE
 19485        ELSE
 19486           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19487
 19488*    IF MAP-NAME = 'EL156A'
 19489*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19490*          NEXT SENTENCE
 19491*       ELSE
 19492*          MOVE AL-SADOF TO CASHHA CASHA.
 19493
 19494     IF MAP-NAME = 'EL156A'
 19495        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19496           NEXT SENTENCE
 19497        ELSE
 19498           MOVE AL-SADOF        TO  LOANHA
 19499                                    LOANNOA.
 19500
 19501     IF MAP-NAME = 'EL156A'
 19502        MOVE -1                 TO  ENTERPFL
 19503        IF PI-USES-PAID-TO
 19504           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19505           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19506           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19507        ELSE
 19508           NEXT SENTENCE
 19509     ELSE
 19510        IF MAP-NAME = 'EL156B'
 19511           IF PI-USES-PAID-TO
 19512              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19513              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19514
 19515
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 375
* EL156.cbl
 19516* EXEC CICS SEND
 19517*        MAP   (MAP-NAME)
 19518*        MAPSET(MAPSET-NAME)
 19519*        FROM  (EL156AI)
 19520*        ERASE
 19521*        CURSOR
 19522*    END-EXEC.
 19523     MOVE LENGTH OF
 19524      EL156AI
 19525       TO DFHEIV12
 19526     MOVE -1
 19527       TO DFHEIV11
 19528*    MOVE '8$     CT  E    H L F ,   #00017345' TO DFHEIV0
 19529     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19530     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19531     MOVE X'2020233030303137333435' TO DFHEIV0(25:11)
 19532     CALL 'kxdfhei1' USING DFHEIV0,
 19533           MAP-NAME,
 19534           EL156AI,
 19535           DFHEIV12,
 19536           MAPSET-NAME,
 19537           DFHEIV99,
 19538           DFHEIV99,
 19539           DFHEIV99,
 19540           DFHEIV11,
 19541           DFHEIV99,
 19542           DFHEIV99,
 19543           DFHEIV99
 19544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19545
 19546
 19547     GO TO 9100-RETURN-TRAN.
 19548
 19549 8200-SEND-DATAONLY.
 19550
 19551     IF FIRST-ENTRY = 'Y'
 19552         GO TO 8100-SEND-INITIAL-MAP.
 19553
 19554     IF RETURNED-FROM-B = 'Y'
 19555         GO TO 8100-SEND-INITIAL-MAP.
 19556
 19557     MOVE SAVE-DATE              TO RUNDTEAO.
 19558     MOVE EIBTIME                TO TIME-IN.
 19559     MOVE TIME-OUT               TO RUNTIMAO.
 19560
 19561     IF EIBAID = DFHPF11
 19562        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19564        MOVE 'EL001   '          TO RETURNED-FROM
 19565        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19566        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19567        GO TO 8100-SEND-INITIAL-MAP.
 19568
 19569     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19570
 19571     IF MAP-NAME =  'EL156A'
 19572        MOVE -1                 TO  ENTERPFL
 19573        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 376
* EL156.cbl
 19574           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19575           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19576           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19577        ELSE
 19578           NEXT SENTENCE
 19579     ELSE
 19580        IF MAP-NAME = 'EL156B'
 19581           IF PI-USES-PAID-TO
 19582              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19583              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19584
 19585     IF MAP-NAME =  'EL156A'
 19586        IF PI-COMPANY-ID = 'BOA'
 19587            IF PI-INT-RATE NUMERIC
 19588                MOVE PI-INT-RATE TO PINTO.
 19589     IF MAP-NAME = 'EL156A'
 19590        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19591           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19592*          MOVE 'Y'              TO EOBYNO
 19593        END-IF
 19594     END-IF
 19595
 19596
 19597* EXEC CICS SEND
 19598*        MAP   (MAP-NAME)
 19599*        MAPSET(MAPSET-NAME)
 19600*        FROM  (EL156AI)
 19601*        DATAONLY
 19602*        CURSOR
 19603*    END-EXEC.
 19604     MOVE LENGTH OF
 19605      EL156AI
 19606       TO DFHEIV12
 19607     MOVE -1
 19608       TO DFHEIV11
 19609*    MOVE '8$D    CT       H L F ,   #00017402' TO DFHEIV0
 19610     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19611     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19612     MOVE X'2020233030303137343032' TO DFHEIV0(25:11)
 19613     CALL 'kxdfhei1' USING DFHEIV0,
 19614           MAP-NAME,
 19615           EL156AI,
 19616           DFHEIV12,
 19617           MAPSET-NAME,
 19618           DFHEIV99,
 19619           DFHEIV99,
 19620           DFHEIV99,
 19621           DFHEIV11,
 19622           DFHEIV99,
 19623           DFHEIV99,
 19624           DFHEIV99
 19625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19626
 19627
 19628     GO TO 9100-RETURN-TRAN.
 19629
 19630 8300-SEND-TEXT.
 19631
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 377
* EL156.cbl
 19632* EXEC CICS SEND TEXT
 19633*        FROM(LOGOFF-TEXT)
 19634*        LENGTH(LOGOFF-LENGTH)
 19635*        ERASE
 19636*        FREEKB
 19637*    END-EXEC.
 19638*    MOVE '8&      T  E F  H   F -   #00017413' TO DFHEIV0
 19639     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19640     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19641     MOVE X'2020233030303137343133' TO DFHEIV0(25:11)
 19642     CALL 'kxdfhei1' USING DFHEIV0,
 19643           LOGOFF-TEXT,
 19644           LOGOFF-LENGTH,
 19645           DFHEIV99,
 19646           DFHEIV99,
 19647           DFHEIV99,
 19648           DFHEIV99,
 19649           DFHEIV99,
 19650           DFHEIV99,
 19651           DFHEIV99,
 19652           DFHEIV99,
 19653           DFHEIV99,
 19654           DFHEIV99
 19655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19656
 19657
 19658
 19659* EXEC CICS RETURN
 19660*    END-EXEC.
 19661*    MOVE '.(                    ''   #00017420' TO DFHEIV0
 19662     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19663     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19664     MOVE X'2020233030303137343230' TO DFHEIV0(25:11)
 19665     CALL 'kxdfhei1' USING DFHEIV0,
 19666           DFHEIV99,
 19667           DFHEIV99,
 19668           DFHEIV99,
 19669           DFHEIV99,
 19670           DFHEIV99,
 19671           DFHEIV99
 19672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19673
 19674
 19675 8500-FILE-NOTOPEN.
 19676     IF FILE-SWITCH = 'MSTR'
 19677         MOVE ER-0154            TO EMI-ERROR.
 19678     IF FILE-SWITCH = 'TRLR'
 19679         MOVE ER-0172            TO EMI-ERROR.
 19680     IF FILE-SWITCH = 'CERT'
 19681         MOVE ER-0169            TO EMI-ERROR.
 19682     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19683                      'PROC' OR 'STAT'
 19684         MOVE ER-0042            TO EMI-ERROR.
 19685     IF FILE-SWITCH = 'ACTQ'
 19686         MOVE ER-0338            TO EMI-ERROR.
 19687     IF FILE-SWITCH = 'ACCT'
 19688         MOVE ER-0168            TO EMI-ERROR.
 19689
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 378
* EL156.cbl
 19690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19691     MOVE -1                     TO PMTTYPEL.
 19692
 19693     IF FIRST-ENTRY = 'Y'
 19694         GO TO 8100-SEND-INITIAL-MAP.
 19695
 19696     GO TO 8200-SEND-DATAONLY.
 19697
 19698 8600-PGRM-NOT-FOUND.
 19699
 19700     MOVE ER-0923                TO EMI-ERROR.
 19701     MOVE -1                     TO ENTPFBL.
 19702     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19703
 19704     IF FIRST-ENTRY = 'Y'
 19705         GO TO 8100-SEND-INITIAL-MAP
 19706     ELSE
 19707         GO TO 8200-SEND-DATAONLY.
 19708
 19709 8800-UNAUTHORIZED-ACCESS.
 19710     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19711     GO TO 8300-SEND-TEXT.
 19712
 19713 8810-PF23.
 19714     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19715     MOVE XCTL-005               TO PGM-NAME.
 19716     GO TO 9300-XCTL.
 19717
 19718 8820-PF7-8.
 19719     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19720     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19721                                    PI-SAVED-PROGRAM-2
 19722                                    PI-SAVED-PROGRAM-3
 19723                                    PI-SAVED-PROGRAM-4
 19724                                    PI-SAVED-PROGRAM-5
 19725                                    PI-SAVED-PROGRAM-6
 19726                                    PI-RETURN-TO-PROGRAM.
 19727     IF EIBAID = DFHPF8
 19728        MOVE XCTL-132            TO PGM-NAME
 19729     ELSE
 19730        MOVE XCTL-130            TO PGM-NAME.
 19731
 19732     GO TO 9300-XCTL.
 19733
 19734 9100-RETURN-TRAN.
 19735     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19736     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19737
 19738
 19739* EXEC CICS RETURN
 19740*        TRANSID(TRANS-ID)
 19741*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19742*        LENGTH(PI-COMM-LENGTH)
 19743*    END-EXEC.
 19744*    MOVE '.(CT                  ''   #00017486' TO DFHEIV0
 19745     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19746     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19747     MOVE X'2020233030303137343836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 379
* EL156.cbl
 19748     CALL 'kxdfhei1' USING DFHEIV0,
 19749           TRANS-ID,
 19750           PROGRAM-INTERFACE-BLOCK,
 19751           PI-COMM-LENGTH,
 19752           DFHEIV99,
 19753           DFHEIV99,
 19754           DFHEIV99
 19755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19756
 19757
 19758 9200-RETURN-MAIN-MENU.
 19759     MOVE XCTL-126               TO PGM-NAME.
 19760     GO TO 9300-XCTL.
 19761
 19762 9300-XCTL.
 19763
 19764* EXEC CICS XCTL
 19765*        PROGRAM(PGM-NAME)
 19766*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19767*        LENGTH(PI-COMM-LENGTH)
 19768*    END-EXEC.
 19769*    MOVE '.$C                   %   #00017497' TO DFHEIV0
 19770     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19771     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19772     MOVE X'2020233030303137343937' TO DFHEIV0(25:11)
 19773     CALL 'kxdfhei1' USING DFHEIV0,
 19774           PGM-NAME,
 19775           PROGRAM-INTERFACE-BLOCK,
 19776           PI-COMM-LENGTH,
 19777           DFHEIV99
 19778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19779
 19780
 19781 9400-CLEAR.
 19782     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19783     GO TO 9300-XCTL.
 19784
 19785 9500-PF12.
 19786     MOVE XCTL-010               TO PGM-NAME.
 19787     GO TO 9300-XCTL.
 19788
 19789 9700-LINK-DATE-CONVERT.
 19790     MOVE LINK-ELDATCV           TO PGM-NAME.
 19791
 19792* EXEC CICS LINK
 19793*        PROGRAM   (PGM-NAME)
 19794*        COMMAREA  (DATE-CONVERSION-DATA)
 19795*        LENGTH    (DC-COMM-LENGTH)
 19796*    END-EXEC.
 19797*    MOVE '."C                   (   #00017513' TO DFHEIV0
 19798     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19799     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19800     MOVE X'2020233030303137353133' TO DFHEIV0(25:11)
 19801     CALL 'kxdfhei1' USING DFHEIV0,
 19802           PGM-NAME,
 19803           DATE-CONVERSION-DATA,
 19804           DC-COMM-LENGTH,
 19805           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 380
* EL156.cbl
 19806           DFHEIV99,
 19807           DFHEIV99,
 19808           DFHEIV99
 19809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19810
 19811
 19812 9700-EXIT.
 19813     EXIT.
 19814
 19815 9800-LINK-REM-TERM.
 19816     MOVE LINK-REMTERM TO PGM-NAME.
 19817
 19818
 19819* EXEC CICS LINK
 19820*        PROGRAM   (PGM-NAME)
 19821*        COMMAREA  (CALCULATION-PASS-AREA)
 19822*        LENGTH    (CP-COMM-LENGTH)
 19823*    END-EXEC.
 19824*    MOVE '."C                   (   #00017525' TO DFHEIV0
 19825     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19826     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19827     MOVE X'2020233030303137353235' TO DFHEIV0(25:11)
 19828     CALL 'kxdfhei1' USING DFHEIV0,
 19829           PGM-NAME,
 19830           CALCULATION-PASS-AREA,
 19831           CP-COMM-LENGTH,
 19832           DFHEIV99,
 19833           DFHEIV99,
 19834           DFHEIV99,
 19835           DFHEIV99
 19836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19837
 19838
 19839 9800-EXIT.
 19840     EXIT.
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 381
* EL156.cbl
 19842 9830-DMD-REMAINING-TERM.
 19843
 19844     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 19845         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 19846
 19847     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 19848                              CM-PMT-EXTENSION-DAYS.
 19849
 19850     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 19851                                  CL-NO-OF-DAYS-PAID.
 19852
 19853     DIVIDE W-REM-TERM-IN-DAYS BY +30
 19854         GIVING W-REM REMAINDER W-REM-DAYS.
 19855
 19856     MOVE W-REM                  TO WST-REM.
 19857
 19858     IF W-REM-DAYS > ZEROS
 19859         MOVE '/'                TO WST-SLASH
 19860         MOVE W-REM-DAYS         TO WST-REM-DAYS
 19861     ELSE
 19862         MOVE SPACES             TO WST-REM-DAYS-GRP.
 19863
 19864 9830-EXIT.
 19865     EXIT.
 19866
 19867 9870-OUTPUT-ACTIVITY-RECORD.
 19868
 19869
 19870* EXEC CICS GETMAIN
 19871*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 19872*         LENGTH(25)
 19873*         INITIMG(WS-BLANK)
 19874*    END-EXEC.
 19875     MOVE 25
 19876       TO DFHEIV11
 19877*    MOVE ',"IL                  $   #00017561' TO DFHEIV0
 19878     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 19879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19880     MOVE X'2020233030303137353631' TO DFHEIV0(25:11)
 19881     CALL 'kxdfhei1' USING DFHEIV0,
 19882           DFHEIV20,
 19883           DFHEIV11,
 19884           WS-BLANK
 19885     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 19886         DFHEIV20
 19887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19888
 19889
 19890     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 19891     MOVE ELMSTR-KEY             TO DA-KEY.
 19892     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 19893
 19894     IF PI-PMTTYPE EQUAL '7'
 19895         MOVE 'V'                TO DA-RECORD-TYPE
 19896     ELSE
 19897         MOVE 'P'                TO DA-RECORD-TYPE.
 19898
 19899
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 382
* EL156.cbl
 19900* EXEC CICS HANDLE CONDITION
 19901*         NOTOPEN(9870-NOTOPEN)
 19902*         DUPREC(9870-EXIT)
 19903*    END-EXEC.
 19904*    MOVE '"$J%                  ! B #00017576' TO DFHEIV0
 19905     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 19906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19907     MOVE X'4220233030303137353736' TO DFHEIV0(25:11)
 19908     CALL 'kxdfhei1' USING DFHEIV0
 19909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19910
 19911
 19912
 19913* EXEC CICS WRITE
 19914*         DATASET('DLYACTV')
 19915*         RIDFLD(DA-KEY)
 19916*         FROM(DAILY-ACTIVITY-RECORD)
 19917*         LENGTH(25)
 19918*    END-EXEC.
 19919     MOVE 'DLYACTV' TO DFHEIV1
 19920     MOVE 25
 19921       TO DFHEIV11
 19922*    MOVE '&$ L                  ''   #00017581' TO DFHEIV0
 19923     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19924     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19925     MOVE X'2020233030303137353831' TO DFHEIV0(25:11)
 19926     CALL 'kxdfhei1' USING DFHEIV0,
 19927           DFHEIV1,
 19928           DAILY-ACTIVITY-RECORD,
 19929           DFHEIV11,
 19930           DA-KEY,
 19931           DFHEIV99,
 19932           DFHEIV99
 19933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19934
 19935     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 19936     GO TO 9870-EXIT.
 19937
 19938 9870-NOTOPEN.
 19939
 19940     MOVE '2955'                 TO EMI-ERROR.
 19941     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 19942
 19943 9870-EXIT.
 19944     EXIT.
 19945
 19946 9900-ERROR-FORMAT.
 19947
 19948     IF EMI-ERROR = ER-0923
 19949         MOVE PGM-NAME           TO W-CALLED-NAME.
 19950
 19951     MOVE LINK-001      TO PGM-NAME.
 19952     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 19953
 19954
 19955* EXEC CICS LINK
 19956*        PROGRAM (PGM-NAME)
 19957*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 383
* EL156.cbl
 19958*        LENGTH  (EMI-COMM-LENGTH)
 19959*    END-EXEC.
 19960*    MOVE '."C                   (   #00017606' TO DFHEIV0
 19961     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19962     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19963     MOVE X'2020233030303137363036' TO DFHEIV0(25:11)
 19964     CALL 'kxdfhei1' USING DFHEIV0,
 19965           PGM-NAME,
 19966           ERROR-MESSAGE-INTERFACE-BLOCK,
 19967           EMI-COMM-LENGTH,
 19968           DFHEIV99,
 19969           DFHEIV99,
 19970           DFHEIV99,
 19971           DFHEIV99
 19972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19973
 19974
 19975     IF EMI-ERROR = ER-0923
 19976         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 19977
 19978 9900-EXIT.
 19979     EXIT.
 19980
 19981 9990-ABEND.
 19982     MOVE LINK-004               TO PGM-NAME.
 19983     MOVE DFHEIBLK               TO EMI-LINE1.
 19984
 19985* EXEC CICS LINK
 19986*        PROGRAM   (PGM-NAME)
 19987*        COMMAREA  (EMI-LINE1)
 19988*        LENGTH    (64)
 19989*    END-EXEC.
 19990     MOVE 64
 19991       TO DFHEIV11
 19992*    MOVE '."C                   (   #00017621' TO DFHEIV0
 19993     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19994     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19995     MOVE X'2020233030303137363231' TO DFHEIV0(25:11)
 19996     CALL 'kxdfhei1' USING DFHEIV0,
 19997           PGM-NAME,
 19998           EMI-LINE1,
 19999           DFHEIV11,
 20000           DFHEIV99,
 20001           DFHEIV99,
 20002           DFHEIV99,
 20003           DFHEIV99
 20004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20005
 20006
 20007     MOVE 'EL156A'               TO  MAP-NAME.
 20008     MOVE LOW-VALUES             TO  EL156AO.
 20009     GO TO 8100-SEND-INITIAL-MAP.
 20010
 20011 9995-SECURITY-VIOLATION.
 20012*    COPY ELCSCTP.
 20013******************************************************************
 20014*                                                                *
 20015*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 384
* EL156.cbl
 20016*                            VMOD=2.001                          *
 20017*                                                                *
 20018*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20019******************************************************************
 20020
 20021
 20022     MOVE EIBDATE          TO SM-JUL-DATE.
 20023     MOVE EIBTRMID         TO SM-TERMID.
 20024     MOVE THIS-PGM         TO SM-PGM.
 20025     MOVE EIBTIME          TO TIME-IN.
 20026     MOVE TIME-OUT         TO SM-TIME.
 20027     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20028
 20029
 20030* EXEC CICS LINK
 20031*         PROGRAM  ('EL003')
 20032*         COMMAREA (SECURITY-MESSAGE)
 20033*         LENGTH   (80)
 20034*    END-EXEC.
 20035     MOVE 'EL003' TO DFHEIV1
 20036     MOVE 80
 20037       TO DFHEIV11
 20038*    MOVE '."C                   (   #00017649' TO DFHEIV0
 20039     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20040     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20041     MOVE X'2020233030303137363439' TO DFHEIV0(25:11)
 20042     CALL 'kxdfhei1' USING DFHEIV0,
 20043           DFHEIV1,
 20044           SECURITY-MESSAGE,
 20045           DFHEIV11,
 20046           DFHEIV99,
 20047           DFHEIV99,
 20048           DFHEIV99,
 20049           DFHEIV99
 20050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20051
 20052
 20053******************************************************************
 20054
 20055
 20056
 20057 9999-DFHBACK SECTION.
 20058     MOVE '9%                    "   ' TO DFHEIV0
 20059     MOVE 'EL156' TO DFHEIV1
 20060     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20061     GOBACK.
 20062 9999-DFHEXIT.
 20063     IF DFHEIGDJ EQUAL 0001
 20064         NEXT SENTENCE
 20065     ELSE IF DFHEIGDJ EQUAL 2
 20066         GO TO 9990-ABEND,
 20067               8600-PGRM-NOT-FOUND,
 20068               0400-FIRST-TIME,
 20069               6180-DUPREC,
 20070               9990-ABEND
 20071         DEPENDING ON DFHEIGDI
 20072     ELSE IF DFHEIGDJ EQUAL 3
 20073         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 385
* EL156.cbl
 20074               0380-CLAIM-END-FILE
 20075         DEPENDING ON DFHEIGDI
 20076     ELSE IF DFHEIGDJ EQUAL 4
 20077         GO TO 0380-CLAIM-END-FILE,
 20078               0380-CLAIM-END-FILE
 20079         DEPENDING ON DFHEIGDI
 20080     ELSE IF DFHEIGDJ EQUAL 5
 20081         GO TO 0800-EXIT
 20082         DEPENDING ON DFHEIGDI
 20083     ELSE IF DFHEIGDJ EQUAL 6
 20084         GO TO 1950-NOT-FOUND,
 20085               1950-NOT-FOUND
 20086         DEPENDING ON DFHEIGDI
 20087     ELSE IF DFHEIGDJ EQUAL 7
 20088         GO TO 1950-NOT-FOUND
 20089         DEPENDING ON DFHEIGDI
 20090     ELSE IF DFHEIGDJ EQUAL 8
 20091         GO TO 1950-NOT-FOUND,
 20092               1950-NOT-FOUND
 20093         DEPENDING ON DFHEIGDI
 20094     ELSE IF DFHEIGDJ EQUAL 9
 20095         GO TO 1166-END-CHECK,
 20096               1166-END-CHECK
 20097         DEPENDING ON DFHEIGDI
 20098     ELSE IF DFHEIGDJ EQUAL 10
 20099         GO TO 1950-NOT-FOUND,
 20100               1950-NOT-FOUND
 20101         DEPENDING ON DFHEIGDI
 20102     ELSE IF DFHEIGDJ EQUAL 11
 20103         GO TO 1950-NOT-FOUND,
 20104               1950-NOT-FOUND
 20105         DEPENDING ON DFHEIGDI
 20106     ELSE IF DFHEIGDJ EQUAL 12
 20107         GO TO 1950-NOT-FOUND
 20108         DEPENDING ON DFHEIGDI
 20109     ELSE IF DFHEIGDJ EQUAL 13
 20110         GO TO 3600-CONTINUE
 20111         DEPENDING ON DFHEIGDI
 20112     ELSE IF DFHEIGDJ EQUAL 14
 20113         GO TO 5300-NOTE-NOT-FOUND
 20114         DEPENDING ON DFHEIGDI
 20115     ELSE IF DFHEIGDJ EQUAL 15
 20116         GO TO 6065-NOT-FOUND
 20117         DEPENDING ON DFHEIGDI
 20118     ELSE IF DFHEIGDJ EQUAL 16
 20119         GO TO 6068-ACCT-NOT-FND
 20120         DEPENDING ON DFHEIGDI
 20121     ELSE IF DFHEIGDJ EQUAL 17
 20122         GO TO 6074-GET-COMP-DATA
 20123         DEPENDING ON DFHEIGDI
 20124     ELSE IF DFHEIGDJ EQUAL 18
 20125         GO TO 6170-WRITE
 20126         DEPENDING ON DFHEIGDI
 20127     ELSE IF DFHEIGDJ EQUAL 19
 20128         GO TO 6180-DUPREC
 20129         DEPENDING ON DFHEIGDI
 20130     ELSE IF DFHEIGDJ EQUAL 20
 20131         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 04-Jun-14 13:32 Page 386
* EL156.cbl
 20132         DEPENDING ON DFHEIGDI
 20133     ELSE IF DFHEIGDJ EQUAL 21
 20134         GO TO 6185-DUPREC
 20135         DEPENDING ON DFHEIGDI
 20136     ELSE IF DFHEIGDJ EQUAL 22
 20137         GO TO 6720-BUILD-NEW-RECORD
 20138         DEPENDING ON DFHEIGDI
 20139     ELSE IF DFHEIGDJ EQUAL 23
 20140         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20141               6900-BUILD-ARCHIVE-HEADER
 20142         DEPENDING ON DFHEIGDI
 20143     ELSE IF DFHEIGDJ EQUAL 24
 20144         GO TO 7010-BUILD-MAP
 20145         DEPENDING ON DFHEIGDI
 20146     ELSE IF DFHEIGDJ EQUAL 25
 20147         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20148         DEPENDING ON DFHEIGDI
 20149     ELSE IF DFHEIGDJ EQUAL 26
 20150         GO TO 7160-DUPREC
 20151         DEPENDING ON DFHEIGDI
 20152     ELSE IF DFHEIGDJ EQUAL 27
 20153         GO TO 7200-EXIT,
 20154               7200-EXIT
 20155         DEPENDING ON DFHEIGDI
 20156     ELSE IF DFHEIGDJ EQUAL 28
 20157         GO TO 7400-NOT-FOUND
 20158         DEPENDING ON DFHEIGDI
 20159     ELSE IF DFHEIGDJ EQUAL 29
 20160         GO TO 7590-END,
 20161               7590-END
 20162         DEPENDING ON DFHEIGDI
 20163     ELSE IF DFHEIGDJ EQUAL 30
 20164         GO TO 7699-EXIT
 20165         DEPENDING ON DFHEIGDI
 20166     ELSE IF DFHEIGDJ EQUAL 31
 20167         GO TO 5300-NOTE-NOT-FOUND
 20168         DEPENDING ON DFHEIGDI
 20169     ELSE IF DFHEIGDJ EQUAL 32
 20170         GO TO 7800-COMP-NOTFND
 20171         DEPENDING ON DFHEIGDI
 20172     ELSE IF DFHEIGDJ EQUAL 33
 20173         GO TO 7920-NOT-FOUND
 20174         DEPENDING ON DFHEIGDI
 20175     ELSE IF DFHEIGDJ EQUAL 34
 20176         GO TO 9870-NOTOPEN,
 20177               9870-EXIT
 20178         DEPENDING ON DFHEIGDI.
 20179     MOVE '9%                    "   ' TO DFHEIV0
 20180     MOVE 'EL156' TO DFHEIV1
 20181     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20182     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12172     Code:       74559
