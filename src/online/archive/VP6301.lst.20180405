* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   1
* VP6301.cbl
* Options: int("VP6301.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("VP6301.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"VP6301.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"VP6301.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 VP6301.
     3*                            VMOD=2.075
     4*
     5*AUTHOR.     LOGIC,INC.
     6*            DALLAS, TEXAS.
     7*DATE-COMPILED.
     8*SECURITY.   *****************************************************
     9*            *                                                   *
    10*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    11*            *                                                   *
    12*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    13*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   2
* VP6301.cbl
    14*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    15*            *                                                   *
    16*            *****************************************************
    17*REMARKS.
    18*         TRANSACTION - VPA6 - NEW BUSINESS - DATA ENTRY (ISSUES).
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    28* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    29* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    30* 081606  CR2006080800002  PEMA  ADD VIN NUMBER
    31* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    32* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
    33* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    34* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    35* 020210  IR2010011100002  PEMA  CORRECT ATTRB ON BCZIPCD
    36* 030310  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    37* 030310  CR2009031200002  PEMA  CHECK LOAN OFF EDIT SWITCH
    38* 060211  CR2011051600002  PEMA  OPEN CP FIELD
    39* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    40* 050713  CR2008042200001  PEMA  ADD ZERO PCT APR PROCESSING
    41* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    42* 020514  IR2014012400001  PEMA  DARK OUT AH ALT BEN FOR CID&AHL
    43* 042114  CR2014032000001  PEMA  rearrange dob,jntdob&ssn
    44* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
    45* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    46******************************************************************
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*    VP6301 WORKING STORAGE    *'.
    53 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.075 *********'.
    54 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    55 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   3
* VP6301.cbl
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107 01  WS-NUM-TABLE                PIC X(26)  VALUE
   108     '12345678012345070923456789'.
   109 01  FILLER REDEFINES WS-NUM-TABLE.
   110     05  WS-NUM OCCURS 26        PIC 9.
   111 01  V1                          PIC S999 COMP-3.
   112 01  V2                          PIC S999 COMP-3.
   113 01  V3                          PIC S999 COMP-3.
   114 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   115 01  FILLER REDEFINES WS-WORK-VIN.
   116     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   117 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   118 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   119 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   120 01  WS-HEX-WORK.
   121     05  FILLER                  PIC X  VALUE LOW-VALUES.
   122     05  WS-HEX-BYTE             PIC X.
   123 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   124 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   125 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1900.
   126 01  STANDARD-AREAS.
   127     12  WS-RESPONSE             PIC S9(8)   COMP.
   128         88  RESP-NORMAL              VALUE +00.
   129         88  RESP-ERROR               VALUE +01.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   4
* VP6301.cbl
   130         88  RESP-NOTFND              VALUE +13.
   131         88  RESP-NOTOPEN             VALUE +19.
   132         88  RESP-ENDFILE             VALUE +20.
   133     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   134     12  VP630B              PIC X(8)    VALUE 'VP630B'.
   135     12  VP630C              PIC X(8)    VALUE 'VP630C'.
   136     12  MAPSET-VP6301S      PIC X(8)    VALUE 'VP6301S'.
   137     12  TRANS-EXA6          PIC X(4)    VALUE 'VPA6'.
   138     12  THIS-PGM            PIC X(8)    VALUE 'VP6301'.
   139     12  PGM-NAME            PIC X(8).
   140     12  TIME-IN             PIC S9(7).
   141     12  TIME-OUT-R  REDEFINES TIME-IN.
   142         16  FILLER          PIC X.
   143         16  TIME-OUT        PIC 99V99.
   144         16  FILLER          PIC XX.
   145     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   146     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   147     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   148     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   149     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   150     12  XCTL-EL630          PIC X(8)    VALUE 'EL630'.
   151     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   152     12  FILE-ID-ERPNDB      PIC X(8)    VALUE 'ERPNDB'.
   153     12  FILE-ID-ERPNDM      PIC X(8)    VALUE 'ERPNDM'.
   154     12  FILE-ID-ELCERT      PIC X(8)    VALUE 'ELCERT'.
   155     12  FILE-ID-ELCNTL      PIC X(8)    VALUE 'ELCNTL'.
   156     12  WS-CURRENT-DT       PIC X(8)    VALUE SPACES.
   157     12  WS-CURRENT-BIN-DT   PIC XX      VALUE SPACES.
   158     12  WS-TERM-IN-DAYS-SW  PIC X.
   159         88  WS-TERM-IN-DAYS-FOUND       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   5
* VP6301.cbl
   161 01  ERROR-MESSAGES.
   162     12  ER-0000                 PIC X(4)  VALUE '0000'.
   163     12  ER-0004                 PIC X(4)  VALUE '0004'.
   164     12  ER-0008                 PIC X(4)  VALUE '0008'.
   165     12  ER-0029                 PIC X(4)  VALUE '0029'.
   166     12  ER-0070                 PIC X(4)  VALUE '0070'.
   167     12  ER-0582                 PIC X(4)  VALUE '0582'.
   168     12  ER-1923                 PIC X(4)  VALUE '1923'.
   169     12  ER-2049                 PIC X(4)  VALUE '2049'.
   170     12  ER-2119                 PIC X(4)  VALUE '2119'.
   171     12  ER-2212                 PIC X(4)  VALUE '2212'.
   172     12  ER-2217                 PIC X(4)  VALUE '2217'.
   173     12  ER-2218                 PIC X(4)  VALUE '2218'.
   174     12  ER-2200                 PIC X(4)  VALUE '2200'.
   175     12  ER-2209                 PIC X(4)  VALUE '2209'.
   176     12  ER-2220                 PIC X(4)  VALUE '2220'.
   177     12  ER-2222                 PIC X(4)  VALUE '2222'.
   178     12  ER-2223                 PIC X(4)  VALUE '2223'.
   179     12  ER-2224                 PIC X(4)  VALUE '2224'.
   180     12  ER-2226                 PIC X(4)  VALUE '2226'.
   181     12  ER-2227                 PIC X(4)  VALUE '2227'.
   182     12  ER-2228                 PIC X(4)  VALUE '2228'.
   183     12  ER-2240                 PIC X(4)  VALUE '2240'.
   184     12  ER-2241                 PIC X(4)  VALUE '2241'.
   185     12  ER-2247                 PIC X(4)  VALUE '2247'.
   186     12  ER-2423                 PIC X(4)  VALUE '2423'.
   187     12  ER-2424                 PIC X(4)  VALUE '2424'.
   188     12  ER-2425                 PIC X(4)  VALUE '2425'.
   189     12  ER-2426                 PIC X(4)  VALUE '2426'.
   190     12  ER-2427                 PIC X(4)  VALUE '2427'.
   191     12  ER-2428                 PIC X(4)  VALUE '2428'.
   192     12  ER-2431                 PIC X(4)  VALUE '2431'.
   193     12  ER-2433                 PIC X(4)  VALUE '2433'.
   194     12  ER-2437                 PIC X(4)  VALUE '2437'.
   195     12  ER-2429                 PIC X(4)  VALUE '2429'.
   196     12  ER-2442                 PIC X(4)  VALUE '2442'.
   197     12  ER-2471                 PIC X(4)  VALUE '2471'.
   198     12  ER-2526                 PIC X(4)  VALUE '2526'.
   199     12  ER-2529                 PIC X(4)  VALUE '2529'.
   200     12  ER-2531                 PIC X(4)  VALUE '2531'.
   201     12  ER-2532                 PIC X(4)  VALUE '2532'.
   202     12  ER-2541                 PIC X(4)  VALUE '2541'.
   203     12  ER-2542                 PIC X(4)  VALUE '2542'.
   204     12  ER-2589                 PIC X(4)  VALUE '2589'.
   205     12  ER-2591                 PIC X(4)  VALUE '2591'.
   206     12  ER-2592                 PIC X(4)  VALUE '2592'.
   207     12  ER-2593                 PIC X(4)  VALUE '2593'.
   208     12  ER-2594                 PIC X(4)  VALUE '2594'.
   209     12  ER-2629                 PIC X(4)  VALUE '2629'.
   210     12  ER-2630                 PIC X(4)  VALUE '2630'.
   211     12  ER-2635                 PIC X(4)  VALUE '2635'.
   212     12  ER-2636                 PIC X(4)  VALUE '2636'.
   213     12  ER-2651                 PIC X(4)  VALUE '2651'.
   214     12  ER-2670                 PIC X(4)  VALUE '2670'.
   215     12  ER-2683                 PIC X(4)  VALUE '2683'.
   216     12  ER-2700                 PIC X(4)  VALUE '2700'.
   217     12  ER-2701                 PIC X(4)  VALUE '2701'.
   218     12  ER-2702                 PIC X(4)  VALUE '2702'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   6
* VP6301.cbl
   219     12  ER-2901                 PIC X(4)  VALUE '2901'.
   220     12  ER-2963                 PIC X(4)  VALUE '2963'.
   221     12  ER-2964                 PIC X(4)  VALUE '2964'.
   222     12  ER-3166                 PIC X(4)  VALUE '3166'.
   223     12  ER-3825                 PIC X(4)  VALUE '3825'.
   224     12  ER-3826                 PIC X(4)  VALUE '3826'.
   225     12  ER-7400                 PIC X(4)  VALUE '7400'.
   226     12  ER-7403                 PIC X(4)  VALUE '7403'.
   227     12  ER-7404                 PIC X(4)  VALUE '7404'.
   228     12  ER-7405                 PIC X(4)  VALUE '7405'.
   229     12  ER-7423                 PIC X(4)  VALUE '7423'.
   230     12  ER-7424                 PIC X(4)  VALUE '7424'.
   231     12  ER-7530                 PIC X(4)  VALUE '7530'.
   232     12  ER-7632                 PIC X(4)  VALUE '7632'.
   233     12  ER-7630                 PIC X(4)  VALUE '7630'.
   234     12  ER-7631                 PIC X(4)  VALUE '7631'.
   235     12  ER-7633                 PIC X(4)  VALUE '7633'.
   236     12  ER-7997                 PIC X(4)  VALUE '7997'.
   237     12  ER-7998                 PIC X(4)  VALUE '7998'.
   238     12  ER-9841                 PIC X(4)  VALUE '9841'.
   239     12  ER-9999                 PIC X(4)  VALUE '9999'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   7
* VP6301.cbl
   241 01  ACCESS-KEYS.
   242     12  ERPNDB-KEY.
   243         16  ERPNDB-COMP-CD          PIC X     VALUE SPACE.
   244         16  ERPNDB-ENTRY-BATCH      PIC X(6)  VALUE SPACES.
   245         16  ERPNDB-BATCH-SEQ        PIC S9(4) VALUE +1 COMP.
   246         16  ERPNDB-BATCH-CHG-SEQ    PIC S9(4) VALUE +0 COMP.
   247     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   248     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   249     12  ELCNTL-KEY.
   250         16  ELCNTL-COMPANY-ID       PIC X(3)  VALUE SPACES.
   251         16  ELCNTL-REC-TYPE         PIC X     VALUE SPACES.
   252         16  ELCNTL-ACCESS.
   253             20  FILLER              PIC XX.
   254             20  ELCNTL-HI-BEN       PIC XX.
   255         16  ELCNTL-SEQ              PIC S9(4) VALUE +0 COMP.
   256     12  ELCNTL-RECORD-LENGTH        PIC S9(4) COMP VALUE +504.
   257     12  ELCNTL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +527.
   258     12  ELCERT-KEY.
   259         16  ELCERT-COMPANY-CD       PIC X.
   260         16  ELCERT-CARRIER          PIC X.
   261         16  ELCERT-GROUPING         PIC X(6).
   262         16  ELCERT-STATE            PIC XX.
   263         16  ELCERT-ACCOUNT          PIC X(10).
   264         16  ELCERT-CERT-EFF-DT      PIC XX.
   265         16  ELCERT-CERT-NO.
   266             20  ELCERT-CERT-PRIME   PIC X(10).
   267             20  ELCERT-CERT-SFX     PIC X.
   268     12  ELCRTT-KEY.
   269         16  ELCRTT-COMPANY-CD       PIC X.
   270         16  ELCRTT-CARRIER          PIC X.
   271         16  ELCRTT-GROUPING         PIC X(6).
   272         16  ELCRTT-STATE            PIC XX.
   273         16  ELCRTT-ACCOUNT          PIC X(10).
   274         16  ELCRTT-CERT-EFF-DT      PIC XX.
   275         16  ELCRTT-CERT-NO.
   276             20  ELCRTT-CERT-PRIME   PIC X(10).
   277             20  ELCRTT-CERT-SFX     PIC X.
   278         16  ELCRTT-TRLR-TYPE        PIC X.
   279     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   280     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   281     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   282     12  ERPNDM-KEY.
   283         16  ERPNDM-COMP-CD          PIC X     VALUE SPACE.
   284         16  ERPNDM-ENTRY-BATCH      PIC X(6)  VALUE SPACES.
   285         16  ERPNDM-BATCH-SEQ        PIC S9(4) VALUE +1 COMP.
   286         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4) VALUE +0 COMP.
   287*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   288     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   289*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   290     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   8
* VP6301.cbl
   292 01  WORK-AREA.
   293     12  DEEDIT-FIELD            PIC X(15).
   294     12  FILLER REDEFINES DEEDIT-FIELD.
   295         16  FILLER              PIC X(4).
   296         16  DEEDIT-FIELD-X11    PIC X(11).
   297     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(15).
   298     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(13)V99.
   299     12  DEEDIT-FIELD-V3 REDEFINES DEEDIT-FIELD PIC S9(12)V9(3).
   300     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD PIC S9(11)V9(4).
   301     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD PIC S9(10)V9(5).
   302     12  WS-SUB                  PIC S9(4) VALUE +0  COMP.
   303     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   304     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   305     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   306     12  WS-ACCT-SUB             PIC S9(4) VALUE +0  COMP.
   307     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   308     12  WS-EDIT-SUB             PIC S9(4) VALUE +0  COMP.
   309     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   310     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   311     12  FILLER REDEFINES WS-WORK-BIN-RED.
   312         16  FILLER              PIC X(02).
   313         16  WS-WORK-BIN-DT      PIC X(02).
   314     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   315     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   316         16  WS-CALC-TERM-WHOLE  PIC S999.
   317         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   318     12  ERROR-SW                PIC X     VALUE SPACE.
   319         88  NO-ERROR                VALUE SPACE.
   320         88  ERRORS                  VALUE 'Y'.
   321         88  WS-COVERAGE-PRESENT     VALUE 'Y'.
   322     12  WS-DATA-KEYED-SW        PIC X     VALUE SPACE.
   323         88  WS-DATA-NOT-KEYED       VALUE SPACE.
   324         88  WS-DATA-KEYED           VALUE 'Y'.
   325     12  WS-EDITED-LF-CODE       PIC XX   VALUE SPACES.
   326     12  WS-LF-ABBR-DESC         PIC XXX  VALUE SPACES.
   327     12  ws-lf-earnings-calc     pic x    value spaces.
   328     12  WS-EDITED-AH-CODE       PIC XX   VALUE ZEROS.
   329     12  WS-AH-ABBR-DESC         PIC XXX  VALUE SPACES.
   330     12  WS-BEN-CD               PIC XX   VALUE SPACES.
   331     12  WS-ENTRY-CODE           PIC X     VALUE SPACE.
   332         88  WS-ENTRY-CODE-VALID   VALUE ' ' 'E' 'R' 'P'
   333                                         'M' 'D' 'V' 'U'.
   334     12  WS-FORCE-CODE           PIC X     VALUE SPACE.
   335         88  WS-FORCE-CODE-VALID   VALUE ' ' 'A' 'D'.
   336     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   337     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   338         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
   339     12  WS-SKIP-CODE            PIC X     VALUE SPACE.
   340         88 WS-SKIP-CODE-VALID     VALUE ' ' 'A' 'X' '0' THRU '9'.
   341     12  WS-KIND                 PIC XX    VALUE SPACE.
   342         88 WS-KIND-LF             VALUE 'LF'.
   343         88 WS-KIND-AH             VALUE 'AH'.
   344         88 WS-KIND-PR             VALUE 'PR'.
   345         88 WS-KIND-UE             VALUE 'UE'.
   346         88 WS-KIND-DI             VALUE 'DI'.
   347         88 WS-KIND-MONTHLY        VALUE 'AH' 'UE'.
   348     12  WS-JOURNAL-RECORD-LENGTH   PIC S9(4) COMP VALUE +0000.
   349     12  WS-EDIT-CODE               PIC X(4)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page   9
* VP6301.cbl
   350     12  WS-SAVE-INPUT-FIELDS.
   351         16  WS-BAGE                 PIC 99       VALUE ZERO.
   352         16  WS-BJNT-AGE             PIC 99       VALUE ZERO.
   353         16  WS-BDAYS                PIC 999      VALUE ZERO.
   354         16  WS-BLN-TERM             PIC 999      VALUE ZERO.
   355         16  WS-BFREQ                PIC 99       VALUE ZERO.
   356         16  WS-BPHONE               PIC 9(12)    VALUE  0 COMP-3.
   357         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   358         16  FILLER REDEFINES WS-BAPR.
   359             20  WS-APR-WHOLE-NUM    PIC 99.
   360             20  WS-APR-DEC          PIC 9999.
   361         16  WS-BPMT                 PIC S9(6)V99 VALUE +0 COMP-3.
   362         16  WS-BPMTS                PIC S999     VALUE +0 COMP-3.
   363         16  WS-BLIVES               PIC 9(7)      COMP-3.
   364         16  WS-B-COVERAGE.
   365             20  WS-BTERM1            PIC 999       COMP-3.
   366             20  WS-BBEN1             PIC S9(10)V99 COMP-3.
   367             20  WS-BALT-BEN1     PIC S9(10)V99 COMP-3.
   368             20  WS-BPREM1        PIC S9(10)V99 COMP-3.
   369             20  WS-BALT-PREM1    PIC S9(7)V99 COMP-3.
   370             20  WS-BTERM2            PIC 999       COMP-3.
   371             20  WS-BCRIT-PERD2       PIC 99        COMP-3.
   372             20  WS-BBEN2             PIC S9(10)V99 COMP-3.
   373             20  WS-BPREM2        PIC S9(10)V99 COMP-3.
   374             20  WS-BALT-BEN2     PIC S9(10)V99 COMP-3.
   375             20  WS-BALT-PREM2    PIC S9(7)V99 COMP-3.
   376         16  WS-C-FIELDS   OCCURS 4 TIMES.
   377             20  WS-CLIVES      PIC 9(3)          COMP-3.
   378             20  WS-CREFUND1    PIC S9(7)V99      COMP-3.
   379             20  WS-CREFUND2    PIC S9(7)V99      COMP-3.
   380             20  WS-CAN-REA     PIC X.
   381     12  WS-CONVERTED-BIRTH      OCCURS 2 PIC XX.
   382     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   383     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACES.
   384     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   385     12  WS-CONVERTED-CANCEL-DATES OCCURS 4 TIMES.
   386         16  WS-CONVERTED-CANDT1 PIC XX.
   387         16  WS-CONVERTED-CANDT2 PIC XX.
   388     12  WS-CONVERTED-CAN-EFF-DATES OCCURS 4 TIMES.
   389         16  WS-CONVERTED-CAN-EFF-DT PIC XX.
   390     12  WS-FIRST-NAME.
   391         16  WS-1ST-INIT         PIC X.
   392         16  FILLER              PIC X(9).
   393     12  WS-INITIALS.
   394         16  WS-INITIAL-1        PIC X.
   395         16  WS-INITIAL-2        PIC X.
   396     12  WS-ZIP-CODE.
   397         16  WS-ZIP-1            PIC X.
   398             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   399         16  WS-ZIP-2-3          PIC XX.
   400         16  WS-ZIP-4            PIC X.
   401         16  WS-ZIP-5            PIC X.
   402         16  WS-ZIP-6            PIC X.
   403         16  FILLER              PIC X(4).
   404     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   405         16  WS-ZIP-AM-1-CODE    PIC X(5).
   406         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   407         16  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  10
* VP6301.cbl
   408     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   409         16  WS-ZIP-AM-2-CODE    PIC X(5).
   410         16  WS-ZIP-AM-2-DASH    PIC X.
   411         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   412     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   413         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   414         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   415         16  FILLER              PIC X(4).
   416     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   417         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   418         16  FILLER              PIC X.
   419         16  WS-ZIP-CAN-2-POST2  PIC XXX.
   420         16  FILLER              PIC XXX.
   421     12  WS-MEMBER-NO            PIC X(12).
   422     12  FILLER  REDEFINES  WS-MEMBER-NO.
   423         16  WS-MEMBER-NO-1-8    PIC 9(8).
   424         16  FILLER              PIC X(4).
   425     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  11
* VP6301.cbl
   427 01  WS-DATE-AREA.
   428     12  WS-COMPARE-CURRENT-DT.
   429         16  FILLER              PIC X(4)    VALUE SPACES.
   430         16  WS-COMPARE-CURR-YR  PIC X(2)    VALUE SPACES.
   431     12  WS-SAVE-BIRTH-DATE.
   432         16  FILLER              PIC X(4)   VALUE SPACES.
   433         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   434 01  CLASIC-WARNING.
   435     12  WARNING-LENGTH              PIC S9(4)  VALUE +124 COMP.
   436     12  WARNING-TEXT.
   437         16  FILLER                  PIC X(80)  VALUE
   438             'THIS DATA MAY HAVE PREVIOUSLY BEEN PROCESSED'.
   439         16  FILLER                  PIC X(44)  VALUE
   440             'CONTACT PAUL @ CSO FOR FURTHER INFORMATION'.
   441*                                COPY ELCDATE.
   442******************************************************************
   443*                                                                *
   444*                                                                *
   445*                            ELCDATE.                            *
   446*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   447*                            VMOD=2.003
   448*                                                                *
   449*                                                                *
   450*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   451*                 LENGTH = 200                                   *
   452******************************************************************
   453
   454 01  DATE-CONVERSION-DATA.
   455     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   456     12  DC-OPTION-CODE                PIC X.
   457         88  BIN-TO-GREG                VALUE ' '.
   458         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   459         88  EDIT-GREG-TO-BIN           VALUE '2'.
   460         88  YMD-GREG-TO-BIN            VALUE '3'.
   461         88  MDY-GREG-TO-BIN            VALUE '4'.
   462         88  JULIAN-TO-BIN              VALUE '5'.
   463         88  BIN-PLUS-ELAPSED           VALUE '6'.
   464         88  FIND-CENTURY               VALUE '7'.
   465         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   466         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   467         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   468         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   469         88  JULIAN-TO-BIN-3            VALUE 'C'.
   470         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   471         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   472         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   473         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   474         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   475         88  CHECK-LEAP-YEAR            VALUE 'H'.
   476         88  BIN-3-TO-GREG              VALUE 'I'.
   477         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   478         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   479         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   480         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   481         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   482         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   483         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   484         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  12
* VP6301.cbl
   485         88  THREE-CHARACTER-BIN
   486                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   487         88  GREGORIAN-TO-BIN
   488                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   489         88  BIN-TO-GREGORIAN
   490                  VALUES ' ' '1' 'I' '8' 'G'.
   491         88  JULIAN-TO-BINARY
   492                  VALUES '5' 'C' 'E' 'F'.
   493     12  DC-ERROR-CODE                 PIC X.
   494         88  NO-CONVERSION-ERROR        VALUE ' '.
   495         88  DATE-CONVERSION-ERROR
   496                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   497         88  DATE-IS-ZERO               VALUE '1'.
   498         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   499         88  DATE-IS-INVALID            VALUE '3'.
   500         88  DATE1-GREATER-DATE2        VALUE '4'.
   501         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   502         88  DATE-INVALID-OPTION        VALUE '9'.
   503         88  INVALID-CENTURY            VALUE 'A'.
   504         88  ONLY-CENTURY               VALUE 'B'.
   505         88  ONLY-LEAP-YEAR             VALUE 'C'.
   506         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   507     12  DC-END-OF-MONTH               PIC X.
   508         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   509     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   510         88  USE-NORMAL-PROCESS         VALUE ' '.
   511         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   512         88  ADJUST-UP-100-YRS          VALUE '2'.
   513     12  FILLER                        PIC X.
   514     12  DC-CONVERSION-DATES.
   515         16  DC-BIN-DATE-1             PIC XX.
   516         16  DC-BIN-DATE-2             PIC XX.
   517         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   518         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   519                       DC-GREG-DATE-1-EDIT.
   520             20  DC-EDIT1-MONTH        PIC 99.
   521             20  SLASH1-1              PIC X.
   522             20  DC-EDIT1-DAY          PIC 99.
   523             20  SLASH1-2              PIC X.
   524             20  DC-EDIT1-YEAR         PIC 99.
   525         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   526         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   527                     DC-GREG-DATE-2-EDIT.
   528             20  DC-EDIT2-MONTH        PIC 99.
   529             20  SLASH2-1              PIC X.
   530             20  DC-EDIT2-DAY          PIC 99.
   531             20  SLASH2-2              PIC X.
   532             20  DC-EDIT2-YEAR         PIC 99.
   533         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   534         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   535                     DC-GREG-DATE-1-YMD.
   536             20  DC-YMD-YEAR           PIC 99.
   537             20  DC-YMD-MONTH          PIC 99.
   538             20  DC-YMD-DAY            PIC 99.
   539         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   540         16  DC-GREG-DATE-1-MDY-R REDEFINES
   541                      DC-GREG-DATE-1-MDY.
   542             20  DC-MDY-MONTH          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  13
* VP6301.cbl
   543             20  DC-MDY-DAY            PIC 99.
   544             20  DC-MDY-YEAR           PIC 99.
   545         16  DC-GREG-DATE-1-ALPHA.
   546             20  DC-ALPHA-MONTH        PIC X(10).
   547             20  DC-ALPHA-DAY          PIC 99.
   548             20  FILLER                PIC XX.
   549             20  DC-ALPHA-CENTURY.
   550                 24 DC-ALPHA-CEN-N     PIC 99.
   551             20  DC-ALPHA-YEAR         PIC 99.
   552         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   553         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   554         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   555         16  DC-JULIAN-DATE            PIC 9(05).
   556         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   557                                       PIC 9(05).
   558         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   559             20  DC-JULIAN-YEAR        PIC 99.
   560             20  DC-JULIAN-DAYS        PIC 999.
   561         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   562         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   563         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   564     12  DATE-CONVERSION-VARIBLES.
   565         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   566         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   567             20  FILLER                PIC 9(3).
   568             20  HOLD-CEN-1-CCYY.
   569                 24  HOLD-CEN-1-CC     PIC 99.
   570                 24  HOLD-CEN-1-YY     PIC 99.
   571             20  HOLD-CEN-1-MO         PIC 99.
   572             20  HOLD-CEN-1-DA         PIC 99.
   573         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   574             20  HOLD-CEN-1-R-MO       PIC 99.
   575             20  HOLD-CEN-1-R-DA       PIC 99.
   576             20  HOLD-CEN-1-R-CCYY.
   577                 24  HOLD-CEN-1-R-CC   PIC 99.
   578                 24  HOLD-CEN-1-R-YY   PIC 99.
   579             20  FILLER                PIC 9(3).
   580         16  HOLD-CENTURY-1-X.
   581             20  FILLER                PIC X(3)  VALUE SPACES.
   582             20  HOLD-CEN-1-X-CCYY.
   583                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   584                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   585             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   586             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   587         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   588             20  HOLD-CEN-1-R-X-MO     PIC XX.
   589             20  HOLD-CEN-1-R-X-DA     PIC XX.
   590             20  HOLD-CEN-1-R-X-CCYY.
   591                 24  HOLD-CEN-1-R-X-CC PIC XX.
   592                 24  HOLD-CEN-1-R-X-YY PIC XX.
   593             20  FILLER                PIC XXX.
   594         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   595         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   596         16  DC-JULIAN-DATE-1          PIC 9(07).
   597         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   598             20  DC-JULIAN-1-CCYY.
   599                 24  DC-JULIAN-1-CC    PIC 99.
   600                 24  DC-JULIAN-1-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  14
* VP6301.cbl
   601             20  DC-JULIAN-DA-1        PIC 999.
   602         16  DC-JULIAN-DATE-2          PIC 9(07).
   603         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   604             20  DC-JULIAN-2-CCYY.
   605                 24  DC-JULIAN-2-CC    PIC 99.
   606                 24  DC-JULIAN-2-YR    PIC 99.
   607             20  DC-JULIAN-DA-2        PIC 999.
   608         16  DC-GREG-DATE-A-EDIT.
   609             20  DC-EDITA-MONTH        PIC 99.
   610             20  SLASHA-1              PIC X VALUE '/'.
   611             20  DC-EDITA-DAY          PIC 99.
   612             20  SLASHA-2              PIC X VALUE '/'.
   613             20  DC-EDITA-CCYY.
   614                 24  DC-EDITA-CENT     PIC 99.
   615                 24  DC-EDITA-YEAR     PIC 99.
   616         16  DC-GREG-DATE-B-EDIT.
   617             20  DC-EDITB-MONTH        PIC 99.
   618             20  SLASHB-1              PIC X VALUE '/'.
   619             20  DC-EDITB-DAY          PIC 99.
   620             20  SLASHB-2              PIC X VALUE '/'.
   621             20  DC-EDITB-CCYY.
   622                 24  DC-EDITB-CENT     PIC 99.
   623                 24  DC-EDITB-YEAR     PIC 99.
   624         16  DC-GREG-DATE-CYMD         PIC 9(08).
   625         16  DC-GREG-DATE-CYMD-R REDEFINES
   626                              DC-GREG-DATE-CYMD.
   627             20  DC-CYMD-CEN           PIC 99.
   628             20  DC-CYMD-YEAR          PIC 99.
   629             20  DC-CYMD-MONTH         PIC 99.
   630             20  DC-CYMD-DAY           PIC 99.
   631         16  DC-GREG-DATE-MDCY         PIC 9(08).
   632         16  DC-GREG-DATE-MDCY-R REDEFINES
   633                              DC-GREG-DATE-MDCY.
   634             20  DC-MDCY-MONTH         PIC 99.
   635             20  DC-MDCY-DAY           PIC 99.
   636             20  DC-MDCY-CEN           PIC 99.
   637             20  DC-MDCY-YEAR          PIC 99.
   638    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   639        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   640    12  DC-EL310-DATE                  PIC X(21).
   641    12  FILLER                         PIC X(28).
   642*                                COPY ELCLOGOF.
   643******************************************************************
   644*                                                                *
   645*                                                                *
   646*                            ELCLOGOF.                           *
   647*                            VMOD=2.001                          *
   648*                                                                *
   649*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   650*                                                                *
   651******************************************************************
   652 01  CLASIC-LOGOFF.
   653     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   654     12  LOGOFF-TEXT.
   655         16  FILLER          PIC X(5)    VALUE SPACES.
   656         16  LOGOFF-MSG.
   657             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   658             20  FILLER      PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  15
* VP6301.cbl
   659             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   660         16  FILLER          PIC X(80)
   661           VALUE '* YOU ARE NOW LOGGED OFF'.
   662         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   663         16  FILLER          PIC X       VALUE QUOTE.
   664         16  LOGOFF-SYS-MSG  PIC X(17)
   665           VALUE 'S CLAS-IC SYSTEM '.
   666     12  TEXT-MESSAGES.
   667         16  UNACCESS-MSG    PIC X(29)
   668             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   669         16  PGMIDERR-MSG    PIC X(17)
   670             VALUE 'PROGRAM NOT FOUND'.
   671*                                COPY ELCATTR.
   672******************************************************************
   673*                                                                *
   674*                            ELCATTR.                            *
   675*                            VMOD=2.001                          *
   676*                                                                *
   677*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   678*                                                                *
   679*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   680*                                                                *
   681*                   POS 1   P=PROTECTED                          *
   682*                           U=UNPROTECTED                        *
   683*                           S=ASKIP                              *
   684*                   POS 2   A=ALPHA/NUMERIC                      *
   685*                           N=NUMERIC                            *
   686*                   POS 3   N=NORMAL                             *
   687*                           B=BRIGHT                             *
   688*                           D=DARK                               *
   689*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   690*                           OF=MODIFIED DATA TAG OFF             *
   691*                                                                *
   692*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   693******************************************************************
   694 01  ATTRIBUTE-LIST.
   695     12  AL-PABOF            PIC X       VALUE 'Y'.
   696     12  AL-PABON            PIC X       VALUE 'Z'.
   697     12  AL-PADOF            PIC X       VALUE '%'.
   698     12  AL-PADON            PIC X       VALUE '_'.
   699     12  AL-PANOF            PIC X       VALUE '-'.
   700     12  AL-PANON            PIC X       VALUE '/'.
   701     12  AL-SABOF            PIC X       VALUE '8'.
   702     12  AL-SABON            PIC X       VALUE '9'.
   703     12  AL-SADOF            PIC X       VALUE '@'.
   704     12  AL-SADON            PIC X       VALUE QUOTE.
   705     12  AL-SANOF            PIC X       VALUE '0'.
   706     12  AL-SANON            PIC X       VALUE '1'.
   707     12  AL-UABOF            PIC X       VALUE 'H'.
   708     12  AL-UABON            PIC X       VALUE 'I'.
   709     12  AL-UADOF            PIC X       VALUE '<'.
   710     12  AL-UADON            PIC X       VALUE '('.
   711     12  AL-UANOF            PIC X       VALUE ' '.
   712     12  AL-UANON            PIC X       VALUE 'A'.
   713     12  AL-UNBOF            PIC X       VALUE 'Q'.
   714     12  AL-UNBON            PIC X       VALUE 'R'.
   715     12  AL-UNDOF            PIC X       VALUE '*'.
   716     12  AL-UNDON            PIC X       VALUE ')'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  16
* VP6301.cbl
   717     12  AL-UNNOF            PIC X       VALUE '&'.
   718     12  AL-UNNON            PIC X       VALUE 'J'.
   719*                                COPY ELCEMIB.
   720******************************************************************
   721*                                                                *
   722*                                                                *
   723*                            ELCEMIB.                            *
   724*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   725*                            VMOD=2.005                          *
   726*                                                                *
   727*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   728*                                                                *
   729******************************************************************
   730 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   731     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   732     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   733     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   734     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   735     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   736     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   737     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   738     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   739     12  EMI-SWITCH1             PIC X        VALUE '1'.
   740         88  EMI-NO-ERRORS                    VALUE '1'.
   741         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   742         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   743     12  EMI-SWITCH2             PIC X        VALUE '1'.
   744         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   745     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   746         88  EMI-AREA1-EMPTY                  VALUE '1'.
   747         88  EMI-AREA1-FULL                   VALUE '2'.
   748     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   749         88  EMI-AREA2-EMPTY                  VALUE '1'.
   750         88  EMI-AREA2-FULL                   VALUE '2'.
   751     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   752         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   753         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   754         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   755         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   756         88  EMI-BYPASS-FATALS                VALUE 'X'.
   757     12  EMI-ERROR-LINES.
   758         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   759         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   760         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   761         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   762             20  EMI-ERR-CODES OCCURS 10 TIMES.
   763                 24  EMI-ERR-NUM         PIC X(4).
   764                 24  EMI-FILLER          PIC X.
   765                 24  EMI-SEV             PIC X.
   766                 24  FILLER              PIC X.
   767             20  FILLER                  PIC X(02).
   768     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   769         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   770             20  EMI-ERROR-NUMBER    PIC X(4).
   771             20  EMI-FILL            PIC X.
   772             20  EMI-SEVERITY        PIC X.
   773             20  FILLER              PIC X.
   774             20  EMI-ERROR-TEXT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  17
* VP6301.cbl
   775                 24  EMI-TEXT-VARIABLE   PIC X(10).
   776                 24  FILLER          PIC X(55).
   777     12  EMI-SEVERITY-SAVE           PIC X.
   778         88  EMI-NOTE                    VALUE 'N'.
   779         88  EMI-WARNING                 VALUE 'W'.
   780         88  EMI-FORCABLE                VALUE 'F'.
   781         88  EMI-FATAL                   VALUE 'X'.
   782     12  EMI-MESSAGE-FLAG            PIC X.
   783         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   784         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   785     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   786     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   787         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   788         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   789         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   790     12  emi-claim-no                pic x(7).
   791     12  emi-claim-type              pic x(6).
   792     12  FILLER                      PIC X(124)  VALUE SPACES.
   793     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   794     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   795     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   796     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   797*                                COPY ELCINTF.
   798******************************************************************
   799*                                                                *
   800*                                                                *
   801*                            ELCINTF.                            *
   802*                            VMOD=2.017                          *
   803*                                                                *
   804*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   805*                                                                *
   806*       LENGTH = 1024                                            *
   807*                                                                *
   808******************************************************************
   809*                   C H A N G E   L O G
   810*
   811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   812*-----------------------------------------------------------------
   813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   814* EFFECTIVE    NUMBER
   815*-----------------------------------------------------------------
   816* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   817******************************************************************
   818 01  PROGRAM-INTERFACE-BLOCK.
   819     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   820     12  PI-CALLING-PROGRAM              PIC X(8).
   821     12  PI-SAVED-PROGRAM-1              PIC X(8).
   822     12  PI-SAVED-PROGRAM-2              PIC X(8).
   823     12  PI-SAVED-PROGRAM-3              PIC X(8).
   824     12  PI-SAVED-PROGRAM-4              PIC X(8).
   825     12  PI-SAVED-PROGRAM-5              PIC X(8).
   826     12  PI-SAVED-PROGRAM-6              PIC X(8).
   827     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   828     12  PI-COMPANY-ID                   PIC XXX.
   829     12  PI-COMPANY-CD                   PIC X.
   830
   831     12  PI-COMPANY-PASSWORD             PIC X(8).
   832
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  18
* VP6301.cbl
   833     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   834
   835     12  PI-CONTROL-IN-PROGRESS.
   836         16  PI-CARRIER                  PIC X.
   837         16  PI-GROUPING                 PIC X(6).
   838         16  PI-STATE                    PIC XX.
   839         16  PI-ACCOUNT                  PIC X(10).
   840         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   841                                         PIC X(10).
   842         16  PI-CLAIM-CERT-GRP.
   843             20  PI-CLAIM-NO             PIC X(7).
   844             20  PI-CERT-NO.
   845                 25  PI-CERT-PRIME       PIC X(10).
   846                 25  PI-CERT-SFX         PIC X.
   847             20  PI-CERT-EFF-DT          PIC XX.
   848         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   849             20  PI-PLAN-CODE            PIC X(2).
   850             20  PI-REVISION-NUMBER      PIC X(3).
   851             20  PI-PLAN-EFF-DT          PIC X(2).
   852             20  PI-PLAN-EXP-DT          PIC X(2).
   853             20  FILLER                  PIC X(11).
   854         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   855             20  PI-OE-REFERENCE-1.
   856                 25  PI-OE-REF-1-PRIME   PIC X(18).
   857                 25  PI-OE-REF-1-SUFF    PIC XX.
   858
   859     12  PI-SESSION-IN-PROGRESS          PIC X.
   860         88  CLAIM-SESSION                   VALUE '1'.
   861         88  CREDIT-SESSION                  VALUE '2'.
   862         88  WARRANTY-SESSION                VALUE '3'.
   863         88  MORTGAGE-SESSION                VALUE '4'.
   864         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   865
   866
   867*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   868
   869     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   870     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   871
   872     12  PI-CREDIT-USER                  PIC X.
   873         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   874         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   875
   876     12  PI-CLAIM-USER                   PIC X.
   877         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   878         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   879
   880     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   881         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   882         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   883         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   884         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   885         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   886
   887     12  PI-PROCESSOR-ID                 PIC X(4).
   888
   889     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   890
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  19
* VP6301.cbl
   891     12  PI-MEMBER-CAPTION               PIC X(10).
   892
   893     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   894         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   895
   896     12  PI-LIFE-OVERRIDE-L1             PIC X.
   897     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   898     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   899     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   900
   901     12  PI-AH-OVERRIDE-L1               PIC X.
   902     12  PI-AH-OVERRIDE-L2               PIC XX.
   903     12  PI-AH-OVERRIDE-L6               PIC X(6).
   904     12  PI-AH-OVERRIDE-L12              PIC X(12).
   905
   906     12  PI-NEW-SYSTEM                   PIC X(2).
   907
   908     12  PI-PRIMARY-CERT-NO              PIC X(11).
   909     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   910         88  PI-USES-PAID-TO                 VALUE '1'.
   911     12  PI-CRDTCRD-SYSTEM.
   912         16  PI-CRDTCRD-USER             PIC X.
   913             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   914             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   915         16  PI-CC-MONTH-END-DT          PIC XX.
   916     12  PI-PROCESSOR-PRINTER            PIC X(4).
   917
   918     12  PI-OE-REFERENCE-2.
   919         16  PI-OE-REF-2-PRIME           PIC X(10).
   920         16  PI-OE-REF-2-SUFF            PIC X.
   921
   922     12  PI-REM-TRM-CALC-OPTION          PIC X.
   923
   924     12  PI-LANGUAGE-TYPE                PIC X.
   925             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   926             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   927             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   928
   929     12  PI-POLICY-LINKAGE-IND           PIC X.
   930         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   931         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   932                                                   LOW-VALUES.
   933
   934     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   935     12  PI-CLAIM-PW-SESSION             PIC X(1).
   936         88  PI-CLAIM-CREDIT                 VALUE '1'.
   937         88  PI-CLAIM-CONVEN                 VALUE '2'.
   938
   939     12  PI-PROCESSOR-CSR-IND            PIC X.
   940         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   941         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   942
   943     12  FILLER                          PIC X(3).
   944
   945     12  PI-SYSTEM-LEVEL                 PIC X(145).
   946
   947     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   948         PI-SYSTEM-LEVEL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  20
* VP6301.cbl
   949
   950         16  PI-ENTRY-CODES.
   951             20  PI-ENTRY-CD-1           PIC X.
   952             20  PI-ENTRY-CD-2           PIC X.
   953
   954         16  PI-RETURN-CODES.
   955             20  PI-RETURN-CD-1          PIC X.
   956             20  PI-RETURN-CD-2          PIC X.
   957
   958         16  PI-UPDATE-STATUS-SAVE.
   959             20  PI-UPDATE-BY            PIC X(4).
   960             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   961
   962         16  PI-LOWER-CASE-LETTERS       PIC X.
   963             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   964
   965*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   966*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   967*            88  CARRIER-CLM-CNTL            VALUE '2'.
   968
   969         16  PI-CERT-ACCESS-CONTROL      PIC X.
   970             88  ST-ACCNT-CNTL               VALUE ' '.
   971             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   972             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   973             88  ACCNT-CNTL                  VALUE '3'.
   974             88  CARR-ACCNT-CNTL             VALUE '4'.
   975
   976         16  PI-PROCESSOR-CAP-LIST.
   977             20  PI-SYSTEM-CONTROLS.
   978                24 PI-SYSTEM-DISPLAY     PIC X.
   979                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   980                24 PI-SYSTEM-MODIFY      PIC X.
   981                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   982             20  FILLER                  PIC XX.
   983             20  PI-DISPLAY-CAP          PIC X.
   984                 88  DISPLAY-CAP             VALUE 'Y'.
   985             20  PI-MODIFY-CAP           PIC X.
   986                 88  MODIFY-CAP              VALUE 'Y'.
   987             20  PI-MSG-AT-LOGON-CAP     PIC X.
   988                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   989             20  PI-FORCE-CAP            PIC X.
   990                 88  FORCE-CAP               VALUE 'Y'.
   991
   992         16  PI-PROGRAM-CONTROLS.
   993             20  PI-PGM-PRINT-OPT        PIC X.
   994             20  PI-PGM-FORMAT-OPT       PIC X.
   995             20  PI-PGM-PROCESS-OPT      PIC X.
   996             20  PI-PGM-TOTALS-OPT       PIC X.
   997
   998         16  PI-HELP-INTERFACE.
   999             20  PI-LAST-ERROR-NO        PIC X(4).
  1000             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1001
  1002         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1003             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1004
  1005         16  PI-CR-CONTROL-IN-PROGRESS.
  1006             20  PI-CR-CARRIER           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  21
* VP6301.cbl
  1007             20  PI-CR-GROUPING          PIC X(6).
  1008             20  PI-CR-STATE             PIC XX.
  1009             20  PI-CR-ACCOUNT           PIC X(10).
  1010             20  PI-CR-FIN-RESP          PIC X(10).
  1011             20  PI-CR-TYPE              PIC X.
  1012
  1013         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1014
  1015         16  PI-CR-MONTH-END-DT          PIC XX.
  1016
  1017         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1018             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1019             88  PI-ZERO-CARRIER             VALUE '1'.
  1020             88  PI-ZERO-GROUPING            VALUE '2'.
  1021             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1022
  1023         16  PI-CARRIER-SECURITY         PIC X.
  1024             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1025
  1026         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1027             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1028             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1029
  1030         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1031             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1032                                         INDEXED BY PI-ACCESS-NDX
  1033                                         PIC X.
  1034
  1035         16  PI-GA-BILLING-CONTROL       PIC X.
  1036             88  PI-GA-BILLING               VALUE '1'.
  1037
  1038         16  PI-MAIL-PROCESSING          PIC X.
  1039             88  PI-MAIL-YES                 VALUE 'Y'.
  1040
  1041         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1042
  1043         16  PI-AR-SYSTEM.
  1044             20  PI-AR-PROCESSING-CNTL   PIC X.
  1045                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1046             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1047             20  PI-AR-MONTH-END-DT      PIC XX.
  1048
  1049         16  PI-MP-SYSTEM.
  1050             20  PI-MORTGAGE-USER            PIC X.
  1051                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1052                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1053             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1054                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1055                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1056                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1057                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1058                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1059             20  PI-MP-MONTH-END-DT          PIC XX.
  1060             20  PI-MP-REFERENCE-NO.
  1061                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1062                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1063
  1064         16  PI-LABEL-CONTROL            PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  22
* VP6301.cbl
  1065             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1066             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1067
  1068         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1069             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1070
  1071         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1072             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1073             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1074
  1075         16  FILLER                      PIC X(14).
  1076
  1077     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1078******************************************************************
  1079*                                COPY ELC630PI.
  1080******************************************************************
  1081*                                                                *
  1082*                            ELC630PI                            *
  1083*                            VMOD=2.014                          *
  1084*                                                                *
  1085* - PI-PROGRAM-WORK-AREA FOR THE DATA-ENTRY SUB-SYSTEM -         *
  1086*                                                                *
  1087*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  1088*                                                                *
  1089*               EL630 - EL6301 - EL6302                          *
  1090******************************************************************
  1091*                   C H A N G E   L O G
  1092*
  1093* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1094*-----------------------------------------------------------------
  1095*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1096* EFFECTIVE    NUMBER
  1097*-----------------------------------------------------------------
  1098* 072308  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  1099* 030310  CR2009031200002  PEMA  OPEN LOAN OFFICER FIELD
  1100* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1101******************************************************************
  1102
  1103     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1104         16  PI-AM-NAME                  PIC X(30).
  1105         16  PI-MAP-NAME                 PIC X(8).
  1106         16  PI-BATCH-AMOUNTS    COMP-3.
  1107             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
  1108             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
  1109             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
  1110             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
  1111             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
  1112             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
  1113             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
  1114             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
  1115             20  PI-ISS-CNT-REMITTED     PIC S9(5).
  1116             20  PI-ISS-CNT-ENTERED      PIC S9(5).
  1117             20  PI-CAN-CNT-REMITTED     PIC S9(5).
  1118             20  PI-CAN-CNT-ENTERED      PIC S9(5).
  1119         16  PI-MAINT-FUNC               PIC X.
  1120         16  PI-ERROR-SW                 PIC X.
  1121             88  PI-DATA-ERRORS              VALUE 'Y'.
  1122         16  PI-UPDATE-SW                PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  23
* VP6301.cbl
  1123             88  PI-DATA-UPDATED             VALUE 'Y'.
  1124         16  PI-DISPLAY-SW               PIC X.
  1125             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
  1126         16  PI-SAVE-CALLING-PGM         PIC X(8).
  1127         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4) COMP.
  1128         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4) COMP.
  1129         16  PI-SAV-CARRIER              PIC X.
  1130         16  PI-SAV-GROUPING             PIC X(6).
  1131         16  PI-SAV-STATE                PIC XX.
  1132         16  PI-SAV-ACCOUNT              PIC X(10).
  1133         16  PI-SAV-CERT-EFF-DT          PIC XX.
  1134         16  PI-SAV-CERT-NO.
  1135             20  PI-SAV-CERT-PRIME       PIC X(14).
  1136             20  PI-SAV-CERT-SFX         PIC X.
  1137         16  PI-PYAJ-REFERENCE REDEFINES PI-SAV-CERT-NO.
  1138             20  PI-SAV-PYAJ-REFERENCE   PIC X(12).
  1139             20  FILLER                  PIC X(3).
  1140         16  PI-SAV-ENDING-ERPNDB-KEY.
  1141             20  PI-SAV-COMP-CD          PIC X.
  1142             20  PI-SAV-ENTRY-BATCH      PIC X(6).
  1143             20  PI-SAV-BATCH-SEQ        PIC S9(4) COMP.
  1144             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4) COMP.
  1145         16  PI-SAV-REFERENCE            PIC X(12).
  1146         16  PI-SAV-FULL-CONTROL.
  1147             20  PI-SAV-FC-CARRIER       PIC X.
  1148             20  PI-SAV-FC-GROUPING      PIC X(6).
  1149             20  PI-SAV-FC-STATE         PIC XX.
  1150         16  PI-VERIFY-DELETE-SW         PIC X.
  1151             88  PI-DELETE-IS-OK             VALUE 'Y'.
  1152         16  PI-EL630-FIRST-TIME-SW      PIC X.
  1153             88  PI-EL630-FIRST-TIME         VALUE SPACE.
  1154         16  PI-CREDIT-EDIT-CONTROLS.
  1155             20  PI-MIN-PREMIUM          PIC S9(3)V99  COMP-3.
  1156             20  PI-MIN-AGE              PIC 99.
  1157             20  PI-DEFAULT-AGE          PIC 99.
  1158             20  PI-MIN-TERM             PIC S9(3)     COMP-3.
  1159             20  PI-MAX-TERM             PIC S9(3)     COMP-3.
  1160             20  PI-DEFAULT-SEX          PIC X.
  1161             20  PI-JOINT-AGE-INPUT      PIC X.
  1162                 88 PI-JOINT-AGE-IS-INPUT       VALUE '1'.
  1163             20  PI-BIRTH-DATE-INPUT     PIC X.
  1164                 88 PI-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1165         16  PI-KEYED-SWITCHES.
  1166             20  PI-ISS-SUFFIX-KEYED-SW  PIC X.
  1167                 88  PI-ISS-SUFFIX-KEYED     VALUE 'Y'.
  1168             20  PI-CAN-SUFFIX-KEYED-SW  PIC X.
  1169                 88  PI-CAN-SUFFIX-KEYED     VALUE 'Y'.
  1170             20  PI-IG-KEYED-SW          PIC X.
  1171                 88  PI-IG-KEYED             VALUE 'Y'.
  1172             20  PI-APR-KEYED-SW         PIC X.
  1173                 88  PI-APR-KEYED            VALUE 'Y'.
  1174*            20  PI-FREQ-KEYED-SW        PIC X.
  1175*                88  PI-FREQ-KEYED           VALUE 'Y'.
  1176             20  PI-VIN-KEYED-SW         PIC X.
  1177                 88  PI-VIN-KEYED            VALUE 'Y'.
  1178             20  PI-SIG-KEYED-SW         PIC X.
  1179                 88  PI-SIG-KEYED            VALUE 'Y'.
  1180             20  PI-LFRT-KEYED-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  24
* VP6301.cbl
  1181                 88  PI-LFRT-KEYED           VALUE 'Y'.
  1182             20  PI-AHRT-KEYED-SW        PIC X.
  1183                 88  PI-AHRT-KEYED           VALUE 'Y'.
  1184             20  PI-SSNUM-KEYED-SW       PIC X.
  1185                 88  PI-SSNUM-KEYED          VALUE 'Y'.
  1186             20  PI-JNT-SSNUM-KEYED-SW   PIC X.
  1187                 88  PI-JNT-SSNUM-KEYED      VALUE 'Y'.
  1188             20  PI-MEMBER-KEYED-SW      PIC X.
  1189                 88  PI-MEMBER-KEYED         VALUE 'Y'.
  1190             20  PI-MODE-KEYED-SW        PIC X.
  1191                 88  PI-MODE-KEYED           VALUE 'Y'.
  1192             20  PI-PMTS-KEYED-SW        PIC X.
  1193                 88  PI-PMTS-KEYED           VALUE 'Y'.
  1194             20  PI-LN-OFFICER-KEYED-SW  PIC X.
  1195                 88  PI-LN-OFFICER-KEYED     VALUE 'Y'.
  1196             20  PI-ENTRY-KEYED-SW       PIC X.
  1197                 88  PI-ENTRY-KEYED          VALUE 'Y'.
  1198             20  PI-FORCE-KEYED-SW       PIC X.
  1199                 88  PI-FORCE-KEYED          VALUE 'Y'.
  1200             20  PI-RINCD-KEYED-SW       PIC X.
  1201                 88  PI-RINCD-KEYED          VALUE 'Y'.
  1202             20  PI-BILLCD-KEYED-SW      PIC X.
  1203                 88  PI-BILLCD-KEYED         VALUE 'Y'.
  1204             20  PI-RTCLS-KEYED-SW       PIC X.
  1205                 88  PI-RTCLS-KEYED          VALUE 'Y'.
  1206             20  PI-LNTRM-KEYED-SW       PIC X.
  1207                 88  PI-LNTRM-KEYED          VALUE 'Y'.
  1208             20  PI-EXPIR-KEYED-SW       PIC X.
  1209                 88  PI-EXPIR-KEYED          VALUE 'Y'.
  1210             20  PI-PMT-KEYED-SW         PIC X.
  1211                 88  PI-PMT-KEYED            VALUE 'Y'.
  1212             20  PI-1ST-PMT-KEYED-SW     PIC X.
  1213                 88  PI-1ST-PMT-KEYED        VALUE 'Y'.
  1214             20  PI-DAYS-KEYED-SW        PIC X.
  1215                 88  PI-DAYS-KEYED           VALUE 'Y'.
  1216             20  PI-SKPCD-KEYED-SW       PIC X.
  1217                 88  PI-SKPCD-KEYED          VALUE 'Y'.
  1218             20  PI-JNT-AGE-KEYED-SW     PIC X.
  1219                 88  PI-JNT-AGE-KEYED        VALUE 'Y'.
  1220             20  PI-JNT-NAME-KEYED-SW    PIC X.
  1221                 88  PI-JNT-NAME-KEYED       VALUE 'Y'.
  1222             20  PI-ISS-LIVES-KEYED-SW   PIC X.
  1223                 88  PI-ISS-LIVES-KEYED      VALUE 'Y'.
  1224             20  PI-CAN-LIVES-KEYED-SW   PIC X.
  1225                 88  PI-CAN-LIVES-KEYED      VALUE 'Y'.
  1226             20  PI-PAYEE-KEYED-SW       PIC X.
  1227                 88  PI-PAYEE-KEYED          VALUE 'Y'.
  1228             20  PI-CHK-REQ-KEYED-SW     PIC X.
  1229                 88  PI-CHK-REQ-KEYED        VALUE 'Y'.
  1230             20  PI-ZIP4-KEYED-SW        PIC X.
  1231                 88  PI-ZIP4-KEYED           VALUE 'Y'.
  1232             20  PI-POLICY-KEYED-SW      PIC X.
  1233                 88  PI-POLICY-KEYED         VALUE 'Y'.
  1234             20  PI-EXPIRE-KEYED-SW      PIC X.
  1235                 88  PI-EXPIRE-KEYED         VALUE 'Y'.
  1236             20  PI-CRIT-PERD-KEYED-SW    PIC X.
  1237                 88  PI-CRIT-PERD-KEYED      VALUE 'Y'.
  1238             20  PI-BENEFICIARY-KEYED-SW PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  25
* VP6301.cbl
  1239                 88  PI-BENEFICIARY-KEYED    VALUE 'Y'.
  1240             20  PI-PHONE-KEYED-SW       PIC X.
  1241                 88  PI-PHONE-KEYED          VALUE 'Y'.
  1242             20  PI-ALT-BEN-KEYED-SW     PIC X.
  1243                 88  PI-ALT-BEN-KEYED        VALUE 'Y'.
  1244             20  PI-ALT-PREM-KEYED-SW    PIC X.
  1245                 88  PI-ALT-PREM-KEYED       VALUE 'Y'.
  1246             20  PI-REFUND-MTHD-KEYED-SW PIC X.
  1247                 88  PI-REFUND-MTHD-KEYED    VALUE 'Y'.
  1248         16  PI-ACCT-LOW-EFF-DT          PIC XX.
  1249         16  PI-ACCT-HIGH-EXP-DT         PIC XX.
  1250         16  PI-BATCH-EOF-SW             PIC X.
  1251             88  PI-BATCH-EOF                VALUE 'Y'.
  1252         16  PI-NB-MONTH-END-DT          PIC XX.
  1253         16  PI-ISSUE-ADDED-SW           PIC X.
  1254             88  PI-ISSUE-ADDED              VALUE 'Y'.
  1255         16  PI-BROWSE-SW                PIC X.
  1256             88  PI-BROWSE                   VALUE 'Y'.
  1257         16  PI-ACCT-AGENT-ERROR-SW      PIC X.
  1258             88  PI-ACCT-AGENT-ERROR         VALUE 'Y'.
  1259         16  PI-FIN-RESP-ERROR-SW        PIC X.
  1260             88  PI-FIN-RESP-ERROR           VALUE 'Y'.
  1261         16  PI-CAN-REA-KEYED-SW         PIC X.
  1262             88  PI-CAN-REA-KEYED            VALUE 'Y'.
  1263         16  PI-AM-EDIT-LOAN-OFC         PIC X.
  1264         16  PI-AM-ADDR1                 PIC X(30).
  1265         16  PI-AM-ADDR2                 PIC X(30).
  1266         16  PI-AM-CITYST.
  1267             20  PI-AM-CITY              PIC X(28).
  1268             20  PI-AM-STATE             PIC XX.
  1269         16  PI-AM-ZIP                   PIC X(9).
  1270         16  FILLER                      PIC X(290).
  1271*        16  FILLER                      PIC X(390).
  1272     12  PI-MISC.
  1273         16  PI-ACCT-DATE-RANGES OCCURS 32 TIMES.
  1274             20  PI-ACCT-EFF-DT          PIC XX.
  1275             20  PI-ACCT-EXP-DT          PIC XX.
  1276             20  PI-REMIT-AGENT          PIC X(10).
  1277             20  PI-ACCT-AGENT           PIC X(10).
  1278         16  PI-ACCOUNT-AGENT            PIC X(10).
  1279         16  PI-FIN-RESP                 PIC X(10).
  1280         16  PI-SUMMARY-CODE             PIC X(6).
  1281         16  PI-SUB                      PIC S9(4) COMP.
  1282         16  PI-COMP-CARRIER             PIC X.
  1283         16  PI-COMP-GROUPING            PIC X(6).
  1284         16  PI-ACCT-AGENT-PROCESSED-SW  PIC X.
  1285             88  PI-ACCT-AGENT-PROCESSED     VALUE 'Y'.
  1286         16  PI-CLEAR-ERROR-SW           PIC X.
  1287             88  PI-CLEAR-ERROR              VALUE 'Y'.
  1288         16  PI-AGE-KEYED-SW             PIC X.
  1289             88  PI-AGE-KEYED                VALUE 'Y'.
  1290         16  PI-BIRTHDT-KEYED-SW         PIC X.
  1291             88  PI-BIRTHDT-KEYED            VALUE 'Y'.
  1292         16  PI-RECEIVED-DT              PIC XX.
  1293         16  PI-CSR-ID                   PIC X(4).
  1294
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  26
* VP6301.cbl
  1296*                                COPY ELCJPFX.
  1297******************************************************************
  1298*                                                                *
  1299*                                                                *
  1300*                            ELCJPFX.                            *
  1301*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1302*                            VMOD=2.002                          *
  1303*                                                                *
  1304*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1305*                                                                *
  1306*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1307*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1308*        ELCNTL - CONTROL FILE                                   *
  1309*        ELMSTR - CLAIM MASTERS                                  *
  1310*        ELTRLR - ACTIVITY TRAILERS                              *
  1311*        ELCHKQ - CHECK QUE                                      *
  1312******************************************************************
  1313 01  JOURNAL-RECORD.
  1314     12  jp-date                     pic s9(5) comp-3.
  1315     12  jp-time                     pic s9(7) comp-3.
  1316     12  JP-USER-ID                  PIC X(4).
  1317     12  JP-FILE-ID                  PIC X(8).
  1318     12  JP-PROGRAM-ID               PIC X(8).
  1319     12  JP-RECORD-TYPE              PIC X.
  1320         88 JP-ADD              VALUE 'A'.
  1321         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1322         88 JP-AFTER-CHANGE     VALUE 'C'.
  1323         88 JP-DELETE           VALUE 'D'.
  1324         88 JP-GENERIC-DELETE   VALUE 'G'.
  1325         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1326         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1327     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1328     12  JP-RECORD-AREA
  1329
  1330
  1331                                 PIC X(608).
  1332*                                COPY ELCAID.
  1333******************************************************************
  1334*                                                                *
  1335*                            ELCAID.                             *
  1336*                            VMOD=2.001                          *
  1337*                                                                *
  1338*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1339*                                                                *
  1340*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1341*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1342******************************************************************
  1343
  1344 01  DFHAID.
  1345   02  DFHNULL   PIC  X  VALUE  ' '.
  1346   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1347   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1348   02  DFHPEN    PIC  X  VALUE  '='.
  1349   02  DFHOPID   PIC  X  VALUE  'W'.
  1350   02  DFHPA1    PIC  X  VALUE  '%'.
  1351   02  DFHPA2    PIC  X  VALUE  '>'.
  1352   02  DFHPA3    PIC  X  VALUE  ','.
  1353   02  DFHPF1    PIC  X  VALUE  '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  27
* VP6301.cbl
  1354   02  DFHPF2    PIC  X  VALUE  '2'.
  1355   02  DFHPF3    PIC  X  VALUE  '3'.
  1356   02  DFHPF4    PIC  X  VALUE  '4'.
  1357   02  DFHPF5    PIC  X  VALUE  '5'.
  1358   02  DFHPF6    PIC  X  VALUE  '6'.
  1359   02  DFHPF7    PIC  X  VALUE  '7'.
  1360   02  DFHPF8    PIC  X  VALUE  '8'.
  1361   02  DFHPF9    PIC  X  VALUE  '9'.
  1362   02  DFHPF10   PIC  X  VALUE  ':'.
  1363   02  DFHPF11   PIC  X  VALUE  '#'.
  1364   02  DFHPF12   PIC  X  VALUE  '@'.
  1365   02  DFHPF13   PIC  X  VALUE  'A'.
  1366   02  DFHPF14   PIC  X  VALUE  'B'.
  1367   02  DFHPF15   PIC  X  VALUE  'C'.
  1368   02  DFHPF16   PIC  X  VALUE  'D'.
  1369   02  DFHPF17   PIC  X  VALUE  'E'.
  1370   02  DFHPF18   PIC  X  VALUE  'F'.
  1371   02  DFHPF19   PIC  X  VALUE  'G'.
  1372   02  DFHPF20   PIC  X  VALUE  'H'.
  1373   02  DFHPF21   PIC  X  VALUE  'I'.
  1374*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1375   02  DFHPF22   PIC  X  VALUE  '['.
  1376   02  DFHPF23   PIC  X  VALUE  '.'.
  1377   02  DFHPF24   PIC  X  VALUE  '<'.
  1378   02  DFHMSRE   PIC  X  VALUE  'X'.
  1379   02  DFHSTRF   PIC  X  VALUE  'h'.
  1380   02  DFHTRIG   PIC  X  VALUE  '"'.
  1381 01  FILLER    REDEFINES DFHAID.
  1382     12  FILLER              PIC X(8).
  1383     12  PF-VALUES           PIC X       OCCURS 2.
  1384*                                COPY VP6301S.
  1385 01  VP630BI.
  1386     05  FILLER            PIC  X(0012).
  1387*    -------------------------------
  1388     05  BDATEL PIC S9(0004) COMP.
  1389     05  BDATEF PIC  X(0001).
  1390     05  FILLER REDEFINES BDATEF.
  1391         10  BDATEA PIC  X(0001).
  1392     05  BDATEI PIC  X(0008).
  1393*    -------------------------------
  1394     05  BTIMEL PIC S9(0004) COMP.
  1395     05  BTIMEF PIC  X(0001).
  1396     05  FILLER REDEFINES BTIMEF.
  1397         10  BTIMEA PIC  X(0001).
  1398     05  BTIMEI PIC  X(0005).
  1399*    -------------------------------
  1400     05  BBATCHL PIC S9(0004) COMP.
  1401     05  BBATCHF PIC  X(0001).
  1402     05  FILLER REDEFINES BBATCHF.
  1403         10  BBATCHA PIC  X(0001).
  1404     05  BBATCHI PIC  X(0008).
  1405*    -------------------------------
  1406     05  BSEQL PIC S9(0004) COMP.
  1407     05  BSEQF PIC  X(0001).
  1408     05  FILLER REDEFINES BSEQF.
  1409         10  BSEQA PIC  X(0001).
  1410     05  BSEQI PIC  X(0004).
  1411*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  28
* VP6301.cbl
  1412     05  BMOENDL PIC S9(0004) COMP.
  1413     05  BMOENDF PIC  X(0001).
  1414     05  FILLER REDEFINES BMOENDF.
  1415         10  BMOENDA PIC  X(0001).
  1416     05  BMOENDI PIC  X(0008).
  1417*    -------------------------------
  1418     05  BACCTNML PIC S9(0004) COMP.
  1419     05  BACCTNMF PIC  X(0001).
  1420     05  FILLER REDEFINES BACCTNMF.
  1421         10  BACCTNMA PIC  X(0001).
  1422     05  BACCTNMI PIC  X(0030).
  1423*    -------------------------------
  1424     05  BEFFDTL PIC S9(0004) COMP.
  1425     05  BEFFDTF PIC  X(0001).
  1426     05  FILLER REDEFINES BEFFDTF.
  1427         10  BEFFDTA PIC  X(0001).
  1428     05  BEFFDTI PIC  X(0006).
  1429*    -------------------------------
  1430     05  BCERTL PIC S9(0004) COMP.
  1431     05  BCERTF PIC  X(0001).
  1432     05  FILLER REDEFINES BCERTF.
  1433         10  BCERTA PIC  X(0001).
  1434     05  BCERTI PIC  X(0010).
  1435*    -------------------------------
  1436     05  BSFXL PIC S9(0004) COMP.
  1437     05  BSFXF PIC  X(0001).
  1438     05  FILLER REDEFINES BSFXF.
  1439         10  BSFXA PIC  X(0001).
  1440     05  BSFXI PIC  X(0001).
  1441*    -------------------------------
  1442     05  BLONOFCL PIC S9(0004) COMP.
  1443     05  BLONOFCF PIC  X(0001).
  1444     05  FILLER REDEFINES BLONOFCF.
  1445         10  BLONOFCA PIC  X(0001).
  1446     05  BLONOFCI PIC  X(0005).
  1447*    -------------------------------
  1448     05  B1STNML PIC S9(0004) COMP.
  1449     05  B1STNMF PIC  X(0001).
  1450     05  FILLER REDEFINES B1STNMF.
  1451         10  B1STNMA PIC  X(0001).
  1452     05  B1STNMI PIC  X(0010).
  1453*    -------------------------------
  1454     05  BINTL PIC S9(0004) COMP.
  1455     05  BINTF PIC  X(0001).
  1456     05  FILLER REDEFINES BINTF.
  1457         10  BINTA PIC  X(0001).
  1458     05  BINTI PIC  X(0001).
  1459*    -------------------------------
  1460     05  BLASTNML PIC S9(0004) COMP.
  1461     05  BLASTNMF PIC  X(0001).
  1462     05  FILLER REDEFINES BLASTNMF.
  1463         10  BLASTNMA PIC  X(0001).
  1464     05  BLASTNMI PIC  X(0015).
  1465*    -------------------------------
  1466     05  BAGEL PIC S9(0004) COMP.
  1467     05  BAGEF PIC  X(0001).
  1468     05  FILLER REDEFINES BAGEF.
  1469         10  BAGEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  29
* VP6301.cbl
  1470     05  BAGEI PIC  X(0002).
  1471*    -------------------------------
  1472     05  BSEXL PIC S9(0004) COMP.
  1473     05  BSEXF PIC  X(0001).
  1474     05  FILLER REDEFINES BSEXF.
  1475         10  BSEXA PIC  X(0001).
  1476     05  BSEXI PIC  X(0001).
  1477*    -------------------------------
  1478     05  BJNT1STL PIC S9(0004) COMP.
  1479     05  BJNT1STF PIC  X(0001).
  1480     05  FILLER REDEFINES BJNT1STF.
  1481         10  BJNT1STA PIC  X(0001).
  1482     05  BJNT1STI PIC  X(0010).
  1483*    -------------------------------
  1484     05  BJNTINTL PIC S9(0004) COMP.
  1485     05  BJNTINTF PIC  X(0001).
  1486     05  FILLER REDEFINES BJNTINTF.
  1487         10  BJNTINTA PIC  X(0001).
  1488     05  BJNTINTI PIC  X(0001).
  1489*    -------------------------------
  1490     05  BJNTNAML PIC S9(0004) COMP.
  1491     05  BJNTNAMF PIC  X(0001).
  1492     05  FILLER REDEFINES BJNTNAMF.
  1493         10  BJNTNAMA PIC  X(0001).
  1494     05  BJNTNAMI PIC  X(0015).
  1495*    -------------------------------
  1496     05  BJNTAGEL PIC S9(0004) COMP.
  1497     05  BJNTAGEF PIC  X(0001).
  1498     05  FILLER REDEFINES BJNTAGEF.
  1499         10  BJNTAGEA PIC  X(0001).
  1500     05  BJNTAGEI PIC  X(0002).
  1501*    -------------------------------
  1502     05  BADDRS1L PIC S9(0004) COMP.
  1503     05  BADDRS1F PIC  X(0001).
  1504     05  FILLER REDEFINES BADDRS1F.
  1505         10  BADDRS1A PIC  X(0001).
  1506     05  BADDRS1I PIC  X(0030).
  1507*    -------------------------------
  1508     05  BADDRS2L PIC S9(0004) COMP.
  1509     05  BADDRS2F PIC  X(0001).
  1510     05  FILLER REDEFINES BADDRS2F.
  1511         10  BADDRS2A PIC  X(0001).
  1512     05  BADDRS2I PIC  X(0030).
  1513*    -------------------------------
  1514     05  BCITYL PIC S9(0004) COMP.
  1515     05  BCITYF PIC  X(0001).
  1516     05  FILLER REDEFINES BCITYF.
  1517         10  BCITYA PIC  X(0001).
  1518     05  BCITYI PIC  X(0028).
  1519*    -------------------------------
  1520     05  BSTATEL PIC S9(0004) COMP.
  1521     05  BSTATEF PIC  X(0001).
  1522     05  FILLER REDEFINES BSTATEF.
  1523         10  BSTATEA PIC  X(0001).
  1524     05  BSTATEI PIC  X(0002).
  1525*    -------------------------------
  1526     05  BZIPCDEL PIC S9(0004) COMP.
  1527     05  BZIPCDEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  30
* VP6301.cbl
  1528     05  FILLER REDEFINES BZIPCDEF.
  1529         10  BZIPCDEA PIC  X(0001).
  1530     05  BZIPCDEI PIC  X(0010).
  1531*    -------------------------------
  1532     05  BYEARL PIC S9(0004) COMP.
  1533     05  BYEARF PIC  X(0001).
  1534     05  FILLER REDEFINES BYEARF.
  1535         10  BYEARA PIC  X(0001).
  1536     05  BYEARI PIC  X(0004).
  1537*    -------------------------------
  1538     05  BMAKEL PIC S9(0004) COMP.
  1539     05  BMAKEF PIC  X(0001).
  1540     05  FILLER REDEFINES BMAKEF.
  1541         10  BMAKEA PIC  X(0001).
  1542     05  BMAKEI PIC  X(0020).
  1543*    -------------------------------
  1544     05  BMODELL PIC S9(0004) COMP.
  1545     05  BMODELF PIC  X(0001).
  1546     05  FILLER REDEFINES BMODELF.
  1547         10  BMODELA PIC  X(0001).
  1548     05  BMODELI PIC  X(0020).
  1549*    -------------------------------
  1550     05  BFUTUREL PIC S9(0004) COMP.
  1551     05  BFUTUREF PIC  X(0001).
  1552     05  FILLER REDEFINES BFUTUREF.
  1553         10  BFUTUREA PIC  X(0001).
  1554     05  BFUTUREI PIC  X(0020).
  1555*    -------------------------------
  1556     05  BVINHDL PIC S9(0004) COMP.
  1557     05  BVINHDF PIC  X(0001).
  1558     05  FILLER REDEFINES BVINHDF.
  1559         10  BVINHDA PIC  X(0001).
  1560     05  BVINHDI PIC  X(0005).
  1561*    -------------------------------
  1562     05  BVINL PIC S9(0004) COMP.
  1563     05  BVINF PIC  X(0001).
  1564     05  FILLER REDEFINES BVINF.
  1565         10  BVINA PIC  X(0001).
  1566     05  BVINI PIC  X(0017).
  1567*    -------------------------------
  1568     05  BOMETERL PIC S9(0004) COMP.
  1569     05  BOMETERF PIC  X(0001).
  1570     05  FILLER REDEFINES BOMETERF.
  1571         10  BOMETERA PIC  X(0001).
  1572     05  BOMETERI PIC  X(0007).
  1573*    -------------------------------
  1574     05  BNFICRYL PIC S9(0004) COMP.
  1575     05  BNFICRYF PIC  X(0001).
  1576     05  FILLER REDEFINES BNFICRYF.
  1577         10  BNFICRYA PIC  X(0001).
  1578     05  BNFICRYI PIC  X(0025).
  1579*    -------------------------------
  1580     05  BCADDR1L PIC S9(0004) COMP.
  1581     05  BCADDR1F PIC  X(0001).
  1582     05  FILLER REDEFINES BCADDR1F.
  1583         10  BCADDR1A PIC  X(0001).
  1584     05  BCADDR1I PIC  X(0030).
  1585*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  31
* VP6301.cbl
  1586     05  BCADDR2L PIC S9(0004) COMP.
  1587     05  BCADDR2F PIC  X(0001).
  1588     05  FILLER REDEFINES BCADDR2F.
  1589         10  BCADDR2A PIC  X(0001).
  1590     05  BCADDR2I PIC  X(0030).
  1591*    -------------------------------
  1592     05  BCCITYL PIC S9(0004) COMP.
  1593     05  BCCITYF PIC  X(0001).
  1594     05  FILLER REDEFINES BCCITYF.
  1595         10  BCCITYA PIC  X(0001).
  1596     05  BCCITYI PIC  X(0028).
  1597*    -------------------------------
  1598     05  BCSTATEL PIC S9(0004) COMP.
  1599     05  BCSTATEF PIC  X(0001).
  1600     05  FILLER REDEFINES BCSTATEF.
  1601         10  BCSTATEA PIC  X(0001).
  1602     05  BCSTATEI PIC  X(0002).
  1603*    -------------------------------
  1604     05  BCZIPCDL PIC S9(0004) COMP.
  1605     05  BCZIPCDF PIC  X(0001).
  1606     05  FILLER REDEFINES BCZIPCDF.
  1607         10  BCZIPCDA PIC  X(0001).
  1608     05  BCZIPCDI PIC  X(0010).
  1609*    -------------------------------
  1610     05  BKIND1L PIC S9(0004) COMP.
  1611     05  BKIND1F PIC  X(0001).
  1612     05  FILLER REDEFINES BKIND1F.
  1613         10  BKIND1A PIC  X(0001).
  1614     05  BKIND1I PIC  X(0002).
  1615*    -------------------------------
  1616     05  BTYPE1L PIC S9(0004) COMP.
  1617     05  BTYPE1F PIC  X(0001).
  1618     05  FILLER REDEFINES BTYPE1F.
  1619         10  BTYPE1A PIC  X(0001).
  1620     05  BTYPE1I PIC  X(0003).
  1621*    -------------------------------
  1622     05  BTRM1L PIC S9(0004) COMP.
  1623     05  BTRM1F PIC  X(0001).
  1624     05  FILLER REDEFINES BTRM1F.
  1625         10  BTRM1A PIC  X(0001).
  1626     05  BTRM1I PIC  X(0003).
  1627*    -------------------------------
  1628     05  BBEN1L PIC S9(0004) COMP.
  1629     05  BBEN1F PIC  X(0001).
  1630     05  FILLER REDEFINES BBEN1F.
  1631         10  BBEN1A PIC  X(0001).
  1632     05  BBEN1I PIC  X(0012).
  1633*    -------------------------------
  1634     05  BPRM1L PIC S9(0004) COMP.
  1635     05  BPRM1F PIC  X(0001).
  1636     05  FILLER REDEFINES BPRM1F.
  1637         10  BPRM1A PIC  X(0001).
  1638     05  BPRM1I PIC  X(0011).
  1639*    -------------------------------
  1640     05  BALTBN1L PIC S9(0004) COMP.
  1641     05  BALTBN1F PIC  X(0001).
  1642     05  FILLER REDEFINES BALTBN1F.
  1643         10  BALTBN1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  32
* VP6301.cbl
  1644     05  BALTBN1I PIC  X(0012).
  1645*    -------------------------------
  1646     05  BALTPM1L PIC S9(0004) COMP.
  1647     05  BALTPM1F PIC  X(0001).
  1648     05  FILLER REDEFINES BALTPM1F.
  1649         10  BALTPM1A PIC  X(0001).
  1650     05  BALTPM1I PIC  X(0009).
  1651*    -------------------------------
  1652     05  BKIND2L PIC S9(0004) COMP.
  1653     05  BKIND2F PIC  X(0001).
  1654     05  FILLER REDEFINES BKIND2F.
  1655         10  BKIND2A PIC  X(0001).
  1656     05  BKIND2I PIC  X(0002).
  1657*    -------------------------------
  1658     05  BTYPE2L PIC S9(0004) COMP.
  1659     05  BTYPE2F PIC  X(0001).
  1660     05  FILLER REDEFINES BTYPE2F.
  1661         10  BTYPE2A PIC  X(0001).
  1662     05  BTYPE2I PIC  X(0003).
  1663*    -------------------------------
  1664     05  BTRM2L PIC S9(0004) COMP.
  1665     05  BTRM2F PIC  X(0001).
  1666     05  FILLER REDEFINES BTRM2F.
  1667         10  BTRM2A PIC  X(0001).
  1668     05  BTRM2I PIC  X(0003).
  1669*    -------------------------------
  1670     05  BBEN2L PIC S9(0004) COMP.
  1671     05  BBEN2F PIC  X(0001).
  1672     05  FILLER REDEFINES BBEN2F.
  1673         10  BBEN2A PIC  X(0001).
  1674     05  BBEN2I PIC  X(0012).
  1675*    -------------------------------
  1676     05  BPRM2L PIC S9(0004) COMP.
  1677     05  BPRM2F PIC  X(0001).
  1678     05  FILLER REDEFINES BPRM2F.
  1679         10  BPRM2A PIC  X(0001).
  1680     05  BPRM2I PIC  X(0011).
  1681*    -------------------------------
  1682     05  BCP2L PIC S9(0004) COMP.
  1683     05  BCP2F PIC  X(0001).
  1684     05  FILLER REDEFINES BCP2F.
  1685         10  BCP2A PIC  X(0001).
  1686     05  BCP2I PIC  X(0002).
  1687*    -------------------------------
  1688     05  BALTBN2L PIC S9(0004) COMP.
  1689     05  BALTBN2F PIC  X(0001).
  1690     05  FILLER REDEFINES BALTBN2F.
  1691         10  BALTBN2A PIC  X(0001).
  1692     05  BALTBN2I PIC  X(0012).
  1693*    -------------------------------
  1694     05  BALTPM2L PIC S9(0004) COMP.
  1695     05  BALTPM2F PIC  X(0001).
  1696     05  FILLER REDEFINES BALTPM2F.
  1697         10  BALTPM2A PIC  X(0001).
  1698     05  BALTPM2I PIC  X(0009).
  1699*    -------------------------------
  1700     05  BERMSG1L PIC S9(0004) COMP.
  1701     05  BERMSG1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  33
* VP6301.cbl
  1702     05  FILLER REDEFINES BERMSG1F.
  1703         10  BERMSG1A PIC  X(0001).
  1704     05  BERMSG1I PIC  X(0079).
  1705*    -------------------------------
  1706     05  BERMSG2L PIC S9(0004) COMP.
  1707     05  BERMSG2F PIC  X(0001).
  1708     05  FILLER REDEFINES BERMSG2F.
  1709         10  BERMSG2A PIC  X(0001).
  1710     05  BERMSG2I PIC  X(0079).
  1711*    -------------------------------
  1712     05  BPFENTRL PIC S9(0004) COMP.
  1713     05  BPFENTRF PIC  X(0001).
  1714     05  FILLER REDEFINES BPFENTRF.
  1715         10  BPFENTRA PIC  X(0001).
  1716     05  BPFENTRI PIC  9(2).
  1717*    -------------------------------
  1718     05  BDELHDGL PIC S9(0004) COMP.
  1719     05  BDELHDGF PIC  X(0001).
  1720     05  FILLER REDEFINES BDELHDGF.
  1721         10  BDELHDGA PIC  X(0001).
  1722     05  BDELHDGI PIC  X(0017).
  1723 01  VP630BO REDEFINES VP630BI.
  1724     05  FILLER            PIC  X(0012).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
  1727     05  BDATEO PIC  X(0008).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  BTIMEO PIC  99.99.
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  BBATCHO PIC  X(0008).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  BSEQO PIC  X(0004).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  BMOENDO PIC  X(0008).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  BACCTNMO PIC  X(0030).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  BEFFDTO PIC  X(0006).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  BCERTO PIC  X(0010).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  BSFXO PIC  X(0001).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  BLONOFCO PIC  X(0005).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  B1STNMO PIC  X(0010).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  34
* VP6301.cbl
  1760     05  BINTO PIC  X(0001).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  BLASTNMO PIC  X(0015).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  BAGEO PIC  X(0002).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  BSEXO PIC  X(0001).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  BJNT1STO PIC  X(0010).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  BJNTINTO PIC  X(0001).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  BJNTNAMO PIC  X(0015).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  BJNTAGEO PIC  X(0002).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  BADDRS1O PIC  X(0030).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  BADDRS2O PIC  X(0030).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  BCITYO PIC  X(0028).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  BSTATEO PIC  X(0002).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  BZIPCDEO PIC  X(0010).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  BYEARO PIC  X(0004).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  BMAKEO PIC  X(0020).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  BMODELO PIC  X(0020).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  BFUTUREO PIC  X(0020).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  BVINHDO PIC  X(0005).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  BVINO PIC  X(0017).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  BOMETERO PIC  X(0007).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  35
* VP6301.cbl
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  BNFICRYO PIC  X(0025).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  BCADDR1O PIC  X(0030).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  BCADDR2O PIC  X(0030).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  BCCITYO PIC  X(0028).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  BCSTATEO PIC  X(0002).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  BCZIPCDO PIC  X(0010).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  BKIND1O PIC  X(0002).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  BTYPE1O PIC  X(0003).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  BTRM1O PIC  X(0003).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  BBEN1O PIC  X(0012).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  BPRM1O PIC  X(0011).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  BALTBN1O PIC  X(0012).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  BALTPM1O PIC  X(0009).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  BKIND2O PIC  X(0002).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  BTYPE2O PIC  X(0003).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  BTRM2O PIC  X(0003).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  BBEN2O PIC  X(0012).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  BPRM2O PIC  X(0011).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  BCP2O PIC  X(0002).
  1875*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  36
* VP6301.cbl
  1876     05  FILLER            PIC  X(0003).
  1877     05  BALTBN2O PIC  X(0012).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  BALTPM2O PIC  X(0009).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  BERMSG1O PIC  X(0079).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  BERMSG2O PIC  X(0079).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  BPFENTRO PIC  99.
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  BDELHDGO PIC  X(0017).
  1893*    -------------------------------
  1894 01  VP630CI REDEFINES VP630BI.
  1895     05  FILLER            PIC  X(0012).
  1896*    -------------------------------
  1897     05  CDATEL PIC S9(0004) COMP.
  1898     05  CDATEF PIC  X(0001).
  1899     05  FILLER REDEFINES CDATEF.
  1900         10  CDATEA PIC  X(0001).
  1901     05  CDATEI PIC  X(0008).
  1902*    -------------------------------
  1903     05  CTIMEL PIC S9(0004) COMP.
  1904     05  CTIMEF PIC  X(0001).
  1905     05  FILLER REDEFINES CTIMEF.
  1906         10  CTIMEA PIC  X(0001).
  1907     05  CTIMEI PIC  X(0005).
  1908*    -------------------------------
  1909     05  CBATCHL PIC S9(0004) COMP.
  1910     05  CBATCHF PIC  X(0001).
  1911     05  FILLER REDEFINES CBATCHF.
  1912         10  CBATCHA PIC  X(0001).
  1913     05  CBATCHI PIC  X(0008).
  1914*    -------------------------------
  1915     05  CMOENDL PIC S9(0004) COMP.
  1916     05  CMOENDF PIC  X(0001).
  1917     05  FILLER REDEFINES CMOENDF.
  1918         10  CMOENDA PIC  X(0001).
  1919     05  CMOENDI PIC  X(0008).
  1920*    -------------------------------
  1921     05  CACCTNML PIC S9(0004) COMP.
  1922     05  CACCTNMF PIC  X(0001).
  1923     05  FILLER REDEFINES CACCTNMF.
  1924         10  CACCTNMA PIC  X(0001).
  1925     05  CACCTNMI PIC  X(0030).
  1926*    -------------------------------
  1927     05  CSEQ1L PIC S9(0004) COMP.
  1928     05  CSEQ1F PIC  X(0001).
  1929     05  FILLER REDEFINES CSEQ1F.
  1930         10  CSEQ1A PIC  X(0001).
  1931     05  CSEQ1I PIC  X(0004).
  1932*    -------------------------------
  1933     05  CCERT1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  37
* VP6301.cbl
  1934     05  CCERT1F PIC  X(0001).
  1935     05  FILLER REDEFINES CCERT1F.
  1936         10  CCERT1A PIC  X(0001).
  1937     05  CCERT1I PIC  X(0010).
  1938*    -------------------------------
  1939     05  CSFX1L PIC S9(0004) COMP.
  1940     05  CSFX1F PIC  X(0001).
  1941     05  FILLER REDEFINES CSFX1F.
  1942         10  CSFX1A PIC  X(0001).
  1943     05  CSFX1I PIC  X(0001).
  1944*    -------------------------------
  1945     05  CEFFDT1L PIC S9(0004) COMP.
  1946     05  CEFFDT1F PIC  X(0001).
  1947     05  FILLER REDEFINES CEFFDT1F.
  1948         10  CEFFDT1A PIC  X(0001).
  1949     05  CEFFDT1I PIC  9(6).
  1950*    -------------------------------
  1951     05  CLSTNM1L PIC S9(0004) COMP.
  1952     05  CLSTNM1F PIC  X(0001).
  1953     05  FILLER REDEFINES CLSTNM1F.
  1954         10  CLSTNM1A PIC  X(0001).
  1955     05  CLSTNM1I PIC  X(0015).
  1956*    -------------------------------
  1957     05  CKIND1L PIC S9(0004) COMP.
  1958     05  CKIND1F PIC  X(0001).
  1959     05  FILLER REDEFINES CKIND1F.
  1960         10  CKIND1A PIC  X(0001).
  1961     05  CKIND1I PIC  X(0002).
  1962*    -------------------------------
  1963     05  CCANDT1L PIC S9(0004) COMP.
  1964     05  CCANDT1F PIC  X(0001).
  1965     05  FILLER REDEFINES CCANDT1F.
  1966         10  CCANDT1A PIC  X(0001).
  1967     05  CCANDT1I PIC  9(6).
  1968*    -------------------------------
  1969     05  CRFUND1L PIC S9(0004) COMP.
  1970     05  CRFUND1F PIC  X(0001).
  1971     05  FILLER REDEFINES CRFUND1F.
  1972         10  CRFUND1A PIC  X(0001).
  1973     05  CRFUND1I PIC  S9(9)V9(2).
  1974*    -------------------------------
  1975     05  CMTHD1L PIC S9(0004) COMP.
  1976     05  CMTHD1F PIC  X(0001).
  1977     05  FILLER REDEFINES CMTHD1F.
  1978         10  CMTHD1A PIC  X(0001).
  1979     05  CMTHD1I PIC  X(0001).
  1980*    -------------------------------
  1981     05  CKIND2L PIC S9(0004) COMP.
  1982     05  CKIND2F PIC  X(0001).
  1983     05  FILLER REDEFINES CKIND2F.
  1984         10  CKIND2A PIC  X(0001).
  1985     05  CKIND2I PIC  X(0002).
  1986*    -------------------------------
  1987     05  CCANDT2L PIC S9(0004) COMP.
  1988     05  CCANDT2F PIC  X(0001).
  1989     05  FILLER REDEFINES CCANDT2F.
  1990         10  CCANDT2A PIC  X(0001).
  1991     05  CCANDT2I PIC  9(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  38
* VP6301.cbl
  1992*    -------------------------------
  1993     05  CRFUND2L PIC S9(0004) COMP.
  1994     05  CRFUND2F PIC  X(0001).
  1995     05  FILLER REDEFINES CRFUND2F.
  1996         10  CRFUND2A PIC  X(0001).
  1997     05  CRFUND2I PIC  S9(9)V9(2).
  1998*    -------------------------------
  1999     05  CMTHD2L PIC S9(0004) COMP.
  2000     05  CMTHD2F PIC  X(0001).
  2001     05  FILLER REDEFINES CMTHD2F.
  2002         10  CMTHD2A PIC  X(0001).
  2003     05  CMTHD2I PIC  X(0001).
  2004*    -------------------------------
  2005     05  CCHK1L PIC S9(0004) COMP.
  2006     05  CCHK1F PIC  X(0001).
  2007     05  FILLER REDEFINES CCHK1F.
  2008         10  CCHK1A PIC  X(0001).
  2009     05  CCHK1I PIC  X(0001).
  2010*    -------------------------------
  2011     05  CPAYEE1L PIC S9(0004) COMP.
  2012     05  CPAYEE1F PIC  X(0001).
  2013     05  FILLER REDEFINES CPAYEE1F.
  2014         10  CPAYEE1A PIC  X(0001).
  2015     05  CPAYEE1I PIC  X(0006).
  2016*    -------------------------------
  2017     05  CLIVES1L PIC S9(0004) COMP.
  2018     05  CLIVES1F PIC  X(0001).
  2019     05  FILLER REDEFINES CLIVES1F.
  2020         10  CLIVES1A PIC  X(0001).
  2021     05  CLIVES1I PIC  9(3).
  2022*    -------------------------------
  2023     05  CCANRN1L PIC S9(0004) COMP.
  2024     05  CCANRN1F PIC  X(0001).
  2025     05  FILLER REDEFINES CCANRN1F.
  2026         10  CCANRN1A PIC  X(0001).
  2027     05  CCANRN1I PIC  X(0001).
  2028*    -------------------------------
  2029     05  CSEQ2L PIC S9(0004) COMP.
  2030     05  CSEQ2F PIC  X(0001).
  2031     05  FILLER REDEFINES CSEQ2F.
  2032         10  CSEQ2A PIC  X(0001).
  2033     05  CSEQ2I PIC  X(0004).
  2034*    -------------------------------
  2035     05  CCERT2L PIC S9(0004) COMP.
  2036     05  CCERT2F PIC  X(0001).
  2037     05  FILLER REDEFINES CCERT2F.
  2038         10  CCERT2A PIC  X(0001).
  2039     05  CCERT2I PIC  X(0010).
  2040*    -------------------------------
  2041     05  CSFX2L PIC S9(0004) COMP.
  2042     05  CSFX2F PIC  X(0001).
  2043     05  FILLER REDEFINES CSFX2F.
  2044         10  CSFX2A PIC  X(0001).
  2045     05  CSFX2I PIC  X(0001).
  2046*    -------------------------------
  2047     05  CEFFDT2L PIC S9(0004) COMP.
  2048     05  CEFFDT2F PIC  X(0001).
  2049     05  FILLER REDEFINES CEFFDT2F.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  39
* VP6301.cbl
  2050         10  CEFFDT2A PIC  X(0001).
  2051     05  CEFFDT2I PIC  9(6).
  2052*    -------------------------------
  2053     05  CLSTNM2L PIC S9(0004) COMP.
  2054     05  CLSTNM2F PIC  X(0001).
  2055     05  FILLER REDEFINES CLSTNM2F.
  2056         10  CLSTNM2A PIC  X(0001).
  2057     05  CLSTNM2I PIC  X(0015).
  2058*    -------------------------------
  2059     05  CKIND3L PIC S9(0004) COMP.
  2060     05  CKIND3F PIC  X(0001).
  2061     05  FILLER REDEFINES CKIND3F.
  2062         10  CKIND3A PIC  X(0001).
  2063     05  CKIND3I PIC  X(0002).
  2064*    -------------------------------
  2065     05  CCANDT3L PIC S9(0004) COMP.
  2066     05  CCANDT3F PIC  X(0001).
  2067     05  FILLER REDEFINES CCANDT3F.
  2068         10  CCANDT3A PIC  X(0001).
  2069     05  CCANDT3I PIC  9(6).
  2070*    -------------------------------
  2071     05  CRFUND3L PIC S9(0004) COMP.
  2072     05  CRFUND3F PIC  X(0001).
  2073     05  FILLER REDEFINES CRFUND3F.
  2074         10  CRFUND3A PIC  X(0001).
  2075     05  CRFUND3I PIC  S9(9)V9(2).
  2076*    -------------------------------
  2077     05  CMTHD3L PIC S9(0004) COMP.
  2078     05  CMTHD3F PIC  X(0001).
  2079     05  FILLER REDEFINES CMTHD3F.
  2080         10  CMTHD3A PIC  X(0001).
  2081     05  CMTHD3I PIC  X(0001).
  2082*    -------------------------------
  2083     05  CKIND4L PIC S9(0004) COMP.
  2084     05  CKIND4F PIC  X(0001).
  2085     05  FILLER REDEFINES CKIND4F.
  2086         10  CKIND4A PIC  X(0001).
  2087     05  CKIND4I PIC  X(0002).
  2088*    -------------------------------
  2089     05  CCANDT4L PIC S9(0004) COMP.
  2090     05  CCANDT4F PIC  X(0001).
  2091     05  FILLER REDEFINES CCANDT4F.
  2092         10  CCANDT4A PIC  X(0001).
  2093     05  CCANDT4I PIC  9(6).
  2094*    -------------------------------
  2095     05  CRFUND4L PIC S9(0004) COMP.
  2096     05  CRFUND4F PIC  X(0001).
  2097     05  FILLER REDEFINES CRFUND4F.
  2098         10  CRFUND4A PIC  X(0001).
  2099     05  CRFUND4I PIC  S9(9)V9(2).
  2100*    -------------------------------
  2101     05  CMTHD4L PIC S9(0004) COMP.
  2102     05  CMTHD4F PIC  X(0001).
  2103     05  FILLER REDEFINES CMTHD4F.
  2104         10  CMTHD4A PIC  X(0001).
  2105     05  CMTHD4I PIC  X(0001).
  2106*    -------------------------------
  2107     05  CCHK2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  40
* VP6301.cbl
  2108     05  CCHK2F PIC  X(0001).
  2109     05  FILLER REDEFINES CCHK2F.
  2110         10  CCHK2A PIC  X(0001).
  2111     05  CCHK2I PIC  X(0001).
  2112*    -------------------------------
  2113     05  CPAYEE2L PIC S9(0004) COMP.
  2114     05  CPAYEE2F PIC  X(0001).
  2115     05  FILLER REDEFINES CPAYEE2F.
  2116         10  CPAYEE2A PIC  X(0001).
  2117     05  CPAYEE2I PIC  X(0006).
  2118*    -------------------------------
  2119     05  CLIVES2L PIC S9(0004) COMP.
  2120     05  CLIVES2F PIC  X(0001).
  2121     05  FILLER REDEFINES CLIVES2F.
  2122         10  CLIVES2A PIC  X(0001).
  2123     05  CLIVES2I PIC  9(3).
  2124*    -------------------------------
  2125     05  CCANRN2L PIC S9(0004) COMP.
  2126     05  CCANRN2F PIC  X(0001).
  2127     05  FILLER REDEFINES CCANRN2F.
  2128         10  CCANRN2A PIC  X(0001).
  2129     05  CCANRN2I PIC  X(0001).
  2130*    -------------------------------
  2131     05  CSEQ3L PIC S9(0004) COMP.
  2132     05  CSEQ3F PIC  X(0001).
  2133     05  FILLER REDEFINES CSEQ3F.
  2134         10  CSEQ3A PIC  X(0001).
  2135     05  CSEQ3I PIC  X(0004).
  2136*    -------------------------------
  2137     05  CCERT3L PIC S9(0004) COMP.
  2138     05  CCERT3F PIC  X(0001).
  2139     05  FILLER REDEFINES CCERT3F.
  2140         10  CCERT3A PIC  X(0001).
  2141     05  CCERT3I PIC  X(0010).
  2142*    -------------------------------
  2143     05  CSFX3L PIC S9(0004) COMP.
  2144     05  CSFX3F PIC  X(0001).
  2145     05  FILLER REDEFINES CSFX3F.
  2146         10  CSFX3A PIC  X(0001).
  2147     05  CSFX3I PIC  X(0001).
  2148*    -------------------------------
  2149     05  CEFFDT3L PIC S9(0004) COMP.
  2150     05  CEFFDT3F PIC  X(0001).
  2151     05  FILLER REDEFINES CEFFDT3F.
  2152         10  CEFFDT3A PIC  X(0001).
  2153     05  CEFFDT3I PIC  9(6).
  2154*    -------------------------------
  2155     05  CLSTNM3L PIC S9(0004) COMP.
  2156     05  CLSTNM3F PIC  X(0001).
  2157     05  FILLER REDEFINES CLSTNM3F.
  2158         10  CLSTNM3A PIC  X(0001).
  2159     05  CLSTNM3I PIC  X(0015).
  2160*    -------------------------------
  2161     05  CKIND5L PIC S9(0004) COMP.
  2162     05  CKIND5F PIC  X(0001).
  2163     05  FILLER REDEFINES CKIND5F.
  2164         10  CKIND5A PIC  X(0001).
  2165     05  CKIND5I PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  41
* VP6301.cbl
  2166*    -------------------------------
  2167     05  CCANDT5L PIC S9(0004) COMP.
  2168     05  CCANDT5F PIC  X(0001).
  2169     05  FILLER REDEFINES CCANDT5F.
  2170         10  CCANDT5A PIC  X(0001).
  2171     05  CCANDT5I PIC  9(6).
  2172*    -------------------------------
  2173     05  CRFUND5L PIC S9(0004) COMP.
  2174     05  CRFUND5F PIC  X(0001).
  2175     05  FILLER REDEFINES CRFUND5F.
  2176         10  CRFUND5A PIC  X(0001).
  2177     05  CRFUND5I PIC  S9(9)V9(2).
  2178*    -------------------------------
  2179     05  CMTHD5L PIC S9(0004) COMP.
  2180     05  CMTHD5F PIC  X(0001).
  2181     05  FILLER REDEFINES CMTHD5F.
  2182         10  CMTHD5A PIC  X(0001).
  2183     05  CMTHD5I PIC  X(0001).
  2184*    -------------------------------
  2185     05  CKIND6L PIC S9(0004) COMP.
  2186     05  CKIND6F PIC  X(0001).
  2187     05  FILLER REDEFINES CKIND6F.
  2188         10  CKIND6A PIC  X(0001).
  2189     05  CKIND6I PIC  X(0002).
  2190*    -------------------------------
  2191     05  CCANDT6L PIC S9(0004) COMP.
  2192     05  CCANDT6F PIC  X(0001).
  2193     05  FILLER REDEFINES CCANDT6F.
  2194         10  CCANDT6A PIC  X(0001).
  2195     05  CCANDT6I PIC  9(6).
  2196*    -------------------------------
  2197     05  CRFUND6L PIC S9(0004) COMP.
  2198     05  CRFUND6F PIC  X(0001).
  2199     05  FILLER REDEFINES CRFUND6F.
  2200         10  CRFUND6A PIC  X(0001).
  2201     05  CRFUND6I PIC  S9(9)V9(2).
  2202*    -------------------------------
  2203     05  CMTHD6L PIC S9(0004) COMP.
  2204     05  CMTHD6F PIC  X(0001).
  2205     05  FILLER REDEFINES CMTHD6F.
  2206         10  CMTHD6A PIC  X(0001).
  2207     05  CMTHD6I PIC  X(0001).
  2208*    -------------------------------
  2209     05  CCHK3L PIC S9(0004) COMP.
  2210     05  CCHK3F PIC  X(0001).
  2211     05  FILLER REDEFINES CCHK3F.
  2212         10  CCHK3A PIC  X(0001).
  2213     05  CCHK3I PIC  X(0001).
  2214*    -------------------------------
  2215     05  CPAYEE3L PIC S9(0004) COMP.
  2216     05  CPAYEE3F PIC  X(0001).
  2217     05  FILLER REDEFINES CPAYEE3F.
  2218         10  CPAYEE3A PIC  X(0001).
  2219     05  CPAYEE3I PIC  X(0006).
  2220*    -------------------------------
  2221     05  CLIVES3L PIC S9(0004) COMP.
  2222     05  CLIVES3F PIC  X(0001).
  2223     05  FILLER REDEFINES CLIVES3F.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  42
* VP6301.cbl
  2224         10  CLIVES3A PIC  X(0001).
  2225     05  CLIVES3I PIC  9(3).
  2226*    -------------------------------
  2227     05  CCANRN3L PIC S9(0004) COMP.
  2228     05  CCANRN3F PIC  X(0001).
  2229     05  FILLER REDEFINES CCANRN3F.
  2230         10  CCANRN3A PIC  X(0001).
  2231     05  CCANRN3I PIC  X(0001).
  2232*    -------------------------------
  2233     05  CSEQ4L PIC S9(0004) COMP.
  2234     05  CSEQ4F PIC  X(0001).
  2235     05  FILLER REDEFINES CSEQ4F.
  2236         10  CSEQ4A PIC  X(0001).
  2237     05  CSEQ4I PIC  X(0004).
  2238*    -------------------------------
  2239     05  CCERT4L PIC S9(0004) COMP.
  2240     05  CCERT4F PIC  X(0001).
  2241     05  FILLER REDEFINES CCERT4F.
  2242         10  CCERT4A PIC  X(0001).
  2243     05  CCERT4I PIC  X(0010).
  2244*    -------------------------------
  2245     05  CSFX4L PIC S9(0004) COMP.
  2246     05  CSFX4F PIC  X(0001).
  2247     05  FILLER REDEFINES CSFX4F.
  2248         10  CSFX4A PIC  X(0001).
  2249     05  CSFX4I PIC  X(0001).
  2250*    -------------------------------
  2251     05  CEFFDT4L PIC S9(0004) COMP.
  2252     05  CEFFDT4F PIC  X(0001).
  2253     05  FILLER REDEFINES CEFFDT4F.
  2254         10  CEFFDT4A PIC  X(0001).
  2255     05  CEFFDT4I PIC  9(6).
  2256*    -------------------------------
  2257     05  CLSTNM4L PIC S9(0004) COMP.
  2258     05  CLSTNM4F PIC  X(0001).
  2259     05  FILLER REDEFINES CLSTNM4F.
  2260         10  CLSTNM4A PIC  X(0001).
  2261     05  CLSTNM4I PIC  X(0015).
  2262*    -------------------------------
  2263     05  CKIND7L PIC S9(0004) COMP.
  2264     05  CKIND7F PIC  X(0001).
  2265     05  FILLER REDEFINES CKIND7F.
  2266         10  CKIND7A PIC  X(0001).
  2267     05  CKIND7I PIC  X(0002).
  2268*    -------------------------------
  2269     05  CCANDT7L PIC S9(0004) COMP.
  2270     05  CCANDT7F PIC  X(0001).
  2271     05  FILLER REDEFINES CCANDT7F.
  2272         10  CCANDT7A PIC  X(0001).
  2273     05  CCANDT7I PIC  9(6).
  2274*    -------------------------------
  2275     05  CRFUND7L PIC S9(0004) COMP.
  2276     05  CRFUND7F PIC  X(0001).
  2277     05  FILLER REDEFINES CRFUND7F.
  2278         10  CRFUND7A PIC  X(0001).
  2279     05  CRFUND7I PIC  S9(9)V9(2).
  2280*    -------------------------------
  2281     05  CMTHD7L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  43
* VP6301.cbl
  2282     05  CMTHD7F PIC  X(0001).
  2283     05  FILLER REDEFINES CMTHD7F.
  2284         10  CMTHD7A PIC  X(0001).
  2285     05  CMTHD7I PIC  X(0001).
  2286*    -------------------------------
  2287     05  CKIND8L PIC S9(0004) COMP.
  2288     05  CKIND8F PIC  X(0001).
  2289     05  FILLER REDEFINES CKIND8F.
  2290         10  CKIND8A PIC  X(0001).
  2291     05  CKIND8I PIC  X(0002).
  2292*    -------------------------------
  2293     05  CCANDT8L PIC S9(0004) COMP.
  2294     05  CCANDT8F PIC  X(0001).
  2295     05  FILLER REDEFINES CCANDT8F.
  2296         10  CCANDT8A PIC  X(0001).
  2297     05  CCANDT8I PIC  9(6).
  2298*    -------------------------------
  2299     05  CRFUND8L PIC S9(0004) COMP.
  2300     05  CRFUND8F PIC  X(0001).
  2301     05  FILLER REDEFINES CRFUND8F.
  2302         10  CRFUND8A PIC  X(0001).
  2303     05  CRFUND8I PIC  S9(9)V9(2).
  2304*    -------------------------------
  2305     05  CMTHD8L PIC S9(0004) COMP.
  2306     05  CMTHD8F PIC  X(0001).
  2307     05  FILLER REDEFINES CMTHD8F.
  2308         10  CMTHD8A PIC  X(0001).
  2309     05  CMTHD8I PIC  X(0001).
  2310*    -------------------------------
  2311     05  CCHK4L PIC S9(0004) COMP.
  2312     05  CCHK4F PIC  X(0001).
  2313     05  FILLER REDEFINES CCHK4F.
  2314         10  CCHK4A PIC  X(0001).
  2315     05  CCHK4I PIC  X(0001).
  2316*    -------------------------------
  2317     05  CPAYEE4L PIC S9(0004) COMP.
  2318     05  CPAYEE4F PIC  X(0001).
  2319     05  FILLER REDEFINES CPAYEE4F.
  2320         10  CPAYEE4A PIC  X(0001).
  2321     05  CPAYEE4I PIC  X(0006).
  2322*    -------------------------------
  2323     05  CLIVES4L PIC S9(0004) COMP.
  2324     05  CLIVES4F PIC  X(0001).
  2325     05  FILLER REDEFINES CLIVES4F.
  2326         10  CLIVES4A PIC  X(0001).
  2327     05  CLIVES4I PIC  9(3).
  2328*    -------------------------------
  2329     05  CCANRN4L PIC S9(0004) COMP.
  2330     05  CCANRN4F PIC  X(0001).
  2331     05  FILLER REDEFINES CCANRN4F.
  2332         10  CCANRN4A PIC  X(0001).
  2333     05  CCANRN4I PIC  X(0001).
  2334*    -------------------------------
  2335     05  CERMSG1L PIC S9(0004) COMP.
  2336     05  CERMSG1F PIC  X(0001).
  2337     05  FILLER REDEFINES CERMSG1F.
  2338         10  CERMSG1A PIC  X(0001).
  2339     05  CERMSG1I PIC  X(0079).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  44
* VP6301.cbl
  2340*    -------------------------------
  2341     05  CERMSG2L PIC S9(0004) COMP.
  2342     05  CERMSG2F PIC  X(0001).
  2343     05  FILLER REDEFINES CERMSG2F.
  2344         10  CERMSG2A PIC  X(0001).
  2345     05  CERMSG2I PIC  X(0079).
  2346*    -------------------------------
  2347     05  CPFENTRL PIC S9(0004) COMP.
  2348     05  CPFENTRF PIC  X(0001).
  2349     05  FILLER REDEFINES CPFENTRF.
  2350         10  CPFENTRA PIC  X(0001).
  2351     05  CPFENTRI PIC  9(2).
  2352*    -------------------------------
  2353     05  CDELHDGL PIC S9(0004) COMP.
  2354     05  CDELHDGF PIC  X(0001).
  2355     05  FILLER REDEFINES CDELHDGF.
  2356         10  CDELHDGA PIC  X(0001).
  2357     05  CDELHDGI PIC  X(0017).
  2358 01  VP630CO REDEFINES VP630BI.
  2359     05  FILLER            PIC  X(0012).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  CDATEO PIC  X(0008).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  CTIMEO PIC  99.99.
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  CBATCHO PIC  X(0008).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  CMOENDO PIC  X(0008).
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  CACCTNMO PIC  X(0030).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  CSEQ1O PIC  X(0004).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  CCERT1O PIC  X(0010).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  CSFX1O PIC  X(0001).
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  CEFFDT1O PIC  999999.
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  CLSTNM1O PIC  X(0015).
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  CKIND1O PIC  X(0002).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  CCANDT1O PIC  999999.
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  45
* VP6301.cbl
  2398     05  CRFUND1O PIC  9999999.99-.
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  CMTHD1O PIC  X(0001).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  CKIND2O PIC  X(0002).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  CCANDT2O PIC  999999.
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  CRFUND2O PIC  9999999.99-.
  2411*    -------------------------------
  2412     05  FILLER            PIC  X(0003).
  2413     05  CMTHD2O PIC  X(0001).
  2414*    -------------------------------
  2415     05  FILLER            PIC  X(0003).
  2416     05  CCHK1O PIC  X(0001).
  2417*    -------------------------------
  2418     05  FILLER            PIC  X(0003).
  2419     05  CPAYEE1O PIC  X(0006).
  2420*    -------------------------------
  2421     05  FILLER            PIC  X(0003).
  2422     05  CLIVES1O PIC  999.
  2423*    -------------------------------
  2424     05  FILLER            PIC  X(0003).
  2425     05  CCANRN1O PIC  X(0001).
  2426*    -------------------------------
  2427     05  FILLER            PIC  X(0003).
  2428     05  CSEQ2O PIC  X(0004).
  2429*    -------------------------------
  2430     05  FILLER            PIC  X(0003).
  2431     05  CCERT2O PIC  X(0010).
  2432*    -------------------------------
  2433     05  FILLER            PIC  X(0003).
  2434     05  CSFX2O PIC  X(0001).
  2435*    -------------------------------
  2436     05  FILLER            PIC  X(0003).
  2437     05  CEFFDT2O PIC  999999.
  2438*    -------------------------------
  2439     05  FILLER            PIC  X(0003).
  2440     05  CLSTNM2O PIC  X(0015).
  2441*    -------------------------------
  2442     05  FILLER            PIC  X(0003).
  2443     05  CKIND3O PIC  X(0002).
  2444*    -------------------------------
  2445     05  FILLER            PIC  X(0003).
  2446     05  CCANDT3O PIC  999999.
  2447*    -------------------------------
  2448     05  FILLER            PIC  X(0003).
  2449     05  CRFUND3O PIC  9999999.99-.
  2450*    -------------------------------
  2451     05  FILLER            PIC  X(0003).
  2452     05  CMTHD3O PIC  X(0001).
  2453*    -------------------------------
  2454     05  FILLER            PIC  X(0003).
  2455     05  CKIND4O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  46
* VP6301.cbl
  2456*    -------------------------------
  2457     05  FILLER            PIC  X(0003).
  2458     05  CCANDT4O PIC  999999.
  2459*    -------------------------------
  2460     05  FILLER            PIC  X(0003).
  2461     05  CRFUND4O PIC  9999999.99-.
  2462*    -------------------------------
  2463     05  FILLER            PIC  X(0003).
  2464     05  CMTHD4O PIC  X(0001).
  2465*    -------------------------------
  2466     05  FILLER            PIC  X(0003).
  2467     05  CCHK2O PIC  X(0001).
  2468*    -------------------------------
  2469     05  FILLER            PIC  X(0003).
  2470     05  CPAYEE2O PIC  X(0006).
  2471*    -------------------------------
  2472     05  FILLER            PIC  X(0003).
  2473     05  CLIVES2O PIC  999.
  2474*    -------------------------------
  2475     05  FILLER            PIC  X(0003).
  2476     05  CCANRN2O PIC  X(0001).
  2477*    -------------------------------
  2478     05  FILLER            PIC  X(0003).
  2479     05  CSEQ3O PIC  X(0004).
  2480*    -------------------------------
  2481     05  FILLER            PIC  X(0003).
  2482     05  CCERT3O PIC  X(0010).
  2483*    -------------------------------
  2484     05  FILLER            PIC  X(0003).
  2485     05  CSFX3O PIC  X(0001).
  2486*    -------------------------------
  2487     05  FILLER            PIC  X(0003).
  2488     05  CEFFDT3O PIC  999999.
  2489*    -------------------------------
  2490     05  FILLER            PIC  X(0003).
  2491     05  CLSTNM3O PIC  X(0015).
  2492*    -------------------------------
  2493     05  FILLER            PIC  X(0003).
  2494     05  CKIND5O PIC  X(0002).
  2495*    -------------------------------
  2496     05  FILLER            PIC  X(0003).
  2497     05  CCANDT5O PIC  999999.
  2498*    -------------------------------
  2499     05  FILLER            PIC  X(0003).
  2500     05  CRFUND5O PIC  9999999.99-.
  2501*    -------------------------------
  2502     05  FILLER            PIC  X(0003).
  2503     05  CMTHD5O PIC  X(0001).
  2504*    -------------------------------
  2505     05  FILLER            PIC  X(0003).
  2506     05  CKIND6O PIC  X(0002).
  2507*    -------------------------------
  2508     05  FILLER            PIC  X(0003).
  2509     05  CCANDT6O PIC  999999.
  2510*    -------------------------------
  2511     05  FILLER            PIC  X(0003).
  2512     05  CRFUND6O PIC  9999999.99-.
  2513*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  47
* VP6301.cbl
  2514     05  FILLER            PIC  X(0003).
  2515     05  CMTHD6O PIC  X(0001).
  2516*    -------------------------------
  2517     05  FILLER            PIC  X(0003).
  2518     05  CCHK3O PIC  X(0001).
  2519*    -------------------------------
  2520     05  FILLER            PIC  X(0003).
  2521     05  CPAYEE3O PIC  X(0006).
  2522*    -------------------------------
  2523     05  FILLER            PIC  X(0003).
  2524     05  CLIVES3O PIC  999.
  2525*    -------------------------------
  2526     05  FILLER            PIC  X(0003).
  2527     05  CCANRN3O PIC  X(0001).
  2528*    -------------------------------
  2529     05  FILLER            PIC  X(0003).
  2530     05  CSEQ4O PIC  X(0004).
  2531*    -------------------------------
  2532     05  FILLER            PIC  X(0003).
  2533     05  CCERT4O PIC  X(0010).
  2534*    -------------------------------
  2535     05  FILLER            PIC  X(0003).
  2536     05  CSFX4O PIC  X(0001).
  2537*    -------------------------------
  2538     05  FILLER            PIC  X(0003).
  2539     05  CEFFDT4O PIC  999999.
  2540*    -------------------------------
  2541     05  FILLER            PIC  X(0003).
  2542     05  CLSTNM4O PIC  X(0015).
  2543*    -------------------------------
  2544     05  FILLER            PIC  X(0003).
  2545     05  CKIND7O PIC  X(0002).
  2546*    -------------------------------
  2547     05  FILLER            PIC  X(0003).
  2548     05  CCANDT7O PIC  999999.
  2549*    -------------------------------
  2550     05  FILLER            PIC  X(0003).
  2551     05  CRFUND7O PIC  9999999.99-.
  2552*    -------------------------------
  2553     05  FILLER            PIC  X(0003).
  2554     05  CMTHD7O PIC  X(0001).
  2555*    -------------------------------
  2556     05  FILLER            PIC  X(0003).
  2557     05  CKIND8O PIC  X(0002).
  2558*    -------------------------------
  2559     05  FILLER            PIC  X(0003).
  2560     05  CCANDT8O PIC  999999.
  2561*    -------------------------------
  2562     05  FILLER            PIC  X(0003).
  2563     05  CRFUND8O PIC  9999999.99-.
  2564*    -------------------------------
  2565     05  FILLER            PIC  X(0003).
  2566     05  CMTHD8O PIC  X(0001).
  2567*    -------------------------------
  2568     05  FILLER            PIC  X(0003).
  2569     05  CCHK4O PIC  X(0001).
  2570*    -------------------------------
  2571     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  48
* VP6301.cbl
  2572     05  CPAYEE4O PIC  X(0006).
  2573*    -------------------------------
  2574     05  FILLER            PIC  X(0003).
  2575     05  CLIVES4O PIC  999.
  2576*    -------------------------------
  2577     05  FILLER            PIC  X(0003).
  2578     05  CCANRN4O PIC  X(0001).
  2579*    -------------------------------
  2580     05  FILLER            PIC  X(0003).
  2581     05  CERMSG1O PIC  X(0079).
  2582*    -------------------------------
  2583     05  FILLER            PIC  X(0003).
  2584     05  CERMSG2O PIC  X(0079).
  2585*    -------------------------------
  2586     05  FILLER            PIC  X(0003).
  2587     05  CPFENTRO PIC  99.
  2588*    -------------------------------
  2589     05  FILLER            PIC  X(0003).
  2590     05  CDELHDGO PIC  X(0017).
  2591*    -------------------------------
  2592 01  MAP-B REDEFINES VP630BI.
  2593     12  FILLER                      PIC X(42).
  2594     12  DATA-AREA-B.
  2595         16  BSEQ-LEN                PIC S9(4)  COMP.
  2596         16  BSEQ-ATTRB              PIC X.
  2597         16  BSEQ                    PIC 9(4).
  2598         16  BMO-END-LEN             PIC S9(4)  COMP.
  2599         16  BMO-END-ATTRB           PIC X.
  2600         16  BMO-END                 PIC X(8).
  2601         16  BACCT-NM-LEN            PIC S9(4)  COMP.
  2602         16  BACCT-NM-ATTRB          PIC X.
  2603         16  BACCT-NM                PIC X(30).
  2604         16  BEFFDT-LEN              PIC S9(4)  COMP.
  2605         16  BEFFDT-ATTRB            PIC X.
  2606         16  BEFFDT                  PIC X(6).
  2607         16  BCERT-LEN               PIC S9(4)  COMP.
  2608         16  BCERT-ATTRB             PIC X.
  2609         16  BCERT                   PIC X(10).
  2610         16  BSFX-LEN                PIC S9(4)  COMP.
  2611         16  BSFX-ATTRB              PIC X.
  2612         16  BSFX                    PIC X.
  2613         16  BLN-OFFICER-LEN         PIC S9(4)  COMP.
  2614         16  BLN-OFFICER-ATTRB       PIC X.
  2615         16  BLN-OFFICER             PIC X(5).
  2616         16  B1ST-NAME-LEN           PIC S9(4)  COMP.
  2617         16  B1ST-NAME-ATTRB         PIC X.
  2618         16  B1ST-NAME               PIC X(10).
  2619         16  BINIT-LEN               PIC S9(4)  COMP.
  2620         16  BINIT-ATTRB             PIC X.
  2621         16  BINIT                   PIC X.
  2622         16  BLAST-NAME-LEN          PIC S9(4)  COMP.
  2623         16  BLAST-NAME-ATTRB        PIC X.
  2624         16  BLAST-NAME              PIC X(15).
  2625         16  BAGE-LEN                PIC S9(4)  COMP.
  2626         16  BAGE-ATTRB              PIC X.
  2627         16  BAGE                    PIC 99.
  2628         16  BSEX-LEN                PIC S9(4)  COMP.
  2629         16  BSEX-ATTRB              PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  49
* VP6301.cbl
  2630         16  BSEX                    PIC X.
  2631         16  BJNT-1ST-NAME-LEN       PIC S9(4)   COMP.
  2632         16  BJNT-1ST-NAME-ATTRB     PIC X.
  2633         16  BJNT-1ST-NAME           PIC X(10).
  2634         16  BJNT-INIT-LEN           PIC S9(4)   COMP.
  2635         16  BJNT-INIT-ATTRB         PIC X.
  2636         16  BJNT-INIT               PIC X.
  2637         16  BJNT-LST-NAME-LEN       PIC S9(4)   COMP.
  2638         16  BJNT-LST-NAME-ATTRB     PIC X.
  2639         16  BJNT-LST-NAME           PIC X(15).
  2640         16  BJNT-AGE-LEN            PIC S9(4)   COMP.
  2641         16  BJNT-AGE-ATTRB          PIC X.
  2642         16  BJNT-AGE                PIC 99.
  2643         16  BADDRS1-LEN             PIC S9(4)  COMP.
  2644         16  BADDRS1-ATTRB           PIC X.
  2645         16  BADDRS1                 PIC X(30).
  2646         16  BADDRS2-LEN             PIC S9(4)  COMP.
  2647         16  BADDRS2-ATTRB           PIC X.
  2648         16  BADDRS2                 PIC X(30).
  2649         16  BCITY-LEN               PIC S9(4)  COMP.
  2650         16  BCITY-ATTRB             PIC X.
  2651         16  BCITY                   PIC X(28).
  2652         16  BSTATE-LEN              PIC S9(4)  COMP.
  2653         16  BSTATE-ATTRB            PIC X.
  2654         16  BSTATE                  PIC XX.
  2655         16  BZIPCDE-LEN             PIC S9(4)  COMP.
  2656         16  BZIPCDE-ATTRB           PIC X.
  2657         16  BZIPCDE                 PIC X(10).
  2658         16  BYEAR-LEN               PIC S9(4)  COMP.
  2659         16  BYEAR-ATTRB             PIC X.
  2660         16  BYEAR                   PIC X(4).
  2661         16  BMAKE-LEN               PIC S9(4)  COMP.
  2662         16  BMAKE-ATTRB             PIC X.
  2663         16  BMAKE                   PIC X(20).
  2664         16  BMODEL-LEN              PIC S9(4)  COMP.
  2665         16  BMODEL-ATTRB            PIC X.
  2666         16  BMODEL                  PIC X(20).
  2667         16  BFUTURE-LEN             PIC S9(4)  COMP.
  2668         16  BFUTURE-ATTRB           PIC X.
  2669         16  BFUTURE                 PIC X(20).
  2670         16  BVINHD-LEN              PIC S9(4)  COMP.
  2671         16  BVINHD-ATTRB            PIC X.
  2672         16  BVINNDI                 PIC X(5).
  2673         16  BVIN-LEN                PIC S9(4)  COMP.
  2674         16  BVIN-ATTRB              PIC X.
  2675         16  BVIN-NOI                PIC X(17).
  2676         16  BOMETER-LEN             PIC S9(4)  COMP.
  2677         16  BOMETER-ATTRB           PIC X.
  2678         16  BOMETER-in              PIC x(7).
  2679         16  BOMETER-out REDEFINES BOMETER-in
  2680                                     PIC 999,999.
  2681         16  BBENEFICIARY-LEN        PIC S9(4)   COMP.
  2682         16  BBENEFICIARY-ATTRB      PIC X.
  2683         16  BBENEFICIARY            PIC X(25).
  2684         16  BCADDR1-LEN             PIC S9(4)  COMP.
  2685         16  BCADDR1-ATTRB           PIC X.
  2686         16  BCADDR1                 PIC X(30).
  2687         16  BCADDR2-LEN             PIC S9(4)  COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  50
* VP6301.cbl
  2688         16  BCADDR2-ATTRB           PIC X.
  2689         16  BCADDR2                 PIC X(30).
  2690         16  BCCITY-LEN              PIC S9(4)  COMP.
  2691         16  BCCITY-ATTRB            PIC X.
  2692         16  BCCITY                  PIC X(28).
  2693         16  BCSTATE-LEN             PIC S9(4)  COMP.
  2694         16  BCSTATE-ATTRB           PIC X.
  2695         16  BCSTATE                 PIC XX.
  2696         16  BCZIPCD-LEN             PIC S9(4)  COMP.
  2697         16  BCZIPCD-ATTRB           PIC X.
  2698         16  BCZIPCD                 PIC X(10).
  2699         16  BKIND1-LEN           PIC S9(4)  COMP.
  2700         16  BKIND1-ATTRB         PIC X.
  2701         16  BKIND1               PIC XX.
  2702         16  BTYPE1-LEN           PIC S9(4)  COMP.
  2703         16  BTYPE1-ATTRB         PIC X.
  2704         16  BTYPE1               PIC X(3).
  2705         16  BTERM1-LEN           PIC S9(4)  COMP.
  2706         16  BTERM1-ATTRB         PIC X.
  2707         16  BTERM1I              PIC 999.
  2708         16  BTERM1O REDEFINES
  2709                        BTERM1I   PIC ZZZ.
  2710         16  BBENE1-LEN            PIC S9(4)  COMP.
  2711         16  BBENE1-ATTRB          PIC X.
  2712         16  BBENE1I               PIC 9(10)V99.
  2713*        16  BBENE1I               PIC 9(12).
  2714         16  BBENE1O REDEFINES
  2715                           BBENE1I PIC Z(9).99.
  2716         16  BPREM1-LEN           PIC S9(4)  COMP.
  2717         16  BPREM1-ATTRB         PIC X.
  2718         16  BPREM1I              PIC 9(9)V99.
  2719*        16  BPREM1I              PIC 9(11).
  2720         16  BPREM1O REDEFINES
  2721                          BPREM1I PIC Z(7).99-.
  2722         16  BALT-BEN1-LEN        PIC S9(4)  COMP.
  2723         16  BALT-BEN1-ATTRB      PIC X.
  2724         16  BALT-BEN1I           PIC 9(10)V99.
  2725*        16  BALT-BEN1I           PIC 9(12).
  2726         16  BALT-BEN1O REDEFINES
  2727                           BALT-BEN1I PIC Z(9).ZZ.
  2728         16  BALT-PREM1-LEN       PIC S9(4)  COMP.
  2729         16  BALT-PREM1-ATTRB     PIC X.
  2730         16  BALT-PREM1I          PIC 9(7)V99.
  2731*        16  BALT-PREM1I          PIC 9(9).
  2732         16  BALT-PREM1O REDEFINES
  2733                           BALT-PREM1I PIC Z(6).ZZ.
  2734         16  BKIND2-LEN           PIC S9(4)  COMP.
  2735         16  BKIND2-ATTRB         PIC X.
  2736         16  BKIND2               PIC XX.
  2737         16  BTYPE2-LEN           PIC S9(4)  COMP.
  2738         16  BTYPE2-ATTRB         PIC X.
  2739         16  BTYPE2               PIC X(3).
  2740         16  BTERM2-LEN           PIC S9(4)  COMP.
  2741         16  BTERM2-ATTRB         PIC X.
  2742         16  BTERM2I              PIC 999.
  2743         16  BTERM2O REDEFINES
  2744                        BTERM2I   PIC ZZZ.
  2745         16  BBENE2-LEN            PIC S9(4)  COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  51
* VP6301.cbl
  2746         16  BBENE2-ATTRB          PIC X.
  2747         16  BBENE2I               PIC 9(10)V99.
  2748*        16  BBENE2I               PIC 9(12).
  2749         16  BBENE2O REDEFINES
  2750                           BBENE2I PIC Z(9).99.
  2751         16  BPREM2-LEN           PIC S9(4)  COMP.
  2752         16  BPREM2-ATTRB         PIC X.
  2753         16  BPREM2I              PIC 9(9)V99.
  2754*        16  BPREM2I              PIC 9(11).
  2755         16  BPREM2O REDEFINES
  2756                          BPREM2I PIC Z(7).99-.
  2757         16  BCRIT-PERD2-LEN      PIC S9(4)  COMP.
  2758         16  BCRIT-PERD2-ATTRB    PIC X.
  2759         16  BCRIT-PERD2I         PIC 99.
  2760         16  BCRIT-PERD2O REDEFINES
  2761                 BCRIT-PERD2I PIC ZZ.
  2762         16  BALT-BEN2-LEN        PIC S9(4)  COMP.
  2763         16  BALT-BEN2-ATTRB      PIC X.
  2764         16  BALT-BEN2I           PIC 9(10)V99.
  2765*        16  BALT-BEN2I           PIC 9(12).
  2766         16  BALT-BEN2O REDEFINES
  2767                           BALT-BEN2I PIC Z(9).ZZ.
  2768         16  BALT-PREM2-LEN       PIC S9(4)  COMP.
  2769         16  BALT-PREM2-ATTRB     PIC X.
  2770         16  BALT-PREM2I          PIC 9(7)V99.
  2771*        16  BALT-PREM2I          PIC 9(9).
  2772         16  BALT-PREM2O REDEFINES
  2773                           BALT-PREM2I PIC Z(6).ZZ.
  2774 01  MAP-C REDEFINES VP630BI.
  2775     12  FILLER                  PIC X(86).
  2776     12  DATA-AREA-C             OCCURS 4 TIMES.
  2777         16  CSEQ-LEN                PIC S9(4)  COMP.
  2778         16  CSEQ-ATTRB              PIC X.
  2779         16  CSEQ                    PIC 9(4).
  2780         16  CCERT-LEN               PIC S9(4)  COMP.
  2781         16  CCERT-ATTRB             PIC X.
  2782         16  CCERT                   PIC X(10).
  2783         16  CSFX-LEN                PIC S9(4)  COMP.
  2784         16  CSFX-ATTRB              PIC X.
  2785         16  CSFX                    PIC X.
  2786         16  CEFFDT-LEN              PIC S9(4)  COMP.
  2787         16  CEFFDT-ATTRB            PIC X.
  2788         16  CEFFDT                  PIC 9(6).
  2789         16  CLAST-NAME-LEN          PIC S9(4)  COMP.
  2790         16  CLAST-NAME-ATTRB        PIC X.
  2791         16  CLAST-NAME              PIC X(15).
  2792         16  CANCEL-INFO.
  2793             20  CKIND1-LEN          PIC S9(4)  COMP.
  2794             20  CKIND1-ATTRB        PIC X.
  2795             20  CKIND1              PIC XX.
  2796             20  CCANDT1-LEN         PIC S9(4)  COMP.
  2797             20  CCANDT1-ATTRB       PIC X.
  2798             20  CCANDT1             PIC 9(6).
  2799             20  CREFUND1-LEN        PIC S9(4)  COMP.
  2800             20  CREFUND1-ATTRB      PIC X.
  2801             20  CREFUND1I           PIC S9(9)V99.
  2802*            20  CREFUND1I           PIC X(11).
  2803             20  CREFUND1O REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  52
* VP6301.cbl
  2804                           CREFUND1I PIC Z(7).99-.
  2805             20  CMTHD1-LEN          PIC S9(4)  COMP.
  2806             20  CMTHD1-ATTRB        PIC X.
  2807             20  CMTHD1              PIC X.
  2808             20  CKIND2-LEN          PIC S9(4)  COMP.
  2809             20  CKIND2-ATTRB        PIC X.
  2810             20  CKIND2              PIC XX.
  2811             20  CCANDT2-LEN         PIC S9(4)  COMP.
  2812             20  CCANDT2-ATTRB       PIC X.
  2813             20  CCANDT2             PIC 9(6).
  2814             20  CREFUND2-LEN        PIC S9(4)  COMP.
  2815             20  CREFUND2-ATTRB      PIC X.
  2816             20  CREFUND2I           PIC S9(9)V99.
  2817*            20  CREFUND2I           PIC X(11).
  2818             20  CREFUND2O REDEFINES
  2819                           CREFUND2I PIC Z(7).99-.
  2820             20  CMTHD2-LEN          PIC S9(4)  COMP.
  2821             20  CMTHD2-ATTRB        PIC X.
  2822             20  CMTHD2              PIC X.
  2823             20  CCHK-LEN            PIC S9(4)  COMP.
  2824             20  CCHK-ATTRB          PIC X.
  2825             20  CCHK                PIC X.
  2826             20  CPAYEE-LEN          PIC S9(4)  COMP.
  2827             20  CPAYEE-ATTRB        PIC X.
  2828             20  CPAYEE              PIC X(6).
  2829             20  CLIVES-LEN          PIC S9(4)  COMP.
  2830             20  CLIVES-ATTRB        PIC X.
  2831             20  CLIVESI             PIC 999.
  2832             20  CLIVESO REDEFINES
  2833                          CLIVESI    PIC ZZZ.
  2834             20  CCANREA-LEN         PIC S9(4)  COMP.
  2835             20  CCANREA-ATTRB       PIC X.
  2836             20  CCANREA             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  53
* VP6301.cbl
  2838****************************************************************
  2839*
  2840* Copyright (c) 2007 by Clerity Solutions, Inc.
  2841* All rights reserved.
  2842*
  2843****************************************************************
  2844 01  DFHEIV.
  2845   02  DFHEIV0               PIC X(35).
  2846   02  DFHEIV1               PIC X(08).
  2847   02  DFHEIV2               PIC X(08).
  2848   02  DFHEIV3               PIC X(08).
  2849   02  DFHEIV4               PIC X(06).
  2850   02  DFHEIV5               PIC X(04).
  2851   02  DFHEIV6               PIC X(04).
  2852   02  DFHEIV7               PIC X(02).
  2853   02  DFHEIV8               PIC X(02).
  2854   02  DFHEIV9               PIC X(01).
  2855   02  DFHEIV10              PIC S9(7) COMP-3.
  2856   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2857   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2858   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2859   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2860   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2861   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2862   02  DFHEIV17              PIC X(04).
  2863   02  DFHEIV18              PIC X(04).
  2864   02  DFHEIV19              PIC X(04).
  2865   02  DFHEIV20              USAGE IS POINTER.
  2866   02  DFHEIV21              USAGE IS POINTER.
  2867   02  DFHEIV22              USAGE IS POINTER.
  2868   02  DFHEIV23              USAGE IS POINTER.
  2869   02  DFHEIV24              USAGE IS POINTER.
  2870   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2871   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2872   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2873   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2874   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2875   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2876   02  FILLER                PIC X(02).
  2877   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2878   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2879   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2880   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2881   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2882 LINKAGE  SECTION.
  2883*****************************************************************
  2884*                                                               *
  2885* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2886* All rights reserved.                                          *
  2887*                                                               *
  2888*****************************************************************
  2889 01  dfheiblk.
  2890     02  eibtime          pic s9(7) comp-3.
  2891     02  eibdate          pic s9(7) comp-3.
  2892     02  eibtrnid         pic x(4).
  2893     02  eibtaskn         pic s9(7) comp-3.
  2894     02  eibtrmid         pic x(4).
  2895     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  54
* VP6301.cbl
  2896     02  eibcposn         pic s9(4) comp.
  2897     02  eibcalen         pic s9(4) comp.
  2898     02  eibaid           pic x(1).
  2899     02  eibfiller1       pic x(1).
  2900     02  eibfn            pic x(2).
  2901     02  eibfiller2       pic x(2).
  2902     02  eibrcode         pic x(6).
  2903     02  eibfiller3       pic x(2).
  2904     02  eibds            pic x(8).
  2905     02  eibreqid         pic x(8).
  2906     02  eibrsrce         pic x(8).
  2907     02  eibsync          pic x(1).
  2908     02  eibfree          pic x(1).
  2909     02  eibrecv          pic x(1).
  2910     02  eibsend          pic x(1).
  2911     02  eibatt           pic x(1).
  2912     02  eibeoc           pic x(1).
  2913     02  eibfmh           pic x(1).
  2914     02  eibcompl         pic x(1).
  2915     02  eibsig           pic x(1).
  2916     02  eibconf          pic x(1).
  2917     02  eiberr           pic x(1).
  2918     02  eibrldbk         pic x(1).
  2919     02  eiberrcd         pic x(4).
  2920     02  eibsynrb         pic x(1).
  2921     02  eibnodat         pic x(1).
  2922     02  eibfiller5       pic x(2).
  2923     02  eibresp          pic 9(09) comp.
  2924     02  eibresp2         pic 9(09) comp.
  2925     02  dfheigdj         pic s9(4) comp.
  2926     02  dfheigdk         pic s9(4) comp.
  2927 01  DFHCOMMAREA             PIC X(1900).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  55
* VP6301.cbl
  2929*01 PARMLIST .
  2930*    02  FILLER              PIC S9(8)   COMP.
  2931*    02  ERPNDB-POINTER      PIC S9(8)   COMP.
  2932*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  2933*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  2934*    02  ERPNDM-POINTER      PIC S9(8)   COMP.
  2935*                                COPY ERCPNDB.
  2936******************************************************************
  2937*                                                                *
  2938*                                                                *
  2939*                            ERCPNDB.                            *
  2940*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2941*                            VMOD=2.025                          *
  2942*                                                                *
  2943*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2944*                                                                *
  2945******************************************************************
  2946*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2947*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2948******************************************************************
  2949*                                                                *
  2950*                                                                *
  2951*   FILE TYPE = VSAM,KSDS                                        *
  2952*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2953*                                                                *
  2954*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2955*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2956*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2957*                                                 RKP=13,LEN=36  *
  2958*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2959*                                      AND CHG-SEQ.)             *
  2960*                                                RKP=49,LEN=11   *
  2961*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2962*                                      AND CHG-SEQ.)             *
  2963*                                                RKP=60,LEN=15   *
  2964*                                                                *
  2965*   LOG = NO                                                     *
  2966*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2967******************************************************************
  2968******************************************************************
  2969*                   C H A N G E   L O G
  2970*
  2971* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2972*-----------------------------------------------------------------
  2973*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2974* EFFECTIVE    NUMBER
  2975*-----------------------------------------------------------------
  2976* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2977* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2978* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2979* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2980* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2981* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2982* 032306                   PEMA  ADD BOW LOAN NUMBER
  2983* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2984* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2985* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2986* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  56
* VP6301.cbl
  2987* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2988* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2989* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2990* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2991* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2992* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2993******************************************************************
  2994
  2995 01  PENDING-BUSINESS.
  2996     12  PB-RECORD-ID                     PIC XX.
  2997         88  VALID-PB-ID                        VALUE 'PB'.
  2998
  2999     12  PB-CONTROL-PRIMARY.
  3000         16  PB-COMPANY-CD                PIC X.
  3001         16  PB-ENTRY-BATCH               PIC X(6).
  3002         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3003         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3004
  3005     12  PB-CONTROL-BY-ACCOUNT.
  3006         16  PB-COMPANY-CD-A1             PIC X.
  3007         16  PB-CARRIER                   PIC X.
  3008         16  PB-GROUPING.
  3009             20  PB-GROUPING-PREFIX       PIC XXX.
  3010             20  PB-GROUPING-PRIME        PIC XXX.
  3011         16  PB-STATE                     PIC XX.
  3012         16  PB-ACCOUNT.
  3013             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3014             20  PB-ACCOUNT-PRIME         PIC X(6).
  3015         16  PB-CERT-EFF-DT               PIC XX.
  3016         16  PB-CERT-NO.
  3017             20  PB-CERT-PRIME            PIC X(10).
  3018             20  PB-CERT-SFX              PIC X.
  3019         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3020
  3021         16  PB-RECORD-TYPE               PIC X.
  3022             88  PB-MAILING-DATA                VALUE '0'.
  3023             88  PB-ISSUE                       VALUE '1'.
  3024             88  PB-CANCELLATION                VALUE '2'.
  3025             88  PB-BATCH-TRAILER               VALUE '9'.
  3026
  3027     12  PB-CONTROL-BY-ORIG-BATCH.
  3028         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3029         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3030         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3031         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3032
  3033     12  PB-CONTROL-BY-CSR.
  3034         16  PB-CSR-COMPANY-CD            PIC X.
  3035         16  PB-CSR-ID                    PIC X(4).
  3036         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3037         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3038         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3039******************************************************************
  3040*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3041******************************************************************
  3042
  3043     12  PB-LAST-MAINT-DT                 PIC XX.
  3044     12  PB-LAST-MAINT-BY                 PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  57
* VP6301.cbl
  3045     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3046
  3047     12  PB-RECORD-BODY                   PIC X(375).
  3048
  3049     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3050         16  PB-CERT-ORIGIN               PIC X.
  3051             88  CLASIC-CREATED-CERT         VALUE '1'.
  3052         16  PB-I-NAME.
  3053             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3054             20  PB-I-INSURED-FIRST-NAME.
  3055                 24  PB-I-INSURED-1ST-INIT PIC X.
  3056                 24  FILLER                PIC X(9).
  3057             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3058         16  PB-I-AGE                     PIC S99   COMP-3.
  3059         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3060         16  PB-I-BIRTHDAY                PIC XX.
  3061         16  PB-I-INSURED-SEX             PIC X.
  3062             88  PB-SEX-MALE     VALUE 'M'.
  3063             88  PB-SEX-FEMALE   VALUE 'F'.
  3064
  3065         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3066         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3067         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3068         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3069         16  PB-I-SKIP-CODE               PIC X.
  3070             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3071             88  PB-SKIP-JULY              VALUE '1'.
  3072             88  PB-SKIP-AUGUST            VALUE '2'.
  3073             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3074             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3075             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3076             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3077             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3078             88  PB-SKIP-JUNE              VALUE '8'.
  3079             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3080             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3081             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3082         16  PB-I-TERM-TYPE               PIC X.
  3083             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3084             88  PB-PAID-WEEKLY            VALUE 'W'.
  3085             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3086             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3087             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3088         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3089         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3090         16  PB-I-DATA-ENTRY-SW           PIC X.
  3091             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3092             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3093             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3094             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3095         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3096         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3097*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3098         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3099         16  FILLER                       PIC X.
  3100
  3101         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3102             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  58
* VP6301.cbl
  3103             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3104                                                   '90' THRU '99'.
  3105         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3106                                          PIC XX.
  3107         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3108         16  PB-I-AMOUNT-FINANCED REDEFINES
  3109                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3110         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3111         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  3112                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3113         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3114         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3115         16  PB-I-CLP-AMOUNT REDEFINES
  3116                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3117         16  PB-I-LF-CALC-FLAG            PIC X.
  3118             88 PB-COMP-LF-PREM               VALUE '?'.
  3119         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3120         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3121         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3122         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3123         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3124         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3125         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3126         16  PB-I-LF-ABBR                 PIC XXX.
  3127         16  PB-I-LF-INPUT-CD             PIC XX.
  3128
  3129         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3130             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3131             88  PB-INVALID-AH               VALUE '  ' '00'
  3132                                                   '90' THRU '99'.
  3133         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3134         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3135         16  PB-I-AH-CALC-FLAG            PIC X.
  3136             88 PB-COMP-AH-PREM                  VALUE '?'.
  3137         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3138         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3139         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  3140         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3141         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3142         16  PB-I-AH-ABBR                 PIC XXX.
  3143         16  PB-I-AH-INPUT-CD             PIC XXX.
  3144
  3145         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3146         16  PB-I-REIN-TABLE              PIC XXX.
  3147         16  PB-I-BUSINESS-TYPE           PIC 99.
  3148         16  PB-I-INDV-GRP-CD             PIC X.
  3149         16  PB-I-MORT-CODE.
  3150             20  PB-I-TABLE               PIC X.
  3151             20  PB-I-INTEREST            PIC XX.
  3152             20  PB-I-MORT-TYP            PIC X.
  3153         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3154         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3155         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3156         16  PB-I-INDV-GRP-OVRD           PIC X.
  3157         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3158         16  PB-I-SIG-SW                  PIC X.
  3159             88  PB-POLICY-SIGNED             VALUE 'Y'.
  3160         16  PB-I-RATE-CLASS              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  59
* VP6301.cbl
  3161         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3162         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3163         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3164         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3165         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3166         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3167         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3168         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3169         16  PB-I-OB-FLAG                 PIC X.
  3170             88  PB-I-OB                      VALUE 'B'.
  3171             88  PB-I-SUMMARY                 VALUE 'Z'.
  3172         16  PB-I-ENTRY-STATUS            PIC X.
  3173             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3174                                              'M' '5' '9' '2'.
  3175             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3176             88  PB-I-POLICY-PENDING          VALUE '2'.
  3177             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3178             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3179             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  3180             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3181             88  PB-I-REIN-ONLY               VALUE '9'.
  3182             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3183             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3184             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3185             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3186         16  PB-I-INT-CODE                PIC X.
  3187             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3188             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3189         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3190         16  PB-I-SOC-SEC-NO              PIC X(11).
  3191         16  PB-I-MEMBER-NO               PIC X(12).
  3192         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3193*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3194         16  PB-I-OLD-LOF                 PIC XXX.
  3195         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3196         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3197         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3198         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3199         16  PB-I-LIFE-INDICATOR          PIC X.
  3200             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3201         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3202         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  3203                                          PIC S9(5)V99    COMP-3.
  3204         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3205             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3206             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3207         16  PB-I-1ST-PMT-DT              PIC XX.
  3208         16  PB-I-JOINT-INSURED.
  3209             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3210             20 PB-I-JOINT-FIRST-NAME.
  3211                24  PB-I-JOINT-FIRST-INIT PIC X.
  3212                24  FILLER                PIC X(9).
  3213             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3214*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3215         16  PB-I-BENEFICIARY-NAME.
  3216             20  PB-I-BANK-NUMBER         PIC X(10).
  3217             20  FILLER                   PIC X(15).
  3218         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  60
* VP6301.cbl
  3219         16  PB-I-REFERENCE               PIC X(12).
  3220         16  FILLER REDEFINES PB-I-REFERENCE.
  3221             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3222             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3223             20  PB-I-CLP-STATE           PIC XX.
  3224         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3225             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3226             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3227             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3228         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3229         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3230         16  PB-I-RESIDENT-STATE          PIC XX.
  3231         16  PB-I-RATE-CODE               PIC X(4).
  3232         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3233         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3234         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3235         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3236         16  PB-I-BANK-NOCHRGB            PIC 99.
  3237         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3238         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3239
  3240     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3241         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3242             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3243         16  PB-C-CANCEL-ORIGIN           PIC X.
  3244             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3245         16  PB-C-LF-CANCEL-DT            PIC XX.
  3246         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3247         16  PB-C-LF-CALC-REQ             PIC X.
  3248             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3249         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3250         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3251         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3252             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3253         16  PB-C-AH-CANCEL-DT            PIC XX.
  3254         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3255         16  PB-C-AH-CALC-REQ             PIC X.
  3256             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3257         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3258         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3259         16  PB-C-LAST-NAME               PIC X(15).
  3260         16  PB-C-REFUND-SW               PIC X.
  3261             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3262             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3263         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3264         16  PB-C-PAYEE-CODE              PIC X(6).
  3265         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3266         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3267         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3268         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3269         16  PB-C-REFERENCE               PIC X(12).
  3270         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3271         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3272         16  PB-C-POST-CARD-IND           PIC X.
  3273         16  PB-C-CANCEL-REASON           PIC X.
  3274         16  PB-C-REF-INTERFACE-SW        PIC X.
  3275         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  3276         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  61
* VP6301.cbl
  3277         16  FILLER                       PIC X(01).
  3278*        16  FILLER                       PIC X(18).
  3279         16  PB-C-POLICY-FORM-NO          PIC X(12).
  3280*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3281         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  3282         16  PB-CANCELED-CERT-DATA.
  3283             20  PB-CI-INSURED-NAME.
  3284                 24  PB-CI-LAST-NAME      PIC X(15).
  3285                 24  PB-CI-INITIALS       PIC XX.
  3286             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3287             20  PB-CI-INSURED-SEX        PIC X.
  3288             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3289             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  3290             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  3291             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3292             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3293             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3294             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3295             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3296             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3297             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3298             20  PB-CI-RATE-CLASS         PIC XX.
  3299             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3300             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3301             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3302             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3303             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3304             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3305             20  PB-CI-LF-ABBR            PIC X(3).
  3306             20  PB-CI-AH-ABBR            PIC X(3).
  3307             20  PB-CI-OB-FLAG            PIC X.
  3308                 88  PB-CI-OB                VALUE 'B'.
  3309             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3310                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3311                                           'M' '4' '5' '9' '2'.
  3312                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3313                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3314                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3315                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3316                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3317                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  3318                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3319                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3320                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3321                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3322                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3323                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3324                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3325             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3326                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3327                                           'M' '4' '5' '9' '2'.
  3328                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3329                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3330                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3331                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3332                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3333                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  3334                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  62
* VP6301.cbl
  3335                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3336                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3337                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3338                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3339                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3340                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3341             20  PB-CI-PAY-FREQUENCY      PIC 99.
  3342             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3343             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3344             20  PB-CI-MEMBER-NO          PIC X(12).
  3345             20  PB-CI-INT-CODE           PIC X.
  3346                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3347                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3348             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3349             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3350             20  PB-CI-COMP-EXCP-SW       PIC X.
  3351                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3352                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3353             20  PB-CI-ENTRY-STATUS       PIC X.
  3354             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3355             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3356             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3357             20  PB-CI-DEATH-DT           PIC XX.
  3358             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3359             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3360             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3361             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3362             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3363             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3364             20  PB-CI-ENTRY-DT              PIC XX.
  3365             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3366             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3367             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3368             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3369             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3370             20  PB-CI-OLD-LOF               PIC XXX.
  3371*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3372             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3373             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3374             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3375             20  PB-CI-INDV-GRP-CD           PIC X.
  3376             20  PB-CI-BENEFICIARY-NAME.
  3377                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3378                 24  FILLER                  PIC X(15).
  3379             20  PB-CI-NOTE-SW               PIC X.
  3380             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3381             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3382             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3383             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3384             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3385             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3386             20  PB-CI-FIRST-NAME            PIC X(10).
  3387             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  3388
  3389         16  FILLER                       PIC X(13).
  3390*032306  16  FILLER                       PIC X(27).
  3391*        16  FILLER                       PIC X(46).
  3392
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  63
* VP6301.cbl
  3393     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3394         16  FILLER                       PIC X(10).
  3395         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3396         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3397         16  PB-M-INSURED-MID-INIT        PIC X.
  3398         16  PB-M-INSURED-AGE             PIC 99.
  3399         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3400         16  PB-M-INSURED-SEX             PIC X.
  3401         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3402         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3403         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3404         16  PB-M-INSURED-CITY-STATE.
  3405             20  PB-M-INSURED-CITY        PIC X(28).
  3406             20  PB-M-INSURED-STATE       PIC XX.
  3407         16  PB-M-INSURED-ZIP-CODE.
  3408             20  PB-M-INSURED-ZIP-PRIME.
  3409                 24  PB-M-INSURED-ZIP-1   PIC X.
  3410                     88  PB-M-CANADIAN-POST-CODE
  3411                                             VALUE 'A' THRU 'Z'.
  3412                 24  FILLER               PIC X(4).
  3413             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3414         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3415                                        PB-M-INSURED-ZIP-CODE.
  3416             20  PM-M-INS-CAN-POST1       PIC XXX.
  3417             20  PM-M-INS-CAN-POST2       PIC XXX.
  3418             20  FILLER                   PIC XXX.
  3419         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3420         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3421         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3422         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3423         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3424         16  PB-M-CRED-BENE-CITYST.
  3425             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3426             20  PB-M-CRED-BENE-STATE     PIC XX.
  3427         16  FILLER                       PIC X(92).
  3428
  3429     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3430         16  FILLER                       PIC X(10).
  3431         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3432         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3433         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3434         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3435         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3436         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3437         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3438         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3439         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3440         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3441         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3442         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3443         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3444         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3445         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3446         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3447         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3448         16  PB-ACCOUNT-NAME              PIC X(30).
  3449         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3450         16  PB-REFERENCE                 PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  64
* VP6301.cbl
  3451         16  PB-B-RECEIVED-DT             PIC XX.
  3452         16  FILLER                       PIC X(234).
  3453
  3454     12  PB-RECORD-STATUS.
  3455         16  PB-CREDIT-SELECT-DT          PIC XX.
  3456         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  3457         16  PB-BILLED-DT                 PIC XX.
  3458         16  PB-BILLING-STATUS            PIC X.
  3459             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3460             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3461             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3462         16  PB-RECORD-BILL               PIC X.
  3463             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3464             88  PB-RECORD-RETURNED           VALUE 'R'.
  3465             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3466             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  3467             88  PB-OVERRIDE-AH               VALUE 'A'.
  3468             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3469         16  PB-BATCH-ENTRY               PIC X.
  3470             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3471             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3472             88  PB-REISSUED-CERT             VALUE 'E'.
  3473             88  PB-CASH-CERT                 VALUE 'C'.
  3474             88  PB-MONTHLY-CERT              VALUE 'M'.
  3475             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3476             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3477             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3478         16  PB-FORCE-CODE                PIC X.
  3479             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3480             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3481             88  PB-CANCEL-FORCE              VALUE '8'.
  3482             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3483             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3484             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3485             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3486             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3487             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3488             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3489         16  PB-FATAL-FLAG                PIC X.
  3490             88  PB-FATAL-ERRORS              VALUE 'X'.
  3491         16  PB-FORCE-ER-CD               PIC X.
  3492             88  PB-FORCE-ERRORS              VALUE 'F'.
  3493             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3494         16  PB-WARN-ER-CD                PIC X.
  3495             88  PB-WARNING-ERRORS            VALUE 'W'.
  3496         16  FILLER                       PIC X.
  3497         16  PB-OUT-BAL-CD                PIC X.
  3498             88  PB-OUT-OF-BAL                VALUE 'O'.
  3499         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3500         16  PB-AH-OVERRIDE-L1            PIC X.
  3501         16  PB-INPUT-DT                  PIC XX.
  3502         16  PB-INPUT-BY                  PIC X(4).
  3503         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3504         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3505         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3506         16  PB-LF-EARNING-METHOD         PIC X.
  3507         16  PB-AH-EARNING-METHOD         PIC X.
  3508         16  PB-LF-TERM-CALC-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  65
* VP6301.cbl
  3509         16  PB-AH-TERM-CALC-METHOD       PIC X.
  3510         16  PB-REIN-CD                   PIC XXX.
  3511         16  PB-LF-REFUND-TYPE            PIC X.
  3512         16  PB-AH-REFUND-TYPE            PIC X.
  3513         16  PB-ACCT-EFF-DT               PIC XX.
  3514         16  PB-ACCT-EXP-DT               PIC XX.
  3515         16  PB-COMPANY-ID                PIC X(3).
  3516         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3517         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3518         16  PB-SV-CARRIER                PIC X.
  3519         16  PB-SV-GROUPING               PIC X(6).
  3520         16  PB-SV-STATE                  PIC XX.
  3521         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3522         16  PB-GA-BILLING-INFO.
  3523             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3524                                          PIC XX.
  3525         16  PB-SV-REMIT-TO  REDEFINES
  3526             PB-GA-BILLING-INFO           PIC X(10).
  3527         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3528         16  PB-I-LOAN-OFFICER            PIC X(5).
  3529         16  PB-I-VIN                     PIC X(17).
  3530
  3531         16  FILLER                       PIC X(04).
  3532         16  IMNET-BYPASS-SW              PIC X.
  3533
  3534******************************************************************
  3535*                COMMON EDIT ERRORS                              *
  3536******************************************************************
  3537
  3538     12  PB-COMMON-ERRORS.
  3539         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3540                                           PIC S9(4)     COMP.
  3541
  3542******************************************************************
  3543*                                COPY ELCCNTL.
  3544******************************************************************
  3545*                                                                *
  3546*                                                                *
  3547*                            ELCCNTL.                            *
  3548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3549*                            VMOD=2.059                          *
  3550*                                                                *
  3551*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3552*                                                                *
  3553*   FILE TYPE = VSAM,KSDS                                        *
  3554*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3555*                                                                *
  3556*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3557*       ALTERNATE INDEX = NONE                                   *
  3558*                                                                *
  3559*   LOG = YES                                                    *
  3560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3561******************************************************************
  3562*                   C H A N G E   L O G
  3563*
  3564* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3565*-----------------------------------------------------------------
  3566*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  66
* VP6301.cbl
  3567* EFFECTIVE    NUMBER
  3568*-----------------------------------------------------------------
  3569* 082503                   PEMA  ADD BENEFIT GROUP
  3570* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3571* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3572* 092705    2005050300006  PEMA  ADD SPP LEASES
  3573* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3574* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3575* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3576* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3577* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3578* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3579* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3580* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3581* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3582* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3583******************************************************************
  3584*
  3585 01  CONTROL-FILE.
  3586     12  CF-RECORD-ID                       PIC XX.
  3587         88  VALID-CF-ID                        VALUE 'CF'.
  3588
  3589     12  CF-CONTROL-PRIMARY.
  3590         16  CF-COMPANY-ID                  PIC XXX.
  3591         16  CF-RECORD-TYPE                 PIC X.
  3592             88  CF-COMPANY-MASTER              VALUE '1'.
  3593             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3594             88  CF-STATE-MASTER                VALUE '3'.
  3595             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3596             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3597             88  CF-CARRIER-MASTER              VALUE '6'.
  3598             88  CF-MORTALITY-MASTER            VALUE '7'.
  3599             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3600             88  CF-TERMINAL-MASTER             VALUE '9'.
  3601             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3602             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3603             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3604             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3605             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3606             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3607             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3608             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3609             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3610         16  CF-ACCESS-CD-GENL              PIC X(4).
  3611         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3612             20  CF-PROCESSOR               PIC X(4).
  3613         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3614             20  CF-STATE-CODE              PIC XX.
  3615             20  FILLER                     PIC XX.
  3616         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3617             20  FILLER                     PIC XX.
  3618             20  CF-HI-BEN-IN-REC           PIC XX.
  3619         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3620             20  FILLER                     PIC XXX.
  3621             20  CF-CARRIER-CNTL            PIC X.
  3622         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3623             20  FILLER                     PIC XX.
  3624             20  CF-HI-TYPE-IN-REC          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  67
* VP6301.cbl
  3625         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3626             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3627                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3628             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3629             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3630         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3631             20  FILLER                     PIC X.
  3632             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3633         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3634             20  FILLER                     PIC XX.
  3635             20  CF-MORTGAGE-PLAN           PIC XX.
  3636         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3637
  3638     12  CF-LAST-MAINT-DT                   PIC XX.
  3639     12  CF-LAST-MAINT-BY                   PIC X(4).
  3640     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3641
  3642     12  CF-RECORD-BODY                     PIC X(728).
  3643
  3644
  3645****************************************************************
  3646*             COMPANY MASTER RECORD                            *
  3647****************************************************************
  3648
  3649     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3650         16  CF-COMPANY-ADDRESS.
  3651             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3652             20  CF-CL-IN-CARE-OF           PIC X(30).
  3653             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3654             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3655             20  CF-CL-CITY-STATE           PIC X(30).
  3656             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3657             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3658         16  CF-COMPANY-CD                  PIC X.
  3659         16  CF-COMPANY-PASSWORD            PIC X(8).
  3660         16  CF-SECURITY-OPTION             PIC X.
  3661             88  ALL-SECURITY                   VALUE '1'.
  3662             88  COMPANY-VERIFY                 VALUE '2'.
  3663             88  PROCESSOR-VERIFY               VALUE '3'.
  3664             88  NO-SECURITY                    VALUE '4'.
  3665             88  ALL-BUT-TERM                   VALUE '5'.
  3666         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3667             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3668         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3669             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3670         16  CF-INFORCE-LOCATION            PIC X.
  3671             88  CERTS-ARE-ONLINE               VALUE '1'.
  3672             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3673             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3674         16  CF-LOWER-CASE-LETTERS          PIC X.
  3675         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3676             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3677             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3678             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3679             88  CF-ACCNT-CNTL                  VALUE '3'.
  3680             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3681
  3682         16  CF-FORMS-PRINTER-ID            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  68
* VP6301.cbl
  3683         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3684
  3685         16  CF-LGX-CREDIT-USER             PIC X.
  3686             88  CO-IS-NOT-USER                 VALUE 'N'.
  3687             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3688
  3689         16 CF-CREDIT-CALC-CODES.
  3690             20  CF-CR-REM-TERM-CALC PIC X.
  3691               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3692               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3693               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3694               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3695               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3696               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3697               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3698             20  CF-CR-R78-METHOD           PIC X.
  3699               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3700               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3701
  3702         16  CF-CLAIM-CONTROL-COUNTS.
  3703             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3704                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3705
  3706             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3707                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3708
  3709             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3710                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3711
  3712             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3713                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3714
  3715         16  CF-CURRENT-MONTH-END           PIC XX.
  3716
  3717         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3718             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3719             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3720             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3721             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3722                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3723                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3724             20  CF-CO-PREM-REJECT-SW       PIC X.
  3725                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3726                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3727             20  CF-CO-REF-REJECT-SW        PIC X.
  3728                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3729                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3730
  3731         16  CF-CO-REPORTING-DT             PIC XX.
  3732         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3733         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3734           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3735           88  CF-CO-MONTH-END                  VALUE '1'.
  3736
  3737         16  CF-LGX-CLAIM-USER              PIC X.
  3738             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3739             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3740
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  69
* VP6301.cbl
  3741         16  CF-CREDIT-EDIT-CONTROLS.
  3742             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3743             20  CF-MIN-AGE                 PIC 99.
  3744             20  CF-DEFAULT-AGE             PIC 99.
  3745             20  CF-MIN-TERM                PIC S999      COMP-3.
  3746             20  CF-MAX-TERM                PIC S999      COMP-3.
  3747             20  CF-DEFAULT-SEX             PIC X.
  3748             20  CF-JOINT-AGE-INPUT         PIC X.
  3749                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3750             20  CF-BIRTH-DATE-INPUT        PIC X.
  3751                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3752             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3753                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3754                 88  CF-ZERO-CARRIER            VALUE '1'.
  3755                 88  CF-ZERO-GROUPING           VALUE '2'.
  3756                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3757             20  CF-EDIT-SW                 PIC X.
  3758                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3759             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3760             20  CF-CR-PR-METHOD            PIC X.
  3761               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3762               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3763             20  FILLER                     PIC X.
  3764
  3765         16  CF-CREDIT-MISC-CONTROLS.
  3766             20  CF-REIN-TABLE-SW           PIC X.
  3767                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3768             20  CF-COMP-TABLE-SW           PIC X.
  3769                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3770             20  CF-EXPERIENCE-RETENTION-AGE
  3771                                            PIC S9        COMP-3.
  3772             20  CF-CONVERSION-DT           PIC XX.
  3773             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3774             20  CF-RUN-FREQUENCY-SW        PIC X.
  3775                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3776                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3777
  3778             20  CF-CR-CHECK-NO-CONTROL.
  3779                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3780                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3781                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3782                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3783                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3784                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3785
  3786                 24  CF-CR-CHECK-COUNT       REDEFINES
  3787                     CF-CR-CHECK-COUNTER      PIC X(4).
  3788
  3789                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3790                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3791
  3792                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3793                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3794                 24  CF-MAIL-PROCESSING       PIC X.
  3795                     88  MAIL-PROCESSING          VALUE 'Y'.
  3796
  3797         16  CF-MISC-SYSTEM-CONTROL.
  3798             20  CF-SYSTEM-C                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  70
* VP6301.cbl
  3799                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3800             20  CF-SYSTEM-D                 PIC X.
  3801                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3802             20  CF-SOC-SEC-NO-SW            PIC X.
  3803                 88  SOC-SEC-NO-USED             VALUE '1'.
  3804             20  CF-MEMBER-NO-SW             PIC X.
  3805                 88  MEMBER-NO-USED              VALUE '1'.
  3806             20  CF-TAX-ID-NUMBER            PIC X(11).
  3807             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3808             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3809                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3810                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3811                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3812                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3813             20  CF-SYSTEM-E                 PIC X.
  3814                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3815
  3816         16  CF-LGX-LIFE-USER               PIC X.
  3817             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3818             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3819
  3820         16  CF-CR-MONTH-END-DT             PIC XX.
  3821
  3822         16  CF-FILE-MAINT-DATES.
  3823             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3824                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3825             20  CF-LAST-BATCH       REDEFINES
  3826                 CF-LAST-BATCH-NO               PIC X(4).
  3827             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3828             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3829             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3830             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3831             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3832             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3833             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3834             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3835             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3836             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3837
  3838         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3839         16  FILLER                         PIC X.
  3840
  3841         16  CF-ALT-MORT-CODE               PIC X(4).
  3842         16  CF-MEMBER-CAPTION              PIC X(10).
  3843
  3844         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3845             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3846             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3847             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3848             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3849             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3850
  3851         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3852
  3853         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3854         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3855         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3856         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  71
* VP6301.cbl
  3857
  3858         16  CF-AH-OVERRIDE-L1              PIC X.
  3859         16  CF-AH-OVERRIDE-L2              PIC XX.
  3860         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3861         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3862
  3863         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3864         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3865
  3866         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3867         16  CF-AR-LAST-EL860-DT            PIC XX.
  3868         16  CF-MP-MONTH-END-DT             PIC XX.
  3869
  3870         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3871         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3872             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3873
  3874         16  CF-AR-MONTH-END-DT             PIC XX.
  3875
  3876         16  CF-CRDTCRD-USER                PIC X.
  3877             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3878             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3879
  3880         16  CF-CC-MONTH-END-DT             PIC XX.
  3881
  3882         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3883
  3884         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3885             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3886             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3887             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3888         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3889         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3890         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3891         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3892             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3893             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3894         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3895         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3896         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3897             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3898         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3899
  3900         16  CF-CL-ZIP-CODE.
  3901             20  CF-CL-ZIP-PRIME.
  3902                 24  CF-CL-ZIP-1ST          PIC X.
  3903                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3904                 24  FILLER                 PIC X(4).
  3905             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3906         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3907             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3908             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3909             20  FILLER                     PIC XXX.
  3910
  3911         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3912         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3913         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3914         16  CF-CO-OPTION-START-DATE        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  72
* VP6301.cbl
  3915         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3916           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3917                                                      '3' '4'.
  3918           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3919           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3920           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3921           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3922           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3923           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3924
  3925         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3926
  3927         16  CF-PAYMENT-APPROVAL-LEVELS.
  3928             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3929             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3930             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3931             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3932             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3933             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3934
  3935         16  CF-END-USER-REPORTING-USER     PIC X.
  3936             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3937             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3938
  3939         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3940             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3941             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3942
  3943         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3944
  3945         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3946         16  FILLER                         PIC X.
  3947
  3948         16  CF-CREDIT-ARCHIVE-CNTL.
  3949             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3950             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3951             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3952
  3953         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3954
  3955         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3956             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3957             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3958
  3959         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3960             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3961             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3962
  3963         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3964
  3965         16  CF-CO-ACH-ID-CODE              PIC  X.
  3966             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3967             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3968             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3969         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3970         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3971         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3972         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  73
* VP6301.cbl
  3973         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3974         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3975         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3976         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3977         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3978                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3979         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3980                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3981
  3982         16  CF-CO-OVER-SHORT.
  3983             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3984             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3985
  3986*         16  FILLER                         PIC X(102).
  3987         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3988             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3989             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3990
  3991         16  CF-AH-APPROVAL-DAYS.
  3992             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3993             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3994             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3995             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3996
  3997         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3998
  3999         16  CF-APPROV-LEV-5.
  4000             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4001             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4002             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4003
  4004         16  FILLER                         PIC X(68).
  4005****************************************************************
  4006*             PROCESSOR/USER RECORD                            *
  4007****************************************************************
  4008
  4009     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4010         16  CF-PROCESSOR-NAME              PIC X(30).
  4011         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4012         16  CF-PROCESSOR-TITLE             PIC X(26).
  4013         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4014                 88  MESSAGE-YES                VALUE 'Y'.
  4015                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4016
  4017*****************************************************
  4018****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4019****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4020****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4021****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4022*****************************************************
  4023
  4024         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4025             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4026             20  CF-APPLICATION-FORCE       PIC X.
  4027             20  CF-INDIVIDUAL-APP.
  4028                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4029                     28  CF-BROWSE-APP      PIC X.
  4030                     28  CF-UPDATE-APP      PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  74
* VP6301.cbl
  4031
  4032         16  CF-CURRENT-TERM-ON             PIC X(4).
  4033         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4034             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4035             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4036             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4037             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4038             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4039             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4040             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4041         16  CF-PROCESSOR-CARRIER           PIC X.
  4042             88  NO-CARRIER-SECURITY            VALUE ' '.
  4043         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4044             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4045         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4046             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4047         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4048             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4049
  4050         16  CF-PROC-SYS-ACCESS-SW.
  4051             20  CF-PROC-CREDIT-CLAIMS-SW.
  4052                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4053                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4054                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4055                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4056             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4057                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4058                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4059             20  CF-PROC-LIFE-GNRLDGR-SW.
  4060                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4061                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4062                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4063                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4064             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4065                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4066                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4067         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4068             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4069             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4070         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4071
  4072         16  CF-APPROVAL-LEVEL                  PIC X.
  4073             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4074             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4075             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4076             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4077             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4078
  4079         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4080
  4081         16  CF-LANGUAGE-TYPE                   PIC X.
  4082             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4083             88  CF-LANG-IS-FR                      VALUE 'F'.
  4084
  4085         16  CF-CSR-IND                         PIC X.
  4086         16  FILLER                             PIC X(239).
  4087
  4088****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  75
* VP6301.cbl
  4089*             PROCESSOR/REMINDERS RECORD                       *
  4090****************************************************************
  4091
  4092     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4093         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4094             20  CF-START-REMIND-DT         PIC XX.
  4095             20  CF-END-REMIND-DT           PIC XX.
  4096             20  CF-REMINDER-TEXT           PIC X(50).
  4097         16  FILLER                         PIC X(296).
  4098
  4099
  4100****************************************************************
  4101*             STATE MASTER RECORD                              *
  4102****************************************************************
  4103
  4104     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4105         16  CF-STATE-ABBREVIATION          PIC XX.
  4106         16  CF-STATE-NAME                  PIC X(25).
  4107         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4108         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4109             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4110             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4111             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4112             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4113                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4114                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4115             20  CF-ST-PREM-REJECT-SW       PIC X.
  4116                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4117                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4118             20  CF-ST-REF-REJECT-SW        PIC X.
  4119                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4120                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4121         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4122         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4123         16  CF-ST-REFUND-RULES.
  4124             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4125             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4126             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4127         16  CF-ST-FST-PMT-EXTENSION.
  4128             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4129             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4130                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4131                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4132                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4133                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4134         16  CF-ST-STATE-CALL.
  4135             20  CF-ST-CALL-UNEARNED        PIC X.
  4136             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4137             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4138         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4139             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4140             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4141         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4142         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4143         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4144         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4145         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4146         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  76
* VP6301.cbl
  4147         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4148             20  CF-ST-BENEFIT-CD           PIC XX.
  4149             20  CF-ST-BENEFIT-KIND         PIC X.
  4150                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4151                 88  CF-ST-AH-KIND              VALUE 'A'.
  4152             20  CF-ST-REM-TERM-CALC        PIC X.
  4153                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4154                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4155                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4156                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4157                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4158                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4159                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4160                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4161
  4162             20  CF-ST-REFUND-CALC          PIC X.
  4163                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4164                 88  ST-REFD-BY-R78             VALUE '1'.
  4165                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4166                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4167                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4168                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4169                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4170                 88  ST-REFD-UTAH               VALUE '7'.
  4171                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4172                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4173                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4174
  4175             20  CF-ST-EARNING-CALC         PIC X.
  4176                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4177                 88  ST-EARN-BY-R78             VALUE '1'.
  4178                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4179                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4180                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4181                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4182                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4183                 88  ST-EARN-MEAN               VALUE '8'.
  4184                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4185
  4186             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4187                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4188                 88  ST-OVRD-BY-R78             VALUE '1'.
  4189                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4190                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4191                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4192                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4193                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4194                 88  ST-OVRD-MEAN               VALUE '8'.
  4195                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4196             20  cf-st-extra-periods        pic 9.
  4197*            20  FILLER                     PIC X.
  4198
  4199         16  CF-ST-COMMISSION-CAPS.
  4200             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4201             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4202             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4203             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4204         16  CF-COMM-CAP-LIMIT-TO           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  77
* VP6301.cbl
  4205                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4206
  4207         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4208
  4209         16  CF-ST-STATUTORY-INTEREST.
  4210             20  CF-ST-STAT-DATE-FROM       PIC X.
  4211                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4212                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4213             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4214             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4215             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4216             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4217             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4218
  4219         16  CF-ST-OVER-SHORT.
  4220             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4221             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4222
  4223         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4224
  4225         16  CF-ST-RT-CALC                  PIC X.
  4226
  4227         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4228         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4229         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4230         16  CF-ST-RF-LR-CALC               PIC X.
  4231         16  CF-ST-RF-LL-CALC               PIC X.
  4232         16  CF-ST-RF-LN-CALC               PIC X.
  4233         16  CF-ST-RF-AH-CALC               PIC X.
  4234         16  CF-ST-RF-CP-CALC               PIC X.
  4235*        16  FILLER                         PIC X(206).
  4236*CIDMOD         16  FILLER                         PIC X(192).
  4237         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4238             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4239         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4240         16  CF-ST-VFY-2ND-BENE             PIC X.
  4241         16  CF-ST-CAUSAL-STATE             PIC X.
  4242         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4243         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4244         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4245             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4246         16  CF-ST-NET-ONLY-STATE           PIC X.
  4247             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4248         16  FILLER                         PIC X(181).
  4249
  4250****************************************************************
  4251*             BENEFIT MASTER RECORD                            *
  4252****************************************************************
  4253
  4254     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4255         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4256             20  CF-BENEFIT-CODE            PIC XX.
  4257             20  CF-BENEFIT-NUMERIC  REDEFINES
  4258                 CF-BENEFIT-CODE            PIC XX.
  4259             20  CF-BENEFIT-ALPHA           PIC XXX.
  4260             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4261             20  CF-BENEFIT-COMMENT         PIC X(10).
  4262
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  78
* VP6301.cbl
  4263             20  CF-LF-COVERAGE-TYPE        PIC X.
  4264                 88  CF-REDUCING                VALUE 'R'.
  4265                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4266
  4267             20  CF-SPECIAL-CALC-CD         PIC X.
  4268                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4269                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4270                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4271                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4272                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4273                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4274                 88  CF-FARM-PLAN               VALUE 'F'.
  4275                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4276                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4277                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4278                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4279                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4280                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4281                 88  CF-PRUDENTIAL              VALUE 'P'.
  4282                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4283                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4284                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4285                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4286                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4287                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4288
  4289             20  CF-JOINT-INDICATOR         PIC X.
  4290                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4291
  4292*            20  FILLER                     PIC X(12).
  4293             20  cf-maximum-benefits        pic s999 comp-3.
  4294             20  FILLER                     PIC X(09).
  4295             20  CF-BENEFIT-CATEGORY        PIC X.
  4296             20  CF-LOAN-TYPE               PIC X(8).
  4297
  4298             20  CF-CO-REM-TERM-CALC        PIC X.
  4299                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4300                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4301                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4302                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4303                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4304
  4305             20  CF-CO-EARNINGS-CALC        PIC X.
  4306                 88  CO-EARN-BY-R78             VALUE '1'.
  4307                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4308                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4309                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4310                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4311                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4312                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4313                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4314
  4315             20  CF-CO-REFUND-CALC          PIC X.
  4316                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4317                 88  CO-REFD-BY-R78             VALUE '1'.
  4318                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4319                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4320                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  79
* VP6301.cbl
  4321                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4322                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4323                 88  CO-REFD-MEAN               VALUE '8'.
  4324                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4325                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4326                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4327
  4328             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4329                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4330                 88  CO-OVRD-BY-R78             VALUE '1'.
  4331                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4332                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4333                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4334                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4335                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4336                 88  CO-OVRD-MEAN               VALUE '8'.
  4337                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4338
  4339             20  CF-CO-BEN-I-G-CD           PIC X.
  4340                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4341                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4342                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4343
  4344         16  FILLER                         PIC X(304).
  4345
  4346
  4347****************************************************************
  4348*             CARRIER MASTER RECORD                            *
  4349****************************************************************
  4350
  4351     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4352         16  CF-ADDRESS-DATA.
  4353             20  CF-MAIL-TO-NAME            PIC X(30).
  4354             20  CF-IN-CARE-OF              PIC X(30).
  4355             20  CF-ADDRESS-LINE-1          PIC X(30).
  4356             20  CF-ADDRESS-LINE-2          PIC X(30).
  4357             20  CF-CITY-STATE              PIC X(30).
  4358             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4359             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4360
  4361         16  CF-CLAIM-NO-CONTROL.
  4362             20  CF-CLAIM-NO-METHOD         PIC X.
  4363                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4364                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4365                 88  CLAIM-NO-SEQ               VALUE '3'.
  4366                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4367             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4368                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4369                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4370                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4371
  4372         16  CF-CHECK-NO-CONTROL.
  4373             20  CF-CHECK-NO-METHOD         PIC X.
  4374                 88  CHECK-NO-MANUAL            VALUE '1'.
  4375                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4376                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4377                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4378             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  80
* VP6301.cbl
  4379                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4380
  4381         16  CF-DOMICILE-STATE              PIC XX.
  4382
  4383         16  CF-EXPENSE-CONTROLS.
  4384             20  CF-EXPENSE-METHOD          PIC X.
  4385                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4386                 88  DOLLARS-PER-PMT            VALUE '2'.
  4387                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4388                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4389             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4390             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4391
  4392         16  CF-CORRESPONDENCE-CONTROL.
  4393             20  CF-LETTER-RESEND-OPT       PIC X.
  4394                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4395                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4396             20  FILLER                     PIC X(4).
  4397
  4398         16  CF-RESERVE-CONTROLS.
  4399             20  CF-MANUAL-SW               PIC X.
  4400                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4401             20  CF-FUTURE-SW               PIC X.
  4402                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4403             20  CF-PTC-SW                  PIC X.
  4404                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4405             20  CF-IBNR-SW                 PIC X.
  4406                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4407             20  CF-PTC-LF-SW               PIC X.
  4408                 88  CF-LF-PTC-USED             VALUE '1'.
  4409             20  CF-CDT-ACCESS-METHOD       PIC X.
  4410                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4411                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4412                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4413             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4414
  4415         16  CF-CLAIM-CALC-METHOD           PIC X.
  4416             88  360-PLUS-MONTHS                VALUE '1'.
  4417             88  365-PLUS-MONTHS                VALUE '2'.
  4418             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4419             88  360-DAILY                      VALUE '4'.
  4420             88  365-DAILY                      VALUE '5'.
  4421
  4422         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4423         16  FILLER                         PIC X(11).
  4424
  4425         16  CF-LIMIT-AMOUNTS.
  4426             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4427             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4428             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4429             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4430             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4431             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4432             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4433             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4434             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4435             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4436
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  81
* VP6301.cbl
  4437         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4438         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4439         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4440
  4441         16  CF-ZIP-CODE.
  4442             20  CF-ZIP-PRIME.
  4443                 24  CF-ZIP-1ST             PIC X.
  4444                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4445                 24  FILLER                 PIC X(4).
  4446             20  CF-ZIP-PLUS4               PIC X(4).
  4447         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4448             20  CF-CAN-POSTAL-1            PIC XXX.
  4449             20  CF-CAN-POSTAL-2            PIC XXX.
  4450             20  FILLER                     PIC XXX.
  4451
  4452         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4453         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4454         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4455
  4456         16  CF-RATING-SWITCH               PIC X.
  4457             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4458             88  CF-NO-RATING                   VALUE 'N'.
  4459
  4460         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4461
  4462         16  CF-CARRIER-OVER-SHORT.
  4463             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4464             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4465
  4466         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4467         16  CF-SECPAY-SWITCH               PIC X.
  4468             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4469             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4470         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4471         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4472         16  FILLER                         PIC X(444).
  4473*        16  FILLER                         PIC X(452).
  4474
  4475
  4476****************************************************************
  4477*             MORTALITY MASTER RECORD                          *
  4478****************************************************************
  4479
  4480     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4481         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4482                                INDEXED BY CF-MORT-NDX.
  4483             20  CF-MORT-TABLE              PIC X(5).
  4484             20  CF-MORT-TABLE-TYPE         PIC X.
  4485                 88  CF-MORT-JOINT              VALUE 'J'.
  4486                 88  CF-MORT-SINGLE             VALUE 'S'.
  4487                 88  CF-MORT-COMBINED           VALUE 'C'.
  4488                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4489                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4490             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4491             20  CF-MORT-AGE-METHOD         PIC XX.
  4492                 88  CF-AGE-LAST                VALUE 'AL'.
  4493                 88  CF-AGE-NEAR                VALUE 'AN'.
  4494             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  82
* VP6301.cbl
  4495             20  CF-MORT-ADJUSTMENT-DIRECTION
  4496                                            PIC X.
  4497                 88  CF-MINUS                   VALUE '-'.
  4498                 88  CF-PLUS                    VALUE '+'.
  4499             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4500             20  CF-MORT-JOINT-CODE         PIC X.
  4501                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4502             20  CF-MORT-PC-Q               PIC X.
  4503                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4504             20  CF-MORT-TABLE-CODE         PIC X(4).
  4505             20  CF-MORT-COMMENTS           PIC X(15).
  4506             20  FILLER                     PIC X(14).
  4507
  4508         16  FILLER                         PIC X(251).
  4509
  4510
  4511****************************************************************
  4512*             BUSSINESS TYPE MASTER RECORD                     *
  4513****************************************************************
  4514
  4515     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4516* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4517* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4518* AND RECORD 05 IS TYPES 81-99
  4519         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4520             20  CF-BUSINESS-TITLE          PIC  X(19).
  4521             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4522                                            PIC S9V9(4) COMP-3.
  4523             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4524             20  FILLER                     PIC  X.
  4525         16  FILLER                         PIC  X(248).
  4526
  4527
  4528****************************************************************
  4529*             TERMINAL MASTER RECORD                           *
  4530****************************************************************
  4531
  4532     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4533
  4534         16  CF-COMPANY-TERMINALS.
  4535             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4536                                  PIC X(4).
  4537         16  FILLER               PIC X(248).
  4538
  4539
  4540****************************************************************
  4541*             LIFE EDIT MASTER RECORD                          *
  4542****************************************************************
  4543
  4544     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4545         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4546             20  CF-LIFE-CODE-IN            PIC XX.
  4547             20  CF-LIFE-CODE-OUT           PIC XX.
  4548         16  FILLER                         PIC X(248).
  4549
  4550
  4551****************************************************************
  4552*             AH EDIT MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  83
* VP6301.cbl
  4553****************************************************************
  4554
  4555     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4556         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4557             20  CF-AH-CODE-IN              PIC XXX.
  4558             20  CF-AH-CODE-OUT             PIC XX.
  4559         16  FILLER                         PIC X(248).
  4560
  4561
  4562****************************************************************
  4563*             CREDIBILITY TABLES                               *
  4564****************************************************************
  4565
  4566     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4567         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4568                             INDEXED BY CF-CRDB-NDX.
  4569             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4570             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4571             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4572         16  FILLER                         PIC  X(332).
  4573
  4574
  4575****************************************************************
  4576*             REPORT CUSTOMIZATION RECORD                      *
  4577****************************************************************
  4578
  4579     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4580         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4581             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4582             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4583             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4584**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4585****       A T-TRANSFER.                                   ****
  4586             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4587
  4588         16  FILLER                         PIC XX.
  4589
  4590         16  CF-CARRIER-CNTL-OPT.
  4591             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4592                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4593                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4594             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4595                                            PIC X.
  4596         16  CF-GROUP-CNTL-OPT.
  4597             20  CF-GROUP-OPT-SEQ           PIC 9.
  4598                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4599                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4600             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4601                                            PIC X(6).
  4602         16  CF-STATE-CNTL-OPT.
  4603             20  CF-STATE-OPT-SEQ           PIC 9.
  4604                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4605                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4606             20  CF-STATE-SELECT OCCURS 3 TIMES
  4607                                            PIC XX.
  4608         16  CF-ACCOUNT-CNTL-OPT.
  4609             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4610                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  84
* VP6301.cbl
  4611                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4612             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4613                                            PIC X(10).
  4614         16  CF-BUS-TYP-CNTL-OPT.
  4615             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4616                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4617                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4618             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4619                                            PIC XX.
  4620         16  CF-LF-TYP-CNTL-OPT.
  4621             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4622                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4623                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4624             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4625                                            PIC XX.
  4626         16  CF-AH-TYP-CNTL-OPT.
  4627             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4628                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4629                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4630             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4631                                            PIC XX.
  4632         16  CF-REPTCD1-CNTL-OPT.
  4633             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4634                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4635                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4636             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4637                                            PIC X(10).
  4638         16  CF-REPTCD2-CNTL-OPT.
  4639             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4640                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4641                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4642             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4643                                            PIC X(10).
  4644         16  CF-USER1-CNTL-OPT.
  4645             20  CF-USER1-OPT-SEQ           PIC 9.
  4646                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4647                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4648             20  CF-USER1-SELECT OCCURS 3 TIMES
  4649                                            PIC X(10).
  4650         16  CF-USER2-CNTL-OPT.
  4651             20  CF-USER2-OPT-SEQ           PIC 9.
  4652                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4653                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4654             20  CF-USER2-SELECT OCCURS 3 TIMES
  4655                                            PIC X(10).
  4656         16  CF-USER3-CNTL-OPT.
  4657             20  CF-USER3-OPT-SEQ           PIC 9.
  4658                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4659                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4660             20  CF-USER3-SELECT OCCURS 3 TIMES
  4661                                            PIC X(10).
  4662         16  CF-USER4-CNTL-OPT.
  4663             20  CF-USER4-OPT-SEQ           PIC 9.
  4664                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4665                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4666             20  CF-USER4-SELECT OCCURS 3 TIMES
  4667                                            PIC X(10).
  4668         16  CF-USER5-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  85
* VP6301.cbl
  4669             20  CF-USER5-OPT-SEQ           PIC 9.
  4670                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4671                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4672             20  CF-USER5-SELECT OCCURS 3 TIMES
  4673                                            PIC X(10).
  4674         16  CF-REINS-CNTL-OPT.
  4675             20  CF-REINS-OPT-SEQ           PIC 9.
  4676                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4677                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4678             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4679                 24  CF-REINS-PRIME         PIC XXX.
  4680                 24  CF-REINS-SUB           PIC XXX.
  4681
  4682         16  CF-AGENT-CNTL-OPT.
  4683             20  CF-AGENT-OPT-SEQ           PIC 9.
  4684                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4685                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4686             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4687                                            PIC X(10).
  4688
  4689         16  FILLER                         PIC X(43).
  4690
  4691         16  CF-LOSS-RATIO-SELECT.
  4692             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4693             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4694         16  CF-ENTRY-DATE-SELECT.
  4695             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4696             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4697         16  CF-EFFECTIVE-DATE-SELECT.
  4698             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4699             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4700
  4701         16  CF-EXCEPTION-LIST-IND          PIC X.
  4702             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4703
  4704         16  FILLER                         PIC X(318).
  4705
  4706****************************************************************
  4707*                  EXCEPTION REPORTING RECORD                  *
  4708****************************************************************
  4709
  4710     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4711         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4712             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4713
  4714         16  CF-COMBINED-LIFE-AH-OPT.
  4715             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4716             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4717             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4718             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4719
  4720         16  CF-LIFE-OPT.
  4721             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4722             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4723             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4724             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4725             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4726             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  86
* VP6301.cbl
  4727             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4728             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4729             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4730             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4731
  4732         16  CF-AH-OPT.
  4733             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4734             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4735             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4736             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4737             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4738             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4739             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4740             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4741             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4742             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4743
  4744         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4745             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4746             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4747             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4748
  4749         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4750
  4751         16  FILLER                         PIC X(673).
  4752
  4753
  4754****************************************************************
  4755*             MORTGAGE SYSTEM PLAN RECORD                      *
  4756****************************************************************
  4757
  4758     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4759         16  CF-PLAN-TYPE                   PIC X.
  4760             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4761             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4762             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4763         16  CF-PLAN-ABBREV                 PIC XXX.
  4764         16  CF-PLAN-DESCRIPT               PIC X(10).
  4765         16  CF-PLAN-NOTES                  PIC X(20).
  4766         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4767         16  CF-PLAN-UNDERWRITING.
  4768             20  CF-PLAN-TERM-DATA.
  4769                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4770                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4771             20  CF-PLAN-AGE-DATA.
  4772                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4773                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4774                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4775             20  CF-PLAN-BENEFIT-DATA.
  4776                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4777                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4778                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4779                                            PIC S9(7)V99  COMP-3.
  4780         16  CF-PLAN-POLICY-FORMS.
  4781             20  CF-POLICY-FORM             PIC X(12).
  4782             20  CF-MASTER-APPLICATION      PIC X(12).
  4783             20  CF-MASTER-POLICY           PIC X(12).
  4784         16  CF-PLAN-RATING.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  87
* VP6301.cbl
  4785             20  CF-RATE-CODE               PIC X(5).
  4786             20  CF-SEX-RATING              PIC X.
  4787                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4788                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4789             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4790             20  CF-SUB-STD-TYPE            PIC X.
  4791                 88  CF-PCT-OF-PREM            VALUE '1'.
  4792                 88  CF-PCT-OF-BENE            VALUE '2'.
  4793         16  CF-PLAN-PREM-TOLERANCES.
  4794             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4795             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4796         16  CF-PLAN-PYMT-TOLERANCES.
  4797             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4798             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4799         16  CF-PLAN-MISC-DATA.
  4800             20  FILLER                     PIC X.
  4801             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4802             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4803         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4804         16  CF-PLAN-IND-GRP                PIC X.
  4805             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4806                                                     '1'.
  4807             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4808                                                     '2'.
  4809         16  CF-MIB-SEARCH-SW               PIC X.
  4810             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4811             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4812             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4813             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4814         16  CF-ALPHA-SEARCH-SW             PIC X.
  4815             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4816             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4817             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4818             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4819             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4820             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4821             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4822             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4823             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4824             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4825                                                     'A' 'B' 'C'
  4826                                                     'X' 'Y' 'Z'.
  4827         16  CF-EFF-DT-RULE-SW              PIC X.
  4828             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4829             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4830             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4831             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4832             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4833         16  FILLER                         PIC X(4).
  4834         16  CF-HEALTH-QUESTIONS            PIC X.
  4835             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4836         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4837         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4838         16  CF-PLAN-SNGL-JNT               PIC X.
  4839             88  CF-COMBINED-PLAN              VALUE 'C'.
  4840             88  CF-JNT-PLAN                   VALUE 'J'.
  4841             88  CF-SNGL-PLAN                  VALUE 'S'.
  4842         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  88
* VP6301.cbl
  4843         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4844         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4845         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4846         16  CF-RERATE-CNTL                 PIC  X.
  4847             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4848             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4849             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4850             88  CF-AUTO-RECALC                 VALUE '4'.
  4851         16  CF-BENEFIT-TYPE                PIC  X.
  4852             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4853             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4854         16  CF-POLICY-FEE                  PIC S999V99
  4855                                                    COMP-3.
  4856         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4857         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4858         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4859         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4860         16  FILLER                         PIC  X(32).
  4861         16  CF-TERMINATION-FORM            PIC  X(04).
  4862         16  FILLER                         PIC  X(08).
  4863         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4864                                                       COMP-3.
  4865         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4866         16  CF-ISSUE-LETTER                PIC  X(4).
  4867         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4868         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4869             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4870             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4871         16  CF-MP-REFUND-CALC              PIC X.
  4872             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4873             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4874             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4875             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4876             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4877             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4878             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4879             88  CF-MP-REFD-MEAN                VALUE '8'.
  4880         16  CF-ALT-RATE-CODE               PIC  X(5).
  4881
  4882
  4883         16  FILLER                         PIC X(498).
  4884****************************************************************
  4885*             MORTGAGE COMPANY MASTER RECORD                   *
  4886****************************************************************
  4887
  4888     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4889         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4890         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4891             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4892             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4893             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4894             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4895             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4896
  4897         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4898         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4899         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4900         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  89
* VP6301.cbl
  4901         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4902
  4903         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4904             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4905         16  CF-MP-RECON-USE-IND            PIC X(1).
  4906             88  CF-MP-USE-RECON             VALUE 'Y'.
  4907         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4908             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4909         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4910             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4911             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4912         16  FILLER                         PIC X(1).
  4913         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4914             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4915         16  CF-MORTG-MIB-VERSION           PIC X.
  4916             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4917             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4918             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4919         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4920             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4921                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4922             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4923                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4924             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4925                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4926             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4927                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4928             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4929                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4930             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4931                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4932         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4933         16  FILLER                         PIC X(7).
  4934         16  CF-MORTG-DESTINATION-SYMBOL.
  4935             20  CF-MORTG-MIB-COMM          PIC X(5).
  4936             20  CF-MORTG-MIB-TERM          PIC X(5).
  4937         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4938             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4939         16  FILLER                         PIC X(03).
  4940         16  CF-MP-CHECK-NO-CONTROL.
  4941             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4942                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4943                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4944                                                ' ' LOW-VALUES.
  4945                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4946                                               VALUE '3'.
  4947         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4948         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4949         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4950             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4951                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4952             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4953                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4954             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4955                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4956             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4957                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4958             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  90
* VP6301.cbl
  4959                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4960             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4961                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4962         16  CF-MORTG-BILLING-AREA.
  4963             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4964                                            PIC X.
  4965         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4966         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4967         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4968         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4969             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4970             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4971         16  FILLER                         PIC X.
  4972         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4973             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4974             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4975         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4976         16  FILLER                         PIC X(8).
  4977         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4978         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4979         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4980         16  CF-ACH-COMPANY-ID.
  4981             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4982                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4983                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4984                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4985             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4986         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4987             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4988         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4989             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4990             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4991         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4992         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4993         16  FILLER                         PIC X(536).
  4994
  4995****************************************************************
  4996*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4997****************************************************************
  4998
  4999     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5000         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5001             20  CF-FEMALE-HEIGHT.
  5002                 24  CF-FEMALE-FT           PIC 99.
  5003                 24  CF-FEMALE-IN           PIC 99.
  5004             20  CF-FEMALE-MIN-WT           PIC 999.
  5005             20  CF-FEMALE-MAX-WT           PIC 999.
  5006         16  FILLER                         PIC X(428).
  5007
  5008     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5009         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5010             20  CF-MALE-HEIGHT.
  5011                 24  CF-MALE-FT             PIC 99.
  5012                 24  CF-MALE-IN             PIC 99.
  5013             20  CF-MALE-MIN-WT             PIC 999.
  5014             20  CF-MALE-MAX-WT             PIC 999.
  5015         16  FILLER                         PIC X(428).
  5016******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  91
* VP6301.cbl
  5017*             AUTOMATIC ACTIVITY RECORD                          *
  5018******************************************************************
  5019     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5020         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5021             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5022             20  CF-SYS-LETTER-ID           PIC X(04).
  5023             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5024             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5025             20  CF-SYS-RESET-SW            PIC X(01).
  5026             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5027             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5028
  5029         16  FILLER                         PIC X(50).
  5030
  5031         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5032             20  CF-USER-ACTIVE-SW          PIC X(01).
  5033             20  CF-USER-LETTER-ID          PIC X(04).
  5034             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5035             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5036             20  CF-USER-RESET-SW           PIC X(01).
  5037             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5038             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5039             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5040
  5041         16  FILLER                         PIC X(246).
  5042*                                COPY ELCCERT.
  5043******************************************************************
  5044*                                                                *
  5045*                            ELCCERT.                            *
  5046*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5047*                            VMOD=2.013                          *
  5048*                                                                *
  5049*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5050*                                                                *
  5051*   FILE TYPE = VSAM,KSDS                                        *
  5052*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5053*                                                                *
  5054*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5055*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5056*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5057*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5058*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5059*                                                                *
  5060*   LOG = YES                                                    *
  5061*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5062******************************************************************
  5063*                   C H A N G E   L O G
  5064*
  5065* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5066*-----------------------------------------------------------------
  5067*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5068* EFFECTIVE    NUMBER
  5069*-----------------------------------------------------------------
  5070* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5071* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5072* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5073* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5074* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  92
* VP6301.cbl
  5075* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5076* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5077* 032612  CR2011110200001  PEMA  AHL CHANGES
  5078* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5079* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5080******************************************************************
  5081
  5082 01  CERTIFICATE-MASTER.
  5083     12  CM-RECORD-ID                      PIC XX.
  5084         88  VALID-CM-ID                      VALUE 'CM'.
  5085
  5086     12  CM-CONTROL-PRIMARY.
  5087         16  CM-COMPANY-CD                 PIC X.
  5088         16  CM-CARRIER                    PIC X.
  5089         16  CM-GROUPING.
  5090             20  CM-GROUPING-PREFIX        PIC X(3).
  5091             20  CM-GROUPING-PRIME         PIC X(3).
  5092         16  CM-STATE                      PIC XX.
  5093         16  CM-ACCOUNT.
  5094             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5095             20  CM-ACCOUNT-PRIME          PIC X(6).
  5096         16  CM-CERT-EFF-DT                PIC XX.
  5097         16  CM-CERT-NO.
  5098             20  CM-CERT-PRIME             PIC X(10).
  5099             20  CM-CERT-SFX               PIC X.
  5100
  5101     12  CM-CONTROL-BY-NAME.
  5102         16  CM-COMPANY-CD-A1              PIC X.
  5103         16  CM-INSURED-LAST-NAME          PIC X(15).
  5104         16  CM-INSURED-INITIALS.
  5105             20  CM-INSURED-INITIAL1       PIC X.
  5106             20  CM-INSURED-INITIAL2       PIC X.
  5107
  5108     12  CM-CONTROL-BY-SSN.
  5109         16  CM-COMPANY-CD-A2              PIC X.
  5110         16  CM-SOC-SEC-NO.
  5111             20  CM-SSN-STATE              PIC XX.
  5112             20  CM-SSN-ACCOUNT            PIC X(6).
  5113             20  CM-SSN-LN3.
  5114                 25  CM-INSURED-INITIALS-A2.
  5115                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5116                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5117                 25 CM-PART-LAST-NAME-A2         PIC X.
  5118
  5119     12  CM-CONTROL-BY-CERT-NO.
  5120         16  CM-COMPANY-CD-A4              PIC X.
  5121         16  CM-CERT-NO-A4                 PIC X(11).
  5122
  5123     12  CM-CONTROL-BY-MEMB.
  5124         16  CM-COMPANY-CD-A5              PIC X.
  5125         16  CM-MEMBER-NO.
  5126             20  CM-MEMB-STATE             PIC XX.
  5127             20  CM-MEMB-ACCOUNT           PIC X(6).
  5128             20  CM-MEMB-LN4.
  5129                 25  CM-INSURED-INITIALS-A5.
  5130                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5131                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5132                 25 CM-PART-LAST-NAME-A5         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  93
* VP6301.cbl
  5133
  5134     12  CM-INSURED-PROFILE-DATA.
  5135         16  CM-INSURED-FIRST-NAME.
  5136             20  CM-INSURED-1ST-INIT       PIC X.
  5137             20  FILLER                    PIC X(9).
  5138         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5139         16  CM-INSURED-SEX                PIC X.
  5140             88  CM-SEX-MALE                  VALUE 'M'.
  5141             88  CM-SEX-FEMAL                 VALUE 'F'.
  5142         16  CM-INSURED-JOINT-AGE          PIC 99.
  5143         16  CM-JOINT-INSURED-NAME.
  5144             20  CM-JT-LAST-NAME           PIC X(15).
  5145             20  CM-JT-FIRST-NAME.
  5146                 24  CM-JT-1ST-INIT        PIC X.
  5147                 24  FILLER                PIC X(9).
  5148             20  CM-JT-INITIAL             PIC X.
  5149
  5150     12  CM-LIFE-DATA.
  5151         16  CM-LF-BENEFIT-CD              PIC XX.
  5152         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5153         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5154         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5155         16  CM-LF-DEV-CODE                PIC XXX.
  5156         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5157         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5158         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5159         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5160         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5161         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5162         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5163         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5164         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5165         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5166         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5167         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5168         16  cm-temp-epiq                  pic xx.
  5169             88  EPIQ-CLASS                  value 'EQ'.
  5170*        16  FILLER                        PIC XX.
  5171
  5172     12  CM-AH-DATA.
  5173         16  CM-AH-BENEFIT-CD              PIC XX.
  5174         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5175         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5176         16  CM-AH-DEV-CODE                PIC XXX.
  5177         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5178         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5179         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5180         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5181         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5182         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5183         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5184         16  CM-AH-PAID-THRU-DT            PIC XX.
  5185             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5186         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5187         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5188         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5189         16  FILLER                        PIC X.
  5190
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  94
* VP6301.cbl
  5191     12  CM-LOAN-INFORMATION.
  5192         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5193         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5194                                           PIC S9(5)V99  COMP-3.
  5195         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5196         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5197         16  CM-PAY-FREQUENCY              PIC S99.
  5198         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5199         16  CM-RATE-CLASS                 PIC XX.
  5200         16  CM-BENEFICIARY                PIC X(25).
  5201         16  CM-POLICY-FORM-NO             PIC X(12).
  5202         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5203         16  CM-LAST-ADD-ON-DT             PIC XX.
  5204         16  CM-DEDUCTIBLE-AMOUNTS.
  5205             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5206             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5207         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5208             20  CM-RESIDENT-STATE         PIC XX.
  5209             20  CM-RATE-CODE              PIC X(4).
  5210             20  FILLER                    PIC XX.
  5211         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5212             20  CM-LOAN-OFFICER           PIC X(5).
  5213             20  FILLER                    PIC XXX.
  5214         16  CM-CSR-CODE                   PIC XXX.
  5215         16  CM-UNDERWRITING-CODE          PIC X.
  5216             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5217         16  CM-POST-CARD-IND              PIC X.
  5218         16  CM-NH-INTERFACE-SW            PIC X.
  5219         16  CM-PREMIUM-TYPE               PIC X.
  5220             88  CM-SING-PRM                  VALUE '1'.
  5221             88  CM-O-B-COVERAGE              VALUE '2'.
  5222             88  CM-OPEN-END                  VALUE '3'.
  5223         16  CM-IND-GRP-TYPE               PIC X.
  5224             88  CM-INDIVIDUAL                VALUE 'I'.
  5225             88  CM-GROUP                     VALUE 'G'.
  5226         16  CM-SKIP-CODE                  PIC X.
  5227             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5228             88  SKIP-JULY                    VALUE '1'.
  5229             88  SKIP-AUGUST                  VALUE '2'.
  5230             88  SKIP-SEPTEMBER               VALUE '3'.
  5231             88  SKIP-JULY-AUG                VALUE '4'.
  5232             88  SKIP-AUG-SEPT                VALUE '5'.
  5233             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5234             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5235             88  SKIP-JUNE                    VALUE '8'.
  5236             88  SKIP-JUNE-JULY               VALUE '9'.
  5237             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5238             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5239         16  CM-PAYMENT-MODE               PIC X.
  5240             88  PAY-MONTHLY                  VALUE SPACE.
  5241             88  PAY-WEEKLY                   VALUE '1'.
  5242             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5243             88  PAY-BI-WEEKLY                VALUE '3'.
  5244             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5245         16  CM-LOAN-NUMBER                PIC X(8).
  5246         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5247         16  CM-OLD-LOF                    PIC XXX.
  5248*        16  CM-LOAN-OFFICER               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  95
* VP6301.cbl
  5249         16  CM-REIN-TABLE                 PIC XXX.
  5250         16  CM-SPECIAL-REIN-CODE          PIC X.
  5251         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5252         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5253         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5254
  5255     12  CM-STATUS-DATA.
  5256         16  CM-ENTRY-STATUS               PIC X.
  5257         16  CM-ENTRY-DT                   PIC XX.
  5258
  5259         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5260         16  CM-LF-CANCEL-DT               PIC XX.
  5261         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5262
  5263         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5264         16  CM-LF-DEATH-DT                PIC XX.
  5265         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5266
  5267         16  CM-LF-CURRENT-STATUS          PIC X.
  5268             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5269                                                'M' '4' '5' '9'.
  5270             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5271             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5272             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5273             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5274             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5275             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5276             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5277             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5278             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5279             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5280             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5281             88  CM-LF-DECLINED               VALUE 'D'.
  5282             88  CM-LF-VOIDED                 VALUE 'V'.
  5283
  5284         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5285         16  CM-AH-CANCEL-DT               PIC XX.
  5286         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5287
  5288         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5289         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5290         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5291
  5292         16  CM-AH-CURRENT-STATUS          PIC X.
  5293             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5294                                                'M' '4' '5' '9'.
  5295             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5296             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5297             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5298             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5299             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5300             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5301             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5302             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5303             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5304             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5305             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5306             88  CM-AH-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  96
* VP6301.cbl
  5307             88  CM-AH-VOIDED                 VALUE 'V'.
  5308
  5309         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5310             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5311             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5312             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5313         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5314
  5315         16  CM-ENTRY-BATCH                PIC X(6).
  5316         16  CM-LF-EXIT-BATCH              PIC X(6).
  5317         16  CM-AH-EXIT-BATCH              PIC X(6).
  5318         16  CM-LAST-MONTH-END             PIC XX.
  5319
  5320     12  CM-NOTE-SW                        PIC X.
  5321         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5322         88  CERT-NOTES-PRESENT               VALUE '1'.
  5323         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5324         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5325         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5326         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5327         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5328         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5329     12  CM-COMP-EXCP-SW                   PIC X.
  5330         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5331         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5332     12  CM-INSURED-ADDRESS-SW             PIC X.
  5333         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5334         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5335
  5336*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5337     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5338     12  FILLER                            PIC X.
  5339
  5340*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5341     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5342     12  FILLER                            PIC X.
  5343*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5344     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5345
  5346     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5347         88  CERT-ADDED-BATCH                 VALUE ' '.
  5348         88  CERT-ADDED-ONLINE                VALUE '1'.
  5349         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5350         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5351         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5352     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5353         88  CERT-AS-LOADED                   VALUE ' '.
  5354         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5355         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5356         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5357         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5358         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5359         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5360         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5361
  5362     12  CM-ACCOUNT-COMM-PCTS.
  5363         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5364         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  97
* VP6301.cbl
  5365
  5366     12  CM-USER-FIELD                     PIC X.
  5367     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5368     12  CM-CLP-STATE                      PIC XX.
  5369     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5370     12  CM-USER-RESERVED                  PIC XXX.
  5371     12  FILLER REDEFINES CM-USER-RESERVED.
  5372         16  CM-AH-CLASS-CD                PIC XX.
  5373         16  F                             PIC X.
  5374******************************************************************
  5375*                                COPY ELCCRTT.
  5376******************************************************************
  5377*                                                                *
  5378*                            ELCCRTT.                            *
  5379*                                                                *
  5380*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5381*                                                                *
  5382*   FILE TYPE = VSAM,KSDS                                        *
  5383*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5384*                                                                *
  5385*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5386*                                                                *
  5387*   LOG = YES                                                    *
  5388*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5389******************************************************************
  5390*                   C H A N G E   L O G
  5391*
  5392* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5393*-----------------------------------------------------------------
  5394*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5395* EFFECTIVE    NUMBER
  5396*-----------------------------------------------------------------
  5397* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5398* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5399* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5400* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5401* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5402* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5403* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5404* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5405* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5406******************************************************************
  5407
  5408 01  CERTIFICATE-TRAILERS.
  5409     12  CS-RECORD-ID                      PIC XX.
  5410         88  VALID-CS-ID                      VALUE 'CS'.
  5411
  5412     12  CS-CONTROL-PRIMARY.
  5413         16  CS-COMPANY-CD                 PIC X.
  5414         16  CS-CARRIER                    PIC X.
  5415         16  CS-GROUPING                   PIC X(6).
  5416         16  CS-STATE                      PIC XX.
  5417         16  CS-ACCOUNT                    PIC X(10).
  5418         16  CS-CERT-EFF-DT                PIC XX.
  5419         16  CS-CERT-NO.
  5420             20  CS-CERT-PRIME             PIC X(10).
  5421             20  CS-CERT-SFX               PIC X.
  5422         16  CS-TRAILER-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  98
* VP6301.cbl
  5423             88  COMM-TRLR           VALUE 'A'.
  5424             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5425             88  CERT-DATA-TRLR      VALUE 'C'.
  5426
  5427     12  CS-DATA-AREA                      PIC X(516).
  5428
  5429     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5430         16  CS-BANK-COMMISSION-AREA.
  5431             20  CS-BANK-COMMS       OCCURS 10.
  5432                 24  CS-AGT                PIC X(10).
  5433                 24  CS-COM-TYP            PIC X.
  5434                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5435                 24  CS-RECALC-LV-INDIC    PIC X.
  5436                 24  FILLER                PIC X(10).
  5437         16  FILLER                        PIC X(256).
  5438
  5439     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5440****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5441         16  CS-MB-CLAIM-DATA OCCURS 24.
  5442             20  CS-CLAIM-NO               PIC X(7).
  5443             20  CS-CLAIM-TYPE             PIC X.
  5444                 88  CS-AH-CLM               VALUE 'A'.
  5445                 88  CS-IU-CLM               VALUE 'I'.
  5446                 88  CS-GP-CLM               VALUE 'G'.
  5447                 88  CS-LF-CLM               VALUE 'L'.
  5448                 88  CS-PR-CLM               VALUE 'P'.
  5449                 88  CS-FL-CLM               VALUE 'F'.
  5450             20  CS-INSURED-TYPE           PIC X.
  5451                 88  CS-PRIM-INSURED          VALUE 'P'.
  5452                 88  CS-CO-BORROWER           VALUE 'C'.
  5453             20  CS-BENEFIT-PERIOD         PIC 99.
  5454             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5455             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5456             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5457         16  FILLER                        PIC X(12).
  5458     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5459         16  CS-VIN-NUMBER                 PIC X(17).
  5460         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5461         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5462         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5463         16  cs-agent-name.
  5464             20  cs-agent-fname            pic x(20).
  5465             20  cs-agent-mi               pic x.
  5466             20  cs-agent-lname            pic x(25).
  5467         16  cs-license-no                 pic x(15).
  5468         16  cs-npn-number                 pic x(10).
  5469         16  cs-agent-edit-status          pic x.
  5470             88  cs-ae-refer-to-manager      value 'M'.
  5471             88  cs-ae-cover-sheet           value 'C'.
  5472             88  cs-ae-sig-form              value 'S'.
  5473             88  cs-ae-verified              value 'V'.
  5474             88  cs-unidentified-signature   value 'U'.
  5475             88  cs-cert-returned            value 'R'.
  5476             88  cs-accept-no-commission     value 'N'.
  5477         16  cs-year                       pic 9999.
  5478         16  cs-make                       pic x(20).
  5479         16  cs-model                      pic x(20).
  5480         16  cs-future                     pic x(20).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page  99
* VP6301.cbl
  5481         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5482         16  FILLER                        PIC X(356). *> was 420
  5483*        16  FILLER                        PIC X(496).
  5484*                                COPY ERCPNDM.
  5485******************************************************************
  5486*                                                                *
  5487*                                                                *
  5488*                            ERCPNDM                             *
  5489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5490*                            VMOD=2.003                          *
  5491*                                                                *
  5492*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5493*                                                                *
  5494*   FILE TYPE = VSAM,KSDS                                        *
  5495*   RECORD SIZE = 374   RECFORM = FIX                            *
  5496*                                                                *
  5497*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5498*   ALTERNATE PATH    = NOT USED                                 *
  5499*                                                                *
  5500*   LOG = YES                                                    *
  5501*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5502******************************************************************
  5503*                   C H A N G E   L O G
  5504*
  5505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5506*-----------------------------------------------------------------
  5507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5508* EFFECTIVE    NUMBER
  5509*-----------------------------------------------------------------
  5510* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5511* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5512* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5513******************************************************************
  5514
  5515 01  PENDING-MAILING-DATA.
  5516     12  PM-RECORD-ID                      PIC XX.
  5517         88  VALID-MA-ID                       VALUE 'PM'.
  5518
  5519     12  PM-CONTROL-PRIMARY.
  5520         16  PM-COMPANY-CD                 PIC X.
  5521         16  PM-ENTRY-BATCH                PIC X(6).
  5522         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5523         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5524
  5525     12  FILLER                            PIC X(14).
  5526
  5527     12  PM-ACCESS-CONTROL.
  5528         16  PM-SOURCE-SYSTEM              PIC XX.
  5529             88  PM-FROM-CREDIT                VALUE 'CR'.
  5530             88  PM-FROM-VSI                   VALUE 'VS'.
  5531             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5532             88  PM-FROM-OTHER                 VALUE 'OT'.
  5533         16  PM-RECORD-ADD-DT              PIC XX.
  5534         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5535         16  PM-LAST-MAINT-DT              PIC XX.
  5536         16  PM-LAST-MAINT-BY              PIC XXXX.
  5537         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5538
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 100
* VP6301.cbl
  5539     12  PM-PROFILE-INFO.
  5540         16  PM-QUALIFY-CODE-1             PIC XX.
  5541         16  PM-QUALIFY-CODE-2             PIC XX.
  5542         16  PM-QUALIFY-CODE-3             PIC XX.
  5543         16  PM-QUALIFY-CODE-4             PIC XX.
  5544         16  PM-QUALIFY-CODE-5             PIC XX.
  5545
  5546         16  PM-INSURED-LAST-NAME          PIC X(15).
  5547         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5548         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5549         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5550         16  PM-INSURED-BIRTH-DT           PIC XX.
  5551         16  PM-INSURED-SEX                PIC X.
  5552             88  PM-SEX-MALE                   VALUE 'M'.
  5553             88  PM-SEX-FEMALE                 VALUE 'F'.
  5554         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5555
  5556         16  PM-ADDRESS-CORRECTED          PIC X.
  5557         16  PM-JOINT-BIRTH-DT             PIC XX.
  5558*        16  FILLER                        PIC X(12).
  5559
  5560         16  PM-ADDRESS-LINE-1             PIC X(30).
  5561         16  PM-ADDRESS-LINE-2             PIC X(30).
  5562         16  PM-CITY-STATE.
  5563             20  PM-CITY                   PIC X(28).
  5564             20  PM-STATE                  PIC XX.
  5565         16  PM-ZIP.
  5566             20  PM-ZIP-CODE.
  5567                 24  PM-ZIP-1              PIC X.
  5568                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5569                 24  FILLER                PIC X(4).
  5570             20  PM-ZIP-PLUS4              PIC X(4).
  5571         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5572             20  PM-CAN-POST1              PIC XXX.
  5573             20  PM-CAN-POST2              PIC XXX.
  5574             20  FILLER                    PIC XXX.
  5575
  5576         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5577
  5578         16  FILLER                        PIC X(03).
  5579
  5580     12  PM-CRED-BENE-INFO.
  5581         16  PM-CRED-BENE-NAME             PIC X(25).
  5582         16  PM-CRED-BENE-ADDR             PIC X(30).
  5583         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5584         16  PM-CRED-BENE-CTYST.
  5585             20  PM-CRED-BENE-CITY         PIC X(28).
  5586             20  PM-CRED-BENE-STATE        PIC XX.
  5587         16  PM-CRED-BENE-ZIP.
  5588             20  PM-CB-ZIP-CODE.
  5589                 24  PM-CB-ZIP-1           PIC X.
  5590                     88  PM-CB-CANADIAN-POST-CODE
  5591                                  VALUE 'A' THRU 'Z'.
  5592                 24  FILLER                PIC X(4).
  5593             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5594         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5595             20  PM-CB-CAN-POST1           PIC XXX.
  5596             20  PM-CB-CAN-POST2           PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 101
* VP6301.cbl
  5597             20  FILLER                    PIC XXX.
  5598     12  PM-POST-CARD-MAIL-DATA.
  5599         16  PM-MAIL-DATA OCCURS 7.
  5600             20  PM-MAIL-TYPE              PIC X.
  5601                 88  PM-12MO-MAILING           VALUE '1'.
  5602                 88  PM-EXP-MAILING            VALUE '2'.
  5603             20  PM-MAIL-STATUS            PIC X.
  5604                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5605                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5606                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5607             20  PM-MAIL-DATE              PIC XX.
  5608     12  FILLER                            PIC XX.
  5609     12  FILLER                            PIC X(12).
  5610*    12  FILLER                            PIC X(30).
  5611
  5612******************************************************************
  5613 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5614                          CONTROL-FILE CERTIFICATE-MASTER
  5615                          CERTIFICATE-TRAILERS
  5616                          PENDING-MAILING-DATA.
  5617 0000-DFHEXIT SECTION.
  5618     MOVE '9#                    $   ' TO DFHEIV0.
  5619     MOVE 'VP6301' TO DFHEIV1.
  5620     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5621     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5622     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  5623     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  5624     IF EIBCALEN = 0
  5625         GO TO 8800-UNAUTHORIZED-ACCESS.
  5626     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5627     MOVE '5'                    TO DC-OPTION-CODE.
  5628     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5629     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  5630     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  5631     MOVE DC-GREG-DATE-1-MDY     TO WS-COMPARE-CURRENT-DT.
  5632     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5633         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5634             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5635             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5636             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5637             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5638             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5639             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5640             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5641             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5642         ELSE
  5643             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5644             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5645             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5646             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5647             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5648             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5649             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5650             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5651     MOVE LOW-VALUES             TO VP630BI.
  5652     IF EIBTRNID NOT = TRANS-EXA6
  5653         MOVE ZEROS              TO PI-LF-ISS-ENTERED
  5654                                    PI-LF-CAN-ENTERED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 102
* VP6301.cbl
  5655                                    PI-AH-ISS-ENTERED
  5656                                    PI-AH-CAN-ENTERED
  5657                                    PI-ISS-CNT-ENTERED
  5658                                    PI-CAN-CNT-ENTERED
  5659         IF PI-MAINT-FUNC = 'N'
  5660            MOVE +0              TO PI-LAST-SEQ-NO-ADDED
  5661            MOVE +1              TO PI-NEXT-DISPLAY-SEQ-NO
  5662            IF PI-MAP-NAME = VP630B
  5663               PERFORM 8550-SET-MAP-SEQ-NOS
  5664               GO TO 8100-SEND-INITIAL-MAP
  5665            ELSE
  5666               PERFORM 8550-SET-MAP-SEQ-NOS
  5667                       VARYING WS-SUB2 FROM 1 BY 1
  5668                       UNTIL WS-SUB2   GREATER 4
  5669                 GO TO 8100-SEND-INITIAL-MAP
  5670         ELSE
  5671             GO TO 3000-CONTINUE-ENTRY.
  5672
  5673* EXEC CICS HANDLE CONDITION
  5674*        PGMIDERR  (9600-PGMID-ERROR)
  5675*        ERROR     (9990-ABEND)
  5676*    END-EXEC.
  5677*    MOVE '"$L.                  ! " #00005668' TO DFHEIV0
  5678     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5680     MOVE X'2220233030303035363638' TO DFHEIV0(25:11)
  5681     CALL 'kxdfhei1' USING DFHEIV0
  5682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5683
  5684     IF EIBAID = DFHCLEAR
  5685         MOVE SPACE TO PI-DISPLAY-SW
  5686                       PI-BROWSE-SW
  5687         GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 103
* VP6301.cbl
  5689 0200-RECEIVE.
  5690     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5691         MOVE ER-0008            TO EMI-ERROR
  5692         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5693         IF PI-MAP-NAME = VP630B
  5694             MOVE -1             TO BPFENTRL
  5695             GO TO 8200-SEND-DATAONLY
  5696         ELSE
  5697             MOVE -1             TO CPFENTRL
  5698             GO TO 8200-SEND-DATAONLY.
  5699
  5700* EXEC CICS RECEIVE
  5701*        MAP      (PI-MAP-NAME)
  5702*        MAPSET   (MAPSET-VP6301S)
  5703*        INTO     (VP630BI)
  5704*    END-EXEC.
  5705     MOVE LENGTH OF
  5706      VP630BI
  5707       TO DFHEIV11
  5708*    MOVE '8"T I  L              ''   #00005687' TO DFHEIV0
  5709     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5710     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5711     MOVE X'2020233030303035363837' TO DFHEIV0(25:11)
  5712     CALL 'kxdfhei1' USING DFHEIV0,
  5713           PI-MAP-NAME,
  5714           VP630BI,
  5715           DFHEIV11,
  5716           MAPSET-VP6301S,
  5717           DFHEIV99,
  5718           DFHEIV99
  5719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5720
  5721     INSPECT VP630BI CONVERTING '_' TO ' '.
  5722     IF PI-MAP-NAME = VP630B
  5723         IF BPFENTRL GREATER ZERO
  5724             IF EIBAID NOT = DFHENTER
  5725                 MOVE ER-0004    TO EMI-ERROR
  5726                 MOVE AL-UNBOF   TO BPFENTRA
  5727                 MOVE -1         TO BPFENTRL
  5728                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5729                 GO TO 8200-SEND-DATAONLY
  5730             ELSE
  5731                 IF BPFENTRI NUMERIC AND
  5732                    BPFENTRI GREATER 0 AND LESS 23
  5733                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  5734                 ELSE
  5735                     MOVE ER-0029  TO EMI-ERROR
  5736                     MOVE AL-UNBOF TO BPFENTRA
  5737                     MOVE -1       TO BPFENTRL
  5738                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5739                     GO TO 8200-SEND-DATAONLY
  5740         ELSE
  5741             NEXT SENTENCE
  5742     ELSE
  5743     IF PI-MAP-NAME = VP630C
  5744         IF CPFENTRL GREATER ZERO
  5745             IF EIBAID NOT = DFHENTER
  5746                 MOVE ER-0004    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 104
* VP6301.cbl
  5747                 MOVE AL-UNBOF   TO CPFENTRA
  5748                 MOVE -1         TO CPFENTRL
  5749                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5750                 GO TO 8200-SEND-DATAONLY
  5751             ELSE
  5752                 IF CPFENTRI NUMERIC AND
  5753                    CPFENTRI GREATER 0 AND LESS 23
  5754                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  5755                 ELSE
  5756                     MOVE ER-0029  TO EMI-ERROR
  5757                     MOVE AL-UNBOF TO BPFENTRA
  5758                     MOVE -1       TO BPFENTRL
  5759                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5760                     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 105
* VP6301.cbl
  5762******************************************************************
  5763*   PF KEY FUNCTIONS:                                            *
  5764*                                                                *
  5765*   PF1 = BROWSE FOWARD                                          *
  5766*   PF2 = BROWSE BACKWARD                                        *
  5767*   PF3 = ADD ISSUE RECORD                                       *
  5768*   PF4 = ADD CANCEL RECORD                                      *
  5769*   PF5 = RESET TABS (OPEN PROTECTED FIELDS)                     *
  5770*   PF6 = DELETE ENTRY                                           *
  5771******************************************************************
  5772 0300-CHECK-PFKEYS.
  5773     IF EIBAID = DFHPF12
  5774         GO TO 9500-PF12.
  5775     IF EIBAID NOT = DFHPF5
  5776        MOVE SPACE               TO PI-BROWSE-SW.
  5777     IF EIBAID = DFHENTER
  5778         GO TO 1000-EDIT-MAPB.
  5779     IF EIBAID = DFHPF1
  5780         MOVE 'Y'                TO PI-BROWSE-SW
  5781         GO TO 2000-BROWSE-FWD.
  5782     IF EIBAID = DFHPF2
  5783         MOVE 'Y'                TO PI-BROWSE-SW
  5784         GO TO 2100-BROWSE-BKWD.
  5785     IF EIBAID = DFHPF3
  5786         MOVE SPACE              TO PI-DISPLAY-SW
  5787         MOVE LOW-VALUES         TO VP630BI
  5788         ADD +1                     PI-LAST-SEQ-NO-ADDED
  5789               GIVING PI-NEXT-DISPLAY-SEQ-NO
  5790         MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ
  5791         MOVE VP630B             TO PI-MAP-NAME
  5792         PERFORM 8550-SET-MAP-SEQ-NOS
  5793         GO TO 8100-SEND-INITIAL-MAP.
  5794     IF EIBAID = DFHPF4
  5795         MOVE SPACE              TO PI-DISPLAY-SW
  5796         MOVE LOW-VALUES         TO MAP-C
  5797         ADD +1                     PI-LAST-SEQ-NO-ADDED
  5798               GIVING PI-NEXT-DISPLAY-SEQ-NO
  5799         MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ
  5800         MOVE VP630C             TO PI-MAP-NAME
  5801         PERFORM 8550-SET-MAP-SEQ-NOS
  5802                VARYING WS-SUB2 FROM 1 BY 1
  5803                UNTIL WS-SUB2 GREATER +4
  5804         GO TO 8100-SEND-INITIAL-MAP.
  5805     IF EIBAID = DFHPF5
  5806        IF PI-BROWSE
  5807           IF PI-MAP-NAME = VP630B
  5808              MOVE -1          TO BEFFDTL
  5809              GO TO 8200-SEND-DATAONLY
  5810           ELSE
  5811              MOVE -1          TO CCERT-LEN (1)
  5812              GO TO 8200-SEND-DATAONLY.
  5813     IF EIBAID = DFHPF5
  5814        IF PI-MAP-NAME = VP630B
  5815           PERFORM 0610-UNPROTECT-FIELDS THRU 0610-EXIT
  5816           MOVE -1             TO BEFFDTL
  5817           GO TO 8200-SEND-DATAONLY
  5818        ELSE
  5819           PERFORM 0710-UNPROTECT-FIELDS THRU 0710-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 106
* VP6301.cbl
  5820           ADD +1    PI-LAST-SEQ-NO-ADDED
  5821                  GIVING PI-NEXT-DISPLAY-SEQ-NO
  5822          MOVE -1             TO CCERT-LEN  (1)
  5823          GO TO 8200-SEND-DATAONLY.
  5824     IF EIBAID = DFHPF6
  5825         IF PI-LAST-FUNC-DISPLAY
  5826             GO TO 6000-DELETE-PEND-BUS-RECORD
  5827         ELSE
  5828             MOVE ER-2594        TO EMI-ERROR
  5829             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5830             IF PI-MAP-NAME = VP630B
  5831                 MOVE -1         TO BPFENTRL
  5832                 GO TO 8200-SEND-DATAONLY
  5833             ELSE
  5834                 MOVE -1         TO CPFENTRL
  5835                 GO TO 8200-SEND-DATAONLY.
  5836     MOVE ER-0008 TO EMI-ERROR.
  5837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5838     IF PI-MAP-NAME = VP630B
  5839         MOVE -1                 TO BPFENTRL
  5840     ELSE
  5841         MOVE -1                 TO CPFENTRL.
  5842     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 107
* VP6301.cbl
  5844 0600-PROTECT-FIELDS.
  5845     IF PI-COMPANY-ID = 'MON'
  5846         MOVE AL-UANOF         TO BSFX-ATTRB
  5847     ELSE
  5848     IF PI-COMPANY-ID = 'PEM' OR
  5849                        'CGL' OR
  5850                        'TIH' OR
  5851                        'TII' OR
  5852                        'FGL' OR
  5853                        'OFL'
  5854        NEXT SENTENCE
  5855     ELSE
  5856        IF NOT PI-ISS-SUFFIX-KEYED
  5857           MOVE AL-SANOF         TO BSFX-ATTRB.
  5858     IF PI-PROCESSOR-ID = 'LGXX'
  5859        IF NOT PI-ISS-SUFFIX-KEYED
  5860           MOVE AL-SANOF         TO BSFX-ATTRB.
  5861     IF PI-COMPANY-ID = 'DCC' or 'VPP' or 'CID'
  5862        CONTINUE
  5863     ELSE
  5864        IF NOT PI-VIN-KEYED
  5865           MOVE AL-SANOF         TO BVIN-ATTRB
  5866        END-IF
  5867     END-IF
  5868     IF PI-COMPANY-ID = 'CID' OR 'DCC' or 'AHL' or 'VPP'
  5869        CONTINUE
  5870     ELSE
  5871        IF NOT PI-LN-OFFICER-KEYED
  5872           MOVE AL-SANOF         TO BLN-OFFICER-ATTRB
  5873        END-IF
  5874     END-IF
  5875     IF PI-COMPANY-ID = 'CRI' OR 'LGX'
  5876         IF PI-BIRTHDT-KEYED  AND  NOT PI-AGE-KEYED
  5877             MOVE AL-SANOF       TO BAGE-ATTRB.
  5878     IF PI-COMPANY-ID = 'PEM' OR 'CGL' OR 'TIH' OR 'TII' OR
  5879        'FGL' OR 'OFL'
  5880        CONTINUE
  5881     ELSE
  5882        IF NOT PI-JNT-AGE-KEYED
  5883           MOVE AL-SANOF         TO BJNT-AGE-ATTRB
  5884        END-IF
  5885     END-IF
  5886     IF PI-COMPANY-ID = 'PEM' OR
  5887                        'CGL' OR
  5888                        'TIH' OR
  5889                        'TII' OR
  5890                        'FGL' OR
  5891                        'OFL'
  5892        NEXT SENTENCE
  5893     ELSE
  5894        IF NOT PI-JNT-NAME-KEYED
  5895           MOVE AL-SANOF           TO BJNT-INIT-ATTRB
  5896                                      BJNT-LST-NAME-ATTRB
  5897                                      BJNT-1ST-NAME-ATTRB.
  5898     IF PI-COMPANY-ID = 'TMS' OR 'CID' OR 'DCC' or 'AHL' or 'VPP'
  5899        NEXT SENTENCE
  5900     ELSE
  5901        IF NOT PI-BENEFICIARY-KEYED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 108
* VP6301.cbl
  5902            MOVE AL-SANOF           TO BBENEFICIARY-ATTRB.
  5903     IF NOT PI-ALT-BEN-KEYED
  5904         MOVE AL-SANOF           TO BALT-BEN1-ATTRB
  5905     END-IF
  5906     IF NOT PI-ALT-PREM-KEYED
  5907         MOVE AL-SANOF           TO BALT-PREM1-ATTRB
  5908     END-IF
  5909     IF NOT PI-ALT-BEN-KEYED
  5910         MOVE AL-SANOF           TO BALT-BEN2-ATTRB
  5911     END-IF
  5912     IF NOT PI-ALT-PREM-KEYED
  5913         MOVE AL-SANOF           TO BALT-PREM2-ATTRB
  5914     END-IF
  5915     IF PI-PROCESSOR-ID = 'LGXX'
  5916        CONTINUE
  5917     ELSE
  5918        IF PI-COMPANY-ID = 'PEM' OR
  5919                           'CGL' OR
  5920                           'TIH' OR
  5921                           'TII' OR
  5922                           'FGL' OR
  5923                           'OFL'
  5924           MOVE AL-SANOF            TO BADDRS2-ATTRB
  5925*                                      BPHONE-ATTRB
  5926        ELSE
  5927           IF PI-COMPANY-ID ='CID' or 'AHL'
  5928              MOVE AL-SANOF         TO BADDRS2-ATTRB
  5929           END-IF
  5930        END-IF
  5931     END-IF
  5932     IF PI-COMPANY-ID = 'TMS'
  5933*        MOVE AL-UANOF              TO BSIG-ATTRB
  5934         MOVE AL-UANOF              TO BJNT-AGE-ATTRB
  5935                                       BJNT-LST-NAME-ATTRB
  5936                                       BJNT-1ST-NAME-ATTRB
  5937                                       BJNT-INIT-ATTRB.
  5938 0600-EXIT.
  5939     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 109
* VP6301.cbl
  5941 0610-UNPROTECT-FIELDS.
  5942     IF PI-COMPANY-ID = 'PEM' OR
  5943                        'CGL' OR
  5944                        'TIH' OR
  5945                        'TII' OR
  5946                        'FGL' OR
  5947                        'OFL'
  5948        NEXT SENTENCE
  5949     ELSE
  5950        IF NOT PI-ISS-SUFFIX-KEYED
  5951           MOVE AL-UANOF         TO BSFX-ATTRB.
  5952     IF PI-PROCESSOR-ID = 'LGXX'
  5953        IF NOT PI-ISS-SUFFIX-KEYED
  5954           MOVE AL-UANOF         TO BSFX-ATTRB.
  5955     IF PI-COMPANY-ID = 'CID' OR 'DCC' or 'AHL' or 'VPP'
  5956        CONTINUE
  5957     ELSE
  5958        IF NOT PI-LN-OFFICER-KEYED
  5959           MOVE AL-UANOF         TO BLN-OFFICER-ATTRB
  5960        END-IF
  5961     END-IF
  5962     IF PI-COMPANY-ID = 'FLA'
  5963        IF BAGE-LEN NOT GREATER THAN +0
  5964           MOVE AL-UANOF       TO BAGE-ATTRB.
  5965     IF PI-COMPANY-ID = 'CRI' OR
  5966                        'LGX'
  5967        IF NOT PI-AGE-KEYED
  5968           IF BAGE-LEN NOT GREATER THAN +0
  5969              MOVE AL-UANOF     TO BAGE-ATTRB.
  5970     IF PI-COMPANY-ID = 'PEM' OR
  5971                        'CGL' OR
  5972                        'TIH' OR
  5973                        'TII' OR
  5974                        'FGL' OR
  5975                        'OFL'
  5976        NEXT SENTENCE
  5977     ELSE
  5978        IF NOT PI-JNT-AGE-KEYED
  5979           MOVE AL-UANOF           TO BJNT-AGE-ATTRB.
  5980     IF PI-COMPANY-ID = 'PEM' OR
  5981                        'CGL' OR
  5982                        'TIH' OR
  5983                        'TII' OR
  5984                        'FGL' OR
  5985                        'OFL'
  5986        NEXT SENTENCE
  5987     ELSE
  5988        IF NOT PI-JNT-NAME-KEYED
  5989           MOVE AL-UANOF           TO BJNT-INIT-ATTRB
  5990                                      BJNT-LST-NAME-ATTRB
  5991                                      BJNT-1ST-NAME-ATTRB.
  5992     IF PI-COMPANY-ID = 'TMS' OR 'CID' OR 'DCC' or 'AHL' or 'VPP'
  5993        NEXT SENTENCE
  5994     ELSE
  5995        IF NOT PI-BENEFICIARY-KEYED
  5996            MOVE AL-UANOF           TO BBENEFICIARY-ATTRB.
  5997     IF NOT PI-ALT-BEN-KEYED
  5998         MOVE AL-UANOF           TO BALT-BEN1-ATTRB
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 110
* VP6301.cbl
  5999     END-IF
  6000     IF NOT PI-ALT-PREM-KEYED
  6001         MOVE AL-UANOF           TO BALT-PREM1-ATTRB
  6002     END-IF
  6003     if pi-company-id = 'DCC' or 'VPP'
  6004        IF NOT PI-ALT-BEN-KEYED
  6005           MOVE AL-UANOF         TO BALT-BEN2-ATTRB
  6006        END-IF
  6007        IF NOT PI-ALT-PREM-KEYED
  6008           MOVE AL-UANOF         TO BALT-PREM2-ATTRB
  6009        END-IF
  6010     end-if
  6011     IF PI-PROCESSOR-ID = 'LGXX'
  6012        CONTINUE
  6013     ELSE
  6014        IF PI-COMPANY-ID = 'PEM' OR
  6015                           'CGL' OR
  6016                           'TIH' OR
  6017                           'TII' OR
  6018                           'FGL' OR
  6019                           'OFL'
  6020           MOVE AL-UANOF            TO BADDRS2-ATTRB
  6021*                                      BPHONE-ATTRB
  6022        ELSE
  6023           IF (PI-COMPANY-ID = 'CID' or 'AHL') AND
  6024              (PI-MAIL-YES)
  6025              MOVE AL-UANOF         TO BADDRS2-ATTRB
  6026           END-IF
  6027        END-IF
  6028     END-IF
  6029     .
  6030 0610-EXIT.
  6031     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 111
* VP6301.cbl
  6033 0700-PROTECT-FIELDS.
  6034     IF PI-COMPANY-ID = 'PEM' OR
  6035                        'CGL' OR
  6036                        'TIH' OR
  6037                        'TII' OR
  6038                        'FGL' OR
  6039                        'OFL'
  6040        NEXT SENTENCE
  6041     ELSE
  6042        IF NOT PI-CAN-SUFFIX-KEYED
  6043           MOVE AL-SANOF         TO CSFX-ATTRB (1)
  6044                                    CSFX-ATTRB (2)
  6045                                    CSFX-ATTRB (3)
  6046                                    CSFX-ATTRB (4).
  6047     IF PI-PROCESSOR-ID = 'LGXX'
  6048        IF NOT PI-CAN-SUFFIX-KEYED
  6049           MOVE AL-SANOF         TO CSFX-ATTRB (1)
  6050                                    CSFX-ATTRB (2)
  6051                                    CSFX-ATTRB (3)
  6052                                    CSFX-ATTRB (4).
  6053     IF PI-COMPANY-ID = 'CSO' OR 'CID' or 'AHL'
  6054        MOVE AL-SANOF            TO CLAST-NAME-ATTRB (1)
  6055                                    CLAST-NAME-ATTRB (2)
  6056                                    CLAST-NAME-ATTRB (3)
  6057                                    CLAST-NAME-ATTRB (4).
  6058     IF NOT PI-CAN-LIVES-KEYED
  6059        MOVE AL-SANOF            TO CLIVES-ATTRB (1)
  6060                                    CLIVES-ATTRB (2)
  6061                                    CLIVES-ATTRB (3)
  6062                                    CLIVES-ATTRB (4).
  6063     IF NOT PI-CAN-REA-KEYED
  6064        MOVE AL-SANOF            TO CCANREA-ATTRB (1)
  6065                                    CCANREA-ATTRB (2)
  6066                                    CCANREA-ATTRB (3)
  6067                                    CCANREA-ATTRB (4)
  6068     END-IF
  6069*    IF PI-COMPANY-ID = 'HER'
  6070*        NEXT SENTENCE
  6071*    ELSE
  6072*        IF NOT PI-MICRO-NO-KEYED
  6073*            MOVE AL-SANOF       TO CMICRO-NO-ATTRB (1)
  6074*                                   CMICRO-NO-ATTRB (2)
  6075*                                   CMICRO-NO-ATTRB (3)
  6076*                                   CMICRO-NO-ATTRB (4).
  6077     IF NOT PI-PAYEE-KEYED
  6078         MOVE AL-SANOF           TO CPAYEE-ATTRB (1)
  6079                                    CPAYEE-ATTRB (2)
  6080                                    CPAYEE-ATTRB (3)
  6081                                    CPAYEE-ATTRB (4).
  6082     IF NOT PI-CHK-REQ-KEYED
  6083         MOVE AL-SANOF           TO CCHK-ATTRB   (1)
  6084                                    CCHK-ATTRB   (2)
  6085                                    CCHK-ATTRB   (3)
  6086                                    CCHK-ATTRB   (4).
  6087     IF NOT PI-REFUND-MTHD-KEYED
  6088         MOVE AL-SANOF           TO CMTHD1-ATTRB (1)
  6089                                    CMTHD2-ATTRB (1)
  6090                                    CMTHD1-ATTRB (2)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 112
* VP6301.cbl
  6091                                    CMTHD2-ATTRB (2)
  6092                                    CMTHD1-ATTRB (3)
  6093                                    CMTHD2-ATTRB (3)
  6094                                    CMTHD1-ATTRB (4)
  6095                                    CMTHD2-ATTRB (4).
  6096 0700-EXIT.
  6097     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 113
* VP6301.cbl
  6099 0710-UNPROTECT-FIELDS.
  6100     IF PI-COMPANY-ID = 'PEM' OR
  6101                        'CGL' OR
  6102                        'TIH' OR
  6103                        'TII' OR
  6104                        'FGL' OR
  6105                        'OFL'
  6106        NEXT SENTENCE
  6107     ELSE
  6108        IF NOT PI-CAN-SUFFIX-KEYED
  6109         MOVE AL-UANOF           TO CSFX-ATTRB (1)
  6110                                    CSFX-ATTRB (2)
  6111                                    CSFX-ATTRB (3)
  6112                                    CSFX-ATTRB (4).
  6113     IF PI-PROCESSOR-ID = 'LGXX'
  6114        IF NOT PI-CAN-SUFFIX-KEYED
  6115           MOVE AL-UANOF         TO CSFX-ATTRB (1)
  6116                                    CSFX-ATTRB (2)
  6117                                    CSFX-ATTRB (3)
  6118                                    CSFX-ATTRB (4).
  6119     IF PI-COMPANY-ID = 'CSO' OR 'CID' or 'AHL'
  6120        MOVE AL-UANOF            TO CLAST-NAME-ATTRB (1)
  6121                                    CLAST-NAME-ATTRB (2)
  6122                                    CLAST-NAME-ATTRB (3)
  6123                                    CLAST-NAME-ATTRB (4).
  6124     IF NOT PI-CAN-LIVES-KEYED
  6125         MOVE AL-UANOF           TO CLIVES-ATTRB (1)
  6126                                    CLIVES-ATTRB (2)
  6127                                    CLIVES-ATTRB (3)
  6128                                    CLIVES-ATTRB (4).
  6129     IF NOT PI-CAN-REA-KEYED
  6130        MOVE AL-UANOF            TO CCANREA-ATTRB (1)
  6131                                    CCANREA-ATTRB (2)
  6132                                    CCANREA-ATTRB (3)
  6133                                    CCANREA-ATTRB (4)
  6134     END-IF
  6135*    IF PI-COMPANY-ID = 'HER'
  6136*        NEXT SENTENCE
  6137*    ELSE
  6138*        IF NOT PI-MICRO-NO-KEYED
  6139*            MOVE AL-UNNOF       TO CMICRO-NO-ATTRB (1)
  6140*                                   CMICRO-NO-ATTRB (2)
  6141*                                   CMICRO-NO-ATTRB (3)
  6142*                                   CMICRO-NO-ATTRB (4).
  6143     IF NOT PI-PAYEE-KEYED
  6144         MOVE AL-UANOF           TO CPAYEE-ATTRB (1)
  6145                                    CPAYEE-ATTRB (2)
  6146                                    CPAYEE-ATTRB (3)
  6147                                    CPAYEE-ATTRB (4).
  6148     IF NOT PI-CHK-REQ-KEYED
  6149         MOVE AL-UANOF           TO CCHK-ATTRB   (1)
  6150                                    CCHK-ATTRB   (2)
  6151                                    CCHK-ATTRB   (3)
  6152                                    CCHK-ATTRB   (4).
  6153     IF NOT PI-REFUND-MTHD-KEYED
  6154         MOVE AL-UANOF           TO CMTHD1-ATTRB (1)
  6155                                    CMTHD2-ATTRB (1)
  6156                                    CMTHD1-ATTRB (2)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 114
* VP6301.cbl
  6157                                    CMTHD2-ATTRB (2)
  6158                                    CMTHD1-ATTRB (3)
  6159                                    CMTHD2-ATTRB (3)
  6160                                    CMTHD1-ATTRB (4)
  6161                                    CMTHD2-ATTRB (4).
  6162 0710-EXIT.
  6163     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 115
* VP6301.cbl
  6165 1000-EDIT-MAPB.
  6166     IF PI-MAP-NAME NOT = VP630B
  6167         GO TO 1100-EDIT-MAPC.
  6168     IF PI-LAST-FUNC-DISPLAY
  6169       AND BSFX-LEN           = ZEROS
  6170       AND B1ST-NAME-LEN      = ZEROS
  6171       AND BLAST-NAME-LEN     = ZEROS
  6172       AND BINIT-LEN          = ZEROS
  6173       AND BJNT-1ST-NAME-LEN  = ZEROS
  6174       AND BJNT-INIT-LEN      = ZEROS
  6175       AND BJNT-LST-NAME-LEN  = ZEROS
  6176       AND BSEX-LEN           = ZEROS
  6177       AND BAGE-LEN           = ZEROS
  6178       AND BTERM1-LEN         = ZEROS
  6179       AND BTERM2-LEN         = ZEROS
  6180       AND BTYPE1-LEN         = ZEROS
  6181       AND BTYPE2-LEN         = ZEROS
  6182       AND BBENE1-LEN         = ZEROS
  6183       AND BBENE2-LEN         = ZEROS
  6184       AND BALT-BEN1-LEN      = ZEROS
  6185       AND BPREM1-LEN         = ZEROS
  6186       AND BPREM2-LEN         = ZEROS
  6187       AND BALT-PREM1-LEN     = ZEROS
  6188       AND BVIN-LEN           = ZEROS
  6189       AND BJNT-AGE-LEN       = ZEROS
  6190       AND BBENEFICIARY-LEN   = ZEROS
  6191       AND BCADDR1-LEN        = ZEROS
  6192       AND BCADDR2-LEN        = ZEROS
  6193       AND BCCITY-LEN         = ZEROS
  6194       AND BCSTATE-LEN        = ZEROS
  6195       AND BCZIPCD-LEN        = ZEROS
  6196       AND BLN-OFFICER-LEN    = ZEROS
  6197       AND BADDRS1-LEN        = ZEROS
  6198       AND BADDRS2-LEN        = ZEROS
  6199       AND BCITY-LEN          = ZEROS
  6200       AND BSTATE-LEN         = ZEROS
  6201       AND BZIPCDE-LEN        = ZEROS
  6202       AND BAGE-LEN           = ZEROS
  6203       and byear-len          = zeros
  6204       and bmake-len          = zeros
  6205       and bmodel-len         = zeros
  6206       and bometer-len        = zeros
  6207         MOVE SPACE              TO PI-DISPLAY-SW
  6208         GO TO 1030-NOTHING-TO-EDIT.
  6209 1010-EDIT-MAPB.
  6210     IF BCERT-LEN             = ZEROS
  6211       AND BLAST-NAME-LEN     = ZEROS
  6212       AND BEFFDT-LEN         = ZEROS
  6213       AND NOT PI-LAST-FUNC-DISPLAY
  6214         GO TO 1030-NOTHING-TO-EDIT.
  6215     MOVE AL-SABON               TO BSEQ-ATTRB.
  6216     IF BCERT-LEN  GREATER ZEROS
  6217       AND PI-LAST-FUNC-DISPLAY
  6218         NEXT SENTENCE
  6219     ELSE
  6220         IF BCERT-LEN  GREATER ZEROS
  6221             MOVE AL-UANON       TO BCERT-ATTRB
  6222         ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 116
* VP6301.cbl
  6223             MOVE -1             TO BEFFDT-LEN
  6224             MOVE ER-2218        TO EMI-ERROR
  6225             MOVE AL-UABON       TO BCERT-ATTRB
  6226             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6227     IF BSFX-LEN  NOT = ZEROS
  6228         MOVE 'Y'                TO PI-ISS-SUFFIX-KEYED-SW
  6229         MOVE AL-UANON           TO BSFX-ATTRB.
  6230     IF BEFFDT-LEN  = ZEROS
  6231       AND PI-LAST-FUNC-DISPLAY
  6232         NEXT SENTENCE
  6233     ELSE
  6234         IF BEFFDT-LEN   GREATER ZEROS
  6235             MOVE AL-UNNON           TO BEFFDT-ATTRB
  6236             IF BEFFDT   NUMERIC
  6237                 MOVE 4              TO DC-OPTION-CODE
  6238                 MOVE BEFFDT    TO DC-GREG-DATE-1-MDY
  6239                 PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  6240                 MOVE DC-BIN-DATE-1  TO WS-CONVERTED-EFFDT
  6241                 IF NO-CONVERSION-ERROR
  6242                     IF WS-CONVERTED-EFFDT NOT LESS
  6243                       PI-ACCT-LOW-EFF-DT  AND LESS
  6244                       PI-ACCT-HIGH-EXP-DT
  6245                         PERFORM 1500-EDIT-ACCT-DT-RANGES THRU
  6246                                 1590-EXIT
  6247                     ELSE
  6248                         MOVE 'Y' TO PI-FIN-RESP-ERROR-SW
  6249*                        MOVE -1       TO BEFFDT-LEN
  6250*                        MOVE ER-2589  TO EMI-ERROR
  6251*                        MOVE AL-UNBON TO BEFFDT-ATTRB
  6252*                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6253                 ELSE
  6254                     MOVE -1         TO BEFFDT-LEN
  6255                     MOVE ER-2226    TO EMI-ERROR
  6256                     MOVE AL-UNBON   TO BEFFDT-ATTRB
  6257                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6258             ELSE
  6259                 MOVE -1             TO BEFFDT-LEN
  6260                 MOVE ER-2223        TO EMI-ERROR
  6261                 MOVE AL-UNBON       TO BEFFDT-ATTRB
  6262                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6263         ELSE
  6264             MOVE -1                 TO BEFFDT-LEN
  6265             MOVE ER-2220            TO EMI-ERROR
  6266             MOVE AL-UNBON           TO BEFFDT-ATTRB
  6267             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6268*    IF PI-COMPANY-ID = ('PEM' OR 'CRI')
  6269*      AND NOT PI-LAST-FUNC-DISPLAY
  6270*       IF BCERT      = BCERTV   AND
  6271*          BSFX       = BSFXV    AND
  6272*          BEFFDT     = BEFFDTV  AND
  6273*          BLAST-NAME = BLAST-NAMEV
  6274*          NEXT SENTENCE
  6275*       ELSE
  6276*          MOVE -1               TO BCERT-LEN
  6277*          MOVE -1               TO BLAST-NAME-LEN
  6278*          MOVE ER-3166          TO EMI-ERROR
  6279*          MOVE AL-UNBON         TO BCERT-ATTRB
  6280*                                   BCERTV-ATTRB
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 117
* VP6301.cbl
  6281*                                   BSFX-ATTRB
  6282*                                   BSFXV-ATTRB
  6283*                                   BEFFDT-ATTRB
  6284*                                   BEFFDTV-ATTRB
  6285*                                   BLAST-NAME-ATTRB
  6286*                                   BLAST-NAMEV-ATTRB
  6287*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6288     IF BLAST-NAME-LEN   GREATER ZEROS
  6289         MOVE AL-UANON           TO BLAST-NAME-ATTRB.
  6290     IF B1ST-NAME-LEN    GREATER ZEROS
  6291         MOVE AL-UANON           TO B1ST-NAME-ATTRB.
  6292     IF BINIT-LEN        GREATER ZEROS
  6293         MOVE AL-UANON           TO BINIT-ATTRB.
  6294     IF BSEX-LEN         GREATER ZEROS
  6295         IF BSEX   = 'M' OR 'F'
  6296             MOVE AL-UANON       TO BSEX-ATTRB
  6297         ELSE
  6298             MOVE -1             TO BSEX-LEN
  6299             MOVE ER-2629        TO EMI-ERROR
  6300             MOVE AL-UABON       TO BSEX-ATTRB
  6301             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6302     IF BAGE-LEN > 0
  6303        MOVE 'Y'                 TO PI-AGE-KEYED-SW
  6304        IF BAGE NUMERIC
  6305           MOVE BAGE             TO WS-BAGE
  6306           MOVE AL-UNNON         TO BAGE-ATTRB
  6307        ELSE
  6308           MOVE -1             TO BAGE-LEN
  6309           MOVE ER-2223        TO EMI-ERROR
  6310           MOVE AL-UNBON       TO BAGE-ATTRB
  6311           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6312     MOVE +0                     TO WS-SUB1
  6313     .
  6314 1020-EDIT-COVERAGES.
  6315     IF NOT MODIFY-CAP
  6316          MOVE 'UPDATE'       TO SM-READ
  6317          PERFORM 9995-SECURITY-VIOLATION
  6318          MOVE ER-0070        TO EMI-ERROR
  6319          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6320          GO TO 8100-SEND-INITIAL-MAP.
  6321     ADD +1                      TO WS-SUB1.
  6322     IF BTYPE1-LEN       > ZEROS OR
  6323        BTERM1-LEN       > ZEROS OR
  6324        BBENE1-LEN       > ZEROS OR
  6325        BPREM1-LEN       > ZEROS OR
  6326        BALT-PREM1-LEN   > ZEROS OR
  6327        BALT-BEN1-LEN    > ZEROS
  6328        MOVE 'Y'                 TO WS-DATA-KEYED-SW
  6329     ELSE
  6330        GO TO 1020-EDIT-BENEFIT-2
  6331     END-IF
  6332     MOVE +1                     TO WS-SUB1
  6333     IF NOT PI-LAST-FUNC-DISPLAY
  6334        IF BTYPE1-LEN  > ZEROS
  6335           MOVE AL-UANON         TO BTYPE1-ATTRB
  6336           PERFORM 1040-EDIT-INPUT-CODE
  6337                                 THRU 1059-EXIT
  6338        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 118
* VP6301.cbl
  6339     ELSE
  6340        IF BTYPE1-LEN > ZEROS
  6341           IF BTYPE1 = SPACES OR ZEROS
  6342              MOVE AL-UANON      TO BTYPE1-ATTRB
  6343           ELSE
  6344              MOVE AL-UANON      TO BTYPE1-ATTRB
  6345              PERFORM 1040-EDIT-INPUT-CODE
  6346                                 THRU 1059-EXIT
  6347           END-IF
  6348        END-IF
  6349     END-IF
  6350     IF PI-LAST-FUNC-DISPLAY
  6351        IF BTERM1-LEN  = ZEROS
  6352           CONTINUE
  6353        ELSE
  6354           MOVE BTERM1I          TO DEEDIT-FIELD
  6355           PERFORM 8600-DEEDIT
  6356           IF DEEDIT-FIELD-V0 NUMERIC
  6357              MOVE DEEDIT-FIELD-V0
  6358                                 TO WS-BTERM1
  6359              IF WS-BTERM1 > ZERO
  6360                 MOVE AL-UNNON   TO BTERM1-ATTRB
  6361              ELSE
  6362                 MOVE ER-2241    TO EMI-ERROR
  6363                 MOVE -1         TO BTERM1-LEN
  6364                 MOVE AL-UNBOF   TO BTERM1-ATTRB
  6365                 PERFORM 9900-ERROR-FORMAT
  6366                                 THRU 9900-EXIT
  6367              END-IF
  6368           ELSE
  6369              MOVE ER-2223       TO EMI-ERROR
  6370              MOVE -1            TO BTERM1-LEN
  6371              MOVE AL-UNBON      TO BTERM1-ATTRB
  6372              PERFORM 9900-ERROR-FORMAT
  6373                                 THRU 9900-EXIT
  6374           END-IF
  6375        END-IF
  6376     ELSE
  6377        IF BTERM1-LEN > ZEROS
  6378           MOVE BTERM1I          TO DEEDIT-FIELD
  6379           PERFORM 8600-DEEDIT
  6380           IF DEEDIT-FIELD-V0      NUMERIC
  6381              IF DEEDIT-FIELD-V0 > ZERO
  6382                 MOVE DEEDIT-FIELD-V0 TO WS-BTERM1
  6383                 MOVE AL-UNNON        TO BTERM1-ATTRB
  6384              ELSE
  6385                 MOVE ER-2241         TO EMI-ERROR
  6386                 MOVE -1              TO BTERM1-LEN
  6387                 MOVE AL-UNBOF        TO BTERM1-ATTRB
  6388                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6389              END-IF
  6390           ELSE
  6391              MOVE ER-2223             TO EMI-ERROR
  6392              MOVE -1                  TO BTERM1-LEN
  6393              MOVE AL-UNBON            TO BTERM1-ATTRB
  6394              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6395           END-IF
  6396        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 119
* VP6301.cbl
  6397           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  6398              MOVE ER-2240             TO EMI-ERROR
  6399              MOVE -1                  TO BTERM1-LEN
  6400              MOVE AL-UNBOF            TO BTERM1-ATTRB
  6401              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6402           END-IF
  6403        END-IF
  6404     END-IF
  6405     IF BBENE1-LEN = ZEROS
  6406        AND PI-LAST-FUNC-DISPLAY
  6407        CONTINUE
  6408     ELSE
  6409        IF BBENE1-LEN > ZEROS
  6410           MOVE AL-UNNON           TO BBENE1-ATTRB
  6411
  6412* EXEC CICS BIF DEEDIT
  6413*              FIELD  (BBENE1I)
  6414*              LENGTH (12)
  6415*          END-EXEC
  6416     MOVE 12
  6417       TO DFHEIV11
  6418*    MOVE '@"L                   #   #00006382' TO DFHEIV0
  6419     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6420     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6421     MOVE X'2020233030303036333832' TO DFHEIV0(25:11)
  6422     CALL 'kxdfhei1' USING DFHEIV0,
  6423           BBENE1I,
  6424           DFHEIV11
  6425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6426           IF BBENE1I NUMERIC
  6427              IF BBENE1I > ZEROS
  6428                 MOVE BBENE1I TO WS-BBEN1
  6429*          MOVE BBENE1I           TO DEEDIT-FIELD
  6430*          PERFORM 8600-DEEDIT
  6431*          IF DEEDIT-FIELD-V2  NUMERIC
  6432*             IF DEEDIT-FIELD-V2 > ZEROS
  6433*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN1
  6434              ELSE
  6435                 MOVE ER-7632    TO EMI-ERROR
  6436                 MOVE -1         TO BBENE1-LEN
  6437                 MOVE AL-UNBOF   TO BBENE1-ATTRB
  6438                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6439              END-IF
  6440           ELSE
  6441              MOVE ER-2223         TO EMI-ERROR
  6442              MOVE AL-UNBON        TO BBENE1-ATTRB
  6443              MOVE -1              TO BBENE1-LEN
  6444           END-IF
  6445        ELSE
  6446           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  6447             MOVE ER-7632    TO EMI-ERROR
  6448             MOVE -1         TO BBENE1-LEN
  6449             MOVE AL-UNBOF   TO BBENE1-ATTRB
  6450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6451           END-IF
  6452        END-IF
  6453     END-IF
  6454     IF BPREM1-LEN = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 120
* VP6301.cbl
  6455        AND PI-LAST-FUNC-DISPLAY
  6456        CONTINUE
  6457     ELSE
  6458        IF BPREM1-LEN > ZEROS
  6459           MOVE AL-UNNON           TO BPREM1-ATTRB
  6460*          MOVE BPREM1I            TO DEEDIT-FIELD
  6461*          PERFORM 8600-DEEDIT
  6462*          IF DEEDIT-FIELD-V2  NUMERIC
  6463*             IF DEEDIT-FIELD-V2 GREATER ZEROS
  6464*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM1
  6465
  6466* EXEC CICS BIF DEEDIT
  6467*              FIELD  (BPREM1I)
  6468*              LENGTH (11)
  6469*          END-EXEC
  6470     MOVE 11
  6471       TO DFHEIV11
  6472*    MOVE '@"L                   #   #00006425' TO DFHEIV0
  6473     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6474     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6475     MOVE X'2020233030303036343235' TO DFHEIV0(25:11)
  6476     CALL 'kxdfhei1' USING DFHEIV0,
  6477           BPREM1I,
  6478           DFHEIV11
  6479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6480           IF BPREM1I NUMERIC
  6481              IF BPREM1I > ZEROS
  6482                 MOVE BPREM1I TO WS-BPREM1
  6483              ELSE
  6484                 MOVE ER-7633    TO EMI-ERROR
  6485                 MOVE -1         TO BPREM1-LEN
  6486                 MOVE AL-UNBOF   TO BPREM1-ATTRB
  6487                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6488              END-IF
  6489           ELSE
  6490              MOVE AL-UNBON   TO BPREM1-ATTRB
  6491              MOVE ER-2223         TO EMI-ERROR
  6492              MOVE -1              TO BPREM1-LEN
  6493           END-IF
  6494        ELSE
  6495           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  6496              MOVE ER-7633    TO EMI-ERROR
  6497              MOVE -1         TO BPREM1-LEN
  6498              MOVE AL-UNBOF   TO BPREM1-ATTRB
  6499              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6500           END-IF
  6501        END-IF
  6502     END-IF
  6503     IF BALT-BEN1-LEN = ZEROS
  6504        AND PI-LAST-FUNC-DISPLAY
  6505        CONTINUE
  6506     ELSE
  6507        IF BALT-BEN1-LEN > ZEROS
  6508           MOVE 'Y'              TO PI-ALT-BEN-KEYED-SW
  6509           MOVE AL-UNNON         TO BALT-BEN1-ATTRB
  6510*          MOVE BALT-BEN1I       TO DEEDIT-FIELD
  6511*          PERFORM 8600-DEEDIT
  6512*          IF DEEDIT-FIELD-V2  NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 121
* VP6301.cbl
  6513*             MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN1
  6514
  6515* EXEC CICS BIF DEEDIT
  6516*              FIELD  (BALT-BEN1I)
  6517*              LENGTH (12)
  6518*          END-EXEC
  6519     MOVE 12
  6520       TO DFHEIV11
  6521*    MOVE '@"L                   #   #00006463' TO DFHEIV0
  6522     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6523     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6524     MOVE X'2020233030303036343633' TO DFHEIV0(25:11)
  6525     CALL 'kxdfhei1' USING DFHEIV0,
  6526           BALT-BEN1I,
  6527           DFHEIV11
  6528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6529           IF BALT-BEN1I NUMERIC
  6530              MOVE BALT-BEN1I TO WS-BALT-BEN1
  6531           ELSE
  6532              MOVE ER-2223       TO EMI-ERROR
  6533              MOVE AL-UNBON      TO BALT-BEN1-ATTRB
  6534              MOVE -1            TO BALT-BEN1-LEN
  6535           END-IF
  6536        END-IF
  6537     END-IF
  6538     IF BALT-PREM1-LEN = ZEROS
  6539        AND PI-LAST-FUNC-DISPLAY
  6540        NEXT SENTENCE
  6541     ELSE
  6542        IF BALT-PREM1-LEN > ZEROS
  6543           MOVE 'Y'              TO PI-ALT-PREM-KEYED-SW
  6544           MOVE AL-UNNON         TO BALT-PREM1-ATTRB
  6545*          MOVE BALT-PREM1I      TO DEEDIT-FIELD
  6546*          PERFORM 8600-DEEDIT
  6547*          IF DEEDIT-FIELD-V2  NUMERIC
  6548*             MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM1
  6549
  6550* EXEC CICS BIF DEEDIT
  6551*              FIELD  (BALT-PREM1I)
  6552*              LENGTH (9)
  6553*          END-EXEC
  6554     MOVE 9
  6555       TO DFHEIV11
  6556*    MOVE '@"L                   #   #00006487' TO DFHEIV0
  6557     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6558     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6559     MOVE X'2020233030303036343837' TO DFHEIV0(25:11)
  6560     CALL 'kxdfhei1' USING DFHEIV0,
  6561           BALT-PREM1I,
  6562           DFHEIV11
  6563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6564           IF BALT-PREM1I NUMERIC
  6565              MOVE BALT-PREM1I TO WS-BALT-PREM1
  6566           ELSE
  6567              MOVE AL-UNBON      TO BALT-PREM1-ATTRB
  6568              MOVE ER-2223       TO EMI-ERROR
  6569              MOVE -1            TO BALT-PREM1-LEN
  6570           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 122
* VP6301.cbl
  6571        END-IF
  6572     END-IF
  6573     .
  6574 1020-EDIT-BENEFIT-2.
  6575     IF BTYPE2-LEN       > ZEROS OR
  6576        BTERM2-LEN       > ZEROS OR
  6577        BBENE2-LEN       > ZEROS OR
  6578        BPREM2-LEN       > ZEROS OR
  6579        BCRIT-PERD2-LEN  > ZEROS OR
  6580        BALT-PREM2-LEN   > ZEROS OR
  6581        BALT-BEN2-LEN    > ZEROS
  6582        MOVE 'Y'                 TO WS-DATA-KEYED-SW
  6583     ELSE
  6584        GO TO 1025-CONT-EDIT
  6585     END-IF
  6586     MOVE +2                     TO WS-SUB1
  6587     IF NOT PI-LAST-FUNC-DISPLAY
  6588        IF BTYPE2-LEN  > ZEROS
  6589           MOVE AL-UANON         TO BTYPE2-ATTRB
  6590           PERFORM 1040-EDIT-INPUT-CODE
  6591                                 THRU 1059-EXIT
  6592        END-IF
  6593     ELSE
  6594        IF BTYPE2-LEN > ZEROS
  6595           IF BTYPE2 = SPACES OR ZEROS
  6596              MOVE AL-UANON      TO BTYPE2-ATTRB
  6597           ELSE
  6598              MOVE AL-UANON      TO BTYPE2-ATTRB
  6599              PERFORM 1040-EDIT-INPUT-CODE
  6600                                 THRU 1059-EXIT
  6601           END-IF
  6602        END-IF
  6603     END-IF
  6604     IF PI-LAST-FUNC-DISPLAY
  6605        IF BTERM2-LEN  = ZEROS
  6606           CONTINUE
  6607        ELSE
  6608           MOVE BTERM2I          TO DEEDIT-FIELD
  6609           PERFORM 8600-DEEDIT
  6610           IF DEEDIT-FIELD-V0 NUMERIC
  6611              MOVE DEEDIT-FIELD-V0
  6612                                 TO WS-BTERM2
  6613              IF WS-BTERM2 > ZERO
  6614                 MOVE AL-UNNON   TO BTERM2-ATTRB
  6615              ELSE
  6616                 MOVE ER-2241    TO EMI-ERROR
  6617                 MOVE -1         TO BTERM2-LEN
  6618                 MOVE AL-UNBOF   TO BTERM2-ATTRB
  6619                 PERFORM 9900-ERROR-FORMAT
  6620                                 THRU 9900-EXIT
  6621              END-IF
  6622           ELSE
  6623              MOVE ER-2223       TO EMI-ERROR
  6624              MOVE -1            TO BTERM2-LEN
  6625              MOVE AL-UNBON      TO BTERM2-ATTRB
  6626              PERFORM 9900-ERROR-FORMAT
  6627                                 THRU 9900-EXIT
  6628           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 123
* VP6301.cbl
  6629        END-IF
  6630     ELSE
  6631        IF BTERM2-LEN > ZEROS
  6632           MOVE BTERM2I          TO DEEDIT-FIELD
  6633           PERFORM 8600-DEEDIT
  6634           IF DEEDIT-FIELD-V0      NUMERIC
  6635              IF DEEDIT-FIELD-V0 > ZERO
  6636                 MOVE DEEDIT-FIELD-V0 TO WS-BTERM2
  6637                 MOVE AL-UNNON        TO BTERM2-ATTRB
  6638              ELSE
  6639                 MOVE ER-2241         TO EMI-ERROR
  6640                 MOVE -1              TO BTERM2-LEN
  6641                 MOVE AL-UNBOF        TO BTERM2-ATTRB
  6642                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6643              END-IF
  6644           ELSE
  6645              MOVE ER-2223             TO EMI-ERROR
  6646              MOVE -1                  TO BTERM2-LEN
  6647              MOVE AL-UNBON            TO BTERM2-ATTRB
  6648              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6649           END-IF
  6650        ELSE
  6651           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  6652              MOVE ER-2240             TO EMI-ERROR
  6653              MOVE -1                  TO BTERM2-LEN
  6654              MOVE AL-UNBOF            TO BTERM2-ATTRB
  6655              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6656           END-IF
  6657        END-IF
  6658     END-IF
  6659     IF BBENE2-LEN = ZEROS
  6660        AND PI-LAST-FUNC-DISPLAY
  6661        CONTINUE
  6662     ELSE
  6663        IF BBENE2-LEN > ZEROS
  6664           MOVE AL-UNNON           TO BBENE2-ATTRB
  6665
  6666* EXEC CICS BIF DEEDIT
  6667*              FIELD  (BBENE2I)
  6668*              LENGTH (12)
  6669*          END-EXEC
  6670     MOVE 12
  6671       TO DFHEIV11
  6672*    MOVE '@"L                   #   #00006592' TO DFHEIV0
  6673     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6674     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6675     MOVE X'2020233030303036353932' TO DFHEIV0(25:11)
  6676     CALL 'kxdfhei1' USING DFHEIV0,
  6677           BBENE2I,
  6678           DFHEIV11
  6679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6680           IF BBENE2I NUMERIC
  6681              IF BBENE2I > ZEROS
  6682                 MOVE BBENE2I TO WS-BBEN2
  6683*          MOVE BBENE2I           TO DEEDIT-FIELD
  6684*          PERFORM 8600-DEEDIT
  6685*          IF DEEDIT-FIELD-V2  NUMERIC
  6686*             IF DEEDIT-FIELD-V2 > ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 124
* VP6301.cbl
  6687*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN2
  6688              ELSE
  6689                 MOVE ER-7632    TO EMI-ERROR
  6690                 MOVE -1         TO BBENE2-LEN
  6691                 MOVE AL-UNBOF   TO BBENE2-ATTRB
  6692                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6693              END-IF
  6694           ELSE
  6695              MOVE ER-2223         TO EMI-ERROR
  6696              MOVE AL-UNBON        TO BBENE2-ATTRB
  6697              MOVE -1              TO BBENE2-LEN
  6698           END-IF
  6699        ELSE
  6700           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  6701             MOVE ER-7632    TO EMI-ERROR
  6702             MOVE -1         TO BBENE2-LEN
  6703             MOVE AL-UNBOF   TO BBENE2-ATTRB
  6704             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6705           END-IF
  6706        END-IF
  6707     END-IF
  6708     IF BPREM2-LEN = ZEROS
  6709        AND PI-LAST-FUNC-DISPLAY
  6710        CONTINUE
  6711     ELSE
  6712        IF BPREM2-LEN > ZEROS
  6713           MOVE AL-UNNON           TO BPREM2-ATTRB
  6714*          MOVE BPREM2I            TO DEEDIT-FIELD
  6715*          PERFORM 8600-DEEDIT
  6716*          IF DEEDIT-FIELD-V2  NUMERIC
  6717*             IF DEEDIT-FIELD-V2 GREATER ZEROS
  6718*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM2
  6719
  6720* EXEC CICS BIF DEEDIT
  6721*              FIELD  (BPREM2I)
  6722*              LENGTH (11)
  6723*          END-EXEC
  6724     MOVE 11
  6725       TO DFHEIV11
  6726*    MOVE '@"L                   #   #00006635' TO DFHEIV0
  6727     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6728     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6729     MOVE X'2020233030303036363335' TO DFHEIV0(25:11)
  6730     CALL 'kxdfhei1' USING DFHEIV0,
  6731           BPREM2I,
  6732           DFHEIV11
  6733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6734           IF BPREM2I NUMERIC
  6735              IF BPREM2I > ZEROS
  6736                 MOVE BPREM2I TO WS-BPREM2
  6737              ELSE
  6738                 MOVE ER-7633    TO EMI-ERROR
  6739                 MOVE -1         TO BPREM2-LEN
  6740                 MOVE AL-UNBOF   TO BPREM2-ATTRB
  6741                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6742              END-IF
  6743           ELSE
  6744              MOVE AL-UNBON   TO BPREM2-ATTRB
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 125
* VP6301.cbl
  6745              MOVE ER-2223         TO EMI-ERROR
  6746              MOVE -1              TO BPREM2-LEN
  6747           END-IF
  6748        ELSE
  6749           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
  6750              MOVE ER-7633    TO EMI-ERROR
  6751              MOVE -1         TO BPREM2-LEN
  6752              MOVE AL-UNBOF   TO BPREM2-ATTRB
  6753              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6754           END-IF
  6755        END-IF
  6756     END-IF
  6757*    IF BEXPIRE-LEN (WS-SUB1)   GREATER ZEROS
  6758*       MOVE 'Y'                 TO PI-EXPIRE-KEYED-SW
  6759*        IF BEXPIRE (WS-SUB1)    NUMERIC
  6760*            MOVE AL-UNNON       TO BEXPIRE-ATTRB (WS-SUB1)
  6761*            MOVE 4              TO DC-OPTION-CODE
  6762*            MOVE BEXPIRE (WS-SUB1)   TO DC-GREG-DATE-1-MDY
  6763*            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  6764*            MOVE DC-BIN-DATE-1  TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  6765*            IF NO-CONVERSION-ERROR
  6766*                NEXT SENTENCE
  6767*            ELSE
  6768*                MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  6769*                MOVE ER-2531    TO EMI-ERROR
  6770*                MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  6771*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6772*        ELSE
  6773*            MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  6774*            MOVE ER-2532        TO EMI-ERROR
  6775*            MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  6776*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6777     IF BCRIT-PERD2-LEN > ZEROS
  6778        MOVE 'Y'                     TO PI-CRIT-PERD-KEYED-SW
  6779        MOVE BCRIT-PERD2I            TO DEEDIT-FIELD
  6780        PERFORM 8600-DEEDIT
  6781        IF DEEDIT-FIELD-V0 NUMERIC
  6782           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD2
  6783           MOVE AL-UNNON             TO BCRIT-PERD2-ATTRB
  6784        ELSE
  6785           MOVE -1                   TO BCRIT-PERD2-LEN
  6786           MOVE AL-UNBON             TO BCRIT-PERD2-ATTRB
  6787           MOVE ER-2223              TO EMI-ERROR
  6788           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6789        END-IF
  6790     END-IF
  6791     IF BALT-BEN2-LEN = ZEROS
  6792        AND PI-LAST-FUNC-DISPLAY
  6793        CONTINUE
  6794     ELSE
  6795        IF BALT-BEN2-LEN > ZEROS
  6796           MOVE 'Y'              TO PI-ALT-BEN-KEYED-SW
  6797           MOVE AL-UNNON         TO BALT-BEN2-ATTRB
  6798*          MOVE BALT-BEN2I       TO DEEDIT-FIELD
  6799*          PERFORM 8600-DEEDIT
  6800*          IF DEEDIT-FIELD-V2  NUMERIC
  6801*             MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN2
  6802
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 126
* VP6301.cbl
  6803* EXEC CICS BIF DEEDIT
  6804*              FIELD  (BALT-BEN2I)
  6805*              LENGTH (12)
  6806*          END-EXEC
  6807     MOVE 12
  6808       TO DFHEIV11
  6809*    MOVE '@"L                   #   #00006707' TO DFHEIV0
  6810     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6811     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6812     MOVE X'2020233030303036373037' TO DFHEIV0(25:11)
  6813     CALL 'kxdfhei1' USING DFHEIV0,
  6814           BALT-BEN2I,
  6815           DFHEIV11
  6816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6817           IF BALT-BEN2I NUMERIC
  6818              MOVE BALT-BEN2I TO WS-BALT-BEN2
  6819           ELSE
  6820              MOVE ER-2223       TO EMI-ERROR
  6821              MOVE AL-UNBON      TO BALT-BEN2-ATTRB
  6822              MOVE -1            TO BALT-BEN2-LEN
  6823           END-IF
  6824        END-IF
  6825     END-IF
  6826     IF BALT-PREM2-LEN = ZEROS
  6827        AND PI-LAST-FUNC-DISPLAY
  6828        NEXT SENTENCE
  6829     ELSE
  6830        IF BALT-PREM2-LEN > ZEROS
  6831           MOVE 'Y'              TO PI-ALT-PREM-KEYED-SW
  6832           MOVE AL-UNNON         TO BALT-PREM2-ATTRB
  6833*          MOVE BALT-PREM2I      TO DEEDIT-FIELD
  6834*          PERFORM 8600-DEEDIT
  6835*          IF DEEDIT-FIELD-V2  NUMERIC
  6836*             MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM2
  6837
  6838* EXEC CICS BIF DEEDIT
  6839*              FIELD  (BALT-PREM2I)
  6840*              LENGTH (9)
  6841*          END-EXEC
  6842     MOVE 9
  6843       TO DFHEIV11
  6844*    MOVE '@"L                   #   #00006731' TO DFHEIV0
  6845     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6846     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6847     MOVE X'2020233030303036373331' TO DFHEIV0(25:11)
  6848     CALL 'kxdfhei1' USING DFHEIV0,
  6849           BALT-PREM2I,
  6850           DFHEIV11
  6851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6852           IF BALT-PREM2I NUMERIC
  6853              MOVE BALT-PREM2I TO WS-BALT-PREM2
  6854           ELSE
  6855              MOVE AL-UNBON      TO BALT-PREM2-ATTRB
  6856              MOVE ER-2223       TO EMI-ERROR
  6857              MOVE -1            TO BALT-PREM2-LEN
  6858           END-IF
  6859        END-IF
  6860     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 127
* VP6301.cbl
  6861*    GO TO 1020-EDIT-COVERAGES.
  6862     .
  6863 1025-CONT-EDIT.
  6864*    IF BLIVES-LEN               GREATER ZEROS
  6865*       MOVE 'Y'                   TO PI-ISS-LIVES-KEYED-SW
  6866*       MOVE BLIVESI               TO DEEDIT-FIELD
  6867*       PERFORM 8600-DEEDIT
  6868*       IF DEEDIT-FIELD-V0 NUMERIC
  6869*          MOVE DEEDIT-FIELD-V0    TO WS-BLIVES
  6870*          MOVE AL-UNNON           TO BLIVES-ATTRB
  6871*       ELSE
  6872*          MOVE -1                 TO BLIVES-LEN
  6873*          MOVE AL-UNBON           TO BLIVES-ATTRB
  6874*          MOVE ER-2223            TO EMI-ERROR
  6875*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6876     IF (BSTATE-LEN > 0)
  6877        AND (BSTATE NOT = '  ' AND '00')
  6878        MOVE AL-UANON            TO BSTATE-ATTRB
  6879        MOVE SPACES              TO ELCNTL-KEY
  6880        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6881        MOVE '3'                 TO ELCNTL-REC-TYPE
  6882        MOVE BSTATE              TO ELCNTL-ACCESS
  6883        MOVE +0                  TO ELCNTL-SEQ
  6884
  6885* EXEC CICS READ
  6886*          DATASET   (FILE-ID-ELCNTL)
  6887*          SET       (ADDRESS OF CONTROL-FILE)
  6888*          RIDFLD    (ELCNTL-KEY)
  6889*          RESP      (WS-RESPONSE)
  6890*       END-EXEC
  6891*    MOVE '&"S        E          (  N#00006767' TO DFHEIV0
  6892     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6893     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6894     MOVE X'204E233030303036373637' TO DFHEIV0(25:11)
  6895     CALL 'kxdfhei1' USING DFHEIV0,
  6896           FILE-ID-ELCNTL,
  6897           DFHEIV20,
  6898           DFHEIV99,
  6899           ELCNTL-KEY,
  6900           DFHEIV99,
  6901           DFHEIV99,
  6902           DFHEIV99
  6903     SET ADDRESS OF CONTROL-FILE TO
  6904         DFHEIV20
  6905     MOVE EIBRESP  TO WS-RESPONSE
  6906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6907        IF RESP-NORMAL
  6908           CONTINUE
  6909        ELSE
  6910           MOVE ER-2963          TO EMI-ERROR
  6911*          MOVE -1               TO BSTATE-LEN
  6912           MOVE -1               TO BPFENTRL
  6913           MOVE AL-UABON         TO BSTATE-ATTRB
  6914           PERFORM 9900-ERROR-FORMAT
  6915                                 THRU 9900-EXIT
  6916           SUBTRACT +1 FROM EMI-FATAL-CTR
  6917        END-IF
  6918*    ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 128
* VP6301.cbl
  6919*       MOVE ER-2209          TO EMI-ERROR
  6920*       MOVE -1               TO BSTATE-LEN
  6921*       MOVE AL-UABON         TO BSTATE-ATTRB
  6922*       PERFORM 9900-ERROR-FORMAT
  6923*                             THRU 9900-EXIT
  6924*       SUBTRACT +1 FROM EMI-FATAL-CTR
  6925     END-IF
  6926     IF BCSTATE-LEN > 0
  6927        MOVE SPACES              TO ELCNTL-KEY
  6928        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6929        MOVE '3'                 TO ELCNTL-REC-TYPE
  6930        MOVE BCSTATE             TO ELCNTL-ACCESS
  6931        MOVE +0                  TO ELCNTL-SEQ
  6932
  6933* EXEC CICS READ
  6934*          DATASET   (FILE-ID-ELCNTL)
  6935*          SET       (ADDRESS OF CONTROL-FILE)
  6936*          RIDFLD    (ELCNTL-KEY)
  6937*          RESP      (WS-RESPONSE)
  6938*       END-EXEC
  6939*    MOVE '&"S        E          (  N#00006798' TO DFHEIV0
  6940     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6942     MOVE X'204E233030303036373938' TO DFHEIV0(25:11)
  6943     CALL 'kxdfhei1' USING DFHEIV0,
  6944           FILE-ID-ELCNTL,
  6945           DFHEIV20,
  6946           DFHEIV99,
  6947           ELCNTL-KEY,
  6948           DFHEIV99,
  6949           DFHEIV99,
  6950           DFHEIV99
  6951     SET ADDRESS OF CONTROL-FILE TO
  6952         DFHEIV20
  6953     MOVE EIBRESP  TO WS-RESPONSE
  6954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6955        IF RESP-NORMAL
  6956           CONTINUE
  6957        ELSE
  6958           MOVE ER-2964          TO EMI-ERROR
  6959*          MOVE -1               TO BCSTATE-LEN
  6960           MOVE -1               TO BPFENTRL
  6961           MOVE AL-UABON         TO BCSTATE-ATTRB
  6962           PERFORM 9900-ERROR-FORMAT
  6963                                 THRU 9900-EXIT
  6964           SUBTRACT +1 FROM EMI-FATAL-CTR
  6965        END-IF
  6966     END-IF
  6967     IF BJNT-1ST-NAME-LEN     GREATER ZEROS OR
  6968        BJNT-INIT-LEN         GREATER ZEROS OR
  6969        BJNT-LST-NAME-LEN     GREATER ZEROS
  6970         MOVE 'Y'                TO PI-JNT-NAME-KEYED-SW
  6971         MOVE AL-UANON           TO BJNT-1ST-NAME-ATTRB
  6972                                    BJNT-INIT-ATTRB
  6973                                    BJNT-LST-NAME-ATTRB.
  6974     IF BJNT-AGE-LEN GREATER ZEROS
  6975        MOVE 'Y'                 TO PI-JNT-AGE-KEYED-SW
  6976        IF BJNT-AGE NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 129
* VP6301.cbl
  6977           MOVE BJNT-AGE         TO WS-BJNT-AGE
  6978           MOVE AL-UNNON         TO BJNT-AGE-ATTRB
  6979        ELSE
  6980           MOVE -1             TO BJNT-AGE-LEN
  6981           MOVE ER-2223        TO EMI-ERROR
  6982           MOVE AL-UNBON       TO BJNT-AGE-ATTRB
  6983           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6984*    IF BMICROFILM-NO-LEN  GREATER  ZEROS
  6985*        MOVE 'Y'                TO  PI-MICRO-NO-KEYED-SW
  6986*        MOVE BMICROFILM-NOI     TO  DEEDIT-FIELD
  6987*        PERFORM 8600-DEEDIT
  6988*        IF DEEDIT-FIELD-V0  NUMERIC
  6989*            MOVE DEEDIT-FIELD-V0
  6990*                                TO  WS-I-MICRO-NO
  6991*            MOVE AL-UNNON       TO  BMICROFILM-NO-ATTRB
  6992*        ELSE
  6993*            MOVE -1             TO  BMICROFILM-NO-LEN
  6994*            MOVE AL-UNBON       TO  BMICROFILM-NO-ATTRB
  6995*            MOVE ER-2701        TO  EMI-ERROR
  6996*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6997     IF BBENEFICIARY-LEN GREATER ZEROS
  6998         MOVE 'Y'                TO PI-BENEFICIARY-KEYED-SW
  6999         MOVE AL-UANON           TO BBENEFICIARY-ATTRB.
  7000     IF BLN-OFFICER-LEN GREATER ZEROS
  7001         MOVE 'Y'                TO PI-LN-OFFICER-KEYED-SW
  7002         MOVE AL-UANON           TO BLN-OFFICER-ATTRB.
  7003     .
  7004 1027-CHECK-FUNCTION.
  7005     .
  7006 1028-CHECK-MEMNO.
  7007*    IF BMEM-NO-LEN GREATER ZEROS
  7008*        MOVE 'Y'                TO PI-MEMBER-KEYED-SW
  7009*        MOVE AL-UANON           TO BMEM-NO-ATTRB.
  7010*    IF  BPHONE-LEN GREATER ZEROS
  7011*        MOVE BPHONE             TO DEEDIT-FIELD
  7012*        PERFORM 8600-DEEDIT
  7013*        MOVE DEEDIT-FIELD-V0    TO WS-BPHONE
  7014*        MOVE AL-UANON           TO BPHONE-ATTRB.
  7015*    IF BENTRYI = 'D' OR 'V'
  7016*       GO TO 1029-CHECK-ERRORS.
  7017     IF NOT PI-LAST-FUNC-DISPLAY
  7018        AND WS-DATA-NOT-KEYED
  7019        MOVE ER-7400             TO EMI-ERROR
  7020        MOVE -1                  TO BTYPE1-LEN
  7021        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7022        MOVE 'Y'                 TO PI-ERROR-SW.
  7023 1029-CHECK-ERRORS.
  7024     IF EMI-ERROR = ZEROS
  7025         MOVE 'Y'                TO PI-UPDATE-SW
  7026         MOVE SPACE              TO PI-DISPLAY-SW
  7027         PERFORM 4000-BUILD-ISSUE-RECORD THRU 4900-EXIT
  7028     ELSE
  7029        IF (EMI-FATAL-CTR = ZEROS)
  7030           AND (EMI-FORCABLE-CTR = ZEROS)
  7031           MOVE 'Y'              TO PI-UPDATE-SW
  7032           MOVE SPACE            TO PI-DISPLAY-SW
  7033           PERFORM 4000-BUILD-ISSUE-RECORD THRU 4900-EXIT
  7034           MOVE 'Y'              TO PI-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 130
* VP6301.cbl
  7035        ELSE
  7036           MOVE ZEROS              TO EMI-ERROR
  7037           MOVE 'Y'                TO PI-ERROR-SW
  7038        END-IF
  7039     END-IF
  7040     .
  7041 1030-NOTHING-TO-EDIT.
  7042     IF PI-DATA-ERRORS
  7043         MOVE AL-SABON           TO BSEQ-ATTRB
  7044         GO TO 8200-SEND-DATAONLY.
  7045     IF PI-SAV-BATCH-SEQ LESS PI-LAST-SEQ-NO-ADDED
  7046         SUBTRACT 1 FROM PI-SAV-BATCH-SEQ
  7047         MOVE ER-0000        TO EMI-ERROR
  7048         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7049         GO TO 2000-BROWSE-FWD.
  7050     MOVE LOW-VALUES     TO VP630BI.
  7051     ADD +1                 PI-LAST-SEQ-NO-ADDED
  7052                            GIVING PI-NEXT-DISPLAY-SEQ-NO.
  7053     MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ.
  7054     PERFORM 8550-SET-MAP-SEQ-NOS.
  7055     MOVE ER-0000        TO EMI-ERROR.
  7056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7057     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 131
* VP6301.cbl
  7059 1040-EDIT-INPUT-CODE.
  7060     IF WS-SUB1 = +2
  7061        GO TO 1050-EDIT-INPUT-AH-CODE.
  7062     MOVE SPACES                 TO ELCNTL-ACCESS.
  7063     MOVE 'L'                    TO ELCNTL-REC-TYPE.
  7064     PERFORM 1070-ELCNTL-READ THRU 1079-EXIT.
  7065     IF EMI-ERROR = 9999
  7066         GO TO 1048-NO-RECORD.
  7067     MOVE +1 TO WS-EDIT-SUB.
  7068 1041-SEARCH-LOOP.
  7069     IF CF-LIFE-CODE-OUT (WS-EDIT-SUB) = ZEROS
  7070         GO TO 1047-NO-MATCH-FOUND.
  7071     IF BTYPE1  = CF-LIFE-CODE-IN (WS-EDIT-SUB)
  7072         MOVE CF-LIFE-CODE-OUT (WS-EDIT-SUB) TO WS-EDITED-LF-CODE
  7073         PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT
  7074         GO TO 1059-EXIT.
  7075     ADD 1   TO WS-EDIT-SUB.
  7076     IF WS-EDIT-SUB GREATER 120
  7077         GO TO 1047-NO-MATCH-FOUND.
  7078     GO TO 1041-SEARCH-LOOP.
  7079 1047-NO-MATCH-FOUND.
  7080*    MOVE ER-2424                TO EMI-ERROR.
  7081*    MOVE AL-UABON               TO BTYPE1-ATTRB
  7082*    MOVE -1                     TO BTYPE1-LEN
  7083*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7084*    MOVE 'Y'                    TO ERROR-SW.
  7085     MOVE BTYPE1                 TO WS-EDITED-LF-CODE.
  7086     PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT.
  7087     GO TO 1059-EXIT.
  7088 1048-NO-RECORD.
  7089*    MOVE ER-2423                TO EMI-ERROR.
  7090*    MOVE AL-UABON               TO BTYPE1-ATTRB
  7091*    MOVE -1                     TO BTYPE1-LEN
  7092*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7093*    MOVE 'Y'                    TO ERROR-SW.
  7094     MOVE BTYPE1                 TO WS-EDITED-LF-CODE.
  7095     PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT.
  7096     GO TO 1059-EXIT.
  7097 1050-EDIT-INPUT-AH-CODE.
  7098     MOVE SPACES                 TO ELCNTL-ACCESS.
  7099     MOVE 'A'                    TO ELCNTL-REC-TYPE.
  7100     PERFORM 1070-ELCNTL-READ THRU 1079-EXIT.
  7101     IF EMI-ERROR = 9999
  7102         GO TO 1058-NO-RECORD.
  7103     MOVE +1 TO WS-EDIT-SUB.
  7104 1051-SEARCH-LOOP.
  7105     IF CF-AH-CODE-OUT (WS-EDIT-SUB) = ZEROS
  7106         GO TO 1057-NO-MATCH-FOUND.
  7107     IF BTYPE2    = CF-AH-CODE-IN (WS-EDIT-SUB)
  7108         MOVE CF-AH-CODE-OUT (WS-EDIT-SUB) TO WS-EDITED-AH-CODE
  7109         PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT
  7110         GO TO 1059-EXIT.
  7111     ADD +1  TO WS-EDIT-SUB.
  7112     IF WS-EDIT-SUB GREATER +96
  7113         GO TO 1057-NO-MATCH-FOUND.
  7114     GO TO 1051-SEARCH-LOOP.
  7115 1057-NO-MATCH-FOUND.
  7116*    MOVE ER-2428                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 132
* VP6301.cbl
  7117*    MOVE AL-UABON               TO BTYPE2-ATTRB
  7118*    MOVE -1                     TO BTYPE2-LEN
  7119*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7120*    MOVE 'Y'                    TO ERROR-SW.
  7121     MOVE BTYPE2                 TO WS-EDITED-AH-CODE.
  7122     PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT.
  7123     GO TO 1059-EXIT.
  7124 1058-NO-RECORD.
  7125*    MOVE ER-2427                TO EMI-ERROR.
  7126*    MOVE AL-UABON               TO BTYPE2-ATTRB
  7127*    MOVE -1                     TO BTYPE2-LEN
  7128*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7129*    MOVE 'Y'                    TO ERROR-SW.
  7130     MOVE BTYPE2                 TO WS-EDITED-AH-CODE.
  7131     PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT.
  7132 1059-EXIT.
  7133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 133
* VP6301.cbl
  7135 1060-BENEFIT-MASTER-READ.
  7136     MOVE SPACES                 TO ELCNTL-ACCESS.
  7137     IF ELCNTL-REC-TYPE = 'L'
  7138         MOVE WS-EDITED-LF-CODE  TO WS-BEN-CD
  7139                                    ELCNTL-HI-BEN
  7140         MOVE '4'                TO ELCNTL-REC-TYPE
  7141     ELSE
  7142         MOVE WS-EDITED-AH-CODE  TO WS-BEN-CD
  7143                                    ELCNTL-HI-BEN
  7144         MOVE '5'                TO ELCNTL-REC-TYPE.
  7145     PERFORM 1070-ELCNTL-READ THRU 1079-EXIT.
  7146     IF EMI-ERROR = 9999
  7147         GO TO 1062-NO-RECORD.
  7148     IF ELCNTL-COMPANY-ID NOT = CF-COMPANY-ID  OR
  7149        ELCNTL-REC-TYPE   NOT = CF-RECORD-TYPE
  7150           GO TO 1062-NO-RECORD.
  7151     perform varying ws-sub from +1 by +1 until
  7152        (ws-sub > +8)
  7153        or (cf-benefit-code (ws-sub) = ws-ben-cd)
  7154     end-perform
  7155     IF WS-SUB NOT = +9
  7156         IF ELCNTL-REC-TYPE = '4'
  7157             MOVE CF-BENEFIT-ALPHA (WS-SUB) TO WS-LF-ABBR-DESC
  7158             move cf-co-earnings-calc (ws-sub)
  7159                                 to ws-lf-earnings-calc
  7160         ELSE
  7161             MOVE CF-BENEFIT-ALPHA (WS-SUB) TO WS-AH-ABBR-DESC
  7162     ELSE
  7163         GO TO 1063-NO-MATCH-FOUND.
  7164     IF  CF-TERM-IN-DAYS (WS-SUB)
  7165         MOVE 'Y'                TO WS-TERM-IN-DAYS-SW.
  7166     GO TO 1069-EXIT.
  7167 1062-NO-RECORD.
  7168     MOVE ER-2426                TO EMI-ERROR.
  7169     IF ELCNTL-REC-TYPE = '4'
  7170         MOVE AL-UABON           TO BTYPE1-ATTRB
  7171         MOVE -1                 TO BTYPE1-LEN
  7172     ELSE
  7173         MOVE AL-UABON           TO BTYPE2-ATTRB
  7174         MOVE -1                 TO BTYPE2-LEN
  7175     END-IF
  7176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7177     MOVE 'Y'                    TO ERROR-SW.
  7178     GO TO 1069-EXIT.
  7179 1063-NO-MATCH-FOUND.
  7180     IF ELCNTL-REC-TYPE = '4'
  7181         MOVE ER-2425            TO EMI-ERROR
  7182         MOVE AL-UABON           TO BTYPE1-ATTRB
  7183         MOVE -1                 TO BTYPE1-LEN
  7184     ELSE
  7185         MOVE ER-2429            TO EMI-ERROR
  7186         MOVE AL-UABON           TO BTYPE2-ATTRB
  7187         MOVE -1                 TO BTYPE2-LEN
  7188     END-IF
  7189     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7190     MOVE 'Y'                    TO ERROR-SW.
  7191     GO TO 1069-EXIT.
  7192 1069-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 134
* VP6301.cbl
  7193     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 135
* VP6301.cbl
  7195 1070-ELCNTL-READ.
  7196
  7197* EXEC CICS HANDLE CONDITION
  7198*        NOTFND  (1078-NO-RECORD)
  7199*        ENDFILE (1078-NO-RECORD)
  7200*    END-EXEC.
  7201*    MOVE '"$I''                  ! # #00007045' TO DFHEIV0
  7202     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7203     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7204     MOVE X'2320233030303037303435' TO DFHEIV0(25:11)
  7205     CALL 'kxdfhei1' USING DFHEIV0
  7206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7207
  7208     IF ELCNTL-REC-TYPE = '1' OR '4' OR '5'
  7209
  7210* EXEC CICS READ
  7211*            DATASET (FILE-ID-ELCNTL)
  7212*            SET     (ADDRESS OF CONTROL-FILE)
  7213*            RIDFLD  (ELCNTL-KEY)
  7214*            GTEQ
  7215*        END-EXEC
  7216*    MOVE '&"S        G          (   #00007050' TO DFHEIV0
  7217     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7218     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7219     MOVE X'2020233030303037303530' TO DFHEIV0(25:11)
  7220     CALL 'kxdfhei1' USING DFHEIV0,
  7221           FILE-ID-ELCNTL,
  7222           DFHEIV20,
  7223           DFHEIV99,
  7224           ELCNTL-KEY,
  7225           DFHEIV99,
  7226           DFHEIV99,
  7227           DFHEIV99
  7228     SET ADDRESS OF CONTROL-FILE TO
  7229         DFHEIV20
  7230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7231     ELSE
  7232
  7233* EXEC CICS READ
  7234*            DATASET (FILE-ID-ELCNTL)
  7235*            SET     (ADDRESS OF CONTROL-FILE)
  7236*            RIDFLD  (ELCNTL-KEY)
  7237*        END-EXEC.
  7238*    MOVE '&"S        E          (   #00007057' TO DFHEIV0
  7239     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7240     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7241     MOVE X'2020233030303037303537' TO DFHEIV0(25:11)
  7242     CALL 'kxdfhei1' USING DFHEIV0,
  7243           FILE-ID-ELCNTL,
  7244           DFHEIV20,
  7245           DFHEIV99,
  7246           ELCNTL-KEY,
  7247           DFHEIV99,
  7248           DFHEIV99,
  7249           DFHEIV99
  7250     SET ADDRESS OF CONTROL-FILE TO
  7251         DFHEIV20
  7252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 136
* VP6301.cbl
  7253
  7254     GO TO 1079-EXIT.
  7255 1078-NO-RECORD.
  7256     MOVE ER-9999                TO EMI-ERROR.
  7257 1079-EXIT.
  7258     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 137
* VP6301.cbl
  7260*1080-TERM-CONVERSION.
  7261*    IF BMODE   = ' ' OR 'M'
  7262*        MOVE WS-BPMTS      TO WS-CALC-TERM-WHOLE
  7263*        GO TO 1085-ROUND-TERM.
  7264*    IF BMODE   = 'S'
  7265*        COMPUTE WS-CALC-TERM = WS-BPMTS / 2
  7266*        GO TO 1085-ROUND-TERM.
  7267*    IF BMODE   = 'W'
  7268*        COMPUTE WS-CALC-TERM = WS-BPMTS / 4.33333
  7269*        GO TO 1085-ROUND-TERM.
  7270*    IF BMODE   = 'B'
  7271*        COMPUTE WS-CALC-TERM = WS-BPMTS / 2.16667
  7272*        GO TO 1085-ROUND-TERM.
  7273*    IF BMODE   = 'T'
  7274*        COMPUTE WS-CALC-TERM = WS-BPMTS / 1.08334.
  7275*1085-ROUND-TERM.
  7276*    IF WS-CALC-TERM-REMAIN GREATER .00000
  7277*       ADD +1 TO WS-CALC-TERM.
  7278*    MOVE ZEROS                  TO WS-CALC-TERM-REMAIN.
  7279*    IF  BTYPE-LEN       (WS-SUB1)  GREATER ZEROS
  7280*        IF  WS-KIND-MONTHLY
  7281*            IF BTERM-LEN    (WS-SUB1)  = ZEROS
  7282*               IF BPREM-LEN (WS-SUB1)  GREATER ZEROS
  7283*                  IF  BPMT-LEN   GREATER ZEROS
  7284*                      NEXT SENTENCE
  7285*                  ELSE
  7286*                      GO TO 1087-EDIT-TERM.
  7287*    IF PI-COMPANY-ID IS EQUAL TO 'HAN' OR 'JHL'
  7288*        IF BBEN-LEN (WS-SUB1) IS GREATER THAN ZEROS
  7289*            GO TO 1087-EDIT-TERM.
  7290*    IF  BMODE   = 'M' OR ' '
  7291*        MOVE WS-BPMT            TO  WS-BBEN    (WS-SUB1).
  7292*    IF  BMODE   = 'W'
  7293*        COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 4.33333.
  7294*    IF  BMODE   = 'S'
  7295*        COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = WS-BPMT * 2.
  7296*    IF  BMODE   = 'B'
  7297*        COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 2.16667.
  7298*    IF  BMODE   = 'T'
  7299*        COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 1.08334.
  7300*    IF WS-SUB1 = +1
  7301*        COMPUTE WS-BBEN  (WS-SUB1) = WS-BPMT * WS-BPMTS.
  7302*    IF PI-COMPANY-ID = 'CRI'       OR  'LGX'
  7303*        IF WS-SUB1 = +1  AND
  7304*           BBEN-LEN (WS-SUB1) GREATER ZEROS
  7305*             GO TO 1087-EDIT-TERM.
  7306*    MOVE  WS-BBEN (WS-SUB1)     TO BBENO       (WS-SUB1).
  7307*    MOVE +12                    TO BBEN-LEN    (WS-SUB1).
  7308*    MOVE AL-UNNON               TO BBEN-ATTRB  (WS-SUB1).
  7309*1087-EDIT-TERM.
  7310*    IF BTERM-LEN (WS-SUB1)  = ZEROS
  7311*        MOVE WS-CALC-TERM-WHOLE   TO BTERMI      (WS-SUB1)
  7312*                                     WS-BTERM    (WS-SUB1)
  7313*        MOVE +3                   TO BTERM-LEN   (WS-SUB1)
  7314*        GO TO 1089-EXIT.
  7315*    MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD.
  7316*    PERFORM 8600-DEEDIT.
  7317*    IF DEEDIT-FIELD-V0 NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 138
* VP6301.cbl
  7318*       MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  7319*       IF WS-BTERM (WS-SUB1)  GREATER ZERO
  7320*          MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  7321*       ELSE
  7322*          MOVE ER-2241         TO EMI-ERROR
  7323*          MOVE -1              TO BTERM-LEN   (WS-SUB1)
  7324*          MOVE AL-UNBOF        TO BTERM-ATTRB (WS-SUB1)
  7325*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7326*          GO TO 1089-EXIT.
  7327*    IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
  7328*        MOVE -1                   TO BTERM-LEN   (WS-SUB1)
  7329*        MOVE ER-2593              TO EMI-ERROR
  7330*        MOVE AL-UNBON             TO BTERM-ATTRB (WS-SUB1)
  7331*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7332*1089-EXIT.
  7333*    EXIT.
  7334*1090-CALCULATE-MONTHLY-TERM.
  7335*    IF  BTYPE-LEN  (WS-SUB1)  GREATER ZEROS
  7336*        IF BTERM-LEN (WS-SUB1)  = ZEROS
  7337*           IF BPREM-LEN ( WS-SUB1) GREATER ZEROS
  7338*              IF  BPMT-LEN   GREATER ZEROS
  7339*                  NEXT SENTENCE
  7340*              ELSE
  7341*                  GO TO 1094-EXIT.
  7342*    COMPUTE  WS-CALC-TERM = WS-BDAYS / 31.
  7343*    IF WS-CALC-TERM-REMAIN GREATER .00000
  7344*       ADD +1 TO WS-CALC-TERM.
  7345*    MOVE ZEROS                  TO  WS-CALC-TERM-REMAIN.
  7346*    MOVE WS-CALC-TERM           TO  BTERMI    (WS-SUB1).
  7347*    MOVE +3                     TO  BTERM-LEN (WS-SUB1).
  7348*    IF  BMODE   = 'M'  OR  ' '
  7349*        MOVE WS-BPMT            TO  WS-BBEN    (WS-SUB1).
  7350*    IF  BMODE   = 'W'
  7351*        COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 4.33333.
  7352*    IF  BMODE   = 'S'
  7353*        COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = WS-BPMT * 2.
  7354*    IF  BMODE   = 'B'
  7355*        COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 2.16667.
  7356*    IF  BMODE   = 'T'
  7357*        COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 1.08334.
  7358*    IF WS-SUB1 = +1
  7359*       COMPUTE WS-BBEN  (WS-SUB1) =
  7360*               WS-BBEN (WS-SUB1) * WS-CALC-TERM.
  7361*    MOVE  WS-BBEN (WS-SUB1)     TO BBENO       (WS-SUB1).
  7362*    MOVE +12                    TO BBEN-LEN    (WS-SUB1).
  7363*    MOVE AL-UNNON               TO BBEN-ATTRB  (WS-SUB1).
  7364*1094-EXIT.
  7365*    EXIT.
  7366 1095-CALC-AGE.
  7367     MOVE WS-CONVERTED-BIRTH (1) TO DC-BIN-DATE-1
  7368     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  7369     MOVE 1 TO DC-OPTION-CODE.
  7370     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7371     IF NO-CONVERSION-ERROR
  7372         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  7373         MOVE WS-BAGE            TO BAGE
  7374         MOVE +2                 TO BAGE-LEN
  7375         MOVE AL-UNNON TO BAGE-ATTRB.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 139
* VP6301.cbl
  7376 1099-EXIT.
  7377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 140
* VP6301.cbl
  7379 1100-EDIT-MAPC.
  7380     MOVE +1                     TO WS-SUB2.
  7381     IF PI-LAST-FUNC-DISPLAY
  7382        AND CLAST-NAME-LEN (1)   = ZEROS
  7383        AND CLAST-NAME-LEN (2)   = ZEROS
  7384        AND CLAST-NAME-LEN (3)   = ZEROS
  7385        AND CLAST-NAME-LEN (4)   = ZEROS
  7386        AND CCANDT1-LEN     (1) = ZEROS
  7387        AND CCANDT2-LEN     (1) = ZEROS
  7388        AND CCANDT1-LEN     (2) = ZEROS
  7389        AND CCANDT2-LEN     (2) = ZEROS
  7390        AND CCANDT1-LEN     (3) = ZEROS
  7391        AND CCANDT2-LEN     (3) = ZEROS
  7392        AND CCANDT1-LEN     (4) = ZEROS
  7393        AND CCANDT2-LEN     (4) = ZEROS
  7394        AND CMTHD1-LEN      (1) = ZEROS
  7395        AND CMTHD2-LEN      (1) = ZEROS
  7396        AND CMTHD1-LEN      (2) = ZEROS
  7397        AND CMTHD2-LEN      (2) = ZEROS
  7398        AND CMTHD1-LEN      (3) = ZEROS
  7399        AND CMTHD2-LEN      (3) = ZEROS
  7400        AND CMTHD1-LEN      (4) = ZEROS
  7401        AND CMTHD2-LEN      (4) = ZEROS
  7402        AND CREFUND1-LEN    (1) = ZEROS
  7403        AND CREFUND2-LEN    (1) = ZEROS
  7404        AND CREFUND1-LEN    (2) = ZEROS
  7405        AND CREFUND2-LEN    (2) = ZEROS
  7406        AND CREFUND1-LEN    (3) = ZEROS
  7407        AND CREFUND2-LEN    (3) = ZEROS
  7408        AND CREFUND1-LEN    (4) = ZEROS
  7409        AND CREFUND2-LEN    (4) = ZEROS
  7410        AND CLIVES-LEN     (1) = ZEROS
  7411        AND CLIVES-LEN     (2) = ZEROS
  7412        AND CLIVES-LEN     (3) = ZEROS
  7413        AND CLIVES-LEN     (4) = ZEROS
  7414        AND CCANREA-LEN    (1) = ZEROS
  7415        AND CCANREA-LEN    (2) = ZEROS
  7416        AND CCANREA-LEN    (3) = ZEROS
  7417        AND CCANREA-LEN    (4) = ZEROS
  7418        AND CPAYEE-LEN     (1) = ZEROS
  7419        AND CPAYEE-LEN     (2) = ZEROS
  7420        AND CPAYEE-LEN     (3) = ZEROS
  7421        AND CPAYEE-LEN     (4) = ZEROS
  7422        AND CCHK-LEN       (1) = ZEROS
  7423        AND CCHK-LEN       (2) = ZEROS
  7424        AND CCHK-LEN       (3) = ZEROS
  7425        AND CCHK-LEN       (4) = ZEROS
  7426         GO TO 1130-NOTHING-TO-EDIT.
  7427 1110-EDIT-MAPC-LOOP.
  7428     IF CCERT-LEN       (WS-SUB2) = ZEROS
  7429       AND CEFFDT-LEN   (WS-SUB2) = ZEROS
  7430       AND CCANDT1-LEN  (WS-SUB2) = ZEROS
  7431       AND CCANDT2-LEN  (WS-SUB2) = ZEROS
  7432       AND CMTHD1-LEN   (WS-SUB2) = ZEROS
  7433       AND CMTHD2-LEN   (WS-SUB2) = ZEROS
  7434       AND CREFUND1-LEN (WS-SUB2) = ZEROS
  7435       AND CREFUND2-LEN (WS-SUB2) = ZEROS
  7436       AND NOT PI-LAST-FUNC-DISPLAY
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 141
* VP6301.cbl
  7437         GO TO 1120-INCREMENT-OCCURRENCE.
  7438     MOVE 'Y'                    TO WS-DATA-KEYED-SW.
  7439     MOVE AL-SABON               TO CSEQ-ATTRB (WS-SUB2).
  7440     IF CCERT-LEN (WS-SUB2) = ZEROS
  7441       AND PI-LAST-FUNC-DISPLAY
  7442         NEXT SENTENCE
  7443     ELSE
  7444         IF CCERT-LEN (WS-SUB2)  NOT = ZEROS
  7445             MOVE AL-UANON       TO CCERT-ATTRB (WS-SUB2)
  7446         ELSE
  7447             MOVE -1             TO CCERT-LEN   (WS-SUB2)
  7448             MOVE ER-2218        TO EMI-ERROR
  7449             MOVE AL-UABON       TO CCERT-ATTRB (WS-SUB2)
  7450             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7451     IF CSFX-LEN (WS-SUB2)      GREATER ZEROS
  7452         MOVE 'Y'                TO PI-CAN-SUFFIX-KEYED-SW
  7453         MOVE AL-UANON           TO CSFX-ATTRB (WS-SUB2).
  7454     IF CEFFDT-LEN (WS-SUB2) = ZEROS
  7455       AND PI-LAST-FUNC-DISPLAY
  7456         NEXT SENTENCE
  7457     ELSE
  7458         IF CEFFDT-LEN (WS-SUB2) GREATER ZEROS
  7459             MOVE AL-UNNON           TO CEFFDT-ATTRB (WS-SUB2)
  7460             IF CEFFDT (WS-SUB2) NUMERIC
  7461                 MOVE 4              TO DC-OPTION-CODE
  7462                 MOVE CEFFDT (WS-SUB2)  TO DC-GREG-DATE-1-MDY
  7463                 PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7464                 MOVE DC-BIN-DATE-1  TO
  7465                             WS-CONVERTED-CAN-EFF-DT (WS-SUB2)
  7466                             WS-CONVERTED-EFFDT
  7467                 IF NO-CONVERSION-ERROR
  7468                     IF WS-CONVERTED-CAN-EFF-DT (WS-SUB2)
  7469                       NOT LESS PI-ACCT-LOW-EFF-DT
  7470                       AND LESS PI-ACCT-HIGH-EXP-DT
  7471                         PERFORM 1500-EDIT-ACCT-DT-RANGES THRU
  7472                                 1590-EXIT
  7473                     ELSE
  7474                         NEXT SENTENCE
  7475*                        MOVE -1       TO CEFFDT-LEN (WS-SUB2)
  7476*                        MOVE ER-2589  TO EMI-ERROR
  7477*                        MOVE AL-UNBON TO CEFFDT-ATTRB (WS-SUB2)
  7478*                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7479                 ELSE
  7480                     MOVE -1         TO CEFFDT-LEN (WS-SUB2)
  7481                     MOVE ER-2226    TO EMI-ERROR
  7482                     MOVE AL-UNBON   TO CEFFDT-ATTRB (WS-SUB2)
  7483                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7484             ELSE
  7485                 MOVE -1             TO CEFFDT-LEN (WS-SUB2)
  7486                 MOVE ER-2223        TO EMI-ERROR
  7487                 MOVE AL-UNBON       TO CEFFDT-ATTRB (WS-SUB2)
  7488                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7489         ELSE
  7490             MOVE -1                 TO CEFFDT-LEN (WS-SUB2)
  7491             MOVE ER-2220            TO EMI-ERROR
  7492             MOVE AL-UNBON           TO CEFFDT-ATTRB (WS-SUB2)
  7493             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7494     IF CLAST-NAME-LEN (WS-SUB2) GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 142
* VP6301.cbl
  7495         MOVE AL-UANON           TO CLAST-NAME-ATTRB (WS-SUB2).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 143
* VP6301.cbl
  7497 1115-EDIT-COVERAGES.
  7498     IF CCANDT1-LEN (WS-SUB2) = ZEROS
  7499       AND PI-LAST-FUNC-DISPLAY
  7500         NEXT SENTENCE
  7501     ELSE
  7502         IF CCANDT1-LEN (WS-SUB2) GREATER ZEROS
  7503             MOVE AL-UNNON       TO CCANDT1-ATTRB (WS-SUB2)
  7504             IF PI-LAST-FUNC-DISPLAY AND
  7505                CCANDT1 (WS-SUB2) = SPACES
  7506                 MOVE LOW-VALUES TO WS-CONVERTED-CANDT1 (WS-SUB2)
  7507             ELSE
  7508                IF CCANDT1 (WS-SUB2) NUMERIC
  7509                   MOVE 4              TO DC-OPTION-CODE
  7510                   MOVE CCANDT1 (WS-SUB2) TO
  7511                                      DC-GREG-DATE-1-MDY
  7512                   PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7513                   MOVE DC-BIN-DATE-1  TO WS-CONVERTED-CANDT1
  7514                                                         (WS-SUB2)
  7515                   IF NO-CONVERSION-ERROR
  7516                      NEXT SENTENCE
  7517                   ELSE
  7518                      MOVE -1       TO CCANDT1-LEN   (WS-SUB2)
  7519                      MOVE ER-2227  TO EMI-ERROR
  7520                      MOVE AL-UNBON TO CCANDT1-ATTRB (WS-SUB2)
  7521                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7522                ELSE
  7523                   MOVE -1         TO CCANDT1-LEN   (WS-SUB2)
  7524                   MOVE ER-2223    TO EMI-ERROR
  7525                   MOVE AL-UNBON   TO CCANDT1-ATTRB (WS-SUB2)
  7526                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7527         ELSE
  7528             IF CREFUND1-LEN (WS-SUB2) GREATER ZEROS
  7529                MOVE -1             TO CCANDT1-LEN   (WS-SUB2)
  7530                MOVE ER-2222        TO EMI-ERROR
  7531                MOVE AL-UNBOF       TO CCANDT1-ATTRB (WS-SUB2)
  7532                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7533     IF CREFUND1-LEN (WS-SUB2) = ZEROS
  7534       AND PI-LAST-FUNC-DISPLAY
  7535         NEXT SENTENCE
  7536     ELSE
  7537         IF CREFUND1-LEN (WS-SUB2) NOT = ZEROS
  7538            MOVE AL-UNNON       TO CREFUND1-ATTRB (WS-SUB2)
  7539*           MOVE CREFUND1I (WS-SUB2) TO DEEDIT-FIELD-X11
  7540*           PERFORM 8600-DEEDIT
  7541*           MOVE DEEDIT-FIELD-V2  TO WS-CREFUND1 (WS-SUB2).
  7542
  7543* EXEC CICS BIF DEEDIT
  7544*               FIELD  (CREFUND1I (WS-SUB2))
  7545*               LENGTH (11)
  7546*           END-EXEC
  7547     MOVE 11
  7548       TO DFHEIV11
  7549*    MOVE '@"L                   #   #00007350' TO DFHEIV0
  7550     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7551     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7552     MOVE X'2020233030303037333530' TO DFHEIV0(25:11)
  7553     CALL 'kxdfhei1' USING DFHEIV0,
  7554           CREFUND1I(WS-SUB2),
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 144
* VP6301.cbl
  7555           DFHEIV11
  7556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7557            MOVE CREFUND1I (WS-SUB2) TO WS-CREFUND1 (WS-SUB2).
  7558******************************************************************
  7559*********** REFUND METHODS CORRESPOND TO EARNING METHODS *********
  7560*********** METHOD 'R' INDICATES A REPOSSESSION FOR 'FLC'*********
  7561******************************************************************
  7562     IF CMTHD1-LEN (WS-SUB2) = ZEROS
  7563       AND PI-LAST-FUNC-DISPLAY
  7564         NEXT SENTENCE
  7565     ELSE
  7566         IF CMTHD1-LEN (WS-SUB2) NOT = ZEROS
  7567            MOVE 'Y'            TO PI-REFUND-MTHD-KEYED-SW
  7568            MOVE AL-UNNON       TO CMTHD1-ATTRB (WS-SUB2)
  7569            IF CMTHD1 (WS-SUB2) EQUAL '1' OR '2' OR '3' OR '4'
  7570                                   OR '5' OR '6' OR '8' OR ' '
  7571*                                  OR 'R'
  7572               NEXT SENTENCE
  7573            ELSE
  7574                MOVE -1         TO CMTHD1-LEN   (WS-SUB2)
  7575                MOVE ER-0582    TO EMI-ERROR
  7576                MOVE AL-UNBON   TO CMTHD1-ATTRB (WS-SUB2)
  7577                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7578     MOVE SPACES                  TO WS-CONVERTED-CANDT2 (WS-SUB2)
  7579     IF CCANDT2-LEN (WS-SUB2) = ZEROS
  7580       AND PI-LAST-FUNC-DISPLAY
  7581         NEXT SENTENCE
  7582     ELSE
  7583         IF CCANDT2-LEN (WS-SUB2) GREATER ZEROS
  7584             MOVE AL-UNNON       TO CCANDT2-ATTRB (WS-SUB2)
  7585             IF PI-LAST-FUNC-DISPLAY AND
  7586                CCANDT2 (WS-SUB2) = SPACES
  7587                 MOVE LOW-VALUES TO WS-CONVERTED-CANDT2 (WS-SUB2)
  7588             ELSE
  7589                IF CCANDT2 (WS-SUB2) NUMERIC
  7590                   MOVE 4              TO DC-OPTION-CODE
  7591                   MOVE CCANDT2 (WS-SUB2) TO
  7592                                      DC-GREG-DATE-1-MDY
  7593                   PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7594                   MOVE DC-BIN-DATE-1  TO WS-CONVERTED-CANDT2
  7595                                                         (WS-SUB2)
  7596                   IF NO-CONVERSION-ERROR
  7597                      NEXT SENTENCE
  7598                   ELSE
  7599                      MOVE -1       TO CCANDT2-LEN   (WS-SUB2)
  7600                      MOVE ER-2227  TO EMI-ERROR
  7601                      MOVE AL-UNBON TO CCANDT2-ATTRB (WS-SUB2)
  7602                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7603                ELSE
  7604                   MOVE -1         TO CCANDT2-LEN   (WS-SUB2)
  7605                   MOVE ER-2223    TO EMI-ERROR
  7606                   MOVE AL-UNBON   TO CCANDT2-ATTRB (WS-SUB2)
  7607                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7608****     ELSE
  7609****         IF CREFUND2-LEN (WS-SUB2) GREATER ZEROS
  7610****            MOVE -1             TO CCANDT2-LEN   (WS-SUB2)
  7611****            MOVE ER-2222        TO EMI-ERROR
  7612****            MOVE AL-UNBOF       TO CCANDT2-ATTRB (WS-SUB2)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 145
* VP6301.cbl
  7613****            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7614     IF CREFUND2-LEN (WS-SUB2) = ZEROS
  7615       AND PI-LAST-FUNC-DISPLAY
  7616         NEXT SENTENCE
  7617     ELSE
  7618         IF CREFUND2-LEN (WS-SUB2) NOT = ZEROS
  7619            MOVE AL-UNNON       TO CREFUND2-ATTRB (WS-SUB2)
  7620*           MOVE CREFUND2I (WS-SUB2) TO DEEDIT-FIELD-X11
  7621*           PERFORM 8600-DEEDIT
  7622*           MOVE DEEDIT-FIELD-V2  TO WS-CREFUND2 (WS-SUB2).
  7623
  7624* EXEC CICS BIF DEEDIT
  7625*               FIELD  (CREFUND2I (WS-SUB2))
  7626*               LENGTH (11)
  7627*           END-EXEC
  7628     MOVE 11
  7629       TO DFHEIV11
  7630*    MOVE '@"L                   #   #00007420' TO DFHEIV0
  7631     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7632     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7633     MOVE X'2020233030303037343230' TO DFHEIV0(25:11)
  7634     CALL 'kxdfhei1' USING DFHEIV0,
  7635           CREFUND2I(WS-SUB2),
  7636           DFHEIV11
  7637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7638            MOVE CREFUND2I (WS-SUB2) TO WS-CREFUND2 (WS-SUB2).
  7639     IF CMTHD2-LEN (WS-SUB2) = ZEROS
  7640       AND PI-LAST-FUNC-DISPLAY
  7641         NEXT SENTENCE
  7642     ELSE
  7643         IF CMTHD2-LEN (WS-SUB2) NOT = ZEROS
  7644            MOVE 'Y'            TO PI-REFUND-MTHD-KEYED-SW
  7645            MOVE AL-UNNON       TO CMTHD2-ATTRB (WS-SUB2)
  7646            IF CMTHD2 (WS-SUB2) EQUAL '1' OR '2' OR '3' OR '4'
  7647                                   OR '5' OR '6' OR '8' OR ' '
  7648*                                  OR 'R'
  7649               NEXT SENTENCE
  7650            ELSE
  7651                MOVE -1         TO CMTHD2-LEN   (WS-SUB2)
  7652                MOVE ER-0582    TO EMI-ERROR
  7653                MOVE AL-UNBON   TO CMTHD2-ATTRB (WS-SUB2)
  7654                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7655     IF CLIVES-LEN  (WS-SUB2)  GREATER ZEROS
  7656         MOVE 'Y'                TO PI-CAN-LIVES-KEYED-SW
  7657         MOVE CLIVESI (WS-SUB2 ) TO DEEDIT-FIELD
  7658         PERFORM 8600-DEEDIT
  7659         IF DEEDIT-FIELD-V0 NUMERIC
  7660             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES   (WS-SUB2)
  7661             MOVE AL-UNNON       TO CLIVES-ATTRB (WS-SUB2)
  7662         ELSE
  7663             MOVE -1             TO CLIVES-LEN   (WS-SUB2)
  7664             MOVE AL-UNBON       TO CLIVES-ATTRB (WS-SUB2)
  7665             MOVE ER-2223        TO EMI-ERROR
  7666             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7667     IF CCANREA-LEN (WS-SUB2)  GREATER  ZEROS
  7668         MOVE 'Y'                TO  PI-CAN-REA-KEYED-SW
  7669         IF CCANREA (WS-SUB2) = 'R' OR ' '
  7670            MOVE CCANREA (WS-SUB2)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 146
* VP6301.cbl
  7671                                 TO  WS-CAN-REA (WS-SUB2)
  7672             MOVE AL-UANON       TO  CCANREA-ATTRB (WS-SUB2)
  7673         ELSE
  7674             MOVE -1             TO  CCANREA-LEN (WS-SUB2)
  7675             MOVE AL-UABON       TO  CCANREA-ATTRB (WS-SUB2)
  7676             MOVE ER-9841        TO  EMI-ERROR
  7677             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7678     IF CPAYEE-LEN  (WS-SUB2)  GREATER ZEROS
  7679        MOVE 'Y'                 TO PI-PAYEE-KEYED-SW.
  7680     IF CCHK-LEN    (WS-SUB2)  GREATER ZEROS
  7681        MOVE 'Y'                 TO PI-CHK-REQ-KEYED-SW
  7682        IF  CCHK    (WS-SUB2)  = 'R' OR ' '
  7683            NEXT SENTENCE
  7684        ELSE
  7685            MOVE ER-7405         TO EMI-ERROR
  7686            MOVE -1              TO CCHK-LEN      (WS-SUB2)
  7687            MOVE AL-UABON        TO CCHK-ATTRB    (WS-SUB2)
  7688            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7689     IF PI-LAST-FUNC-DISPLAY
  7690        NEXT SENTENCE
  7691     ELSE
  7692        IF CCANDT1-LEN (WS-SUB2) GREATER ZEROS OR
  7693           CCANDT2-LEN (WS-SUB2) GREATER ZEROS
  7694             NEXT SENTENCE
  7695           ELSE
  7696             MOVE ER-2222          TO EMI-ERROR
  7697             MOVE -1               TO CCANDT1-LEN   (WS-SUB2)
  7698             MOVE AL-UNBOF         TO CCANDT1-ATTRB (WS-SUB2)
  7699             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7700     IF PI-LAST-FUNC-DISPLAY
  7701        NEXT SENTENCE
  7702     ELSE
  7703        IF WS-CONVERTED-CANDT1 (WS-SUB2) NOT = LOW-VALUES AND
  7704           WS-CONVERTED-CANDT2 (WS-SUB2) = SPACES AND
  7705           CREFUND2-LEN (WS-SUB2) GREATER ZEROS
  7706             MOVE WS-CONVERTED-CANDT1 (WS-SUB2) TO
  7707                  WS-CONVERTED-CANDT2 (WS-SUB2)
  7708             MOVE CCANDT1     (WS-SUB2) TO CCANDT2     (WS-SUB2)
  7709             MOVE CCANDT1-LEN (WS-SUB2) TO CCANDT2-LEN (WS-SUB2).
  7710     IF  EMI-ERROR = ZEROS
  7711         MOVE 'Y'                TO PI-UPDATE-SW
  7712     ELSE
  7713         MOVE 'Y'                TO PI-ERROR-SW.
  7714 1120-INCREMENT-OCCURRENCE.
  7715     ADD +1                      TO WS-SUB2.
  7716     IF WS-SUB2 GREATER +4 OR PI-LAST-FUNC-DISPLAY
  7717         NEXT SENTENCE
  7718     ELSE
  7719         GO TO 1110-EDIT-MAPC-LOOP.
  7720     IF PI-DATA-ERRORS
  7721         MOVE AL-SABON           TO CSEQ-ATTRB (1) CSEQ-ATTRB (2)
  7722                                    CSEQ-ATTRB (3) CSEQ-ATTRB (4)
  7723        GO TO 8200-SEND-DATAONLY
  7724     ELSE
  7725        PERFORM 5000-BUILD-CANCEL-RECORD THRU 5900-EXIT.
  7726 1130-NOTHING-TO-EDIT.
  7727     IF NOT PI-LAST-FUNC-DISPLAY
  7728        AND WS-DATA-NOT-KEYED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 147
* VP6301.cbl
  7729          MOVE ER-7400             TO EMI-ERROR
  7730          MOVE -1                  TO CCANDT1-LEN (1)
  7731          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7732          MOVE 'Y'                 TO PI-ERROR-SW
  7733          GO TO 8200-SEND-DATAONLY.
  7734     IF PI-SAV-BATCH-SEQ LESS PI-LAST-SEQ-NO-ADDED
  7735        SUBTRACT 1 FROM PI-SAV-BATCH-SEQ
  7736        MOVE ER-0000            TO EMI-ERROR
  7737        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7738        GO TO 2000-BROWSE-FWD.
  7739     MOVE LOW-VALUES     TO VP630BI.
  7740     MOVE SPACE          TO PI-DISPLAY-SW.
  7741     ADD +1                 PI-LAST-SEQ-NO-ADDED
  7742                            GIVING PI-NEXT-DISPLAY-SEQ-NO.
  7743     MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ.
  7744     PERFORM 8550-SET-MAP-SEQ-NOS
  7745                  VARYING WS-SUB2 FROM +1 BY +1
  7746                  UNTIL WS-SUB2 GREATER +4.
  7747     MOVE ER-0000            TO EMI-ERROR.
  7748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7749     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 148
* VP6301.cbl
  7751 1500-EDIT-ACCT-DT-RANGES.
  7752******************************************************************
  7753*                                                                *
  7754*         E D I T   A C C O U N T   D A T E   R A N G E S        *
  7755*                                                                *
  7756*                                                                *
  7757*    NOTE:  IT IS ONLY NECESSARY TO EDIT THE DATE RANGES         *
  7758*           FOR COMPANYS THAT USE THE ACCOUNTS RECEIVABLE        *
  7759*           SYSTEM.                                              *
  7760*                                                                *
  7761*    1.  DETERMINE THE DATE RANGE FOR THE EFFECTIVE DATE.        *
  7762*                                                                *
  7763*    2.  VERIFY THE ACCOUNT AGENT.  THE ACCOUNT AGENT SHOULD BE  *
  7764*        THE SAME FOR THE ENTIRE BATCH.  IF IT CHANGES, IT IS    *
  7765*        AN ERROR.                                               *
  7766*                                                                *
  7767*    3.  VERIFY THAT THE FINANCIAL RESPONSIBLITY.  THE FINANCIAL *
  7768*        RESPONSIBILITY SHOULD BE THE SAME FOR THE ENTIRE BATCH. *
  7769*        IF IT CHANGES, IT IS AN ERROR.                          *
  7770*                                                                *
  7771******************************************************************
  7772     IF PI-AR-PROCESSING
  7773        NEXT SENTENCE
  7774     ELSE
  7775        GO TO 1590-EXIT.
  7776     MOVE +0                     TO WS-ACCT-SUB.
  7777 1525-FIND-ACCT-DT-RANGE.
  7778     ADD  +1                     TO WS-ACCT-SUB.
  7779     IF WS-ACCT-SUB GREATER +32
  7780        MOVE  ER-2119            TO EMI-ERROR
  7781        IF PI-MAP-NAME = VP630B
  7782           MOVE -1               TO BPFENTRL
  7783           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7784           GO TO 8200-SEND-DATAONLY
  7785        ELSE
  7786           MOVE -1               TO CEFFDT-LEN (WS-SUB2)
  7787           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7788           GO TO 1590-EXIT.
  7789     IF WS-CONVERTED-EFFDT NOT LESS PI-ACCT-EFF-DT
  7790                                                 (WS-ACCT-SUB)
  7791        IF WS-CONVERTED-EFFDT  LESS PI-ACCT-EXP-DT
  7792                                                 (WS-ACCT-SUB)
  7793           NEXT SENTENCE
  7794        ELSE
  7795           GO TO 1525-FIND-ACCT-DT-RANGE.
  7796     IF PI-ACCOUNT-AGENT = SPACES
  7797        MOVE PI-ACCT-AGENT  (WS-ACCT-SUB) TO PI-ACCOUNT-AGENT
  7798        MOVE PI-REMIT-AGENT (WS-ACCT-SUB) TO PI-FIN-RESP.
  7799     IF PI-ACCT-AGENT  (WS-ACCT-SUB) = PI-ACCOUNT-AGENT
  7800        NEXT SENTENCE
  7801     ELSE
  7802        MOVE 'Y'                 TO PI-ACCT-AGENT-ERROR-SW.
  7803     IF PI-REMIT-AGENT (WS-ACCT-SUB) = PI-FIN-RESP
  7804        NEXT SENTENCE
  7805     ELSE
  7806        MOVE 'Y'                 TO PI-FIN-RESP-ERROR-SW.
  7807 1590-EXIT.
  7808      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 149
* VP6301.cbl
  7810 2000-BROWSE-FWD.
  7811     MOVE LOW-VALUES             TO VP630BI.
  7812     ADD +1                      TO PI-SAV-BATCH-SEQ.
  7813
  7814* EXEC CICS HANDLE CONDITION
  7815*        NOTFND (2020-END-FILE)
  7816*    END-EXEC.
  7817*    MOVE '"$I                   ! $ #00007599' TO DFHEIV0
  7818     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7819     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7820     MOVE X'2420233030303037353939' TO DFHEIV0(25:11)
  7821     CALL 'kxdfhei1' USING DFHEIV0
  7822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7823
  7824
  7825* EXEC CICS READ
  7826*        SET     (ADDRESS OF PENDING-BUSINESS)
  7827*        DATASET (FILE-ID-ERPNDB)
  7828*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  7829*        GTEQ
  7830*    END-EXEC.
  7831*    MOVE '&"S        G          (   #00007602' TO DFHEIV0
  7832     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7834     MOVE X'2020233030303037363032' TO DFHEIV0(25:11)
  7835     CALL 'kxdfhei1' USING DFHEIV0,
  7836           FILE-ID-ERPNDB,
  7837           DFHEIV20,
  7838           DFHEIV99,
  7839           PI-SAV-ENDING-ERPNDB-KEY,
  7840           DFHEIV99,
  7841           DFHEIV99,
  7842           DFHEIV99
  7843     SET ADDRESS OF PENDING-BUSINESS TO
  7844         DFHEIV20
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7846
  7847     IF PB-COMPANY-CD  = PI-SAV-COMP-CD  AND
  7848        PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  7849         NEXT SENTENCE
  7850     ELSE
  7851         GO TO 2020-END-FILE.
  7852     IF PB-BATCH-TRAILER
  7853         GO TO 2020-END-FILE.
  7854     MOVE PB-BATCH-SEQ-NO        TO PI-SAV-BATCH-SEQ.
  7855     IF PB-ISSUE
  7856         MOVE VP630B             TO PI-MAP-NAME
  7857         MOVE AL-SANOF           TO BDELHDGA
  7858         PERFORM 7000-FORMAT-ISSUE-SCREEN THRU 7090-EXIT
  7859     ELSE
  7860         MOVE VP630C             TO PI-MAP-NAME
  7861         MOVE AL-SANOF           TO CDELHDGA
  7862         PERFORM 7100-FORMAT-CANCEL-SCREEN THRU 7190-EXIT.
  7863 2010-SEND-MAP.
  7864     GO TO 8100-SEND-INITIAL-MAP.
  7865 2020-END-FILE.
  7866     MOVE SPACE                  TO PI-DISPLAY-SW.
  7867     IF PI-MAP-NAME = VP630B
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 150
* VP6301.cbl
  7868         MOVE LOW-VALUES         TO VP630BI
  7869         MOVE -1                 TO BPFENTRL
  7870         ADD +1                     PI-LAST-SEQ-NO-ADDED
  7871               GIVING PI-NEXT-DISPLAY-SEQ-NO
  7872         PERFORM 8550-SET-MAP-SEQ-NOS
  7873     ELSE
  7874         MOVE LOW-VALUES         TO VP630BI
  7875         MOVE -1                 TO CPFENTRL
  7876         ADD +1                     PI-LAST-SEQ-NO-ADDED
  7877               GIVING PI-NEXT-DISPLAY-SEQ-NO
  7878         PERFORM 8550-SET-MAP-SEQ-NOS
  7879                 VARYING WS-SUB2 FROM +1 BY +1
  7880                 UNTIL WS-SUB2 GREATER +4.
  7881     MOVE ER-2217                TO EMI-ERROR.
  7882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7883     GO TO 2010-SEND-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 151
* VP6301.cbl
  7885 2100-BROWSE-BKWD.
  7886     MOVE LOW-VALUES             TO VP630BI.
  7887     SUBTRACT +1             FROM PI-SAV-BATCH-SEQ.
  7888     IF PI-SAV-BATCH-SEQ NOT GREATER +0
  7889         GO TO 2120-END-FILE.
  7890
  7891* EXEC CICS HANDLE CONDITION
  7892*        NOTFND (2100-BROWSE-BKWD)
  7893*    END-EXEC.
  7894*    MOVE '"$I                   ! % #00007651' TO DFHEIV0
  7895     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7896     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7897     MOVE X'2520233030303037363531' TO DFHEIV0(25:11)
  7898     CALL 'kxdfhei1' USING DFHEIV0
  7899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7900
  7901
  7902* EXEC CICS READ
  7903*        SET     (ADDRESS OF PENDING-BUSINESS)
  7904*        DATASET (FILE-ID-ERPNDB)
  7905*        RIDFLD  (PI-SAV-ENDING-ERPNDB-KEY)
  7906*    END-EXEC.
  7907*    MOVE '&"S        E          (   #00007654' TO DFHEIV0
  7908     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7910     MOVE X'2020233030303037363534' TO DFHEIV0(25:11)
  7911     CALL 'kxdfhei1' USING DFHEIV0,
  7912           FILE-ID-ERPNDB,
  7913           DFHEIV20,
  7914           DFHEIV99,
  7915           PI-SAV-ENDING-ERPNDB-KEY,
  7916           DFHEIV99,
  7917           DFHEIV99,
  7918           DFHEIV99
  7919     SET ADDRESS OF PENDING-BUSINESS TO
  7920         DFHEIV20
  7921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7922
  7923     IF PB-COMPANY-CD  = PI-SAV-COMP-CD  AND
  7924        PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  7925         NEXT SENTENCE
  7926     ELSE
  7927         GO TO 2120-END-FILE.
  7928     IF PB-BATCH-TRAILER
  7929         GO TO 2120-END-FILE.
  7930     IF PB-ISSUE
  7931         MOVE VP630B             TO PI-MAP-NAME
  7932         MOVE AL-SANOF           TO BDELHDGA
  7933         PERFORM 7000-FORMAT-ISSUE-SCREEN THRU 7090-EXIT
  7934     ELSE
  7935         MOVE VP630C             TO PI-MAP-NAME
  7936         MOVE AL-SANOF           TO CDELHDGA
  7937         PERFORM 7100-FORMAT-CANCEL-SCREEN THRU 7190-EXIT.
  7938 2110-SEND-MAP.
  7939     GO TO 8100-SEND-INITIAL-MAP.
  7940 2120-END-FILE.
  7941     MOVE ER-2431                TO EMI-ERROR.
  7942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 152
* VP6301.cbl
  7943     MOVE ER-0000                TO EMI-ERROR.
  7944     MOVE ZEROS                  TO PI-SAV-BATCH-SEQ.
  7945     GO TO 2000-BROWSE-FWD.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 153
* VP6301.cbl
  7947 3000-CONTINUE-ENTRY.
  7948     MOVE PI-SAV-ENDING-ERPNDB-KEY TO ERPNDB-KEY.
  7949
  7950* EXEC CICS HANDLE CONDITION
  7951*        NOTFND (3300-REC-NOT-FND)
  7952*    END-EXEC.
  7953*    MOVE '"$I                   ! & #00007685' TO DFHEIV0
  7954     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7956     MOVE X'2620233030303037363835' TO DFHEIV0(25:11)
  7957     CALL 'kxdfhei1' USING DFHEIV0
  7958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7959
  7960
  7961* EXEC CICS STARTBR
  7962*        DATASET (FILE-ID-ERPNDB)
  7963*        RIDFLD  (ERPNDB-KEY)
  7964*        GTEQ
  7965*    END-EXEC.
  7966     MOVE 0
  7967       TO DFHEIV11
  7968*    MOVE '&,         G          &   #00007688' TO DFHEIV0
  7969     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7970     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7971     MOVE X'2020233030303037363838' TO DFHEIV0(25:11)
  7972     CALL 'kxdfhei1' USING DFHEIV0,
  7973           FILE-ID-ERPNDB,
  7974           ERPNDB-KEY,
  7975           DFHEIV99,
  7976           DFHEIV11,
  7977           DFHEIV99
  7978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7979
  7980 3100-READ-LOOP.
  7981
  7982* EXEC CICS HANDLE CONDITION
  7983*        ENDFILE (3200-END-BROWSE)
  7984*    END-EXEC.
  7985*    MOVE '"$''                   ! '' #00007694' TO DFHEIV0
  7986     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7987     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7988     MOVE X'2720233030303037363934' TO DFHEIV0(25:11)
  7989     CALL 'kxdfhei1' USING DFHEIV0
  7990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7991
  7992
  7993* EXEC CICS READNEXT
  7994*        SET     (ADDRESS OF PENDING-BUSINESS)
  7995*        DATASET (FILE-ID-ERPNDB)
  7996*        RIDFLD  (ERPNDB-KEY)
  7997*    END-EXEC.
  7998     MOVE 0
  7999       TO DFHEIV11
  8000*    MOVE '&.S                   )   #00007697' TO DFHEIV0
  8001     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8002     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8003     MOVE X'2020233030303037363937' TO DFHEIV0(25:11)
  8004     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 154
* VP6301.cbl
  8005           FILE-ID-ERPNDB,
  8006           DFHEIV20,
  8007           DFHEIV99,
  8008           ERPNDB-KEY,
  8009           DFHEIV99,
  8010           DFHEIV11,
  8011           DFHEIV99,
  8012           DFHEIV99
  8013     SET ADDRESS OF PENDING-BUSINESS TO
  8014         DFHEIV20
  8015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8016
  8017     IF PB-COMPANY-CD  = PI-SAV-COMP-CD   AND
  8018        PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  8019         NEXT SENTENCE
  8020     ELSE
  8021         GO TO 3200-END-BROWSE.
  8022     IF NOT PB-BATCH-TRAILER
  8023         GO TO 3110-NOT-BATCH-TRAILER.
  8024 3105-PRIME-PI-COUNTS.
  8025     IF PI-LF-ISS-REMITTED = ZEROS
  8026         MOVE PB-B-LF-ISS-PRM-REMITTED  TO PI-LF-ISS-REMITTED.
  8027     IF PI-AH-ISS-REMITTED = ZEROS
  8028         MOVE PB-B-AH-ISS-PRM-REMITTED  TO PI-AH-ISS-REMITTED.
  8029     IF PI-ISS-CNT-REMITTED = ZEROS
  8030         MOVE PB-B-ISSUE-CNT-REMITTED   TO PI-ISS-CNT-REMITTED.
  8031     IF PI-CAN-CNT-REMITTED = ZEROS
  8032         MOVE PB-B-CANCEL-CNT-REMITTED  TO PI-CAN-CNT-REMITTED.
  8033     IF PI-LF-CAN-REMITTED = ZEROS
  8034         MOVE PB-B-LF-CAN-PRM-REMITTED  TO PI-LF-CAN-REMITTED.
  8035     IF PI-AH-CAN-REMITTED = ZEROS
  8036         MOVE PB-B-AH-CAN-PRM-REMITTED  TO PI-AH-CAN-REMITTED.
  8037     GO TO 3200-END-BROWSE.
  8038 3110-NOT-BATCH-TRAILER.
  8039     IF PB-ISSUE
  8040         ADD PB-I-LF-PREMIUM-AMT     TO PI-LF-ISS-ENTERED
  8041         ADD PB-I-LF-ALT-PREMIUM-AMT TO PI-LF-ISS-ENTERED
  8042         ADD PB-I-AH-PREMIUM-AMT     TO PI-AH-ISS-ENTERED
  8043         ADD +1                      TO PI-ISS-CNT-ENTERED
  8044     ELSE
  8045         ADD PB-C-LF-CANCEL-AMT      TO PI-LF-CAN-ENTERED
  8046         ADD PB-C-AH-CANCEL-AMT      TO PI-AH-CAN-ENTERED
  8047         ADD +1                      TO PI-CAN-CNT-ENTERED.
  8048     MOVE PB-BATCH-SEQ-NO            TO PI-LAST-SEQ-NO-ADDED
  8049                                        PI-SAV-BATCH-SEQ.
  8050     GO TO 3100-READ-LOOP.
  8051 3200-END-BROWSE.
  8052
  8053* EXEC CICS ENDBR
  8054*        DATASET (FILE-ID-ERPNDB)
  8055*    END-EXEC.
  8056     MOVE 0
  8057       TO DFHEIV11
  8058*    MOVE '&2                    $   #00007737' TO DFHEIV0
  8059     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8060     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8061     MOVE X'2020233030303037373337' TO DFHEIV0(25:11)
  8062     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 155
* VP6301.cbl
  8063           FILE-ID-ERPNDB,
  8064           DFHEIV11,
  8065           DFHEIV99
  8066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8067
  8068     ADD +1                         PI-LAST-SEQ-NO-ADDED
  8069                            GIVING PI-NEXT-DISPLAY-SEQ-NO.
  8070     IF PI-MAINT-FUNC = 'B'
  8071         MOVE ZEROS              TO PI-SAV-BATCH-SEQ
  8072         GO TO 2000-BROWSE-FWD
  8073     ELSE
  8074         ADD +1                  TO PI-SAV-BATCH-SEQ.
  8075     IF PI-LF-ISS-REMITTED  = ZEROS  AND
  8076        PI-AH-ISS-REMITTED  = ZEROS  AND
  8077        PI-LF-CAN-REMITTED  = ZEROS  AND
  8078        PI-AH-CAN-REMITTED  = ZEROS  AND
  8079        PI-ISS-CNT-REMITTED = ZEROS  AND
  8080        PI-CAN-CNT-REMITTED = ZEROS
  8081         MOVE  VP630B            TO PI-MAP-NAME
  8082     ELSE
  8083         IF PI-LF-ISS-REMITTED  = ZEROS AND
  8084            PI-AH-ISS-REMITTED  = ZEROS AND
  8085            PI-ISS-CNT-REMITTED = ZEROS
  8086             MOVE  VP630C        TO PI-MAP-NAME
  8087         ELSE
  8088             MOVE  VP630B        TO PI-MAP-NAME.
  8089     IF PI-MAP-NAME = VP630B
  8090         PERFORM 8550-SET-MAP-SEQ-NOS
  8091     ELSE
  8092         PERFORM 8550-SET-MAP-SEQ-NOS
  8093                 VARYING WS-SUB2 FROM +1 BY +1
  8094                 UNTIL WS-SUB2 GREATER +4.
  8095     GO TO 8100-SEND-INITIAL-MAP.
  8096 3300-REC-NOT-FND.
  8097     MOVE ER-2212                TO EMI-ERROR.
  8098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8099     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 156
* VP6301.cbl
  8101 4000-BUILD-ISSUE-RECORD.
  8102     IF BSEQ  GREATER PI-LAST-SEQ-NO-ADDED
  8103         GO TO 4100-ADD-ISSUE-RECORD.
  8104******************************************************************
  8105*   THE DATA ENTRY SYSTEM ALLOWS BROWSING OF THE CURRENT BUS.    *
  8106*   FILE. THE DATA ENTRY SYS. DOES NOT HAVE A MAINT. FUNCTION.   *
  8107*   THE PROGRAM ASSUMES THAT IF A MATCH ON THE READ FOR UPDATE   *
  8108*   IS SUCCESSFUL, THE RECORD HAS PREVIOUSLY BEEN DISPLAYED      *
  8109*   THRUOUGH A BROWSE.  CHANGES ARE APPLIED AND THE PB-RECORD IS *
  8110*   REWRITTEN, ELSE A NEW PENDING BUS. RECORD IS ADDED.          *
  8111******************************************************************
  8112     MOVE PI-COMPANY-CD          TO ERPNDB-COMP-CD.
  8113     MOVE PI-SAV-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH.
  8114     MOVE BSEQ                   TO ERPNDB-BATCH-SEQ.
  8115
  8116* EXEC CICS HANDLE CONDITION
  8117*        NOTFND (4100-ADD-ISSUE-RECORD)
  8118*    END-EXEC.
  8119*    MOVE '"$I                   ! ( #00007787' TO DFHEIV0
  8120     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8122     MOVE X'2820233030303037373837' TO DFHEIV0(25:11)
  8123     CALL 'kxdfhei1' USING DFHEIV0
  8124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8125
  8126
  8127* EXEC CICS READ
  8128*        SET     (ADDRESS OF PENDING-BUSINESS)
  8129*        DATASET (FILE-ID-ERPNDB)
  8130*        RIDFLD  (ERPNDB-KEY)
  8131*        UPDATE
  8132*    END-EXEC.
  8133*    MOVE '&"S        EU         (   #00007790' TO DFHEIV0
  8134     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8135     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8136     MOVE X'2020233030303037373930' TO DFHEIV0(25:11)
  8137     CALL 'kxdfhei1' USING DFHEIV0,
  8138           FILE-ID-ERPNDB,
  8139           DFHEIV20,
  8140           DFHEIV99,
  8141           ERPNDB-KEY,
  8142           DFHEIV99,
  8143           DFHEIV99,
  8144           DFHEIV99
  8145     SET ADDRESS OF PENDING-BUSINESS TO
  8146         DFHEIV20
  8147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8148
  8149     MOVE PB-CONTROL-PRIMARY     TO ERPNDM-KEY.
  8150     MOVE 'B'                    TO JP-RECORD-TYPE
  8151     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  8152     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  8153     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  8154     PERFORM 8400-LOG-JOURNAL-RECORD.
  8155     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8156     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8157     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  8158     IF BLAST-NAME-LEN GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 157
* VP6301.cbl
  8159         MOVE BLAST-NAME         TO PB-I-INSURED-LAST-NAME.
  8160     IF B1ST-NAME-LEN GREATER ZEROS
  8161         MOVE B1ST-NAME          TO PB-I-INSURED-FIRST-NAME.
  8162     IF BINIT-LEN     GREATER ZEROS
  8163         MOVE BINIT              TO PB-I-INSURED-MIDDLE-INIT.
  8164     IF BAGE-LEN      GREATER ZEROS
  8165         MOVE WS-BAGE            TO PB-I-AGE.
  8166     IF BJNT-AGE-LEN  GREATER ZEROS
  8167         MOVE WS-BJNT-AGE        TO PB-I-JOINT-AGE.
  8168     IF BSEX-LEN      GREATER ZEROS
  8169         MOVE BSEX               TO PB-I-INSURED-SEX.
  8170     IF BTERM1-LEN > ZEROS
  8171        MOVE WS-BTERM1           TO PB-I-LF-TERM.
  8172     IF BTERM2-LEN > ZEROS
  8173        MOVE WS-BTERM2             TO PB-I-AH-TERM.
  8174******************************************************************
  8175*          IF BTYPE = ZEROS DELETE LIFE COVERAGE.                *
  8176*                                                                *
  8177*          IF BTYPE = SPACES ZERO OUT BENEFIT CODE.              *
  8178******************************************************************
  8179     IF BTYPE1-LEN > ZEROS
  8180        IF BTYPE1           NOT = SPACES AND ZEROS
  8181           MOVE BTYPE1            TO PB-I-LF-INPUT-CD
  8182           MOVE WS-EDITED-LF-CODE TO PB-I-LIFE-BENEFIT-CD
  8183           MOVE WS-LF-ABBR-DESC   TO PB-I-LF-ABBR
  8184        ELSE
  8185           IF BTYPE1      = SPACES
  8186              MOVE SPACES         TO PB-I-LF-INPUT-CD
  8187                                     PB-I-LF-ABBR
  8188              MOVE ZEROS          TO PB-I-LIFE-BENEFIT-CD
  8189           ELSE
  8190              SUBTRACT PB-I-LF-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8191              SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
  8192                       PI-LF-ISS-ENTERED
  8193              MOVE SPACES         TO PB-I-LF-INPUT-CD
  8194                                     PB-I-LF-ABBR
  8195              MOVE ZEROS          TO PB-I-LF-TERM
  8196                                     PB-I-LF-BENEFIT-AMT
  8197                                     PB-I-LF-PREMIUM-AMT
  8198                                     PB-I-LF-BENEFIT-CD
  8199                                     PB-I-LF-PREM-CALC
  8200                                     PB-I-LF-ALT-BENEFIT-AMT
  8201                                     PB-I-LF-ALT-PREMIUM-AMT
  8202                                     PB-I-LF-CRIT-PER
  8203              MOVE LOW-VALUES     TO PB-I-LF-EXPIRE-DT.
  8204     IF  BBENE1-LEN > ZEROS
  8205         MOVE WS-BBEN1           TO PB-I-LF-BENEFIT-AMT.
  8206     IF  BALT-BEN1-LEN > ZEROS
  8207         MOVE WS-BALT-BEN1          TO PB-I-LF-ALT-BENEFIT-AMT.
  8208     IF  BPREM1-LEN > ZEROS
  8209         IF WS-BPREM1       = WS-ALL-NINES OR
  8210            WS-BPREM1       GREATER WS-ALL-NINES
  8211            SUBTRACT PB-I-LF-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8212            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
  8213            MOVE '?'             TO PB-I-LF-CALC-FLAG
  8214         ELSE
  8215            SUBTRACT PB-I-LF-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8216            MOVE WS-BPREM1       TO PB-I-LF-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 158
* VP6301.cbl
  8217            ADD  WS-BPREM1       TO PI-LF-ISS-ENTERED
  8218            MOVE SPACE           TO PB-I-LF-CALC-FLAG.
  8219     IF  BALT-PREM1-LEN > ZEROS
  8220         SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8221         MOVE WS-BALT-PREM1      TO PB-I-LF-ALT-PREMIUM-AMT
  8222         ADD  WS-BALT-PREM1      TO PI-LF-ISS-ENTERED.
  8223     IF  BALT-PREM2-LEN > ZEROS
  8224         MOVE WS-BALT-PREM2      TO PB-I-TOT-FEES
  8225     END-IF
  8226******************************************************************
  8227*          IF BTYPE = ZEROS DELETE A&H COVERAGE.                 *
  8228*                                                                *
  8229*          IF BTYPE = SPACES ZERO OUT BENEFIT CODE.              *
  8230******************************************************************
  8231     IF BTYPE2-LEN > ZEROS
  8232        IF BTYPE2           NOT = SPACES AND ZEROS
  8233           MOVE BTYPE2            TO PB-I-AH-INPUT-CD
  8234           MOVE WS-EDITED-LF-CODE TO PB-I-AH-BENEFIT-CD
  8235           MOVE WS-LF-ABBR-DESC   TO PB-I-AH-ABBR
  8236        ELSE
  8237           IF BTYPE2      = SPACES
  8238              MOVE SPACES         TO PB-I-AH-INPUT-CD
  8239                                     PB-I-AH-ABBR
  8240              MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
  8241           ELSE
  8242              SUBTRACT PB-I-AH-PREMIUM-AMT FROM PI-AH-ISS-ENTERED
  8243              MOVE SPACES         TO PB-I-AH-INPUT-CD
  8244                                     PB-I-AH-ABBR
  8245              MOVE ZEROS          TO PB-I-AH-TERM
  8246                                     PB-I-AH-BENEFIT-AMT
  8247                                     PB-I-AH-PREMIUM-AMT
  8248                                     PB-I-AH-BENEFIT-CD
  8249                                     PB-I-AH-PREM-CALC
  8250                                     PB-I-AH-CRIT-PER
  8251                                     PB-I-TOT-FEES
  8252                                     PB-I-TOT-FEES-CALC
  8253              MOVE LOW-VALUES     TO PB-I-AH-EXPIRE-DT.
  8254     IF  BBENE2-LEN > ZEROS
  8255         MOVE WS-BBEN2           TO PB-I-AH-BENEFIT-AMT.
  8256     IF  BPREM2-LEN > ZEROS
  8257         IF WS-BPREM2       = WS-ALL-NINES OR
  8258            WS-BPREM2       GREATER WS-ALL-NINES
  8259            SUBTRACT PB-I-AH-PREMIUM-AMT FROM PI-AH-ISS-ENTERED
  8260            MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT
  8261            MOVE '?'                TO PB-I-AH-CALC-FLAG
  8262         ELSE
  8263            SUBTRACT PB-I-AH-PREMIUM-AMT FROM PI-AH-ISS-ENTERED
  8264            MOVE WS-BPREM2       TO PB-I-AH-PREMIUM-AMT
  8265            ADD  WS-BPREM2       TO PI-AH-ISS-ENTERED
  8266            MOVE SPACE           TO PB-I-AH-CALC-FLAG.
  8267     MOVE ZEROS                  TO PB-I-LF-CRIT-PER
  8268     IF BCRIT-PERD2-LEN > ZEROS
  8269        MOVE WS-BCRIT-PERD2       TO PB-I-AH-CRIT-PER.
  8270     IF BLN-OFFICER-LEN  GREATER ZEROS
  8271         MOVE BLN-OFFICER        TO PB-I-LOAN-OFFICER.
  8272     IF PB-1ST-PMT-DT-PROCESSING
  8273        IF PB-I-1ST-PMT-DT = LOW-VALUES
  8274           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 159
* VP6301.cbl
  8275     IF BVIN-LEN > ZEROS
  8276        MOVE BVIN-NOI            TO PB-I-VIN
  8277     END-IF
  8278     IF BJNT-1ST-NAME-LEN   GREATER ZEROS
  8279         MOVE BJNT-1ST-NAME      TO PB-I-JOINT-FIRST-NAME.
  8280     IF BJNT-INIT-LEN       GREATER ZEROS
  8281         MOVE BJNT-INIT          TO PB-I-JOINT-MIDDLE-INIT.
  8282     IF BJNT-LST-NAME-LEN   GREATER ZEROS
  8283         MOVE BJNT-LST-NAME      TO PB-I-JOINT-LAST-NAME.
  8284     IF BBENEFICIARY-LEN    GREATER ZEROS
  8285         MOVE BBENEFICIARY       TO PB-I-BENEFICIARY-NAME.
  8286     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
  8287     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
  8288     IF PI-MAIL-YES
  8289        MOVE '1'                 TO PB-I-MAIL-ADDRS-SW.
  8290     MOVE 'C'                    TO JP-RECORD-TYPE.
  8291     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  8292     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  8293     move pb-control-by-account  to elcrtt-key
  8294
  8295* EXEC CICS REWRITE
  8296*        DATASET (FILE-ID-ERPNDB)
  8297*        FROM    (PENDING-BUSINESS)
  8298*    END-EXEC.
  8299     MOVE LENGTH OF
  8300      PENDING-BUSINESS
  8301       TO DFHEIV11
  8302*    MOVE '&& L                  %   #00007941' TO DFHEIV0
  8303     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8304     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8305     MOVE X'2020233030303037393431' TO DFHEIV0(25:11)
  8306     CALL 'kxdfhei1' USING DFHEIV0,
  8307           FILE-ID-ERPNDB,
  8308           PENDING-BUSINESS,
  8309           DFHEIV11,
  8310           DFHEIV99
  8311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8312
  8313     MOVE ERPNDB-KEY             TO PI-SAV-ENDING-ERPNDB-KEY.
  8314     PERFORM 8400-LOG-JOURNAL-RECORD.
  8315     IF EIBAID = DFHENTER
  8316         MOVE PI-NEXT-DISPLAY-SEQ-NO TO BSEQ
  8317         ADD +1                      TO PI-NEXT-DISPLAY-SEQ-NO
  8318         MOVE AL-SABON               TO BSEQ-ATTRB.
  8319     if (byear-len      <> zeros)
  8320        or (bmake-len   <> zeros)
  8321        or (bmodel-len  <> zeros)
  8322        or (bometer-len <> zeros)
  8323        move 'C'                 to elcrtt-trlr-type
  8324        perform 4910-read-elcrtt-update
  8325                                 thru 4910-exit
  8326        if resp-normal
  8327           perform 4920-rewrite-elcrtt
  8328                                 thru 4920-exit
  8329        else
  8330           if resp-notfnd
  8331              perform 4930-write-elcrtt
  8332                                 thru 4930-exit
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 160
* VP6301.cbl
  8333           end-if
  8334        end-if
  8335     end-if
  8336     IF PI-MAIL-YES
  8337        NEXT SENTENCE
  8338     ELSE
  8339        GO TO 4900-EXIT.
  8340     IF BLAST-NAME-LEN = ZEROS AND
  8341        B1ST-NAME-LEN  = ZEROS AND
  8342        BINIT-LEN      = ZEROS AND
  8343        BADDRS1-LEN    = ZEROS AND
  8344        BADDRS2-LEN    = ZEROS AND
  8345        BCITY-LEN      = ZEROS AND
  8346        BSTATE-LEN     = ZEROS AND
  8347        BZIPCDE-LEN    = ZEROS AND
  8348        BBENEFICIARY-LEN = ZEROS AND
  8349        BCADDR1-LEN    = ZEROS AND
  8350        BCADDR2-LEN    = ZEROS AND
  8351        BCCITY-LEN     = ZEROS AND
  8352        BCSTATE-LEN    = ZEROS AND
  8353        BCZIPCD-LEN    = ZEROS
  8354        GO TO 4900-EXIT.
  8355
  8356* EXEC CICS HANDLE CONDITION
  8357*        NOTFND (4185-ADD-MAILING-RECORD)
  8358*    END-EXEC.
  8359*    MOVE '"$I                   ! ) #00007987' TO DFHEIV0
  8360     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8362     MOVE X'2920233030303037393837' TO DFHEIV0(25:11)
  8363     CALL 'kxdfhei1' USING DFHEIV0
  8364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8365
  8366
  8367* EXEC CICS READ
  8368*        SET     (ADDRESS OF PENDING-MAILING-DATA)
  8369*        DATASET (FILE-ID-ERPNDM)
  8370*        RIDFLD  (ERPNDM-KEY)
  8371*        UPDATE
  8372*    END-EXEC.
  8373*    MOVE '&"S        EU         (   #00007990' TO DFHEIV0
  8374     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8375     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8376     MOVE X'2020233030303037393930' TO DFHEIV0(25:11)
  8377     CALL 'kxdfhei1' USING DFHEIV0,
  8378           FILE-ID-ERPNDM,
  8379           DFHEIV20,
  8380           DFHEIV99,
  8381           ERPNDM-KEY,
  8382           DFHEIV99,
  8383           DFHEIV99,
  8384           DFHEIV99
  8385     SET ADDRESS OF PENDING-MAILING-DATA TO
  8386         DFHEIV20
  8387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8388
  8389     MOVE 'B'                    TO JP-RECORD-TYPE.
  8390     MOVE PENDING-MAILING-DATA   TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 161
* VP6301.cbl
  8391     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  8392     MOVE FILE-ID-ERPNDM         TO JP-FILE-ID.
  8393     PERFORM 8400-LOG-JOURNAL-RECORD.
  8394     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
  8395     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
  8396     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
  8397     IF BLAST-NAME-LEN      GREATER ZEROS
  8398         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  8399     IF B1ST-NAME-LEN       GREATER ZEROS
  8400         MOVE B1ST-NAME          TO PM-INSURED-FIRST-NAME.
  8401     IF BINIT-LEN           GREATER ZEROS
  8402         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  8403     IF BAGE-LEN            GREATER ZEROS
  8404         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
  8405     IF BLAST-NAME-LEN      GREATER ZEROS
  8406         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  8407     IF BINIT-LEN           GREATER ZEROS
  8408         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  8409     IF BADDRS1-LEN         GREATER ZERO
  8410         MOVE BADDRS1            TO PM-ADDRESS-LINE-1.
  8411     IF BADDRS2-LEN         GREATER ZERO
  8412         MOVE BADDRS2            TO PM-ADDRESS-LINE-2.
  8413     IF BCITY-LEN > 0
  8414        MOVE BCITY               TO PM-CITY
  8415     END-IF
  8416     IF BSTATE-LEN > 0
  8417        MOVE BSTATE              TO PM-STATE
  8418     END-IF
  8419     IF BZIPCDE-LEN GREATER ZEROS
  8420        MOVE BZIPCDE             TO WS-ZIP-CODE
  8421     ELSE
  8422        GO TO 4010-CRED-BENE
  8423     END-IF
  8424     IF WS-CANADIAN-ZIP
  8425        IF WS-ZIP-4 = SPACE  OR  '-'
  8426           MOVE WS-ZIP-CAN-2-POST1   TO PM-CAN-POST1
  8427           MOVE WS-ZIP-CAN-2-POST2   TO PM-CAN-POST2
  8428        ELSE
  8429           MOVE WS-ZIP-CAN-1-POST1   TO PM-CAN-POST1
  8430           MOVE WS-ZIP-CAN-1-POST2   TO PM-CAN-POST2
  8431        END-IF
  8432     ELSE
  8433        IF WS-ZIP-6 = SPACE  OR  '-'
  8434           MOVE WS-ZIP-AM-2-CODE     TO PM-ZIP-CODE
  8435           MOVE WS-ZIP-AM-2-PLUS4    TO PM-ZIP-PLUS4
  8436        ELSE
  8437           MOVE WS-ZIP-AM-1-CODE     TO PM-ZIP-CODE
  8438           MOVE WS-ZIP-AM-1-PLUS4    TO PM-ZIP-PLUS4
  8439        END-IF
  8440     END-IF
  8441     .
  8442 4010-CRED-BENE.
  8443     IF BBENEFICIARY-LEN > ZEROS
  8444        MOVE BBENEFICIARY        TO PM-CRED-BENE-NAME
  8445     END-IF
  8446     IF BCADDR1-LEN > ZEROS
  8447        MOVE BCADDR1             TO PM-CRED-BENE-ADDR
  8448     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 162
* VP6301.cbl
  8449     IF BCADDR2-LEN > ZEROS
  8450        MOVE BCADDR2             TO PM-CRED-BENE-ADDR2
  8451     END-IF
  8452     IF BCCITY-LEN > ZEROS
  8453        MOVE BCCITY              TO PM-CRED-BENE-CITY
  8454     END-IF
  8455     IF BCSTATE-LEN > ZEROS
  8456        MOVE BCSTATE             TO PM-CRED-BENE-STATE
  8457     END-IF
  8458     IF BCZIPCD-LEN > ZEROS
  8459        MOVE BCZIPCD             TO WS-ZIP-CODE
  8460     ELSE
  8461        GO TO 4010-CONTINUE
  8462     END-IF
  8463     IF WS-CANADIAN-ZIP
  8464        IF WS-ZIP-4 = SPACE  OR  '-'
  8465           MOVE WS-ZIP-CAN-2-POST1   TO PM-CB-CAN-POST1
  8466           MOVE WS-ZIP-CAN-2-POST2   TO PM-CB-CAN-POST2
  8467        ELSE
  8468           MOVE WS-ZIP-CAN-1-POST1   TO PM-CB-CAN-POST1
  8469           MOVE WS-ZIP-CAN-1-POST2   TO PM-CB-CAN-POST2
  8470        END-IF
  8471     ELSE
  8472        IF WS-ZIP-6 = SPACE  OR  '-'
  8473           MOVE WS-ZIP-AM-2-CODE     TO PM-CB-ZIP-CODE
  8474           MOVE WS-ZIP-AM-2-PLUS4    TO PM-CB-ZIP-PLUS4
  8475        ELSE
  8476           MOVE WS-ZIP-AM-1-CODE     TO PM-CB-ZIP-CODE
  8477           MOVE WS-ZIP-AM-1-PLUS4    TO PM-CB-ZIP-PLUS4
  8478        END-IF
  8479     END-IF
  8480     .
  8481 4010-CONTINUE.
  8482     MOVE 'C'                    TO JP-RECORD-TYPE.
  8483     MOVE PENDING-MAILING-DATA   TO JP-RECORD-AREA.
  8484     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  8485     MOVE FILE-ID-ERPNDM         TO JP-FILE-ID.
  8486
  8487* EXEC CICS REWRITE
  8488*        DATASET (FILE-ID-ERPNDM)
  8489*        FROM    (PENDING-MAILING-DATA)
  8490*    END-EXEC.
  8491     MOVE LENGTH OF
  8492      PENDING-MAILING-DATA
  8493       TO DFHEIV11
  8494*    MOVE '&& L                  %   #00008093' TO DFHEIV0
  8495     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8496     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8497     MOVE X'2020233030303038303933' TO DFHEIV0(25:11)
  8498     CALL 'kxdfhei1' USING DFHEIV0,
  8499           FILE-ID-ERPNDM,
  8500           PENDING-MAILING-DATA,
  8501           DFHEIV11,
  8502           DFHEIV99
  8503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8504
  8505     PERFORM 8400-LOG-JOURNAL-RECORD.
  8506     GO TO 4900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 163
* VP6301.cbl
  8508 4100-ADD-ISSUE-RECORD.
  8509
  8510* EXEC CICS GETMAIN
  8511*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
  8512*        LENGTH  (ELCRTT-RECORD-LENGTH)
  8513*        INITIMG (GETMAIN-SPACE)
  8514*    END-EXEC
  8515*    MOVE ',"IL                  $   #00008101' TO DFHEIV0
  8516     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8517     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8518     MOVE X'2020233030303038313031' TO DFHEIV0(25:11)
  8519     CALL 'kxdfhei1' USING DFHEIV0,
  8520           DFHEIV20,
  8521           ELCRTT-RECORD-LENGTH,
  8522           GETMAIN-SPACE
  8523     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8524         DFHEIV20
  8525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8526
  8527* EXEC CICS GETMAIN
  8528*        SET     (ADDRESS OF PENDING-BUSINESS)
  8529*        LENGTH  (ERPNDB-RECORD-LENGTH)
  8530*        INITIMG (GETMAIN-SPACE)
  8531*    END-EXEC.
  8532*    MOVE ',"IL                  $   #00008106' TO DFHEIV0
  8533     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8534     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8535     MOVE X'2020233030303038313036' TO DFHEIV0(25:11)
  8536     CALL 'kxdfhei1' USING DFHEIV0,
  8537           DFHEIV20,
  8538           ERPNDB-RECORD-LENGTH,
  8539           GETMAIN-SPACE
  8540     SET ADDRESS OF PENDING-BUSINESS TO
  8541         DFHEIV20
  8542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8543
  8544     MOVE 'PB'                   TO PB-RECORD-ID.
  8545     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  8546                                    PB-COMPANY-CD-A1.
  8547     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  8548     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH.
  8549     MOVE BSEQ                   TO PB-BATCH-SEQ-NO.
  8550     IF BSEQ   GREATER PI-LAST-SEQ-NO-ADDED
  8551         MOVE BSEQ          TO PI-LAST-SEQ-NO-ADDED.
  8552     MOVE PI-SAV-CARRIER         TO PB-CARRIER.
  8553     MOVE PI-SAV-GROUPING        TO PB-GROUPING.
  8554     MOVE PI-SAV-STATE           TO PB-STATE.
  8555     MOVE PI-SAV-ACCOUNT         TO PB-ACCOUNT.
  8556     MOVE '1'                    TO PB-RECORD-TYPE.
  8557     MOVE BCERT                  TO PB-CERT-PRIME.
  8558     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
  8559     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  8560                                    PB-ALT-CHG-SEQ-NO.
  8561     MOVE +0                     TO PB-NO-OF-ERRORS.
  8562     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  8563     MOVE ZEROS                  TO PB-I-LOAN-TERM
  8564                                    PB-I-LF-POLICY-FEE
  8565                                    PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 164
* VP6301.cbl
  8566                                    PB-I-LF-ALT-PREM-CALC
  8567                                    PB-I-LF-RATE
  8568                                    PB-I-LF-ALT-RATE
  8569                                    PB-I-LF-REI-RATE
  8570                                    PB-I-LF-ALT-REI-RATE
  8571                                    PB-I-RATE-DEV-PCT-LF
  8572                                    PB-I-cancel-fee
  8573                                    PB-I-AH-PREM-CALC
  8574                                    PB-I-TOT-FEES
  8575                                    PB-I-TOT-FEES-CALC
  8576                                    PB-I-AH-RATE
  8577                                    PB-I-AH-REI-RATE
  8578                                    PB-I-AH-RATE-TRM
  8579                                    PB-I-RATE-DEV-PCT-AH
  8580                                    PB-I-BUSINESS-TYPE
  8581                                    PB-I-LIFE-COMMISSION
  8582                                    PB-I-JOINT-COMMISSION
  8583                                    PB-I-AH-COMMISSION
  8584                                    PB-I-CURR-SEQ
  8585                                    PB-CHG-COUNT
  8586                                    PB-LF-BILLED-AMTS
  8587                                    PB-AH-BILLED-AMTS
  8588                                    PB-CALC-TOLERANCE
  8589                                    PB-I-EXTENTION-DAYS
  8590*                                   PB-I-MICROFILM-NO
  8591                                    PB-I-TERM-IN-DAYS
  8592                                    PB-I-STATE-TAX
  8593                                    PB-I-MUNI-TAX
  8594                                    PB-I-NUM-BILLED
  8595                                    pb-i-loan-apr.
  8596     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  8597                                    PB-I-LF-EXPIRE-DT
  8598                                    PB-I-AH-EXPIRE-DT
  8599                                    PB-I-1ST-PMT-DT
  8600                                    PB-BILLED-DT
  8601                                    PB-ACCT-EFF-DT
  8602                                    PB-ACCT-EXP-DT.
  8603     MOVE 'X'                    TO PB-FATAL-FLAG.
  8604     IF PI-MAIL-YES
  8605        MOVE '1'                 TO PB-I-MAIL-ADDRS-SW.
  8606     IF PI-NB-MONTH-END-DT NOT = SPACES
  8607        MOVE PI-NB-MONTH-END-DT  TO PB-CREDIT-SELECT-DT
  8608       ELSE
  8609        MOVE PI-CR-MONTH-END-DT     TO PB-CREDIT-SELECT-DT.
  8610     IF BSFX-LEN            GREATER ZEROS
  8611         MOVE BSFX               TO PB-CERT-SFX.
  8612     IF BLAST-NAME-LEN      GREATER ZEROS
  8613         MOVE BLAST-NAME         TO PB-I-INSURED-LAST-NAME.
  8614     IF B1ST-NAME-LEN       GREATER ZEROS
  8615         MOVE B1ST-NAME          TO PB-I-INSURED-FIRST-NAME.
  8616     IF BINIT-LEN           GREATER ZEROS
  8617         MOVE BINIT              TO PB-I-INSURED-MIDDLE-INIT.
  8618     IF BAGE-LEN            GREATER ZEROS
  8619         MOVE WS-BAGE            TO PB-I-AGE
  8620     ELSE
  8621         MOVE ZEROS              TO PB-I-AGE.
  8622     IF BJNT-AGE-LEN        GREATER ZEROS
  8623         MOVE WS-BJNT-AGE        TO PB-I-JOINT-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 165
* VP6301.cbl
  8624     ELSE
  8625         MOVE ZEROS              TO PB-I-JOINT-AGE.
  8626         MOVE LOW-VALUES          TO PB-I-BIRTHDAY.
  8627        MOVE LOW-VALUES          TO PB-I-JOINT-BIRTHDAY
  8628     IF BSEX-LEN            GREATER ZEROS
  8629         MOVE BSEX               TO PB-I-INSURED-SEX.
  8630     IF BTERM1-LEN > ZEROS
  8631        MOVE WS-BTERM1              TO PB-I-LF-TERM
  8632     ELSE
  8633        MOVE ZEROS               TO PB-I-LF-TERM.
  8634     IF BTERM2-LEN > ZEROS
  8635        MOVE WS-BTERM2              TO PB-I-AH-TERM
  8636     ELSE
  8637        MOVE ZEROS              TO PB-I-AH-TERM.
  8638     MOVE ZEROS              TO PB-I-LOAN-TERM.
  8639         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
  8640         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
  8641         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
  8642     IF BTYPE1-LEN > ZEROS
  8643        IF BTYPE1           NOT = ZEROS OR SPACES
  8644           MOVE BTYPE1            TO PB-I-LF-INPUT-CD
  8645           MOVE WS-EDITED-LF-CODE TO PB-I-LIFE-BENEFIT-CD
  8646           MOVE WS-LF-ABBR-DESC   TO PB-I-LF-ABBR
  8647        ELSE
  8648           MOVE ZEROS             TO PB-I-LIFE-BENEFIT-CD
  8649     ELSE
  8650           MOVE ZEROS             TO PB-I-LIFE-BENEFIT-CD.
  8651     IF  BBENE1-LEN > ZEROS
  8652         MOVE WS-BBEN1           TO PB-I-LF-BENEFIT-AMT
  8653     ELSE
  8654         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
  8655     IF  BALT-BEN1-LEN > ZEROS
  8656         MOVE WS-BALT-BEN1       TO PB-I-LF-ALT-BENEFIT-AMT
  8657     ELSE
  8658         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
  8659     IF  BPREM1-LEN > ZEROS
  8660         IF WS-BPREM1      = WS-ALL-NINES OR
  8661            WS-BPREM1      GREATER WS-ALL-NINES
  8662            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
  8663            MOVE '?'             TO PB-I-LF-CALC-FLAG
  8664         ELSE
  8665            ADD  WS-BPREM1       TO PI-LF-ISS-ENTERED
  8666            MOVE WS-BPREM1       TO PB-I-LF-PREMIUM-AMT
  8667     ELSE
  8668         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
  8669     IF  BALT-PREM1-LEN > ZEROS
  8670         MOVE WS-BALT-PREM1      TO PB-I-LF-ALT-PREMIUM-AMT
  8671         ADD  WS-BALT-PREM1      TO PI-LF-ISS-ENTERED
  8672     ELSE
  8673         MOVE ZEROS              TO PB-I-LF-ALT-PREMIUM-AMT.
  8674     IF  BALT-PREM2-LEN > ZEROS
  8675         MOVE WS-BALT-PREM2      TO PB-I-TOT-FEES
  8676     ELSE
  8677         MOVE ZEROS              TO PB-I-TOT-FEES
  8678     END-IF
  8679     IF BTYPE2-LEN > ZEROS
  8680        IF BTYPE2           NOT = ZEROS
  8681           MOVE BTYPE2            TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 166
* VP6301.cbl
  8682           MOVE WS-EDITED-AH-CODE TO PB-I-AH-BENEFIT-CD
  8683           MOVE WS-AH-ABBR-DESC   TO PB-I-AH-ABBR
  8684        ELSE
  8685           MOVE ZEROS             TO PB-I-AH-BENEFIT-CD
  8686     ELSE
  8687           MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
  8688     IF  BBENE2-LEN > ZEROS
  8689         MOVE WS-BBEN2           TO PB-I-AH-BENEFIT-AMT
  8690     ELSE
  8691         MOVE ZEROS              TO PB-I-AH-BENEFIT-AMT.
  8692     IF  BPREM2-LEN > ZEROS
  8693         IF WS-BPREM2      = WS-ALL-NINES OR
  8694            WS-BPREM2      GREATER WS-ALL-NINES
  8695            MOVE ZEROS            TO PB-I-AH-PREMIUM-AMT
  8696            MOVE '?'              TO PB-I-AH-CALC-FLAG
  8697         ELSE
  8698            ADD  WS-BPREM2        TO PI-AH-ISS-ENTERED
  8699            MOVE WS-BPREM2        TO PB-I-AH-PREMIUM-AMT
  8700     ELSE
  8701         MOVE ZEROS               TO PB-I-AH-PREMIUM-AMT.
  8702     IF PB-COMPANY-ID = 'NSL'
  8703     IF PB-I-AGE       GREATER 49   OR
  8704        PB-I-JOINT-AGE GREATER 49
  8705         MOVE 'H'                TO PB-RECORD-BILL
  8706       ELSE
  8707     IF PB-I-LF-BENEFIT-AMT GREATER +14999.99 OR
  8708        PB-I-AH-BENEFIT-AMT GREATER +14999.99
  8709          MOVE 'H'                TO PB-RECORD-BILL.
  8710*    IF BCRIT-PERD-LEN      (1)   GREATER ZEROS
  8711*       MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
  8712*    ELSE
  8713        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
  8714     IF BCRIT-PERD2-LEN > ZEROS
  8715        MOVE WS-BCRIT-PERD2       TO PB-I-AH-CRIT-PER
  8716     ELSE
  8717        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
  8718*    IF BIND-GRP-LEN        GREATER ZEROS
  8719*        MOVE BIND-GRP           TO PB-I-INDV-GRP-OVRD.
  8720*    IF BRTCLS-LEN          GREATER ZEROS
  8721*        MOVE BRTCLS             TO PB-I-RATE-CLASS-OVRD.
  8722*    IF BSIG-LEN            GREATER ZEROS
  8723*        MOVE BSIG               TO PB-I-SIG-SW.
  8724     IF BLN-OFFICER-LEN     GREATER ZEROS
  8725         MOVE BLN-OFFICER        TO PB-I-LOAN-OFFICER.
  8726     MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
  8727     MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
  8728        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
  8729                                    PB-I-EXTENTION-DAYS.
  8730     IF PB-1ST-PMT-DT-PROCESSING
  8731        IF PB-I-1ST-PMT-DT = LOW-VALUES
  8732           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
  8733     IF BVIN-LEN > ZEROS
  8734        MOVE BVIN-NOI            TO PB-I-VIN
  8735     ELSE
  8736        MOVE SPACES              TO PB-I-VIN
  8737     END-IF
  8738     MOVE ZEROS               TO PB-I-LIVES.
  8739     IF BJNT-1ST-NAME-LEN   GREATER ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 167
* VP6301.cbl
  8740         MOVE BJNT-1ST-NAME      TO PB-I-JOINT-FIRST-NAME.
  8741     IF BJNT-INIT-LEN       GREATER ZEROS
  8742         MOVE BJNT-INIT          TO PB-I-JOINT-MIDDLE-INIT.
  8743     IF BJNT-LST-NAME-LEN   GREATER ZEROS
  8744         MOVE BJNT-LST-NAME      TO PB-I-JOINT-LAST-NAME.
  8745     IF BBENEFICIARY-LEN    GREATER ZEROS
  8746         MOVE BBENEFICIARY       TO PB-I-BENEFICIARY-NAME.
  8747     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
  8748     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
  8749 4175-WRITE-PB-RECORD.
  8750     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
  8751                                    PB-INPUT-BY.
  8752     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8753     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  8754                                    PB-INPUT-DT.
  8755     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
  8756     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
  8757     MOVE PI-CSR-ID              TO PB-CSR-ID.
  8758     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  8759     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  8760     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
  8761     MOVE 'A'                    TO JP-RECORD-TYPE.
  8762     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  8763     MOVE PB-CONTROL-PRIMARY     TO PI-SAV-ENDING-ERPNDB-KEY
  8764                                    ERPNDM-KEY.
  8765*    MOVE PI-SAV-REFERENCE       TO PB-I-REFERENCE.
  8766     ADD +1                      TO PI-SAV-BATCH-SEQ.
  8767     move pb-control-by-account  to elcrtt-key
  8768
  8769* EXEC CICS HANDLE CONDITION
  8770*        DUPREC (4200-DUPLICATE-ALT-INDEX)
  8771*    END-EXEC.
  8772*    MOVE '"$%                   ! * #00008335' TO DFHEIV0
  8773     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  8774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8775     MOVE X'2A20233030303038333335' TO DFHEIV0(25:11)
  8776     CALL 'kxdfhei1' USING DFHEIV0
  8777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8778
  8779
  8780* EXEC CICS WRITE
  8781*        DATASET (FILE-ID-ERPNDB)
  8782*        FROM    (PENDING-BUSINESS)
  8783*        RIDFLD  (PB-CONTROL-PRIMARY)
  8784*    END-EXEC.
  8785     MOVE LENGTH OF
  8786      PENDING-BUSINESS
  8787       TO DFHEIV11
  8788*    MOVE '&$ L                  ''   #00008338' TO DFHEIV0
  8789     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8791     MOVE X'2020233030303038333338' TO DFHEIV0(25:11)
  8792     CALL 'kxdfhei1' USING DFHEIV0,
  8793           FILE-ID-ERPNDB,
  8794           PENDING-BUSINESS,
  8795           DFHEIV11,
  8796           PB-CONTROL-PRIMARY,
  8797           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 168
* VP6301.cbl
  8798           DFHEIV99
  8799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8800
  8801     ADD +1                      TO PI-ISS-CNT-ENTERED.
  8802     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  8803     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  8804     PERFORM 8400-LOG-JOURNAL-RECORD.
  8805     MOVE PI-NEXT-DISPLAY-SEQ-NO TO BSEQ.
  8806     MOVE AL-SABON               TO BSEQ-ATTRB.
  8807     ADD +1                      TO PI-NEXT-DISPLAY-SEQ-NO.
  8808     if (byear-len      <> zeros)
  8809        or (bmake-len   <> zeros)
  8810        or (bmodel-len  <> zeros)
  8811        or (bometer-len <> zeros)
  8812        move pb-control-by-account
  8813                                 to elcrtt-key
  8814        move 'C'                 to elcrtt-trlr-type
  8815        perform 4910-read-elcrtt-update
  8816                                 thru 4910-exit
  8817        if resp-normal
  8818           perform 4920-rewrite-elcrtt
  8819                                 thru 4920-exit
  8820        else
  8821           if resp-notfnd
  8822              perform 4930-write-elcrtt
  8823                                 thru 4930-exit
  8824           end-if
  8825        end-if
  8826     end-if
  8827******************************************************************
  8828*    CHECK THE FIRST ISSUE RECORD IN EVERY NEW BATCH.  VERIFY    *
  8829*    THAT THE CERTIFICATE DOES NOT EXIST ON THE CERT. MASTER     *
  8830*    FILE.  IF IT DOES DISPLAY WARNING MESSAGE ON BLANK SCREEN.  *
  8831******************************************************************
  8832     IF  PI-MAINT-FUNC = 'N' NEXT SENTENCE
  8833        ELSE
  8834         GO TO 4185-ADD-MAILING-RECORD.
  8835     IF  PI-ISSUE-ADDED
  8836         GO TO 4185-ADD-MAILING-RECORD.
  8837     MOVE 'Y'                    TO  PI-ISSUE-ADDED-SW.
  8838
  8839* EXEC CICS HANDLE CONDITION
  8840*        NOTFND (4185-ADD-MAILING-RECORD)
  8841*    END-EXEC.
  8842*    MOVE '"$I                   ! + #00008380' TO DFHEIV0
  8843     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8845     MOVE X'2B20233030303038333830' TO DFHEIV0(25:11)
  8846     CALL 'kxdfhei1' USING DFHEIV0
  8847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8848
  8849     MOVE PB-CONTROL-BY-ACCOUNT  TO  ELCERT-KEY.
  8850     MOVE PI-SAV-FC-CARRIER      TO  ELCERT-CARRIER.
  8851     MOVE PI-SAV-FC-GROUPING     TO  ELCERT-GROUPING.
  8852     MOVE PI-SAV-FC-STATE        TO  ELCERT-STATE.
  8853
  8854* EXEC CICS READ
  8855*        SET     (ADDRESS OF CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 169
* VP6301.cbl
  8856*        DATASET (FILE-ID-ELCERT)
  8857*        RIDFLD  (ELCERT-KEY)
  8858*        LENGTH  (ELCERT-RECORD-LENGTH)
  8859*        UPDATE
  8860*    END-EXEC.
  8861*    MOVE '&"SL       EU         (   #00008387' TO DFHEIV0
  8862     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  8863     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8864     MOVE X'2020233030303038333837' TO DFHEIV0(25:11)
  8865     CALL 'kxdfhei1' USING DFHEIV0,
  8866           FILE-ID-ELCERT,
  8867           DFHEIV20,
  8868           ELCERT-RECORD-LENGTH,
  8869           ELCERT-KEY,
  8870           DFHEIV99,
  8871           DFHEIV99,
  8872           DFHEIV99
  8873     SET ADDRESS OF CERTIFICATE-MASTER TO
  8874         DFHEIV20
  8875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8876
  8877     IF  CERT-WAS-CREATED-FOR-CLAIM
  8878         GO TO 4185-ADD-MAILING-RECORD.
  8879     go to 4900-exit
  8880     .
  8881 4185-ADD-MAILING-RECORD.
  8882     IF  PI-MAIL-YES
  8883         IF  BADDRS1-LEN > ZERO
  8884                 OR
  8885             BBENEFICIARY-LEN > ZERO
  8886                  OR
  8887             BADDRS2-LEN > ZERO
  8888                 OR
  8889             BCITY-LEN > ZERO
  8890                 OR
  8891             BSTATE-LEN > ZERO
  8892                 OR
  8893             BCADDR1-LEN > ZERO
  8894                 OR
  8895             BCADDR2-LEN > ZERO
  8896                 OR
  8897             BCCITY-LEN > ZERO
  8898                 OR
  8899             BCSTATE-LEN > ZERO
  8900             NEXT SENTENCE
  8901         ELSE
  8902             GO TO 4900-EXIT
  8903     ELSE
  8904         GO TO 4900-EXIT.
  8905
  8906* EXEC CICS GETMAIN
  8907*        SET     (ADDRESS OF PENDING-MAILING-DATA)
  8908*        LENGTH  (ERPNDM-RECORD-LENGTH)
  8909*        INITIMG (GETMAIN-SPACE)
  8910*    END-EXEC.
  8911*    MOVE ',"IL                  $   #00008422' TO DFHEIV0
  8912     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8913     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 170
* VP6301.cbl
  8914     MOVE X'2020233030303038343232' TO DFHEIV0(25:11)
  8915     CALL 'kxdfhei1' USING DFHEIV0,
  8916           DFHEIV20,
  8917           ERPNDM-RECORD-LENGTH,
  8918           GETMAIN-SPACE
  8919     SET ADDRESS OF PENDING-MAILING-DATA TO
  8920         DFHEIV20
  8921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8922
  8923     MOVE 'PM'                   TO PM-RECORD-ID.
  8924     MOVE 'ER'                   TO PM-SOURCE-SYSTEM.
  8925     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY
  8926                                    PM-RECORD-ADDED-BY.
  8927     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
  8928     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT
  8929                                    PM-RECORD-ADD-DT.
  8930     MOVE ERPNDM-KEY             TO PM-CONTROL-PRIMARY.
  8931     IF BLAST-NAME-LEN      GREATER ZEROS
  8932         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  8933     IF B1ST-NAME-LEN       GREATER ZEROS
  8934         MOVE B1ST-NAME          TO PM-INSURED-FIRST-NAME.
  8935     IF BINIT-LEN           GREATER ZEROS
  8936         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  8937     IF BAGE-LEN            GREATER ZEROS
  8938         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE
  8939     ELSE
  8940         MOVE ZEROS              TO PM-INSURED-ISSUE-AGE.
  8941        MOVE LOW-VALUES          TO PM-INSURED-BIRTH-DT.
  8942        MOVE LOW-VALUES          TO PM-JOINT-BIRTH-DT
  8943     IF BLAST-NAME-LEN      GREATER ZEROS
  8944         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  8945     IF BINIT-LEN           GREATER ZEROS
  8946         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  8947     IF BADDRS1-LEN         GREATER ZERO
  8948         MOVE BADDRS1            TO PM-ADDRESS-LINE-1.
  8949     IF BADDRS2-LEN         GREATER ZERO
  8950         MOVE BADDRS2            TO PM-ADDRESS-LINE-2.
  8951     IF BCITY-LEN > 0
  8952        MOVE BCITY               TO PM-CITY
  8953     END-IF
  8954     IF BSTATE-LEN > 0
  8955        MOVE BSTATE              TO PM-STATE
  8956     END-IF
  8957     IF BZIPCDE-LEN GREATER ZEROS
  8958         MOVE BZIPCDE            TO  WS-ZIP-CODE
  8959     ELSE
  8960         GO TO 4188-CRED-BENE.
  8961     IF WS-CANADIAN-ZIP
  8962         IF WS-ZIP-4 = SPACE  OR  '-'
  8963             MOVE WS-ZIP-CAN-2-POST1   TO PM-CAN-POST1
  8964             MOVE WS-ZIP-CAN-2-POST2   TO PM-CAN-POST2
  8965         ELSE
  8966             MOVE WS-ZIP-CAN-1-POST1   TO PM-CAN-POST1
  8967             MOVE WS-ZIP-CAN-1-POST2   TO PM-CAN-POST2
  8968     ELSE
  8969         IF WS-ZIP-6 = SPACE  OR  '-'
  8970             MOVE WS-ZIP-AM-2-CODE     TO PM-ZIP-CODE
  8971             MOVE WS-ZIP-AM-2-PLUS4    TO PM-ZIP-PLUS4
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 171
* VP6301.cbl
  8972         ELSE
  8973             MOVE WS-ZIP-AM-1-CODE     TO PM-ZIP-CODE
  8974             MOVE WS-ZIP-AM-1-PLUS4    TO PM-ZIP-PLUS4.
  8975     .
  8976 4188-CRED-BENE.
  8977     IF BBENEFICIARY-LEN > ZEROS
  8978        MOVE BBENEFICIARY        TO PM-CRED-BENE-NAME
  8979     END-IF
  8980     IF BCADDR1-LEN > ZEROS
  8981        MOVE BCADDR1             TO PM-CRED-BENE-ADDR
  8982     END-IF
  8983     IF BCADDR2-LEN > ZEROS
  8984        MOVE BCADDR2             TO PM-CRED-BENE-ADDR2
  8985     END-IF
  8986     IF BCCITY-LEN > ZEROS
  8987        MOVE BCCITY              TO PM-CRED-BENE-CITY
  8988     END-IF
  8989     IF BCSTATE-LEN > ZEROS
  8990        MOVE BCSTATE             TO PM-CRED-BENE-STATE
  8991     END-IF
  8992     IF BCZIPCD-LEN > ZEROS
  8993        MOVE BCZIPCD             TO WS-ZIP-CODE
  8994     ELSE
  8995        GO TO 4188-CONTINUE
  8996     END-IF
  8997     IF WS-CANADIAN-ZIP
  8998        IF WS-ZIP-4 = SPACE  OR  '-'
  8999           MOVE WS-ZIP-CAN-2-POST1   TO PM-CB-CAN-POST1
  9000           MOVE WS-ZIP-CAN-2-POST2   TO PM-CB-CAN-POST2
  9001        ELSE
  9002           MOVE WS-ZIP-CAN-1-POST1   TO PM-CB-CAN-POST1
  9003           MOVE WS-ZIP-CAN-1-POST2   TO PM-CB-CAN-POST2
  9004        END-IF
  9005     ELSE
  9006        IF WS-ZIP-6 = SPACE  OR  '-'
  9007           MOVE WS-ZIP-AM-2-CODE     TO PM-CB-ZIP-CODE
  9008           MOVE WS-ZIP-AM-2-PLUS4    TO PM-CB-ZIP-PLUS4
  9009        ELSE
  9010           MOVE WS-ZIP-AM-1-CODE     TO PM-CB-ZIP-CODE
  9011           MOVE WS-ZIP-AM-1-PLUS4    TO PM-CB-ZIP-PLUS4
  9012        END-IF
  9013     END-IF
  9014     .
  9015 4188-CONTINUE.
  9016*    IF BPHONE-LEN          GREATER ZERO
  9017*        MOVE WS-BPHONE          TO PM-PHONE-NO
  9018*    ELSE
  9019         MOVE ZEROS              TO PM-PHONE-NO.
  9020     MOVE 'A'                    TO JP-RECORD-TYPE.
  9021     MOVE PENDING-MAILING-DATA   TO JP-RECORD-AREA.
  9022     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9023     MOVE FILE-ID-ERPNDM         TO JP-FILE-ID.
  9024
  9025* EXEC CICS WRITE
  9026*        DATASET (FILE-ID-ERPNDM)
  9027*        FROM    (PENDING-MAILING-DATA)
  9028*        RIDFLD  (PM-CONTROL-PRIMARY)
  9029*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 172
* VP6301.cbl
  9030     MOVE LENGTH OF
  9031      PENDING-MAILING-DATA
  9032       TO DFHEIV11
  9033*    MOVE '&$ L                  ''   #00008528' TO DFHEIV0
  9034     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9035     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9036     MOVE X'2020233030303038353238' TO DFHEIV0(25:11)
  9037     CALL 'kxdfhei1' USING DFHEIV0,
  9038           FILE-ID-ERPNDM,
  9039           PENDING-MAILING-DATA,
  9040           DFHEIV11,
  9041           PM-CONTROL-PRIMARY,
  9042           DFHEIV99,
  9043           DFHEIV99
  9044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9045
  9046     PERFORM 8400-LOG-JOURNAL-RECORD.
  9047     MOVE LOW-VALUES             TO MAP-B.
  9048     GO TO 4900-EXIT.
  9049 4200-DUPLICATE-ALT-INDEX.
  9050     MOVE ER-2247                TO EMI-ERROR.
  9051     MOVE -1                     TO BCERT-LEN.
  9052     MOVE AL-UABON               TO BCERT-ATTRB.
  9053     MOVE AL-UNBON               TO BEFFDT-ATTRB.
  9054     MOVE 'Y'                    TO PI-ERROR-SW.
  9055     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9056     IF BPREM1-LEN > ZEROS
  9057         SUBTRACT WS-BPREM1
  9058                                 FROM PI-LF-ISS-ENTERED.
  9059     IF BALT-PREM1-LEN > ZEROS
  9060         SUBTRACT WS-BALT-PREM1
  9061                                 FROM PI-LF-ISS-ENTERED.
  9062     IF BPREM2-LEN > ZEROS
  9063         SUBTRACT WS-BPREM2
  9064                                 FROM PI-AH-ISS-ENTERED.
  9065     SUBTRACT +1                 FROM PI-LAST-SEQ-NO-ADDED
  9066                                      PI-SAV-BATCH-SEQ.
  9067 4900-EXIT.
  9068     EXIT.
  9069 4905-read-elcrtt.
  9070
  9071* EXEC CICS READ
  9072*        SET     (ADDRESS OF certificate-trailers)
  9073*        DATASET ('ELCRTT')
  9074*        RIDFLD  (ELCRTT-KEY)
  9075*        resp    (ws-response)
  9076*    END-EXEC
  9077     MOVE 'ELCRTT' TO DFHEIV1
  9078*    MOVE '&"S        E          (  N#00008557' TO DFHEIV0
  9079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9081     MOVE X'204E233030303038353537' TO DFHEIV0(25:11)
  9082     CALL 'kxdfhei1' USING DFHEIV0,
  9083           DFHEIV1,
  9084           DFHEIV20,
  9085           DFHEIV99,
  9086           ELCRTT-KEY,
  9087           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 173
* VP6301.cbl
  9088           DFHEIV99,
  9089           DFHEIV99
  9090     SET ADDRESS OF certificate-trailers TO
  9091         DFHEIV20
  9092     MOVE EIBRESP  TO ws-response
  9093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9094     .
  9095 4905-exit.
  9096     exit.
  9097 4910-read-elcrtt-update.
  9098
  9099* EXEC CICS READ
  9100*        SET     (ADDRESS OF certificate-trailers)
  9101*        DATASET ('ELCRTT')
  9102*        RIDFLD  (ELCRTT-KEY)
  9103*        UPDATE
  9104*        resp    (ws-response)
  9105*    END-EXEC
  9106     MOVE 'ELCRTT' TO DFHEIV1
  9107*    MOVE '&"S        EU         (  N#00008567' TO DFHEIV0
  9108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9109     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9110     MOVE X'204E233030303038353637' TO DFHEIV0(25:11)
  9111     CALL 'kxdfhei1' USING DFHEIV0,
  9112           DFHEIV1,
  9113           DFHEIV20,
  9114           DFHEIV99,
  9115           ELCRTT-KEY,
  9116           DFHEIV99,
  9117           DFHEIV99,
  9118           DFHEIV99
  9119     SET ADDRESS OF certificate-trailers TO
  9120         DFHEIV20
  9121     MOVE EIBRESP  TO ws-response
  9122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9123     .
  9124 4910-exit.
  9125     exit.
  9126 4920-rewrite-elcrtt.
  9127     perform 4940-update-elcrtt  thru 4940-exit
  9128
  9129* exec cics rewrite
  9130*       dataset     ('ELCRTT')
  9131*       from        (certificate-trailers)
  9132*       resp        (ws-response)
  9133*    end-exec
  9134     MOVE LENGTH OF
  9135      certificate-trailers
  9136       TO DFHEIV11
  9137     MOVE 'ELCRTT' TO DFHEIV1
  9138*    MOVE '&& L                  %  N#00008579' TO DFHEIV0
  9139     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9140     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9141     MOVE X'204E233030303038353739' TO DFHEIV0(25:11)
  9142     CALL 'kxdfhei1' USING DFHEIV0,
  9143           DFHEIV1,
  9144           certificate-trailers,
  9145           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 174
* VP6301.cbl
  9146           DFHEIV99
  9147     MOVE EIBRESP  TO ws-response
  9148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9149     .
  9150 4920-exit.
  9151     exit.
  9152 4930-write-elcrtt.
  9153     move 'CS'                   to certificate-trailers
  9154     move elcrtt-key             to cs-control-primary
  9155     move 'C'                    to cs-trailer-type
  9156     perform 4940-update-elcrtt  thru 4940-exit
  9157
  9158* EXEC CICS WRITE
  9159*        DATASET ('ELCRTT')
  9160*        FROM    (CERTIFICATE-TRAILERS)
  9161*        RIDFLD  (CS-CONTROL-PRIMARY)
  9162*    END-EXEC
  9163     MOVE LENGTH OF
  9164      CERTIFICATE-TRAILERS
  9165       TO DFHEIV11
  9166     MOVE 'ELCRTT' TO DFHEIV1
  9167*    MOVE '&$ L                  ''   #00008592' TO DFHEIV0
  9168     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9169     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9170     MOVE X'2020233030303038353932' TO DFHEIV0(25:11)
  9171     CALL 'kxdfhei1' USING DFHEIV0,
  9172           DFHEIV1,
  9173           CERTIFICATE-TRAILERS,
  9174           DFHEIV11,
  9175           CS-CONTROL-PRIMARY,
  9176           DFHEIV99,
  9177           DFHEIV99
  9178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9179     .
  9180 4930-exit.
  9181     exit.
  9182 4940-update-elcrtt.
  9183     if byear-len <> zeros
  9184        move byear               to cs-year
  9185     end-if
  9186     if bmake-len <> zeros
  9187        move bmake               to cs-make
  9188     end-if
  9189     if bmodel-len <> zeros
  9190        move bmodel              to cs-model
  9191     end-if
  9192     if bometer-len <> zeros
  9193        MOVE Bometer-in          TO DEEDIT-FIELD
  9194        PERFORM 8600-DEEDIT
  9195        IF DEEDIT-FIELD-V0 NUMERIC
  9196           MOVE DEEDIT-FIELD-V0  TO cs-vehicle-odometer
  9197        end-if
  9198     end-if
  9199     .
  9200 4940-exit.
  9201     exit.
  9202 5000-BUILD-CANCEL-RECORD.
  9203     MOVE +0                     TO WS-SUB2.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 175
* VP6301.cbl
  9204 5025-PROCESS-CANCEL.
  9205     ADD +1                      TO WS-SUB2.
  9206     IF PI-LAST-FUNC-DISPLAY
  9207        IF WS-SUB2 GREATER +1
  9208           GO TO 5900-EXIT.
  9209     IF WS-SUB2 GREATER +4
  9210        GO TO 5900-EXIT.
  9211     IF CCERT-LEN    (WS-SUB2) = ZEROS AND
  9212        CEFFDT-LEN   (WS-SUB2) = ZEROS AND
  9213        CCANDT1-LEN  (WS-SUB2) = ZEROS AND
  9214        CCANDT2-LEN  (WS-SUB2) = ZEROS AND
  9215        CMTHD1-LEN   (WS-SUB2) = ZEROS AND
  9216        CMTHD2-LEN   (WS-SUB2) = ZEROS AND
  9217        CREFUND1-LEN (WS-SUB2) = ZEROS AND
  9218        CREFUND2-LEN (WS-SUB2) = ZEROS AND
  9219        CLIVES-LEN   (WS-SUB2) = ZEROS AND
  9220        CCHK-LEN     (WS-SUB2) = ZEROS
  9221           GO TO 5025-PROCESS-CANCEL.
  9222     IF CSEQ (WS-SUB2) GREATER PI-LAST-SEQ-NO-ADDED
  9223         GO TO 5100-ADD-CANCEL-RECORD.
  9224******************************************************************
  9225*   THE DATA ENTRY SYSTEM ALLOWS BROWSING OF THE CURRENT BUS.    *
  9226*   FILE. THE DATA ENTRY SYS. DOES NOT HAVE A MAINT. FUNCTION.   *
  9227*   THE PROGRAM ASSUMES THAT IF A MATCH ON THE READ FOR UPDATE   *
  9228*   IS SUCCESSFUL, THE RECORD HAS PREVIOUSLY BEEN DISPLAYED      *
  9229*   THROUGH A BROWSE.  CHANGES ARE APPLIED AND THE PB-RECORD IS  *
  9230*   REWRITTEN, ELSE A NEW PB-RECORD IS ADDED.                    *
  9231******************************************************************
  9232     MOVE PI-COMPANY-CD          TO ERPNDB-COMP-CD.
  9233     MOVE PI-SAV-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH.
  9234     MOVE CSEQ (WS-SUB2)         TO ERPNDB-BATCH-SEQ.
  9235
  9236* EXEC CICS HANDLE CONDITION
  9237*        NOTFND (5100-ADD-CANCEL-RECORD)
  9238*    END-EXEC.
  9239*    MOVE '"$I                   ! , #00008653' TO DFHEIV0
  9240     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9242     MOVE X'2C20233030303038363533' TO DFHEIV0(25:11)
  9243     CALL 'kxdfhei1' USING DFHEIV0
  9244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9245
  9246
  9247* EXEC CICS READ
  9248*        SET     (ADDRESS OF PENDING-BUSINESS)
  9249*        DATASET (FILE-ID-ERPNDB)
  9250*        RIDFLD  (ERPNDB-KEY)
  9251*        UPDATE
  9252*    END-EXEC.
  9253*    MOVE '&"S        EU         (   #00008656' TO DFHEIV0
  9254     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9255     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9256     MOVE X'2020233030303038363536' TO DFHEIV0(25:11)
  9257     CALL 'kxdfhei1' USING DFHEIV0,
  9258           FILE-ID-ERPNDB,
  9259           DFHEIV20,
  9260           DFHEIV99,
  9261           ERPNDB-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 176
* VP6301.cbl
  9262           DFHEIV99,
  9263           DFHEIV99,
  9264           DFHEIV99
  9265     SET ADDRESS OF PENDING-BUSINESS TO
  9266         DFHEIV20
  9267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9268
  9269     MOVE 'B'                    TO JP-RECORD-TYPE
  9270     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9271     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9272     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9273     PERFORM 8400-LOG-JOURNAL-RECORD.
  9274     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  9275     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  9276     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  9277     IF CSFX-LEN  (WS-SUB2) GREATER ZEROS
  9278        MOVE CSFX (WS-SUB2)      TO PB-CERT-SFX.
  9279     IF CLAST-NAME-LEN (WS-SUB2) GREATER ZEROS
  9280         MOVE CLAST-NAME (WS-SUB2)  TO PB-C-LAST-NAME.
  9281     IF CREFUND1-LEN   (WS-SUB2) GREATER ZEROS
  9282         IF WS-CREFUND1 (WS-SUB2) = WS-ALL-NINES OR
  9283            WS-CREFUND1 (WS-SUB2) GREATER WS-ALL-NINES
  9284            SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
  9285            MOVE ZEROS            TO PB-C-LF-CANCEL-AMT
  9286            MOVE '?'              TO PB-C-LF-CALC-REQ
  9287         ELSE
  9288            SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
  9289            ADD WS-CREFUND1  (WS-SUB2) TO PI-LF-CAN-ENTERED
  9290            MOVE WS-CREFUND1 (WS-SUB2) TO PB-C-LF-CANCEL-AMT
  9291            MOVE SPACE                 TO PB-C-LF-CALC-REQ.
  9292     IF CREFUND2-LEN   (WS-SUB2) GREATER ZEROS
  9293         IF WS-CREFUND2 (WS-SUB2) = WS-ALL-NINES OR
  9294            WS-CREFUND2 (WS-SUB2) GREATER WS-ALL-NINES
  9295            SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
  9296            MOVE ZEROS            TO PB-C-AH-CANCEL-AMT
  9297            MOVE '?'              TO PB-C-AH-CALC-REQ
  9298         ELSE
  9299            SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
  9300            ADD WS-CREFUND2  (WS-SUB2) TO PI-AH-CAN-ENTERED
  9301            MOVE WS-CREFUND2 (WS-SUB2) TO PB-C-AH-CANCEL-AMT
  9302            MOVE SPACE                 TO PB-C-AH-CALC-REQ.
  9303******************************************************************
  9304*      IF CANCEL DATE = SPACES (LOW-VALUES) DELETE COVERAGE.     *
  9305******************************************************************
  9306     IF CCANDT1-LEN (WS-SUB2) GREATER ZEROS
  9307        MOVE WS-CONVERTED-CANDT1 (WS-SUB2) TO PB-C-LF-CANCEL-DT
  9308        IF   WS-CONVERTED-CANDT1 (WS-SUB2) = LOW-VALUES
  9309             SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
  9310             MOVE ZEROS          TO PB-C-LF-REF-CALC
  9311                                    PB-C-LF-CANCEL-AMT.
  9312     IF CCANDT2-LEN (WS-SUB2) GREATER ZEROS
  9313        MOVE WS-CONVERTED-CANDT2 (WS-SUB2) TO PB-C-AH-CANCEL-DT
  9314        IF   WS-CONVERTED-CANDT2 (WS-SUB2) = LOW-VALUES
  9315             SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
  9316             MOVE ZEROS          TO PB-C-AH-REF-CALC
  9317                                    PB-C-AH-CANCEL-AMT.
  9318     IF CMTHD1-LEN (WS-SUB2) GREATER THAN +0
  9319        MOVE CMTHD1 (WS-SUB2)    TO PB-C-LF-REFUND-OVERRIDE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 177
* VP6301.cbl
  9320     IF CMTHD2-LEN (WS-SUB2) GREATER THAN +0
  9321        MOVE CMTHD2 (WS-SUB2)    TO PB-C-AH-REFUND-OVERRIDE.
  9322     IF CLIVES-LEN  (WS-SUB2) GREATER ZEROS
  9323        MOVE WS-CLIVES (WS-SUB2) TO PB-C-LIVES.
  9324     IF CCANREA-LEN (WS-SUB2) > ZEROS
  9325        MOVE WS-CAN-REA (WS-SUB2) TO PB-C-CANCEL-REASON
  9326     END-IF
  9327*    IF CMICRO-NO-LEN (WS-SUB2)  GREATER  ZEROS
  9328*        MOVE WS-MICRO-NO (WS-SUB2)
  9329*                                TO  PB-C-MICROFILM-NO.
  9330     IF CPAYEE-LEN  (WS-SUB2) GREATER ZEROS
  9331        MOVE CPAYEE (WS-SUB2)    TO PB-C-PAYEE-CODE.
  9332     IF CCHK-LEN    (WS-SUB2) GREATER ZEROS
  9333        MOVE CCHK   (WS-SUB2)    TO PB-C-REFUND-SW.
  9334     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
  9335     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
  9336     MOVE 'C'                    TO JP-RECORD-TYPE.
  9337     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9338     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9339     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9340
  9341* EXEC CICS REWRITE
  9342*        DATASET (FILE-ID-ERPNDB)
  9343*        FROM    (PENDING-BUSINESS)
  9344*    END-EXEC.
  9345     MOVE LENGTH OF
  9346      PENDING-BUSINESS
  9347       TO DFHEIV11
  9348*    MOVE '&& L                  %   #00008733' TO DFHEIV0
  9349     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9350     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9351     MOVE X'2020233030303038373333' TO DFHEIV0(25:11)
  9352     CALL 'kxdfhei1' USING DFHEIV0,
  9353           FILE-ID-ERPNDB,
  9354           PENDING-BUSINESS,
  9355           DFHEIV11,
  9356           DFHEIV99
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9358
  9359     MOVE ERPNDB-KEY             TO PI-SAV-ENDING-ERPNDB-KEY.
  9360     PERFORM 8400-LOG-JOURNAL-RECORD.
  9361     MOVE LOW-VALUES             TO DATA-AREA-C (WS-SUB2).
  9362     IF EIBAID = DFHENTER
  9363         MOVE PI-NEXT-DISPLAY-SEQ-NO TO CSEQ (WS-SUB2)
  9364         ADD +1 TO PI-NEXT-DISPLAY-SEQ-NO
  9365         MOVE AL-SABON               TO CSEQ-ATTRB (WS-SUB2).
  9366     GO TO 5900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 178
* VP6301.cbl
  9368 5100-ADD-CANCEL-RECORD.
  9369
  9370* EXEC CICS GETMAIN
  9371*        SET     (ADDRESS OF PENDING-BUSINESS)
  9372*        LENGTH  (ERPNDB-RECORD-LENGTH)
  9373*        INITIMG (GETMAIN-SPACE)
  9374*    END-EXEC.
  9375*    MOVE ',"IL                  $   #00008747' TO DFHEIV0
  9376     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9377     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9378     MOVE X'2020233030303038373437' TO DFHEIV0(25:11)
  9379     CALL 'kxdfhei1' USING DFHEIV0,
  9380           DFHEIV20,
  9381           ERPNDB-RECORD-LENGTH,
  9382           GETMAIN-SPACE
  9383     SET ADDRESS OF PENDING-BUSINESS TO
  9384         DFHEIV20
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9386
  9387     MOVE 'PB'                   TO PB-RECORD-ID.
  9388     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  9389                                    PB-COMPANY-CD-A1.
  9390     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  9391     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH.
  9392     MOVE CSEQ (WS-SUB2)         TO PB-BATCH-SEQ-NO.
  9393     IF CSEQ (WS-SUB2) GREATER PI-LAST-SEQ-NO-ADDED
  9394        MOVE CSEQ (WS-SUB2)      TO PI-LAST-SEQ-NO-ADDED.
  9395     MOVE PI-SAV-CARRIER         TO PB-CARRIER.
  9396     MOVE PI-SAV-GROUPING        TO PB-GROUPING.
  9397     MOVE PI-SAV-STATE           TO PB-STATE.
  9398     MOVE PI-SAV-ACCOUNT         TO PB-ACCOUNT.
  9399     MOVE '2'                    TO PB-RECORD-TYPE.
  9400     MOVE CCERT (WS-SUB2)        TO PB-CERT-PRIME.
  9401     MOVE WS-CONVERTED-CAN-EFF-DT (WS-SUB2)
  9402                                 TO PB-CERT-EFF-DT.
  9403*    MOVE PI-SAV-REFERENCE       TO PB-C-REFERENCE.
  9404     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  9405                                    PB-ALT-CHG-SEQ-NO.
  9406     MOVE +0                     TO PB-NO-OF-ERRORS.
  9407     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  9408     MOVE ZEROS                  TO PB-C-LF-REF-CALC
  9409                                    PB-C-AH-REF-CALC
  9410                                    PB-C-LF-RFND-CLP
  9411                                    PB-C-AH-RFND-CLP
  9412                                    PB-CI-INSURED-AGE
  9413                                    PB-CI-LF-TERM
  9414                                    PB-CI-AH-TERM
  9415                                    PB-CI-LF-BENEFIT-CD
  9416                                    PB-CI-LF-BENEFIT-AMT
  9417                                    PB-CI-LF-ALT-BENEFIT-AMT
  9418                                    PB-CI-LF-PREMIUM-AMT
  9419                                    PB-CI-LF-ALT-PREMIUM-AMT
  9420                                    PB-CI-AH-BENEFIT-CD
  9421                                    PB-CI-AH-BENEFIT-AMT
  9422                                    PB-CI-AH-PREMIUM-AMT
  9423                                    PB-CI-PAY-FREQUENCY
  9424                                    PB-CI-LOAN-APR
  9425                                    PB-CI-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 179
* VP6301.cbl
  9426                                    PB-CI-LIFE-COMMISSION
  9427                                    PB-CI-AH-COMMISSION
  9428                                    PB-CI-CURR-SEQ
  9429                                    PB-CI-AH-CANCEL-AMT
  9430                                    PB-CI-LF-CANCEL-AMT
  9431                                    PB-CI-RATE-DEV-PCT-LF
  9432                                    PB-CI-RATE-DEV-PCT-AH
  9433                                    PB-CI-EXTENTION-DAYS
  9434                                    PB-CI-TERM-IN-DAYS
  9435                                    PB-CI-LIVES
  9436                                    PB-CI-LF-CRIT-PER
  9437                                    PB-CI-AH-CRIT-PER
  9438                                    PB-C-LF-REM-TERM
  9439                                    PB-C-AH-REM-TERM
  9440                                    PB-CHG-COUNT
  9441                                    PB-LF-BILLED-AMTS
  9442                                    PB-AH-BILLED-AMTS
  9443*                                   PB-C-MICROFILM-NO
  9444                                    PB-C-NH-INT-ON-REFS
  9445                                    PB-CALC-TOLERANCE.
  9446     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  9447                                    PB-CI-AH-SETTLEMENT-DT
  9448                                    PB-CI-DEATH-DT
  9449                                    PB-CI-LF-PRIOR-CANCEL-DT
  9450                                    PB-CI-AH-PRIOR-CANCEL-DT
  9451                                    PB-CI-ENTRY-DT
  9452                                    PB-CI-LF-EXPIRE-DT
  9453                                    PB-CI-AH-EXPIRE-DT
  9454                                    PB-CI-LOAN-1ST-PMT-DT
  9455                                    PB-C-LF-CANCEL-DT
  9456                                    PB-C-AH-CANCEL-DT
  9457                                    PB-CREDIT-ACCEPT-DT
  9458                                    PB-BILLED-DT
  9459                                    PB-ACCT-EFF-DT
  9460                                    PB-ACCT-EXP-DT.
  9461     IF PI-NB-MONTH-END-DT NOT = SPACES
  9462        MOVE PI-NB-MONTH-END-DT  TO PB-CREDIT-SELECT-DT
  9463       ELSE
  9464        MOVE PI-CR-MONTH-END-DT  TO PB-CREDIT-SELECT-DT.
  9465     MOVE 'X'                    TO PB-FATAL-FLAG.
  9466     IF CSFX-LEN  (WS-SUB2) GREATER ZEROS
  9467        MOVE CSFX (WS-SUB2)      TO PB-CERT-SFX.
  9468     IF CLAST-NAME-LEN (WS-SUB2) GREATER ZEROS
  9469         MOVE CLAST-NAME (WS-SUB2)  TO PB-C-LAST-NAME.
  9470     IF CCANDT1-LEN (WS-SUB2) GREATER ZEROS
  9471        MOVE WS-CONVERTED-CANDT1 (WS-SUB2) TO PB-C-LF-CANCEL-DT.
  9472     IF CCANDT2-LEN (WS-SUB2) GREATER ZEROS
  9473        MOVE WS-CONVERTED-CANDT2 (WS-SUB2) TO PB-C-AH-CANCEL-DT.
  9474     IF CMTHD1-LEN (WS-SUB2) GREATER ZEROS
  9475        MOVE CMTHD1 (WS-SUB2) TO PB-C-LF-REFUND-OVERRIDE.
  9476     IF CMTHD2-LEN (WS-SUB2) GREATER ZEROS
  9477        MOVE CMTHD2 (WS-SUB2) TO PB-C-AH-REFUND-OVERRIDE.
  9478     IF CREFUND1-LEN   (WS-SUB2) GREATER ZEROS
  9479         IF WS-CREFUND1 (WS-SUB2) = WS-ALL-NINES OR
  9480            WS-CREFUND1 (WS-SUB2) GREATER WS-ALL-NINES
  9481            MOVE ZEROS            TO PB-C-LF-CANCEL-AMT
  9482            MOVE '?'              TO PB-C-LF-CALC-REQ
  9483         ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 180
* VP6301.cbl
  9484            ADD  WS-CREFUND1  (WS-SUB2) TO PI-LF-CAN-ENTERED
  9485            MOVE WS-CREFUND1  (WS-SUB2) TO PB-C-LF-CANCEL-AMT
  9486     ELSE
  9487         MOVE ZEROS            TO PB-C-LF-CANCEL-AMT.
  9488     IF CREFUND2-LEN   (WS-SUB2) GREATER ZEROS
  9489         IF WS-CREFUND2 (WS-SUB2) = WS-ALL-NINES OR
  9490            WS-CREFUND2 (WS-SUB2) GREATER WS-ALL-NINES
  9491            MOVE ZEROS            TO PB-C-AH-CANCEL-AMT
  9492            MOVE '?'              TO PB-C-AH-CALC-REQ
  9493         ELSE
  9494            ADD  WS-CREFUND2  (WS-SUB2) TO PI-AH-CAN-ENTERED
  9495            MOVE WS-CREFUND2  (WS-SUB2) TO PB-C-AH-CANCEL-AMT
  9496     ELSE
  9497         MOVE ZEROS              TO PB-C-AH-CANCEL-AMT.
  9498     IF CLIVES-LEN  (WS-SUB2) GREATER ZEROS
  9499        MOVE WS-CLIVES (WS-SUB2) TO PB-C-LIVES
  9500     ELSE
  9501        MOVE ZEROS               TO PB-C-LIVES.
  9502     IF CCANREA-LEN (WS-SUB2) > ZEROS
  9503        MOVE WS-CAN-REA (WS-SUB2) TO PB-C-CANCEL-REASON
  9504     END-IF
  9505*    IF CMICRO-NO-LEN (WS-SUB2)  GREATER  ZEROS
  9506*        MOVE WS-MICRO-NO (WS-SUB2)
  9507*                                TO  PB-C-MICROFILM-NO
  9508*    ELSE
  9509*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
  9510     IF CPAYEE-LEN  (WS-SUB2) GREATER ZEROS
  9511        MOVE CPAYEE (WS-SUB2)    TO PB-C-PAYEE-CODE.
  9512     IF CCHK-LEN    (WS-SUB2) GREATER ZEROS
  9513        MOVE CCHK   (WS-SUB2)    TO PB-C-REFUND-SW.
  9514     IF PB-COMPANY-ID = 'LAP'  OR  'RMC'
  9515         MOVE 'H'                TO PB-RECORD-BILL.
  9516     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
  9517     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
  9518     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
  9519                                    PB-INPUT-BY.
  9520     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  9521     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  9522                                    PB-INPUT-DT.
  9523     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
  9524     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
  9525     MOVE PI-CSR-ID              TO PB-CSR-ID.
  9526     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
  9527     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
  9528     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
  9529     MOVE 'A'                    TO JP-RECORD-TYPE.
  9530     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9531     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9532     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9533     MOVE PB-CONTROL-PRIMARY     TO PI-SAV-ENDING-ERPNDB-KEY.
  9534     ADD +1                      TO PI-SAV-BATCH-SEQ.
  9535
  9536* EXEC CICS HANDLE CONDITION
  9537*        DUPREC (5200-DUPLICATE-ALT-INDEX)
  9538*    END-EXEC.
  9539*    MOVE '"$%                   ! - #00008900' TO DFHEIV0
  9540     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  9541     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 181
* VP6301.cbl
  9542     MOVE X'2D20233030303038393030' TO DFHEIV0(25:11)
  9543     CALL 'kxdfhei1' USING DFHEIV0
  9544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9545
  9546
  9547* EXEC CICS WRITE
  9548*        DATASET (FILE-ID-ERPNDB)
  9549*        FROM    (PENDING-BUSINESS)
  9550*        RIDFLD  (PB-CONTROL-PRIMARY)
  9551*    END-EXEC.
  9552     MOVE LENGTH OF
  9553      PENDING-BUSINESS
  9554       TO DFHEIV11
  9555*    MOVE '&$ L                  ''   #00008903' TO DFHEIV0
  9556     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9557     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9558     MOVE X'2020233030303038393033' TO DFHEIV0(25:11)
  9559     CALL 'kxdfhei1' USING DFHEIV0,
  9560           FILE-ID-ERPNDB,
  9561           PENDING-BUSINESS,
  9562           DFHEIV11,
  9563           PB-CONTROL-PRIMARY,
  9564           DFHEIV99,
  9565           DFHEIV99
  9566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9567
  9568     ADD +1                      TO PI-CAN-CNT-ENTERED.
  9569     PERFORM 8400-LOG-JOURNAL-RECORD.
  9570     MOVE LOW-VALUES             TO DATA-AREA-C (WS-SUB2).
  9571     MOVE PI-NEXT-DISPLAY-SEQ-NO TO CSEQ        (WS-SUB2).
  9572     MOVE AL-SABON               TO CSEQ-ATTRB  (WS-SUB2).
  9573     ADD +1 TO                   PI-NEXT-DISPLAY-SEQ-NO.
  9574     GO TO 5025-PROCESS-CANCEL.
  9575 5200-DUPLICATE-ALT-INDEX.
  9576     MOVE ER-2247                TO EMI-ERROR.
  9577     MOVE -1                     TO CCERT-LEN    (WS-SUB2).
  9578     MOVE AL-UABON               TO CCERT-ATTRB  (WS-SUB2).
  9579     MOVE AL-UNBON               TO CEFFDT-ATTRB (WS-SUB2).
  9580     MOVE 'Y'                    TO PI-ERROR-SW.
  9581     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9582     IF CREFUND1-LEN (WS-SUB2) GREATER ZEROS
  9583         SUBTRACT WS-CREFUND1 (WS-SUB2) FROM PI-LF-CAN-ENTERED.
  9584     IF CREFUND2-LEN (WS-SUB2) GREATER ZEROS
  9585         SUBTRACT WS-CREFUND2 (WS-SUB2) FROM PI-AH-CAN-ENTERED.
  9586     GO TO 8200-SEND-DATAONLY.
  9587 5900-EXIT.
  9588     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 182
* VP6301.cbl
  9590 6000-DELETE-PEND-BUS-RECORD.
  9591     MOVE PI-COMPANY-CD          TO ERPNDB-COMP-CD.
  9592     MOVE PI-SAV-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH.
  9593     IF PI-MAP-NAME = VP630B
  9594         MOVE BSEQ               TO ERPNDB-BATCH-SEQ
  9595     ELSE
  9596         MOVE CSEQ (1)           TO ERPNDB-BATCH-SEQ.
  9597
  9598* EXEC CICS HANDLE CONDITION
  9599*        NOTFND (6990-REC-NOTFND)
  9600*    END-EXEC.
  9601*    MOVE '"$I                   ! . #00008937' TO DFHEIV0
  9602     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9604     MOVE X'2E20233030303038393337' TO DFHEIV0(25:11)
  9605     CALL 'kxdfhei1' USING DFHEIV0
  9606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9607
  9608
  9609* EXEC CICS READ
  9610*        SET     (ADDRESS OF PENDING-BUSINESS)
  9611*        DATASET (FILE-ID-ERPNDB)
  9612*        RIDFLD  (ERPNDB-KEY)
  9613*        UPDATE
  9614*    END-EXEC.
  9615*    MOVE '&"S        EU         (   #00008940' TO DFHEIV0
  9616     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9617     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9618     MOVE X'2020233030303038393430' TO DFHEIV0(25:11)
  9619     CALL 'kxdfhei1' USING DFHEIV0,
  9620           FILE-ID-ERPNDB,
  9621           DFHEIV20,
  9622           DFHEIV99,
  9623           ERPNDB-KEY,
  9624           DFHEIV99,
  9625           DFHEIV99,
  9626           DFHEIV99
  9627     SET ADDRESS OF PENDING-BUSINESS TO
  9628         DFHEIV20
  9629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9630
  9631******************************************************************
  9632*    PENDING BUSINESS RECORD CAN NOT BE DELETED THROUGH DATA     *
  9633*    ENTRY IF THE RECORD HAS BEEN EDITED.  IF THE RECORD HAS     *
  9634*    BEEN EDITED, THE CURRENT BUSINESS RECORD CAN ONLY BE DELETED*
  9635*    THROUGH REVIEW AND CORRECTION.                              *
  9636******************************************************************
  9637     IF  PB-ACCT-EFF-DT = LOW-VALUES NEXT SENTENCE
  9638        ELSE
  9639         GO TO 6880-DELETE-ERROR.
  9640     IF PB-ISSUE
  9641         SUBTRACT PB-I-LF-PREMIUM-AMT     FROM PI-LF-ISS-ENTERED
  9642         SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  9643         SUBTRACT PB-I-AH-PREMIUM-AMT     FROM PI-AH-ISS-ENTERED
  9644         SUBTRACT +1 FROM PI-ISS-CNT-ENTERED
  9645     ELSE
  9646         SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
  9647         SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 183
* VP6301.cbl
  9648         SUBTRACT +1 FROM PI-CAN-CNT-ENTERED.
  9649 6300-DELETE-PB-RECORD.
  9650     MOVE 'D'                    TO JP-RECORD-TYPE.
  9651     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9652     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9653     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
  9654
  9655* EXEC CICS DELETE
  9656*        DATASET (FILE-ID-ERPNDB)
  9657*    END-EXEC.
  9658*    MOVE '&(                    &   #00008969' TO DFHEIV0
  9659     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9660     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9661     MOVE X'2020233030303038393639' TO DFHEIV0(25:11)
  9662     CALL 'kxdfhei1' USING DFHEIV0,
  9663           FILE-ID-ERPNDB,
  9664           DFHEIV99,
  9665           DFHEIV99,
  9666           DFHEIV99,
  9667           DFHEIV99
  9668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9669
  9670     PERFORM 8400-LOG-JOURNAL-RECORD.
  9671     MOVE 'Y'                    TO PI-UPDATE-SW.
  9672     MOVE ER-0000                TO EMI-ERROR.
  9673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9674     ADD +1             PI-LAST-SEQ-NO-ADDED
  9675                     GIVING PI-NEXT-DISPLAY-SEQ-NO.
  9676     IF PI-MAP-NAME = VP630B
  9677         MOVE LOW-VALUES         TO MAP-B
  9678         PERFORM 8550-SET-MAP-SEQ-NOS
  9679     ELSE
  9680         MOVE SPACE              TO PI-DISPLAY-SW
  9681         MOVE LOW-VALUES         TO MAP-C
  9682         PERFORM 8550-SET-MAP-SEQ-NOS
  9683                 VARYING WS-SUB2 FROM +1 BY +1
  9684                 UNTIL WS-SUB2 GREATER +5.
  9685     GO TO 8100-SEND-INITIAL-MAP.
  9686 6880-DELETE-ERROR.
  9687
  9688* EXEC CICS UNLOCK
  9689*         DATASET (FILE-ID-ERPNDB)
  9690*    END-EXEC.
  9691*    MOVE '&*                    #   #00008989' TO DFHEIV0
  9692     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9693     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9694     MOVE X'2020233030303038393839' TO DFHEIV0(25:11)
  9695     CALL 'kxdfhei1' USING DFHEIV0,
  9696           FILE-ID-ERPNDB,
  9697           DFHEIV99
  9698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9699
  9700     MOVE ER-2901        TO EMI-ERROR.
  9701     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9702     IF PI-MAP-NAME = VP630B
  9703         MOVE -1                 TO BPFENTRL
  9704     ELSE
  9705         MOVE -1                 TO CPFENTRL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 184
* VP6301.cbl
  9706     GO TO 8200-SEND-DATAONLY.
  9707 6990-REC-NOTFND.
  9708     MOVE ER-2433                TO EMI-ERROR
  9709     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9710     IF PI-MAP-NAME = VP630B
  9711         MOVE -1                 TO BPFENTRL
  9712     ELSE
  9713         MOVE -1                 TO CPFENTRL.
  9714     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 185
* VP6301.cbl
  9716 7000-FORMAT-ISSUE-SCREEN.
  9717     MOVE 'Y'                        TO PI-DISPLAY-SW.
  9718     MOVE LOW-VALUES                 TO DATA-AREA-B.
  9719     MOVE -1                         TO BPFENTRL.
  9720     MOVE PB-BATCH-SEQ-NO            TO BSEQ.
  9721     MOVE AL-SABON                   TO BSEQ-ATTRB.
  9722     MOVE PB-CERT-PRIME              TO BCERT.
  9723     MOVE AL-SANON                   TO BCERT-ATTRB.
  9724     MOVE PB-CERT-SFX                TO BSFX.
  9725     MOVE AL-SANOF                   TO BSFX-ATTRB.
  9726     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  9727     MOVE SPACE                      TO DC-OPTION-CODE.
  9728     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9729     MOVE DC-GREG-DATE-1-MDY         TO BEFFDT.
  9730     MOVE AL-SANON                   TO BEFFDT-ATTRB.
  9731     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND1
  9732     MOVE PI-AH-OVERRIDE-L2          TO BKIND2
  9733     IF PB-I-INSURED-LAST-NAME GREATER SPACES
  9734        MOVE PB-I-INSURED-LAST-NAME  TO BLAST-NAME.
  9735     IF PB-I-INSURED-FIRST-NAME GREATER SPACES
  9736        MOVE PB-I-INSURED-FIRST-NAME TO B1ST-NAME.
  9737     IF PB-I-INSURED-MIDDLE-INIT GREATER SPACES
  9738        MOVE PB-I-INSURED-MIDDLE-INIT TO BINIT.
  9739     IF PB-I-AGE GREATER ZEROS
  9740        MOVE PB-I-AGE                TO BAGE.
  9741     IF PB-I-JOINT-AGE GREATER ZEROS
  9742        MOVE PB-I-JOINT-AGE          TO BJNT-AGE.
  9743     IF PB-I-INSURED-SEX GREATER SPACES
  9744        MOVE PB-I-INSURED-SEX        TO BSEX.
  9745     IF PB-I-LF-TERM GREATER ZEROS
  9746        MOVE PB-I-LF-TERM            TO BTERM1O.
  9747     IF PB-I-AH-TERM GREATER ZEROS
  9748        MOVE PB-I-AH-TERM            TO BTERM2O.
  9749     IF PB-I-LF-INPUT-CD GREATER SPACES
  9750        MOVE PB-I-LF-INPUT-CD        TO BTYPE1.
  9751     IF PB-I-LF-BENEFIT-AMT GREATER ZEROS
  9752        MOVE PB-I-LF-BENEFIT-AMT     TO BBENE1O.
  9753     IF PB-I-LF-ALT-BENEFIT-AMT GREATER ZEROS
  9754        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BEN1O.
  9755     IF PB-I-LF-PREMIUM-AMT GREATER ZEROS
  9756        MOVE PB-I-LF-PREMIUM-AMT     TO BPREM1O.
  9757     IF PB-I-LF-ALT-PREMIUM-AMT GREATER ZEROS
  9758        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREM1O.
  9759     IF PB-I-AH-INPUT-CD GREATER SPACES
  9760        MOVE PB-I-AH-INPUT-CD        TO BTYPE2.
  9761     IF PB-I-AH-BENEFIT-AMT GREATER ZEROS
  9762        MOVE PB-I-AH-BENEFIT-AMT     TO BBENE2O.
  9763     IF PB-I-AH-PREMIUM-AMT GREATER ZEROS
  9764        MOVE PB-I-AH-PREMIUM-AMT     TO BPREM2O.
  9765     IF PB-I-AH-CRIT-PER GREATER ZEROS
  9766        MOVE PB-I-AH-CRIT-PER           TO BCRIT-PERD2O.
  9767     IF PB-I-LOAN-OFFICER GREATER SPACES
  9768        MOVE PB-I-LOAN-OFFICER       TO BLN-OFFICER.
  9769     IF PB-I-VIN > ZEROS
  9770        MOVE PB-I-VIN            TO BVIN-NOI
  9771     END-IF
  9772     IF PB-I-JOINT-FIRST-NAME GREATER SPACES
  9773        MOVE PB-I-JOINT-FIRST-NAME   TO BJNT-1ST-NAME.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 186
* VP6301.cbl
  9774     IF PB-I-JOINT-MIDDLE-INIT GREATER SPACES
  9775        MOVE PB-I-JOINT-MIDDLE-INIT  TO BJNT-INIT.
  9776     IF PB-I-JOINT-LAST-NAME GREATER SPACES
  9777        MOVE PB-I-JOINT-LAST-NAME    TO BJNT-LST-NAME.
  9778     IF PB-I-BENEFICIARY-NAME GREATER SPACES
  9779        MOVE PB-I-BENEFICIARY-NAME   TO BBENEFICIARY.
  9780     move pb-control-by-account  to elcrtt-key
  9781     move 'C'                    to elcrtt-trlr-type
  9782     perform 4905-read-elcrtt    thru 4905-exit
  9783     if resp-normal
  9784        if cs-year numeric
  9785           move cs-year          to byearo
  9786        end-if
  9787        move cs-make             to bmakeo
  9788        move cs-model            to bmodelo
  9789        if cs-vehicle-odometer numeric
  9790           move cs-vehicle-odometer
  9791                                 to bometer-out
  9792        end-if
  9793     end-if
  9794     MOVE PB-CONTROL-PRIMARY         TO ERPNDM-KEY.
  9795
  9796* EXEC CICS HANDLE CONDITION
  9797*        NOTFND (7090-EXIT)
  9798*    END-EXEC.
  9799*    MOVE '"$I                   ! / #00009087' TO DFHEIV0
  9800     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9802     MOVE X'2F20233030303039303837' TO DFHEIV0(25:11)
  9803     CALL 'kxdfhei1' USING DFHEIV0
  9804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9805
  9806
  9807* EXEC CICS READ
  9808*        SET     (ADDRESS OF PENDING-MAILING-DATA)
  9809*        DATASET (FILE-ID-ERPNDM)
  9810*        RIDFLD  (ERPNDM-KEY)
  9811*        UPDATE
  9812*    END-EXEC.
  9813*    MOVE '&"S        EU         (   #00009090' TO DFHEIV0
  9814     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9815     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9816     MOVE X'2020233030303039303930' TO DFHEIV0(25:11)
  9817     CALL 'kxdfhei1' USING DFHEIV0,
  9818           FILE-ID-ERPNDM,
  9819           DFHEIV20,
  9820           DFHEIV99,
  9821           ERPNDM-KEY,
  9822           DFHEIV99,
  9823           DFHEIV99,
  9824           DFHEIV99
  9825     SET ADDRESS OF PENDING-MAILING-DATA TO
  9826         DFHEIV20
  9827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9828
  9829     IF PM-ADDRESS-LINE-1 GREATER SPACES
  9830        MOVE PM-ADDRESS-LINE-1       TO BADDRS1.
  9831     IF PM-ADDRESS-LINE-2 GREATER SPACES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 187
* VP6301.cbl
  9832        MOVE PM-ADDRESS-LINE-2       TO BADDRS2.
  9833     IF PM-CITY > SPACES
  9834        MOVE PM-CITY                 TO BCITY
  9835     END-IF
  9836     IF PM-STATE > SPACES
  9837        MOVE PM-STATE                TO BSTATE
  9838     END-IF
  9839     IF PM-ZIP            GREATER SPACES
  9840         MOVE SPACES               TO WS-ZIP-CODE
  9841         IF PM-CANADIAN-POST-CODE
  9842             MOVE PM-CAN-POST1     TO WS-ZIP-CAN-2-POST1
  9843             MOVE PM-CAN-POST2     TO WS-ZIP-CAN-2-POST2
  9844             MOVE WS-ZIP-CODE      TO BZIPCDE
  9845         ELSE
  9846             MOVE PM-ZIP-CODE      TO WS-ZIP-AM-2-CODE
  9847             MOVE WS-ZIP-CODE      TO BZIPCDE
  9848             IF PM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9849                 MOVE '-'          TO WS-ZIP-AM-2-DASH
  9850                 MOVE PM-ZIP-PLUS4 TO WS-ZIP-AM-2-PLUS4
  9851                 MOVE WS-ZIP-CODE  TO BZIPCDE.
  9852*    IF PM-PHONE-NO NUMERIC
  9853*       IF PM-PHONE-NO GREATER ZEROS
  9854*          MOVE PM-PHONE-NO          TO  BPHONE-NO
  9855*          INSPECT BPHONE-NO CONVERTING ' ' TO '-'.
  9856     IF PM-CRED-BENE-ADDR > SPACES
  9857        MOVE PM-CRED-BENE-ADDR       TO BCADDR1
  9858     END-IF
  9859     IF PM-CRED-BENE-ADDR2 > SPACES
  9860        MOVE PM-CRED-BENE-ADDR2     TO BCADDR2
  9861     END-IF
  9862     IF PM-CRED-BENE-CITY > SPACES
  9863        MOVE PM-CRED-BENE-CITY       TO BCCITY
  9864     END-IF
  9865     IF PM-CRED-BENE-STATE > SPACES
  9866        MOVE PM-CRED-BENE-STATE      TO BCSTATE
  9867     END-IF
  9868     IF PM-CRED-BENE-ZIP > SPACES
  9869        MOVE SPACES               TO WS-ZIP-CODE
  9870        IF PM-CB-CANADIAN-POST-CODE
  9871           MOVE PM-CB-CAN-POST1     TO WS-ZIP-CAN-2-POST1
  9872           MOVE PM-CB-CAN-POST2     TO WS-ZIP-CAN-2-POST2
  9873           MOVE WS-ZIP-CODE      TO BZIPCDE
  9874        ELSE
  9875           MOVE PM-CB-ZIP-CODE      TO WS-ZIP-AM-2-CODE
  9876           MOVE WS-ZIP-CODE      TO BCZIPCD
  9877           IF PM-CB-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9878              MOVE '-'          TO WS-ZIP-AM-2-DASH
  9879              MOVE PM-CB-ZIP-PLUS4 TO WS-ZIP-AM-2-PLUS4
  9880              MOVE WS-ZIP-CODE  TO BCZIPCD
  9881           END-IF
  9882        END-IF
  9883     END-IF
  9884     .
  9885 7090-EXIT.
  9886     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 188
* VP6301.cbl
  9888 7100-FORMAT-CANCEL-SCREEN.
  9889     MOVE 'Y'                    TO PI-DISPLAY-SW.
  9890     MOVE LOW-VALUES             TO DATA-AREA-C (2)
  9891                                    DATA-AREA-C (3).
  9892     MOVE -1                     TO CPFENTRL.
  9893     MOVE PB-BATCH-SEQ-NO        TO CSEQ        (1).
  9894     MOVE AL-SABON               TO CSEQ-ATTRB  (1).
  9895     MOVE PB-CERT-PRIME          TO CCERT       (1).
  9896     MOVE AL-SANON               TO CCERT-ATTRB (1).
  9897     MOVE PB-CERT-SFX            TO CSFX        (1).
  9898     MOVE AL-SANON               TO CSFX-ATTRB  (1).
  9899     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
  9900     MOVE SPACE                  TO DC-OPTION-CODE.
  9901     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9902     MOVE DC-GREG-DATE-1-MDY     TO CEFFDT       (1).
  9903     MOVE AL-SANON               TO CEFFDT-ATTRB (1).
  9904     MOVE PB-C-LAST-NAME         TO CLAST-NAME   (1).
  9905     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  9906        MOVE PB-C-LF-CANCEL-DT   TO DC-BIN-DATE-1
  9907        MOVE SPACE               TO DC-OPTION-CODE
  9908        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  9909        MOVE DC-GREG-DATE-1-MDY  TO CCANDT1 (1)
  9910        MOVE AL-UANON            TO CCANDT1-ATTRB (1).
  9911     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
  9912        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
  9913        MOVE SPACE               TO DC-OPTION-CODE
  9914        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  9915        MOVE DC-GREG-DATE-1-MDY  TO CCANDT2 (1)
  9916        MOVE AL-UANON            TO CCANDT2-ATTRB (1).
  9917     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
  9918        NEXT SENTENCE
  9919     ELSE
  9920        MOVE PB-C-LF-REFUND-OVERRIDE
  9921                                 TO CMTHD1 (1)
  9922        MOVE AL-UANON            TO CMTHD1-ATTRB (1).
  9923     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
  9924        NEXT SENTENCE
  9925     ELSE
  9926        MOVE PB-C-AH-REFUND-OVERRIDE
  9927                                 TO CMTHD2 (1)
  9928        MOVE AL-UANON            TO CMTHD2-ATTRB (1).
  9929     IF PB-C-LF-CANCEL-AMT NOT =  ZEROS
  9930        MOVE PB-C-LF-CANCEL-AMT  TO CREFUND1O (1)
  9931        MOVE AL-UNNON            TO CREFUND1-ATTRB (1).
  9932     IF PB-C-AH-CANCEL-AMT NOT =  ZEROS
  9933        MOVE PB-C-AH-CANCEL-AMT  TO CREFUND2O      (1)
  9934        MOVE AL-UNNON            TO CREFUND2-ATTRB (1).
  9935     IF PB-C-LIVES GREATER ZEROS
  9936        MOVE PB-C-LIVES          TO CLIVESO      (1)
  9937        MOVE AL-UNNON            TO CLIVES-ATTRB (1).
  9938     IF PB-C-CANCEL-REASON GREATER SPACES
  9939        MOVE PB-C-CANCEL-REASON  TO CCANREA (1)
  9940        MOVE AL-UANON            TO CCANREA-ATTRB (1)
  9941     END-IF
  9942*    IF PB-C-MICROFILM-NO  IS NUMERIC
  9943*        IF PB-C-MICROFILM-NO  NOT =  ZEROS
  9944*            MOVE PB-C-MICROFILM-NO
  9945*                                TO  CMICRO-NOO (1)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 189
* VP6301.cbl
  9946*            MOVE AL-UNNON       TO  CMICRO-NO-ATTRB (1).
  9947     IF PB-C-PAYEE-CODE GREATER SPACES
  9948        MOVE PB-C-PAYEE-CODE     TO CPAYEE       (1)
  9949        MOVE AL-UANON            TO CPAYEE-ATTRB (1).
  9950     IF PB-C-REFUND-SW  GREATER SPACES
  9951        MOVE PB-C-REFUND-SW      TO CCHK         (1)
  9952        MOVE AL-UANON            TO CCHK-ATTRB   (1).
  9953     IF PB-C-LAST-NAME GREATER SPACES
  9954        MOVE PB-C-LAST-NAME      TO CLAST-NAME       (1)
  9955        MOVE AL-UANON            TO CLAST-NAME-ATTRB (1).
  9956     PERFORM 7180-PROTECT-FIELDS VARYING WS-SUB2 FROM +2 BY +1
  9957                                 UNTIL WS-SUB2 GREATER +4.
  9958     GO TO 7190-EXIT.
  9959 7180-PROTECT-FIELDS.
  9960     MOVE AL-SANOF               TO CCERT-ATTRB      (WS-SUB2)
  9961                                    CSFX-ATTRB       (WS-SUB2)
  9962                                    CEFFDT-ATTRB     (WS-SUB2)
  9963                                    CLAST-NAME-ATTRB (WS-SUB2)
  9964                                    CCANDT1-ATTRB    (WS-SUB2)
  9965                                    CCANDT2-ATTRB    (WS-SUB2)
  9966                                    CMTHD1-ATTRB     (WS-SUB2)
  9967                                    CMTHD2-ATTRB     (WS-SUB2)
  9968                                    CREFUND1-ATTRB   (WS-SUB2)
  9969                                    CREFUND2-ATTRB   (WS-SUB2)
  9970                                    CCHK-ATTRB       (WS-SUB2)
  9971                                    CPAYEE-ATTRB     (WS-SUB2)
  9972                                    CLIVES-ATTRB     (WS-SUB2)
  9973                                    CCANREA-ATTRB    (WS-SUB2).
  9974 7190-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 190
* VP6301.cbl
  9976 8100-SEND-INITIAL-MAP.
  9977     IF PI-MAP-NAME = VP630B
  9978         NEXT SENTENCE
  9979     ELSE
  9980         GO TO 8110-SEND-INITIAL-CANCEL-MAP.
  9981*    MOVE PI-MEMBER-CAPTION        TO BCAPTNO.
  9982     IF EIBAID NOT = DFHPF1   AND
  9983        EIBAID NOT = DFHPF2   AND
  9984        EIBAID NOT = DFHPF5   AND
  9985        PI-MAINT-FUNC NOT = 'B'
  9986          PERFORM 0600-PROTECT-FIELDS THRU 0600-EXIT.
  9987     MOVE PI-SAV-ENTRY-BATCH     TO BBATCHO.
  9988     MOVE PI-AM-NAME             TO BACCTNMO
  9989     IF ((PI-AM-ADDR1 NOT = SPACES)
  9990        OR (PI-AM-ADDR2 NOT = SPACES))
  9991        IF BNFICRYO (1:5) = LOW-VALUES OR '_____'
  9992           MOVE PI-AM-NAME       TO BNFICRYO
  9993           MOVE AL-UANON         TO BBENEFICIARY-ATTRB
  9994        END-IF
  9995        IF BCADDR1 (1:5) = LOW-VALUES OR '_____'
  9996           MOVE PI-AM-ADDR2      TO BCADDR1
  9997           MOVE AL-UANON         TO BCADDR1-ATTRB
  9998        END-IF
  9999        IF BCADDR2 = SPACES OR LOW-VALUES
 10000*          MOVE PI-AM-ADDR2      TO BCADDR2
 10001           MOVE AL-UANON         TO BCADDR2-ATTRB
 10002        END-IF
 10003        IF BCCITY = SPACES OR LOW-VALUES
 10004           MOVE PI-AM-CITY       TO BCCITY
 10005           MOVE AL-UANON         TO BCCITY-ATTRB
 10006        END-IF
 10007        IF BCSTATE = SPACES OR LOW-VALUES
 10008           MOVE PI-AM-STATE      TO BCSTATE
 10009           MOVE AL-UANON         TO BCSTATE-ATTRB
 10010        END-IF
 10011        IF BCZIPCD = SPACES OR LOW-VALUES
 10012           MOVE PI-AM-ZIP        TO BCZIPCD
 10013           MOVE AL-UANON         TO BCZIPCD-ATTRB
 10014        END-IF
 10015     END-IF
 10016     IF PI-AM-EDIT-LOAN-OFC = 'N'
 10017        MOVE AL-SANOF            TO BLN-OFFICER-ATTRB
 10018     END-IF
 10019     IF PI-MAIL-YES
 10020        continue
 10021     ELSE
 10022        MOVE AL-SANOF            TO BADDRS1-ATTRB
 10023                                    BADDRS2-ATTRB
 10024                                    BCITY-ATTRB
 10025                                    BSTATE-ATTRB
 10026                                    BZIPCDE-ATTRB
 10027*                                   BZIP4-ATTRB
 10028*                                   BPHONE-ATTRB
 10029     END-IF
 10030     IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10031        MOVE AL-SADOF            TO balt-ben2-attrb
 10032                                    balt-prem2-attrb
 10033     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 191
* VP6301.cbl
 10034     IF PI-COMPANY-ID NOT = 'DCC' and 'CID' and 'VPP'
 10035        MOVE AL-SADOF            TO BVINHD-ATTRB
 10036                                    BVIN-ATTRB
 10037     END-IF
 10038*    IF PI-LAST-FUNC-DISPLAY
 10039*          MOVE AL-SADOF            TO BCERTV-ATTRB
 10040*                                      BSFXV-ATTRB
 10041*                                      BEFFDTV-ATTRB
 10042*                                      BLAST-NAMEV-ATTRB
 10043*    ELSE
 10044*       IF PI-COMPANY-ID = ('PEM' OR 'CRI')
 10045*          MOVE AL-UANOF            TO BCERTV-ATTRB
 10046*                                      BSFXV-ATTRB
 10047*                                      BEFFDTV-ATTRB
 10048*                                      BLAST-NAMEV-ATTRB
 10049*       ELSE
 10050*          MOVE AL-SADOF            TO BCERTV-ATTRB
 10051*                                      BSFXV-ATTRB
 10052*                                      BEFFDTV-ATTRB
 10053*                                      BLAST-NAMEV-ATTRB.
 10054     IF PI-LAST-FUNC-DISPLAY
 10055        NEXT SENTENCE
 10056     ELSE
 10057        IF PI-COMPANY-ID = 'PEM' OR 'CRI'
 10058           MOVE AL-UADOF            TO BCERT-ATTRB
 10059                                       BSFX-ATTRB
 10060                                       BEFFDT-ATTRB
 10061                                       BLAST-NAME-ATTRB
 10062        ELSE
 10063           MOVE AL-UANOF            TO BCERT-ATTRB
 10064                                       BEFFDT-ATTRB.
 10065     IF PI-NB-MONTH-END-DT NOT = SPACES
 10066        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-1
 10067       ELSE
 10068        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-1.
 10069     MOVE SPACE                  TO DC-OPTION-CODE.
 10070     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10071     MOVE DC-GREG-DATE-1-EDIT    TO BMOENDO.
 10072     MOVE WS-CURRENT-DT          TO BDATEO.
 10073     MOVE EIBTIME                TO TIME-IN.
 10074     MOVE TIME-OUT               TO BTIMEO.
 10075     MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1
 10076     MOVE AL-SABOF               TO BKIND1-ATTRB
 10077     MOVE PI-AH-OVERRIDE-L2      TO BKIND2
 10078     MOVE AL-SABOF               TO BKIND2-ATTRB
 10079     IF PI-DATA-ERRORS
 10080        MOVE SPACE               TO PI-ERROR-SW
 10081     ELSE
 10082        IF EIBAID = DFHPF1 OR DFHPF2
 10083           CONTINUE
 10084        ELSE
 10085           MOVE -1               TO BEFFDTL
 10086         END-IF
 10087     END-IF
 10088     MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O.
 10089     MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O.
 10090
 10091* EXEC CICS SEND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 192
* VP6301.cbl
 10092*        MAP      (PI-MAP-NAME)
 10093*        MAPSET   (MAPSET-VP6301S)
 10094*        FROM     (VP630BI)
 10095*        ERASE
 10096*        CURSOR
 10097*    END-EXEC.
 10098     MOVE LENGTH OF
 10099      VP630BI
 10100       TO DFHEIV12
 10101     MOVE -1
 10102       TO DFHEIV11
 10103*    MOVE '8$     CT  E    H L F ,   #00009357' TO DFHEIV0
 10104     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10105     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10106     MOVE X'2020233030303039333537' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0,
 10108           PI-MAP-NAME,
 10109           VP630BI,
 10110           DFHEIV12,
 10111           MAPSET-VP6301S,
 10112           DFHEIV99,
 10113           DFHEIV99,
 10114           DFHEIV99,
 10115           DFHEIV11,
 10116           DFHEIV99,
 10117           DFHEIV99,
 10118           DFHEIV99
 10119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10120
 10121     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 193
* VP6301.cbl
 10123 8110-SEND-INITIAL-CANCEL-MAP.
 10124     IF EIBAID NOT = DFHPF5  AND
 10125        EIBAID NOT = DFHPF1  AND
 10126        EIBAID NOT = DFHPF2  AND
 10127        PI-MAINT-FUNC NOT = 'B'
 10128          PERFORM 0700-PROTECT-FIELDS THRU 0700-EXIT.
 10129     MOVE PI-SAV-ENTRY-BATCH     TO CBATCHO.
 10130     MOVE PI-AM-NAME             TO CACCTNMO.
 10131     IF PI-NB-MONTH-END-DT NOT = SPACES
 10132        MOVE PI-NB-MONTH-END-DT  TO DC-BIN-DATE-1
 10133       ELSE
 10134        MOVE PI-CR-MONTH-END-DT  TO DC-BIN-DATE-1.
 10135     MOVE SPACE                  TO DC-OPTION-CODE.
 10136     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10137     MOVE DC-GREG-DATE-1-EDIT    TO CMOENDO.
 10138     MOVE WS-CURRENT-DT          TO CDATEO.
 10139     MOVE EIBTIME                TO TIME-IN.
 10140     MOVE TIME-OUT               TO CTIMEO.
 10141     MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1 (1)
 10142                                    CKIND1 (2)
 10143                                    CKIND1 (3)
 10144                                    CKIND1 (4).
 10145     MOVE PI-AH-OVERRIDE-L2      TO CKIND2 (1)
 10146                                    CKIND2 (2)
 10147                                    CKIND2 (3)
 10148                                    CKIND2 (4).
 10149     MOVE AL-SABOF               TO CKIND1-ATTRB (1)
 10150                                    CKIND1-ATTRB (2)
 10151                                    CKIND1-ATTRB (3)
 10152                                    CKIND1-ATTRB (4)
 10153                                    CKIND2-ATTRB (1)
 10154                                    CKIND2-ATTRB (2)
 10155                                    CKIND2-ATTRB (3)
 10156                                    CKIND2-ATTRB (4).
 10157     IF PI-DATA-ERRORS
 10158         MOVE SPACE              TO PI-ERROR-SW
 10159     ELSE
 10160         IF EIBAID = DFHPF1 OR DFHPF2
 10161             NEXT SENTENCE
 10162         ELSE
 10163             MOVE -1             TO CCERT1L.
 10164     MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O.
 10165     MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O.
 10166
 10167* EXEC CICS SEND
 10168*        MAP      (PI-MAP-NAME)
 10169*        MAPSET   (MAPSET-VP6301S)
 10170*        FROM     (VP630BI)
 10171*        ERASE
 10172*        CURSOR
 10173*    END-EXEC.
 10174     MOVE LENGTH OF
 10175      VP630BI
 10176       TO DFHEIV12
 10177     MOVE -1
 10178       TO DFHEIV11
 10179*    MOVE '8$     CT  E    H L F ,   #00009409' TO DFHEIV0
 10180     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 194
* VP6301.cbl
 10181     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10182     MOVE X'2020233030303039343039' TO DFHEIV0(25:11)
 10183     CALL 'kxdfhei1' USING DFHEIV0,
 10184           PI-MAP-NAME,
 10185           VP630BI,
 10186           DFHEIV12,
 10187           MAPSET-VP6301S,
 10188           DFHEIV99,
 10189           DFHEIV99,
 10190           DFHEIV99,
 10191           DFHEIV11,
 10192           DFHEIV99,
 10193           DFHEIV99,
 10194           DFHEIV99
 10195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10196
 10197     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 195
* VP6301.cbl
 10199 8200-SEND-DATAONLY.
 10200     MOVE SPACE              TO PI-ERROR-SW.
 10201     IF PI-MAP-NAME = VP630B
 10202*        MOVE PI-MEMBER-CAPTION      TO BCAPTNO
 10203         MOVE WS-CURRENT-DT          TO BDATEO
 10204         MOVE EIBTIME                TO TIME-IN
 10205         MOVE TIME-OUT               TO BTIMEO
 10206         MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 10207         MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 10208
 10209* EXEC CICS SEND
 10210*            MAP      (PI-MAP-NAME)
 10211*            MAPSET   (MAPSET-VP6301S)
 10212*            FROM     (VP630BI)
 10213*            DATAONLY
 10214*            CURSOR
 10215*        END-EXEC
 10216     MOVE LENGTH OF
 10217      VP630BI
 10218       TO DFHEIV12
 10219     MOVE -1
 10220       TO DFHEIV11
 10221*    MOVE '8$D    CT       H L F ,   #00009427' TO DFHEIV0
 10222     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10223     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10224     MOVE X'2020233030303039343237' TO DFHEIV0(25:11)
 10225     CALL 'kxdfhei1' USING DFHEIV0,
 10226           PI-MAP-NAME,
 10227           VP630BI,
 10228           DFHEIV12,
 10229           MAPSET-VP6301S,
 10230           DFHEIV99,
 10231           DFHEIV99,
 10232           DFHEIV99,
 10233           DFHEIV11,
 10234           DFHEIV99,
 10235           DFHEIV99,
 10236           DFHEIV99
 10237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10238     ELSE
 10239         MOVE WS-CURRENT-DT          TO CDATEO
 10240         MOVE EIBTIME                TO TIME-IN
 10241         MOVE TIME-OUT               TO CTIMEO
 10242         MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 10243         MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 10244
 10245* EXEC CICS SEND
 10246*            MAP      (PI-MAP-NAME)
 10247*            MAPSET   (MAPSET-VP6301S)
 10248*            FROM     (VP630BI)
 10249*            DATAONLY
 10250*            CURSOR
 10251*        END-EXEC.
 10252     MOVE LENGTH OF
 10253      VP630BI
 10254       TO DFHEIV12
 10255     MOVE -1
 10256       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 196
* VP6301.cbl
 10257*    MOVE '8$D    CT       H L F ,   #00009440' TO DFHEIV0
 10258     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10259     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10260     MOVE X'2020233030303039343430' TO DFHEIV0(25:11)
 10261     CALL 'kxdfhei1' USING DFHEIV0,
 10262           PI-MAP-NAME,
 10263           VP630BI,
 10264           DFHEIV12,
 10265           MAPSET-VP6301S,
 10266           DFHEIV99,
 10267           DFHEIV99,
 10268           DFHEIV99,
 10269           DFHEIV11,
 10270           DFHEIV99,
 10271           DFHEIV99,
 10272           DFHEIV99
 10273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10274
 10275     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 197
* VP6301.cbl
 10277 8300-SEND-TEXT.
 10278
 10279* EXEC CICS SEND TEXT
 10280*        FROM     (LOGOFF-TEXT)
 10281*        LENGTH   (LOGOFF-LENGTH)
 10282*        ERASE
 10283*        FREEKB
 10284*    END-EXEC.
 10285*    MOVE '8&      T  E F  H   F -   #00009450' TO DFHEIV0
 10286     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10287     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10288     MOVE X'2020233030303039343530' TO DFHEIV0(25:11)
 10289     CALL 'kxdfhei1' USING DFHEIV0,
 10290           LOGOFF-TEXT,
 10291           LOGOFF-LENGTH,
 10292           DFHEIV99,
 10293           DFHEIV99,
 10294           DFHEIV99,
 10295           DFHEIV99,
 10296           DFHEIV99,
 10297           DFHEIV99,
 10298           DFHEIV99,
 10299           DFHEIV99,
 10300           DFHEIV99,
 10301           DFHEIV99
 10302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10303
 10304
 10305* EXEC CICS RETURN
 10306*    END-EXEC.
 10307*    MOVE '.(                    ''   #00009456' TO DFHEIV0
 10308     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10309     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10310     MOVE X'2020233030303039343536' TO DFHEIV0(25:11)
 10311     CALL 'kxdfhei1' USING DFHEIV0,
 10312           DFHEIV99,
 10313           DFHEIV99,
 10314           DFHEIV99,
 10315           DFHEIV99,
 10316           DFHEIV99,
 10317           DFHEIV99
 10318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10319
 10320 8350-SEND-WARNING.
 10321
 10322* EXEC CICS SEND TEXT
 10323*        FROM     (WARNING-TEXT)
 10324*        LENGTH   (WARNING-LENGTH)
 10325*        ERASE
 10326*        FREEKB
 10327*    END-EXEC.
 10328*    MOVE '8&      T  E F  H   F -   #00009459' TO DFHEIV0
 10329     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10330     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10331     MOVE X'2020233030303039343539' TO DFHEIV0(25:11)
 10332     CALL 'kxdfhei1' USING DFHEIV0,
 10333           WARNING-TEXT,
 10334           WARNING-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 198
* VP6301.cbl
 10335           DFHEIV99,
 10336           DFHEIV99,
 10337           DFHEIV99,
 10338           DFHEIV99,
 10339           DFHEIV99,
 10340           DFHEIV99,
 10341           DFHEIV99,
 10342           DFHEIV99,
 10343           DFHEIV99,
 10344           DFHEIV99
 10345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10346
 10347     GO TO 9100-RETURN-TRAN.
 10348 8400-LOG-JOURNAL-RECORD.
 10349     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 10350     MOVE THIS-PGM                TO JP-PROGRAM-ID.
 10351*    EXEC CICS JOURNAL
 10352*        JFILEID     (PI-JOURNAL-FILE-ID)
 10353*        JTYPEID     ('EL')
 10354*        FROM        (JOURNAL-RECORD)
 10355*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 10356*        END-EXEC.
 10357 8500-DATE-CONVERT.
 10358
 10359* EXEC CICS LINK
 10360*        PROGRAM  (LINK-ELDATCV)
 10361*        COMMAREA (DATE-CONVERSION-DATA)
 10362*        LENGTH   (DC-COMM-LENGTH)
 10363*    END-EXEC.
 10364*    MOVE '."C                   (   #00009476' TO DFHEIV0
 10365     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10366     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10367     MOVE X'2020233030303039343736' TO DFHEIV0(25:11)
 10368     CALL 'kxdfhei1' USING DFHEIV0,
 10369           LINK-ELDATCV,
 10370           DATE-CONVERSION-DATA,
 10371           DC-COMM-LENGTH,
 10372           DFHEIV99,
 10373           DFHEIV99,
 10374           DFHEIV99,
 10375           DFHEIV99
 10376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10377
 10378 8500-EXIT.
 10379     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 199
* VP6301.cbl
 10381 8550-SET-MAP-SEQ-NOS.
 10382     IF PI-MAP-NAME = VP630B
 10383         MOVE PI-NEXT-DISPLAY-SEQ-NO TO BSEQ
 10384         MOVE AL-SABON               TO BSEQ-ATTRB
 10385     ELSE
 10386         MOVE PI-NEXT-DISPLAY-SEQ-NO TO CSEQ (WS-SUB2)
 10387         MOVE AL-SABON               TO CSEQ-ATTRB (WS-SUB2).
 10388     ADD +1  TO PI-NEXT-DISPLAY-SEQ-NO.
 10389 8555-EXIT.
 10390     EXIT.
 10391 8600-DEEDIT.
 10392
 10393* EXEC CICS BIF DEEDIT
 10394*        FIELD   (DEEDIT-FIELD)
 10395*        LENGTH  (15)
 10396*    END-EXEC.
 10397     MOVE 15
 10398       TO DFHEIV11
 10399*    MOVE '@"L                   #   #00009495' TO DFHEIV0
 10400     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10401     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10402     MOVE X'2020233030303039343935' TO DFHEIV0(25:11)
 10403     CALL 'kxdfhei1' USING DFHEIV0,
 10404           DEEDIT-FIELD,
 10405           DFHEIV11
 10406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10407
 10408 8600-EXIT.
 10409     EXIT.
 10410 8800-UNAUTHORIZED-ACCESS.
 10411     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10412     GO TO 8300-SEND-TEXT.
 10413 9000-RETURN-CICS.
 10414
 10415* EXEC CICS RETURN
 10416*    END-EXEC.
 10417*    MOVE '.(                    ''   #00009505' TO DFHEIV0
 10418     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10419     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10420     MOVE X'2020233030303039353035' TO DFHEIV0(25:11)
 10421     CALL 'kxdfhei1' USING DFHEIV0,
 10422           DFHEIV99,
 10423           DFHEIV99,
 10424           DFHEIV99,
 10425           DFHEIV99,
 10426           DFHEIV99,
 10427           DFHEIV99
 10428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10429
 10430 9100-RETURN-TRAN.
 10431     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10432     IF  PI-MAP-NAME = VP630B
 10433         MOVE '630B'             TO PI-CURRENT-SCREEN-NO.
 10434     IF  PI-MAP-NAME = VP630C
 10435         MOVE '630C'             TO PI-CURRENT-SCREEN-NO.
 10436
 10437* EXEC CICS RETURN
 10438*        TRANSID    (TRANS-EXA6)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 200
* VP6301.cbl
 10439*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10440*        LENGTH     (WS-COMM-LENGTH)
 10441*    END-EXEC.
 10442*    MOVE '.(CT                  ''   #00009513' TO DFHEIV0
 10443     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10444     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10445     MOVE X'2020233030303039353133' TO DFHEIV0(25:11)
 10446     CALL 'kxdfhei1' USING DFHEIV0,
 10447           TRANS-EXA6,
 10448           PROGRAM-INTERFACE-BLOCK,
 10449           WS-COMM-LENGTH,
 10450           DFHEIV99,
 10451           DFHEIV99,
 10452           DFHEIV99
 10453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10454
 10455 9300-XCTL.
 10456
 10457* EXEC CICS XCTL
 10458*        PROGRAM    (PGM-NAME)
 10459*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10460*        LENGTH     (WS-COMM-LENGTH)
 10461*    END-EXEC.
 10462*    MOVE '.$C                   %   #00009519' TO DFHEIV0
 10463     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10464     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10465     MOVE X'2020233030303039353139' TO DFHEIV0(25:11)
 10466     CALL 'kxdfhei1' USING DFHEIV0,
 10467           PGM-NAME,
 10468           PROGRAM-INTERFACE-BLOCK,
 10469           WS-COMM-LENGTH,
 10470           DFHEIV99
 10471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10472
 10473 9400-CLEAR.
 10474     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 10475     GO TO 9300-XCTL.
 10476 9500-PF12.
 10477     MOVE XCTL-EL010             TO PGM-NAME.
 10478     GO TO 9300-XCTL.
 10479 9600-PGMID-ERROR.
 10480
 10481* EXEC CICS HANDLE CONDITION
 10482*        PGMIDERR    (8300-SEND-TEXT)
 10483*    END-EXEC.
 10484*    MOVE '"$L                   ! 0 #00009531' TO DFHEIV0
 10485     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10487     MOVE X'3020233030303039353331' TO DFHEIV0(25:11)
 10488     CALL 'kxdfhei1' USING DFHEIV0
 10489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10490
 10491     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10492     MOVE ' '                    TO PI-ENTRY-CD-1.
 10493     MOVE XCTL-EL005            TO PGM-NAME.
 10494     MOVE PGM-NAME               TO LOGOFF-PGM.
 10495     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10496     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 201
* VP6301.cbl
 10497 9900-ERROR-FORMAT.
 10498     IF PI-MAP-NAME = VP630B
 10499        MOVE 2                   TO EMI-NUMBER-OF-LINES
 10500       ELSE
 10501        MOVE 1                   TO EMI-NUMBER-OF-LINES.
 10502     IF NOT EMI-ERRORS-COMPLETE
 10503         MOVE LINK-EL001         TO PGM-NAME
 10504
 10505* EXEC CICS LINK
 10506*            PROGRAM    (PGM-NAME)
 10507*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10508*            LENGTH     (EMI-COMM-LENGTH)
 10509*        END-EXEC.
 10510*    MOVE '."C                   (   #00009547' TO DFHEIV0
 10511     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10513     MOVE X'2020233030303039353437' TO DFHEIV0(25:11)
 10514     CALL 'kxdfhei1' USING DFHEIV0,
 10515           PGM-NAME,
 10516           ERROR-MESSAGE-INTERFACE-BLOCK,
 10517           EMI-COMM-LENGTH,
 10518           DFHEIV99,
 10519           DFHEIV99,
 10520           DFHEIV99,
 10521           DFHEIV99
 10522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10523
 10524 9900-EXIT.
 10525     EXIT.
 10526 9990-ABEND.
 10527     MOVE LINK-EL004             TO PGM-NAME.
 10528     MOVE DFHEIBLK               TO EMI-LINE1.
 10529
 10530* EXEC CICS LINK
 10531*        PROGRAM   (PGM-NAME)
 10532*        COMMAREA  (EMI-LINE1)
 10533*        LENGTH    (72)
 10534*    END-EXEC.
 10535     MOVE 72
 10536       TO DFHEIV11
 10537*    MOVE '."C                   (   #00009557' TO DFHEIV0
 10538     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10540     MOVE X'2020233030303039353537' TO DFHEIV0(25:11)
 10541     CALL 'kxdfhei1' USING DFHEIV0,
 10542           PGM-NAME,
 10543           EMI-LINE1,
 10544           DFHEIV11,
 10545           DFHEIV99,
 10546           DFHEIV99,
 10547           DFHEIV99,
 10548           DFHEIV99
 10549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10550
 10551     IF PI-MAP-NAME = VP630B
 10552         MOVE -1 TO BPFENTRL
 10553     ELSE
 10554         MOVE -1 TO CPFENTRL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 202
* VP6301.cbl
 10555     GO TO 8200-SEND-DATAONLY.
 10556
 10557* GOBACK.
 10558     MOVE '9%                    "   ' TO DFHEIV0
 10559     MOVE 'VP6301' TO DFHEIV1
 10560     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10561     GOBACK.
 10562 9995-SECURITY-VIOLATION.
 10563*    COPY ELCSCTP.
 10564******************************************************************
 10565*                                                                *
 10566*                            ELCSCTP                             *
 10567*                            VMOD=2.001                          *
 10568*                                                                *
 10569*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10570******************************************************************
 10571
 10572
 10573     MOVE EIBDATE          TO SM-JUL-DATE.
 10574     MOVE EIBTRMID         TO SM-TERMID.
 10575     MOVE THIS-PGM         TO SM-PGM.
 10576     MOVE EIBTIME          TO TIME-IN.
 10577     MOVE TIME-OUT         TO SM-TIME.
 10578     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10579
 10580
 10581* EXEC CICS LINK
 10582*         PROGRAM  ('EL003')
 10583*         COMMAREA (SECURITY-MESSAGE)
 10584*         LENGTH   (80)
 10585*    END-EXEC.
 10586     MOVE 'EL003' TO DFHEIV1
 10587     MOVE 80
 10588       TO DFHEIV11
 10589*    MOVE '."C                   (   #00009586' TO DFHEIV0
 10590     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10592     MOVE X'2020233030303039353836' TO DFHEIV0(25:11)
 10593     CALL 'kxdfhei1' USING DFHEIV0,
 10594           DFHEIV1,
 10595           SECURITY-MESSAGE,
 10596           DFHEIV11,
 10597           DFHEIV99,
 10598           DFHEIV99,
 10599           DFHEIV99,
 10600           DFHEIV99
 10601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10602
 10603
 10604******************************************************************
 10605
 10606 9995-EXIT.
 10607     EXIT.
 10608
 10609 9999-DFHBACK SECTION.
 10610     MOVE '9%                    "   ' TO DFHEIV0
 10611     MOVE 'VP6301' TO DFHEIV1
 10612     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 203
* VP6301.cbl
 10613     GOBACK.
 10614 9999-DFHEXIT.
 10615     IF DFHEIGDJ EQUAL 0001
 10616         NEXT SENTENCE
 10617     ELSE IF DFHEIGDJ EQUAL 2
 10618         GO TO 9600-PGMID-ERROR,
 10619               9990-ABEND
 10620         DEPENDING ON DFHEIGDI
 10621     ELSE IF DFHEIGDJ EQUAL 3
 10622         GO TO 1078-NO-RECORD,
 10623               1078-NO-RECORD
 10624         DEPENDING ON DFHEIGDI
 10625     ELSE IF DFHEIGDJ EQUAL 4
 10626         GO TO 2020-END-FILE
 10627         DEPENDING ON DFHEIGDI
 10628     ELSE IF DFHEIGDJ EQUAL 5
 10629         GO TO 2100-BROWSE-BKWD
 10630         DEPENDING ON DFHEIGDI
 10631     ELSE IF DFHEIGDJ EQUAL 6
 10632         GO TO 3300-REC-NOT-FND
 10633         DEPENDING ON DFHEIGDI
 10634     ELSE IF DFHEIGDJ EQUAL 7
 10635         GO TO 3200-END-BROWSE
 10636         DEPENDING ON DFHEIGDI
 10637     ELSE IF DFHEIGDJ EQUAL 8
 10638         GO TO 4100-ADD-ISSUE-RECORD
 10639         DEPENDING ON DFHEIGDI
 10640     ELSE IF DFHEIGDJ EQUAL 9
 10641         GO TO 4185-ADD-MAILING-RECORD
 10642         DEPENDING ON DFHEIGDI
 10643     ELSE IF DFHEIGDJ EQUAL 10
 10644         GO TO 4200-DUPLICATE-ALT-INDEX
 10645         DEPENDING ON DFHEIGDI
 10646     ELSE IF DFHEIGDJ EQUAL 11
 10647         GO TO 4185-ADD-MAILING-RECORD
 10648         DEPENDING ON DFHEIGDI
 10649     ELSE IF DFHEIGDJ EQUAL 12
 10650         GO TO 5100-ADD-CANCEL-RECORD
 10651         DEPENDING ON DFHEIGDI
 10652     ELSE IF DFHEIGDJ EQUAL 13
 10653         GO TO 5200-DUPLICATE-ALT-INDEX
 10654         DEPENDING ON DFHEIGDI
 10655     ELSE IF DFHEIGDJ EQUAL 14
 10656         GO TO 6990-REC-NOTFND
 10657         DEPENDING ON DFHEIGDI
 10658     ELSE IF DFHEIGDJ EQUAL 15
 10659         GO TO 7090-EXIT
 10660         DEPENDING ON DFHEIGDI
 10661     ELSE IF DFHEIGDJ EQUAL 16
 10662         GO TO 8300-SEND-TEXT
 10663         DEPENDING ON DFHEIGDI.
 10664     MOVE '9%                    "   ' TO DFHEIV0
 10665     MOVE 'VP6301' TO DFHEIV1
 10666     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10667     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:08 Page 204
* VP6301.cbl
* Total Messages:     0
* Data:        6824     Code:       33737
