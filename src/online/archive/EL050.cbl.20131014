00001  IDENTIFICATION DIVISION.
00002
00003  PROGRAM-ID.                 EL050 .
00004 *              PROGRAM CONVERTED BY
00005 *              COBOL CONVERSION AID PO 5785-ABJ
00006 *              CONVERSION DATE 06/07/94 08:48:38.
00007 *            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
00008 *                            VMOD=2.032.
00008 *
00009
00010 *AUTHOR.     LOGIC, INC.
00011 *            DALLAS, TEXAS.
00024
00025 *REMARKS.
00026 *            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
00027 *            ON-LINE CREDIT SYSTEM.
00028 *
121802******************************************************************
121802*                   C H A N G E   L O G
121802*
121802* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
121802*-----------------------------------------------------------------
121802*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
121802* EFFECTIVE    NUMBER
121802*-----------------------------------------------------------------
121802* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
100703* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
100703*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
062904* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
062904*                                IS OPEN OR CNC DT < PD THRU
111504* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
083106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
030309* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
042709* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
012010* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
060710* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
011211* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
050311* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
042412* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
061412* 061412  CR2011022800001  AJRA  NAPERSOFT
062712* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
071712* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
121712* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
011413* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
121802******************************************************************
00029  ENVIRONMENT DIVISION.
00030
00031  DATA DIVISION.
00032      EJECT
00033  WORKING-STORAGE SECTION.
       01  DFH-START PIC X(04).
00034
00035  77  FILLER   PIC X(32) VALUE '********************************'.
00036  77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
00037  77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
00038
00039  77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
00040  77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
00041                                    USAGE POINTER.
00042  77  FILLER                        PIC S9(8)   COMP VALUE +0.
00043  77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
00044  77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
00045                                    USAGE IS POINTER.
00046  77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
00047  77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
00048                                    USAGE IS POINTER.
00049  77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
00050  77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
00051                                    USAGE IS POINTER.
00052
00053  77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
00054  77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
00055                                    USAGE IS POINTER.
00056
00057 *    COPY ELC50WS.
00001 *****************************************************************
00002 *                                                               *
00003 *                            ELC50WS.                           *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.061.                        *
00006 *                                                               *
00007 *   THIS IS THE WORKING STORAGE FOR EL050                       *
00008 *                                   EL517                       *
00009 *****************************************************************
122002******************************************************************
122002*                   C H A N G E   L O G
122002*
122002* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
122002*-----------------------------------------------------------------
122002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
122002* EFFECTIVE    NUMBER
122002*-----------------------------------------------------------------
123102* 123102                   PEMA  ADD DCC PROCESSING
082003* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
082203* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
100703* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
040504* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
111504* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
121304* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
071305* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
092205* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
042106* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
052306* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
071906* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
081606* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
083106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
101706* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
062707* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
022608* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
090408* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
102908* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
030309* 030309  CR2009021700001  PEMA  ADD ER-2883
042709* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
011410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
012010* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
071910* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
101010* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
011211* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
020711* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
020711* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
071211* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
092311* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
110811* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
112911* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
061412* 061412  CR2011022800001  AJRA  NAPERSOFT
121712* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
012213* 012213  CR2013011600001  PEMA  ADD ERROR 3058
031513* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
012010*-----------------------------------------------------------------
00010
00011  01  WORK-AREAS.
00012
00013 *****************************************************************
00014 *        WORKING STORAGE AREA FOR CLIENT-MON                    *
00015 *****************************************************************
00016
00017      12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
00018      12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
00019      12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
00020      12  WS-NAME-EDIT-WORK-AREA.
00021          16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
00022          16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
00023              20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
00024          16  WS-WORK-NAME.
00025              20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
00026              20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
00027              20  FILLER           PIC X(10)     VALUE SPACES.
00028          16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
00029              20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
00030
00031 *****************************************************************
00032 *        END OF WORKING STORAGE FOR CLIENT-MON                  *
00033 *****************************************************************
00034
00035      12  WS-ERRESC-KEY.
00036          16 WS-ERRESC-SEARCH-KEY.
00037              20  WS-ERRESC-COMPANY-CD PIC  X.
00038              20  WS-ERRESC-CARRIER    PIC  X.
00039              20  WS-ERRESC-GROUP      PIC X(6).
00040              20  WS-ERRESC-STATE      PIC XX.
00041              20  WS-ERRESC-ACCOUNT    PIC X(10).
00042          16 WS-ERRESC-RESIDUAL-KEY.
00043              20  WS-ERRESC-AGENT      PIC X(10).
00044              20  WS-ERRESC-RES-STATE  PIC XX.
00045              20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
00046 *                                          YYYYMMDD
00047      12  WS-COMMISSION                PIC SV9(5) COMP-3.
00048      12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
00049
00050 *RESIDENT STATE TAX MASTER(ERRESS)
00051 *
00052      12  WS-ERRESS-KEY.
00053          16  WS-ERRESS-COMPANY-CD      PIC  X.
00054          16  WS-ERRESS-RESIDENT-STATE  PIC XX.
00055          16  WS-ERRESS-COVERAGE-CAT    PIC  X.
00056          16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
00057 *                                          YYYYMMDD
00058
00059      12  WS-CONTRACT-DATE              PIC 9(8).
00060 *                                          YYYYMMDD
00061      12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
00062      12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
00063          16 WS-YEAR-YY                 PIC   9999.
00064          16 FILLER                     PIC 9(4).
00065 *                                          YYYYMMDD
00066      12  WS-SAVE-ERRESS-KEY            PIC X(9).
00067      12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
00068      12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
00069      12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
00070
00071      12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
00072          88  DPRB-1ST-TIME                      VALUE ' '.
00073
00074 *****************************************************************
00075 *        END OF WORKING STORAGE FOR CLIENT-DMD                  *
00076 *****************************************************************
00077
100703     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
CIDMOD     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
PEMMOD     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
PEMMOD     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
PEMMOD     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
012010     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
00078      12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
00079      12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
00080      12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
00081      12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
00082          88 POLICY-HAS-AH            VALUE '01' THRU '89'.
00083          88 NO-AH-COVERAGE           VALUE '  ' '00'.
00084      12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
00085          88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
00086          88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
00087      12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
00088
00089      12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
00090      12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
00091
00092      12  WS-R78-METHOD            PIC X         VALUE SPACES.
00093      12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
00094      12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
00095      12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
00096      12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
00097      12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
00098      12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
00099      12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
00100      12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
00101      12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
00102      12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
00103      12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
00104      12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
00105      12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
00106      12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
00107      12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
00108      12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
00109      12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
00110      12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
00111      12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
00112      12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
00113      12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
00114      12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
00115      12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
00116      12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
00117      12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
00118      12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
00119      12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
00120      12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
00121      12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
00122      12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
00123      12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
00124      12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
00125      12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
00126      12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
00127      12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
00128      12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
00129      12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
00130      12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
00131      12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
00132      12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
00133      12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
00134      12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
00135      12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
00136      12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
00137      12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
00138      12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
00139      12  WS-IG-OVRD               PIC X         VALUE SPACES.
00140      12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
00141      12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
00142      12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
00143      12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
00144      12  WS-2671-SW               PIC X         VALUE SPACE.
00145      12  WS-2672-SW               PIC X         VALUE SPACE.
00146      12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
00147          88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
00148      12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
00149          88  CANCEL-FUTURE-DT                   VALUE 'Y'.
00150      12  W-BROWSE-SW              PIC X         VALUE SPACE.
00151
00152      12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
00153          88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
00154          88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
00155          88  ERFORM-FILE-ADDRESSED              VALUE '3'.
00156          88  ERACCT-FILE-ADDRESSED              VALUE '4'.
00157
00158      12  WS-CREDIT-EDIT-CONTROLS.
00159          16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
00160          16  WS-MIN-AGE           PIC 99                VALUE  0.
00161          16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
00162          16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
00163          16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
00164          16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
00165
121712     12  WS-AGE-FIELDS.
121712         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
121712         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
121712         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
121712         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
121712
00166      12  WS-SAVE-ALLOWABLE-BENEFIT.
00167          16  WS-SAVE-BENEFIT-CODE       PIC XX.
00168          16  WS-SAVE-BENEFIT-TYPE       PIC X.
00169          16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
00170          16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
00171          16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
00172          16  FILLER                      PIC XX.
00173
00174      12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
00175      12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
100703     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
100703     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
092705     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
100703     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
092205     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
100703     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
011904     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
011904     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
00176
00177      12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
00178      12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
00179      12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
00180      12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
00181      12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
00182      12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
00183      12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
00184      12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
00185          88  WS-REDUCING              VALUE 'R'.
00186          88  WS-LEVEL                 VALUE 'L' 'P'.
100703     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
00187
00188      12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
00189      12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
00190      12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
00191      12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
00192      12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
00193      12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
00194      12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
100703     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
           12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
00195
00196      12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
00197      12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
00198      12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
00199      12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
00200      12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
00201      12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
00202      12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
00203      12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
00204      12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
00205      12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
00206      12  WS-ACCT-SIG-SW.
00207          16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
00208          16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
00209      12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
00210      12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
040504     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
062707     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
101010     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
           12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
071211     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
           12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
00211      12  WS-INITIALS.
00212          16  WS-INIT-1            PIC X         VALUE SPACES.
00213          16  WS-INIT-2            PIC X         VALUE SPACES.
00214
00215      12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
00216      12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
00217      12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
00218      12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
           12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
00219 *    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
00220      12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
00221      12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
00222      12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
00223      12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
00224      12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
00225      12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
00226      12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
00227      12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
00228      12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
00229      12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
00230      12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
00231      12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
00232      12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
00233      12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
00234      12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
00235      12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
00236      12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
00237      12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
00238      12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
00239      12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
00240      12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
00241      12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
00242 ******** FLA
00243      12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
00244      12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
00245      12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
00246      12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
00247      12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
00248 ********
00249      12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
00250      12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
00251      12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
00252      12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
00253      12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
00254      12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
00255      12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
00256      12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
00257      12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
00258      12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
00259
00260      12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
00261          88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
00262                                          '0' THRU '9'.
00263
00264      12  NUMBER-OF-MONTHS.
00265          16  SK-MO OCCURS 12 TIMES PIC X.
00266
00267      12  WS-WORK-DATE.
00268          16  WS-YEAR            PIC 99    VALUE 00.
00269          16  WS-MONTH           PIC 99    VALUE 00.
00270          16  WS-DAY             PIC 99    VALUE 00.
00271
00272      12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
00273      12  WS-WORK-CRIT-DEV       REDEFINES
00274          WS-WORK-LF-CRIT-PER    PIC X(03).
00275
00276      12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
           12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
00277
00278      12  WS-WORK-DATE-FROM.
00279          16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
00280          16  FILLER             PIC X  VALUE SPACE.
00281          16  WS-WDF-DAY         PIC 99        VALUE ZERO.
00282          16  FILLER             PIC X         VALUE SPACE.
00283          16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
00284
00285      12  WS-WORK-DATE-THRU.
00286          16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
00287          16  FILLER             PIC X         VALUE SPACE.
00288          16  WS-WDT-DAY         PIC 99        VALUE ZERO.
00289          16  FILLER             PIC X         VALUE SPACE.
00290          16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
00291
00292      12  WS-LF-INPUT-CD.
00293          16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
00294          16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
00295
00296      12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
00297      12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
00298          16  WS-AH-INPUT-CD-1   PIC X.
00299          16  WS-AH-INPUT-CD-2-3 PIC XX.
00300
00301      12  WS-SWITCHES.
00302          16  DATE-RANGE-SW            PIC X    VALUE SPACES.
00303          16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
00304              88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
100703         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
100703             88  BANK-ACCT-FOUND          VALUE 'Y'.
111504         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
111504             88  AGENT-MASTER-FOUND       VALUE 'Y'.
100703         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
100703             88  BXRF-MASTER-FOUND        VALUE 'Y'.
100703         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
100703             88  COMP-MASTER-FOUND        VALUE 'Y'.
083106         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
083106             88  LOFC-MASTER-FOUND        VALUE 'Y'.
101010         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
101010             88  PDEF-MASTER-FOUND        VALUE 'Y'.
101010         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
101010             88  STAT-MASTER-FOUND        VALUE 'Y'.
00305          16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
00306              88  PLAN-MASTER-FOUND        VALUE 'Y'.
00307          16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
00308              88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
00309          16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
00310              88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
00311          16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
00312              88  FORM-MASTER-FOUND        VALUE 'Y'.
00313          16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
00314              88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
00315          16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
00316              88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
00317          16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
00318              88  PROCESS-FORM-EDITS       VALUE 'Y'.
00319          16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
00320              88  NO-BENEFIT-FOUND         VALUE 'N'.
00321          16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
00322              88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
00323          16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
00324              88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
00325          16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
00326              88  AH-BENEFIT-FOUND         VALUE ' '.
00327              88  NO-AH-BENEFIT-MATCH      VALUE '1'.
00328          16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
00329              88  LF-BENEFIT-FOUND         VALUE ' '.
00330              88  NO-LF-BENEFIT-MATCH      VALUE '1'.
071910         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
071910             88  NO-STATE-RECORD          VALUE '1'.
00331          16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
00332              88  LF-REIN-NSP-NOT-USED     VALUE '  '.
00333          16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
00334              88  AH-REIN-NSP-NOT-USED     VALUE '  '.
00335          16  CERT-STATUS-SW           PIC X    VALUE SPACE.
00336              88  CERT-WAS-FOUND           VALUE ' '.
00337              88  CERT-WAS-NOT-FOUND       VALUE '1'.
00338          16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
00339              88  BROWSE-STARTED           VALUE 'Y'.
00340          16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
00341              88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
00342          16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
00343              88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
00344          16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
00345              88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
00346          16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
00347              88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
00348          16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
00349              88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
00350          16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
00351              88  APP-CERT-USED            VALUE 'Y' 'A'.
00352          16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
00353              88  CTBL-TABLE-FOUND         VALUE 'Y'.
00354              88  FIRST-TIME-THROUGH       VALUE '1'.
00355              88  CTBL-NOT-FOUND           VALUE '2'.
00356
00357          16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
00358              88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
00359
00360          16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
00361              88  DLO-ERROR-FOUND          VALUE 'Y'.
00362
00363 ********FLA
00364      12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
00365      12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
00366 ********
00367      12  RC-SW-1                  PIC X           VALUE '0'.
00368      12  RC-SW-2                  PIC X           VALUE '0'.
00369      12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
00370      12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
00371      12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
00372      12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
00373      12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
00374      12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
00375      12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
00376      12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
00377      12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
00378      12  IB                       PIC 9(4) COMP   VALUE ZEROS.
00379      12  LIT-SPACES               PIC X           VALUE SPACES.
00380      12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
00381      12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
00382      12  ERMAIL-FOUND             PIC X           VALUE SPACES.
00383      12  ERPNDM-FOUND             PIC X           VALUE SPACES.
011410     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
011410     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
           12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
               88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
               88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
           12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
               88  SKIP-ADDR-EDIT         VALUE 'Y'.
00384
100703 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
100703     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
100703     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
00385  01  WS-CRI-SSN-WORK-AREA.
00386      05  WS-CRI-SOC-SEC-NO.
00387          10  WS-SS-REPT-CD       PIC X(5).
00388          10  WS-SS-LAST-NAME     PIC X(5).
00389          10  WS-SS-INITIAL       PIC X.
00390
00391      05  WS-CRI-REPORT-CODE.
00392          10  FILLER              PIC X(5).
00393          10  WS-CRI-RPT-CD-MOVE  PIC X(5).
00394
00395      05  WS-CRI-LAST-NAME.
00396          10  WS-CRI-NAME-MOVE    PIC X(5).
00397          10  FILLER              PIC X(10).
00398
       01  WS-NUM-TABLE                PIC X(26)  VALUE
           '12345678012345070923456789'.
       01  FILLER REDEFINES WS-NUM-TABLE.
           05  WS-NUM OCCURS 26        PIC 9.
101010 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
       01  V1                          PIC S999 COMP-3.
       01  V2                          PIC S999 COMP-3.
       01  V3                          PIC S999 COMP-3.
       01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
       01  FILLER REDEFINES WS-WORK-VIN.
           05  WS-WORK-VIN-N OCCURS 17        PIC 9.
       01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
       01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
       01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
       01  WS-HEX-WORK.
           05  FILLER                  PIC X  VALUE LOW-VALUES.
           05  WS-HEX-BYTE             PIC X.
       01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
       01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
101010 01  WS-WORK-HIN-ROW-B.
101010     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
101010
101010 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
101010 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
101010     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
101010 01  WS-ROW-D-TABLE.
101010     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
101010
101010 01  WS-HIN-TABLE-B.
101010     05  F                       PIC XX VALUE 'A2'.
101010     05  F                       PIC XX VALUE 'B3'.
101010     05  F                       PIC XX VALUE 'C4'.
101010     05  F                       PIC XX VALUE 'D5'.
101010     05  F                       PIC XX VALUE 'E6'.
101010     05  F                       PIC XX VALUE 'F7'.
101010     05  F                       PIC XX VALUE 'G8'.
101010     05  F                       PIC XX VALUE 'H9'.
101010     05  F                       PIC XX VALUE 'I1'.
101010     05  F                       PIC XX VALUE 'J2'.
101010     05  F                       PIC XX VALUE 'K3'.
101010     05  F                       PIC XX VALUE 'L4'.
101010     05  F                       PIC XX VALUE 'M5'.
101010     05  F                       PIC XX VALUE 'N6'.
101010     05  F                       PIC XX VALUE 'O0'.
101010     05  F                       PIC XX VALUE 'P7'.
101010     05  F                       PIC XX VALUE 'Q0'.
101010     05  F                       PIC XX VALUE 'R8'.
101010     05  F                       PIC XX VALUE 'S9'.
101010     05  F                       PIC XX VALUE 'T2'.
101010     05  F                       PIC XX VALUE 'U3'.
101010     05  F                       PIC XX VALUE 'V4'.
101010     05  F                       PIC XX VALUE 'W5'.
101010     05  F                       PIC XX VALUE 'X6'.
101010     05  F                       PIC XX VALUE 'Y7'.
101010     05  F                       PIC XX VALUE 'Z8'.
101010 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
101010     05  WS-VAL-IN               PIC X.
101010     05  WS-VAL-OUT              PIC 9.
101010 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
00399  01  WS-COMPARE-BINARY-DATES.
CIDMOD     05  WS-971231                PIC XX VALUE X'92FF'.
00400      05  WS-931231                PIC XX VALUE X'8CFF'.
00401      05  WS-791231                PIC XX VALUE X'77FF'.
00402      05  WS-771001                PIC XX VALUE X'74A1'.
00403      05  WS-820301                PIC XX VALUE X'7B41'.
00404      05  WS-831031                PIC XX VALUE X'7DBF'.
00405      05  WS-831231                PIC XX VALUE X'7DFF'.
00406      05  WS-810831                PIC XX VALUE X'7A7F'.
00407      05  WS-830901                PIC XX VALUE X'7D81'.
00408
00409  01  FILE-ACCESS-IDS.
00410      12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
00411      12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
00412      12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
00413      12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
00414      12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
00415      12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
00416      12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
00417      12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
00418      12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
00419      12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
100703     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
083106     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
101010     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
101010     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
100703     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
111504     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
042709     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
101010 01  DD-IU-SW                    PIC X   VALUE ' '.
101010     88  DD-IU-PRESENT                 VALUE 'Y'.
00420
00421  01  ACCESS-KEYS.
00422      12  ELMSTR-KEY.
00423          16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
00424          16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
00425      12  W-CLAIM-KEY.
00426          16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
00427          16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
00428
00429      12  ELCNTL-KEY.
00430          16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
00431          16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
00432          16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
00433          16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
00434
00435      12  ELCERT-KEY.
00436          16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
00437          16  CERT-CARRIER         PIC X       VALUE SPACE.
00438          16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
00439          16  CERT-STATE           PIC XX      VALUE SPACES.
00440          16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
00441          16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
00442          16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
00443
00444      12  ELCERT2-KEY.
00445          16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
00446          16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
00447
00448      12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
00449
00450      12  ELCERT-SAVE.
00451          16  FILLER                      PIC XX    VALUE SPACES.
00452
042709         16  WCS-CONTROL-PRIMARY.
042709             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
042709             20  WCS-CARRIER             PIC X     VALUE SPACE.
042709             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
042709             20  WCS-STATE               PIC XX    VALUE SPACES.
042709             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
042709             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
042709             20  WCS-CERT-NO.
042709                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
042709                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
00463
00464          16  CS-CONTROL-BY-NAME.
00465              20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
00466              20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
00467              20  CS-INSURED-INITIALS.
00468                  24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
00469                  24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
00470
00471          16  CS-CONTROL-BY-SSN.
00472              20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
00473              20  CS-SOC-SEC-NO.
00474                  24  CS-SSN-STATE        PIC XX VALUE SPACES.
00475                  24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
00476                  24  CS-SSN-LN3.
00477                      28 CS-INSURED-INITIALS-A2   PIC XX
00478                                      VALUE SPACES.
00479                      28 CS-PART-LAST-NAME-A2     PIC X
00480                                      VALUE SPACE.
00481
00482          16  CS-CONTROL-BY-CERT-NO.
00483              20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
00484              20  CS-CERT-NO-A4           PIC X(11)
00485                                      VALUE SPACES.
00486
00487          16  CS-CONTROL-BY-MEMB.
00488              20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
00489              20  CS-MEMBER-NO.
00490                  24  CS-MEMB-STATE     PIC XX VALUE SPACES.
00491                  24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
00492                  24  CS-MEMB-LN4.
00493                      28 CS-INSURED-INITIALS-A5   PIC XX
00494                                       VALUE SPACES.
00495                      28 CS-PART-LAST-NAME-A5     PIC XX
00496                                       VALUE SPACES.
00497
00498          16  FILLER              PIC X(360) VALUE SPACES.
00499
00500      12  ERACCT-KEY.
00501          16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
00502          16  ACCT-CARRIER         PIC X     VALUE SPACES.
00503          16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
00504          16  ACCT-STATE           PIC X(02) VALUE SPACES.
00505          16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
00506          16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
100703
100703     12  ERCOMP-KEY.
100703         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
100703         16  COMP-CARRIER         PIC X     VALUE SPACES.
100703         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
100703         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
100703         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
100703         16  COMP-TYPE            PIC X     VALUE SPACES.
100703
083106     12  ERLOFC-KEY.
083106         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
083106         16  LOFC-CARRIER         PIC X     VALUE SPACES.
083106         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
083106         16  LOFC-STATE           PIC XX    VALUE SPACES.
083106         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
083106         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
083106
042709     12  WS-ELCRTT-KEY.
042709         16  WS-ELCRTT-PRIMARY       PIC X(33).
042709         16  WS-ELCRTT-REC-TYPE      PIC X(1).
042709
100703     12  ERBXRF-KEY.
100703         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
100703         16  BXRF-CARRIER         PIC X     VALUE SPACES.
100703         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
100703         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
100703
111504     12  ERAGTC-KEY.
111504         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
111504         16  AGTC-CARRIER         PIC X     VALUE SPACES.
111504         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
111504         16  AGTC-BANK            PIC X(10) VALUE SPACES.
111504         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
111504         16  AGTC-TYPE            PIC X     VALUE SPACES.
111504
00508      12  ERPLAN-KEY.
00509          16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
00510          16  PLAN-CARRIER         PIC X     VALUE SPACES.
00511          16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
00512          16  PLAN-STATE           PIC X(2)  VALUE SPACES.
00513          16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
00514          16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
00515          16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
00516          16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
00517
00518      12  ERFORM-KEY.
00519          16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
00520          16  FORM-STATE           PIC X(2)  VALUE SPACES.
00521          16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
00522          16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
00523
00524      12  ERREIN-KEY.
00525          16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
00526          16  REIN-TYPE            PIC X     VALUE SPACES.
00527          16  REIN-TABLE-CO.
00528              20  REIN-CODE-1      PIC X     VALUE SPACE.
00529              20  REIN-CODE-2      PIC X     VALUE SPACE.
00530              20  REIN-CODE-3      PIC X     VALUE SPACE.
00531          16  FILLER               PIC X(3)  VALUE SPACES.
00532
00533      12  ERCTBL-KEY.
00534          16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
00535          16  CTBL-TABLE           PIC XXX   VALUE SPACES.
00536          16  CTBL-CNTRL-2.
00537              20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
00538              20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
061412
061412     12  ELCRTO-KEY.
061412         16  ELCRTO-COMPANY-CD       PIC X.
061412         16  ELCRTO-CARRIER          PIC X.
061412         16  ELCRTO-GROUPING         PIC X(6).
061412         16  ELCRTO-STATE            PIC XX.
061412         16  ELCRTO-ACCOUNT          PIC X(10).
061412         16  ELCRTO-CERT-EFF-DT      PIC XX.
061412         16  ELCRTO-CERT-NO.
061412             20  ELCRTO-CERT-PRIME   PIC X(10).
061412             20  ELCRTO-CERT-SFX     PIC X.
061412         16  ELCRTO-RECORD-TYPE      PIC X.
061412         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
061412
00539
00540      12  WS-ACCESS.
00541          16  FILLER               PIC XX    VALUE SPACES.
00542          16  WS-BEN-CD            PIC XX    VALUE SPACES.
00543
00544      12  WS-CARR-ACCESS.
00545          16  FILLER               PIC X(3)  VALUE SPACES.
00546          16  WS-CARR              PIC X     VALUE SPACE.
00547 *DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
00548 *WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
00549      12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
00550          88  WS-DMD-LF-RATING   VALUE 'Y'.
00551          88  WS-DMD-AH-RATING   VALUE 'Y'.
00552          88  WS-DMD-NO-RATING   VALUE 'N'.
00553
082205     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
082205         88  WS-LF-CASH            VALUE 'MJ' 'MS'
082205                                         'NJ' 'NL'
092311                                         'PJ' 'PL'
082205                                         'SJ' 'SL'.
082205     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
071906         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
082205                                         'NI' 'NJ' 'NL' 'NU'
092311                                         'PJ' 'PL' 'PI' 'PU'
082205                                         'SI' 'SJ' 'SL' 'SU'
                                               'MX' 'MY' 'MZ'.
101010 01  ERPDEF-KEY-SAVE             PIC X(18).
101010 01  ERPDEF-KEY.
101010     12  ERPDEF-COMPANY-CD       PIC X.
101010     12  ERPDEF-STATE            PIC XX.
101010     12  ERPDEF-PROD-CD          PIC XXX.
101010     12  F                       PIC X(7).
101010     12  ERPDEF-BEN-TYPE         PIC X.
101010     12  ERPDEF-BEN-CODE         PIC XX.
101010     12  ERPDEF-EXP-DT           PIC XX.
101010
101010 01  ELSTAT-KEY-SAVE             PIC X(20).
101010 01  ELSTAT-KEY.
101010     12  ELSTAT-COMPANY-ID       PIC XXX.
101010     12  ELSTAT-CARRIER          PIC X.
101010     12  ELSTAT-GROUP            PIC X(6).
101010     12  ELSTAT-STATE            PIC XX.
101010     12  ELSTAT-EXP-DT           PIC 9(8).
020711 01  WS-ERROR-VALUES.
020711     12  ER-1570                     PIC S9(4)   VALUE +1570.
020711     12  ER-1571                     PIC S9(4)   VALUE +1571.
020711     12  ER-1575                     PIC S9(4)   VALUE +1575.
00555      12  ER-1891                     PIC S9(4)   VALUE +1891.
00556      12  ER-1892                     PIC S9(4)   VALUE +1892.
00557      12  ER-1893                     PIC S9(4)   VALUE +1893.
00558      12  ER-1894                     PIC S9(4)   VALUE +1894.
00559      12  ER-1895                     PIC S9(4)   VALUE +1895.
00560      12  ER-1896                     PIC S9(4)   VALUE +1896.
00561      12  ER-1897                     PIC S9(4)   VALUE +1897.
00562      12  ER-1898                     PIC S9(4)   VALUE +1898.
00563      12  ER-1899                     PIC S9(4)   VALUE +1899.
00564      12  ER-1900                     PIC S9(4)   VALUE +1900.
00565      12  ER-1901                     PIC S9(4)   VALUE +1901.
00566      12  ER-1902                     PIC S9(4)   VALUE +1902.
00567      12  ER-1903                     PIC S9(4)   VALUE +1903.
00568      12  ER-1904                     PIC S9(4)   VALUE +1904.
00569      12  ER-1905                     PIC S9(4)   VALUE +1905.
00570      12  ER-1906                     PIC S9(4)   VALUE +1906.
00571      12  ER-1907                     PIC S9(4)   VALUE +1907.
00572      12  ER-1909                     PIC S9(4)   VALUE +1909.
00573      12  ER-1910                     PIC S9(4)   VALUE +1910.
00574      12  ER-1911                     PIC S9(4)   VALUE +1911.
00575      12  ER-1912                     PIC S9(4)   VALUE +1912.
00576      12  ER-1913                     PIC S9(4)   VALUE +1913.
00577      12  ER-1914                     PIC S9(4)   VALUE +1914.
00578      12  ER-1915                     PIC S9(4)   VALUE +1915.
00579      12  ER-1916                     PIC S9(4)   VALUE +1916.
00580      12  ER-1917                     PIC S9(4)   VALUE +1917.
00581      12  ER-1918                     PIC S9(4)   VALUE +1918.
00582      12  ER-1919                     PIC S9(4)   VALUE +1919.
00583      12  ER-1920                     PIC S9(4)   VALUE +1920.
00584      12  ER-1921                     PIC S9(4)   VALUE +1921.
00585      12  ER-1922                     PIC S9(4)   VALUE +1922.
00586      12  ER-1923                     PIC S9(4)   VALUE +1923.
00587      12  ER-1924                     PIC S9(4)   VALUE +1924.
00588      12  ER-1925                     PIC S9(4)   VALUE +1925.
00589      12  ER-1926                     PIC S9(4)   VALUE +1926.
00590      12  ER-1927                     PIC S9(4)   VALUE +1927.
00591      12  ER-2393                     PIC S9(4)   VALUE +2393.
00591      12  ER-2600                     PIC S9(4)   VALUE +2600.
00592      12  ER-2601                     PIC S9(4)   VALUE +2601.
00593      12  ER-2602                     PIC S9(4)   VALUE +2602.
00594      12  ER-2603                     PIC S9(4)   VALUE +2603.
00595      12  ER-2604                     PIC S9(4)   VALUE +2604.
00596      12  ER-2605                     PIC S9(4)   VALUE +2605.
00597      12  ER-2606                     PIC S9(4)   VALUE +2606.
00598      12  ER-2607                     PIC S9(4)   VALUE +2607.
00599      12  ER-2608                     PIC S9(4)   VALUE +2608.
00600      12  ER-2609                     PIC S9(4)   VALUE +2609.
00601      12  ER-2610                     PIC S9(4)   VALUE +2610.
00602      12  ER-2611                     PIC S9(4)   VALUE +2611.
00603      12  ER-2612                     PIC S9(4)   VALUE +2612.
00604      12  ER-2613                     PIC S9(4)   VALUE +2613.
00605      12  ER-2614                     PIC S9(4)   VALUE +2614.
00606      12  ER-2615                     PIC S9(4)   VALUE +2615.
00607      12  ER-2616                     PIC S9(4)   VALUE +2616.
00608      12  ER-2617                     PIC S9(4)   VALUE +2617.
00609      12  ER-2618                     PIC S9(4)   VALUE +2618.
00610      12  ER-2619                     PIC S9(4)   VALUE +2619.
00611      12  ER-2620                     PIC S9(4)   VALUE +2620.
00612      12  ER-2621                     PIC S9(4)   VALUE +2621.
00613      12  ER-2622                     PIC S9(4)   VALUE +2622.
00614      12  ER-2623                     PIC S9(4)   VALUE +2623.
00615      12  ER-2624                     PIC S9(4)   VALUE +2624.
00616      12  ER-2625                     PIC S9(4)   VALUE +2625.
00617      12  ER-2626                     PIC S9(4)   VALUE +2626.
00618      12  ER-2627                     PIC S9(4)   VALUE +2627.
00619      12  ER-2628                     PIC S9(4)   VALUE +2628.
00620      12  ER-2629                     PIC S9(4)   VALUE +2629.
00621      12  ER-2630                     PIC S9(4)   VALUE +2630.
00622      12  ER-2631                     PIC S9(4)   VALUE +2631.
00623      12  ER-2632                     PIC S9(4)   VALUE +2632.
00624      12  ER-2633                     PIC S9(4)   VALUE +2633.
00625      12  ER-2634                     PIC S9(4)   VALUE +2634.
00626      12  ER-2635                     PIC S9(4)   VALUE +2635.
00627      12  ER-2636                     PIC S9(4)   VALUE +2636.
00628      12  ER-2637                     PIC S9(4)   VALUE +2637.
00629      12  ER-2638                     PIC S9(4)   VALUE +2638.
00630      12  ER-2639                     PIC S9(4)   VALUE +2639.
00631      12  ER-2640                     PIC S9(4)   VALUE +2640.
00632      12  ER-2641                     PIC S9(4)   VALUE +2641.
00633      12  ER-2642                     PIC S9(4)   VALUE +2642.
00634      12  ER-2643                     PIC S9(4)   VALUE +2643.
00635      12  ER-2644                     PIC S9(4)   VALUE +2644.
00636      12  ER-2645                     PIC S9(4)   VALUE +2645.
00637      12  ER-2646                     PIC S9(4)   VALUE +2646.
00638      12  ER-2647                     PIC S9(4)   VALUE +2647.
00639      12  ER-2648                     PIC S9(4)   VALUE +2648.
00640      12  ER-2649                     PIC S9(4)   VALUE +2649.
00641      12  ER-2650                     PIC S9(4)   VALUE +2650.
00642      12  ER-2651                     PIC S9(4)   VALUE +2651.
00643      12  ER-2652                     PIC S9(4)   VALUE +2652.
00644      12  ER-2653                     PIC S9(4)   VALUE +2653.
00645      12  ER-2654                     PIC S9(4)   VALUE +2654.
00646      12  ER-2655                     PIC S9(4)   VALUE +2655.
00647      12  ER-2656                     PIC S9(4)   VALUE +2656.
00648      12  ER-2657                     PIC S9(4)   VALUE +2657.
00649      12  ER-2658                     PIC S9(4)   VALUE +2658.
00650      12  ER-2659                     PIC S9(4)   VALUE +2659.
00651      12  ER-2660                     PIC S9(4)   VALUE +2660.
00652      12  ER-2661                     PIC S9(4)   VALUE +2661.
00653      12  ER-2662                     PIC S9(4)   VALUE +2662.
00654      12  ER-2663                     PIC S9(4)   VALUE +2663.
00655      12  ER-2664                     PIC S9(4)   VALUE +2664.
00656      12  ER-2665                     PIC S9(4)   VALUE +2665.
00657      12  ER-2666                     PIC S9(4)   VALUE +2666.
00658      12  ER-2667                     PIC S9(4)   VALUE +2667.
00659      12  ER-2668                     PIC S9(4)   VALUE +2668.
00660      12  ER-2669                     PIC S9(4)   VALUE +2669.
00661      12  ER-2670                     PIC S9(4)   VALUE +2670.
00662      12  ER-2671                     PIC S9(4)   VALUE +2671.
00663      12  ER-2672                     PIC S9(4)   VALUE +2672.
00664      12  ER-2673                     PIC S9(4)   VALUE +2673.
00665      12  ER-2674                     PIC S9(4)   VALUE +2674.
00666      12  ER-2675                     PIC S9(4)   VALUE +2675.
00667      12  ER-2676                     PIC S9(4)   VALUE +2676.
00668      12  ER-2677                     PIC S9(4)   VALUE +2677.
00669      12  ER-2678                     PIC S9(4)   VALUE +2678.
00670      12  ER-2679                     PIC S9(4)   VALUE +2679.
00671      12  ER-2680                     PIC S9(4)   VALUE +2680.
00672      12  ER-2681                     PIC S9(4)   VALUE +2681.
00673      12  ER-2682                     PIC S9(4)   VALUE +2682.
00674      12  ER-2683                     PIC S9(4)   VALUE +2683.
00675      12  ER-2684                     PIC S9(4)   VALUE +2684.
00676      12  ER-2685                     PIC S9(4)   VALUE +2685.
00677      12  ER-2686                     PIC S9(4)   VALUE +2686.
00678      12  ER-2687                     PIC S9(4)   VALUE +2687.
00679      12  ER-2688                     PIC S9(4)   VALUE +2688.
00680      12  ER-2689                     PIC S9(4)   VALUE +2689.
00681      12  ER-2690                     PIC S9(4)   VALUE +2690.
00682      12  ER-2691                     PIC S9(4)   VALUE +2691.
00683      12  ER-2692                     PIC S9(4)   VALUE +2692.
00684      12  ER-2693                     PIC S9(4)   VALUE +2693.
00685      12  ER-2694                     PIC S9(4)   VALUE +2694.
00686      12  ER-2695                     PIC S9(4)   VALUE +2695.
00687      12  ER-2696                     PIC S9(4)   VALUE +2696.
00688      12  ER-2697                     PIC S9(4)   VALUE +2697.
00689      12  ER-2698                     PIC S9(4)   VALUE +2698.
00690      12  ER-2699                     PIC S9(4)   VALUE +2699.
00691      12  ER-2700                     PIC S9(4)   VALUE +2700.
00692      12  ER-2701                     PIC S9(4)   VALUE +2701.
082003     12  ER-2702                     PIC S9(4)   VALUE +2702.
00693      12  ER-2703                     PIC S9(4)   VALUE +2703.
00694      12  ER-2704                     PIC S9(4)   VALUE +2704.
00695      12  ER-2707                     PIC S9(4)   VALUE +2707.
00696      12  ER-2720                     PIC S9(4)   VALUE +2720.
CIDMOD     12  ER-2709                     PIC S9(4)   VALUE +2709.
00697      12  ER-2717                     PIC S9(4)   VALUE +2717.
CIDMOD     12  ER-2718                     PIC S9(4)   VALUE +2718.
PEMMOD     12  ER-2719                     PIC S9(4)   VALUE +2719.
123102     12  ER-2721                     PIC S9(4)   VALUE +2721.
082203     12  ER-2722                     PIC S9(4)   VALUE +2722.
00698      12  ER-2723                     PIC S9(4)   VALUE +2723.
00699      12  ER-2724                     PIC S9(4)   VALUE +2724.
00700      12  ER-2725                     PIC S9(4)   VALUE +2725.
00701      12  ER-2726                     PIC S9(4)   VALUE +2726.
00702      12  ER-2727                     PIC S9(4)   VALUE +2727.
00703      12  ER-2728                     PIC S9(4)   VALUE +2728.
00704      12  ER-2729                     PIC S9(4)   VALUE +2729.
00705      12  ER-2730                     PIC S9(4)   VALUE +2730.
00706      12  ER-2731                     PIC S9(4)   VALUE +2731.
00707      12  ER-2732                     PIC S9(4)   VALUE +2732.
00708      12  ER-2733                     PIC S9(4)   VALUE +2733.
00709      12  ER-2734                     PIC S9(4)   VALUE +2734.
00710      12  ER-2735                     PIC S9(4)   VALUE +2735.
00711      12  ER-2736                     PIC S9(4)   VALUE +2736.
00712      12  ER-2737                     PIC S9(4)   VALUE +2737.
00713      12  ER-2738                     PIC S9(4)   VALUE +2738.
00714      12  ER-2739                     PIC S9(4)   VALUE +2739.
00715      12  ER-2740                     PIC S9(4)   VALUE +2740.
00716      12  ER-2741                     PIC S9(4)   VALUE +2741.
00717      12  ER-2742                     PIC S9(4)   VALUE +2742.
00718      12  ER-2743                     PIC S9(4)   VALUE +2743.
00719      12  ER-2744                     PIC S9(4)   VALUE +2744.
00720      12  ER-2745                     PIC S9(4)   VALUE +2745.
00721      12  ER-2746                     PIC S9(4)   VALUE +2746.
00722      12  ER-2747                     PIC S9(4)   VALUE +2747.
00723      12  ER-2748                     PIC S9(4)   VALUE +2748.
00724      12  ER-2749                     PIC S9(4)   VALUE +2749.
00725      12  ER-2750                     PIC S9(4)   VALUE +2750.
00726      12  ER-2751                     PIC S9(4)   VALUE +2751.
00727      12  ER-2752                     PIC S9(4)   VALUE +2752.
00728      12  ER-2753                     PIC S9(4)   VALUE +2753.
00729      12  ER-2754                     PIC S9(4)   VALUE +2754.
00730      12  ER-2755                     PIC S9(4)   VALUE +2755.
00731      12  ER-2756                     PIC S9(4)   VALUE +2756.
00732      12  ER-2757                     PIC S9(4)   VALUE +2757.
00733      12  ER-2758                     PIC S9(4)   VALUE +2758.
00734      12  ER-2759                     PIC S9(4)   VALUE +2759.
00735      12  ER-2760                     PIC S9(4)   VALUE +2760.
00736      12  ER-2761                     PIC S9(4)   VALUE +2761.
00737      12  ER-2762                     PIC S9(4)   VALUE +2762.
00738      12  ER-2763                     PIC S9(4)   VALUE +2763.
00739      12  ER-2764                     PIC S9(4)   VALUE +2764.
00740      12  ER-2765                     PIC S9(4)   VALUE +2765.
00741      12  ER-2766                     PIC S9(4)   VALUE +2766.
00742      12  ER-2767                     PIC S9(4)   VALUE +2767.
00743      12  ER-2768                     PIC S9(4)   VALUE +2768.
00744      12  ER-2769                     PIC S9(4)   VALUE +2769.
00745      12  ER-2770                     PIC S9(4)   VALUE +2770.
00746      12  ER-2771                     PIC S9(4)   VALUE +2771.
00747      12  ER-2772                     PIC S9(4)   VALUE +2772.
00748      12  ER-2773                     PIC S9(4)   VALUE +2773.
00749      12  ER-2774                     PIC S9(4)   VALUE +2774.
00750      12  ER-2775                     PIC S9(4)   VALUE +2775.
00751      12  ER-2776                     PIC S9(4)   VALUE +2776.
00752      12  ER-2777                     PIC S9(4)   VALUE +2777.
00753      12  ER-2778                     PIC S9(4)   VALUE +2778.
00754      12  ER-2779                     PIC S9(4)   VALUE +2779.
00755      12  ER-2780                     PIC S9(4)   VALUE +2780.
00756      12  ER-2781                     PIC S9(4)   VALUE +2781.
00757      12  ER-2782                     PIC S9(4)   VALUE +2782.
00758      12  ER-2783                     PIC S9(4)   VALUE +2783.
121304     12  ER-2786                     PIC S9(4)   VALUE +2786.
071305     12  ER-2787                     PIC S9(4)   VALUE +2787.
042106     12  ER-2788                     PIC S9(4)   VALUE +2788.
102006     12  ER-2789                     PIC S9(4)   VALUE +2789.
022608     12  ER-2792                     PIC S9(4)   VALUE +2792.
00759      12  ER-2793                     PIC S9(4)   VALUE +2793.
00759      12  ER-2794                     PIC S9(4)   VALUE +2794.
00759      12  ER-2795                     PIC S9(4)   VALUE +2795.
00759      12  ER-2796                     PIC S9(4)   VALUE +2796.
           12  ER-2798                     PIC S9(4)   VALUE +2798.
00760      12  ER-2799                     PIC S9(4)   VALUE +2799.
100703     12  ER-2869                     PIC S9(4)   VALUE +2869.
020305     12  ER-2879                     PIC S9(4)   VALUE +2879.
           12  ER-2881                     PIC S9(4)   VALUE +2881.
030309     12  ER-2883                     PIC S9(4)   VALUE +2883.
102908     12  ER-2882                     PIC S9(4)   VALUE +2882.
012010     12  ER-2884                     PIC S9(4)   VALUE +2884.
012010     12  ER-2885                     PIC S9(4)   VALUE +2885.
012010     12  ER-2886                     PIC S9(4)   VALUE +2886.
011211     12  ER-2887                     PIC S9(4)   VALUE +2887.
011211     12  ER-2888                     PIC S9(4)   VALUE +2888.
011211     12  ER-2889                     PIC S9(4)   VALUE +2889.
011211     12  ER-2890                     PIC S9(4)   VALUE +2890.
011211     12  ER-2891                     PIC S9(4)   VALUE +2891.
011211     12  ER-2892                     PIC S9(4)   VALUE +2892.
071910     12  ER-2963                     PIC S9(4)   VALUE +2963.
071910     12  ER-2964                     PIC S9(4)   VALUE +2964.
011211     12  ER-2965                     PIC S9(4)   VALUE +2965.
011211     12  ER-2969                     PIC S9(4)   VALUE +2969.
083106     12  ER-3006                     PIC S9(4)   VALUE +3006.
031513     12  ER-3049                     PIC S9(4)   VALUE +3049.
00761      12  ER-3050                     PIC S9(4)   VALUE +3050.
00762      12  ER-3052                     PIC S9(4)   VALUE +3052.
00763      12  ER-3054                     PIC S9(4)   VALUE +3054.
071211     12  ER-3057                     PIC S9(4)   VALUE +3057.
012213     12  ER-3058                     PIC S9(4)   VALUE +3058.
00764      12  ER-3780                     PIC S9(4)   VALUE +3780.
00765      12  ER-3781                     PIC S9(4)   VALUE +3781.
00766      12  ER-3782                     PIC S9(4)   VALUE +3782.
081606     12  ER-3789                     PIC S9(4)   VALUE +3789.
081606     12  ER-3790                     PIC S9(4)   VALUE +3790.
101706     12  ER-3825                     PIC S9(4)   VALUE +3825.
101706     12  ER-3826                     PIC S9(4)   VALUE +3826.
           12  ER-3843                     PIC S9(4)   VALUE +3843.
00767      12  ER-7812                     PIC S9(4)   VALUE +7812.
00768      12  ER-7813                     PIC S9(4)   VALUE +7813.
00769      12  ER-7814                     PIC S9(4)   VALUE +7814.
00770      12  ER-7815                     PIC S9(4)   VALUE +7815.
00771      12  ER-7816                     PIC S9(4)   VALUE +7816.
00772      12  ER-7817                     PIC S9(4)   VALUE +7817.
00773      12  ER-7818                     PIC S9(4)   VALUE +7818.
00774      12  ER-7819                     PIC S9(4)   VALUE +7819.
00775      12  ER-7820                     PIC S9(4)   VALUE +7820.
00776      12  ER-7823                     PIC S9(4)   VALUE +7823.
00777      12  ER-7825                     PIC S9(4)   VALUE +7825.
00778      12  ER-8002                     PIC S9(4)   VALUE +8002.
00779      12  ER-8030                     PIC S9(4)   VALUE +8030.
00780      12  ER-8036                     PIC S9(4)   VALUE +8036.
00781      12  ER-8037                     PIC S9(4)   VALUE +8037.
00782      12  ER-8038                     PIC S9(4)   VALUE +8038.
00783      12  ER-8039                     PIC S9(4)   VALUE +8039.
00784      12  ER-8040                     PIC S9(4)   VALUE +8040.
00785      12  ER-8041                     PIC S9(4)   VALUE +8041.
00786      12  ER-8042                     PIC S9(4)   VALUE +8042.
00787      12  ER-8043                     PIC S9(4)   VALUE +8043.
00788      12  ER-8044                     PIC S9(4)   VALUE +8044.
00789      12  ER-8045                     PIC S9(4)   VALUE +8045.
00790      12  ER-8046                     PIC S9(4)   VALUE +8046.
00791      12  ER-8050                     PIC S9(4)   VALUE +8050.
00792      12  ER-8067                     PIC S9(4)   VALUE +8067.
00793      12  ER-8068                     PIC S9(4)   VALUE +8068.
00794      12  ER-8069                     PIC S9(4)   VALUE +8069.
00795      12  ER-8070                     PIC S9(4)   VALUE +8070.
00796      12  ER-8071                     PIC S9(4)   VALUE +8071.
00797      12  ER-8072                     PIC S9(4)   VALUE +8072.
00798      12  ER-8074                     PIC S9(4)   VALUE +8074.
00799      12  ER-8075                     PIC S9(4)   VALUE +8075.
00800      12  ER-8076                     PIC S9(4)   VALUE +8076.
00801      12  ER-8077                     PIC S9(4)   VALUE +8077.
00802      12  ER-8078                     PIC S9(4)   VALUE +8078.
00803      12  ER-8079                     PIC S9(4)   VALUE +8079.
00804      12  ER-8080                     PIC S9(4)   VALUE +8080.
00805      12  ER-8081                     PIC S9(4)   VALUE +8081.
00806      12  ER-8082                     PIC S9(4)   VALUE +8082.
00807      12  ER-8083                     PIC S9(4)   VALUE +8083.
00808      12  ER-8084                     PIC S9(4)   VALUE +8084.
00809      12  ER-8085                     PIC S9(4)   VALUE +8085.
00810      12  ER-8086                     PIC S9(4)   VALUE +8086.
00811      12  ER-8087                     PIC S9(4)   VALUE +8087.
00812      12  ER-8088                     PIC S9(4)   VALUE +8088.
00813      12  ER-8089                     PIC S9(4)   VALUE +8089.
00814      12  ER-8090                     PIC S9(4)   VALUE +8090.
00815      12  ER-8091                     PIC S9(4)   VALUE +8091.
00816      12  ER-8092                     PIC S9(4)   VALUE +8092.
00817      12  ER-8093                     PIC S9(4)   VALUE +8093.
00818      12  ER-8094                     PIC S9(4)   VALUE +8094.
00819      12  ER-8095                     PIC S9(4)   VALUE +8095.
00820      12  ER-8096                     PIC S9(4)   VALUE +8096.
00821      12  ER-8097                     PIC S9(4)   VALUE +8097.
00822      12  ER-8098                     PIC S9(4)   VALUE +8098.
00823      12  ER-8099                     PIC S9(4)   VALUE +8099.
00824      12  ER-8109                     PIC S9(4)   VALUE +8109.
00825      12  ER-8110                     PIC S9(4)   VALUE +8110.
00826      12  ER-8111                     PIC S9(4)   VALUE +8111.
00827      12  ER-8112                     PIC S9(4)   VALUE +8112.
00828      12  ER-8113                     PIC S9(4)   VALUE +8113.
00829      12  ER-8114                     PIC S9(4)   VALUE +8114.
00830      12  ER-8116                     PIC S9(4)   VALUE +8116.
00831      12  ER-8148                     PIC S9(4)   VALUE +8148.
00831      12  ER-8152                     PIC S9(4)   VALUE +8152.
00832      12  ER-8300                     PIC S9(4)   VALUE +8300.
00833      12  ER-8301                     PIC S9(4)   VALUE +8301.
00834      12  ER-8302                     PIC S9(4)   VALUE +8302.
00835      12  ER-8303                     PIC S9(4)   VALUE +8303.
00836      12  ER-8304                     PIC S9(4)   VALUE +8304.
00837      12  ER-8310                     PIC S9(4)   VALUE +8310.
00838      12  ER-8311                     PIC S9(4)   VALUE +8311.
00839      12  ER-8312                     PIC S9(4)   VALUE +8312.
00840      12  ER-8313                     PIC S9(4)   VALUE +8313.
00841      12  ER-8314                     PIC S9(4)   VALUE +8314.
00842      12  ER-8315                     PIC S9(4)   VALUE +8315.
00843      12  ER-8316                     PIC S9(4)   VALUE +8316.
00844      12  ER-8317                     PIC S9(4)   VALUE +8317.
00845      12  ER-9236                     PIC S9(4)   VALUE +9236.
090408     12  ER-9501                     PIC S9(4)   VALUE +9501.
090408     12  ER-9503                     PIC S9(4)   VALUE +9503.
00846      12  ER-9263                     PIC S9(4)   VALUE +9263.
00846      12  ER-9999                     PIC S9(4)   VALUE +9999.
00847 ******************************************************************
00848 ***************   END OF ELC50WS     ****************************
00849 ******************************************************************
00850      EJECT
00058      EJECT
00059  01  WORKING-STORAGE-WORK-AREAS.
083106     12  WS-RESPONSE             PIC S9(8)  COMP.
083106         88  WS-RESP-NORMAL           VALUE +00.
083106         88  WS-RESP-ERROR            VALUE +01.
083106         88  WS-RESP-NOTFND           VALUE +13.
083106         88  WS-RESP-DUPREC           VALUE +14.
083106         88  WS-RESP-ENDFILE          VALUE +20.
050311     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
00060      12  WORK-AREAS.
00061          16  WK-CONV-GREG.
00062              24  WCG-CENT             PIC XX.
00063              24  WCG-REST             PIC X(4).
00064          16  WORK-GREGORIAN-DATE.
00065              24  WK-GREG-CENT         PIC XX.
00066              24  WK-GREG-DATE-YYMMDD.
00067                  28  WK-GREG-YYMM     PIC X(4).
00068                  28  WK-GREG-DD       PIC XX.
00069
CIDMOD         16  WORK-SELECT-DATE.
CIDMOD             24  WK-SELECT-CENT            PIC XX.
CIDMOD             24  WK-SELECT-DATE-YYMMDD.
CIDMOD                 28  WK-SELECT-GREG-YYMM   PIC X(4).
CIDMOD                 28  FILLER                PIC XX.
00073
00074          16  WK-FORM-NO.
00075              24  WK-FORM-BANK-ID       PIC X(5).
00076              24  WK-FORM-UNDRWRTR      PIC X(1).
00077              24  WK-FORM-MASTER-POL-NO PIC X(6).
00078
00079          16  WK-MEMBER-NO.
00080              24  WK-MEMBER-1-6        PIC X(6).
00081              24  WK-MEMBER-7-12       PIC X(6).
00082
00083          16  WK-FULL-CERT-NO.
00084              24  WK-CERT-POS-1-2      PIC X(2).
00085              24  WK-CERT-POS-3        PIC X(1).
00086              24  WK-CERT-POS-4        PIC X(1).
00087              24  WK-CERT-POS-5-6      PIC X(2).
00088              24  WK-CERT-POS-7        PIC X(1).
00089              24  WK-CERT-POS-8-11     PIC X(4).
00090
00091          16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
00092              88  VALID-RATE-CODE        VALUE 'Y'.
00093              88  FOUND-TO-BE-INVALID    VALUE 'N'.
00094
00095          16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
00096          16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
00097          16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
00098          16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
00099          16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
00100          16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
00101          16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
00102          16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
00103          16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
00104          16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
00105
00106 * DLO001
00107  01  WS-DLO-MASTER-POLICY-FORM.
00108      12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
00109      12  DMPF-RETURN-CODE          PIC XX.
00110          88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
00111          88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
00112          88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
00113          88  DMPF-POLICY-INACTIVE              VALUE '03'.
00114          88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
00115          88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
00116
00117 * DLO002
00118  01  WS-DLO-INTERNAL-POLICY-FORM.
00119      12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
00120      12  DIPF-RETURN-CODE          PIC XX.
00121          88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
00122          88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
00123          88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
00124          88  DIPF-POLICY-INACTIVE              VALUE '03'.
00125          88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
00126          88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
00127
00128 * DLO003
00129  01  WS-DLO-VALID-BANK-ID.
00130      12  DVBI-BANK-ID              PIC X(5).
00131      12  DVBI-BANK-ID-TYPE         PIC X.
00132          88  DVBI-BILLING-BANK                 VALUE 'B'.
00133          88  DVBI-PLAN-BANK                    VALUE 'P'.
00134          88  DVBI-ENROLL-BANK                  VALUE 'E'.
00135          88  DVBI-NEGOT-BANK                   VALUE 'N'.
00136          88  DVBI-PROCESS-CENTER               VALUE 'X'.
00137      12  DVBI-RETURN-CODE          PIC XX.
00138          88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
00139          88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
00140          88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
00141          88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
00142          88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
00143          88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
00144          88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
00145          88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
00146          88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
00147
00148 * DLO007
00149  01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
00150      12  DCUA-RES-STATE            PIC XX.
00151      12  DCUA-BEN-TYPE             PIC XX.
00152      12  DCUA-SYS-IDENT            PIC X.
00153          88  DCUA-CLAIM                        VALUE 'C'.
00154          88  DCUA-PREMIUM                      VALUE 'P'.
00155      12  DCUA-COVERAGE-RULE        PIC X.
00156      12  DCUA-CLIENT-ID            PIC X(10).
00157      12  DCUA-EFF-DATE             PIC X(8).
00158      12  DCUA-PREV-CERT-NUMBER     PIC X(11).
00159      12  DCUA-RETURN-CODE          PIC XX.
00160          88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
00161      12  DCUA-CERT-NUMBER          PIC X(11).
00162      12  DCUA-UNDRWRTR-CODE        PIC XX.
00163      12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
00164
00165 * DLO011
00166  01  WS-DLO-PREM-RATES-BEN-TYPE.
00167      12  DPRB-RATE-CODE            PIC X(4).
00168      12  DPRB-COVERAGE-CATEG       PIC X.
00169      12  DPRB-RETURN-CODE          PIC XX.
00170          88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
00171          88  DPRB-NO-RATE-CODE                 VALUE '01'.
00172          88  DPRB-NO-COV-CATEG                 VALUE '02'.
00173          88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
00174          88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
00175          88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
00176          88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
00177          88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
00178          88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
00179      12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
00180      12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
00181      12  DPRB-BEN-TYPE             PIC XX.
00182
00183 * DLO017
00184  01  WS-DLO-VALID-RATE-CODE.
00185      12  DVRC-RATE-CODE            PIC X(4).
00186      12  DVRC-RETURN-CODE          PIC XX.
00187          88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
00188          88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
00189          88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
00190          88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
00191          88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
00192          88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
00193
00194 * DLO019
00195  01  WS-DLO-ORIG-COV-CAT.
00196      12  DOCC-ORIG-BEN-TYPE        PIC XX.
00197      12  DOCC-RETURN-CODE          PIC XX.
00198      12  DOCC-ORIG-COV-CAT         PIC X.
00199      12  DOCC-UNDERWITER           PIC XX.
00200      12  DOCC-UNDW-GROUP-CODE      PIC X.
00201      12  DOCC-FILLER               PIC X(6).
00202
00203 * DLO021
00204  01  WS-DLO-VALID-LOAN-OFFICER.
00205      12  DVLO-LOAN-OFFICER.
00206          16  DVLO-BILL-TYPE        PIC X.
00207          16  DVLO-BILL-SOURCE      PIC X.
00208          16  DVLO-BATCH-TYPE       PIC X.
00209      12  DVLO-RETURN-CODE          PIC XX.
00210          88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
00211          88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
00212          88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
00213          88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
00214          88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
00215          88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
00216
00217 * DLO022
00218  01  WS-DLO-VALID-STATE-CODE.
00219      12  DVSC-STATE-CODE           PIC XX.
00220      12  DVSC-RETURN-CODE          PIC XX.
00221          88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
00222
00223 * DLO023
00224  01  WS-DLO-VALID-CODE-VALUES.
00225      12  DVCV-SYSTEM-ID            PIC XX.
00226          88  DVCV-CLAIMS                       VALUE 'CL'.
00227          88  DVCV-CREDIT                       VALUE 'CR'.
00228      12  DVCV-RECORD-TYPE          PIC XX.
00229          88  DVCV-DENIAL-CODE                  VALUE 'DN'.
00230          88  DVCV-EOB-CODE                     VALUE 'EO'.
00231          88  DVCV-ICD9-CODE                    VALUE 'I9'.
00232          88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
00233          88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
00234          88  DVCV-CAUSE-CODE                   VALUE 'CS'.
00235          88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
00236          88  DVCV-RES-STATE-CODE               VALUE 'ST'.
00237      12  DVCV-RECORD-KEY           PIC X(6).
00238      12  DVCV-RETURN-CODE          PIC XX.
00239          88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
00240          88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
00241          88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
00242          88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
00243          88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
00244          88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
00245          88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
00246      12  DVCV-CODE-DESC            PIC X(60).
00247      12  DVCV-GEN-DESC-1           PIC X(20).
00248      12  DVCV-GEN-DESC-2           PIC X(20).
00249      12  DVCV-GEN-DESC-3           PIC X(20).
00250
00251      EJECT
100703*    COPY ERCBXRF.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCBXRF                             *
00006 *                                                                *
00007 *   ONLINE CREDIT SYSTEM                                         *
00008 *                                                                *
00009 *   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
00010 *                                                                *
00011 *   FILE TYPE = VSAM,KSDS                                        *
00012 *   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
00013 *                                                                *
00014 *   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
00015 *       ALTERNATE PATH = NONE                                    *
00016 *                                                                *
00017 *   LOG = NO                                                     *
00018 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00019 *                                                                *
00020 ******************************************************************
00021
00022  01  BANK-CROSS-REFERENCE.
00023      12  BK-RECORD-ID                PIC XX.
00024          88  VALID-BK-ID             VALUE 'BK'.
00025
00026      12  BK-CONTROL-PRIMARY.
00027          16  BK-COMPANY-CD           PIC X.
00028          16  BK-CARRIER              PIC X.
00029          16  BK-GROUPING             PIC X(6).
00030          16  BK-BANK-NO              PIC X(10).
00031
00032      12  BK-MAINT-INFORMATION.
00033          16  BK-LAST-MAINT-DT        PIC XX.
00034          16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
00035          16  BK-LAST-MAINT-USER      PIC X(4).
00036          16  FILLER                  PIC X(9).
00037
00038      12  FILLER                      PIC X(37).
00039
00040      12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
00041
00042      12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
00043                             DEPENDING ON BK-BANK-POINTER-CNT.
00047          16  BK-AM-ACCOUNT           PIC X(10).
00048          16  BK-AM-EXP-DT            PIC XX.
00051          16  BK-AM-EFF-DT            PIC XX.
00046          16  BK-AM-STATE             PIC XX.
00052          16  FILLER                  PIC X(20).
00053
00054 ******************************************************************
100703
100703*    COPY ERCCOMP.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCCOMP                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.019                          *
00006 *                                                                *
00007 *   ONLINE CREDIT SYSTEM                                         *
00008 *                                                                *
00009 *   FILE DESCRIPTION = COMPENSATION MASTER                       *
00010 *                                                                *
00011 *   FILE TYPE = VSAM,KSDS                                        *
00012 *   RECORD SIZE = 700   RECFORM = FIXED                          *
00013 *                                                                *
00014 *   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
00015 *       ALTERNATE PATH = NONE                                    *
00016 *                                                                *
00017 *   LOG = NO                                                     *
00018 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00019 *                                                                *
00020 ******************************************************************
100703*                   C H A N G E   L O G
100703*
100703* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
100703*-----------------------------------------------------------------
100703*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
100703* EFFECTIVE    NUMBER
100703*-----------------------------------------------------------------
100703* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
041105* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
092205* 092205    2005050300006  PEMA  ADD LEASE FEE
032406* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
072406* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
062907* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
011410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
020310* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
071712* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
100703******************************************************************
00021
00022  01  COMPENSATION-MASTER.
00023      12  CO-RECORD-ID                          PIC XX.
00024          88  VALID-CO-ID                          VALUE 'CO'.
00025
00026      12  CO-CONTROL-PRIMARY.
00027          16  CO-COMPANY-CD                     PIC X.
00028          16  CO-CONTROL.
00029              20  CO-CTL-1.
00030                  24  CO-CARR-GROUP.
00031                      28  CO-CARRIER            PIC X.
00032                      28  CO-GROUPING.
00033                          32  CO-GROUP-PREFIX   PIC XXX.
00034                          32  CO-GROUP-PRIME    PIC XXX.
00035                  24  CO-RESP-NO.
00036                      28  CO-RESP-PREFIX        PIC X(4).
00037                      28  CO-RESP-PRIME         PIC X(6).
00038              20  CO-CTL-2.
00039                  24  CO-ACCOUNT.
00040                      28  CO-ACCT-PREFIX        PIC X(4).
00041                      28  CO-ACCT-PRIME         PIC X(6).
00042          16  CO-TYPE                           PIC X.
00043              88  CO-COMPANY-TYPE                  VALUE 'C'.
041105             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
00045              88  CO-ACCOUNT-TYPE                  VALUE 'A'.
00046
00047      12  CO-MAINT-INFORMATION.
00048          16  CO-LAST-MAINT-DT                  PIC XX.
00049          16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
00050          16  CO-LAST-MAINT-USER                PIC X(4).
011410     12  FILLER                                PIC XX.
020210     12  CO-STMT-TYPE                          PIC XXX.
011410     12  CO-COMP-TYPE                          PIC X.
011410         88  CO-COMP-IS-SPPDD                    VALUE '1'.
           12  CO-STMT-OWNER                         PIC X(4).
00053      12  CO-BALANCE-CONTROL                    PIC X.
00054          88  CO-CARRY-BALANCE                     VALUE 'Y'.
00055          88  CO-NO-BALANCE                        VALUE 'N'.
00056
00057      12  CO-INTERNAL-CONTROL-1                 PIC X.
00058          88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
00059          88  CO-AUTO-GENERATED                    VALUE 'Y'.
00060          88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
00061
00062      12  CO-INTERNAL-CONTROL-2                 PIC X.
00063          88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
00064          88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
00065
062907     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
062907     12  CO-GA-DIRECT-DEP                      PIC X.
062907     12  CO-FUTURE-SPACE                       PIC X.
062907         88  CO-FUTURE-NOT-USED                   VALUE ' '.
00068
00069      12  CO-ACCT-NAME                          PIC X(30).
00070      12  CO-MAIL-NAME                          PIC X(30).
00071      12  CO-ADDR-1                             PIC X(30).
00072      12  CO-ADDR-2                             PIC X(30).
CIDMOD     12  CO-ADDR-3.
               16  CO-ADDR-CITY                      PIC X(27).
               16  CO-ADDR-STATE                     PIC XX.
CIDMOD     12  CO-CSO-1099                           PIC X.
00074      12  CO-ZIP.
00075          16  CO-ZIP-PRIME.
00076              20  CO-ZIP-PRI-1ST                PIC X.
00077                  88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
00078              20  FILLER                        PIC X(4).
00079          16  CO-ZIP-PLUS4                      PIC X(4).
00080      12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
00081          16  CO-CAN-POSTAL-1                   PIC XXX.
00082          16  CO-CAN-POSTAL-2                   PIC XXX.
00083          16  FILLER                            PIC XXX.
00084      12  CO-SOC-SEC                            PIC X(13).
00085      12  CO-TELEPHONE.
00086          16  CO-AREA-CODE                      PIC XXX.
00087          16  CO-PREFIX                         PIC XXX.
00088          16  CO-PHONE                          PIC X(4).
00089
00090      12  CO-ROLADEX-PRINT-DT                   PIC XX.
00091
00092      12  CO-AR-BAL-LEVEL                       PIC X.
00093          88  CO-AR-REF-LVL                        VALUE '1'.
00094          88  CO-AR-BILL-REF-LVL                   VALUE '1'.
00095          88  CO-AR-BILL-LVL                       VALUE '2'.
00096          88  CO-AR-AGT-LVL                        VALUE '3'.
00097          88  CO-AR-FR-LVL                         VALUE '4'.
00098
00099      12  CO-AR-NORMAL-PRINT                    PIC X.
00100          88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
00101          88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
00102
00103      12  CO-AR-SUMMARY-CODE                    PIC X(6).
00104
00105      12  CO-AR-REPORTING                       PIC X.
00106          88  CO-AR-NET-REPORT                     VALUE 'N'.
00107          88  CO-AR-GROSS-REPORT                   VALUE 'G'.
00108
00109      12  CO-AR-PULL-CHECK                      PIC X.
00110          88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
00111          88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
00112
00113      12  CO-AR-BALANCE-PRINT                   PIC X.
00114          88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
00115
00116      12  CO-AR-LAST-RUN-CODE                   PIC X.
00117          88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
00118          88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
00119          88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
00120
00121      12  CO-LAST-EOM-STMT-DT                   PIC XX.
00122
00123      12  CO-USER-CODE                          PIC X.
00124      12  CO-REPORT-GROUP-ID                    PIC X(12).
00125
00126 ******************************************************************
00127 *    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
00128 *    THE LAST MONTH END RUN.
00129 ******************************************************************
00130
00131      12  CO-LAST-ACTIVITY-DATE.
00132          16  CO-ACT-YEAR                       PIC 99.
00133          16  CO-ACT-MONTH                      PIC 99.
00134          16  CO-ACT-DAY                        PIC 99.
00135
00136      12  CO-LAST-STMT-DT.
00137          16  CO-LAST-STMT-YEAR                 PIC 99.
00138          16  CO-LAST-STMT-MONTH                PIC 99.
00139          16  CO-LAST-STMT-DAY                  PIC 99.
00140
00141      12  CO-MO-END-TOTALS.
00142          16  CO-MONTHLY-TOTALS.
00143              20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
00144              20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
00145              20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
00146              20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
00147              20  CO-END-BAL                PIC S9(7)V99   COMP-3.
00148
00149          16  CO-AGING-TOTALS.
00150              20  CO-CUR                    PIC S9(7)V99   COMP-3.
00151              20  CO-OV30                   PIC S9(7)V99   COMP-3.
00152              20  CO-OV60                   PIC S9(7)V99   COMP-3.
00153              20  CO-OV90                   PIC S9(7)V99   COMP-3.
00154
00155          16  CO-YTD-TOTALS.
00156              20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
00157              20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
00158
00159          16  CO-OVER-UNDER-TOTALS.
00160              20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
00161              20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
00162
00163      12  CO-MISCELLANEOUS-TOTALS.
00164          16  CO-FICA-TOTALS.
00165              20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
00166              20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
00167
00168          16  CO-CLAIM-TOTALS.
00169              20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
00170              20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
00171
00172 ******************************************************************
00173 *    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
00174 *    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
00175 ******************************************************************
00176
00177      12  CO-CURRENT-TOTALS.
00178          16  CO-CURRENT-LAST-STMT-DT.
00179              20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
00180              20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
00181              20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
00182
00183          16  CO-CURRENT-MONTHLY-TOTALS.
00184              20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
00185              20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
00186              20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
00187              20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
00188              20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
00189
00190          16  CO-CURRENT-AGING-TOTALS.
00191              20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
00192              20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
00193              20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
00194              20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
00195
00196          16  CO-CURRENT-YTD-TOTALS.
00197              20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
00198              20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
00199
00200      12  CO-PAID-COMM-TOTALS.
00201          16  CO-YTD-PAID-COMMS.
00202              20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
00203              20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
00204
00205      12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
00206          88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
00207          88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
00208
00209      12  CO-DELINQUENT-LETTER-CODE         PIC X.
00210          88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
00211          88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
00212          88  CO-AGENT-1ST-LETTER              VALUE 'B'.
00213          88  CO-AGENT-2ND-LETTER              VALUE 'G'.
00214          88  CO-OVERWRITE-LETTER              VALUE 'O'.
00215          88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
00216          88  CO-FINAL-LETTER                  VALUE 'F'.
00217          88  CO-RECONCILING                   VALUE 'R'.
00218          88  CO-PHONE-CALL                    VALUE 'P'.
00219          88  CO-LEGAL                         VALUE 'L'.
00220          88  CO-COLLECTION-AGENCY             VALUE 'C'.
00221          88  CO-WRITE-OFF                     VALUE 'W'.
00222          88  CO-NO-ACTION                     VALUE 'N' ' '.
00223
00224      12  CO-CSR-CODE                       PIC X(4).
00225
00226      12  CO-GA-STATUS-INFO.
00227          16  CO-GA-EFFECTIVE-DT            PIC XX.
00228          16  CO-GA-TERMINATION-DT          PIC XX.
00229          16  CO-GA-STATUS-CODE             PIC X.
00230              88  CO-GA-ACTIVE                 VALUE 'A'.
00231              88  CO-GA-INACTIVE               VALUE 'I'.
00232              88  CO-GA-PENDING                VALUE 'P'.
00233          16  CO-GA-COMMENTS.
00234              20  CO-GA-COMMENT-1           PIC X(40).
00235              20  CO-GA-COMMENT-2           PIC X(40).
00236              20  CO-GA-COMMENT-3           PIC X(40).
00237              20  CO-GA-COMMENT-4           PIC X(40).
00238
00239      12  CO-RPTCD2                         PIC X(10).
071712     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
071712         16  CO-OV120                      PIC S9(7)V99   COMP-3.
071712         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
00240
00241      12  CO-TYPE-AGENT                     PIC X(01).
00242          88  CO-CORPORATION                   VALUE 'C'.
00243          88  CO-PARTNERSHIP                   VALUE 'P'.
00244          88  CO-SOLE-PROPRIETOR               VALUE 'S'.
00245          88  CO-TRUST                         VALUE 'T'.
00246          88  CO-UNKNOWN                       VALUE ' ' 'X'.
00247
00248      12  CO-FAXNO.
00249          16  CO-FAX-AREA-CODE                  PIC XXX.
00250          16  CO-FAX-PREFIX                     PIC XXX.
00251          16  CO-FAX-PHONE                      PIC X(4).
00252
00253      12  CO-BANK-INFORMATION.
00254          16  CO-BANK-TRANSIT-NO                PIC X(8).
00255          16  CO-BANK-TRANSIT-NON REDEFINES
00256              CO-BANK-TRANSIT-NO                PIC 9(8).
00257
00258          16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
           12  CO-MISC-DEDUCT-INFO REDEFINES
                        CO-BANK-INFORMATION.
               16  CO-MD-GL-ACCT                     PIC X(10).
               16  CO-MD-DIV                         PIC XX.
               16  CO-MD-CENTER                      PIC X(4).
               16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
092707         16  CO-CREATE-AP-CHECK                PIC X.
092707         16  CO-DELIVER-CK-TO-MEL              PIC X.
092707         16  FILLER                            PIC XXX.
00259      12  CO-ACH-STATUS                         PIC X.
00260          88  CO-ACH-ACTIVE                         VALUE 'A'.
00261          88  CO-ACH-PENDING                        VALUE 'P'.
00262
CIDMOD     12  CO-BILL-SW                            PIC X.
CIDMOD     12  CO-CONTROL-NAME                       PIC X(30).
092205     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
111504     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
100703     12  CO-CLP-STATE                          PIC XX.
032406     12  CO-FIRST-WRITTEN-DT                   PIC XX.
072406     12  CO-SPP-REFUND-EDIT                    PIC X.
00264
00265 ******************************************************************
100703
111504*    COPY ERCAGTC.
      ******************************************************************
      *                                                                *
      *                                                                *
      *                            ERCAGTC                             *
      *                            VMOD=2.001                          *
      *                                                                *
      *   ONLINE CREDIT SYSTEM                                         *
      *                                                                *
      *   FILE DESCRIPTION = AGENT COMMISSIONS                         *
      *                                                                *
      *   FILE TYPE = VSAM,KSDS                                        *
      *   RECORD SIZE = 450   RECFORM = FIXED                          *
      *                                                                *
      *   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
      *       ALTERNATE PATH = NONE                                    *
      *                                                                *
      *   LOG = NO                                                     *
      *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
      *                                                                *
      ******************************************************************
      *                   C H A N G E   L O G
      *
      * CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
      *-----------------------------------------------------------------
      *  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
      * EFFECTIVE    NUMBER
      *-----------------------------------------------------------------
      * 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
      * 111004                         NEW FILE AND COPYBOOK
092205* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
      ******************************************************************
       01  AGENT-COMMISSIONS.
           12  AG-RECORD-ID                          PIC XX.
               88  VALID-CO-ID                          VALUE 'AG'.
           12  AG-CONTROL-PRIMARY.
               16  AG-COMPANY-CD                     PIC X.
               16  AG-CONTROL.
                   20  AG-CTL-1.
                       24  AG-CARR-GROUP.
                           28  AG-CARRIER            PIC X.
                           28  AG-GROUPING           PIC X(6).
                       24  AG-BANK                   PIC X(10).
                   20  AG-CTL-2.
                       24  AG-EXP-DT                 PIC XX.
               16  AG-TYPE                           PIC X.
                   88  AG-GEN-AGENT-TYPE                VALUE 'G'.
                   88  AG-ACCOUNT-TYPE                  VALUE 'A'.
           12  AG-MAINT-INFORMATION.
               16  AG-LAST-MAINT-DT                  PIC XX.
               16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
               16  AG-LAST-MAINT-USER                PIC X(4).
               16  FILLER                            PIC X(10).
           12  AG-EFF-DT                             PIC XX.
           12  AG-COMM-STRUCTURE.
               16  AG-AGT-COMMS OCCURS 10.
                   20  AG-AGT                PIC X(10).
                   20  AG-COM-TYP            PIC X.
                   20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
                   20  AG-RECALC-LV-INDIC    PIC X.
092205             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
092205             20  AG-LRCALC-LV-INDIC    PIC X.
092205             20  FILLER                PIC X(05).
           12  FILLER                  PIC X(145).
      ******************************************************************
00252 *    COPY ERCRESS.
00001 ******************************************************************
00002 *                                                                *
00003 *                            ERCRESS                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.002                          *
00006 *                                                                *
00007 *   CREDIT RESIDENT STATE TAXES MASTER                          *
00008 *                                                                *
00009 *   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
00010 *   VSAM RESIDENT STATE TAX MASTER                              *
00011 *                                                                *
00012 *   FILE DESCRIPTION = ER.TEST.ERRESS                           *
00013 *                                                                *
00014 *   FILE TYPE = VSAM,KSDS                                        *
00015 *   RECORD SIZE = 0047 RECFORM = FIXED                           *
00016 *                                                                *
00017 *   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
00018 *       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
00019 *                                                                *
00020 *   LOG = NO                                                     *
00021 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00022 *                                                                *
00023 *                                                                *
00024 ******************************************************************
00025
00026  01  RESIDENT-STATE-TAX-MASTER.
00027
00028      10  ERRESS-PRIMARY-KEY.
00029          15  RES-COMPANY-CD        PIC X.
00030          15  RES-RESIDENT-STATE    PIC XX.
00031          15  RES-COVERAGE-CATEGORY PIC X.
00032          15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
00033 *                                      YYYYMMDD
00034 *****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
00035
00036      10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
00037
00038          15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
00039          15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
00040          15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
00041          15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
00042
00043      10 RES-RECALC-SW              PIC   X.
00044          88 RECALC                VALUE 'Y'.
00045          88 NO-RECALC             VALUE 'N'.
00046      10  RES-MAINT-BY              PIC X(4).
00047      10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
00048      10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
00049 *                                      YYYYMMDD
00253      EJECT
00254 *    COPY ERCRESC.
00001 ******************************************************************
CIDMOD*                                                                *
00003 *                            ERCRESC                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.003                          *
00006 *                                                                *
00007 *   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
00008 *                                                                *
00009 *   FILE TYPE = VSAM,KSDS                                        *
00010 *   RECORD SIZE = 103 RECFORM = FIXED                            *
00011 *                                                                *
00012 *   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
00013 *       ALTERNATE PATH1 = NONE                                   *
00014 *                                                                *
00015 *   LOG = NO                                                     *
00016 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00017 *                                                                *
00018 ******************************************************************
00019
00020  01  ACCOUNT-RESIDENT-ST-COMMISSION.
00021
00022      10  ERRESC-RECORD-KEY.
00023          15  RESC-COMPANY-CD           PIC   X.
00024          15  RESC-CARRIER              PIC   X.
00025          15  RESC-GROUP                PIC   X(6).
00026          15  RESC-STATE                PIC   XX.
00027          15  RESC-ACCOUNT              PIC   X(10).
00028          15  RESC-AGENT                PIC   X(10).
00029          15  RESC-RESIDENT-STATE       PIC   XX.
00030          15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
00031 *                                           YYYYMMDD
00032      10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
00033
00034      10  RESC-COMM-RECORD-DATA.
00035          15  RESC-COMMISSIONS OCCURS 12 TIMES.
00036              20 RESC-COVERAGE-CAT      PIC    X.
00037              20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
00038              20 RESC-COMMISSION-TAB REDEFINES
00039                 RESC-COMMISSION-PER    PIC  XXX.
00040
00041      10  RESC-MAINT-BY                 PIC X(4).
00042      10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
00043      10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
00044 *                                          YYYYMMDD
00255      EJECT
00256 *    COPY ERCPLAN.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCPLAN                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.003                          *
00006 *                                                                *
00007 *   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
00008 *                                                                *
00009 *   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
00010 *   PLAN MASTER                                                  *
00011 *                                                                *
00012 *   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
00013 *                                                                *
00014 *   FILE TYPE = VSAM,KSDS                                        *
00015 *   RECORD SIZE = 420   RECFORM = FIX                            *
00016 *                                                                *
00017 *   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
00018 *       ALTERNATE PATH1 = N/A                                    *
00019 *                                                                *
00020 *   LOG = NO                                                     *
00021 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00022 *                                                                *
00023 *                                                                *
00024 ******************************************************************
00025
00026  01  PLAN-MASTER.
00027      12  PL-RECORD-ID                      PIC XX.
00028          88  VALID-PL-ID                      VALUE 'PL'.
00029
00030      12  PL-CONTROL-PRIMARY.
00031          16  PL-COMPANY-CD                 PIC X.
00032          16  PL-MSTR-CNTRL.
00033              20  PL-CONTROL-A.
00034                  24  PL-CARRIER            PIC X.
00035                  24  PL-GROUPING           PIC X(6).
00036                  24  PL-STATE              PIC XX.
00037                  24  PL-ACCOUNT            PIC X(10).
00038              20  PL-BENEFIT-TYPE           PIC X.
00039              20  PL-BENEFIT-CODE           PIC XX.
00040              20  PL-REVISION-NO            PIC X(3).
00041
00042      12  PL-CONTROL-BY-VAR-GRP.
00043          16  PL-COMPANY-CD-A1              PIC X.
00044          16  PL-VG-CARRIER                 PIC X.
00045          16  PL-VG-GROUPING                PIC X(6).
00046          16  PL-VG-STATE                   PIC XX.
00047          16  PL-VG-ACCOUNT                 PIC X(10).
00048          16  PL-BENEFIT-TYPE-A1            PIC X.
00049          16  PL-BENEFIT-CODE-A1            PIC XX.
00050          16  PL-REVISION-NO-A1             PIC 999.
00051
00052      12  PL-MAINT-INFORMATION.
00053          16  PL-LAST-MAINT-DT              PIC XX.
00054          16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
00055          16  PL-LAST-MAINT-USER            PIC X(4).
00056          16  FILLER                        PIC XX.
00057
00058      12  PL-LIABILITY-LIMITS.
00059          16  PL-ATT-AGE                    PIC S99        COMP-3.
00060          16  PL-L-LIMITS        OCCURS 8 TIMES.
00061              20  PL-LM-AGE                 PIC S99        COMP-3.
00062              20  PL-LM-DUR                 PIC S999       COMP-3.
00063              20  PL-LM-MOA                 PIC S9(4)      COMP-3.
00064              20  PL-LM-AMT                 PIC S9(6)      COMP-3.
00065
00066      12  FILLER                            PIC X(30).
00067
00068      12  PL-GL-ACCOUNT-NOS.
00069          16  PL-PREMIUM-GL                 PIC X(8).
00070          16  PL-COMM-GL                    PIC X(8).
00071          16  PL-CLAIM-GL                   PIC X(8).
00072      12  FILLER                            PIC X(24).
00073      12  PL-TOLERANCES.
00074          16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
00075          16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
00076          16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
00077          16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
00078          16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
00079          16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
00080      12  PL-OVER-SHORT.
00081          16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
00082          16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
00083      12  FILLER                            PIC X(24).
00084      12  PLAN-MISC.
00085          16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
00086          16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
00087          16  PL-IG                         PIC X.
00088          16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
00089          16  PL-POLICY-FORM                PIC X(12).
00090          16  PL-EDIT-FOR-FORM              PIC X(01).
00091          16  PL-DEV-CODE                   PIC XXX.
00092          16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
00093          16  PL-CALC-METHOD                PIC X.
00094          16  PL-BENEFIT-GROUP              PIC X(05).
00095          16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
00096
00097          16  FILLER                        PIC X(99).
00098 ******************************************************************
00257      EJECT
00258 *    COPY ELCCERT.
00001 ******************************************************************
00002 *                                                                *
00003 *                            ELCCERT.                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.013                          *
00006 *                                                                *
00007 *   FILE DESCRIPTION = CERTIFICATE MASTER                        *
00008 *                                                                *
00009 *   FILE TYPE = VSAM,KSDS                                        *
00010 *   RECORD SIZE = 450  RECFORM = FIXED                           *
00011 *                                                                *
00012 *   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
00013 *       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
00014 *       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
00015 *       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
00016 *       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
00017 *                                                                *
00018 *   LOG = YES                                                    *
00019 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
122002******************************************************************
122002*                   C H A N G E   L O G
122002*
122002* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
122002*-----------------------------------------------------------------
122002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
122002* EFFECTIVE    NUMBER
122002*-----------------------------------------------------------------
122002* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
040504* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
061405* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
110105* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
072308* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
102109* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
011410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
032612* 032612  CR2011110200001  PEMA  AHL CHANGES
122002******************************************************************
00021
00022  01  CERTIFICATE-MASTER.
00023      12  CM-RECORD-ID                      PIC XX.
00024          88  VALID-CM-ID                      VALUE 'CM'.
00025
00026      12  CM-CONTROL-PRIMARY.
00027          16  CM-COMPANY-CD                 PIC X.
00028          16  CM-CARRIER                    PIC X.
00029          16  CM-GROUPING.
00030              20  CM-GROUPING-PREFIX        PIC X(3).
00031              20  CM-GROUPING-PRIME         PIC X(3).
00032          16  CM-STATE                      PIC XX.
00033          16  CM-ACCOUNT.
00034              20  CM-ACCOUNT-PREFIX         PIC X(4).
00035              20  CM-ACCOUNT-PRIME          PIC X(6).
00036          16  CM-CERT-EFF-DT                PIC XX.
00037          16  CM-CERT-NO.
00038              20  CM-CERT-PRIME             PIC X(10).
00039              20  CM-CERT-SFX               PIC X.
00040
00041      12  CM-CONTROL-BY-NAME.
00042          16  CM-COMPANY-CD-A1              PIC X.
00043          16  CM-INSURED-LAST-NAME          PIC X(15).
00044          16  CM-INSURED-INITIALS.
00045              20  CM-INSURED-INITIAL1       PIC X.
00046              20  CM-INSURED-INITIAL2       PIC X.
00047
00048      12  CM-CONTROL-BY-SSN.
00049          16  CM-COMPANY-CD-A2              PIC X.
00050          16  CM-SOC-SEC-NO.
00051              20  CM-SSN-STATE              PIC XX.
00052              20  CM-SSN-ACCOUNT            PIC X(6).
00053              20  CM-SSN-LN3.
00054                  25  CM-INSURED-INITIALS-A2.
00055                      30 CM-INSURED-INITIAL1-A2   PIC X.
00056                      30 CM-INSURED-INITIAL2-A2   PIC X.
00057                  25 CM-PART-LAST-NAME-A2         PIC X.
00058
00059      12  CM-CONTROL-BY-CERT-NO.
00060          16  CM-COMPANY-CD-A4              PIC X.
00061          16  CM-CERT-NO-A4                 PIC X(11).
00062
00063      12  CM-CONTROL-BY-MEMB.
00064          16  CM-COMPANY-CD-A5              PIC X.
00065          16  CM-MEMBER-NO.
00066              20  CM-MEMB-STATE             PIC XX.
00067              20  CM-MEMB-ACCOUNT           PIC X(6).
00068              20  CM-MEMB-LN4.
00069                  25  CM-INSURED-INITIALS-A5.
00070                      30 CM-INSURED-INITIAL1-A5   PIC X.
00071                      30 CM-INSURED-INITIAL2-A5   PIC X.
00072                  25 CM-PART-LAST-NAME-A5         PIC XX.
00073
00074      12  CM-INSURED-PROFILE-DATA.
00075          16  CM-INSURED-FIRST-NAME.
00076              20  CM-INSURED-1ST-INIT       PIC X.
00077              20  FILLER                    PIC X(9).
00078          16  CM-INSURED-ISSUE-AGE          PIC 99.
00079          16  CM-INSURED-SEX                PIC X.
00080              88  CM-SEX-MALE                  VALUE 'M'.
00081              88  CM-SEX-FEMAL                 VALUE 'F'.
00082          16  CM-INSURED-JOINT-AGE          PIC 99.
00083          16  CM-JOINT-INSURED-NAME.
00084              20  CM-JT-LAST-NAME           PIC X(15).
00085              20  CM-JT-FIRST-NAME.
00086                  24  CM-JT-1ST-INIT        PIC X.
00087                  24  FILLER                PIC X(9).
00088              20  CM-JT-INITIAL             PIC X.
00089
00090      12  CM-LIFE-DATA.
00091          16  CM-LF-BENEFIT-CD              PIC XX.
00092          16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
00093          16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
00094          16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
00095          16  CM-LF-DEV-CODE                PIC XXX.
00096          16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
00097          16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
00098          16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
00099          16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
00100          16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
00101          16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
00102          16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
00103          16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
00104          16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
00105          16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
00106          16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
00107          16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
00108          16  FILLER                        PIC XX.
00109
00110      12  CM-AH-DATA.
00111          16  CM-AH-BENEFIT-CD              PIC XX.
00112          16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
00113          16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
00114          16  CM-AH-DEV-CODE                PIC XXX.
00115          16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
00116          16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
00117          16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
00118          16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
00119          16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
00120          16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
00121          16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
00122          16  CM-AH-PAID-THRU-DT            PIC XX.
00123              88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
00124          16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
00125          16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
00126          16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
00127          16  FILLER                        PIC X.
00128
00129      12  CM-LOAN-INFORMATION.
00130          16  CM-LIVES                      PIC S9(7)     COMP-3.
011410         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
011410                                           PIC S9(5)V99  COMP-3.
00131          16  CM-BILLED                     PIC S9(7)     COMP-3.
00132          16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
00133          16  CM-PAY-FREQUENCY              PIC S99.
00134          16  CM-LOAN-TERM                  PIC S999      COMP-3.
00135          16  CM-RATE-CLASS                 PIC XX.
00136          16  CM-BENEFICIARY                PIC X(25).
00137          16  CM-POLICY-FORM-NO             PIC X(12).
00138          16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
00139          16  CM-LAST-ADD-ON-DT             PIC XX.
00140          16  CM-DEDUCTIBLE-AMOUNTS.
00141              20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
00142              20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
00143          16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
00144              20  CM-RESIDENT-STATE         PIC XX.
00145              20  CM-RATE-CODE              PIC X(4).
00146              20  FILLER                    PIC XX.
110105         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
110105             20  CM-LOAN-OFFICER           PIC X(5).
110105             20  FILLER                    PIC XXX.
00147          16  CM-CSR-CODE                   PIC XXX.
00148          16  CM-UNDERWRITING-CODE          PIC X.
00149              88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
081606         16  CM-POST-CARD-IND              PIC X.
072308         16  CM-NH-INTERFACE-SW            PIC X.
00151          16  CM-PREMIUM-TYPE               PIC X.
00152              88  CM-SING-PRM                  VALUE '1'.
00153              88  CM-O-B-COVERAGE              VALUE '2'.
00154              88  CM-OPEN-END                  VALUE '3'.
00155          16  CM-IND-GRP-TYPE               PIC X.
00156              88  CM-INDIVIDUAL                VALUE 'I'.
00157              88  CM-GROUP                     VALUE 'G'.
00158          16  CM-SKIP-CODE                  PIC X.
00159              88  NO-MONTHS-SKIPPED            VALUE SPACE.
00160              88  SKIP-JULY                    VALUE '1'.
00161              88  SKIP-AUGUST                  VALUE '2'.
00162              88  SKIP-SEPTEMBER               VALUE '3'.
00163              88  SKIP-JULY-AUG                VALUE '4'.
00164              88  SKIP-AUG-SEPT                VALUE '5'.
00165              88  SKIP-JULY-AUG-SEPT           VALUE '6'.
00166              88  SKIP-JUNE-JULY-AUG           VALUE '7'.
00167              88  SKIP-JUNE                    VALUE '8'.
00168              88  SKIP-JUNE-JULY               VALUE '9'.
00169              88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
00170              88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
00171          16  CM-PAYMENT-MODE               PIC X.
00172              88  PAY-MONTHLY                  VALUE SPACE.
00173              88  PAY-WEEKLY                   VALUE '1'.
00174              88  PAY-SEMI-MONTHLY             VALUE '2'.
00175              88  PAY-BI-WEEKLY                VALUE '3'.
00176              88  PAY-SEMI-ANUALLY             VALUE '4'.
00177          16  CM-LOAN-NUMBER                PIC X(8).
00178          16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
110105         16  CM-OLD-LOF                    PIC XXX.
00179 *        16  CM-LOAN-OFFICER               PIC XXX.
00180          16  CM-REIN-TABLE                 PIC XXX.
00181          16  CM-SPECIAL-REIN-CODE          PIC X.
00182          16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
00183          16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
00184          16  CM-LOAN-1ST-PMT-DT            PIC XX.
00185
00186      12  CM-STATUS-DATA.
00187          16  CM-ENTRY-STATUS               PIC X.
00188          16  CM-ENTRY-DT                   PIC XX.
00189
00190          16  CM-LF-STATUS-AT-CANCEL        PIC X.
00191          16  CM-LF-CANCEL-DT               PIC XX.
00192          16  CM-LF-CANCEL-EXIT-DT          PIC XX.
00193
00194          16  CM-LF-STATUS-AT-DEATH         PIC X.
00195          16  CM-LF-DEATH-DT                PIC XX.
00196          16  CM-LF-DEATH-EXIT-DT           PIC XX.
00197
00198          16  CM-LF-CURRENT-STATUS          PIC X.
00199              88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
00200                                                 'M' '4' '5' '9'.
00201              88  CM-LF-NORMAL-ENTRY           VALUE '1'.
00202              88  CM-LF-POLICY-PENDING         VALUE '2'.
00203              88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
00204              88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
00205              88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
122002             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
00206              88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
00207              88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
00208              88  CM-LF-CANCEL-APPLIED         VALUE '8'.
00209              88  CM-LF-IS-REIN-ONLY           VALUE '9'.
00210              88  CM-LF-DECLINED               VALUE 'D'.
00211              88  CM-LF-VOIDED                 VALUE 'V'.
00212
00213          16  CM-AH-STATUS-AT-CANCEL        PIC X.
00214          16  CM-AH-CANCEL-DT               PIC XX.
00215          16  CM-AH-CANCEL-EXIT-DT          PIC XX.
00216
00217          16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
00218          16  CM-AH-SETTLEMENT-DT           PIC XX.
00219          16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
00220
00221          16  CM-AH-CURRENT-STATUS          PIC X.
00222              88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
00223                                                 'M' '4' '5' '9'.
00224              88  CM-AH-NORMAL-ENTRY           VALUE '1'.
00225              88  CM-AH-POLICY-PENDING         VALUE '2'.
00226              88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
00227              88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
00228              88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
122002             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
00229              88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
00230              88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
00231              88  CM-AH-CANCEL-APPLIED         VALUE '8'.
00232              88  CM-AH-IS-REIN-ONLY           VALUE '9'.
00233              88  CM-AH-DECLINED               VALUE 'D'.
00234              88  CM-AH-VOIDED                 VALUE 'V'.
00235
00236          16  CM-CLAIM-INTERFACE-SW         PIC X.
00237              88  NO-CLAIM-ATTACHED            VALUE SPACE.
00238              88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
00239              88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
00240          16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
00241
00242          16  CM-ENTRY-BATCH                PIC X(6).
00243          16  CM-LF-EXIT-BATCH              PIC X(6).
00244          16  CM-AH-EXIT-BATCH              PIC X(6).
00245          16  CM-LAST-MONTH-END             PIC XX.
00246
00247      12  CM-NOTE-SW                        PIC X.
00248          88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
00249          88  CERT-NOTES-PRESENT               VALUE '1'.
00250          88  BILLING-NOTES-PRESENT            VALUE '2'.
00251          88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
102109         88  CLAIM-NOTES-PRESENT              VALUE '4'.
102109         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
102109         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
102109         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
00252      12  CM-COMP-EXCP-SW                   PIC X.
00253          88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
00254          88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
00255      12  CM-INSURED-ADDRESS-SW             PIC X.
00256          88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
00257          88  INSURED-ADDR-PRESENT             VALUE '1'.
00258
011410*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
011410     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
011410     12  FILLER                            PIC X.
00260
011410*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
011410     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
011410     12  FILLER                            PIC X.
072308*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
072308     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
00263
00264      12  CM-CREDIT-INTERFACE-SW-1          PIC X.
00265          88  CERT-ADDED-BATCH                 VALUE ' '.
00266          88  CERT-ADDED-ONLINE                VALUE '1'.
00267          88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
00268          88  CERT-PURGED-OFFLINE              VALUE '3'.
00269          88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
00270      12  CM-CREDIT-INTERFACE-SW-2          PIC X.
00271          88  CERT-AS-LOADED                   VALUE ' '.
00272          88  CERT-CANCELLED-ONLINE            VALUE '1'.
00273          88  CERT-CLAIM-ONLINE                VALUE '2'.
00274          88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
00275          88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
00276          88  CERT-PEND-CANCEL-VOID            VALUE '5'.
00277          88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
00278          88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
00279
00280      12  CM-ACCOUNT-COMM-PCTS.
00281          16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
00282          16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
00283
00284      12  CM-USER-FIELD                     PIC X.
040504     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
061405     12  CM-CLP-STATE                      PIC XX.
032612     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
061405     12  CM-USER-RESERVED                  PIC XXX.
032612     12  FILLER REDEFINES CM-USER-RESERVED.
032612         16  CM-AH-CLASS-CD                PIC XX.
032612         16  F                             PIC X.
00286 ******************************************************************
00259      EJECT
00260 *    COPY ERCMAIL.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCMAIL                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.003                          *
00006 *                                                                *
00007 *   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
00008 *                                                                *
00009 *   FILE TYPE = VSAM,KSDS                                        *
CIDMOD*   RECORD SIZE = 374   RECFORM = FIX                            *
00011 *                                                                *
00012 *   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
00013 *   ALTERNATE PATH    = NOT USED                                 *
00014 *                                                                *
00015 *   LOG = YES                                                    *
00016 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
080406******************************************************************
080406*                   C H A N G E   L O G
080406*
080406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
080406*-----------------------------------------------------------------
080406*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
080406* EFFECTIVE    NUMBER
080406*-----------------------------------------------------------------
080406* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
090408* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
111108* 111108                   PEMA  ADD CRED BENE ADDR2
00017 ******************************************************************
00018
00019  01  MAILING-DATA.
00020      12  MA-RECORD-ID                      PIC XX.
00021          88  VALID-MA-ID                       VALUE 'MA'.
00022
00023      12  MA-CONTROL-PRIMARY.
00024          16  MA-COMPANY-CD                 PIC X.
00025          16  MA-CARRIER                    PIC X.
00026          16  MA-GROUPING.
00027              20  MA-GROUPING-PREFIX        PIC XXX.
00028              20  MA-GROUPING-PRIME         PIC XXX.
00029          16  MA-STATE                      PIC XX.
00030          16  MA-ACCOUNT.
00031              20  MA-ACCOUNT-PREFIX         PIC X(4).
00032              20  MA-ACCOUNT-PRIME          PIC X(6).
00033          16  MA-CERT-EFF-DT                PIC XX.
00034          16  MA-CERT-NO.
00035              20  MA-CERT-PRIME             PIC X(10).
00036              20  MA-CERT-SFX               PIC X.
00037
00038      12  FILLER                            PIC XX.
00039
00040      12  MA-ACCESS-CONTROL.
00041          16  MA-SOURCE-SYSTEM              PIC XX.
00042              88  MA-FROM-CREDIT                VALUE 'CR'.
00043              88  MA-FROM-VSI                   VALUE 'VS'.
00044              88  MA-FROM-WARRANTY              VALUE 'WA'.
00045              88  MA-FROM-OTHER                 VALUE 'OT'.
00046          16  MA-RECORD-ADD-DT              PIC XX.
00047          16  MA-RECORD-ADDED-BY            PIC XXXX.
00048          16  MA-LAST-MAINT-DT              PIC XX.
00049          16  MA-LAST-MAINT-BY              PIC XXXX.
00050          16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
00051
00052      12  MA-PROFILE-INFO.
00053          16  MA-QUALIFY-CODE-1             PIC XX.
00054          16  MA-QUALIFY-CODE-2             PIC XX.
00055          16  MA-QUALIFY-CODE-3             PIC XX.
00056          16  MA-QUALIFY-CODE-4             PIC XX.
00057          16  MA-QUALIFY-CODE-5             PIC XX.
00058
00059          16  MA-INSURED-LAST-NAME          PIC X(15).
00060          16  MA-INSURED-FIRST-NAME         PIC X(10).
00061          16  MA-INSURED-MIDDLE-INIT        PIC X.
00062          16  MA-INSURED-ISSUE-AGE          PIC 99.
00063          16  MA-INSURED-BIRTH-DT           PIC XX.
00064          16  MA-INSURED-SEX                PIC X.
00065              88  MA-SEX-MALE                   VALUE 'M'.
00066              88  MA-SEX-FEMALE                 VALUE 'F'.
00067          16  MA-INSURED-SOC-SEC-NO         PIC X(11).
00068
080406         16  MA-ADDRESS-CORRECTED          PIC X.
081108         16  MA-JOINT-BIRTH-DT             PIC XX.
00069 *        16  FILLER                        PIC X(12).
00070
00071          16  MA-ADDRESS-LINE-1             PIC X(30).
00072          16  MA-ADDRESS-LINE-2             PIC X(30).
00073          16  MA-CITY-STATE.
                   20  MA-CITY                   PIC X(28).
                   20  MA-ADDR-STATE             PIC XX.
00074          16  MA-ZIP.
00075              20  MA-ZIP-CODE.
00076                  24  MA-ZIP-CODE-1ST       PIC X(1).
00077                      88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
00078                  24  FILLER                PIC X(4).
00079              20  MA-ZIP-PLUS4              PIC X(4).
00080          16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
00081              20  MA-CAN-POSTAL-CODE-1      PIC X(3).
00082              20  MA-CAN-POSTAL-CODE-2      PIC X(3).
00083              20  FILLER                    PIC X(3).
00084
00085          16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
00086
               16  FILLER                        PIC XXX.
00087 *        16  FILLER                        PIC X(10).
00088
           12  MA-CRED-BENE-INFO.
CIDMOD         16  MA-CRED-BENE-NAME                 PIC X(25).
CIDMOD         16  MA-CRED-BENE-ADDR                 PIC X(30).
               16  MA-CRED-BENE-ADDR2                PIC X(30).
CIDMOD         16  MA-CRED-BENE-CTYST.
                   20  MA-CRED-BENE-CITY             PIC X(28).
                   20  MA-CRED-BENE-STATE            PIC XX.
CIDMOD         16  MA-CRED-BENE-ZIP.
CIDMOD             20  MA-CB-ZIP-CODE.
CIDMOD                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
CIDMOD                     88  MA-CB-CANADIAN-POST-CODE
                                                 VALUE 'A' THRU 'Z'.
CIDMOD                 24  FILLER                    PIC X(4).
CIDMOD             20  MA-CB-ZIP-PLUS4               PIC X(4).
CIDMOD         16  MA-CB-CANADIAN-POSTAL-CODE
                                  REDEFINES MA-CRED-BENE-ZIP.
CIDMOD             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
CIDMOD             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
CIDMOD             20  FILLER                        PIC X(3).
080406     12  MA-POST-CARD-MAIL-DATA.
080406         16  MA-MAIL-DATA OCCURS 7.
080406             20  MA-MAIL-TYPE              PIC X.
080406                 88  MA-12MO-MAILING           VALUE '1'.
080406                 88  MA-EXP-MAILING            VALUE '2'.
080406             20  MA-MAIL-STATUS            PIC X.
080406                 88  MA-MAIL-ST-MAILED         VALUE '1'.
080406                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
080406                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
080406             20  MA-MAIL-DATE              PIC XX.
080406     12  FILLER                            PIC XX.
           12  FILLER                            PIC XX.
080406*    12  FILLER                            PIC X(30).
00090 ******************************************************************
00261      EJECT
00262 *    COPY ERCPNDM.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCPNDM                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.003                          *
00006 *                                                                *
00007 *   FILE DESCRIPTION = PENDING MAILING DATA                      *
00008 *                                                                *
00009 *   FILE TYPE = VSAM,KSDS                                        *
CIDMOD*   RECORD SIZE = 374   RECFORM = FIX                            *
00011 *                                                                *
00012 *   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
00013 *   ALTERNATE PATH    = NOT USED                                 *
00014 *                                                                *
00015 *   LOG = YES                                                    *
00016 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
080406******************************************************************
080406*                   C H A N G E   L O G
080406*
080406* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
080406*-----------------------------------------------------------------
080406*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
080406* EFFECTIVE    NUMBER
080406*-----------------------------------------------------------------
080406* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
071108* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
090408* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
00017 ******************************************************************
00018
00019  01  PENDING-MAILING-DATA.
00020      12  PM-RECORD-ID                      PIC XX.
00021          88  VALID-MA-ID                       VALUE 'PM'.
00022
00023      12  PM-CONTROL-PRIMARY.
00024          16  PM-COMPANY-CD                 PIC X.
00025          16  PM-ENTRY-BATCH                PIC X(6).
00026          16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
00027          16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
00028
00029      12  FILLER                            PIC X(14).
00030
00031      12  PM-ACCESS-CONTROL.
00032          16  PM-SOURCE-SYSTEM              PIC XX.
00033              88  PM-FROM-CREDIT                VALUE 'CR'.
00034              88  PM-FROM-VSI                   VALUE 'VS'.
00035              88  PM-FROM-WARRANTY              VALUE 'WA'.
00036              88  PM-FROM-OTHER                 VALUE 'OT'.
00037          16  PM-RECORD-ADD-DT              PIC XX.
00038          16  PM-RECORD-ADDED-BY            PIC XXXX.
00039          16  PM-LAST-MAINT-DT              PIC XX.
00040          16  PM-LAST-MAINT-BY              PIC XXXX.
00041          16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
00042
00043      12  PM-PROFILE-INFO.
00044          16  PM-QUALIFY-CODE-1             PIC XX.
00045          16  PM-QUALIFY-CODE-2             PIC XX.
00046          16  PM-QUALIFY-CODE-3             PIC XX.
00047          16  PM-QUALIFY-CODE-4             PIC XX.
00048          16  PM-QUALIFY-CODE-5             PIC XX.
00049
00050          16  PM-INSURED-LAST-NAME          PIC X(15).
00051          16  PM-INSURED-FIRST-NAME         PIC X(10).
00052          16  PM-INSURED-MIDDLE-INIT        PIC X.
00053          16  PM-INSURED-ISSUE-AGE          PIC 99.
00054          16  PM-INSURED-BIRTH-DT           PIC XX.
00055          16  PM-INSURED-SEX                PIC X.
00056              88  PM-SEX-MALE                   VALUE 'M'.
00057              88  PM-SEX-FEMALE                 VALUE 'F'.
00058          16  PM-INSURED-SOC-SEC-NO         PIC X(11).
00059
080406         16  PM-ADDRESS-CORRECTED          PIC X.
081108         16  PM-JOINT-BIRTH-DT             PIC XX.
00060 *        16  FILLER                        PIC X(12).
00061
00062          16  PM-ADDRESS-LINE-1             PIC X(30).
00063          16  PM-ADDRESS-LINE-2             PIC X(30).
00064          16  PM-CITY-STATE.
                   20  PM-CITY                   PIC X(28).
                   20  PM-STATE                  PIC XX.
00065          16  PM-ZIP.
00066              20  PM-ZIP-CODE.
00067                  24  PM-ZIP-1              PIC X.
00068                      88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
00069                  24  FILLER                PIC X(4).
00070              20  PM-ZIP-PLUS4              PIC X(4).
00071          16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
00072              20  PM-CAN-POST1              PIC XXX.
00073              20  PM-CAN-POST2              PIC XXX.
00074              20  FILLER                    PIC XXX.
00075
00076          16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
00077
00078          16  FILLER                        PIC X(03).
00079
           12  PM-CRED-BENE-INFO.
CIDMOD         16  PM-CRED-BENE-NAME             PIC X(25).
CIDMOD         16  PM-CRED-BENE-ADDR             PIC X(30).
071108         16  PM-CRED-BENE-ADDR2            PIC X(30).
CIDMOD         16  PM-CRED-BENE-CTYST.
                   20  PM-CRED-BENE-CITY         PIC X(28).
                   20  PM-CRED-BENE-STATE        PIC XX.
CIDMOD         16  PM-CRED-BENE-ZIP.
CIDMOD             20  PM-CB-ZIP-CODE.
CIDMOD                 24  PM-CB-ZIP-1           PIC X.
CIDMOD                     88  PM-CB-CANADIAN-POST-CODE
                                        VALUE 'A' THRU 'Z'.
CIDMOD                 24  FILLER                PIC X(4).
CIDMOD             20  PM-CB-ZIP-PLUS4           PIC X(4).
CIDMOD         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
CIDMOD             20  PM-CB-CAN-POST1           PIC XXX.
CIDMOD             20  PM-CB-CAN-POST2           PIC XXX.
CIDMOD             20  FILLER                    PIC XXX.
080406     12  PM-POST-CARD-MAIL-DATA.
080406         16  PM-MAIL-DATA OCCURS 7.
080406             20  PM-MAIL-TYPE              PIC X.
080406                 88  PM-12MO-MAILING           VALUE '1'.
080406                 88  PM-EXP-MAILING            VALUE '2'.
080406             20  PM-MAIL-STATUS            PIC X.
080406                 88  PM-MAIL-ST-MAILED         VALUE '1'.
080406                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
080406                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
080406             20  PM-MAIL-DATE              PIC XX.
080406     12  FILLER                            PIC XX.
           12  FILLER                            PIC X(12).
080406*    12  FILLER                            PIC X(30).
00075
00081 ******************************************************************
083106*                                COPY ERCLOFC.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCLOFC                             *
00003 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00004 *                            VMOD=2.003                          *
00005 *                                                                *
00006 *   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
00007 *                                                                *
00008 *   FILE TYPE = VSAM,KSDS                                        *
00009 *   RECORD SIZE = 670   RECFORM = FIX                            *
00010 *                                                                *
00011 *   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
00012 *                                                                *
00013 *   LOG = YES                                                    *
00014 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00015 *                                                                *
00016 ******************************************************************
00017
00018  01  LOAN-OFFICER-MASTER.
00019      12  LO-RECORD-ID                PIC XX.
00020          88  VALID-LO-ID                VALUE 'LO'.
00021
00022      12  LO-CONTROL-PRIMARY.
00023          16  LO-COMPANY-CD           PIC X.
00024          16  LO-CARRIER              PIC X.
00025          16  LO-GROUPING.
00026              20  LO-GROUPING-PREFIX  PIC XXX.
00027              20  LO-GROUPING-PRIME   PIC XXX.
00028          16  LO-STATE                PIC XX.
00029          16  LO-ACCOUNT.
00030              20  LO-ACCOUNT-PREFIX   PIC X(4).
00031              20  LO-ACCOUNT-PRIME    PIC X(6).
00032          16  LO-OFFICER-CODE         PIC X(5).
00033
00034      12  LO-OFFICER-NAME             PIC X(30).
00035
00036      12  LO-LAST-MAINT-DT            PIC XX.
00037      12  LO-LAST-USER                PIC X(4).
00038      12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
00039
00040      12  LO-COMP-CONTROL             PIC X.
00041              88  LO-SHOW-COMP           VALUE 'Y'.
00042              88  LO-SUPPRESS-COMP       VALUE 'N'.
00043      12  LO-DETAIL-CONTROL           PIC X.
00044              88  LO-PRINT-DETAIL        VALUE 'D'.
00045              88  LO-PRINT-SUMMARY       VALUE 'S'.
00046
00047      12  LO-SV-CARRIER               PIC X.
00048      12  LO-SV-GROUPING              PIC X(6).
00049      12  LO-SV-STATE                 PIC XX.
00050
00051      12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
00052      12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
00053
00054      12  LO-OFFICER-INFO.
00055          16  FILLER OCCURS 12 TIMES.
00056              20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
00057              20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
00058              20  LO-LF-COUNT         PIC S9(5) COMP-3.
00059              20  LO-LF-PREM          PIC S9(7) COMP-3.
00060              20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
00061              20  LO-AH-COUNT         PIC S9(5) COMP-3.
00062              20  LO-AH-PREM          PIC S9(7) COMP-3.
00063              20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
110105     12  FILLER                      PIC X(198).
00064 ******************************************************************
      *                                COPY ERCPDEF.
      ******************************************************************
      *                                                                *
      *                                                                *
      *                            ERCPDEF.                            *
      *                                                                *
      *    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
      *                                                                *
      *    FILE TYPE = VSAM,KSDS                                       *
      *    RECORD SIZE = 1319 RECFORM = FIXED                          *
      *                                                                *
      *    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
      *                                                                *
      *    LOG = YES                                                   *
      *    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
      ******************************************************************
       01  PRODUCT-MASTER.
          12  PD-RECORD-ID                 PIC X(02).
              88  VALID-PD-ID                  VALUE 'PD'.
          12  PD-CONTROL-PRIMARY.
              16  PD-COMPANY-CD            PIC X.
              16  PD-STATE                 PIC XX.
              16  PD-PRODUCT-CD            PIC XXX.
              16  PD-FILLER                PIC X(7).
              16  PD-BEN-TYPE              PIC X.
              16  PD-BEN-CODE              PIC XX.
              16  PD-PROD-EXP-DT           PIC XX.
          12  FILLER                       PIC X(50).
          12  PD-PRODUCT-DATA OCCURS 8.
              16  PD-PROD-CODE             PIC X.
                  88  PD-PROD-LIFE           VALUE 'L'.
                  88  PD-PROD-PROP           VALUE 'P'.
                  88  PD-PROD-AH             VALUE 'A'.
                  88  PD-PROD-IU             VALUE 'I'.
                  88  PD-PROD-GAP            VALUE 'G'.
              16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
              16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
              16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
              16  PD-MAX-TERM              PIC S999        COMP-3.
              16  PD-MAX-AMT               PIC S9(07)      COMP-3.
              16  FILLER                   PIC X.
              16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
              16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
              16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
              16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
              16  PD-CRIT-PERIOD           PIC S999        COMP-3.
              16  PD-REC-CRIT-PERIOD       PIC X.
              16  PD-RTW-MOS               PIC 99.
              16  FILLER                   PIC X(5).
          12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
          12  PD-TERM-LIMITS OCCURS 15.
              16  PD-LOW-TERM              PIC S999        COMP-3.
              16  PD-HI-TERM               PIC S999        COMP-3.
      *  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
          12  PD-LOAN-AMT-LIMITS OCCURS 15.
              16  PD-LOW-AMT               PIC S9(5)       COMP-3.
              16  PD-HI-AMT                PIC S9(7)       COMP-3.
          12  PD-EARN-FACTORS.
              16  FILLER OCCURS 15.
                  20  FILLER OCCURS 15.
                      24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
          12  PD-PRODUCT-DESC              PIC X(80).
          12  PD-TRUNCATED                 PIC X.
          12  FILLER                       PIC X(59).
          12  PD-MAINT-INFORMATION.
              16  PD-LAST-MAINT-DT         PIC X(02).
              16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
              16  PD-LAST-MAINT-BY         PIC X(04).
      *                                COPY ELCSTATE.
      ******************************************************************
      *                                                                *
      *                                                                *
      *                            ELCSTATE.                           *
      *                                                                *
      *   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
      *                                                                *
      *   FILE TYPE = VSAM,KSDS                                        *
      *   RECORD SIZE = 250  RECFORM = FIXED                           *
      *                                                                *
      *   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
      *       ALTERNATE INDEX = NONE                                   *
      *                                                                *
      *   LOG = YES                                                    *
      *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
      ******************************************************************
122710*                   C H A N G E   L O G
122710*
122710* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
122710*-----------------------------------------------------------------
122710*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
122710* EFFECTIVE    NUMBER
122710*-----------------------------------------------------------------
122710* 122710  CR2010012700001  PEMA  NEW COPYBOOK
122710******************************************************************
      *
       01  STATE-FILE.
           12  SF-RECORD-ID                       PIC XX.
               88  VALID-CF-ID                        VALUE 'SF'.
           12  SF-CONTROL-PRIMARY.
               16  SF-COMPANY-ID                  PIC XXX.
               16  SF-CARRIER-CODE                PIC X.
               16  SF-GROUPING                    PIC X(6).
               16  SF-STATE-CODE                  PIC XX.
               16  SF-EXPIRE-DATE                 PIC 9(8).
      ****************************************************************
      *             STATE CONTROLS
      ****************************************************************
           12  SF-LAST-MAINT-DT                   PIC XX.
           12  SF-LAST-MAINT-BY                   PIC X(4).
           12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
           12  SF-STATE-RT-CONTROLS.
               16  SF-ST-RT-CALC                  PIC X.
           12  SF-ST-TAX-CONTROLS.
               16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
               16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
               16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
           12  SF-ST-REFUND-OPTIONS.
               16  SF-ST-RF-LR-CALC               PIC X.
               16  SF-ST-RF-LL-CALC               PIC X.
               16  SF-ST-RF-LN-CALC               PIC X.
               16  SF-ST-RF-AH-CALC               PIC X.
               16  SF-ST-RF-CP-CALC               PIC X.
           12  SF-ST-UNEARN-PREM-OPTIONS.
               16  SF-ST-LUEP-R78                 PIC X.
               16  SF-ST-LUEP-PRO                 PIC X.
               16  SF-ST-LUEP-ST                  PIC X.
               16  SF-ST-LUEP-DOM                 PIC X.
               16  SF-ST-AUEP-R78                 PIC X.
               16  SF-ST-AUEP-PRO                 PIC X.
               16  SF-ST-AUEP-ST                  PIC X.
               16  SF-ST-AUEP-DOM                 PIC X.
               16  SF-ST-CUEP-R78                 PIC X.
               16  SF-ST-CUEP-PRO                 PIC X.
               16  SF-ST-CUEP-ST                  PIC X.
               16  SF-ST-CUEP-DOM                 PIC X.
           12  SF-ST-EARN-PREM-OPTIONS.
               16  SF-ST-LEP-R78                  PIC X.
               16  SF-ST-LEP-PRO                  PIC X.
               16  SF-ST-LEP-ST                   PIC X.
               16  SF-ST-LEP-DOM                  PIC X.
               16  SF-ST-AEP-R78                  PIC X.
               16  SF-ST-AEP-PRO                  PIC X.
               16  SF-ST-AEP-ST                   PIC X.
               16  SF-ST-AEP-DOM                  PIC X.
               16  SF-ST-CEP-R78                  PIC X.
               16  SF-ST-CEP-PRO                  PIC X.
               16  SF-ST-CEP-ST                   PIC X.
               16  SF-ST-CEP-DOM                  PIC X.
           12  SF-FOR-FUTURE-USE                  PIC X(179).
042709     EJECT
042709*    COPY ELCCRTT.
00001 ******************************************************************
00002 *                                                                *
00003 *                            ELCCRTT.                            *
00006 *                                                                *
00007 *   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
00008 *                                                                *
00009 *   FILE TYPE = VSAM,KSDS                                        *
00010 *   RECORD SIZE = 552  RECFORM = FIXED                           *
00011 *                                                                *
00012 *   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
00017 *                                                                *
00018 *   LOG = YES                                                    *
00019 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
111204******************************************************************
111204*                   C H A N G E   L O G
111204*
111204* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
111204*-----------------------------------------------------------------
111204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
111204* EFFECTIVE    NUMBER
111204*-----------------------------------------------------------------
111204* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
040109* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
012010* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
121712* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
061013* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
111204******************************************************************
00021
00022  01  CERTIFICATE-TRAILERS.
00023      12  CS-RECORD-ID                      PIC XX.
00024          88  VALID-CS-ID                      VALUE 'CS'.
00025
00026      12  CS-CONTROL-PRIMARY.
00027          16  CS-COMPANY-CD                 PIC X.
00028          16  CS-CARRIER                    PIC X.
00029          16  CS-GROUPING                   PIC X(6).
00032          16  CS-STATE                      PIC XX.
00033          16  CS-ACCOUNT                    PIC X(10).
00036          16  CS-CERT-EFF-DT                PIC XX.
00037          16  CS-CERT-NO.
00038              20  CS-CERT-PRIME             PIC X(10).
00039              20  CS-CERT-SFX               PIC X.
               16  CS-TRAILER-TYPE               PIC X.
                   88  COMM-TRLR           VALUE 'A'.
061013             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
040109             88  CERT-DATA-TRLR      VALUE 'C'.
00040
040109     12  CS-DATA-AREA                      PIC X(516).
040109
040109     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
040109         16  CS-BANK-COMMISSION-AREA.
040109             20  CS-BANK-COMMS       OCCURS 10.
040109                 24  CS-AGT                PIC X(10).
040109                 24  CS-COM-TYP            PIC X.
040109                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
040109                 24  CS-RECALC-LV-INDIC    PIC X.
040109                 24  FILLER                PIC X(10).
040109         16  FILLER                        PIC X(256).
040109
061013     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
061013****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
061013****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
061013         16  CS-MB-CLAIM-DATA OCCURS 2.
061013             20  FILLER OCCURS 10.
061013                 24  CS-CLAIM-TYPE         PIC X.
061013                     88  CS-AH-CLM           VALUE 'A'.
061013                     88  CS-IU-CLM           VALUE 'I'.
061013                     88  CS-GP-CLM           VALUE 'G'.
061013                     88  CS-LF-CLM           VALUE 'L'.
061013                     88  CS-PR-CLM           VALUE 'P'.
061013                 24  CS-BANK               PIC S999 COMP-3.
061013                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
061013                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
061013                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
061013         16  FILLER                        PIC X(216).
040109     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
040109         16  CS-VIN-NUMBER                 PIC X(17).
012010         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
121712         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
121712         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
121712         16  FILLER                        PIC X(496).
00286 ******************************************************************
041412*    COPY ELCCRTO.
      ******************************************************************
      *                                                                *
      *                            ELCCRTO.                            *
      *                                                                *
      *   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
      *                                                                *
      *   FILE TYPE = VSAM,KSDS                                        *
      *   RECORD SIZE = 524  RECFORM = FIXED                           *
      *                                                                *
      *   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
      *                                                                *
      *   LOG = YES                                                    *
      *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
      ******************************************************************
      *                   C H A N G E   L O G
      *
      * CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
      *-----------------------------------------------------------------
      *  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
      * EFFECTIVE    NUMBER
      *-----------------------------------------------------------------
061011* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
062712* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
071712* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
121812* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
011413* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
      ******************************************************************
       01  ORIGINAL-CERTIFICATE.
           12  OC-RECORD-ID                      PIC XX.
               88  VALID-OC-ID                      VALUE 'OC'.
           12  OC-CONTROL-PRIMARY.
               16  OC-COMPANY-CD                 PIC X.
               16  OC-CARRIER                    PIC X.
               16  OC-GROUPING                   PIC X(6).
               16  OC-STATE                      PIC XX.
               16  OC-ACCOUNT                    PIC X(10).
               16  OC-CERT-EFF-DT                PIC XX.
               16  OC-CERT-NO.
                   20  OC-CERT-PRIME             PIC X(10).
                   20  OC-CERT-SFX               PIC X.
               16  OC-RECORD-TYPE                PIC X.
               16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
           12  OC-LAST-MAINT-DT                  PIC XX.
           12  OC-LAST-MAINT-BY                  PIC X(4).
           12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
           12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
           12  FILLER                            PIC X(49).
062712     12  OC-ORIG-REC.
062712         16  OC-INS-LAST-NAME              PIC X(15).
062712         16  OC-INS-FIRST-NAME             PIC X(10).
062712         16  OC-INS-MIDDLE-INIT            PIC X.
062712         16  OC-INS-AGE                    PIC S999     COMP-3.
062712         16  OC-JNT-LAST-NAME              PIC X(15).
062712         16  OC-JNT-FIRST-NAME             PIC X(10).
062712         16  OC-JNT-MIDDLE-INIT            PIC X.
062712         16  OC-JNT-AGE                    PIC S999     COMP-3.
062712         16  OC-LF-BENCD                   PIC XX.
062712         16  OC-LF-TERM                    PIC S999      COMP-3.
062712         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
062712         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
062712         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
062712         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
062712         16  OC-LF-EXP-DT                  PIC XX.
062712         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
062712         16  OC-LF-CANCEL-DT               PIC XX.
062712         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
071712         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
062712         16  OC-AH-BENCD                   PIC XX.
062712         16  OC-AH-TERM                    PIC S999      COMP-3.
062712         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
062712         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
062712         16  OC-AH-EXP-DT                  PIC XX.
062712         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
062712         16  OC-AH-CP                      PIC 99.
062712         16  OC-AH-CANCEL-DT               PIC XX.
062712         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
071712         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
062712         16  OC-CRED-BENE-NAME             PIC X(25).
062712         16  OC-1ST-PMT-DT                 PIC XX.
121812         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
121812         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
011413         16  OC-ISSUE-TRAN-IND             PIC X.
011413         16  OC-CANCEL-TRAN-IND            PIC X.
011413         16  FILLER                        PIC X(211).
062712
062712     12  FILLER                            PIC X(50).
      ******************************************************************
00264
00265 *    COPY ELCDATE.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ELCDATE.                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.003
00006 *                                                                *
00007 *                                                                *
00008 *   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
00009 *                 LENGTH = 200                                   *
00010 ******************************************************************
00011
00012  01  DATE-CONVERSION-DATA.
00013      12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
00014      12  DC-OPTION-CODE                PIC X.
00015          88  BIN-TO-GREG                VALUE ' '.
00016          88  ELAPSED-BETWEEN-BIN        VALUE '1'.
00017          88  EDIT-GREG-TO-BIN           VALUE '2'.
00018          88  YMD-GREG-TO-BIN            VALUE '3'.
00019          88  MDY-GREG-TO-BIN            VALUE '4'.
00020          88  JULIAN-TO-BIN              VALUE '5'.
00021          88  BIN-PLUS-ELAPSED           VALUE '6'.
00022          88  FIND-CENTURY               VALUE '7'.
00023          88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
00024          88  EDIT-GREG-TO-BIN-3         VALUE '9'.
00025          88  YMD-GREG-TO-BIN-3          VALUE 'A'.
00026          88  MDY-GREG-TO-BIN-3          VALUE 'B'.
00027          88  JULIAN-TO-BIN-3            VALUE 'C'.
00028          88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
00029          88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
00030          88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
00031          88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
00032          88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
00033          88  CHECK-LEAP-YEAR            VALUE 'H'.
00034          88  BIN-3-TO-GREG              VALUE 'I'.
00035          88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
00036          88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
00037          88  CYMD-GREG-TO-BIN           VALUE 'L'.
00038          88  MDCY-GREG-TO-BIN           VALUE 'M'.
00039          88  MDY-GREG-TO-JULIAN         VALUE 'N'.
00040          88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
00041          88  YMD-GREG-TO-JULIAN         VALUE 'P'.
00042          88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
00043          88  THREE-CHARACTER-BIN
00044                   VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
00045          88  GREGORIAN-TO-BIN
00046                   VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
00047          88  BIN-TO-GREGORIAN
00048                   VALUES ' ' '1' 'I' '8' 'G'.
00049          88  JULIAN-TO-BINARY
00050                   VALUES '5' 'C' 'E' 'F'.
00051      12  DC-ERROR-CODE                 PIC X.
00052          88  NO-CONVERSION-ERROR        VALUE ' '.
00053          88  DATE-CONVERSION-ERROR
00054                   VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
00055          88  DATE-IS-ZERO               VALUE '1'.
00056          88  DATE-IS-NON-NUMERIC        VALUE '2'.
00057          88  DATE-IS-INVALID            VALUE '3'.
00058          88  DATE1-GREATER-DATE2        VALUE '4'.
00059          88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
00060          88  DATE-INVALID-OPTION        VALUE '9'.
00061          88  INVALID-CENTURY            VALUE 'A'.
00062          88  ONLY-CENTURY               VALUE 'B'.
00063          88  ONLY-LEAP-YEAR             VALUE 'C'.
00064          88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
00065      12  DC-END-OF-MONTH               PIC X.
00066          88  CALCULATE-END-OF-MONTH     VALUE '1'.
00067      12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
00068          88  USE-NORMAL-PROCESS         VALUE ' '.
00069          88  ADJUST-DOWN-100-YRS        VALUE '1'.
00070          88  ADJUST-UP-100-YRS          VALUE '2'.
00071      12  FILLER                        PIC X.
00072      12  DC-CONVERSION-DATES.
00073          16  DC-BIN-DATE-1             PIC XX.
00074          16  DC-BIN-DATE-2             PIC XX.
00075          16  DC-GREG-DATE-1-EDIT       PIC X(08).
00076          16  DC-GREG-DATE-1-EDIT-R REDEFINES
00077                        DC-GREG-DATE-1-EDIT.
00078              20  DC-EDIT1-MONTH        PIC 99.
00079              20  SLASH1-1              PIC X.
00080              20  DC-EDIT1-DAY          PIC 99.
00081              20  SLASH1-2              PIC X.
00082              20  DC-EDIT1-YEAR         PIC 99.
00083          16  DC-GREG-DATE-2-EDIT       PIC X(08).
00084          16  DC-GREG-DATE-2-EDIT-R REDEFINES
00085                      DC-GREG-DATE-2-EDIT.
00086              20  DC-EDIT2-MONTH        PIC 99.
00087              20  SLASH2-1              PIC X.
00088              20  DC-EDIT2-DAY          PIC 99.
00089              20  SLASH2-2              PIC X.
00090              20  DC-EDIT2-YEAR         PIC 99.
00091          16  DC-GREG-DATE-1-YMD        PIC 9(06).
00092          16  DC-GREG-DATE-1-YMD-R  REDEFINES
00093                      DC-GREG-DATE-1-YMD.
00094              20  DC-YMD-YEAR           PIC 99.
00095              20  DC-YMD-MONTH          PIC 99.
00096              20  DC-YMD-DAY            PIC 99.
00097          16  DC-GREG-DATE-1-MDY        PIC 9(06).
00098          16  DC-GREG-DATE-1-MDY-R REDEFINES
00099                       DC-GREG-DATE-1-MDY.
00100              20  DC-MDY-MONTH          PIC 99.
00101              20  DC-MDY-DAY            PIC 99.
00102              20  DC-MDY-YEAR           PIC 99.
00103          16  DC-GREG-DATE-1-ALPHA.
00104              20  DC-ALPHA-MONTH        PIC X(10).
00105              20  DC-ALPHA-DAY          PIC 99.
00106              20  FILLER                PIC XX.
00107              20  DC-ALPHA-CENTURY.
00108                  24 DC-ALPHA-CEN-N     PIC 99.
00109              20  DC-ALPHA-YEAR         PIC 99.
00110          16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
00111          16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
00112          16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
00113          16  DC-JULIAN-DATE            PIC 9(05).
00114          16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
00115                                        PIC 9(05).
00116          16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
00117              20  DC-JULIAN-YEAR        PIC 99.
00118              20  DC-JULIAN-DAYS        PIC 999.
00119          16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
00120          16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
00121          16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
00122      12  DATE-CONVERSION-VARIBLES.
00123          16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
00124          16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
00125              20  FILLER                PIC 9(3).
00126              20  HOLD-CEN-1-CCYY.
00127                  24  HOLD-CEN-1-CC     PIC 99.
00128                  24  HOLD-CEN-1-YY     PIC 99.
00129              20  HOLD-CEN-1-MO         PIC 99.
00130              20  HOLD-CEN-1-DA         PIC 99.
00131          16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
00132              20  HOLD-CEN-1-R-MO       PIC 99.
00133              20  HOLD-CEN-1-R-DA       PIC 99.
00134              20  HOLD-CEN-1-R-CCYY.
00135                  24  HOLD-CEN-1-R-CC   PIC 99.
00136                  24  HOLD-CEN-1-R-YY   PIC 99.
00137              20  FILLER                PIC 9(3).
00138          16  HOLD-CENTURY-1-X.
00139              20  FILLER                PIC X(3)  VALUE SPACES.
00140              20  HOLD-CEN-1-X-CCYY.
00141                  24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
00142                  24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
00143              20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
00144              20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
00145          16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
00146              20  HOLD-CEN-1-R-X-MO     PIC XX.
00147              20  HOLD-CEN-1-R-X-DA     PIC XX.
00148              20  HOLD-CEN-1-R-X-CCYY.
00149                  24  HOLD-CEN-1-R-X-CC PIC XX.
00150                  24  HOLD-CEN-1-R-X-YY PIC XX.
00151              20  FILLER                PIC XXX.
00152          16  DC-BIN-DATE-EXPAND-1      PIC XXX.
00153          16  DC-BIN-DATE-EXPAND-2      PIC XXX.
00154          16  DC-JULIAN-DATE-1          PIC 9(07).
00155          16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
00156              20  DC-JULIAN-1-CCYY.
00157                  24  DC-JULIAN-1-CC    PIC 99.
00158                  24  DC-JULIAN-1-YR    PIC 99.
00159              20  DC-JULIAN-DA-1        PIC 999.
00160          16  DC-JULIAN-DATE-2          PIC 9(07).
00161          16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
00162              20  DC-JULIAN-2-CCYY.
00163                  24  DC-JULIAN-2-CC    PIC 99.
00164                  24  DC-JULIAN-2-YR    PIC 99.
00165              20  DC-JULIAN-DA-2        PIC 999.
00166          16  DC-GREG-DATE-A-EDIT.
00167              20  DC-EDITA-MONTH        PIC 99.
00168              20  SLASHA-1              PIC X VALUE '/'.
00169              20  DC-EDITA-DAY          PIC 99.
00170              20  SLASHA-2              PIC X VALUE '/'.
00171              20  DC-EDITA-CCYY.
00172                  24  DC-EDITA-CENT     PIC 99.
00173                  24  DC-EDITA-YEAR     PIC 99.
00174          16  DC-GREG-DATE-B-EDIT.
00175              20  DC-EDITB-MONTH        PIC 99.
00176              20  SLASHB-1              PIC X VALUE '/'.
00177              20  DC-EDITB-DAY          PIC 99.
00178              20  SLASHB-2              PIC X VALUE '/'.
00179              20  DC-EDITB-CCYY.
00180                  24  DC-EDITB-CENT     PIC 99.
00181                  24  DC-EDITB-YEAR     PIC 99.
00182          16  DC-GREG-DATE-CYMD         PIC 9(08).
00183          16  DC-GREG-DATE-CYMD-R REDEFINES
00184                               DC-GREG-DATE-CYMD.
00185              20  DC-CYMD-CEN           PIC 99.
00186              20  DC-CYMD-YEAR          PIC 99.
00187              20  DC-CYMD-MONTH         PIC 99.
00188              20  DC-CYMD-DAY           PIC 99.
00189          16  DC-GREG-DATE-MDCY         PIC 9(08).
00190          16  DC-GREG-DATE-MDCY-R REDEFINES
00191                               DC-GREG-DATE-MDCY.
00192              20  DC-MDCY-MONTH         PIC 99.
00193              20  DC-MDCY-DAY           PIC 99.
00194              20  DC-MDCY-CEN           PIC 99.
00195              20  DC-MDCY-YEAR          PIC 99.
CIDMOD    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
CIDMOD        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
CIDMOD    12  DC-EL310-DATE                  PIC X(21).
CIDMOD    12  FILLER                         PIC X(28).
00266
00267      EJECT
00268 *    COPY ELCCALC.
00001 ******************************************************************
00002 *                                                                *
00003 *                           ELCCALC.                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.025                          *
00006 *                                                                *
00007 *   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
00008 *                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
00009 *                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
00010 *                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
00011 *                                                                *
00012 *  PASSED TO ELRTRM                                              *
00013 *  -----------------                                             *
00014 *  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
00015 *  ORIGINAL TERM                                                 *
00016 *  BEGINNING DATE                                                *
00017 *  ENDING DATE                                                   *
00018 *  COMPANY I.D.                                                  *
00019 *  ACCOUNT MASTER USER FIELD                                     *
00020 *  PROCESS SWITCH (CANCEL, CLAIM)                                *
00021 *  FREE LOOK DAYS                                                *
00022 *                                                                *
00023 *  RETURNED FROM ELRTRM                                          *
00024 *  ---------------------                                         *
00025 *  REMAINING TERM 1 - USED FOR EARNINGS                          *
00026 *  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
00027 *  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
00028 *  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
00029 *----------------------------------------------------------------*
00030 *  PASSED TO ELRAMT                                              *
00031 *  ----------------                                              *
00032 *  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
00033 *  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
00034 *  ORIGINAL AMOUNT                                               *
00035 *  ALTERNATE BENEFIT (BALLON)                                    *
00036 *  A.P.R. - NET PAY ONLY                                         *
00037 *  METHOD
00038 *  PAYMENT FREQUENCY - FOR FARM PLAN                             *
00039 *  COMPANY I.D.                                                  *
00040 *  BENEFIT TYPE                                                  *
00041 *                                                                *
00042 *  RETURNED FROM ELRAMT                                          *
00043 *  --------------------                                          *
00044 *  REMAINING AMOUNT 1 - CURRENT                                  *
00045 *  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
00046 *  REMAINING AMOUNT FACTOR
00047 *----------------------------------------------------------------*
00048 *  PASSED TO ELRESV                                              *
00049 *  -----------------                                             *
00050 *  CERTIFICATE EFFECTIVE DATE                                    *
00051 *  VALUATION DATE                                                *
00052 *  PAID THRU DATE                                                *
00053 *  BENEFIT                                                       *
00054 *  INCURRED DATE                                                 *
00055 *  REPORTED DATE                                                 *
00056 *  ISSUE AGE                                                     *
00057 *  TERM                                                          *
00058 *  CDT PERCENT                                                   *
00059 *  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
00060 * *CLAIM TYPE (LIFE, A/H)                                        *
00061 * *REMAINING BENEFIT (FROM ELRAMT)                               *
00062 * *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
00063 *                                                                *
00064 *  RETURNED FROM ELRESV                                          *
00065 *  --------------------                                          *
00066 *  CDT TABLE USED                                                *
00067 *  CDT FACTOR USED                                               *
00068 *  PAY TO CURRENT RESERVE                                        *
00069 *  I.B.N.R. - A/H ONLY                                           *
00070 *  FUTURE (ACCRUED) AH ONLY                                      *
00071 *----------------------------------------------------------------*
00072 *  PASSED TO ELRATE                                              *
00073 *  ----------------                                              *
00074 *  CERT ISSUE DATE                                               *
00075 *  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
00076 *  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
00077 *  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
00078 *  STATE CODE (CLIENT DEFINED)                                   *
00079 *  STATE CODE (STANDARD P.O. ABBRV)                              *
00080 *  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
00081 *  DEVIATION CODE                                                *
00082 *  ISSUE AGE                                                     *
00083 *  ORIGINAL BENEFIT AMOUNT                                       *
00084 *  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
00085 *  PROCESS TYPE (ISSUE OR CANCEL)                                *
00086 *  BENEFIT KIND (LIFE OR A/H)                                    *
00087 *  A.P.R.                                                        *
00088 *  METHOD
00089 *  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
00090 *  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
00091 *  COMPANY I.D. (3 CHARACTER)                                    *
00092 *  BENEFIT CODE                                                  *
00093 *  BENEFIT OVERRIDE CODE                                         *
00094 *  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
00095 *  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
00096 *  JOINT INDICATOR (CSL ONLY)                                    *
00097 *  FIRST PAYMENT DATE (CSL ONLY)                                 *
00098 *  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
00099 *                                                                *
00100 *  RETURNED FROM ELRATE                                          *
00101 *  --------------------                                          *
00102 *  CALCULATED PREMIUM                                            *
00103 *  PREMIUM RATE                                                  *
00104 *  MORTALITY CODE                                                *
00105 *  MAX ATTAINED AGE                                              *
00106 *  MAX AGE                                                       *
00107 *  MAX TERM                                                      *
00108 *  MAX MONTHLY BENEFIT                                           *
00109 *  MAX TOTAL BENIFIT                                             *
00110 *  COMPOSITE RATE (OPEN-END ONLY)                                *
00111 *----------------------------------------------------------------*
00112 *  PASSED TO ELRFND                                              *
00113 *  ----------------                                              *
00114 *  CERT ISSUE DATE                                               *
00115 *  REFUND DATE                                                   *
00116 *  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
00117 *  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
00118 *  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
00119 *  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
00120 *  STATE CODE (CLIENT DEFINED)                                   *
00121 *  STATE CODE (STANDARD P.O. ABBRV)                              *
00122 *  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
00123 *  DEVIATION CODE                                                *
00124 *  ISSUE AGE                                                     *
00125 *  ORIGINAL BENEFIT AMOUNT                                       *
00126 *  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
00127 *  PROCESS TYPE (CANCEL)                                         *
00128 *  BENEFIT KIND (LIFE OR A/H)                                    *
00129 *  A.P.R.                                                        *
00130 *  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
00131 *  RATING METHOD -  (CODE FROM BENEFIT)                          *
00132 *  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
00133 *  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
00134 *  COMPANY I.D. (3 CHARACTER)                                    *
00135 *  BENEFIT CODE                                                  *
00136 *  BENEFIT OVERRIDE CODE                                         *
00137 *                                                                *
00138 *  RETURNED FROM ELRFND                                          *
00139 *  --------------------                                          *
00140 *  CALCULATED REFUND                                             *
00141 *----------------------------------------------------------------*
00142 *  PASSED TO ELEARN                                              *
00143 *  ----------------                                              *
00144 *  CERT ISSUE DATE                                               *
00145 *  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
00146 *  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
00147 *  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
00148 *  STATE CODE (CLIENT DEFINED)                                   *
00149 *  STATE CODE (STANDARD P.O. ABBRV)                              *
00150 *  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
00151 *  DEVIATION CODE                                                *
00152 *  ISSUE AGE                                                     *
00153 *  ORIGINAL BENEFIT AMOUNT                                       *
00154 *  BENEFIT KIND (LIFE OR A/H)                                    *
00155 *  A.P.R.                                                        *
00156 *  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
00157 *  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
00158 *  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
00159 *  COMPANY I.D. (3 CHARACTER)                                    *
00160 *  BENEFIT CODE                                                  *
00161 *  BENEFIT OVERRIDE CODE                                         *
00162 *                                                                *
00163 *  RETURNED FROM ELEARN                                          *
00164 *  --------------------                                          *
00165 *  INDICATED  EARNINGS                                           *
00166 *----------------------------------------------------------------*
00167 *                 LENGTH = 450                                   *
00168 *                                                                *
00169 ******************************************************************
010303******************************************************************
010303*                   C H A N G E   L O G
010303*
010303* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
010303*-----------------------------------------------------------------
010303*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
010303* EFFECTIVE    NUMBER
010303*-----------------------------------------------------------------
010303* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
033104* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
101807* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
010410* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
010410* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
041310* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
041710* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
101110* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
071211* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
010303******************************************************************
00170
00171  01  CALCULATION-PASS-AREA.
00172      12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
00173                                      COMP.
00174
00175      12  CP-RETURN-CODE            PIC X             VALUE ZERO.
00176        88  NO-CP-ERROR                             VALUE ZERO.
00177        88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
00178                                   '9' 'A' 'B' 'C' 'D' 'E' 'H'.
00179        88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
00180        88  CP-ERROR-IN-DATES                       VALUE '2'.
00181        88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
00182        88  CP-ERROR-IN-TERMS                       VALUE '4'.
00183        88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
00184        88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
00185        88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
00186        88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
00187        88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
00188        88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
00189        88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
00190        88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
00191        88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
00192        88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
00193        88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
00194        88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
00195        88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
00196
00197      12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
00198        88  NO-CP-ERROR-2                           VALUE ZERO.
00199 ***********************  INPUT AREAS ****************************
00200
00201      12  CP-CALCULATION-AREA.
00202          16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
00203          16  CP-CERT-EFF-DT        PIC XX.
00204          16  CP-VALUATION-DT       PIC XX.
00205          16  CP-PAID-THRU-DT       PIC XX.
00206          16  CP-BENEFIT-TYPE       PIC X.
00207            88  CP-AH                               VALUE 'A' 'D'
00208                                                    'I' 'U'.
00209            88  CP-REDUCING-LIFE                    VALUE 'R'.
00210            88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
00211          16  CP-INCURRED-DT        PIC XX.
00212          16  CP-REPORTED-DT        PIC XX.
00213          16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
00214          16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
00215          16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
00216                                      COMP-3.
00217          16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
00218                                      COMP-3.
00219          16  CP-CDT-METHOD         PIC X.
00220            88  CP-CDT-ROUND-NEAR                   VALUE '1'.
00221            88  CP-CDT-ROUND-HIGH                   VALUE '2'.
00222            88  CP-CDT-INTERPOLATED                 VALUE '3'.
00223          16  CP-CLAIM-TYPE         PIC X.
00224            88  CP-AH-CLAIM                         VALUE 'A'.
00225            88  CP-LIFE-CLAIM                       VALUE 'L'.
00226          16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
00227                                      COMP-3.
00228          16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
00229                                      COMP-3.
00230          16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
00231                                      COMP-3.
00232          16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
00233                                      COMP-3.
00234          16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
00235                                      COMP-3.
00236          16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
00237                                      COMP-3.
00238          16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
00239                                      COMP-3.
00240          16  CP-REM-TERM-METHOD    PIC X.
00241            88  CP-EARN-AFTER-15TH                  VALUE '1'.
00242            88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
00243            88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
00244            88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
00245            88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
00246            88  CP-EARN-AFTER-14TH                  VALUE '6'.
00247            88  CP-EARN-AFTER-16TH                  VALUE '7'.
00248          16  CP-EARNING-METHOD     PIC X.
00249            88  CP-EARN-BY-R78                      VALUE '1' 'R'.
00250            88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
00251            88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
00252            88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
00253            88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
00254            88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
00255            88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
00256            88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
00257            88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
00258            88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
033104           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
033104           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
092310           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
                 88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
00259          16  CP-PROCESS-TYPE       PIC X.
00260            88  CP-CLAIM                            VALUE '1'.
00261            88  CP-CANCEL                           VALUE '2'.
00262            88  CP-ISSUE                            VALUE '3'.
00263          16  CP-SPECIAL-CALC-CD    PIC X.
00264            88  CP-OUTSTANDING-BAL              VALUE 'O'.
00265            88  CP-1-MTH-INTEREST               VALUE ' '.
00266            88  CP-0-MTH-INTEREST               VALUE 'A'.
00267            88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
00268            88  CP-CRITICAL-PERIOD              VALUE 'C'.
00269            88  CP-TERM-IS-DAYS                 VALUE 'D'.
00270            88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
00271            88  CP-FARM-PLAN                    VALUE 'F'.
00272            88  CP-RATE-AS-STANDARD             VALUE 'G'.
00273            88  CP-2-MTH-INTEREST               VALUE 'I'.
00274            88  CP-3-MTH-INTEREST               VALUE 'J'.
00275            88  CP-4-MTH-INTEREST               VALUE 'K'.
00276            88  CP-BALLOON-LAST-PMT             VALUE 'L'.
00277            88  CP-MORTGAGE-REC                 VALUE 'M'.
00278            88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
00279            88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
00280            88  CP-NET-PAY-SIMPLE               VALUE 'S'.
00281            88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
00282                                                      'W' 'X'.
00283            88  CP-TRUNCATE-0-MTH               VALUE 'T'.
00284            88  CP-TRUNCATE-1-MTH               VALUE 'U'.
00285            88  CP-TRUNCATE-2-MTH               VALUE 'V'.
00286            88  CP-TRUNCATE-3-MTH               VALUE 'W'.
00287            88  CP-TRUNCATE-4-MTH               VALUE 'X'.
00288            88  CP-SUMMARY-REC                  VALUE 'Z'.
00289            88  CP-PROPERTY-BENEFIT             VALUE '2'.
00290            88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
00291            88  CP-AD-D-BENEFIT                 VALUE '4'.
00292            88  CP-CSL-METH-1                   VALUE '5'.
00293            88  CP-CSL-METH-2                   VALUE '6'.
00294            88  CP-CSL-METH-3                   VALUE '7'.
00295            88  CP-CSL-METH-4                   VALUE '8'.
00296
00297          16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
00298                                      COMP-3.
00299          16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
00300          16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
00301          16  CP-STATE              PIC XX          VALUE SPACE.
00302          16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
00303          16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
00304            88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
00305                '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
00306          16  CP-R78-OPTION         PIC X.
00307            88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
00308            88  CP-TERM-TIMES-TERM                  VALUE '1'.
00309
00310          16  CP-COMPANY-CD         PIC X             VALUE SPACE.
00311          16  CP-IBNR-RESERVE-SW    PIC X.
00312          16  CP-CLAIM-STATUS       PIC X.
00313          16  CP-RATE-FILE          PIC X.
00314          16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
00315                                      COMP-3.
00316
00317          16  CP-LIFE-OVERRIDE-CODE PIC X.
00318          16  CP-AH-OVERRIDE-CODE   PIC X.
00319
00320          16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
00321                                      COMP-3.
               16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
                                         PIC S9(5)V99 COMP-3.
00322          16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
00323                                      COMP-3.
00324          16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
00325                                      COMP-3.
00326          16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
00327                                      COMP-3.
               16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
                                        PIC S9(7)V99 COMP-3.
00328
00329          16  CP-PAID-FROM-DATE     PIC X(02).
00330          16  CP-CLAIM-CALC-METHOD  PIC X(01).
00331          16  CP-EXT-DAYS-CALC      PIC X.
00332            88  CP-EXT-NO-CHG                   VALUE ' '.
00333            88  CP-EXT-CHG-LF                   VALUE '1'.
00334            88  CP-EXT-CHG-AH                   VALUE '2'.
00335            88  CP-EXT-CHG-LF-AH                VALUE '3'.
00336          16  CP-DOMICILE-STATE     PIC XX.
00337          16  CP-CARRIER            PIC X.
00338          16  CP-REIN-FLAG          PIC X.
00339          16  CP-REM-TRM-CALC-OPTION PIC X.
00340            88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
00341                       '2' '3' '4' '5'.
00342            88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
00343            88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
00344            88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
00345            88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
00346            88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
00347            88  CP-EXT-30-DAY-MONTH          VALUE '3'.
00348            88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
                 88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
00349          16  CP-SIG-SWITCH         PIC X.
00350          16  CP-RATING-METHOD      PIC X.
00351            88  CP-RATE-AS-R78                      VALUE '1' 'R'.
00352            88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
00353            88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
00354            88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
00355            88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
00356            88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
00357            88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
00358            88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
00359            88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
00360          16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
00361                                      COMP-3.
090803         16  CP-BEN-CATEGORY       PIC X.
011904         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
               16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
                                         PIC S99V9(5) COMP-3.
011904         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
               16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
                                         PIC S99V9(5) COMP-3.
080305         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
               16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
041310         16  CP-EXPIRE-DT          PIC XX.
041710         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
               16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
               16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
               16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
               16  CP-DDF-SPEC-CALC      PIC X.
                   88  CP-CALC-GROSS-FEE        VALUE 'G'.
                   88  CP-CALC-CLP              VALUE 'C'.
               16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
               16  CP-CANCEL-REASON      PIC X.
               16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
               16  CP-PMT-MODE           PIC X.
               16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
071211         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
               16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
               16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
071211         16  FILLER                PIC X.
00363
00364 ***************    OUTPUT FROM ELRESV   ************************
00365
00366          16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
00367
00368          16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
00369                                      COMP-3.
101807         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
101807                                     COMP-3.
101807         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
101807                                     COMP-3.
101807         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
101807                                     COMP-3.
101807         16  FILLER                PIC X(09).
00377 ***************    OUTPUT FROM ELRTRM   *************************
00378
00379          16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
00380                                      COMP-3.
00381          16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
00382                                      COMP-3.
00383          16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
00384                                      COMP-3.
00385          16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
00386                                      COMP-3.
00387          16  FILLER                PIC X(12).
00388
00389 ***************    OUTPUT FROM ELRAMT   *************************
00390
00391          16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
00392                                      COMP-3.
00393          16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
00394                                      COMP-3.
00395          16  FILLER                PIC X(12).
00396
00397 ***************    OUTPUT FROM ELRATE   *************************
00398
00399          16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
00400                                      COMP-3.
00401          16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
00402                                      COMP-3.
00403          16  CP-MORTALITY-CODE     PIC X(4).
00404          16  CP-RATE-EDIT-FLAG     PIC X.
00405              88  CP-RATES-NEED-APR                  VALUE '1'.
00406          16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
00407                                      COMP-3.
00408          16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
032905         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
               16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
                                         PIC S9(7)V99 COMP-3.
00409          16  FILLER                PIC X(07).
00410
00411 ***************    OUTPUT FROM ELRFND   *************************
00412
00413          16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
00414                                      COMP-3.
00415          16  CP-REFUND-TYPE-USED   PIC X.
00416            88  CP-R-AS-R78                         VALUE '1'.
00417            88  CP-R-AS-PRORATA                     VALUE '2'.
00418            88  CP-R-AS-CALIF                       VALUE '3'.
00419            88  CP-R-AS-TEXAS                       VALUE '4'.
00420            88  CP-R-AS-FARM-PLAN                   VALUE '4'.
00421            88  CP-R-AS-NET-PAY                     VALUE '5'.
00422            88  CP-R-AS-ANTICIPATION                VALUE '6'.
00423            88  CP-R-AS-MEAN                        VALUE '8'.
00424            88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
033104           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
033104           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
092310           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
092310           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
                 88  CP-R-AS-REPOSSESSION                VALUE 'R'.
00425          16  FILLER                PIC X(12).
00426
00427 ***************    OUTPUT FROM ELEARN   *************************
00428
00429          16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
00430                                      COMP-3.
00431          16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
00432                                      COMP-3.
00433          16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
00434                                      COMP-3.
00435          16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
00436                                      COMP-3.
00437          16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
00438                                      COMP-3.
00439          16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
00440                                      COMP-3.
00441          16  CP-EARNING-TYPE-USED  PIC X.
00442            88  CP-E-AS-SPECIAL                     VALUE 'S'.
00443            88  CP-E-AS-R78                         VALUE '1'.
00444            88  CP-E-AS-PRORATA                     VALUE '2'.
00445            88  CP-E-AS-TEXAS                       VALUE '4'.
00446            88  CP-E-AS-FARM-PLAN                   VALUE '4'.
00447            88  CP-E-AS-NET-PAY                     VALUE '5'.
00448            88  CP-E-AS-ANTICIPATION                VALUE '6'.
00449            88  CP-E-AS-MEAN                        VALUE '8'.
00450            88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
00451          16  FILLER                PIC X(12).
00452
00453 ***************    OUTPUT FROM ELPMNT   *************************
00454
00455          16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
00456                                      COMP-3.
00457          16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
00458                                      COMP-3.
00459          16  FILLER                PIC X(12).
00460
00461 ***************   MISC WORK AREAS    *****************************
00462          16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
00463                                      COMP-3.
00464          16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
00465                                      COMP-3.
00466          16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
00467                                      COMP-3.
00468          16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
00469                                      COMP-3.
00470          16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
00471                                      COMP-3.
00472          16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
00473                                      COMP-3.
00474          16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
00475              88  OPEN-RATE-FILE                   VALUE 'O'.
00476              88  CLOSE-RATE-FILE                  VALUE 'C'.
00477              88  IO-ERROR                         VALUE 'E'.
00478
00479          16  CP-FIRST-PAY-DATE     PIC XX.
00480
00481          16  CP-JOINT-INDICATOR    PIC X.
00482
00483          16  CP-RESERVE-REMAINING-TERM
00484                                    PIC S9(4)V9    VALUE ZERO
00485                                      COMP-3.
00486
00487          16  CP-INSURED-BIRTH-DT   PIC XX.
00488
00489          16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
00490                                      COMP-3.
00491
00492          16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
00493                                      COMP-3.
00494
00495          16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
00496                                      COMP-3.
00497
00498          16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
00499                                      COMP-3.
00500
00501          16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
00502                                      COMP-3.
00503
00504          16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
00505                                      COMP-3.
00506
00507          16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
00508                                      COMP-3.
00509
00510          16  CP-ROA-REFUND         PIC X          VALUE 'N'.
00511              88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
00512
010303         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
010303                                     COMP-3.
041710         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
041710                                     COMP-3.
               16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
041710         16  FILLER                PIC X(15).
00514 ******************************************************************
00269      EJECT
00270 ******************************************************************
00271 *** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
00272 *** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
00273 *** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
00274 *** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
00275 *** MODIFICATION.                                              ***
00276 *** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
00277 *** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
00278 ******************************************************************
00279 *    COPY ERCPNDB.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCPNDB.                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.025                          *
00006 *                                                                *
00007 *   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
00008 *                                                                *
00009 ******************************************************************
00010 *   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
00011 *         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
00012 ******************************************************************
00013 *                                                                *
00014 *                                                                *
00015 *   FILE TYPE = VSAM,KSDS                                        *
00016 *   RECORD SIZE = 585  RECFORM = FIXED                           *
00017 *                                                                *
00018 *   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
00019 *       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
00020 *                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
00021 *                                                 RKP=13,LEN=36  *
00022 *       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
00023 *                                      AND CHG-SEQ.)             *
00024 *                                                RKP=49,LEN=11   *
00025 *       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
00026 *                                      AND CHG-SEQ.)             *
00027 *                                                RKP=60,LEN=15   *
00028 *                                                                *
00029 *   LOG = NO                                                     *
00030 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00031 ******************************************************************
122002******************************************************************
122002*                   C H A N G E   L O G
122002*
122002* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
122002*-----------------------------------------------------------------
122002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
122002* EFFECTIVE    NUMBER
122002*-----------------------------------------------------------------
122002* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
100703* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
011904* 011904                   PEMA  ADD TOTAL FEE PROCESSING
040504* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
020305* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
110105* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
032306* 032306                   PEMA  ADD BOW LOAN NUMBER
081606* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
073107* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
072308* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
090408* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
032109* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
072209* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
011410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
071211* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
122002******************************************************************
00032
00033  01  PENDING-BUSINESS.
00034      12  PB-RECORD-ID                     PIC XX.
00035          88  VALID-PB-ID                        VALUE 'PB'.
00036
00037      12  PB-CONTROL-PRIMARY.
00038          16  PB-COMPANY-CD                PIC X.
00039          16  PB-ENTRY-BATCH               PIC X(6).
00040          16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
00041          16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
00042
00043      12  PB-CONTROL-BY-ACCOUNT.
00044          16  PB-COMPANY-CD-A1             PIC X.
00045          16  PB-CARRIER                   PIC X.
00046          16  PB-GROUPING.
00047              20  PB-GROUPING-PREFIX       PIC XXX.
00048              20  PB-GROUPING-PRIME        PIC XXX.
00049          16  PB-STATE                     PIC XX.
00050          16  PB-ACCOUNT.
00051              20  PB-ACCOUNT-PREFIX        PIC X(4).
00052              20  PB-ACCOUNT-PRIME         PIC X(6).
00053          16  PB-CERT-EFF-DT               PIC XX.
00054          16  PB-CERT-NO.
00055              20  PB-CERT-PRIME            PIC X(10).
00056              20  PB-CERT-SFX              PIC X.
00057          16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
00058
00059          16  PB-RECORD-TYPE               PIC X.
00060              88  PB-MAILING-DATA                VALUE '0'.
00061              88  PB-ISSUE                       VALUE '1'.
00062              88  PB-CANCELLATION                VALUE '2'.
00063              88  PB-BATCH-TRAILER               VALUE '9'.
00064
00065      12  PB-CONTROL-BY-ORIG-BATCH.
00066          16  PB-ORIGINAL-COMPANY-CD       PIC X.
00067          16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
00068          16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
00069          16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
00070
00071      12  PB-CONTROL-BY-CSR.
00072          16  PB-CSR-COMPANY-CD            PIC X.
00073          16  PB-CSR-ID                    PIC X(4).
00074          16  PB-CSR-ENTRY-BATCH           PIC X(6).
00075          16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
00076          16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
00077 ******************************************************************
00078 *    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
00079 ******************************************************************
00080
00081      12  PB-LAST-MAINT-DT                 PIC XX.
00082      12  PB-LAST-MAINT-BY                 PIC X(4).
00083      12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
00084
00085      12  PB-RECORD-BODY                   PIC X(375).
00086
00087      12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
00088          16  PB-CERT-ORIGIN               PIC X.
00089              88  CLASIC-CREATED-CERT         VALUE '1'.
00090          16  PB-I-NAME.
00091              20  PB-I-INSURED-LAST-NAME   PIC X(15).
00092              20  PB-I-INSURED-FIRST-NAME.
00093                  24  PB-I-INSURED-1ST-INIT PIC X.
00094                  24  FILLER                PIC X(9).
00095              20  PB-I-INSURED-MIDDLE-INIT PIC X.
00096          16  PB-I-AGE                     PIC S99   COMP-3.
00097          16  PB-I-JOINT-AGE               PIC S99   COMP-3.
00098          16  PB-I-BIRTHDAY                PIC XX.
00099          16  PB-I-INSURED-SEX             PIC X.
00100              88  PB-SEX-MALE     VALUE 'M'.
00101              88  PB-SEX-FEMALE   VALUE 'F'.
00102
00103          16  PB-I-LF-TERM                 PIC S999   COMP-3.
00104          16  PB-I-AH-TERM                 PIC S999   COMP-3.
00105          16  PB-I-LOAN-TERM               PIC S999   COMP-3.
00106          16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
00107          16  PB-I-SKIP-CODE               PIC X.
00108              88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
00109              88  PB-SKIP-JULY              VALUE '1'.
00110              88  PB-SKIP-AUGUST            VALUE '2'.
00111              88  PB-SKIP-SEPTEMBER         VALUE '3'.
00112              88  PB-SKIP-JULY-AUG          VALUE '4'.
00113              88  PB-SKIP-AUG-SEPT          VALUE '5'.
00114              88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
00115              88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
00116              88  PB-SKIP-JUNE              VALUE '8'.
00117              88  PB-SKIP-JUNE-JULY         VALUE '9'.
00118              88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
00119              88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
00120          16  PB-I-TERM-TYPE               PIC X.
00121              88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
00122              88  PB-PAID-WEEKLY            VALUE 'W'.
00123              88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
00124              88  PB-PAID-BI-WEEKLY         VALUE 'B'.
00125              88  PB-PAID-13-YEARLY         VALUE 'T'.
00126          16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
00127          16  PB-I-POLICY-FORM-NO          PIC X(12).
00128          16  PB-I-DATA-ENTRY-SW           PIC X.
00129              88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
00130              88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
00131              88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
00132              88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
00133          16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
073107         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
011410*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
011410         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
011410         16  FILLER                       PIC X.
00136
00137          16  PB-I-LIFE-BENEFIT-CD         PIC XX.
00138              88  PB-VALID-LIFE               VALUE '01' THRU '89'.
00139              88  PB-INVALID-LIFE             VALUE '  ' '00'
00140                                                    '90' THRU '99'.
00141          16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
00142                                           PIC XX.
00143          16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
100703         16  PB-I-AMOUNT-FINANCED REDEFINES
100703                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
00144          16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
100703         16  PB-I-UNPAID-CASH-PRICE REDEFINES
100703                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
00145          16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
00146          16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
100703         16  PB-I-CLP-AMOUNT REDEFINES
100703                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
00147          16  PB-I-LF-CALC-FLAG            PIC X.
00148              88 PB-COMP-LF-PREM               VALUE '?'.
00149          16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
00150          16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
00151          16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
00152          16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
00153          16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
00154          16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
00155          16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
00156          16  PB-I-LF-ABBR                 PIC XXX.
00157          16  PB-I-LF-INPUT-CD             PIC XX.
00158
00159          16  PB-I-AH-BENEFIT-CD           PIC XX.
00160              88  PB-VALID-AH                 VALUE '01' THRU '89'.
00161              88  PB-INVALID-AH               VALUE '  ' '00'
00162                                                    '90' THRU '99'.
00163          16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
00164          16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
00165          16  PB-I-AH-CALC-FLAG            PIC X.
00166              88 PB-COMP-AH-PREM                  VALUE '?'.
00167          16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
00168          16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
00169          16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
00170          16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
00171          16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
00172          16  PB-I-AH-ABBR                 PIC XXX.
00173          16  PB-I-AH-INPUT-CD             PIC XXX.
00174
00175          16  PB-I-SPECIAL-REIN-CODE       PIC X.
00176          16  PB-I-REIN-TABLE              PIC XXX.
00177          16  PB-I-BUSINESS-TYPE           PIC 99.
00178          16  PB-I-INDV-GRP-CD             PIC X.
00179          16  PB-I-MORT-CODE.
00180              20  PB-I-TABLE               PIC X.
00181              20  PB-I-INTEREST            PIC XX.
00182              20  PB-I-MORT-TYP            PIC X.
00183          16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
00184          16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
011410         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
00186          16  PB-I-INDV-GRP-OVRD           PIC X.
00187          16  PB-I-RATE-CLASS-OVRD         PIC XX.
00188          16  PB-I-SIG-SW                  PIC X.
00189              88  PB-POLICY-SIGNED             VALUE 'Y'.
00190          16  PB-I-RATE-CLASS              PIC XX.
00191          16  PB-I-RATE-DEVIATION-LF       PIC XXX.
00192          16  PB-I-RATE-DEVIATION-AH       PIC XXX.
00193          16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
00194          16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
00195          16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
00196          16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
00197          16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
00198          16  PB-I-BENEFIT-TYPE            PIC XXX.
00199          16  PB-I-OB-FLAG                 PIC X.
00200              88  PB-I-OB                      VALUE 'B'.
00201              88  PB-I-SUMMARY                 VALUE 'Z'.
00202          16  PB-I-ENTRY-STATUS            PIC X.
00203              88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
122002                                              'M' '5' '9' '2'.
00205              88  PB-I-NORMAL-ENTRY            VALUE '1'.
00206              88  PB-I-POLICY-PENDING          VALUE '2'.
00207              88  PB-I-CONVERSION-ENTRY        VALUE '4'.
00208              88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
122002             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
00209              88  PB-I-REIN-ONLY               VALUE '9'.
00210              88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
00211              88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
00212              88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
00213              88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
00214          16  PB-I-INT-CODE                PIC X.
00215              88  PB-ADD-ON-INTEREST           VALUE 'A'.
00216              88  PB-SIMPLE-INTEREST           VALUE 'S'.
00217          16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
00218          16  PB-I-SOC-SEC-NO              PIC X(11).
00219          16  PB-I-MEMBER-NO               PIC X(12).
00220          16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
110105*        16  PB-I-LOAN-OFFICER            PIC XXX.
110105         16  PB-I-OLD-LOF                 PIC XXX.
00222          16  PB-I-LF-EXPIRE-DT            PIC XX.
00223          16  PB-I-AH-EXPIRE-DT            PIC XX.
00224          16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
00225          16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
00226          16  PB-I-LIFE-INDICATOR          PIC X.
00227              88  PB-I-JOINT-COVERAGE         VALUE 'J'.
00228          16  PB-I-LIVES                   PIC S9(7)       COMP-3.
071211         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
071211                                          PIC S9(5)V99    COMP-3.
00229          16  PB-I-MAIL-ADDRS-SW           PIC X.
00230              88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
00231              88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
00232          16  PB-I-1ST-PMT-DT              PIC XX.
00233          16  PB-I-JOINT-INSURED.
00234              20 PB-I-JOINT-LAST-NAME      PIC X(15).
00235              20 PB-I-JOINT-FIRST-NAME.
00236                 24  PB-I-JOINT-FIRST-INIT PIC X.
00237                 24  FILLER                PIC X(9).
00238              20 PB-I-JOINT-MIDDLE-INIT    PIC X.
100703*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
100703         16  PB-I-BENEFICIARY-NAME.
100703             20  PB-I-BANK-NUMBER         PIC X(10).
100703             20  FILLER                   PIC X(15).
00240          16  PB-I-LAST-ADD-ON-DT          PIC XX.
011904         16  PB-I-REFERENCE               PIC X(12).
011904         16  FILLER REDEFINES PB-I-REFERENCE.
011904             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
011904             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
020305             20  PB-I-CLP-STATE           PIC XX.
00242          16  PB-I-UNDERWRITING-STATUS     PIC X.
00243              88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
00244              88  PB-I-POLICY-DECLINED         VALUE 'D'.
00245              88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
00246          16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
00247          16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
00248          16  PB-I-RESIDENT-STATE          PIC XX.
00249          16  PB-I-RATE-CODE               PIC X(4).
00250          16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
PEMMOD         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
PEMMOD         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
100703         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
100703         16  PB-I-BANK-NOCHRGB            PIC 99.
040504         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
081108         16  PB-I-JOINT-BIRTHDAY          PIC XX.
00252
00253      12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
00254          16  PB-C-LF-CANCEL-VOID-SW       PIC X.
00255              88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
00256          16  PB-C-CANCEL-ORIGIN           PIC X.
00257              88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
00258          16  PB-C-LF-CANCEL-DT            PIC XX.
00259          16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
00260          16  PB-C-LF-CALC-REQ             PIC X.
00261              88 PB-COMP-LF-CANCEL            VALUE '?'.
00262          16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
00263          16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
00264          16  PB-C-AH-CANCEL-VOID-SW       PIC X.
00265              88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
00266          16  PB-C-AH-CANCEL-DT            PIC XX.
00267          16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
00268          16  PB-C-AH-CALC-REQ             PIC X.
00269              88 PB-COMP-AH-CANCEL            VALUE '?'.
00270          16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
00271          16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
00272          16  PB-C-LAST-NAME               PIC X(15).
00273          16  PB-C-REFUND-SW               PIC X.
00274              88  PB-C-REFUND-CREATED          VALUE 'Y'.
00275              88  PB-C-REFUND-REQUESTED        VALUE 'R'.
00276          16  PB-C-LIVES                   PIC S9(3)       COMP-3.
00277          16  PB-C-PAYEE-CODE              PIC X(6).
00278          16  PB-C-LF-REFUND-OVERRIDE      PIC X.
00279          16  PB-C-AH-REFUND-OVERRIDE      PIC X.
00280          16  PB-C-LF-COMM-CHARGEBACK      PIC X.
00281          16  PB-C-AH-COMM-CHARGEBACK      PIC X.
00282          16  PB-C-REFERENCE               PIC X(12).
PEMMOD         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
PEMMOD         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
081606         16  PB-C-POST-CARD-IND           PIC X.
081606         16  PB-C-CANCEL-REASON           PIC X.
072308         16  PB-C-REF-INTERFACE-SW        PIC X.
071211         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
071211         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
00283          16  FILLER                       PIC X(01).
PEMMOD*        16  FILLER                       PIC X(18).
00284          16  PB-C-POLICY-FORM-NO          PIC X(12).
072308*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
072308         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
00286          16  PB-CANCELED-CERT-DATA.
00287              20  PB-CI-INSURED-NAME.
00288                  24  PB-CI-LAST-NAME      PIC X(15).
00289                  24  PB-CI-INITIALS       PIC XX.
00290              20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
00291              20  PB-CI-INSURED-SEX        PIC X.
00292              20  PB-CI-LF-TERM            PIC S999        COMP-3.
00293              20  PB-CI-LF-BENEFIT-CD      PIC XX.
00294              20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
00295              20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
00296              20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
00297              20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
00298              20  PB-CI-AH-TERM            PIC S999        COMP-3.
00299              20  PB-CI-AH-BENEFIT-CD      PIC XX.
00300              20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
00301              20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
00302              20  PB-CI-RATE-CLASS         PIC XX.
00303              20  PB-CI-RATE-DEV-LF        PIC XXX.
00304              20  PB-CI-RATE-DEV-AH        PIC XXX.
00305              20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
00306              20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
00307              20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
00308              20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
00309              20  PB-CI-LF-ABBR            PIC X(3).
00310              20  PB-CI-AH-ABBR            PIC X(3).
00311              20  PB-CI-OB-FLAG            PIC X.
00312                  88  PB-CI-OB                VALUE 'B'.
00313              20  PB-CI-LF-POLICY-STATUS   PIC X.
00314                  88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
122002                                           'M' '4' '5' '9' '2'.
00316                  88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
00317                  88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
00318                  88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
00319                  88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
00320                  88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
122002                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
00321                  88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
00322                  88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
00323                  88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
00324                  88  PB-CI-LF-REIN-ONLY              VALUE '9'.
00325                  88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
00326                  88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
00327              20  PB-CI-AH-POLICY-STATUS   PIC X.
00328                  88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
122002                                           'M' '4' '5' '9' '2'.
00330                  88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
00331                  88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
00332                  88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
00333                  88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
00334                  88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
122002                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
00335                  88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
00336                  88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
00337                  88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
00338                  88  PB-CI-AH-REIN-ONLY              VALUE '9'.
00339                  88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
00340                  88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
00341              20  PB-CI-PAY-FREQUENCY      PIC 99.
00342              20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
00343              20  PB-CI-SOC-SEC-NO         PIC X(11).
00344              20  PB-CI-MEMBER-NO          PIC X(12).
00345              20  PB-CI-INT-CODE           PIC X.
00346                  88  PB-CI-ADD-ON                  VALUE 'A'.
00347                  88  PB-CI-SIMPLE                  VALUE 'S'.
00348              20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
00349              20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
00350              20  PB-CI-COMP-EXCP-SW       PIC X.
00351                  88  PB-CI-NO-COMP-EXCP            VALUE ' '.
00352                  88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
00353              20  PB-CI-ENTRY-STATUS       PIC X.
00354              20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
00355              20  PB-CI-AH-PAID-THRU-DT    PIC XX.
00356              20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
00357              20  PB-CI-DEATH-DT           PIC XX.
00358              20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
00359              20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
00360              20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
00361              20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
00362              20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
00363              20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
00364              20  PB-CI-ENTRY-DT              PIC XX.
00365              20  PB-CI-ENTRY-BATCH           PIC X(6).
00366              20  PB-CI-LF-EXPIRE-DT          PIC XX.
00367              20  PB-CI-AH-EXPIRE-DT          PIC XX.
00368              20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
00369              20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
110105             20  PB-CI-OLD-LOF               PIC XXX.
110105*            20  PB-CI-LOAN-OFFICER          PIC XXX.
00371              20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
00372              20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
00373              20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
00374              20  PB-CI-INDV-GRP-CD           PIC X.
100703             20  PB-CI-BENEFICIARY-NAME.
100703                 24  PB-CI-BANK-NUMBER       PIC X(10).
100703                 24  FILLER                  PIC X(15).
00376              20  PB-CI-NOTE-SW               PIC X.
00377              20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
00378              20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
00379              20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
040504             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
110105             20  PB-CI-LOAN-OFFICER          PIC X(5).
032306             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
072209             20  PB-CI-FIRST-NAME            PIC X(10).
071211             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
00380
072209         16  FILLER                       PIC X(13).
072209*032306  16  FILLER                       PIC X(27).
040504*        16  FILLER                       PIC X(46).
00382
00383      12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
00384          16  FILLER                       PIC X(10).
00385          16  PB-M-INSURED-LAST-NAME       PIC X(15).
00386          16  PB-M-INSURED-FIRST-NAME      PIC X(10).
00387          16  PB-M-INSURED-MID-INIT        PIC X.
00388          16  PB-M-INSURED-AGE             PIC 99.
00389          16  PB-M-INSURED-BIRTHDAY        PIC XX.
00390          16  PB-M-INSURED-SEX             PIC X.
00391          16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
00392          16  PB-M-INSURED-ADDRESS-1       PIC X(30).
00393          16  PB-M-INSURED-ADDRESS-2       PIC X(30).
00394          16  PB-M-INSURED-CITY-STATE.
051810             20  PB-M-INSURED-CITY        PIC X(28).
051810             20  PB-M-INSURED-STATE       PIC XX.
00395          16  PB-M-INSURED-ZIP-CODE.
00396              20  PB-M-INSURED-ZIP-PRIME.
00397                  24  PB-M-INSURED-ZIP-1   PIC X.
00398                      88  PB-M-CANADIAN-POST-CODE
00399                                              VALUE 'A' THRU 'Z'.
00400                  24  FILLER               PIC X(4).
00401              20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
00402          16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
00403                                         PB-M-INSURED-ZIP-CODE.
00404              20  PM-M-INS-CAN-POST1       PIC XXX.
00405              20  PM-M-INS-CAN-POST2       PIC XXX.
00406              20  FILLER                   PIC XXX.
00407          16  PB-M-INSURED-PHONE-NO        PIC 9(10).
081108         16  PB-M-JOINT-BIRTHDAY          PIC XX.
               16  PB-M-CRED-BENE-NAME          PIC X(30).
               16  PB-M-CRED-BENE-ADDR1         PIC X(30).
               16  PB-M-CRED-BENE-ADDR2         PIC X(30).
               16  PB-M-CRED-BENE-CITYST.
                   20  PB-M-CRED-BENE-CITY      PIC X(28).
                   20  PB-M-CRED-BENE-STATE     PIC XX.
081108         16  FILLER                       PIC X(92).
00409
00410      12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
00411          16  FILLER                       PIC X(10).
00412          16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
00413          16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
00414          16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
00415          16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
00416          16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
00417          16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
00418          16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
00419          16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
00420          16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
00421          16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
00422          16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
00423          16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
00424          16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
00425          16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
00426          16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
00427          16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
00428          16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
00429          16  PB-ACCOUNT-NAME              PIC X(30).
00430          16  PB-PREM-REF-RPT-FLAG         PIC X.
00431          16  PB-REFERENCE                 PIC X(12).
00432          16  PB-B-RECEIVED-DT             PIC XX.
00433          16  FILLER                       PIC X(234).
00434
00435      12  PB-RECORD-STATUS.
00436          16  PB-CREDIT-SELECT-DT          PIC XX.
00437          16  PB-CREDIT-ACCEPT-DT          PIC XX.
00438          16  PB-BILLED-DT                 PIC XX.
00439          16  PB-BILLING-STATUS            PIC X.
00440              88  PB-ENTRY-REVERSED            VALUE 'R'.
00441              88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
00442              88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
00443          16  PB-RECORD-BILL               PIC X.
00444              88  PB-RECORD-ON-HOLD            VALUE 'H'.
00445              88  PB-RECORD-RETURNED           VALUE 'R'.
00446              88  PB-RECORD-ENDORSED           VALUE 'E'.
00447              88  PB-OVERRIDE-LIFE             VALUE 'L'.
00448              88  PB-OVERRIDE-AH               VALUE 'A'.
00449              88  PB-OVERRIDE-BOTH             VALUE 'B'.
00450          16  PB-BATCH-ENTRY               PIC X.
00451              88  PB-POLICY-IS-DECLINED        VALUE 'D'.
00452              88  PB-REIN-ONLY-CERT            VALUE 'R'.
00453              88  PB-REISSUED-CERT             VALUE 'E'.
122002             88  PB-MONTHLY-CERT              VALUE 'M'.
00454              88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
00455              88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
00456              88  PB-POLICY-IS-VOIDED          VALUE 'V'.
00457          16  PB-FORCE-CODE                PIC X.
00458              88  PB-FORCE-OFF                 VALUE ' ' '0'.
00459              88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
00460              88  PB-CANCEL-FORCE              VALUE '8'.
00461              88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
00462              88  PB-ALL-CANCEL-FORCED         VALUE '8'.
00463              88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
00464              88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
00465              88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
00466              88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
073107             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
00467          16  PB-FATAL-FLAG                PIC X.
00468              88  PB-FATAL-ERRORS              VALUE 'X'.
00469          16  PB-FORCE-ER-CD               PIC X.
00470              88  PB-FORCE-ERRORS              VALUE 'F'.
00471              88  PB-UNFORCED-ERRORS           VALUE 'X'.
00472          16  PB-WARN-ER-CD                PIC X.
00473              88  PB-WARNING-ERRORS            VALUE 'W'.
00474          16  FILLER                       PIC X.
00475          16  PB-OUT-BAL-CD                PIC X.
00476              88  PB-OUT-OF-BAL                VALUE 'O'.
00477          16  PB-LIFE-OVERRIDE-L1          PIC X.
00478          16  PB-AH-OVERRIDE-L1            PIC X.
00479          16  PB-INPUT-DT                  PIC XX.
00480          16  PB-INPUT-BY                  PIC X(4).
00481          16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
00482          16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
00483          16  PB-TOLERANCE-REJECT-SW       PIC X.
00484          16  PB-LF-EARNING-METHOD         PIC X.
00485          16  PB-AH-EARNING-METHOD         PIC X.
00486          16  PB-LF-TERM-CALC-METHOD       PIC X.
00487          16  PB-AH-TERM-CALC-METHOD       PIC X.
00488          16  PB-REIN-CD                   PIC XXX.
00489          16  PB-LF-REFUND-TYPE            PIC X.
00490          16  PB-AH-REFUND-TYPE            PIC X.
00491          16  PB-ACCT-EFF-DT               PIC XX.
00492          16  PB-ACCT-EXP-DT               PIC XX.
00493          16  PB-COMPANY-ID                PIC X(3).
00494          16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
00495          16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
00496          16  PB-SV-CARRIER                PIC X.
00497          16  PB-SV-GROUPING               PIC X(6).
00498          16  PB-SV-STATE                  PIC XX.
00499          16  PB-CONFIRMATION-REPT-DT      PIC XX.
00500          16  PB-GA-BILLING-INFO.
00501              20  PB-GA-BILL-DT OCCURS 5 TIMES
00502                                           PIC XX.
00503          16  PB-SV-REMIT-TO  REDEFINES
00504              PB-GA-BILLING-INFO           PIC X(10).
00505          16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
110105         16  PB-I-LOAN-OFFICER            PIC X(5).
081606         16  PB-I-VIN                     PIC X(17).
00506
110105         16  FILLER                       PIC X(04).
110105         16  IMNET-BYPASS-SW              PIC X.
00508
00509 ******************************************************************
00510 *                COMMON EDIT ERRORS                              *
00511 ******************************************************************
00512
00513      12  PB-COMMON-ERRORS.
00514          16  PB-COMMON-ERROR    OCCURS 10 TIMES
00515                                            PIC S9(4)     COMP.
00516
00517 ******************************************************************
00280
00281 * COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
00282 *    COPY ELC50W1.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                             ELC50W1                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.004                          *
00006 *                                                                *
00007 *       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
00008 *                                                                *
00009 *                                                                *
00010 ******************************************************************
00011
00012      12  WK-WORK-AREA.
00013          16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
00014          16  WK-LAST-CARRIER          PIC X   VALUE ' '.
00015          16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
00016          16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
00017          16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
00018          16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
00019          16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
00020          16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
00021          16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
00022          16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
00023          16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
00024          16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
00025          16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
00026          16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
00027          16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
00028          16  WK-CREDIT-EDIT-CONTROLS.
00029              20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
00030              20  WK-MIN-AGE           PIC 99  VALUE 00.
00031              20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
00032              20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
00033              20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
00034              20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
00035          16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
00036          16  WK-SAVE-REIN-DATA.
00037              20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
00038              20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
00039              20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
00040          16  WK-ENTRY-SW              PIC X    VALUE ' '.
00041              88  ENTRY-FROM-EL6311       VALUE '6'.
00042          16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
00043          16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
00044      12  WK-RECORD-ADDRESSES.
00045          16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
00046          16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
00047          16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
00048          16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
00049          16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
00050          16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
00051          16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
00052          16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
00053      12  WK-OVER-SHORT-AREA.
00054          16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
00055          16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
               16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
                   88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
00056          16  FILLER                   PIC X(5) VALUE SPACES.
00283
00284 *    COPY ELCEDITC.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ELCEDITC                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.012                          *
00006 *                                                                *
00007 *       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
00008 *                     EL6313, EL050 AND EL517.                   *
00009 *                                                                *
00010 ******************************************************************
122002******************************************************************
122002*                   C H A N G E   L O G
122002*
122002* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
122002*-----------------------------------------------------------------
122002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
122002* EFFECTIVE    NUMBER
122002*-----------------------------------------------------------------
122002* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
122002******************************************************************
00011
00012      12  EDIT-CRITERIA-DATA.
00013          16  EC-CO-MONTH-END-DT       PIC XX.
00014          16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
00015          16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
00016          16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
00017          16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
00018          16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
00019          16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
00020          16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
00021          16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
00022          16  EC-CO-REM-TERM-CALC      PIC X.
00023                88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
00024                88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
00025                88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
00026                88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
00027
00028          16  EC-BR-LF-EARNINGS-CALC    PIC X.
00029                88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
00030                88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
00031                88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
00032                88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
00033                88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
00034                88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
00035                88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
00036                88  EC-BR-LF-EARN-MEAN               VALUE '8'.
00037                88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
00038                88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
00039
00040          16  EC-BR-AH-EARNINGS-CALC    PIC X.
00041                88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
00042                88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
00043                88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
00044                88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
00045                88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
00046                88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
00047                88  EC-BR-AH-EARN-MEAN               VALUE '8'.
00048                88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
00049
00050          16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
00051                  88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
00052                  88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
00053
00054          16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
00055                  88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
00056                  88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
00057                  88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
00058                  88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
00059                  88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
00060                  88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
00061                  88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
00062                  88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
00063
00064          16  EC-BR-LF-COVERAGE-TYPE    PIC X.
00065                88  EC-BR-REDUCING                   VALUE 'R'.
00066                88  EC-BR-LEVEL                      VALUE 'L' 'P'.
00067
00068          16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
00069          16  EC-BR-LF-DESC             PIC X(10).
00070          16  EC-BR-AH-DESC             PIC X(10).
00071          16  EC-BR-LF-COMMENT          PIC X(10).
00072          16  EC-BR-AH-COMMENT          PIC X(10).
00073
00074          16  EC-BR-LF-REM-TERM-CALC    PIC X.
00075                88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
00076                88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
00077                88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
00078                88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
00079
00080          16  EC-BR-AH-REM-TERM-CALC    PIC X.
00081                88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
00082                88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
00083                88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
00084                88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
00085
00086          16  EC-BR-LF-REFUND-CALC      PIC X.
00087                  88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
00088                  88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
00089                  88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
00090                  88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
00091                  88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
00092                  88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
00093                  88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
00094
00095          16  EC-BR-AH-REFUND-CALC      PIC X.
00096                  88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
00097                  88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
00098                  88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
00099                  88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
00100                  88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
00101                  88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
00102                  88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
00103                  88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
00104
00105          16  EC-BR-LF-BEN-I-G-CD       PIC X.
00106                  88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
00107                  88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
00108                  88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
00109
00110          16  EC-BR-AH-BEN-I-G-CD       PIC X.
00111                  88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
00112                  88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
00113                  88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
00114
00115          16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
00116          16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
00117          16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
00118          16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
00119
00120          16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
00121          16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
00122                  88  EC-ST-EXT-NO-CHG               VALUE ' '.
00123                  88  EC-ST-EXT-CHG-LF               VALUE '1'.
00124                  88  EC-ST-EXT-CHG-AH               VALUE '2'.
00125                  88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
00126
00127          16  EC-ST-LF-REM-TERM-CALC    PIC X.
00128                88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
00129                88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
00130                88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
00131                88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
00132                88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
00133
00134          16  EC-ST-AH-REM-TERM-CALC    PIC X.
00135                88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
00136                88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
00137                88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
00138                88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
00139                88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
00140
00141          16  EC-ST-LF-REFUND-CALC      PIC X.
00142                  88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
00143                  88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
00144                  88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
00145                  88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
00146                  88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
00147                  88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
00148                  88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
00149                  88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
00150
00151          16  EC-ST-AH-REFUND-CALC      PIC X.
00152                  88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
00153                  88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
00154                  88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
00155                  88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
00156                  88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
00157                  88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
00158                  88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
00159                  88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
00160
00161          16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
00162          16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
00163          16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
00164          16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
00165          16  EC-AM-EXPIRATION-DT       PIC XX.
00166          16  EC-AM-EFFECTIVE-DT        PIC XX.
00167          16  EC-AM-CLASS-CD            PIC XX.
00168          16  EC-AM-LF-DEVIATION        PIC XXX.
00169          16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
00170          16  EC-AM-AH-DEVIATION        PIC XXX.
00171          16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
00172          16  EC-AM-PHONE-NO            PIC X(10).
00173
00174          16  EC-AM-LF-REFUND-CALC      PIC X.
00175                  88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
00176                  88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
00177                  88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
00178                  88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
00179                  88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
00180                  88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
00181                  88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
00182
00183          16  EC-AM-AH-REFUND-CALC      PIC X.
00184                  88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
00185                  88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
00186                  88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
00187                  88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
00188                  88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
00189                  88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
00190                  88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
00191
00192          16  EC-AM-BEN-I-G-CD          PIC X.
00193                  88  WK-AM-I-G-NOT-USED             VALUE ' '.
00194                  88  EC-AM-I-G-IS-INDV              VALUE 'I'.
00195                  88  EC-AM-I-G-IS-GRP               VALUE 'G'.
00196
00197          16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
00198          16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
00199          16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
00200          16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
00201          16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
00202          16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
00203          16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
00204          16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
00205          16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
00206
00207          16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
00208          16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
00209          16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
00210          16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
00211          16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
00212          16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
00213          16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
00214          16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
00215          16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
00216          16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
00217          16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
00218          16  EC-RT-LF-NSP-ST           PIC XX.
00219          16  EC-RT-AH-NSP-ST           PIC XX.
00220          16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
00221          16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
00222
00223          16  EC-CM-LF-PRIOR-STATUS     PIC X.
00224              88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
00225                                              'M' '5' '9' '2'.
00226              88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
00227              88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
00228              88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
00229              88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
00230              88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
122002             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
00231              88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
00232              88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
00233              88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
00234              88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
00235
00236          16  EC-CM-AH-PRIOR-STATUS     PIC X.
00237              88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
00238                                              'M' '5' '9' '2'.
00239              88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
00240              88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
00241              88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
00242              88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
00243              88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
122002             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
00244              88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
00245              88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
00246              88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
00247              88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
00248
00249          16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
00250          16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
00251          16  EC-CM-LF-CANCEL-DT        PIC XX.
00252          16  EC-CM-AH-CANCEL-DT        PIC XX.
00253          16  EC-CM-DEATH-DT            PIC XX.
00254
00255 *DMD CUSTOM CODING FIELDS BELOW
00256 *POPULATED BY CF-RATING-SWITCH AT EL050 TIME
00257          16  EC-BR-DMD-RATING-SW       PIC X.
00258                  88  EC-DMD-AH-RATING            VALUE 'Y'.
00259                  88  EC-DMD-LF-RATING            VALUE 'Y'.
00260                  88  NO-DMD-RATING               VALUE 'N'.
00261
00262          16  EC-NEW-CERT               PIC X(11).
00263          16  EC-NEW-STATE              PIC XX.
00264          16  FILLER                    PIC X.
00265 *FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
00266          16  OVER-SHORT-EDIT-FIELDS.
00267              20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
00268              20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
00269              20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
00270              20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
00271              20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
00272              20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
00273              20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
00274              20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
00275              20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
00276          16  FILLER                    PIC X(71).
00285 ******************************************************************
00286
00287      EJECT
00288 *    COPY ELCDIFRD.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ELCDIFRD.                           *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.004                          *
00006 *                                                                *
00007 *   WORKING STORAGE FOR REFUND DIFFERENCES                       *
00008 *                                                                *
00009 ******************************************************************
00010 *
00011   01  WS-DIFFERENCE-CALCULATION.
00012         12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
00013         12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
00014         12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
00015         12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
00016         12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
00017         12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
00018         12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
00019         12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
00020         12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
00021         12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
00022         12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
00289
00290      EJECT
      ****************************************************************
      *                                                               
      * Copyright (c) 2007 by Clerity Solutions, Inc.                 
      * All rights reserved.                                          
      *                                                               
      ****************************************************************
       01  DFHEIV.                                                    
         02  DFHEIV0               PIC X(35).                         
         02  DFHEIV1               PIC X(08).                         
         02  DFHEIV2               PIC X(08).                         
         02  DFHEIV3               PIC X(08).                         
         02  DFHEIV4               PIC X(06).                         
         02  DFHEIV5               PIC X(04).                         
         02  DFHEIV6               PIC X(04).                         
         02  DFHEIV7               PIC X(02).                         
         02  DFHEIV8               PIC X(02).                         
         02  DFHEIV9               PIC X(01).                         
         02  DFHEIV10              PIC S9(7) COMP-3.                  
         02  DFHEIV11              PIC S9(4) COMP SYNC.               
         02  DFHEIV12              PIC S9(4) COMP SYNC.               
         02  DFHEIV13              PIC S9(4) COMP SYNC.               
         02  DFHEIV14              PIC S9(4) COMP SYNC.               
         02  DFHEIV15              PIC S9(4) COMP SYNC.               
         02  DFHEIV16              PIC S9(9) COMP SYNC.               
         02  DFHEIV17              PIC X(04).                         
         02  DFHEIV18              PIC X(04).                         
         02  DFHEIV19              PIC X(04).                         
         02  DFHEIV20              USAGE IS POINTER.                  
         02  DFHEIV21              USAGE IS POINTER.                  
         02  DFHEIV22              USAGE IS POINTER.                  
         02  DFHEIV23              USAGE IS POINTER.                  
         02  DFHEIV24              USAGE IS POINTER.                  
         02  DFHEIV25              PIC S9(9) COMP SYNC.               
         02  DFHEIV26              PIC S9(9) COMP SYNC.               
         02  DFHEIV27              PIC S9(9) COMP SYNC.               
         02  DFHEIV28              PIC S9(9) COMP SYNC.               
         02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.       
         02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.    
         02  FILLER                PIC X(02).                         
         02  DFHEIV99              PIC X(08) VALUE SPACE.             
         02  DFHEIVL0              PIC X(48) VALUE SPACE.             
         02  DFHEIVL1              PIC X(48) VALUE SPACE.             
         02  DFHEIVL2              PIC X(48) VALUE SPACE.             
         02  DFHEIVL3              PIC X(48) VALUE SPACE.             
       LINKAGE  SECTION.
      *****************************************************************
      *                                                               *
      * Copyright (c) 2007 by Clerity Solutions, Inc.                 *
      * All rights reserved.                                          *
      *                                                               *
      *****************************************************************
       01  dfheiblk.
           02  eibtime          pic s9(7) comp-3.
           02  eibdate          pic s9(7) comp-3.
           02  eibtrnid         pic x(4).
           02  eibtaskn         pic s9(7) comp-3.
           02  eibtrmid         pic x(4).
           02  dfheigdi         pic s9(4) comp.
           02  eibcposn         pic s9(4) comp.
           02  eibcalen         pic s9(4) comp.
           02  eibaid           pic x(1).
           02  eibfiller1       pic x(1).
           02  eibfn            pic x(2).
           02  eibfiller2       pic x(2).
           02  eibrcode         pic x(6).
           02  eibfiller3       pic x(2).
           02  eibds            pic x(8).
           02  eibreqid         pic x(8).
           02  eibrsrce         pic x(8).
           02  eibsync          pic x(1).
           02  eibfree          pic x(1).
           02  eibrecv          pic x(1).
           02  eibsend          pic x(1).
           02  eibatt           pic x(1).
           02  eibeoc           pic x(1).
           02  eibfmh           pic x(1).
           02  eibcompl         pic x(1).
           02  eibsig           pic x(1).
           02  eibconf          pic x(1).
           02  eiberr           pic x(1).
           02  eibrldbk         pic x(1).
           02  eiberrcd         pic x(4).
           02  eibsynrb         pic x(1).
           02  eibnodat         pic x(1).
           02  eibfiller5       pic x(2).
           02  eibresp          pic 9(09) comp.
           02  eibresp2         pic 9(09) comp.
           02  dfheigdj         pic s9(4) comp.
           02  dfheigdk         pic s9(4) comp.
00292
00293  01  DFHCOMMAREA                   PIC X(1036).
00294
00295 *01 PARMLIST .
00296 *    02  FILLER                    PIC S9(8)   COMP.
00297 *    02  ELCNTL-POINTER            PIC S9(8)   COMP.
00298 *    02  ERACCT-POINTER            PIC S9(8)   COMP.
00299 *    02  ERREIN-POINTER            PIC S9(8)   COMP.
00300 *    02  ERCTBL-POINTER            PIC S9(8)   COMP.
00301 *    02  ERFORM-POINTER            PIC S9(8)   COMP.
00302 *    02  ELMSTR-POINTER            PIC S9(8)   COMP.
00303 *    02  ERPLAN-POINTER            PIC S9(8)   COMP.
00304
00305      EJECT
00306 *    COPY ELCCNTL.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ELCCNTL.                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.059                          *
00006 *                                                                *
00007 *   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
00008 *                                                                *
00009 *   FILE TYPE = VSAM,KSDS                                        *
00010 *   RECORD SIZE = 750  RECFORM = FIXED                           *
00011 *                                                                *
00012 *   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
00013 *       ALTERNATE INDEX = NONE                                   *
00014 *                                                                *
00015 *   LOG = YES                                                    *
00016 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00017 ******************************************************************
082503*                   C H A N G E   L O G
082503*
082503* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
082503*-----------------------------------------------------------------
082503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
082503* EFFECTIVE    NUMBER
082503*-----------------------------------------------------------------
082503* 082503                   PEMA  ADD BENEFIT GROUP
100703* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
033104* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
092705* 092705    2005050300006  PEMA  ADD SPP LEASES
031808* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
071508* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
091808* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
011410* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
061511* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
011812* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
012913* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
032813* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
082503******************************************************************
00018 *
00019  01  CONTROL-FILE.
00020      12  CF-RECORD-ID                       PIC XX.
00021          88  VALID-CF-ID                        VALUE 'CF'.
00022
00023      12  CF-CONTROL-PRIMARY.
00024          16  CF-COMPANY-ID                  PIC XXX.
00025          16  CF-RECORD-TYPE                 PIC X.
00026              88  CF-COMPANY-MASTER              VALUE '1'.
00027              88  CF-PROCESSOR-MASTER            VALUE '2'.
00028              88  CF-STATE-MASTER                VALUE '3'.
00029              88  CF-LF-BENEFIT-MASTER           VALUE '4'.
00030              88  CF-AH-BENEFIT-MASTER           VALUE '5'.
00031              88  CF-CARRIER-MASTER              VALUE '6'.
00032              88  CF-MORTALITY-MASTER            VALUE '7'.
00033              88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
00034              88  CF-TERMINAL-MASTER             VALUE '9'.
00035              88  CF-AH-EDIT-MASTER              VALUE 'A'.
00036              88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
00037              88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
00038              88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
00039              88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
00040              88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
00041              88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
00042              88  CF-REMINDERS-MASTER            VALUE 'R'.
00043              88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
00044          16  CF-ACCESS-CD-GENL              PIC X(4).
00045          16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
00046              20  CF-PROCESSOR               PIC X(4).
00047          16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
00048              20  CF-STATE-CODE              PIC XX.
00049              20  FILLER                     PIC XX.
00050          16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
00051              20  FILLER                     PIC XX.
00052              20  CF-HI-BEN-IN-REC           PIC XX.
00053          16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
00054              20  FILLER                     PIC XXX.
00055              20  CF-CARRIER-CNTL            PIC X.
00056          16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
00057              20  FILLER                     PIC XX.
00058              20  CF-HI-TYPE-IN-REC          PIC 99.
00059          16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
00060              20  CF-CRDB-TABLE-INDICATOR    PIC X.
00061                  88  CF-CRDB-NAIC-TABLE         VALUE '9'.
00062              20  CF-CRDB-BENEFIT-TYPE       PIC X.
00063              20  CF-CRDB-WAITING-PERIOD     PIC XX.
00064          16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
00065              20  FILLER                     PIC X.
00066              20  CF-CUSTOM-REPORT-NO        PIC 999.
00067          16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
00068              20  FILLER                     PIC XX.
00069              20  CF-MORTGAGE-PLAN           PIC XX.
00070          16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
00071
00072      12  CF-LAST-MAINT-DT                   PIC XX.
00073      12  CF-LAST-MAINT-BY                   PIC X(4).
00074      12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
00075
00076      12  CF-RECORD-BODY                     PIC X(728).
00077
00078
00079 ****************************************************************
00080 *             COMPANY MASTER RECORD                            *
00081 ****************************************************************
00082
00083      12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
00084          16  CF-COMPANY-ADDRESS.
00085              20  CF-CL-MAIL-TO-NAME         PIC X(30).
00086              20  CF-CL-IN-CARE-OF           PIC X(30).
00087              20  CF-CL-ADDR-LINE-1          PIC X(30).
00088              20  CF-CL-ADDR-LINE-2          PIC X(30).
00089              20  CF-CL-CITY-STATE           PIC X(30).
00090              20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
00091              20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
00092          16  CF-COMPANY-CD                  PIC X.
00093          16  CF-COMPANY-PASSWORD            PIC X(8).
00094          16  CF-SECURITY-OPTION             PIC X.
00095              88  ALL-SECURITY                   VALUE '1'.
00096              88  COMPANY-VERIFY                 VALUE '2'.
00097              88  PROCESSOR-VERIFY               VALUE '3'.
00098              88  NO-SECURITY                    VALUE '4'.
00099              88  ALL-BUT-TERM                   VALUE '5'.
00100          16  CF-CARRIER-CONTROL-LEVEL       PIC X.
00101              88  USE-ACTUAL-CARRIER             VALUE SPACE.
00102          16  CF-LGX-INTERFACE-CNTL          PIC X.
00103              88  LGX-TIME-SHR-COMPANY           VALUE '1'.
00104          16  CF-INFORCE-LOCATION            PIC X.
00105              88  CERTS-ARE-ONLINE               VALUE '1'.
00106              88  CERTS-ARE-OFFLINE              VALUE '2'.
00107              88  NO-CERTS-AVAILABLE             VALUE '3'.
00108          16  CF-LOWER-CASE-LETTERS          PIC X.
00109          16  CF-CERT-ACCESS-CONTROL         PIC X.
00110              88  CF-ST-ACCNT-CNTL               VALUE ' '.
00111              88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
00112              88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
00113              88  CF-ACCNT-CNTL                  VALUE '3'.
00114              88  CF-CARR-ACCNT-CNTL             VALUE '4'.
00115
00116          16  CF-FORMS-PRINTER-ID            PIC X(4).
00117          16  CF-CHECK-PRINTER-ID            PIC X(4).
00118
00119          16  CF-LGX-CREDIT-USER             PIC X.
00120              88  CO-IS-NOT-USER                 VALUE 'N'.
00121              88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
00122
00123          16 CF-CREDIT-CALC-CODES.
00124              20  CF-CR-REM-TERM-CALC PIC X.
00125                88  CR-EARN-AFTER-15TH           VALUE '1'.
00126                88  CR-EARN-ON-HALF-MO           VALUE '2'.
00127                88  CR-EARN-ON-1ST-DAY           VALUE '3'.
00128                88  CR-EARN-ON-FULL-MO           VALUE '4'.
00129                88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
00130                88  CR-EARN-AFTER-14TH           VALUE '6'.
00131                88  CR-EARN-AFTER-16TH           VALUE '7'.
00132              20  CF-CR-R78-METHOD           PIC X.
00133                88  USE-TERM-PLUS-ONE            VALUE SPACE.
00134                88  DONT-USE-PLUS-ONE            VALUE '1'.
00135
00136          16  CF-CLAIM-CONTROL-COUNTS.
00137              20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
00138                  88  CO-CLM-COUNT-RESET         VALUE +99999.
00139
00140              20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
00141                  88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
00142
00143              20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
00144                  88  CO-CHECK-COUNT-RESET       VALUE +9999999.
00145
00146              20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
00147                  88  CO-QUE-COUNT-RESET         VALUE +9999999.
00148
00149          16  CF-CURRENT-MONTH-END           PIC XX.
00150
00151          16  CF-CO-CALC-QUOTE-TOLERANCE.
00152              20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
00153              20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
00154              20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
00155              20  CF-CO-CLAIM-REJECT-SW      PIC X.
00156                  88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
00157                  88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
00158              20  CF-CO-PREM-REJECT-SW       PIC X.
00159                  88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
00160                  88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
00161              20  CF-CO-REF-REJECT-SW        PIC X.
00162                  88 CO-WARN-IF-REF-OUT          VALUE SPACE.
00163                  88 CO-FORCE-IF-REF-OUT         VALUE '1'.
00164
00165          16  CF-CO-REPORTING-DT             PIC XX.
00166          16  CF-CO-REPORTING-MONTH-DT       PIC XX.
00167          16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
00168            88  CF-CO-NOT-MONTH-END              VALUE SPACES.
00169            88  CF-CO-MONTH-END                  VALUE '1'.
00170
00171          16  CF-LGX-CLAIM-USER              PIC X.
00172              88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
00173              88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
00174
00175          16  CF-CREDIT-EDIT-CONTROLS.
00176              20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
00177              20  CF-MIN-AGE                 PIC 99.
00178              20  CF-DEFAULT-AGE             PIC 99.
00179              20  CF-MIN-TERM                PIC S999      COMP-3.
00180              20  CF-MAX-TERM                PIC S999      COMP-3.
00181              20  CF-DEFAULT-SEX             PIC X.
00182              20  CF-JOINT-AGE-INPUT         PIC X.
00183                  88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
00184              20  CF-BIRTH-DATE-INPUT        PIC X.
00185                  88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
00186              20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
00187                  88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
00188                  88  CF-ZERO-CARRIER            VALUE '1'.
00189                  88  CF-ZERO-GROUPING           VALUE '2'.
00190                  88  CF-ZERO-CAR-GROUP          VALUE '3'.
00191              20  CF-EDIT-SW                 PIC X.
00192                  88  CF-START-EDIT-TONIGHT      VALUE '1'.
00193              20  CF-EDIT-RESTART-BATCH      PIC X(6).
00194              20  CF-CR-PR-METHOD            PIC X.
00195                88  USE-NORMAL-PR-METHOD         VALUE SPACE.
00196                88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
00197              20  FILLER                     PIC X.
00198
00199          16  CF-CREDIT-MISC-CONTROLS.
00200              20  CF-REIN-TABLE-SW           PIC X.
00201                  88 REIN-TABLES-ARE-USED        VALUE '1'.
00202              20  CF-COMP-TABLE-SW           PIC X.
00203                  88 COMP-TABLES-ARE-USED        VALUE '1'.
00204              20  CF-EXPERIENCE-RETENTION-AGE
00205                                             PIC S9        COMP-3.
00206              20  CF-CONVERSION-DT           PIC XX.
00207              20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
00208              20  CF-RUN-FREQUENCY-SW        PIC X.
00209                  88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
00210                  88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
00211
00212              20  CF-CR-CHECK-NO-CONTROL.
00213                  24  CF-CR-CHECK-NO-METHOD    PIC X.
00214                      88  CR-CHECK-NO-MANUAL       VALUE '1'.
00215                      88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
00216                      88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
00217                  24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
00218                      88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
00219
00220                  24  CF-CR-CHECK-COUNT       REDEFINES
00221                      CF-CR-CHECK-COUNTER      PIC X(4).
00222
00223                  24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
00224                      88  CR-QUE-COUNT-RESET      VALUE +9999999.
00225
00226                  24  CF-CR-CHECK-QUE-COUNT   REDEFINES
00227                      CF-CR-CHECK-QUE-COUNTER  PIC X(4).
00228                  24  CF-MAIL-PROCESSING       PIC X.
00229                      88  MAIL-PROCESSING          VALUE 'Y'.
00230
00231          16  CF-MISC-SYSTEM-CONTROL.
00232              20  CF-SYSTEM-C                 PIC X.
00233                  88  CONFIRMATION-SYS-USED       VALUE '1'.
00234              20  CF-SYSTEM-D                 PIC X.
00235                  88  DAILY-BILL-SYS-USED         VALUE '1'.
00236              20  CF-SOC-SEC-NO-SW            PIC X.
00237                  88  SOC-SEC-NO-USED             VALUE '1'.
00238              20  CF-MEMBER-NO-SW             PIC X.
00239                  88  MEMBER-NO-USED              VALUE '1'.
00240              20  CF-TAX-ID-NUMBER            PIC X(11).
00241              20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
00242              20  CF-PAYMENT-APPROVAL-SW      PIC X.
00243                  88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
00244                  88  CF-NO-APPROVAL              VALUE ' ' 'N'.
00245                  88  CF-ALL-APPROVED             VALUE 'Y'.
00246                  88  CF-GRADUATED-APPROVAL       VALUE 'G'.
00247              20  CF-SYSTEM-E                 PIC X.
00248                  88  CF-AR-SYSTEM-USED           VALUE 'Y'.
00249
00250          16  CF-LGX-LIFE-USER               PIC X.
00251              88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
00252              88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
00253
00254          16  CF-CR-MONTH-END-DT             PIC XX.
00255
00256          16  CF-FILE-MAINT-DATES.
00257              20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
00258                  88  CF-LAST-BATCH-RESET        VALUE +999999.
00259              20  CF-LAST-BATCH       REDEFINES
00260                  CF-LAST-BATCH-NO               PIC X(4).
00261              20  CF-RATES-FILE-MAINT-DT         PIC XX.
00262              20  CF-RATES-FILE-CREATE-DT        PIC XX.
00263              20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
00264              20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
00265              20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
00266              20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
00267              20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
00268              20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
00269              20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
00270              20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
00271
00272          16  CF-NEXT-COMPANY-ID             PIC XXX.
00273          16  FILLER                         PIC X.
00274
00275          16  CF-ALT-MORT-CODE               PIC X(4).
00276          16  CF-MEMBER-CAPTION              PIC X(10).
00277
00278          16  CF-LIFE-ACCESS-CONTROL         PIC X.
00279              88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
00280              88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
00281              88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
00282              88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
00283              88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
00284
00285          16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
00286
00287          16  CF-LIFE-OVERRIDE-L1            PIC X.
00288          16  CF-LIFE-OVERRIDE-L2            PIC XX.
00289          16  CF-LIFE-OVERRIDE-L6            PIC X(6).
00290          16  CF-LIFE-OVERRIDE-L12           PIC X(12).
00291
00292          16  CF-AH-OVERRIDE-L1              PIC X.
00293          16  CF-AH-OVERRIDE-L2              PIC XX.
00294          16  CF-AH-OVERRIDE-L6              PIC X(6).
00295          16  CF-AH-OVERRIDE-L12             PIC X(12).
00296
00297          16  CF-REPORT-CD1-CAPTION          PIC X(10).
00298          16  CF-REPORT-CD2-CAPTION          PIC X(10).
00299
00300          16  CF-CLAIM-CUTOFF-DATE           PIC XX.
00301          16  CF-AR-LAST-EL860-DT            PIC XX.
00302          16  CF-MP-MONTH-END-DT             PIC XX.
00303
00304          16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
00305          16  CF-CLAIM-PAID-THRU-TO          PIC X.
00306              88  CF-CLAIM-PAID-TO               VALUE '1'.
00307
00308          16  CF-AR-MONTH-END-DT             PIC XX.
00309
00310          16  CF-CRDTCRD-USER                PIC X.
00311              88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
00312              88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
00313
00314          16  CF-CC-MONTH-END-DT             PIC XX.
00315
00316          16  CF-PRINT-ADDRESS-LABELS        PIC X.
00317
00318          16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
00319              88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
00320              88  CF-USE-ALL-AGE-LAST            VALUE '2'.
00321              88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
00322          16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
00323          16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
00324          16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
00325          16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
00326              88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
00327              88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
00328          16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
00329          16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
00330          16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
00331              88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
00332          16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
00333
00334          16  CF-CL-ZIP-CODE.
00335              20  CF-CL-ZIP-PRIME.
00336                  24  CF-CL-ZIP-1ST          PIC X.
00337                      88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
00338                  24  FILLER                 PIC X(4).
00339              20  CF-CL-ZIP-PLUS4            PIC X(4).
00340          16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
00341              20  CF-CL-CAN-POSTAL-1         PIC XXX.
00342              20  CF-CL-CAN-POSTAL-2         PIC XXX.
00343              20  FILLER                     PIC XXX.
00344
00345          16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
00346          16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
00347          16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
00348          16  CF-CO-OPTION-START-DATE        PIC XX.
00349          16  CF-REM-TRM-CALC-OPTION         PIC X.
00350            88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
00351                                                       '3' '4'.
00352            88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
00353            88  CF-30-DAY-MONTH                  VALUE '1' '3'.
00354            88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
00355            88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
00356            88  CF-EXT-30-DAY-MONTH              VALUE '3'.
00357            88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
00358
00359          16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
00360
00361          16  CF-PAYMENT-APPROVAL-LEVELS.
00362              20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
00363              20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
00364              20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
00365              20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
00366              20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
00367              20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
00368
00369          16  CF-END-USER-REPORTING-USER     PIC X.
00370              88  CO-NO-END-USER-REPORTING       VALUE 'N'.
00371              88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
00372
00373          16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
00374              88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
00375              88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
00376
00377          16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
00378
071508         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
00379          16  FILLER                         PIC X.
00380
00381          16  CF-CREDIT-ARCHIVE-CNTL.
00382              20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
00383              20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
00384              20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
00385
00386          16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
00387
00388          16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
00389              88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
00390              88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
00391
00392          16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
00393              88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
00394              88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
00395
00396          16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
00397
00398          16  CF-CO-ACH-ID-CODE              PIC  X.
00399              88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
00400              88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
00401              88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
00402          16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
00403          16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
00404          16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
00405          16  CF-CO-ACH-ADMIN-NO             PIC X(09).
00406          16  CF-CO-ACH-RECV-NAME            PIC X(23).
00407          16  CF-CO-ACH-RECV-NO              PIC X(08).
00408          16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
00409          16  CF-CO-ACH-COMPANY-ID           PIC X(09).
00410          16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
00411                  88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
00412          16  CF-CO-ACH-TRACE-SPACE REDEFINES
00413                  CF-CO-ACH-TRACE-NO         PIC X(4).
00414
00415          16  CF-CO-OVER-SHORT.
00416              20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
00417              20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
00418
031808*         16  FILLER                         PIC X(102).
031808         16  CF-PAYMENT-APPROVAL-LEVELS-2.
031808             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
031808             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
031808
031808         16  CF-AH-APPROVAL-DAYS.
031808             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
031808             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
031808             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
031808             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
032813
032813         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
031808
032813         16  FILLER                         PIC X(79).
00421 ****************************************************************
00422 *             PROCESSOR/USER RECORD                            *
00423 ****************************************************************
00424
00425      12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
00426          16  CF-PROCESSOR-NAME              PIC X(30).
00427          16  CF-PROCESSOR-PASSWORD          PIC X(11).
00428          16  CF-PROCESSOR-TITLE             PIC X(26).
00429          16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
00430                  88  MESSAGE-YES                VALUE 'Y'.
00431                  88  MESSAGE-NO                 VALUE ' ' 'N'.
00432
00433 *****************************************************
00434 ****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
00435 ****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
00436 ****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
00437 ****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
00438 *****************************************************
00439
00440          16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
00441              20  CF-ADMINISTRATION-CONTROLS PIC XX.
00442              20  CF-APPLICATION-FORCE       PIC X.
00443              20  CF-INDIVIDUAL-APP.
00444                  24  CF-APP-SWITCHES  OCCURS  44 TIMES.
00445                      28  CF-BROWSE-APP      PIC X.
00446                      28  CF-UPDATE-APP      PIC X.
00447
00448          16  CF-CURRENT-TERM-ON             PIC X(4).
00449          16  CF-PROCESSOR-LIMITS-CLAIMS.
00450              20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
00451              20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
00452              20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
00453              20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
00454              20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
00455              20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
00456              20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
00457          16  CF-PROCESSOR-CARRIER           PIC X.
00458              88  NO-CARRIER-SECURITY            VALUE ' '.
00459          16  CF-PROCESSOR-ACCOUNT           PIC X(10).
00460              88  NO-ACCOUNT-SECURITY            VALUE SPACES.
00461          16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
00462              88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
00463          16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
00464              88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
00465
00466          16  CF-PROC-SYS-ACCESS-SW.
00467              20  CF-PROC-CREDIT-CLAIMS-SW.
00468                  24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
00469                      88  ACCESS-TO-CREDIT           VALUE 'Y'.
00470                  24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
00471                      88  ACCESS-TO-CLAIMS           VALUE 'Y'.
00472              20  CF-PROC-CREDIT-CLAIMS   REDEFINES
00473                  CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
00474                  88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
00475              20  CF-PROC-LIFE-GNRLDGR-SW.
00476                  24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
00477                      88  ACCESS-TO-LIFE             VALUE 'Y'.
00478                  24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
00479                      88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
00480              20  CF-PROC-LIFE-GNRLDGR    REDEFINES
00481                  CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
00482                  88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
00483          16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
00484              CF-PROC-SYS-ACCESS-SW              PIC X(4).
00485              88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
00486          16  CF-PROCESSOR-PRINTER               PIC X(4).
00487
00488          16  CF-APPROVAL-LEVEL                  PIC X.
00489              88  APPROVAL-LEVEL-1                   VALUE '1'.
00490              88  APPROVAL-LEVEL-2                   VALUE '2'.
00491              88  APPROVAL-LEVEL-3                   VALUE '3'.
031808             88  APPROVAL-LEVEL-4                   VALUE '4'.
00492
00493          16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
00494
00495          16  CF-LANGUAGE-TYPE                   PIC X.
00496              88  CF-LANG-IS-ENG                     VALUE 'E'.
00497              88  CF-LANG-IS-FR                      VALUE 'F'.
011812
011812         16  CF-CSR-IND                         PIC X.
011812         16  FILLER                             PIC X(239).
00499
00500 ****************************************************************
00501 *             PROCESSOR/REMINDERS RECORD                       *
00502 ****************************************************************
00503
00504      12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
00505          16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
00506              20  CF-START-REMIND-DT         PIC XX.
00507              20  CF-END-REMIND-DT           PIC XX.
00508              20  CF-REMINDER-TEXT           PIC X(50).
00509          16  FILLER                         PIC X(296).
00510
00511
00512 ****************************************************************
00513 *             STATE MASTER RECORD                              *
00514 ****************************************************************
00515
00516      12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
00517          16  CF-STATE-ABBREVIATION          PIC XX.
00518          16  CF-STATE-NAME                  PIC X(25).
00519          16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
00520          16  CF-ST-CALC-QUOTE-TOLERANCE.
00521              20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
00522              20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
00523              20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
00524              20  CF-ST-CLAIM-REJECT-SW      PIC X.
00525                  88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
00526                  88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
00527              20  CF-ST-PREM-REJECT-SW       PIC X.
00528                  88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
00529                  88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
00530              20  CF-ST-REF-REJECT-SW        PIC X.
00531                  88 ST-WARN-IF-REF-OUT          VALUE SPACE.
00532                  88 ST-FORCE-IF-REF-OUT         VALUE '1'.
00533          16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
00534          16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
00535          16  CF-ST-REFUND-RULES.
00536              20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
00537              20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
00538              20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
00539          16  CF-ST-FST-PMT-EXTENSION.
00540              20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
00541              20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
00542                  88  CF-ST-EXT-NO-CHG           VALUE ' '.
00543                  88  CF-ST-EXT-CHG-LF           VALUE '1'.
00544                  88  CF-ST-EXT-CHG-AH           VALUE '2'.
00545                  88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
00546          16  CF-ST-STATE-CALL.
00547              20  CF-ST-CALL-UNEARNED        PIC X.
00548              20  CF-ST-CALL-RPT-CNTL        PIC X.
00549              20  CF-ST-CALL-RATE-DEV        PIC XXX.
00550          16  CF-REPLACEMENT-LAW-SW          PIC X.
00551              88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
00552              88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
00553          16  CF-REPLACEMENT-LETTER          PIC X(4).
00554          16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
00555          16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
00556          16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
00557          16  CF-ST-SPLIT-PAYMENT            PIC X.
00558          16  FILLER                         PIC X.
00559          16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
00560              20  CF-ST-BENEFIT-CD           PIC XX.
00561              20  CF-ST-BENEFIT-KIND         PIC X.
00562                  88  CF-ST-LIFE-KIND            VALUE 'L'.
00563                  88  CF-ST-AH-KIND              VALUE 'A'.
00564              20  CF-ST-REM-TERM-CALC        PIC X.
00565                  88  ST-REM-TERM-NOT-USED       VALUE SPACE.
00566                  88  ST-EARN-AFTER-15TH         VALUE '1'.
00567                  88  ST-EARN-ON-HALF-MO         VALUE '2'.
00568                  88  ST-EARN-ON-1ST-DAY         VALUE '3'.
00569                  88  ST-EARN-ON-FULL-MO         VALUE '4'.
00570                  88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
00571                  88  ST-EARN-AFTER-14TH         VALUE '6'.
00572                  88  ST-EARN-AFTER-16TH         VALUE '7'.
00573
00574              20  CF-ST-REFUND-CALC          PIC X.
00575                  88  ST-REFUND-NOT-USED         VALUE SPACE.
00576                  88  ST-REFD-BY-R78             VALUE '1'.
00577                  88  ST-REFD-BY-PRO-RATA        VALUE '2'.
00578                  88  ST-REFD-AS-CALIF           VALUE '3'.
00579                  88  ST-REFD-AS-TEXAS           VALUE '4'.
00580                  88  ST-REFD-IS-NET-PAY         VALUE '5'.
00581                  88  ST-REFD-ANTICIPATION       VALUE '6'.
00582                  88  ST-REFD-UTAH               VALUE '7'.
00583                  88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
00584                  88  ST-REFD-REG-BALLOON        VALUE 'B'.
033104                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
00585
00586              20  CF-ST-EARNING-CALC         PIC X.
00587                  88  ST-EARNING-NOT-USED        VALUE SPACE.
00588                  88  ST-EARN-BY-R78             VALUE '1'.
00589                  88  ST-EARN-BY-PRO-RATA        VALUE '2'.
00590                  88  ST-EARN-AS-CALIF           VALUE '3'.
00591                  88  ST-EARN-AS-TEXAS           VALUE '4'.
00592                  88  ST-EARN-IS-NET-PAY         VALUE '5'.
00593                  88  ST-EARN-ANTICIPATION       VALUE '6'.
00594                  88  ST-EARN-MEAN               VALUE '8'.
00595                  88  ST-EARN-REG-BALLOON        VALUE 'B'.
00596
00597              20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
00598                  88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
00599                  88  ST-OVRD-BY-R78             VALUE '1'.
00600                  88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
00601                  88  ST-OVRD-AS-CALIF           VALUE '3'.
00602                  88  ST-OVRD-AS-TEXAS           VALUE '4'.
00603                  88  ST-OVRD-IS-NET-PAY         VALUE '5'.
00604                  88  ST-OVRD-ANTICIPATION       VALUE '6'.
00605                  88  ST-OVRD-MEAN               VALUE '8'.
00606                  88  ST-OVRD-REG-BALLOON        VALUE 'B'.
00607              20  FILLER                     PIC X.
00608
00609          16  CF-ST-COMMISSION-CAPS.
00610              20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
00611              20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
00612              20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
00613              20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
00614          16  CF-COMM-CAP-LIMIT-TO           PIC X.
00615                  88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
00616
00617          16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
00618
00619          16  CF-ST-STATUTORY-INTEREST.
00620              20  CF-ST-STAT-DATE-FROM       PIC X.
00621                  88  ST-STAT-FROM-INCURRED      VALUE 'I'.
00622                  88  ST-STAT-FROM-REPORTED      VALUE 'R'.
00623              20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
00624              20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
00625              20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
00626              20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
00627              20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
00628
00629          16  CF-ST-OVER-SHORT.
00630              20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
00631              20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
00632
00633          16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
00634
CIDMOD         16  CF-ST-RT-CALC                  PIC X.
CIDMOD
PEMMOD         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
PEMMOD         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
PEMMOD         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
PEMMOD         16  CF-ST-RF-LR-CALC               PIC X.
PEMMOD         16  CF-ST-RF-LL-CALC               PIC X.
PEMMOD         16  CF-ST-RF-LN-CALC               PIC X.
PEMMOD         16  CF-ST-RF-AH-CALC               PIC X.
PEMMOD         16  CF-ST-RF-CP-CALC               PIC X.
PEMMOD*        16  FILLER                         PIC X(206).
091808*CIDMOD         16  FILLER                         PIC X(192).
091808         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
091808             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
011410         16  CF-ST-REF-AH-DEATH-IND         PIC X.
061511         16  CF-ST-VFY-2ND-BENE             PIC X.
012913         16  CF-ST-CAUSAL-STATE             PIC X.
012913         16  FILLER                         PIC X(185).
00636
00637 ****************************************************************
00638 *             BENEFIT MASTER RECORD                            *
00639 ****************************************************************
00640
00641      12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
00642          16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
00643              20  CF-BENEFIT-CODE            PIC XX.
00644              20  CF-BENEFIT-NUMERIC  REDEFINES
00645                  CF-BENEFIT-CODE            PIC XX.
00646              20  CF-BENEFIT-ALPHA           PIC XXX.
00647              20  CF-BENEFIT-DESCRIP         PIC X(10).
00648              20  CF-BENEFIT-COMMENT         PIC X(10).
00649
00650              20  CF-LF-COVERAGE-TYPE        PIC X.
00651                  88  CF-REDUCING                VALUE 'R'.
00652                  88  CF-LEVEL                   VALUE 'L' 'P'.
00653
00654              20  CF-SPECIAL-CALC-CD         PIC X.
00655                  88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
00656                  88  CF-NP-0-MO-INT             VALUE 'A'.
00657                  88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
00658                  88  CF-CRITICAL-PERIOD         VALUE 'C'.
00659                  88  CF-TERM-IN-DAYS            VALUE 'D'.
00660                  88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
00661                  88  CF-FARM-PLAN               VALUE 'F'.
00662                  88  CF-RATE-AS-STANDARD        VALUE 'G'.
00663                  88  CF-2-MTH-INTEREST          VALUE 'I'.
00664                  88  CF-3-MTH-INTEREST          VALUE 'J'.
00665                  88  CF-4-MTH-INTEREST          VALUE 'K'.
00666                  88  CF-BALLOON-LAST-PMT        VALUE 'L'.
00667                  88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
00668                  88  CF-PRUDENTIAL              VALUE 'P'.
00669                  88  CF-OUTSTANDING-BAL         VALUE 'O'.
00670                  88  CF-TRUNCATED-LIFE          VALUE 'T'.
00671                  88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
00672                  88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
00673                  88  CF-NET-PAY-SIMPLE          VALUE 'S'.
00674                  88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
00675
00676              20  CF-JOINT-INDICATOR         PIC X.
00677                  88  CF-JOINT-COVERAGE          VALUE 'J'.
00678
082603*            20  FILLER                     PIC X(12).
082603             20  FILLER                     PIC X(11).
082503             20  CF-BENEFIT-CATEGORY        PIC X.
00680              20  CF-LOAN-TYPE               PIC X(8).
00681
00682              20  CF-CO-REM-TERM-CALC        PIC X.
00683                  88  CO-EARN-AFTER-15TH         VALUE '1'.
00684                  88  CO-EARN-ON-HALF-MO         VALUE '2'.
00685                  88  CO-EARN-ON-1ST-DAY         VALUE '3'.
00686                  88  CO-EARN-ON-FULL-MO         VALUE '4'.
00687                  88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
00688
00689              20  CF-CO-EARNINGS-CALC        PIC X.
00690                  88  CO-EARN-BY-R78             VALUE '1'.
00691                  88  CO-EARN-BY-PRO-RATA        VALUE '2'.
00692                  88  CO-EARN-AS-CALIF           VALUE '3'.
00693                  88  CO-EARN-AS-TEXAS           VALUE '4'.
00694                  88  CO-EARN-IS-NET-PAY         VALUE '5'.
00695                  88  CO-EARN-ANTICIPATION       VALUE '6'.
00696                  88  CO-EARN-AS-MEAN            VALUE '8'.
00697                  88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
00698
00699              20  CF-CO-REFUND-CALC          PIC X.
00700                  88  CO-REFUND-NOT-USED         VALUE SPACE.
00701                  88  CO-REFD-BY-R78             VALUE '1'.
00702                  88  CO-REFD-BY-PRO-RATA        VALUE '2'.
00703                  88  CO-REFD-AS-CALIF           VALUE '3'.
00704                  88  CO-REFD-AS-TEXAS           VALUE '4'.
00705                  88  CO-REFD-IS-NET-PAY         VALUE '5'.
00706                  88  CO-REFD-ANTICIPATION       VALUE '6'.
00707                  88  CO-REFD-MEAN               VALUE '8'.
00708                  88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
00709                  88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
033104                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
00710
00711              20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
00712                  88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
00713                  88  CO-OVRD-BY-R78             VALUE '1'.
00714                  88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
00715                  88  CO-OVRD-AS-CALIF           VALUE '3'.
00716                  88  CO-OVRD-AS-TEXAS           VALUE '4'.
00717                  88  CO-OVRD-IS-NET-PAY         VALUE '5'.
00718                  88  CO-OVRD-ANTICIPATION       VALUE '6'.
00719                  88  CO-OVRD-MEAN               VALUE '8'.
00720                  88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
00721
00722              20  CF-CO-BEN-I-G-CD           PIC X.
00723                  88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
00724                  88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
00725                  88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
00726
00727          16  FILLER                         PIC X(304).
00728
00729
00730 ****************************************************************
00731 *             CARRIER MASTER RECORD                            *
00732 ****************************************************************
00733
00734      12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
00735          16  CF-ADDRESS-DATA.
00736              20  CF-MAIL-TO-NAME            PIC X(30).
00737              20  CF-IN-CARE-OF              PIC X(30).
00738              20  CF-ADDRESS-LINE-1          PIC X(30).
00739              20  CF-ADDRESS-LINE-2          PIC X(30).
00740              20  CF-CITY-STATE              PIC X(30).
00741              20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
00742              20  CF-PHONE-NO                PIC 9(11)     COMP-3.
00743
00744          16  CF-CLAIM-NO-CONTROL.
00745              20  CF-CLAIM-NO-METHOD         PIC X.
00746                  88  CLAIM-NO-MANUAL            VALUE '1'.
00747                  88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
00748                  88  CLAIM-NO-SEQ               VALUE '3'.
00749                  88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
00750              20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
00751                  88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
00752                  88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
00753                  88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
00754
00755          16  CF-CHECK-NO-CONTROL.
00756              20  CF-CHECK-NO-METHOD         PIC X.
00757                  88  CHECK-NO-MANUAL            VALUE '1'.
00758                  88  CHECK-NO-AUTO-SEQ          VALUE '2'.
00759                  88  CHECK-NO-CARR-SEQ          VALUE '3'.
00760                  88  CHECK-NO-AT-PRINT          VALUE '4'.
00761              20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
00762                  88  CHECK-CNT-RESET-VALUE      VALUE +999999.
00763
00764          16  CF-DOMICILE-STATE              PIC XX.
00765
00766          16  CF-EXPENSE-CONTROLS.
00767              20  CF-EXPENSE-METHOD          PIC X.
00768                  88  EXPENSE-CALC-MANUAL        VALUE '1'.
00769                  88  DOLLARS-PER-PMT            VALUE '2'.
00770                  88  PERCENT-OF-PAYMENT         VALUE '3'.
00771                  88  DOLLARS-PER-MONTH          VALUE '4'.
00772              20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
00773              20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
00774
00775          16  CF-CORRESPONDENCE-CONTROL.
00776              20  CF-LETTER-RESEND-OPT       PIC X.
00777                  88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
00778                  88  LETTERS-ARE-ARCHIVED       VALUE '1'.
00779              20  FILLER                     PIC X(4).
00780
00781          16  CF-RESERVE-CONTROLS.
00782              20  CF-MANUAL-SW               PIC X.
00783                  88  CF-MANUAL-RESERVES-USED    VALUE '1'.
00784              20  CF-FUTURE-SW               PIC X.
00785                  88  CF-FUTURE-RESERVES-USED    VALUE '1'.
00786              20  CF-PTC-SW                  PIC X.
00787                  88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
00788              20  CF-IBNR-SW                 PIC X.
00789                  88  CF-IBNR-RESERVES-USED      VALUE '1'.
00790              20  CF-PTC-LF-SW               PIC X.
00791                  88  CF-LF-PTC-USED             VALUE '1'.
00792              20  CF-CDT-ACCESS-METHOD       PIC X.
00793                  88  CF-CDT-ROUND-NEAR          VALUE '1'.
00794                  88  CF-CDT-ROUND-HIGH          VALUE '2'.
00795                  88  CF-CDT-INTERPOLATED        VALUE '3'.
00796              20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
00797
00798          16  CF-CLAIM-CALC-METHOD           PIC X.
00799              88  360-PLUS-MONTHS                VALUE '1'.
00800              88  365-PLUS-MONTHS                VALUE '2'.
00801              88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
00802              88  360-DAILY                      VALUE '4'.
00803              88  365-DAILY                      VALUE '5'.
00804
00805          16  CF-LAST-ALPHA-CHARACTER        PIC X.
00806          16  FILLER                         PIC X(11).
00807
00808          16  CF-LIMIT-AMOUNTS.
00809              20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
00810              20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
00811              20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
00812              20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
00813              20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
00814              20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
00815              20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
00816              20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
00817              20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
00818              20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
00819
00820          16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
00821          16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
00822          16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
00823
00824          16  CF-ZIP-CODE.
00825              20  CF-ZIP-PRIME.
00826                  24  CF-ZIP-1ST             PIC X.
00827                      88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
00828                  24  FILLER                 PIC X(4).
00829              20  CF-ZIP-PLUS4               PIC X(4).
00830          16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
00831              20  CF-CAN-POSTAL-1            PIC XXX.
00832              20  CF-CAN-POSTAL-2            PIC XXX.
00833              20  FILLER                     PIC XXX.
00834
00835          16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
00836          16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
00837          16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
00838
00839          16  CF-RATING-SWITCH               PIC X.
00840              88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
00841              88  CF-NO-RATING                   VALUE 'N'.
00842
00843          16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
00844
00845          16  CF-CARRIER-OVER-SHORT.
00846              20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
00847              20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
00848
100703         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
100703         16  CF-SECPAY-SWITCH               PIC X.
100703             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
100703             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
092705         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
032813         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
032813         16  FILLER                         PIC X(444).
100703*        16  FILLER                         PIC X(452).
00850
00851
00852 ****************************************************************
00853 *             MORTALITY MASTER RECORD                          *
00854 ****************************************************************
00855
00856      12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
00857          16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
00858                                 INDEXED BY CF-MORT-NDX.
00859              20  CF-MORT-TABLE              PIC X(5).
00860              20  CF-MORT-TABLE-TYPE         PIC X.
00861                  88  CF-MORT-JOINT              VALUE 'J'.
00862                  88  CF-MORT-SINGLE             VALUE 'S'.
00863                  88  CF-MORT-COMBINED           VALUE 'C'.
00864                  88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
00865                  88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
00866              20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
00867              20  CF-MORT-AGE-METHOD         PIC XX.
00868                  88  CF-AGE-LAST                VALUE 'AL'.
00869                  88  CF-AGE-NEAR                VALUE 'AN'.
00870              20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
00871              20  CF-MORT-ADJUSTMENT-DIRECTION
00872                                             PIC X.
00873                  88  CF-MINUS                   VALUE '-'.
00874                  88  CF-PLUS                    VALUE '+'.
00875              20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
00876              20  CF-MORT-JOINT-CODE         PIC X.
00877                  88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
00878              20  CF-MORT-PC-Q               PIC X.
00879                  88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
00880              20  CF-MORT-TABLE-CODE         PIC X(4).
00881              20  CF-MORT-COMMENTS           PIC X(15).
00882              20  FILLER                     PIC X(14).
00883
00884          16  FILLER                         PIC X(251).
00885
00886
00887 ****************************************************************
00888 *             BUSSINESS TYPE MASTER RECORD                     *
00889 ****************************************************************
00890
00891      12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
00892 * FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
00893 * RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
00894 * AND RECORD 05 IS TYPES 81-99
00895          16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
00896              20  CF-BUSINESS-TITLE          PIC  X(19).
00897              20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
00898                                             PIC S9V9(4) COMP-3.
00899              20  CF-BUS-EXCL-ST-CALL        PIC  X.
00900              20  FILLER                     PIC  X.
00901          16  FILLER                         PIC  X(248).
00902
00903
00904 ****************************************************************
00905 *             TERMINAL MASTER RECORD                           *
00906 ****************************************************************
00907
00908      12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
00909
00910          16  CF-COMPANY-TERMINALS.
00911              20  CF-TERMINAL-ID  OCCURS 120 TIMES
00912                                   PIC X(4).
00913          16  FILLER               PIC X(248).
00914
00915
00916 ****************************************************************
00917 *             LIFE EDIT MASTER RECORD                          *
00918 ****************************************************************
00919
00920      12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
00921          16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
00922              20  CF-LIFE-CODE-IN            PIC XX.
00923              20  CF-LIFE-CODE-OUT           PIC XX.
00924          16  FILLER                         PIC X(248).
00925
00926
00927 ****************************************************************
00928 *             AH EDIT MASTER RECORD                            *
00929 ****************************************************************
00930
00931      12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
00932          16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
00933              20  CF-AH-CODE-IN              PIC XXX.
00934              20  CF-AH-CODE-OUT             PIC XX.
00935          16  FILLER                         PIC X(248).
00936
00937
00938 ****************************************************************
00939 *             CREDIBILITY TABLES                               *
00940 ****************************************************************
00941
00942      12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
00943          16  CF-CRDB-ENTRY   OCCURS 36 TIMES
00944                              INDEXED BY CF-CRDB-NDX.
00945              20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
00946              20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
00947              20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
00948          16  FILLER                         PIC  X(332).
00949
00950
00951 ****************************************************************
00952 *             REPORT CUSTOMIZATION RECORD                      *
00953 ****************************************************************
00954
00955      12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
00956          16  CF-ACCOUNT-MASTER-STATUS       PIC X.
00957              88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
00958              88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
121307             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
00959 **** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
00960 ****       A T-TRANSFER.                                   ****
00961              88  CF-ALL-ACCOUNTS                VALUE 'B'.
00962
00963          16  FILLER                         PIC XX.
00964
00965          16  CF-CARRIER-CNTL-OPT.
00966              20  CF-CARRIER-OPT-SEQ         PIC 9.
00967                  88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
00968                  88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
00969              20  CF-CARRIER-SELECT OCCURS 3 TIMES
00970                                             PIC X.
00971          16  CF-GROUP-CNTL-OPT.
00972              20  CF-GROUP-OPT-SEQ           PIC 9.
00973                  88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
00974                  88  CF-GROUP-OPT-NOT-USED      VALUE 0.
00975              20  CF-GROUP-SELECT OCCURS 3 TIMES
00976                                             PIC X(6).
00977          16  CF-STATE-CNTL-OPT.
00978              20  CF-STATE-OPT-SEQ           PIC 9.
00979                  88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
00980                  88  CF-STATE-OPT-NOT-USED      VALUE 0.
00981              20  CF-STATE-SELECT OCCURS 3 TIMES
00982                                             PIC XX.
00983          16  CF-ACCOUNT-CNTL-OPT.
00984              20  CF-ACCOUNT-OPT-SEQ         PIC 9.
00985                  88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
00986                  88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
00987              20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
00988                                             PIC X(10).
00989          16  CF-BUS-TYP-CNTL-OPT.
00990              20  CF-BUS-TYP-OPT-SEQ         PIC 9.
00991                  88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
00992                  88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
00993              20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
00994                                             PIC XX.
00995          16  CF-LF-TYP-CNTL-OPT.
00996              20  CF-LF-TYP-OPT-SEQ          PIC 9.
00997                  88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
00998                  88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
00999              20  CF-BUS-LF-SELECT OCCURS 3 TIMES
01000                                             PIC XX.
01001          16  CF-AH-TYP-CNTL-OPT.
01002              20  CF-AH-TYP-OPT-SEQ          PIC 9.
01003                  88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
01004                  88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
01005              20  CF-BUS-AH-SELECT OCCURS 3 TIMES
01006                                             PIC XX.
01007          16  CF-REPTCD1-CNTL-OPT.
01008              20  CF-REPTCD1-OPT-SEQ         PIC 9.
01009                  88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
01010                  88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
01011              20  CF-REPTCD1-SELECT OCCURS 3 TIMES
01012                                             PIC X(10).
01013          16  CF-REPTCD2-CNTL-OPT.
01014              20  CF-REPTCD2-OPT-SEQ         PIC 9.
01015                  88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
01016                  88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
01017              20  CF-REPTCD2-SELECT OCCURS 3 TIMES
01018                                             PIC X(10).
01019          16  CF-USER1-CNTL-OPT.
01020              20  CF-USER1-OPT-SEQ           PIC 9.
01021                  88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
01022                  88  CF-USER1-OPT-NOT-USED      VALUE 0.
01023              20  CF-USER1-SELECT OCCURS 3 TIMES
01024                                             PIC X(10).
01025          16  CF-USER2-CNTL-OPT.
01026              20  CF-USER2-OPT-SEQ           PIC 9.
01027                  88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
01028                  88  CF-USER2-OPT-NOT-USED      VALUE 0.
01029              20  CF-USER2-SELECT OCCURS 3 TIMES
01030                                             PIC X(10).
01031          16  CF-USER3-CNTL-OPT.
01032              20  CF-USER3-OPT-SEQ           PIC 9.
01033                  88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
01034                  88  CF-USER3-OPT-NOT-USED      VALUE 0.
01035              20  CF-USER3-SELECT OCCURS 3 TIMES
01036                                             PIC X(10).
01037          16  CF-USER4-CNTL-OPT.
01038              20  CF-USER4-OPT-SEQ           PIC 9.
01039                  88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
01040                  88  CF-USER4-OPT-NOT-USED      VALUE 0.
01041              20  CF-USER4-SELECT OCCURS 3 TIMES
01042                                             PIC X(10).
01043          16  CF-USER5-CNTL-OPT.
01044              20  CF-USER5-OPT-SEQ           PIC 9.
01045                  88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
01046                  88  CF-USER5-OPT-NOT-USED      VALUE 0.
01047              20  CF-USER5-SELECT OCCURS 3 TIMES
01048                                             PIC X(10).
01049          16  CF-REINS-CNTL-OPT.
01050              20  CF-REINS-OPT-SEQ           PIC 9.
01051                  88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
01052                  88  CF-REINS-OPT-NOT-USED      VALUE 0.
01053              20  CF-REINS-SELECT OCCURS 3 TIMES.
01054                  24  CF-REINS-PRIME         PIC XXX.
01055                  24  CF-REINS-SUB           PIC XXX.
01056
01057          16  CF-AGENT-CNTL-OPT.
01058              20  CF-AGENT-OPT-SEQ           PIC 9.
01059                  88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
01060                  88  CF-AGENT-OPT-NOT-USED      VALUE 0.
01061              20  CF-AGENT-SELECT OCCURS 3 TIMES
01062                                             PIC X(10).
01063
01064          16  FILLER                         PIC X(43).
01065
01066          16  CF-LOSS-RATIO-SELECT.
01067              20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
01068              20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
01069          16  CF-ENTRY-DATE-SELECT.
01070              20  CF-SEL-LO-ENTRY-DATE       PIC XX.
01071              20  CF-SEL-HI-ENTRY-DATE       PIC XX.
01072          16  CF-EFFECTIVE-DATE-SELECT.
01073              20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
01074              20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
01075
01076          16  CF-EXCEPTION-LIST-IND          PIC X.
01077              88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
01078
01079          16  FILLER                         PIC X(318).
01080
01081 ****************************************************************
01082 *                  EXCEPTION REPORTING RECORD                  *
01083 ****************************************************************
01084
01085      12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
01086          16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
01087              88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
01088
01089          16  CF-COMBINED-LIFE-AH-OPT.
01090              20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
01091              20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
01092              20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
01093              20  CF-CANCELLATION-RATIO      PIC S9(02).
01094
01095          16  CF-LIFE-OPT.
01096              20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
01097              20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
01098              20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
01099              20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
01100              20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
01101              20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
01102              20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
01103              20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
01104              20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
01105              20  CF-LF-AVG-AGE-MAX          PIC S9(02).
01106
01107          16  CF-AH-OPT.
01108              20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
01109              20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
01110              20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
01111              20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
01112              20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
01113              20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
01114              20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
01115              20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
01116              20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
01117              20  CF-AH-AVG-AGE-MAX          PIC S9(02).
01118
01119          16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
01120              88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
01121              88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
01122              88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
01123
01124          16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
01125
01126          16  FILLER                         PIC X(673).
01127
01128
01129 ****************************************************************
01130 *             MORTGAGE SYSTEM PLAN RECORD                      *
01131 ****************************************************************
01132
01133      12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
01134          16  CF-PLAN-TYPE                   PIC X.
01135              88  CF-LIFE-MORT-PLAN             VALUE 'L'.
01136              88  CF-DISAB-MORT-PLAN            VALUE 'D'.
01137              88  CF-AD-D-MORT-PLAN             VALUE 'A'.
01138          16  CF-PLAN-ABBREV                 PIC XXX.
01139          16  CF-PLAN-DESCRIPT               PIC X(10).
01140          16  CF-PLAN-NOTES                  PIC X(20).
01141          16  CF-PLAN-ESTABLISH-DATE         PIC XX.
01142          16  CF-PLAN-UNDERWRITING.
01143              20  CF-PLAN-TERM-DATA.
01144                  24  CF-MINIMUM-TERM        PIC S999      COMP-3.
01145                  24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
01146              20  CF-PLAN-AGE-DATA.
01147                  24  CF-MINIMUM-AGE         PIC S999      COMP-3.
01148                  24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
01149                  24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
01150              20  CF-PLAN-BENEFIT-DATA.
01151                  24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
01152                  24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
01153                  24  CF-MAXIMUM-MONTHLY-BENEFIT
01154                                             PIC S9(7)V99  COMP-3.
01155          16  CF-PLAN-POLICY-FORMS.
01156              20  CF-POLICY-FORM             PIC X(12).
01157              20  CF-MASTER-APPLICATION      PIC X(12).
01158              20  CF-MASTER-POLICY           PIC X(12).
01159          16  CF-PLAN-RATING.
01160              20  CF-RATE-CODE               PIC X(5).
01161              20  CF-SEX-RATING              PIC X.
01162                  88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
01163                  88  CF-PLAN-SEX-RATED         VALUE '2'.
01164              20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
01165              20  CF-SUB-STD-TYPE            PIC X.
01166                  88  CF-PCT-OF-PREM            VALUE '1'.
01167                  88  CF-PCT-OF-BENE            VALUE '2'.
01168          16  CF-PLAN-PREM-TOLERANCES.
01169              20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
01170              20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
01171          16  CF-PLAN-PYMT-TOLERANCES.
01172              20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
01173              20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
01174          16  CF-PLAN-MISC-DATA.
01175              20  FILLER                     PIC X.
01176              20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
01177              20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
01178          16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
01179          16  CF-PLAN-IND-GRP                PIC X.
01180              88  CF-MORT-INDIV-PLAN            VALUE 'I'
01181                                                      '1'.
01182              88  CF-MORT-GROUP-PLAN            VALUE 'G'
01183                                                      '2'.
01184          16  CF-MIB-SEARCH-SW               PIC X.
01185              88  CF-MIB-SEARCH-ALL             VALUE '1'.
01186              88  CF-MIB-SEARCH-NONE            VALUE '2'.
01187              88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
01188              88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
01189          16  CF-ALPHA-SEARCH-SW             PIC X.
01190              88  CF-MIB-ALPHA-ALL              VALUE '1'.
01191              88  CF-MIB-ALPHA-NONE             VALUE '2'.
01192              88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
01193              88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
01194              88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
01195              88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
01196              88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
01197              88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
01198              88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
01199              88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
01200                                                      'A' 'B' 'C'
01201                                                      'X' 'Y' 'Z'.
01202          16  CF-EFF-DT-RULE-SW              PIC X.
01203              88  CF-EFF-DT-ENTER               VALUE 'E'.
01204              88  CF-EFF-DT-MONTH               VALUE 'M'.
01205              88  CF-EFF-DT-QTR                 VALUE 'Q'.
01206              88  CF-EFF-DT-SEMI                VALUE 'S'.
01207              88  CF-EFF-DT-ANN                 VALUE 'A'.
01208          16  FILLER                         PIC X(4).
01209          16  CF-HEALTH-QUESTIONS            PIC X.
01210              88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
01211          16  CF-GRACE-PERIOD                PIC S999      COMP-3.
01212          16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
01213          16  CF-PLAN-SNGL-JNT               PIC X.
01214              88  CF-COMBINED-PLAN              VALUE 'C'.
01215              88  CF-JNT-PLAN                   VALUE 'J'.
01216              88  CF-SNGL-PLAN                  VALUE 'S'.
01217          16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
01218          16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
01219          16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
01220          16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
01221          16  CF-RERATE-CNTL                 PIC  X.
01222              88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
01223              88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
01224              88  CF-DO-NOT-RERATE               VALUE '3' ' '.
01225              88  CF-AUTO-RECALC                 VALUE '4'.
01226          16  CF-BENEFIT-TYPE                PIC  X.
01227              88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
01228              88  CF-BENEFIT-REDUCES             VALUE '2'.
01229          16  CF-POLICY-FEE                  PIC S999V99
01230                                                     COMP-3.
01231          16  CF-1ST-NOTICE-FORM             PIC  X(04).
01232          16  CF-2ND-NOTICE-FORM             PIC  X(04).
01233          16  CF-3RD-NOTICE-FORM             PIC  X(04).
01234          16  CF-4TH-NOTICE-FORM             PIC  X(04).
01235          16  FILLER                         PIC  X(32).
01236          16  CF-TERMINATION-FORM            PIC  X(04).
01237          16  FILLER                         PIC  X(08).
01238          16  CF-CLAIM-CAP                   PIC S9(7)V99
01239                                                        COMP-3.
01240          16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
01241          16  CF-ISSUE-LETTER                PIC  X(4).
01242          16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
01243          16  CF-DEPENDENT-COVERAGE          PIC  X.
01244              88  CF-YES-DEP-COV                 VALUE 'Y'.
01245              88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
01246          16  CF-MP-REFUND-CALC              PIC X.
01247              88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
01248              88  CF-MP-REFD-BY-R78              VALUE '1'.
01249              88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
01250              88  CF-MP-REFD-AS-CALIF            VALUE '3'.
01251              88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
01252              88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
01253              88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
01254              88  CF-MP-REFD-MEAN                VALUE '8'.
01255          16  CF-ALT-RATE-CODE               PIC  X(5).
01256
01257
01258          16  FILLER                         PIC X(498).
01259 ****************************************************************
01260 *             MORTGAGE COMPANY MASTER RECORD                   *
01261 ****************************************************************
01262
01263      12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
01264          16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
01265          16  CF-MORTG-ACCESS-CONTROL        PIC X.
01266              88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
01267              88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
01268              88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
01269              88  CF-MORT-PROD-CNTL                   VALUE '3'.
01270              88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
01271
01272          16  CF-MORTG-CONVERSION-DATE       PIC XX.
01273          16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
01274          16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
01275          16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
01276          16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
01277
01278          16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
01279              88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
01280          16  CF-MP-RECON-USE-IND            PIC X(1).
01281              88  CF-MP-USE-RECON             VALUE 'Y'.
01282          16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
01283              88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
01284          16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
01285              88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
01286              88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
01287          16  FILLER                         PIC X(1).
01288          16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
01289              88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
01290          16  CF-MORTG-MIB-VERSION           PIC X.
01291              88  CF-MORTG-MIB-BATCH         VALUE '1'.
01292              88  CF-MORTG-MIB-ONLINE        VALUE '2'.
01293              88  CF-MORTG-MIB-BOTH          VALUE '3'.
01294          16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
01295              20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
01296                  88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
01297              20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
01298                  88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
01299              20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
01300                  88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
01301              20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
01302                  88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
01303              20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
01304                  88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
01305              20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
01306                  88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
01307          16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
01308          16  FILLER                         PIC X(7).
01309          16  CF-MORTG-DESTINATION-SYMBOL.
01310              20  CF-MORTG-MIB-COMM          PIC X(5).
01311              20  CF-MORTG-MIB-TERM          PIC X(5).
01312          16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
01313              88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
01314          16  FILLER                         PIC X(03).
01315          16  CF-MP-CHECK-NO-CONTROL.
01316              20  CF-MP-CHECK-NO-METHOD      PIC X(01).
01317                  88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
01318                  88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
01319                                                 ' ' LOW-VALUES.
01320                  88  CF-MP-CHECK-NO-PRE-PRINTED
01321                                                VALUE '3'.
01322          16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
01323          16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
01324          16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
01325              20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
01326                  88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
01327              20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
01328                  88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
01329              20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
01330                  88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
01331              20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
01332                  88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
01333              20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
01334                  88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
01335              20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
01336                  88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
01337          16  CF-MORTG-BILLING-AREA.
01338              20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
01339                                             PIC X.
01340          16  CF-MORTG-MONTH-END-DT          PIC XX.
01341          16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
01342          16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
01343          16  CF-MORTG-MIB-DEST-SW           PIC X.
01344              88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
01345              88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
01346          16  FILLER                         PIC X.
01347          16  CF-MORTG-LABEL-CONTROL         PIC X.
01348              88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
01349              88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
01350          16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
01351          16  FILLER                         PIC X(8).
01352          16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
01353          16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
01354          16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
01355          16  CF-ACH-COMPANY-ID.
01356              20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
01357                  88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
01358                  88  CF-ACH-ICD-DUNS                VALUE '3'.
01359                  88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
01360              20  CF-ACH-COMPANY-ID-NO       PIC X(9).
01361          16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
01362              88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
01363          16  CF-RATE-DEV-AUTHORIZATION      PIC X.
01364              88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
01365              88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
01366          16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
01367          16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
01368          16  FILLER                         PIC X(536).
01369
01370 ****************************************************************
01371 *             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
01372 ****************************************************************
01373
01374      12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
01375          16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
01376              20  CF-FEMALE-HEIGHT.
01377                  24  CF-FEMALE-FT           PIC 99.
01378                  24  CF-FEMALE-IN           PIC 99.
01379              20  CF-FEMALE-MIN-WT           PIC 999.
01380              20  CF-FEMALE-MAX-WT           PIC 999.
01381          16  FILLER                         PIC X(428).
01382
01383      12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
01384          16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
01385              20  CF-MALE-HEIGHT.
01386                  24  CF-MALE-FT             PIC 99.
01387                  24  CF-MALE-IN             PIC 99.
01388              20  CF-MALE-MIN-WT             PIC 999.
01389              20  CF-MALE-MAX-WT             PIC 999.
01390          16  FILLER                         PIC X(428).
01391 ******************************************************************
01392 *             AUTOMATIC ACTIVITY RECORD                          *
01393 ******************************************************************
01394      12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
01395          16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
01396              20  CF-SYS-ACTIVE-SW           PIC X(01).
01397              20  CF-SYS-LETTER-ID           PIC X(04).
01398              20  CF-SYS-RESEND-DAYS         PIC 9(03).
01399              20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
01400              20  CF-SYS-RESET-SW            PIC X(01).
01401              20  CF-SYS-REPORT-DAYS         PIC 9(03).
01402              20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
01403
01404          16  FILLER                         PIC X(50).
01405
01406          16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
01407              20  CF-USER-ACTIVE-SW          PIC X(01).
01408              20  CF-USER-LETTER-ID          PIC X(04).
01409              20  CF-USER-RESEND-DAYS        PIC 9(03).
01410              20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
01411              20  CF-USER-RESET-SW           PIC X(01).
01412              20  CF-USER-REPORT-DAYS        PIC 9(03).
01413              20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
01414              20  CF-USER-ACTIVITY-DESC      PIC X(20).
01415
01416          16  FILLER                         PIC X(246).
00307      EJECT
00308 *    COPY ERCACCT.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCACCT                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.031                          *
00006 *                                                                *
00007 *   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
00008 *                                                                *
00009 *   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
00010 *   VSAM ACCOUNT MASTER FILES.                                   *
00011 *                                                                *
00012 *   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
00013 *                                                                *
00014 *   FILE TYPE = VSAM,KSDS                                        *
00015 *   RECORD SIZE = 2000  RECFORM = FIX                            *
00016 *                                                                *
00017 *   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
00018 *       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
00019 *                                                                *
00020 *   LOG = NO                                                     *
00021 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00022 *                                                                *
00023 *                                                                *
00024 ******************************************************************
102004*                   C H A N G E   L O G
102004*
102004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
102004*-----------------------------------------------------------------
102004*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
102004* EFFECTIVE    NUMBER
102004*-----------------------------------------------------------------
102004* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
092705* 092705    2005050300006  PEMA  ADD SPP LEASES
022808* 022808    2007083100002  PEMA  ADD FREEZE STATUS
011410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
030211* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
031811* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
101711* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
102004******************************************************************
00025
00026  01  ACCOUNT-MASTER.
00027      12  AM-RECORD-ID                      PIC XX.
00028          88  VALID-AM-ID                      VALUE 'AM'.
00029
00030      12  AM-CONTROL-PRIMARY.
00031          16  AM-COMPANY-CD                 PIC X.
00032          16  AM-MSTR-CNTRL.
00033              20  AM-CONTROL-A.
00034                  24  AM-CARRIER            PIC X.
00035                  24  AM-GROUPING.
00036                      28 AM-GROUPING-PREFIX PIC XXX.
00037                      28 AM-GROUPING-PRIME  PIC XXX.
00038                  24  AM-STATE              PIC XX.
00039                  24  AM-ACCOUNT.
00040                      28  AM-ACCOUNT-PREFIX PIC X(4).
00041                      28  AM-ACCOUNT-PRIME  PIC X(6).
00042              20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
00043                                            PIC X(19).
00044              20  AM-CNTRL-B.
00045                  24  AM-EXPIRATION-DT      PIC XX.
00046                  24  FILLER                PIC X(4).
00047              20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
00048                  24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
00049
00050      12  AM-CONTROL-BY-VAR-GRP.
00051          16  AM-COMPANY-CD-A1              PIC X.
00052          16  AM-VG-CARRIER                 PIC X.
00053          16  AM-VG-GROUPING                PIC X(6).
00054          16  AM-VG-STATE                   PIC XX.
00055          16  AM-VG-ACCOUNT                 PIC X(10).
00056          16  AM-VG-DATE.
00057              20  AM-VG-EXPIRATION-DT       PIC XX.
00058              20  FILLER                    PIC X(4).
00059          16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
00060                                            PIC 9(11)      COMP-3.
030211     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
030211         16  FILLER                        PIC X(10).
030211         16  AM-VG-KEY3.
030211             20  AM-VG3-ACCOUNT            PIC X(10).
030211             20  AM-VG3-EXP-DT             PIC XX.
030211         16  FILLER                        PIC X(4).
00061      12  AM-MAINT-INFORMATION.
00062          16  AM-LAST-MAINT-DT              PIC XX.
00063          16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
00064          16  AM-LAST-MAINT-USER            PIC X(4).
00065          16  FILLER                        PIC XX.
00066
00067      12  AM-EFFECTIVE-DT                   PIC XX.
00068      12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
00069
00070      12  AM-PREV-DATES  COMP-3.
00071          16  AM-PREV-EXP-DT                PIC 9(11).
00072          16  AM-PREV-EFF-DT                PIC 9(11).
00073
00074      12  AM-REPORT-CODE-1                  PIC X(10).
00075      12  AM-REPORT-CODE-2                  PIC X(10).
00076
00077      12  AM-CITY-CODE                      PIC X(4).
00078      12  AM-COUNTY-PARISH                  PIC X(6).
00079
00080      12  AM-NAME                           PIC X(30).
00081      12  AM-PERSON                         PIC X(30).
00082      12  AM-ADDRS                          PIC X(30).
00083      12  AM-CITY.
               16  AM-ADDR-CITY                  PIC X(28).
               16  AM-ADDR-STATE                 PIC XX.
00084      12  AM-ZIP.
00085          16  AM-ZIP-PRIME.
00086              20  AM-ZIP-PRI-1ST            PIC X.
00087                  88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
00088              20  FILLER                    PIC X(4).
00089          16  AM-ZIP-PLUS4                  PIC X(4).
00090      12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
00091          16  AM-CAN-POSTAL-1               PIC XXX.
00092          16  AM-CAN-POSTAL-2               PIC XXX.
00093          16  FILLER                        PIC XXX.
00094      12  AM-TEL-NO.
00095          16  AM-AREA-CODE                  PIC 999.
00096          16  AM-TEL-PRE                    PIC 999.
00097          16  AM-TEL-NBR                    PIC 9(4).
00098      12  AM-TEL-LOC                        PIC X.
00099          88  AM-TEL-AT-HOME                   VALUE 'H'.
00100          88  AM-TEL-AT-BUSINESS               VALUE 'B'.
00101
00102      12  AM-COMM-STRUCTURE.
00103          16  AM-DEFN-1.
00104              20  AM-AGT-COMMS       OCCURS 10 TIMES.
00105                  24  AM-AGT.
00106                      28  AM-AGT-PREFIX     PIC X(4).
00107                      28  AM-AGT-PRIME      PIC X(6).
00108                  24  AM-COM-TYP            PIC X.
00109                  24  AM-L-COM              PIC SV9(5)     COMP-3.
00110                  24  AM-J-COM              PIC SV9(5)     COMP-3.
00111                  24  AM-A-COM              PIC SV9(5)     COMP-3.
00112                  24  AM-RECALC-LV-INDIC    PIC X.
00113                  24  AM-RETRO-LV-INDIC     PIC X.
00114                  24  AM-GL-CODES           PIC X.
00115                  24  AM-COMM-CHARGEBACK    PIC 9(02).
00116                  24  FILLER                PIC X(01).
00117          16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
00118              20  AM-COM-TBLS        OCCURS 10 TIMES.
00119                  24  FILLER                PIC X(11).
00120                  24  AM-L-COMA             PIC XXX.
00121                  24  AM-J-COMA             PIC XXX.
00122                  24  AM-A-COMA             PIC XXX.
00123                  24  FILLER                PIC X(6).
00124
00125      12  AM-COMM-CHANGE-STATUS             PIC X.
00126          88  AM-COMMISSIONS-CHANGED           VALUE '*'.
00127
00128      12  AM-CSR-CODE                       PIC X(4).
00129
00130      12  AM-BILLING-STATUS                 PIC X.
00131          88  AM-ACCOUNT-BILLED                VALUE 'B'.
00132          88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
00133      12  AM-AUTO-REFUND-SW                 PIC X.
00134          88  AUTO-REFUNDS-USED                VALUE 'Y'.
00135          88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
00136      12  AM-GPCD                           PIC 99.
00137      12  AM-IG                             PIC X.
00138          88  AM-HAS-INDIVIDUAL                VALUE '1'.
00139          88  AM-HAS-GROUP                     VALUE '2'.
00140      12  AM-STATUS                         PIC X.
00141          88  AM-ACCOUNT-ACTIVE                VALUE '0'.
00142          88  AM-ACCOUNT-INACTIVE              VALUE '1'.
00143          88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
102004         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
022808         88  AM-ACCOUNT-FROZEN                VALUE '4'.
031811         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
00144      12  AM-REMIT-TO                       PIC 99.
00145      12  AM-ID-NO                          PIC X(11).
00146
00147      12  AM-CAL-TABLE                      PIC XX.
00148      12  AM-LF-DEVIATION                   PIC XXX.
00149      12  AM-AH-DEVIATION                   PIC XXX.
00150      12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
00151      12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
00152      12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
00153      12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
00154      12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
00155      12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
00156
00157      12  AM-USER-FIELDS.
00158          16  AM-FLD-1                      PIC XX.
00159          16  AM-FLD-2                      PIC XX.
00160          16  AM-FLD-3                      PIC XX.
00161          16  AM-FLD-4                      PIC XX.
00162          16  AM-FLD-5                      PIC XX.
00163
00164      12  AM-1ST-PROD-DATE.
00165          16  AM-1ST-PROD-YR                PIC XX.
00166          16  AM-1ST-PROD-MO                PIC XX.
00167          16  AM-1ST-PROD-DA                PIC XX.
00168      12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
00169      12  AM-CERTS-PURGED-DATE.
00170          16  AM-PUR-YR                     PIC XX.
00171          16  AM-PUR-MO                     PIC XX.
00172          16  AM-PUR-DA                     PIC XX.
00173      12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
00174      12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
00175      12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
00176      12  AM-INACTIVE-DATE.
00177          16  AM-INA-MO                     PIC 99.
00178          16  AM-INA-DA                     PIC 99.
00179          16  AM-INA-YR                     PIC 99.
00180      12  AM-AR-HI-CERT-DATE                PIC XX.
00181
00182      12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
00183      12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
00184
00185      12  AM-OB-PAYMENT-MODE                PIC X.
00186          88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
00187          88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
00188          88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
00189          88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
00190
00191      12  AM-AH-ONLY-INDICATOR              PIC X.
00192          88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
00193          88  AM-NO-AH-ONLY                    VALUE 'N'.
00194
00195      12  AM-EDIT-LOAN-OFC                  PIC X(01).
00196
00197      12  AM-OVER-SHORT.
00198          16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
00199          16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
00200
011410     12  AM-DCC-PRODUCT-CODE               PIC XXX.
041910     12  AM-DCC-CLP-STATE                  PIC XX.
00202
00203      12  AM-RECALC-COMM                    PIC X.
00204      12  AM-RECALC-REIN                    PIC X.
00205
00206      12  AM-REI-TABLE                      PIC XXX.
00207      12  AM-REI-ET-LF                      PIC X.
00208      12  AM-REI-ET-AH                      PIC X.
00209      12  AM-REI-PE-LF                      PIC X.
00210      12  AM-REI-PE-AH                      PIC X.
00211      12  AM-REI-PRT-ST                     PIC X.
00212      12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
00213      12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
00214      12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
00215      12  AM-REI-GROUP-A                    PIC X(6).
00216      12  AM-REI-MORT                       PIC X(4).
00217      12  AM-REI-PRT-OW                     PIC X.
00218      12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
00219      12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
00220      12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
00221      12  AM-REI-GROUP-B                    PIC X(6).
00222
00223      12  AM-TRUST-TYPE                     PIC X(2).
00224
00225      12  AM-EMPLOYER-STMT-USED             PIC X.
00226      12  AM-GROUPED-CHECKS-Y-N             PIC X.
00227
00228      12  AM-STD-AH-TYPE                    PIC XX.
00229      12  AM-EARN-METHODS.
00230          16  AM-EARN-METHOD-R              PIC X.
00231              88 AM-REF-RL-R78                 VALUE 'R'.
00232              88 AM-REF-RL-PR                  VALUE 'P'.
00233              88 AM-REF-RL-MEAN                VALUE 'M'.
00234              88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
00235          16  AM-EARN-METHOD-L              PIC X.
00236              88 AM-REF-LL-R78                 VALUE 'R'.
00237              88 AM-REF-LL-PR                  VALUE 'P'.
00238              88 AM-REF-LL-MEAN                VALUE 'M'.
00239              88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
00240          16  AM-EARN-METHOD-A              PIC X.
00241              88 AM-REF-AH-R78                 VALUE 'R'.
00242              88 AM-REF-AH-PR                  VALUE 'P'.
00243              88 AM-REF-AH-MEAN                VALUE 'M'.
00244              88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
00245              88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
00246              88 AM-REF-AH-NET                 VALUE 'N'.
00247
00248      12  AM-TOL-PREM                       PIC S999V99    COMP-3.
00249      12  AM-TOL-REF                        PIC S999V99    COMP-3.
00250      12  AM-TOL-CLM                        PIC S999V99    COMP-3.
00251
00252      12  AM-RET-Y-N                        PIC X.
00253      12  AM-RET-P-E                        PIC X.
00254      12  AM-LF-RET                         PIC S9V9999    COMP-3.
00255      12  AM-AH-RET                         PIC S9V9999    COMP-3.
00256      12  AM-RET-GRP                        PIC X(6).
00257      12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
00258          16  AM-POOL-PRIME                 PIC XXX.
00259          16  AM-POOL-SUB                   PIC XXX.
00260      12  AM-RETRO-EARNINGS.
00261          16  AM-RET-EARN-R                 PIC X.
00262          16  AM-RET-EARN-L                 PIC X.
00263          16  AM-RET-EARN-A                 PIC X.
00264      12  AM-RET-ST-TAX-USE                 PIC X.
00265          88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
00266          88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
00267      12  AM-RETRO-BEG-EARNINGS.
00268          16  AM-RET-BEG-EARN-R             PIC X.
00269          16  AM-RET-BEG-EARN-L             PIC X.
00270          16  AM-RET-BEG-EARN-A             PIC X.
00271      12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
00272      12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
00273
00274      12  AM-USER-SELECT-OPTIONS.
00275          16  AM-USER-SELECT-1              PIC X(10).
00276          16  AM-USER-SELECT-2              PIC X(10).
00277          16  AM-USER-SELECT-3              PIC X(10).
00278          16  AM-USER-SELECT-4              PIC X(10).
00279          16  AM-USER-SELECT-5              PIC X(10).
00280
00281      12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
00282
00283      12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
00284
00285      12  AM-RPT045A-SWITCH                 PIC X.
00286          88  RPT045A-OFF                   VALUE 'N'.
00287
00288      12  AM-INSURANCE-LIMITS.
00289          16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
00290          16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
00291
00292      12  AM-PROFILE-CHANGE-SWITCH          PIC X.
00293          88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
00294
00295      12  AM-DISMBR-COVERAGE-SW             PIC X.
00296          88  AM-DISMBR-COVERAGE               VALUE 'Y'.
00297          88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
00298
00299      12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
00300
00301      12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
090803     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
092705     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
           12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
           12  AM-DCC-UEF-STATE                  PIC XX.
           12  FILLER                            PIC XXX.
120406     12  AM-REPORT-CODE-3                  PIC X(10).
090803*    12  FILLER                            PIC X(22).
00303
00304      12  AM-RESERVE-DATE.
00305          16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
00306          16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
00307          16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
00308
00309      12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
00310      12  AM-NOTIFICATION-TYPES.
00311          16  AM-NOTIF-OF-LETTERS           PIC X.
00312          16  AM-NOTIF-OF-PAYMENTS          PIC X.
00313          16  AM-NOTIF-OF-REPORTS           PIC X.
00314          16  AM-NOTIF-OF-STATUS            PIC X.
00315
00316      12  AM-BENEFIT-TABLE-USAGE            PIC X.
00317          88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
00318          88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
00319          88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
00320          88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
00321
00322      12  AM-BENEFIT-CONTROLS.
00323          16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
00324              20  AM-BENEFIT-CODE           PIC XX.
00325              20  AM-BENEFIT-TYPE           PIC X.
00326              20  AM-BENEFIT-REVISION       PIC XXX.
00327              20  AM-BENEFIT-REM-TERM       PIC X.
00328              20  AM-BENEFIT-RETRO-Y-N      PIC X.
00329              20  FILLER                    PIC XX.
00330          16  FILLER                        PIC X(80).
00331
00332      12  AM-TRANSFER-DATA.
00333          16  AM-TRANSFERRED-FROM.
00334              20  AM-TRNFROM-CARRIER        PIC X.
00335              20  AM-TRNFROM-GROUPING.
00336                  24  AM-TRNFROM-GRP-PREFIX PIC XXX.
00337                  24  AM-TRNFROM-GRP-PRIME  PIC XXX.
00338              20  AM-TRNFROM-STATE          PIC XX.
00339              20  AM-TRNFROM-ACCOUNT.
00340                  24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
00341                  24  AM-TRNFROM-ACCT-PRIME PIC X(6).
00342              20  AM-TRNFROM-DTE            PIC XX.
00343          16  AM-TRANSFERRED-TO.
00344              20  AM-TRNTO-CARRIER          PIC X.
00345              20  AM-TRNTO-GROUPING.
00346                  24  AM-TRNTO-GRP-PREFIX   PIC XXX.
00347                  24  AM-TRNTO-GRP-PRIME    PIC XXX.
00348              20  AM-TRNTO-STATE            PIC XX.
00349              20  AM-TRNTO-ACCOUNT.
00350                  24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
00351                  24  AM-TRNTO-ACCT-PRIME   PIC X(6).
00352              20  AM-TRNTO-DTE              PIC XX.
00353          16  FILLER                        PIC X(10).
00354
00355      12  AM-SAVED-REMIT-TO                 PIC 99.
00356
00357      12  AM-COMM-STRUCTURE-SAVED.
00358          16  AM-DEFN-1-SAVED.
00359              20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
00360                  24  AM-AGT-SV             PIC X(10).
00361                  24  AM-COM-TYP-SV         PIC X.
00362                  24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
00363                  24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
00364                  24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
00365                  24  AM-RECALC-LV-INDIC-SV PIC X.
00366                  24  FILLER                PIC X.
00367                  24  AM-GL-CODES-SV        PIC X.
00368                  24  AM-COM-CHARGEBACK-SV  PIC 99.
00369                  24  FILLER                PIC X.
00370          16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
00371              20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
00372                  24  FILLER                PIC X(11).
00373                  24  AM-L-COMA-SV          PIC XXX.
00374                  24  AM-J-COMA-SV          PIC XXX.
00375                  24  AM-A-COMA-SV          PIC XXX.
00376                  24  FILLER                PIC X(6).
00377
00378      12  AM-FLC-NET-PREMIUM-ALLOWANCE.
00379          16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
00380             20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
00381             20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
00382             20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
00383
122806     12  AM-ORIG-DEALER-NO                 PIC X(10).
122806     12  FILLER                            PIC X(120).
00385
00386      12  AM-ACCOUNT-EXECUTIVE-DATA.
00387          16  AM-CONTROL-NAME               PIC X(30).
00388          16  AM-EXECUTIVE-ONE.
00389              20  AM-EXEC1-NAME             PIC X(15).
00390              20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
00391                                                           COMP-3.
00392              20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
00393                                                           COMP-3.
00394          16  AM-EXECUTIVE-TWO.
00395              20  AM-EXEC2-NAME             PIC X(15).
00396              20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
00397                                                           COMP-3.
00398              20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
00399                                                           COMP-3.
00400
00401      12  AM-RETRO-ADDITIONAL-DATA.
00402          16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
00403          16  AM-RETRO-PREM-P-E             PIC X.
00404          16  AM-RETRO-CLMS-P-I             PIC X.
00405          16  AM-RETRO-RET-BRACKET-LF.
00406              20  AM-RETRO-RET-METHOD-LF    PIC X.
00407                  88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
00408                  88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
00409              20  AM-RETRO-RET-BASIS-LF     PIC X.
00410                  88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
00411                  88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
00412              20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
00413                  24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
00414                  24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
00415          16  AM-RETRO-RET-BRACKET-AH.
00416              20  AM-RETRO-RET-METHOD-AH    PIC X.
00417                  88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
00418                  88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
00419                  88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
00420              20  AM-RETRO-RET-BASIS-AH     PIC X.
00421                  88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
00422                  88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
00423              20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
00424                  24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
00425                  24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
00426
00427      12  AM-COMMENTS.
00428          16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
00429
00430      12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
00431          16  AM-FLI-RETRO-SHARE-CODE       PIC X.
00432          16  AM-FLI-BILLING-CODE           PIC X.
00433          16  AM-FLI-ALT-STATE-CODE         PIC XX.
00434          16  AM-FLI-UNITED-IDENT           PIC X.
00435          16  AM-FLI-INTEREST-LOST-DATA.
00436              20  AM-FLI-BANK-NO            PIC X(5).
00437              20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
00438              20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
00439              20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
00440          16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
00441              20  AM-FLI-AGT                PIC X(9).
00442              20  AM-FLI-AGT-COMM-ACC       PIC X.
00443              20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
00444          16  FILLER                        PIC X(102).
00445
00446      12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
00447          16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
00448              20  AM-BENEFIT-DMD-CODE         PIC XX.
00449              20  AM-BENEFIT-DMD-TYPE         PIC X.
00450              20  AM-BENEFIT-DMD-REVISION     PIC XXX.
00451              20  AM-BENEFIT-DMD-REM-TERM     PIC X.
00452              20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
00453          16  FILLER                          PIC X(10).
00454 ******************************************************************
00309      EJECT
00310 *    COPY ERCREIN.
00001 ******************************************************************
00002 *                                                                *
00003 *                            ERCREIN                             *
00003 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00004 *                            VMOD=2.010                          *
00005 *                                                                *
00006 *   ONLINE CREDIT SYSTEM                                         *
00007 *                                                                *
00008 *   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
00009 *                                                                *
00010 *   FILE TYPE = VSAM,KSDS                                        *
00011 *   RECORD SIZE = 4000  RECFORM = FIXED                          *
00012 *                                                                *
00013 *   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
00014 *       ALTERNATE PATH = NONE                                    *
00015 *                                                                *
00016 *   LOG = NO                                                     *
00017 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00018 *                                                                *
00019 ******************************************************************
103101*                   C H A N G E   L O G
103101*
103101* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
103101*-----------------------------------------------------------------
103101*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
103101* EFFECTIVE    NUMBER
103101*-----------------------------------------------------------------
103101* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
032707* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
103101******************************************************************
00021  01  REINSURANCE-RECORD.
00022      12  RE-RECORD-ID                      PIC XX.
00023          88  VALID-RE-ID                      VALUE 'RE'.
00024
00025      12  RE-CONTROL-PRIMARY.
00026          16  RE-COMPANY-CD                 PIC X.
00027          16  RE-KEY.
00028              20  RE-CODE                   PIC X.
00029                  88  RE-TABLE-RECORD          VALUE 'A'.
00030                  88  RE-COMPANY-RECORD        VALUE 'B'.
00031              20  RE-TABLE                  PIC XXX.
00032              20  FILLER                    PIC XXX.
00033          16  RE-COMPANY-KEY REDEFINES RE-KEY.
00034              20  FILLER                    PIC X.
00035              20  RE-COMPANY.
00036                  24  RE-COMP-PRIME         PIC XXX.
00037                  24  RE-COMP-SUB           PIC XXX.
00038
00039      12  RE-MAINT-INFORMATION.
00040          16  RE-LAST-MAINT-DT              PIC XX.
00041          16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
00042          16  RE-LAST-MAINT-USER            PIC X(4).
00043          16  FILLER                        PIC X(10).
00044
00045      12  RE-TABLE-DATA.
00046          16  RE-100-COMP                   PIC 99.
00047
00048          16  RE-COMP-INFO    OCCURS 30 TIMES.
00049              20  RE-REI-COMP-NO.
00050                  24  RE-REI-COMP           PIC XXX.
00051                  24  RE-REI-COMP-SUB       PIC XXX.
00052              20  RE-LF-QC                  PIC X.
00053              20  RE-AH-QC                  PIC X.
00054              20  RE-LO-DATE                PIC 9(11)     COMP-3.
00055              20  RE-HI-DATE                PIC 9(11)     COMP-3.
00056              20  RE-LFAGE-LO               PIC 99.
00057              20  RE-LFAGE-HI               PIC 99.
00058              20  RE-AHAGE-LO               PIC 99.
00059              20  RE-AHAGE-HI               PIC 99.
00060              20  RE-LFTRM-LO               PIC S999       COMP-3.
00061              20  RE-LFTRM-HI               PIC S999       COMP-3.
00062              20  RE-AHTRM-LO               PIC S999       COMP-3.
00063              20  RE-AHTRM-HI               PIC S999       COMP-3.
00064              20  RE-LF-PCT                 PIC S9V9999    COMP-3.
00065              20  RE-AH-PCT                 PIC S9V9999    COMP-3.
00066              20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
00067              20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
00068              20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
00069              20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
00070              20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
00071              20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
00072              20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
00073              20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
00074              20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
00075              20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
00076              20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
00077              20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
00078              20  RE-LF-BEN-CODE            PIC X.
00079              20  RE-AH-BEN-CODE            PIC X.
00080              20  RE-INTERACTIVE            PIC X.
00081              20  RE-REMAINING              PIC X.
CIDMOD             20  RE-LF-RUNOFF-SW           PIC X.
CIDMOD             20  RE-AH-RUNOFF-SW           PIC X.
CIDMOD             20  FILLER                    PIC X(19).
00083
00084          16  RE-COMP-INFO-END              PIC X(6).
00085          16  RE-NSP-ST-CD-LF               PIC XX.
00086          16  RE-NSP-ST-CD-AH               PIC XX.
00087          16  RE-TABLE-CARRIER-SECURITY     PIC X.
00088              88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
00089
00090          16  FILLER                        PIC X(27).
00091
00092      12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
00093          16  RE-NAME                       PIC X(30).
00094          16  RE-LF-PE                      PIC X.
00095          16  RE-AH-PE                      PIC X.
00096          16  RE-LF-FEE                     PIC S9V9999    COMP-3.
00097          16  RE-AH-FEE                     PIC S9V9999    COMP-3.
00098          16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
00099          16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
00100          16  RE-PRT-ST                     PIC X.
00101          16  RE-PRT-OW                     PIC X.
00102          16  RE-MORT-CODE                  PIC X(4).
00103          16  RE-CLAIM-CODE                 PIC X.
00104          16  RE-ZERO-LF-FEE                PIC X.
00105          16  RE-ZERO-AH-FEE                PIC X.
00106          16  RE-CEDE-NAME                  PIC X(30).
00107          16  RE-LF-COMM                    PIC X.
00108          16  RE-AH-COMM                    PIC X.
00109          16  RE-LF-TAX                     PIC X.
00110          16  RE-AH-TAX                     PIC X.
00111          16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
00116          16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
00117          16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
00118
00119          16  RE-COMP-CARRIER-SECURITY      PIC X.
00120              88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
00121
00122          16  RE-LF-CEDING-FEE-BRACKETS.
00123              20  RE-LF-FEE-METHOD          PIC X.
00124                  88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
00125                  88  RE-LF-FEE-METHOD-1          VALUE '1'.
00126                  88  RE-LF-FEE-METHOD-2          VALUE '2'.
00127                  88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
00128              20  RE-LF-FEE-BASIS           PIC X.
00129                  88  RE-LF-GROSS-CEDED             VALUE '1'.
00130                  88  RE-LF-NET-CEDED               VALUE '2'.
00131                  88  RE-LF-GROSS-WRITTEN           VALUE '3'.
00132                  88  RE-LF-NET-WRITTEN             VALUE '4'.
00133                  88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
00134                  88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
00135                  88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
00136                  88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
00137              20  FILLER                    PIC XXX.
00138              20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
00139                  24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
00140                  24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
00141
00142          16  RE-AH-CEDING-FEE-BRACKETS.
00143              20  RE-AH-FEE-METHOD          PIC X.
00144                  88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
00145                  88  RE-AH-FEE-METHOD-1          VALUE '1'.
00146                  88  RE-AH-FEE-METHOD-2          VALUE '2'.
00147                  88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
00148              20  RE-AH-FEE-BASIS           PIC X.
00149                  88  RE-AH-GROSS-CEDED             VALUE '1'.
00150                  88  RE-AH-NET-CEDED               VALUE '2'.
00151                  88  RE-AH-GROSS-WRITTEN           VALUE '3'.
00152                  88  RE-AH-NET-WRITTEN             VALUE '4'.
00153                  88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
00154                  88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
00155                  88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
00156                  88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
00157              20  FILLER                    PIC XXX.
00158              20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
00159                  24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
00160                  24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
00161
00162          16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
00166
00167          16  RE-OLD-CEDING-STMT            PIC X.
00168
00169          16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
00170          16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
00171          16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
00172          16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
00173          16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
00174          16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
00175          16  RE-REINS-GROUPING-CODE        PIC X(6).
00176          16  RE-MORT-SW                    PIC X.
00177          16  RE-CEDING-TYPE-FLAG           PIC X.
00178              88  RE-NO-CESSION-TYPE                VALUE ' '.
00179              88  RE-CEDED                          VALUE 'C'.
00180              88  RE-ASSUMED                        VALUE 'A'.
00181              88  RE-PHANTOM                        VALUE 'P'.
00182
00183          16  RE-CEDING-STMT-OPT-A          PIC X.
00184              88  REPORT-A-WANTED    VALUE ' ' 'Y'.
00185          16  RE-CEDING-STMT-OPT-B          PIC X.
00186              88  REPORT-B-WANTED    VALUE ' ' 'Y'.
00187          16  RE-CEDING-STMT-OPT-C          PIC X.
00188              88  REPORT-C-WANTED    VALUE ' ' 'Y'.
00189          16  RE-CEDING-STMT-OPT-D          PIC X.
00190              88  REPORT-D-WANTED    VALUE ' ' 'Y'.
00191          16  RE-CEDING-STMT-OPT-E          PIC X.
00192              88  REPORT-E-WANTED    VALUE ' ' 'Y'.
00193
00194          16  RE-PRT-CRSV                   PIC X.
00195
00196          16  RE-GL-CENTER                  PIC X(4).
00197
00198          16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
00199
00200          16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
00204
00205          16  RE-EARN-STOP-CODE             PIC X.
00206              88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
00207              88  STOP-AH-EARNING    VALUE 'A' 'B'.
00208
103101         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
103101             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
103101
032707         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
032707         16  FILLER                        PIC X(2281).
00210
00211          16  RE-DESC OCCURS 18 TIMES       PIC X(79).
00212
00213 ******************************************************************
00311      EJECT
00312 *    COPY ERCCTBL.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCCTBL                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.003
00006 *                                                                *
00007 *   ONLINE CREDIT SYSTEM                                         *
00008 *                                                                *
00009 *   FILE DESCRIPTION = COMPENSATION TABLE                        *
00010 *                                                                *
00011 *   FILE TYPE = VSAM,KSDS                                        *
00012 *   RECORD SIZE = 200   RECFORM = FIXED                          *
00013 *                                                                *
00014 *   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
00015 *       ALTERNATE PATH = NONE                                    *
00016 *                                                                *
00017 *   LOG = NO                                                     *
00018 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00019 *                                                                *
00020 *                                                                *
00021 ******************************************************************
00022
00023  01  COMM-TABLE-RECORD.
00024      12  CT-RECORD-ID                      PIC XX.
00025          88  VALID-CT-ID                      VALUE 'CT'.
00026
00027      12  CT-CONTROL-PRIMARY.
00028          16  CT-COMPANY-CD                 PIC X.
00029          16  CT-TABLE                      PIC XXX.
00030          16  CT-CNTRL-2.
00031              20  CT-BEN-TYPE               PIC X.
00032              20  CT-BEN-CODE               PIC XX.
00033
00034      12  CT-MAINT-INFORMATION.
00035          16  CT-LAST-MAINT-DT              PIC XX.
00036          16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
00037          16  CT-LAST-MAINT-USER            PIC X(4).
00038          16  FILLER                        PIC X(31).
00039
00040      12  CT-LIMITS.
00041          16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
00042
00043          16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
00044
00045          16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
00046
00047      12  CT-RATES.
00048          16  CT-RTX          OCCURS 27 TIMES.
00049              20  CT-RT                     PIC SV9(5)     COMP-3.
00050              20  CT-RT-R   REDEFINES
00051                  CT-RT                     PIC XXX.
00052
00053      12  FILLER                            PIC  X(42).
00054
00055 ******************************************************************
00313      EJECT
00314 *    COPY ERCFORM.
00001 ******************************************************************
00002 *                                                                *
00002 *                                                                *
00003 *                            ERCFORM.                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.003                          *
00006 *                                                                *
00007 *    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
00008 *                                                                *
00009 *    FILE TYPE = VSAM,KSDS                                       *
00010 *    RECORD SIZE = 500  RECFORM = FIXED                          *
00011 *                                                                *
00012 *    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
00013 *                                                                *
00014 *    LOG = YES                                                   *
00015 *    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
00016 ******************************************************************
00017  01  FORM-MASTER.
00018     12  FO-RECORD-ID                 PIC X(02).
00019         88  VALID-FO-ID                  VALUE 'FO'.
00020
00021     12  FO-CONTROL-PRIMARY.
00022         16  FO-COMPANY-CD            PIC X(01).
00023         16  FO-STATE                 PIC X(02).
00024         16  FO-FORM-ID               PIC X(12).
00025         16  FO-FORM-EXP-DT           PIC X(02).
00026
00027     12  FO-POLICY-FORM-DATA.
00028         16  FO-IND-GRP-CD            PIC X(01).
00029         16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
00030         16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
00031         16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
00032         16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
00033         16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
00034         16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
00035         16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
00036         16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
00037         16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
00038         16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
00039         16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
00040         16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
00041         16  FO-DIS-DEF-TYPE          PIC 9(02).
00042         16  FO-DISMEMBERMENT-CD      PIC X(01).
00043         16  FO-APP-CERT-USE-CD       PIC X(01).
00044
00045     12  FILLER                       PIC X(29).
00046
00047     12  FO-FORM-PLAN-TABLE.
00048         16  FO-FORM-PLANS     OCCURS 40 TIMES.
00049             20  FO-PLAN-TYPE         PIC X(01).
00050             20  FO-PLAN-ID           PIC X(02).
00051             20  FO-PLAN-TERM         PIC 9(03).
00052             20  FO-PLAN-REFUND-METHOD
00053                                      PIC X.
00054
00055     12  FILLER                       PIC X(30).
00056
00057     12  FO-COMMENTS-AREA.
00058         16  FO-COMMENT-LINE-1        PIC X(78).
00059
00060     12  FILLER                       PIC X(20).
00061
00062     12  FO-MAINT-INFORMATION.
00063         16  FO-LAST-MAINT-DT         PIC X(02).
00064         16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
00065         16  FO-LAST-MAINT-BY         PIC X(04).
00315      EJECT
00316 *    COPY ELCMSTR.
00001 ******************************************************************
00002 *                                                                *
00003 *                            ELCMSTR.                            *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.012                          *
00006 *                                                                *
00007 *   FILE DESCRIPTION = CLAIM MASTER FILE                         *
00008 *                                                                *
00009 *   FILE TYPE = VSAM,KSDS                                        *
00010 *   RECORD SIZE = 350  RECFORM = FIXED                           *
00011 *                                                                *
00012 *   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
00013 *       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
00014 *       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
00015 *       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
00016 *       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
00017 *                                                 RKP=75,LEN=21  *
00018 *                                                                *
00019 *   **** NOTE ****                                               *
00020 *             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
00021 *             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
00022 *                                                                *
00023 *   LOG = YES                                                    *
00024 *   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
120503******************************************************************
120503*                   C H A N G E   L O G
120503*
120503* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
120503*-----------------------------------------------------------------
120503*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
120503* EFFECTIVE    NUMBER
120503*-----------------------------------------------------------------
120503* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
080307* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
031213* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
00025 ******************************************************************
00026  01  CLAIM-MASTER.
00027      12  CL-RECORD-ID                PIC XX.
00028          88  VALID-CL-ID         VALUE 'CL'.
00029
00030      12  CL-CONTROL-PRIMARY.
00031          16  CL-COMPANY-CD           PIC X.
00032          16  CL-CARRIER              PIC X.
00033          16  CL-CLAIM-NO             PIC X(7).
00034          16  CL-CERT-NO.
00035              20  CL-CERT-PRIME       PIC X(10).
00036              20  CL-CERT-SFX         PIC X.
00037
00038      12  CL-CONTROL-BY-NAME.
00039          16  CL-COMPANY-CD-A1        PIC X.
00040          16  CL-INSURED-LAST-NAME    PIC X(15).
00041          16  CL-INSURED-NAME.
00042              20  CL-INSURED-1ST-NAME PIC X(12).
00043              20  CL-INSURED-MID-INIT PIC X.
00044
00045      12  CL-CONTROL-BY-SSN.
00046          16  CL-COMPANY-CD-A2        PIC X.
00047          16  CL-SOC-SEC-NO.
00048              20  CL-SSN-STATE        PIC XX.
00049              20  CL-SSN-ACCOUNT      PIC X(6).
00050              20  CL-SSN-LN3          PIC X(3).
00051
00052      12  CL-CONTROL-BY-CERT-NO.
00053          16  CL-COMPANY-CD-A4        PIC X.
00054          16  CL-CERT-NO-A4.
00055              20  CL-CERT-A4-PRIME    PIC X(10).
00056              20  CL-CERT-A4-SFX      PIC X.
00057
00058      12  CL-CONTROL-BY-CCN.
00059          16  CL-COMPANY-CD-A5        PIC X.
00060          16  CL-CCN-A5.
00061              20  CL-CCN.
00062                  24  CL-CCN-PREFIX-A5 PIC X(4).
00063                  24  CL-CCN-PRIME-A5 PIC X(12).
00064              20  CL-CCN-FILLER-A5    PIC X(4).
00065
00066      12  CL-INSURED-PROFILE-DATA.
00067          16  CL-INSURED-BIRTH-DT     PIC XX.
00068          16  CL-INSURED-SEX-CD       PIC X.
00069              88  INSURED-IS-MALE        VALUE 'M'.
00070              88  INSURED-IS-FEMALE      VALUE 'F'.
00071              88  INSURED-SEX-UNKNOWN    VALUE ' '.
00072          16  CL-INSURED-OCC-CD       PIC X(6).
00073          16  FILLER                  PIC X(5).
00074
00075      12  CL-PROCESSING-INFO.
00076          16  CL-PROCESSOR-ID         PIC X(4).
00077          16  CL-CLAIM-STATUS         PIC X.
00078              88  CLAIM-IS-OPEN          VALUE 'O'.
00079              88  CLAIM-IS-CLOSED        VALUE 'C'.
00080          16  CL-CLAIM-TYPE           PIC X.
00081 *            88  AH-CLAIM               VALUE 'A'.
00082 *            88  LIFE-CLAIM             VALUE 'L'.
00083 *            88  PROPERTY-CLAIM         VALUE 'P'.
00084 *            88  IUI-CLAIM              VALUE 'I'.
120503*            88  GAP-CLAIM              VALUE 'G'.
00085          16  CL-CLAIM-PREM-TYPE      PIC X.
00086              88  SINGLE-PREMIUM         VALUE '1'.
00087              88  O-B-COVERAGE           VALUE '2'.
00088              88  OPEN-END-COVERAGE      VALUE '3'.
00089          16  CL-INCURRED-DT          PIC XX.
00090          16  CL-REPORTED-DT          PIC XX.
00091          16  CL-FILE-ESTABLISH-DT    PIC XX.
00092          16  CL-EST-END-OF-DISAB-DT  PIC XX.
00093          16  CL-LAST-PMT-DT          PIC XX.
00094          16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
00095          16  CL-PAID-THRU-DT         PIC XX.
00096          16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
00097          16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
00098          16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
00099          16  CL-PMT-CALC-METHOD      PIC X.
00100              88  CL-360-DAY-YR          VALUE '1'.
00101              88  CL-365-DAY-YR          VALUE '2'.
00102              88  CL-FULL-MONTHS         VALUE '3'.
00103          16  CL-CAUSE-CD             PIC X(6).
00104
00105          16  CL-PRIME-CERT-NO.
00106              20  CL-PRIME-CERT-PRIME PIC X(10).
00107              20  CL-PRIME-CERT-SFX   PIC X.
00108
00109          16  CL-SYSTEM-IDENTIFIER    PIC XX.
00110              88  CL-CREDIT-CLAIM        VALUE 'CR'.
00111              88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
00112
00113          16  CL-MICROFILM-NO         PIC X(10).
00114          16  CL-PROG-FORM-TYPE       PIC X.
00115          16  CL-LAST-ADD-ON-DT       PIC XX.
00116
00117          16  CL-LAST-REOPEN-DT       PIC XX.
00118          16  CL-LAST-CLOSE-DT        PIC XX.
00119          16  CL-LAST-CLOSE-REASON    PIC X(01).
00120              88  FINAL-PAID             VALUE '1'.
00121              88  CLAIM-DENIED           VALUE '2'.
00122              88  AUTO-CLOSE             VALUE '3'.
00123              88  MANUAL-CLOSE           VALUE '4'.
00124              88  BENEFITS-CHANGED       VALUE 'C'.
00125              88  SETUP-ERRORS           VALUE 'E'.
00126          16  CL-ASSOC-CERT-SEQU      PIC S99.
00127          16  CL-ASSOC-CERT-TOTAL     PIC S99.
00128          16  CL-CLAIM-PAYMENT-STATUS PIC 9.
00129              88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
080307         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
080307         16  FILLER                  PIC X.
00131
00132      12  CL-CERTIFICATE-DATA.
00133          16  CL-CERT-ORIGIN          PIC X.
00134              88  CERT-WAS-ONLINE        VALUE '1'.
00135              88  CERT-WAS-CREATED       VALUE '2'.
00136              88  COVERAGE-WAS-ADDED     VALUE '3'.
00137          16  CL-CERT-KEY-DATA.
00138              20  CL-CERT-CARRIER     PIC X.
00139              20  CL-CERT-GROUPING    PIC X(6).
00140              20  CL-CERT-STATE       PIC XX.
00141              20  CL-CERT-ACCOUNT.
00142                  24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
00143                  24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
00144              20  CL-CERT-EFF-DT      PIC XX.
00145
00146      12  CL-STATUS-CONTROLS.
00147          16  CL-PRIORITY-CD          PIC X.
00148              88  CONFIDENTIAL-DATA      VALUE '8'.
00149              88  HIGHEST-PRIORITY       VALUE '9'.
00150          16  CL-SUPV-ATTN-CD         PIC X.
00151              88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
00152              88  SUPV-IS-REQUIRED       VALUE 'Y'.
00153          16  CL-PURGED-DT            PIC XX.
00154          16  CL-RESTORED-DT          PIC XX.
00155          16  CL-NEXT-AUTO-PAY-DT     PIC XX.
00156          16  CL-NEXT-RESEND-DT       PIC XX.
00157          16  CL-NEXT-FOLLOWUP-DT     PIC XX.
031213         16  CL-CRITICAL-PERIOD      PIC 99.
031213*        16  FILLER                  PIC XX.
00159          16  CL-LAST-MAINT-DT        PIC XX.
00160          16  CL-LAST-MAINT-USER      PIC X(4).
00161          16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
00162          16  CL-LAST-MAINT-TYPE      PIC X.
00163              88  CLAIM-SET-UP           VALUE ' '.
00164              88  PAYMENT-MADE           VALUE '1'.
00165              88  LETTER-SENT            VALUE '2'.
00166              88  MASTER-WAS-ALTERED     VALUE '3'.
00167              88  MASTER-WAS-RESTORED    VALUE '4'.
00168              88  INCURRED-DATE-CHANGED  VALUE '5'.
00169              88  FILE-CONVERTED         VALUE '6'.
00170              88  CHANGE-OF-BENEFITS     VALUE 'C'.
00171              88  ERROR-CORRECTION       VALUE 'E'.
00172          16  CL-RELATED-CLAIM-NO     PIC X(7).
00173          16  CL-HISTORY-ARCHIVE-DT   PIC XX.
00174          16  CL-BENEFICIARY          PIC X(10).
00175          16  CL-FILE-ESTABLISHED-BY  PIC X(4).
120808         16  CL-DENIAL-TYPE          PIC X.
                   88  CL-TYPE-DENIAL          VALUE '1'.
                   88  CL-TYPE-RESCISSION      VALUE '2'.
                   88  CL-TYPE-REFORMATION     VALUE '3'.
                   88  CL-TYPE-REF-TO-RES      VALUE '4'.
                   88  CL-TYPE-RECONSIDERED    VALUE '5'.
               16  CL-CRIT-PER-RECURRENT   PIC X.
               16  CL-CRIT-PER-RTW-MOS     PIC 99.
               16  CL-RTW-DT               PIC XX.
00177
00178      12  CL-TRAILER-CONTROLS.
00179          16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
00180              88  CL-1ST-TRL-AVAIL       VALUE +4095.
00181              88  CL-LAST-TRL-AVAIL      VALUE +100.
00182              88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
00183          16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
00184          16  FILLER                  PIC XX.
00185          16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
00186          16  CL-ADDRESS-TRAILER-CNT.
00187              20  CL-INSURED-ADDR-CNT  PIC S9(1).
00188                  88  NO-INSURED-AVAILABLE    VALUE ZERO.
00189              20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
00190                  88  ACCOUNT-IS-ONLINE       VALUE ZERO.
00191              20  CL-BENIF-ADDR-CNT    PIC S9(1).
00192                  88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
00193              20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
00194                  88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
00195              20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
00196                  88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
00197              20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
00198                  88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
00199              20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
00200                  88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
00201
00202      12  CL-CV-REFERENCE-NO.
00203          16  CL-CV-REFNO-PRIME       PIC X(18).
00204          16  CL-CV-REFNO-SFX         PIC XX.
00205
00206      12  CL-FILE-LOCATION            PIC X(4).
00207
00208      12  CL-PROCESS-ERRORS.
00209          16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
00210              88  NO-FATAL-ERRORS        VALUE ZERO.
00211          16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
00212              88  NO-FORCABLE-ERRORS     VALUE ZERO.
00213
00214      12  CL-PRODUCT-CD               PIC X.
00215
00216      12  CL-CURRENT-KEY-DATA.
00217          16  CL-CURRENT-CARRIER      PIC X.
00218          16  CL-CURRENT-GROUPING     PIC X(6).
00219          16  CL-CURRENT-STATE        PIC XX.
00220          16  CL-CURRENT-ACCOUNT      PIC X(10).
00221
00222      12  CL-ASSOCIATES               PIC X.
00223          88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
00224          88  CL-ASSOC-INTERFACE         VALUE 'I'.
00225          88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
00226          88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
00227
00228      12  CL-ACTIVITY-CODE            PIC 99.
00229      12  CL-ACTIVITY-MAINT-DT        PIC XX.
00230      12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
00231
00232      12  CL-LAPSE-REPORT-CODE        PIC 9.
00233      12  CL-LAG-REPORT-CODE          PIC 9.
00234      12  CL-LOAN-TYPE                PIC XX.
00235      12  CL-LEGAL-STATE              PIC XX.
00236
CIDMOD     12  CL-YESNOSW                  PIC X.
031213     12  CL-ACCIDENT-CLAIM-SW        PIC X.
031213         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
031213         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
031213         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
           12  cl-insured-claim            pic x.
               88  cl-claim-on-primary         value 'P'.
               88  cl-claim-on-secondary       value 'S'.
031213     12  cl-benefit-expiration-dt    PIC XX.
00317
00318  01  PLAN-RECORDS.
00319      12  LINK-LIFE-PLAN-RECORD   PIC X(420).
00320      12  LINK-AH-PLAN-RECORD     PIC X(420).
00321
00322      EJECT
       PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
                                ACCOUNT-MASTER REINSURANCE-RECORD
                                COMM-TABLE-RECORD FORM-MASTER
                                CLAIM-MASTER PLAN-RECORDS.
       0000-DFHEXIT SECTION.
           MOVE '9#                    $   ' TO DFHEIV0.
           MOVE 'EL050' TO DFHEIV1.
           CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
00324
00325      MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
00326
00327      
      * EXEC CICS  HANDLE CONDITION
00328 *           ERROR    (9300-ABEND)
00329 *           NOTOPEN  (3990-FILES-NOT-OPEN)
00330 *    END-EXEC.
      *    MOVE '"$.J                  ! " #00007521' TO DFHEIV0
           MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2220233030303037353231' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00331
00332  0000-COPY-PROCEDURE-DIV.
00333 *                          COPY ELC50PD.
00001 ******************************************************************
00002 *                                                                *
00003 *                            ELC50PD                             *
00004 *           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
00005 *                            VMOD=2.188                          *
00006 *                                                                *
122002******************************************************************
122002*                   C H A N G E   L O G
122002*
122002* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
122002*-----------------------------------------------------------------
122002*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
122002* EFFECTIVE    NUMBER
122002*-----------------------------------------------------------------
122002* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
123102* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
082003* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
082003*                             2709 AND 2718
082203* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
100703* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
011904* 011904                   PEMA  ADD TOTAL FEE PROCESSING
033104* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
062904* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
062904*                                IS OPEN OR CNC DT < PD THRU
111504* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
121304* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
011305* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
061405* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
070705* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
071305* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
080805* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
083005* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
092205* 092205  CR2005050300006  PEMA  ADD SPP LEASES
093005* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
020906* 020906                   PEMA  EXPAND LOAN OFFICER
042106* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
050506* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
052306* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
081606* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
083106* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
101706* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
102706* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
030807* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
040407* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
061207* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
062707* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
062907* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
073107* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
122807* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
040708* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
050508* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
072308* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
090408* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
090408* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
102908* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
012909* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
030309* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
030509* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
042709* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
050509* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
050509*                                UPDATE VIN ON CERT TRAILER
061009* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
072109* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
072209* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
101509* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
011410* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
022210* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
022510* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
040610* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
041310* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
042310* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
071910* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
080310* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
091610* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
111610* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
012711* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
020711* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
020711* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
031611* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
031611* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
031811* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
040811* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
041811* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
050311* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
071211* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
071311* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
072111* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
083111* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
092311* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
110811* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
112911* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
120511* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
030612* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
032912* 032912  CR2011110200001  PEMA  AHL CHANGES
040512* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
041012* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
042012* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
080712* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
091012* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
111212* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
112612* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
010713* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
011513* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
012213* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
022513* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
031513* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
032013* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
081613* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
00007 ******************************************************************
00008 ************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
00009 ******************************************************************
00010
00011      INITIALIZE  WS-CRI-SSN-WORK-AREA.
00012
00013      MOVE SPACES                 TO PB-FATAL-FLAG
00014                                     PB-FORCE-ER-CD
00015                                     PB-WARN-ER-CD
00016                                     PB-OUT-BAL-CD.
00017
00018      MOVE SPACE                  TO WS-IG-OVRD-AH
00019                                     WS-IG-OVRD-LF
00020                                     WS-IG-OVRD-AM
00021                                     WS-IG-OVRD
00022                                     WS-IG-OVRD-AH-PL
00023                                     WS-IG-OVRD-LF-PL
00024                                     WS-IG-OVRD-AH-BEN
00025                                     WS-IG-OVRD-LF-BEN.
00026
00027 ******************************************************************
00028 *************       INITIALIZE COMMON ERRORS       ***************
00029 ******************************************************************
00030
00031      MOVE +0                     TO PB-NO-OF-ERRORS.
00032      MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
00033
00034 ******************************************************************
00035
00036      MOVE EIBDATE                TO DC-JULIAN-DATE.
00037      SET JULIAN-TO-BIN           TO TRUE.
00038 *    MOVE 5                      TO DC-OPTION-CODE.
00039      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
00040      MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
00041
00042      MOVE ZERO                   TO  SUB4.
00043
00044  0040-INITIALIZE-GA-BILL-DT.
00045
00046      ADD +1                      TO  SUB4.
00047
00048      IF  SUB4 GREATER THAN +5
00049          GO TO 0050-CHECK-CNTL-FOUND.
00050
00051      IF  PB-GA-BILL-DT (SUB4) = SPACES
00052          MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
00053
00054      GO TO 0040-INITIALIZE-GA-BILL-DT.
00055
00056  0050-CHECK-CNTL-FOUND.
00057
00058      IF WK-CNTL-RECORD-FOUND-SW = 'Y'
00059         MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
00060                                          WS-AH-REM-TERM-CALC
00061                                          EC-CO-REM-TERM-CALC
00062         MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
00063         MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
00064         MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
00065                                          WS-TOL-AH-CLAIM
00066         MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
00067                                          WS-TOL-AH-PREM
00068                                          EC-CO-TOL-PREM
00069         MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
00070                                          WS-TOL-AH-REFUND
00071                                          EC-CO-TOL-REFUND
00072         MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
00073                                          WS-AH-REFUND-OVS-AMT
00074                                          EC-CO-OVR-SHT-AMT
00075         MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
00076                                          WS-TOL-AH-PREM-PCT
00077                                          EC-CO-TOL-PREM-PCT
00078         MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
00079                                          WS-TOL-AH-REFUND-PCT
00080                                          EC-CO-TOL-REFUND-PCT
00081         MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
00082                                          WS-AH-REFUND-OVS-PCT
00083                                          EC-CO-OVR-SHT-PCT
00084         MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
00085         MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
00086         MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
00087         MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
00088         MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
00089         MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
00090         MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
00091         MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
00092         MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
00093         MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
00094         MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
00095         MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
00096                                          EC-CO-MONTH-END-DT
00097         MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
00098           GO TO 0100-READ-ACCT.
00099
00100      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
00101      MOVE SPACES                 TO CNTL-ACCESS.
00102      MOVE '1'                    TO CNTL-REC-TYPE.
00103      MOVE +0                     TO CNTL-SEQ-NO.
00104
00105      MOVE '1' TO RC-SW-1.
00106      PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
00107      IF NOT CF-COMPANY-MASTER
00108          MOVE ZEROS             TO WK-CO-TOL-PREM
00109                                    WK-CO-TOL-CLAIM
00110                                    WK-CO-TOL-REFUND
00111                                    WK-REFUND-OVS-AMT
00112                                    WK-REFUND-OVS-PCT
00113                                    WK-CO-TOL-PREM-PCT
00114                                    WK-CO-TOL-REFUND-PCT
00115                                    WK-DEFAULT-APR
00116                                    WK-CO-MAX-CAP
00117         MOVE SPACES             TO WK-CR-REM-TERM-CALC
00118                                    WK-CR-R78-METHOD
00119                                    WK-CO-REF-REJECT-SW
00120                                    WK-CO-PREM-REJECT-SW
00121                                    WK-REM-TRM-CALC-OPTION
00122                                    WK-BIRTH-DATE-INPUT
00123                                    WK-JOINT-AGE-INPUT
00124         MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
00125         MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
00126         INITIALIZE    WK-CREDIT-EDIT-CONTROLS
00127         MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
00128           GO TO 0099-COMPANY-NOT-FOUND.
00129
00130      IF CF-CO-TOL-PREM-PCT NOT NUMERIC
00131         MOVE +0                    TO CF-CO-TOL-PREM-PCT.
00132      IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
00133         MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
00134      IF CF-CO-TOL-CAP NOT NUMERIC
00135         MOVE +0                    TO CF-CO-TOL-CAP.
00136      IF CF-DEFAULT-APR NOT NUMERIC
00137         MOVE +0                    TO CF-DEFAULT-APR.
00138
00139      MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
00140      MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
00141      MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
00142      MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
00143      MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
00144      MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
00145      MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
00146      MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
00147      MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
00148      MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
00149      MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
00150      MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
00151
00152      IF CF-CO-OVR-SHT-AMT NUMERIC AND
00153           CF-CO-OVR-SHT-AMT > +0
00154         MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
00155
00156      IF CF-CO-OVR-SHT-PCT NUMERIC AND
00157           CF-CO-OVR-SHT-PCT > +0
00158         MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
00159
00160      IF CF-VALID-REM-TRM-OPTION
00161          MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
00162      ELSE
00163          MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
00164
00165      MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
00166      MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
00167      MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
00168      MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
00169
00170      GO TO 0050-CHECK-CNTL-FOUND.
00171
00172  0099-COMPANY-NOT-FOUND.
00173
00174      MOVE ER-2616                TO WS-ERROR.
00175      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00176
00177  0100-READ-ACCT.
00178
00179      MOVE SPACES                 TO DATE-RANGE-SW.
00180
00181      IF WK-ACCT-ADDR = ZEROS
00182         GO TO 0102-ACCT-GETMAIN.
00183
00184      MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
00185      SET ERACCT-FILE-ADDRESSED   TO TRUE.
00186      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
00187
00188      IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
00189         OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
00190         GO TO 0105-READ-ACCT
           END-IF
00191
00192      IF PB-CARRIER NOT = SPACES
00193         IF PB-CARRIER NOT = AM-VG-CARRIER
00194            GO TO 0105-READ-ACCT.
00195
00196      IF PB-STATE NOT = SPACES
00197         IF PB-STATE NOT = AM-VG-STATE
00198            GO TO 0105-READ-ACCT.
00199
00200      IF PB-GROUPING NOT = SPACES
00201         IF PB-GROUPING NOT = AM-VG-GROUPING
00202            GO TO 0105-READ-ACCT.
00203
00204      MOVE 'X'                 TO DATE-RANGE-SW.
00205
00206      IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
00207         MOVE 'X'                 TO DATE-RANGE-SW
00208         GO TO 0105-READ-ACCT.
00209
00210      IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
00211         GO TO 0105-READ-ACCT.
00212
00213      GO TO 0180-ACCOUNT-FOUND.
00214
00215  0102-ACCT-GETMAIN.
00216      PERFORM 8560-GETMAIN THRU 8560-EXIT.
00217      MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
00218
00219  0105-READ-ACCT.
00220      MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
00221      MOVE PB-CARRIER             TO ACCT-CARRIER.
00222      MOVE PB-GROUPING            TO ACCT-GROUPING.
00223      MOVE PB-STATE               TO ACCT-STATE.
00224      MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
00225      MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
00226
00227      PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
00228
00229      MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
00230
00231  0110-FIND-ACCT-TOLERANCES-LOOP.
00232      PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
00233
00234      IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
00235         OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
00236         GO TO 0199-ACCT-NOT-FOUND
00237      END-IF
00238      IF PB-CARRIER NOT = SPACES
00239         IF PB-CARRIER NOT = AM-VG-CARRIER
00240            GO TO 0199-ACCT-NOT-FOUND.
00241
00242      IF PB-STATE NOT = SPACES
00243         IF PB-STATE NOT = AM-VG-STATE
00244            GO TO 0199-ACCT-NOT-FOUND.
00245
00246      IF PB-GROUPING NOT = SPACES
00247         IF PB-GROUPING NOT = AM-VG-GROUPING
00248            GO TO 0199-ACCT-NOT-FOUND.
00249
00250      MOVE 'X'                    TO DATE-RANGE-SW.
00251
00252      IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
00253         MOVE 'X'                 TO DATE-RANGE-SW
00254         GO TO 0199-ACCT-NOT-FOUND.
00255
00256      IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
00257         GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
00258
00259  0180-ACCOUNT-FOUND.
00260      MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
00261      MOVE AM-CARRIER             TO PB-SV-CARRIER.
00262      MOVE AM-STATE               TO PB-SV-STATE.
00263      MOVE AM-GROUPING            TO PB-SV-GROUPING.
00264
00265      IF AM-CANCEL-FEE  NOT NUMERIC
00266         MOVE ZEROS TO AM-CANCEL-FEE.
00267
00268      IF AM-MAX-MON-BEN NOT NUMERIC
00269         MOVE ZEROS TO AM-MAX-MON-BEN.
00270
00271      IF AM-MAX-TOT-BEN NOT NUMERIC
00272         MOVE ZEROS TO AM-MAX-TOT-BEN.
00273
100703     IF AM-CLP-TOL-PCT NOT NUMERIC
100703        MOVE +0                  TO AM-CLP-TOL-PCT
100703     END-IF
092705     IF AM-SPP-LEASE-COMM NOT NUMERIC
092705        MOVE +0                  TO AM-SPP-LEASE-COMM
092705     END-IF
00274      IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
00275         MOVE ER-2611             TO   WS-ERROR
00276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00277
00278      IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
00279         MOVE ER-2621             TO   WS-ERROR
00280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00281
00282      IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
00283         AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
00284         AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
00285         AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
00286          MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
00287
00288      MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
00289      MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
00290      MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
00291      MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
100703     IF AM-CLP-TOL-PCT NOT = ZEROS
100703        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
100703     END-IF
092705     IF AM-SPP-LEASE-COMM NOT = ZEROS
092705        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
092705     END-IF
      *    IF PB-COMPANY-ID = 'DCC'
      *       MOVE +0                  TO WS-ACCT-ADDL-CLP
062707*                                   WS-ADMIN-FEES
      *       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
      *          (SUB5 > +10)
052306*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
      *             AND (AM-A-COM (SUB5) NUMERIC)
      *             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
      *                + (AM-A-COM (SUB5) * 1000)
062707*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
062707*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
052306*                + (AM-A-COM (SUB5) * 1000)
052306*             END-IF
      *             IF AM-COM-TYP (SUB5) = 'N'
      *                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
      *                + (AM-A-COM (SUB5) * 1000)
      *             END-IF
      *          END-IF
      *       END-PERFORM
      *    END-IF
071211     IF (PB-COMPANY-ID = 'DCC')
              AND (PB-ISSUE)
071211        MOVE +0                  TO WS-ACCT-ADDL-CLP
071211        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
071211           (SUB5 > +10)
071211           MOVE +0 TO WS-WK-RATE
071211           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
071211              IF (AM-A-COM (SUB5) NUMERIC)
071211                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
071211                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
071211              ELSE
071211                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
071211                 IF PB-ISSUE
071211                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
071211                 ELSE
071211                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
071211                 END-IF
071211                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
071211                 MOVE ZEROS             TO WS-SUB1
071211                                           WS-COMMISSION
071211                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
                       MOVE '0530'               TO CTBL-SW
                       MOVE ' '                  TO WS-CTBL-READ-SW
071211                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       IF FIRST-TIME-THROUGH
                          MOVE 'AA'              TO CTBL-BEN-CODE
                          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       END-IF
071211                 IF CTBL-TABLE-FOUND
071211                    IF PB-ISSUE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
071211                    ELSE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
071211                    END-IF
071211                    PERFORM 8800-GET-COMP-RATE
071211                              THRU 8800-EXIT
071211                 END-IF
071211              END-IF
071211              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
071211                + (WS-WK-RATE * 1000)
071211           END-IF
071211        END-PERFORM
071211     END-IF
00293      IF PB-COMPANY-ID EQUAL 'CRI'
00294          MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
00295
00296      IF PB-COMPANY-ID EQUAL 'NCL'
00297          MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
           END-IF
00298
00299      GO TO 0200-READ-CERT.
00300
00301  0199-ACCT-NOT-FOUND.
00302
00303      MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
00304
00305      IF DATE-RANGE-SW NOT = SPACES
00306         MOVE ER-2601             TO WS-ERROR
00307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00308      ELSE
00309         MOVE ER-2619             TO WS-ERROR
00310         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00311
00312      GO TO 9990-RETURN.
00313
00314  0200-READ-CERT.
00315
00316      MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
00317      MOVE PB-SV-CARRIER          TO CERT-CARRIER.
00318      MOVE PB-SV-GROUPING         TO CERT-GROUPING.
00319      MOVE PB-SV-STATE            TO CERT-STATE.
00320      MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
00321      MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
00322      MOVE PB-CERT-NO             TO CERT-CERT-NO.
00323
00324      PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
00325
00326      IF CERT-WAS-NOT-FOUND
00327         GO TO 0299-CERT-NOT-FOUND.
00328
00329      IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
00330         MOVE ER-2759             TO WS-ERROR
00331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00332         GO TO 0298-UNLOCK-RETURN.
00333
00334      IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
00335          MOVE ER-2758            TO WS-ERROR
00336          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00337          GO TO 0298-UNLOCK-RETURN.
00338
00339      IF PB-ISSUE
00340         IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
00341            IF CERT-WAS-CREATED-FOR-CLAIM
00342               NEXT SENTENCE
00343             ELSE
00344               MOVE ER-2626       TO WS-ERROR
00345               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00346               GO TO 0298-UNLOCK-RETURN.
00347
00348      IF NOT PB-CANCELLATION
00349         GO TO 0300-CONTINUE-EDIT.
00350
00351      MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
00352      MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
072209     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
00353      MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
00354      MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
00355      MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
00356
00357      MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
00358      MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
00359      MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
00360      MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
00361      MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
00362      MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
00363      MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
00364      MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
00365      MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
00366
00367      MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
00368      MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
00369      MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
00370      MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
00371      MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
00372      MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
00373      MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
00374
00375      MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
00376      MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
00377
00378      MOVE CM-CREDIT-INTERFACE-SW-1
00379                                   TO PB-CI-CREDIT-INTERFACE-SW-1.
00380      MOVE CM-CREDIT-INTERFACE-SW-2
00381                                   TO PB-CI-CREDIT-INTERFACE-SW-2.
00382
00383      IF CM-O-B-COVERAGE
00384          MOVE 'B'                 TO PB-CI-OB-FLAG.
00385
00386      IF CM-LIVES NOT NUMERIC
00387          MOVE ZERO                TO CM-LIVES.
00388
00389      IF CM-BILLED NOT NUMERIC
00390          MOVE ZERO                TO CM-BILLED.
00391
00392      IF CM-CREDIT-INTERFACE-SW-2 = SPACE
00393          MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
00394          MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
00395          MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
00396          MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
00397          MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
00398          MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
00399          MOVE CM-LIVES             TO PB-CI-LIVES
072209*The next line causes a problem with my change  I dont think it is
072209*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
00401
00402      MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
00403      MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
00404      MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
00405      MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
00406      MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
00407      MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
00408
00409      MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
00410      MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
00411      MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
00412      MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
00413
00414      IF CM-LIFE-COMM-PCT NUMERIC
00415          MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
00416      ELSE
00417          MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
00418
00419      IF CM-AH-COMM-PCT NUMERIC
00420          MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
00421      ELSE
00422          MOVE ZEROS              TO PB-CI-AH-COMMISSION.
00423
00424      MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
00425
00426      IF CM-LOAN-APR       NOT NUMERIC
00427            MOVE ZERO               TO CM-LOAN-APR.
00428
00429      IF CM-PAY-FREQUENCY  NOT NUMERIC
00430            MOVE ZERO               TO CM-PAY-FREQUENCY.
00431
00432      IF CM-LOAN-TERM      NOT NUMERIC
00433            MOVE ZERO               TO CM-LOAN-TERM.
00434
00435      IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
00436            MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
00437
00438      IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
00439            MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
00440
00441      MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
00442      MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
00443      MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
00444      MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
00445      MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
00446      MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
00447      MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
00448      MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
00449      MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
00450      MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
00451      MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
00452      MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
00453
00454      IF CM-STATE = CM-SSN-STATE
00455          MOVE SPACES               TO PB-CI-SOC-SEC-NO.
00456
00457      IF CM-STATE NOT = CM-MEMB-STATE
00458          MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
00459
00460      MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
00461
100703     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
00463         MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
040504        IF CM-ADDL-CLP NOT NUMERIC
040504           MOVE +0               TO CM-ADDL-CLP
040504        END-IF
040504        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
071211        IF AM-DCC-PRODUCT-CODE = 'DDF'
071211           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
071211        END-IF
040504     END-IF
071211     IF PB-COMPANY-ID = 'DCC'
071211        MOVE +0                  TO WS-ADMIN-FEES
                                          WS-CSO-ADMIN-FEE
                                          WS-COMM-AND-MFEE
071211                                    WS-1ST-YR-ALLOW
071211        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
071211           (SUB5 > +10)
071211           MOVE +0 TO WS-WK-RATE
071211           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
071211              IF (AM-A-COM (SUB5) NUMERIC)
071211                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
071211                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
071211              ELSE
071211                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
071211                 IF PB-ISSUE
071211                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
071211                 ELSE
071211                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
071211                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
071211                 END-IF
071211                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
071211                 MOVE ZEROS             TO WS-SUB1
071211                                           WS-COMMISSION
071211                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
                       MOVE '0530'               TO CTBL-SW
                       MOVE ' '                  TO WS-CTBL-READ-SW
071211                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       IF FIRST-TIME-THROUGH
                          MOVE 'AA'              TO CTBL-BEN-CODE
                          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
                       END-IF
071211                 IF CTBL-TABLE-FOUND
071211                    IF PB-ISSUE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
071211                    ELSE
071211                       COMPUTE WS-COMM-CK-AMT =
071211                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
071211                    END-IF
071211                    PERFORM 8800-GET-COMP-RATE
071211                              THRU 8800-EXIT
071211                 END-IF
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'I'
071211                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'N'
071211                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
071211                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
071211                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
071211                   + (WS-WK-RATE * 1000)
071211              END-IF
071211           END-IF
071211        END-PERFORM
071211     END-IF
00465      GO TO 0300-CONTINUE-EDIT.
00466
00467  0298-UNLOCK-RETURN.
00468       PERFORM 9250-UNLOCK-RETURN
00469       GO TO 9990-RETURN.
00470
00471  0299-CERT-NOT-FOUND.
00472
00473      MOVE '1'                     TO CERT-STATUS-SW.
00474
00475      IF PB-COMPANY-ID = 'UCL'
00476          IF WS-ERROR = ER-2799
00477              GO TO 3000-CONTINUE-EDIT.
00478
00479      IF NOT PB-CANCELLATION
00480          GO TO 0300-CONTINUE-EDIT.
00481
00482      MOVE ER-2726                  TO  WS-ERROR.
00483      PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
00484      MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
00485      MOVE ZEROS                  TO PB-CI-INSURED-AGE
00486                                     PB-CI-LF-TERM
00487                                     PB-C-LF-REM-TERM
00488                                     PB-CI-AH-TERM
00489                                     PB-C-AH-REM-TERM
00490                                     PB-CI-LF-BENEFIT-CD
00491                                     PB-CI-LF-BENEFIT-AMT
00492                                     PB-CI-LF-ALT-BENEFIT-AMT
00493                                     PB-CI-LF-PREMIUM-AMT
00494                                     PB-CI-LF-ALT-PREMIUM-AMT
00495                                     PB-CI-AH-BENEFIT-CD
00496                                     PB-CI-AH-BENEFIT-AMT
00497                                     PB-CI-AH-PREMIUM-AMT
00498                                     PB-CI-PAY-FREQUENCY
00499                                     PB-CI-LOAN-APR
00500                                     PB-CI-LOAN-TERM
00501                                     PB-CI-LIFE-COMMISSION
00502                                     PB-CI-AH-COMMISSION
00503                                     PB-CI-CURR-SEQ
00504                                     PB-CI-AH-CANCEL-AMT
00505                                     PB-CI-LF-CANCEL-AMT
00506                                     PB-CI-RATE-DEV-PCT-LF
00507                                     PB-CI-RATE-DEV-PCT-AH
00508                                     PB-CI-EXTENTION-DAYS
00509                                     PB-CI-TERM-IN-DAYS
00510                                     PB-CI-LIVES
00511                                     PB-CI-LF-CRIT-PER
00512                                     PB-CI-AH-CRIT-PER
040504                                    PB-CI-ADDL-CLP
071211                                    PB-CI-DDF-IU-RATE-UP.
00513
00514      MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
00515                                     PB-CI-AH-SETTLEMENT-DT
00516                                     PB-CI-DEATH-DT
00517                                     PB-CI-LF-PRIOR-CANCEL-DT
00518                                     PB-CI-AH-PRIOR-CANCEL-DT
00519                                     PB-CI-ENTRY-DT
00520                                     PB-CI-LF-EXPIRE-DT
00521                                     PB-CI-AH-EXPIRE-DT
00522                                     PB-CI-LOAN-1ST-PMT-DT.
00523
00524      IF ACCOUNT-MAST-FOUND
00525         MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
00526         MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
00527
00528      GO TO 3000-CONTINUE-EDIT.
00529
00530      EJECT
00531
00532  0300-CONTINUE-EDIT.
00533
00534      IF PB-ISSUE
00535         IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
00536             PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
00537
00538      IF PB-ISSUE
00539         IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
00540             PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
00541
00542      IF PB-ISSUE
00543        IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
00544           (AM-NO-AH-ONLY)
00545            IF PB-I-AH-BENEFIT-CD NOT = ZEROS
00546                IF PB-I-LIFE-BENEFIT-CD = ZEROS
00547                    MOVE ER-2679 TO WS-ERROR
00548                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00549
00550      IF PB-ISSUE
00551         MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
00552         MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
00553         MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
00554      ELSE
00555         MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
00556         MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
00557         MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
00558
00559      MOVE 'N'                    TO PLAN-MASTER-SW
00560                                     PLAN-MASTER-LIFE-SW
00561                                     FORM-MASTER-SW
00562                                     WS-APP-CERT-SW.
00563
00564      MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
00565                                     WS-PL-TOL-LF-REFUND
00566                                     WS-PL-REF-OVS-AMT
00567                                     WS-PL-TOL-LF-PREM-PCT
00568                                     WS-PL-TOL-LF-REFUND-PCT
00569                                     WS-PL-REF-OVS-PCT
00570                                     WS-PL-TOL-LF-CLAIM.
00571
00572      IF PB-COMPANY-ID = 'NCL'
00573        IF PB-ISSUE
00574          IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
00575              PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
00576              IF FORM-MASTER-FOUND
00577                  MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
00578
00579      IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
00580         GO TO 0310-FIND-AH-BENEFIT-RECORD.
00581
00582 ********************** MON CODE **********************
00583      IF PB-COMPANY-ID = 'MON'
00584      IF PB-ISSUE
00585      IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
00586         AND (PB-I-LOAN-APR NOT NUMERIC OR
00587              PB-I-LOAN-APR = ZERO)
00588                MOVE 14.0         TO PB-I-LOAN-APR.
00589 ******************************************************
00590
00591      IF PB-COMPANY-ID = 'NCL'
00592        IF PB-ISSUE
00593            IF FORM-MASTER-FOUND
00594              IF FO-DISMEMBERMENT-CD = 'Y'  AND
00595                 AM-DISMBR-COVERAGE
00596                  MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
00597                  IF WS-LF-INPUT-CD-1 NOT = 'B'
00598                    MOVE '8'            TO  WS-LF-INPUT-CD-1
00599                    MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
00600                                            PB-I-LIFE-BENEFIT-CD.
00601
00602      MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
00603
00604      IF WK-LIFE-BEN-ADDR NOT = ZEROS
00605          MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
00606          SET ELCNTL-FILE-ADDRESSED   TO TRUE
00607          PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
00608          PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
00609          IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
00610            AND NOT LESS THAN CF-BENEFIT-CODE (1)
00611              GO TO 0301-LIFE-BENEFIT-SEARCH
00612          ELSE
00613              NEXT SENTENCE
00614      ELSE
00615          PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
00616
00617      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
00618      MOVE '4'                    TO CNTL-REC-TYPE.
00619      MOVE +0                     TO CNTL-SEQ-NO.
00620      MOVE WS-ACCESS              TO CNTL-ACCESS.
00621
00622      MOVE '1' TO RC-SW-2.
00623      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
00624
00625      IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
00626         (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
00627          GO TO 0305-BENEFIT-NOT-FOUND.
00628
00629      MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
00630
00631  0301-LIFE-BENEFIT-SEARCH.
00632
00633      PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
00634
00635      IF NO-BENEFIT-FOUND
00636         GO TO 0305-BENEFIT-NOT-FOUND.
00637
00638      IF WS-BEN-CD = '99'
00639         GO TO 0305-BENEFIT-NOT-FOUND.
00640
00641      IF PB-COMPANY-ID = 'NCL'
00642          IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
00643              GO TO 0304-LIFE-BENEFIT-FOUND.
00644
00645      MOVE +1                     TO SUB5.
00646      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
00647
00648 * FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
00649 * BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
00650      IF PB-COMPANY-ID = 'DMD'
00651          MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
00652
00653  0302-EDIT-ACCT-LF-BENEFITS.
00654
00655      IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
00656         IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
00657            MOVE AM-ALLOWABLE-BENEFITS (SUB5)
00658                                  TO WS-SAVE-ALLOWABLE-BENEFIT
00659            GO TO 03XX-GET-LIFE-ERPLAN.
00660
00661      IF SUB5 LESS THAN +20
00662         ADD +1                   TO SUB5
00663         GO TO 0302-EDIT-ACCT-LF-BENEFITS.
00664
00665      MOVE +1                     TO SUB5.
00666
00667      IF  PB-COMPANY-ID NOT EQUAL 'DMD'
00668         GO TO 03XX-EDIT-FOR-NINETY-LF.
00669
00670  0303-EDIT-DMD-EXTRA-BENEFITS.
00671
00672      IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
00673         IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
00674            MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
00675                                  TO WS-SAVE-ALLOWABLE-BENEFIT
00676            GO TO 03XX-GET-LIFE-ERPLAN.
00677
00678      IF SUB5 LESS THAN +30
00679         ADD +1                   TO SUB5
00680         GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
00681
00682      MOVE +1                     TO SUB5.
00683
00684  03XX-EDIT-FOR-NINETY-LF.
00685
00686 ***************************************************************
00687 *                                                             *
00688 *    NINETY BENEFIT PLAN TYPES:                               *
00689 *                                                             *
00690 *      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
00691 *      92 = ALL GROUP REDUCING BENEFITS                       *
00692 *      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
00693 *      94 = ALL GROUP LEVEL BENEFITS                          *
00694 *      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
00695 *           BENEFIT CONTROLS.                                 *
00696 *      99 = ALL BENEFITS                                      *
00697 *                                                             *
00698 ***************************************************************
00699
00700      MOVE AM-ALLOWABLE-BENEFITS (SUB5)
00701                                  TO WS-SAVE-ALLOWABLE-BENEFIT.
00702
00703      IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
00704        AND
00705         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00706         GO TO 03XX-GET-LIFE-ERPLAN.
00707
00708      IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
00709        AND
00710         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00711         IF CF-REDUCING (SUB3)
00712            IF (PB-I-INDV-GRP-OVRD = 'I')
00713               OR
00714            ((AM-IG = '1') AND
00715            (PB-I-INDV-GRP-OVRD NOT = 'G'))
00716               OR
00717            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
00718            (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
00719            (AM-IG NOT = '2'))
00720               GO TO 03XX-GET-LIFE-ERPLAN.
00721
00722      IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
00723        AND
00724         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00725         IF CF-REDUCING (SUB3)
00726            IF (PB-I-INDV-GRP-OVRD = 'G')
00727               OR
00728            ((AM-IG = '2') AND
00729            (PB-I-INDV-GRP-OVRD NOT = 'I'))
00730               OR
00731            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
00732            (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
00733            (AM-IG NOT = '1'))
00734               GO TO 03XX-GET-LIFE-ERPLAN.
00735
00736      IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
00737        AND
00738         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00739         IF CF-LEVEL    (SUB3)
00740            IF (PB-I-INDV-GRP-OVRD = 'I')
00741               OR
00742            ((AM-IG = '1') AND
00743            (PB-I-INDV-GRP-OVRD NOT = 'G'))
00744               OR
00745            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
00746            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
00747             (AM-IG NOT = '2'))
00748               GO TO 03XX-GET-LIFE-ERPLAN.
00749
00750      IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
00751        AND
00752         (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00753         IF CF-LEVEL    (SUB3)
00754            IF (PB-I-INDV-GRP-OVRD = 'G')
00755               OR
00756            ((AM-IG = '2') AND
00757            (PB-I-INDV-GRP-OVRD NOT = 'G'))
00758               OR
00759            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
00760            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
00761            (AM-IG NOT = '1'))
00762               GO TO 03XX-GET-LIFE-ERPLAN.
00763
00764      IF SUB5 LESS THAN +20
00765         ADD +1                   TO SUB5
00766         GO TO 03XX-EDIT-FOR-NINETY-LF.
00767
00768      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
00769
00770      IF  PB-COMPANY-ID NOT EQUAL 'DMD'
00771         GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
00772
00773      MOVE +1                     TO SUB5.
00774
00775  03XX-EDIT-DMD-EXTRA-NINETY-LF.
00776
00777      MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
00778                                  TO WS-SAVE-ALLOWABLE-BENEFIT.
00779
00780      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
00781        AND
00782         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00783         GO TO 03XX-GET-LIFE-ERPLAN.
00784
00785      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
00786        AND
00787         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00788         IF CF-REDUCING (SUB3)
00789            IF (PB-I-INDV-GRP-OVRD = 'I')
00790               OR
00791            ((AM-IG = '1') AND
00792            (PB-I-INDV-GRP-OVRD NOT = 'G'))
00793               OR
00794            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
00795            (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
00796            (AM-IG NOT = '2'))
00797               GO TO 03XX-GET-LIFE-ERPLAN.
00798
00799      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
00800        AND
00801         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00802         IF CF-REDUCING (SUB3)
00803            IF (PB-I-INDV-GRP-OVRD = 'G')
00804               OR
00805            ((AM-IG = '2') AND
00806            (PB-I-INDV-GRP-OVRD NOT = 'I'))
00807               OR
00808            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
00809            (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
00810            (AM-IG NOT = '1'))
00811               GO TO 03XX-GET-LIFE-ERPLAN.
00812
00813      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
00814        AND
00815         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00816         IF CF-LEVEL    (SUB3)
00817            IF (PB-I-INDV-GRP-OVRD = 'I')
00818               OR
00819            ((AM-IG = '1') AND
00820            (PB-I-INDV-GRP-OVRD NOT = 'G'))
00821               OR
00822            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
00823            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
00824             (AM-IG NOT = '2'))
00825               GO TO 03XX-GET-LIFE-ERPLAN.
00826
00827      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
00828        AND
00829         (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
00830         IF CF-LEVEL    (SUB3)
00831            IF (PB-I-INDV-GRP-OVRD = 'G')
00832               OR
00833            ((AM-IG = '2') AND
00834            (PB-I-INDV-GRP-OVRD NOT = 'G'))
00835               OR
00836            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
00837            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
00838            (AM-IG NOT = '1'))
00839               GO TO 03XX-GET-LIFE-ERPLAN.
00840
00841      IF SUB5 LESS THAN +30
00842         ADD +1                   TO SUB5
00843         GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
00844
00845      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
00846
00847  03XX-EDIT-FOR-NINETY-LF-CONT.
00848
00849      MOVE +99                    TO SUB5.
00850
00851      IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
00852         IF PB-ISSUE
00853            MOVE ER-1924          TO  WS-ERROR
00854            PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
00855
00856      GO TO 0304-LIFE-BENEFIT-FOUND.
00857
00858  03XX-GET-LIFE-ERPLAN.
00859
00860      IF WK-PLAN-ADDR EQUAL +0
00861         GO TO 03XX-ERPLAN-LIFE-GETMAIN.
00862
00863      MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
00864      SET ERPLAN-FILE-ADDRESSED   TO TRUE.
00865      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
00866      MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
00867      MOVE 'Y'                    TO PLAN-MASTER-SW
00868                                     PLAN-MASTER-LIFE-SW.
00869      GO TO XXXX-CHECK-LF-PLAN-KEY.
00870
00871  03XX-ERPLAN-LIFE-GETMAIN.
00872
00873      PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
00874      MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
00875
00876  03XX-ERPLAN-LIFE-READ.
00877
00878      MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
00879      MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
00880      MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
00881      MOVE PB-SV-STATE            TO PLAN-STATE.
00882      MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
00883      MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
00884      MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
00885      MOVE WS-SAVE-BENEFIT-REVISION
00886                                  TO PLAN-REVISION-NO.
00887
00888      PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
00889      MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
00890
00891      IF PB-COMPANY-ID = 'NCL'
00892        IF NOT LF-PLAN-MASTER-FOUND
00893          IF NOT PB-POLICY-IS-DECLINED  AND
00894             NOT PB-POLICY-IS-VOIDED
00895              MOVE  ER-1921         TO  WS-ERROR
00896              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
00897              GO TO 0304-LIFE-BENEFIT-FOUND.
00898
00899      IF NOT LF-PLAN-MASTER-FOUND
00900         GO TO 0304-LIFE-BENEFIT-FOUND.
00901
00902  XXXX-CHECK-LF-PLAN-KEY.
00903
00904      IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
00905         (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
00906         (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
00907         (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
00908         (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
00909         (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
00910         (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
00911         (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
00912         MOVE 'N'                 TO PLAN-MASTER-SW
00913           GO TO 03XX-ERPLAN-LIFE-READ.
00914
00915      MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
00916
00917      IF  PB-CANCELLATION
00918          GO TO  0303-LF-ACCT-BEN-FOUND.
00919
00920      IF PL-EDIT-FOR-FORM EQUAL 'Y'
00921         IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
00922            (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
00923            IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
00924               MOVE ER-2644             TO WS-ERROR
00925               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00926            ELSE
00927               NEXT SENTENCE
00928         ELSE
00929            IF PB-COMPANY-ID NOT = 'NCL'
00930               IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
00931                  MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
00932
00933  0303-LF-ACCT-BEN-FOUND.
00934
00935      MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
00936
00937      IF PL-DEV-CODE NOT = SPACES
00938         MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
00939
00940      IF PL-DEV-PCT NUMERIC AND
00941         PL-DEV-PCT NOT = ZEROS
00942         MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
00943
00944      IF PL-TOL-PREM-AMT GREATER THAN +0
00945         MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
00946
00947      IF PL-TOL-REF-AMT GREATER THAN +0
00948         MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
00949
00950      IF PL-TOL-PREM-PCT GREATER THAN +0
00951         MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
00952
00953      IF PL-TOL-REF-PCT GREATER THAN +0
00954         MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
00955
00956      IF PL-TOL-CLM-AMT GREATER THAN +0
00957         MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
00958
00959      IF PL-OVER-SHORT-AMT NUMERIC  AND
00960                           PL-OVER-SHORT-AMT > +0
00961         MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
00962
00963      IF PL-OVER-SHORT-PCT NUMERIC  AND
00964                           PL-OVER-SHORT-PCT > +0
00965         MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
00966
00967      IF PL-SALES-TAX NUMERIC AND
00968                           PL-SALES-TAX > +0
00969          MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
00970
00971      IF PL-IG NOT EQUAL SPACES AND ZEROS
00972         MOVE PL-IG               TO WS-IG-OVRD-LF-PL
00973                                     WS-IG-OVRD-AM.
00974
00975  0304-LIFE-BENEFIT-FOUND.
00976
00977      MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
00978
00979      IF PB-ISSUE
00980         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
00981      ELSE
00982         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
00983
00984      MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
00985      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
00986      MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
00987      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
00988      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
00989                                          WS-LF-REFUND-CALC.
00990
00991      IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
00992         MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
00993
00994      IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
00995         MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
100703     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
00996
00997      MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
00998      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
00999      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
01000      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
01001      MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
01002      MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
01003
01004      IF PB-COMPANY-ID = 'NCL'  AND
01005         CF-SPECIAL-CALC-CD (SUB3)  =  'O'
01006          NEXT SENTENCE
01007      ELSE
01008          IF SUB5 NOT GREATER THAN +20
01009             IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
01010                MOVE WS-SAVE-BENEFIT-REM-TERM
01011                                       TO WS-AM-LF-BENE-REM-TERM
01012                                          EC-BR-LF-REM-TERM-CALC.
01013
01014      MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
01015      MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
01016
01017      GO TO 0310-FIND-AH-BENEFIT-RECORD.
01018
01019  0305-BENEFIT-NOT-FOUND.
01020
01021      MOVE '1'                    TO LF-BENEFIT-ERROR.
01022      MOVE ER-2604                TO WS-ERROR.
01023      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01024
01025      EJECT
01026
01027  0310-FIND-AH-BENEFIT-RECORD.
01028
01029      MOVE 'N'                    TO PLAN-MASTER-SW
01030                                     PLAN-MASTER-AH-SW.
01031
01032      MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
01033                                     WS-PL-TOL-AH-REFUND
01034                                     WS-AH-PL-REF-OVS-AMT
01035                                     WS-PL-TOL-AH-PREM-PCT
01036                                     WS-PL-TOL-AH-REFUND-PCT
01037                                     WS-AH-PL-REF-OVS-PCT
01038                                     WS-PL-TOL-AH-CLAIM.
           MOVE ' '                    TO WS-AH-DCC-TRUNC
01039
01040
           if pb-issue
01041         IF PB-I-AH-INPUT-CD EQUAL ZEROS
01042            MOVE SPACES              TO PB-I-AH-INPUT-CD
              end-if
01044         IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
01045            and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
01046            GO TO 0399-BENEFIT-NOT-FOUND
              end-if
           end-if
01047
01048      IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
01049         GO TO 0400-FIND-CARRIER.
01050
01051      MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
01052
01053      IF WK-AH-BEN-ADDR NOT = ZEROS
01054          MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
01055          SET ELCNTL-FILE-ADDRESSED TO TRUE
01056          PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
01057          IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
01058            AND NOT LESS THAN CF-BENEFIT-CODE (1)
01059              GO TO 0311-AH-BENEFIT-SEARCH
01060          ELSE
01061              NEXT SENTENCE
01062      ELSE
01063          PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
01064
01065      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
01066      MOVE '5'                    TO CNTL-REC-TYPE.
01067      MOVE +0                     TO CNTL-SEQ-NO.
01068      MOVE WS-ACCESS              TO CNTL-ACCESS.
01069
01070      MOVE '2' TO RC-SW-2.
01071      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
01072
01073      IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
01074         (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
01075           GO TO 0399-BENEFIT-NOT-FOUND.
01076
01077      MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
01078
01079  0311-AH-BENEFIT-SEARCH.
01080
01081      PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
01082
01083      IF NO-BENEFIT-FOUND
01084          GO TO 0399-BENEFIT-NOT-FOUND.
01085
01086      IF WS-BEN-CD = '99'
01087         GO TO 0399-BENEFIT-NOT-FOUND.
01088
01089      IF PB-COMPANY-ID  =  'NCL'
01090          IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
01091              GO TO 0314-A-H-BENEFIT-FOUND.
01092
01093      MOVE +1                     TO SUB5.
01094      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
01095
01096 * FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
01097 * BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
01098      IF PB-COMPANY-ID = 'DMD'
01099          MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
01100
01101  0312-EDIT-ACCT-AH-BENEFITS.
01102
01103      IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
01104         IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
01105            MOVE AM-ALLOWABLE-BENEFITS (SUB5)
01106                                  TO WS-SAVE-ALLOWABLE-BENEFIT
01107            GO TO 03XX-GET-AH-ERPLAN.
01108
01109      IF SUB5 LESS THAN +20
01110         ADD +1                   TO SUB5
01111         GO TO 0312-EDIT-ACCT-AH-BENEFITS.
01112
01113      MOVE +1                     TO SUB5.
01114
01115      IF  PB-COMPANY-ID NOT EQUAL 'DMD'
01116         GO TO 03XX-EDIT-FOR-NINETY-AH.
01117
01118  0313-EDIT-DMD-EXTRA-BENEFITS.
01119
01120      IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
01121         IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
01122            MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
01123                                  TO WS-SAVE-ALLOWABLE-BENEFIT
01124            GO TO 03XX-GET-AH-ERPLAN.
01125
01126      IF SUB5 LESS THAN +30
01127         ADD +1                   TO SUB5
01128         GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
01129
01130      MOVE +1                     TO SUB5.
01131
01132  03XX-EDIT-FOR-NINETY-AH.
01133
01134 ***************************************************************
01135 *                                                             *
01136 *    NINETY BENEFIT PLAN TYPES:                               *
01137 *                                                             *
01138 *      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
01139 *      92 = ALL GROUP REDUCING BENEFITS.                      *
01140 *      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
01141 *           BENEFIT CONTROLS.                                 *
01142 *      99 = ALL BENEFITS.                                     *
01143 *                                                             *
01144 ***************************************************************
01145
01146      MOVE AM-ALLOWABLE-BENEFITS (SUB5)
01147                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
01148
01149      IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
01150        AND
01151         AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
01152         GO TO 03XX-GET-AH-ERPLAN.
01153
01154      IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
01155        AND
01156         AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
01157            IF (PB-I-INDV-GRP-OVRD = 'I')
01158               OR
01159            ((AM-IG = '1') AND
01160            (PB-I-INDV-GRP-OVRD NOT = 'G'))
01161               OR
01162            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
01163            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
01164            (AM-IG NOT = '2'))
01165               GO TO 03XX-GET-AH-ERPLAN.
01166
01167      IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
01168        AND
01169         AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
01170            IF (PB-I-INDV-GRP-OVRD = 'G')
01171               OR
01172            ((AM-IG = '2') AND
01173            (PB-I-INDV-GRP-OVRD NOT = 'I'))
01174               OR
01175            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
01176            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
01177            (AM-IG NOT = '1'))
01178               GO TO 03XX-GET-AH-ERPLAN.
01179
01180      IF SUB5 LESS THAN +20
01181         ADD +1                   TO SUB5
01182         GO TO 03XX-EDIT-FOR-NINETY-AH.
01183
01184      IF  PB-COMPANY-ID NOT EQUAL 'DMD'
01185         GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
01186
01187      MOVE +1                    TO SUB5.
01188
01189  03XX-EDIT-DMD-EXTRA-NINETY-AH.
01190
01191      MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
01192                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
01193
01194      IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
01195        AND
01196         AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
01197         GO TO 03XX-GET-AH-ERPLAN.
01198
01199      IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
01200        AND
01201         AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
01202            IF (PB-I-INDV-GRP-OVRD = 'I')
01203               OR
01204            ((AM-IG = '1') AND
01205            (PB-I-INDV-GRP-OVRD NOT = 'G'))
01206               OR
01207            ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
01208            (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
01209            (AM-IG NOT = '2'))
01210               GO TO 03XX-GET-AH-ERPLAN.
01211
01212      IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
01213        AND
01214         AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
01215            IF (PB-I-INDV-GRP-OVRD = 'G')
01216               OR
01217            ((AM-IG = '2') AND
01218            (PB-I-INDV-GRP-OVRD NOT = 'I'))
01219               OR
01220            ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
01221            (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
01222            (AM-IG NOT = '1'))
01223               GO TO 03XX-GET-AH-ERPLAN.
01224
01225      IF SUB5 LESS THAN +30
01226         ADD +1                   TO SUB5
01227         GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
01228
01229  03XX-EDIT-FOR-NINETY-AH-CONT.
01230
01231      MOVE +99                    TO SUB5.
01232
01233      MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
01234
01235      IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
01236         IF PB-ISSUE
01237            MOVE ER-1925          TO  WS-ERROR
01238            PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
01239
01240      GO TO 0314-A-H-BENEFIT-FOUND.
01241
01242  03XX-GET-AH-ERPLAN.
01243
01244      IF WK-PLAN-ADDR EQUAL +0
01245          GO TO 03XX-ERPLAN-AH-GETMAIN.
01246
01247      MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
01248      SET ERPLAN-FILE-ADDRESSED   TO TRUE.
01249      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
01250      MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
01251      MOVE 'Y'                    TO PLAN-MASTER-SW
01252                                     PLAN-MASTER-AH-SW.
01253 *****GO TO XXXX-CHECK-AH-PLAN-KEY.
01254      GO TO 03XX-ERPLAN-AH-READ.
01255
01256  03XX-ERPLAN-AH-GETMAIN.
01257
01258      PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
01259      MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
01260
01261  03XX-ERPLAN-AH-READ.
01262
01263      MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
01264      MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
01265      MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
01266      MOVE PB-SV-STATE            TO PLAN-STATE.
01267      MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
01268      MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
01269      MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
01270      MOVE WS-SAVE-BENEFIT-REVISION
01271                                  TO PLAN-REVISION-NO.
01272
01273      PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
01274      MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
01275
01276      IF PB-COMPANY-ID = 'NCL'
01277        IF NOT AH-PLAN-MASTER-FOUND
01278          IF NOT PB-POLICY-IS-DECLINED  AND
01279             NOT PB-POLICY-IS-VOIDED
01280              MOVE  ER-1922         TO  WS-ERROR
01281              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
01282              GO TO 0314-A-H-BENEFIT-FOUND.
01283
01284      IF NOT AH-PLAN-MASTER-FOUND
01285         GO TO 0314-A-H-BENEFIT-FOUND.
01286
01287  XXXX-CHECK-AH-PLAN-KEY.
01288
01289      IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
01290         (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
01291         (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
01292         (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
01293         (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
01294         (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
01295         (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
01296         (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
01297         MOVE 'N'                 TO PLAN-MASTER-SW
01298           GO TO 03XX-ERPLAN-AH-READ.
01299
01300      MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
01301
01302      IF  PB-CANCELLATION
01303          GO TO  0313-AH-ACCT-BEN-FOUND.
01304
01305      IF PL-EDIT-FOR-FORM EQUAL 'Y'
01306        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
01307           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
01308           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
01309              MOVE ER-2644             TO WS-ERROR
01310              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01311           ELSE
01312              NEXT SENTENCE
01313        ELSE
01314           IF PB-COMPANY-ID NOT = 'NCL'
01315              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
01316                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
01317
01318  0313-AH-ACCT-BEN-FOUND.
01319
01320      MOVE PL-REVISION-NO         TO WS-AH-REVISION.
01321
01322      IF PL-DEV-CODE NOT = SPACES
01323         MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
01324
01325      IF PL-DEV-PCT NUMERIC AND
01326         PL-DEV-PCT NOT = ZEROS
01327         MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
01328
01329      IF PL-TOL-PREM-AMT NOT EQUAL +0
01330         MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
01331
01332      IF PL-TOL-REF-AMT NOT EQUAL +0
01333         MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
01334
01335      IF PL-TOL-PREM-PCT GREATER THAN +0
01336         MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
01337
01338      IF PL-TOL-REF-PCT GREATER THAN +0
01339         MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
01340
01341      IF PL-TOL-CLM-AMT NOT EQUAL +0
01342         MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
01343
01344      IF PL-OVER-SHORT-AMT NUMERIC AND
01345                           PL-OVER-SHORT-AMT > +0
01346         MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
01347
01348      IF PL-OVER-SHORT-PCT NUMERIC AND
01349                           PL-OVER-SHORT-PCT > +0
01350         MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
01351
01352      IF PL-IG NOT EQUAL SPACES AND ZEROS
01353         MOVE PL-IG               TO WS-IG-OVRD-AH-PL
01354         IF WS-IG-OVRD-AM EQUAL SPACES
01355             MOVE PL-IG           TO WS-IG-OVRD-AM.
01356
01357  0314-A-H-BENEFIT-FOUND.
01358
01359      MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
01360
01361      IF PB-ISSUE
01362         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
01363        ELSE
01364         MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
01365
01366      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
01367      MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
01368      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
01369      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
01370                                          WS-AH-REFUND-CALC.
01371
01372      IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
01373         MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
01374
01375      IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
01376         MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
100703     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
01377
01378      MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
01379      MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
01380      MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
01381      MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
01382      MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
01383      MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
01384
01385      IF PB-COMPANY-ID = 'NCL'  AND
01386         CF-SPECIAL-CALC-CD (SUB3)  =  'O'
01387          NEXT SENTENCE
01388      ELSE
01389          IF SUB5 NOT GREATER THAN +20
01390             IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
01391                 MOVE WS-SAVE-BENEFIT-REM-TERM
01392                                       TO WS-AM-AH-BENE-REM-TERM
01393                                          EC-BR-AH-REM-TERM-CALC.
01394
01395      MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
01396      MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
01397
01398      GO TO 0400-FIND-CARRIER.
01399
01400  0399-BENEFIT-NOT-FOUND.
01401
01402      MOVE '1'                    TO AH-BENEFIT-ERROR.
01403      MOVE ER-2605                TO WS-ERROR.
01404      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01405
01406      EJECT
01407
01408  0400-FIND-CARRIER.
01409
01410      MOVE PB-SV-CARRIER          TO WS-CARR.
01411
01412      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
01413      MOVE ZEROS                  TO CNTL-SEQ-NO.
01414      MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
01415      MOVE '6'                    TO CNTL-REC-TYPE.
01416
01417 *INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
01418      MOVE SPACE                  TO WS-DMD-RATING-SW
01419                                     EC-BR-DMD-RATING-SW.
01420
01421      MOVE '2'                    TO RC-SW-1.
01422      PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
01423
01424      IF NOT CF-CARRIER-MASTER
01425         GO TO 0400-CARRIER-NOT-FOUND.
01426
01427  0400-BUILD-CARR-TOL.
01428
01429      IF CF-CR-TOL-PREM NUMERIC AND
01430         CF-CR-TOL-PREM GREATER THAN +0
01431         MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
01432                                     WS-TOL-AH-PREM.
01433
01434      IF CF-CR-TOL-REFUND NUMERIC AND
01435         CF-CR-TOL-REFUND GREATER THAN +0
01436         MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
01437                                     WS-TOL-AH-REFUND.
01438
01439      IF CF-CR-OVR-SHT-AMT NUMERIC AND
01440         CF-CR-OVR-SHT-AMT GREATER THAN +0
01441         MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
01442                                     WS-AH-REFUND-OVS-AMT.
01443
01444      IF CF-CR-OVR-SHT-PCT NUMERIC AND
01445         CF-CR-OVR-SHT-PCT GREATER THAN +0
01446         MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
01447                                     WS-AH-REFUND-OVS-PCT.
01448
01449      IF CF-CR-TOL-PREM-PCT NUMERIC AND
01450         CF-CR-TOL-PREM-PCT GREATER THAN +0
01451         MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
01452                                     WS-TOL-AH-PREM-PCT.
01453
01454      IF CF-CR-TOL-REFUND-PCT NUMERIC AND
01455         CF-CR-TOL-REFUND-PCT GREATER THAN +0
01456         MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
01457                                      WS-TOL-AH-REFUND-PCT.
01458
01459      IF CF-COMPANY-ID EQUAL 'DMD'
01460          MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
01461                                     EC-BR-DMD-RATING-SW.
01462
           MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
100703     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
100703        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
100703     END-IF
092705     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
092705        MOVE +0                  TO CF-CARRIER-LEASE-COMM
092705     END-IF
100703     IF WS-TOL-CLP-PCT = ZEROS
100703        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
100703     END-IF
100703
092705     IF WS-SPP-LEASE-COMM = ZEROS
092705        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
092705     END-IF
01463      GO TO 0400-FIND-ERPDEF.
01464
01465  0400-CARRIER-NOT-FOUND.
01466
01467      MOVE ER-2602                TO WS-ERROR.
01468      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01469
       0400-FIND-ERPDEF.
           IF PB-COMPANY-ID = 'DCC'
              AND AM-DCC-PRODUCT-CODE = 'DDF'
              CONTINUE
           ELSE
              GO TO 0400-FIND-ERCOMP
           END-IF
           MOVE ' '                    TO PDEF-MASTER-SW
           MOVE PB-COMPANY-CD          TO ERPDEF-KEY
           MOVE PB-STATE               TO ERPDEF-STATE
           MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
           MOVE 'A'                    TO ERPDEF-BEN-TYPE
           IF PB-ISSUE
              MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
           ELSE
              MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
           END-IF
           MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
           MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
           PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
           IF PDEF-MASTER-FOUND
              MOVE 'N'                 TO PDEF-MASTER-SW
              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
              IF PDEF-MASTER-FOUND
                 IF (ERPDEF-KEY-SAVE (1:16) =
                              PD-CONTROL-PRIMARY (1:16))
                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
                    CONTINUE
                 ELSE
                    PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
                    IF (ERPDEF-KEY-SAVE (1:16) =
                              PD-CONTROL-PRIMARY (1:16))
                       AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
                       CONTINUE
                    ELSE
                       MOVE 'N'        TO PDEF-MASTER-SW
                    END-IF
                 END-IF
              END-IF
              PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
           END-IF
           IF PDEF-MASTER-FOUND
              IF PD-TRUNCATED = 'Y'
                 MOVE 'T'              TO WS-AH-DCC-TRUNC
              END-IF
           END-IF
           .
100703 0400-FIND-ERCOMP.
080805     IF PB-COMPANY-ID = 'DCC'
080805        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
080805           (WS-SUB1 > +10)
052306           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
071211                 OR 'A' OR 'N'
080805              MOVE PB-COMPANY-CD TO COMP-COMP-CD
080805              MOVE PB-CARRIER    TO COMP-CARRIER
080805              MOVE PB-GROUPING   TO COMP-GROUPING
080805              MOVE LOW-VALUES    TO COMP-ACCOUNT
080805              MOVE AM-AGT (WS-SUB1)
                                       TO COMP-FIN-RESP
080805              MOVE 'G'           TO COMP-TYPE
080805              PERFORM 8582-READ-COMPENSATION-MASTER
080805                                 THRU 8582-EXIT
080805              IF COMP-MASTER-FOUND
080805                 IF CO-GA-INACTIVE
080805                    MOVE ER-2763 TO WS-ERROR
080805                    PERFORM 9900-ERROR-FORMAT
080805                                 THRU 9900-EXIT
080805                    MOVE +11     TO WS-SUB1
080805                 END-IF
042106                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
042106                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
042106                    MOVE ER-2788 TO WS-ERROR
042106                    PERFORM 9900-ERROR-FORMAT
042106                                 THRU 9900-EXIT
042106                    MOVE +11     TO WS-SUB1
042106                 END-IF
080805              END-IF
080805           END-IF
080805        END-PERFORM
080805     END-IF
071211     IF PB-COMPANY-ID = 'DCC'
071211        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
071211           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
071211                                    WS-CLP-STATE
071211        ELSE
071211           MOVE SPACES           TO PB-I-CLP-STATE
071211                                    WS-CLP-STATE
071211        END-IF
071211     END-IF
071211
071211     IF (PB-COMPANY-ID = 'DCC')
071211        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
071211        CONTINUE
071211     ELSE
071211        GO TO 0400-FIND-STATE-RECORD
071211     END-IF
100703     MOVE SPACES                 TO WS-CLP-STATE
100703     MOVE +0                     TO WS-BANK-FEE
092205                                    WS-BANK-LFEE
100703                                    WS-BANK-NOCHRGB
100703
100703     MOVE LOW-VALUES             TO COMP-FIN-RESP
100703     IF (PB-ISSUE)
100703        AND (PB-I-BANK-NUMBER NOT =
                  SPACES AND ZEROS AND LOW-VALUES)
100703        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
100703     ELSE
100703        IF (PB-CANCELLATION)
100703           AND (PB-CI-BANK-NUMBER NOT =
                      SPACES AND ZEROS AND LOW-VALUES)
100703           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
100703        END-IF
100703     END-IF
100703     IF COMP-FIN-RESP NOT = LOW-VALUES
100703        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
100703        MOVE PB-CARRIER          TO COMP-CARRIER
100703        MOVE PB-GROUPING         TO COMP-GROUPING
100703        MOVE LOW-VALUES          TO COMP-ACCOUNT
100703        MOVE 'B'                 TO COMP-TYPE
100703        PERFORM 8582-READ-COMPENSATION-MASTER
100703                                 THRU 8582-EXIT
100703        IF COMP-MASTER-FOUND
100703           IF CO-MAX-BANK-FEE NOT NUMERIC
100703              MOVE +0            TO CO-MAX-BANK-FEE
100703           END-IF
100703           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
100703              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
100703           END-IF
080805           IF CO-GA-INACTIVE
080805              MOVE ER-2763       TO WS-ERROR
080805              PERFORM 9900-ERROR-FORMAT
080805                                 THRU 9900-EXIT
080805           END-IF
042106           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
042106              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
042106              MOVE ER-2788 TO WS-ERROR
042106              PERFORM 9900-ERROR-FORMAT
042106                                 THRU 9900-EXIT
042106              MOVE +11     TO WS-SUB1
042106           END-IF
092205           IF WS-AH-BEN-CATEGORY = 'G'
100703              MOVE CO-MAX-BANK-FEE
092205                                 TO WS-BANK-FEE
092205                                    PB-I-BANK-FEE
092205           ELSE
092205              MOVE CO-MAX-BANK-FEE-LEASE
092205                                 TO WS-BANK-LFEE
092205                                    PB-I-BANK-FEE
092205           END-IF
                 IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
                    AND (WS-AH-REFUND-CALC = 'G'))
                              OR
                    ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
                    AND (WS-AH-REFUND-CALC NOT = 'G'))
                    CONTINUE
                 ELSE
                    MOVE ER-2789 TO WS-ERROR
                    PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 END-IF
100703           MOVE CO-CLP-STATE     TO WS-CLP-STATE
020305                                    PB-I-CLP-STATE
                 MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
                 MOVE CO-CARRIER       TO BXRF-CARRIER
                 MOVE CO-GROUPING      TO BXRF-GROUPING
                 MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
                 MOVE BXRF-MAX-REC-LENGTH
                                       TO BXRF-REC-LENGTH
                 PERFORM 8584-READ-BANK-CROSS-REF
                                       THRU 8584-EXIT
                 IF BXRF-MASTER-FOUND
                    MOVE ' '           TO BANK-ACCT-SW
                    MOVE BK-BANK-POINTER-CNT
                                       TO BK-BANK-POINTER-CNT
                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
                       (WS-SUB1 > BK-BANK-POINTER-CNT)
                       OR (BANK-ACCT-FOUND)
                       IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
                          AND (BK-AM-EXP-DT (WS-SUB1)
                                       > PB-CERT-EFF-DT)
                          AND (BK-AM-EFF-DT (WS-SUB1)
                                       NOT > PB-CERT-EFF-DT)
                          SET BANK-ACCT-FOUND TO TRUE
                       END-IF
                    END-PERFORM
                    IF NOT BANK-ACCT-FOUND
                       MOVE ZEROS      TO WS-BANK-FEE
092205                                    WS-BANK-LFEE
100703                 MOVE ER-2869    TO WS-ERROR
100703                 PERFORM 9900-ERROR-FORMAT
100703                                 THRU 9900-EXIT
111504              ELSE
030905                 PERFORM 5000-PROCESS-REPS
                                       THRU 5000-EXIT
111504                 IF AGENT-MASTER-FOUND
092205                    MOVE +0      TO WS-BANK-FEE
092205                                    WS-BANK-LFEE
      *                   MOVE AG-SPP-FEES (1)
      *                                TO PB-I-BANK-FEE
      *                                   WS-BANK-FEE
111504                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
111504                       (WS-SUB1 > +10)
111504                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
111504                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
111504                       END-IF
111504                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
111504                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
111504                       END-IF
111504                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
111504                          AG-SPP-FEES (WS-SUB1)
111504                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
111504                          AG-SPP-LFEES (WS-SUB1)
111504                    END-PERFORM
092205                    IF WS-AH-BEN-CATEGORY = 'G'
                             MOVE WS-BANK-FEE
                                       TO PB-I-BANK-FEE
                          ELSE
                             MOVE WS-BANK-LFEE
                                       TO PB-I-BANK-FEE
                          END-IF
111504                 END-IF
100703              END-IF
                 END-IF
              ELSE
020305           MOVE ER-2879          TO WS-ERROR
020305           PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
100703        END-IF
020305     ELSE
020305        MOVE ER-2879             TO WS-ERROR
020305        PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
100703     END-IF
092205     IF WS-AH-BEN-CATEGORY = 'G'
              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
              + WS-BANK-FEE
           ELSE
              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
              + WS-BANK-LFEE
           END-IF
           .
01470  0400-FIND-STATE-RECORD.
01471
01472      IF WK-STATE-ADDR NOT = ZEROS
01473          MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
01474          SET ELCNTL-FILE-ADDRESSED TO TRUE
01475          PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
01476          PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
01477          IF PB-SV-STATE = CF-STATE-CODE
01478              GO TO 0405-CONTINUE-EDIT
01479          ELSE
01480              NEXT SENTENCE
01481      ELSE
01482          PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
01483
01484      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
01485      MOVE PB-SV-STATE            TO CNTL-ACCESS.
01486      MOVE '3'                    TO CNTL-REC-TYPE.
01487      MOVE +0                     TO CNTL-SEQ-NO.
01488
01489      MOVE '3'                    TO RC-SW-2.
01490      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
01491
01492      IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
01493         CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
01494         PB-SV-STATE   NOT = CF-STATE-CODE)
01495         MOVE ZEROS               TO WS-TOL-LF-CLAIM
01496                                     WS-TOL-AH-CLAIM
01497                                     WS-MINIMUM-REFUND
01498                                     WS-TOL-LF-PREM
01499                                     WS-TOL-AH-PREM
01500                                     WS-TOL-LF-REFUND
01501                                     WS-TOL-AH-REFUND
01502                                     EC-ST-TOL-PREM-PCT
01503                                     WS-TOL-LF-PREM-PCT
01504                                     WS-TOL-AH-PREM-PCT
01505                                     EC-ST-TOL-REFUND-PCT
01506                                     WS-TOL-LF-REFUND-PCT
01507                                     WS-TOL-AH-REFUND-PCT
01508                                     EC-ST-TOL-PREM
01509                                     EC-ST-TOL-REFUND
01510                                     EC-ST-FST-PMT-DAYS-MAX
01511                                     WS-FREE-LOOK-PERIOD
PEMMOD                                    WS-ST-LF-PREM-TAX
PEMMOD                                    WS-ST-AH-PREM-TAX-I
PEMMOD                                    WS-ST-AH-PREM-TAX-G
100703                                    WS-BANK-FEE
092205                                    WS-BANK-LFEE
100703                                    WS-TOL-CLP-PCT
092705                                    WS-SPP-LEASE-COMM
01512         MOVE SPACES              TO WS-STATE-ABBREVIATION
01513                                     EC-ST-FST-PMT-DAYS-CHG
01514                                     WS-LF-REM-TERM-CALC
01515                                     WS-LF-REFUND-CALC
01516                                     EC-ST-LF-REM-TERM-CALC
01517                                     EC-ST-LF-REFUND-CALC
01518                                     WS-AH-REM-TERM-CALC
01519                                     WS-AH-REFUND-CALC
100703                                    WS-LF-BEN-CATEGORY
100703                                    WS-AH-BEN-CATEGORY
100703                                    WS-CLP-STATE
042310                                    WS-ST-REFUND-CLAIM-FLAG
01520                                     EC-ST-AH-REM-TERM-CALC
01521                                     EC-ST-AH-REFUND-CALC
01522           GO TO 0499-STATE-NOT-FOUND.
01523
01524      MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
01525
01526  0405-CONTINUE-EDIT.
082203
040512     if pb-company-id = 'AHL'
040512        continue
040512     else
030807        IF PB-CERT-PRIME NOT NUMERIC
030807           MOVE ER-2722          TO WS-ERROR
030807           PERFORM 9900-ERROR-FORMAT
030807                                 THRU 9900-EXIT
040512        end-if
030807     END-IF
030807*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
030807*       MOVE +0                  TO SUB3
030807*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
030807*       IF SUB3 > +0
030807*          MOVE ER-2722          TO WS-ERROR
030807*          PERFORM 9900-ERROR-FORMAT
030807*                                THRU 9900-EXIT
030807*       END-IF
030807*    END-IF
082203*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
082203*       IF PB-CERT-PRIME NOT NUMERIC
      *          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
      *          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
      *          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
      *          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
      *
082203*          MOVE ER-2722          TO WS-ERROR
082203*          PERFORM 9900-ERROR-FORMAT
082203*                                THRU 9900-EXIT
082203*       END-IF
082203*    END-IF
082203
01527      MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
01528
01529      IF CF-ST-TOL-CLAIM NOT = ZEROS
01530         MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
01531                                     WS-TOL-AH-CLAIM.
01532
01533      IF CF-ST-REFUND-MIN NOT NUMERIC
01534         MOVE ZEROS               TO CF-ST-REFUND-MIN.
01535
01536      IF CF-ST-REFUND-MIN NOT = ZEROS
01537         MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
01538
01539      IF CF-ST-TOL-PREM  NOT = ZEROS
01540         MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
01541                                     WS-TOL-AH-PREM
01542         MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
01543
01544      IF CF-ST-TOL-REFUND NOT = ZEROS
01545         MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
01546                                     WS-TOL-AH-REFUND
01547         MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
01548
01549      IF CF-ST-OVR-SHT-AMT NUMERIC AND
01550         CF-ST-OVR-SHT-AMT GREATER THAN +0
01551         MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
01552                                     WS-AH-REFUND-OVS-AMT
01553                                     EC-ST-OVR-SHT-AMT.
01554
01555      IF CF-ST-TOL-PREM-PCT NUMERIC AND
01556         CF-ST-TOL-PREM-PCT GREATER THAN +0
01557         MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
01558                                     WS-TOL-LF-PREM-PCT
01559                                     WS-TOL-AH-PREM-PCT.
01560
01561      IF CF-ST-TOL-REF-PCT NUMERIC AND
01562         CF-ST-TOL-REF-PCT GREATER THAN +0
01563         MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
01564                                     WS-TOL-LF-REFUND-PCT
01565                                     WS-TOL-AH-REFUND-PCT.
01566
01567      IF CF-ST-OVR-SHT-PCT NUMERIC AND
01568         CF-ST-OVR-SHT-PCT GREATER THAN +0
01569         MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
01570                                     WS-AH-REFUND-OVS-PCT
01571                                     EC-ST-OVR-SHT-PCT.
01572
01573      MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
01574      MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
01575
01576      IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
01577           MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
01578
01579      MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
01580      MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
01582      MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
01583
PEMMOD     IF CF-ST-LF-PREM-TAX NUMERIC
PEMMOD        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
PEMMOD     END-IF
PEMMOD     IF CF-ST-AH-PREM-TAX-I NUMERIC
PEMMOD        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
PEMMOD     END-IF
PEMMOD     IF CF-ST-AH-PREM-TAX-G NUMERIC
PEMMOD        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
PEMMOD     END-IF
PEMMOD
042310     IF CF-ST-REF-AH-DEATH-IND > SPACES
042310         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
042310     END-IF.
042310
01584      IF WS-LF-BENEFIT-CD = ZEROS
01585         GO TO 0410-CHECK-AH.
01586
CIDMOD     IF CF-ST-RT-CALC NOT = SPACES
CIDMOD        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
CIDMOD                                    EC-ST-LF-REM-TERM-CALC
CIDMOD     END-IF
CIDMOD
PEMMOD     IF WS-LF-COVERAGE-TYPE = 'R'
PEMMOD        IF WS-LF-EARNINGS-CALC = '5'
PEMMOD           IF CF-ST-RF-LN-CALC > '0'
PEMMOD              MOVE CF-ST-RF-LN-CALC
PEMMOD                                 TO WS-LF-REFUND-CALC
PEMMOD                                    EC-ST-LF-REFUND-CALC
PEMMOD           END-IF
PEMMOD        ELSE
PEMMOD           IF CF-ST-RF-LR-CALC > '0'
PEMMOD              MOVE CF-ST-RF-LR-CALC
PEMMOD                                 TO WS-LF-REFUND-CALC
PEMMOD                                    EC-ST-LF-REFUND-CALC
PEMMOD           END-IF
PEMMOD        END-IF
PEMMOD     ELSE
PEMMOD        IF CF-ST-RF-LL-CALC > '0'
PEMMOD           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
PEMMOD                                    EC-ST-LF-REFUND-CALC
PEMMOD        END-IF
PEMMOD     END-IF
PEMMOD
CIDMOD     IF CF-ST-RT-CALC NOT = SPACES
CIDMOD        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
CIDMOD                                    EC-ST-LF-REM-TERM-CALC
CIDMOD     END-IF
CIDMOD
01587      MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
01588      MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
01589
01590      PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
01591
01592      IF NO-BENEFIT-FOUND
01593         GO TO 0410-CHECK-AH.
01594
01595      IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
CIDMOD        MOVE CF-ST-REM-TERM-CALC  (SUB3)
CIDMOD                                 TO EC-ST-LF-REM-TERM-CALC
CIDMOD                                    WS-LF-REM-TERM-CALC
CIDMOD     END-IF
01597
01598      IF CF-ST-REFUND-CALC (SUB3) > '0'
01599         MOVE CF-ST-REFUND-CALC (SUB3)
PEMMOD                                 TO WS-LF-REFUND-CALC
PEMMOD                                    EC-ST-LF-REFUND-CALC
PEMMOD     END-IF
PEMMOD*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
01603
01604      .
01605  0410-CHECK-AH.
01606
01607      IF WS-AH-BENEFIT-CD = ZEROS
01608         GO TO 0500-SET-ACCOUNT.
01609
CIDMOD     IF CF-ST-RT-CALC NOT = SPACES
CIDMOD        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
CIDMOD                                    EC-ST-AH-REM-TERM-CALC
CIDMOD     END-IF
CIDMOD
PEMMOD     IF WS-AH-SPECIAL-CALC-CD = 'C'
PEMMOD        IF CF-ST-RF-CP-CALC > '0'
PEMMOD           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
PEMMOD                                    EC-ST-AH-REFUND-CALC
PEMMOD        END-IF
PEMMOD     ELSE
PEMMOD        IF CF-ST-RF-AH-CALC > '0'
PEMMOD           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
PEMMOD                                    EC-ST-AH-REFUND-CALC
PEMMOD        END-IF
PEMMOD     END-IF
01610      MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
01611      MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
01612
01613      PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
01614
01615      IF NO-BENEFIT-FOUND
01616         GO TO 0500-SET-ACCOUNT.
01617
01618      IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
01619         MOVE CF-ST-REM-TERM-CALC (SUB3)
CIDMOD                                 TO WS-AH-REM-TERM-CALC
CIDMOD                                    EC-ST-AH-REM-TERM-CALC
CIDMOD     END-IF
01620
01621      IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
01622         MOVE CF-ST-REFUND-CALC (SUB3)
                                       TO WS-AH-REFUND-CALC
                                          EC-ST-AH-REFUND-CALC
           END-IF
01623
PEMMOD*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
01626
01627      GO TO 0500-SET-ACCOUNT.
01628
01629  0499-STATE-NOT-FOUND.
01630
01631      MOVE ER-2603                TO WS-ERROR.
01632      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01633
01634      EJECT
01635
01636  0500-SET-ACCOUNT.
100703*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
100703     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
100703        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
100703        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
100703        MOVE WS-CLP-STATE        TO CNTL-ACCESS
100703        MOVE '3'                 TO CNTL-REC-TYPE
100703        MOVE +0                  TO CNTL-SEQ-NO
100703
100703        MOVE '3'                 TO RC-SW-2
100703        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
100703
100703        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
100703           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
100703           WS-CLP-STATE  NOT = CF-STATE-CODE)
100703           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
100703                                    WS-ST-AH-PREM-TAX-I
100703                                    WS-ST-AH-PREM-TAX-G
              ELSE
                 IF CF-ST-LF-PREM-TAX NUMERIC
                    MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
                 END-IF
                 IF CF-ST-AH-PREM-TAX-I NUMERIC
                    MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
                 END-IF
                 IF CF-ST-AH-PREM-TAX-G NUMERIC
                    MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
                 END-IF
100703        END-IF
100703        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
100703     END-IF
100703*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
      *  FOR DCC ONLY
071211     IF PB-COMPANY-ID = 'DCC'
071211
071211     MOVE ' '                    TO STAT-MASTER-SW
071211     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
071211     MOVE PB-CARRIER             TO ELSTAT-CARRIER
071211     MOVE PB-GROUPING            TO ELSTAT-GROUP
071211     MOVE PB-STATE               TO ELSTAT-STATE
071211     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
071211        MOVE WS-CLP-STATE        TO ELSTAT-STATE
071211     END-IF
071211
071211     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
071211     SET BIN-TO-GREG             TO TRUE
071211     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
071211     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
071211     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
071211
071211     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
071211     IF STAT-MASTER-FOUND
071211        MOVE 'N'                 TO STAT-MASTER-SW
071211        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
071211        IF STAT-MASTER-FOUND
071211           IF (ELSTAT-KEY-SAVE (1:12) =
071211                        SF-CONTROL-PRIMARY (1:12))
071211              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
071211                 MOVE 'F'        TO STAT-MASTER-SW
071211              ELSE
071211                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
071211                 IF (STAT-MASTER-FOUND)
071211                    AND (ELSTAT-KEY-SAVE (1:12) =
071211                        SF-CONTROL-PRIMARY (1:12))
071211                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
071211                    MOVE 'F'     TO STAT-MASTER-SW
071211                 END-IF
071211              END-IF
071211           END-IF
071211        END-IF
071211     END-IF
071211
071211     IF STAT-MASTER-SW = 'F'
071211        IF SF-ST-LF-PREM-TAX NUMERIC
071211           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
071211        END-IF
071211        IF SF-ST-AH-PREM-TAX-I NUMERIC
071211           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
071211        END-IF
071211        IF SF-ST-AH-PREM-TAX-G NUMERIC
071211           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
071211        END-IF
071211     END-IF
071211
071211     END-IF
           IF (PB-COMPANY-ID = 'DCC')
122807        AND (PB-ISSUE)
              AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
071211        AND (AM-DCC-PRODUCT-CODE = 'DDF')
071211        AND (AM-GPCD = 06)
              MOVE 'Y'                 TO WS-GOOD-HIN
              IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
                 MOVE PB-I-VIN         TO WS-WORK-VIN
                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
                    (V1 > 16)
                    IF WS-WORK-VIN (V1:1) NUMERIC
                       MOVE WS-WORK-VIN-N (V1)
                                       TO WS-ROW-B-VAL (V1)
                    ELSE
                       PERFORM VARYING V2 FROM +1 BY +1 UNTIL
                          (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
                          OR (V2 > 26)
                       END-PERFORM
                       IF V2 < 27
                          MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
                       ELSE
                          MOVE 'N'     TO WS-GOOD-HIN
                       END-IF
                    END-IF
                    COMPUTE WS-ROW-D-VAL (V1) =
                       WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
                    COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
                       WS-ROW-D-VAL (V1)
                 END-PERFORM
                 MOVE ZEROS            TO WS-VIN-REMAINDER
                 DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
                   REMAINDER WS-VIN-REMAINDER
                 IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
                    CONTINUE
                 ELSE
                    MOVE 'N'           TO WS-GOOD-HIN
                 END-IF
              ELSE
                 MOVE 'N'              TO WS-GOOD-HIN
              END-IF
              IF WS-GOOD-HIN NOT = 'Y'
                 MOVE ER-3826           TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF
           IF (PB-COMPANY-ID = 'DCC')
122807        AND (PB-ISSUE)
              AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
              AND (AM-GPCD NOT = 06)
              IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
                MOVE PB-I-VIN          TO WS-WORK-VIN
                MOVE +8                TO V2
062907          MOVE ZEROS             TO WS-VIN-TOTAL
                PERFORM VARYING V1 FROM +1 BY +1 UNTIL
                 (V1 > 17)
                   IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
                      MOVE ER-3825     TO WS-ERROR
                      PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                   ELSE
                      IF V1 = 8
                         MOVE 10       TO V2
                      END-IF
                      IF V1 = 9
                         MOVE 0        TO V2
                      END-IF
                      IF V1 = 10
                         MOVE 9        TO V2
                      END-IF
                      IF WS-WORK-VIN (V1:1) NUMERIC
                         COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
                          + (WS-WORK-VIN-N (V1) * V2)
                      ELSE
                         MOVE WS-WORK-VIN (V1:1)
                                       TO WS-HEX-BYTE
                         COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
                         COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
                          + (WS-NUM (V3) * V2)
                      END-IF
                      COMPUTE V2 = V2 - 1
                   END-IF
                END-PERFORM
062907          MOVE ZEROS TO WS-VIN-REMAINDER
                DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
                   REMAINDER WS-VIN-REMAINDER
                IF ((WS-WORK-VIN (9:1) = 'X')
                   AND (WS-VIN-REMAINDER = 10))
                           OR
                   (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
                   CONTINUE
                ELSE
                   MOVE ER-3826        TO WS-ERROR
                   PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                END-IF
              ELSE
                MOVE ER-3826           TO WS-ERROR
                PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF
01637 ******************************************************************
01638 ******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
01639 ******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
01640 ******* METHODS.
01641 ******************************************************************
01642      IF PB-COMPANY-ID EQUAL TO 'NCL'
01643         IF PB-CANCELLATION
01644            IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
01645               OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
01646                 PERFORM 3350-GET-ERFORM THRU 3350-EXIT
01647                 IF FORM-MASTER-FOUND
01648                     PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
01649 ******************************************************************
01650
01651      MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
01652      MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
01653
01654      MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
01655      MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
01656      MOVE AM-STATUS              TO WS-ACCT-STATUS.
01657      MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
01658
01659
01660      MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
01661      MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
01662      MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
01663
01664      IF AM-LF-OB-RATE NOT NUMERIC
01665          MOVE ZERO               TO AM-LF-OB-RATE.
01666
01667      IF AM-LF-OB-RATE-JNT NOT NUMERIC
01668          MOVE ZERO               TO AM-LF-OB-RATE-JNT.
01669
01670      IF AM-AH-OB-RATE NOT NUMERIC
01671          MOVE ZERO               TO AM-AH-OB-RATE.
01672
01673      IF WS-LF-JOINT-INDICATOR = 'J'
01674          MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
01675      ELSE
01676          MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
01677
01678      MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
01679
01680      IF WS-IG-OVRD-AM  EQUAL SPACE
01681          MOVE AM-IG              TO WS-IG-OVRD-AM.
01682
01683      IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
01684          MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
01685                                        WS-IG-OVRD
01686      ELSE
01687          IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
01688              MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
01689                                        WS-IG-OVRD
01690          ELSE
01691              MOVE AM-IG             TO WS-IG-OVRD-AH
01692                                        WS-IG-OVRD.
01693
01694      IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
01695          MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
01696                                        WS-IG-OVRD
01697      ELSE
01698          IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
01699              MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
01700                                        WS-IG-OVRD
01701          ELSE
01702              MOVE AM-IG             TO WS-IG-OVRD-LF
01703                                        WS-IG-OVRD.
01704
01705      INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
01706      INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
01707      INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
01708      INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
040708     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
01710
01711      MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
01712      MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
01713      MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
01714      MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
01715
01716      MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
01717      MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
01718      MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
01719      MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
01720      MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
01721      MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
01722      MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
01723
01724      IF WS-ACCT-AH-DEV-PCT > +0
01725         MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
01726      ELSE
01727         MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
01728
01729      IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
01730         MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
01731      IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
01732         MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
01733
01734         IF AM-EARN-METHOD-L = 'S'
01735             MOVE '9'                 TO EC-AM-LF-REFUND-CALC
01736                                         WS-LF-REFUND-CALC.
01737
01738         IF AM-EARN-METHOD-R = 'S'
01739             MOVE '9'                 TO EC-AM-LF-REFUND-CALC
01740                                         WS-LF-REFUND-CALC.
01741
01742      IF WS-LF-COVERAGE-TYPE = 'R'
01743          IF AM-EARN-METHOD-R = 'R'
01744             MOVE '1'             TO EC-AM-LF-REFUND-CALC
01745                                     WS-LF-REFUND-CALC.
01746      IF WS-LF-COVERAGE-TYPE = 'R'
01747          IF AM-EARN-METHOD-R = 'P'
01748             MOVE '2'             TO EC-AM-LF-REFUND-CALC
01749                                     WS-LF-REFUND-CALC.
01750      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
01751          IF AM-EARN-METHOD-L = 'R'
01752             MOVE '1'             TO EC-AM-LF-REFUND-CALC
01753                                     WS-LF-REFUND-CALC.
01754      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
01755          IF AM-EARN-METHOD-L = 'P'
01756             MOVE '2'             TO EC-AM-LF-REFUND-CALC
01757                                     WS-LF-REFUND-CALC.
01758      IF WS-LF-COVERAGE-TYPE = 'R'
01759          IF AM-EARN-METHOD-R = 'A'
01760             MOVE '6'             TO EC-AM-LF-REFUND-CALC
01761                                     WS-LF-REFUND-CALC.
01762      IF WS-LF-COVERAGE-TYPE = 'R'
01763          IF AM-EARN-METHOD-R = 'M'
01764             MOVE '8'             TO EC-AM-LF-REFUND-CALC
01765                                     WS-LF-REFUND-CALC.
01766      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
01767          IF AM-EARN-METHOD-L = 'A'
01768             MOVE '6'             TO EC-AM-LF-REFUND-CALC
01769                                     WS-LF-REFUND-CALC.
01770      IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
01771          IF AM-EARN-METHOD-L = 'M'
01772             MOVE '8'             TO EC-AM-LF-REFUND-CALC
01773                                     WS-LF-REFUND-CALC.
01774
01775      IF AM-EARN-METHOD-A = 'R'
01776         MOVE '1'                 TO EC-AM-AH-REFUND-CALC
01777                                     WS-AH-REFUND-CALC.
01778      IF AM-EARN-METHOD-A = 'P'
01779         MOVE '2'                 TO EC-AM-AH-REFUND-CALC
01780                                     WS-AH-REFUND-CALC.
01781      IF AM-EARN-METHOD-A = 'C'
01782         MOVE '3'                 TO EC-AM-AH-REFUND-CALC
01783                                     WS-AH-REFUND-CALC.
01784      IF AM-EARN-METHOD-A = 'A'
01785         MOVE '6'                 TO EC-AM-AH-REFUND-CALC
01786                                     WS-AH-REFUND-CALC.
01787      IF AM-EARN-METHOD-A = 'M'
01788         MOVE '8'                 TO EC-AM-AH-REFUND-CALC
01789                                     WS-AH-REFUND-CALC.
01790      IF AM-EARN-METHOD-A = 'N'
01791         MOVE '5'                 TO EC-AM-AH-REFUND-CALC
01792                                     WS-AH-REFUND-CALC.
01793      IF AM-EARN-METHOD-A = 'S'
01794         MOVE '9'                 TO EC-AM-AH-REFUND-CALC
01795                                     WS-AH-REFUND-CALC.
01796
01797      IF AM-TOL-PREM NOT = ZEROS
01798         MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
01799                                     WS-TOL-AH-PREM.
01800
01801      IF AM-OVR-SHT-AMT NUMERIC AND
01802                   AM-OVR-SHT-AMT > 0
01803         MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
01804                                     EC-AM-LF-OVR-SHT-AMT
01805                                     WS-AH-REFUND-OVS-AMT
01806                                     EC-AM-AH-OVR-SHT-AMT.
01807
01808      IF AM-OVR-SHT-PCT NUMERIC AND
01809                     AM-OVR-SHT-PCT > 0
01810         MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
01811                                     EC-AM-LF-OVR-SHT-PCT
01812                                     WS-AH-REFUND-OVS-PCT
01813                                     EC-AM-AH-OVR-SHT-PCT.
01814
01815      IF AM-TOL-REF-PCT NUMERIC AND
01816                   AM-TOL-REF-PCT > 0
01817         MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
01818                                     WS-TOL-AH-REFUND-PCT.
01819
01820      IF AM-TOL-REF  NOT = ZEROS  AND
01821                   AM-TOL-REF NUMERIC
01822         MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
01823                                     EC-AM-LF-TOL-REFUND
01824                                     WS-TOL-AH-REFUND
01825                                     EC-AM-AH-TOL-REFUND.
01826
01827      IF AM-TOL-CLM  NOT = ZEROS
01828         MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
01829                                     WS-TOL-AH-CLAIM.
01830
100703     IF AM-CLP-TOL-PCT NOT NUMERIC
100703        MOVE +0                  TO AM-CLP-TOL-PCT
100703     END-IF
100703
092705     IF AM-SPP-LEASE-COMM NOT NUMERIC
092705        MOVE +0                  TO AM-SPP-LEASE-COMM
092705     END-IF
01831      IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
01832         MOVE WS-PL-TOL-LF-PREM-PCT
01833                                  TO WS-TOL-LF-PREM-PCT.
01834
01835      IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
01836         MOVE WS-PL-TOL-AH-PREM-PCT
01837                                  TO WS-TOL-AH-PREM-PCT.
01838
01839      IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
01840         MOVE WS-PL-TOL-LF-REFUND-PCT
01841                                  TO WS-TOL-LF-REFUND-PCT.
01842
01843      IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
01844         MOVE WS-PL-TOL-AH-REFUND-PCT
01845                                  TO WS-TOL-AH-REFUND-PCT.
01846
01847      IF WS-PL-REF-OVS-AMT > +0
01848         MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
01849
01850      IF WS-PL-REF-OVS-PCT > +0
01851         MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
01852
01853      IF WS-PL-TOL-LF-PREM NOT EQUAL +0
01854         MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
01855      IF WS-PL-TOL-AH-PREM NOT EQUAL +0
01856         MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
01857      IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
01858         MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
01859      IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
01860         MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
01861      IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
01862         MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
01863      IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
01864         MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
01865
01866      IF WS-AH-PL-REF-OVS-AMT > +0
01867         MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
01868
01869      IF WS-AH-PL-REF-OVS-PCT > +0
01870         MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
01871
01872      MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
01873      MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
01874
01875      IF PB-CANCELLATION
01876         GO TO 3000-CONTINUE-EDIT.
01877
01878      MOVE +1 TO SUB1.
01879      MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
01880      MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
01881
01882      IF CF-COMPANY-ID = 'DMD'
01883        IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
01884          MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
01885         ELSE
01886          MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
01887
01888   0525-FIND-ACCT-COMM.
01889      IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
01890         NEXT SENTENCE
01891       ELSE
01892          ADD +1 TO SUB1
01893          IF SUB1 LESS +11
01894             GO TO 0525-FIND-ACCT-COMM
01895           ELSE
01896              GO TO 0560-EDIT-CONTINUE.
01897
01898      MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
01899      MOVE ZERO                   TO PB-I-AH-COMMISSION
01900                                     PB-I-LIFE-COMMISSION.
01901 ***  IF PB-COMPANY-ID = 'CRI'
01902      IF PB-PREM-ACCTNG-ONLY
01903          GO TO 0560-EDIT-CONTINUE.
01904
01905      MOVE '0530' TO CTBL-SW.
01906      MOVE ' '    TO WS-CTBL-READ-SW.
01907
01908
01909  0530-GET-AH-COMP.
01910      IF NO-AH-COVERAGE  OR
01911         NO-AH-BENEFIT-MATCH
01912            GO TO 0540-NEXT-READ-STEP.
01913
01914      IF AM-A-COM (SUB1) NUMERIC
PEMUNI        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
01915          MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
01916          MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
01917          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
01918          MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
01919      ELSE
01920           MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
01921           MOVE PB-I-AH-TERM      TO WS-WORK-TERM
01922           MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
01923           MOVE ZEROS             TO WS-SUB1
01924                                     WS-COMMISSION
01925           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
01926           MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
01927           IF WS-COMMISSION > ZEROS
01928              MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
01929              GO TO 0540-NEXT-READ-STEP
01930           END-IF
01931           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
01932           IF CTBL-TABLE-FOUND
01933              COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
01934                                         PB-I-AH-TERM
01935              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
01936              MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
01937              GO TO 0540-NEXT-READ-STEP
01938           ELSE
01939              IF FIRST-TIME-THROUGH
01940                  GO TO 0530-GET-AH-COMP
01941              ELSE
01942                  MOVE ER-2609                TO WS-ERROR
01943                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01944
01945  0540-NEXT-READ-STEP.
01946      MOVE '0540' TO CTBL-SW.
01947      MOVE ' '    TO WS-CTBL-READ-SW.
01948
01949  0540-GET-LF-COMP.
01950      IF NO-LIFE-COVERAGE  OR
01951         NO-LF-BENEFIT-MATCH
01952            GO TO 0560-EDIT-CONTINUE.
01953
01954      IF WS-LF-JOINT-INDICATOR = 'J'
01955         IF AM-J-COM (SUB1) NUMERIC
pemuni           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
01956            MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
01957            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
01958            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
01959            MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
01960         ELSE
01961            MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
01962            MOVE PB-I-LF-TERM         TO WS-WORK-TERM
01963            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
01964            MOVE ZEROS                TO WS-SUB1
01965                                         WS-COMMISSION
01966            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
01967            IF WS-COMMISSION > ZEROS
01968               MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
01969               GO TO 0560-EDIT-CONTINUE
01970            END-IF
01971            MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
01972            PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
01973            IF CTBL-TABLE-FOUND
01974               MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
01975               PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
01976               MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
01977               GO TO 0560-EDIT-CONTINUE
01978            ELSE
01979               IF FIRST-TIME-THROUGH
01980                   GO TO 0540-GET-LF-COMP
01981               ELSE
01982                   MOVE ER-2609                TO WS-ERROR
01983                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01984                   GO TO 0560-EDIT-CONTINUE.
01985
01986      IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
01987         IF AM-L-COM (SUB1) NUMERIC
pemuni           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
01988            MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
01989            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
01990            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
01991            MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
01992         ELSE
01993            MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
01994            MOVE PB-I-LF-TERM         TO WS-WORK-TERM
01995            MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
01996            MOVE ZEROS                TO WS-SUB1
01997                                         WS-COMMISSION
01998            PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
01999            IF WS-COMMISSION IS GREATER THAN ZEROS
02000               MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
02001               GO TO 0560-EDIT-CONTINUE
02002            END-IF
02003            MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
02004            PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
02005            IF CTBL-TABLE-FOUND
02006               MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
02007               PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
02008               MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
02009               GO TO 0560-EDIT-CONTINUE
02010            ELSE
02011               IF FIRST-TIME-THROUGH
02012                   GO TO 0540-GET-LF-COMP
02013               ELSE
02014                   MOVE ER-2609                TO WS-ERROR
02015                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02016
02017 *    GO TO 0560-EDIT-CONTINUE.
02018
02019  0560-EDIT-CONTINUE.
011410     MOVE ZEROS                  TO WS-LF-PMF-COMM
011410                                    WS-AH-PMF-COMM
      *****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
      *****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
           PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
              (SUB1 > +10)
011410        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
                 MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
                 MOVE '0530'           TO CTBL-SW
                 MOVE ' '              TO WS-CTBL-READ-SW
                 PERFORM 0561-CHECK-AH THRU 0561-EXIT
                 MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
                 MOVE '0540'           TO CTBL-SW
                 MOVE ' '              TO WS-CTBL-READ-SW
                 PERFORM 0563-CHECK-LF THRU 0563-EXIT
              END-IF
           END-PERFORM
           GO TO 0564-EDIT-CONTINUE
           .
       0561-CHECK-AH.
           IF (NO-AH-COVERAGE)
              OR (NO-AH-BENEFIT-MATCH)
              CONTINUE
           ELSE
              IF (AM-A-COM (SUB1) NUMERIC)
                 AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
011410           IF (AM-COM-TYP (SUB1) = 'A')
011410              AND (WS-AH-PMF-COMM = ZEROS)
011410              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
011410           END-IF
                 CONTINUE
              ELSE
                 MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
                 MOVE PB-I-AH-TERM     TO WS-WORK-TERM
                 MOVE PB-AH-OVERRIDE-L1
                                       TO CTBL-BEN-TYPE
                 MOVE ZEROS            TO WS-SUB1
                                          WS-COMMISSION
                 MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
                 PERFORM 8300-READ-CTBL-TABLE
                                       THRU 8300-EXIT
                 IF CTBL-TABLE-FOUND
011410              IF (AM-COM-TYP (SUB1) = 'A')
011410                 AND (WS-AH-PMF-COMM = ZEROS)
011410                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
011410                                        PB-I-AH-TERM
011410                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
011410                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
                    END-IF
                    CONTINUE
                 ELSE
                    IF FIRST-TIME-THROUGH
                       GO TO 0561-CHECK-AH
                    ELSE
                       MOVE ER-2609    TO WS-ERROR
                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                    END-IF
                 END-IF
              END-IF
           END-IF
           .
       0561-EXIT.
           EXIT.
       0563-CHECK-LF.
           IF (NO-LIFE-COVERAGE)
              OR (NO-LF-BENEFIT-MATCH)
              CONTINUE
           ELSE
              IF WS-LF-JOINT-INDICATOR = 'J'
                 IF AM-J-COM (SUB1) NUMERIC
                    AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
011410              IF (AM-COM-TYP (SUB1) = 'A')
011410                 AND (WS-LF-PMF-COMM = ZEROS)
011410                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
011410              END-IF
                    CONTINUE
                 ELSE
                    MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
                    MOVE PB-I-LF-TERM  TO WS-WORK-TERM
                    MOVE PB-LIFE-OVERRIDE-L1
                                       TO CTBL-BEN-TYPE
                    MOVE ZEROS         TO WS-SUB1
                                          WS-COMMISSION
                    MOVE AM-J-COMA (SUB1)
                                       TO CTBL-TABLE
                    PERFORM 8300-READ-CTBL-TABLE
                                       THRU 8300-EXIT
                    IF CTBL-TABLE-FOUND
011410                 IF (AM-COM-TYP (SUB1) = 'A')
011410                    AND (WS-LF-PMF-COMM = ZEROS)
011410                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
011410                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
011410                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
011410                 END-IF
                       CONTINUE
                    ELSE
                       IF FIRST-TIME-THROUGH
                          GO TO 0563-CHECK-LF
                       ELSE
                          MOVE ER-2609 TO WS-ERROR
                          PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
      *                   GO TO 0560-EDIT-CONTINUE
                       END-IF
                    END-IF
                 END-IF
              ELSE
                 IF AM-L-COM (SUB1) NUMERIC
                    AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
011410              IF (AM-COM-TYP (SUB1) = 'A')
011410                 AND (WS-LF-PMF-COMM = ZEROS)
011410                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
011410              END-IF
                    CONTINUE
                 ELSE
                    MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
                    MOVE PB-I-LF-TERM  TO WS-WORK-TERM
                    MOVE PB-LIFE-OVERRIDE-L1
                                       TO CTBL-BEN-TYPE
                    MOVE ZEROS         TO WS-SUB1
                                          WS-COMMISSION
                    MOVE AM-L-COMA (SUB1)
                                       TO CTBL-TABLE
                    PERFORM 8300-READ-CTBL-TABLE
                                       THRU 8300-EXIT
                    IF CTBL-TABLE-FOUND
                       CONTINUE
                    ELSE
                       IF FIRST-TIME-THROUGH
                          GO TO 0563-CHECK-LF
                       ELSE
                          MOVE ER-2609 TO WS-ERROR
                          PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                       END-IF
                    END-IF
                 END-IF
              END-IF
           END-IF
           .
       0563-EXIT.
           EXIT.
       0564-EDIT-CONTINUE.
02020
02021      IF  PB-COMPANY-ID EQUAL 'DMD'
02022          IF PB-I-NUM-BILLED EQUAL ZEROS
02023             MOVE ER-8148       TO WS-ERROR
02024             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02025
02026 *    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
02027 *         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
02028 *         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
02029 *         SET ELAPSED-BETWEEN-BIN TO TRUE
02031 *         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
02032 *         IF NO-CONVERSION-ERROR
02033 *             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
02034 *         ELSE
02035 *             IF PB-COMPANY-ID EQUAL 'HAN'
02036 *                 MOVE ZEROS     TO PB-I-AGE.
           IF PB-I-BIRTHDAY > LOW-VALUES
              MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
              MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
              SET ELAPSED-BETWEEN-BIN  TO TRUE
              PERFORM 8500-DATE-CONVERT
                                       THRU 8500-EXIT
              IF NO-CONVERSION-ERROR
                 COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
                 IF PB-I-AGE > ZEROS
                    IF WS-WORK-AGE NOT = PB-I-AGE
                       MOVE ER-9501    TO WS-ERROR
                       PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                    END-IF
                 ELSE
                    MOVE WS-WORK-AGE   TO PB-I-AGE
                 END-IF
              END-IF
           END-IF
011513     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
011513                                   WS-INS-AGE-SET
02038      IF PB-I-AGE = ZEROS
02039         IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
011513           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
011513                                   WS-INS-AGE-SET
02040            MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
02041
02042      MOVE PB-I-AGE              TO WS-EDIT-AGE
02043                                    WS-AH-EDIT-AGE.
02044
090908     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
              MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
              MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
              SET ELAPSED-BETWEEN-BIN  TO TRUE
              PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
              IF NO-CONVERSION-ERROR
                 COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
                 IF PB-I-JOINT-AGE > 0
                    IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
                       MOVE ER-9503    TO WS-ERROR
                       PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                    END-IF
                 ELSE
                    MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
                 END-IF
              ELSE
                 MOVE ZEROS            TO PB-I-JOINT-AGE
              END-IF
           END-IF
02045      IF PB-I-JOINT-AGE NOT NUMERIC
02046         MOVE ZERO               TO PB-I-JOINT-AGE.
02047
011513     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
011513                                   WS-JNT-AGE-SET
030612     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
02049         IF (WS-LF-JOINT-INDICATOR = 'J')  OR
02050            (WS-AH-JOINT-INDICATOR = 'J')
02051            IF PB-I-JOINT-AGE = ZEROS
011513               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
011513                                          WS-JNT-AGE-SET
02052                MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
                 END-IF
              END-IF
           END-IF
02053
           MOVE ' ' TO PB-I-LIFE-INDICATOR
02054      IF WS-LF-JOINT-INDICATOR = 'J'
02055         MOVE 'J'                TO PB-I-LIFE-INDICATOR
02056         IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
02057             IF  PB-I-JOINT-AGE = ZERO
02058                 MOVE ER-2686       TO WS-ERROR
02059                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02060             ELSE
02061                 IF  PB-I-JOINT-AGE GREATER PB-I-AGE
02062                     MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
02063                     IF PB-COMPANY-ID NOT = 'LBL'
02064                         MOVE ER-2685    TO WS-ERROR
02065                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02066
02067      IF WS-AH-JOINT-INDICATOR = 'J'
02068         IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
02069             IF  PB-I-JOINT-AGE = ZERO
02070                 MOVE ER-2686       TO WS-ERROR
02071                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02072             ELSE
02073                 IF  PB-I-JOINT-AGE GREATER PB-I-AGE
02074                     MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
072109                                           WS-EDIT-AGE
02075                     IF PB-COMPANY-ID NOT = 'LBL'
02076                         MOVE ER-2685    TO WS-ERROR
02077                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02078
02079 ******************************************************************
02080 *    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
02081 ******************************************************************
02082
02083      IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
02084         (WS-AH-SPECIAL-CALC-CD = 'O')
02085         NEXT SENTENCE
02086      ELSE
02087         IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
02088           (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
02089            (WS-LF-JOINT-INDICATOR = 'J'  OR
02090             WS-AH-JOINT-INDICATOR = 'J')  AND
02091            (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
02092             MOVE ER-2627             TO WS-ERROR
02093             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02094
02095      IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
02096         (WS-AH-SPECIAL-CALC-CD = 'O')
02097          NEXT SENTENCE
02098      ELSE
02099          IF WS-LF-JOINT-INDICATOR = 'J'  OR
02100             WS-AH-JOINT-INDICATOR = 'J'
02101              IF PB-I-JOINT-INSURED = SPACES
02102                  IF PB-COMPANY-ID NOT = 'JAL'
02103                      MOVE ER-2696    TO WS-ERROR
02104                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02105
02106      IF PB-COMPANY-ID NOT = 'BOA'
02107         IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
02108            (WS-AH-JOINT-INDICATOR NOT = 'J')
02109            IF (PB-I-JOINT-AGE NOT = ZEROS OR
02110                PB-I-JOINT-INSURED NOT = SPACES)
02111                 MOVE ER-2691         TO WS-ERROR
02112                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02113
02114      IF PB-COMPANY-ID = 'BOA'
02115         IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
02116            (WS-AH-JOINT-INDICATOR NOT = 'J')
02117             IF PB-I-JOINT-AGE NOT = ZEROS
02118                 MOVE ER-2691         TO WS-ERROR
02119                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02120
02121      IF PB-COMPANY-ID = 'CRI'
02122         IF PB-I-SIG-SW = 'J'
02123            IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
02124               WS-AH-JOINT-INDICATOR NOT = 'J'
02125               MOVE ER-2675       TO WS-ERROR
02126               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02127
02128      IF PB-COMPANY-ID = 'CRI'
02129         IF PB-I-SIG-SW = 'S'
02130            IF WS-LF-JOINT-INDICATOR = 'J'  OR
02131               WS-AH-JOINT-INDICATOR = 'J'
02132               MOVE ER-2676       TO WS-ERROR
02133               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02134
02135      IF PB-COMPANY-ID = 'CVL'
02136          IF (WS-AH-JOINT-INDICATOR = 'J') AND
02137             (WS-LF-JOINT-INDICATOR NOT = 'J')
02138               MOVE ER-2783           TO WS-ERROR
02139               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
031611     IF (WS-LF-JOINT-INDICATOR = 'J')
031611        AND (WS-AH-JOINT-INDICATOR = 'J')
031611        AND (PB-I-LF-TERM > 120)
031611        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
031611        MOVE ER-2783             TO WS-ERROR
031611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
031611     END-IF
02141      MOVE SPACE                  TO PB-I-INDV-GRP-CD.
02142
02143      IF PB-I-INDV-GRP-OVRD = 'I'
02144         MOVE ER-2666             TO WS-ERROR
02145         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02146         MOVE 'I'                 TO PB-I-INDV-GRP-CD.
02147
02148      IF PB-I-INDV-GRP-OVRD = 'G'
02149         MOVE ER-2666             TO WS-ERROR
02150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02151         MOVE 'G'                 TO PB-I-INDV-GRP-CD.
02152
02153      IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
02154         NEXT SENTENCE
02155      ELSE
02156         MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
02157
02158      IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
02159         IF WS-ERROR = ER-2666
02160            MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
02161            SUBTRACT +1           FROM PB-NO-OF-ERRORS.
123102
123102     IF PB-COMPANY-ID = 'CID'
123102        IF PB-STATE = 'UT' OR 'MO'
123102           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
123102                 OR '76' OR '77')
123102                      OR
123102               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
123102                   OR '41' OR '42' OR '63' OR '64' OR '65'
123102                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
123102                   OR '2K' OR '2L'))
123102              AND PB-I-INDV-GRP-CD = 'I'
123102              MOVE ER-2721             TO WS-ERROR
123102              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
123102           END-IF
123102        END-IF
123102     END-IF
02162
PEMMOD     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
PEMMOD     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
PEMMOD        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
PEMMOD     ELSE
PEMMOD        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
PEMMOD     END-IF
PEMMOD
100703*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
100703*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
02163      MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
02164                                     ACCOUNT-AH-CK-SW.
02165
02166      IF PB-REISSUED-CERT       OR
02167         PB-REIN-ONLY-CERT      OR
02168         PB-POLICY-IS-DECLINED  OR
02169         PB-POLICY-IS-VOIDED
093005*       OR PB-MONTHLY-CERT
02170          GO TO 3000-CONTINUE-EDIT.
02171
030612     IF PB-COMPANY-ID = 'CID' OR 'AHL'
082003        IF WS-EDIT-AGE           > +65
082003           MOVE ER-2709          TO WS-ERROR
082003           PERFORM 9900-ERROR-FORMAT
082003                                 THRU 9900-EXIT
082003        ELSE
082003           IF WS-EDIT-AGE        > +55
082003              MOVE ER-2718       TO WS-ERROR
082003              PERFORM 9900-ERROR-FORMAT
082003                                 THRU 9900-EXIT
082003           END-IF
082003        END-IF
093005     IF PB-COMPANY-ID = 'DCC'
093005        IF WS-EDIT-AGE           > +65
093005           MOVE ER-2709          TO WS-ERROR
093005           PERFORM 9900-ERROR-FORMAT
093005                                 THRU 9900-EXIT
              END-IF
           END-IF
093005     .
082003
02172  0565-LIFE-PLAN-LIMIT-EDITS.
02173
02174      IF NOT LF-PLAN-MASTER-FOUND
072111        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
083111                                    EC-AM-LF-MAX-TOT-BEN
02175         GO TO 0580-AH-PLAN-LIMIT-EDITS.
02176
02177      MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
02178
02179      IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
02180          IF PL-LM-AGE (1) = ZEROS
02181              GO TO 0580-AH-PLAN-LIMIT-EDITS.
02182
02183      IF NO-LF-BENEFIT-MATCH          OR
02184         WS-LF-BENEFIT-CD = ZEROS     OR
02185         WS-LF-SPECIAL-CALC-CD = 'M'
02186         GO TO 0580-AH-PLAN-LIMIT-EDITS.
02187
02188      MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
02189      MOVE +1                     TO SUB2.
02190
02191      IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
02192         IF PB-I-SIG-SW EQUAL 'S' OR 'J'
02193            MOVE +5   TO SUB2
02194            IF (PL-LM-AMT (SUB2) EQUAL +0) AND
02195               (PL-LM-DUR (SUB2) EQUAL +0) AND
02196               (PL-LM-AGE (SUB2) EQUAL +0)
02197               MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
02198               GO TO 0580-AH-PLAN-LIMIT-EDITS.
02199
02200      COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
02201
02202      COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
02203                                + PB-I-LF-ALT-BENEFIT-AMT.
02204
02205  0568-CHECK-LIFE-ATT-AGE.
02206
02207      IF PL-ATT-AGE NUMERIC AND
02208         PL-ATT-AGE > +0
02209         MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
           END-IF
02207 *    IF PL-ATT-AGE NUMERIC AND
02208 *       PL-ATT-AGE > +0
02209 *       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
      *       IF PB-I-BIRTHDAY > LOW-VALUES
      *          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
      *          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
      *          MOVE ZERO             TO DC-ELAPSED-DAYS
      *          SET BIN-PLUS-ELAPSED  TO TRUE
      *          PERFORM 8500-DATE-CONVERT
      *                                THRU 8500-EXIT
      *          IF NO-CONVERSION-ERROR
      *             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
      *             MOVE ER-2669       TO WS-ERROR
      *             PERFORM 9900-ERROR-FORMAT
      *                                THRU 9900-EXIT
      *          END-IF
      *       ELSE
02210 *          IF WS-ATT-AGE >= PL-ATT-AGE
02211 *             MOVE ER-2669       TO WS-ERROR
02212 *             PERFORM 9900-ERROR-FORMAT
      *                                THRU 9900-EXIT
      *          END-IF
      *       END-IF
      *    END-IF
           .
02214  0570-CHECK-LIFE-LIMITS.
02215
02216      IF PB-COMPANY-ID EQUAL 'CRI'
02217         IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
02218            IF SUB2 GREATER THAN +4
02219               MOVE ER-2637 TO WS-ERROR
02220               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02221               GO TO 0580-AH-PLAN-LIMIT-EDITS.
02222
02223      IF PB-COMPANY-ID  =  'NCL'
02224         IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
02225             SUB2 GREATER THAN +8
02226              MOVE 'U'         TO PB-BATCH-ENTRY
02227              MOVE ER-2637     TO WS-ERROR
02228              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02229              GO TO 0575-CHECK-NCL-SIG-SWITCH.
02230
102706     IF SUB2 > +8
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
                 MOVE ER-2637          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
              GO TO 0580-AH-PLAN-LIMIT-EDITS
           END-IF
02236      MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
02237      MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
02238      MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
02239
02240      IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
02241         ADD +1  TO SUB2
02242         GO TO 0570-CHECK-LIFE-LIMITS.
02243
02244      IF PB-COMPANY-ID = 'NCL'
02245          GO TO 0570-CHECK-NCL-LIFE-LIMITS.
02246
102706     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
              OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
                 MOVE ER-2637          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF
02252      GO TO 0580-AH-PLAN-LIMIT-EDITS.
02253
02254
02255  0570-CHECK-NCL-LIFE-LIMITS.
02256
02257      IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
02258         WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
02259          GO TO 0575-CHECK-NCL-SIG-SWITCH.
02260
02261      IF APP-CERT-USED
02262          IF SUB2  LESS THAN  +5
02263              MOVE +5          TO SUB2
02264              GO TO 0570-CHECK-LIFE-LIMITS.
02265
02266      MOVE ER-2637             TO WS-ERROR.
02267      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02268
02269      MOVE 'U'                 TO PB-BATCH-ENTRY.
02270
02271  0575-CHECK-NCL-SIG-SWITCH.
02272
02273      IF NOT APP-CERT-USED
02274          GO TO 0580-AH-PLAN-LIMIT-EDITS.
02275
02276      IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
02277         PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
02278         PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
02279         PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
02280          GO TO 0580-AH-PLAN-LIMIT-EDITS.
02281
02282      IF SUB2 GREATER THAN +4
02283          IF PL-LM-AGE (5) = ZEROS  AND
02284             PL-LM-AGE (6) = ZEROS  AND
02285             PL-LM-AGE (7) = ZEROS  AND
02286             PL-LM-AGE (8) = ZEROS
02287              MOVE  ER-1927        TO WS-ERROR
02288              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
02289              GO TO 0580-AH-PLAN-LIMIT-EDITS
02290          ELSE
02291              IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
02292                  MOVE  ER-1920    TO WS-ERROR
02293                  PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
02294
02295      IF PB-I-SIG-SW  = 'Y'
02296        IF NOT PB-I-POLICY-ACCEPTED  AND
02297           NOT PB-I-POLICY-DECLINED
02298            MOVE 'U'               TO PB-BATCH-ENTRY
02299            MOVE  ER-1926          TO WS-ERROR
02300            PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
02301
02302
02303  0580-AH-PLAN-LIMIT-EDITS.
02304
030612     IF PB-COMPANY-ID = 'CID' OR 'AHL'
082003        IF PB-I-AH-BENEFIT-AMT > +1250
082003           MOVE ER-2702          TO WS-ERROR
082003           PERFORM 9900-ERROR-FORMAT
082003                                 THRU 9900-EXIT
082003        END-IF
082003     END-IF
08200
093005     IF (PB-COMPANY-ID = 'DCC')
093005        AND (PB-MONTHLY-CERT)
091012        IF PB-I-AH-BENEFIT-AMT > +3000
093005           MOVE ER-2881          TO WS-ERROR
093005           PERFORM 9900-ERROR-FORMAT
093005                                 THRU 9900-EXIT
093005        END-IF
093005     END-IF
02305      IF NOT AH-PLAN-MASTER-FOUND
072111        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
02306         GO TO 3000-CONTINUE-EDIT.
02307
02308      MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
02309
02310      IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
02311          IF PL-LM-AGE (1) = ZEROS
02312              GO TO 3000-CONTINUE-EDIT.
02313
02314      IF NO-AH-BENEFIT-MATCH          OR
02315         WS-AH-BENEFIT-CD = ZEROS     OR
02316         WS-AH-SPECIAL-CALC-CD = 'M'
02317         GO TO 3000-CONTINUE-EDIT.
02318
02319      MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
02320      MOVE +1                     TO SUB2.
02321
02322      IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
02323         IF PB-I-SIG-SW EQUAL 'S' OR 'J'
02324            MOVE +5 TO SUB2
02325            IF (PL-LM-AMT (SUB2) EQUAL +0) AND
02326               (PL-LM-MOA (SUB2) EQUAL +0) AND
02327               (PL-LM-DUR (SUB2) EQUAL +0) AND
02328               (PL-LM-AGE (SUB2) EQUAL +0)
02329               MOVE 'NO ' TO ACCOUNT-AH-CK-SW
02330               GO TO 3000-CONTINUE-EDIT.
02331
02332      COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
02333
02334  0590-CHECK-AH-ATT-AGE.
02335
02336      IF PL-ATT-AGE NUMERIC AND
02337         PL-ATT-AGE GREATER THAN +0
02338         MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
           END-IF
02339 *       IF WS-ATT-AGE >= PL-ATT-AGE
02340 *          MOVE ER-3054          TO WS-ERROR
02341 *          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
           .
02343  0597-CHECK-AH-LIMITS.
02344
02345      IF PB-COMPANY-ID EQUAL 'CRI'
02346         IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
02347            IF SUB2 GREATER THAN +4
02348               MOVE ER-2638       TO WS-ERROR
02349               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02350               GO TO 3000-CONTINUE-EDIT.
02351
02352      IF PB-COMPANY-ID  =  'NCL'
02353         IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
02354             SUB2 GREATER THAN +8
02355              MOVE 'U'            TO PB-BATCH-ENTRY
02356              MOVE ER-2638        TO WS-ERROR
02357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02358              GO TO 0599-CHECK-NCL-SIG-SWITCH.
02359
02360      IF SUB2 > +8
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
02361            MOVE ER-2638          TO WS-ERROR
02362            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
02363         GO TO 3000-CONTINUE-EDIT
           END-IF
02364
02365      IF PB-COMPANY-ID = 'CRI'
02366         IF WS-ERROR = ER-2638
02367            MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
02368
02369      MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
02370      MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
02371      MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
02372      MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
02373
02374      IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
02375         ADD +1                   TO SUB2
02376         GO TO 0597-CHECK-AH-LIMITS.
02377
02378      IF PB-COMPANY-ID = 'NCL'
02379          GO TO 0597-CHECK-NCL-AH-LIMITS.
02380
02381      IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
02382         OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
02383         OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
                                       > PL-LM-AMT (SUB2))
030612        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
                 AND (PB-I-SIG-SW = 'Y')
                 CONTINUE
              ELSE
02385            MOVE ER-2638          TO WS-ERROR
02386            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF
02387
02388      IF  PB-COMPANY-ID   EQUAL    'CRI'
02389          IF  WS-ERROR    EQUAL    ER-2638
02390              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
02391                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
02392                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
02393                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
02394                 MOVE  ER-1910    TO  WS-ERROR
02395                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
02396
02397      IF PB-COMPANY-ID = 'CRI'
02398         IF WS-ERROR = ER-2638
02399             MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
02400             SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
02401             MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
02402
02403      GO TO 3000-CONTINUE-EDIT.
02404
02405  0597-CHECK-NCL-AH-LIMITS.
02406
02407      IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
02408         PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
02409         ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
02410                             NOT GREATER THAN PL-LM-AMT (SUB2))
02411          GO TO 0599-CHECK-NCL-SIG-SWITCH.
02412
02413      IF APP-CERT-USED
02414          IF SUB2  LESS THAN  +5
02415              MOVE +5             TO SUB2
02416              GO TO 0597-CHECK-AH-LIMITS.
02417
02418      MOVE ER-2638                TO WS-ERROR.
02419      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02420
02421      MOVE 'U'                    TO PB-BATCH-ENTRY.
02422
02423  0599-CHECK-NCL-SIG-SWITCH.
02424
02425      IF NOT APP-CERT-USED
02426          GO TO 3000-CONTINUE-EDIT.
02427
02428      IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
02429         PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
02430         PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
02431         PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
02432          GO TO 3000-CONTINUE-EDIT.
02433
02434      IF SUB2 GREATER THAN +4
02435          IF PL-LM-AGE (5) = ZEROS  AND
02436             PL-LM-AGE (6) = ZEROS  AND
02437             PL-LM-AGE (7) = ZEROS  AND
02438             PL-LM-AGE (8) = ZEROS
02439              MOVE  ER-1927        TO WS-ERROR
02440              PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
02441              GO TO 3000-CONTINUE-EDIT
02442          ELSE
02443              IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
02444                  MOVE  ER-1920    TO WS-ERROR
02445                  PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
02446
02447      IF PB-I-SIG-SW  = 'Y'
02448        IF NOT PB-I-POLICY-ACCEPTED  AND
02449           NOT PB-I-POLICY-DECLINED
02450            MOVE 'U'               TO PB-BATCH-ENTRY
02451            MOVE  ER-1926          TO WS-ERROR
02452            PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
02453
02454 ******************************************************************
02455      EJECT
02456
02457  3000-CONTINUE-EDIT.
02458
02459      MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
02460      MOVE AM-CSR-CODE            TO PB-CSR-ID.
02461      MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
02462      MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
02463      MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
02464
02465      IF BROWSE-STARTED
02466         PERFORM 9990-RETURN THRU 9990-EXIT
02467         MOVE SPACES              TO WS-BROWSE-STARTED-SW.
02468
02469      IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
02470         MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
02471         MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
02472         SET ELAPSED-BETWEEN-BIN  TO TRUE
02473 *       MOVE 1                   TO DC-OPTION-CODE
02474         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
02475         IF DATE-CONVERSION-ERROR
02476            MOVE ER-2622          TO WS-ERROR
02477            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02478         ELSE
02479            IF DC-ELAPSED-MONTHS   GREATER THAN +2
02480               MOVE ER-2623       TO WS-ERROR
02481               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02482            ELSE
02483               MOVE ER-2622       TO WS-ERROR
02484               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02485
02486      MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
02487      MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
02488      SET ELAPSED-BETWEEN-BIN     TO TRUE.
02489 *    MOVE 1                      TO DC-OPTION-CODE.
02490      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
02491      IF DATE-CONVERSION-ERROR
02492         GO TO 3005-EDIT-CONTINUE
02493      ELSE
02494         IF DC-ELAPSED-DAYS GREATER +180
02495            MOVE ER-2613          TO WS-ERROR
02496            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02497         ELSE
02498            IF DC-ELAPSED-DAYS GREATER +90
02499               MOVE ER-2612       TO WS-ERROR
02500               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02501            ELSE
02502              IF DC-ELAPSED-DAYS GREATER +60
02503                 MOVE ER-2614     TO WS-ERROR
02504                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02505
02506  3005-EDIT-CONTINUE.
02507
02508      IF PB-CANCELLATION
02509          GO TO 3700-EDIT-CANCEL.
02510
02511      EJECT
02512 ******************************************************************
02513 *                  E D I T   I S S U E                           *
02514 ******************************************************************
02515
02516  3020-EDIT-ISSUE.
02517
02518       MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
02519       MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
02520       MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
02521       MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
02522       MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
02523
02524      IF PB-ISSUE-FORCE
073107        OR PB-ISSUE-DATE-FORCED
02525         OR PB-FORCE-OFF
073107        OR PB-OVERCHARGE-FORCE
02526         CONTINUE
02527      ELSE
02528         MOVE ER-2670             TO WS-ERROR
02529         PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
           END-IF
           .
02531  3022-SET-POLICY-STATUS.
02532
02533      MOVE '2'                    TO PB-I-ENTRY-STATUS.
02534
111610     IF (PB-REISSUED-CERT)
111610             OR
111610        ((PB-COMPANY-ID NOT = 'DCC')
111610         AND (PB-MONTHLY-CERT))
111610         MOVE '5'                TO PB-I-ENTRY-STATUS
111610         MOVE 'E'                TO PB-BATCH-ENTRY
111610     END-IF
111610
111610     IF PB-COMPANY-ID = 'DCC'
111610        IF PB-MONTHLY-CERT
111610           MOVE 'M'              TO PB-I-ENTRY-STATUS
111610        END-IF
111610     END-IF
02537      IF PB-POLICY-IS-DECLINED
02538          MOVE 'D'                TO PB-I-ENTRY-STATUS.
02539      IF PB-POLICY-IS-VOIDED
02540          MOVE 'V'                TO PB-I-ENTRY-STATUS.
02541      IF PB-NEEDS-UNDERWRITING
02542          MOVE 'U'                TO PB-I-ENTRY-STATUS.
02543      IF PB-REIN-ONLY-CERT
02544          MOVE '9'                TO PB-I-ENTRY-STATUS.
02545      IF PB-PREM-ACCTNG-ONLY
02546          MOVE 'P'                TO PB-I-ENTRY-STATUS.
02547
02548      MOVE SPACE                  TO PB-I-OB-FLAG.
02549
02550      IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
02551          MOVE ER-2665            TO WS-ERROR
02552          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02553          MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
02554
02555      IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
02556         AND WS-AH-SPECIAL-CALC-CD = 'Z'
02557            MOVE 'Z'             TO PB-I-OB-FLAG.
02558
02559      IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
02560         AND WS-LF-SPECIAL-CALC-CD = 'Z'
02561            MOVE 'Z'             TO PB-I-OB-FLAG.
02562
02563      IF ACCOUNT-MAST-FOUND
02564          MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
02565          MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
02566          MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
02567          MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
02568          MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
02569          MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
040504         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
040504     END-IF
02570
02571      IF ACCOUNT-MAST-FOUND
02572         AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
02573          MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
02574
040708     IF (ACCOUNT-MAST-FOUND)
031811        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
02576         IF PB-REISSUED-CERT
02577            CONTINUE
02578         ELSE
02579            MOVE ER-2608          TO WS-ERROR
02580            PERFORM 9900-ERROR-FORMAT
040708                                 THRU 9900-EXIT
040708         END-IF
040708     END-IF
02581
02582      IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
02583         MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
02584         MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
02585
02586 **********   DMD CUSTOM CODE FOLLOWS  **********
02587  3024-EDIT-DMD-FIELDS.
02588      IF PB-COMPANY-ID NOT = 'DMD'
02589         GO TO 3025-EDIT-REINSURANCE.
02590
02591 *** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
02592 *** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
02593 *** ERROR IF THEY ARE NOT EQUAL.
02594
02595      MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
02596      SET BIN-TO-GREG               TO TRUE.
02597      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
CIDMOD     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
02598 **   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
02599
02600      MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
02601      SET BIN-TO-GREG               TO TRUE.
02602      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
CIDMOD     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
02603 **   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
02604
02605      IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
02606         MOVE ER-8116               TO WS-ERROR
02607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02608
02609      MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
02610
02611      MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
02612                                       WK-FULL-CERT-NO.
02613      MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
02614
02615      MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
02616
02617      IF PB-VALID-LIFE
02618         MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
02619      ELSE
02620         IF PB-VALID-AH
02621           MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
02622
02623
02624      MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
02625      MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
02626      MOVE SPACES                   TO DCUA-CERT-NUMBER
02627                                       DCUA-UNDRWRTR-CODE
02628                                       DCUA-UNDRWRTR-GROUP-CODE
02629                                       DCUA-RETURN-CODE.
02630
02631 ****************************************************************
02632 *** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
02633 ***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
02634 ***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
02635 ***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
02636 ***   TO THIS RECORD.                                        ***
02637 ****************************************************************
02638      MOVE ' '                      TO WS-DLO-ERROR-SW.
02639      PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
02640      IF DCUA-SUCCESSFUL-PROCESS
02641         GO TO 3024-EDIT-DL7-CONT.
02642
02643      IF DCUA-RETURN-CODE EQUAL '01'
02644         MOVE ER-8110               TO WS-ERROR
02645         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02647         GO TO 3024-EDIT-DL7-CONT.
02648
02649      IF DCUA-RETURN-CODE EQUAL '02'
02650         MOVE ER-8111               TO WS-ERROR
02651         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02653         GO TO 3024-EDIT-DL7-CONT.
02654
02655      IF DCUA-RETURN-CODE EQUAL '03'
02656         MOVE ER-8074               TO WS-ERROR
02657         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02658         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02659         GO TO 3024-EDIT-DL7-CONT.
02660
02661      IF DCUA-RETURN-CODE EQUAL '04'
02662         MOVE ER-8075               TO WS-ERROR
02663         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02664         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02665         GO TO 3024-EDIT-DL7-CONT.
02666
02667      IF DCUA-RETURN-CODE EQUAL '05'
02668         MOVE ER-8076               TO WS-ERROR
02669         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02670         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02671         GO TO 3024-EDIT-DL7-CONT.
02672
02673      IF DCUA-RETURN-CODE EQUAL '06'
02674         MOVE ER-8077               TO WS-ERROR
02675         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02677         GO TO 3024-EDIT-DL7-CONT.
02678
02679      IF DCUA-RETURN-CODE EQUAL '07'
02680         MOVE ER-8078               TO WS-ERROR
02681         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02683         GO TO 3024-EDIT-DL7-CONT.
02684
02685      IF DCUA-RETURN-CODE EQUAL 'E1'
02686         MOVE ER-8079               TO WS-ERROR
02687         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02689         GO TO 3024-EDIT-DL7-CONT.
02690
02691      IF DCUA-RETURN-CODE EQUAL 'E2'
02692         MOVE ER-8080               TO WS-ERROR
02693         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02694         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02695         GO TO 3024-EDIT-DL7-CONT.
02696
02697      IF DCUA-RETURN-CODE EQUAL 'E3'
02698         MOVE ER-8098               TO WS-ERROR
02699         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02700         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02701         GO TO 3024-EDIT-DL7-CONT.
02702
02703      IF DCUA-RETURN-CODE EQUAL 'C1'
02704         MOVE ER-8099               TO WS-ERROR
02705         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02707         GO TO 3024-EDIT-DL7-CONT.
02708
02709      IF DCUA-RETURN-CODE EQUAL 'U1'
02710         MOVE ER-8109               TO WS-ERROR
02711         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02713         GO TO 3024-EDIT-DL7-CONT.
02714
02715      IF DCUA-RETURN-CODE EQUAL 'N1'
02716         MOVE ER-8112               TO WS-ERROR
02717         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02719         GO TO 3024-EDIT-DL7-CONT.
02720
02721      IF DCUA-RETURN-CODE EQUAL 'N2'
02722         MOVE ER-8113               TO WS-ERROR
02723         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02724         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02725         GO TO 3024-EDIT-DL7-CONT.
02726
02727      IF DCUA-RETURN-CODE EQUAL 'N3'
02728         MOVE ER-8114               TO WS-ERROR
02729         MOVE 'Y'                   TO WS-DLO-ERROR-SW
02730         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02731         GO TO 3024-EDIT-DL7-CONT.
02732
02733      MOVE 'Y'                      TO WS-DLO-ERROR-SW.
02734      MOVE ER-8097                  TO WS-ERROR.
02735      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
02736      GO TO 3024-EDIT-DL7-CONT.
02737
02738  3024-EDIT-DL7-CONT.
02739
02740      MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
02741      MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
02742      IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
02743         NEXT SENTENCE
02744      ELSE
02745         MOVE ER-9263               TO WS-ERROR
02746         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02747
02748 ******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
02749 ******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
02750      IF DCUA-CERT-NUMBER = PB-CERT-NO
02751         NEXT SENTENCE
02752      ELSE
02753         MOVE ER-8039               TO WS-ERROR
02754         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02755
02756      EJECT
02757 ****************************************************************
02758 *** VALIDATE STATE  : DLO022                                 ***
02759 ****************************************************************
02760      MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
02761      MOVE SPACES                   TO DVSC-RETURN-CODE.
02762
02763      PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
02764      IF DVSC-SUCCESSFUL-EDIT
02765         GO TO 3024-EDIT-DL22-CONT.
02766
02767      IF DVSC-RETURN-CODE EQUAL '01'
02768         MOVE ER-8300               TO WS-ERROR
02769         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02770         GO TO 3024-EDIT-DL22-CONT.
02771
02772      IF DVSC-RETURN-CODE EQUAL '02'
02773         MOVE ER-8301               TO WS-ERROR
02774         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02775         GO TO 3024-EDIT-DL22-CONT.
02776
02777      IF DVSC-RETURN-CODE EQUAL '03'
02778         MOVE ER-8302               TO WS-ERROR
02779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02780         GO TO 3024-EDIT-DL22-CONT.
02781
02782      IF DVSC-RETURN-CODE EQUAL 'N1'
02783         MOVE ER-8304               TO WS-ERROR
02784         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02785         GO TO 3024-EDIT-DL22-CONT.
02786
02787      MOVE ER-8303                  TO WS-ERROR
02788      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02789
02790  3024-EDIT-DL22-CONT.
02791  EJECT
02792 ****************************************************************
02793 *** VALIDATE LOAN OFFICER : DLO021                           ***
02794 ****************************************************************
02795
02796      MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
02797      MOVE SPACES                    TO DVLO-RETURN-CODE.
02798      PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
02799      IF DVLO-SUCCESSFUL-EDIT
02800         GO TO 3024-EDIT-DL21-CONT.
02801
02802      IF DVLO-RETURN-CODE EQUAL '01'
02803         MOVE ER-8081               TO WS-ERROR
02804         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02805         GO TO 3024-EDIT-DL21-CONT.
02806
02807      IF DVLO-RETURN-CODE EQUAL '02'
02808         MOVE ER-8082               TO WS-ERROR
02809         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02810         GO TO 3024-EDIT-DL21-CONT.
02811
02812      IF DVLO-RETURN-CODE EQUAL '03'
02813         MOVE ER-8083               TO WS-ERROR
02814         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02815         GO TO 3024-EDIT-DL21-CONT.
02816
02817      IF DVLO-RETURN-CODE EQUAL '04'
02818         MOVE ER-8084               TO WS-ERROR
02819         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02820         GO TO 3024-EDIT-DL21-CONT.
02821
02822      IF DVLO-RETURN-CODE EQUAL '05'
02823         MOVE ER-8085               TO WS-ERROR
02824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02825         GO TO 3024-EDIT-DL21-CONT.
02826
02827      MOVE ER-7825                  TO WS-ERROR
02828      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
02829      GO TO 3024-EDIT-DL21-CONT.
02830
02831  3024-EDIT-DL21-CONT.
02832  EJECT
02833
02834 ****************************************************************
02835 *** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
02836 ****************************************************************
02837
02838      MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
02839      MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
02840      MOVE SPACES                 TO DIPF-RETURN-CODE.
02841      PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
02842      IF DIPF-SUCCESSFUL-EDIT
02843         GO TO 3024-EDIT-DL02-CONT.
02844
02845      IF DIPF-RETURN-CODE EQUAL '01'
02846         MOVE ER-8086               TO WS-ERROR
02847         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02848         GO TO 3024-EDIT-DL02-CONT.
02849
02850      IF DIPF-RETURN-CODE EQUAL '02'
02851         MOVE ER-8087               TO WS-ERROR
02852         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02853         GO TO 3024-EDIT-DL02-CONT.
02854
02855      IF DIPF-RETURN-CODE EQUAL '03'
02856         MOVE ER-8088               TO WS-ERROR
02857         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02858         GO TO 3024-EDIT-DL02-CONT.
02859
02860      MOVE ER-8095                  TO WS-ERROR
02861      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
02862      GO TO 3024-EDIT-DL02-CONT.
02863
02864  3024-EDIT-DL02-CONT.
02865  EJECT
02866
02867 ****************************************************************
02868 *** VALIDATE BANK ID : DLO003                                ***
02869 ****************************************************************
02870
02871      MOVE WK-GREG-CENT           TO WCG-CENT.
02872      MOVE WK-GREG-YYMM           TO WCG-REST.
02873      IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
02874         MOVE ER-8040               TO WS-ERROR
02875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02876
02877      MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
02878      MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
02879      MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
02880      MOVE SPACES                 TO  DVBI-RETURN-CODE.
02881      PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
02882      IF DVBI-SUCCESSFUL-EDIT
02883         GO TO 3024-EDIT-DL03-CONT.
02884
02885      IF DVBI-RETURN-CODE EQUAL '01'
02886         MOVE ER-8089               TO WS-ERROR
02887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02888         GO TO 3024-EDIT-DL03-CONT.
02889
02890      IF DVBI-RETURN-CODE EQUAL '02'
02891         MOVE ER-8090               TO WS-ERROR
02892         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02893         GO TO 3024-EDIT-DL03-CONT.
02894
02895      IF DVBI-RETURN-CODE EQUAL '03'
02896         MOVE ER-8091               TO WS-ERROR
02897         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02898         GO TO 3024-EDIT-DL03-CONT.
02899
02900      IF DVBI-RETURN-CODE EQUAL '04'
02901         MOVE ER-8092               TO WS-ERROR
02902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02903         GO TO 3024-EDIT-DL03-CONT.
02904
02905      IF DVBI-RETURN-CODE EQUAL '05'
02906         MOVE ER-8093               TO WS-ERROR
02907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02908         GO TO 3024-EDIT-DL03-CONT.
02909
02910      IF DVBI-RETURN-CODE EQUAL '06'
02911         MOVE ER-8094               TO WS-ERROR
02912         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02913         GO TO 3024-EDIT-DL03-CONT.
02914
02915      MOVE ER-8096                  TO WS-ERROR
02916      PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
02917      GO TO 3024-EDIT-DL03-CONT.
02918
02919  3024-EDIT-DL03-CONT.
02920  EJECT
02921
02922      IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
02923         NEXT SENTENCE
02924      ELSE
02925         MOVE ER-8042               TO WS-ERROR
02926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02927
02928      MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
02929      MOVE SPACES                 TO  DMPF-RETURN-CODE.
02930      PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
02931
02932      IF DMPF-RETURN-CODE = '01'
02933         MOVE ER-8067               TO WS-ERROR
02934         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02935         GO TO 3024-EDIT-DL01-CONT.
02936
02937      IF DMPF-RETURN-CODE = '02'
02938         MOVE ER-8068               TO WS-ERROR
02939         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02940         GO TO 3024-EDIT-DL01-CONT.
02941
02942      IF DMPF-RETURN-CODE = '03'
02943         MOVE ER-8069               TO WS-ERROR
02944         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02945         GO TO 3024-EDIT-DL01-CONT.
02946
02947      IF DMPF-RETURN-CODE = 'E1'
02948         MOVE ER-8070               TO WS-ERROR
02949         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02950         GO TO 3024-EDIT-DL01-CONT.
02951
02952      IF DMPF-RETURN-CODE = 'N1'
02953         MOVE ER-8071               TO WS-ERROR
02954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02955         GO TO 3024-EDIT-DL01-CONT.
02956
02957      IF DMPF-RETURN-CODE NOT = 'OK'
02958         MOVE ER-8072               TO WS-ERROR
02959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
02960
02961  3024-EDIT-DL01-CONT.
02962 ******************************************************************
02963 ***  VALIDATES RATE CODES : DLO017                             ***
02964 ******************************************************************
02965
02966       MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
02967       MOVE SPACES                   TO DVRC-RETURN-CODE.
02968       PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
02969       IF DVRC-SUCCESSFUL-EDIT
02970         MOVE 'Y'                   TO WK-VALID-RATE-CODE
02971         GO TO 3024-CHECK-VALID-RATE.
02972
02973       MOVE 'N'                     TO WK-VALID-RATE-CODE.
02974
02975       IF DVRC-RETURN-CODE EQUAL '01'
02976          MOVE ER-7817                   TO WS-ERROR
02977          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02978          GO TO 3025-EDIT-REINSURANCE.
02979
02980       IF DVRC-RETURN-CODE EQUAL '02'
02981          MOVE ER-7818                   TO WS-ERROR
02982          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02983          GO TO 3025-EDIT-REINSURANCE.
02984
02985       IF DVRC-RETURN-CODE EQUAL '03'
02986          MOVE ER-7819                   TO WS-ERROR
02987          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
02988          GO TO 3025-EDIT-REINSURANCE.
02989
02990        MOVE ER-7820                     TO WS-ERROR.
02991        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
02992        GO TO 3025-EDIT-REINSURANCE.
02993
02994 ******************************************************************
02995 ***  GET PREMIUM RATES : DLO011                                ***
02996 ******************************************************************
02997
02998  3024-CHECK-VALID-RATE.
02999
03000      IF VALID-RATE-CODE
03001         MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
03002         MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
03003         MOVE SPACES                TO DPRB-RETURN-CODE
03004         PERFORM 7740-CALL-DL11 THRU 7740-EXIT
03005      ELSE
03006          GO TO 3025-EDIT-REINSURANCE.
03007
03008       IF DPRB-SUCCESSFUL-PROCESS
03009          IF PB-VALID-LIFE
03010              MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
03011              GO TO 3025-EDIT-REINSURANCE
03012          ELSE
03013              IF PB-VALID-AH
03014                  MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
03015                  GO TO 3025-EDIT-REINSURANCE.
03016
03017       IF DPRB-RETURN-CODE EQUAL '01'
03018          MOVE ER-7812                   TO WS-ERROR
03019          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03020          GO TO 3025-EDIT-REINSURANCE.
03021
03022       IF DPRB-RETURN-CODE EQUAL '02'
03023          MOVE ER-7813                   TO WS-ERROR
03024          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03025          GO TO 3025-EDIT-REINSURANCE.
03026
03027       IF DPRB-RETURN-CODE EQUAL '03'
03028          MOVE ER-7814                   TO WS-ERROR
03029          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03030          GO TO 3025-EDIT-REINSURANCE.
03031
03032       IF DPRB-RETURN-CODE EQUAL '04'
03033          IF NOT DPRB-1ST-TIME
03034             MOVE ER-7815                   TO WS-ERROR
03035             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03036             GO TO 3025-EDIT-REINSURANCE
03037           ELSE
03038          IF PB-VALID-LIFE
03039             MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
03040           ELSE
03041             MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
03042          END-IF
03043          MOVE SPACES                TO DOCC-RETURN-CODE
03044          MOVE 'X'                   TO DPRB-1ST-TIME-SW
03045          PERFORM 7755-CALL-DL19 THRU 7755-EXIT
03046          IF DOCC-RETURN-CODE = 'OK'
03047              MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
03048              GO TO 3024-CHECK-VALID-RATE
03049            ELSE
03050              MOVE ER-7823               TO WS-ERROR
03051              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
03052              GO TO 3025-EDIT-REINSURANCE.
03053
03054        MOVE ER-7816                     TO WS-ERROR.
03055        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
03056        GO TO 3025-EDIT-REINSURANCE.
03057
03058 **********   DMD CUSTOM CODE ABOVE    **********
03059
03060  3025-EDIT-REINSURANCE.
03061      IF PB-I-SPECIAL-REIN-CODE = SPACE
03062          GO TO 3027-EDIT-CONTINUE.
03063
03064      MOVE LOW-VALUES               TO ERREIN-KEY.
03065      MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
03066      MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
03067                                       REIN-CODE-2
03068                                       REIN-CODE-3.
03069      MOVE 'A'                      TO REIN-TYPE.
03070
03071      MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
03072
03073      MOVE '3026' TO REIN-SW.
03074      MOVE ' '                   TO WS-REIN-READ-SW.
03075
03076      PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
03077      IF REIN-TABLE-NOT-FOUND
03078          GO TO 3026-NO-SPEC-TABLE.
03079
03080      MOVE RE-TABLE              TO WK-REIN-TABLE.
03081      MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
03082                                    WS-NSP-ST-CD-LF.
03083      MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
03084                                    WS-NSP-ST-CD-AH.
03085
03086      GO TO 3040-EDIT-CONTINUE.
03087
03088  3026-NO-SPEC-TABLE.
03089
03090      MOVE ER-2664                TO WS-ERROR.
03091      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03092      GO TO 3040-EDIT-CONTINUE.
03093
03094  3027-EDIT-CONTINUE.
03095
03096      IF PB-I-REIN-TABLE = SPACES
03097        GO TO 3040-EDIT-CONTINUE.
03098
03099      IF PB-I-REIN-TABLE = WK-REIN-TABLE
03100           MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
03101           MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
03102            GO TO 3040-EDIT-CONTINUE.
03103
03104      MOVE LOW-VALUES            TO ERREIN-KEY.
03105      MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
03106      MOVE 'A'                   TO REIN-TYPE.
03107      MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
03108
03109      MOVE '3028'                TO REIN-SW.
03110      MOVE ' '                   TO WS-REIN-READ-SW.
03111
03112      PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
03113      IF REIN-TABLE-NOT-FOUND
03114          GO TO 3028-NO-REIN-TABLE.
03115
03116      MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
03117      MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
03118                                    WS-NSP-ST-CD-LF.
03119      MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
03120                                    WS-NSP-ST-CD-AH.
03121
03122      GO TO 3040-EDIT-CONTINUE.
03123
03124  3028-NO-REIN-TABLE.
03125
03126      MOVE ER-2615                TO WS-ERROR.
03127      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03128      GO TO 3040-EDIT-CONTINUE.
03129
03130  3040-EDIT-CONTINUE.
03131
03132      IF PB-I-LF-PREM-CALC NOT NUMERIC
03133          MOVE ZEROS              TO PB-I-LF-PREM-CALC.
03134
03135      IF PB-I-AH-PREM-CALC NOT NUMERIC
03136          MOVE ZEROS              TO PB-I-AH-PREM-CALC.
03137
122002     IF (NOT PB-REISSUED-CERT)
122002        AND (NOT PB-MONTHLY-CERT)
03139         IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
03140             MOVE '001'           TO PB-I-LF-TERM
03141             MOVE 'M'             TO PB-I-INSURED-SEX.
03142
03143      IF (NOT PB-REISSUED-CERT)
122002        AND (NOT PB-MONTHLY-CERT)
03144         IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
03145             MOVE '001'           TO PB-I-AH-TERM
03146             MOVE 'M'             TO PB-I-INSURED-SEX.
03147
03148  3040-EDIT-1ST-PMT-DT.
           MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
03149      IF PB-I-EXTENTION-DAYS NOT NUMERIC
03150          MOVE ZEROS TO PB-I-EXTENTION-DAYS.
03151
03152 ******************************************************************
03153 *                                                                *
03154 *        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
03155 *        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
03156 *        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
03157 *        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
03158 *                                                                *
03159 ******************************************************************
03160
03161      IF PB-EFF-DT-PROCESSING
03162         MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
03163                                     PB-I-LF-EXPIRE-DT
03164                                     PB-I-AH-EXPIRE-DT
03165         MOVE ZEROS               TO PB-I-EXTENTION-DAYS
03166         MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
03167         MOVE ZERO                TO DC-ELAPSED-DAYS
03168         MOVE +1                  TO DC-ELAPSED-MONTHS
03169         SET BIN-PLUS-ELAPSED     TO TRUE
03170 *       MOVE 6                   TO DC-OPTION-CODE
03171         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
03172         IF NO-CONVERSION-ERROR
03173            MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
03174
03175 ******************************************************************
03176 *                                                                *
03177 *        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
03178 *        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
03179 *        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
03180 *        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
03181 *                                                                *
03182 ******************************************************************
03183
03184      IF PB-EXT-DAYS-PROCESSING
03185           MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
03186                                          PB-I-LF-EXPIRE-DT
03187                                          PB-I-AH-EXPIRE-DT
03188           MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
03189           MOVE ZERO                   TO DC-ELAPSED-DAYS
03190           MOVE +1                     TO DC-ELAPSED-MONTHS
03191           MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
03192           SET BIN-PLUS-ELAPSED        TO TRUE
03193 *         MOVE 6                      TO DC-OPTION-CODE
03194           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
03195           IF NO-CONVERSION-ERROR
03196              MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
03197
03198 ******************************************************************
03199 *                                                                *
03200 *        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
03201 *        BASED ON THE OLDEST EXPIRE DATE.                        *
03202 *        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
03203 *        (EXPIRE DATE - (TERM -1))  *  -1.
03204 *                                                                *
03205 ******************************************************************
03206
03207      IF PB-EXPIRE-DT-PROCESSING
03208         IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
03209            IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
03210               MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
03211               MOVE PB-I-AH-TERM      TO WS-TERM
03212            ELSE
03213               MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
03214               MOVE PB-I-LF-TERM      TO WS-TERM
03215         ELSE
03216            IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
03217               MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
03218               MOVE PB-I-LF-TERM      TO WS-TERM
03219            ELSE
03220               MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
03221               MOVE PB-I-AH-TERM      TO WS-TERM.
03222
03223      IF PB-EXPIRE-DT-PROCESSING
03224         MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
03225         MOVE ZEROS               TO PB-I-EXTENTION-DAYS
03226         MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
03227         MOVE ZERO                TO DC-ELAPSED-DAYS
03228                                     DC-ODD-DAYS-OVER
03229           COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
03230           SET BIN-PLUS-ELAPSED    TO TRUE
03231 *         MOVE 6                  TO DC-OPTION-CODE
03232           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
03233           IF NO-CONVERSION-ERROR
03234              MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
03235
03236 ******************************************************************
03237 *                                                                *
03238 *            1ST PAYMENT DATE PROCESSING                         *
03239 *                                                                *
03240 ******************************************************************
03241
03242      IF PB-1ST-PMT-DT-PROCESSING
03243         MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
03244                                     PB-I-AH-EXPIRE-DT
03245         MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
03246
03247      IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
03248          NEXT SENTENCE
03249      ELSE
03250          MOVE ER-2680                 TO WS-ERROR
03251          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03252          GO TO 3060-ORIG-TERM-CHECK.
03253
03254      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
03255      MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
03256      SET ELAPSED-BETWEEN-BIN     TO TRUE.
03257 *    MOVE 1                      TO DC-OPTION-CODE.
03258      MOVE ZEROS                  TO DC-ELAPSED-MONTHS
03259                                     DC-ELAPSED-DAYS
03260                                     DC-ODD-DAYS-OVER.
03261
03262      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
03263
03264      IF DATE-CONVERSION-ERROR
03265         GO TO 3060-ORIG-TERM-CHECK.
03266
071305     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
030612     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
102908        AND (WS-LF-COVERAGE-TYPE = 'L')
102908        IF (DC-ELAPSED-MONTHS > 1)
102908                      OR
102908           ((DC-ELAPSED-MONTHS = 1)
102908           AND (DC-ODD-DAYS-OVER > 0))
102908           MOVE ER-2882          TO WS-ERROR
102908           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
102908        END-IF
102908     END-IF
           if dc-elapsed-months > 0
              compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
              + dc-odd-days-over
           end-if
091609     IF PB-EXT-DAYS-PROCESSING
091609        CONTINUE
091609     ELSE
091609        IF DC-ELAPSED-MONTHS = +0
091609           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
091609        ELSE
091609           IF (WS-LF-EARNINGS-CALC = '4')
091609              AND (DC-ELAPSED-MONTHS > ZERO)
091609              AND (DC-ELAPSED-DAYS > ZERO)
091609              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
091609           ELSE
091609              PERFORM 6400-COMPUTE-EXTENSION-DAYS
091609                                 THRU 6499-EXIT
091609              MOVE WS-ODD-DAYS-OVER
091609                                 TO PB-I-EXTENTION-DAYS
091609           END-IF
091609        END-IF
091609     END-IF
03276 ******************************************************************
03277 *                                                                *
03278 *            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
03279 *            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
03280 *            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
03281 *            AND ANY ODD DAYS.                                   *
03282 *                                                                *
03283 ******************************************************************
03284
03285      COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
03286                               (EC-ST-FST-PMT-DAYS-MAX + 32)
061009     IF WS-LF-EARNINGS-CALC NOT = '4'
03287         IF DC-ELAPSED-DAYS > ZEROS
03288            MOVE ER-2681          TO WS-ERROR
03289            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
061009     END-IF
03290
03291      IF WS-LF-EARNINGS-CALC NOT = '4'
03292         IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
03293            MOVE ER-2681          TO WS-ERROR
03294            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03295
03296      IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
03297         (PB-I-LF-TERM NOT = ZERO) AND
03298          NOT NO-LIFE-COVERAGE
03299           MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
03300           COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
091609          IF WS-LF-EARNINGS-CALC = '4'
091609             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
091609             PB-I-PAY-FREQUENCY
091609          END-IF
03301           MOVE ZERO              TO DC-ELAPSED-DAYS
03302                                     DC-ODD-DAYS-OVER
03303           MOVE 1                 TO DC-END-OF-MONTH
03304           SET BIN-PLUS-ELAPSED        TO TRUE
03305 *         MOVE 6                 TO DC-OPTION-CODE
03306           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
03307           IF NO-CONVERSION-ERROR
03308              MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
03309              IF (WS-LF-EARNINGS-CALC = 'B') AND
03310                 (WS-LF-SPECIAL-CALC-CD = 'L')
03311                   MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
03312                   MOVE ZERO           TO DC-ELAPSED-DAYS
03313                   MOVE +1             TO DC-ELAPSED-MONTHS
03314                   SET BIN-PLUS-ELAPSED  TO TRUE
03315 *                 MOVE 6              TO DC-OPTION-CODE
03316                   PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
03317                   IF NO-CONVERSION-ERROR
03318                      MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
03319
042709* okay, i had to move the new att age edit down here because the
      * expiration date could get recalculated and i need the exp date
042709     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
042709        AND (EC-AM-LF-MAX-ATT-AGE > +0)
042709        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
042709        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           AND ZEROS
                 MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
042709                 MOVE ER-2669       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
042709              MOVE ER-2669       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
020711                 MOVE ER-1570    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF
042709        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           AND ZEROS
                 MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
042709                 MOVE ER-2669       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                   (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
042709              MOVE ER-2669       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
020711                 MOVE ER-1571    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF
              IF WS-ERROR = ER-2669
042709           PERFORM 9900-ERROR-FORMAT
042709                                 THRU 9900-EXIT
042709        END-IF
042709     END-IF
03320      IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
03321         (PB-I-AH-TERM NOT = ZERO) AND
03322          NOT NO-AH-COVERAGE
050509          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
022510             AND (PB-COMPANY-ID = 'DCC')
050509             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
050509             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
050509          ELSE
110609             IF WS-LF-EARNINGS-CALC = '4'
012711                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
110609                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
110609                PB-I-PAY-FREQUENCY
110609             ELSE
050509                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
050509                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
110609             END-IF
050509          END-IF
03325           MOVE ZERO                   TO DC-ELAPSED-DAYS
03326                                          DC-ODD-DAYS-OVER
03327           MOVE 1                      TO DC-END-OF-MONTH
03328           SET BIN-PLUS-ELAPSED        TO TRUE
03329 *         MOVE 6                      TO DC-OPTION-CODE
03330           PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
03331           IF NO-CONVERSION-ERROR
03332              MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
042709     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
042709        AND (EC-AM-AH-MAX-ATT-AGE > +0)
042709        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
042709        IF PB-I-BIRTHDAY > LOW-VALUES
                 MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
042709                 MOVE ER-3054       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
042709              MOVE ER-3054       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709           END-IF
042709        END-IF
042709        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           AND ZEROS
                 MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
                 SET ELAPSED-BETWEEN-BIN TO TRUE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
042709                 MOVE ER-3054       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                   (PB-I-AH-TERM / 12)
042709           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
042709              MOVE ER-3054       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709           END-IF
042709        END-IF
              IF WS-ERROR = ER-3054
042709           PERFORM 9900-ERROR-FORMAT
042709                                 THRU 9900-EXIT
042709        END-IF
042709     END-IF
03334      MOVE SPACE                       TO DC-END-OF-MONTH.
03335
03336      IF PB-COMPANY-ID = 'NCB'
03337         GO TO 3040-EDIT-EXTENSION-DAYS.
03338
03339      IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
03340        AND
03341         PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
03342         NEXT SENTENCE
03343      ELSE
03344         GO TO 3040-EDIT-EXTENSION-DAYS.
03345
03346      IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
03347         MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
03348         MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
03349      ELSE
03350         MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
03351         MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
03352
03353      SET ELAPSED-BETWEEN-BIN TO TRUE.
03354 *    MOVE '1'      TO DC-OPTION-CODE
03355      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
03356      IF (NO-CONVERSION-ERROR)
03357         AND (DC-ELAPSED-MONTHS > +1)
              AND (WS-AH-BEN-CATEGORY NOT = 'D')
03359         MOVE ER-2668   TO WS-ERROR
03360         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03361
03362  3040-EDIT-EXTENSION-DAYS.
03363
03364      IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
03365         AND (PB-COMPANY-ID NOT EQUAL 'CSL')
03366          GO TO 3050-EDIT-TERM-IN-DAYS
03367      ELSE
03368          MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
03369
03370      IF PB-I-EXTENTION-DAYS NOT NUMERIC
03371          MOVE ZEROS             TO PB-I-EXTENTION-DAYS
03372      ELSE
03373         IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
061009           AND (WS-LF-EARNINGS-CALC NOT = '4')
03374            MOVE ER-2681         TO WS-ERROR
03375            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03376
03377      IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
03378         (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
03379         (PB-I-AH-EXPIRE-DT = LOW-VALUES)
03380          GO TO 3060-ORIG-TERM-CHECK.
03381
03382      GO TO 3060-ORIG-TERM-CHECK.
03383
03384  3050-EDIT-TERM-IN-DAYS.
03385
03386      MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
03387
03388      IF PB-I-TERM-IN-DAYS NOT NUMERIC
03389          MOVE ZEROS              TO PB-I-TERM-IN-DAYS
03390      ELSE
03391          IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
03392             MOVE ER-2682         TO WS-ERROR
03393             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03394
03395      DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
03396                                        REMAINDER WS-WORK-TERM.
03397      IF WS-WORK-TERM GREATER THAN ZERO
03398          ADD +1 TO PB-I-LF-TERM.
03399
03400      IF NOT NO-AH-COVERAGE
03401          MOVE ER-2684            TO WS-ERROR
03402          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03403
03404
03405  3060-ORIG-TERM-CHECK.
03406
03407 ******************************************************************
03408 *    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
03409 ******************************************************************
03410
03411      IF WS-LF-SPECIAL-CALC-CD = 'O'
03412         NEXT SENTENCE
03413      ELSE
03414         IF NOT NO-LIFE-COVERAGE
03415            IF PB-I-LF-TERM NUMERIC
03416               AND (PB-I-LF-TERM GREATER THAN ZERO)
03417               AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
03418               AND (PB-I-LF-TERM NOT GREATER THAN +360)
03419                   NEXT SENTENCE
03420            ELSE
03421               MOVE ER-2647       TO WS-ERROR
03422               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03423
03424      IF NOT NO-AH-COVERAGE
03425          IF PB-I-AH-TERM NUMERIC
03426             AND (PB-I-AH-TERM GREATER THAN ZERO)
03427             AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
03428             AND (PB-I-AH-TERM NOT GREATER THAN +360)
03429              NEXT SENTENCE
03430           ELSE
03431               MOVE ER-2658       TO WS-ERROR
03432               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03433
03434      IF PB-COMPANY-ID = 'NCB'
03435         GO TO 3070-LOAN-TERM-CHECK.
03436
03437      IF POLICY-HAS-AH
03438        AND
03439         POLICY-HAS-LIFE
03440        AND
03441         PB-I-LF-TERM NUMERIC
03442        AND
03443         PB-I-AH-TERM NUMERIC
03444         NEXT SENTENCE
03445      ELSE
03446         GO TO 3070-LOAN-TERM-CHECK.
03447
03448      COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
03449      IF WS-TEX-FACT-2 LESS THAN +0
03450         MULTIPLY +1 BY WS-TEX-FACT-2.
03451
03452      IF WS-TEX-FACT-2 GREATER THAN +1
03453         MOVE ER-2668             TO WS-ERROR
03454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03455
03456  3070-LOAN-TERM-CHECK.
03457
03458      IF (WS-LF-BENEFIT-CD = ZERO)
03459          OR (NO-LF-BENEFIT-MATCH)
03460             GO TO 3125-EDIT-PMT-FREQ.
      *    IF PB-COMPANY-ID NOT = 'DCC'
03462 *       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
      *          AND 'V' AND 'W' AND 'X'
03464 *          GO TO 3125-EDIT-PMT-FREQ
      *       END-IF
      *    ELSE
      *       IF WS-AH-DCC-TRUNC = 'T'
      *          CONTINUE
      *       ELSE
      *          GO TO 3125-EDIT-PMT-FREQ
      *       END-IF
      *    END-IF
020711     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
                          OR
              ((PB-COMPANY-ID = 'DCC')
              AND (WS-AH-DCC-TRUNC = 'T'))
020711        CONTINUE
020711     ELSE
              GO TO 3125-EDIT-PMT-FREQ
           END-IF
03466      IF PB-I-LOAN-TERM NOT NUMERIC
03467          MOVE ZEROS              TO PB-I-LOAN-TERM.
03468
03469      IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
03470         PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
012213*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
              PB-I-LOAN-TERM NOT GREATER THAN +360
03473          NEXT SENTENCE
03474      ELSE
03475          MOVE ER-2648            TO WS-ERROR
03476          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03477
012213     if  PB-I-LOAN-TERM > WS-MAX-TERM
012213        MOVE ER-3058             TO WS-ERROR
012213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
012213     end-if
03477
CIDMOD     IF WS-STATE-ABBREVIATION = 'NC'
CIDMOD        IF PB-I-LOAN-TERM > +59
CIDMOD           CONTINUE
CIDMOD        ELSE
022708           MOVE ER-2792          TO WS-ERROR
CIDMOD           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
CIDMOD        END-IF
CIDMOD     END-IF
03478
CIDMOD     .
03479  3125-EDIT-PMT-FREQ.
03480      IF (WS-LF-BENEFIT-CD = ZERO)
03481          OR (NO-LF-BENEFIT-MATCH)
03482             GO TO 3127-EDIT-LOAN-OFFICER.
020711     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
                          OR
              ((PB-COMPANY-ID = 'DCC')
              AND (WS-AH-DCC-TRUNC = 'T'))
032912                    OR
032912         (PB-COMPANY-ID = 'AHL')
020711        CONTINUE
020711     ELSE
020711        IF (PB-I-LOAN-TERM > ZEROS)
020711           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
020711           MOVE ER-1575          TO WS-ERROR
020711           PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711        END-IF
           END-IF
03484      IF WS-LF-EARNINGS-CALC NOT = '4'
03485          IF PB-I-PAY-FREQUENCY  NOT = ZEROS
03486             MOVE ER-2653         TO WS-ERROR
03487             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03488             GO TO 3127-EDIT-LOAN-OFFICER
03489          ELSE
03490             GO TO 3127-EDIT-LOAN-OFFICER.
03491
03492      IF PB-I-PAY-FREQUENCY = ZERO OR 1
03493          MOVE ER-2655            TO WS-ERROR
03494          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03495          GO TO 3127-EDIT-LOAN-OFFICER.
03496
03497      IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
03498          MOVE ER-2654            TO WS-ERROR
03499          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03500          GO TO 3127-EDIT-LOAN-OFFICER.
03501
03502      DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
03503          GIVING WS-TEX-FACT-2
03504              REMAINDER WS-TEX-FACT-3.
03505
091609*    IF WS-TEX-FACT-3 NOT = ZERO
091609*       MOVE ER-2654             TO WS-ERROR
091609*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03509
03510
03511  3127-EDIT-LOAN-OFFICER.
03512
03513      IF WS-EDIT-LOAN-OFC-SW = 'Y'
03514         IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
03515            MOVE ER-2690          TO WS-ERROR
03516            PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
083106        ELSE
083106           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
083106           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
083106           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
083106           MOVE PB-SV-STATE      TO LOFC-STATE
083106           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
083106           MOVE PB-I-LOAN-OFFICER
083106                                 TO LOFC-CODE
083106           PERFORM 8586-READ-LOAN-OFFICER
083106                                 THRU 8586-EXIT
083106           IF (NOT LOFC-MASTER-FOUND)
083106              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
083106              MOVE ER-3006       TO WS-ERROR
083106              PERFORM 9900-ERROR-FORMAT
083106                                 THRU 9900-EXIT
083106           END-IF
083106        END-IF
083106     END-IF
           .
03518  3129-EDIT-APR.
03519
03520      IF (WS-LF-BENEFIT-CD = ZERO)
03521         OR (NO-LF-BENEFIT-MATCH)
              IF PB-COMPANY-ID NOT = 'DCC'
03522            GO TO 3130-EDIT-AGE
042605*       ELSE
042605*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
042605*             GO TO 3130-EDIT-AGE
042605*          END-IF
042605        END-IF
           END-IF
03523
03524      IF (WS-STATE-ABBREVIATION = 'OH')
CIDMOD         AND (PB-I-RATE-CLASS NOT = 'L ')
03525          AND (PB-I-LF-TERM GREATER THAN 60)
03526          AND (PB-CERT-EFF-DT GREATER WS-831031)
03527          GO TO 3129-APR-CONT.
03528
03529      IF (WS-STATE-ABBREVIATION = 'RI')
03530          AND (PB-I-LF-TERM GREATER THAN 60)
03531          AND (PB-CERT-EFF-DT GREATER WS-831231)
03532          GO TO 3129-APR-CONT.
03533
03534      IF (WS-STATE-ABBREVIATION = 'UT')
03535          AND (PB-I-LF-TERM GREATER THAN 62)
03536          AND (PB-CERT-EFF-DT GREATER WS-810831)
03537          AND (PB-CERT-EFF-DT LESS WS-830901)
03538          GO TO 3129-APR-CONT.
03539
03540      IF PB-COMPANY-ID = 'LAP'
03541         IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
03542            IF PB-I-LOAN-APR GREATER THAN ZEROS
03543               MOVE ER-2656         TO WS-ERROR
03544               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03545               GO TO 3130-EDIT-AGE.
03546
03547      IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
03548         (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
03549         (WS-LF-SPECIAL-CALC-CD NOT = 'G')
011305        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
112612        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
112612        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
03550          GO TO 3130-EDIT-AGE.
03551
03552  3129-APR-CONT.
03553      IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
03554          (WS-LF-SPECIAL-CALC-CD = 'M'))
03555          GO TO 3130-EDIT-AGE.
03556
112612     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
112612         WS-AH-BENEFIT-CD (1:1) = 'S')
061207        AND (PB-COMPANY-ID = 'DCC')
061207        AND (PB-I-LOAN-APR = ZERO)
061207        MOVE ER-2657             TO WS-ERROR
061207        PERFORM 9900-ERROR-FORMAT
061207                                 THRU 9900-EXIT
061207        GO TO 3130-EDIT-AGE
061207     END-IF
pemtst     IF PB-I-LOAN-APR = ZERO
pemtst        MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
pemtst     END-IF
03559
03560      IF PB-I-LOAN-APR = ZERO
03561         MOVE ER-2656             TO WS-ERROR
03562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03563         GO TO 3130-EDIT-AGE.
03564
011305*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
011305     IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +30.000
03566         MOVE ER-2657             TO WS-ERROR
03567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03568
03569  3130-EDIT-AGE.
03570
03571 ******************************************************************
03572 *    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
03573 ******************************************************************
03574
03575      IF NOT NO-LIFE-COVERAGE
03576         IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
03577            IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
03578                MOVE ER-2628             TO WS-ERROR
03579                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03580
03581      IF NOT NO-AH-COVERAGE
03582         IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
03583            IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
03584                MOVE ER-2628         TO WS-ERROR
03585                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03586
03587  3133-SEX-CODE.
03588      IF PB-I-INSURED-SEX = SPACE OR ZERO
03589          IF WS-DEFAULT-SEX = 'M'
03590              MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
03591           ELSE
03592              IF WS-DEFAULT-SEX = 'F'
03593              MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
03594
03595      IF PB-I-INSURED-SEX = '1'
03596          MOVE 'M' TO PB-I-INSURED-SEX.
03597
03598      IF PB-I-INSURED-SEX = '2'
03599          MOVE 'F' TO PB-I-INSURED-SEX.
03600
03601  3134-SIG-SW-EDIT.
03602      IF PB-I-SIG-SW = SPACE
03603          MOVE 'N'                TO  PB-I-SIG-SW.
03604
03605      IF PB-COMPANY-ID = 'NCL'
03606          IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
03607              NEXT SENTENCE
03608          ELSE
03609              MOVE ER-1923        TO  WS-ERROR
03610              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03611      ELSE
03612      IF PB-COMPANY-ID = 'CRI'
03613          IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
03614              NEXT SENTENCE
03615          ELSE
03616              MOVE ER-2606        TO  WS-ERROR
03617              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03618      ELSE
03619      IF PB-COMPANY-ID = 'TMS'
03620          IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
03621              NEXT SENTENCE
03622          ELSE
03623              MOVE ER-2689        TO  WS-ERROR
03624              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03625      ELSE
03626          IF PB-I-SIG-SW = 'Y' OR 'N'
03627              NEXT SENTENCE
03628          ELSE
03629              MOVE ER-2651        TO  WS-ERROR
03630              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03631
03632      IF PB-COMPANY-ID = 'FLA'
03633          IF (WS-EDIT-AGE GREATER 54  OR
03634              WS-AH-EDIT-AGE GREATER 54)  AND
03635             PB-I-SIG-SW = 'N'
03636             MOVE ER-2651         TO  WS-ERROR
03637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03638
03639  3135-NAME-EDIT.
03640
           IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
              AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-JOINT-FIRST-NAME (2:9)
                                       TO PB-I-JOINT-FIRST-NAME
              END-PERFORM
           END-IF
           IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
              AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-JOINT-LAST-NAME (2:14)
                                       TO PB-I-JOINT-LAST-NAME
              END-PERFORM
           END-IF
           IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
              AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-INSURED-FIRST-NAME (2:9)
                                       TO PB-I-INSURED-FIRST-NAME
              END-PERFORM
           END-IF
           IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
              AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
              PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
                 MOVE PB-I-INSURED-LAST-NAME (2:14)
                                       TO PB-I-INSURED-LAST-NAME
              END-PERFORM
           END-IF
03641      IF PB-I-INSURED-LAST-NAME = SPACES
03642        AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
03643        AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
03644            MOVE ER-2660    TO WS-ERROR
03645            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03646
03647  3136-EDIT-SEX.
03648
03649 ******************************************************************
03650 *    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
03651 ******************************************************************
03652
03653      IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
03654         (WS-AH-SPECIAL-CALC-CD = 'O')
03655         NEXT SENTENCE
03656      ELSE
03657         IF PB-I-INSURED-SEX = 'M' OR 'F'
03658            NEXT SENTENCE
03659         ELSE
03660            MOVE ER-2629            TO WS-ERROR
03661            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03662
03663  3137-EDIT-EFF-DATE.
03664
03665      IF PB-REISSUED-CERT       OR
03666         PB-POLICY-IS-DECLINED  OR
03667         PB-POLICY-IS-VOIDED
03668          GO TO 3139-EDIT-COVERAGE-CODES.
03669
03670      MOVE SPACE                  TO WS-2671-SW
03671                                     WS-2672-SW.
03672
03673      IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
03674          IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
03675              MOVE ER-2703        TO WS-ERROR
03676              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03677              GO TO 3139-EDIT-COVERAGE-CODES.
03678
03679      IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
03680          GO TO 3139-EDIT-COVERAGE-CODES.
03681
03682      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
03683      MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
03684 *    MOVE '1'                    TO DC-OPTION-CODE.
03685      SET ELAPSED-BETWEEN-BIN     TO TRUE.
03686      MOVE +0                     TO DC-ELAPSED-MONTHS
03687                                     DC-ELAPSED-DAYS.
03688      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
03689
03690      IF DATE-CONVERSION-ERROR
03691          GO TO 3139-EDIT-COVERAGE-CODES.
03692
03693      IF DC-ELAPSED-DAYS GREATER +180
03694          MOVE ER-2672            TO WS-ERROR
03695          MOVE 'Y'                TO WS-2672-SW
03696          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
031611     END-IF
03702
03703      IF WS-ERROR = ER-2671  AND
03704         PB-COMPANY-ID  = 'LBL'
03705         MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03706         MOVE SPACE               TO WS-2671-SW
03707         SUBTRACT +1            FROM PB-NO-OF-ERRORS.
03708
03709      IF PB-ISSUE-DATE-FORCED  AND
03710       ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
03711          SUBTRACT +1           FROM PB-NO-OF-ERRORS
03712          MOVE ER-2673            TO WS-ERROR
03713          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03714          MOVE SPACE              TO WS-2671-SW
03715                                     WS-2672-SW.
03716
03717      IF DC-ELAPSED-MONTHS IS GREATER THAN +9
03718          IF PB-ISSUE-DATE-FORCED
03719              MOVE ER-2600          TO  WS-ERROR
03720              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03721          ELSE
03722              MOVE ER-2692          TO  WS-ERROR
03723              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03724
03725
03726  3139-EDIT-COVERAGE-CODES.
03727
042012     if pb-company-id not = 'AHL'
071305        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
071305           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
071305           MOVE ER-2787          TO WS-ERROR
071305           PERFORM 9900-ERROR-FORMAT
071305                                 THRU 9900-EXIT
071305        END-IF
042012     end-if
PEMMOD     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
PEMMOD        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
PEMMOD                                 > 250000.00
PEMMOD           MOVE ER-2719          TO WS-ERROR
PEMMOD           PERFORM 9900-ERROR-FORMAT
PEMMOD                                 THRU 9900-EXIT
PEMMOD        END-IF
PEMMOD     END-IF
PEMMOD
03728      IF PB-POLICY-IS-DECLINED  OR
03729         PB-POLICY-IS-VOIDED
03730          GO TO 3140-EDIT-MAX-AMT-SIZES.
03731
03732      IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
03733         (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
03734          MOVE ER-2630                TO WS-ERROR
03735          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03736
03737      IF PB-I-LF-BENEFIT-CD = ZERO  AND
03738         PB-I-LF-BENEFIT-AMT = ZERO  AND
03739         PB-I-LF-PREMIUM-AMT = ZERO
03740          GO TO 3140-CHECK-AH-FOR-ZERO.
03741
03742      IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
03743         PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
03744         PB-I-LF-PREMIUM-AMT NOT = ZERO
03745          GO TO 3140-CHECK-AH-FOR-ZERO.
03746
03747      IF (PB-I-LF-BENEFIT-CD = ZERO)
100703        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
03748         MOVE ER-2631             TO WS-ERROR
03749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
           END-IF
03750
03751
03752 ******************************************************************
03753 *    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
03754 ******************************************************************
03755
03756      IF WS-LF-SPECIAL-CALC-CD = 'O'
03757         NEXT SENTENCE
03758      ELSE
03759         IF PB-I-LF-BENEFIT-AMT = ZERO
03760            MOVE ER-2632             TO WS-ERROR
03761            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03762
03763
03764 ******************************************************************
03765 *    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
03766 ******************************************************************
03767
03768      IF WS-LF-SPECIAL-CALC-CD = 'O'
100703        CONTINUE
03770      ELSE
03771         IF PB-I-LF-PREMIUM-AMT = ZERO
03772            IF (NOT PB-COMP-LF-PREM)
100703              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
03773               MOVE ER-2633       TO WS-ERROR
03774               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           END-IF
03775      .
03776  3140-CHECK-AH-FOR-ZERO.
03777
03778      IF PB-I-AH-BENEFIT-CD = ZERO  AND
03779         PB-I-AH-BENEFIT-AMT = ZERO  AND
03780         PB-I-AH-PREMIUM-AMT = ZERO
03781          GO TO 3140-EDIT-MAX-AMT-SIZES.
03782
03783      IF PB-COMPANY-ID = 'CSL'  AND
03784         PB-I-AH-BENEFIT-CD = ZERO  AND
03785         PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
03786         PB-I-AH-PREMIUM-AMT = ZERO
03787          GO TO 3140-EDIT-MAX-AMT-SIZES.
03788
03789      IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
03790         PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
03791         PB-I-AH-PREMIUM-AMT NOT = ZERO
03792          GO TO 3140-EDIT-MAX-AMT-SIZES.
03793
03794      IF PB-I-AH-BENEFIT-CD = ZERO
03795          MOVE ER-2634            TO WS-ERROR
03796          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03797
03798 ******************************************************************
03799 *     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
03800 ******************************************************************
03801
03802      IF WS-AH-SPECIAL-CALC-CD = 'O'
03803         NEXT SENTENCE
03804      ELSE
03805         IF PB-I-AH-BENEFIT-AMT = ZERO
03806            MOVE ER-2635             TO WS-ERROR
03807            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03808
03809 ******************************************************************
03810 *    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
03811 ******************************************************************
03812
03813      IF WS-AH-SPECIAL-CALC-CD = 'O'
03814         NEXT SENTENCE
03815      ELSE
03816         IF PB-I-AH-PREMIUM-AMT = ZERO
03817             IF NOT PB-COMP-AH-PREM
03818                 MOVE ER-2636    TO WS-ERROR
03819                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03820
03821
03822  3140-EDIT-MAX-AMT-SIZES.
03823 * CUSTOM CODE FOR CLIENT    'DMD'
03824      MOVE ZEROS                   TO WS-RES-STATE-TAX
03825                                      WS-RES-MUNI-TAX
03826                                      PB-I-STATE-TAX
03827                                      PB-I-MUNI-TAX.
03828
03829      PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
03830
03831      IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
03832         GO TO 3150-RATE-OUTSTAND-BAL.
03833
03834      IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
03835         GO TO 3150-RATE-OUTSTAND-BAL.
03836
03837      IF WS-LF-EARNINGS-CALC EQUAL '5'
03838         GO TO 3150-RATE-OUTSTAND-BAL.
03839
03840      IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
03841                              OR 'RIC')
03842         GO TO 3150-RATE-OUTSTAND-BAL.
03843
03844      IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
03845         IF PB-I-LOAN-APR GREATER THAN ZEROS
03846             GO TO 3150-RATE-OUTSTAND-BAL
03847         ELSE
03848            IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
03849                GO TO 3150-RATE-OUTSTAND-BAL.
03850
03851      IF NOT PB-NO-MONTHS-SKIPPED
03852         GO TO 3150-RATE-OUTSTAND-BAL.
03853
03854      IF PB-I-LF-TERM NOT = PB-I-AH-TERM
03855         GO TO 3150-RATE-OUTSTAND-BAL.
03856
03857      IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
03858         IF PB-I-AH-BENEFIT-AMT NOT = ZERO
03859            COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
03860              (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
03861            MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
03862            IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
03863               MOVE ER-2693     TO WS-ERROR
03864               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03865               GO TO 3150-RATE-OUTSTAND-BAL
03866            ELSE
03867               GO TO 3150-RATE-OUTSTAND-BAL.
03868
03869  3150-RATE-OUTSTAND-BAL.
03870
03871 * DMD RATING TEST
03872      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
03873          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
03874          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
03875          MOVE ER-2687                 TO WS-ERROR
03876          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03877          MOVE 'B'                     TO PB-I-OB-FLAG
03878          GO TO 3260-EDIT-CONTINUE.
03879
03880      IF  PB-COMPANY-ID   EQUAL    'CRI'
03881          IF  WS-ERROR    EQUAL    ER-2693
03882              IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
03883                  MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03884                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
03885                  MOVE  +0            TO  WS-ERROR.
03886
03887      IF  PB-COMPANY-ID   EQUAL    'CDL'
03888          IF  WS-ERROR    EQUAL    ER-2693
03889              IF WS-STATE-ABBREVIATION EQUAL 'NC'
03890                  MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03891                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
03892                  MOVE  +0            TO  WS-ERROR.
03893
03894      IF PLAN-MASTER-AH-SW = 'Y'
03895         IF  PB-COMPANY-ID   EQUAL    'CRI'
03896             IF  WS-ERROR    EQUAL    ER-2693
03897               IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
03898                  MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
03899                  MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03900                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
03901                  MOVE  ER-1910           TO  WS-ERROR
03902                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
03903
03904      IF PLAN-MASTER-AH-SW = 'Y'
03905         IF  PB-COMPANY-ID   EQUAL    'CRI'
03906             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
03907                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
03908                MOVE  ER-1910           TO  WS-ERROR
03909                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
03910
03911      IF PLAN-MASTER-AH-SW = 'Y'
03912         IF  PB-COMPANY-ID   EQUAL    'CRI'
03913             IF  WS-ERROR    EQUAL    ER-2693
03914                 IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
03915                  MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03916                  SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
03917                  MOVE  +0       TO  WS-ERROR.
03918
03919      IF WS-ERROR = ER-2693
03920         IF PB-COMPANY-ID = 'JAL' AND
03921            PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
03922            MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03923            SUBTRACT +1    FROM PB-NO-OF-ERRORS.
03924
03925      IF WS-ERROR = ER-2693
03926         IF PB-COMPANY-ID = 'NCL'  AND
03927            PB-I-AH-BENEFIT-CD = 'OA'
03928            MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03929            SUBTRACT +1    FROM PB-NO-OF-ERRORS.
03930
03931      IF WS-ERROR = ER-2693
03932         IF PB-COMPANY-ID = 'CNL' AND
03933            PB-I-LF-BENEFIT-CD = '71' OR '72'
03934            MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03935            SUBTRACT +1    FROM PB-NO-OF-ERRORS.
03936
03937      IF WS-ERROR = ER-2693
03938         IF PB-COMPANY-ID = 'HER'
03939            IF WS-LEVEL
03940               MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
03941               SUBTRACT +1    FROM PB-NO-OF-ERRORS.
03942
03943      IF ((LF-BENEFIT-FOUND) AND
03944          (NOT NO-LIFE-COVERAGE)  AND
03945          (WS-LF-SPECIAL-CALC-CD = 'O'))
03946        OR   ((AH-BENEFIT-FOUND) AND
03947              (NOT NO-AH-COVERAGE)    AND
03948              (WS-AH-SPECIAL-CALC-CD = 'O'))
03949          NEXT SENTENCE
03950      ELSE
03951          GO TO 3215-EDIT-RATES.
03952
03953      IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
03954         AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
03955            MOVE ER-2674          TO WS-ERROR
03956            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03957            GO TO 3215-EDIT-RATES.
03958
03959      IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
03960         AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
03961            MOVE ER-2674          TO WS-ERROR
03962            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03963            GO TO 3215-EDIT-RATES.
03964
03965      MOVE 'B'                    TO PB-I-OB-FLAG.
03966
03967      IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
03968          NEXT SENTENCE
03969      ELSE
03970          IF NOT NO-LIFE-COVERAGE
03971              IF WS-ACCT-LF-OB-RT = ZERO
03972                 MOVE ER-2641    TO WS-ERROR
03973                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03974
03975      IF PB-COMPANY-ID = 'CRI'
03976        IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
03977          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
03978          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
03979          IF WS-ERROR = ER-2675
03980             SUBTRACT +1               FROM PB-NO-OF-ERRORS
03981             MOVE ER-2687              TO WS-ERROR
03982             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
03983          ELSE
03984             MOVE ER-2687              TO WS-ERROR
03985             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03986
03987
03988      IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
03989          NEXT SENTENCE
03990      ELSE
041012       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
041012            NEXT SENTENCE
041012       ELSE
03991          IF NOT NO-AH-COVERAGE
03992              IF WS-ACCT-AH-OB-RT = ZERO
03993                 MOVE ER-2642    TO WS-ERROR
03994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
03995
03996      IF PB-COMPANY-ID = 'CRI'
03997        IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
03998          MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
03999          IF WS-ERROR = ER-2676
04000             SUBTRACT +1               FROM PB-NO-OF-ERRORS
04001             MOVE ER-2687              TO WS-ERROR
04002             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04003          ELSE
04004             MOVE ER-2687              TO WS-ERROR
04005             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04006
04007      IF PB-COMPANY-ID NOT = 'GIC'
04008          COMPUTE PB-I-LF-PREM-CALC ROUNDED =
04009             (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
04010      ELSE
04011          IF PB-I-LF-PREM-CALC = ZEROS
04012              COMPUTE PB-I-LF-PREM-CALC ROUNDED =
04013                 (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
04014
04015      IF PB-COMPANY-ID NOT = 'GIC'
04016          COMPUTE PB-I-AH-PREM-CALC ROUNDED =
04017             (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
04018      ELSE
04019          IF PB-I-AH-PREM-CALC = ZEROS
04020              COMPUTE PB-I-AH-PREM-CALC ROUNDED =
04021                 (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
04022
04023      MOVE ZEROS TO PB-I-MORT-CODE.
04024
04025      GO TO 3260-EDIT-CONTINUE.
04026
04027
04028  3215-EDIT-RATES.
04029      IF ACCOUNT-MAST-FOUND
04030          NEXT SENTENCE
04031      ELSE
04032          GO TO 3999-END-EDIT.
04033
04034  3220-CHECK-LF-RATES.
04035
082205     IF PB-COMPANY-ID = 'DCC'
082205        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
082205        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
082205        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-LF-CASH))
082205                           OR
082205           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-AH-CASH)))
111105                       AND
111105           (PB-I-ENTRY-STATUS NOT = '5')
082205           MOVE 'M'              TO PB-BATCH-ENTRY
082205                                    PB-I-ENTRY-STATUS
082205        END-IF
082205     END-IF
04036      MOVE ZEROS                  TO PB-I-LF-PREM-CALC
04037                                     PB-I-AH-PREM-CALC
04038                                     PB-I-LF-ALT-PREM-CALC
04039                                     PB-I-LF-ALT-RATE
04040                                     PB-I-LF-REI-RATE
04041                                     PB-I-LF-ALT-REI-RATE
04042                                     PB-I-AH-REI-RATE
011904                                    PB-I-TOT-FEES-CALC.
04043
04044      IF PB-COMPANY-ID EQUAL 'DMD'
04045         NEXT SENTENCE
04046      ELSE
04047         MOVE ZEROS               TO PB-I-LF-RATE
04048                                     PB-I-AH-RATE.
04049
           IF PB-I-TOT-FEES NOT NUMERIC
              MOVE ZEROS               TO PB-I-TOT-FEES
           END-IF
04050      IF PB-I-LIVES NOT NUMERIC
04051          MOVE ZERO               TO PB-I-LIVES.
04052
04053      IF PB-I-NUM-BILLED NOT NUMERIC
04054          MOVE ZERO               TO PB-I-NUM-BILLED.
04055
PEMMOD     IF PB-I-LF-PREM-TAX NOT NUMERIC
PEMMOD        MOVE +0                  TO PB-I-LF-PREM-TAX
PEMMOD     END-IF
PEMMOD
PEMMOD     IF PB-I-AH-PREM-TAX NOT NUMERIC
PEMMOD        MOVE +0                  TO PB-I-AH-PREM-TAX
PEMMOD     END-IF
PEMMOD
04056      IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
04057         PB-I-PAY-FREQUENCY = ZEROS
04058             MOVE 12 TO CP-PAY-FREQUENCY
04059      ELSE
04060             MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
04061
04062      IF PB-I-STATE-TAX NOT NUMERIC
04063          MOVE ZEROS               TO PB-I-STATE-TAX.
04064
04065      IF PB-I-MUNI-TAX NOT NUMERIC
04066          MOVE ZEROS               TO PB-I-MUNI-TAX.
04067
100703     MOVE SPACES                 TO CP-BEN-CATEGORY
04068      IF PB-COMPANY-ID  = 'CSL'  AND
04069         PB-I-LF-TERM NOT = ZERO
04070         COMPUTE WS-PAYMENT-AMT =
04071              PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
04072         COMPUTE WS-CSL-AMT1 =
04073              PB-I-LF-TERM * AM-MAX-MON-BEN
04074         COMPUTE WS-CSL-AMT2 =
04075              WS-PAYMENT-AMT * PB-I-LF-TERM
04076         IF CP-PAY-FREQUENCY NOT = 12
04077            MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
04078            MOVE '8' TO WS-CSL-CALC-CD
04079         ELSE
04080            IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
04081               (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
04082                AM-MAX-TOT-BEN
04083                MOVE '6' TO WS-CSL-CALC-CD
04084            ELSE
04085               IF (WS-CSL-AMT1  GREATER THAN
04086                  AM-MAX-TOT-BEN) AND
04087                  (WS-CSL-AMT2  GREATER THAN
04088                  AM-MAX-TOT-BEN)
04089                  MOVE '7' TO WS-CSL-CALC-CD
04090               ELSE
04091                  MOVE '5' TO WS-CSL-CALC-CD.
04092
04093      IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
04094          NEXT SENTENCE
04095      ELSE
04096          GO TO 3300-CHECK-AH-RATES.
04097
04098 *****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
04099
04100      IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
04101         IF (PB-I-LF-CRIT-PER    EQUAL +0)
04102               OR
04103            (PB-I-PAYMENT-AMOUNT EQUAL +0)
04104            MOVE ER-2618          TO WS-ERROR
04105            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04106            GO TO 3300-CHECK-AH-RATES.
04107
04108      IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
04109            COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
04110                    PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
04111
04112      IF WS-LF-SPECIAL-CALC-CD = 'M'
04113          MOVE ER-2687             TO WS-ERROR
04114          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04115          MOVE 'Z000'              TO PB-I-MORT-CODE
04116          MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
04117          GO TO 3300-CHECK-AH-RATES.
04118
04119      IF WS-LF-SPECIAL-CALC-CD = 'Z'
04120         IF PB-I-LIVES = ZERO
04121            MOVE ER-2688          TO WS-ERROR
04122            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04123
04124      MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
04125
04126      MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
04127      MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
04128      MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
04129      MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
04130      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
04131      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
04132      MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
04133      MOVE '3'                    TO CP-PROCESS-TYPE.
04134      MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
04135      MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
04136
04137 ******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
04138      IF PB-COMPANY-ID EQUAL 'CDL'
04139          IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
04140             CP-EARN-AS-NET-PAY)
04141              IF PB-CERT-EFF-DT GREATER  WS-931231
04142                  MOVE '1'        TO CP-EARNING-METHOD.
04143 *******
04144
04145      MOVE PB-SV-STATE            TO CP-STATE.
04146      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
04147      MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
04148      MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
04149      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
04150      MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
04151                                     CP-RATING-BENEFIT-AMT.
04152      IF CP-STATE-STD-ABBRV = 'OR'
04153          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
04154                                          PB-I-LF-ALT-BENEFIT-AMT.
04155      MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
04156      MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
04157      MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
04158      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
04159      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
04160      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
04161      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
04162      MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
04163      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
04164                                     CP-REMAINING-TERM
04165                                     CP-LOAN-TERM.
04166
04167      IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
04168          NEXT SENTENCE
04169      ELSE
04170          IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
04171              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
04172                                            PB-I-LF-PREMIUM-AMT.
04173
04174      IF PB-COMPANY-ID EQUAL 'CSL'
04175         IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
04176            COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
04177                                          PB-I-LF-PREMIUM-AMT.
04178
04179      IF PB-COMPANY-ID EQUAL 'NCB'
04180          IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
04181             CP-EARN-AS-NET-PAY
04182              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
04183                  PB-I-LF-PREMIUM-AMT.
04184
032912     IF (CP-TRUNCATED-LIFE)
032912        or ((pb-company-id = 'AHL')
032912           and (pb-i-loan-term > pb-i-lf-term))
04186         MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
04187
04188      IF PB-COMPANY-ID EQUAL 'CRI'
04189         MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
04190
04191      IF CP-TERM-IS-DAYS
04192          MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
04193      ELSE
04194          MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
071311        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
071311        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
              IF WS-LF-BEN-CATEGORY = 'D'
011410           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
011410           MOVE PB-I-LIFE-COMMISSION
011410                                 TO CP-DCC-ACT-COMM
                 MOVE WS-LF-BEN-CATEGORY
                                       TO CP-BEN-CATEGORY
              END-IF
071311        IF (CP-BENEFIT-CD (1:1) = 'P')
071311           AND (PB-I-LOAN-TERM NOT = ZEROS)
071311           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
022513           add pb-i-ah-premium-amt to cp-original-premium
071311        END-IF
080305     END-IF
04196      IF PB-COMPANY-ID = 'CSL'
04197          MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
04198          MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
04199          MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
04200
04201      IF PB-COMPANY-ID = 'CSL'
04202         MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
04203
04204      IF (CP-SPECIAL-CALC-CD = 'H')
011904        OR (PB-COMPANY-ID = 'DCC')
04205          MOVE PB-I-LF-ALT-BENEFIT-AMT
04206                                     TO CP-ALTERNATE-BENEFIT
04207          MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
04208
           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              MOVE PB-I-LF-ALT-BENEFIT-AMT
                                       TO CP-ALTERNATE-BENEFIT
              MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
           END-IF
041310     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
04209      MOVE 'R'                   TO CP-RATE-FILE.
04210      PERFORM 7000-GET-RATE THRU 7000-EXIT.
04211
04212      IF CP-ERROR-RATE-NOT-FOUND
04213         MOVE ER-2641            TO WS-ERROR
04214         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04215         GO TO 3300-CHECK-AH-RATES.
04216
04217      IF PB-COMPANY-ID EQUAL 'CRI'
04218         IF CP-ERROR-NO-LIMITS-CRI
04219            IF NOT ACCOUNT-LIFE-CHECKED
04220               MOVE ER-2607      TO WS-ERROR
04221               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04222
04223 ******************************************************************
04224 *    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
04225 *    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
04226 ******************************************************************
04227
CIDMOD* CALC LIFE AGE AT EXPIRATION.
CIDMOD
CIDMOD     COMPUTE WS-AGE-AT-EXPIRE =
CIDMOD          ((PB-I-LF-TERM / 12) + PB-I-AGE).
CIDMOD
PEMMOD*    IF PB-STATE = 'CO' OR 'UT'
PEMMOD*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
PEMMOD*        MOVE 'F'            TO PB-FATAL-FLAG
PEMMOD*        MOVE ER-2709        TO WS-ERROR
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.
CIDMOD
PEMMOD*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
PEMMOD*        MOVE 'X'            TO PB-FATAL-FLAG
PEMMOD*        MOVE ER-2718        TO WS-ERROR
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.
CIDMOD
CIDMOD* CALC A & H AGE AT EXPIRATION.
CIDMOD
CIDMOD     COMPUTE WS-AGE-AT-EXPIRE =
CIDMOD          ((PB-I-AH-TERM / 12) + PB-I-AGE).
CIDMOD
PEMMOD*    IF PB-STATE = 'CO' OR 'UT'
PEMMOD*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
PEMMOD*        MOVE 'F'            TO PB-FATAL-FLAG
PEMMOD*        MOVE ER-2709        TO WS-ERROR
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.
CIDMOD
PEMMOD*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
PEMMOD*        MOVE 'X'            TO PB-FATAL-FLAG
PEMMOD*        MOVE ER-2718        TO WS-ERROR
PEMMOD*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
PEMMOD*        GO TO PREMIUM-EDITING-IS-BYPASSED.
CIDMOD
04228      IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
04229         GO TO 3221-CHECK-ERROR-RATE-OPEN.
04230
04231      IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
04232         GO TO 3221-CHECK-ERROR-RATE-OPEN.
04233
04234      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
04235         GO TO 3221-CHECK-ERROR-RATE-OPEN.
04236
04237      IF CP-ERROR-AMT-OUTSIDE-LIMIT
04238          MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
04239          MOVE ER-2639        TO WS-ERROR
04240          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04241
03157
04242 ******************************************************************
04243 *    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
04244 ******************************************************************
04245
CIDMOD PREMIUM-EDITING-IS-BYPASSED.
042709     IF (CP-R-MAX-ATT-AGE NUMERIC)
042709        AND (CP-R-MAX-ATT-AGE > +0)
042709        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
042709        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
042709           MOVE '1'              TO DC-OPTION-CODE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709              MOVE ER-2661       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                 MOVE ER-1570    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF
042709        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709           MOVE PB-I-JOINT-BIRTHDAY
                                       TO DC-BIN-DATE-1
                 MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
042709           MOVE '1'              TO DC-OPTION-CODE
042709           PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709           IF NO-CONVERSION-ERROR
042709              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709              END-IF
                 ELSE
                    DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
042709           END-IF
042709        ELSE
042709           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                   (PB-I-LF-TERM / 12)
042709           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709              MOVE ER-2661       TO WS-ERROR
042709*             PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711           ELSE
020711              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                 MOVE ER-1571    TO WS-ERROR
020711                 PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711              END-IF
042709           END-IF
042709        END-IF
              IF WS-ERROR = ER-2661
042709           PERFORM 9900-ERROR-FORMAT
042709                                 THRU 9900-EXIT
              END-IF
042709     END-IF
04246 *    IF CP-ERROR-ATT-OUTSIDE-LIMIT
04247 *       MOVE ER-2661             TO WS-ERROR
04248 *       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04249
04250      IF CP-ERROR-AGE-OUTSIDE-LIMIT
04251         MOVE ER-2662             TO WS-ERROR
04252         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04253
04254      IF CP-ERROR-TERM-OUTSIDE-LIMIT
04255         MOVE ER-2677             TO WS-ERROR
04256         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04257
04258      IF CP-ERROR-LOAN-TERM
04259         MOVE ER-2648             TO WS-ERROR
04260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04261
04262  3221-CHECK-ERROR-RATE-OPEN.
04263
04264      IF CP-ERROR-RATE-FILE-NOTOPEN
04265          GO TO 3990-FILES-NOT-OPEN.
04266
04267      IF PB-COMPANY-ID NOT = 'DMD'
04268         MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
           END-IF
           .
04271  3221-CONTINUE.
011904     MOVE ZEROS                  TO WS-DCC-LF-RATE
011904                                    WS-DCC-AH-RATE
011410     IF PB-COMPANY-ID = 'DCC'
011410        IF WS-LF-BEN-CATEGORY = 'D'
011410           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
011410              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
011410        END-IF
011410     END-IF
04272      MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
      *   X'A4FF' = 12/31/2009
           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              AND (PB-CERT-EFF-DT > X'A4FF')
              MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
           END-IF
04273      MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
04274
04275      MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
011904     IF (PB-COMPANY-ID = 'DCC')
011904        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
011904        AND (PB-I-POLICY-IS-MONTHLY)
011904        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
011904        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
011904     END-IF
04276      MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
04277      MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
04278      MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
04279      MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
121304     IF (PB-COMPANY-ID = 'DCC')
121304        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
121304        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
121304        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
121304        MOVE ER-2786             TO WS-ERROR
121304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
121304     END-IF
04280
04281      MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
04282
04283 ******************************************************************
04284 *    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
04285 ******************************************************************
04286      IF WS-LF-SPECIAL-CALC-CD = 'E'
04287         GO TO 3225-CHECK-ALT-LIFE-RATE.
04288
04289      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
04290         GO TO 3225-CHECK-ALT-LIFE-RATE
04291      ELSE
04292        IF PB-I-LF-RATE = ZERO
04293           MOVE ER-2641          TO WS-ERROR
04294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04295
04296  3225-CHECK-ALT-LIFE-RATE.
04297
04298      IF (PB-COMPANY-ID EQUAL 'GTL') AND
04299         (WS-STATE-ABBREVIATION EQUAL 'PA') AND
04300         (CP-SPECIAL-CALC-CD EQUAL 'H')
04301          GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
04302
04303      IF (WS-LF-EARNINGS-CALC NOT = 'B')
04304          IF (PB-I-LF-ALT-BENEFIT-AMT > +0
011904             AND PB-COMPANY-ID NOT = 'DCC')
                         OR
04305               (PB-I-LF-ALT-PREMIUM-AMT > +0
04306               AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
071211              AND PB-COMPANY-ID NOT = 'DCC')
04307              MOVE ER-2720        TO  WS-ERROR
04308              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04309              GO TO 3225-RATING-CONT
04310          ELSE
04311              GO TO 3225-RATING-CONT.
030612     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
111610        AND (AM-GPCD = 01 OR 06 OR 15)
111610        MOVE ER-2798             TO WS-ERROR
111610        PERFORM 9900-ERROR-FORMAT
111610                                 THRU 9900-EXIT
111610*       GO TO 3225-RATING-CONT
111610     END-IF
           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              AND (PB-CERT-EFF-DT > X'A4FF')
              GO TO 3225-RATING-CONT
           END-IF
011904     IF PB-COMPANY-ID = 'DCC'
011904        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
011904           AND (PB-I-POLICY-IS-MONTHLY)
011904           GO TO 3225-RATING-CONT
011904        END-IF
011904     END-IF
011904
04313      IF PB-COMPANY-ID EQUAL 'WDS' AND
04314         (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
04315         CP-EARN-AS-REG-BALLOON
04316         NEXT SENTENCE
04317      ELSE
04318         MOVE '2'                 TO CP-EARNING-METHOD.
04319
04320  3225-SET-ALT-LIFE-RATE-LOOKUP.
04321
04322      MOVE 'L'                    TO CP-BENEFIT-TYPE.
04323
04324      IF (PB-COMPANY-ID EQUAL 'GTL') AND
04325         (WS-STATE-ABBREVIATION EQUAL 'PA') AND
04326         (CP-SPECIAL-CALC-CD EQUAL 'H')
04327          NEXT SENTENCE
04328      ELSE
04329          MOVE SPACE              TO CP-SPECIAL-CALC-CD.
04330
04331      MOVE 'LEV'                  TO CP-DEVIATION-CODE.
04332      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
04333      MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
04334                                      CP-RATING-BENEFIT-AMT.
04335      IF CP-STATE-STD-ABBRV = 'OR'
04336          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
04337                                          PB-I-LF-ALT-BENEFIT-AMT.
080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF
04338      MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
04339      MOVE ZERO                   TO CP-CRITICAL-MONTHS
04340      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
04341                                     CP-REMAINING-TERM
04342                                     CP-LOAN-TERM.
04343      IF WS-LF-SPECIAL-CALC-CD = 'L'
04344         ADD +1                   TO CP-ORIGINAL-TERM
04345                                     CP-REMAINING-TERM
04346                                     CP-LOAN-TERM.
04347
04348      MOVE 'R'                   TO CP-RATE-FILE.
04349      PERFORM 7000-GET-RATE THRU 7000-EXIT.
04350
04351      IF CP-ERROR-RATE-NOT-FOUND
04352          MOVE ER-2641            TO WS-ERROR
04353          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04354          GO TO 3300-CHECK-AH-RATES.
04355
04356      MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
04357      MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
04358
04359      IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
04360          MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
04361
04362      COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
04363                                + PB-I-LF-ALT-BENEFIT-AMT.
04364
04365      IF ACCOUNT-LIFE-CHECKED  OR
04366         PB-POLICY-IS-VOIDED   OR
04367         (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
04368         GO TO 3225-CONTINUE.
04369
04370      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
04371         GO TO 3225-CONTINUE.
04372
04373      IF WS-LF-BENEFIT-AMT  GREATER THAN
04374                              EC-RT-LF-MAX-TOT-BEN
04375         MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
04376         MOVE ER-2639       TO WS-ERROR
04377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04378
04379  3225-CONTINUE.
04380      IF PB-I-LF-ALT-RATE = ZERO
04381          MOVE ER-2659            TO WS-ERROR
04382          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04383
04384      IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
04385         PB-I-LF-ALT-PREMIUM-AMT = ZERO
04386         MOVE ER-2698             TO WS-ERROR
04387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04388
04389  3225-RATING-CONT.
04390
04391      IF WS-LF-SPECIAL-CALC-CD = 'E'
04392          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
04393          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
111212         IF (PB-COMPANY-ID = 'DCC')
111212            AND (AM-DCC-PRODUCT-CODE = 'DDF')
111212            CONTINUE
111212         ELSE
04394             MOVE ER-2687         TO WS-ERROR
04395             PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
111212         END-IF
04396          GO TO 3290-EDIT-LF-REIN-RATE
111212     END-IF
04397
04398 * DMD RATING TEST
04399      IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
04400          MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
04401          MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
04402          MOVE ER-2687                 TO WS-ERROR
04403          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04404          GO TO 3290-EDIT-LF-REIN-RATE.
04405
04406  3230-CLIENT-MORT-CD-SPECIALS.
04407
04408      MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
04409      SET BIN-TO-GREG          TO TRUE.
04410 *    MOVE ' '                 TO DC-OPTION-CODE.
04411      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
04412      MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
04413
04414  C-POS-3230-MORT-CD.
04415      IF PB-COMPANY-ID = 'POS' AND
04416         PB-SV-CARRIER = '2'
04417          NEXT SENTENCE
04418      ELSE
04419          GO TO C-POS-3240-MORT-CD.
04420
04421      IF PB-SV-GROUPING = '030'
04422         AND PB-CERT-EFF-DT GREATER THAN WS-791231
04423          MOVE '2350' TO PB-I-MORT-CODE
04424       ELSE
04425          MOVE '3300' TO PB-I-MORT-CODE.
04426
04427
04428  C-POS-3240-MORT-CD.
04429      IF PB-COMPANY-ID = 'POS' AND
04430         PB-SV-CARRIER = '1'
04431          NEXT SENTENCE
04432      ELSE
CIDMOD         GO TO 3230-CONTINUE.
04434
04435      IF PB-SV-STATE = '45' OR '47'
04436         OR PB-CERT-EFF-DT LESS THAN WS-771001
04437          MOVE '5200' TO PB-I-MORT-CODE
04438      ELSE
04439          MOVE '8300' TO PB-I-MORT-CODE.
04440
CIDMOD 3230-CONTINUE.
CIDMOD
CIDMOD     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
CIDMOD        GO TO 3240-CONTINUE
CIDMOD     END-IF
CIDMOD
CIDMOD     IF PB-CERT-EFF-DT > WS-971231
CIDMOD        GO TO 3240-CONTINUE
CIDMOD     END-IF
CIDMOD
CIDMOD     IF LF-BENEFIT-FOUND AND
CIDMOD        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
CIDMOD         MOVE 'F250'       TO PB-I-MORT-CODE
CIDMOD     ELSE
CIDMOD         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
CIDMOD             MOVE '7250'   TO PB-I-MORT-CODE
CIDMOD         ELSE
CIDMOD             MOVE '4251'   TO PB-I-MORT-CODE
CIDMOD         END-IF
CIDMOD     END-IF
CIDMOD
CIDMOD     .
04441  3240-CONTINUE.
CIDMOD
04442      IF PB-COMPANY-ID NOT = 'GNL'
04443          GO TO 3256-CONTINUE.
04444
04445      IF PB-CERT-EFF-DT  LESS THAN WS-820301
04446          MOVE 'A300' TO PB-I-MORT-CODE
04447      ELSE
04448          MOVE '8350' TO PB-I-MORT-CODE.
04449
04450  3256-CONTINUE.
04451      IF PB-COMPANY-ID NOT = 'ABL'
04452          GO TO 3260-EDIT-CONTINUE.
04453
04454      IF PB-I-LF-TERM GREATER THAN 59
04455          MOVE 'F550' TO PB-I-MORT-CODE
04456      ELSE
04457          MOVE 'E550' TO PB-I-MORT-CODE.
04458
04459  3260-EDIT-CONTINUE.
04460      MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
04461
04462  3290-EDIT-LF-REIN-RATE.
04463      IF LF-REIN-NSP-NOT-USED
04464          GO TO 3290-RATING-CONT.
04465
PEMTST     IF PB-COMPANY-ID = 'DCC'
PEMTST        GO TO 3290-RATING-CONT.
04466      MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
04467      MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
04468      MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
04469      MOVE '3'                   TO CP-PROCESS-TYPE.
04470      MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
04471
04472 ******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
04473      IF PB-COMPANY-ID EQUAL 'CDL'
04474          IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
04475             CP-EARN-AS-NET-PAY)
04476              MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
04477 *            MOVE SPACE          TO DC-OPTION-CODE
04478              SET BIN-TO-GREG     TO TRUE
04479              PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
04480 ***  Y2K PROJ 7744
04481              IF DC-GREG-DATE-CYMD GREATER 19931231
04482                  MOVE '1'        TO CP-EARNING-METHOD.
04483 ***  Y2K PROJ 7744
04484 *******
04485
04486      MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
04487      MOVE PB-SV-STATE           TO CP-STATE.
04488      MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
04489      MOVE ZERO                  TO CP-DEVIATION-CODE
04490                                    CP-RATE-DEV-PCT.
04491      MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
04492      MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
04493                                    CP-RATING-BENEFIT-AMT.
04494
04495 ************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
04496      IF PB-COMPANY-ID EQUAL 'NCB'
04497          IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
04498             CP-EARN-AS-NET-PAY
04499              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
04500                  PB-I-LF-PREMIUM-AMT.
04501 ************
04502
04503      IF CP-STATE-STD-ABBRV = 'OR'
04504          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
04505                                          PB-I-LF-ALT-BENEFIT-AMT.
04506      MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
04507      MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
04508      MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
04509      MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
04510      MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
04511      MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
04512      MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
04513      MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
04514                                    CP-REMAINING-TERM
04515                                    CP-LOAN-TERM.
04516      IF CP-TRUNCATED-LIFE
04517         MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
04518
04519      IF CP-TERM-IS-DAYS
04520          MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
04521      ELSE
04522          MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
04523
080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF
04524      IF PB-COMPANY-ID NOT = 'TIC'
04525           MOVE ZERO          TO CP-CLASS-CODE.
04526
04527      MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
04528
04529      MOVE 'R'                   TO CP-RATE-FILE.
04530      PERFORM 7000-GET-RATE THRU 7000-EXIT.
04531
04532      IF CP-ERROR-RATE-NOT-FOUND
04533         IF PB-I-OB
04534            MOVE ER-2625      TO WS-ERROR
04535            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04536            GO TO 3299-EDIT-CONTINUE
04537         ELSE
04538            MOVE ER-2643      TO WS-ERROR
04539            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04540            GO TO 3299-EDIT-CONTINUE.
04541
04542      MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
04543
04544      MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
04545      MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
04546
04547      IF PB-I-LF-REI-RATE = ZERO
04548          MOVE ER-2643        TO WS-ERROR
04549          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04550
04551  3290-CHECK-ALT-REIN-RATE.
04552
04553      IF WS-LF-EARNINGS-CALC NOT = 'B'
04554         GO TO 3290-RATING-CONT.
04555
04556      MOVE 'L'                    TO CP-BENEFIT-TYPE.
04557      MOVE '2'                    TO CP-EARNING-METHOD.
04558      MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
04559      MOVE 'LEV'                  TO CP-DEVIATION-CODE.
04560      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
04561      MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
04562                                      CP-RATING-BENEFIT-AMT.
04563      IF CP-STATE-STD-ABBRV = 'OR'
04564          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
04565                                          PB-I-LF-ALT-BENEFIT-AMT.
080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF
04566      MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
04567      MOVE ZERO                   TO CP-CRITICAL-MONTHS
04568      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
04569                                     CP-REMAINING-TERM
04570                                     CP-LOAN-TERM.
04571      IF WS-LF-SPECIAL-CALC-CD = 'L'
04572         ADD +1                   TO CP-ORIGINAL-TERM
04573                                     CP-REMAINING-TERM
04574                                     CP-LOAN-TERM.
04575
04576      MOVE 'R'                   TO CP-RATE-FILE.
04577      PERFORM 7000-GET-RATE THRU 7000-EXIT.
04578
04579      MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
04580
04581      IF PB-I-LF-ALT-REI-RATE = ZERO
04582          MOVE ER-2643            TO WS-ERROR
04583          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04584
04585  3290-RATING-CONT.
04586
04587      IF PB-I-OB
04588 *       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
04589         GO TO 3300-CHECK-AH-RATES.
04590
04591  3299-EDIT-CONTINUE.
04592
04593      IF  PB-I-MORT-CODE GREATER THAN SPACES
04594          NEXT SENTENCE
04595      ELSE
04596          MOVE ER-2620           TO WS-ERROR
04597          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04598
04599  3300-CHECK-AH-RATES.
04600      IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
04601          NEXT SENTENCE
04602      ELSE
04603          GO TO 3340-CALCULATE-PREMIUM-AMT.
04604
04605      IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
04606         ((CF-COMPANY-ID = 'DMD') AND
04607                 (NO-DMD-RATING))
111212         IF (PB-COMPANY-ID = 'DCC')
111212            AND (AM-DCC-PRODUCT-CODE = 'DDF')
111212            CONTINUE
111212         ELSE
04608             MOVE ER-2687         TO WS-ERROR
04609             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
111212         END-IF
04610          MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
04611          GO TO 3335-EDIT-AH-REIN-NSP-RATE
111212     END-IF
04612
04613      IF PB-I-OB
04614         GO TO 3335-EDIT-AH-REIN-NSP-RATE.
04615
04616      IF WS-AH-SPECIAL-CALC-CD = 'M'
04617          MOVE ER-2687             TO WS-ERROR
04618          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04619          MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
04620          GO TO 3999-END-EDIT.
04621
04622 *****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
04623
04624      IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
04625         IF PB-I-AH-CRIT-PER = ZERO
071211           IF PB-COMPANY-ID = 'DCC'
071211              AND AM-DCC-PRODUCT-CODE = 'DDF'
071211              CONTINUE
071211           ELSE
04626               MOVE ER-2618       TO WS-ERROR
04627               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04628               GO TO 3999-END-EDIT
                 END-IF
              END-IF
           END-IF
04631      MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
04632      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
04633      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
04634      MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
04635      MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
04636      MOVE PB-SV-STATE            TO CP-STATE.
04637      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
04638      MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
04639      MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
04640 *    MOVE 'A'                    TO CP-BENEFIT-TYPE.
04641      MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
04642      MOVE '3'                    TO CP-PROCESS-TYPE.
04643      MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
04644      MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
04645                                     CP-RATING-BENEFIT-AMT.
091610     IF PB-COMPANY-ID = 'CID'
091610               OR
04646         CP-STATE-STD-ABBRV = 'OR'
04647          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
04648                                          PB-I-AH-TERM.
123102     IF PB-COMPANY-ID = 'DCC' OR 'CID'
071311        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
011904           AND (PB-I-POLICY-IS-MONTHLY)
123102           MOVE PB-I-LF-BENEFIT-AMT
123102                                 TO CP-NET-BENEFIT-AMT
                 move pb-i-ah-premium-amt to cp-original-premium
022513           add pb-i-lf-premium-amt to cp-original-premium
123102        END-IF
123102     END-IF
100703     MOVE SPACES                 TO CP-BEN-CATEGORY
           IF PB-COMPANY-ID = 'DCC'
              MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
              EVALUATE TRUE
                 WHEN (WS-AH-BEN-CATEGORY = 'G')
                    AND (AM-DCC-PRODUCT-CODE = 'DDF')
                    MOVE PB-I-LF-BENEFIT-AMT
                                       TO CP-RATING-BENEFIT-AMT
                    MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
                 WHEN WS-AH-BEN-CATEGORY = 'G'
                    MOVE PB-I-UNPAID-CASH-PRICE
                                       TO CP-RATING-BENEFIT-AMT
                 WHEN WS-AH-BEN-CATEGORY = 'D'
                    MOVE WS-AH-PMF-COMM
                                       TO CP-DCC-PMF-COMM
                    MOVE PB-I-AH-COMMISSION
                                       TO CP-DCC-ACT-COMM
              END-EVALUATE
           END-IF
04649      MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
04650      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
04651      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
04652      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
04653      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
04654      MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
04655      MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
04656                                     CP-REMAINING-TERM
04657                                     WS-WORK-TERM.
04658      MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
04659
04660      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
04661      SET BIN-TO-GREG             TO TRUE.
04662 *    MOVE ' '                    TO DC-OPTION-CODE.
04663      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
04664      MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
04665
04666      MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
04667      IF NOT VALID-SKIP-CODE
04668          MOVE ER-2683            TO WS-ERROR
04669          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04670          GO TO 3320-RATE-CONTINUE.
04671
04672      IF PB-NO-MONTHS-SKIPPED
04673          GO TO 3320-RATE-CONTINUE.
04674
04675      MOVE SPACE TO NUMBER-OF-MONTHS.
04676
04677      IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
04678          MOVE 'S'                TO SK-MO (6).
04679      IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
04680          MOVE 'S'                TO SK-MO (7).
04681      IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
04682          MOVE 'S'                TO SK-MO (8).
04683      IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
04684          MOVE 'S'                TO SK-MO (9).
04685      IF PB-I-SKIP-CODE = 'A'
04686          MOVE 'S'                TO SK-MO (10).
04687
04688      MOVE 1                      TO SUB2.
04689      MOVE PB-I-AH-TERM           TO SUB3.
04690      MOVE WS-MONTH               TO SUB1.
04691      PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
04692      GO TO 3320-RATE-CONTINUE.
04693
04694  3310-GET-SKIP-MO.
04695      IF SUB1 = 13
04696          MOVE 1                  TO SUB1.
04697
04698      IF SK-MO (SUB1) = 'S'
04699          SUBTRACT 1 FROM WS-WORK-TERM.
04700
04701      ADD 1 TO SUB2
04702               SUB1.
04703
04704  3320-RATE-CONTINUE.
04705
04706      IF WS-WORK-TERM = ZERO
04707          MOVE 1                  TO WS-WORK-TERM.
04708
04709      MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
04710                                     CP-LOAN-TERM.
04711
04712      IF PB-COMPANY-ID EQUAL 'DMD'
04713          NEXT SENTENCE
04714      ELSE
04715          MOVE ZERO               TO PB-I-AH-RATE
04716                                     PB-I-AH-REI-RATE.
04717
04718
04719      IF PB-COMPANY-ID EQUAL 'CRI'
04720         MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
04721
04722      IF PB-COMPANY-ID = 'CSL'
04723          MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
04724          MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
04725          MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
04726          MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
04727
           IF PB-COMPANY-ID = 'DCC'
              IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
                 COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
                    PB-I-RATE-DEV-PCT-LF
              END-IF
              MOVE PB-I-LF-ALT-BENEFIT-AMT
                                       TO CP-ALTERNATE-BENEFIT
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
071311        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
071311        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
           END-IF
           IF (PB-COMPANY-ID = 'CID')
              AND (WS-LF-EARNINGS-CALC = 'B')
              AND (CP-STATE-STD-ABBRV = 'MN')
              MOVE 'Y'                 TO CP-AH-BALLOON-SW
           ELSE
              MOVE ' '                 TO CP-AH-BALLOON-SW
           END-IF
011904     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
04728      MOVE 'R'                   TO CP-RATE-FILE.
04729      PERFORM 7000-GET-RATE THRU 7000-EXIT.
04730
04731      IF CP-ERROR-RATE-NOT-FOUND
04732         IF PB-I-OB
04733            MOVE ER-2624          TO WS-ERROR
04734            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04735            GO TO 3340-CALCULATE-PREMIUM-AMT
04736         ELSE
041012          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
041012              NEXT SENTENCE
041012          ELSE
04737            MOVE ER-2642          TO WS-ERROR
04738            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04739            GO TO 3340-CALCULATE-PREMIUM-AMT.
04740
04741      IF PB-COMPANY-ID EQUAL 'CSL' AND
04742         CP-ERROR-DIV-BY-ZERO
04743            MOVE ER-3782          TO WS-ERROR
04744            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04745
04746      IF PB-COMPANY-ID EQUAL 'CRI'
04747         IF CP-ERROR-NO-LIMITS-CRI
04748            IF NOT ACCOUNT-AH-CHECKED
04749               MOVE ER-2607          TO WS-ERROR
04750               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04751
04752      IF ACCOUNT-AH-CHECKED
04753         NEXT SENTENCE
04754      ELSE
04755        IF CP-ERROR-AMT-OUTSIDE-LIMIT
04756           MOVE ER-2640           TO WS-ERROR
04757           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04758
04759      IF PB-COMPANY-ID = 'CRI'
04760          IF WS-ERROR = ER-2640
04761              MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
042709     IF ACCOUNT-AH-CHECKED
042709        CONTINUE
042709     ELSE
042709        IF (CP-R-MAX-ATT-AGE NUMERIC)
042709           AND (CP-R-MAX-ATT-AGE > +0)
042709           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
042709           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
042709              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
                    MOVE PB-I-AH-EXPIRE-DT
                                       TO DC-BIN-DATE-2
042709              MOVE '1'           TO DC-OPTION-CODE
042709              PERFORM 8500-DATE-CONVERT
042709                                 THRU 8500-EXIT
042709              IF NO-CONVERSION-ERROR
042709                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                    MOVE ER-2661       TO WS-ERROR
042709*                   PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
042709                 END-IF
042709              END-IF
042709           ELSE
042709              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
042709              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661    TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                THRU 9900-EXIT
020711              ELSE
020711                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                    MOVE ER-1570 TO WS-ERROR
020711                    PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711                 END-IF
042709              END-IF
042709           END-IF
042709           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
042709              MOVE PB-I-JOINT-BIRTHDAY
                                          TO DC-BIN-DATE-1
                    MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
042709              MOVE '1'              TO DC-OPTION-CODE
042709              PERFORM 8500-DATE-CONVERT
042709                                    THRU 8500-EXIT
042709              IF NO-CONVERSION-ERROR
042709                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
042709                    MOVE ER-2661       TO WS-ERROR
042709*                   PERFORM 9900-ERROR-FORMAT
042709*                                   THRU 9900-EXIT
042709                 END-IF
042709              END-IF
042709           ELSE
042709              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
                      (PB-I-AH-TERM / 12)
042709              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
042709                 MOVE ER-2661       TO WS-ERROR
042709*                PERFORM 9900-ERROR-FORMAT
042709*                                   THRU 9900-EXIT
020711              ELSE
020711                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
020711                    MOVE ER-1571 TO WS-ERROR
020711                    PERFORM 9900-ERROR-FORMAT
020711                                 THRU 9900-EXIT
020711                 END-IF
042709              END-IF
042709           END-IF
                 IF WS-ERROR = ER-2661
042709              PERFORM 9900-ERROR-FORMAT
042709                                    THRU 9900-EXIT
                 END-IF
              END-IF
042709     END-IF
042709*    IF ACCOUNT-AH-CHECKED
042709*       NEXT SENTENCE
042709*    ELSE
042709*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
042709*          MOVE ER-2661          TO WS-ERROR
042709*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04769
04770      IF ACCOUNT-AH-CHECKED
04771         NEXT SENTENCE
04772      ELSE
04773         IF CP-ERROR-AGE-OUTSIDE-LIMIT
04774            MOVE ER-2663          TO WS-ERROR
04775            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04776
04777      IF ACCOUNT-AH-CHECKED OR
04778         (WS-AH-SPECIAL-CALC-CD = 'Z') OR
04779          PB-POLICY-IS-VOIDED
04780         NEXT SENTENCE
04781      ELSE
04782         IF CP-ERROR-TOT-OUTSIDE-LIMIT
04783            MOVE ER-2667            TO WS-ERROR
04784            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04785
04786      IF PB-COMPANY-ID = 'CRI'
04787          IF WS-ERROR = ER-2667
04788              MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
04789
04790      IF ACCOUNT-AH-CHECKED
04791         NEXT SENTENCE
04792      ELSE
04793         IF CP-ERROR-TERM-OUTSIDE-LIMIT
04794            MOVE ER-2678            TO WS-ERROR
04795            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04796
04797      IF CP-ERROR-RATE-FILE-NOTOPEN
04798          GO TO 3990-FILES-NOT-OPEN.
04799
04800  3321-CONTINUE.
04801      MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
04802      MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
100703     IF (PB-COMPANY-ID = 'DCC')
100703        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
100703        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
100703                                    PB-I-LF-ALT-PREM-CALC
100703        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
092705        IF WS-AH-BEN-CATEGORY = 'G'
100703           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
040504           + PB-I-ADDL-CLP)
071211           * (1 + WS-TOL-CLP-PCT)
071211*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
092705        ELSE
092705           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
071211           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
071211*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
092705        END-IF
070705        MOVE WS-TOL-LF-HIGH-PREM-AMT
070705                                 TO PB-I-AH-PREM-CALC
100703        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
100703           MOVE ER-8152          TO WS-ERROR
100703           PERFORM 9900-ERROR-FORMAT
100703                                 THRU 9900-EXIT
100703        ELSE
100703           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
                       PB-I-ADDL-CLP)
100703              MOVE ER-8148       TO WS-ERROR
100703              PERFORM 9900-ERROR-FORMAT
100703                                 THRU 9900-EXIT
100703           END-IF
100703        END-IF
100703     END-IF
011904     IF (PB-COMPANY-ID = 'DCC')
011904        AND (PB-I-POLICY-IS-MONTHLY)
011904        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
011904        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
011904        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
                 MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
              END-IF
011904     END-IF
121304     IF (PB-COMPANY-ID = 'DCC')
121304        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
121304        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
121304        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
121304        MOVE ER-2786             TO WS-ERROR
121304        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
121304     END-IF
071211     MOVE +0                     TO PB-I-AH-CLP
011410     IF PB-COMPANY-ID = 'DCC'
011410        IF WS-AH-BEN-CATEGORY = 'D'
011410           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
011410              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
071211        ELSE
071211           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
071211              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
071211           END-IF
011410        END-IF
011410     END-IF
04803      MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
04804
04805      IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
04806          MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
04807
04808      IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
04809          MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
04810
04811      IF PB-COMPANY-ID = 'CRI'
04812          IF PB-I-NO-OF-PAYMENTS = ZERO  OR
04813             PB-I-PAYMENT-AMOUNT = ZERO
04814              NEXT SENTENCE
04815          ELSE
04816              COMPUTE PB-I-AH-PREM-CALC =
04817                  (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
04818                  (CP-PREMIUM-RATE / 100)
04819              IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
04820                  COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
04821                                              PB-I-RATE-DEV-PCT-AH.
04822
04823      IF PB-I-AH-RATE  = ZERO
041012       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
041012           NEXT SENTENCE
041012       ELSE
04824          MOVE ER-2642            TO WS-ERROR
04825          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04826
04827      MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
04828      MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
04829      MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
04830      MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
04831      MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
04832      MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
04833
071211     IF (PB-COMPANY-ID = 'DCC')
071211        AND (WS-AH-BEN-CATEGORY = 'G')
071211        AND (AM-DCC-PRODUCT-CODE = 'DDF')
071211        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
071211        IF CP-DEVIATION-CODE NOT = '000'
071211           MOVE '000'            TO CP-DEVIATION-CODE
071211           PERFORM 7000-GET-RATE THRU 7000-EXIT
071211           IF NO-CP-ERROR
071211              COMPUTE PB-I-DDF-IU-RATE-UP =
071211              PB-I-AH-CLP - CP-CALC-PREMIUM
071211           ELSE
071211              MOVE ER-3057        TO WS-ERROR
071211              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
071211           END-IF
071211        END-IF
071211     END-IF
           .
04834  3335-EDIT-AH-REIN-NSP-RATE.
04835      IF AH-REIN-NSP-NOT-USED
04836          GO TO 3340-CALCULATE-PREMIUM-AMT.
04837
PEMTST     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
PEMTST     IF PB-COMPANY-ID = 'DCC'
PEMTST         GO TO 3340-CALCULATE-PREMIUM-AMT.
04838      MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
04839      MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
04840      MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
04841      MOVE PB-SV-STATE            TO CP-STATE.
04842      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
04843      MOVE ZERO                   TO CP-DEVIATION-CODE
04844                                     CP-RATE-DEV-PCT.
04845 *    MOVE 'A'                    TO CP-BENEFIT-TYPE.
04846      MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
04847      MOVE '3'                    TO CP-PROCESS-TYPE.
04848      MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
04849      MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
04850                                     CP-RATING-BENEFIT-AMT.
04851      IF CP-STATE-STD-ABBRV = 'OR'
04852          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
04853                                          PB-I-AH-TERM.
04854      MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
04855      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
04856      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
04857      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
04858      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
04859      MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
04860                                     CP-REMAINING-TERM
04861                                     WS-WORK-TERM.
04862      MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF
04864      IF  PB-COMPANY-ID = 'TIC'
04865          IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
04866             MOVE ZERO TO CP-CLASS-CODE.
04867
04868      IF PB-COMPANY-ID NOT = 'TIC'
04869           MOVE ZERO          TO CP-CLASS-CODE.
04870
04871      MOVE ZERO               TO CP-DEVIATION-CODE.
04872
04873      MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
04874
04875      MOVE ZERO               TO PB-I-AH-REI-RATE.
04876
04877      MOVE 'R'                   TO CP-RATE-FILE.
04878      PERFORM 7000-GET-RATE THRU 7000-EXIT.
04879
04880      IF CP-ERROR-RATE-NOT-FOUND
04881          MOVE ER-2645        TO WS-ERROR
04882          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04883          GO TO 3340-CALCULATE-PREMIUM-AMT.
04884
04885      MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
04886
04887      MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
04888      MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
04889
04890      IF PB-I-AH-REI-RATE = ZERO
04891          MOVE ER-2645        TO WS-ERROR
04892          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04893
04894
04895  3340-CALCULATE-PREMIUM-AMT.
04896
04897      IF PB-COMPANY-ID = 'NCL'
04898          IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
04899              WS-AH-SPECIAL-CALC-CD = 'O')
04900              GO TO 3999-END-EDIT.
04901
04902      IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
04903                         'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
040407                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
030612                         OR 'AHL'
04905          NEXT SENTENCE
04906      ELSE
04907          IF WS-STATE-ABBREVIATION = 'CT'
04908              IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
04909                 (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
04910                  COMPUTE PB-I-LF-PREM-CALC =
04911                                      PB-I-LF-PREM-CALC * .90
04912                  COMPUTE PB-I-LF-ALT-PREM-CALC =
04913                                      PB-I-LF-ALT-PREM-CALC * .90
04914                  COMPUTE PB-I-AH-PREM-CALC =
04915                                      PB-I-AH-PREM-CALC * .90.
04916
04917      IF PB-COMP-LF-PREM
04918         MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
04919         MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
04920
04921      IF PB-COMP-AH-PREM
04922         MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
04923
011904 3340-CHECK-DCC-TOT-FEES.
           IF (PB-COMPANY-ID = 'DCC')
              AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
              AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
              AND (PB-I-POLICY-IS-MONTHLY)
              CONTINUE
           ELSE
              GO TO 3340-EDIT-LF-AH-TOL
           END-IF
           MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
           MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
           IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
              COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
                 PB-I-RATE-DEV-PCT-LF
           END-IF
           IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
              COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
                 PB-I-RATE-DEV-PCT-AH
           END-IF
           MOVE 'N'                    TO CP-BEN-CATEGORY
04124      MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
04125
04126      MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
04127      MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
04128      MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
04129      MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
04130      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
04131      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
04132      MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
04133      MOVE '3'                    TO CP-PROCESS-TYPE.
04134      MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
04135      MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
04136
04145      MOVE PB-SV-STATE            TO CP-STATE.
04146      MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
04147      MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
04148      MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
04149      MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
04150      MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
04151                                     CP-RATING-BENEFIT-AMT.
04152      IF CP-STATE-STD-ABBRV = 'OR'
04153          COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
04154                                          PB-I-LF-ALT-BENEFIT-AMT.
04155      MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
04156      MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
04157      MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
04158      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
04159      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
04160      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
04161      MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
04162      MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
04163      MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
04164                                     CP-REMAINING-TERM
04165                                     CP-LOAN-TERM.
04167      IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
04168          NEXT SENTENCE
04169      ELSE
04170          IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
04171              COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
04172                                            PB-I-LF-PREMIUM-AMT.
04184
04185      IF CP-TRUNCATED-LIFE
04186         MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
04187
04191      IF CP-TERM-IS-DAYS
04192          MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
04193      ELSE
04194          MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
04195
080305     IF PB-COMPANY-ID = 'DCC'
080305        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
080305     END-IF
04204      IF CP-SPECIAL-CALC-CD = 'H'
04205          MOVE PB-I-LF-ALT-BENEFIT-AMT
04206                                     TO CP-ALTERNATE-BENEFIT
04207          MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
           MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
           MOVE 'R'                    TO CP-RATE-FILE
           PERFORM 7000-GET-RATE       THRU 7000-EXIT
           IF NOT CP-ERROR-RATE-NOT-FOUND
              MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
              IF (CP-DCC-LF-RATE NOT = ZEROS)
                 AND (CP-BENEFIT-CD (1:1) = 'S')
                 MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
                                          PB-I-LF-PREMIUM-AMT
              END-IF
           ELSE
              MOVE +0                  TO PB-I-TOT-FEES-CALC
           END-IF
04925      .
04926  3340-EDIT-LF-AH-TOL.
04927
04928 ***    UNSIGN-WRK1    =    LIFE DIFFERENCE
04929 ***    UNSIGN-WRK2    =    AH   DIFFERENCE
04930 ***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
04931 ***
04932      ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
04933          PB-I-AH-PREMIUM-AMT
04934           GIVING WS-CALC-WORK.
04935
04936      IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
04937         AND WS-CALC-WORK NOT = ZERO
04938          MOVE ER-2649            TO WS-ERROR
04939          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
04940
04941      SUBTRACT PB-I-LF-PREM-CALC
04942              FROM PB-I-LF-PREMIUM-AMT
04943                  GIVING WS-UNSIGN-WRK1.
04944
04945      SUBTRACT PB-I-LF-ALT-PREM-CALC
04946              FROM PB-I-LF-ALT-PREMIUM-AMT
04947                  GIVING WS-UNSIGN-WRK4.
04948
04949      COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
04950                                 + WS-UNSIGN-WRK4.
04951
04952      SUBTRACT PB-I-AH-PREM-CALC
04953              FROM PB-I-AH-PREMIUM-AMT
04954                  GIVING WS-UNSIGN-WRK2.
04955
04956 ******************************************************************
04957 *    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
04958 ******************************************************************
04959
04960      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
04961          MOVE ZERO TO WS-UNSIGN-WRK1.
04962
04963      IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
04964          MOVE ZERO TO WS-UNSIGN-WRK2.
04965
04966      ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
04967              GIVING WS-UNSIGN-WRK3.
04968
04969  3342-CONTINUE.
04970
04971      IF (PB-I-LF-RATE = ZERO  AND
04972          PB-I-AH-RATE = ZERO)
04973          IF WS-LF-SPECIAL-CALC-CD = 'O' OR
04974             WS-AH-SPECIAL-CALC-CD = 'O'
04975               NEXT SENTENCE
04976          ELSE
04977              GO TO 3345-EDIT-CONTINUE.
04978
04979      IF  PB-RECORD-BILL   =  'B' OR  'L'
04980          NEXT SENTENCE
04981      ELSE
04982      IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
04983         IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
04984            IF (PB-REISSUED-CERT         OR
04985                PB-POLICY-IS-DECLINED    OR
04986                PB-POLICY-IS-VOIDED)
04987               NEXT SENTENCE
04988            ELSE
04989               IF WS-PREM-REJECT-SW = SPACE
04990                  MOVE ER-2652    TO WS-ERROR
04991                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04992                  GO TO 3344-CHECK-AH
04993               ELSE
04994                  MOVE ER-2650    TO WS-ERROR
04995                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
04996                  GO TO 3344-CHECK-AH.
04997
04998 ***
04999 ***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
05000 ***
05001
05002      IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
05003          COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
05004             (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
05005              (1 + WS-TOL-LF-PREM-PCT)
05006          COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
05007             (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
05008              (1 - WS-TOL-LF-PREM-PCT)
05009      ELSE
032013         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
032013         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
05012
05013 ***
05014 ***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
05015 ***
05016
05017      COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
05018          PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
05019           WS-TOL-LF-PREM.
05020
05021      COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
05022          (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
05023           WS-TOL-LF-PREM.
05024
05025      IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
05026         MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
05027
05028      IF PB-REISSUED-CERT
05029         or PB-POLICY-IS-DECLINED
05030         or PB-POLICY-IS-VOIDED
031513        continue
05032      ELSE
05033         IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
05034               > WS-TOL-LF-HIGH-PREM-AMT)
05035            OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
05037               < WS-TOL-LF-LOW-PREM-AMT))
031513                      or
05039            (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
05040               > WS-TOL-LF-HIGH-PREM-PCT)
05041            OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
05043               < WS-TOL-LF-LOW-PREM-PCT))
05044            IF WS-PREM-REJECT-SW = SPACE
05045               MOVE ER-2652       TO WS-ERROR
05046               PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
05047            ELSE
05048               MOVE ER-2650       TO WS-ERROR
05049               PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
031513           end-if
031513        end-if
031513     end-if
05050
05051 *    IF  WS-ERROR  =  ER-2650  OR  ER-2652
05052 *        IF  PB-RECORD-BILL   =  'B' OR  'L'
05053 *            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
05054 *            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
05055
100703     IF WS-ERROR  =  ER-2650  OR  ER-2652
100703        IF (PB-RECORD-BILL   =  'B' OR  'L')
100703                      OR
100703           ((PB-COMPANY-ID = 'DCC')
031513           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
100703           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
100703           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
100703        END-IF
100703     END-IF
05055
05056      IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
05057         IF WS-COMP-MAX-CAP GREATER THAN +0
05058            IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
05059               IF (PB-REISSUED-CERT         OR
05060                   PB-POLICY-IS-DECLINED    OR
05061                   PB-POLICY-IS-VOIDED)
05062                  NEXT SENTENCE
05063               ELSE
05064                   MOVE ER-2646   TO  WS-ERROR
05065                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05066
05067  3344-CVL-TOLERANCE-CHECK.
05068
05069       IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
05070           GO TO 3344-CHECK-AH.
05071
05072       IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
05073           GO TO 3344-CHECK-AH.
05074
05075       MOVE ZERO                  TO  WS-UNSIGN-WRK5
05076                                      WS-UNSIGN-WRK6.
05077
05078       IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
05079           COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
05080                                  + PB-I-LF-PREMIUM-AMT
05081                                  - PB-I-LF-PREM-CALC.
05082
05083       IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
05084           COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
05085                                  + PB-I-LF-ALT-PREMIUM-AMT
05086                                  - PB-I-LF-ALT-PREM-CALC.
05087
05088       IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
05089           IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
05090               IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
05091                  MOVE ER-2652    TO  WS-ERROR
05092                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05093               ELSE
05094                  MOVE ER-2650    TO  WS-ERROR
05095                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05096
05097       IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
05098           IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
05099               IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
05100                  MOVE ER-2652    TO  WS-ERROR
05101                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05102               ELSE
05103                  MOVE ER-2650    TO  WS-ERROR
05104                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05105
05106  3344-CHECK-AH.
05107
05108 ****************************************************************
05109 ***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
05110 ***
05111
05112      IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
05113          COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
05114              (1 + WS-TOL-AH-PREM-PCT)
05115          COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
05116              (1 - WS-TOL-AH-PREM-PCT)
05117      ELSE
032013         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
032013         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
05120
05121 ***
05122 ***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
05123 ***
05124
05125      COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
05126          PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
05127
05128      COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
05129          PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
05130
05131      IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
05132         MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
05133
05134      IF (PB-REISSUED-CERT)
05135         OR (PB-POLICY-IS-DECLINED)
              OR (PB-POLICY-IS-VOIDED)
              OR (AM-DCC-PRODUCT-CODE = 'DDF')
              CONTINUE
05138      ELSE
05139         IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
05141               OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
031513                          or
05144            ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
05145               OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
05147            IF WS-PREM-REJECT-SW = SPACE
05148               MOVE ER-3052       TO WS-ERROR
05149               PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
05150            ELSE
05151               MOVE ER-3050       TO WS-ERROR
05152               PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
                 END-IF
              END-IF
           END-IF
031513     if (pb-company-id = 'DCC')
031513        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
031513        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
031513        and (pb-i-policy-is-monthly)
031513        compute ws-tol-ah-high-prem-amt =
031513           pb-i-tot-fees-calc + ws-tol-ah-prem
031513        compute ws-tol-ah-low-prem-amt =
031513           pb-i-tot-fees-calc - ws-tol-ah-prem
031513        if ws-tol-ah-prem-pct > zeros
031513           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
031513              (1 + ws-tol-ah-prem-pct)
031513           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
031513              (1 - ws-tol-ah-prem-pct)
031513        else
032013           move +9999999.99      to ws-tol-ah-high-prem-pct
032013           move +0               to ws-tol-ah-low-prem-pct
031513        end-if
031513        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
031513            or
031513           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
031513                          or
031513           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
031513           or
031513           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
031513            move er-3049         to ws-error
031513           perform 9900-error-format
031513                                 thru 9900-exit
031513
031513        end-if
031513     end-if
05154      IF  WS-ERROR  =  ER-3050   OR   ER-3052
05155          IF  PB-RECORD-BILL   =  'B' OR 'A'
05156              MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
05157              SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
05158
05159      IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
05160         IF WS-COMP-MAX-CAP GREATER THAN +0
05161            IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
05162               IF (PB-REISSUED-CERT         OR
05163                   PB-POLICY-IS-DECLINED    OR
05164                   PB-POLICY-IS-VOIDED)
05165                  NEXT SENTENCE
05166               ELSE
05167                   MOVE ER-2646   TO  WS-ERROR
05168                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05169
05170      IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
05171         (WS-COMP-MAX-CAP EQUAL +0)
05172            GO TO 3345-EDIT-CONTINUE.
05173
05174      IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
05175         GREATER THAN WS-COMP-MAX-CAP
05176            MOVE ER-2646          TO  WS-ERROR
05177            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05178
05179  3345-EDIT-CONTINUE.
05180
072308*    IF PB-COMPANY-ID    EQUAL    'NCL'
072308*       IF PB-ENTRY-BATCH   NUMERIC
072308*          IF PB-ISSUE
072308*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
072308*          ELSE
072308*              IF PB-CANCELLATION
072308*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
05188
05189 *    IF  PB-COMPANY-ID    EQUAL    'HER'
05190 *        IF  PB-I-MICROFILM-NO     NUMERIC    AND
05191 *            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
05192 *            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
05193 *        ELSE
05194 *            MOVE  ER-1909            TO  WS-ERROR
05195 *            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05196
05197      IF PB-I-POLICY-ACCEPTED
05198         IF PB-POLICY-IS-DECLINED  OR
05199            PB-REISSUED-CERT  OR
05200            PB-REIN-ONLY-CERT  OR
05201            PB-POLICY-IS-VOIDED
05202             MOVE  ER-1891         TO  WS-ERROR
05203             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05204         ELSE
05205             MOVE SPACE            TO  PB-BATCH-ENTRY
05206             MOVE '2'              TO  PB-I-ENTRY-STATUS.
05207
05208      IF PB-I-POLICY-DECLINED
05209         IF PB-REISSUED-CERT  OR
05210            PB-REIN-ONLY-CERT  OR
05211            PB-POLICY-IS-VOIDED
05212             MOVE  ER-1906         TO  WS-ERROR
05213             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05214         ELSE
05215             MOVE  'D'             TO  PB-BATCH-ENTRY
05216                                       PB-I-ENTRY-STATUS.
05217
05218      IF PB-I-NEEDS-UNDERWRITING
05219         IF PB-POLICY-IS-DECLINED OR
05220            PB-REISSUED-CERT  OR
05221            PB-REIN-ONLY-CERT  OR
05222            PB-POLICY-IS-VOIDED
05223             MOVE  ER-1907         TO  WS-ERROR
05224             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05225         ELSE
05226             MOVE 'U'              TO  PB-BATCH-ENTRY
05227                                       PB-I-ENTRY-STATUS.
05228
05229      IF PB-NEEDS-UNDERWRITING
05230         MOVE  ER-1901             TO  WS-ERROR
05231         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
082205     IF PB-COMPANY-ID = 'DCC'
082205        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
082205        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
082205        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-LF-CASH))
082205                           OR
082205           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
082205           AND (NOT WS-AH-CASH)))
111105                       AND
111105           (PB-I-ENTRY-STATUS NOT = '5')
082205           MOVE 'M'              TO PB-BATCH-ENTRY
082205                                    PB-I-ENTRY-STATUS
082205        END-IF
082205     END-IF
05233      IF  PB-COMPANY-ID NOT = 'NCL'
05234          GO TO 3999-END-EDIT.
05235
05236      IF PB-REISSUED-CERT  OR
05237         PB-POLICY-IS-DECLINED  OR
05238         PB-POLICY-IS-VOIDED  OR
05239         PB-I-OB
05240          GO TO 3999-END-EDIT.
05241
05242      IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
05243          MOVE  ER-2644            TO  WS-ERROR
05244          PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
05245          GO TO 3999-END-EDIT.
05246
05247      MOVE 'N'                     TO  FORM-MASTER-SW.
05248      PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
05249
05250      IF NOT FORM-MASTER-FOUND
05251          GO TO 3999-END-EDIT.
05252
05253      MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
05254                                       FORM-MASTER-AH-SW.
05255
05256      IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
05257          MOVE  +1                 TO SUB6
05258          PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
05259
05260      IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
05261          MOVE  +1                 TO SUB6
05262          PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
05263
05264      IF LF-FORM-MASTER-FOUND  OR
05265         AH-FORM-MASTER-FOUND
05266          GO TO 3360-CHECK-FORM-LIMITS
05267      ELSE
05268          GO TO 3999-END-EDIT.
05269
05270 ******************************************************************
05271 *                  3350-GET-ERFORM                               *
05272 *    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
05273 *    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
05274 ******************************************************************
05275
05276  3350-GET-ERFORM.
05277
05278      IF  WK-FORM-ADDR      EQUAL    ZEROS
05279          GO TO  3350-ERFORM-GETMAIN.
05280
05281      MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
05282      SET ERFORM-FILE-ADDRESSED    TO  TRUE.
05283      PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
05284      MOVE 'Y'                     TO FORM-MASTER-SW.
05285
05286      IF PB-CANCELLATION
05287          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
05288             PB-SV-STATE          EQUAL   FO-STATE       AND
05289             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
05290               GO TO 3350-EXIT
05291          ELSE
05292              NEXT SENTENCE
05293      ELSE
05294          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
05295             PB-SV-STATE          EQUAL   FO-STATE       AND
05296             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
05297               GO TO 3350-EXIT.
05298
05299  3350-ERFORM-GETMAIN.
05300
05301      PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
05302      MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
05303
05304  3350-ERFORM-READ.
05305
05306      MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
05307      MOVE  PB-SV-STATE            TO  FORM-STATE.
05308      IF PB-CANCELLATION
05309          MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
05310      ELSE
05311          MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
05312      MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
05313
05314      PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
05315
05316      IF FORM-MASTER-FOUND
05317        IF PB-CANCELLATION
05318           IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
05319              PB-SV-STATE          EQUAL   FO-STATE       AND
05320              CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
05321               GO  TO 3350-EXIT
05322           ELSE
05323               NEXT SENTENCE
05324        ELSE
05325           IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
05326              PB-SV-STATE          EQUAL   FO-STATE       AND
05327              PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
05328               GO  TO 3350-EXIT.
05329
05330      MOVE  'N'                    TO  FORM-MASTER-SW.
05331      MOVE  ER-1895                TO  WS-ERROR.
05332      PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05333
05334  3350-EXIT.
05335       EXIT.
05336
05337 ******************************************************************
05338 *                  3355-EDIT-FORM-LF-BENEFITS                    *
05339 *   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
05340 *   VALID FOR THE POLICY FORM USED.                              *
05341 ******************************************************************
05342
05343  3355-EDIT-FORM-LF-BENEFITS.
05344
05345      IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
05346         PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
05347          MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
05348          GO TO   3355-EXIT.
05349
05350      IF  SUB6    LESS THAN   +40
05351          ADD  +1      TO  SUB6
05352          GO TO  3355-EDIT-FORM-LF-BENEFITS.
05353
05354      MOVE  ER-1896         TO  WS-ERROR.
05355      PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
05356
05357  3355-EXIT.
05358       EXIT.
05359
05360 ******************************************************************
05361 *                  3356-EDIT-FORM-AH-BENEFITS                    *
05362 *   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
05363 *   VALID FOR THE POLICY FORM USED.                              *
05364 ******************************************************************
05365
05366  3356-EDIT-FORM-AH-BENEFITS.
05367
05368      IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
05369         PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
05370          MOVE  'Y'                TO  FORM-MASTER-AH-SW
05371          GO TO  3356-EXIT.
05372
05373       IF  SUB6    LESS THAN     +40
05374           ADD  +1      TO  SUB6
05375           GO TO  3356-EDIT-FORM-AH-BENEFITS.
05376
05377      MOVE  ER-1897         TO  WS-ERROR.
05378      PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
05379
05380  3356-EXIT.
05381       EXIT.
05382
05383 ******************************************************************
05384 *                  3357-BENEFIT-SEARCH                           *
05385 *   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
05386 *   CANCELLATIONS ONLY.                                          *
05387 ******************************************************************
05388  3357-BENEFIT-SEARCH.
05389      IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
05390          MOVE +1                          TO SUB6
05391          PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
05392
05393      IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
05394          MOVE +1                          TO SUB6
05395          PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
05396
05397  3357-EXIT.
05398      EXIT.
05399
05400 ******************************************************************
05401 *                  3358-BENEFIT-LIFE-SEARCH                      *
05402 *   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
05403 *   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
05404 *   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
05405 ******************************************************************
05406  3358-BENEFIT-LIFE-SEARCH.
05407      IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
05408        IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
05409          IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
05410            OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
05411               IF FO-PLAN-REFUND-METHOD (SUB6)
05412                      IS GREATER THAN SPACES
05413                  MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
05414                                           WS-LF-REFUND-CALC
05415                  GO TO 3358-EXIT.
05416
05417      IF SUB6 LESS THAN +40
05418          ADD +1                 TO SUB6
05419          GO TO 3358-BENEFIT-LIFE-SEARCH.
05420
05421  3358-EXIT.
05422      EXIT.
05423 ******************************************************************
05424 *                  3359-BENEFIT-AH-SEARCH                        *
05425 *   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
05426 *   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
05427 *   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
05428 ******************************************************************
05429  3359-BENEFIT-AH-SEARCH.
05430      IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
05431        IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
05432          IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
05433            OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
05434               IF FO-PLAN-REFUND-METHOD (SUB6)
05435                       IS GREATER THAN SPACES
05436                  MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
05437                                           WS-AH-REFUND-CALC
05438                  GO TO 3359-EXIT.
05439
05440      IF SUB6 LESS THAN +40
05441          ADD +1                 TO SUB6
05442          GO TO 3359-BENEFIT-AH-SEARCH.
05443
05444  3359-EXIT.
05445      EXIT.
05446
05447 ******************************************************************
05448 *                  3360-CHECK-FORM-LIMITS                        *
05449 *   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
05450 *   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
05451 ******************************************************************
05452
05453  3360-CHECK-FORM-LIMITS.
05454
05455      IF FO-IND-GRP-CD = 'I'  OR  'G'
05456          MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
05457
05458      IF NOT LF-FORM-MASTER-FOUND
05459          GO TO 3360-CHECK-FORM-AH-LIMITS.
05460
05461  3360-CHECK-FORM-LF-MIN-ISS-AGE.
05462
05463      IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
05464        (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
05465         WS-LF-JOINT-INDICATOR = 'J'  AND
05466         (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
05467          IF PB-COMPANY-ID = 'NCL'
05468             MOVE  ER-1911          TO  WS-ERROR
05469             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05470          ELSE
05471             MOVE  ER-1892          TO  WS-ERROR
05472             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05473
05474  3360-CHECK-FORM-LF-ATT-AGE.
05475
05476      COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
05477
05478      IF  FO-MAX-ATT-AGE     NUMERIC  AND
05479          FO-MAX-ATT-AGE     GREATER THAN  ZEROS
05480          IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
05481             IF PB-COMPANY-ID = 'NCL'
05482                 MOVE  ER-1913      TO  WS-ERROR
05483                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05484             ELSE
05485                 MOVE  ER-1894      TO  WS-ERROR
05486                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05487
05488  3360-CHECK-FORM-LF-MAX-ISS-AGE.
05489
05490      IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
05491          FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
05492          IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
05493             IF PB-COMPANY-ID = 'NCL'
05494                 MOVE  ER-1914      TO  WS-ERROR
05495                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
05496             ELSE
05497                 MOVE  ER-1899      TO  WS-ERROR
05498                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
05499
05500  3360-CHECK-FORM-LF-TERM-BAMT.
05501
05502      IF  FO-LF-MAX-TERM   NUMERIC   AND
05503          FO-LF-MAX-TERM   GREATER THAN   ZEROS
05504          IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
05505            IF  PB-COMPANY-ID = 'NCL'
05506                MOVE  ER-1916       TO  WS-ERROR
05507                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05508            ELSE
05509                MOVE  ER-1902       TO  WS-ERROR
05510                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05511
05512      COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
05513                                     PB-I-LF-ALT-BENEFIT-AMT.
05514
05515      IF  FO-MAX-LF-AMT   NUMERIC   AND
05516          FO-MAX-LF-AMT   GREATER THAN   ZEROS
05517          IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
05518              IF  PB-COMPANY-ID = 'NCL'
05519                  MOVE  ER-1918     TO  WS-ERROR
05520                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05521              ELSE
05522                  MOVE  ER-1904     TO  WS-ERROR
05523                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05524
05525 ******************************************************************
05526 *                  3360-CHECK-FORM-AH-LIMITS                     *
05527 *   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
05528 *   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
05529 ******************************************************************
05530
05531  3360-CHECK-FORM-AH-LIMITS.
05532
05533      IF NOT AH-FORM-MASTER-FOUND
05534          GO TO 3999-END-EDIT.
05535
05536  3360-CHECK-FORM-AH-MIN-ISS-AGE.
05537
05538      IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
05539        (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
05540         WS-AH-JOINT-INDICATOR = 'J'  AND
05541         (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
05542          IF PB-COMPANY-ID = 'NCL'
05543             MOVE  ER-1912          TO  WS-ERROR
05544             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05545          ELSE
05546             MOVE  ER-1893          TO  WS-ERROR
05547             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05548
05549  3360-CHECK-FORM-AH-ATT-AGE.
05550
05551      COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
05552
05553      IF  FO-MAX-ATT-AGE     NUMERIC     AND
05554          FO-MAX-ATT-AGE     GREATER THAN  ZEROS
05555          IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
05556             IF PB-COMPANY-ID = 'NCL'
05557                 MOVE  ER-1913      TO  WS-ERROR
05558                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
05559             ELSE
05560                 MOVE  ER-1894      TO  WS-ERROR
05561                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
05562
05563  3360-CHECK-FORM-AH-MAX-ISS-AGE.
05564
05565      IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
05566          FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
05567          IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
05568             IF PB-COMPANY-ID = 'NCL'
05569                 MOVE  ER-1915      TO  WS-ERROR
05570                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05571             ELSE
05572                 MOVE  ER-1900      TO  WS-ERROR
05573                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05574
05575  3360-CHECK-FORM-AH-TERM-BAMT.
05576
05577      IF  FO-AH-MAX-TERM    NUMERIC   AND
05578          FO-AH-MAX-TERM    GREATER THAN  +0
05579          IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
05580              IF  PB-COMPANY-ID = 'NCL'
05581                  MOVE  ER-1917     TO  WS-ERROR
05582                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
05583              ELSE
05584                   MOVE  ER-1903    TO  WS-ERROR
05585                   PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
05586
05587      IF  FO-MAX-AH-AMT    NUMERIC   AND
05588          FO-MAX-AH-AMT    GREATER THAN  +0
05589          IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
05590              IF  PB-COMPANY-ID = 'NCL'
05591                  MOVE  ER-1919     TO  WS-ERROR
05592                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05593              ELSE
05594                  MOVE  ER-1905     TO  WS-ERROR
05595                  PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05596
05597      GO TO 3999-END-EDIT.
05598
05599 ******************************************************************
05600      EJECT
05601 ******************************************************************
05602 *                  E D I T   C A N C E L                         *
05603 ******************************************************************
05604
05605  3700-EDIT-CANCEL.
05606      IF PB-COMPANY-ID = 'DMD'
05607          MOVE ZEROS                   TO WS-RES-STATE-TAX
05608                                          WS-RES-MUNI-TAX
05609                                          PB-CI-STATE-TAX
05610                                          PB-CI-MUNI-TAX
05611          PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
05612
05613 *    IF PB-COMPANY-ID  EQUAL  'NCL'
05614 *       IF PB-ENTRY-BATCH  NUMERIC
05615 *          IF PB-CANCELLATION
05616 *             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
05617 *          ELSE
05618 *             IF PB-ISSUE
05619 *                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
05620
072308     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
072308        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
072308     END-IF
05621 *    IF PB-C-MICROFILM-NO  NOT NUMERIC
05622 *        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
05623
05624      IF CM-ENTRY-STATUS = 'V'
05625         MOVE ER-2780             TO WS-ERROR
05626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05627         GO TO 3999-END-EDIT.
05628
05629      IF CM-ENTRY-STATUS = 'D'
05630         MOVE ER-2781             TO WS-ERROR
05631         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05632         GO TO 3999-END-EDIT.
05633
05634      IF CM-ENTRY-STATUS = 'U'
05635         MOVE ER-2782             TO WS-ERROR
05636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05637
05638 ***************************************************************
05639 *                                                             *
05640 *   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
05641 *   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
05642 *   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
05643 *   OF ANOTHER COVERAGE.                                      *
05644 *                                                             *
05645 ***************************************************************
05646
05647      MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
05648                                     PB-C-AH-CANCEL-VOID-SW.
05649
05650      IF PB-C-LF-CANCEL-AMT = ZERO
05651         NEXT SENTENCE
05652      ELSE
05653         IF (PB-C-LF-CANCEL-AMT NEGATIVE)
05654            AND
05655            ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
05656                MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
05657                MOVE ER-2745           TO WS-ERROR
05658                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05659
05660      IF PB-C-AH-CANCEL-AMT = ZERO
05661         NEXT SENTENCE
05662      ELSE
05663         IF (PB-C-AH-CANCEL-AMT NEGATIVE)
05664            AND
05665            (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
05666                MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
05667                MOVE ER-2745           TO WS-ERROR
05668                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05669
05670      IF WS-LF-EARNINGS-CALC = '4'
05671         MOVE '4'                   TO WS-LF-REFUND-CALC.
05672
05673      MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
05674      MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
05675      MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
05676      MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
05677      MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
05678      MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
05679
05680      MOVE ZERO                     TO PB-C-LF-REF-CALC
05681                                       PB-C-AH-REF-CALC.
05682      MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
05683
05684 ******************************************************************
05685 *        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
05686 *             TO VALIDATE COVERAGE.                              *
05687 ******************************************************************
05688
05689      IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
05690         PB-C-LF-CANCEL-AMT = ZEROS
05691           MOVE 'N'                 TO WS-LF-CANCEL-SW
05692       ELSE
05693           MOVE 'Y'                 TO WS-LF-CANCEL-SW.
05694
05695      IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
05696         PB-C-AH-CANCEL-AMT = ZEROS
05697           MOVE 'N'                 TO WS-AH-CANCEL-SW
05698       ELSE
05699           MOVE 'Y'                 TO WS-AH-CANCEL-SW.
05700
05701      EVALUATE TRUE
05702          WHEN PB-CANCEL-FORCE             OR
05703               PB-CANCEL-DATE-FORCED       OR
05704               PB-FORCE-OFF
05705                   IF PB-COMPANY-ID = 'ACE'
05706                      MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
05707                   END-IF
05708          WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
05709                PB-ALL-CANCEL-FORCED-NO-FEE)  AND
05710               (PB-COMPANY-ID = 'ACE' )
05711                   MOVE ZEROES TO PB-CI-CANCEL-FEE
05712          WHEN OTHER
05713               IF PB-COMPANY-ID = 'ACE'
05714                  MOVE ER-2794              TO WS-ERROR
05715               ELSE
05716                  MOVE ER-2749              TO WS-ERROR
05717               END-IF
05718               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05719      END-EVALUATE.
05720
05721
05722 *    IF  PB-COMPANY-ID    EQUAL    'HER'
05723 *        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
05724 *            MOVE  ER-1909            TO  WS-ERROR
05725 *            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
05726 *        ELSE
05727 *            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
05728
PEMMOD     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
PEMMOD     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
PEMMOD        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
PEMMOD     ELSE
PEMMOD        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
PEMMOD     END-IF
PEMMOD     .
05729  3705-EDIT-CANCEL-DT.
05730
05731      IF LF-COVERAGE-CANCELLED
05732         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
05733          MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
05734          MOVE WS-CURRENT-MONTH-END
05735                                  TO DC-BIN-DATE-2
05736          SET ELAPSED-BETWEEN-BIN TO TRUE
05737 *        MOVE 1                  TO DC-OPTION-CODE
05738          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
05739          IF DATE-CONVERSION-ERROR
05740             NEXT SENTENCE
05741           ELSE
05742              IF DC-ELAPSED-DAYS GREATER +180
05743                 IF PB-CANCEL-DATE-FORCED  OR
05744                    PB-CANCEL-DATE-FORCED-NO-FEE
05745                       MOVE ER-2751  TO WS-ERROR
05746                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05747                  ELSE
05748                    MOVE ER-2752  TO WS-ERROR
05749                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05750
05751      IF AH-COVERAGE-CANCELLED
05752         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
05753          MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
05754          MOVE WS-CURRENT-MONTH-END
05755                                  TO DC-BIN-DATE-2
05756          SET ELAPSED-BETWEEN-BIN TO TRUE
05757 *        MOVE 1                  TO DC-OPTION-CODE
05758          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
05759          IF DATE-CONVERSION-ERROR
05760             NEXT SENTENCE
05761           ELSE
05762              IF DC-ELAPSED-DAYS GREATER +180
05763                 IF PB-CANCEL-DATE-FORCED OR
05764                    PB-CANCEL-DATE-FORCED-NO-FEE
05765                       MOVE ER-2751  TO WS-ERROR
05766                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05767                  ELSE
05768                    MOVE ER-2752  TO WS-ERROR
05769                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05770
05771      IF WS-ERROR = ER-2752
05772         AND (PB-COMPANY-ID = 'ABL'
05773          OR  PB-COMPANY-ID = 'FGL'
05774          OR  PB-COMPANY-ID = 'IST'
05775          OR  PB-COMPANY-ID = 'JHL'
05776          OR  PB-COMPANY-ID = 'LAP'
05777          OR  PB-COMPANY-ID = 'LBL'
05778          OR  PB-COMPANY-ID = 'NCB'
05779          OR  PB-COMPANY-ID = 'NLI'
05780          OR  PB-COMPANY-ID = 'OFI'
05781          OR  PB-COMPANY-ID = 'PLI'
05782          OR  PB-COMPANY-ID = 'TAO'
05783          OR  PB-COMPANY-ID = 'TIC'
05784          OR  PB-COMPANY-ID = 'HER'
05785          OR  WS-LF-SPECIAL-CALC-CD = 'Z'
05786          OR  WS-AH-SPECIAL-CALC-CD = 'Z')
05787             SUBTRACT +1          FROM PB-NO-OF-ERRORS
05788             MOVE ER-2762     TO WS-ERROR
05789             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05790
05791      IF LF-COVERAGE-CANCELLED
05792         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
05793         IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
05794              MOVE ER-2733         TO WS-ERROR
05795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05796
05797      IF AH-COVERAGE-CANCELLED
05798         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
05799         IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
05800               MOVE ER-2733        TO WS-ERROR
05801               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05802
05803      IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
05804         (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
05805         IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
05806            (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
05807             IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
05808               IF PB-COMPANY-ID NOT = 'LAP'
05809                MOVE ER-2704            TO WS-ERROR
05810                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
05811
05812      IF CERT-WAS-NOT-FOUND
05813          GO TO 3999-END-EDIT.
05814
05815      IF PB-COMPANY-ID EQUAL 'CDC'
05816         IF LF-COVERAGE-CANCELLED
05817            AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
05818             MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
05819             MOVE PB-C-LF-CANCEL-DT
05820                                  TO DC-BIN-DATE-2
05821             SET ELAPSED-BETWEEN-BIN TO TRUE
05822 *           MOVE 1               TO DC-OPTION-CODE
05823             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
05824             IF DATE-CONVERSION-ERROR
05825                NEXT SENTENCE
05826              ELSE
05827                 IF DC-ELAPSED-DAYS GREATER +60
05828                    MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
05829
05830      IF PB-COMPANY-ID EQUAL 'CDC'
05831         IF AH-COVERAGE-CANCELLED
05832            AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
05833             MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
05834             MOVE PB-C-AH-CANCEL-DT
05835                                  TO DC-BIN-DATE-2
05836             MOVE +0              TO DC-ELAPSED-DAYS
05837                                     DC-ELAPSED-MONTHS
05838             SET ELAPSED-BETWEEN-BIN  TO TRUE
05839 *           MOVE 1               TO DC-OPTION-CODE
05840             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
05841             IF DATE-CONVERSION-ERROR
05842                NEXT SENTENCE
05843              ELSE
05844                 IF DC-ELAPSED-DAYS GREATER +60
05845                    MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
05846
05847      MOVE +0                     TO DC-ELAPSED-DAYS
05848                                     DC-ELAPSED-MONTHS.
05849
05850      IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
05851         (WS-AH-SPECIAL-CALC-CD = 'Z')
05852           MOVE 'Z'                TO PB-CI-OB-FLAG
05853           MOVE ER-2767            TO WS-ERROR
05854           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
05855           MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
05856           MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
05857           GO TO 3775-OVER-REF-CHK
05858         ELSE
05859           MOVE ZEROS              TO PB-CI-LIVES
05860                                      PB-C-LIVES
05861           IF PB-CI-OB-FLAG NOT = 'B'
05862              MOVE SPACE           TO PB-CI-OB-FLAG.
05863
05864      IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
05865          MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
05866      ELSE
05867          MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
05868
05869      IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
05870         AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
05871             MOVE ER-2760         TO WS-ERROR
05872             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05873
05874      IF LF-COVERAGE-CANCELLED
05875         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
05876          IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
05877             AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
05878                MOVE ER-2774       TO WS-ERROR
05879                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05880
05881      IF AH-COVERAGE-CANCELLED
05882         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
05883          IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
05884             AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
05885                MOVE ER-2775       TO WS-ERROR
05886                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05887
05888      IF LF-COVERAGE-CANCELLED
05889         AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
05890          IF PB-C-LF-CANCEL-DT = LOW-VALUES
05891             MOVE ER-2776         TO WS-ERROR
05892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05893
05894      IF AH-COVERAGE-CANCELLED
05895         AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
05896          IF PB-C-AH-CANCEL-DT = LOW-VALUES
05897             MOVE ER-2777         TO WS-ERROR
05898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
081613     IF LF-COVERAGE-CANCELLED
081613        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
081613        if pb-ci-lf-expire-dt = low-values or spaces
081613           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
081613           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
081613           MOVE PB-CI-EXTENTION-DAYS
081613                                 TO DC-ELAPSED-DAYS
081613           SET BIN-PLUS-ELAPSED  TO TRUE
081613           PERFORM 8500-DATE-CONVERT
081613                                 THRU 8500-EXIT
081613           IF DATE-CONVERSION-ERROR
081613              move low-values    to dc-bin-date-2
081613           end-if
081613        else
081613           move pb-ci-lf-expire-dt
081613                                 to dc-bin-date-2
081613        end-if
081613        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
081613           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
081613                             OR  'FIA'
081613              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
081613           ELSE
081613              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
081613              MOVE ER-2731       TO WS-ERROR
081613              PERFORM 9900-ERROR-FORMAT
081613                                 THRU 9900-EXIT
081613           end-if
081613        end-if
081613     end-if
05900 *    IF LF-COVERAGE-CANCELLED
05901 *       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
05902 *        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
05903 *        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
05904 *        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
05906 *        SET BIN-PLUS-ELAPSED      TO TRUE
05907 *        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
05908 *        IF DATE-CONVERSION-ERROR
05909 *           NEXT SENTENCE
05910 *         ELSE
05911 *           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
05912 *             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
05913 *                            OR  'FIA'
05914 *                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
05915 *              ELSE
05916 *               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
05917 *               MOVE ER-2731       TO WS-ERROR
05918 *               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
           .
05920  3705-EDIT-AH-CANCEL-DT.
081613     IF AH-COVERAGE-CANCELLED
081613        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
081613        if pb-ci-AH-expire-dt = low-values or spaces
081613           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
081613           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
081613           MOVE PB-CI-EXTENTION-DAYS
081613                                 TO DC-ELAPSED-DAYS
081613           SET BIN-PLUS-ELAPSED  TO TRUE
081613           PERFORM 8500-DATE-CONVERT
081613                                 THRU 8500-EXIT
081613           IF DATE-CONVERSION-ERROR
081613              move low-values    to dc-bin-date-2
081613           end-if
081613        else
081613           move pb-ci-ah-expire-dt
081613                                 to dc-bin-date-2
081613        end-if
081613        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
081613           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
081613                             OR  'FIA'
081613              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
081613           ELSE
081613              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
081613              MOVE ER-2771       TO WS-ERROR
081613              PERFORM 9900-ERROR-FORMAT
081613                                 THRU 9900-EXIT
081613           end-if
081613        end-if
081613     end-if
05922 *    IF AH-COVERAGE-CANCELLED
05923 *       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
05924 *        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
05925 *        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
05926 *        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
05927 **       MOVE 6                    TO DC-OPTION-CODE
05928 *        SET BIN-PLUS-ELAPSED      TO TRUE
05929 *        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
05930 *        IF DATE-CONVERSION-ERROR
05931 *           NEXT SENTENCE
05932 *         ELSE
05933 *           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
05934 *             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
05935 *                             OR 'FIA'
05936 *               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
05937 *             ELSE
05938 *              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
05939 *              MOVE ER-2771       TO WS-ERROR
05940 *              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
           .
05942  3705-EDIT-CONTINUED.
05943
041811*    IF LF-COVERAGE-CANCELLED
041811*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
041811*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
041811*            MOVE ER-2727         TO WS-ERROR
041811*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
041811*
041811*    IF AH-COVERAGE-CANCELLED
041811*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
041811*        IF PB-COMPANY-ID = 'ACE'
041811*           MOVE ER-2727        TO WS-ERROR
041811*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
041811*        ELSE
041811*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
041811*              MOVE ER-2727     TO WS-ERROR
041811*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05959
05960      IF PB-COMPANY-ID = 'ACE'
05961        IF AH-COVERAGE-CANCELLED
05962          IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
05963            IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
05964               MOVE ER-2732      TO WS-ERROR
05965               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05966
05967      IF PB-COMPANY-ID      EQUAL   'HER'
05968         IF WS-ERROR        EQUAL   ER-2727
05969             SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
05970             MOVE  ER-2725          TO  WS-ERROR
05971             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
05972
05973      IF PB-C-CLAIM-CREATED-CANCEL
05974             MOVE ER-2748         TO WS-ERROR
05975             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05976
05977      IF PB-C-LAST-NAME NOT = SPACES
05978          IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
05979             MOVE ER-2747         TO WS-ERROR
05980             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05981
05982  3710-EDIT-LUMP-SUM-PRIOR.
05983
05984      IF AH-COVERAGE-CANCELLED
05985          IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
05986              IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
05987                 MOVE ER-2735    TO WS-ERROR
05988                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05989
05990      IF LF-COVERAGE-CANCELLED
05991          IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
05992              IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
05993                 MOVE ER-2735    TO WS-ERROR
05994                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
05995
05996  3710-EDIT-PRIOR-DEATH.
05997
040811*    IF LF-COVERAGE-CANCELLED
040811*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
040811*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
040811*           (NOT PB-CI-OB)
040811*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
040811*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
040811*                   MOVE ER-2732  TO WS-ERROR
040811*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
040811*
040811*    IF AH-COVERAGE-CANCELLED
040811*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
040811*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
040811*           (NOT PB-CI-OB)
040811*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
040811*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
040811*                   MOVE ER-2732  TO WS-ERROR
040811*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06015
06016      IF PB-CI-DEATH-DT NOT = LOW-VALUES
06017          IF (PB-C-LF-CANCEL-AMT = ZERO) AND
06018             (NOT PB-COMP-LF-CANCEL)
06019              NEXT SENTENCE
06020          ELSE
06021            IF PB-C-LF-CANCEL-VOIDED
06022               NEXT SENTENCE
06023            ELSE
06024               MOVE ER-2753      TO WS-ERROR
06025               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06026
06027      IF CANCEL-FUTURE-DT
06028          GO TO 3999-END-EDIT.
06029
06030  3715-GET-REMAIN-TERM-LF.
06031
06032      IF NO-LF-BENEFIT-MATCH  OR
06033         WS-LF-BENEFIT-CD = ZEROS
06034         GO TO 3730-GET-AH-REMAIN-TERM.
06035
06036      MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
06037      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
06038      MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
06039      MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
06040      MOVE PB-SV-STATE            TO CP-STATE.
06041      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
06042      MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
06043      MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
06044      MOVE '2'                    TO CP-PROCESS-TYPE.
06045      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
06046      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
06047      MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
083005     IF (PB-COMPANY-ID = 'CID')
083005        AND (CP-STATE-STD-ABBRV = 'WI')
083005        MOVE '7'                 TO CP-REM-TERM-METHOD
083005        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
083005     ELSE
06048         MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
06049         MOVE WS-REM-TRM-CALC-OPTION
083005                                 TO CP-REM-TRM-CALC-OPTION
083005     END-IF
      **  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
           IF (PB-COMPANY-ID = 'CID')
              AND (CP-STATE-STD-ABBRV = 'MO')
              AND (PB-CERT-EFF-DT >= X'9B41')
              AND (PB-CERT-EFF-DT <= X'A2FB')
              MOVE '7'                 TO CP-REM-TERM-METHOD
              MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
           END-IF
06050      MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
06051                                     CP-LOAN-TERM.
06052      IF CP-TRUNCATED-LIFE
06053         MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
06054
06055      IF CP-TERM-IS-DAYS
06056          MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
06057      ELSE
06058          MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
06059
06060      MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
06061
06062      PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
06063
06064      IF LF-COVERAGE-CANCELLED
06065         AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
06066         NEXT SENTENCE
06067       ELSE
06068           GO TO 3730-GET-AH-REMAIN-TERM.
06069
06070  3720-GET-LF-REFUND.
06071
06072      IF PB-C-LF-CANCEL-VOIDED OR
06073         PB-C-AH-CANCEL-VOIDED
06074         GO TO 3780-UPDATE-CANCEL-CERT.
06075
06076      IF PB-COMPANY-ID EQUAL 'BOA'
06077          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
06078          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
06079          GO TO 3730-GET-AH-REMAIN-TERM.
06080
06081      IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
06082         (WS-AH-SPECIAL-CALC-CD = 'M')
06083          MOVE ER-2767            TO WS-ERROR
06084          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06085          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
06086          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
06087          GO TO 3780-UPDATE-CANCEL-CERT.
06088
           MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
06090
06091      MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
06092      MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
06093      MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
06094      MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
040610     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
083111     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
071211     IF (PB-COMPANY-ID = 'DCC')
071211        AND (AM-DCC-PRODUCT-CODE = 'DDF')
              IF PDEF-MASTER-FOUND
                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
                    (V1 > +8)
                    OR (PD-PROD-CODE (V1) = 'L')
                 END-PERFORM
                 IF V1 < +9
                    MOVE PD-MAX-AMT (V1)
                                 TO CP-R-MAX-TOT-BEN
                                    EC-AM-LF-MAX-TOT-BEN
                 END-IF
              ELSE
071211        MOVE ' '                 TO PDEF-MASTER-SW
071211        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
071211        MOVE PB-STATE            TO ERPDEF-STATE
071211        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
071211        MOVE 'A'                 TO ERPDEF-BEN-TYPE
071211        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
071211        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
071211        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
071211        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
071211        IF PDEF-MASTER-FOUND
071211           MOVE 'N'              TO PDEF-MASTER-SW
071211           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211           IF PDEF-MASTER-FOUND
071211              IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                 CONTINUE
071211              ELSE
071211                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211                 IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                    CONTINUE
071211                 ELSE
071211                    MOVE 'N'     TO PDEF-MASTER-SW
071211                 END-IF
071211              END-IF
071211              DISPLAY ' MADE IT TO REM AMT  IN IF STMT '
071211
071211              IF PDEF-MASTER-FOUND
071211                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
071211                    (V1 > +8)
071211                    OR (PD-PROD-CODE (V1) = 'L')
071211                 END-PERFORM
071211                 IF V1 < +9
071211                    MOVE PD-MAX-AMT (V1)
071211                                 TO CP-R-MAX-TOT-BEN
071211                                    EC-AM-LF-MAX-TOT-BEN
071211                 END-IF
071211              END-IF
071211           END-IF
071211           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
071211        END-IF
              END-IF
071211     END-IF
06096      PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
06097
06098      MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
06099
06100      MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
06101                                     PB-C-LF-REM-TERM.
06102
06103      MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
06104      MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
06105
06106      IF PB-COMPANY-ID EQUAL 'FLC'
06107         IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
06108            MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
06109            COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
06110                     + PB-CI-LF-ALT-PREMIUM-AMT)
06111                     - CM-LF-ITD-DEATH-AMT
06112            IF PB-C-LF-REF-CALC LESS THAN +0
06113               MOVE +0            TO PB-C-LF-REF-CALC
06114               GO TO 3730-GET-AH-REMAIN-TERM
06115            ELSE
06116               GO TO 3730-GET-AH-REMAIN-TERM.
06117
06118      IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
06119                             OR '4' OR '5' OR '6' OR '8'
033104                            OR '9' OR 'G'
06121         MOVE PB-C-LF-REFUND-OVERRIDE
06122                                  TO CP-EARNING-METHOD.
06123
010713     if pb-company-id = 'AHL'
010713        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
010713        if cp-class-code = spaces
010713           move zeros            to cp-class-code
010713        end-if
010713     ELSE
010713        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
010713     END-IF
070713*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
06125      MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
06126      MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
06127                                     CP-RATING-BENEFIT-AMT.
06128      IF CP-STATE-STD-ABBRV = 'OR'
06129          COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
06130                                          PB-CI-LF-ALT-BENEFIT-AMT.
06131      MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
06132      MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
06133      MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
06134      MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
06135      MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
06136      MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
071211     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
           IF WS-DEFAULT-APR NOT NUMERIC
               MOVE ZEROS TO WS-DEFAULT-APR.
CIDMOD****   N O T E   ****
CIDMOD*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
CIDMOD*      THE OH HARD CODING IN ELCRFNDP
CIDMOD
CIDMOD     IF PB-COMPANY-ID = 'CID'
CIDMOD        IF CP-STATE-STD-ABBRV = 'OH'
CIDMOD           MOVE WS-LF-EARNINGS-CALC
CIDMOD                                 TO CP-EARNING-METHOD
CIDMOD        END-IF
CIDMOD     END-IF
CIDMOD
CIDMOD****   N O T E   ****
CIDMOD
           IF CP-EARN-AS-NET-PAY
               IF CP-LOAN-APR NOT GREATER THAN ZEROS
                  IF WS-DEFAULT-APR GREATER THAN ZEROS
                      MOVE WS-DEFAULT-APR
                                       TO  CP-LOAN-APR
                      MOVE ER-3780     TO  WS-ERROR
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
                  ELSE
                      MOVE ER-3781     TO  WS-ERROR
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
           MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
06152      PERFORM 7600-GET-REFUND THRU 7600-EXIT.
06153
06154      IF CP-REFUND-TYPE-USED NOT = SPACE
06155          MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
06156
06157      IF CP-ERROR-RATE-IS-ZERO OR
06158         CP-ERROR-RATE-NOT-FOUND
06159         MOVE ER-2740             TO WS-ERROR
06160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06161
06162      IF CP-ERROR-RATE-FILE-NOTOPEN
06163         MOVE ER-2617             TO WS-ERROR
06164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06165
           IF PB-COMPANY-ID = 'DCC'
              AND PB-CI-ENTRY-STATUS = 'M'
              MOVE +0                  TO PB-C-LF-REF-CALC
           ELSE
06166         MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
           END-IF
06167
06168      IF WS-LF-EARNINGS-CALC NOT = 'B'
06169          GO TO 3730-GET-AH-REMAIN-TERM.
06170
06171 *    IF WS-LF-SPECIAL-CALC-CD = 'L'
06172 *       ADD +1                   TO PB-C-LF-REM-TERM
06173 *                                   CP-REMAINING-TERM
06174 *                                   CP-ORIGINAL-TERM.
06175
06176      MOVE 'L'                    TO CP-BENEFIT-TYPE.
06177      MOVE '2'                    TO CP-EARNING-METHOD
06178                                     CP-RATING-METHOD.
           IF PB-COMPANY-ID = 'CID'
              IF (CP-STATE-STD-ABBRV = 'MN')
                 AND (PB-CERT-EFF-DT > X'A4FF')
                 AND (WS-LF-EARNINGS-CALC = 'B')
                 MOVE '5'              TO CP-EARNING-METHOD
                 MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
              END-IF
           END-IF
06179      MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
06180                                         CP-REMAINING-BENEFIT
06181                                         CP-RATING-BENEFIT-AMT.
06182      IF CP-STATE-STD-ABBRV = 'OR'
06183          COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
06184                                          PB-CI-LF-ALT-BENEFIT-AMT.
06185      MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
06186      MOVE 'LEV'                  TO CP-DEVIATION-CODE.
06187
06188      PERFORM 7600-GET-REFUND THRU 7600-EXIT.
06189
06190      IF CP-ERROR-RATE-IS-ZERO OR
06191         CP-ERROR-RATE-NOT-FOUND
06192         MOVE ER-2740             TO WS-ERROR
06193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06194
06195      IF CP-ERROR-RATE-FILE-NOTOPEN
06196         MOVE ER-2617             TO WS-ERROR
06197         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06198
06199      ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
06200
06201 ******************************************************************
06202
06203      EJECT
06204  3730-GET-AH-REMAIN-TERM.
06205      IF NO-AH-BENEFIT-MATCH  OR
06206         WS-AH-BENEFIT-CD = ZEROS
06207          GO TO 3770-CHECK-REFUNDS.
06208
06209      IF PB-CI-AH-LUMP-SUM-DISAB
06210          IF  PB-C-AH-CANCEL-AMT = ZERO
06211             IF NOT PB-COMP-AH-CANCEL
06212              GO TO 3770-CHECK-REFUNDS.
06213
06214      MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
06215      MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
06216      MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
06217      MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
06218      MOVE PB-SV-STATE            TO CP-STATE.
06219      MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
06220      MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
06221      MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
06222      MOVE '2'                    TO CP-PROCESS-TYPE.
06223      MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
06224      MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
06225      MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
083005     IF (PB-COMPANY-ID = 'CID')
083005        AND (CP-STATE-STD-ABBRV = 'WI')
083005        MOVE '7'                 TO CP-REM-TERM-METHOD
083005        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
083005     ELSE
06226         MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
06227         MOVE WS-REM-TRM-CALC-OPTION
083005                                 TO CP-REM-TRM-CALC-OPTION
083005     END-IF
           IF (PB-COMPANY-ID = 'CID')
              AND (CP-STATE-STD-ABBRV = 'MO')
              AND (PB-CERT-EFF-DT >= X'9B41')
              AND (PB-CERT-EFF-DT <= X'A2FB')
              MOVE '7'                 TO CP-REM-TERM-METHOD
              MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
           END-IF
06228      MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
06229                                     CP-LOAN-TERM.
06230      IF NOT CP-TERM-IS-DAYS
06231          MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
06232
06233      MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
06234
06235      PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
06236
06237      IF AH-COVERAGE-CANCELLED
06238         AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
06239         NEXT SENTENCE
06240       ELSE
06241          GO TO 3770-CHECK-REFUNDS.
06242
06243  3740-GET-AH-REFUND.
06244
06245      IF PB-C-LF-CANCEL-VOIDED OR
06246         PB-C-AH-CANCEL-VOIDED
06247         GO TO 3780-UPDATE-CANCEL-CERT.
06248
06249      IF PB-COMPANY-ID = 'BOA'
06250          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
06251          GO TO 3770-CHECK-REFUNDS.
06252
06253      MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
06254 *    MOVE ' '                    TO DC-OPTION-CODE
06255      SET BIN-TO-GREG             TO TRUE
06256      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
06257      MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
06258                                     PB-C-AH-REM-TERM.
06259      MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
06260      MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
06261
06262      IF PB-COMPANY-ID EQUAL 'FLC'
06263         IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
06264            MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
06265            COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
06266                     - CM-AH-ITD-AH-PMT)
06267            IF PB-C-AH-REF-CALC LESS THAN +0
06268               MOVE +0            TO PB-C-AH-REF-CALC
06269               GO TO 3770-CHECK-REFUNDS
06270            ELSE
06271               GO TO 3770-CHECK-REFUNDS.
06272
033104     IF PB-COMPANY-ID = 'DCC'
033104        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
033104           MOVE 'S'              TO CP-EARNING-METHOD
033104        END-IF
033104     END-IF
06273      IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
06274                             OR '4' OR '5' OR '6' OR '8'
033104                            OR '9' OR 'G' OR 'S'
06276         MOVE PB-C-AH-REFUND-OVERRIDE
06277                                  TO CP-EARNING-METHOD.
06278
010713     if pb-company-id = 'AHL'
010713        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
010713        if cp-class-code = spaces
010713           move zeros            to cp-class-code
010713        end-if
010713     ELSE
010713        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
010713     END-IF
010713*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
06280      MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
06281      MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
06282                                     CP-RATING-BENEFIT-AMT.
06283      IF CP-STATE-STD-ABBRV = 'OR'
06284          COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
06285                                          PB-CI-AH-TERM.
06286      MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
06287      MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
06288      MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
06289      MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
06290      MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
06291      MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
06292
06293      IF CP-STATE-STD-ABBRV = 'OH'
CIDMOD        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
030612                                AND 'CID' AND 'DCC' AND 'AHL')
06295            IF (CP-ORIGINAL-TERM GREATER 60) AND
06296               (DC-GREG-DATE-CYMD GREATER 19831101) AND
06297               (PB-CI-LF-BENEFIT-CD NOT = ZERO)
CIDMOD              MOVE '6' TO CP-EARNING-METHOD
CIDMOD           END-IF
CIDMOD        END-IF
CIDMOD        IF PB-COMPANY-ID = 'CID'
CIDMOD           IF NO-LIFE-COVERAGE
CIDMOD              IF CP-CRITICAL-PERIOD
CIDMOD                 MOVE '2'       TO CP-EARNING-METHOD
CIDMOD              ELSE
CIDMOD                 MOVE '6'       TO CP-EARNING-METHOD
CIDMOD              END-IF
CIDMOD           ELSE
CIDMOD              IF WS-LF-COVERAGE-TYPE = 'L'
CIDMOD                 MOVE '2'       TO CP-EARNING-METHOD
CIDMOD              ELSE
CIDMOD                 IF (PB-CI-LF-TERM > +60) OR
CIDMOD                    (WS-LF-EARNINGS-CALC = '5')
CIDMOD                    IF CP-CRITICAL-PERIOD
CIDMOD                       MOVE '2'  TO CP-EARNING-METHOD
CIDMOD                    ELSE
CIDMOD                       MOVE '6'  TO CP-EARNING-METHOD
CIDMOD                    END-IF
CIDMOD                 ELSE
CIDMOD                    MOVE '1'     TO CP-EARNING-METHOD
CIDMOD                 END-IF
CIDMOD              END-IF
CIDMOD           END-IF
CIDMOD        END-IF
CIDMOD     END-IF
06299
PEMMOD*    IF CP-STATE-STD-ABBRV = 'VA'
PEMMOD*       IF DC-GREG-DATE-CYMD GREATER 19921231
PEMMOD*          IF CP-ORIGINAL-TERM GREATER 61
PEMMOD*             MOVE '6' TO CP-EARNING-METHOD
PEMMOD*          ELSE
PEMMOD*             MOVE '1' TO CP-EARNING-METHOD.
06306
           IF WS-DEFAULT-APR NOT NUMERIC
               MOVE ZEROS TO WS-DEFAULT-APR.
           IF CP-EARN-AS-NET-PAY
               IF CP-LOAN-APR NOT GREATER THAN ZEROS
                  IF WS-DEFAULT-APR GREATER THAN ZEROS
                      MOVE WS-DEFAULT-APR
                                       TO  CP-LOAN-APR
                      MOVE ER-3780     TO  WS-ERROR
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
                  ELSE
                      MOVE ER-3781     TO  WS-ERROR
                      PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
071211     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
071211     IF PB-COMPANY-ID = 'DCC'
071211        AND CP-CANCEL-REASON = 'R'
071211        MOVE 'G'                 TO CP-DDF-SPEC-CALC
071211        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
071211     END-IF
071211     IF PB-COMPANY-ID = 'DCC'
071211        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211        AND (CP-EARNING-METHOD = 'D')
071211        AND (CP-CANCEL-REASON NOT = 'R')
              CONTINUE
           ELSE
              GO TO 3750-CONTINUE
           END-IF
           MOVE ' '                    TO DD-IU-SW
           IF NOT PDEF-MASTER-FOUND
071211        MOVE ' '                 TO PDEF-MASTER-SW
071211        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
071211        MOVE PB-STATE            TO ERPDEF-STATE
071211        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
071211        MOVE 'A'                 TO ERPDEF-BEN-TYPE
071211        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
071211        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
071211        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
071211        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
071211        IF PDEF-MASTER-FOUND
071211           MOVE 'N'              TO PDEF-MASTER-SW
071211           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211           IF PDEF-MASTER-FOUND
071211              IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                 CONTINUE
071211              ELSE
071211                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
071211                 IF (ERPDEF-KEY-SAVE (1:16) =
071211                           PD-CONTROL-PRIMARY (1:16))
071211                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
071211                    CONTINUE
071211                 ELSE
071211                    MOVE ER-2740 TO WS-ERROR
071211                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
071211                    GO TO 3770-CHECK-REFUNDS
071211                 END-IF
071211              END-IF
                 END-IF
071211           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
              END-IF
071211     END-IF
           IF PDEF-MASTER-FOUND
071211        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
071211           (V1 > +8)
071211           OR (PD-PROD-CODE (V1) = 'I')
071211        END-PERFORM
071211        IF V1 < +9
071211           SET DD-IU-PRESENT        TO TRUE
071211        END-IF
              IF WS-AH-DCC-TRUNC = 'T'
                 MOVE PB-CI-LOAN-TERM     TO WS-TERM
              ELSE
                 MOVE CP-ORIGINAL-TERM    TO WS-TERM
              END-IF
071211        EVALUATE TRUE
071211           WHEN WS-TERM > +168
071211              MOVE 15               TO V1
071211           WHEN WS-TERM > +156
071211              MOVE 14               TO V1
071211           WHEN WS-TERM > +144
071211              MOVE 13               TO V1
071211           WHEN WS-TERM > +132
071211              MOVE 12               TO V1
071211           WHEN WS-TERM > +120
071211              MOVE 11               TO V1
071211           WHEN WS-TERM > +108
071211              MOVE 10               TO V1
071211           WHEN WS-TERM > +96
071211              MOVE 9                TO V1
071211           WHEN WS-TERM > +84
071211              MOVE 8                TO V1
071211           WHEN WS-TERM > +72
071211              MOVE 7                TO V1
071211           WHEN WS-TERM > +60
071211              MOVE 6                TO V1
071211           WHEN WS-TERM > +48
071211              MOVE 5                TO V1
071211           WHEN WS-TERM > +36
071211              MOVE 4                TO V1
071211           WHEN WS-TERM > +24
071211              MOVE 3                TO V1
071211           WHEN WS-TERM > +12
071211              MOVE 2                TO V1
071211           WHEN OTHER
071211              MOVE 1                TO V1
071211        END-EVALUATE
071211
071211        EVALUATE TRUE
071211*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
071211*             < +13)
071211*             AND (DD-IU-PRESENT)
071211*             MOVE 2                TO V2
071211*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
071211*             MOVE 1                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
071211              MOVE 2                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
071211              MOVE 3                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
071211              MOVE 4                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
071211              MOVE 5                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
071211              MOVE 6                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
071211              MOVE 7                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
071211              MOVE 8                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
071211              MOVE 9                TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
071211              MOVE 10               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
071211              MOVE 11               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
071211              MOVE 12               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
071211              MOVE 13               TO V2
071211           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
071211              MOVE 14               TO V2
071211           WHEN OTHER
071211              MOVE 15               TO V2
071211        END-EVALUATE
071211
071211        MOVE PD-UEP-FACTOR (V1 V2 + 1)
071211                                 TO CP-DDF-LO-FACT
071211        MOVE PD-UEP-FACTOR (V1 V2)
071211                                 TO CP-DDF-HI-FACT
071211
              MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
              MOVE CM-AH-CLP     TO CP-DDF-CLP
              COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
                 (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
              MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
              MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
071211        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
071211           + PD-1ST-YR-ADMIN-ALLOW
071211
071211        MOVE 'G'                 TO CP-DDF-SPEC-CALC
PEMTST*       IF PI-CLP-YN = 'Y'
PEMTST*          MOVE 'C'              TO CP-DDF-SPEC-CALC
PEMTST*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
PEMTST*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
PEMTST*       END-IF
071211
071211        IF DD-IU-PRESENT
071211           MOVE 'I'              TO CP-EARNING-METHOD
071211        END-IF
071211        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
                                           CP-CLP-RATE-UP
071211        IF CP-IU-RATE-UP NOT = ZEROS
071211           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
071211              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
071211           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
071211              / (1 - WS-WORK-FACT)
071211        END-IF
071211     END-IF
           .
       3750-CONTINUE.
06321      PERFORM 7600-GET-REFUND THRU 7600-EXIT.
06322
06323      IF CP-REFUND-TYPE-USED NOT = SPACE
06324          MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
06325
06326      IF CP-ERROR-RATE-IS-ZERO OR
06327         CP-ERROR-RATE-NOT-FOUND
06328         MOVE ER-2740             TO WS-ERROR
06329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06330
06331      IF CP-ERROR-RATE-FILE-NOTOPEN
06332         MOVE ER-2617             TO WS-ERROR
06333         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
           IF PB-COMPANY-ID = 'DCC'
              AND PB-CI-ENTRY-STATUS = 'M'
              MOVE +0                  TO PB-C-AH-REF-CALC
           ELSE
              MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
           END-IF
071211     IF PB-COMPANY-ID = 'DCC'
071211        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
071211        AND (CP-EARNING-METHOD = 'D' OR 'I')
071211        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
071211        MOVE 'C'                 TO CP-DDF-SPEC-CALC
071211        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
071211        MOVE ZEROS               TO CP-1ST-YR-ALLOW
071211        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
071211        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
071211        DISPLAY ' CALC CLP   ' CP-CALC-REFUND
071211     END-IF
06337      GO TO 3770-CHECK-REFUNDS.
06338      EJECT
06339
06340  3770-CHECK-REFUNDS.
06341
06342      IF PB-CI-LF-CANCEL-AMT NOT = ZERO
06343         IF PB-C-LF-CANCEL-VOID-SW = SPACE
06344            MOVE ER-2766          TO WS-ERROR
06345            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06346            SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
06347            IF PB-C-LF-REF-CALC LESS THAN ZERO
06348               MOVE ZEROS         TO PB-C-LF-REF-CALC.
06349
06350      IF PB-CI-AH-CANCEL-AMT NOT = ZERO
06351         IF PB-C-AH-CANCEL-VOID-SW = SPACE
06352            MOVE ER-2766          TO WS-ERROR
06353            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06354            SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
06355            IF PB-C-AH-REF-CALC LESS THAN ZERO
06356               MOVE ZEROS         TO PB-C-AH-REF-CALC.
06357
06358      IF PB-COMP-LF-CANCEL
06359         MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
06360         IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
06361            IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
06362               MOVE +0            TO  PB-C-LF-CANCEL-AMT.
06363
06364      IF PB-COMP-AH-CANCEL
06365         MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
06366         IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
06367            IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
06368               MOVE +0            TO  PB-C-AH-CANCEL-AMT.
06369
06370      SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
06371              GIVING WS-UNSIGN-WRK1
06372      SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
06373              GIVING WS-UNSIGN-WRK2.
06374
06375      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
06376          MOVE ZERO TO WS-UNSIGN-WRK1.
06377
06378      IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
06379          MOVE ZERO TO WS-UNSIGN-WRK2.
06380
06381      ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
06382
06383  EJECT
06384
06385  3772-CONTINUE.
06386
06387 **********************************
06388 *** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
06389 *** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
06390 *** DOUBLES THE TOLERANCE AMOUNT.
06391 ***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
06392 **********************************
06393      IF PB-COMPANY-ID = 'MON'
06394      IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
06395          IF WS-REF-REJECT-SW = SPACE
06396              MOVE ER-2754        TO WS-ERROR
06397              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06398            ELSE
06399              MOVE ER-2736        TO WS-ERROR
06400              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06401 **********************************
06402
06403  3773-CONTINUE.
06404
06405      IF PB-C-LF-CANCEL-AMT GREATER THAN +0
06406         IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
06407            MOVE ER-2723          TO WS-ERROR
06408            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06409
06410      IF PB-C-AH-CANCEL-AMT GREATER THAN +0
06411         IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
06412            MOVE ER-2724          TO WS-ERROR
06413            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06414
06415      IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
06416          COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
06417              (1 + WS-LF-REFUND-OVS-PCT)
06418      ELSE
06419          MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
06420
06421      IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
06422          COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
06423              (1 - WS-TOL-LF-REFUND-PCT)
06424      ELSE
06425          MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
06426
           IF (PB-COMPANY-ID = 'DCC')
              AND (PB-CI-ENTRY-STATUS = 'M')
              AND (PB-C-LF-CANCEL-AMT > +0)
              MOVE ER-3843             TO WS-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
           END-IF
06427      EVALUATE TRUE
06428         WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
06429            CONTINUE
06430         WHEN PB-C-LF-CANCEL-AMT = +0
06431                  AND PB-C-LF-REF-CALC > +0
06432            CONTINUE
06433         WHEN WS-LF-REFUND-OVS-AMT = 0
06434                  AND WS-TOL-LF-REFUND = 0
06435            CONTINUE
06436         WHEN OTHER
06437            IF WS-TOL-LF-REFUND  = +0
06438               MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
06439            END-IF
06440            IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
06441                 (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
06442                           (PB-C-LF-CANCEL-AMT))
06443               CONTINUE
06444            ELSE
06445               IF WS-LF-REFUND-OVS-AMT = +0
06446                  MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
06447               END-IF
06448               IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
06449                   (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
06450                                        PB-C-LF-CANCEL-AMT)
06451                  CONTINUE
06452               ELSE
06453                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE
06454                    MOVE ER-2754   TO  WS-ERROR
06455                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06456                  ELSE
06457                     MOVE ER-2736   TO  WS-ERROR
06458                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06459                  END-IF
06460               END-IF
06461            END-IF
06462      END-EVALUATE.
06463
06464      EVALUATE TRUE
06465         WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
06466            CONTINUE
06467         WHEN PB-C-LF-CANCEL-AMT = +0
06468                  AND PB-C-LF-REF-CALC > +0
06469            CONTINUE
06470         WHEN OTHER
06471            IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
06472                (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
06473               CONTINUE
06474            ELSE
06475               IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
06476                (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
06477                 CONTINUE
06478               ELSE
06479                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE
06480                      MOVE ER-2754   TO  WS-ERROR
06481                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06482                  ELSE
06483                      MOVE ER-2736   TO  WS-ERROR
06484                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06485                  END-IF
06486               END-IF
06487            END-IF
06488      END-EVALUATE.
06489
06490      IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
06491          COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
06492              (1 + WS-AH-REFUND-OVS-PCT)
06493      ELSE
06494          MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
06495
06496      IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
06497          COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
06498              (1 - WS-TOL-AH-REFUND-PCT)
06499      ELSE
06500          MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
06501
           IF (PB-COMPANY-ID = 'DCC')
              AND (PB-CI-ENTRY-STATUS = 'M')
              AND (PB-C-AH-CANCEL-AMT > +0)
              MOVE ER-3843             TO WS-ERROR
              PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
           END-IF
06502      EVALUATE TRUE
06503         WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
06504            CONTINUE
CIDMOD*       WHEN PB-C-AH-REF-CALC = +0 AND
CIDMOD*                  PB-C-AH-CANCEL-AMT > +0
CIDMOD        WHEN PB-C-AH-CANCEL-AMT = +0 AND
CIDMOD                   PB-C-AH-REF-CALC > +0
06507            CONTINUE
06508         WHEN WS-AH-REFUND-OVS-AMT = +0
06509                 AND WS-TOL-AH-REFUND = +0
06510            CONTINUE
06511         WHEN OTHER
06512            IF WS-TOL-AH-REFUND = +0
06513               MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
06514            END-IF
06515            IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
06516                (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
06517                                          PB-C-AH-CANCEL-AMT)
06518               CONTINUE
06519            ELSE
06520               IF WS-AH-REFUND-OVS-AMT = +0
06521                  MOVE +9999999.99 TO
06522                          WS-AH-REFUND-OVS-AMT
06523               END-IF
06524               IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
06525                   (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
06526                                          PB-C-AH-CANCEL-AMT)
06527                  CONTINUE
06528               ELSE
06529                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE
06530                     MOVE ER-2754   TO  WS-ERROR
06531                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06532                  ELSE
06533                     MOVE ER-2736   TO  WS-ERROR
06534                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06535                  END-IF
06536               END-IF
06537            END-IF
06538      END-EVALUATE.
06539
06540      EVALUATE TRUE
06541         WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
06542            CONTINUE
CIDMOD*       WHEN PB-C-AH-REF-CALC > +0 AND
CIDMOD*                  PB-C-AH-CANCEL-AMT = +0
CIDMOD        WHEN PB-C-AH-CANCEL-AMT > +0 AND
CIDMOD                   PB-C-AH-REF-CALC = +0
06545            CONTINUE
06546         WHEN OTHER
06547            IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
06548                (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
06549               CONTINUE
06550            ELSE
06551               IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
06552                 (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
06553                  CONTINUE
06554               ELSE
06555                  IF WS-REF-REJECT-SW IS EQUAL TO SPACE
06556                      MOVE ER-2754   TO  WS-ERROR
06557                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06558                  ELSE
06559                      MOVE ER-2736   TO  WS-ERROR
06560                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06561                  END-IF
06562               END-IF
06563            END-IF
06564      END-EVALUATE.
06565
06566      IF (PB-C-LF-CANCEL-AMT = ZERO)
06567         AND (PB-C-AH-CANCEL-AMT = ZERO)
06568         IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
06569            AND  PB-C-LF-REF-CALC < +1.00
06570            AND  PB-C-AH-REF-CALC < +1.00
06571            CONTINUE
06572         ELSE
                 IF (PB-COMPANY-ID = 'DCC')
                    AND (PB-CI-ENTRY-STATUS = 'M')
                    CONTINUE
                 ELSE
06573               MOVE ER-2741       TO WS-ERROR
06574               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
                 END-IF
              END-IF
           END-IF
06575
06576      IF (PB-C-LF-CANCEL-AMT = ZERO
06577         AND WS-LF-BENEFIT-CD NOT = ZERO
06578         AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
06579         AND PB-C-LF-REF-CALC NOT = ZERO)
06580         OR
06581         (PB-C-LF-CANCEL-AMT = ZERO
06582         AND WS-LF-BENEFIT-CD NOT = ZERO
06583         AND PB-C-LF-CANCEL-DT = LOW-VALUES)
06584              IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
06585                 AND PB-C-LF-REF-CALC LESS THAN +1.00
06586                 NEXT SENTENCE
06587              ELSE
06588                 MOVE ER-2739        TO WS-ERROR
06589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06590
06591      IF (PB-C-AH-CANCEL-AMT = ZERO
06592         AND WS-AH-BENEFIT-CD NOT = ZERO
06593         AND NOT PB-CI-AH-LUMP-SUM-DISAB
06594         AND PB-C-AH-REF-CALC NOT = ZERO)
06595         OR
06596         (PB-C-AH-CANCEL-AMT = ZERO
06597         AND WS-AH-BENEFIT-CD NOT = ZERO
06598         AND PB-C-AH-CANCEL-DT = LOW-VALUES)
06599              IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
06600                 AND PB-C-AH-REF-CALC LESS THAN +1.00
06601                 NEXT SENTENCE
06602              ELSE
06603                 MOVE ER-2738        TO WS-ERROR
06604                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06605
06606  3775-OVER-REF-CHK.
06607
06608      IF PB-CI-ENTRY-STATUS = '5'
06609         GO TO 3780-UPDATE-CANCEL-CERT.
06610
06611      COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
06612                               PB-CI-LF-ALT-PREMIUM-AMT.
06613
06614      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
06615         COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
06616                                  PB-C-LF-REF-CALC
06617       ELSE
06618         COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
06619                                  PB-C-LF-CANCEL-AMT.
06620
06621      IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
06622         MOVE ER-2755             TO WS-ERROR
06623         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06624
06625      MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
06626
06627      IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
06628         COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
06629                                  PB-C-AH-REF-CALC
06630       ELSE
06631         COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
06632                                  PB-C-AH-CANCEL-AMT.
06633
06634      IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
06635         MOVE ER-2778             TO WS-ERROR
06636         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06637
06638      IF PB-CI-OB-FLAG NOT = 'Z'
06639         NEXT SENTENCE
06640        ELSE
06641          IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
06642             MOVE ER-2757           TO WS-ERROR
06643             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06644
06645  3780-UPDATE-CANCEL-CERT.
06646
06647      IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
06648         MOVE ER-2728              TO WS-ERROR
06649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06650
06651      IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
06652          MOVE ER-2729              TO WS-ERROR
06653          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06654
06655      IF PB-CI-LF-BENEFIT-CD = ZERO
06656          GO TO 3780-UPDATE-CONT-1.
06657
06658      IF PB-C-LF-CANCEL-DT = LOW-VALUE
06659          GO TO 3780-UPDATE-CONT-1.
06660
06661      IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
06662        AND
06663         (PB-C-LF-CANCEL-AMT NEGATIVE)
06664        AND
06665         (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
06666        AND
06667         ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
06668             NEXT SENTENCE
06669        ELSE
06670         IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
06671           AND
06672 ***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
06673 ***       AND
06674            (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
06675             IF PB-C-LF-CANCEL-VOID-SW = SPACE
06676                MOVE ER-2730      TO WS-ERROR
06677                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06678                GO TO 3999-END-EDIT
06679             ELSE
06680                GO TO 3999-END-EDIT
06681         ELSE
06682             IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
06683                MOVE ER-2765           TO WS-ERROR
06684                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
072308               GO TO 3785-CHECK-NH.
06685 *              GO TO 3999-END-EDIT.
06686
06687  3780-UPDATE-CONT-1.
050311     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
06688
06689      IF PB-CI-AH-BENEFIT-CD = ZERO
06690          GO TO 3780-UPDATE-CONT-2.
06691
06692      IF PB-C-AH-CANCEL-DT = LOW-VALUE
06693          GO TO 3780-UPDATE-CONT-2.
050311
050311     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
06694
06695      IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
06696        AND
06697         (PB-C-AH-CANCEL-AMT NEGATIVE)
06698        AND
06699         (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
06700        AND
06701         ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
06702             NEXT SENTENCE
06703        ELSE
06704         IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
06705           AND
06706 ***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
06707 ***       AND
06708            (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
050311           IF WS-AH-CLAIM-RESCINDED <> 'Y'
06709             IF PB-C-AH-CANCEL-VOID-SW = SPACE
06710                MOVE ER-2773      TO WS-ERROR
06711                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06712                GO TO 3999-END-EDIT
06713             ELSE
06714                GO TO 3999-END-EDIT
050311            END-IF
050311           ELSE
050311             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
050311                MOVE ER-2890 TO WS-ERROR
050311                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
050311                GO TO 3999-END-EDIT
050311             ELSE
050311                GO TO 3785-CHECK-NH
050311             END-IF
050311           END-IF
06715           ELSE
06716             IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
050311              IF WS-AH-CLAIM-RESCINDED = 'Y'
050311                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
050311                   MOVE ER-2890 TO WS-ERROR
050311                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
050311                   GO TO 3999-END-EDIT
050311                ELSE
050311                   MOVE ER-2765 TO WS-ERROR
050311                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
050311                   GO TO 3785-CHECK-NH
050311                END-IF
050311              ELSE
06717                MOVE ER-2765      TO WS-ERROR
06718                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
072308               GO TO 3785-CHECK-NH.
06719 *              GO TO 3999-END-EDIT.
06720
06721  3780-UPDATE-CONT-2.
06722
06723      IF PB-C-LF-CANCEL-AMT NOT = ZERO
06724         AND WS-LF-BENEFIT-CD = ZERO
06725            MOVE ER-2743           TO WS-ERROR
06726            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06727
06728      IF PB-C-AH-CANCEL-AMT NOT = ZERO
06729         AND WS-AH-BENEFIT-CD = ZERO
06730            MOVE ER-2744           TO WS-ERROR
06731            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06732
06733      IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
06734         (PB-C-AH-CANCEL-AMT NEGATIVE))
06735         AND
06736         ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
06737          (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
06738            MOVE ER-2746           TO WS-ERROR
06739            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06740
06741      IF (PB-C-LF-CANCEL-AMT NEGATIVE)
06742        AND
06743         (PB-C-LF-CANCEL-VOID-SW NOT = '1')
06744              MOVE ER-2737        TO WS-ERROR
06745              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06746
06747      IF (PB-C-AH-CANCEL-AMT NEGATIVE)
06748        AND
06749         (PB-C-AH-CANCEL-VOID-SW NOT = '1')
06750              MOVE ER-2737        TO WS-ERROR
06751              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06752
06753      IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
06754          IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
030612             OR 'CID' OR 'DCC' OR 'AHL'
06755              PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
06756          ELSE
06757              IF PB-COMPANY-ID = 'FIA' OR 'MTL'
06758                  MOVE ER-2768    TO WS-ERROR
06759                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
06760              ELSE
06761                  MOVE ER-2756    TO WS-ERROR
06762                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06763
06764      IF CERT-PEND-ISSUE-RETURNED
06765         MOVE ER-2772             TO WS-ERROR
06766         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
072308 3785-CHECK-NH.
072308     IF PB-STATE NOT = 'NH'
072308        GO TO 3999-END-EDIT
072308     END-IF
072308
072308     MOVE ER-2796                TO WS-ERROR
072308     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
072308     IF (PB-C-REF-INTERFACE-SW = 'Y')
072308        OR (CM-NH-INTERFACE-SW = 'Y')
072308        MOVE ER-2793             TO WS-ERROR
072308        PERFORM 9900-ERROR-FORMAT
072308                                 THRU 9900-EXIT
072308     END-IF
072308     MOVE +0                     TO WS-PAYMENT-AMT
072308     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
072308        GO TO 3999-END-EDIT
072308     END-IF
072308     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
072308        GO TO 3999-END-EDIT
072308     END-IF
072308     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
072308     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
072308     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
072308        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
072308     END-IF
072308     MOVE '1'                    TO DC-OPTION-CODE
072308     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
072308     IF NO-CONVERSION-ERROR
072308        IF DC-ELAPSED-DAYS < +16
072308           GO TO 3999-END-EDIT
072308        END-IF
072308     END-IF
072308     MOVE +0                     TO DC-ELAPSED-DAYS
072308     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
072308     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
072308     MOVE '1'                    TO DC-OPTION-CODE
072308     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
072308     IF NO-CONVERSION-ERROR
072308        IF DC-ELAPSED-DAYS > +30
072308           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
072308        ELSE
072308           GO TO 3999-END-EDIT
072308        END-IF
072308     ELSE
072308        GO TO 3999-END-EDIT
072308     END-IF
072308     COMPUTE WS-PAYMENT-AMT ROUNDED =
072308        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
072308           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
072308     IF WS-PAYMENT-AMT < 600.00
072308        GO TO 3999-END-EDIT
072308     END-IF
072308     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
072308
072308     IF (ERMAIL-FOUND = ' ')
072308         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
072308         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
072308        GO TO 3999-END-EDIT
072308     END-IF
072308     MOVE ER-2795                TO WS-ERROR
072308     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
06767
06768      GO TO 3999-END-EDIT.
06769 ******************************************************************
06770      EJECT
06771  3990-FILES-NOT-OPEN.
06772
06773      MOVE ER-2617                TO WS-ERROR.
06774      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
06775      GO TO 9990-RETURN.
06776
06777  3999-END-EDIT.
06778
06779      MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
06780
06781      IF PB-CANCELLATION AND CERT-WAS-FOUND
06782          PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
06783          IF CERTIFICATE-MASTER = ELCERT-SAVE
06784              PERFORM 9250-UNLOCK-RETURN
06785              GO TO 9990-RETURN
06786           ELSE
06787              PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
06788              GO TO 9990-RETURN.
06789
06790      IF PB-CANCELLATION
06791           GO TO 9990-RETURN.
06792
06793      IF CERT-WAS-NOT-FOUND
06794         MOVE SPACES              TO CERTIFICATE-MASTER.
06795
06796      PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
06797
06798      IF CERT-WAS-FOUND
06799          IF CERTIFICATE-MASTER = ELCERT-SAVE
06800              PERFORM 9250-UNLOCK-RETURN
06801           ELSE
06802             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
06803       ELSE
06804          PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
050509
050509     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
050509        IF PB-COMPANY-ID = 'DCC' AND
050509           (PB-CARRIER = '2' OR '4' OR '6')
050509              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
050509        END-IF
050509     END-IF.
011513
011513     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
011513         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
011513     END-IF.
06805
           MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
           IF ((PB-COMPANY-ID = 'DCC')
              AND (WS-NO-SECURE-PAY))
                        OR
              (WS-LF-SPECIAL-CALC-CD = 'O'
              OR WS-AH-SPECIAL-CALC-CD = 'O')
              SET SKIP-ADDR-EDIT       TO TRUE
           END-IF
080310     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
              AND (NOT SKIP-ADDR-EDIT)
080310        MOVE ER-2963             TO WS-ERROR
080310        PERFORM 9900-ERROR-FORMAT
080310                                 THRU 9900-EXIT
080310        GO TO 9990-RETURN
080310     END-IF
06809      PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
           IF ERPNDM-FOUND NOT = 'X'
              IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
                 OR (PM-CITY-STATE  = SPACES OR LOW-VALUES)
                 OR (PM-ZIP         = SPACES OR LOW-VALUES))
                 AND (NOT SKIP-ADDR-EDIT)
                 MOVE ER-2694          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
080310        MOVE ' '                 TO STATE-RECORD-ERROR
080310        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
080310        MOVE PM-STATE            TO CNTL-ACCESS
080310        MOVE '3'                 TO CNTL-REC-TYPE
080310        MOVE +0                  TO CNTL-SEQ-NO
080310        MOVE '0'                 TO RC-SW-2
080310        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
080310        IF (NO-STATE-RECORD)
080310           OR (CF-RECORD-TYPE NOT = '3')
080310           OR (PM-STATE NOT = CF-STATE-CODE)
                 IF (PM-STATE = SPACES)
                    AND (SKIP-ADDR-EDIT)
                    CONTINUE
                 ELSE
080310              MOVE ER-2963       TO WS-ERROR
080310              PERFORM 9900-ERROR-FORMAT
080310                                 THRU 9900-EXIT
                 END-IF
080310        END-IF
              IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
                 MOVE ER-2883          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
080310        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
080310           MOVE ' '                 TO STATE-RECORD-ERROR
080310           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
080310           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
080310           MOVE '3'                 TO CNTL-REC-TYPE
080310           MOVE +0                  TO CNTL-SEQ-NO
080310           MOVE '0'                 TO RC-SW-2
080310           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
080310           IF NO-STATE-RECORD
080310              OR (CF-RECORD-TYPE NOT = '3')
080310              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
080310              MOVE ER-2964          TO WS-ERROR
080310              PERFORM 9900-ERROR-FORMAT
080310                                    THRU 9900-EXIT
080310           END-IF
080310        END-IF
           ELSE
              IF NOT SKIP-ADDR-EDIT
                 MOVE ER-2393          TO WS-ERROR
                 PERFORM 9900-ERROR-FORMAT
                                       THRU 9900-EXIT
              END-IF
           END-IF
06810
06811      PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
06812
06813      IF (ERMAIL-FOUND = ' ' AND
06814         ERPNDM-FOUND = ' ')
06815         IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
06816            MA-PROFILE-INFO = PM-PROFILE-INFO AND
                 MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
06817           OR
06818            (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
06819           OR
06820            (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
06821            MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
06822            GO TO 3999-UNLOCK-ERMAIL.
06823
06824      IF ERPNDM-FOUND = 'X'
06825         GO TO 3999-UNLOCK-ERMAIL.
06826
080310     IF PM-INSURED-LAST-NAME      = SPACES
080310        AND PM-INSURED-FIRST-NAME = SPACES
080310        AND PM-ADDRESS-LINE-1     = SPACES
080310        AND PM-ADDRESS-LINE-2     = SPACES
080310        AND PM-CITY-STATE         = SPACES
080310        AND PM-CRED-BENE-NAME     = SPACES
080310        AND PM-CRED-BENE-ADDR     = SPACES
080310        AND PM-CRED-BENE-CTYST    = SPACES
080310        GO TO 3999-UNLOCK-ERMAIL
080310     END-IF
06833
06834      MOVE SPACES                 TO MAILING-DATA.
06835
06836      MOVE 'MA'                   TO MA-RECORD-ID.
06837      MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
06838      MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
06839      MOVE PB-SV-CARRIER          TO MA-CARRIER.
06840      MOVE PB-SV-GROUPING         TO MA-GROUPING.
06841      MOVE PB-SV-STATE            TO MA-STATE.
06842      MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
           MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
06843
06844      MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
06845      MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
06846
06847      IF ERMAIL-FOUND = ' '
06848         PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
06849      ELSE
06850         MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
06851         MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
06852         PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
06853
06854      GO TO 9990-RETURN.
06855
06856  3999-UNLOCK-ERMAIL.
06857      IF ERMAIL-FOUND = ' '
06858         PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
06859
06860      GO TO 9990-RETURN.
06861 ******************************************************************
06862
06863      EJECT
06864  4000-UPDATE-CANCELLED-CERT.
06865      IF CERT-WAS-NOT-FOUND
06866         GO TO 4299-EXIT.
06867
06868 *    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
           IF PB-C-NH-INT-ON-REFS > ZEROS
              MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
           END-IF
           IF PB-C-REF-INTERFACE-SW = 'Y'
              MOVE PB-C-REF-INTERFACE-SW
                                       TO CM-NH-INTERFACE-SW
           END-IF
081606     IF PB-C-POST-CARD-IND = 'Y'
081606        MOVE +8                  TO SUB
081606        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
081606        IF ERMAIL-FOUND = ' '
081606           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
081606              (SUB > +7)
081606              OR (MA-MAIL-STATUS (SUB) = '1')
081606           END-PERFORM
081606        END-IF
081606        IF (SUB > +7)
081606           OR (ERMAIL-FOUND = 'X')
081606           MOVE ER-3789          TO WS-ERROR
081606           PERFORM 9900-ERROR-FORMAT
081606                                 THRU 9900-EXIT
081606        END-IF
081606     ELSE
081606        MOVE 'N'                 TO PB-C-POST-CARD-IND
081606     END-IF
081606     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
06869
06870      IF PB-CI-OB-FLAG = 'Z'
06871         GO TO 4150-SUMMARY-CERT-CANCEL.
06872
06873      IF PB-C-LF-CANCEL-VOIDED
06874          PERFORM 4200-REVERSE-LF-CANCEL.
06875      IF PB-C-AH-CANCEL-VOIDED
06876          PERFORM 4200-REVERSE-AH-CANCEL.
06877
06878  4100-APPLY-LF-CANCEL.
06879
06880      MOVE +0                     TO WS-SUB.
06881
06882  4100-CHECK-LF-ERRORS.
06883
06884      ADD +1                       TO WS-SUB.
06885
06886      IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
06887         IF LF-COVERAGE-CANCELLED
06888            GO TO 4100-LF-CANCEL-CONT
06889         ELSE
06890            GO TO 4100-UPDATE-LF-COVERAGE.
06891
06892      IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
06893                                    ER-2729 OR
06894                                    ER-2730 OR
06895                                    ER-2731 OR
06896                                    ER-2732 OR
06897                                    ER-2737 OR
06898                                    ER-2740 OR
06899                                    ER-2743 OR
06900                                    ER-2749 OR
06901                                    ER-2750 OR
06902                                    ER-2755 OR
06903                                    ER-2757 OR
06904                                    ER-2760 OR
06905                                    ER-2772 OR
06906                                    ER-2774 OR
06907                                    ER-2776 OR
06908                                    ER-2794
06909         GO TO 4100-UPDATE-LF-COVERAGE.
06910
06911      GO TO 4100-CHECK-LF-ERRORS.
06912
06913  4100-UPDATE-LF-COVERAGE.
06914
06915      MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
06916      MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
042011     IF NOT CM-LF-DEATH-CLAIM-APPLIED
042011        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
042011     END-IF
06918      MOVE PB-CI-CREDIT-INTERFACE-SW-2
06919                                       TO CM-CREDIT-INTERFACE-SW-2.
06920      IF CM-LF-CANCEL-DT = LOW-VALUE
06921          MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
06922
06923      IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
06924          MOVE SPACES                  TO CM-LF-EXIT-BATCH
06925                                          CM-LF-STATUS-AT-CANCEL.
06926
06927      GO TO 4100-APPLY-AH-CANCEL.
06928
06929  4100-LF-CANCEL-CONT.
06930      IF PB-C-LF-CANCEL-VOIDED
06931          GO TO 4100-APPLY-AH-CANCEL.
06932
06933      IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
06934          GO TO 4100-APPLY-AH-CANCEL.
06935
06936      IF PB-C-LF-CANCEL-AMT GREATER ZERO
06937         IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
06938            MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
06939         ELSE
06940            MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
06941
06942      MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
06943      MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
06944
06945      IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
06946          MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
06947
06948      IF (CM-LF-STATUS-AT-CANCEL = SPACE)
042011        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
06949          MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
06950          MOVE '8'                  TO CM-LF-CURRENT-STATUS.
06951
06952      IF PB-RECORD-RETURNED
06953         MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
06954       ELSE
06955         MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
06956
06957  4100-APPLY-AH-CANCEL.
06958
06959      MOVE +0                      TO WS-SUB.
06960
06961  4100-CHECK-AH-ERRORS.
06962
06963      ADD +1                       TO WS-SUB.
06964
06965      IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
06966         IF AH-COVERAGE-CANCELLED
06967            GO TO 4100-AH-CANCEL-CONT
06968         ELSE
06969            GO TO 4100-UPDATE-AH-COVERAGE.
06970
06971      IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
06972                                    ER-2729 OR
06973                                    ER-2732 OR
06974                                    ER-2737 OR
06975                                    ER-2740 OR
06976                                    ER-2744 OR
06977                                    ER-2749 OR
06978                                    ER-2750 OR
06979                                    ER-2755 OR
06980                                    ER-2757 OR
06981                                    ER-2760 OR
06982                                    ER-2771 OR
06983                                    ER-2772 OR
06984                                    ER-2773 OR
06985                                    ER-2775 OR
06986                                    ER-2777 OR
06987                                    ER-2794
06988         GO TO 4100-UPDATE-AH-COVERAGE.
06989
06990      GO TO 4100-CHECK-AH-ERRORS.
06991
06992  4100-UPDATE-AH-COVERAGE.
06993
06994      MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
06995      MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
06996      MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
06997      MOVE PB-CI-CREDIT-INTERFACE-SW-2
06998                                       TO CM-CREDIT-INTERFACE-SW-2.
06999      IF CM-AH-CANCEL-DT = LOW-VALUE
07000          MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
07001
07002      IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
07003          MOVE SPACES                  TO CM-AH-EXIT-BATCH
07004                                          CM-AH-STATUS-AT-CANCEL.
07005
07006      IF LF-COVERAGE-CANCELLED
07007          IF PB-RECORD-RETURNED
07008               MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
07009           ELSE
07010               MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
07011
07012      GO TO 4299-EXIT.
07013
07014  4100-AH-CANCEL-CONT.
07015      IF PB-C-AH-CANCEL-VOIDED
07016          GO TO 4299-EXIT.
07017
07018      IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
07019          GO TO 4299-EXIT.
07020
07021      IF PB-C-AH-CANCEL-AMT GREATER ZERO
07022         IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
07023            MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
07024         ELSE
07025            MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
07026
07027      MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
07028      MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
07029
07030      IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
07031          MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
07032
07033      IF CM-AH-STATUS-AT-CANCEL = SPACE
07034          MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
07035          MOVE '8'                TO CM-AH-CURRENT-STATUS.
07036
07037      IF PB-RECORD-RETURNED
07038         MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
07039       ELSE
07040         MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
07041
07042      GO TO 4299-EXIT.
07043
07044  4150-SUMMARY-CERT-CANCEL.
07045      MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
07046
07047      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
07048         COMPUTE CM-LF-ITD-CANCEL-AMT =
07049                       PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
07050      ELSE
07051         COMPUTE CM-LF-ITD-CANCEL-AMT =
07052                        PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
07053
07054      IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
07055         COMPUTE CM-AH-ITD-CANCEL-AMT =
07056                        PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
07057      ELSE
07058         COMPUTE CM-AH-ITD-CANCEL-AMT =
07059                        PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
07060
07061      IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
07062         NEXT SENTENCE
07063      ELSE
07064         COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
07065
07066      GO TO 4299-EXIT.
07067
07068  4200-REVERSE-LF-CANCEL.
07069      MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
07070
07071      IF CM-LF-CANCEL-APPLIED
07072         MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
07073         MOVE SPACES                TO CM-LF-EXIT-BATCH
07074         MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
07075
07076      MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
07077
07078      IF PB-RECORD-RETURNED
07079         MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
07080        ELSE
07081         MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
07082
07083  4200-REVERSE-LF-EXIT.
07084        EXIT.
07085
07086  4200-REVERSE-AH-CANCEL.
07087      MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
07088
07089      IF CM-AH-CANCEL-APPLIED
07090         MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
07091         MOVE SPACES                TO CM-AH-EXIT-BATCH
07092         MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
07093
07094      MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
07095
07096      IF PB-RECORD-RETURNED
07097         MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
07098        ELSE
07099         MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
07100
07101  4200-REVERSE-AH-EXIT.
07102        EXIT.
07103
07104  4299-EXIT.
07105        EXIT.
07106        EJECT
07107
07108  4500-UPDATE-NEW-CERT.
07109      IF CERT-WAS-FOUND
07110          NEXT SENTENCE
07111        ELSE
07112          GO TO 4520-BUILD-NEW-KEY.
07113
07114      IF  CLASIC-CREATED-CERT
07115          GO TO 4999-EXIT.
07116
07117      IF  CERT-WAS-CREATED-FOR-CLAIM
07118          GO TO 4520-BUILD-NEW-KEY.
07119
07120      IF CERT-ADDED-BATCH
07121         IF CM-RECORD-ID = 'CM'
07122             GO TO 4999-EXIT.
07123
07124  4520-BUILD-NEW-KEY.
07125 * BUILD CONTROL PRIMARY
07126
07127      MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
07128                                        CM-COMPANY-CD-A1
07129                                        CM-COMPANY-CD-A2
07130                                        CM-COMPANY-CD-A4
07131                                        CM-COMPANY-CD-A5.
07132
07133      MOVE PB-SV-CARRIER             TO CM-CARRIER.
07134      MOVE PB-SV-GROUPING            TO CM-GROUPING.
07135      MOVE PB-SV-STATE               TO CM-STATE.
07136      MOVE PB-ACCOUNT                TO CM-ACCOUNT.
07137      MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
07138      MOVE PB-CERT-SFX               TO CM-CERT-SFX.
07139      MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
07140
07141      MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
07142
07143      MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
07144      MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
07145      MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
07146      MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
07147
07148      IF PB-I-SOC-SEC-NO EQUAL '000000000  '
07149         MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
07150
07151      IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
07152          MOVE PB-SV-STATE            TO CM-SSN-STATE
07153          MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
07154          MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
07155          MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
07156      ELSE
07157          MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
07158
07159      IF PB-COMPANY-ID   EQUAL  'CRI'
07160          MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
07161          MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
07162          MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
07163          MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
07164          MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
07165
07166      IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
07167         (CM-INSURED-INITIALS  = SPACES OR ZERO)
07168          MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
07169
07170      IF PB-COMPANY-ID  = 'LBL'
07171         IF PB-I-JOINT-COVERAGE
07172             MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
07173                                            PB-I-MEMBER-NO
07174             GO TO 4550-CONT-CERT-PROCESS.
07175
07176      IF PB-COMPANY-ID  = 'MON' OR 'PEM'
07177         NEXT SENTENCE
07178      ELSE
07179         GO TO 4540-BUILD-MEMBER-NO.
07180
07181 ******************************************************************
07182 *                                                                *
07183 *    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
07184 *    FOR 'MON'.                                                  *
07185 *                                                                *
07186 ******************************************************************
07187
07188      MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
07189      MOVE SPACES                 TO WS-WORK-MEMB-NAME.
07190      MOVE +1                     TO WS-SUB1
07191                                     WS-SUB2.
07192
07193  4530-EDIT-MEMB-NAME.
07194
07195      IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
07196         MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
07197         ADD +1                       TO WS-SUB2.
07198
07199      IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
07200         ADD +1                       TO WS-SUB1
07201         GO TO 4530-EDIT-MEMB-NAME.
07202
07203      MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
07204      MOVE PB-SV-STATE                TO CM-MEMB-STATE.
07205      MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
07206 *    MOVE SPACE                      TO DC-OPTION-CODE.
07207      SET  BIN-TO-GREG                TO TRUE.
07208      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
07209      MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
07210
07211      GO TO 4550-CONT-CERT-PROCESS.
07212
07213 ******************************************************************
07214 *    END FOR 'MON' CODE FOR MEMBER NO.                           *
07215 ******************************************************************
07216
07217  4540-BUILD-MEMBER-NO.
07218
07219      IF PB-I-MEMBER-NO  = SPACES OR ZERO
07220          MOVE PB-SV-STATE            TO CM-MEMB-STATE
07221          MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
07222          MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
07223          MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
07224      ELSE
07225          MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
07226
07227      IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
07228         (CM-INSURED-INITIALS  = SPACES OR ZERO)
07229          MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
07230
07231  4550-CONT-CERT-PROCESS.
07232
07233 *    IF PB-I-MICROFILM-NO  NOT NUMERIC
07234 *        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
07235 *    ELSE
07236 *        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
07237
07238      IF CERT-WAS-CREATED-FOR-CLAIM
07239         MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
07240         MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
07241
07242      IF CERT-AND-CLAIM-ONLINE
07243         MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
07244         MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
07245
07246      MOVE 'CM'                     TO CM-RECORD-ID.
07247      MOVE LOW-VALUES               TO CM-STATUS-DATA.
07248
07249      IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
07250         MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
07251         MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
07252      ELSE
07253         MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
07254         MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
07255
07256      MOVE ZERO                     TO CM-LOAN-BALANCE.
07257      MOVE '1'                      TO CM-PREMIUM-TYPE.
07258      MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
07259      MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
07260      MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
07261      MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
07262      MOVE ZEROS                    TO CM-LF-REMAINING-AMT
07263                                       CM-LF-ITD-CANCEL-AMT
07264                                       CM-LF-ITD-DEATH-AMT
07265                                       CM-AH-ITD-AH-PMT
07266                                       CM-AH-ITD-LUMP-PMT
07267                                       CM-AH-ITD-CANCEL-AMT
07268                                       CM-LF-NSP-PREMIUM-AMT
07269                                       CM-AH-NSP-PREMIUM-AMT.
020906*                                     CM-CLAIM-DEDUCT-WITHHELD
020906*                                     CM-CANCEL-DEDUCT-WITHHELD.
07272      MOVE PB-I-LOAN-APR            TO CM-LOAN-APR.
07273      MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
07274      MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
07275      MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
07276      MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
07277      MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
07278      MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
07279      MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
07280      MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
07281      MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
07282      MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
07283      MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
07284
07285      IF PB-I-LIVES NOT NUMERIC
07286          MOVE ZERO                 TO PB-I-LIVES.
07287
07288      IF PB-I-NUM-BILLED NOT NUMERIC
07289          MOVE ZERO                 TO PB-I-NUM-BILLED.
07290
07291      MOVE PB-I-LIVES               TO CM-LIVES.
07292      MOVE PB-I-NUM-BILLED          TO CM-BILLED.
07293
07294      IF PB-COMPANY-ID EQUAL  'DMD'
07295          MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
07296          MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
07297
07298      MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
07299      MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
07300      MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
07301      MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
07302      MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
011410     MOVE PB-I-LF-CLP              TO CM-LF-CLP
07303
07304      IF PB-I-LF-POLICY-FEE NUMERIC
07305         MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
07306      ELSE
07307         MOVE +0                    TO CM-LF-POLICY-FEE.
07308
07309      IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
07310         MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
07311         MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
07312      ELSE
07313         MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
07314
07315      MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
07316      MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
07317      MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
07318      MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
07319      MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
07320      MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
07321      MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
07322      MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
011410     MOVE PB-I-AH-CLP              TO CM-AH-CLP
07323
07324      IF PB-I-AH-POLICY-FEE NUMERIC
07325         MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
07326      ELSE
07327         MOVE +0                    TO CM-AH-POLICY-FEE.
07328
07329      IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
07330         MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
07331      ELSE
07332         MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
07333
07334      MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
07335      MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
07336
07337      MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
07338                                       CM-LF-DEATH-EXIT-DT
07339                                       CM-AH-SETTLEMENT-EXIT-DT.
07340
07341 *    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
07342 *                       'TIH' OR 'OFL' OR 'FLA' OR
07343 *                       'TII' OR 'TMS' OR 'CRI' OR
07344 *                       'NCL'
102706     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
07346
07347      IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
07348          IF WS-LF-SPECIAL-CALC-CD = 'O'
07349             MOVE '2'                TO CM-PREMIUM-TYPE.
07350
07351      IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
07352          IF WS-AH-SPECIAL-CALC-CD = 'O'
07353             MOVE '2'                TO CM-PREMIUM-TYPE.
07354
07355      IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
07356          MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
07357      ELSE
07358          MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
07359          MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
07360
07361      MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
07362      MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
07363      MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
07364      MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
07365      MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
07366      MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
07367      MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
07368      MOVE SPACE                     TO CM-PAYMENT-MODE.
07369
07370      IF PB-NO-MONTHS-SKIPPED
07371          MOVE SPACE                 TO CM-SKIP-CODE
07372      ELSE
07373          MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
07374
07375      MOVE '2'                       TO CM-LF-CURRENT-STATUS.
07376      MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
07377                                        CM-LF-STATUS-AT-CANCEL.
07378
07379      MOVE '2'                       TO CM-AH-CURRENT-STATUS.
07380      MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
07381                                        CM-AH-STATUS-AT-CANCEL.
07382
07383      MOVE '1'                       TO CM-ENTRY-STATUS.
07384
07385      IF PB-REISSUED-CERT
07386         MOVE '5'                    TO CM-ENTRY-STATUS.
07387
122002     IF PB-MONTHLY-CERT
122002        MOVE 'M'                    TO CM-ENTRY-STATUS.
122002
040504     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
061405     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
07388      IF PB-POLICY-IS-DECLINED
07389         MOVE 'D'                    TO CM-ENTRY-STATUS.
07390
07391      IF PB-POLICY-IS-VOIDED
07392         MOVE 'V'                    TO CM-ENTRY-STATUS.
07393
07394      IF PB-NEEDS-UNDERWRITING
07395         MOVE 'U'                    TO CM-ENTRY-STATUS.
07396
07397      IF PB-REIN-ONLY-CERT
07398         MOVE '9'                    TO CM-ENTRY-STATUS.
07399
07400      IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
07401          MOVE 'Y'                   TO CM-UNDERWRITING-CODE
07402      ELSE
07403          MOVE SPACE                 TO CM-UNDERWRITING-CODE.
07404
07405      IF PB-RECORD-RETURNED
07406         MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
07407       ELSE
07408         MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
07409
07410      IF PB-I-MAIL-ADDRS-PRESENT
07411         MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
07412
07413      MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
07414                                        CM-ENTRY-DT.
07415
07416  4999-EXIT.
07417      EXIT.
07418      EJECT
07419
       5000-PROCESS-REPS.
           MOVE ' '                    TO AGTC-MASTER-SW
           MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
           MOVE CO-TYPE                TO AGTC-TYPE
           MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
           PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
           IF (AGTC-MASTER-SW NOT = 'N')
              AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
              AND (PB-CERT-EFF-DT = AG-EXP-DT)
              PERFORM 8583-READ-ERAGTC-NEXT
                                       THRU 8583-EXIT
           END-IF
           IF AGTC-MASTER-SW = 'N'
              CONTINUE
           ELSE
              IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
                 IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
                    AND (PB-CERT-EFF-DT < AG-EXP-DT)
                    MOVE 'Y'           TO AGTC-MASTER-SW
                 END-IF
              END-IF
           END-IF
           .
       5000-EXIT.
           EXIT.
07420  6370-EDIT-INPUT-LF-CODE.
07421      IF WK-LIFE-EDIT-ADDR NOT = ZEROS
07422         MOVE +1                  TO SUB
07423         MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
07424         SET ELCNTL-FILE-ADDRESSED   TO TRUE
07425         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
07426         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
07427         GO TO 6370-SEARCH-LOOP.
07428
07429      PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
07430
07431      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
07432      MOVE SPACES                 TO CNTL-ACCESS.
07433 *    MOVE 'L'                    TO CNTL-REC-TYPE.
07434      MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
07435      MOVE +0                     TO CNTL-SEQ-NO.
07436      MOVE '4' TO RC-SW-2.
07437      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
07438
07439      IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
07440         CF-RECORD-TYPE NOT = CNTL-REC-TYPE
07441         GO TO 6370-NO-LF-FOUND.
07442
07443      MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
07444      MOVE +1                     TO SUB.
07445
07446  6370-SEARCH-LOOP.
07447      IF CF-LIFE-CODE-OUT (SUB) = ZEROS
07448          GO TO 6370-NO-LF-FOUND.
07449
07450      IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
07451          MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
07452          GO TO 6370-HER-NET-PAY-CHECK.
07453
07454      ADD 1   TO SUB.
CIDMOD*    IF SUB GREATER 120
CIDMOD     IF SUB GREATER 200
07456          GO TO 6370-NO-LF-FOUND.
07457
07458      GO TO 6370-SEARCH-LOOP.
07459
07460  6370-NO-LF-FOUND.
07461
07462      MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
07463
07464  6370-HER-NET-PAY-CHECK.
07465
CIDMOD     IF PB-COMPANY-ID = 'CID'
CIDMOD        IF PB-SV-STATE = 'CA' OR 'MN'
CIDMOD           IF PB-I-LF-BENEFIT-CD = '02'
CIDMOD              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
CIDMOD           ELSE
CIDMOD              IF PB-I-LF-BENEFIT-CD = '04'
CIDMOD                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
CIDMOD              END-IF
CIDMOD           END-IF
CIDMOD        END-IF
CIDMOD     END-IF
CIDMOD
07466      IF PB-COMPANY-ID NOT = 'HER'
07467          GO TO 6370-EXIT.
07468
07469      IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
07470          GO TO 6370-EXIT.
07471
07472      IF PB-I-LF-TERM NOT NUMERIC
07473          MOVE ZEROS              TO PB-I-LF-TERM.
07474
07475      IF PB-I-LOAN-TERM NOT NUMERIC
07476          MOVE ZEROS              TO PB-I-LOAN-TERM.
07477
07478      IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
07479          GO TO 6370-EXIT.
07480
07481      IF PB-I-LF-BENEFIT-CD = '33'
07482          MOVE '31'               TO PB-I-LF-BENEFIT-CD.
07483
07484      IF PB-I-LF-BENEFIT-CD = '34'
07485          MOVE '32'               TO PB-I-LF-BENEFIT-CD.
07486
07487  6370-EXIT.
07488      EXIT.
07489      EJECT
07490
07491  6380-EDIT-INPUT-AH-CODE.
07492      IF WK-AH-EDIT-ADDR NOT = ZEROS
07493         MOVE +1                  TO SUB
07494         MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
07495         SET ELCNTL-FILE-ADDRESSED   TO TRUE
07496         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
07497         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
07498         GO TO 6380-SEARCH-LOOP.
07499
07500      PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
07501
07502      MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
07503      MOVE SPACES                 TO CNTL-ACCESS.
07504      MOVE 'A'                    TO CNTL-REC-TYPE.
07505 *    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
07506      MOVE +0                     TO CNTL-SEQ-NO.
07507      MOVE '5' TO RC-SW-2.
07508      PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
07509
07510      IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
07511         CF-RECORD-TYPE NOT = CNTL-REC-TYPE
07512         GO TO 6380-NO-AH-FOUND.
07513
07514      MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
07515      MOVE +1 TO SUB.
07516
07517  6380-SEARCH-LOOP.
07518      IF CF-AH-CODE-OUT (SUB) = ZEROS
07519          GO TO 6380-NO-AH-FOUND.
07520
07521      IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
07522          MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
07523          GO TO 6380-CSO-AH-ONLY-CHECKS.
07524
07525      ADD 1   TO SUB.
100703     IF SUB GREATER THAN 96
CIDMOD*    IF SUB GREATER THAN 300
07527          GO TO 6380-NO-AH-FOUND.
07528
07529      GO TO 6380-SEARCH-LOOP.
07530
07531  6380-NO-AH-FOUND.
07532
07533      MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
07534
07535      IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
07536          MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
07537      ELSE
07538          MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
07539
07540  6380-CSO-AH-ONLY-CHECKS.
07541
CIDMOD     IF PB-COMPANY-ID = 'CSO' OR 'CID'
CIDMOD        NEXT SENTENCE
CIDMOD      ELSE
07543         GO TO 6380-EXIT.
07544
07545      IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
07546          GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
07547
CIDMOD
CIDMOD     GO TO 6380-EXIT
CIDMOD     .
CIDMOD 6380-CSO-LIFE-WITH-AH-CHECKS.
CIDMOD
CIDMOD
CIDMOD     .
07570  6380-EXIT.
07571      EXIT.
07572
07573      EJECT
07574
07575  6400-COMPUTE-EXTENSION-DAYS.
07576
07577 ******************************************************************
07578 *                                                                *
07579 *                   COMPUTE EXTENSION DAYS                       *
07580 *                                                                *
07581 *    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
07582 *    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
07583 *    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
07584 *    THE EXTENSION DAYS.                                         *
07585 *                                                                *
07586 ******************************************************************
07587
07588      MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
07589      MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
07590
07591 ******************************************************************
07592 *    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
07593 *       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
07594 ******************************************************************
07595
07596      IF DC-ELAPSED-MONTHS GREATER THAN +0
07597         COMPUTE WS-ODD-DAYS-OVER =
07598                ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
07599      ELSE
07600         MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
07601
07602      IF WS-ODD-DAYS-OVER = ZEROS
07603            GO TO 6499-EXIT
07604      ELSE
07605         IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
07606            IF WS-WDF-MONTH = 02
07607               PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
07608               ADD 2       TO  WS-ODD-DAYS-OVER
07609               GO TO 6499-EXIT
07610            ELSE
07611               IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
07612                  SUBTRACT 1 FROM WS-ODD-DAYS-OVER
07613                  GO TO 6499-EXIT
07614                ELSE
07615                  GO TO 6499-EXIT
07616         ELSE
07617            GO TO 6499-EXIT.
07618
07619  6412-CHECK-TO-DAY.
07620
07621         IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
07622            IF WS-WDT-DAY = 28
07623               ADD 2              TO WS-ODD-DAYS-OVER
07624            ELSE
07625               IF WS-WDT-DAY = 29
07626                  ADD 1           TO WS-ODD-DAYS-OVER
07627               ELSE
07628                  NEXT SENTENCE
07629         ELSE
07630            IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
07631               SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
07632
07633      GO TO 6499-EXIT.
07634
07635
07636  6415-CHECK-LEAP-YEAR.
07637
07638      IF DC-DAYS-IN-MONTH = 29
07639         SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
07640
07641  6415-EXIT.
07642      EXIT.
07643
07644  6499-EXIT.
07645       EXIT.
07646
07647  6500-END.
CIDVAO     EXIT.
CIDVAO
07648
07649 ******************************************************************
07650 ************* PROCEDURE DIVISION FOR EL050 ***********************
07651 ********************** ELC50PD END *******************************
07652
00334      EJECT
00335
00336 **START***********************************************************
00337 *      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
00338 *            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
00339 ******************************************************************
00340 *
00341  6600-GET-STATE-MUNICIPAL-TAX.
00342
00343      IF PB-COMPANY-ID NOT = 'DMD'
00344          GO TO 6640-EXIT.
00345
00346      MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
00347      MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
00348      MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
00349 *CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
00350 *
00351 ***  Y2K PROJ 7744
00352      MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
00353      SET BIN-TO-GREG          TO TRUE.
00354      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
00355
00356      MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
00357
00358      MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
00359      MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
00360
00361      
      * EXEC CICS HANDLE CONDITION
00362 *        INVREQ    (6610-START-BROWSE)
00363 *        NOTOPEN   (6630-ERRESS-PROBLEM)
00364 *        NOTFND    (6630-END-OF-FILE)
00365 *    END-EXEC.
      *    MOVE '"$8JI                 ! # #00017948' TO DFHEIV0
           MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2320233030303137393438' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00366
00367  6610-START-BROWSE.
00368
00369      
      * EXEC CICS HANDLE CONDITION
00370 *        NOTFND    (6630-END-OF-FILE)
00371 *        DISABLED  (6630-ERRESS-PROBLEM)
00372 *        NOTOPEN   (6630-ERRESS-PROBLEM)
00373 *        ENDFILE   (6630-END-OF-FILE)
00374 *    END-EXEC.
      *    MOVE '"$IcJ''                ! $ #00017956' TO DFHEIV0
           MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2420233030303137393536' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00375
00376      
      * EXEC CICS STARTBR
00377 *        DATASET (FILE-ID-ERRESS)
00378 *        RIDFLD  (WS-ERRESS-KEY)
00379 *        GTEQ
00380 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00017963' TO DFHEIV0
           MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303137393633' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 WS-ERRESS-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00381
00382  6620-READ-NEXT-ERRESS-MASTER.
00383
00384      
      * EXEC CICS HANDLE CONDITION
00385 *        NOTFND    (6630-END-OF-FILE)
00386 *        ENDFILE   (6630-END-OF-FILE)
00387 *        DISABLED  (6630-ERRESS-PROBLEM)
00388 *        NOTOPEN   (6630-ERRESS-PROBLEM)
00389 *    END-EXEC.
      *    MOVE '"$I''cJ                ! % #00017971' TO DFHEIV0
           MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2520233030303137393731' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00390
00391      
      * EXEC CICS READNEXT
00392 *        DATASET (FILE-ID-ERRESS)
00393 *        INTO    (RESIDENT-STATE-TAX-MASTER)
00394 *        RIDFLD  (WS-ERRESS-KEY)
00395 *    END-EXEC.
           MOVE LENGTH OF
            RESIDENT-STATE-TAX-MASTER
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00017978' TO DFHEIV0
           MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'2020233030303137393738' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 RESIDENT-STATE-TAX-MASTER, 
                 DFHEIV12, 
                 WS-ERRESS-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00396
00397      IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
00398         
      * EXEC CICS ENDBR
00399 *            DATASET (FILE-ID-ERRESS)
00400 *       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00017985' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303137393835' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
00401         GO TO 6630-END-OF-FILE.
00402
00403      IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
00404         NEXT SENTENCE
00405       ELSE
00406         GO TO 6620-READ-NEXT-ERRESS-MASTER.
00407
00408 *IS IT LIFE(1) OR IS IT P&C(2) ?????
00409 *WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
00410 *
00411      MOVE +2                     TO WS-SUB1.
00412
00413      IF PB-ISSUE
00414      IF PB-I-POLICY-FORM-NO (6:1) = '1'
00415         MOVE +1                  TO WS-SUB1.
00416
00417      IF PB-CANCELLATION
00418      IF PB-C-POLICY-FORM-NO (6:1) = '1'
00419         MOVE +1                  TO WS-SUB1.
00420 *
00421 *CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
00422 *
00423 ***  Y2K PROJ 7744
00424      MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
00425 ***  Y2K PROJ 7744
00426
00427 *BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
00428 * TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
00429 * TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
00430
00431      ADD 1                    TO WS-YEAR-YY.
00432
00433      IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
00434          MOVE RES-REN-STATE-TAX (WS-SUB1)
00435                               TO WS-RES-STATE-TAX
00436          MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
00437                               TO WS-RES-MUNI-TAX
00438      ELSE
00439          MOVE RES-1YR-STATE-TAX (WS-SUB1)
00440                               TO WS-RES-STATE-TAX
00441          MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
00442                               TO WS-RES-MUNI-TAX.
00443
00444 *COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
00445
00446      IF PB-CANCELLATION
00447          GO TO 6640-CANCEL-TAX.
00448
00449      IF PB-I-LF-PREMIUM-AMT > ZEROS
00450          COMPUTE PB-I-STATE-TAX ROUNDED =
00451                                    PB-I-LF-PREMIUM-AMT
00452                                  * WS-RES-STATE-TAX
00453          COMPUTE PB-I-MUNI-TAX ROUNDED =
00454                                    PB-I-LF-PREMIUM-AMT
00455                                  * WS-RES-MUNI-TAX
00456      ELSE
00457      IF PB-I-AH-PREMIUM-AMT > ZEROS
00458          COMPUTE PB-I-STATE-TAX ROUNDED =
00459                                    PB-I-AH-PREMIUM-AMT
00460                                  * WS-RES-STATE-TAX
00461          COMPUTE PB-I-MUNI-TAX ROUNDED =
00462                                    PB-I-AH-PREMIUM-AMT
00463                                  * WS-RES-MUNI-TAX.
00464
00465      
      * EXEC CICS ENDBR
00466 *         DATASET (FILE-ID-ERRESS)
00467 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018052' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303138303532' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00468
00469      GO TO 6640-EXIT.
00470
00471  6640-CANCEL-TAX.
00472      MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
00473
00474      IF PB-C-LF-CANCEL-AMT > ZEROS
00475          COMPUTE PB-CI-STATE-TAX ROUNDED =
00476                                    PB-C-LF-CANCEL-AMT
00477                                  * WS-RES-STATE-TAX
00478          COMPUTE PB-CI-MUNI-TAX ROUNDED =
00479                                    PB-C-LF-CANCEL-AMT
00480                                 *  WS-RES-MUNI-TAX
00481      ELSE
00482      IF PB-C-AH-CANCEL-AMT > ZEROS
00483          COMPUTE PB-CI-STATE-TAX ROUNDED =
00484                                    PB-C-AH-CANCEL-AMT
00485                                  * WS-RES-STATE-TAX
00486          COMPUTE PB-CI-MUNI-TAX ROUNDED =
00487                                    PB-C-AH-CANCEL-AMT
00488                                 *  WS-RES-MUNI-TAX.
00489
00490      
      * EXEC CICS ENDBR
00491 *         DATASET (FILE-ID-ERRESS)
00492 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018077' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303138303737' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00493
00494      GO TO 6640-EXIT.
00495
00496  6630-END-OF-FILE.
00497      MOVE ER-8002              TO WS-ERROR.
00498      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00499
00500      GO TO 6640-EXIT.
00501
00502  6630-ERRESS-PROBLEM.
00503      MOVE ER-8044              TO WS-ERROR.
00504      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00505
00506  6640-EXIT.
00507      EXIT.
00508
00509      EJECT
00510  6650-GET-RES-STATE-COMM.
00511
00512      IF PB-COMPANY-ID NOT = 'DMD'
00513          GO TO 6700-COMM-EXIT.
00514
00515      MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
00516      MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
00517      MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
00518      MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
00519      MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
00520      MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
00521      MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
00522
00523 *CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
00524 *
00525 ***  Y2K PROJ 7744
00526      MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
00527      SET BIN-TO-GREG          TO TRUE.
00528      PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
00529
00530      MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
00531 ***  Y2K PROJ 7744
00532
00533      MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
00534
00535      
      * EXEC CICS HANDLE CONDITION
00536 *        INVREQ    (6660-START-BROWSE)
00537 *        DISABLED  (6690-ERRESC-PROBLEM)
00538 *        NOTOPEN   (6690-ERRESC-PROBLEM)
00539 *        NOTFND    (6690-END-OF-FILE)
00540 *    END-EXEC.
      *    MOVE '"$8cJI                ! & #00018122' TO DFHEIV0
           MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2620233030303138313232' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00541
00542      
      * EXEC CICS RESETBR
00543 *        DATASET (FILE-ID-ERRESC)
00544 *        RIDFLD  (WS-ERRESC-KEY)
00545 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&4         G          &   #00018129' TO DFHEIV0
           MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303138313239' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 WS-ERRESC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00546
00547  6660-START-BROWSE.
00548
00549      
      * EXEC CICS HANDLE CONDITION
00550 *        NOTFND    (6690-END-OF-FILE)
00551 *        DISABLED  (6690-ERRESC-PROBLEM)
00552 *        NOTOPEN   (6690-ERRESC-PROBLEM)
00553 *        ENDFILE   (6690-END-OF-FILE)
00554 *    END-EXEC.
      *    MOVE '"$IcJ''                ! '' #00018136' TO DFHEIV0
           MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2720233030303138313336' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00555
00556      
      * EXEC CICS STARTBR
00557 *        DATASET (FILE-ID-ERRESC)
00558 *        RIDFLD  (WS-ERRESC-KEY)
00559 *        GTEQ
00560 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00018143' TO DFHEIV0
           MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303138313433' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 WS-ERRESC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00561
00562      MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
00563
00564  6670-READ-NEXT-ERRESC-MASTER.
00565
00566      
      * EXEC CICS HANDLE CONDITION
00567 *        NOTFND    (6690-END-OF-FILE)
00568 *        DISABLED  (6690-ERRESC-PROBLEM)
00569 *        NOTOPEN   (6690-ERRESC-PROBLEM)
00570 *        ENDFILE   (6690-END-OF-FILE)
00571 *    END-EXEC.
      *    MOVE '"$IcJ''                ! ( #00018153' TO DFHEIV0
           MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2820233030303138313533' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00572
00573      
      * EXEC CICS READNEXT
00574 *        DATASET (FILE-ID-ERRESC)
00575 *        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
00576 *        RIDFLD  (ERRESC-RECORD-KEY)
00577 *    END-EXEC.
           MOVE LENGTH OF
            ACCOUNT-RESIDENT-ST-COMMISSION
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00018160' TO DFHEIV0
           MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'2020233030303138313630' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 ACCOUNT-RESIDENT-ST-COMMISSION, 
                 DFHEIV12, 
                 ERRESC-RECORD-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00578
00579      IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
00580         NEXT SENTENCE
00581      ELSE
00582         
      * EXEC CICS ENDBR
00583 *            DATASET (FILE-ID-ERRESC)
00584 *       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018169' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303138313639' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
00585         GO TO 6690-END-OF-FILE.
00586
00587      IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
00588         
      * EXEC CICS ENDBR
00589 *            DATASET (FILE-ID-ERRESC)
00590 *       END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018175' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303138313735' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
00591         GO TO 6690-END-OF-FILE.
00592
00593      IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
00594         NEXT SENTENCE
00595       ELSE
00596         GO TO 6670-READ-NEXT-ERRESC-MASTER.
00597
00598 * SEARCH FOR MATCHING CATEGORY CODE ENTRY
00599 *
00600      MOVE ZEROS               TO WS-SUB WS-SUB1.
00601
00602      PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
00603
00604      IF WS-SUB1 > ZERO
00605          IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
00606              PERFORM 6680-SET-COMMISSION
00607          ELSE
00608              PERFORM 6680-SET-TABLE-CODE.
00609
00610      
      * EXEC CICS ENDBR
00611 *         DATASET (FILE-ID-ERRESC)
00612 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018197' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303138313937' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ID-ERRESC, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00613
00614      GO TO 6700-COMM-EXIT.
00615
00616  6680-SET-TABLE-CODE.
00617      IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
00618         MOVE ZEROS             TO WS-SUB1
00619      ELSE
00620 * DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
00621 * TO COMPUTE AH COMMISSION.
00622         MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
00623         MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
00624         MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
00625         MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
00626         PERFORM 6680-READ-CTBL-TABLE
00627         IF WS-CTBL-READ-SW NOT = 'Y'
00628            MOVE ZEROS          TO WS-SUB1.
00629
00630  6680-READ-CTBL-TABLE.
00631 *
00632 * WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
00633 * TO COMPUTE LIFE COMMISSION
00634
00635      IF CTBL-SW = '0540'
00636         MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
00637         MOVE PB-I-LF-TERM        TO WS-WORK-TERM
00638         MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
00639
00640      PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
00641
00642      IF CTBL-TABLE-FOUND
00643         IF CTBL-SW = '0530'
00644              COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
00645                                     * PB-I-AH-TERM
00646              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
00647              MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
00648         ELSE
00649              MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
00650              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
00651              MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
00652      ELSE
00653         IF FIRST-TIME-THROUGH
00654             GO TO 6680-READ-CTBL-TABLE
00655         ELSE
00656             MOVE ZEROS         TO WS-SUB1.
00657
00658  6680-SET-COMMISSION.
00659      IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
00660            MOVE ZEROS          TO WS-SUB1
00661        ELSE
00662            MOVE RESC-COMMISSION-PER (WS-SUB)
00663                                TO WS-COMMISSION
00664            IF CTBL-SW = '0530'
00665                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
00666            ELSE
00667                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
00668
00669  6680-SEARCH-CATEGORY.
00670      ADD +1                   TO WS-SUB.
00671      IF WS-SUB > +12
00672          GO TO 6680-EXIT.
00673
00674      IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
00675           MOVE WS-SUB         TO WS-SUB1
00676           GO TO 6680-EXIT.
00677
00678      GO TO 6680-SEARCH-CATEGORY.
00679
00680  6680-EXIT.
00681      EXIT.
00682
00683  6690-END-OF-FILE.
00684      GO TO 6700-COMM-EXIT.
00685
00686  6690-ERRESC-PROBLEM.
00687       MOVE ER-8030              TO WS-ERROR.
00688       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
00689
00690       GO TO 6700-COMM-EXIT.
00691
00692  6700-COMM-EXIT.
00693      EXIT.
00694
00695  7000-GET-RATE.
00696      
      * EXEC CICS LINK
00697 *        PROGRAM    ('ELRATE')
00698 *        COMMAREA   (CALCULATION-PASS-AREA)
00699 *        LENGTH     (CP-COMM-LENGTH)
00700 *    END-EXEC.
           MOVE 'ELRATE' TO DFHEIV1
      *    MOVE '."C                   (   #00018283' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138323833' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00701
00702  7000-EXIT.
00703      EXIT.
00704      EJECT
00705  7100-FIND-BENEFIT-IN-STATE.
00706      MOVE 'N'                    TO BEN-SEARCH-SW.
00707
00708      PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
00709          VARYING SUB3 FROM 1 BY 1 UNTIL
00710             ((SUB3 GREATER 50) OR
00711               ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
00712                AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
00713
00714      IF SUB3 NOT = 51
00715          MOVE 'Y'                TO BEN-SEARCH-SW.
00716
00717      GO TO 7199-EXIT.
00718
00719  7100-BENEFIT-DUMMY.
00720
00721  7100-DUMMY-EXIT.
00722      EXIT.
00723
00724  7199-EXIT.
00725      EXIT.
00726      EJECT
00727  7200-FIND-BENEFIT.
00728      MOVE 'N'                    TO BEN-SEARCH-SW.
00729
00730      PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
00731          VARYING SUB3 FROM 1 BY 1 UNTIL
00732             ((SUB3 GREATER 8) OR
00733             (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
00734
00735      IF SUB3 NOT = 9
00736          MOVE 'Y'                TO BEN-SEARCH-SW.
00737
00738      GO TO 7200-EXIT.
00739
00740  7200-BENEFIT-DUMMY.
00741
00742  7200-DUMMY-EXIT.
00743      EXIT.
00744
00745  7200-EXIT.
00746      EXIT.
00747      EJECT
050311 7250-LOOK-FOR-RESCINDED-CLAIM.
050311     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
050311                                    W-CL-COMP-CD.
050311     MOVE PB-CERT-NO             TO MSTR-CERT-NO
050311                                    W-CL-CERT-NO.
050311
050311     
      * EXEC CICS HANDLE CONDITION
050311*        NOTFND  (7250-CONTINUE)
050311*        ENDFILE (7250-CONTINUE)
050311*    END-EXEC.
      *    MOVE '"$I''                  ! ) #00018341' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2920233030303138333431' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
050311
050311     
      * EXEC CICS IGNORE CONDITION
050311*        DUPKEY
050311*    END-EXEC.
      *    MOVE '"*$                   !   #00018346' TO DFHEIV0
           MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2020233030303138333436' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
050311
050311     
      * EXEC CICS STARTBR
050311*        DATASET   (CLMS-ID)
050311*        RIDFLD    (ELMSTR-KEY)
050311*        GENERIC   EQUAL
050311*        KEYLENGTH (ELMSTR-LENGTH)
050311*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,   KG    E          &   #00018350' TO DFHEIV0
           MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303138333530' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 ELMSTR-KEY, 
                 ELMSTR-LENGTH, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
050311
050311     MOVE 'Y'                    TO W-BROWSE-SW.
050311
050311 7250-NEXT-CLAIM.
050311
050311     
      * EXEC CICS READNEXT
050311*        DATASET   (CLMS-ID)
050311*        RIDFLD    (ELMSTR-KEY)
050311*        SET       (ADDRESS OF CLAIM-MASTER)
050311*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00018361' TO DFHEIV0
           MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'2020233030303138333631' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELMSTR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CLAIM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
050311
050311     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
050311        MSTR-CERT-NO NOT = W-CL-CERT-NO
050311         GO TO 7250-CONTINUE
050311     END-IF.
050311
050311     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
050311        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
050311        PB-SV-STATE    NOT = CL-CERT-STATE     OR
050311        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
050311        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
050311         GO TO 7250-NEXT-CLAIM
050311     END-IF.
050311
050311     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
050311        OR (CL-CLAIM-TYPE = 'I')
050311        OR (CL-CLAIM-TYPE = 'G')
050311          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
050311              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
050311              GO TO 7250-CONTINUE
050311          END-IF
050311     END-IF.
050311
050311     GO TO 7250-NEXT-CLAIM.
050311
050311 7250-CONTINUE.
050311
050311     IF W-BROWSE-SW = 'Y'
050311         
      * EXEC CICS ENDBR
050311*            DATASET   (CLMS-ID)
050311*        END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018394' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303138333934' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
050311         MOVE 'N' TO W-BROWSE-SW
050311     END-IF.
050311
050311 7250-EXIT.
050311     EXIT.
050311     EJECT
00748  7300-CHECK-FOR-OPEN-CLMS.
00749
062904*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
062904*    MOVE SPACES                 TO CNTL-ACCESS.
062904*    MOVE '1'                    TO CNTL-REC-TYPE.
062904*    MOVE +0                     TO CNTL-SEQ-NO.
062904
062904*    MOVE '3'                    TO RC-SW-1.
062904*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
062904
062904*    IF NOT CF-COMPANY-MASTER
062904*         PERFORM 0099-COMPANY-NOT-FOUND
062904*         GO TO 7300-EXIT.
00761
00762      MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
00763                                     W-CL-COMP-CD.
00764      MOVE PB-CERT-NO             TO MSTR-CERT-NO
00765                                     W-CL-CERT-NO.
00766
00767      
      * EXEC CICS HANDLE CONDITION
00768 *        NOTFND  (7300-CONTINUE)
00769 *        ENDFILE (7300-CONTINUE)
00770 *    END-EXEC.
      *    MOVE '"$I''                  ! * #00018422' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2A20233030303138343232' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00771
00772      
      * EXEC CICS IGNORE CONDITION
00773 *        DUPKEY
00774 *    END-EXEC.
      *    MOVE '"*$                   !   #00018427' TO DFHEIV0
           MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2020233030303138343237' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00775
00776      
      * EXEC CICS STARTBR
00777 *        DATASET   (CLMS-ID)
00778 *        RIDFLD    (ELMSTR-KEY)
00779 *        GENERIC   EQUAL
00780 *        KEYLENGTH (ELMSTR-LENGTH)
00781 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,   KG    E          &   #00018431' TO DFHEIV0
           MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303138343331' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 ELMSTR-KEY, 
                 ELMSTR-LENGTH, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00782
00783      MOVE 'Y'                    TO W-BROWSE-SW.
00784
00785  7300-NEXT-CLAIM.
00786
00787      
      * EXEC CICS READNEXT
00788 *        DATASET   (CLMS-ID)
00789 *        RIDFLD    (ELMSTR-KEY)
00790 *        SET       (ADDRESS OF CLAIM-MASTER)
00791 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.S                   )   #00018442' TO DFHEIV0
           MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'2020233030303138343432' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELMSTR-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CLAIM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00792
00793      IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
00794         MSTR-CERT-NO NOT = W-CL-CERT-NO
00795          GO TO 7300-CONTINUE.
00796
00797      IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
00798         PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
00799         PB-SV-STATE    NOT = CL-CERT-STATE     OR
00800         PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
00801         PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
00802          GO TO 7300-NEXT-CLAIM.
00803
121802*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
062904     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
121802        OR (CL-CLAIM-TYPE = 'I')
100703        OR (CL-CLAIM-TYPE = 'G')
00805         IF CLAIM-IS-OPEN
012010           EVALUATE TRUE
012010             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
012010                 MOVE ER-2884      TO WS-ERROR
012010             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
011211                 MOVE ER-2887      TO WS-ERROR
012010             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
012010                 MOVE ER-2886      TO WS-ERROR
011211             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
011211                 MOVE ER-2888      TO WS-ERROR
011211             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
011211                 MOVE ER-2885      TO WS-ERROR
012010             WHEN OTHER
012010                 MOVE ER-2768      TO WS-ERROR
012010           END-EVALUATE
060710           IF PB-C-AH-CANCEL-VOIDED OR
011211              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
060710                NOT AH-COVERAGE-CANCELLED)
012010               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
012010               MOVE ER-2768      TO WS-ERROR
012010           END-IF
00807            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
011211           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
012010              PB-FORCE-CODE NOT EQUAL '8'
012010               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
012010           END-IF
012010           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
00808            GO TO 7300-CONTINUE
062904        ELSE
011211           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
011211*****THIS IS A RESCISSION OR REFORMATION
011211              IF (AH-COVERAGE-CANCELLED AND
011211                  PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT)
011211                    MOVE ER-2890 TO WS-ERROR
011211                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
011211                    GO TO 7300-CONTINUE
011211              END-IF
011211           ELSE
011211              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
042412               AND PB-C-AH-CANCEL-DT > SPACES
011211                 MOVE ER-2756        TO WS-ERROR
011211                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
011211                 GO TO 7300-CONTINUE
011211              END-IF
011211           END-IF
011211        END-IF
00811      ELSE
00812 *       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
062904        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
00813            IF CLAIM-IS-OPEN
011211              MOVE ER-2889      TO WS-ERROR
011211              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
00816               GO TO 7300-CONTINUE
062904           ELSE
011211              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
011211*****THIS IS A RESCISSION OR REFORMATION
011211                 IF (LF-COVERAGE-CANCELLED AND
011211                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
011211                       MOVE ER-2890 TO WS-ERROR
011211                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
011211                       GO TO 7300-CONTINUE
011211                 END-IF
011211              ELSE
011211                 IF (AH-COVERAGE-CANCELLED AND
050311                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
050311                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
011211                    (LF-COVERAGE-CANCELLED AND
011211                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
011211                     WS-ST-REFUND-CLAIM-FLAG = '4')
011211                       MOVE ER-2965 TO WS-ERROR
011211                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
011211                       GO TO 7300-CONTINUE
011211                 END-IF
011211                 IF LF-COVERAGE-CANCELLED
050311                  IF CL-TOTAL-PAID-AMT > 0
011211                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
011211                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
011211                        MOVE ER-2891 TO WS-ERROR
011211                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
011211                        GO TO 7300-CONTINUE
011211                      END-IF
011211                    ELSE
011211                      MOVE ER-2892 TO WS-ERROR
011211                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
011211                      GO TO 7300-CONTINUE
011211                    END-IF
050311                  END-IF
011211                 END-IF
062904              END-IF
062904           END-IF
062904        END-IF
062904     END-IF
00817
00818      GO TO 7300-NEXT-CLAIM.
00819
00820  7300-CONTINUE.
00821
00822      IF W-BROWSE-SW = 'Y'
00823          
      * EXEC CICS ENDBR
00824 *            DATASET   (CLMS-ID)
00825 *        END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00018561' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303138353631' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CLMS-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00826
00827  7300-EXIT.
00828      EXIT.
00829      EJECT
00830
00831  7400-GET-REMAIN-TERM.
00832      
      * EXEC CICS LINK
00833 *        PROGRAM    ('ELRTRM')
00834 *        COMMAREA   (CALCULATION-PASS-AREA)
00835 *        LENGTH     (CP-COMM-LENGTH)
00836 *    END-EXEC.
           MOVE 'ELRTRM' TO DFHEIV1
      *    MOVE '."C                   (   #00018570' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138353730' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00837
00838  7400-EXIT.
00839      EXIT.
00840      EJECT
00841
00842  7500-GET-REMAIN-AMOUNT.
00843      
      * EXEC CICS LINK
00844 *        PROGRAM    ('ELRAMT')
00845 *        COMMAREA   (CALCULATION-PASS-AREA)
00846 *        LENGTH     (CP-COMM-LENGTH)
00847 *    END-EXEC.
           MOVE 'ELRAMT' TO DFHEIV1
      *    MOVE '."C                   (   #00018581' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138353831' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00848
00849  7500-EXIT.
00850      EXIT.
00851      EJECT
00852
00853  7600-GET-REFUND.
00854      
      * EXEC CICS LINK
00855 *        PROGRAM    ('ELRFND')
00856 *        COMMAREA   (CALCULATION-PASS-AREA)
00857 *        LENGTH     (CP-COMM-LENGTH)
00858 *    END-EXEC.
           MOVE 'ELRFND' TO DFHEIV1
      *    MOVE '."C                   (   #00018592' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138353932' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CALCULATION-PASS-AREA, 
                 CP-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00859
00860  7600-EXIT.
00861      EXIT.
00862      EJECT
00863  7700-CALL-DL1.
00864      
      * EXEC CICS LINK
00865 *        PROGRAM    ('DLO001')
00866 *        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
00867 *        LENGTH     (DLO001-COMM-LENGTH)
00868 *    END-EXEC.
           MOVE 'DLO001' TO DFHEIV1
      *    MOVE '."C                   (   #00018602' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363032' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-MASTER-POLICY-FORM, 
                 DLO001-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00869
00870  7700-EXIT.
00871      EXIT.
00872
00873  7710-CALL-DL2.
00874      
      * EXEC CICS LINK
00875 *        PROGRAM    ('DLO002')
00876 *        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
00877 *        LENGTH     (DLO002-COMM-LENGTH)
00878 *    END-EXEC.
           MOVE 'DLO002' TO DFHEIV1
      *    MOVE '."C                   (   #00018612' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363132' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-INTERNAL-POLICY-FORM, 
                 DLO002-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00879
00880  7710-EXIT.
00881      EXIT.
00882
00883  7720-CALL-DL3.
00884      
      * EXEC CICS LINK
00885 *        PROGRAM    ('DLO003')
00886 *        COMMAREA   (WS-DLO-VALID-BANK-ID)
00887 *        LENGTH     (DLO003-COMM-LENGTH)
00888 *    END-EXEC.
           MOVE 'DLO003' TO DFHEIV1
      *    MOVE '."C                   (   #00018622' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363232' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-BANK-ID, 
                 DLO003-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00889
00890  7720-EXIT.
00891      EXIT.
00892
00893  7730-CALL-DL7.
00894      
      * EXEC CICS LINK
00895 *        PROGRAM    ('DLO007')
00896 *        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
00897 *        LENGTH     (DLO007-COMM-LENGTH)
00898 *    END-EXEC.
           MOVE 'DLO007' TO DFHEIV1
      *    MOVE '."C                   (   #00018632' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363332' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-CERT-UNDRWRTR-ASSIGN, 
                 DLO007-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00899
00900  7730-EXIT.
00901      EXIT.
00902
00903  7740-CALL-DL11.
00904      
      * EXEC CICS LINK
00905 *        PROGRAM    ('DLO011')
00906 *        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
00907 *        LENGTH     (DLO011-COMM-LENGTH)
00908 *    END-EXEC.
           MOVE 'DLO011' TO DFHEIV1
      *    MOVE '."C                   (   #00018642' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363432' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-PREM-RATES-BEN-TYPE, 
                 DLO011-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00909
00910  7740-EXIT.
00911      EXIT.
00912
00913  7750-CALL-DL17.
00914      
      * EXEC CICS LINK
00915 *        PROGRAM    ('DLO017')
00916 *        COMMAREA   (WS-DLO-VALID-RATE-CODE)
00917 *        LENGTH     (DLO017-COMM-LENGTH)
00918 *    END-EXEC.
           MOVE 'DLO017' TO DFHEIV1
      *    MOVE '."C                   (   #00018652' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363532' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-RATE-CODE, 
                 DLO017-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00919
00920  7750-EXIT.
00921      EXIT.
00922
00923  7755-CALL-DL19.
00924      
      * EXEC CICS LINK
00925 *        PROGRAM    ('DLO019')
00926 *        COMMAREA   (WS-DLO-ORIG-COV-CAT)
00927 *        LENGTH     (DLO019-COMM-LENGTH)
00928 *    END-EXEC.
           MOVE 'DLO019' TO DFHEIV1
      *    MOVE '."C                   (   #00018662' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363632' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-ORIG-COV-CAT, 
                 DLO019-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00929
00930  7755-EXIT.
00931      EXIT.
00932
00933  7760-CALL-DL21.
00934      
      * EXEC CICS LINK
00935 *        PROGRAM    ('DLO021')
00936 *        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
00937 *        LENGTH     (DLO021-COMM-LENGTH)
00938 *    END-EXEC.
           MOVE 'DLO021' TO DFHEIV1
      *    MOVE '."C                   (   #00018672' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363732' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-LOAN-OFFICER, 
                 DLO021-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00939
00940  7760-EXIT.
00941      EXIT.
00942
00943  7770-CALL-DL22.
00944      
      * EXEC CICS LINK
00945 *        PROGRAM    ('DLO022')
00946 *        COMMAREA   (WS-DLO-VALID-STATE-CODE)
00947 *        LENGTH     (DLO022-COMM-LENGTH)
00948 *    END-EXEC.
           MOVE 'DLO022' TO DFHEIV1
      *    MOVE '."C                   (   #00018682' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138363832' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-DLO-VALID-STATE-CODE, 
                 DLO022-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00949
00950  7770-EXIT.
00951      EXIT.
00952
00953      EJECT
00954
00955  7800-REWRITE-CERT.
00956 ******************************************************************
00957 *     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
00958 *        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
00959 ******************************************************************
00960
00961      IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
00962         CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
00963         CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
00964         CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
00965                
      * EXEC CICS REWRITE
00966 *                  DATASET (CERT-ID)
00967 *                  FROM    (CERTIFICATE-MASTER)
00968 *              END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&& L                  %   #00018703' TO DFHEIV0
           MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'2020233030303138373033' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
00969         GO TO 7800-EXIT.
00970
00971        PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
00972        PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
00973
00974  7800-EXIT.
00975       EXIT.
00976
00977  7900-DELETE-CERT.
00978      
      * EXEC CICS DELETE
00979 *        DATASET (CERT-ID)
00980 *    END-EXEC.
      *    MOVE '&(                    &   #00018716' TO DFHEIV0
           MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303138373136' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00981
00982  7900-EXIT.
00983      EXIT.
00984
00985  8000-WRITE-CERT.
00986      
      * EXEC CICS HANDLE CONDITION
00987 *        DUPKEY    (8000-FREE-MAIN)
00988 *    END-EXEC.
      *    MOVE '"$$                   ! + #00018724' TO DFHEIV0
           MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2B20233030303138373234' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00989
00990      
      * EXEC CICS WRITE
00991 *        DATASET     (CERT-ID)
00992 *        FROM        (CERTIFICATE-MASTER)
00993 *        RIDFLD      (ELCERT-KEY)
00994 *    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00018728' TO DFHEIV0
           MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
           MOVE X'2020233030303138373238' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
00995
00996  8000-FREE-MAIN.
00997
00998  8000-EXIT.
00999       EXIT.
01000       EJECT
01001
01002  8100-READ-ERPNDM.
01003      
      * EXEC CICS HANDLE CONDITION
01004 *         NOTFND     (8100-NOTFND)
01005 *         ENDFILE    (8100-NOTFND)
01006 *    END-EXEC.
      *    MOVE '"$I''                  ! , #00018741' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2C20233030303138373431' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01007
01008      MOVE SPACES                 TO ERPNDM-FOUND.
01009      MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
01010
01011      
      * EXEC CICS READ
01012 *         DATASET   (FILE-ERPNDM)
01013 *         RIDFLD    (PM-CONTROL-PRIMARY)
01014 *         INTO      (PENDING-MAILING-DATA)
01015 *    END-EXEC.
           MOVE LENGTH OF
            PENDING-MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00018749' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138373439' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERPNDM, 
                 PENDING-MAILING-DATA, 
                 DFHEIV11, 
                 PM-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01016
01017      GO TO 8100-EXIT.
01018
01019  8100-NOTFND.
01020
01021      MOVE 'X'                    TO ERPNDM-FOUND.
01022      MOVE ER-2694                TO WS-ERROR.
01023      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
           MOVE ER-2883                TO WS-ERROR
           PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
           .
01025  8100-EXIT.
01026      EXIT.
01027
01028  8110-READ-ERMAIL.
01029      
      * EXEC CICS HANDLE CONDITION
01030 *         NOTFND     (8110-NOTFND)
01031 *         ENDFILE    (8110-NOTFND)
01032 *    END-EXEC.
      *    MOVE '"$I''                  ! - #00018769' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2D20233030303138373639' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01033
01034      MOVE SPACES                 TO ERMAIL-FOUND.
01035      MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
01036      MOVE PB-SV-CARRIER          TO MA-CARRIER.
01037      MOVE PB-SV-GROUPING         TO MA-GROUPING.
01038      MOVE PB-SV-STATE            TO MA-STATE.
01039
01040      
      * EXEC CICS READ
01041 *         UPDATE
01042 *         DATASET   (FILE-ERMAIL)
01043 *         RIDFLD    (MA-CONTROL-PRIMARY)
01044 *         INTO      (MAILING-DATA)
01045 *    END-EXEC.
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00018780' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138373830' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01046
01047      GO TO 8110-EXIT.
01048
01049  8110-NOTFND.
01050      MOVE 'X'                    TO ERMAIL-FOUND.
01051
01052  8110-EXIT.
01053      EXIT.
01054
01055  8120-REWRITE-ERMAIL.
01056      
      * EXEC CICS REWRITE
01057 *         DATASET    (FILE-ERMAIL)
01058 *         FROM       (MAILING-DATA)
01059 *    END-EXEC.
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&& L                  %   #00018796' TO DFHEIV0
           MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'2020233030303138373936' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01060
01061  8120-EXIT.
01062      EXIT.
01063
01064  8130-WRITE-ERMAIL.
01065      
      * EXEC CICS HANDLE CONDITION
01066 *         DUPKEY   (8130-EXIT)
01067 *    END-EXEC.
      *    MOVE '"$$                   ! . #00018805' TO DFHEIV0
           MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2E20233030303138383035' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01068
01069      
      * EXEC CICS WRITE
01070 *         DATASET     (FILE-ERMAIL)
01071 *         RIDFLD      (MA-CONTROL-PRIMARY)
01072 *         FROM        (MAILING-DATA)
01073 *    END-EXEC.
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00018809' TO DFHEIV0
           MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383039' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01074
01075  8130-EXIT.
01076      EXIT.
01077
01078  8140-UNLOCK-ERMAIL.
01079      
      * EXEC CICS UNLOCK
01080 *         DATASET   (FILE-ERMAIL)
01081 *    END-EXEC.
      *    MOVE '&*                    #   #00018819' TO DFHEIV0
           MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383139' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01082
01083  8140-EXIT.
01084      EXIT.
01085
042709 8180-UPDATE-VIN-NUMBER.
042709     
      * EXEC CICS HANDLE CONDITION
042709*        NOTFND   (8180-NOTFND)
042709*    END-EXEC.
      *    MOVE '"$I                   ! / #00018827' TO DFHEIV0
           MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'2F20233030303138383237' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
042709
042709     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
042709     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
042709
042709     
      * EXEC CICS READ
042709*        UPDATE
042709*        DATASET  (CRTT-ID)
042709*        RIDFLD   (WS-ELCRTT-KEY)
042709*        INTO     (CERTIFICATE-TRAILERS)
042709*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00018834' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383334' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
042709
042709     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
042709         MOVE PB-I-VIN TO CS-VIN-NUMBER
042709         
      * EXEC CICS REWRITE
042709*           DATASET  (CRTT-ID)
042709*           FROM     (CERTIFICATE-TRAILERS)
042709*        END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00018843' TO DFHEIV0
           MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383433' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
           ELSE
              
      * EXEC CICS UNLOCK
      *          DATASET  (CRTT-ID)
      *       END-EXEC
      *    MOVE '&*                    #   #00018848' TO DFHEIV0
           MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383438' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
042709     END-IF.
042709
042709     GO TO 8180-EXIT.
042709
042709 8180-NOTFND.
042709
042709     MOVE SPACES       TO CERTIFICATE-TRAILERS.
042709     MOVE 'CS'         TO CS-RECORD-ID.
042709     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
042709     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
042709     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
042709     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
042709     
      * EXEC CICS WRITE
042709*       DATASET  (CRTT-ID)
042709*       RIDFLD   (WS-ELCRTT-KEY)
042709*       FROM     (CERTIFICATE-TRAILERS)
042709*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00018863' TO DFHEIV0
           MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383633' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
042709
042709 8180-EXIT.
042709     EXIT.
042709
012010 8190-UPDATE-REFUND-CLAIM-FLAG.
012010     
      * EXEC CICS HANDLE CONDITION
012010*        NOTFND   (8190-NOTFND)
012010*    END-EXEC.
      *    MOVE '"$I                   ! 0 #00018873' TO DFHEIV0
           MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3020233030303138383733' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012010
012010     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
012010     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
012010
012010     
      * EXEC CICS READ
012010*        UPDATE
012010*        DATASET  (CRTT-ID)
012010*        RIDFLD   (WS-ELCRTT-KEY)
012010*        INTO     (CERTIFICATE-TRAILERS)
012010*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00018880' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383830' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012010
012010     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
012010     
      * EXEC CICS REWRITE
012010*       DATASET  (CRTT-ID)
012010*       FROM     (CERTIFICATE-TRAILERS)
012010*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00018888' TO DFHEIV0
           MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'2020233030303138383838' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012010
012010     GO TO 8190-EXIT.
012010
012010 8190-NOTFND.
012010
012010     MOVE SPACES       TO CERTIFICATE-TRAILERS.
012010     MOVE 'CS'         TO CS-RECORD-ID.
012010     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
012010     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
012010     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
012010     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
012010     
      * EXEC CICS WRITE
012010*       DATASET  (CRTT-ID)
012010*       RIDFLD   (WS-ELCRTT-KEY)
012010*       FROM     (CERTIFICATE-TRAILERS)
012010*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00018903' TO DFHEIV0
           MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
           MOVE X'2020233030303138393033' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
012010
012010 8190-EXIT.
012010     EXIT.
012010
121712 8195-UPDATE-AGE-FLAGS.
121712     
      * EXEC CICS HANDLE CONDITION
121712*        NOTFND   (8195-NOTFND)
121712*    END-EXEC.
      *    MOVE '"$I                   ! 1 #00018913' TO DFHEIV0
           MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3120233030303138393133' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
121712
121712     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
121712     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
121712
121712     
      * EXEC CICS READ
121712*        UPDATE
121712*        DATASET  (CRTT-ID)
121712*        RIDFLD   (WS-ELCRTT-KEY)
121712*        INTO     (CERTIFICATE-TRAILERS)
121712*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00018920' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138393230' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
121712
121712     IF WS-INS-AGE-SET = 'Y'
121712        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
121712     END-IF
121712     IF WS-JNT-AGE-SET = 'Y'
121712        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
121712     END-IF
121712
121712     
      * EXEC CICS REWRITE
121712*       DATASET  (CRTT-ID)
121712*       FROM     (CERTIFICATE-TRAILERS)
121712*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&& L                  %   #00018934' TO DFHEIV0
           MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'2020233030303138393334' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
121712
121712     GO TO 8195-EXIT.
121712
121712 8195-NOTFND.
121712
121712     MOVE SPACES       TO CERTIFICATE-TRAILERS.
121712     MOVE 'CS'         TO CS-RECORD-ID.
121712     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
121712     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
121712     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
121712     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
121712     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
121712     
      * EXEC CICS WRITE
121712*       DATASET  (CRTT-ID)
121712*       RIDFLD   (WS-ELCRTT-KEY)
121712*       FROM     (CERTIFICATE-TRAILERS)
121712*    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&$ L                  ''   #00018950' TO DFHEIV0
           MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
           MOVE X'2020233030303138393530' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
121712
121712 8195-EXIT.
121712     EXIT.
121712
01086  8200-READ-REIN-TABLE.
01087      
      * EXEC CICS HANDLE CONDITION
01088 *         NOTFND   (8200-NOTFND)
01089 *    END-EXEC.
      *    MOVE '"$I                   ! 2 #00018960' TO DFHEIV0
           MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3220233030303138393630' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01090
01091      
      * EXEC CICS READ
01092 *        DATASET     (REIN-ID)
01093 *        SET         (ADDRESS OF REINSURANCE-RECORD)
01094 *        RIDFLD      (ERREIN-KEY)
01095 *    END-EXEC.
      *    MOVE '&"S        E          (   #00018964' TO DFHEIV0
           MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138393634' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 REIN-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERREIN-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF REINSURANCE-RECORD TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01096
01097      GO TO 8200-EXIT.
01098
01099  8200-NOTFND.
01100      MOVE 'N'             TO WS-REIN-READ-SW.
01101
01102  8200-EXIT.
01103       EXIT.
01104       EJECT
01105
01106  8300-READ-CTBL-TABLE.
01107      
      * EXEC CICS HANDLE CONDITION
01108 *        NOTFND    (8300-NOTFND)
01109 *        DISABLED  (8300-ERRESS-PROBLEM)
01110 *        NOTOPEN   (8300-ERRESS-PROBLEM)
01111 *        ENDFILE   (8300-NOTFND)
01112 *    END-EXEC.
      *    MOVE '"$IcJ''                ! 3 #00018980' TO DFHEIV0
           MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3320233030303138393830' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01113
01114      
      * EXEC CICS READ
01115 *        DATASET     (CTBL-ID)
01116 *        SET         (ADDRESS OF COMM-TABLE-RECORD)
01117 *        RIDFLD      (ERCTBL-KEY)
01118 *    END-EXEC.
      *    MOVE '&"S        E          (   #00018987' TO DFHEIV0
           MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303138393837' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CTBL-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ERCTBL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF COMM-TABLE-RECORD TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01119
01120      MOVE 'Y'                          TO WS-CTBL-READ-SW.
01121
01122      GO TO 8300-EXIT.
01123
01124  8300-NOTFND.
01125
01126      IF CTBL-SW = '0530'
01127          MOVE 'AA'                     TO WS-AH-COMP-CD
01128          MOVE '0550'                   TO CTBL-SW
01129          MOVE '1'                      TO WS-CTBL-READ-SW
01130          GO TO 8300-EXIT.
01131
01132      IF CTBL-SW = '0540'
01133          MOVE 'AA'                     TO WS-LF-COMP-CD
01134          MOVE '0550'                   TO CTBL-SW
01135          MOVE '1'                      TO WS-CTBL-READ-SW
01136          GO TO 8300-EXIT.
01137
01138      IF CTBL-SW = '0550'
01139          MOVE '2'                      TO WS-CTBL-READ-SW
01140          GO TO 8300-EXIT.
01141
01142      GO TO 8300-EXIT.
01143
01144  8300-ERRESS-PROBLEM.
01145
01146       MOVE ER-8050              TO WS-ERROR.
01147       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01148
01149      GO TO 8300-EXIT.
01150
01151  8300-EXIT.
01152       EXIT.
01153       EJECT
01154
01155
01156  8400-GETMAIN-ERFORM.
01157
01158      
      * EXEC CICS   GETMAIN
01159 *        LENGTH  (500)
01160 *        SET     (ADDRESS OF FORM-MASTER)
01161 *    END-EXEC.
           MOVE 500
             TO DFHEIV11
      *    MOVE '," L                  $   #00019031' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303139303331' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF FORM-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01162
01163      SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
01164
01165  8400-EXIT.
01166       EXIT.
01167
01168  8450-READ-FORM-MASTER.
01169
01170      
      * EXEC CICS  HANDLE CONDITION
01171 *        NOTFND   (8450-FORM-NOT-FOUND)
01172 *        ENDFILE  (8450-FORM-NOT-FOUND)
01173 *    END-EXEC.
      *    MOVE '"$I''                  ! 4 #00019043' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3420233030303139303433' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01174
01175      
      * EXEC CICS   READ
01176 *        DATASET   (FORM-ID)
01177 *        RIDFLD    (ERFORM-KEY)
01178 *        INTO      (FORM-MASTER)
01179 *        GTEQ
01180 *    END-EXEC.
           MOVE LENGTH OF
            FORM-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       G          (   #00019048' TO DFHEIV0
           MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139303438' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FORM-ID, 
                 FORM-MASTER, 
                 DFHEIV11, 
                 ERFORM-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01181
01182      MOVE  'Y'           TO  FORM-MASTER-SW.
01183
01184      GO TO  8450-EXIT.
01185
01186  8450-FORM-NOT-FOUND.
01187
01188      MOVE  'N'           TO  FORM-MASTER-SW.
01189
01190  8450-EXIT.
01191       EXIT.
01192
01193  8500-DATE-CONVERT.
01194      
      * EXEC CICS LINK
01195 *        PROGRAM    ('ELDATCV')
01196 *        COMMAREA   (DATE-CONVERSION-DATA)
01197 *        LENGTH     (DC-COMM-LENGTH)
01198 *    END-EXEC.
           MOVE 'ELDATCV' TO DFHEIV1
      *    MOVE '."C                   (   #00019067' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139303637' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 DATE-CONVERSION-DATA, 
                 DC-COMM-LENGTH, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01199
01200  8500-EXIT.
01201      EXIT.
01202      EJECT
01203
01204  8555-RELOAD-CONTROL-FILE.
01205      CONTINUE.
01206
01207  8555-EXIT.
01208      EXIT.
01209
01210  8557-GETMAIN-ERPLAN.
01211
01212      
      * EXEC CICS GETMAIN
01213 *        LENGTH    (840)
01214 *        SET       (ADDRESS OF PLAN-RECORDS)
01215 *    END-EXEC.
           MOVE 840
             TO DFHEIV11
      *    MOVE '," L                  $   #00019085' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303139303835' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF PLAN-RECORDS TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01216
01217      SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
01218
01219  8557-EXIT.
01220      EXIT.
01221
01222  8560-GETMAIN.
01223      
      * EXEC CICS GETMAIN
01224 *        LENGTH    (2000)
01225 *        SET       (ADDRESS OF ACCOUNT-MASTER)
01226 *    END-EXEC.
           MOVE 2000
             TO DFHEIV11
      *    MOVE '," L                  $   #00019096' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303139303936' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF ACCOUNT-MASTER TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01227
01228      SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
01229
01230  8560-EXIT.
01231      EXIT.
01232
01233  8570-START-ACCOUNT-MASTER.
01234      
      * EXEC CICS HANDLE CONDITION
01235 *        NOTFND    (0199-ACCT-NOT-FOUND)
01236 *        ENDFILE   (0199-ACCT-NOT-FOUND)
01237 *    END-EXEC.
      *    MOVE '"$I''                  ! 5 #00019107' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3520233030303139313037' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01238
01239      
      * EXEC CICS STARTBR
01240 *        DATASET    (ACCT-ID)
01241 *        RIDFLD     (ERACCT-KEY)
01242 *        GTEQ
01243 *    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00019112' TO DFHEIV0
           MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303139313132' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 ACCT-ID, 
                 ERACCT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01244
01245  8570-EXIT.
01246      EXIT.
01247
01248  8580-READ-ACCOUNT-MASTER.
01249      
      * EXEC CICS HANDLE CONDITION
01250 *        NOTFND    (0199-ACCT-NOT-FOUND)
01251 *        ENDFILE   (0199-ACCT-NOT-FOUND)
01252 *    END-EXEC.
      *    MOVE '"$I''                  ! 6 #00019122' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3620233030303139313232' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01253
01254      
      * EXEC CICS READNEXT
01255 *        DATASET     (ACCT-ID)
01256 *        INTO        (ACCOUNT-MASTER)
01257 *        RIDFLD      (ERACCT-KEY)
01258 *    END-EXEC.
           MOVE LENGTH OF
            ACCOUNT-MASTER
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00019127' TO DFHEIV0
           MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'2020233030303139313237' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 ACCT-ID, 
                 ACCOUNT-MASTER, 
                 DFHEIV12, 
                 ERACCT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01259
01260  8580-EXIT.
01261      EXIT.
01262
100703 8582-READ-COMPENSATION-MASTER.
100703     
      * EXEC CICS HANDLE CONDITION
100703*        NOTFND    (8582-COMP-NOT-FOUND)
100703*        ENDFILE   (8582-COMP-NOT-FOUND)
100703*    END-EXEC.
      *    MOVE '"$I''                  ! 7 #00019137' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3720233030303139313337' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
100703
100703     
      * EXEC CICS READ
100703*        DATASET     (COMP-ID)
100703*        INTO        (COMPENSATION-MASTER)
100703*        RIDFLD      (ERCOMP-KEY)
100703*    END-EXEC.
           MOVE LENGTH OF
            COMPENSATION-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00019142' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139313432' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 COMP-ID, 
                 COMPENSATION-MASTER, 
                 DFHEIV11, 
                 ERCOMP-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
100703
100703     MOVE 'Y'                    TO COMP-MASTER-SW
100703
100703     GO TO 8582-EXIT
100703     .
100703 8582-COMP-NOT-FOUND.
100703
100703     MOVE 'N'                    TO COMP-MASTER-SW.
100703
100703 8582-EXIT.
100703     EXIT.
100703
111504 8583-READ-ERAGTC.
111504     
      * EXEC CICS HANDLE CONDITION
111504*        NOTFND    (8583-AGTC-NOT-FOUND)
111504*        ENDFILE   (8583-AGTC-NOT-FOUND)
111504*    END-EXEC.
      *    MOVE '"$I''                  ! 8 #00019160' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3820233030303139313630' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
111504
030905     
      * EXEC CICS STARTBR
030905*        DATASET    (AGTC-ID)
030905*        RIDFLD     (ERAGTC-KEY)
030905*        GTEQ
030905*    END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &   #00019165' TO DFHEIV0
           MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303139313635' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 AGTC-ID, 
                 ERAGTC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
030905
01248  8583-READ-ERAGTC-NEXT.
111504     
      * EXEC CICS READNEXT
111504*        DATASET     (AGTC-ID)
111504*        INTO        (AGENT-COMMISSIONS)
111504*        RIDFLD      (ERAGTC-KEY)
111504*    END-EXEC.
           MOVE LENGTH OF
            AGENT-COMMISSIONS
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00019172' TO DFHEIV0
           MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'2020233030303139313732' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 AGTC-ID, 
                 AGENT-COMMISSIONS, 
                 DFHEIV12, 
                 ERAGTC-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
111504
111504*    MOVE 'Y'                    TO AGTC-MASTER-SW
111504
111504     GO TO 8583-EXIT
111504     .
111504 8583-AGTC-NOT-FOUND.
111504
111504     MOVE 'N'                    TO AGTC-MASTER-SW.
111504
111504 8583-EXIT.
111504     EXIT.
100703
100703 8584-READ-BANK-CROSS-REF.
100703     
      * EXEC CICS HANDLE CONDITION
100703*        NOTFND    (8584-BXRF-NOT-FOUND)
100703*        ENDFILE   (8584-BXRF-NOT-FOUND)
100703*    END-EXEC.
      *    MOVE '"$I''                  ! 9 #00019190' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3920233030303139313930' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
100703
100703     
      * EXEC CICS READ
100703*        DATASET     (BXRF-ID)
100703*        INTO        (BANK-CROSS-REFERENCE)
100703*        RIDFLD      (ERBXRF-KEY)
100703*        LENGTH      (BXRF-REC-LENGTH)
100703*    END-EXEC.
      *    MOVE '&"IL       E          (   #00019195' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139313935' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 BXRF-ID, 
                 BANK-CROSS-REFERENCE, 
                 BXRF-REC-LENGTH, 
                 ERBXRF-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
100703
100703     MOVE 'Y'                    TO BXRF-MASTER-SW
100703
100703     GO TO 8584-EXIT
100703     .
100703 8584-BXRF-NOT-FOUND.
100703
100703     MOVE 'N'                    TO BXRF-MASTER-SW.
100703
100703 8584-EXIT.
100703     EXIT.
100703
01263  8585-READ-PLAN-MASTER.
01264
01265      
      * EXEC CICS HANDLE CONDITION
01266 *        NOTFND    (8585-PLAN-NOT-FOUND)
01267 *        ENDFILE   (8585-PLAN-NOT-FOUND)
01268 *    END-EXEC.
      *    MOVE '"$I''                  ! : #00019215' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3A20233030303139323135' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01269
01270      
      * EXEC CICS READ
01271 *        DATASET     (PLAN-ID)
01272 *        INTO        (PLAN-MASTER)
01273 *        RIDFLD      (ERPLAN-KEY)
01274 *    END-EXEC.
           MOVE LENGTH OF
            PLAN-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       E          (   #00019220' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139323230' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PLAN-ID, 
                 PLAN-MASTER, 
                 DFHEIV11, 
                 ERPLAN-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01275
01276      MOVE 'Y'                    TO PLAN-MASTER-SW.
01277
01278      GO TO 8585-EXIT.
01279
01280  8585-PLAN-NOT-FOUND.
01281
01282      MOVE 'N'                    TO PLAN-MASTER-SW.
01283
01284  8585-EXIT.
01285      EXIT.
01286
083106 8586-READ-LOAN-OFFICER.
083106     
      * EXEC CICS READ
083106*        DATASET     (LOFC-ID)
083106*        INTO        (LOAN-OFFICER-MASTER)
083106*        RIDFLD      (ERLOFC-KEY)
083106*        RESP        (WS-RESPONSE)
083106*    END-EXEC
           MOVE LENGTH OF
            LOAN-OFFICER-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00019238' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'204E233030303139323338' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 LOFC-ID, 
                 LOAN-OFFICER-MASTER, 
                 DFHEIV11, 
                 ERLOFC-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
083106
           IF WS-RESP-NORMAL
083106        MOVE 'Y'                 TO LOFC-MASTER-SW
           ELSE
              MOVE 'N'                 TO LOFC-MASTER-SW
           END-IF
           .
083106 8586-EXIT.
083106     EXIT.
       8587-START-ERPDEF.
           
      * EXEC CICS STARTBR
      *       DATASET   (PDEF-ID)
      *       RIDFLD    (ERPDEF-KEY)
      *       GTEQ
      *       RESP      (WS-RESPONSE)
      *    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &  N#00019254' TO DFHEIV0
           MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'204E233030303139323534' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PDEF-ID, 
                 ERPDEF-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
           IF WS-RESP-NORMAL
              MOVE 'Y'                 TO PDEF-MASTER-SW
           ELSE
              MOVE 'N'                 TO PDEF-MASTER-SW
           END-IF
           .
       8587-EXIT.
           EXIT.
       8588-READ-ERPDEF.
           
      * EXEC CICS READNEXT
      *       DATASET   (PDEF-ID)
      *       RIDFLD    (ERPDEF-KEY)
      *       INTO      (PRODUCT-MASTER)
      *       RESP      (WS-RESPONSE)
      *    END-EXEC
           MOVE LENGTH OF
            PRODUCT-MASTER
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )  N#00019269' TO DFHEIV0
           MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'204E233030303139323639' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PDEF-ID, 
                 PRODUCT-MASTER, 
                 DFHEIV12, 
                 ERPDEF-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
           IF WS-RESP-NORMAL
              MOVE 'Y'                 TO PDEF-MASTER-SW
           ELSE
              MOVE 'N'                 TO PDEF-MASTER-SW
           END-IF
           .
       8588-EXIT.
           EXIT.
       8589-ENDBR-ERPDEF.
           
      * EXEC CICS ENDBR
      *       DATASET   (PDEF-ID)
      *    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019284' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303139323834' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 PDEF-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
           .
       8589-EXIT.
           EXIT.
01287  8590-READ-CERT-MASTER.
01288      IF PB-COMPANY-ID = 'UCL'
01289          GO TO 8690-READ-CERT-MASTER-UCL.
01290
01291      
      * EXEC CICS HANDLE CONDITION
01292 *         NOTFND    (0299-CERT-NOT-FOUND)
01293 *    END-EXEC.
      *    MOVE '"$I                   ! ; #00019294' TO DFHEIV0
           MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3B20233030303139323934' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01294
01295      
      * EXEC CICS READ
01296 *        DATASET     (CERT-ID)
01297 *        INTO        (CERTIFICATE-MASTER)
01298 *        RIDFLD      (ELCERT-KEY)
01299 *        UPDATE
01300 *    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00019298' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139323938' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01301
01302  8590-EXIT.
01303      EXIT.
01304
01305  8690-READ-CERT-MASTER-UCL.
01306      
      * EXEC CICS HANDLE CONDITION
01307 *         NOTFND    (8700-READ-CERT-MASTER)
01308 *    END-EXEC.
      *    MOVE '"$I                   ! < #00019309' TO DFHEIV0
           MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3C20233030303139333039' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01309
01310  8690-READ-CERT-CONT.
01311      
      * EXEC CICS READ
01312 *        DATASET     (CERT-ID)
01313 *        INTO        (CERTIFICATE-MASTER)
01314 *        RIDFLD      (ELCERT-KEY)
01315 *        UPDATE
01316 *    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV11
      *    MOVE '&"IL       EU         (   #00019314' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139333134' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 CERTIFICATE-MASTER, 
                 DFHEIV11, 
                 ELCERT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01317
01318      GO TO 8590-EXIT.
01319
01320  8700-READ-CERT-MASTER.
01321      MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
01322      MOVE PB-CERT-NO             TO CERT2-CERT-NO.
01323      
      * EXEC CICS HANDLE CONDITION
01324 *         DUPKEY    (8720-COMP-ACCOUNTS)
01325 *         ENDFILE   (8730-END-BROWSE)
01326 *         NOTFND    (8740-NOT-FOUND)
01327 *    END-EXEC.
      *    MOVE '"$$''I                 ! = #00019326' TO DFHEIV0
           MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3D20233030303139333236' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01328
01329      
      * EXEC CICS STARTBR
01330 *        DATASET     ('ELCERT5')
01331 *        RIDFLD      (ELCERT2-KEY)
01332 *        EQUAL
01333 *    END-EXEC.
           MOVE 'ELCERT5' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         E          &   #00019332' TO DFHEIV0
           MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'2020233030303139333332' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ELCERT2-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01334
01335  8710-READ-NEXT.
01336      
      * EXEC CICS READNEXT
01337 *        DATASET     ('ELCERT5')
01338 *        INTO        (CERTIFICATE-MASTER)
01339 *        RIDFLD      (ELCERT2-KEY)
01340 *    END-EXEC.
           MOVE LENGTH OF
            CERTIFICATE-MASTER
             TO DFHEIV12
           MOVE 'ELCERT5' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )   #00019339' TO DFHEIV0
           MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'2020233030303139333339' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 CERTIFICATE-MASTER, 
                 DFHEIV12, 
                 ELCERT2-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01341
01342  8720-COMP-ACCOUNTS.
01343      
      * EXEC CICS ENTER
01344 *         TRACEID (001)
01345 *         FROM (PB-C-LAST-NAME)
01346 *    END-EXEC.
           MOVE 001
             TO DFHEIV11
      *    MOVE ':$F                   %   #00019346' TO DFHEIV0
           MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'2020233030303139333436' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV11, 
                 PB-C-LAST-NAME, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01347
01348      
      * EXEC CICS ENTER
01349 *         TRACEID (002)
01350 *         FROM (CM-INSURED-LAST-NAME)
01351 *    END-EXEC.
           MOVE 002
             TO DFHEIV11
      *    MOVE ':$F                   %   #00019351' TO DFHEIV0
           MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'2020233030303139333531' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV11, 
                 CM-INSURED-LAST-NAME, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01352
01353      IF PB-CERT-NO NOT = CM-CERT-NO
01354          GO TO 8730-END-BROWSE.
01355
01356      IF PB-ACCOUNT = CM-ACCOUNT
01357          IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
01358              MOVE ER-2799        TO WS-ERROR
01359              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01360              MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
01361              GO TO 8730-END-BROWSE.
01362
01363      GO TO 8710-READ-NEXT.
01364
01365  8730-END-BROWSE.
01366      
      * EXEC CICS ENDBR
01367 *         DATASET    ('ELCERT5')
01368 *    END-EXEC.
           MOVE 'ELCERT5' TO DFHEIV1
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019369' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303139333639' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01369
01370  8740-NOT-FOUND.
01371      GO TO 0299-CERT-NOT-FOUND.
01372
       8750-START-ELSTAT.
           
      * EXEC CICS STARTBR
      *       DATASET   (STAT-ID)
      *       RIDFLD    (ELSTAT-KEY)
      *       GTEQ
      *       RESP      (WS-RESPONSE)
      *    END-EXEC
           MOVE 0
             TO DFHEIV11
      *    MOVE '&,         G          &  N#00019377' TO DFHEIV0
           MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
           MOVE X'204E233030303139333737' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 STAT-ID, 
                 ELSTAT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
           IF WS-RESP-NORMAL
              MOVE 'Y'                 TO STAT-MASTER-SW
           ELSE
              MOVE 'N'                 TO STAT-MASTER-SW
           END-IF
           .
       8750-EXIT.
           EXIT.
       8752-READ-ELSTAT.
           
      * EXEC CICS READNEXT
      *       DATASET   (STAT-ID)
      *       RIDFLD    (ELSTAT-KEY)
      *       INTO      (STATE-FILE)
      *       RESP      (WS-RESPONSE)
      *    END-EXEC
           MOVE LENGTH OF
            STATE-FILE
             TO DFHEIV12
           MOVE 0
             TO DFHEIV11
      *    MOVE '&.IL                  )  N#00019392' TO DFHEIV0
           MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
           MOVE X'204E233030303139333932' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 STAT-ID, 
                 STATE-FILE, 
                 DFHEIV12, 
                 ELSTAT-KEY, 
                 DFHEIV99, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
           IF WS-RESP-NORMAL
              MOVE 'Y'                 TO STAT-MASTER-SW
           ELSE
              MOVE 'N'                 TO STAT-MASTER-SW
           END-IF
           .
       8752-EXIT.
           EXIT.
01375  8800-GET-COMP-RATE.
01376      MOVE +1 TO IB.
01377      IF WS-COMM-CK-AMT GREATER CT-TBF (1)
01378          ADD +9 TO IB
01379          IF WS-COMM-CK-AMT GREATER CT-TBF (2)
01380              ADD +9 TO IB
01381              IF WS-COMM-CK-AMT GREATER CT-TBF (3)
01382                 MOVE ZEROS       TO WS-WK-RATE
01383                 GO TO 8800-EXIT.
01384
01385      IF PB-I-AGE GREATER CT-AGE (1)
01386          ADD +3 TO IB
01387          IF PB-I-AGE GREATER CT-AGE (2)
01388              ADD +3 TO IB
01389              IF PB-I-AGE GREATER CT-AGE (3)
01390                 MOVE ZEROS       TO WS-WK-RATE
01391                 GO TO 8800-EXIT.
01392
01393      IF WS-WORK-TERM GREATER CT-TRM (1)
01394          ADD +1 TO IB
01395          IF WS-WORK-TERM GREATER CT-TRM (2)
01396              ADD +1 TO IB
01397              IF WS-WORK-TERM GREATER CT-TRM (3)
01398                 MOVE ZEROS       TO WS-WK-RATE
01399                 GO TO 8800-EXIT.
01400
01401      IF CT-RT (IB) NOT NUMERIC
01402          MOVE CT-RT-R (IB) TO CTBL-TABLE
01403          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
01404          GO TO 8800-GET-COMP-RATE.
01405
01406      MOVE CT-RT (IB) TO WS-WK-RATE.
01407
01408  8800-EXIT.
01409      EXIT.
01410      EJECT
01411  8900-ADDRESS-FILE.
01412      IF ERACCT-FILE-ADDRESSED
01413          SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
01414          GO TO 8900-ADDRESS-EXIT.
01415
01416      IF ELCNTL-FILE-ADDRESSED
01417          SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
01418          GO TO 8900-ADDRESS-EXIT.
01419
01420      IF ERPLAN-FILE-ADDRESSED
01421          SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
01422          GO TO 8900-ADDRESS-EXIT.
01423
01424      IF ERFORM-FILE-ADDRESSED
01425          SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
01426          GO TO 8900-ADDRESS-EXIT.
01427
01428  8900-ADDRESS-EXIT.
01429      EXIT.
01430
01431  9000-READ-CONTROL.
01432      
      * EXEC CICS HANDLE CONDITION
01433 *        NOTFND    (9000-NOTFND)
01434 *    END-EXEC.
      *    MOVE '"$I                   ! > #00019463' TO DFHEIV0
           MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3E20233030303139343633' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01435
01436      
      * EXEC CICS READ
01437 *        DATASET     (CNTL-ID)
01438 *        SET         (ADDRESS OF CONTROL-FILE)
01439 *        RIDFLD      (ELCNTL-KEY)
01440 *        GTEQ
01441 *    END-EXEC.
      *    MOVE '&"S        G          (   #00019467' TO DFHEIV0
           MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139343637' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CNTL-ID, 
                 DFHEIV20, 
                 DFHEIV99, 
                 ELCNTL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           SET ADDRESS OF CONTROL-FILE TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01442
01443      GO TO 9000-EXIT.
01444
01445  9000-NOTFND.
01446      IF RC-SW-1 = '1'
01447         MOVE ER-2616              TO WS-ERROR
01448         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01449         GO TO 9000-EXIT.
01450
01451      IF RC-SW-1 = '2'
01452         MOVE ER-2602              TO WS-ERROR
01453         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
01454
01455  9000-EXIT.
01456       EXIT.
01457
01458      EJECT
01459  9100-READ-CONTROL.
01460      
      * EXEC CICS HANDLE CONDITION
01461 *        NOTFND  (9100-NOTFND)
01462 *        ENDFILE (9100-NOTFND)
01463 *    END-EXEC.
      *    MOVE '"$I''                  ! ? #00019491' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'3F20233030303139343931' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01464
01465      
      * EXEC CICS READ
01466 *        DATASET     (CNTL-ID)
01467 *        INTO        (CONTROL-FILE)
01468 *        RIDFLD      (ELCNTL-KEY)
01469 *        GTEQ
01470 *    END-EXEC.
           MOVE LENGTH OF
            CONTROL-FILE
             TO DFHEIV11
      *    MOVE '&"IL       G          (   #00019496' TO DFHEIV0
           MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139343936' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CNTL-ID, 
                 CONTROL-FILE, 
                 DFHEIV11, 
                 ELCNTL-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01471
01472      GO TO 9100-EXIT.
01473
01474  9100-NOTFND.
           IF RC-SW-2 = '0'
              MOVE '1'                  TO STATE-RECORD-ERROR
              GO TO 9100-EXIT
           END-IF
01475      IF RC-SW-2 = '1'
01476         MOVE '1'                  TO LF-BENEFIT-ERROR
01477         MOVE ER-2604              TO WS-ERROR
01478         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01479         GO TO 9100-EXIT.
01480
01481      IF RC-SW-2 = '2'
01482         MOVE '1'                  TO AH-BENEFIT-ERROR
01483         MOVE ER-2605              TO WS-ERROR
01484         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01485         GO TO 9100-EXIT.
01486
01487      IF RC-SW-2 = '3'
01488          MOVE ER-2603           TO WS-ERROR
01489          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
01490          GO TO 9100-EXIT.
01491
01492      IF RC-SW-2 = '4'
01493          MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
01494          GO TO 9100-EXIT.
01495
01496      IF RC-SW-2 = '5'
01497          MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
01498          IF WS-AH-INPUT-CD-1 = SPACE
01499              MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
01500          ELSE
01501              MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
01502
01503  9100-EXIT.
01504       EXIT.
01505      EJECT
01506  9200-CONTROL-GETMAIN.
01507      
      * EXEC CICS GETMAIN
01508 *         LENGTH   (750)
01509 *         SET      (ADDRESS OF CONTROL-FILE)
01510 *    END-EXEC.
           MOVE 750
             TO DFHEIV11
      *    MOVE '," L                  $   #00019542' TO DFHEIV0
           MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV20, 
                 DFHEIV11, 
                 DFHEIV99
           SET ADDRESS OF CONTROL-FILE TO
               DFHEIV20
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01511
01512      SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
01513
01514  9200-EXIT.
01515      EXIT.
01516
01517  9250-UNLOCK-RETURN.
01518      
      * EXEC CICS UNLOCK
01519 *        DATASET   (CERT-ID)
01520 *    END-EXEC.
      *    MOVE '&*                    #   #00019553' TO DFHEIV0
           MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
           MOVE X'2020233030303139353533' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CERT-ID, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01521
01522  9300-ABEND.
01523      MOVE DFHEIBLK               TO WS-ERROR-LINE.
01524
01525      
      * EXEC CICS LINK
01526 *        PROGRAM   ('EL004')
01527 *        COMMAREA  (WS-ERROR-LINE)
01528 *        LENGTH    (72)
01529 *    END-EXEC.
           MOVE 'EL004' TO DFHEIV1
           MOVE 72
             TO DFHEIV11
      *    MOVE '."C                   (   #00019560' TO DFHEIV0
           MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'2020233030303139353630' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 WS-ERROR-LINE, 
                 DFHEIV11, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01530
01531      MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
01532
01533      
      * EXEC CICS ABEND
01534 *        ABCODE ('EL50')
01535 *    END-EXEC.
           MOVE 'EL50' TO DFHEIV5
      *    MOVE '.,A                   "   #00019568' TO DFHEIV0
           MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
           MOVE X'2020233030303139353638' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV5
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01536
01537      EJECT
01538
01539 ******************************************************************
01540 *                                                                *
01541 *            E R R O R   F O R M A T   R O U T I N E             *
01542 *                                                                *
01543 ******************************************************************
01544
01545  9900-ERROR-FORMAT.
01546
01547      IF WS-ERROR  = PB-COMMON-ERROR (1) OR
01548                     PB-COMMON-ERROR (2) OR
01549                     PB-COMMON-ERROR (3) OR
01550                     PB-COMMON-ERROR (4) OR
01551                     PB-COMMON-ERROR (5) OR
01552                     PB-COMMON-ERROR (6) OR
01553                     PB-COMMON-ERROR (7) OR
01554                     PB-COMMON-ERROR (8) OR
01555                     PB-COMMON-ERROR (9) OR
01556                     PB-COMMON-ERROR (10)
01557         GO TO 9900-EXIT.
01558
01559      IF PB-NO-OF-ERRORS = +10
01560         GO TO 9900-EXIT.
01561
01562      ADD +1  TO PB-NO-OF-ERRORS.
01563      MOVE WS-ERROR               TO PB-COMMON-ERROR
01564                                        (PB-NO-OF-ERRORS).
01565  9900-EXIT.
01566      EXIT.
01567
01568  9990-RETURN.
01569      IF BROWSE-STARTED
01570         
      * EXEC CICS ENDBR
01571 *            DATASET  (ACCT-ID)
01572 *       END-EXEC.
           MOVE 0
             TO DFHEIV11
      *    MOVE '&2                    $   #00019605' TO DFHEIV0
           MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
           MOVE X'2020233030303139363035' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 ACCT-ID, 
                 DFHEIV11, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01573
01574  9990-EXIT.
01575      EXIT.
01576
061412
061412****Check for CRTO record, add one if not found.
061412 9991-CHECK-FOR-ELCRTO.
061412      
      * EXEC CICS HANDLE CONDITION
061412*         NOTFND  (9991-CRTO-NOT-FOUND)
061412*         ENDFILE (9991-CRTO-NOT-FOUND)
061412*     END-EXEC.
      *    MOVE '"$I''                  ! @ #00019615' TO DFHEIV0
           MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
           MOVE X'4020233030303139363135' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
061412     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
062712     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
061412     MOVE +0                     TO ELCRTO-SEQ-NO
061412
061412     
      * EXEC CICS READ
061412*       DATASET   ('ELCRTO')
061412*       INTO      (ORIGINAL-CERTIFICATE)
061412*       RIDFLD    (ELCRTO-KEY)
061412*       GTEQ
061412*       RESP      (WS-RESPONSE)
061412*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       G          (  N#00019623' TO DFHEIV0
           MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'204E233030303139363233' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 ELCRTO-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
061412
061412     IF WS-RESP-NORMAL
061412        AND (OC-CONTROL-PRIMARY (1:33) =
061412                 PB-CONTROL-BY-ACCOUNT (1:33))
062712        AND (OC-RECORD-TYPE =  'I')
061412           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
011413               GO TO 9991-CHECK-INDICATORS
061412           ELSE
061412               SUBTRACT +1 FROM OC-KEY-SEQ-NO
061412               GO TO 9991-CRTO-ADD-REC
061412           END-IF
061412     END-IF.
061412
061412 9991-CRTO-NOT-FOUND.
061412
061412     MOVE SPACES              TO ORIGINAL-CERTIFICATE
061412     MOVE 'OC'                TO OC-RECORD-ID
061412     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
061412                              TO OC-CONTROL-PRIMARY (1:33)
061412     MOVE +4096               TO OC-KEY-SEQ-NO.
061412
061412 9991-CRTO-ADD-REC.
061412
061412     MOVE 'E050'              TO OC-LAST-MAINT-BY
061412     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
061412     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
062712     MOVE 'I'                 TO OC-RECORD-TYPE
061412     IF PB-ISSUE
062712         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
062712         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
062712         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
062712         MOVE PB-I-AGE               TO OC-INS-AGE
062712         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
062712         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
062712         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
062712         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
062712         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
062712         MOVE PB-I-LF-TERM           TO OC-LF-TERM
062712         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
062712         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
062712         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
062712         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
062712         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
062712         IF PB-I-JOINT-COMMISSION > +0
062712             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
062712         ELSE
062712             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
062712         END-IF
062712         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
062712         MOVE +0                     TO OC-LF-CANCEL-AMT
071712                                        OC-LF-ITD-CANCEL-AMT
062712         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
062712         MOVE PB-I-AH-TERM           TO OC-AH-TERM
062712         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
062712         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
062712         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
062712         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
062712         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
062712         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
062712         MOVE +0                     TO OC-AH-CANCEL-AMT
071712                                        OC-AH-ITD-CANCEL-AMT
062712         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
011413         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
011413         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
061412     ELSE
062712         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
062712         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
062712         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
062712         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
062712         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
062712         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
062712         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
062712         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
072312         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
072312          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
072312             MOVE SPACES             TO OC-LF-BENCD
072312             MOVE ZEROS              TO OC-LF-TERM
072312                                        OC-LF-BEN-AMT
072312                                        OC-LF-PRM-AMT
072312                                        OC-LF-ALT-BEN-AMT
072312                                        OC-LF-ALT-PRM-AMT
072312                                        OC-LF-COMM-PCT
072312                                        OC-LF-CANCEL-AMT
072312             MOVE LOW-VALUES         TO OC-LF-EXP-DT
072312             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
072312         ELSE
062712             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
062712             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
062712             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
062712             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
062712             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
062712             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
062712             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
062712             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
071712             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
071712             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
072312         END-IF
071712         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
072312         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
072312          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
072312             MOVE SPACES             TO OC-AH-BENCD
072312             MOVE ZEROS              TO OC-AH-TERM
072312                                        OC-AH-BEN-AMT
072312                                        OC-AH-PRM-AMT
072312                                        OC-AH-COMM-PCT
072312                                        OC-AH-CANCEL-AMT
072312                                        OC-AH-CP
072312             MOVE LOW-VALUES         TO OC-AH-EXP-DT
072312             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
072312         ELSE
062712             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
062712             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
062712             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
062712             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
062712             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
062712             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
062712             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
071712             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
071712             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
072312         END-IF
071712         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
062712         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
011413         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
011413         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
061412     END-IF
061412     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
061412
091312     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
091312
091312     
      * EXEC CICS READ
091312*         DATASET   (FILE-ERMAIL)
091312*         RIDFLD    (MA-CONTROL-PRIMARY)
091312*         INTO      (MAILING-DATA)
091312*         RESP      (WS-RESPONSE)
091312*    END-EXEC
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00019759' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'204E233030303139373539' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
091312
091312     IF WS-RESP-NORMAL
061412         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
061412     END-IF.
121712
121712     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
121712     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
121712
121712     
      * EXEC CICS READ
121712*         DATASET  (CRTT-ID)
121712*         RIDFLD   (WS-ELCRTT-KEY)
121712*         INTO     (CERTIFICATE-TRAILERS)
121712*         RESP     (WS-RESPONSE)
121712*    END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00019773' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'204E233030303139373733' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
121712
121712     IF WS-RESP-NORMAL
121712         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
121712         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
121712     END-IF.
061412
061412     
      * EXEC CICS WRITE
061412*       DATASET   ('ELCRTO')
061412*       FROM      (ORIGINAL-CERTIFICATE)
061412*       RIDFLD    (OC-CONTROL-PRIMARY)
061412*       RESP      (WS-RESPONSE)
061412*    END-EXEC.
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&$ L                  ''  N#00019785' TO DFHEIV0
           MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
           MOVE X'204E233030303139373835' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
061412
011413     GO TO 9991-EXIT.
011413
011413 9991-CHECK-INDICATORS.
011413
011413     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
011413         GO TO 9991-EXIT
011413     END-IF.
011413
011413     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
011413         GO TO 9991-EXIT
011413     END-IF.
011413
011413     
      * EXEC CICS READ
011413*       DATASET   ('ELCRTO')
011413*       INTO      (ORIGINAL-CERTIFICATE)
011413*       RIDFLD    (OC-CONTROL-PRIMARY)
011413*       UPDATE
011413*       RESP      (WS-RESPONSE)
011413*    END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&"IL       EU         (  N#00019804' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'204E233030303139383034' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 OC-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011413     IF WS-RESP-NORMAL
011413        IF PB-ISSUE
011413          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
011413          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
011413          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
011413          MOVE PB-I-AGE               TO OC-INS-AGE
011413          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
011413          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
011413          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
011413          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
011413          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
011413          MOVE PB-I-LF-TERM           TO OC-LF-TERM
011413          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
011413          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
011413          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
011413          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
011413          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
011413          IF PB-I-JOINT-COMMISSION > +0
011413              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
011413          ELSE
011413              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
011413          END-IF
011413          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
011413          MOVE PB-I-AH-TERM           TO OC-AH-TERM
011413          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
011413          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
011413          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
011413          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
011413          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
011413          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
011413          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
011413
011413          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
011413          
      * EXEC CICS READ
011413*             DATASET   (FILE-ERMAIL)
011413*             RIDFLD    (MA-CONTROL-PRIMARY)
011413*             INTO      (MAILING-DATA)
011413*             RESP      (WS-RESPONSE)
011413*         END-EXEC
           MOVE LENGTH OF
            MAILING-DATA
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00019844' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'204E233030303139383434' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 FILE-ERMAIL, 
                 MAILING-DATA, 
                 DFHEIV11, 
                 MA-CONTROL-PRIMARY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011413          IF WS-RESP-NORMAL
011413             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
011413          END-IF
011413
011413          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
011413          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
011413          
      * EXEC CICS READ
011413*             DATASET  (CRTT-ID)
011413*             RIDFLD   (WS-ELCRTT-KEY)
011413*             INTO     (CERTIFICATE-TRAILERS)
011413*             RESP     (WS-RESPONSE)
011413*         END-EXEC
           MOVE LENGTH OF
            CERTIFICATE-TRAILERS
             TO DFHEIV11
      *    MOVE '&"IL       E          (  N#00019856' TO DFHEIV0
           MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
           MOVE X'204E233030303139383536' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 CRTT-ID, 
                 CERTIFICATE-TRAILERS, 
                 DFHEIV11, 
                 WS-ELCRTT-KEY, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011413          IF WS-RESP-NORMAL
011413             MOVE CS-INS-AGE-DEFAULT-FLAG TO
011413                               OC-INS-AGE-DEFAULT-FLAG
011413             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
011413                               OC-JNT-AGE-DEFAULT-FLAG
011413          END-IF
011413
011413        ELSE
011413          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
011413             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
011413             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
011413             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
011413          END-IF
011413          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
011413             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
011413             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
011413             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
011413          END-IF
011413          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
011413        END-IF
011413        
      * EXEC CICS REWRITE
011413*          DATASET   ('ELCRTO')
011413*          FROM      (ORIGINAL-CERTIFICATE)
011413*          RESP      (WS-RESPONSE)
011413*       END-EXEC
           MOVE LENGTH OF
            ORIGINAL-CERTIFICATE
             TO DFHEIV11
           MOVE 'ELCRTO' TO DFHEIV1
      *    MOVE '&& L                  %  N#00019882' TO DFHEIV0
           MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
           MOVE X'204E233030303139383832' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV1, 
                 ORIGINAL-CERTIFICATE, 
                 DFHEIV11, 
                 DFHEIV99
           MOVE EIBRESP  TO WS-RESPONSE
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
011413     END-IF.
011413
061412 9991-EXIT.
061412     EXIT.
061412
061412
01577  9999-RETURN.
01578      MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
01579
01580      
      * EXEC CICS RETURN
01581 *    END-EXEC.
      *    MOVE '.(                    ''   #00019896' TO DFHEIV0
           MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
           MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
           MOVE X'2020233030303139383936' TO DFHEIV0(25:11)
           CALL 'kxdfhei1' USING DFHEIV0, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99, 
                 DFHEIV99
           GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
           
01582
01583      
      * GOBACK.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL050' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.

       9999-DFHBACK SECTION.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL050' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.
       9999-DFHEXIT.
           IF DFHEIGDJ EQUAL 0001
               NEXT SENTENCE
           ELSE IF DFHEIGDJ EQUAL 2
               GO TO 9300-ABEND,
                     3990-FILES-NOT-OPEN
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 3
               GO TO 6610-START-BROWSE,
                     6630-ERRESS-PROBLEM,
                     6630-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 4
               GO TO 6630-END-OF-FILE,
                     6630-ERRESS-PROBLEM,
                     6630-ERRESS-PROBLEM,
                     6630-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 5
               GO TO 6630-END-OF-FILE,
                     6630-END-OF-FILE,
                     6630-ERRESS-PROBLEM,
                     6630-ERRESS-PROBLEM
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 6
               GO TO 6660-START-BROWSE,
                     6690-ERRESC-PROBLEM,
                     6690-ERRESC-PROBLEM,
                     6690-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 7
               GO TO 6690-END-OF-FILE,
                     6690-ERRESC-PROBLEM,
                     6690-ERRESC-PROBLEM,
                     6690-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 8
               GO TO 6690-END-OF-FILE,
                     6690-ERRESC-PROBLEM,
                     6690-ERRESC-PROBLEM,
                     6690-END-OF-FILE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 9
               GO TO 7250-CONTINUE,
                     7250-CONTINUE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 10
               GO TO 7300-CONTINUE,
                     7300-CONTINUE
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 11
               GO TO 8000-FREE-MAIN
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 12
               GO TO 8100-NOTFND,
                     8100-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 13
               GO TO 8110-NOTFND,
                     8110-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 14
               GO TO 8130-EXIT
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 15
               GO TO 8180-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 16
               GO TO 8190-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 17
               GO TO 8195-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 18
               GO TO 8200-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 19
               GO TO 8300-NOTFND,
                     8300-ERRESS-PROBLEM,
                     8300-ERRESS-PROBLEM,
                     8300-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 20
               GO TO 8450-FORM-NOT-FOUND,
                     8450-FORM-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 21
               GO TO 0199-ACCT-NOT-FOUND,
                     0199-ACCT-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 22
               GO TO 0199-ACCT-NOT-FOUND,
                     0199-ACCT-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 23
               GO TO 8582-COMP-NOT-FOUND,
                     8582-COMP-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 24
               GO TO 8583-AGTC-NOT-FOUND,
                     8583-AGTC-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 25
               GO TO 8584-BXRF-NOT-FOUND,
                     8584-BXRF-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 26
               GO TO 8585-PLAN-NOT-FOUND,
                     8585-PLAN-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 27
               GO TO 0299-CERT-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 28
               GO TO 8700-READ-CERT-MASTER
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 29
               GO TO 8720-COMP-ACCOUNTS,
                     8730-END-BROWSE,
                     8740-NOT-FOUND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 30
               GO TO 9000-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 31
               GO TO 9100-NOTFND,
                     9100-NOTFND
               DEPENDING ON DFHEIGDI
           ELSE IF DFHEIGDJ EQUAL 32
               GO TO 9991-CRTO-NOT-FOUND,
                     9991-CRTO-NOT-FOUND
               DEPENDING ON DFHEIGDI.
           MOVE '9%                    "   ' TO DFHEIV0
           MOVE 'EL050' TO DFHEIV1
           CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
           GOBACK.
